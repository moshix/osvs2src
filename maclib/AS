         MACRO                                                          01000019
&NAME    AS    &ID=,&ASGROUP=,&DEGROUP=                                 02000019
         GBLA  &IECNDGP(100),&IECCNTR                                   03000019
.*             IECCNTR   MAINTAINS CURRENT VALUE OF ID PARAMETER        04000019
.*             IECNDGP(100)  GLOBAL SAVE CELLS FOR NUMBER OF DEUS PER   05000019
.*                           AS. CERTAIN ONES REUSED AFTER DEU TABLE    06000019
.*                           AND DEU-SEQ TABLE GENERATED BY FIRST       07000019
.*                           TGROUP MACRO                               08000019
         GBLB  &IECSW(9),&IECSEQ(10)                              21094 09000021
.*             IECSW(1)  INDICATES CORE SIZE ON = 32K SET BY CONFIG     10000019
.*             IECSW(2)  ON INDICATES NOT FIRST AS MACRO SET BY AS      11000019
.*             IECSW(7)   INTERNAL SW USED BY AS MACROS                 12000019
.*             IECSEQ(2)  SEQUENCE INDICATOR                            13000019
         GBLC  &IECDGRP(100)                                            14000019
         LCLA  &A,&B,&C ARITH SCRATCH                                   15000019
         LCLB  &NCODE                                                   16000019
         LCLC  &CHAR,&CHARS    CHARACTER SCRATCH                        17000019
         ACTR  1000                                               21094 17500021
         AIF   (&IECSW(2)).BY                                           18000019
&IECSEQ(2) SETB 1                                                       19000019
.BY      AIF   (&IECSEQ(1) AND &IECSEQ(2) AND NOT&IECSEQ(3) AND NOT&IEC-20000019
               SEQ(4) AND NOT&IECSEQ(5) AND NOT&IECSEQ(6)).SEQOK        21000019
&NCODE   SETB  1                                                        22000019
         MNOTE 12,'MACRO SEQUENCE ERROR'                                23000019
.SEQOK   AIF   (T'&ID EQ 'N').IDTYPOK                                   24000019
&CHAR    SETC  T'&ID                                                    25000019
&NCODE   SETB  1                                                        26000019
         MNOTE 12,'REQUIRED OPERAND=ID TYPE ATTRIBUTE=&CHAR IMPROPER'   27000019
.IDTYPOK AIF   (&ID+1 GT &IECCNTR AND &ID LE 63 AND NOT &IECSW(1)).IDOK 28000019
         AIF   (&ID+1 GT &IECCNTR AND &ID LE 99 AND &IECSW(1)).IDOK     29000019
&NCODE   SETB  1                                                        30000019
         MNOTE 12,'ID NOT IN ALLOWED RANGE OR IS OUT OF SEQUENCE'       31000019
         AGO   .IDOK2                                                   32000019
.IDOK    AIF   (NOT (&ID EQ &IECCNTR AND &IECSW(2))).IDOK2              33000019
&NCODE   SETB  1                                                        34000019
&CHAR    SETC  '&ID'                                                    35000019
         MNOTE 12,'DUPLICATE ID = &CHAR'                                36000019
.IDOK2   AIF   (T'&ASGROUP EQ 'O' OR T'&ASGROUP EQ 'M').ASTYPOK         37000019
&NCODE   SETB  1                                                        38000019
&CHAR    SETC  T'&ASGROUP                                               39000019
         MNOTE 12,'ASGROUP TYPE ATTRIBUTE=&CHAR IMPROPER'               40000019
.ASTYPOK AIF ((T'&DEGROUP EQ 'O') OR (N'&DEGROUP EQ 2 AND T'&DEGROUP(1)X41000019
               EQ 'M' AND T'&DEGROUP(2) EQ 'N')).DETYPOK                42000019
&NCODE   SETB  1                                                        43000019
&CHAR    SETC  T'&DEGROUP(1)                                            44000019
&CHARS   SETC  T'&DEGROUP(2)                                            45000019
         MNOTE 12,'DEGROUP TYPE ATTRIBUTE=&CHAR,&CHARS MAY BE IMPROPER X46000019
               OR NUMBER OF SUBOPERANDS NOT 2'                          47000019
.DETYPOK ANOP                                                     21094 47200021
         AIF   (N'&DEGROUP EQ 0).DEOK                             21094 47400021
&A       SETA  &DEGROUP(2)                                        21094 47600021
         AIF   (&A LE 32).DEOK                                    21094 47800021
         MNOTE 12,'NUMBER OF DEUS SPECIFIED IS GREATER THAN 32'   21094 48000021
&NCODE   SETB  1                                                  21094 48200021
.DEOK    ANOP                                                     21094 48400021
         AIF   (&IECSW(2)).SKIP                                   21094 48600021
         SPACE 1                                                        49000019
*                  AREA STATION TABLE                                   50000019
         SPACE 1                                                        51000019
IECASTBL EQU   *                                                        52000019
.SKIP    ANOP                                                           53000019
         AIF   (&NCODE).NOGEN                                           54000019
&CHARS   SETC  '&ASGROUP'                                               55000019
&C       SETA  18                                                       56000019
&A       SETA  &IECCNTR+1                                               57000019
         AIF   (&ID EQ &A AND &ID EQ 1 AND NOT &IECSW(2)).NUTS          58000019
.LOOP    AIF   (&ID EQ &A OR &ID EQ 0).OUT                              59000019
         AIF   (&IECCNTR NE 0 OR &IECSW(7)).PASS                        60000019
.NUTS    ANOP                                                           61000019
&IECCNTR SETA 1                                                         62000019
&A       SETA  0                                                        63000019
.PASS    ANOP                                                           64000019
&CHAR    SETC  '&A'                                                     65000019
         MNOTE *,'ID=&CHAR OMITTED'                                     66000019
         DC    YL1(0)                                                   67000019
&A       SETA  &A+1                                                     68000019
         AGO   .LOOP                                                    69000019
.OUT     ANOP                                                           70000019
&IECSW(7) SETB 1                                                        71000019
&IECCNTR SETA  &ID                                                      72000019
         AIF   ('&ASGROUP' NE '').DC                                    73000019
&C       SETA  0                                                        74000019
&CHARS   SETC  'IECFTGRP'                                               75000019
.DC      DC    YL1((((&CHARS-IECFTGRP)+&C)/18)*4)                       76000019
         AIF   ('&DEGROUP' EQ '').MEND                                  77000019
&A       SETA  &ID+1                                                    78000019
&IECDGRP(&A) SETC '&DEGROUP(1)'                                         79000019
&IECNDGP(&A) SETA &DEGROUP(2)                                           80000019
         AGO   .MEND                                                    81000019
.NOGEN   MNOTE 12,'TEXT GENERATION SUPRESSED'                           82000019
.MEND    ANOP                                                           83000019
&IECSW(2) SETB 1                                                        84000019
         MEND                                                           85000019
