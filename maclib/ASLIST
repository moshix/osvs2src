         MACRO                                                          00500019
&NAME    ASLIST   &OP,&NORM=,&LENGTH=,&DIGIT=,&ENTRY=1,&MSG=,&INQDISP=,X01000021
               &MODULUS=,&SELTRAN=                                      01200021
         GBLA  &IECNDGP(100)                                            01500019
.*             IECNDGP(1)  NO OF BYTES COUNTER                          02000019
.*             IECNDGP(2) NO OF ASLIST OR DEULIST MACROS                02500019
.*             IECNDGP(4)  GLOBAL SAVE FOR NORMAL GUIDENCE AND DEVICE   03000019
         GBLB  &IECDE                                             21094 03200021
         GBLB  &IECSW(9),&IECTXT,&IECSEQ(10),&IECAS               21094 03400021
.*             IECAS   INDICATES ASLIST MACRO CODED               21094 03600021
.*             IECSW(5)  INDICATES NOT FIRST MACRO                      04000019
.*             IECSW(8) SET WHEN MSG TXT APPEARS.INDICATES TO FOLLOWING 04500019
.*               TRLIST OR STEND MACRO THAT AN END OF LIST BYTE         05000019
.*             GENERATED BY THIS MACRO                                  05500019
.*             IECSEQ(5)  SEQUENCE INDICATOR                            06000019
.*             IECTXT  ON WHEN IMPLICIT TEXT ALREADY GENERATED          06070021
         GBLB  &IECIN,&IECINDS                                          06140021
.*             IECIN     INDICATES INQUIRY DISPLAY FOR SYSTEM           06210021
         GBLB  &IECM10,&IECM11                                          06280021
.*             IECM10  INDICATES MODULUS 10 CHECKING IN TRLIST          06350021
.*             IECM11 INDICATES MODULUS 11 CHECKING IN TRLIST           06420021
         LCLA  &A,&B,&C                                                 06500019
         LCLB  &NCODE,&SW(4)                                            07000019
         LCLC  &CHAR                                                    07500019
         ACTR  500                                                      08000019
&IECAS   SETB  1                                                  21094 08200021
&IECSEQ(5) SETB 1                                                       08500019
         AIF   (&IECSEQ(1) AND &IECSEQ(2) AND &IECSEQ(3) AND &IECSEQ(4)-09000019
               AND &IECSEQ(5) AND NOT&IECSEQ(6)).SEQOK                  09500019
.J       ANOP                                                     21094 09700021
         MNOTE 12,'MACRO SEQUENCE ERROR'                                10000019
         MEXIT                                                          10500019
.SEQOK   ANOP                                                           11000019
         AIF   (&IECDE).J                                         21094 11200021
&IECNDGP(2) SETA &IECNDGP(2)+1                                          11500019
         AIF   (&IECNDGP(2) LE 16).NOK                                  12000019
         MNOTE 12,'NO OF ASLIST MACROS EXCEEDS 16'                      12500019
         MEXIT                                                          13000019
.NOK     AIF   ('&OP' EQ 'B' OR '&OP' EQ 'C' OR '&OP' EQ 'M' OR '&OP'  X13500019
               EQ 'O').OPOK                                             14000019
&SW(1)   SETB  1                                                        14500019
&NCODE   SETB  1                                                        15000019
         MNOTE 12,'DEVICE CODE=&OP INVALID'                             15500019
.OPOK    AIF   (T'&NORM EQ 'N').CKRNG                                   16000019
&NCODE   SETB  1                                                        16500019
&CHAR    SETC  T'&NORM                                                  17000019
         MNOTE 12,'REQUIRED OPERAND=NORM TYPE ATTRIBUTE = &CHAR        ?17500019
               IMPROPER'                                                18000019
         AGO   .CKLNGTH                                                 18500019
.CKRNG   ANOP                                                           19000019
&A       SETA  &NORM                                                    19500019
         AIF   (&A GE 1 AND &A LE 31).CKINQD                            20000021
&IECNDGP(4) SETA 0                                                      20500019
&NCODE   SETB  1                                                        21000019
         MNOTE 12,'NORM = &A INVALID'                                   21500019
.CKINQD  ANOP                                                           21510021
         AIF   (T'&INQDISP EQ 'O').CKLNGTH                              21520021
         AIF   (T'&INQDISP EQ 'N').CKINQ1                               21530021
&NCODE   SETB  1                                                        21540021
&CHAR    SETC  T'&INQDISP                                               21550021
         MNOTE 12,'INQDISP OPERAND TYPE ATTRIBUTE=&CHAR IMPROPER'       21560021
         AGO   .CKINQ2                                                  21570021
.CKINQ1  ANOP                                                           21580021
&A       SETA  &INQDISP                                                 21590021
         AIF   (&A GE 1 AND &A LE 31).CKINQ2                            21600021
&NCODE   SETB  1                                                        21610021
         MNOTE 12,'INQDISP=&A INVALID'                                  21620021
.CKINQ2  ANOP                                                           21630021
         AIF   (&IECSW(1)).CKINQ3                                       21640021
&NCODE   SETB  1                                                        21650021
         MNOTE 12,'INQDISP REQUIRES CORE=32 IN CONFIGUR MACRO'          21660021
.CKINQ3  ANOP                                                           21670021
         AIF   (&IECINDS).CKINQ4                                        21680021
&NCODE   SETB  1                                                        21690021
         MNOTE 12,'INQDISP=YES NOT CODED IN TRLIST MACRO FOR THIS      X21700021
               TRANSACTION'                                             21710021
.CKINQ4  ANOP                                                           21720021
         AIF   (&IECIN).CKLNGTH                                         21730021
&NCODE   SETB  1                                                        21740021
         MNOTE 12,'INQDISP REQUIRES INQDISP=YES IN CONFIGUR MACRO'      21750021
         AGO   .CKLNGTH                                                 21760021
.CKLNGTH AIF   (T'&LENGTH EQ 'O').CKDIGIT                               22000019
         AIF   (T'&LENGTH(1) EQ 'N').L1TYPOK                            22500019
&SW(1)   SETB  1  INDICATE LNGTH OP INVALID                             23000019
&CHAR    SETC  T'&LENGTH(1)                                             23500019
         MNOTE 3,'LENGTH=&LENGTH(1) TYPE ATTRIBUTE=&CHAR IMPROPER'      24000019
         AGO   .CKLN2                                                   24500019
.L1TYPOK ANOP                                                           25000019
         AIF   (&SW(1)).CKLN2                                           25500019
&A       SETA  &LENGTH(1)                                               26000019
         AIF   (&A LE 81 AND '&OP' EQ 'C').CKLN2                        26500019
         AIF   (&A LE 7  AND '&OP' EQ 'M').CKLN2                        27000019
         AIF   (&A LE 11 AND ('&OP' EQ 'B' OR '&OP' EQ 'O')).CKLN2      27500019
&SW(1)   SETB  1    INDICATE LENGTH OP INVALID                          28000019
         MNOTE 3,'LENGTH VALUE CODED INVALID FOR DEVICE CODED'          28500019
.CKLN2   AIF   (T'&LENGTH(2) EQ 'N').L2TYPOK                            29000019
&SW(1)   SETB  1                                                        29500019
&CHAR    SETC  T'&LENGTH(2)                                             30000019
         MNOTE 3,'LENGTH=&LENGTH(2) TYPE ATTRIBUTE=&CHAR IMPROPER'      30500019
         AGO   .CKDIGIT                                                 31000019
.L2TYPOK ANOP                                                           31500019
&A       SETA  &LENGTH(2)                                               32000019
         AIF   (&A GE 1 AND &A LE 31).CKDIGIT                           32500019
&SW(1)   SETB  1                                                        33000019
         MNOTE 3,'INVALID LENGTH ERROR GUIDENCE =&A'                    33500019
.CKDIGIT AIF   (T'&DIGIT EQ 'O').CKENTRY                                34000019
         AIF   (T'&DIGIT(1)  EQ 'N' AND T'&DIGIT(2) EQ 'N' AND         X34500019
               T'&DIGIT(3) EQ 'N').LNTYPOK                              35000019
&SW(2)   SETB  1                                                        35500019
         MNOTE 3,'DIGIT=&DIGIT INVALID'                                 36000019
         AGO   .CKENTRY                                                 36500019
.LNTYPOK ANOP                                                           37000019
&A       SETA  &DIGIT(1)                                                37500019
         AIF   (&A GE 1 AND &A LE 15).DLNOK                             38000019
&SW(2)   SETB  1                                                        38500019
         MNOTE 3,'DIGIT=&A INVALID'                                     39000019
.DLNOK   ANOP                                                           39500019
&A       SETA  &DIGIT(2)                                                40000019
         AIF   (&A LE 9).VALOK                                          40500019
&SW(2)   SETB  1                                                        41000019
         MNOTE 3,'VALUE TO BE CHECKED=&A INVALID'                       41500019
.VALOK   ANOP                                                           42000019
&A       SETA  &DIGIT(3)                                                42500019
         AIF   (&A GE 1 AND &A LE 31).CKENTRY                           43000019
&SW(2)   SETB  1                                                        43500019
         MNOTE 3,'GUIDENCE VALUE=&A INVALID'                            44000019
.CKENTRY AIF   ('&ENTRY' EQ '1' OR '&ENTRY' EQ 'M').ENTRYOK             44500019
         MNOTE 3,'ENTRY=&ENTRY INVALID,DEFAULT ASSUMED'                 45000019
.ENTRYOK ANOP                                                           45500019
&SW(3)   SETB  ('&ENTRY' EQ 'M')                                        46000019
         AIF (('&ENTRY' EQ 'M' AND &IECSW(5)) OR '&ENTRY' EQ '1').CKMSG 46500019
&SW(3)   SETB  0                                                        47000019
         MNOTE 3,'ENTRY = M ILLEGAL ON FIRST ASLIST MACRO,DEFAULT      X47500019
               ASSUMED'                                                 48000019
.CKMSG   AIF   (T'&SELTRAN EQ 'O').CKMSG1                         21094 48200021
         AIF   ('&SELTRAN' EQ 'NO' OR '&SELTRAN' EQ 'YES').CKMSG1       48400021
         MNOTE 3,'SELTRAN OPERAND INVALID,OPERAND IGNORED'        21094 48600021
.CKMSG1  AIF   (T'&MSG EQ 'O').CKGEN                              21094 48800021
         AIF   (T'&MSG NE 'O' AND &IECTXT).CKMRMSG                      49000019
&SW(4)   SETB  1                                                        49500019
         AGO   .CKGEN                                                   50000019
.CKMRMSG AIF   ('&MSG'(1,1) EQ '''' AND '&MSG'(K'&MSG,1) EQ '''').MFOK  50500019
         MNOTE 3,'MSG OPERAND IN INCORRECT FORMAT,OPERAND IGNORED'      51000019
&SW(4)   SETB  1                                                        51500019
         AGO   .CKGEN                                                   52000019
.MFOK    ANOP                                                           52500019
&B       SETA  K'&MSG-2                                                 53000019
         AIF   (&B GE 0 AND &B LE 127).CKGEN                            53500019
         MNOTE 3,'MESSAGE LENGTH EXCEEDS 127,OPERAND IGNORED'           54000019
&SW(4)   SETB  1                                                        54500019
.CKGEN   AIF   (NOT &IECSW(8)).CKGEN1                             21094 54600021
&NCODE   SETB  1                                                  21094 54700021
         MNOTE 12,'ASLIST MACRO NOT VALID FOLLOWING IMPLICIT TEXT IN   X54800021
               THIS TRANSACTION'                                  21094 54900021
.CKGEN1  ANOP                                                           55000021
         AIF   (T'&MODULUS EQ 'O').CKGEN2                               55010021
         AIF   (T'&MODULUS(1) EQ 'N' AND T'&MODULUS(2) EQ 'N' AND      X55020021
               T'&MODULUS(3) EQ 'N').MOD1                               55030021
&SW(2)   SETB  1                                                        55040021
         MNOTE 3,'MODULUS=&MODULUS INVALID'                             55050021
         AGO   .CKGEN2                                                  55060021
.MOD1    ANOP                                                           55070021
&A       SETA  &MODULUS(1)                                              55080021
         AIF   (&A GE 2 AND &A LE 16).MOD2                              55090021
&SW(2)   SETB  1                                                        55100021
         MNOTE 3,'MODULUS POSITION = &A INVALID'                        55110021
.MOD2    ANOP                                                           55120021
&A       SETA  &MODULUS(2)                                              55130021
         AIF   (&A GE 1 AND &A LE 15).MOD3                              55140021
&SW(2)   SETB  1                                                        55150021
         MNOTE 3,'MODULUS LENGTH = &A INVALID'                          55160021
.MOD3    ANOP                                                           55170021
&A       SETA  &MODULUS(3)                                              55180021
         AIF   (&A GE 1 AND &A LE 31).CKGEN2                            55190021
&SW(2)   SETB  1                                                        55200021
         MNOTE 3,'MODULUS GUIDANCE VALUE = &A INVALID'                  55210021
.CKGEN2  ANOP                                                           55220021
         AIF   (T'&MODULUS EQ 'O').CKGEN5                               55230021
         AIF   (T'&DIGIT EQ 'O').CKGEN3                                 55240021
&NCODE   SETB  1                                                        55250021
         MNOTE 12,'MODULUS AND DIGIT OPERANDS MUTUALLY EXCLUSIVE'       55260021
.CKGEN3  ANOP                                                           55270021
         AIF   (&IECSW(1)).CKGEN4                                       55280021
&NCODE   SETB  1                                                        55290021
         MNOTE 12,'MODULUS OPERAND NOT VALID UNLESS CORE=32 IN CONFIGURX55300021
               MACRO'                                                   55310021
.CKGEN4  ANOP                                                           55320021
         AIF   (&IECM10 OR &IECM11).CKGEN5                              55330021
&NCODE   SETB  1                                                        55340021
         MNOTE 12,'MODULUS OPERAND REQUIRES THAT EITHER DEMOD10=YES OR X55350021
               DEMOD11=YES BE CODED IN TRLIST'                          55360021
.CKGEN5  ANOP                                                           55370021
         AIF   (T'&DIGIT EQ 'O').CKGEN6                                 55380021
         AIF   (&IECM10 OR &IECM11).ERROR1                              55390021
         AGO   .CKGEN6                                                  55400021
.ERROR1  ANOP                                                           55410021
&NCODE   SETB  1                                                        55420021
         MNOTE 12,'DIGIT OPERAND CAN NOT BE CODED IF DEMOD10=YES OR    X55430021
               DEMOD11=YES IN TRLIST MACRO'                             55440021
.CKGEN6  ANOP                                                           55450021
         AIF   (NOT &NCODE).GENCODE                                     55460021
         MNOTE 12,'TEXT GENERATION SUPRESSED'                           55500019
         AGO   .SET                                                     56000019
.GENCODE ANOP                                                           56500019
&B       SETA  0                                                        57000019
         AIF   (NOT &IECSW(5)).SKIP                                     57500019
&B       SETA  X'80'                                                    58000019
.SKIP    ANOP                                                           58500019
&A       SETA  &NORM                                                    59000019
         AIF   ('&OP' EQ 'B').DC                                        59500019
&B       SETA  &B+X'20'                                                 60000019
         AIF   ('&OP' EQ 'C').DC                                        60500019
&B       SETA  &B+X'20'                                                 61000019
         AIF   ('&OP' EQ 'M').DC                                        61500019
&B       SETA  &B+X'20'                                                 62000019
.DC      DC    YL1(&B+&A)  NORMAL GUIDENCE AND DEVICE INDICATOR         62500019
&C       SETA  &B    SAVE DEVICE INDICATOR                              63000019
         AIF   (&IECSW(5)).SKP1                                         63500019
&IECNDGP(4) SETA &B+&A                                                  64000019
.SKP1    ANOP                                                           64500019
         AIF   (T'&SELTRAN EQ 'O').NOSEL                          21094 64600021
         AIF   ('&SELTRAN' NE 'YES').NOSEL                        21094 64700021
         AIF   (NOT &IECSW(5)).NOSEL                             A43765 64750021
&IECNDGP(4) SETA 0                                                21094 64800021
.NOSEL   ANOP                                                     21094 64900021
&A       SETA  0                                                        65000019
&B       SETA  0                                                        65500019
         AIF   (T'&DIGIT EQ 'O' OR &SW(2)).DCZRO                        66000019
&A       SETA  &DIGIT(1)                                                66500019
&B       SETA  &DIGIT(2)                                                67000019
.DCZRO   ANOP                                                           67500021
         AIF   (T'&MODULUS EQ 'O' OR &SW(2)).DCZRO4                     67580021
&A       SETA  &MODULUS(1)-1                                            67660021
&B       SETA  &MODULUS(2)                                              67740021
.DCZRO4  ANOP                                                           67820021
         DC    YL1(&A*16+&B) DIGIT OR MODULUS POSITION AND VALUE OR NUL 67900021
&A       SETA  0                                                        68000019
.NXT     AIF   (T'&LENGTH EQ 'O' OR &SW(1)).DCZRO1                      68500019
&A       SETA  &LENGTH(1)                                               69000019
.DCZRO1  DC    YL1(X'80'*&SW(3)+&A)  LENGTH OR NULL                     69500019
&A       SETA  0                                                        70000019
&B       SETA  0                                                        70500019
.SKIP1   AIF   (T'&DIGIT EQ 'O' OR &SW(2)).DCZRO2                       71000019
&A       SETA  &DIGIT(3)                                                71500019
&B       SETA  &C                                                       72000019
         AIF   (NOT &IECSW(5)).DCZRO2                                   72500019
&B       SETA  &B-X'80'                                                 73000019
.DCZRO2  ANOP                                                           73500021
         AIF   (T'&MODULUS EQ 'O' OR &SW(2)).DCZRO5                     73560021
&A       SETA  &MODULUS(3)                                              73620021
&B       SETA  &C                                                       73680021
         AIF   (NOT &IECSW(5)).DCZRO5                                   73740021
&B       SETA  &B-X'80'                                                 73800021
.DCZRO5  ANOP                                                           73860021
         DC    YL1(X'80'+&B+&A) DIGIT OR MODULUS ERROR GUIDANCE         73920021
&A       SETA  0                                                        74000019
&B       SETA  0                                                        74500019
.SKIP2   AIF   (T'&LENGTH EQ 'O' OR &SW(1)).DCZRO3                      75000019
&A       SETA  &LENGTH(2)                                               75500019
&B       SETA  &C                                                       76000019
         AIF   (NOT &IECSW(5)).DCZRO3                                   76500019
&B       SETA  &B-X'80'                                                 77000019
.DCZRO3  DC    YL1(X'80'+&B+&A)  LENGTH ERROR GUIDANCE                  77500019
         AIF   (T'&INQDISP NE 'N').SKP                                  77550021
&B       SETA  &INQDISP                                                 77600021
         DC    YL1(&B)                                                  77650021
         DC    YL1(0)                                                   77700021
         DC    X'80'                                                    77750021
         DC    YL1(0)                                                   77800021
         DC    YL1(&IECNDGP(4))                                         77850021
&IECNDGP(1) SETA &IECNDGP(1)+5                                          77900021
.SKP     ANOP                                                           77950021
&B       SETA  0                                                        78000019
         AIF   (T'&MSG EQ 'O' OR &SW(4)).SET                            78500019
&IECSW(8) SETB 1                                                        79000019
         DC    YL1(&IECNDGP(4))  END OF LIST BYTE                       79500019
&B       SETA  K'&MSG-2                                                 80000019
         DC    YL1(&B)  LENGTH OF MSG TEXT                              80500019
         DC    C&MSG                                                    81000019
&B       SETA  &B+1                                                     81500019
&IECTXT  SETB  0  RESET TO PREVENT ASLIST  EXPANSION FOLLOWING MSG TXT  82000019
.SET     ANOP                                                           82500019
&IECSW(5) SETB 1                                                        83000019
&IECNDGP(1) SETA &IECNDGP(1)+5+&B                                       83500019
.MEND    MEND                                                           84000019
