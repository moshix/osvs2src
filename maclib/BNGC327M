         PRINT OFF                                                      00050000
         MACRO                                                          00100000
&NAME    BNGHJN &LABEL,&HJN                                             00150000
         LCLA  &K                                                       00200000
         LCLC  &HJA,&HJB,&HJC                                           00250000
&HJC     SETC  'PTF NO.'                                                00300000
&K       SETA  K'&SYSPARM                                               00350000
         AIF   (&K LT 4).CODE                                           00400000
&HJA     SETC  '&SYSPARM'(1,4)                                          00450000
         AIF   (&K LT 8).CODE                                           00500000
&HJB     SETC  '&SYSPARM'(5,4)                                          00550000
         AIF   (&K LT 15).CODE                                          00600000
&HJC     SETC  '&SYSPARM'(9,7)                                          00650000
.CODE    ANOP                                                           00700000
         AIF   ('&LABEL' EQ '').NOBRNCH                                 00750000
         B     &LABEL .                 BR AROUND CONSTANTS             00800000
         SPACE 2                                                        00850000
.NOBRNCH ANOP                                                           00900000
         AIF   ('&NAME' EQ '').NOLABEL                                  00950000
         DC    C'&NAME' .              MODULE IDENTIFIER                01000000
.NOLABEL ANOP                                                           01050000
         AIF   ('&HJA' EQ '').NEXT                                      01100000
         DC    X'&HJA' .                DATE OF MODIFICATION            01150000
.NEXT    ANOP                                                           01200000
         AIF   ('HJB' EQ '').DATE                                       01250000
         AIF   ('&HJN' NE 'HJN').DATE                                   01300000
         DC    X'&HJB' .                HJN OF MODIFICATION             01350000
.DATE    ANOP                                                           01400000
         DC    C'&HJC' .                PTF LEVEL                       01450000
.NOPTF   ANOP                                                           01500000
         AIF   ('&LABEL' EQ '').NOLBL                                   01550000
         SPACE 2                                                        01600000
&LABEL   DS    0H                                                       01650000
.NOLBL   ANOP                                                           01700000
         MEND                                                           01750000
         PRINT ON                                                       01800000
*********************************************************************** 01850000
*                                                                     * 01900000
* MODULE NAME = BNGC3270                                              * 01950000
*                                                                     * 02000000
* DESCRIPTIVE NAME = CICS DEMF 3270 DISPLAY MODULE                    * 02050000
*                                                                     * 02100000
* COPYRIGHT = NONE                                                    * 02150000
*                                                                     * 02200000
* STATUS = RELEASE 1, LEVEL 1                                         * 02250000
*                                                                     * 02300000
* FUNCTION = 1) RECEIVES CONTROL FROM BNGCDISP;                       * 02350000
*            2) HANDLES 3270 DISPLAY TERMINAL ERROR INFORMATION       * 02400000
*               REQUEST AND BITS PROMPTER REQUEST;                    * 02450000
*            3) ACCESSES SYS1.DEMFLOG DATA FILE AND COLLECTS THE      * 02500000
*               REQUESTED 3270 ERROR INFORMATION FROM IT;             * 02550000
*            4) FORMS OUTPUT MESSAGE WITH DISPLAY FORMAT AND WRITES   * 02600000
*               IT TO THE 3270 DISPLAY TERMINAL; (ERR INFO AND SOME   * 02650000
*               OF DISPLAY MESSAGES)                                  * 02700000
*            5) RETURNS CONTROL TO CICS.                                02750000
*                                                                     * 02800000
* NOTES = NONE                                                        * 02850000
*                                                                     * 02900000
*    DEPENDENCIES =                                                   * 02950000
*                                                                     * 03000000
*    THE FOLLOWING ARE CICS TABLES/CONTROL BLOCKS AND THEIR LABELS    * 03050000
*    USED BY DEMF CICS MODULES (BNGCDISP,BNGC3270,BNGCLOCL,BNGCRMOT   * 03100000
*    BNGCMENU) :                                                      * 03150000
*                                                                     * 03200000
*    CICS TABLE AND                                                   * 03250000
*    CONTROL BLOCKS                  LABELS USED                      * 03300000
*    ----------------------          -----------                      * 03350000
*                                                                     * 03400000
*    COMMON SYSTEM AREA              CSATCTBA                         * 03450000
*    (CSA)                                                            * 03500000
*                                                                     * 03550000
*    TERMINAL CONTROL TABLE          TCTTEDA                          * 03600000
*    TERMINAL ENTRY (TCTTE)          TCTTETM                          * 03650000
*                                    TCTTELT                          * 03700000
*                                    TCTTETI                          * 03750000
*                                    TCTTECLT                         * 03800000
*                                    TCTTETEL                         * 03850000
*                                    TCTTETT                          * 03900000
*                                    TCTTEGU                          * 03950000
*                                    TCTTETA                          * 04000000
*                                                                     * 04050000
*    TERMINAL CONTROL TABLE          TCTLELF                          * 04100000
*    LINE ENTRY (TCTLE)              TCTLEFAA                         * 04150000
*                                    TCTLEPI                          * 04200000
*                                    TCTLEMFP                         * 04250000
*                                    TCTLEPA                          * 04300000
*                                    TCTLEDCB                         * 04350000
*                                    TCTLERLN                         * 04400000
*                                                                     * 04450000
*    TERMINAL INPUT/OUTPUT AREA      TIOADBA                          * 04500000
*    (TIOA)                          TIOATDL                          * 04550000
*                                                                     * 04600000
*    TASK CONTROL AREA               TCAFCAAA                         * 04650000
*    (TCA)                           TCAFCAA                          * 04700000
*                                    TCAPCPI                          * 04750000
*                                    TCASCSA                          * 04800000
*                                                                     * 04850000
*    FILE INPUT/OUTPUT AREA          FIOADBA                          * 04900000
*    (FIOA)                                                           * 04950000
*                                                                     * 05000000
*    RESTRICTIONS = NONE                                              * 05050000
*                                                                     * 05100000
*    REGISTER CONVENTIONS = R12 ADDRESS OF TCA                        * 05150000
*                           R13 ADDRESS OF CSA                        * 05200000
*                                                                     * 05250000
*    PATCH LABEL = PATCH                                       @OX21950 05300000
*                                                                     * 05350000
* MODULE TYPE = COCS DISPLAY                                          * 05400000
*                                                                     * 05450000
*    PROCESSOR = ASSEMBLER H                                          * 05500000
*                                                                     * 05550000
*    MODULE SIZE = 6976 DECIMAL BYTES                                 * 05600000
*                                                                     * 05650000
*    ATTRIBUTES = QUASI-REENTRANT                                     * 05700000
*                                                                     * 05750000
* ENTRY POINT = BNGC3270                                              * 05800000
*                                                                     * 05850000
*    PURPOSE = SEE FUNCTION                                           * 05900000
*                                                                     * 05950000
*    LINKAGE = R1  LOADED WITH THE PARAM LIST POINTER                 * 06000000
*              R14 LOADED WITH THE RETURN ADDR (USED BY SUBROUTINE)   * 06050000
*              R15 LOADED WITH ENTRY POINT                            * 06100000
*                                                                     * 06150000
* INPUT = PARAM LIST ITEMS USED ARE : INPUT TIOA AT BEGINNING OF PGM  * 06200000
*                                                                     * 06250000
* OUTPUT = PARAM LIST ITEMS USED ARE : OUTPUT TIOA AT LABEL - GETTIOA * 06300000
*                                                                     * 06350000
* EXIT-NORMAL = REGISTER 15 RETURN CODE RETURNED TO CALLER :          * 06400000
*               00 - OPERATION PERFORMED AS REQUESTED                 * 06450000
*                                                                     * 06500000
* EXIT-ERROR  = NONE                                                  * 06550000
*                                                                     * 06600000
* EXTERNAL REFERENCE = NONE                                           * 06650000
*                                                                     * 06700000
*    ROUTINES = LOCATE ROUTINE                                        * 06750000
*               GETTIOA ROUTINE (GET TERMINAL OUTPUT AREA)            * 06800000
*               BUOBR ROUTINE (BLOW-UP OBR ROUTINE)                   * 06850000
*               BUMDR ROUTINE (BLOW-UP MDR ROUTINE)                   * 06900000
*                                                                     * 06950000
*    DATA AREAS =  TWA (300 BYTES)                                    * 07000000
*                                                                     * 07050000
*    CONTROL BLOCK = DFHCSADS, DFHTCTLE, DFHTCTTE, DFHTCADS,          * 07100000
*                    DFHTIOA, DFHFIOA                                 * 07150000
*                                                                     * 07200000
* TABLES = CALENDAR - CONVERT JULIAN DATE TO GREGORIAN DATE TABLE     * 07250000
*          LEAPTBL  - LEAP YEAR CALCULATION TABLE                     * 07300000
*          CCWTABL  - CONVERT 270X COMMAND CODE INTO ENGLISH          * 07350000
*          CSWTABL  - CONVERT LOCAL 327X STATUS OR 270X LINE STATUS   * 07400000
*                     INTO ENGLISH                                    * 07450000
*          SENSTABL - CONVERT 270X LINE SENSE CODE INTO ENGLISH       * 07500000
*          STATSTBL - CONVERT REMOTE 327X STATUS CODE INTO ENGLISH    * 07550000
*          SENS3272 - CONVERT LOCAL 327X SENSE CODE INTO ENGLISH      * 07600000
*          CCW3272  - CONVERT LOCAL 327X COMMAND CODE INTO ENGLISH    * 07650000
*          TPOPTBL  - CONVERT BTAM TP OP CODE INTO ENGLISH            * 07700000
*          CICSPTOP - CONVERT TCAM TP OP CODE INTO ENGLISH            * 07750000
*          HXTOEB   - HEX CHARS TO EBCDIC CHARS TABLE                 * 07800000
*          EBTOHX   - EBCDIC CHARS TO HEX CHARS TABLE                 * 07850000
*                                                                     * 07900000
* MACROS = DCBD, DFHPC, DFHSC, DFHTC, DFHPC                           * 07950000
*                                                                     * 08000000
* CHANGE ACTIVITIES AS FOLLOWS:                                       * 08050000
* CHANGE 01  11/15/77  PROLOGUE ADDED                                 * 08100000
* CHANGE 02  02/27/78  BNGHJN MACRO ADDED                             * 08150000
*A110800,246000                                                @OZ30480 08200000
*A192000,374800,414000                                         @OZ31885 08250000
*C384000-384800                                                @OX21950 08300000
*A472800                                                       @OX21950 08350000
*C132400,167600,192800,346400                                  @OX22095 08400000
*A160000,161200,354800                                         @OX22095 08450000
*DUMMY APAR TO CORRECT PREREQ STRINGS ON PREVIOUS PTF'S        @OZ36693 08500000
*A230000                                                       @OZ38643 08550000
*A302000                                                       @OZ40264 08600000
*A149405-149465                                                @OX25492 08650000
*A203625-203875                                                @OX27899 08675000
*********************************************************************** 08700000
BNGC3270 TITLE 'DISPLAY 3270 MDR AND OBR ENTRIES'                       08750000
R1       EQU   1                                                        08800000
BASE1    EQU   2                   1ST PROGRAM BASE REG.                08850000
BASE2    EQU   3                   2ND PROGRAM BASE REG.                08900000
TCTTEAR  EQU   4                   TCT TERML ENTRY REG.                 08950000
TIOABAR  EQU   5                   TIOA POINTER.                        09000000
FIOABAR  EQU   6                   FIOA POINTER.                        09050000
DATAREG  EQU   7                   POINTER TO DATA IN EMF FILE BLOCK.   09100000
DATALOOP EQU   8                   LOOP REG FOR PROCESSING WITH DATAREG 09150000
OUTREG   EQU   9                   POINTER TO VARIABLE AREA IN TIOA.    09200000
OUTLOOP  EQU   10                  LOOP REG FOR PROCESSING WITH OUTREG. 09250000
LINKREG  EQU   11                  LINKAGE TO COMMON SUBROUTINES.       09300000
R15      EQU   15                                                       09350000
SBA      EQU   X'11'                                                    09400000
SF       EQU   X'1D'                                                    09450000
IC       EQU   X'13'                                                    09500000
UNA      EQU   X'40'                                                    09550000
UHA      EQU   X'C8'                                                    09600000
PNA      EQU   X'60'                                                    09650000
PDA      EQU   X'E8'                                                    09700000
PIA      EQU   X'6D'                                                    09750000
MNP      EQU   X'61'                                                    09800000
L2P1     EQU   X'C150'                                                  09850000
L3P1     EQU   X'C260'                                                  09900000
L1P1     EQU   X'4040'                                                  09950000
L5P1     EQU   X'C260'                                                  10000000
L1P36    EQU   X'40E3'                                                  10050000
L4P1     EQU   X'C3F0'                                                  10100000
L1P7     EQU   X'40C6'                                                  10150000
L3P39    EQU   X'C1F6'                                                  10200000
L2P79    EQU   X'C25E'                                                  10250000
L2P1LG   EQU   X'C150'                                                  10300000
L3P1LG   EQU   X'C260'                                                  10350000
L4P1LG   EQU   X'C3F0'                                                  10400000
L1P1SM   EQU   X'4040'                                                  10450000
L2P1SM   EQU   X'40E8'                                                  10500000
L3P1SM   EQU   X'C150'                                                  10550000
L4P1SM   EQU   X'C1F8'                                                  10600000
L6P26    EQU   X'C6E9'                                                  10650000
         PRINT OFF                                                      10700000
         COPY  DFHCSADS                                                 10750000
         COPY  DFHTCTLE                                                 10800000
         COPY  DFHTCTTE                                                 10850000
         COPY  DFHTCADS                                                 10900000
         PRINT ON                                                       10950000
PARM1    DS    D                   1ST INPUT FIELD.                     11000000
PARM2    DS    D                   2ND INPUT FIELD.                     11050000
PARM3    DS    D                   3RD INPUT FIELD.                     11100000
PARM4    DS    D                   4TH INPUT FIELD.                     11150000
PARM5    DS    D                   5TH INPUT FIELD.                     11200000
PARM6    DS    D                   6TH INPUT FIELD.                     11250000
TWASBAS  DS    PL1                 COUNT OF SBA'S IN INPUT MSG.         11300000
TWAREL   DS    CL3                 FILE CONTROL RELATIVE BLK ADDR.      11350000
TWALINE  DS    F                   ADDR OF OUR TCTLE                    11400000
DUBLWD   DS    D                   WORK AREA.                           11450000
TWATIOA  DS    F                   SAVE INPUT ADDRESS.                  11500000
TWATCTID DS    F                   SAVE TERML ID.                       11550000
TWASLOT  DS    F                   SLOT COUNTER.                        11600000
SAVE14   DS    F                   SAVE AREA.                           11650000
TWAOUT   DS    F                   SAVE OUTPUT HDR ADDR                 11700000
LINESZ   DS    H                   LINE SIZE (3277 MOD 1 OR MOD 2)      11750000
LINELOOP DS    H                   NBR LINE ITEMS PER LINESZ.           11800000
OUTSWCH  DS    C                                                        11850000
HXLINLIB DS    0CL6                LINE ADDRESS INCLUDING               11900000
         DS    C                                                        11950000
HEXLINE  DS    CL2                      VTAM LIB ADDR                   12000000
HEXLIB   DS    CL3                      IN HEX FORMAT.                  12050000
HEXCTRL  DS    C                   CTRL UNIT POLL CHAR.                 12100000
HEXTERM  DS    C                   TERML POLL CHAR.                     12150000
NEWFIRST DS    CL5                 SAVE AREA FOR OLD BLK & SLOT NBR.    12200000
NEWPREV  DS    CL5                 SAVE AREA FOR OLD BLK & SLOT NBR.    12250000
SAVETERM DS    CL8                 TERMINAL SAVE AREA FOR 'NO ERR' MSG  12300000
SAVECU   DS    CL8                 CTRL UNIT SAVE AREA FOR 'NO ERR' MSG 12350000
SAVELINE DS    CL8                 LINE SAVE AREA FOR 'NO ERR' MSG      12400000
SAVEID   DS    CL20                CICS SYMBOLIC ID FOR 'NO ERR' MSG    12450000
BITFIRST DS    CL5                 FIRST BBBSS                          12500000
BITLAST  DS    CL5                 SECOND BBBSS                         12550000
BITPREV  DS    CL5                 THIRD BBBSS                          12600000
DATDATE  DS    CL4                 DATE OF ERROR - 00YYDDDF             12650000
DATTIME  DS    CL4                 TIME OF ERROR - HHMMSSHH             12700000
DATASLOT DSECT                                                          12750000
         USING *,DATAREG                                                12800000
DATALTH  DS    C                   LTH OF THIS SLOT                     12850000
LINEID   DS    CL6                 LINE AND LIB ADDR                    12900000
ENTRYTYP DS    C                   ENTRY TYPE - MDR OR OBR              12950000
         DS    CL3                                                      13000000
MDRTYPE  DS    C                   TYPE HDWE - 03 EQUALS 3270           13050000
         DS    CL3                                                      13100000
DATE     DS    CL4                 DATE OF ERROR - 00YY0DDF             13150000
TIME     DS    CL4                 TIME OF ERROR - HHMMSSHH             13200000
         DS    CL8                                                      13250000
MDRCUA   DS    CL2                 MDR CHAN & UNIT ADDR                 13300000
MDRCTRL  DS    C                   MDR CTRL UNIT POLL ADDR              13350000
MDRTERM  DS    C                   MDR TERMIL POLL ADDR                 13400000
MDRSTATS DS    CL2                 REMOTE 3270 STATUS                   13450000
         DS    CL2                                                      13500000
OBRCCW   DS    CL8                 LAST CCW EXECUTED                    13550000
OBRCSW   DS    CL8                 CHANNEL STATUS WORD                  13600000
         DS    CL6                                                      13650000
OBRUCB   DS    C                                                        13700000
         DS    CL3                                                      13750000
OBRCUA   DS    CL2                 OBR CHAN & UNIT ADDR                 13800000
OBRCTRL  DS    C                                                        13850000
OBRTERM  DS    C                                                        13900000
         DS    CL12                                                     13950000
OBRSENSE DS    CL2                 OBR SENSE BYTES                      14000000
         ORG   DATALTH                                                  14050000
CTRLPORT DS    CL6                 PORT & LIB ADDRESS                   14100000
         DS    CL4                                                      14150000
CTRLFRST DS    CL3                 REL BLK ADDR 1ST BLK IN CHAIN.       14200000
         DS    CL3                                                      14250000
SLOTLTH  EQU   *-CTRLPORT                                               14300000
         COPY  DFHTIOA                                                  14350000
SBA1     DS    CL3                 1ST SBA POSITION.                    14400000
CODE     DS    CL4                 TRANS CODE.                          14450000
SBA2     DS    CL3                 2ND SBA                              14500000
PGRM     DS    CL4                 PROGRAM NAME.                        14550000
SBA3     DS    CL3                 3RD SBA.                             14600000
FLP      DS    CL15                FIRST/LAST/PREVIOUS IF BLOWUP RQST.  14650000
SBA4     DS    CL3                 4TH SBA.                             14700000
BUX      DS    CL4                 X FOR BLOWUP REQUEST.                14750000
TIOITEM  DS    CL5                 ITEM ADDRESS TO BLOWUP.              14800000
         ORG   FLP                 START OF BBBSS AREAS                 14850000
         DS    C                   FOR FORWARD AND BACKWARD REQUST      14900000
         DS    CL3                 4TH SBA FOR BBBSS                    14950000
TIOFIRST DS    CL5                 FIRST BBBSS AREA                     15000000
TIOLAST  DS    CL5                 LAST BBBSS AREA                      15050000
TIOPREV  DS    CL5                 PREVIOUS BBBSS AREA                  15100000
         COPY  DFHFIOA                                                  15150000
CTRLLAST DS    F                   LAST USED ADDR IN DATASET            15200000
CTRLTOTL DS    F                   TOTAL BLOCKS IN DATASET              15250000
CTRLBACK DS    F                   BACKWARD PTR IN CTRL BLK CHAIN       15300000
CTRLFWD  DS    F                   FORWARD PTR IN CTRL BLK CHAIN        15350000
CTRLENTS DS    C                   NBR ENTRIES IN THIS CTRL BLK         15400000
         DS    CL15                FOR FUTURE USE                       15450000
CTRLSLT1 DS    0C                  START OF CTRL SLOT NBR ONE.          15500000
         ORG   FIOADBA                                                  15550000
DATAPORT DS    CL6                 PORT & LIB ADDR                      15600000
DATATIME DS    CL4                 TIME BLOCK CREATED                   15650000
DATADATE DS    CL4                 DATE BLOCK CREATED                   15700000
DATAFWD  DS    CL3                 FORWARD CHAIN ADDR                   15750000
DATABACK DS    CL3                 BACKWAD CHAIN ADDR                   15800000
BLKLTH   DS    CL2                 NBR BYTES USED IN THIS BLOCK         15850000
         DS    CL10                                                     15900000
DATASLT1 DS    0C                  START OF 1ST DATA SLOT               15950000
BNGC3270 CSECT                                                          16000000
         BALR  BASE1,0                                                  16050000
         USING *,BASE1,BASE2                                            16100000
BNGC3270 BNGHJN SKIPID                                         @OZ30480 16150000
         LA    BASE2,2048(BASE1)   SETUP PROGRAM BASE REGS.             16200000
         LA    BASE2,2048(BASE2)                                        16250000
         L     TCTTEAR,TCAFCAAA    POINT TO TCT TERML ENTRY.            16300000
         LA    TCTTEAR,0(TCTTEAR)  CLEAR HIGH ORDER BYTE FROM ADDR      16350000
         L     TIOABAR,TCTTEDA     POINT TO TIOA INPUT AREA.            16400000
A005     CP    TWASBAS,=P'2'       WERE LESS THAN 2 FIELDS INPUT?       16450000
         BNL   J010                NO. GO EXAMINE INPUT FURTHER.        16500000
A010     XC    TWAREL,TWAREL       YES. THIS IS A NEW RECAP REQUEST.    16550000
         CLC   PARM3(3),=C'ALL'    IF PARM 3 IS ONE OF THE DEMF         16600000
         BE    A140                DISPLAY CODES, THIS INPUT WAS FROM   16650000
         CLC   PARM3(4),=C'CTRL'          FORMATTED SCREEN.             16700000
         BE    A140                ZERO IT OUT AND TRY AGAIN.           16750000
         CLC   PARM3(4),=C'LINE'                                        16800000
         BE    A140                                                     16850000
         CLC   PARM3(4),=C'3270'                                        16900000
         BE    A140                                                     16950000
         CLC   PARM4(3),=C'ALL'                                         17000000
         BE    A130                                                     17050000
         CLC   PARM4(4),=C'CTRL'                                        17100000
         BE    A130                                                     17150000
         CLC   PARM4(4),=C'LINE'                                        17200000
         BE    A130                                                     17250000
         CLC   PARM4(4),=C'3270'                                        17300000
         BE    A130                                                     17350000
         CLC   PARM5(3),=C'ALL'                                         17400000
         BE    A120                                                     17450000
         CLC   PARM5(4),=C'CTRL'                                        17500000
         BE    A120                                                     17550000
         CLC   PARM5(4),=C'LINE'                                        17600000
         BE    A120                                                     17650000
         CLC   PARM5(4),=C'3270'                                        17700000
         BE    A120                                                     17750000
         OC    PARM3,PARM3         WAS LINE ID INPUT?                   17800000
         BNZ   B140                YES. GO SEARCH CTRL BLK FOR IT.      17850000
         TM    TCTEAMIB,TCTEVTAM    IS THIS FROM A VTAM TERM?           17900000
         BO    A110                 YES. CAN'T HONOR REQUEST.           17950000
         L     14,CSATCTBA         POINT TO TCT PREFIX.                 18000000
         L     14,4(14)            POINT TO BTAM ADCON LIST.            18050000
A030     CLC   0(4,14),=X'FFFFFFFF'  ANY MORE LINES TO LOOK AT?         18100000
         BE    S190                NO. SEND 'INVALID INPUT' MSG.        18150000
         L     1,0(14)             POINT TO A LINE.                     18200000
         ST    1,TWALINE           STORE ADDR IN CASE THIS IS IT.       18250000
         TM    TCTLELF,TCTLEFAA    IS THIS A POOLED LINE?               18300000
         BZ    A090                NO.                                  18350000
         TM    TCTLEPI,TCTLEMFP    YES. IS IT 1ST IN POOL?              18400000
         BZ    A150                NO. SKIP IT - DOESN'T POINT TO DCB.  18450000
A090     L     15,TCTLEPA          YES. POINT TO 1ST TERML.             18500000
A100     CLC   TCTTETI,0(15)       IS THIS OUR TERML?                   18550000
         BE    A170                YES. HAVE LOCATED ITS LINE ENTRY.    18600000
         TM    (TCTTELT-TCTTETI)(15),TCTTECLT  LAST TERML ON LINE?      18650000
         BO    A150                YES. GO LOOK AT NEXT LINE.           18700000
         AH    15,(TCTTETEL-TCTTETI)(15)  BUMP TO NEXT TERML.           18750000
         B     A100                                                     18800000
A110     BAL   LINKREG,D090             GET IOAREA FOR MSG     @OX22095 18850000
         MVC   TIOATDL(VTAMLTH),VTAMMSG                        @OX22095 18900000
         MVC   TIOATDL+(VTAMID-VTAMMSG)(4),TCTTETI                      18950000
         B     D170                                                     19000000
VTAMMSG  DC    AL2(VTAMLTH-4),X'0000'                                   19050000
         DC    CL10'BNG010I C '                                         19100000
VTAMID   DC    CL8' ',CL21' IS A VTAM TERMINAL. '                       19150000
         DC    CL39'FOR INQUIRY,GIVE DEMF HARDWARE ADDRESS.'            19200000
VTAMLTH  EQU   *-VTAMMSG                                                19250000
A120     XC    PARM5,PARM5                                              19300000
         B     A010                                                     19350000
A130     XC    PARM4(16),PARM4                                          19400000
         B     A010                                                     19450000
A140     XC    PARM3(24),PARM3     ZERO OUT PARMS 3, 4, AND 5.          19500000
         B     A010                                                     19550000
A150     LA    14,4(14)            BUMP TO NEXT LINE ADDRESS.           19600000
         B     A030                                                     19650000
A170     EQU   *                                                        19700000
         L     1,TWALINE           POINT TO THIS TERML'S LINE.          19750000
         L     14,TCTLEDCB         POINT TO THE DCB.                    19800000
         USING IHADCB,14                                                19850000
         DCBD                                                           19900000
BNGC3270 CSECT                                                          19950000
         SR    15,15                                                    20000000
         TM    TCTTETT,X'60'       IS THIS A LOCAL DEVICE?     @OX25587 20050000
         BNZ   NOTLOCL1            NO. GET NBR. FROM LE.       @OX25587 20100000
         TM    TCTTETT,X'98'       IS THIS A LOCAL DEVICE?     @OX25587 20150000
         BO    A200                YES. GET LINE NBR FROM TE.  @OX25587 20200000
NOTLOCL1 IC    15,TCTLERLN         NO. GET LINE NBR FROM LE.   @OX25587 20250000
         B     A210                                                     20300000
A200     IC    15,TCTTEGU                                               20350000
         LTR   15,15               DID WE GET A RLN?           @OX27899 20362500
         BNZ   A210                YES, USE IT                 @OX27899 20375000
         LA    15,1(0)             NO, MUST BE TCAM SET TO ONE @OX27899 20387500
A210     L     1,DCBDEBAD          POINT TO THE DEB.                    20400000
         LA    1,32(1)             POINT TO LIST OF UCBS.               20450000
A220     BCT   15,A230                                                  20500000
         B     A250                                                     20550000
A230     LA    1,4(1)              BCT TO APPROPRIATE RLN UCB.          20600000
         B     A220                                                     20650000
A250     L     1,0(1)              POINT TO THE UCB.                    20700000
         MVC   PARM3(3),13(1)      MOVE LINEID TO INPUT PARM FIELD.     20750000
         TM    TCTTETT,X'60'       IS THIS A LOCAL DEVICE?     @OX25587 20800000
         BNZ   NOTLOCL2            YES, NOT LOCAL              @OX25587 20850000
         TM    TCTTETT,X'98'       IS THIS A LOCAL 3270?       @OX25587 20900000
         BO    B130                YES. BYPASS POLL CHARS.     @OX25587 20950000
NOTLOCL2 L     14,TCTTETA          POINT TO ADDRESSING LIST.   @OX25587 21000000
         UNPK  DUBLWD,0(2,14)      GET CTRL UNIT ADDRESS.               21050000
         TR    DUBLWD,HXTOEB       CONVERT IT TO 2 EBCDIC CHARS.        21100000
         MVC   PARM4(2),DUBLWD+5   MOVE THEM TO INPUT PARM FIELD.       21150000
         NI    PARM4,X'FD'         CONVERT REMOTE CU TO ACTUAL CU NUM   21200000
         CLI   0(14),X'61'         SPECIAL CASE                @OX25492 21250000
         BNE   TESTF0              NO, CHECK AGAIN             @OX25492 21300000
TESTC3   MVI   PARM4,X'C3'         YES                         @OX25492 21350000
         B     OUT1                CNTL POLL CHAR COMPLETE     @OX25492 21400000
TESTF0   CLI   0(14),X'F0'         SECOND SPECIAL CASE         @OX25492 21450000
         BNE   TESTE0              NO, WAS '2' BYTE ANDED      @OX25492 21500000
         MVI   PARM4,X'F5'         YES                         @OX25492 21550000
         B     OUT1                CNTL POLL CHAR COMPLETE     @OX25492 21600000
TESTE0   TM    0(14),X'10'         TEST FOR '1' BYTE           @OX25492 21650000
         BO    OUT1                NOT 'E'                     @OX25492 21700000
         TM    0(14),X'E0'         CHECK FOR 'E'               @OX25492 21750000
         BO    TESTC3              YES, MAKE IT AN 'E'         @OX25492 21800000
OUT1     EQU   *                                               @OX25492 21850000
         UNPK  DUBLWD,2(2,14)      GET TERML ADDRESS.                   21900000
         TR    DUBLWD,HXTOEB       CONVERT IT TO 2 EBCDIC CHARS.        21950000
         MVC   PARM5(2),DUBLWD+5   MOVE THEM TO INPUT PARM FIELD.       22000000
*                                                                       22050000
* AT THIS POINT, IF NO INPUT LINE/CTRL/TERM WAS SPECIFIED, THE          22100000
* ADDRESS PERTAINING TO THE REQUESTOR'S TERMINAL HAS BEEN PLACED        22150000
* IN THE INPUT PARMS AS IF THEY HAD BEEN KEYED IN.                      22200000
*                                                                       22250000
B130     MVC   TWATCTID,TCTTETI    MOVE THIS TERML'S CICS ID ALSO.      22300000
B140     MVC   SAVETERM,PARM5      MOVE TERMINAL  TO SAVE AREA          22350000
         MVC   SAVECU,PARM4        MOVE CTRL UNIT TO SAVE AREA          22400000
         MVC   SAVELINE,PARM3      MOVE LINE      TO SAVE AREA          22450000
B160     MVC   DUBLWD+5(3),PARM3                                        22500000
         TR    DUBLWD,EBTOHX            GET LINE,                       22550000
         PACK  DUBLWD(3),DUBLWD+5(4)    CONTROL UNIT,                   22600000
         MVC   HEXLINE,DUBLWD           AND                             22650000
         MVC   DUBLWD+5(3),PARM4        TERMINAL                        22700000
         TR    DUBLWD,EBTOHX            ADDRESS                         22750000
         PACK  DUBLWD(2),DUBLWD+5(3)    INTO HEX                        22800000
         MVC   HEXCTRL,DUBLWD           FORMAT                          22850000
D070     MVC   DUBLWD+5(3),PARM5        FOR COMPARING                   22900000
         TR    DUBLWD,EBTOHX            TO DATA IN                      22950000
         PACK  DUBLWD(2),DUBLWD+5(3)    DISK FILE.                      23000000
         MVC   HEXTERM,DUBLWD                                           23050000
         ST    TIOABAR,TWATIOA     SAVE ADDR OF ORIGINAL INPUT AREA.    23100000
         BAL   LINKREG,GETTIOA     SETUP NEW OUTPUT AREA WITH HDRS.     23150000
D080     DFHFC TYPE=GET,DATASET=EMFILE,RDIDADR=TWAREL,NORESP=D190       23200000
D089     LA    LINKREG,CONTINUE         SETUP FOR FALL THROUGH @OX22095 23250000
D090     DFHSC TYPE=GETMAIN,CLASS=TERM,NUMBYTE=256,INITIMG=40           23300000
         L     TIOABAR,TCASCSA     GET A NEW OUTPUT AREA BIG            23350000
         ST    TIOABAR,TCTTEDA     ENOUGH FOR THE BNG001 ERR MSG.       23400000
         BR    LINKREG                  RESUME                 @OX22095 23450000
CONTINUE EQU *                                                 @OX22095 23500000
         MVC   TIOADBA(IOERRLTH),IOERRMSG                               23550000
         MVC   TIOATDL,=AL2(IOERRLTH)                                   23600000
         UNPK  DUBLWD,TWAREL(4)         SETUP I/O ERROR MSG WITH        23650000
         TR    DUBLWD,HXTOEB            BLOCK NBR THAT                  23700000
         MVC TIOADBA+(IOBLOCK-IOERRMSG)(3),DUBLWD+4  WAS BEING READ,    23750000
         UNPK  DUBLWD,TCAFCAA(3)        AND THE CICS FILE               23800000
         TR    DUBLWD,HXTOEB            CONTROL RETURN CODE.            23850000
         MVC   TIOADBA+(IOCODE-IOERRMSG)(2),DUBLWD+3                    23900000
D170     DFHTC TYPE=(WRITE,ERASE)                                       23950000
         DFHPC TYPE=RETURN                                              24000000
D190     L     FIOABAR,TCAFCAA     POINT TO FILE I/O AREA.              24050000
         SR    DATALOOP,DATALOOP   SETUP TO LOOP ON NBR OF              24100000
         IC    DATALOOP,CTRLENTS   ENTRIES IN THIS CNTRL BLK.           24150000
         LTR   DATALOOP,DATALOOP   VERIFY THAT THE DATA SET             24200000
         BNZ   E030                IS NOT EMPTY.                        24250000
D240     BAL   LINKREG,D090             GET IOAREA FOR MSG     @OX22095 24300000
         LA    OUTREG,TIOADBA           POINT TO OUTPUT AREA   @OX22095 24350000
         CLI   TCTTETM,X'F1'       IS THIS A 3277-1?                    24400000
         BE    D250                YES.                                 24450000
         MVC   TIOADBA(M11LGLTH),MSG11LG  SEND 'NO ERRS' MSG            24500000
         B     D260                                                     24550000
D250     MVC   TIOADBA(M11SMLTH),MSG11SM  SEND 'NO ERRS' MSG            24600000
D260     CLI   SAVETERM,X'00'      IS THERE A TERMINAL ID?              24650000
         BE    D280                NO. IT IS LOCAL TERMINAL             24700000
         CLI   TCTTETM,X'F1'       IS THIS A 3277-1?                    24750000
         BE    D271                YES.                                 24800000
         MVC   (M11LGTRM-MSG11LG)(2,OUTREG),SAVETERM                    24850000
         MVC   (M11LGCU-MSG11LG)(2,OUTREG),SAVECU                       24900000
         MVC   (M11LGLN-MSG11LG)(3,OUTREG),SAVELINE                     24950000
         MVC   (M11LGID-MSG11LG)(20,OUTREG),SAVEID                      25000000
         MVC   TIOATDL,=AL2(M11LGLTH)                                   25050000
         B     D300                                                     25100000
D271     MVC   (M11SMTRM-MSG11SM)(2,OUTREG),SAVETERM                    25150000
         MVC   (M11SMCU-MSG11SM)(2,OUTREG),SAVECU                       25200000
         MVC   (M11SMLN-MSG11SM)(3,OUTREG),SAVELINE                     25250000
         MVC   (M11SMID-MSG11SM)(20,OUTREG),SAVEID                      25300000
         MVC   TIOATDL,=AL2(M11SMLTH)                                   25350000
         B     D300                                                     25400000
D280     CLI   TCTTETM,X'F1'       (LOCAL) IS THIS A 3277-1?            25450000
         BE    D281                YES.                                 25500000
         MVC   TIOADBA(M12LGLTH),MSG12LG  SEND 'NO ERRS' MSG            25550000
         MVC   (M12LGTRM-MSG12LG)(3,OUTREG),SAVELINE      LOCAL TERM    25600000
         MVC   (M12LGID-MSG12LG)(20,OUTREG),SAVEID                      25650000
         MVC   TIOATDL,=AL2(M12LGLTH)                                   25700000
         B     D300                                                     25750000
D281     MVC   TIOADBA(M12SMLTH),MSG12SM  SEND 'NO ERRS' MSG            25800000
         MVC   (M12SMTRM-MSG12SM)(3,OUTREG),SAVELINE      LOCAL TERM    25850000
         MVC   (M12SMID-MSG12SM)(20,OUTREG),SAVEID                      25900000
         MVC   TIOATDL,=AL2(M12SMLTH)                                   25950000
D300     DFHTC TYPE=(WRITE,ERASE)                                       26000000
         DFHPC TYPE=RETURN                                              26050000
E030     LA    DATAREG,CTRLSLT1    POINT TO FIRST CTRL SLOT.            26100000
E040     OC    PARM4,PARM4         WAS A CTRL UNIT ADDR INPUT?          26150000
         BNZ   E110                YES. LINE ID IS CORRECT.             26200000
         XC    DUBLWD,DUBLWD       NO. THIS MUST BE RQST FOR LOCAL.     26250000
         MVC   DUBLWD(3),HXLINLIB  ROUND CUA ADDR DOWN                  26300000
         NI    DUBLWD+2,B'11100000'     TO EVEN CHAN ADDR.              26350000
         CLC   DUBLWD(6),CTRLPORT       LOOK FOR EQUAL LINE ADDRESS.    26400000
         B     E120                                                     26450000
E110     CLC   HXLINLIB,CTRLPORT   IS THIS SLOT = RQSTD LINE ADDR?      26500000
E120     BE    E200                YES. GO READ ITS DATA BLOCK.         26550000
         LA    DATAREG,SLOTLTH(DATAREG)  NO. BUMP TO NEXT CTRL SLOT.    26600000
         BCT   DATALOOP,E040            MORE SLOTS TO LOOK AT?          26650000
         OC    CTRLBACK,CTRLBACK        NO. IS THERE ANOTHER CTRL BLK?  26700000
         BZ    D240                NO. SEND 'NO ERRS' MSG.              26750000
         MVC   TWAREL,CTRLBACK+1        YES. SAVE NEXT BLOCK ADDR.      26800000
         DFHFC TYPE=RELEASE                                             26850000
         B     D080                                                     26900000
E200     MVC   TWAREL,CTRLFRST     MOVE DATA BLOCK ADDR.                26950000
F020     DFHFC TYPE=RELEASE        RELEASE THE CONTROL BLOCK.           27000000
         OC    TWAREL,TWAREL       IS THERE ANY DATA BLOCKS ?  @OZ31885 27050000
         BZ    T190                NO, WRITE 'NO DATA BLKS MSG'@OZ31885 27100000
         DFHFC TYPE=GET,DATASET=EMFILE,RDIDADR=TWAREL,NORESP=F050       27150000
         B     D089                                            @OX22095 27200000
F050     L     FIOABAR,TCAFCAA     POINT TO DATA BLOCK.                 27250000
         XC    TWASLOT,TWASLOT     INITIALIZE SLOT COUNT TO 1.          27300000
         LH    DATALOOP,BLKLTH     SETUP TO LOOP ON NBR BYTES IN REC.   27350000
         LA    DATAREG,DATASLT1    POINT TO FIRST DATA ITEM.            27400000
F080     L     14,TWASLOT                                               27450000
         LA    14,1(14)            ADD ONE TO SLOT COUNT                27500000
         ST    14,TWASLOT                                               27550000
         CLI   ENTRYTYP,X'91'      IS THIS ENTRY AN MDR RECORD?         27600000
         BNE   H060                NO. TEST FURTHER.                    27650000
         CLI   MDRTYPE,X'03'       YES. IS IT A 3270?                   27700000
         BE    G060                YES. TEST FURTHER.                   27750000
F120     SR    1,1                 NO. BUMP                             27800000
         IC    1,0(DATAREG)        TO NEXT DATA ITEM.                   27850000
         LTR   1,1                 PRECENT ENDLESS LOOP                 27900000
         BZ    F240                IN CASE GARBAGE IN RECORD.           27950000
         AR    DATAREG,1                                                28000000
         SR    DATALOOP,1          ALL DONE WITH THIS BLOCK?            28050000
         LTR   DATALOOP,DATALOOP                                        28100000
         BP    F080                NO. PROCESS NEXT ITEM.               28150000
         OC    DATAFWD,DATAFWD     YES. IS THERE ANOTHER BLOCK?         28200000
         BZ    F240                NO. GO WIND UP OUTPUT.               28250000
         MVC   TWAREL,DATAFWD      YES. GET CHAIN ADDR AND              28300000
         B     F020                GO READ NEXT BLOCK.                  28350000
F240     CLI   OUTSWCH,X'FF'       WAS ANY OUTPUT CREATED?              28400000
         BNE   D240                NO. SEND 'NO ERRS' MSG.              28450000
G020     LA    1,TIOADBA           YES. COMPUTE                         28500000
         SR    OUTREG,1            TOTAL DATA LTH.                      28550000
         STH   OUTREG,TIOATDL                                           28600000
         B     D170                GO TRANSMIT DISPLAY.                 28650000
G060     CLC   MDRCTRL,HEXCTRL     IS THIS MDR FOR RQSTED CTRL UNIT?    28700000
         BNE   F120                NO. SKIP IT.                         28750000
         CLC   MDRTERM,HEXTERM     YES. IS IT FOR REQUESTED TERML?      28800000
         BNE   F120                NO. SKIP IT.                         28850000
         MVC   0(MDRLTH,OUTREG),MDRHDR   YES. SETUP BUILD 1 MDR LINE.   28900000
         UNPK  DUBLWD,MDRSTATS(3)                                       28950000
         TR    DUBLWD,HXTOEB       FILL IN REMOTE STATUS BYTES.         29000000
         MVC   (MDRSTAT-MDRHDR)(4,OUTREG),DUBLWD+3                      29050000
G100     UNPK  DUBLWD,TWAREL(4)                                         29100000
         TR    DUBLWD,HXTOEB       FILL IN THIS BLK NBR.                29150000
         MVC   (MDRBBBSS-MDRHDR)(3,OUTREG),DUBLWD+4                     29200000
         UNPK  DUBLWD,TWASLOT(5)                                        29250000
         TR    DUBLWD,HXTOEB       FILL IN THIS SLOT NBR.               29300000
         MVC   (MDRBBBSS+3-MDRHDR)(2,OUTREG),DUBLWD+5                   29350000
         L     14,TWAOUT           POINT TO OUTPUT BBBSS FIELDS.        29400000
         CLC   (BBBSS-HDR3)(5,14),=C'BBBSS' IS 'FIRST' FILLED IN?       29450000
         BNE   G200                YES. SKIP IT.                        29500000
         MVC   (BBBSS-HDR3)(5,14),(MDRBBBSS-MDRHDR)(OUTREG) NO. DO IT.  29550000
         CLC   (BBBSS+10-HDR3)(5,14),=C'BBBSS' HOW ABOUT 'PREV'?        29600000
         BNE   G200                ALREADY THERE; SKIP IT.              29650000
         MVC   (BBBSS+10-HDR3)(5,14),(BBBSS-HDR3)(14)  NO. USE 'FIRST'  29700000
G200     MVC   (BBBSS+5-HDR3)(5,14),(MDRBBBSS-MDRHDR)(OUTREG)           29750000
         UNPK  DUBLWD,TIME                                              29800000
         MVC   (MDRHRS-MDRHDR)(2,OUTREG),DUBLWD+1   FILL IN HOURS       29850000
         MVC   (MDRMINS-MDRHDR)(2,OUTREG),DUBLWD+3  AND MINUTES.        29900000
G230     MVI   OUTSWCH,X'FF'       INDICATE SOME OUTPUT WAS CREATED.    29950000
         TIME    DEC          GET SYSTEM TIME                           30000000
         STCM  0,15,DATTIME        STORE TIME                           30050000
         STCM  1,15,DATDATE        STORE DATE                           30100000
         CP    DATE,DATDATE        DID ERROR HAPPEN TODAY?              30150000
         BE    G240                YES,BR HIGH INTENSITY                30200000
         SP    DATDATE,=P'1'       MAKE DATE YESTERDAY                  30250000
         CP    DATE,DATDATE        DID IT HAPPEN YESTERDAY              30300000
         BNE   G230A               NO,BR LEAVE INTENSITY NORMAL         30350000
         CLC   TIME,DATTIME        IS IT OLDER THAN 24 HRS?             30400000
         BNL   G240                NO,BR MAKE IT HIGH INTENSITY         30450000
G230A    LA    R1,LEAPTBL                                               30500000
G231     CLC   DATE+1(1),0(1)      SEE IF                               30550000
         BE    G232                ERROR HAPPENED                       30600000
         LA    R1,1(R1)            IN LEAP YEAR                         30650000
         CLI   0(R1),X'FF'         IS IT END OF TABLE                   30700000
         BNE   G231                NO,BR TRY NEXT YEAR                  30750000
         ZAP   CALENDAR+8(2),=P'28' NOT LEAP YEAR                       30800000
         B     G233                CONTINUE                             30850000
G232     ZAP   CALENDAR+8(2),=P'29' YES,LEAP YEAR                       30900000
G233     LA    R15,CALENDAR                                             30950000
G234     MVN   DATE+3(1),=X'0C'    MAKE SURE SIGN IS CORRECT            31000000
         CLC   DATE+2(2),3(R15)    COMPUTE MONTH                        31050000
         BNH   G235                AND DAY FROM                         31100000
         SP    DATE+2(2),3(2,R15)  DAY NUMBER                           31150000
         LA    R15,5(R15)                                               31200000
         B     G234                                                     31250000
G235     MVC   (MDRHRS-MDRHDR)(3,OUTREG),0(R15)  MOVE MONTH AND         31300000
         UNPK  (MDRMINS-MDRHDR)(2,OUTREG),DATE+2(2)   DAY TO OUTPUT     31350000
         OI    (MDRMINS+1-MDRHDR)(OUTREG),X'F0'                         31400000
         B     H030                                                     31450000
G240     MVI   1(OUTREG),PDA       YES.                                 31500000
         MVI   4(OUTREG),UHA                                            31550000
         MVI   15(OUTREG),PDA                                           31600000
H030     LA    OUTREG,MDRLTH(OUTREG)    BUMP TO NEXT OUTPUT SLOT.       31650000
         BCT   OUTLOOP,F120        MORE TIOA ROOM LEFT?                 31700000
         B     G020                NO. GO WIND UP OUTPUT.               31750000
H060     CLI   ENTRYTYP,X'91'      IS THIS ENTRY AN OBR?                31800000
         BE    F120                NO. SKIP IT.                         31850000
         CLI   ENTRYTYP,X'36'      VTAM OBR ?                  @OZ38463 31900000
         BE    F120                YES, SKIP IT                @OZ38463 31950000
         CLC   OBRCUA,HEXLINE      YES. IS IT THE REQUESTED CUA ADDR?XX 32000000
         BNE   F120                NO. SKIP IT.                      XX 32050000
         CLI   OBRUCB,X'10'        IS THIS A REMOTE OBR ?            XX 32100000
         BE    H070                NO. BYPASS CHECKING POLL CHARS    XX 32150000
         CLC   OBRCTRL,HEXCTRL     IS IT THE REQUESTED CTRL UNIT ?      32200000
         BNE   F120                NO. SKIP IT.                         32250000
         CLC   OBRTERM,HEXTERM     IS IT THE REQUESTED TERMINAL ?       32300000
         BNE   F120                NO. SKIP IT.                         32350000
H070     MVC   0(MDRLTH,OUTREG),MDRHDR  YES. SETUP COMMON MDR/OBR HDRXX 32400000
         UNPK  DUBLWD,OBRCSW+4(3)                                       32450000
         TR    DUBLWD,HXTOEB       FILL IN CSW BYTES                    32500000
         MVC   (OBRSNS-MDRHDR)(4,OUTREG),DUBLWD+3                       32550000
         UNPK  DUBLWD,OBRSENSE(3)                                       32600000
         TR    DUBLWD,HXTOEB       FILL IN SENSE BYTES.                 32650000
         MVC   (MDRSTAT-MDRHDR)(4,OUTREG),DUBLWD+3                      32700000
         NI    OBRCCW+5,X'3F'      CLEAN UP TP OP CODE.                 32750000
         UNPK  DUBLWD,OBRCCW+5(2)                                       32800000
         TR    DUBLWD,HXTOEB       FILL IN TP OP CODE.                  32850000
         MVC   (OBRTPOP+1-MDRHDR)(2,OUTREG),DUBLWD+5                    32900000
         MVI   (OBRTPOP-1-MDRHDR)(OUTREG),C'B'                          32950000
         CLI   ENTRYTYP,X'34'      IS THIS A TCAM OBR?                  33000000
         BNE   J005                NO. LEAVE 'B' IN FOR BTAM            33050000
         MVI   (OBRTPOP-1-MDRHDR)(OUTREG),C'T'    T=TCAM                33100000
J005     UNPK  DUBLWD,OBRCCW(2)                                         33150000
         TR    DUBLWD,HXTOEB       FILL IN CHANL COMMAND.               33200000
         MVC   (OBRCMD-MDRHDR)(2,OUTREG),DUBLWD+5                       33250000
         B     G100                GO FILL IN DATA COMMON TO MDR/OBR.   33300000
J010     CLC   TIOADBA+8(2),=AL2(L1P7)  IS SECOND FIELD LINE 1 POSN 7?  33350000
         BE    A010                YES. THIS IS NEW INPUT.              33400000
         CLC   TIOADBA+8(2),=AL2(L6P26) IS SECOND FIELD LINE 6 POSN 26? 33450000
         BE    A010                YES. THIS IS NEW INPUT.              33500000
         LA    14,TIOADBA          SCAN THE INPUT TO SEE                33550000
J020     CLI   0(14),C'%'          IF THE SPECIAL CHAR                  33600000
         BE    J140                '%' IS PRESENT, WHICH                33650000
         CLI   0(14),X'00'         WAS PUT OUT BY THE BLOWUP            33700000
         BE    J050                ROUTINE TO INDICATE A                33750000
         LA    14,1(14)            RETURN FROM BLOWUP.                  33800000
         B     J020                                                     33850000
J050     CLC   PARM4(4),=C'PAGE'   IS THIS A 'PAGE' REQUEST?            33900000
         BNE   L160                NO. MUST BE 'BLOWUP' REQUEST.        33950000
         CLC   31(2,TIOABAR),=X'C1D3'   PAGE REQUEST           @OZ30480 34000000
         BE    ALTBBB                   YES, POINT TO NEXT FLD @OZ30480 34050000
         CLC   31(2,TIOABAR),=X'C17B'   PAGE BKWRD LARGE SCREEN@OZ30480 34100000
         BE    ALTBBB                   YES, POINT TO NEXT FLD @OZ30480 34150000
         CLC   31(2,TIOABAR),=X'406B'   PAGE FRWRD SMALL SCREEN@OZ30480 34200000
         BE    ALTBBB                   YES, POINT TO NEXT FLD @OZ30480 34250000
         B     PTOK                     NO, POINTER IS OK      @OZ30480 34300000
ALTBBB   CLC   PARM5(7),=C'FORWARD'     IS IT PAGE FORWARD     @OZ30480 34350000
         BNE   J191                     NO, MUST BE BACKWARD   @OZ30480 34400000
         MVC   NEWFIRST,TIOLAST+4       OLD LAST TO NEW FIRST  @OZ30480 34450000
         MVC   NEWPREV,TIOFIRST+4       OLD FIRST TO NEW PREV  @OZ30480 34500000
         TR    TIOLAST+4,EBTOHX         TRANSLATE OLD LAST     @OZ30480 34550000
         PACK  DUBLWD,TIOLAST+4(6)      INTO HEX               @OZ30480 34600000
         B     J110                     CONTINUE               @OZ30480 34650000
J191     MVC   NEWFIRST,TIOPREV+4       OLD PREV TO NEW FIRST  @OZ30480 34700000
         MVC   NEWPREV,TIOPREV+4        OLD PREV TO NEW PREV   @OZ30480 34750000
         TR    TIOPREV+4,EBTOHX         TRANSLATE OLD PREV     @OZ30480 34800000
         PACK  DUBLWD,TIOPREV+4(6)      INTO HEX               @OZ30480 34850000
         B     J110                     CONTINUE               @OZ30480 34900000
PTOK     EQU   *                                               @OZ30480 34950000
         CLC   PARM5(7),=C'FORWARD'  NO. IS IT PAGE FORWARD?            35000000
         BNE   J190                NO. MUST BE PAGE BACKWARD.           35050000
         MVC   NEWFIRST,TIOLAST    YES. PROMOTE LAST & FIRST FROM OLD   35100000
         MVC   NEWPREV,TIOFIRST    SCREEN TO NEW FIRST & PREVIOUS.      35150000
         TR    TIOLAST,EBTOHX                                           35200000
         PACK  DUBLWD,TIOLAST(6)   GET OLD 'LAST' BLK & SLOT IN HEX.    35250000
J110     MVC   TWAREL,DUBLWD+3     SETUP TO READ APPROPRIATE BLK.       35300000
         MVC   TWASLOT(1),DUBLWD+6  SETUP TO LOCATE APPROPRIATE SLOT.   35350000
         B     K010       GO READ BLK WHERE DISPLAY WILL RESUME.        35400000
*********************************************************************** 35450000
*                                                                     * 35500000
*        RESTORE BITS PROMPTER BBBSS SCREEN                           * 35550000
*                                                                     * 35600000
*********************************************************************** 35650000
J140     SH    14,=H'18'           BACKUP TO THE BBBSS FIELD            35700000
         MVC   BITFIRST(15),0(14)  ALIGN IT IN CASE NO PAGE ENTERED.    35750000
         MVC   NEWFIRST,BITFIRST    RESTORE OLD 'FIRST' & 'PREVIOUS'    35800000
         MVC   NEWPREV,BITPREV     AS NEW 'FIRST' & 'PREVIOUS'          35850000
         TR    BITFIRST,EBTOHX                                          35900000
         PACK  DUBLWD,BITFIRST(6)  GET OLD 'FIRST' ADDR & SLOT IN HEX.  35950000
         B     J110                                                     36000000
*********************************************************************** 36050000
J190     MVC   NEWFIRST,TIOPREV    OLD 'PREVIOUS' NOW BECOMES NEW       36100000
         MVC   NEWPREV,TIOPREV     'PREVIOUS' AND 'FIRST'               36150000
         TR    TIOPREV,EBTOHX                                           36200000
         PACK  DUBLWD,TIOPREV(6)   GET OLD 'PREVIOUS' IN HEX.           36250000
         B     J110                                                     36300000
K010     BAL   LINKREG,LOCATE      LOCATE SLOT TO RESUME AT.            36350000
         XC    PARM4(16),PARM4     ZERO OUT INPUT PARMS.                36400000
         CLI   ENTRYTYP,X'91'     IS THIS AN MDR?                       36450000
         BE    K020               YES. LINE ADDR IS OK.                 36500000
         XC    HXLINLIB,HXLINLIB  NO. DON'T USE ROUNDED DOWN ADDR.      36550000
         MVC   HXLINLIB+1(2),OBRCUA  GET ACTUAL CUA INSTEAD.            36600000
         B     K030                                                     36650000
K020     MVC   HXLINLIB,LINEID                                          36700000
K030     UNPK  DUBLWD,HEXLINE(3)   RESTORE LINE NBR FROM DATA           36750000
         TR    DUBLWD,HXTOEB       BLOCK AS IF IT HAD BEEN KEYED IN.    36800000
         MVC   PARM3(3),DUBLWD+4                                        36850000
         CLI   ENTRYTYP,X'91'      IS THIS AN MDR RECORD?               36900000
         BE    K040                YES. PUT IN POLLING CHARS.        XX 36950000
         CLI   OBRUCB,X'10'        IS THIS A LOCAL ?                 XX 37000000
         BE    L110                YES. BR NO POLL CHARS             XX 37050000
         MVC   HEXCTRL,OBRCTRL     MOVE CTRL UNIT ADDR               XX 37100000
         MVC   HEXTERM,OBRTERM     MOVE TERMINAL ADDR                XX 37150000
         B     K050                                                  XX 37200000
K040     MVC   HEXCTRL,MDRCTRL     YES.                              XX 37250000
         MVC   HEXTERM,MDRTERM     RESTORE CTRL UNIT ADDR            XX 37300000
K050     UNPK  DUBLWD,HEXCTRL(3)   AND TERMINAL ADDR                 XX 37350000
         TR    DUBLWD,HXTOEB       AS IF THEY HAD                    XX 37400000
         MVC   PARM4(2),DUBLWD+3   BEEN KEYED IN.                    XX 37450000
         MVC   PARM5(2),DUBLWD+5                                     XX 37500000
L110     BAL   LINKREG,GETTIOA     SETUP OUTPUT AREA WITH HEADERS.      37550000
         L     14,TWAOUT                                                37600000
         MVC   (BBBSS-HDR3)(5,14),NEWFIRST  FINISH HEADER WITH ADDR     37650000
         MVC   (BBBSS+10-HDR3)(5,14),NEWPREV   OF FIRST & PREVIOUS BLK. 37700000
         B     F080                GO BUILD ANOTHER PAGE.               37750000
L160     CLC   PARM2(4),=C'TERM'   IS THIS A 'COMPANION' INPUT?         37800000
         BE    L200                YES. GO HUNT FOR CTRL & LINE ADDR.   37850000
         TR    TIOITEM,EBTOHX      NO. GET REQUESTED ITEM ADDR.         37900000
         PACK  DUBLWD,TIOITEM(6)        AND SLOT NUMBER.                37950000
         MVC   TWAREL,DUBLWD+3          INTO HEX.                       38000000
         MVC   TWASLOT(1),DUBLWD+6                                      38050000
         BAL   LINKREG,LOCATE      LOCATE APPROPRIATE SLOT IN DATA BLK. 38100000
         DFHSC TYPE=GETMAIN,CLASS=TERM,NUMBYTE=2000,INITIMG=40          38150000
         L     TIOABAR,TCASCSA     GET A NEW OUTPUT AREA                38200000
         ST    TIOABAR,TCTTEDA     FOR THE BLOWUP DISPLAY.              38250000
         CLI   TCTTETM,C'2'        IS THIS SCREEN A MODEL 2?            38300000
         BE    M060                YES. MOVE APPROPRIATE HEADER.        38350000
         MVC   TIOADBA(BUHDR1LT),BUHDR1   NO. MOVE MODEL 1 BLOWUP HDR.  38400000
         LA    OUTREG,TIOADBA+BUHDR1LT  POINT TO NEXT BYTE OF OUTAREA.  38450000
         B     M080                                                     38500000
L200     TR    PARM3,EBTOHX        PARM3 IS BBBSS OF CTRL UNIT DISPLAY. 38550000
         PACK  DUBLWD,PARM3(6)     GET ITS BLK & SLT IN HEX.            38600000
         MVC   TWAREL,DUBLWD+3                                          38650000
         MVC   TWASLOT(1),DUBLWD+6                                      38700000
         BAL   LINKREG,LOCATE      LOCATE BLK & SLOT OF PREVIOUS DISPLY 38750000
         XC    PARM3,PARM3         ERASE BBBSS GARBAGE.                 38800000
         UNPK  PARM3(4),DATAPORT+1(3)   MOVE LINE ADDR FROM RECORD.     38850000
         MVI   PARM3+3,X'00'                                            38900000
         TR    PARM3,HXTOEB        MAKE IT LOOK LIKE IT WAS KEYED IN.   38950000
         XC    PARM4,PARM4                                              39000000
         CLI   ENTRYTYP,X'91'      IS THIS AN OBR?                      39050000
         BNE   L270                YES. SKIP POLLING CHARACTERS.     XX 39100000
         UNPK  PARM4(3),MDRCTRL(2) NO. GET CTRL UNIT POLL CHAR.         39150000
         MVI   PARM4+2,X'00'                                            39200000
         TR    PARM4,HXTOEB        MAKE IT LOOK LIKE IT WAS KEYED IN.   39250000
         B     L300                                                     39300000
L270     CLI   OBRUCB,X'10'        IS THIS A LOCAL ?                 XX 39350000
         BE    L280                YES. BR NO POLL CHARS             XX 39400000
         UNPK  PARM4(3),OBRCTRL(2)  GET CTRL UNIT POLL CHARS         XX 39450000
         MVI   PARM4+2,X'00'                                         XX 39500000
         TR    PARM4,HXTOEB        MAKE IT LOOK LIKE IT WAS KEYED IN XX 39550000
         B     A010                                                  XX 39600000
L280     MVC   PARM3,PARM5         UNROUND TERML ADDRESS                39650000
         XC    PARM5,PARM5         ERASE GARBAGE IF LOCAL CU.           39700000
L300     DFHFC TYPE=RELEASE                                             39750000
         B     A010                                                     39800000
M060     MVC   TIOADBA(BUHDR2LT),BUHDR2   MOVE MODEL 2 BLOWUP HDR.      39850000
         LA    OUTREG,TIOADBA+BUHDR2LT  POINT TO NEXT BYTE OF OUTAREA.  39900000
M080     UNPK  DUBLWD,TIME         MOVE TIME OF                         39950000
         MVC   0(2,OUTREG),DUBLWD+1     ERROR TO OUTPUT.                40000000
         MVI   2(OUTREG),C':'                                           40050000
         MVC   3(2,OUTREG),DUBLWD+3                                     40100000
         LA    1,LEAPTBL                                                40150000
M090     CLC   DATE+1(1),0(1)           FIGURE OUT IF                   40200000
         BE    M100                     ERROR HAPPENED                  40250000
         LA    1,1(1)                   DURING LEAP YEAR.               40300000
         CLI   0(1),X'FF'                                               40350000
         BNE   M090                                                     40400000
         ZAP   CALENDAR+8(2),=P'28'                                     40450000
         B     M110                                                     40500000
M100     ZAP   CALENDAR+8(2),=P'29'                                     40550000
M110     LA    15,CALENDAR                                              40600000
M120     MVN   DATE+3(1),=X'0C'    PROTECT AGAINST GARBAGE IN PACKED    40650000
         CLC   DATE+2(2),3(15)     FIELD.  COMPUTE MONTH AND            40700000
         BNH   M130                     DAY FROM DAY NUMBER.            40750000
         SP    DATE+2(2),3(2,15)                                        40800000
         LA    15,5(15)                                                 40850000
         B     M120                                                     40900000
M130     MVC   6(3,OUTREG),0(15)        MOVE MONTH TO OUTPUT.           40950000
         UNPK  9(2,OUTREG),DATE+2(2)    MOVE DAY TO OUTPUT.             41000000
         OI    10(OUTREG),X'F0'                                         41050000
         MVC   LINESZ,=H'40'                                            41100000
         MVC   LINELOOP,=H'4'                                           41150000
         CLI   TCTTETM,C'2'        SETUP CORRECT LINE SIZE & NBR        41200000
         BNE   M140                     ITEMS FOR SCREEN MODEL.         41250000
         MVC   LINESZ,=H'80'                                            41300000
         MVC   LINELOOP,=H'12'                                          41350000
M140     EQU   *                                                        41400000
         CLI   ENTRYTYP,X'91'      IS THIS ENTRY AN OBR?                41450000
         BNE   M160                YES.                                 41500000
         BAL   LINKREG,BUMDR       NO. BLOW UP AN MDR ENTRY.            41550000
M150     LA    1,TIOADBA                                                41600000
         SR    OUTREG,1                                                 41650000
         STH   OUTREG,TIOATDL      FINISH UP THE OUTPUT.                41700000
         DFHTC TYPE=WRITE,CTLCHAR=C2                                    41750000
         DFHPC TYPE=RETURN                                              41800000
M160     BAL   LINKREG,BUOBR       BLOWUP AN OBR ENTRY.                 41850000
         B     M150                                                     41900000
BUOBR    MVC   13(5,OUTREG),=C'TP-OP'   MOVE THE                        41950000
         CLI   ENTRYTYP,X'34'           TCAM OBR               @OZ40264 42000000
         BE    TRANTP                   YES TRANSLATE AS IS    @OZ40264 42050000
         NI    OBRCCW+5,X'3F'           BTAM, TURN OFF 0 & 1   @OZ40264 42100000
TRANTP   EQU   *                                               @OZ40264 42150000
         UNPK  DUBLWD,OBRCCW+5(2)       TP OP CODE                      42200000
         TR    DUBLWD,HXTOEB            TO OUTPUT AREA.                 42250000
         MVC   19(2,OUTREG),DUBLWD+5                                    42300000
         LA    15,TPOPTBL                                               42350000
         CLI   ENTRYTYP,X'34'       IS THIS A TCAM OBR?                 42400000
         BNE   O060                 NO. REG 15 POINTS AT BTAM           42450000
         L     15,=A(TCAMTPOP)      YES. POINT TO TCAM TPOP TABLE       42500000
O060     CLC   0(2,15),DUBLWD+5                                         42550000
         BE    O120                                                     42600000
         CLC   0(2,15),=X'FFFF'                                         42650000
         BE    O120                                                     42700000
         LA    15,20(15)                                                42750000
         B     O060                                                     42800000
O120     MVC   22(18,OUTREG),2(15) MOVE EXPLANATION OF TP OP CODE.      42850000
         AH    OUTREG,LINESZ       BUMP TO NEXT LINE OF OUTPUT.         42900000
O170     MVC   0(11,OUTREG),=C'DATA LENGTH'                             42950000
         UNPK  DUBLWD,OBRCCW+6(3)                                       43000000
         TR    DUBLWD,HXTOEB       MOVE DATA LENGTH.                    43050000
         MVC   12(4,OUTREG),DUBLWD+3                                    43100000
         MVC   21(14,OUTREG),=C'RESIDUAL COUNT'                         43150000
         UNPK  DUBLWD,OBRCSW+6(3)                                       43200000
         TR    DUBLWD,HXTOEB                                            43250000
         MVC   36(4,OUTREG),DUBLWD+3                                    43300000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE.            43350000
         MVC   0(15,OUTREG),=C'CHANNEL COMMAND'                         43400000
         UNPK  DUBLWD,OBRCCW(2)                                         43450000
         TR    DUBLWD,HXTOEB       MOVE THE CHANNEL COMMAND.            43500000
         MVC   16(2,OUTREG),DUBLWD+5                                    43550000
         LA    15,CCWTABL                                               43600000
         CLI   OBRUCB,X'40'     IS THIS A REMOTE?                       43650000
         BE    P070             YES. USE 270X COMMANDS.                 43700000
         L     15,=A(CCW3272)   NO. USE THE 3272 COMMANDS.              43750000
P070     CLC   0(2,15),DUBLWD+5                                         43800000
         BE    P130                                                     43850000
         CLC   0(2,15),=X'FFFF'                                         43900000
         BE    P130                                                     43950000
         LA    15,20(15)                                                44000000
         B     P070                                                     44050000
P130     MVC   19(18,OUTREG),2(15) MOVE CCW EXPLANATION.                44100000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE.            44150000
         MVC   4(5,OUTREG),=C'SENSE' MOVE SENSE & STATUS HEADERS.       44200000
         MVC   24(6,OUTREG),=C'STATUS'                                  44250000
         UNPK  DUBLWD,OBRSENSE(3)  MOVE SENSE                        XH 44300000
         TR    DUBLWD,HXTOEB       BYTES TO                          XH 44350000
         MVC   10(4,OUTREG),DUBLWD+3    OUTPUT AREA                  XH 44400000
         UNPK  DUBLWD,OBRCSW+4(3)  MOVE OBR STATUS                   XH 44450000
         TR    DUBLWD,HXTOEB       BYTES TO                          XH 44500000
         MVC   31(4,OUTREG),DUBLWD+3    OUTPUT AREA                  XH 44550000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUTLINE.             44600000
         LR    14,OUTREG           TEMPORARY POINTER TO SENSE OUTPUT.   44650000
         LH    1,LINELOOP          LIMIT DISPLAY IF MOD 1 SCREEN.       44700000
         LA    15,SENSTABL                                              44750000
         CLI   OBRUCB,X'40'        IS THIS REMOTE?                      44800000
         BE    P200                YES, USE 270X SENSE                  44850000
         L     15,=A(SENS3272)     NO, USE 3272 SENSE                   44900000
P200     MVC   DUBLWD(1),OBRSENSE  SETUP TO TEST SENSE BITS.            44950000
         NC    DUBLWD(1),0(15)                                          45000000
         CLC   DUBLWD(1),0(15)                                          45050000
         BE    Q050                                                     45100000
Q010     LA    15,19(15)           BUMP TO NEXT SLOT IN SENSE TABL.     45150000
         CLI   0(15),X'FF'                                              45200000
         BNE   P200                                                     45250000
         B     Q080                                                     45300000
Q050     MVC   0(18,14),1(15)      MOVE EXPLANATION OF 1 SENSE BIT.     45350000
         AH    14,LINESZ           BUMP TO NEXT SENSE OUTPUT AREA.      45400000
         BCT   1,Q010              ANY TIOA ROOM LEFT?                  45450000
Q080     ST    14,SAVE14                                                45500000
         LR    14,OUTREG           NO. SETUP TO LOOK AT STATUS BITS.    45550000
         LH    1,LINELOOP                                               45600000
         LA    15,CSWTABL                                               45650000
Q110     MVC   DUBLWD(2),OBRCSW+4                                       45700000
         NC    DUBLWD(2),0(15)                                          45750000
         CLC   DUBLWD(2),0(15)                                          45800000
         BE    Q180                                                     45850000
Q150     LA    15,20(15)                                                45900000
         CLI   0(15),X'FF'                                              45950000
         BNE   Q110                                                     46000000
         B     Q210                                                     46050000
Q180     MVC   20(18,14),2(15)     MOVE EXPLANATION OF 1 CSW STATUS BIT 46100000
         AH    14,LINESZ           BUMP TO NEXT OUTPUT SLOT             46150000
         BCT   1,Q150              ANY TIOA ROOM LEFT?                  46200000
Q210     C     14,SAVE14           NO.                                  46250000
         BH    R010                                                     46300000
         L     14,SAVE14           SET OUTPUT REG TO HIGHER             46350000
R010     LR    OUTREG,14           OUTPUT ADDRESS (SENSE OR STATUS).    46400000
         BR    LINKREG                                                  46450000
BUMDR    MVC   24(6,OUTREG),=C'SENSE '  MOVE SENSE HDR.                 46500000
         UNPK  DUBLWD,MDRSTATS(3)  MOVE MDR                             46550000
         TR    DUBLWD,HXTOEB       STATUS BYTES                         46600000
         MVC   31(4,OUTREG),DUBLWD+3    TO OUTPUT AREA                  46650000
         AH    OUTREG,LINESZ       BUMP TO NEXT OUTPUT LINE.            46700000
         LR    14,OUTREG                                                46750000
         LH    1,LINELOOP                                               46800000
         AR    1,1                 LIMIT MOD 1 TO 7 BITS MAX.           46850000
         BCTR  1,0                                                      46900000
         LA    15,STATSTBL                                              46950000
R080     MVC   DUBLWD(2),MDRSTATS  SETUP TO LOOK AT REMOTE STATUS TBL.  47000000
         NC    DUBLWD(2),0(15)                                          47050000
         CLC   DUBLWD(2),0(15)                                          47100000
         BE    R170                                                     47150000
R120     LA    15,20(15)                                                47200000
         CLI   0(15),X'FF'                                              47250000
         BNE   R080                                                     47300000
         B     R200                                                     47350000
R170     MVC   20(18,14),2(15)     MOVE EXPLANATION OF 1 REMOTE STATUS  47400000
         AH    14,LINESZ           BUMP TO NEXT OUTPUT AREA             47450000
         BCT   1,R120              ANY TIOA ROOM LEFT?                  47500000
R200     LR    OUTREG,14           NO. SETUP TO COMPUTE DATA LTH.       47550000
         BR    LINKREG             RETURN TO MAIN LINE.                 47600000
LOCATE   DFHFC TYPE=GET,DATASET=EMFILE,RDIDADR=TWAREL,NORESP=S030       47650000
         B     D089                                            @OX22095 47700000
S030     L     FIOABAR,TCAFCAA     POINT TO DATA BLK.                   47750000
         LH    DATALOOP,BLKLTH     SETUP LOOP NBR BYTES THIS BLK.       47800000
         LA    DATAREG,DATASLT1    POINT TO FIRST DATA ITEM             47850000
         SR    1,1                 PREPARE SLOT NBR FOR                 47900000
         IC    1,TWASLOT           PUTTING OUT IN DISPLAY               47950000
         BCTR  1,0                 SUB 1 FROM TWASLOT                   48000000
         STC   1,TWASLOT+3         AND STORE INTO LAST BYTE(TWASLOT)    48050000
S060     CLI   TWASLOT,2           IF RQSTED SLOT = 1, THIS IS IT.      48100000
         BL    S220                GO RESUME DISPLAY BUILDING.          48150000
         SR    1,1                                                      48200000
         IC    1,TWASLOT           DECREMENT SLOT COUNT BY 1.           48250000
         BCTR  1,0                                                      48300000
         STC   1,TWASLOT                                                48350000
         IC    1,0(DATAREG)        BUMP TO NEXT SLOT.                   48400000
         LTR   1,1                                                      48450000
         BZ    S190                PREVENT LOOP IF GARBAGE INPUT.       48500000
         AR    DATAREG,1                                                48550000
         SR    DATALOOP,1                                               48600000
         LTR   DATALOOP,DATALOOP   VERIFY SLOT NBR VALID FOR THIS BLK.  48650000
         BP    S060                                                     48700000
S190     EQU   *                                                        48750000
         BAL   LINKREG,D090             GET IOAREA FOR MSG     @OX22095 48800000
         MVC   TIOADBA(INVLTH),INVMSG  IF RQSTED SLOT CAN'T             48850000
         MVC   TIOATDL,=AL2(INVLTH)     BE FOUND, SEND 'SEARCH ERROR'   48900000
         B     D170                                                     48950000
S220     BR    LINKREG             RETURN TO MAIN LINE.                 49000000
GETTIOA  DFHSC TYPE=GETMAIN,CLASS=TERM,NUMBYTE=2000,INITIMG=40          49050000
         L     TIOABAR,TCASCSA     GET A NEW OUTPUT AREA BIG            49100000
         ST    TIOABAR,TCTTEDA     ENOUGH FOR A MODEL-2 DISPLAY.        49150000
         MVC   TIOADBA(HDR1LTH),HDR1                                    49200000
         MVC   TIOADBA+HDR1LTH(4),=C'3270'   SETUP 1ST LINE OF HEADER.  49250000
         LA    OUTREG,TIOADBA+HDR1LTH+4                                 49300000
         CLI   TCTTETM,C'2'        IS THIS SCREEN A MODEL 2?            49350000
         BNE   T120                NO. 1ST LINE IS OK.                  49400000
         MVC   0(3,OUTREG),HDR2    YES. ADD ANOTHER SBA TO FINISH       49450000
         LA    OUTREG,3(OUTREG)    THIS 80-CHAR LINE.                   49500000
T120     MVC   0(HDR3LTH,OUTREG),HDR3   MOVE THE 'PAGE' REQUEST LINES.  49550000
         MVC   SAVEID,=CL20' '     CLEAR CICS ID FROM SAVE AREA         49600000
         OC    TWATCTID,TWATCTID   IF NO INPUT WAS SPECIFIED,           49650000
         BZ    T130                SHOW USER HIS CICS TERML ID.         49700000
         MVC   (HDR3ID-HDR3)(8,OUTREG),=C'CICS ID '                     49750000
         MVC   (HDR3ID-HDR3+8)(4,OUTREG),TWATCTID                       49800000
         MVC   SAVEID(12),(HDR3ID-HDR3)(OUTREG)                         49850000
T130     ST    OUTREG,TWAOUT       SAVE THIS ADDR TO FILL IN BLK NBRS.  49900000
         LA    OUTREG,HDR3LTH(OUTREG)                                   49950000
         MVC   0(HDR4LTH,OUTREG),HDR4   MOVE THE RECAP LINE HDR.        50000000
         OC    PARM5,PARM5         IF NO TERM ADDR INPUT, SHOW ONLY LIN 50050000
         BZ    T150                                                     50100000
         MVC   (HDR4TERM-HDR4)(2,OUTREG),PARM5   FILL IN THE            50150000
         MVC   (HDR4CTRL-HDR4)(2,OUTREG),PARM4    ID OF THIS TERML      50200000
T150     EQU   *                                                        50250000
         MVC   (HDR4LINE-HDR4)(3,OUTREG),PARM3    CTRL UNIT, AND LINE.  50300000
         CLC   (HDR4TERM-HDR4)(2,OUTREG),=C'  '  IS TERML BLANK?        50350000
         BNE   T160                      NO. LET IT GO.                 50400000
         MVC   8(6,OUTREG),=C'LOCAL '    YES, CHANGE TO                 50450000
         MVC   14(3,OUTREG),PARM3        LOCAL FORMAT.                  50500000
         MVC   17(24,OUTREG),=24C' '                                    50550000
T160     EQU   *                                                        50600000
         LA    OUTREG,HDR4LTH(OUTREG)                                   50650000
         CLI   TCTTETM,C'2'        IS THIS A BIG SCREEN?                50700000
         BNE   T170                NO. THIS LINE IS OK.                 50750000
         MVC   0(3,OUTREG),HDR5    YES. ADD ANOTHER SBA TO              50800000
         LA    OUTREG,3(OUTREG)    GET US PAST 40 MORE CHARS.           50850000
T170     MVC   0(HDR6LTH,OUTREG),HDR6   MOVE COLUMN HEADERS.            50900000
         LA    OUTREG,HDR6LTH(OUTREG)                                   50950000
         LA    OUTLOOP,7           SETUP TO SHOW 7 ITEMS ON MOD 1.      51000000
         CLI   TCTTETM,C'2'        IS THIS A BIG SCREEN?                51050000
         BNE   T180                NO. RETURN TO MAIN LINE.             51100000
         MVC   0(HDR6LTH,OUTREG),HDR6   YES. MOVE ANOTHER COLUMN HDR.   51150000
         LA    OUTREG,HDR6LTH(OUTREG)                                   51200000
         LA    OUTLOOP,40          SETUP TO SHOW 40 ITEMS ON MOD 2.     51250000
T180     BR    LINKREG             RETURN TO MAIN LINE.                 51300000
T190     DFHSC TYPE=GETMAIN,CLASS=TERM,NUMBYTE=256,INITIMG=40  @OZ31885 51350000
         L     TIOABAR,TCASCSA          GET DATA AREA          @OZ31885 51400000
         ST    TIOABAR,TCTTEDA          POINT TO MSG TO WRITE  @OZ31885 51450000
         MVC   TIOADBA(MSG13LTH),MSG13  MOVE IN THE MSG        @OZ31885 51500000
         MVC   TIOATDL,=AL2(MSG13LTH)   MOVE IN THE LENGTH     @OZ31885 51550000
         MVC   TIOADBA+(MSG13LN-MSG13)(3),SAVELINE GET LINE NO.@OZ31885 51600000
         DFHTC TYPE=(WRITE,ERASE)                              @OZ31885 51650000
         DFHPC TYPE=RETURN                                     @OZ31885 51700000
HDR1     DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF'                   51750000
         DC    AL1(SF,UNA,IC),AL1(SBA),AL2(L1P36),AL1(SF,MNP)           51800000
HDR1LTH  EQU   *-HDR1                                                   51850000
HDR2     DC    AL1(SBA),AL2(L2P1)                                       51900000
HDR3     DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'?'                        51950000
         DC    AL1(SF,PNA),C') PAGE FORWARD     '                       52000000
HDR3ID   DC    C'                '                                      52050000
         DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'?'                        52100000
         DC    AL1(SF,PNA),C') PAGE BACKWRD'                            52150000
         DC    AL1(SF,PIA)                                              52200000
BBBSS    DC    C'BBBSSBBBSSBBBSS',AL1(SF,PNA),C'    '                   52250000
HDR3LTH  EQU   *-HDR3                                                   52300000
HDR4     DC    AL1(SF,PNA),C'RECAP REMOTE '                          XH 52350000
HDR4TERM DC    CL2'  ',C' ON CU '                                    XH 52400000
HDR4CTRL DC    CL2'  ',C' ON LINE '                                  XH 52450000
HDR4LINE DC    CL3'999',C'  '                                        XH 52500000
HDR4LTH  EQU   *-HDR4                                                XH 52550000
HDR5     DC    AL1(SBA),AL2(L4P1)                                    XH 52600000
HDR6     DC    AL1(SF,PNA),C'      FILE#  TIME SENSE STATUS TPOP CMD'   52650000
HDR6LTH  EQU   *-HDR6                                                XH 52700000
IOERRMSG DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC) XH 52750000
         DC    CL34' ',AL1(SF,PNA),CL39' '                           XH 52800000
         DC    CL39'BNG013A C I/O ERR READING SYS1.DEMFLOG '   @OX21950 52850000
         DC    CL28'  THE CICS RESPONSE CODE IS '              @OX21950 52900000
IOCODE   DC    CL4'00  '                                       @OX21950 52950000
         DC    CL9' '                                                XH 53000000
         DC    CL34'THE BDAM RELATIVE BLOCK NUMBER IS '              XH 53050000
IOBLOCK  DC    CL3'000'                                              XH 53100000
IOERRLTH EQU   *-IOERRMSG                                            XH 53150000
MSG11LG  DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC) XH 53200000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                        XH 53250000
         DC    C'BNG011I C NO ERRORS RECORDED FOR REMOTE'            XH 53300000
         DC    AL1(SBA),AL2(L3P1LG),AL1(SF,PNA)                      XH 53350000
         DC    CL9'TERMINAL '                                        XH 53400000
M11LGTRM DC    CL2' '                                                XH 53450000
         DC    CL20'       ON CTRL UNIT '                            XH 53500000
M11LGCU  DC    CL2' '                                                XH 53550000
         DC    AL1(SBA),AL2(L4P1),AL1(SF,PNA)                        XH 53600000
         DC    CL8'ON LINE '                                         XH 53650000
M11LGLN  DC    CL3' '                                                XH 53700000
         DC    CL8' '                                                XH 53750000
M11LGID  DC    CL20' '         CICS SYMBOLIC NAME                    XH 53800000
M11LGLTH EQU   *-MSG11LG                                             XH 53850000
MSG11SM  DC    AL1(SBA),AL2(L1P1SM),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)  53900000
         DC    AL1(SBA),AL2(L2P1SM),AL1(SF,PNA)                         53950000
         DC    C'BNG011I C NO ERRORS RECORDED FOR REMOTE'            XH 54000000
         DC    AL1(SBA),AL2(L3P1SM),AL1(SF,PNA)                         54050000
         DC    CL9'TERMINAL '                                        XH 54100000
M11SMTRM DC    CL2' '                                                XH 54150000
         DC    CL20'       ON CTRL UNIT '                            XH 54200000
M11SMCU  DC    CL2' '                                                XH 54250000
         DC    AL1(SBA),AL2(L4P1SM),AL1(SF,PNA)                         54300000
         DC    CL8'ON LINE '                                         XH 54350000
M11SMLN  DC    CL3' '                                                XH 54400000
         DC    CL8' '                                                XH 54450000
M11SMID  DC    CL20' '         CICS SYMBOLIC NAME                    XH 54500000
M11SMLTH EQU   *-MSG11SM                                             XH 54550000
MSG12LG  DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC) XH 54600000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                        XH 54650000
         DC    C'BNG012I C NO ERRORS RECORDED FOR LOCAL '            XH 54700000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                        XH 54750000
         DC    CL9'TERMINAL '                                        XH 54800000
M12LGTRM DC    CL3' '                                                XH 54850000
         DC    CL7' '                                                XH 54900000
M12LGID  DC    CL20' '         CICS SYMBOLIC NAME                    XH 54950000
M12LGLTH EQU   *-MSG12LG                                             XH 55000000
MSG12SM  DC    AL1(SBA),AL2(L1P1SM),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)  55050000
         DC    AL1(SBA),AL2(L2P1SM),AL1(SF,PNA)                         55100000
         DC    C'BNG012I C NO ERRORS RECORDED FOR LOCAL '            XH 55150000
         DC    AL1(SBA),AL2(L3P1SM),AL1(SF,PNA)                         55200000
         DC    CL9'TERMINAL '                                        XH 55250000
M12SMTRM DC    CL3' '                                                XH 55300000
         DC    CL7' '                                                XH 55350000
M12SMID  DC    CL20' '         CICS SYMBOLIC NAME                    XH 55400000
M12SMLTH EQU   *-MSG12SM                                             XH 55450000
MDRHDR   DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'? ) '                     55500000
MDRBBBSS DC    CL5'BBBSS',AL1(SF,PNA)                                   55550000
MDRHRS   DC    CL2'24',C':'                                             55600000
MDRMINS  DC    CL2'60',C'  '                                            55650000
MDRSTAT  DC    CL4'XXXX',C'   '                                         55700000
OBRSNS   DC    CL4'    ',C'  '                                          55750000
OBRTPOP  DC    CL2'  ',C'  '                                            55800000
OBRCMD   DC    CL2'  ',C' '                                             55850000
MDRLTH   EQU   *-MDRHDR                                                 55900000
BUHDR1   DC    AL1(SBA),AL2(L1P7),AL1(IC)                               55950000
         DC    AL1(SBA),AL2(L3P39),AL1(SF,PIA),C'%',AL1(SBA),AL2(L5P1)  56000000
         DC    X'3CC75F40',AL1(SBA),AL2(L5P1)                           56050000
BUHDR1LT EQU   *-BUHDR1                                                 56100000
BUHDR2   DC    AL1(SBA),AL2(L1P7),AL1(IC)                               56150000
         DC    AL1(SBA),AL2(L2P79),AL1(SF,PIA),C'%',AL1(SBA),AL2(L4P1)  56200000
         DC    X'3C5D7F40',AL1(SBA),AL2(L4P1)                           56250000
BUHDR2LT EQU   *-BUHDR2                                                 56300000
INVMSG   DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC) XH 56350000
         DC    XL34'00',AL1(SBA),AL2(L2P1),AL1(SF,PNA)               XH 56400000
         DC    CL39'BNG005I C ERROR NOT FOUND ON FILE FOR '          XH 56450000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                        XH 56500000
         DC    C'THE SELECTED ITEM '                                 XH 56550000
INVLTH   EQU   *-INVMSG                                                 56600000
MSG13    DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    56650000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                  @OZ31885 56700000
         DC    CL39'BNG013A C NO DATA BLOCKS AVAILABLE FOR '   @OZ31885 56750000
         DC    CL5'LINE '                                      @OZ31885 56800000
MSG13LN  DC    CL3' '                                          @OZ31885 56850000
         DC    CL31':  DATA BASE IN DEGRADED MODE. '           @OZ31885 56900000
         DC    CL39' MUST ALLOCATE MORE BLOCKS THAN LINES'     @OZ31885 56950000
MSG13LTH EQU   *-MSG13                                         @OZ31885 57000000
         LTORG                                                          57050000
CALENDAR DC    C'JAN',PL2'31'                                           57100000
         DC    C'FEB',PL2'28'                                           57150000
         DC    C'MAR',PL2'31'                                           57200000
         DC    C'APR',PL2'30'                                           57250000
         DC    C'MAY',PL2'31'                                           57300000
         DC    C'JUN',PL2'30'                                           57350000
         DC    C'JUL',PL2'31'                                           57400000
         DC    C'AUG',PL2'31'                                           57450000
         DC    C'SEP',PL2'30'                                           57500000
         DC    C'OCT',PL2'31'                                           57550000
         DC    C'NOV',PL2'30'                                           57600000
         DC    C'DEC',PL2'31'                                           57650000
LEAPTBL  DC    X'768084889296FF'                                        57700000
EBTOHX   DC    X'00000000000000000000000000000000'     00-0F  THIS      57750000
         DC    X'00000000000000000000000000000000'     10-1F  TABLE     57800000
         DC    X'00000000000000000000000000000000'     20-2F  CONVERTS  57850000
         DC    X'00000000000000000000000000000000'     30-3F  INPUT     57900000
         DC    X'00000000000000000000000000000000'     40-4F  A THRU F  57950000
         DC    X'000000000000000000000000FF000000'     50-5F    TO      58000000
         DC    X'00000000000000000000000000000000'     60-6F  0A - 0F   58050000
         DC    X'00000000000000000000000000000000'     70-7F   AND      58100000
         DC    X'00000000000000000000000000000000'     80-8F  F0 - F9   58150000
         DC    X'00000000000000000000000000000000'     90-9F    TO      58200000
         DC    X'00000000000000000000000000000000'     A0-AF  00 - 09   58250000
         DC    X'00000000000000000000000000000000'     B0-BF    AND     58300000
         DC    X'000A0B0C0D0E0F000000000000000000'     C0-CF     *      58350000
         DC    X'00000000000000000000000000000000'     D0-DF   BECOME   58400000
         DC    X'00000000000000000000000000000000'     E0-EF    FF.     58450000
         DC    X'00010203040506070809000000000000'     F0-FF            58500000
HXTOEB   DC    4XL16'00',C' ',XL15'00',7XL16'00'  THIS TABLE CONVERTS   58550000
         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'  HEX CHARS           58600000
         DC    2XL16'00'                CHARS FA-THRU-FF BACK           58650000
         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'  A THRU F            58700000
CCWTABL  DC    CL20'00TEST IO'                                          58750000
         DC    CL20'01WRITE'                                            58800000
         DC    CL20'02READ'                                             58850000
         DC    CL20'03NO OP'                                            58900000
         DC    CL20'04SENSE'                                            58950000
         DC    CL20'05TEST WRITE'                                       59000000
         DC    CL20'06READ PREPARE'                                     59050000
         DC    CL20'07STEP COUNT'                                       59100000
         DC    CL20'09WRITE POLL'                                       59150000
         DC    CL20'0AREAD INHIBIT'                                     59200000
         DC    CL20'0DWRITE BREAK'                                      59250000
         DC    CL20'0EREAD SEARCH'                                      59300000
         DC    CL20'11WRITE W/TIME OUT'                                 59350000
         DC    CL20'12TEST READ'                                        59400000
         DC    CL20'13SAD ZERO'                                         59450000
         DC    CL20'15WRAP'                                             59500000
         DC    CL20'17SAD ONE'                                          59550000
         DC    CL20'19POLL SOH'                                         59600000
         DC    CL20'1BSAD TWO'                                          59650000
         DC    CL20'1DDIAGNOSTIC POLL'                                  59700000
         DC    CL20'1EADDRESS PREPARE'                                  59750000
         DC    CL20'1FSAD THREE'                                        59800000
         DC    CL20'23SET MODE'                                         59850000
         DC    CL20'27ENABLE'                                           59900000
         DC    CL20'29WRITE DIAL'                                       59950000
         DC    CL20'2FDISABLE'                                          60000000
         DC    CL20'33TEST SYNC'                                        60050000
         DC    CL20'37SEND EOT'                                         60100000
         DC    CL20'3BSEND INQUIRY'                                     60150000
         DC    CL20'41WRITE BREAK'                                      60200000
         DC    CL20'42READ CLEAR'                                       60250000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           60300000
TPOPTBL  DC    CL20'00ON LINE TEST'                                     60350000
         DC    CL20'01DISABLE'                                          60400000
         DC    CL20'02WRITE EOA EOT EOT'                                60450000
         DC    CL20'03WRT POLL/ADDR CHRS'                               60500000
         DC    CL20'04WRITE SPACE'                                      60550000
         DC    CL20'05RD RSP TO POLLING'                                60600000
         DC    CL20'06RD RSP TO ADDRESSING'                             60650000
         DC    CL20'07READ ID RESPONSE'                                 60700000
         DC    CL20'08WRITE EOA'                                        60750000
         DC    CL20'09NOP OR TIC'                                       60800000
         DC    CL20'0AREAD INDEX'                                       60850000
         DC    CL20'0BREAD INQUIRY'                                     60900000
         DC    CL20'0CRD RSP TO INQUIRY'                                60950000
         DC    CL20'10WRT LINE ADDRESS'                                 61000000
         DC    CL20'11RD OR WRT TEXT'                                   61050000
         DC    CL20'12RD SKIP OR TIC'                                   61100000
         DC    CL20'13WRITE DLE ETX'                                    61150000
         DC    CL20'20RD RSP TO TEXT'                                   61200000
         DC    CL20'21ALL RESET COMMANDS'                               61250000
         DC    CL20'22READ SKIP'                                        61300000
         DC    CL20'23WRITE BREAK'                                      61350000
         DC    CL20'24OPEN LOPEN CLOSE'                                 61400000
         DC    CL20'25RD RSP TO TEXT'                                   61450000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           61500000
CSWTABL  DC    B'1000000000000000',CL18'ATTENTION'                      61550000
         DC    B'0100000000000000',CL18'STATUS MODIFIER'                61600000
         DC    B'0010000000000000',CL18'CTRL UNIT END'                  61650000
         DC    B'0001000000000000',CL18'BUSY'                           61700000
         DC    B'0000100000000000',CL18'CHANNEL END'                    61750000
         DC    B'0000010000000000',CL18'DEVICE END'                     61800000
         DC    B'0000001000000000',CL18'UNIT CHECK'                     61850000
         DC    B'0000000100000000',CL18'UNIT EXCEPTION'                 61900000
         DC    B'0000000010000000',CL18'PGRM CTRLD INTRPT'              61950000
         DC    B'0000000001000000',CL18'INCORRECT LENGTH'               62000000
         DC    B'0000000000100000',CL18'PROGRAM CHECK'                  62050000
         DC    B'0000000000010000',CL18'PROTECTION CHECK'               62100000
         DC    B'0000000000001000',CL18'CHANL DATA CHECK'               62150000
         DC    B'0000000000000100',CL18'CHANL CTRL CHECK'               62200000
         DC    B'0000000000000010',CL18'INTFACE CTRL CK'                62250000
         DC    B'0000000000000001',CL18'CHAINING CHECK'                 62300000
         DC    X'FF'                                                    62350000
SENSTABL DC    B'10000000',CL18'COMMAND REJECT'                         62400000
         DC    B'01000000',CL18'INTERVENTION REQD'                      62450000
         DC    B'00100000',CL18'BUS OUT CHECK'                          62500000
         DC    B'00010000',CL18'EQUIPMENT CHECK'                        62550000
         DC    B'00001000',CL18'DATA CHECK'                             62600000
         DC    B'00000100',CL18'OVERRUN'                                62650000
         DC    B'00000010',CL18'LOST DATA'                              62700000
         DC    B'00000001',CL18'TIMEOUT'                                62750000
         DC    X'FF'                                                    62800000
STATSTBL DC    B'0010000000000000',CL18'RESERVED'                       62850000
         DC    B'0001000000000000',CL18'RESERVED'                       62900000
         DC    B'0000100000000000',CL18'DEVICE BUSY'                    62950000
         DC    B'0000010000000000',CL18'UNIT SPECIFY'                   63000000
         DC    B'0000001000000000',CL18'DEVICE END'                     63050000
         DC    B'0000000100000000',CL18'TRANSMISSION CHECK'             63100000
         DC    B'0000000000100000',CL18'COMMAND REJECT'                 63150000
         DC    B'0000000000010000',CL18'INTERVENTION REQD'              63200000
         DC    B'0000000000001000',CL18'EQUIPMENT CHECK'                63250000
         DC    B'0000000000000100',CL18'DATA CHECK'                     63300000
         DC    B'0000000000000010',CL18'CONTROL CHECK'                  63350000
         DC    B'0000000000000001',CL18'OPERATION CHECK'                63400000
         DC    X'FF'                                                    63450000
SENS3272 DC B'10000000',CL18'COMMAND REJECT'                            63500000
         DC B'01000000',CL18'INTERVENTION REQD'                         63550000
         DC B'00100000',CL18'BUS OUT CHECK'                             63600000
         DC B'00010000',CL18'EQUIPMENT CHECK'                           63650000
         DC B'00001000',CL18'DATA CHECK'                                63700000
         DC B'00000100',CL18'UNIT SPECIFY'                              63750000
         DC B'00000010',CL18'CONTROL CHECK'                             63800000
         DC B'00000001',CL18'OPERATION CHECK'                           63850000
         DC    X'FF'                                                    63900000
CCW3272  DC    CL20'01WRITE'                                            63950000
         DC    CL20'05ERASE WRITE'                                      64000000
         DC    CL20'02READ BUFFER'                                      64050000
         DC    CL20'06READ MODIFIED'                                    64100000
         DC    CL20'0BSELECT'                                           64150000
         DC    CL20'0FERASE ALL PROTECTD'                               64200000
         DC    CL20'03NO OP'                                            64250000
         DC    CL20'04SENSE'                                            64300000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           64350000
PATCH    DS    20F                                             @OX21950 64400000
TCAMTPOP DC    CL20'01WRT EOT FOR SELECT'                               64450000
         DC    CL20'02OPEN TP OP CODE'                                  64500000
         DC    CL20'03WRITE POLL CHARS'                                 64550000
         DC    CL20'04RD RSPNS TO POLL'                                 64600000
         DC    CL20'05WRITE PAD CHARS'                                  64650000
         DC    CL20'06ENABLE DIAL LINE'                                 64700000
         DC    CL20'07WRT ADDR SEQUENCE'                                64750000
         DC    CL20'08READ RSPNS TO ADDR'                               64800000
         DC    CL20'09WRITE EOA SEQUENCE'                               64850000
         DC    CL20'0ARD RSPNS EOB/ETB'                                 64900000
         DC    CL20'0BWRITE CPU ID'                                     64950000
         DC    CL20'0CREAD ENQ'                                         65000000
         DC    CL20'0DWRITE ENQ'                                        65050000
         DC    CL20'0ERD RSPNS TO ENQ'                                  65100000
         DC    CL20'0FWRITE DLE EOT'                                    65150000
         DC    CL20'10READ ID (TSO)'                                    65200000
         DC    CL20'11NON-R/W CCW'                                      65250000
         DC    CL20'12WRITE BREAK (TSO)'                                65300000
         DC    CL20'13WRT ENQ AFTER SEL'                                65350000
         DC    CL20'14READ LCOUT'                                       65400000
         DC    CL20'15WRT RSP BEFOR TXT'                                65450000
         DC    CL20'16WRITE RESPONSE'                                   65500000
         DC    CL20'17WRITE TONE'                                       65550000
         DC    CL20'18BSC READ ID ENQ'                                  65600000
         DC    CL20'1ABSC READ ID ACK'                                  65650000
         DC    CL20'1CABORT SEND/RECIEV'                                65700000
         DC    CL20'1EREAD TWX ID'                                      65750000
         DC    CL20'20BUF TRM RESET BLK'                                65800000
         DC    CL20'22CLOSE SDR RECRDNG'                                65850000
         DC    CL20'24WRT RESET AFT SEL'                                65900000
         DC    CL20'51READ SKIP LOOP'                                   65950000
         DC    CL20'53WRT IDLES LOOP'                                   66000000
         DC    CL20'57WRT DLE STX'                                      66050000
         DC    CL20'59WRT DLE ETB(ETX)'                                 66100000
         DC    CL20'5BWRT ENQ RSP TO TXT'                               66150000
         DC    CL20'FFTEXT CCW'                                         66200000
         DC    X'FFFF',CL18'NO KNOWN MEANING'                           66250000
         END   BNGC3270                                                 66300000
