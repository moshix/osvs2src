         PRINT OFF                                                      00050000
         MACRO                                                          00100000
&NAME    BNGHJN &LABEL,&HJN                                             00150000
         LCLA  &K                                                       00200000
         LCLC  &HJA,&HJB,&HJC                                           00250000
&HJC     SETC  'PTF NO.'                                                00300000
&K       SETA  K'&SYSPARM                                               00350000
         AIF   (&K LT 4).CODE                                           00400000
&HJA     SETC  '&SYSPARM'(1,4)                                          00450000
         AIF   (&K LT 8).CODE                                           00500000
&HJB     SETC  '&SYSPARM'(5,4)                                          00550000
         AIF   (&K LT 15).CODE                                          00600000
&HJC     SETC  '&SYSPARM'(9,7)                                          00650000
.CODE    ANOP                                                           00700000
         AIF   ('&LABEL' EQ '').NOBRNCH                                 00750000
         B     &LABEL .                 BR AROUND CONSTANTS             00800000
         SPACE 2                                                        00850000
.NOBRNCH ANOP                                                           00900000
         AIF   ('&NAME' EQ '').NOLABEL                                  00950000
         DC    C'&NAME' .              MODULE IDENTIFIER                01000000
.NOLABEL ANOP                                                           01050000
         AIF   ('&HJA' EQ '').NEXT                                      01100000
         DC    X'&HJA' .                DATE OF MODIFICATION            01150000
.NEXT    ANOP                                                           01200000
         AIF   ('HJB' EQ '').DATE                                       01250000
         AIF   ('&HJN' NE 'HJN').DATE                                   01300000
         DC    X'&HJB' .                HJN OF MODIFICATION             01350000
.DATE    ANOP                                                           01400000
         DC    C'&HJC' .                PTF LEVEL                       01450000
.NOPTF   ANOP                                                           01500000
         AIF   ('&LABEL' EQ '').NOLBL                                   01550000
         SPACE 2                                                        01600000
&LABEL   DS    0H                                                       01650000
.NOLBL   ANOP                                                           01700000
         MEND                                                           01750000
         PRINT ON                                                       01800000
*********************************************************************** 01850000
*                                                                     * 01900000
* MODULE NAME = BNGCDISP                                              * 01950000
*                                                                     * 02000000
* DESCRIPTIVE NAME = CICS DEMF DISPLAY CONTROL MODULE                 * 02050000
*                                                                     * 02100000
* COPYRIGHT = NONE                                                    * 02150000
*                                                                     * 02200000
* STATUS = RELEASE 1, LEVEL 1                                         * 02250000
*                                                                     * 02300000
* FUNCTION = 1) RECEIVES CONTROL FROM CICS;                           * 02350000
*            2) EDITS THE INPUT INTO 6 PARM FIELDS WITH LEFT JUSTIFY; * 02400000
*            3) DOES SYNTAX CHECK ON DEMF COMMANDS AND PARAMETERS;    * 02450000
*            4) DETERMINES WHETHER THE REQUEST IS FOR MENU,REMOTE,    * 02500000
*               LOCAL OR 3270 SCREEN ERROR DISPLAY AND PASSES CONTROL * 02550000
*               TO BNGTMENU,BNGTRMOT,BNGTLOCL OR BNGT3270 SEGMENT     * 02600000
*               ACCORDINGLY WITH PARAMETERS;                          * 02650000
*            5) HANDLES ALL,LINE AND CTRL ERROR DISPLAY REQUEST AND   * 02700000
*               WRITES ITS ERROR INFORMATION TO THE 3270 DISPLAY      * 02750000
*               TERMINAL AND ISSUES SOME OF THE DISPLAY MESSAGES;     * 02800000
*            6) ACCESSES SYS1.DEMFLOG DATA FILE FOR ALL,LINE AND CTRL * 02850000
*               ERROR DISPLAY REQUEST;                                * 02900000
*            7) RETURNS CONTROL TO CICS.                              * 02950000
*                                                                     * 03000000
* NOTES = NONE                                                        * 03050000
*                                                                     * 03100000
*    DEPENDENCIES =                                                   * 03150000
*                                                                     * 03200000
*    THE FOLLOWING ARE CICS TABLES/CONTROL BLOCKS AND THEIR LABELS    * 03250000
*    USED BY DEMF CICS MODULES (BNGCDISP,BNGC3270,BNGCLOCL,BNGCRMOT   * 03300000
*    BNGCMENU) :                                                      * 03350000
*                                                                     * 03400000
*    CICS TABLE AND                                                   * 03450000
*    CONTROL BLOCKS                  LABELS USED                      * 03500000
*    ----------------------          -----------                      * 03550000
*                                                                     * 03600000
*    COMMON SYSTEM AREA              CSATCTBA                         * 03650000
*    (CSA)                                                            * 03700000
*                                                                     * 03750000
*    TERMINAL CONTROL TABLE          TCTTEDA                          * 03800000
*    TERMINAL ENTRY (TCTTE)          TCTTETM                          * 03850000
*                                    TCTTELT                          * 03900000
*                                    TCTTETI                          * 03950000
*                                    TCTTECLT                         * 04000000
*                                    TCTTETEL                         * 04050000
*                                    TCTTETT                          * 04100000
*                                    TCTTEGU                          * 04150000
*                                    TCTTETA                          * 04200000
*                                                                     * 04250000
*    TERMINAL CONTROL TABLE          TCTLELF                          * 04300000
*    LINE ENTRY (TCTLE)              TCTLEFAA                         * 04350000
*                                    TCTLEPI                          * 04400000
*                                    TCTLEMFP                         * 04450000
*                                    TCTLEPA                          * 04500000
*                                    TCTLEDCB                         * 04550000
*                                    TCTLERLN                         * 04600000
*                                                                     * 04650000
*    TERMINAL INPUT/OUTPUT AREA      TIOADBA                          * 04700000
*    (TIOA)                          TIOATDL                          * 04750000
*                                                                     * 04800000
*    TASK CONTROL AREA               TCAFCAAA                         * 04850000
*    (TCA)                           TCAFCAA                          * 04900000
*                                    TCAPCPI                          * 04950000
*                                    TCASCSA                          * 05000000
*                                                                     * 05050000
*    FILE INPUT/OUTPUT AREA          FIOADBA                          * 05100000
*    (FIOA)                                                           * 05150000
*                                                                     * 05200000
*    RESTRICTIONS = NONE                                              * 05250000
*                                                                     * 05300000
*    REGISTER CONVENTIONS = R12 ADDRESS OF TCA                        * 05350000
*                           R13 ADDRESS OF CSA                        * 05400000
*                                                                     * 05450000
*    PATCH LABEL = NONE                                               * 05500000
*    PATCH LABEL = PATCH                                       @OX21950 05550000
*                                                                     * 05600000
* MODULE TYPE =  CICS DISPLAY CONTROL                                 * 05650000
*                                                                     * 05700000
*    PROCESSOR = ASSEMBLER H                                          * 05750000
*                                                                     * 05800000
*    MODULE SIZE = 5632 DECIMAL BYTES                                 * 05850000
*                                                                     * 05900000
*    ATTRIBUTES = QUASI-REENTRANT                                     * 05950000
*                                                                     * 06000000
* ENTRY POINT = BNGCDISP                                              * 06050000
*                                                                     * 06100000
*    PURPOSE = SEE FUNCTION                                           * 06150000
*                                                                     * 06200000
*    LINKAGE = R12 LOADED WITH THE ADDRESS OF TCA                     * 06250000
*              R13 LOADED WITH THE ADDRESS OF CSA                     * 06300000
*              R14 LOADED WITH THE RETURN ADDR (USED BY SUBROUTINE)   * 06350000
*              R15 LOADED WITH ENTRY POINT                            * 06400000
*                                                                     * 06450000
* INPUT =  INPUT TIOA                                                 * 06500000
*                                                                     * 06550000
* OUTPUT = OUTPUT TIOA                                                * 06600000
*                                                                     * 06650000
* EXIT-NORMAL = REGISTER 15 RETURN CODE RETURNED TO CALLER :          * 06700000
*               00 - OPERATION PERFORMED AS REQUESTED                 * 06750000
*                                                                     * 06800000
* EXIT-ERROR  = NONE                                                  * 06850000
*                                                                     * 06900000
* EXTERNAL REFERENCE = BNGCLOCL,BNGCRMOT,BNGCMENU AND BNGC3270        * 06950000
*                                                                     * 07000000
*    ROUTINES = LOCATE ROUTINE                                        * 07050000
*               MOD1SCAN ROUTINE                                      * 07100000
*               MOD1 TABLE BUILD (AT LABEL S215) ROUTINE              * 07150000
*                                                                     * 07200000
*    DATA AREAS =  TWA (300 BYTES)                                    * 07250000
*                                                                     * 07300000
*    CONTROL BLOCK = DFHCSADS, DFHTCTTE, DFHTCTLE, DFHTCADS,          * 07350000
*                    DFHTIOA, DFHFIOA                                 * 07400000
*                                                                     * 07450000
* TABLES = TABLE    - FUNCTION/COMPANION TABLE                        * 07500000
*          MOD1TAB  - 3277 MODEL 1 TABLE                              * 07550000
*          HXTOEB   - HEX CHARS TO EBCDIC CHARS TABLE                 * 07600000
*          EBTOHX   - EBCDIC CHARS TO HEX CHARS TABLE                 * 07650000
*          LOTOUP   - LOWER TO UPPER CASE CHARS TABLE                 * 07700000
*                                                                     * 07750000
* MACROS = DCBD, DFHFC, DFHSC, DFHTC, DFHPC                           * 07800000
*                                                                     * 07850000
* CHANGE ACTIVITIES AS FOLLOWS:                                       * 07900000
* CHANGE 01  11/15/77  PROLOGUE ADDED                                 * 07950000
* CHANGE 02  02/22/78  BNGHJN MACRO ADDED                             * 08000000
* 12/30/83 ALTER GETMAIN SIZE REQUEST TO INSURE AREA IS SAME @OZ59145 * 08016600
*          SIZE AS FULL SCREEN PLUS FIELD START CHARACTERS   @OZ59145 * 08033200
*A139000                                                       @OZ29900 08050000
*C521500                                                       @OZ30480 08100000
*A489500                                                       @OZ31882 08150000
*D454000-455000                                                @OZ31878 08200000
*C456500-457000,551500-552000,601000-602000,603500-607000      @OZ31878 08250000
*C608500-611000                                                @OZ31878 08300000
*A412000,654500,684000                                         @OZ31885 08350000
*C037000,360500-361500                                         @OX21950 08400000
*A728500                                                       @OX21950 08450000
*C142500                                                       @OX22096 08500000
*A654800                                                       @OX22096 08550000
*C358000,641000-642500,645000,646000,647000,648000,650500      @OX22095 08600000
*C651500,653500-654000,654700                                  @OX22095 08650000
*A281500                                                       @OX22763 08700000
*DUMMY APAR TO CORRECT PREREQ STRINGS ON PREVIOUS PTF'S        @OZ36693 08750000
*C288000                                                       @OZ37867 08800000
*A431500                                                       @OZ38643 08850000
*C332500                                                       @OZ43235 08900000
*A295505-295565                                                @OX25492 08950000
*C076000-077000                                                @OZ39277 09000000
*A285700,285800,292700,292800                                  @OX25587 09050000
*C285500,286500,292500,293500                                  @OX25587 09100000
*********************************************************************** 09150000
BNGCDISP TITLE 'DISPLAY AUDITS INPUT AND DISPLAYS ALL LINES,LINE, CTRL' 09200000
         PRINT OFF                                                      09250000
         COPY  DFHCSADS                                                 09300000
         COPY  DFHTCTTE                                                 09350000
         COPY  DFHTCTLE                                                 09400000
         COPY  DFHTIOA                                                  09450000
         COPY  DFHTCADS                                                 09500000
         PRINT ON                                                       09550000
PARM1    DS    D                   1ST INPUT PARM - DEMF                09600000
PARM2    DS    D                   2ND INPUT PARM - ALL/LINE/CTRL/      09650000
*                                                    3270               09700000
PARM3    DS    D                   3RD INPUT PARM                       09750000
PARM4    DS    D                   4TH INPUT PARM                       09800000
PARM5    DS    D                   5TH INPUT PARM                       09850000
PARM6    DS    D                   6TH INPUT PARM                       09900000
SBACNT   DS    PL1                 COUNT OF SBA'S IN INPUT              09950000
RELREC   DS    CL3                 BDAM RELATIVE BLOCK ADDRESS          10000000
SVRELREC DS    CL3           SAVE AREA FOR LINE/CTRL RELATIVE BLOCK NO. 10050000
DBLWD    DS    D                   DOUBLEWORD WORK AREA                 10100000
DUBLWD   EQU   DBLWD                                                    10150000
FULLWD   DS    F                   FULLWORD WORK AREA                   10200000
TWALINE  DS    F             SAVE AREA FOR CICS SYMBOLIC LINE POINTER   10250000
*   THE TWA FROM HERE UP MUST REMAIN IN THAT ORDER TO MATCH TWALINE     10300000
*         WITH TWATCTID IN THE 3270 PROGRAM.                            10350000
LINEID   DS    XL6                 HARDWARE LINE ADDRESS                10400000
LINENAME DS    CL8           LINE NAME SAVE AREA FOR RECAP HEADER       10450000
CTRLID   DS    X                   HARDWARE CONTROL UNIT ADDRESS        10500000
CTRLNAME DS    XL8'00'       CTRL/CLUSTER NAME WORK AREA       @OZ39277 10550000
TERMNAME DS    XL8'00'             TERML/LOGICAL UNIT NAME WORK@OZ39277 10600000
CLUSNAME DS    XL8'00'       CTRL/CLUSTER NAME SAVE AREA       @OZ39277 10650000
NEWPARM  DS    C                   NEW-PARM SWITCH                      10700000
CTRPARM  DS    C                   COUNTER OF CHARS STORED IN PARM(X)   10750000
SAVETIOA DS    F                   SAVE AREA FOR ORIGINAL TIOA          10800000
SAVEBBSS DS    F                   SAVE POINTER TO BLK AND SLOT         10850000
TWASLOT  DS    C                   INPUT SLOT COUNT IN HEX              10900000
WRKSLOT  DS    C                   TWASLOT WORK AREA                    10950000
*                                  DISPLACEMENTS IN TIOA                11000000
SAVERCAP DS    F                   SAVEAREA FOR POINTER TO RECAP LINE   11050000
SAVEITEM DS    F                   SAVEAREA FOR POINTER TO FIRST LINE   11100000
*                                  AND CTRL DISPLAYS                    11150000
SLOTCNT  DS    C                   COUNT OF DETAIL SLOTS READ           11200000
ITEMCNT  DS    PL2                 COUNT OF OUTPUT ITEMS IN LINE        11250000
WORKCNT  DS    PL2                 ITEM WORK COUNTER                    11300000
WORK15   DS    CL15                                                     11350000
QUITSW   DS    C             USED TO STOP EDIT OF INPUT ON 3RD SBA      11400000
*                             IF 2ND SBA = L1P7 OR L6P26  ***ALSO*** XH 11450000
*                            USED AS MOD-1 OUTPUT-FULL-SWITCH        XH 11500000
*                               00 = NOT FULL   FF = OUTPUT FULL BUT XH 11550000
*     CONTINUE SCANNING DATA BASE FOR CORRECT ERROR COUNTS           XH 11600000
*********************************************************************** 11650000
MOD1TABL DS    CL64          MAX OF 32 ENTRIES FOR MOD-1 TABLE          11700000
*                              LOCAL TERM = 2-BYTES                     11750000
*                              REMOTE CU AND TERM = 2-BYTES             11800000
TBRELREC DS    CL3           SAVE AREA FOR PAGING 'BBB'                 11850000
TBSLOT   DS    C             SAVE AREA FOR PAGING 'SS'                  11900000
TBCTRL   DS    C             SAVE AREA FOR MDR CTRL UNIT                11950000
TBLINE   DS    CL6           SAVE AREA FOR LINE ADDR OF PAGE            12000000
TBARG    DS    CL2           SAVE AREA FOR TABLE ARGUMENT               12050000
TABLECNT DS    PL2           COUNT OF ENTRIES IN TABLE                  12100000
WKTBLCNT DS    PL2           WORK AREA FOR COUNT OF TABLE ENTRIES       12150000
MOD1SW   DS    X             00 = SWT OFF    FF = SWT ON                12200000
*                            IF ON, PERFORM MOD1 TABLE SCAN             12250000
SOUTLOOP DS    F             SAVE AREA FOR OUTLOOP REGISTER             12300000
*********************************************************************** 12350000
         COPY  DFHFIOA                                                  12400000
CTRLLAST DS    F                   LAST USED ADDR IN DATASET            12450000
CTRLTOTL DS    F                   TOTAL BLOCKS IN DATASET              12500000
CTRLBACK DS    F                   BACKWARD PTR IN CTRL BLK CHAIN       12550000
CTRLFWD  DS    F                   FORWARD PTR IN CTRL BLK CHAIN        12600000
CTRLENTS DS    C                   NBR ENTRIES IN THIS CTRL BLK         12650000
         DS    CL15                FOR FUTURE USE                       12700000
CTRLSLT1 DS    0C                  START OF CTRL SLOT NBR ONE.          12750000
         ORG   FIOADBA                                                  12800000
DATAPORT DS    CL6                 PORT & LIB ADDR                      12850000
DATATIME DS    CL4                 TIME BLOCK CREATED                   12900000
DATADATE DS    CL4                 DATE BLOCK CREATED                   12950000
DATAFWD  DS    CL3                 FORWARD CHAIN ADDR                   13000000
DATABACK DS    CL3                 BACKWAD CHAIN ADDR                   13050000
BLKLTH   DS    CL2                 NBR BYTES USED IN THIS BLOCK         13100000
         DS    CL10                                                     13150000
DATASLT1 DS    0C                  START OF 1ST DATA SLOT               13200000
SLOTS    DSECT           MAP OF ENTRIES IN CONTROL BLOCK                13250000
         USING SLOTS,DATAREG                                            13300000
SLOTLINE DS    CL6                CHANNEL ADDRESS(PORT OR LIB)          13350000
SLOTNBC  DS    CL2                NUMBER OF BLOCKS IN THIS CHAIN        13400000
SLOTHITS DS    CL2                TOTAL HITS ON THIS LINE               13450000
SLOTRFB  DS    CL3                RELATIVE ADDRESS FIRST BLOCK IN CHAIN 13500000
SLOTRLB  DS    CL3                RELATIVE ADDRESS LAST BLOCK IN CHAIN  13550000
SLOTLTH  EQU   *-SLOTS                                                  13600000
         ORG   SLOTS         MAP OF MDR AND OBR IN DETAIL BLOCKS        13650000
DATALTH  DS    C                   LTH OF THIS SLOT                     13700000
LINEIDA  DS    CL6                 LINE AND LIB ADDR                    13750000
ENTRYTYP DS    C                   ENTRY TYPE - MDR OR OBR              13800000
         DS    CL3                                                      13850000
MDRTYPE  DS    C                   TYPE HDWE - 03 EQUALS 3270           13900000
         DS    CL3                                                      13950000
DATE     DS    CL4                 DATE OF ERROR - 00YY0DDF             14000000
TIME     DS    CL4                 TIME OF ERROR - HHMMSSHH             14050000
         DS    CL8                                                      14100000
MDRCUA   DS    CL2                 MDR CHAN & UNIT ADDR                 14150000
MDRCTRL  DS    C                   MDR CTRL UNIT POLL ADDR              14200000
MDRTERM  DS    C                   MDR TERMIL POLL ADDR                 14250000
MDRSTATS DS    CL2                 REMOTE 3270 STATUS                   14300000
         DS    CL2                                                      14350000
OBRCCW   DS    CL8                 LAST CCW EXECUTED                    14400000
OBRCSW   DS    CL8                 CHANNEL STATUS WORD                  14450000
         DS    CL6                                                      14500000
OBRUCB   DS    C                                                        14550000
         DS    CL3                                                      14600000
OBRCUA   DS    CL2                 OBR CHAN & UNIT ADDR                 14650000
OBRCTRL  DS    C                                                        14700000
OBRTERM  DS    C                                                        14750000
         DS    CL12                                                     14800000
OBRSENSE DS    CL2                 OBR SENSE BYTES                      14850000
*********************************************************************** 14900000
BNGCDISP CSECT                                                          14950000
SBA      EQU   X'11'         SET BUFFER ADDRESS                         15000000
SF       EQU   X'1D'         START FIELD                                15050000
IC       EQU   X'13'         INSERT CURSOR                              15100000
UNA      EQU   X'40'         UNPROTECTED,NORMAL INTENSITY, ALPHAMERIC   15150000
PNA      EQU   X'60'         PROTECTED, NORMAL INTENSITY, ALPHAMERIC    15200000
PHA      EQU   X'E8'             PROTECTED, HIGH INTENSITY, ALPHAMERIC  15250000
MNP      EQU   X'61'             PROT,MODIFIED,NORMAL                   15300000
PIA      EQU   X'6D'             PROTECTED,MODIFIED,INVISIBLE,ALPHA     15350000
L1P1     EQU   X'4040'       LINE 1, POSITION 1  BUFFER ADDRESS.        15400000
L1P7     EQU   X'40C6'       LINE 1, POSITION 7  BUFFER ADDRESS.        15450000
L1P36    EQU   X'40E3'       LINE 1, POSITION 36 BUFFER ADDRESS.        15500000
L2P1     EQU   X'C150'       LINE 2, POSITION 1  BUFFER ADDRESS.        15550000
L2P4     EQU   X'C1D3'       PAGE FWD  BUFFER ADDR FOR 3277-2           15600000
L2P44    EQU   X'C17B'       PAGE BKWD BUFFER ADDR FOR 3277-2           15650000
L3P1     EQU   X'C260'       LINE 3, POSITION 1 BUFFER ADDRESS.         15700000
L3P4     EQU   X'C1D3'       LINE 3, POSITION 4 BUFFER ADDRESS.         15750000
L4P1     EQU   X'C3F0'       LINE 4, POSITION 1  BUFFER ADDRESS.        15800000
L4P4     EQU   X'C17B'       PAGE BKWD BUFFER ADDR FOR 3277-1           15850000
L6P26    EQU   X'C6E9'       LINE 6, POSITION 26 BUFFER ADDRESS.        15900000
TCTTEAR  EQU   2             POINTS TO TCTTE                            15950000
BASE1    EQU   3             BASE REGISTER ONE = 0-4095                 16000000
BASE2    EQU   4             BASE REGISTER TWO = 4096-8191              16050000
TIOABAR  EQU   5             POINTS TO TIOA                             16100000
FIOABAR  EQU   6             POINTS TO FIOA                             16150000
PARMREG  EQU   6             POINTS TO PARM AREA                        16200000
OUTREG   EQU   7             POINTS TO DATA IN TIOA AREA                16250000
OUTLOOP  EQU   8             USED FOR LOOPING THRU DATA IN TIOA AREA    16300000
MOD1REG  EQU   8             POINTS TO MOD-1 TABLE (MOD1TABL)           16350000
DATAREG  EQU   9             POINTS TO DATA IN FIOA AREA                16400000
DATALOOP EQU   10            USED FOR LOOPING THRU DATA IN FIOA AREA    16450000
TABLEREG EQU   11            POINTS TO FUNCTION/COMPANION TABLE         16500000
R11      EQU   11            PARMLIST COUNTER WORK REGISTER FOR CTRPARM 16550000
LINKREG  EQU   11            SUBROUTINE LINKAGE                         16600000
R14      EQU   14                                                       16650000
R15      EQU   15                                                       16700000
*********************************************************************** 16750000
         BALR  BASE1,0                                                  16800000
         USING *,BASE1,BASE2                                            16850000
BNGCDISP BNGHJN GO                                             @OZ29900 16900000
         LA    BASE2,2048(BASE1)                                        16950000
         LA    BASE2,2048(BASE2)                                        17000000
         L     TCTTEAR,TCAFCAAA                                         17050000
         LA    TCTTEAR,0(TCTTEAR)                                       17100000
         L     TIOABAR,TCTTEDA                                          17150000
         ZAP   SBACNT,=P'0'        SET SBA COUNTER TO ZERO.             17200000
         SR    DATAREG,DATAREG          CLEAR WORKREG          @OX22096 17250000
         LH    DATAREG,TIOATDL          GET TERMINAL DATA LEN  @OX22096 17300000
         BCTR  DATAREG,0                REDUCE BY ONE FOR EX   @OX22096 17350000
         EX    DATAREG,TRANS            DO DATA TRANSLATION    @OX22096 17400000
         LA    DATAREG,TIOADBA     POINT TO 1ST BYTE IN TIOA.           17450000
         LR    DATALOOP,DATAREG    SETUP DATA LOOP                      17500000
         AH    DATALOOP,TIOATDL                                         17550000
         XC    PARM1(48),PARM1     ZERO OUT PARM FIELDS                 17600000
         LA    PARMREG,PARM1       POINT TO PARMS.                      17650000
         LR    14,PARMREG                                               17700000
         MVI   QUITSW,X'00'        SET QUITSW OFF.                      17750000
         MVI   NEWPARM,C'1'        TURN ON 'NEW PARM' SWITCH.           17800000
         MVI   CTRPARM,X'00'       SET CHARS COUNTER IN PARM = ZERO     17850000
A160     CLI   0(DATAREG),SBA      IS THIS BYTE AN SBA?                 17900000
         BNE   A210                NO. CHECK IT FURTHER.                17950000
         CLI   QUITSW,X'FF'            QUIT SWITCH ON?                  18000000
         BE    C10                          YES.  QUIT EDIT.            18050000
         CLC   1(2,DATAREG),=AL2(L1P7)  IS 2ND SBA = LINE 1 POSN 7?     18100000
         BE    A170                              NO. CONTINUE EDIT      18150000
         CLC   1(2,DATAREG),=AL2(L6P26) IS 2ND SBA = LINE 6 POSN 26?    18200000
         BNE   A180                              NO. CONTINUE EDIT      18250000
A170     MVI   QUITSW,X'FF'            TURN QUIT SWITCH ON              18300000
A180     AP    SBACNT,=P'1'        YES. ADD TO TO SBA COUNTER.          18350000
         LA    DATAREG,2(DATAREG)  BUMP TIOA POINTER BY 2.              18400000
         B     B80                                                      18450000
A210     CLI   0(DATAREG),C'A'     IS IT AN 'A' OR HIGHER?              18500000
         BL    B80                 NO. CHECK NEW PARM SWITCH.           18550000
         CLI   NEWPARM,C'1'        IS FIRST CHAR FOR PARM(X)?           18600000
         BNE   B10                 NO.                                  18650000
         MVI   NEWPARM,C'0'        YES. SET FIRST CHAR IN FOR PARM      18700000
         MVI   CTRPARM,X'00'       SET PARM CHAR CTR = 0                18750000
B10      IC    R11,CTRPARM         LOAD R11 = CTRPARM                   18800000
         LA    R11,1(R11)          ADD CTRPARM = CTRPARM + 1            18850000
         STC   R11,CTRPARM         STORE NEW CTR BACK CTRPARM           18900000
         CLI   CTRPARM,X'08'       IS CHAR COUNT IN PARM OVER 8 ?       18950000
         BH    B50                 YES. GO BACK LOOP WITHOUT STORING    19000000
         MVC   0(1,14),0(DATAREG)  PUT THIS BYTE IN THIS PARM           19050000
         CLI   PARM6+7,X'00'       ARE ALL PARMS USED UP?               19100000
         BNE   C10                 YES. GOTO SYNTAX CHECKING ROUTINE    19150000
         LA    14,1(14)            BUMP PARM POINTER WORKREG.           19200000
B40      LA    DATAREG,1(DATAREG)  BUMP TIOA POINTER.                   19250000
         CR    DATAREG,DATALOOP    IS THERE MORE DATA IN TIOA?          19300000
         BL    A160                YES. GO PROCESS MORE DATA.           19350000
         B     C10                 NO. GOTO SYNTAX CHECKING ROUTINE     19400000
B50      CLC   PARM2(5),=X'F3F2F7F000'  IS THIS A 3270 SCREEN INPUT ?   19450000
         BNE   B40                      NO.                             19500000
         CP    SBACNT,=P'2'        IS THIS NON-FORMATTED INPUT ?        19550000
         BH    B40                 NO.                                  19600000
         B     Z40                 YES. SEND INVALID FORMAT MSG.        19650000
B80      CLI   NEWPARM,C'1'        IS NEW-PARM SWITCH ON?               19700000
         BE    B40                 YES. CHECK FOR MORE DATA.            19750000
         CLI   PARM6,X'00'         NO. ARE ALL PARMS USED UP?           19800000
         BNE   C10                 YES. GOTO SYNTAX CHECKING ROUTINE    19850000
         LA    PARMREG,8(PARMREG)  NO. BUMP TO NEXT NEW PARM.           19900000
         LR    14,PARMREG          POINT WORK REG TO NEXT PARM.         19950000
         MVI   NEWPARM,C'1'        TURN ON NEW-PARM SWICH.              20000000
         B     B40                 GO CHECK FOR MORE DATA.              20050000
*********************************************************************** 20100000
*                                                                     * 20150000
*        AT THIS POINT UP TO 5 PARMS HAVE BEEN EDITED AND             * 20200000
*        ARE LEFT JUSTIFIED WITH TRAILING X'00'S                      * 20250000
*                                                                     * 20300000
*********************************************************************** 20350000
         EJECT                                                          20400000
*********************************************************************** 20450000
*                                                                     * 20500000
*        SYNTAX CHECKING ROUTINE                                      * 20550000
*                                                                     * 20600000
*********************************************************************** 20650000
C10      CLI   QUITSW,X'FF'            IS SBA QUIT SWT ON ?             20700000
         BE    C15                     YES. DATA ENTERED FROM 29 AREA   20750000
         CP    SBACNT,=P'1'            NO. IS SBACNT > 1 ?              20800000
         BH    CC10                    YES. BYPASS SYNTAX CHECK         20850000
         CLI   PARM2,X'00'             IS PARM2 BLANK ?                 20900000
         BE    D80                     YES. GOTO BNGCMENU               20950000
C15      CLC   PARM2(5),=X'D4C5D5E400' IS PARM2=MENU ?                  21000000
         BNE   C20                     NO                               21050000
         CLI   PARM3,X'00'             IS PARM3 = 00 ?                  21100000
         BE    D80                     YES. GOTO BNGCMENU               21150000
         B     Z40                     NO. GO ISSUE INVALID FORMAT MSG  21200000
C20      CLC   PARM2(4),=X'C1D3D300'   IS PARM2 = ALL ?                 21250000
         BNE   C30                     NO                               21300000
         CLI   PARM3,X'00'             IS PARM3 = 00 ?                  21350000
         BE    CC10                    YES.GO SCHEDULE APPROPRIATE PGM  21400000
         B     Z40                     NO. GO ISSUE INVALID FORMAT MSG  21450000
C30      CLC   PARM2(6),=X'D3D6C3C1D300'  IS PARM2 = LOCAL ?            21500000
         BNE   C40                        NO                            21550000
         CLI   PARM3,X'00'             IS PARM3 = 00 ?                  21600000
         BE    CC10                   YES.GO SCHEDULE APPROPRIATE PGM   21650000
         CLC   PARM3+1(2),=C'SS'       IS LOCAL/REMOTE SCREEN ?         21700000
         BE    CC10                   YES.                              21750000
         B     Z40                     NO. GO ISSUE INVALID FORMAT MSG  21800000
C40      CLC   PARM2(6),=X'D9C5D4D6E3C5' IS PARM2 = REMOTE ?            21850000
         BNE   C50                     NO.                              21900000
         CLC   PARM2+7(1),=C'S'        IS REMOTE SCREEN ?               21950000
         BE    C45                     YES.                             22000000
         CLI   PARM2+6,X'00'           IS REMOTE SYNTAX ERROR ?         22050000
         BNE   Z40                     YES. GO ISSUE INVALID FORMAT MSG 22100000
         CLI   PARM3,X'00'             IS PARM3 = 00 ?                  22150000
         BE    CC10                   YES.GO SCHEDULE APPROPRIATE PGM   22200000
         B     Z40                     NO. GO ISSUE INVALID FORMAT MSG  22250000
C45      CLI   PARM3,X'00'             IS REMOTE SCREEN ?               22300000
         BNE   CC10                   YES.                              22350000
         B     Z40                     NO. GO ISSUE INVALID FORMAT MSG  22400000
C50      CLC   PARM2(5),=X'D3C9D5C500' IS PARM2 = LINE ?                22450000
         BNE   C60                     NO                               22500000
         CLI   PARM4,X'00'             IS PARM4 = 00 ?                  22550000
         BNE   Z40                     NO. GO ISSUE INVALID FORMAT MSG  22600000
C55      CLI   PARM3+3,X'00'           LINE ADDR = 4 OR MORE ?          22650000
         BNE   Z40                     YES.                             22700000
         CLI   PARM3+2,X'00'           LINE ADDR = 2 OR LESS ?          22750000
         BE    Z40                     YES.                             22800000
         LA    DATALOOP,3              SET FOR SCAN 3 CHARS             22850000
         LA    DATAREG,PARM3           SET DATAREG = PARM3 PTR          22900000
C57      CLI   0(DATAREG),X'F0'        IS BYTE(PARM3) >= C'0' ?         22950000
         BNL   C59                     YES. IT IS NUMERIC               23000000
         CLI   0(DATAREG),X'C6'        IS BYTE(PARM3) > C'F' ?          23050000
         BH    Z40                     YES. IT IS INVALID FORMAT        23100000
C59      LA    DATAREG,1(DATAREG)      BUMP TO NEXT BYTE OF PARM3       23150000
         BCT   DATALOOP,C57            LOOP                             23200000
         B     CC10                    NO. GO SCHEDULE APPROPRIATE PGM  23250000
C60      CLC   PARM2(5),=X'C3E3D9D300' IS PARM2 = CTRL ?                23300000
         BNE   C70                     NO                               23350000
         CLI   PARM5,X'00'             IS PARM5 = 00 ?                  23400000
         BNE   Z40                     NO.                              23450000
         CLI   PARM4,X'00'             IS PARM4 = 00 ?                  23500000
         BE    C55                     YES.                             23550000
C65      CLI   PARM4+2,X'00'           CTRL ADDR = 3 OR MORE ?          23600000
         BNE   Z40                     YES.                             23650000
         CLI   PARM4+1,X'00'           CTRL ADDR = 1 OR LESS ?          23700000
         BE    Z40                     YES.                             23750000
C66      LA    DATALOOP,2              SET FOR SCAN 2 CHARS             23800000
         LA    DATAREG,PARM4           SET DATAREG = PARM4 PTR          23850000
C67      CLI   0(DATAREG),X'F0'        IS BYTE(PARM3) >= C'0' ?         23900000
         BNL   C69                     YES. IT IS NUMERIC               23950000
         CLI   0(DATAREG),X'C6'        IS BYTE(PARM3) > C'F' ?          24000000
         BH    Z40                     YES. IT IS INVALID FORMAT        24050000
C69      LA    DATAREG,1(DATAREG)      BUMP TO NEXT BYTE OF PARM3       24100000
         BCT   DATALOOP,C67            LOOP                             24150000
         B     C55                     NO. GO CHECK LINE ADDR (PARM3)   24200000
C70      CLC   PARM2(5),=X'F3F2F7F000' IS PARM2 = 3270 ?                24250000
         BNE   Z40                     NO.                              24300000
         CLI   PARM6,X'00'             IS PARM6 = 00 ?                  24350000
         BNE   Z40                     NO.                              24400000
         CLI   PARM5,X'00'             IS PARM5 = 00 ?                  24450000
         BE    C75                     YES.                             24500000
         CLI   PARM5+2,X'00'           IS TERMINAL ADDR = 3 OR MORE ?   24550000
         BNE   Z40                     YES.                             24600000
         CLI   PARM5+1,X'00'           IS TERMINAL ADDR = 1 OR LESS ?   24650000
         BE    Z40                     YES.                             24700000
         LA    DATALOOP,2              SET FOR SCAN 2 CHARS             24750000
         LA    DATAREG,PARM5           SET DATAREG = PARM5 PTR          24800000
C72      CLI   0(DATAREG),X'F0'        IS BYTE(PARM3) >= C'0' ?         24850000
         BNL   C74                     YES. IT IS NUMERIC               24900000
         CLI   0(DATAREG),X'C6'        IS BYTE(PARM3) > C'F' ?          24950000
         BH    Z40                     YES. IT IS INVALID FORMAT        25000000
C74      LA    DATAREG,1(DATAREG)      BUMP TO NEXT BYTE OF PARM3       25050000
         BCT   DATALOOP,C72            LOOP                             25100000
         B     C65                     NO. GO CHK LINE AND CTRL         25150000
C75      CLI   PARM4,X'00'             IS PARM4 = 00 ?                  25200000
         BNE   Z40                     NO.                              25250000
         CLI   PARM3,X'00'             IS PARM3 = 00 ?                  25300000
         BE    D10                     YES. BRANCH TO BNGC3270          25350000
*********************************************************************** 25400000
*                                                                     * 25450000
*     THE FOLLOWING CODE CHECKS FOR A CICS SYMBOLIC MATCH             * 25500000
*                                                                     * 25550000
*********************************************************************** 25600000
         MVC   WORK15(8),PARM3         SAVE PARM3                       25650000
         OC    PARM3,=CL8' '           MAKE ZEROS                       25700000
         BAL   LINKREG,CICSLOC         CALL SYMBOLIC NAME CONV. RTN     25750000
         CLI   PARM3+7,X'00'           IS NAME CONVERTED ?              25800000
         BE    D10                     YES. BYPASS SYNTAX CHK           25850000
         MVC   PARM3,WORK15            NO. RESTO PARM3-CONT. SYNTAX CHK 25900000
*        ******************            **************************       25950000
         CLI   PARM3+3,X'00'           IS TERM/LINE = 4 OR MORE ?       26000000
         BNE   Z70                     YES. GO ISSUE SYMBOLIC ERR MSG   26050000
         CLI   PARM3+2,X'00'           IS TERM/LINE = 2 OR LESS ?       26100000
         BE    Z70                     YES. GO ISSUE SYMBOLIC ERR MSG   26150000
         LA    DATALOOP,3              SET FOR SCAN 3 CHARS             26200000
         LA    DATAREG,PARM3           SET DATAREG = PARM3 PTR          26250000
C77      CLI   0(DATAREG),X'F0'        IS BYTE(PARM3) >= C'0' ?         26300000
         BNL   C79                     YES. IT IS NUMERIC               26350000
         CLI   0(DATAREG),X'C6'        IS BYTE(PARM3) > C'F' ?          26400000
         BH    Z70                     YES. IT IS SYMBOLIC ERROR        26450000
C79      LA    DATAREG,1(DATAREG)      BUMP TO NEXT BYTE OF PARM3       26500000
         BCT   DATALOOP,C77            LOOP                             26550000
*********************************************************************** 26600000
*                                                                     * 26650000
*        AT THIS POINT UP TO 5 PARMS HAVE BEEN EDITED AND             * 26700000
*        ARE LEFT JUSTIFIED WITH TRAILING X'00'S                      * 26750000
*                                                                     * 26800000
*********************************************************************** 26850000
CC10     CP    SBACNT,=P'3'        CNT OF SBA LESS THAN THREE           26900000
         BL    D10                 YES,THIS IS INIT ENTRY               26950000
*********************************************************************** 27000000
*                                                                     * 27050000
*        ENTRY IS FROM A FORMATTED SCREEN. THEREFORE,                 * 27100000
*        THIS SECTION TRANSFERS CONTROL TO APPROPRIATE                * 27150000
*        COMPANION PROGRAM.                                           * 27200000
*                                                                     * 27250000
*********************************************************************** 27300000
         CLC   PARM2(4),=C'MENU'   IS THIS MENU SCREEN ?                27350000
         BE    D32                 YES. GO CHECK MENU PARAMETERS        27400000
         CLI   TIOADBA+35,C'%'     IS THIS FROM BITS PROMPTER SCR ?  XH 27450000
         BE    C190                YES. GOTO BNGC3270                XH 27500000
         CLI   PARM4,X'00'         IS PARM4 BLANK ?                     27550000
         BE    D80                 YES. USER DID NOT X ANY ENTRIES      27600000
         CLC   TIOADBA+15(2),=X'C1D3'   IS THIS A PAGE FORWARD-LG       27650000
*                                       OR A PAGE BACKWARD-SM?          27700000
         BNE   CC40                YES.                              BB 27750000
         CLI   TCTTETM,X'F1'       IS THIS A 3277-1?                 BB 27800000
         BE    CC60                YES. DO PAGE BACKWARD-SM.         BB 27850000
         B     CC50                NO. DO PAGE FORWARD-LG.           BB 27900000
CC40     CLC   TIOADBA+15(2),=X'C17B'   IS THIS A PAGE BACKWRD-LG?   BB 27950000
         BE    CC60                YES.                              BB 28000000
         CLC   TIOADBA+15(2),=X'406B'   IS THIS A PAGE FORWARD-SM?   BB 28050000
         BNE   C109                NO. MUST BE BLOWUP REQUEST        BB 28100000
CC50     MVC   PARM4(4),=C'PAGE'    SET UP PARMS FOR PAGING          BB 28150000
         MVC   PARM5(7),=C'FORWARD'     FORWARD.                     BB 28200000
         B     D10                  GO TO APPROPRIATE PGM.           BB 28250000
CC60     MVC   PARM4(4),=C'PAGE'    SET UP PARMS FOR PAGING          BB 28300000
         MVC   PARM5(7),=C'BACKWRD'     BACKWARD.                    BB 28350000
         B     D10                  GO TO APPROPRIATE PGM.           BB 28400000
*********************************************************************** 28450000
*                                                                     * 28500000
*     AT THIS POINT, THE REQUEST IS FOR A BLOWUP OF AN ENTRY OF ONE   * 28550000
*     OF THE DISPLAYS. THE FUNCTION/COMPANION TABLE IS SEARCHED FOR   * 28600000
*     THE NAME OF THE PROGRAM TO PERFORM THE NEXT DISPLAY.            * 28650000
*                                                                     * 28700000
*********************************************************************** 28750000
C109     LA    TABLEREG,TABLE      POINT AT FUNCTION/COMPANION TABLE.   28800000
C110     CLC   0(4,TABLEREG),PARM2 PGRM NAME IN TABLE?                  28850000
         BE    C170                YES.                                 28900000
         CLC   0(3,TABLEREG),=C'END'    END OF TABLE?                   28950000
         BE    D30                 YES. GO CK FOR MENU REQUEST          29000000
         LA    TABLEREG,TABLENTY(TABLEREG)  BUMP TO NEXT ENTRY.         29050000
         B     C110                GO CH NEXT ENTRY.                    29100000
C170     OC    4(4,TABLEREG),4(TABLEREG) IS THERE A COMPANION PGRM?     29150000
         BZ    D10                       NO.                            29200000
         MVC   PARM2(4),4(TABLEREG)      MOVE COMPANION NAME TO PARM2.  29250000
         CLC   PARM2(4),=C'TERM'   IS THIS A TERML ERROR REQUEST?       29300000
         BNE   D10                 NO.                                  29350000
C190     DFHPC TYPE=XCTL,PROGRAM=BNGC3270                               29400000
*********************************************************************** 29450000
*                                                                     * 29500000
*        THE FOLLOWING CODE CHECKS ALL SINGLE PARM ENTRIES FOR        * 29550000
*        A CICS SYMBOLIC MATCH.                                       * 29600000
*                                                                     * 29650000
*********************************************************************** 29700000
*********************************************************************** 29750000
*                                                                     * 29800000
*        THIS IS THE CICS SYMBOLIC NAME LOCATE/CONVERT ROUTINE.       * 29850000
*                                                                     * 29900000
*********************************************************************** 29950000
CICSLOC  L     14,CSATCTBA         POINT TO TCT PREFIX.                 30000000
         L     14,4(14)            POINT TO BTAM ADCON LIST.            30050000
D0510    CLC   0(4,14),=X'FFFFFFFF'  ANY MORE LINES TO LOOK AT?         30100000
         BE    D0600               NO. LINE NAME NOT IN CICS TCT.--EXIT 30150000
         L     1,0(14)             POINT TO A LINE.                     30200000
         ST    1,TWALINE           STORE ADDR IN CASE THIS IS IT.       30250000
         TM    TCTLELF,TCTLEFAA    IS THIS A POOLED LINE?               30300000
         BZ    D0520               NO.                                  30350000
         TM    TCTLEPI,TCTLEMFP    YES. IS IT 1ST IN POOL?              30400000
         BZ    D0540               NO. SKIP IT - DOESN'T POINT TO DCB.  30450000
D0520    L     15,TCTLEPA          YES. POINT TO 1ST TERML.             30500000
D0530    CLC   PARM3(4),0(15)      IS THIS OUR TERML?                   30550000
         BE    D0550               YES. HAVE LOCATED ITS LINE ENTRY.    30600000
         TM    (TCTTELT-TCTTETI)(15),TCTTECLT  LAST TERML ON LINE?      30650000
         BO    D0540               YES. GO LOOK AT NEXT LINE.           30700000
         AH    15,(TCTTETEL-TCTTETI)(15)  BUMP TO NEXT TERML.           30750000
         B     D0530                                                    30800000
D0540    LA    14,4(14)            BUMP TO NEXT LINE ADDRESS.           30850000
         B     D0510                                                    30900000
D0550    EQU   *                                                        30950000
         LR    TCTTEAR,15                                               31000000
         CLI   TCTTETT,X'91'       IS THIS A 3277 REMOTE?               31050000
         BE    D0560               YES.                                 31100000
         CLI   TCTTETT,X'92'       IS THIS A 3275?                      31150000
         BE    D0560               YES.                                 31200000
         CLI   TCTTETT,X'99'       IS THIS A 3277 LOCAL?                31250000
         BE    D0560               YES.                                 31300000
         CLI   TCTTETT,X'93'            IS THIS REMOTE 3284    @OX22763 31350000
         BE    D0560                    YES                    @OX22763 31400000
         CLI   TCTTETT,X'94'            IS THIS REMOTE 3286    @OX22763 31450000
         BE    D0560                    YES                    @OX22763 31500000
         CLI   TCTTETT,X'9B'            IS THIS LOCAL 3284     @OX22763 31550000
         BE    D0560                    YES                    @OX22763 31600000
         CLI   TCTTETT,X'9C'            IS THIS LOCAL 3286     @OX22763 31650000
         BE    D0560                    YES                    @OX22763 31700000
         B     D0590               NO. CAN'T USE SYMBOLIC NAME--EXIT    31750000
D0560    L     1,TWALINE           POINT TO THIS TERML'S LINE.          31800000
         L     14,TCTLEDCB         POINT TO THE DCB.                    31850000
         USING IHADCB,14                                                31900000
         DCBD                                                           31950000
BNGCDISP CSECT                                                          32000000
         SR    15,15                                                    32050000
         TM    TCTTETT,X'60'       IS THIS A LOCAL DEVICE?     @OX25587 32100000
         BNZ   NOTLOCL1            NO                          @OX25587 32150000
         TM    TCTTETT,X'98'       IS THIS A LOCAL DEVICE?     @OX25587 32200000
         BO    D0570               YES. GET REL NBR FROM TE    @OX25587 32250000
NOTLOCL1 IC    15,TCTLERLN         NO. GET REL NBR FROM LE     @OX25587 32300000
         B     D0572                                                    32350000
D0570    IC    15,TCTTEGU                                               32400000
D0572    TM    DCBOFLGS,DCBOFOPN  DCB OPEN ?                   @OZ37867 32450000
         BNO   D0600               NO, CAN NOT GET TO UCB      @OZ37867 32500000
         L     1,DCBDEBAD          POINT TO THE DEB.           @OZ37867 32550000
         LA    1,32(1)             POINT TO LIST OF UCBS.               32600000
D0574    BCT   15,D0576                                                 32650000
         B     D0578                                                    32700000
D0576    LA    1,4(1)              BCT TO APPROPRIATE RLN UCB.          32750000
         B     D0574                                                    32800000
D0578    L     1,0(1)              POINT TO THE UCB.                    32850000
         XC    PARM3,PARM3                                              32900000
         MVC   PARM3(3),13(1)      MOVE LINEID TO INPUT PARM FIELD.     32950000
         TM    TCTTETT,X'60'       IS THIS A LOCAL 3270?       @OX25587 33000000
         BNZ   NOTLOCL2            YES NOT LOCAL.              @OX25587 33050000
         TM    TCTTETT,X'98'       IS THIS A LOCAL 3270?       @OX25587 33100000
         BO    D0590               YES. BYPASS POLL CHARS.     @OX25587 33150000
NOTLOCL2 L     14,TCTTETA          POINT TO ADDRESSING LIST.   @OX25587 33200000
         UNPK  DUBLWD,0(2,14)      GET CTRL UNIT ADDRESS.               33250000
         TR    DUBLWD,HXTOEB       CONVERT IT TO 2 EBCDIC CHARS.        33300000
         MVC   PARM4(2),DUBLWD+5   MOVE THEM TO INPUT PARM FIELD.       33350000
         NI    PARM4,X'FD'         CONVERT REMOTE CU TO ACTUAL CU NUM   33400000
         CLI   0(14),X'61'         SPECIAL CASE                @OX25492 33450000
         BNE   TESTF0              NO, CHECK AGAIN             @OX25492 33500000
TESTC3   MVI   PARM4,X'C3'         YES                         @OX25492 33550000
         B     OUT1                CNTL POLL CHAR COMPLETE     @OX25492 33600000
TESTF0   CLI   0(14),X'F0'         SECOND SPECIAL CASE         @OX25492 33650000
         BNE   TESTE0              NO, WAS '2' BYTE ANDED      @OX25492 33700000
         MVI   PARM4,X'F5'         YES                         @OX25492 33750000
         B     OUT1                CNTL POLL CHAR COMPLETE     @OX25492 33800000
TESTE0   TM    0(14),X'10'         TEST FOR '1' BYTE           @OX25492 33850000
         BO    OUT1                NOT 'E'                     @OX25492 33900000
         TM    0(14),X'E0'         CHECK FOR 'E'               @OX25492 33950000
         BO    TESTC3              YES, MAKE IT AN 'E'         @OX25492 34000000
OUT1     EQU   *                                               @OX25492 34050000
         UNPK  DUBLWD,2(2,14)      GET TERML ADDRESS.                   34100000
         TR    DUBLWD,HXTOEB       CONVERT IT TO 2 EBCDIC CHARS.        34150000
         MVC   PARM5(2),DUBLWD+5   MOVE THEM TO INPUT PARM FIELD.       34200000
D0590    EQU   *                                                        34250000
         MVC   TWALINE,TCTTETI     SAVE CICS SYMBOLIC NAME FOR          34300000
*                                  3270 PROGRAM.                        34350000
         L     TCTTEAR,TCAFCAAA    POINT BACK TO ORIGINAL TCT           34400000
         LA    TCTTEAR,0(TCTTEAR)  CLEAR HIGH ORDER BYTE FROM ADDR      34450000
         BR    LINKREG                                                  34500000
D0600    XC    TWALINE,TWALINE                                          34550000
         BR    LINKREG                                                  34600000
*********************************************************************** 34650000
*                                                                     * 34700000
*        THIS SECTION TRANSFERS CONTROL TO APPROPRIATE PROGRAM.       * 34750000
*                                                                     * 34800000
*********************************************************************** 34850000
D10      LA    TABLEREG,TABLE      POINT AT FUNCTION/COMPANION TABLE.   34900000
D20      CLC   0(4,TABLEREG),PARM2 PROGRAM NAME IN TABLE?               34950000
         BE    D25                 YES.                                 35000000
         CLC   0(3,TABLEREG),=C'END' END OF TABLE?                      35050000
         BE    D30                 YES. GO TO CK MENU REQUEST           35100000
         LA    TABLEREG,TABLENTY(TABLEREG)  BUMP TO NEXT ENTRY.         35150000
         B     D20                 GO CHECK NEXT ENTRY.                 35200000
D25      CLI   4(TABLEREG),X'00'   IS THERE A PGRM NAME TO XCTL TO?     35250000
         BNE   E10                 NO.                                  35300000
         MVC   TCAPCPI,8(TABLEREG) STORE NAME IN TCA.                   35350000
         DFHPC TYPE=XCTL                                                35400000
D30      CLC   PARM2(4),=C'MENU'                                        35450000
         BNE   D80                 NO.                                  35500000
D32      CLI   TCTTETM,X'F1'       IS THIS A 3277 MODEL 1?              35550000
         BE    D50                 YES.                                 35600000
         CLC   TIOADBA+15(2),=X'4AD6' LARGE MENU 'ALL' = L9P23          35650000
         BE    D40                 YES.                                 35700000
         CLC   TIOADBA+15(2),=X'4BE6' LARGE MENU '3270'= L10P23         35750000
         BE    D41                 YES.                                 35800000
         CLC   TIOADBA+15(2),=X'4CF6' LARGE MENU 'RMOT'= L11P23         35850000
         BE    D42                 YES.                                 35900000
         CLC   TIOADBA+15(2),=X'4FD6' LARGE MENU 'LOCL'= L13P23         35950000
         BNE   D80                 NO. MUST BE FOR MENU.                36000000
D35      DFHPC TYPE=XCTL,PROGRAM=BNGCLOCL YES. GO TO LOCAL PROG.        36050000
D40      MVC   PARM2(3),=C'ALL'    SETUP TO                             36100000
         LA    TABLEREG,TABLE          DO                               36150000
         ZAP   SBACNT,=P'1'        ALL LINES DISPLAY.                   36200000
         B     E10                                                      36250000
D41      XC    PARM2(32),PARM2     CLEAR PARMS FOR TRANSFER             36300000
         MVC   PARM2(4),=C'3270'   SETUP TO DO                          36350000
         ZAP   SBACNT,=P'1'        3270  DISPLAY.                       36400000
         DFHPC TYPE=XCTL,PROGRAM=BNGC3270                               36450000
D42      DFHPC TYPE=XCTL,PROGRAM=BNGCRMOT                               36500000
D50      CLC   TIOADBA+15(2),=X'C17A' SMALL MENU 'ALL' = L4P3           36550000
         BE    D40                 YES.                                 36600000
         CLC   TIOADBA+15(2),=X'C2E2' SMALL MENU '3270'= L5P3           36650000
         BE    D41                 YES.                                 36700000
         CLC   TIOADBA+15(2),=X'C34A' SMALL MENU 'RMOT'= L6P3           36750000
         BE    D42                 YES.                                 36800000
         CLC   TIOADBA+15(2),=X'C45A' SMALL MENU 'LOCL'= L8P3           36850000
         BE    D35                 YES.                                 36900000
D80      DFHPC TYPE=XCTL,PROGRAM=BNGCMENU                               36950000
*********************************************************************** 37000000
*                                                                     * 37050000
*        AT THIS POINT IT HAS BEEN DETERMINED THAT THE REQUEST IS FOR * 37100000
*        ALL LINES, LINE, OR CTRL. THIS MODULE HANDLES THOSE DISPLAYS.* 37150000
*                                                                     * 37200000
*********************************************************************** 37250000
         EJECT                                                          37300000
*********************************************************************** 37350000
*                                                                     * 37400000
*        THIS SECTION CREATES THE COMMON HEADER FOR                   * 37450000
*        ALL LINES, ONE LINE, AND CTRL.                               * 37500000
*                                                                     * 37550000
*********************************************************************** 37600000
E10      MVC   SAVETIOA,TCTTEDA    SAVE ORIGINAL TIOA ADDRESS.          37650000
*                                  GET TIOA BIG ENOUGH FOR OUTPUT       37700000
         DFHSC TYPE=GETMAIN,CLASS=TERM,NUMBYTE=2080,INITIMG=00 @OZ59145 37750000
         L     TIOABAR,TCASCSA     POINT TO NEW TIOA                    37800000
         ST    TIOABAR,TCTTEDA     POINT TO NEW TIOA                    37850000
         LA    OUTREG,TIOADBA      POINT TO START OF OUTPUT DATA AREA   37900000
         MVC   0(HDR1LTH,OUTREG),HDR1        MOVE STANDARD FIRST LINE.  37950000
         MVC   HDR1LTH(4,OUTREG),0(TABLEREG) MOVE NAME OF THIS          38000000
*                                            DISPLAY TO TIOA.           38050000
         OC    HDR1LTH(4,OUTREG),=CL4' '     CHANGE ALL'00' TO ALL' '   38100000
         LA    OUTREG,HDR1LTH+4(OUTREG)      UPDATE DATA POINTER.       38150000
         CLI   TCTTETM,X'F1'       IS THIS A 3277 MODEL 1?              38200000
         BE    E150                YES.                                 38250000
         MVC   0(3,OUTREG),HDR1X   MOVE SBA L2P1 FOR MOD 2.             38300000
         LA    OUTREG,3(OUTREG)                                         38350000
E150     MVC   0(HDR2LTH,OUTREG),HDR2   MOVE PAGE-FOWARD HEADER TO TIOA 38400000
         MVC   HDR2LTH(HDR3LTH,OUTREG),HDR3  MOVE PAGE-BACK HEADER      38450000
         LA    OUTREG,HDR2LTH+HDR3LTH-15(OUTREG)                        38500000
         ST    OUTREG,SAVEBBSS     SAVE POINTER TO BBBSS IN TIOA        38550000
         LA    OUTREG,15(OUTREG)                                        38600000
         ST    OUTREG,SAVERCAP     SAVE POINTER TO RECAP LINE           38650000
         MVC   0(41,OUTREG),16(TABLEREG)  MOVE RECAP HEADER TO TIOA     38700000
         LA    OUTREG,41(OUTREG)                                        38750000
         CLI   TCTTETM,C'1'        IS THIS A MODEL 1?                   38800000
         BE    F30                 YES.                                 38850000
         MVC   0(3,OUTREG),HDR3X   MOVE SBA L4P1 FOR MOD 2.             38900000
         LA    OUTREG,3(OUTREG)                                         38950000
F30      MVC   0(41,OUTREG),57(TABLEREG)  MOVE COLUMN HEADER TO TIOA.   39000000
         LA    OUTREG,41(OUTREG)                                        39050000
         ST    OUTREG,SAVEITEM     SAVE POINTER TO FIRST LINE ITEM      39100000
         CLI   TCTTETM,X'F1'       IS THIS A MODEL 1?                   39150000
         BE    F130                YES.                                 39200000
         MVC   0(41,OUTREG),57(TABLEREG)  MOVE COLUMN HEADER AGAIN      39250000
         LA    OUTREG,41(OUTREG)                                        39300000
         ST    OUTREG,SAVEITEM     SAVE POINTER TO FIRST LINE ITEM      39350000
         LA    OUTLOOP,80          SETUP FOR 80 LINE ITEMS FOR MOD 2    39400000
         B     F150                                                     39450000
F130     LA    OUTLOOP,14          SETUP FOR 14 LINE ITEMS FOR MOD 1    39500000
*********************************************************************** 39550000
*                                                                     * 39600000
*        THIS SECTION BUILDS THE APPROPRIATE DISPLAY                  * 39650000
*                                                                     * 39700000
*********************************************************************** 39750000
F150     CP    SBACNT,=P'2'        IS COUNT OF SBA'S LESS THAN 3?       39800000
         BH    R10                 NO. GO TO CONTINUATION SCREEN.       39850000
F180     XC    RELREC,RELREC       POINT TO FIRST CONTROL BLOCK.        39900000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=G120,DATASET=EMFILE       39950000
F190     UNPK  DBLWD,TCAFCAA(3)                                      PH 40000000
         MVC   IOERCODE(2),DBLWD+3                                      40050000
         TR    IOERCODE,HXTOEB     MOVE CICS RETURN CODE TO I/O ERR MSG 40100000
         UNPK  DBLWD,RELREC(4)                                          40150000
         MVC   IOERBLK,DBLWD+4     MOVE BLK NBR THAT WAS BEING READ     40200000
         TR    IOERBLK,HXTOEB                                           40250000
         LA    DATAREG,X'0'             LOAD MSG NUMBER        @OX22095 40300000
F240     B     Z80                                                      40350000
IOERMSG  DC    AL2(IOERLTH-4),X'0000'                                   40400000
         DC   AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)     40450000
         DC    CL34' ',AL1(SF,PNA),CL39' '                              40500000
         DC    CL39'BNG001A C I/O ERR READING SYS1.DEMFLOG '   @OX21950 40550000
         DC    CL28'  THE CICS RESPONSE CODE IS '              @OX21950 40600000
IOERCODE DC    CL4'00  '                                       @OX21950 40650000
         DC    CL9' '                                                   40700000
         DC    CL34'THE BDAM RELATIVE BLOCK NUMBER IS  '                40750000
IOERBLK  DC    CL3'000'                                                 40800000
IOERLTH  EQU   *-IOERMSG                                                40850000
G120     L     FIOABAR,TCAFCAA     POINT TO FIOA AREA.                  40900000
         OC    CTRLENTS,CTRLENTS   ANY LINE ENTRIES?                    40950000
         BZ    Z30                 NO. WRITE 'NO LINE ERRORS'           41000000
         SR    DATALOOP,DATALOOP                                        41050000
         IC    DATALOOP,CTRLENTS   SET LOOP CTR FOR READING SLOTS.      41100000
         LA    DATAREG,CTRLSLT1    POINT TO FIRST SLOT IN BLOCK.        41150000
         CLC   PARM2(3),=C'ALL'    DOES PARM2 = ALL?                    41200000
         BE    J10                 YES.                                 41250000
         OC    PARM3,PARM3         WAS A LINE ADDRESS ENTERED?          41300000
         BZ    Z40                 NO. WRITE 'NO LINE ENTERED'          41350000
         MVC   LINENAME,PARM3           MOVE LINE ADDRESS TO SAVE AREA  41400000
         MVC   CLUSNAME,PARM4           MOVE CONTROL UNIT NAME TO SAVE  41450000
         MVC   MSG7CTRL,PARM4           MOVE CTRL ADDR TO ERRS MSG AREA 41500000
         OC    MSG7CTRL,=CL8' '                                         41550000
         MVC   NOLINE,PARM3        MOVE LINE ADDRESS TO 'NO ERROR' MSG  41600000
         OC    NOLINE,=CL3' '                                           41650000
         MVC   MSG7LINE,NOLINE     MOVE LINE ADDRESS TO 'NO ERRORS'     41700000
*                                  FOR CONTROL UNIT                     41750000
H40      TR    PARM3(3),EBTOHX     CHANGE F0C6F2 TO 000F02 ETC.         41800000
         PACK  DBLWD,PARM3(4)      PACK   000F02 TO 0000F2 ETC.         41850000
         MVC   LINEID(3),DBLWD+4   MOVE GOOD PORTION TO SAVE AREA       41900000
         MVC   LINEID+3(3),=XL3'000000'                                 41950000
H80      CLC   SLOTLINE,LINEID     IS THIS CONTROL SLOT FOR OUR LINE?   42000000
         BE    L60                 YES. GO GET DETAIL BLOCK.            42050000
         LA    DATAREG,SLOTLTH(DATAREG)   POINT TO NEXT SLOT.           42100000
         BCT   DATALOOP,H80        CHECK NEXT SLOT.                     42150000
         CLC   CTRLFWD,=F'0'       MORE CONTROL BLOCKS?                 42200000
         BE    Z10                      NO. GO WRITE 'NO LINE ERRORS'   42250000
         MVC   RELREC,CTRLFWD+1    POINT TO NEXT BLK TO BE READ.        42300000
         DFHFC TYPE=RELEASE                                             42350000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=H180,DATASET=EMFILE       42400000
         B     F190                BRANCH IF I/O ERROR.                 42450000
H180     L     FIOABAR,TCAFCAA     POINT TO FIOA                        42500000
         SR    DATALOOP,DATALOOP                                        42550000
         IC    DATALOOP,CTRLENTS   SET SLOT LOOP CONTROL                42600000
         LA    DATAREG,CTRLSLT1    POINT TO FIRST SLOT.                 42650000
         B     H80                                                      42700000
*********************************************************************** 42750000
*                                                                     * 42800000
*        THIS SECTION FORMATS 'ALL LINE' ENTRIES                      * 42850000
*                                                                     * 42900000
*********************************************************************** 42950000
J10      L     14,SAVEBBSS         LOAD SAVED ADDR OF BLK/SLOT TIOA.    43000000
         MVC   0(5,14),=C'00001'   MOVE 00001 TO FIRST AND              43050000
         MVC   10(5,14),0(14)      PREVIOUS BBBSS'S                     43100000
J40      MVC   PARM1(6),SLOTLINE   SETUP LINE ADDRESS FOR               43150000
J110     UNPK  DBLWD,SLOTLINE(4)   UNPK LINE ADDR IN WORKAREA           43200000
         TR    DBLWD+4(3),HXTOEB   CONVERT TO EBCDIC                    43250000
         MVC   DTLITEM,=CL8' '     CLEAR DETAIL LINE ITEM               43300000
         MVC   DTLITEM(3),DBLWD+4  PUT LINE ADDR IN DETAIL ENTRY        43350000
J150     LH    14,SLOTHITS         PUT LINE ERRORS IN REG.              43400000
         CVD   14,DBLWD            CONVERT TO DECIMAL                   43450000
         UNPK  DTLCOUNT,DBLWD+5(3) PUT LINE ERROR COUNT                 43500000
         OI    DTLCOUNT+3,X'F0'    IN OUTPUT                            43550000
         MVC   0(DTLLTH,OUTREG),DTLENTRY MOVE DETAIL ENTRY TO OUTPUT    43600000
         MVC   DTLCOUNT,=C'0001'   RESTORE PROGRAM CONSTANT.            43650000
         LA    OUTREG,DTLLTH(OUTREG) UPDATE OUTPUT POINTER              43700000
         BCT   DATALOOP,K100       MORE SLOTS IN THIS CTRL BLK?         43750000
         CLC   CTRLFWD,=F'0'       NO. MORE CTRL BLKS?                  43800000
         BE    K120                NO. PREPARE TO EXIT.                 43850000
         MVC   RELREC,CTRLFWD+1    POINT TO NEXT BLK TO BE READ.        43900000
         DFHFC TYPE=RELEASE                                             43950000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=K50,DATASET=EMFILE        44000000
         B     F190                I/O ERROR                            44050000
K50      L     FIOABAR,TCAFCAA     POINT TO FIOA                        44100000
         SR    DATALOOP,DATALOOP                                        44150000
         IC    DATALOOP,CTRLENTS   SET LOOP CONTROL.                    44200000
         LA    DATAREG,CTRLSLT1    POINT TO FIRST SLOT                  44250000
         B     J40                                                      44300000
K100     LA    DATAREG,SLOTLTH(DATAREG) POINT TO NEXT SLOT.             44350000
         BCT   OUTLOOP,J40         ROOM LEFT IN TIOA?                   44400000
K120     L     15,SAVEBBSS         NO. POINT TO BLK/SLT AREA IN TIOA.   44450000
         UNPK  DBLWD,RELREC(4)     STORE BDAM RELATIVE                  44500000
         TR    DBLWD,HXTOEB        CONTROL BLK NUMBER                   44550000
         MVC   5(3,15),DBLWD+4     (LAST BBBSS) IN OUTPUT               44600000
         SR    14,14                                                    44650000
         IC    14,CTRLENTS         GET ORIGINAL COUNT OF SLOTS          44700000
         SR    14,DATALOOP         DETERMINE LAST SLOT READ.            44750000
         STC   14,DBLWD+6          STORE                                44800000
         UNPK  DBLWD(3),DBLWD+6(2) SLOT NUMBER                          44850000
         TR    DBLWD,HXTOEB        (LAST BBBSS)                         44900000
         MVC   8(2,15),DBLWD       IN OUTPUT.                           44950000
K230     LA    14,TIOADBA          COMPUTE LENGTH OF                    45000000
         SR    OUTREG,14           DATA IN TIOA.                        45050000
         STH   OUTREG,TIOATDL      STORE LENGTH IN TIOA                 45100000
         DFHTC TYPE=(WRITE,ERASE)  ALL DONE. SEND DISPLAY.              45150000
         DFHPC TYPE=RETURN                                              45200000
*********************************************************************** 45250000
*                                                                     * 45300000
*        THIS SECTION PREPARES THE 'LINE' OR 'CTRL' DISPLAY           * 45350000
*                                                                     * 45400000
*********************************************************************** 45450000
L60      MVI   QUITSW,X'00'        TURN OFF OUTPUT-FULL-SWITCH       XH 45500000
         ZAP   ITEMCNT,=P'0'       SET CTR OF OUTPUT ITEMS = 0          45550000
         MVC   RELREC,SLOTRFB      SAVE POINTER TO DETAIL BLK           45600000
L140     DFHFC TYPE=RELEASE        RELEASE CONTROL BLOCK                45650000
         MVC   SVRELREC,RELREC     SAVE FOR LAST BBBSS'S                45700000
         OC    RELREC,RELREC       IS THERE ANY DATA BLOCKS ?  @OZ31885 45750000
         BZ    Z130                NO, WRITE 'NO DATA BLKS MSG'@OZ31885 45800000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=L170,DATASET=EMFILE       45850000
         B     F190                I/O ERROR                            45900000
L170     L     FIOABAR,TCAFCAA     POINT TO FIOA                        45950000
         SR    DATALOOP,DATALOOP                                        46000000
         LH    DATALOOP,BLKLTH     SET SLOT LOOP CONTROL                46050000
         LA    DATAREG,DATASLT1    POINT FOR FIRST SLOT                 46100000
L210     MVI   SLOTCNT,X'00'       ZERO OUT DETAIL SLOT COUNTER.        46150000
         OC    LINENAME,=CL8' '                                         46200000
         OC    CLUSNAME,=CL8' '                                         46250000
L220     L     1,SAVERCAP          POINT TO RECAP HEADER                46300000
         CLC   PARM2(4),=C'LINE'   PARM2 = LINE?                        46350000
         BE    L230                YES.                                 46400000
         CLC   PARM4,=CL8' '       IS PARM4 BLANK?                      46450000
         BE    L225                YES. MUST BE LOCAL.                  46500000
         OC    PARM4,PARM4         OR IS PARM4 ZEROS?                   46550000
         BZ    L225                YES. MUST BE LOCAL ALSO              46600000
         MVC   22(8,1),CLUSNAME    MOVE CONTROL UNIT TO HEADER          46650000
         MVC   30(3,1),=C'ON '                                          46700000
         MVC   33(8,1),LINENAME    MOVE LINE ADDR. TO HEADER            46750000
         B     M10                                                      46800000
L225     MVC   11(19,1),=C'LOCAL CONTROL UNIT '                         46850000
         MVC   30(8,1),LINENAME    MOVE CTRL UNIT TO HEADER             46900000
         B     M10                                                      46950000
L230     MVC   21(8,1),LINENAME    MOVE LINE ADDR. TO HEADER            47000000
*********************************************************************** 47050000
*                                                                     * 47100000
*        THIS SECTION FORMATS A 'LINE' ITEM OR A 'CTRL' ITEM.         * 47150000
*                                                                     * 47200000
*********************************************************************** 47250000
M10      MVC   CTRLNAME,=D'0'      ZERO  OUT CONTROL UNIT WORK AREA.    47300000
         MVC   TERMNAME,=CL8' '    BLANK OUT TERMINAL WORK AREA.        47350000
         MVC   RELREC,DATAFWD      SAVE NEXT DETAIL BLK ADDR.           47400000
         MVC   TBARG,=CL2' '       CLEAR MOD-1 TABLE ARGUMENT        XH 47450000
         CLI   ENTRYTYP,X'91'      IS THIS AN MDR ENTRY?                47500000
         BE    N10                 YES.                                 47550000
         CLI   ENTRYTYP,X'30'      IS IT AN OBR ENTRY?                  47600000
         BE    N80                 YES.                                 47650000
         CLI   ENTRYTYP,X'34'      IS IT TCAM OBR?                      47700000
         BE    N80                 YES,BR                               47750000
         B     M140                NO, SKIP IT                 @OZ38643 47800000
M100     CLC   PARM2(4),=C'LINE'   IS THIS A 'LINE' DISPLAY?            47850000
         BE    N150                YES.                                 47900000
         OC    CTRLNAME,=CL8' '                                         47950000
         OC    PARM4,=CL8' '                                            48000000
         CLC   PARM4,CTRLNAME      IS PARM 4 = REMOTE CTRL UNIT NAME?   48050000
         BE    N150                YES. PROCESS ENTRY                   48100000
         CLI   PARM4,X'40'         IS PARM4 BLANK ?                     48150000
         BNE   M140                NO. MUST BE REMOTE--BYPASS CK LOCAL  48200000
         OC    LINENAME,=CL8' '                                         48250000
         CLC   LINENAME,CTRLNAME   IS LINENAME = LOCAL CTRL UNIT ?      48300000
         BE    N150                YES. PROCESS ENTRY                   48350000
M140     SR    R15,R15                                               XH 48400000
         IC    R15,SLOTCNT         ADD ONE                           XH 48450000
         AH    R15,=H'1'           TO                                XH 48500000
         STC   R15,SLOTCNT         SLOT COUNTER.                     XH 48550000
M160     SR    R14,R14                                               XH 48600000
         IC    R14,DATALTH         PUT LTH OF SLOT IN WORK REG          48650000
         AR    DATAREG,R14         POINT TO NEXT DETAIL SLOT.           48700000
         SR    DATALOOP,R14        MORE SLOTS IN THIS DETAIL BLK?       48750000
         BP    M10                 YES.                                 48800000
         OC    RELREC,RELREC       MORE DETAIL BLOCKS?                  48850000
         BNE   L140                YES.                                 48900000
M240     ZAP   WORKCNT,ITEMCNT                                          48950000
         BZ    Z50                                                      49000000
         B     K230                                                     49050000
N10      CLI   MOD1SW,X'00'        MOD-1 SWITCH OFF ?                XH 49100000
         BE    N30                 YES. BYPASS MOD-1 SCANNER CHECK   XH 49150000
         CLC   PARM2(4),=C'CTRL'   IS THIS A 'CTRL' DISPLAY ?        XH 49200000
         BE    N20                 YES. USE REMOTE TERMINAL ADDR     XH 49250000
         MVC   TBARG(1),MDRCTRL    SET TBARG = REMOTE CTRL UNIT      XH 49300000
         B     N25                 GO CK ADDR AGAINST MOD-1 TABLE    XH 49350000
N20      MVC   TBARG(1),MDRTERM    SET TBARG = REMOTE TERMINAL       XH 49400000
N25      BAL   LINKREG,MOD1SCAN    CK IF REMOTE CU OR TERMINAL       XH 49450000
         CLC   TBARG,=X'0000'        IN MOD-1 TABLE?                 XH 49500000
         BE    M140                YES. BYPASS THIS ERROR ENTRY      XH 49550000
N30      UNPK  CTRLNAME(3),MDRCTRL(2)   MDR - PUT CONTROL UNIT       XH 49600000
         TR    CTRLNAME(2),HXTOEB       NAME                            49650000
         MVI   CTRLNAME+2,X'00'         IN WORK AREA.                   49700000
         UNPK  TERMNAME(3),MDRTERM(2)   PUT TERMINAL                    49750000
         TR    TERMNAME(2),HXTOEB       NAME                            49800000
         MVI   TERMNAME+2,C' '          IN WORK AREA.                   49850000
         B     M100                                                     49900000
N80      CLI   OBRUCB,X'10'        IS THIS A LOCAL                      49950000
         BE    N110                YES, GO MOVE 3 BYTE ADDRESS          50000000
N85      CLI   MOD1SW,X'00'        IS MOD-1 SWITCH OFF ?             XH 50050000
         BE    N95                 YES. BYPASS MOD-1 SCANNER CHECK   XH 50100000
         CLC   PARM2(4),=C'CTRL'      IS THIS A 'CTRL' DISPLAY?@OZ31878 50150000
         BE    N88                    YES. USE REMOTE TERM ADDR@OZ31878 50200000
         MVC   TBARG(1),OBRCTRL       PASS REMOTE CU TO MOD-1  @OZ31878 50250000
         B     N90                    GO CK ADDR AGAINST MOD-1 @OZ31878 50300000
N88      MVC   TBARG(1),OBRTERM       PASS REMOTE TERM ADDR    @OZ31878 50350000
*                                     TO MOD-1                 @OZ31878 50400000
N90      BAL   LINKREG,MOD1SCAN       CK IF REMOTE CU OR TERM  @OZ31878 50450000
         CLC   TBARG,=X'0000'        ADDR FOR REMOTE LINE ERRORS     XH 50500000
*                                    IS IN MOD-1 TABLE ?             XH 50550000
         BE    M140                YES. BYPASS THIS ERROR ENTRY      XH 50600000
N95      UNPK  DBLWD,OBRCTRL(2)    OBR - MOVE 1 BYTE REMOTE CU ADR   XH 50650000
         TR    DBLWD+4(3),HXTOEB                                        50700000
         MVC   CTRLNAME(2),DBLWD+5 TO WORK AREA                         50750000
         UNPK  DBLWD,OBRTERM(2)    MOVE 1-BYTE REMOTE TERML ADDR        50800000
         TR    DBLWD+4(3),HXTOEB                                        50850000
         MVC   TERMNAME(2),DBLWD+5 WORK AREA.                           50900000
         B     M100                                                     50950000
N110     CLI   MOD1SW,X'00'        IS MOD-1 SWITCH OFF ?             XH 51000000
         BE    N130                YES. BYPASS MOD-1 SCANNER CHECK   XH 51050000
         MVC   TBARG,OBRCUA        SET TBARG = LOCAL TERMINAL ADDR   XH 51100000
         BAL   LINKREG,MOD1SCAN    CK IF LOCAL TERMINAL IS IN        XH 51150000
         CLC   TBARG,=X'0000'           MOD-1 TABLE ?                XH 51200000
         BE    M140                YES. BYPASS THIS ERROR ENTRY      XH 51250000
N130     UNPK  DBLWD,LINEIDA(4)    OBR - MOVE 3-BYTE CONTROL UNIT    XH 51300000
         TR    DBLWD+4(3),HXTOEB        ADDRESS(POSSIBLY ROUNDED)       51350000
         MVC   CTRLNAME(3),DBLWD+4      TO WORK AREA.                   51400000
         UNPK  DBLWD,OBRCUA(3)          MOVE REAL 3-BYTE CONTROL        51450000
         TR    DBLWD+4(3),HXTOEB        UNIT ADDRESS                    51500000
         MVC   TERMNAME(3),DBLWD+4      WORK AREA.                      51550000
         B     M100                                                     51600000
N150     OC    CTRLNAME,=CL8' '                                         51650000
         L     R14,SAVEITEM        POINT TO FIRST ITEM IN TIOA          51700000
         ZAP   WORKCNT,ITEMCNT     ANY ITEMS IN TIOA?                   51750000
         BZ    P50         NO,ADD NEW ITEM                              51800000
N170     CLC   PARM2(4),=C'LINE'   IS THIS A 'LINE' DISPLAY?            51850000
         BE    P20                 YES.                                 51900000
         CLC   TERMNAME,ITEMLTH(R14) WORKTERMINAL = TIOA TERMINAL?      51950000
         BE    P40                 YES.                                 52000000
N230     LA    R14,DTLLTH(R14)     BUMP TO NEXT ITEM                    52050000
         SP    WORKCNT,=PL2'1'     SUBT ONE FROM ITEM COUNTER.          52100000
         BZ    P90     ANY ITEMS?  NO. ADD NEW ITEM.                    52150000
         B     N170                                                     52200000
P20      CLC   CTRLNAME,ITEMLTH(R14)    WORK CTRL = TIOA CTRL?          52250000
         BNE   N230                NO.                                  52300000
P40      PACK  FULLWD(3),COUNTLTH(4,R14)  ADD                           52350000
         AP    FULLWD(3),=P'1'            ONE                           52400000
         UNPK  COUNTLTH(4,R14),FULLWD(3)  TO                            52450000
         OI    COUNTLTH+3(R14),X'F0'      COUNT FIELD.                  52500000
         B     M140                GO CHECK NEXT SLOT.                  52550000
P50      CLC   PARM2(4),=C'LINE'   IS IT LINE                           52600000
         BE    P170                YES,BR                               52650000
         SR    R15,R15                                                  52700000
         IC    R15,SLOTCNT                                              52750000
         AH    R15,=H'1'                                                52800000
         STC   R15,SLOTTTR                                              52850000
         L     R15,SAVEBBSS                                             52900000
         UNPK  DBLWD(3),SLOTTTR(2)                                      52950000
         TR    DBLWD,HXTOEB                                             53000000
         MVC   3(2,R15),DBLWD                                           53050000
P90      CLI   QUITSW,X'FF'        MOD-1 OUTPUT-FULL-SW ON ?         XH 53100000
         BE    M140                YES. BYPASS PUTTING ADDR IN OUTPUTXH 53150000
         CLC   PARM2(4),=C'LINE'        IS THIS A 'LINE' DISPLAY?    XH 53200000
         BE    P170                     YES.                            53250000
         MVC   DTLITEM,TERMNAME    NO. MOVE TERMINAL                    53300000
P120     MVC   0(DTLLTH,OUTREG),DTLENTRY  TO OUTPUT                     53350000
         LA    OUTREG,DTLLTH(OUTREG) UPDATE OUTPUT POINTER.             53400000
         AP    ITEMCNT,=P'1'       ADD 1 TO COUNT OF OUTPUT ITEMS.      53450000
         SR    R15,R15                                               XH 53500000
         IC    R15,SLOTCNT         ADD ONE                           XH 53550000
         AH    R15,=H'1'           TO                                XH 53600000
         STC   R15,SLOTCNT         SLOT COUNTER.                     XH 53650000
         L     R15,SAVEBBSS        NO. POINT TO BLK/SLT AREA IN TIOA.XH 53700000
         MVI   QUITSW,X'00'        TURN OFF OUTPUT-FULL-SW.    @OZ31882 53750000
         UNPK  DBLWD,SVRELREC(4)   STORE BDAM RELATIVE               XH 53800000
         TR    DBLWD,HXTOEB        CONTROL BLK NUMBER                XH 53850000
         MVC   5(3,R15),DBLWD+4    (LAST BBBSS) IN OUTPUT            XH 53900000
         SR    R14,R14                                               XH 53950000
         UNPK  DBLWD(3),SLOTCNT(2) STORE SLOT NUMBER IN              XH 54000000
         TR    DBLWD,HXTOEB        (LAST BBBSS)                      XH 54050000
         MVC   8(2,R15),DBLWD      IN OUTPUT.                        XH 54100000
         CP    ITEMCNT,=P'1'       IS THIS THE FIRST ITEM IN TIOA ?  XH 54150000
         BNE   P140                NO. BYPASS UPDATING FIRST BBBSS   XH 54200000
         MVC   0(5,15),5(15)       SET FIRST BBBSS = LAST BBBSS      XH 54250000
         CLC   10(5,15),=C'BBBSS'  IS PREV BBBSS FILLED IN ?         XH 54300000
         BNE   P140                YES. BYPASS UPDATING PREV BBBSS   XH 54350000
         MVC   10(5,15),0(15)      SET PREV BBBSS = FIRST BBBSS      XH 54400000
P140     BCT   OUTLOOP,M160        MORE ROOM IN TIOA?                XH 54450000
         CLI   TCTTETM,X'F2'       IS THIS A 3270-2 ?                XH 54500000
         BE    M240                YES. PREPARE TO EXIT              XH 54550000
         MVI   QUITSW,X'FF'        TURN ON OUTPUT-FULL-SW FOR MOD-1  XH 54600000
         B     M160                CONTINUE SCANNING REST OF DATABASEXH 54650000
P170     MVC   DTLITEM,CTRLNAME    SETUP CONTROL UNIT ADDRESS           54700000
         B     P120                     FOR OUTPUT.                     54750000
*********************************************************************** 54800000
*                                                                     * 54850000
*        THIS SECTION PREPARES FOR AN ENTRY BLOWUP OR FOR PAGING.     * 54900000
*                                                                     * 54950000
*********************************************************************** 55000000
R10      L     R14,SAVETIOA        RESTORE POINTER TO INPUT DATA.       55050000
         LA    14,12(14)           BUMP PASS 'SSA' 12-BYTES             55100000
         CLC   PARM4(4),=C'PAGE'   IS THIS A 'PAGE' REQUEST?            55150000
         BE    S010                YES,BR CK FOR FWD OR BACK            55200000
         OC    PARM5,PARM5         MAKE SURE A FIELD WAS X'ED           55250000
         BZ    Z40                 BR,ZERO NO FIELD WAS X'ED            55300000
         CLC   PARM2(4),=C'LINE'   NO. THIS MUST BE COMPANION REQUEST.  55350000
         BNE   R010                IF NOT LINE DISPLAY, GO READ RECORD. 55400000
         MVC   PARM3,PARM5         IS LINE, MOVE THE X'D FIELD TO PRM3. 55450000
         MVC   LINENAME,PARM5        MOVE LINE ADDRESS TO SAVE AREA     55500000
         XC    PARM4(16),PARM4       AS IF LINE ID HAD BEEN KEYED IN.   55550000
         B     F180                GO DO LINE DISPLAY AS IF THIS WERE   55600000
*                                  AN INITIAL 'LINE' INPUT.             55650000
R010     MVC   CLUSNAME,PARM5      MOVE CONTROL UNIT ADDR TO SAVE       55700000
         MVC   PARM4,PARM5         MOVE X'D CTRL UNIT TO PARM4 AS IF    55750000
         XC    PARM5,PARM5           IT HAD BEEN KEYED IN.              55800000
         MVC   PARM1,PARM4         PUT CTRL NAME IN PARM1 FOR TABLE     55850000
         OC    PARM1,=CL8' '                                            55900000
R140     L    14,SAVETIOA          RESTORE REG 14                       55950000
         LA    14,12(14)                                                56000000
         TR    17(3,14),EBTOHX     GET BLOCK NUMBER OF                  56050000
         PACK  DBLWD,17(4,14)         REQUESTED LINE INTO HEX.          56100000
         MVC   RELREC,DBLWD+4                                           56150000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=R170,DATASET=EMFILE       56200000
         B     F190                I/O ERROR.                           56250000
R170     L     FIOABAR,TCAFCAA                                          56300000
         XC    PARM3,PARM3                                              56350000
         UNPK  DBLWD,DATAPORT(4)        MOVE LINE ID                    56400000
         TR    DBLWD+4,HXTOEB           FROM PREVIOUS BLOCK             56450000
         MVC   LINENAME(3),DBLWD+4     TO PARM3 AS IF IT HAD BEEN       56500000
         MVC   PARM3(6),LINENAME        KEYED IN.                       56550000
         DFHFC TYPE=RELEASE                                             56600000
         CLC   PARM3,PARM4         IS THIS A LOCAL CTRL UNIT?           56650000
         BNE   F180                NO. GO TO PROCESS REMOTE.            56700000
         XC    PARM4,PARM4         YES. CLEAR REDUNDANT CU ADDR         56750000
         B     F180                GO DO A 'CTRL' DISPLAY AS IF ABOVE   56800000
*                                  CTRL & LINE HAD BEEN TYPED IN.       56850000
S010     EQU   *                                                        56900000
         CLC   19(2,14),=X'C1D3'   IS THIS A PAGE FORWARD-LG   @OZ30480 56950000
*                                       OR A PAGE BACKWARD-SM? @OZ30480 57000000
         BE    S090                YES.                        @OZ30480 57050000
         CLC   19(2,14),=X'C17B'   IS THIS A PAGE BACKWRD-LG?  @OZ30480 57100000
         BE    S090                YES.                        @OZ30480 57150000
         CLC   19(2,14),=X'406B'   IS THIS A PAGE FORWARD-SM?  @OZ30480 57200000
         BNE   S100                NO, NO OTHER PAGE REQUEST   @OZ30480 57250000
S090     LA    14,4(14)              BUMP WORK REG BY 4        @OZ30480 57300000
S100     MVC   WORK15,21(14)       CONVERT BBBSS'S TO HEX      @OZ30480 57350000
         TR    WORK15,EBTOHX                                            57400000
         CLC   PARM5(4),=C'FORW'   IS IT A 'PAGE FORWARD' REQUEST?      57450000
         BE    S110                YES.                                 57500000
         PACK  DBLWD,WORK15+10(6)                                       57550000
         MVC   RELREC,DBLWD+3      THE 'PREVIOUS' BLOCK.                57600000
         MVC   TWASLOT,DBLWD+6     AND SLOT TO RESUME AT.               57650000
         MVC   TBRELREC,RELREC     SAVE CURRENT 'BBB'                XH 57700000
         MVC   TBSLOT,TWASLOT      SAVE CURRENT 'SS'                 XH 57750000
         L     15,SAVEBBSS         POINT TO NEW OUTPUT HEADER.          57800000
         MVC   0(5,15),31(14)      OLD PREVIOUS NOW BECOMES NEW         57850000
         MVC   10(5,15),31(14)     FIRST AND PREVIOUS.                  57900000
         B     S180                                                     57950000
S110     EQU   *                                                        58000000
         PACK  DBLWD,WORK15+5(6)                                        58050000
         MVC   RELREC,DBLWD+3      PLACE TO PAGE FORWARD FROM           58100000
         MVC   TWASLOT,DBLWD+6                                          58150000
         MVC   TBRELREC,RELREC     SAVE CURRENT 'BBB'                XH 58200000
         MVC   TBSLOT,TWASLOT      SAVE CURRENT 'SS'                 XH 58250000
         L     15,SAVEBBSS         POINT TO NEW OUTPUT HEADER.          58300000
         MVC   0(5,15),26(14)      OLD LAST IS NEW FIRST AND            58350000
         MVC   10(5,15),21(14)     OLD FIRST IS NEW PREVIOUS.           58400000
S180     BAL   LINKREG,LOCATE      LOCATE PROPER BLOCK & SLOT.          58450000
         CLC   PARM2(3),=C'ALL'                                         58500000
         BE    J40                 GO RESUME WHERE LEFT OFF AT (ALL)    58550000
         B     S215                PERFORM MOD-1 TABLE BUILD         XH 58600000
S190     ZAP   ITEMCNT,=P'0'       SET CTR OF OUTPUT ITEMS = 0       XH 58650000
         SR    R15,R15                                                  58700000
         IC    R15,DBLWD+6             UPDATE SLOT COUNTER              58750000
         SH    R15,=H'1'                   FOR PAGING IN                58800000
         STC   R15,SLOTCNT             LINE OR CTRL DISPLAYS.           58850000
S200     UNPK  DBLWD,LINEIDA(4)        MOVE LINE ADDRESS                58900000
         TR    DBLWD+4(3),HXTOEB                TO                      58950000
         MVC   LINENAME(3),DBLWD+4     SAVE AREA FOR RECAP HDR.         59000000
         MVC   LINENAME+3(5),=CL5' '        CLEAR OUT GARBAGE           59050000
         XC    PARM4,PARM4                                              59100000
         CLI   ENTRYTYP,X'91'          IS THIS AN MDR ENTRY?            59150000
         BE    S210                         YES.                        59200000
         CLI   OBRUCB,X'40'            IS THIS A REMOTE OBR ?        XH 59250000
         BNE   S205                         NO.                      XH 59300000
         UNPK  CLUSNAME(3),OBRCTRL(2)       MOVE MDR DUMMY LINE ADDR XH 59350000
         TR    CLUSNAME(2),HXTOEB                TO                  XH 59400000
         MVC   CLUSNAME+2(6),=CL6' '        SAVE AREA FOR RECAP HDR. XH 59450000
         MVC   PARM4(2),CLUSNAME              MOVE  ADDR  TO PARM4   XH 59500000
         B     L220        GO RESUME WHERE LEFT OFF AT (LINE OR CTRL)XH 59550000
S205     MVC   CLUSNAME,LINENAME       MOVE OBR CTRL ADDR. TO SAVE ARXH 59600000
         B     L220        GO RESUME WHERE LEFT OFF AT (LINE OR CTRL)XH 59650000
S210     UNPK  CLUSNAME(3),MDRCTRL(2)       MOVE MDR CTRL ADDR.         59700000
         TR    CLUSNAME(2),HXTOEB                TO                     59750000
         MVC   CLUSNAME+2(6),=CL6' '        SAVE AREA FOR RECAP HDR.    59800000
         MVC   PARM4(2),CLUSNAME       MOVE MDR CTRL ADDR. TO PARM4     59850000
         B     L220        GO RESUME WHERE LEFT OFF AT (LINE OR CTRL)   59900000
*********************************************************************** 59950000
*                                                                     * 60000000
*   THIS IS THE MOD-1 'LINE' AND 'CTRL' TABLE BUILD ROUTINE           * 60050000
*                                                                     * 60100000
*********************************************************************** 60150000
S215     ST    OUTLOOP,SOUTLOOP    SAVE OUTLOOP REGISTER                60200000
         MVC   MOD1TABL,=CL64' '   INITIALIZE MOD1TABL TO BLANKS        60250000
         CLI   ENTRYTYP,X'91'      IS THIS AN MDR ?                     60300000
         BE    S218                YES. SAVE MDR CTRL UNIT     @OZ31878 60350000
         CLI   OBRUCB,X'40'        IS THIS A REMOTE OBR ?      @OZ31878 60400000
         BNE   S220                NO. BYPASS SAVING CTRL UNIT @OZ31878 60450000
         MVC   TBCTRL,OBRCTRL      YES. SAVE REMOTE OBR CU     @OZ31878 60500000
         B     S220                                            @OZ31878 60550000
S218     MVC   TBCTRL,MDRCTRL      SET TBCTRL = MDRCTRL        @OZ31878 60600000
S220     MVC   TBLINE,LINEIDA      SAVE CURRENT LINE ID                 60650000
         XC    RELREC,RELREC       POINT TO FIRST CONTROL BLOCK.        60700000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=S220R,DATASET=EMFILE      60750000
         B     F190                GET I/O ERROR, GO ISSUE ERR MSG.     60800000
S220R    L     FIOABAR,TCAFCAA     POINT TO FIOA AREA.                  60850000
         OC    CTRLENTS,CTRLENTS   ANY LINE ENTRIES?                    60900000
         BZ    Z30                 NO. WRITE 'NO LINE ERRORS'           60950000
         SR    DATALOOP,DATALOOP                                        61000000
         IC    DATALOOP,CTRLENTS   SET LOOP CTR FOR READING SLOTS.      61050000
         LA    DATAREG,CTRLSLT1    POINT TO FIRST SLOT IN BLOCK.        61100000
S220A    CLC   TBLINE,SLOTLINE     IS THIS CONTROL SLOT FOR OUR LINE?   61150000
         BE    S222                YES. GO GET DETAIL BLOCK.            61200000
         LA    DATAREG,SLOTLTH(DATAREG)   POINT TO NEXT SLOT.           61250000
         BCT   DATALOOP,S220A      CHECK NEXT SLOT.                     61300000
         CLC   CTRLFWD,=F'0'       MORE CONTROL BLOCKS?                 61350000
         BE    Z10                 NO. GO WRITE 'NO LINE ERRORS'        61400000
         MVC   RELREC,CTRLFWD+1    POINT TO NEXT BLK TO BE READ.        61450000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=S222R,DATASET=EMFILE      61500000
         B     F190                GET I/O ERROR, GO ISSUE ERR MSG.     61550000
S222R    L     FIOABAR,TCAFCAA     POINT TO INPUT RECORD AREA           61600000
         SR    DATALOOP,DATALOOP                                        61650000
         IC    DATALOOP,CTRLENTS   SET SLOT LOOP CONTROL                61700000
         LA    DATAREG,CTRLSLT1    POINT TO FIRST SLOT.                 61750000
         B     S220A                                                    61800000
S222     ZAP   TABLECNT,=P'0'      SET CTR OF TABLE ITEMS = 0           61850000
         LA    MOD1REG,MOD1TABL    POINT TO MOD-1 TABLE                 61900000
         MVC   RELREC,SLOTRFB      MOVE POINTER TO DETAIL BLK           61950000
S222A    MVC   SVRELREC,RELREC     SAVE FOR COMPARE TO TABLE RELREC     62000000
         DFHFC TYPE=GET,RDIDADR=RELREC,NORESP=S222AR,DATASET=EMFILE     62050000
         B     F190                GET I/O ERROR, GO ISSUE ERR MSG.     62100000
S222AR   L     FIOABAR,TCAFCAA     POINT TO INPUT RECORD AREA           62150000
         SR    DATALOOP,DATALOOP                                        62200000
         LH    DATALOOP,BLKLTH     SET SLOT LOOP CONTROL                62250000
         LA    DATAREG,DATASLT1    POINT FOR FIRST SLOT                 62300000
         MVI   SLOTCNT,X'01'       SET COUNT OF DETAIL BLK SLOTS=1      62350000
         MVC   RELREC,DATAFWD      SAVE NEXT DETAIL BLK ADDR.           62400000
S222B    CLC   SVRELREC,TBRELREC   IS THIS THE RIGHT DETL BLK ?         62450000
         BNE   S222B10             NO. CONTINUE SCAN                    62500000
         CLC   SLOTCNT,TBSLOT      IS THIS THE RIGHT ENTRY ?            62550000
         BNE   S222B10             NO. CONTINUE SCAN                    62600000
S222B03  MVI   MOD1SW,X'FF'        TURN MOD-1 SWITCH ON                 62650000
S222B05  MVC   RELREC,TBRELREC     RESTORE PAGING 'BBB'                 62700000
         MVC   TWASLOT,TBSLOT      RESTORE PAGING 'SS'                  62750000
         BAL   LINKREG,LOCATE      LOCATE STARTING 'BBBSS' FOR DISP     62800000
         L     OUTLOOP,SOUTLOOP    RESTORE THE CONTENT OF OUTLOOP REG   62850000
         B     S190                RESUME PAGING SETUP                  62900000
S222B10  LA    14,MOD1TABL         POINT OT MOD-1 TABLE                 62950000
         CLI   ENTRYTYP,X'91'      IS THIS AN MDR ENTRY?                63000000
         BE    S222C               YES.                                 63050000
         CLI   ENTRYTYP,X'30'      IS IT A BTAM OBR?                    63100000
         BE    S222D               YES.                                 63150000
         CLI   ENTRYTYP,X'34'      IS IT A TCAM OBR?                    63200000
         BE    S222D               YES.                                 63250000
S222B20  SR    15,15                                                    63300000
         IC    15,SLOTCNT          ADD ONE                              63350000
         AH    15,=H'1'            TO                                   63400000
         STC   15,SLOTCNT          SLOT COUNTER.                        63450000
         SR    14,14                                                    63500000
         IC    14,DATALTH          PUT LTH OF SLOT IN WORK REG.         63550000
         AR    DATAREG,14          POINT TO NEXT DETAIL SLOT.           63600000
         SR    DATALOOP,14         MORE SLOTS IN THIS DETAIL BLK?       63650000
         BP    S222B               YES.                                 63700000
         OC    RELREC,RELREC       MORE DETAIL BLOCKS?                  63750000
         BNE   S222A               YES.                                 63800000
         ZAP   WKTBLCNT,TABLECNT   ANY ITEMS IN MOD-1 TABLE?            63850000
         BZ    S222B05             NO. EXIT BUT DON'T TURN ON MOD-1 SW. 63900000
         B     S222B03             YES. EXIT NORMALLY                   63950000
S222C    CLC   PARM2(4),=C'CTRL'   IS THIS A 'CTRL' DISPLAY ?           64000000
         BE    S222C50             YES.  USE TERMINAL ADDR ONLY         64050000
         ZAP   WKTBLCNT,TABLECNT   ANY ITEMS IN TABLE ?                 64100000
         BZ    S222C30             NO. ADD NEW ITEM                     64150000
S222C10  CLC   0(1,14),MDRCTRL     IS THIS CTRL UNIT IN THE TABLE ?     64200000
         BE    S222B20             YES.  BYPASS THIS ENTRY              64250000
         LA    14,2(14)            BUMP TO NEXT ENTRY                   64300000
         SP    WKTBLCNT,=PL2'1'    SUBTRACT ONE FROM ITEM COUNT         64350000
         BZ    S222C30             BRANCH IF NO MORE ITEMS TO CK        64400000
         B     S222C10                                                  64450000
S222C30  CP    TABLECNT,=P'32'     IS THIS THE 33TH ENTRY ?             64500000
         BE    S222B03             YES.                                 64550000
         MVC   0(1,MOD1REG),MDRCTRL     STORE IN TABLE                  64600000
         B     S228                                                     64650000
S222C50  CLC   TBCTRL,MDRCTRL      DOES CTRL UNIT ENTRY = REQUESTED CU? 64700000
         BNE   S222B20             NO. BYPASS PUTTING TERMINAL IN TABLE 64750000
         ZAP   WKTBLCNT,TABLECNT                                        64800000
         BZ    S222C70                                                  64850000
S222C60  CLC   0(1,14),MDRTERM     IS THIS TERMINAL IN THE TABLE ?      64900000
         BE    S222B20             YES. BYPASS THIS ENTRY               64950000
         LA    14,2(14)            BUMP TO NEXT ENTRY                   65000000
         SP    WKTBLCNT,=PL2'1'                                         65050000
         BZ    S222C70                                                  65100000
         B     S222C60                                                  65150000
S222C70  CP    TABLECNT,=P'32'     IS THIS THE 33TH ENTRY ?             65200000
         BE    S222B03             YES.                                 65250000
         MVC   0(1,MOD1REG),MDRTERM    PUT REMOTE TERMINAL INTO TABLE   65300000
         B     S228                                                     65350000
S222D    CLI   OBRUCB,X'10'        IS THIS A LOCAL?                     65400000
         BE    S222G               YES. GO MOVE 3-BYTE ADDR             65450000
         CLC   PARM2(4),=C'CTRL'   IS THIS A 'CTRL' DISPLAY ?  @OZ31878 65500000
         BE    S222D50             YES.  USE TERMINAL ADDR ONLY@OZ31878 65550000
         ZAP   WKTBLCNT,TABLECNT   ANY ITEMS IN TABLE ?        @OZ31878 65600000
         BZ    S222D30             NO. ADD NEW ITEM            @OZ31878 65650000
S222D10  CLC   0(1,14),OBRCTRL     IS THIS CTRL UNIT IN TABLE? @OZ31878 65700000
         BE    S222B20             YES.  BYPASS THIS ENTRY     @OZ31878 65750000
         LA    14,2(14)            BUMP TO NEXT ENTRY          @OZ31878 65800000
         SP    WKTBLCNT,=PL2'1'    SUBTRACT ONE FROM ITEM COUNT@OZ31878 65850000
         BZ    S222D30             BRANCH IF NO MORE ITEMS     @OZ31878 65900000
         B     S222D10                                         @OZ31878 65950000
S222D30  CP    TABLECNT,=P'32'     IS THIS THE 33TH ENTRY ?    @OZ31878 66000000
         BE    S222B03             YES.                        @OZ31878 66050000
         MVC   0(1,MOD1REG),OBRCTRL     STORE IN TABLE         @OZ31878 66100000
         B     S228                                            @OZ31878 66150000
S222D50  CLC   TBCTRL,OBRCTRL      DOES CU ENTRY = REQSTED CU? @OZ31878 66200000
         BNE   S222B20             NO. DON'T PUT TERM IN TBL   @OZ31878 66250000
         ZAP   WKTBLCNT,TABLECNT                               @OZ31878 66300000
         BZ    S222D70                                         @OZ31878 66350000
S222D60  CLC   0(1,14),OBRTERM     IS THIS TERMINAL IN THE TBL?@OZ31878 66400000
         BE    S222B20             YES. BYPASS THIS ENTRY      @OZ31878 66450000
         LA    14,2(14)            BUMP TO NEXT ENTRY          @OZ31878 66500000
         SP    WKTBLCNT,=PL2'1'                                @OZ31878 66550000
         BZ    S222D70                                         @OZ31878 66600000
         B     S222D60                                         @OZ31878 66650000
S222D70  CP    TABLECNT,=P'32'     IS THIS THE 33TH ENTRY ?    @OZ31878 66700000
         BE    S222B03             YES.                        @OZ31878 66750000
         MVC   0(1,MOD1REG),OBRTERM   PUT REMOTE TERM IN TABLE @OZ31878 66800000
         B     S228                                            @OZ31878 66850000
S222G    CLC   PARM2(4),=C'LINE'   IS THIS A 'LINE' DISPLAY ?           66900000
         BE    S222B20             YES. BYPASS THIS ERROR DATA          66950000
         ZAP   WKTBLCNT,TABLECNT   ANY ITEMS IN TABLE ?        @OZ31878 67000000
         BZ    S225                NO. ADD NEW ITEM TO TABLE   @OZ31878 67050000
S224     CLC   0(2,14),OBRCUA      ARG MATCH TABLE ENTRY ?     @OZ31878 67100000
         BE    S222B20             YES.  BYPASS THIS ARGUMENT  @OZ31878 67150000
         SP    WKTBLCNT,=PL2'1'    SUBTRACT ONE FROM ITEM CNT  @OZ31878 67200000
         BZ    S225                NO MORE ITEMS TO CK--SO ADD @OZ31878 67250000
*                                  THIS NEW ITEM TO TABLE               67300000
         LA    14,2(14)            BUMP TO NEXT TABLE ENTRY             67350000
         B     S224                GO CK ANOTHER ENTRY         @OZ31878 67400000
S225     CP    TABLECNT,=P'32'     MORE THAN 33 ENTRIES--USER  @OZ31878 67450000
*                                  MUST BE PAGING FROM MOD-2   @OZ31878 67500000
         BE    S222B03             PREPARE TO EXIT ROUTINE.    @OZ31878 67550000
         MVC   0(2,MOD1REG),OBRCUA ADD CTRL UNIT TO MOD-1 TABLE@OZ31878 67600000
S228     LA    MOD1REG,2(MOD1REG)  UPDATE TABLE POINTER.       @OZ31878 67650000
         AP    TABLECNT,=P'1'      ADD 1 TO COUNT OF TABLE ITEMS        67700000
         B     S222B20             GO CK ANOTHER ENTRY                  67750000
*********************************************************************** 67800000
*                                                                     * 67850000
*   THIS IS THE MOD-1 TABLE SCANNER ROUTINE                           * 67900000
*                                                                     * 67950000
*********************************************************************** 68000000
MOD1SCAN ST    OUTLOOP,SOUTLOOP    SAVE OUTLOOP REGISTER CONTENT        68050000
         LA    MOD1REG,MOD1TABL    POINT TO MOD-1 TABLE                 68100000
         ZAP   WKTBLCNT,TABLECNT   ANY ITEMS IN TABLE ?                 68150000
         BZ    MOD1EXIT            NO. EXIT AND LEAVE TBARG = ADDR.     68200000
MOD1LOOP CLC   0(2,MOD1REG),TBARG  ARG MATCH TABLE ENTRY ?              68250000
         BE    MOD1PASS            YES.  BYPASS THIS ARGUMENT           68300000
         SP    WKTBLCNT,=PL2'1'    SUBTRACT ONE FROM ITEM CNT           68350000
         BZ    MOD1EXIT            NO MORERE ITEMS TO CK--SO EXIT       68400000
         LA    MOD1REG,2(MOD1REG)  BUMP TO NEXT TABLE ENTRY             68450000
         B     MOD1LOOP            GO CHECK ANOTHER ENTRY               68500000
MOD1PASS MVC   TBARG,=X'0000'      CLEAR ARGUMENT = DO NOT USE          68550000
MOD1EXIT L     OUTLOOP,SOUTLOOP    RESTORE THE CONTENT OF OUTLOOP REG   68600000
         BR    LINKREG             RETURN TO CALLER                     68650000
*********************************************************************** 68700000
*                                                                     * 68750000
*        THIS IS THE LOCATE ROUTINE                                   * 68800000
*                                                                     * 68850000
*********************************************************************** 68900000
LOCATE   DFHFC TYPE=GET,DATASET=EMFILE,RDIDADR=RELREC,NORESP=S230       68950000
         B     F190                BRANCH IF GET I/O ERROR.             69000000
S230     L     FIOABAR,TCAFCAA     POINT TO DATA BLK.                   69050000
         MVC   SVRELREC,RELREC     SAVE FOR LAST BBBSS'S                69100000
         CLC   PARM2(3),=C'ALL'    IS THIS 'ALL' BEING CONTINUED?       69150000
         BNE   S250                NO. GO SETUP FOR DATA BLOCK.         69200000
         CLC   TWASLOT,CTRLENTS    YES. SETUP FOR CNTRL BLOCK.          69250000
         BH    S290                QUIT IF GARBAGE KEYED IN.            69300000
         LA    DATAREG,CTRLSLT1                                         69350000
         SR    DATALOOP,DATALOOP   LOOP THRU CONTROL                    69400000
         IC    DATALOOP,CTRLENTS   BLOCK TILL REQUESTED SLOT NBR        69450000
         SR    1,1                 IS SATISFIED.                        69500000
         IC    1,TWASLOT                                                69550000
S235     BCT   1,S240                                                   69600000
         BR    LINKREG                                                  69650000
S240     BCTR  DATALOOP,0                                               69700000
         LA    DATAREG,SLOTLTH(DATAREG)                                 69750000
         B     S235                                                     69800000
S250     LH    DATALOOP,BLKLTH     SETUP LOOP NBR BYTES THIS BLK.       69850000
         LA    DATAREG,DATASLT1    POINT TO FIRST DATA ITEM             69900000
         MVC   WRKSLOT,TWASLOT     MOVE TWASLOT TO WRKAREA              69950000
S260     CLI   WRKSLOT,2           IF RQSTED SLOT = 1, THIS IS IT.      70000000
         BL    S320                GO RESUME DISPLAY BUILDING.          70050000
         SR    1,1                                                      70100000
         IC    1,WRKSLOT           DECREMENT SLOT COUNT BY 1.           70150000
         BCTR  1,0                                                      70200000
         STC   1,WRKSLOT                                                70250000
         IC    1,0(DATAREG)        BUMP TO NEXT SLOT.                   70300000
         LTR   1,1                                                      70350000
         BZ    S290                PREVENT LOOP IF GARBAGE INPUT.       70400000
         AR    DATAREG,1                                                70450000
         SR    DATALOOP,1                                               70500000
         LTR   DATALOOP,DATALOOP   VERIFY SLOT NBR VALID FOR THIS BLK.  70550000
         BP    S260                                                     70600000
S290     LA    DATAREG,X'5'             LOAD MSG NUMBER        @OX22095 70650000
         B     Z80                                             @OX22095 70700000
S320     BR    LINKREG             RETURN TO MAIN LINE.                 70750000
*********************************************************************** 70800000
Z10      CLC   PARM2(4),=C'CTRL'          IS PARM2 = CTRL ?             70850000
         BE    Z50                        YES.                          70900000
         LA    DATAREG,X'4'             LOAD MSG NUMBER        @OX22095 70950000
         B     Z80                                                      71000000
Z20      LA    DATAREG,X'2'             LOAD MSG NUMBER        @OX22095 71050000
         B     Z80                                                      71100000
Z30      LA    DATAREG,X'3'             LOAD MSG NUMBER        @OX22095 71150000
         B     Z80                                                      71200000
Z40      LA    DATAREG,X'6'             LOAD MSG NUMBER        @OX22095 71250000
         B     Z80                                                      71300000
Z50      CLC   MSG7CTRL,=CL2' '           REMOTE CTRL UNIT PRESENT?     71350000
         BNE   Z50A                       YES.                          71400000
         MVC   MSG8CTRL,MSG7LINE          NO. MOVE LOCAL LINE TO CTRL   71450000
         LA    DATAREG,X'8'             LOAD MSG NUMBER        @OX22095 71500000
         B     Z80                                                      71550000
Z50A     LA    DATAREG,X'7'             LOAD MSG NUMBER        @OX22095 71600000
         B     Z80                                                      71650000
Z70      MVC   MSG1TERM,PARM3        MOVE SYMBOLIC NAME TO ERROR MSG    71700000
         OC    MSG1TERM,=CL8' '      CONVERT X'00' TO BLANK             71750000
         LA    DATAREG,X'1'             LOAD MSG NUMBER        @OX22095 71800000
Z80      DFHSC TYPE=GETMAIN,CLASS=TERM,NUMBYTE=255,INITIMG=00  @OX22095 71850000
         L     TIOABAR,TCASCSA          POINT TO NEW TIOA      @OX22095 71900000
         ST    TIOABAR,TCTTEDA          POINT TO NEW TIOA      @OX22095 71950000
         MH    DATAREG,=X'000A'         SET UP TO MOVE MSG     @OX22095 72000000
         B     *+4(DATAREG)             BRANCH INTO MOVE TABLE @OX22095 72050000
         MVC   TIOATDL(IOERLTH),IOERMSG MOVE IN I/O ERR MSG    @OX22095 72100000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72150000
         MVC   TIOATDL(MSG1LTH),MSG1    MOVE IN THE MESSAGE    @OX22095 72200000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72250000
         MVC   TIOATDL(MSG2LTH),MSG2    MOVE IN THE MESSAGE    @OX22095 72300000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72350000
         MVC   TIOATDL(MSG3LTH),MSG3    MOVE IN THE MESSAGE    @OX22095 72400000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72450000
         MVC   TIOATDL(MSG4LTH),MSG4    MOVE IN THE MESSAGE    @OX22095 72500000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72550000
         MVC   TIOATDL(MSG5LTH),MSG5    MOVE IN THE MESSAGE    @OX22095 72600000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72650000
         MVC   TIOATDL(MSG6LTH),MSG6    MOVE IN THE MESSAGE    @OX22095 72700000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72750000
         MVC   TIOATDL(MSG7LTH),MSG7    MOVE IN THE MESSAGE    @OX22095 72800000
         B     PUTMSG                   WRITE THE MESSAGE      @OX22095 72850000
         MVC   TIOATDL(MSG8LTH),MSG8    MOVE IN THE MESSAGE    @OX22095 72900000
PUTMSG   DFHTC TYPE=(WRITE,ERASE)       WRITE THE MESSAGE      @OX22095 72950000
         DFHPC TYPE=RETURN                                              73000000
Z130     MVC   MSG13LN,MSG7LINE                                @OZ31885 73050000
         LA    DATAREG,X'9'             LOAD MSG NUMBER        @OX22095 73100000
         B     Z80                                             @OZ31885 73150000
TRANS    TR    TIOADBA(0),LOTOUP        TRANS LOWER CASE TO UP @OX22096 73200000
*                                                                       73250000
MSG1     DC    AL2(MSG1LTH-4),X'0000'                                   73300000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    73350000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           73400000
         DC    C'BNG002I C UNABLE TO CONVERT SYMBOLIC '                 73450000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                           73500000
         DC    C'TERMINAL NAME '                                        73550000
MSG1TERM DC    CL8' '                                                   73600000
MSG1LTH  EQU   *-MSG1                                                   73650000
MSG2     DC    AL2(MSG2LTH-4),X'0000'                                   73700000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    73750000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           73800000
         DC    C'BNG002I C INVALID INPUT FROM SCREEN'                   73850000
MSG2LTH  EQU   *-MSG2                                                   73900000
MSG3     DC    AL2(MSG3LTH-4),X'0000'                                   73950000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    74000000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                        XH 74050000
         DC    C'BNG003I C NO ERRORS RECORDED'                       XH 74100000
MSG3LTH  EQU   *-MSG3                                                   74150000
MSG4     DC    AL2(MSG4LTH-4),X'0000'                                   74200000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    74250000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                        XH 74300000
         DC    C'BNG004I C NO ERRORS RECORDED FOR '                  XH 74350000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                        XH 74400000
         DC    C'LINE '                                                 74450000
NOLINE   DC    CL3' '                                                   74500000
MSG4LTH  EQU   *-MSG4                                                   74550000
MSG5     DC    AL2(MSG5LTH-4),X'0000'                                   74600000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    74650000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           74700000
         DC    C'BNG005I C ERROR NOT FOUND ON FILE FOR '                74750000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                           74800000
         DC    C'THE SELECTED ITEM '                                    74850000
MSG5LTH  EQU   *-MSG5                                                   74900000
MSG6     DC    AL2(MSG6LTH-4),X'0000'                                   74950000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    75000000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           75050000
         DC    C'BNG006I C INVALID FORMAT--CHECK PAGE 2 '            XH 75100000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                        XH 75150000
         DC    C'OF MENU FOR CORRECT FORMATS'                        XH 75200000
MSG6LTH  EQU   *-MSG6                                                   75250000
MSG7     DC    AL2(MSG7LTH-4),X'0000'                                   75300000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC)    75350000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                           75400000
         DC    C'BNG007I C NO ERRORS RECORDED FOR REMOTE'            XH 75450000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                           75500000
         DC    C'LINE '                                                 75550000
MSG7LINE DC    CL3' '                                                XH 75600000
         DC    C'    CONTROL UNIT '                                     75650000
MSG7CTRL DC    CL2' '                                                XH 75700000
MSG7LTH  EQU   *-MSG7                                                   75750000
MSG8     DC    AL2(MSG8LTH-4),X'0000'                                   75800000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF',AL1(SF,UNA,IC) XH 75850000
         DC    AL1(SBA),AL2(L2P1),AL1(SF,PNA)                        XH 75900000
         DC    C'BNG008I C NO ERRORS RECORDED FOR '                  XH 75950000
         DC    AL1(SBA),AL2(L3P1),AL1(SF,PNA)                        XH 76000000
         DC    C'LOCAL CONTROL UNIT '                                XH 76050000
MSG8CTRL DC    CL3' '                                                XH 76100000
MSG8LTH  EQU   *-MSG8                                                XH 76150000
MSG13    DC    AL2(MSG13LTH-4),X'0000'                         @OZ31885 76200000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF'          @OZ31885 76250000
         DC    AL1(SF,UNA,IC),AL1(SBA),AL2(L2P1),AL1(SF,PNA)   @OZ31885 76300000
         DC    CL39'BNG013A C NO DATA BLOCKS AVAILABLE FOR '   @OZ31885 76350000
         DC    CL5'LINE '                                      @OZ31885 76400000
MSG13LN  DC    CL3' '                                          @OZ31885 76450000
         DC    CL31':  DATA BASE IN DEGRADED MODE. '           @OZ31885 76500000
         DC    CL39' MUST ALLOCATE MORE BLOCKS THAN LINES'     @OZ31885 76550000
MSG13LTH EQU   *-MSG13                                         @OZ31885 76600000
*********************************************************************** 76650000
HDR3X    DC    AL1(SBA),AL2(L4P1)                                       76700000
HDR1X    DC    AL1(SBA),AL2(L2P1)                                       76750000
DTLENTRY DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'? ) '                     76800000
DTLITEM  DC    CL8' '                                                   76850000
         DC    AL1(SF,PNA)                                              76900000
DTLCOUNT DC    CL4'0001'                                                76950000
DTLLTH   EQU   *-DTLENTRY                                               77000000
ITEMLTH  EQU   DTLITEM-DTLENTRY                                         77050000
COUNTLTH EQU   DTLCOUNT-DTLENTRY                                        77100000
*********************************************************************** 77150000
*                                                                     * 77200000
*   THE FUNCTION/COMPANION TABLE DETERMINES WHICH PROGRAM IS TO WRITE * 77250000
*   THE REQUESTED DISPLAY AND PROVIDES THE CORRECT SCREEN AND COLUMN  * 77300000
*   HEADERS FOR THAT DISPLAY.                                         * 77350000
*                                                                     * 77400000
*********************************************************************** 77450000
TABLE    DS    0C                  FUNCTION/COMPANION TABLE             77500000
         DC    C'ALL',X'00',C'LINE',XL8'00',AL1(SF,PNA)                 77550000
         DC    CL39'    RECAP OF ALL LINES HAVING ERRORS',AL1(SF,PNA)   77600000
         DC    CL39'       LINEID  ERRS        LINEID  ERRS'            77650000
SLOT2    DC    C'LINECTRL',XL8'00',AL1(SF,PNA)                          77700000
         DC    CL17'    RECAP OF LINE',AL1(SF,PNA),CL20' ',AL1(SF,PNA)  77750000
         DC    CL39'      CTRLUNIT ERRS       CTRLUNIT ERRS'            77800000
         DC    C'CTRLTERM',XL8'00',AL1(SF,PNA)                          77850000
         DC    CL18'RECAP OF CTRL UNIT',AL1(SF,PNA),CL19' ',AL1(SF,PNA) 77900000
         DC    CL39'       TERMID  ERRS        TERMID  ERRS'            77950000
         DC    C'3270',XL4'00',C'BNGC3270',CL82' '                      78000000
         DC    C'LOCA',XL4'00',C'BNGCLOCL',CL82' '                      78050000
         DC    C'REMO',XL4'00',C'BNGCRMOT',CL82' '                      78100000
         DC    C'END'                                                   78150000
TABLELTH EQU   *-TABLE                                                  78200000
TABLENTY EQU   SLOT2-TABLE                                              78250000
HDR1     DS    0C                                                       78300000
         DC    AL1(SBA),AL2(L1P1),AL1(SF,MNP),C'DEMF'                   78350000
         DC    AL1(SF,UNA,IC,SBA),AL2(L1P36),AL1(SF,MNP)                78400000
HDR1LTH  EQU   *-HDR1                                                   78450000
HDR2     DS    0C                                                       78500000
         DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'?'                        78550000
         DC    AL1(SF,PNA)                                              78600000
         DC    C') PAGE FORWARD '                                       78650000
         DC    CL20' '                                                  78700000
HDR2LTH  EQU   *-HDR2                                                   78750000
HDR3     DS    0C                                                       78800000
         DC    AL1(SF,PNA),C'(',AL1(SF,UNA),C'?'                        78850000
         DC    AL1(SF,PNA)                                              78900000
         DC    C') PAGE BACKWRD '                                       78950000
         DC    CL4' '                                                   79000000
         DC    AL1(SF,PIA)                                              79050000
         DC    CL15'BBBSSBBBSSBBBSS'     BBBSSBBBSSBBBSS BLOCK & SLOT   79100000
HDR3LTH  EQU   *-HDR3                                                   79150000
HXTOEB   DC    4XL16'00',C' ',XL15'00',7XL16'00'  THIS TABLE CONVERTS   79200000
         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'  HEX CHARS           79250000
         DC    2XL16'00'                CHARS FA-THRU-FF BACK           79300000
         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'  A THRU F            79350000
EBTOHX   DC    X'00000000000000000000000000000000'     00-0F  THIS      79400000
         DC    X'00000000000000000000000000000000'     10-1F  TABLE     79450000
         DC    X'00000000000000000000000000000000'     20-2F  CONVERTS  79500000
         DC    X'00000000000000000000000000000000'     30-3F  INPUT     79550000
         DC    X'00000000000000000000000000000000'     40-4F  A THRU F  79600000
         DC    X'00000000000000000000000000000000'     50-5F    TO      79650000
         DC    X'00000000000000000000000000000000'     60-6F  0A - 0F   79700000
         DC    X'00000000000000000000000000000000'     70-7F   AND      79750000
         DC    X'00000000000000000000000000000000'     80-8F  F0 - F9   79800000
         DC    X'00000000000000000000000000000000'     90-9F    TO      79850000
         DC    X'00000000000000000000000000000000'     A0-AF  00 - 09   79900000
         DC    X'00000000000000000000000000000000'     B0-BF    AND     79950000
         DC    X'000A0B0C0D0E0F000000000000000000'     C0-CF     *      80000000
         DC    X'00000000000000000000000000000000'     D0-DF   BECOME   80050000
         DC    X'00000000000000000000000000000000'     E0-EF    FF.     80100000
         DC    X'00010203040506070809000000000000'     F0-FF            80150000
LOTOUP   DS    0C          LOWER CASE TO UPPER CASE TR TABLE            80200000
         DC    X'000102030405060708090A0B0C0D0E0F'                      80250000
         DC    X'101112131415161718191A1B1C1D1E1F'                      80300000
         DC    X'202122232425262728292A2B2C2D2E2F'                      80350000
         DC    X'303132333435363738393A3B3C3D3E3F'                      80400000
         DC    X'404142434445464748494A4B4C4D4E4F'                      80450000
         DC    X'505152535455565758595A5B5C5D5E5F'                      80500000
         DC    X'606162636465666768696A6B6C6D6E6F'                      80550000
         DC    X'707172737475767778797A7B7C7D7E7F'                      80600000
         DC    X'80C1C2C3C4C5C6C7C8C98A8B8C8D8E8F'                      80650000
         DC    X'90D1D2D3D4D5D6D7D8D99A9B9C9D9E9F'                      80700000
         DC    X'A0A1E2E3E4E5E6E7E8E9AAABACADAEAF'                      80750000
         DC    X'F0F1F2F3F4F5F6F7F8F9BABBBCBDBEBF'                      80800000
         DC    X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'                      80850000
         DC    X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'                      80900000
         DC    X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'                      80950000
         DC    X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'                      81000000
SLOTTTR  DC    C' '                                                     81050000
PATCH    DS    20F                                             @OX21950 81100000
         LTORG                                                          81150000
         END   BNGCDISP                                                 81200000
