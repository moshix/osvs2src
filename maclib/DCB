         MACRO                                                          00090000
&NAME    DCB   &DDNAME=0,&MACRF=,                      FOUNDATION BLOCK*00180000
               &BFTEK=,&BFALN=,&EODAD=1,&RECFM=,&EXLST=0,     EXTENSION*00270000
               &BUFNO=0,&BUFCB=1,&BUFL=0,&DSORG=,&IOBAD=1,       COMMON*00360000
               &IMSK=,&UMSK=,&EOEA=0,&PCIA=0,                 EXCP APP1*00450000
               &SIOA=0,&CENDA=0,&XENDA=0,&AERR=0,&PGFX=NO,    EXCP APP2*00540000
               &HIARCHY=,                                              *00630000
               &OPTCD=,&SYNAD=1,&BLKSIZE=0,&NCP=0,&LRECL=0,&EROPT=,    *00720000
               &BUFRQ=0,&CLPS=1,&INTVL=0,&CPRI=,             QTAM LINE1*00810000
               &THRESH=,&CPOLL=,&LCBAD=1,                     QTAMLINE2*00900000
               &TRMAD=1,&SOWA=0,                             QTAM QUEUE*00990000
               &MON=,&MONDLY=,&WRU=,&IAM=,&EOM=,&EOT=,   BTAM/QTAM WTTA*01080000
               &LIMCT=0,                                           BDAM*01170000
               &NTM=0,&CYLOFL=0,&RKP=0,&MSWA=1,                  ISAM 1*01260000
               &SMSI=0,&SMSW=0,&MSHI=1,&DBUFNO=0,                ISAM 2*01350000
               &IMGADR=0,&SSRTN=0,&DCBHDR=0,&IMGRTE=0,          YL03123,01440000
               &QSAMEX=0,                                      @Y30GS11,01490000
               &DEVD=,&KEYLEN=,&TRTCH=,&DEN=,&ERRCNT=0,&FRID=,  YL03127,01530000
               &PRTSP=,&CODE=,&MODE=,&STACK=,                          *01620000
               &GNCP=1,&POLST=0,&GTYPE=EXPRESS,&ERROPT=,&LERB=,   13549*01710000
               &BUFCT=255,&REPOS=N,&TRANS=,&SCT=,&INVLIST=,&BUFOUT=,   *01800000
               &MH=,&PCI=,&BUFMAX=,&BUFIN=,&BUFSIZE=,&RESERVE=,        *01890000
               &BACKUP=NO,&BKUPDCB=0,&BRINGUP=NO,&DMPAUTO=NO,    ICB447*01900000
               &DUMPDCB=0,&IPLAUTO=NO,&IPLTXID=,&CKPTDCB=0,      ICB447*01910000
               &FUNC=,                                                 *01930000
               &READYQ=,&POWERON=NO,                               @01C*01940000
               &BUFOFF=,                                     ICBI DCB-3*01980000
               &STOP=                                        ICBI DCB-3 02030000
.*                                                                      02070000
.*                      SET SYMBOL DECLARATIONS                         02160000
.*                                                                      02250000
         GBLA  &A0                                                      02340000
         GBLB  &DSORG0,&DSORG1,&DSORG2,&DSORG3,&DSORG4,&DSORG5,&DSORG6  02430000
         GBLB  &MACRFD,&MACRFE,&MACRFF,&MAC5,&MAC6,&MAC7,&FXSW,&RECFM0  02520000
         GBLB  &DSORG7,&MACRF0,&MACRF1,&MACRF2,&MACRF3,&MACRF4,&MACRF5  02610000
         GBLB  &MACRF6,&MACRF7,&MACRF8,&MACRF9,&MACRFA,&MACRFB,&MACRFC  02700000
         GBLB  &RECFM1,&RECFM2,&RECFM3,&RECFM4,&RECFM5,&RECFM6,&RECFM7  02790000
         GBLB  &OPTCD0,&OPTCD1,&OPTCD2,&OPTCD3,&OPTCD4,&OPTCD6,&OPTCD7  02880000
         GBLB  &DSORG9,&DSORGA                                          02970000
         GBLB  &COMSW,&MAC4,&DSORG8,&OPTCD5                        RER1 03060000
         LCLA  &A1,&A2,&B(4)                                      13549 03150000
         LCLB  &IFLGS4,&IFLGS5,&IFLGS6,&IFLGS7                          03240000
         LCLB  &B0,&B1,&B2,&B3,&B4,&B5,&B6,&B7                          03330000
         LCLB  &WTTFLG2,&WTTFLG3                                        03420000
         LCLC  &MTROFF,&EOMC,&EOTC                                      03510000
         LCLC  &C0,&C1,&ERROPTN,&C2                               13549 03600000
         LCLA  &BA1,&BA2                                                03690000
         LCLB  &BS2,&BS3,&BS4,&BS5,&BS6,&BS7,&BS8                       03780000
         LCLB  &BI                                                      03870000
         LCLA  &A4                                                      03960000
.* TCAM SUPPORT OPERANDS                                                04050000
         LCLA  &SCTAD,&ICDE,&INTFACE                                    04140000
         LCLB  &SW                                                      04230000
         LCLC  &TRNTBL,&TRNNO                                           04320000
         LCLA  &WRKA,&WRKB,&WRKC                                        04410000
         LCLA  &LGTH,&INCR,&NUMENT                                      04500000
         LCLA  &TC1                                                     04560000
         LCLC  &TC(4)                                                   04620000
.*                                                                      04680000
.* FUNC SUPPORT OPERANDS                                                04700000
         LCLA  &AFUNC,&AFUNC1,&AFUNC2,&AFUNC3,&AMODE                    04720000
         LCLC  &LFUNC                                                   04740000
.*                                                                      04750000
.*         OS/VS2 RELEASE 03 DELETIONS/CHANGES                          04752000
.*0000104400,116100,117900,144900-145800,152100,156600-157500, @ZA02213 04753000
.*0000162000-162900,197100,383400,471600-485100,546300,573300, @ZA02213 04754000
.*0000657000-658800,693900,694800,711900-715500,767700-768600  @ZA02213 04755000
.*0000587700                                                   @ZA10541 04756000
.*A000       SYSROUTE FROM OY14164                             @ZA13469 04756500
.*0000                                                         @ZA21103 04756700
.*D229050                                                      @ZA41552 04757000
.*C229050,D22950                                               @ZA43308 04757400
.*         OS/VS2 RELEASE 02 DELETIONS/CHANGES                          04758000
.*0000                                                         @ZA00022 04762000
.*0000                                                         @ZA00012 04764000
.*0000                                                         @ZA01331 04766000
.*0000286220,286240,286290                                     @Y30GS11 04766100
.*$01=OZ82292,EDM1102,,FEGHA: BTAM POWER-ON SUPPORT                @01A 04768000
.*         OS/VS2 RELEASE 01 DELETIONS/CHANGES                          04770000
.*                                                              YA02128 04820000
.*         RELEASE 21 DELETIONS/CHANGES                                 04950000
.*                                                               A42398 04990000
.*0000833400                                                     A49372 05000000
.*         RELEASE 20 DELETIONS/CHANGES                                 05040000
.*  RESEQUENCED DCB IN RELEASE 20 TO ACCOMMODATE TCAM CHANGES    S20002 05130000
.*                                                               S20038 05220000
.*                                                               A34467 05240000
.*                                                               M0621  05260000
.*                                                               A33170 05280000
.*                                                               M0624  05290000
.*                                                               M0666  05300000
.*                                                                      05302000
         AIF   ('&DSORG' NE 'TR').IHB01  IF NOT DSORG = TR       ICB477 05304000
&NAME    IHB03 &BACKUP,&BKUPDCB,&BRINGUP,           EXPAND DSORG=TR DCBX05306000
               &DDNAME,&DMPAUTO,&DUMPDCB,&EXLST,                       X05308000
               &IPLAUTO,&IPLTXID,&MACRF,&CKPTDCB                 ICB477 05308400
         MEXIT                                                          05308800
.*                                                                      05310000
.*             ANALYZE DSORG, MACRF, RECFM, OPTCD AND NEGATIVE OFFSET   05400000
.*                                                                      05490000
.IHB01   IHB01 &DSORG,&MACRF,&BFTEK,&BFALN,&EODAD,&RECFM,&EXLST,       *05580000
               &BUFCB,&BUFL,&IOBAD,&EOEA,&PCIA,&SIOA,&CENDA,&XENDA,    *05670000
               &AERR,&PGFX,&OPTCD,&BUFNO,&DEVD,&REPOS                   05760000
         AIF   (&MACRF0 OR &MACRF1 OR &MACRF2 OR &MACRF3 OR &MACRF4 OR *05850000
               &MACRF5 OR &MACRF6 OR &MACRF7 OR &MACRF8 OR &MACRF9 OR &*05940000
               MACRFA OR &MACRFB OR &MACRFC OR &MACRFD).DGN0            06030000
         AIF   (&MACRFE OR &MACRFF).DGN0                                06120000
         IHBERMAC 171                                                   06210000
.* THE FOLLOWING LINE OF CODE PUTS THE NAME FOR THE DCB ON A FULL WORD  06240000
.* BOUNDARY IN CASE THERE IS A SEVERE ERROR WHICH WOULD INHIBIT DCB     06270000
.* EXPANSION.                                                           06300000
&NAME    DS    0F            GENERATED TO DEFINE NAME                   06330000
         MEXIT                                                          06390000
.*                      DIAGNOSE DEVICE SUB-PARAMETERS                  06480000
.*                                                                      06570000
.DGN0    AIF   (NOT &DSORG8).DGN00                                      06660000
&NAME    IHB02 &DSORG,&MACRF,&DDNAME,&EXLST,&GNCP,&POLST,&GTYPE         06750000
         AIF   ( T'&HIARCHY EQ 'O').GEN7C                               06840000
         IHBERMAC 190,HIARCHY             ERROR                         06930000
         AGO   .GEN7C                                                   07020000
.DGN00   AIF   (T'&KEYLEN EQ 'O' OR &DSORG0 OR &DSORG2 OR (&A0 LE 4 AND*07110000
                '&DEVD' NE 'TA' AND (&DSORG1 OR &DSORG6 OR &MACRF0))).D*07200000
               GN1                                                      07290000
         IHBERMAC 100,KEYLEN                                            07380000
.DGN1    AIF   (T'&CODE EQ 'O' OR '&DEVD' EQ 'PT').DGN2                 07470000
         AIF   ('&DEVD' EQ 'BS' AND &DSORG3).DGN2                       07560000
         IHBERMAC 101,CODE                                              07650000
.DGN2    AIF   ('&DEVD' EQ 'PC' OR '&DEVD' EQ 'RD').DGN3                07740000
         AIF   (T'&MODE EQ 'O').DGN2A                                   07830000
         AIF   ('&DEVD' EQ 'BS' AND &DSORG3).DGN2A                      07920000
         IHBERMAC 102,MODE                                              08010000
.DGN2A   AIF   (T'&STACK EQ 'O').DGN3                                   08100000
         IHBERMAC 103,STACK                                             08190000
.DGN3    AIF   (T'&PRTSP EQ 'O' OR '&DEVD' EQ 'PR').DGN4                08280000
         IHBERMAC 104,PRTSP                                             08370000
.DGN4    AIF   (T'&TRTCH EQ 'O' OR '&DEVD' EQ 'TA').DGN5                08460000
         IHBERMAC 105,TRTCH                                             08550000
.DGN5    AIF   (T'&DEN EQ 'O' OR '&DEVD' EQ 'TA').DGN6                  08640000
         IHBERMAC 106,DEN                                               08730000
.*                                                                      08820000
.*                      DIAGNOSE BTAM-QTAM OPERANDS                     08910000
.*                                                                      09000000
.DGN6    AIF   ('&DEVD' EQ 'WT' AND &DSORG3).DGN61                      09090000
         AIF   (T'&MON EQ 'O').DGN601                                   09180000
         IHBERMAC 107,MON                                               09270000
.DGN601  AIF   (T'&MONDLY EQ 'O').DGN602                                09360000
         IHBERMAC 108,MONDLY                                            09450000
.DGN602  AIF   (T'&WRU EQ 'O').DGN603                                   09540000
         IHBERMAC 109,WRU                                               09630000
.DGN603  AIF   (T'&IAM EQ 'O').DGN604                                   09720000
         IHBERMAC 110,IAM                                               09810000
.DGN604  AIF   (T'&EOM EQ 'O').DGN605                                   09900000
         IHBERMAC 111,EOM                                               09990000
.DGN605  AIF   (T'&EOT EQ 'O').DGN61                                    10080000
         IHBERMAC 112,EOT                                               10170000
.DGN61   ANOP                                                           10260000
         AIF   (&DSORG3 AND (&MACRF1 OR &MACRF9)).DGN6G                 10350000
         AIF   ('&BUFRQ' EQ '0').DGN6B                         @ZA02213 10440000
         IHBERMAC 107,BUFRQ                                             10530000
.DGN6B   AIF   ('&CLPS' EQ '1').DGN6C                                   10620000
         IHBERMAC 109,CLPS                                              10710000
.DGN6C   AIF   (&DSORG9 OR &DSORGA).DGN6D                               10800000
         AIF   ('&INTVL' EQ '0').DGN6D                                  10890000
         IHBERMAC 110,INTVL                                             10980000
.DGN6D   AIF   (&DSORG9 OR &DSORGA).DGN6E                               11070000
         AIF   (T'&CPRI EQ 'O').DGN6E                                   11160000
         IHBERMAC 111,CPRI                                              11250000
.DGN6E   ANOP                                                           11340000
.DGN6F   AIF   (T'&CPOLL EQ 'O').DGN6G                                  11430000
         IHBERMAC 113,CPOLL                                             11520000
.DGN6G   AIF   ('&SOWA' EQ '0').DGN6A                          @ZA02213 11610000
         IHBERMAC 114,SOWA                                              11700000
.DGN6A   AIF   ('&TRMAD' EQ '1').DGN6H                         @ZA02213 11790000
         IHBERMAC 108,TRMAD                                       13549 11880000
.DGN6H   ANOP                                                     13549 11970000
.* THIS CODE IS INTENDED TO ALLOW BOTH 'ERROPT' AND 'EROPT' SPELLING    12060000
.* FOR BTAM USERS.  ALL OTHER USERS WILL NOT BE PERMITTED TO USE        12150000
.* THIS SPELLING.                                                       12240000
.* DELETION OF THIS CODE WILL DISALLOW THAT SPELLING.                   12330000
         AIF   (&DSORG3 AND (&MACRF2 OR &MACRFA)).ISBTAM          13549 12420000
         AIF   (T'&ERROPT EQ 'O').DGN6I                           13549 12510000
         IHBERMAC 54,,ERROPT                                            12600000
         MEXIT                                                    13549 12690000
.ISBTAM  AIF   (T'&ERROPT EQ 'O').CKEROPT                         13549 12780000
&ERROPTN SETC  '&ERROPT'                                          13549 12870000
&A2      SETA  K'&ERROPT                                          13549 12960000
&C2      SETC  'ERROPT'                                           13549 13050000
         AGO   .DGN6I                                             13549 13140000
.CKEROPT ANOP                                                     13549 13230000
.* END OF CODE DELETION REGARDING 'ERROPT' KEYWORD.               13549 13320000
&C2      SETC  'EROPT'                                            13549 13410000
         AIF   (T'&EROPT EQ 'O').OMITTED                          13549 13500000
&ERROPTN SETC  '&EROPT'                                           13549 13590000
&A2      SETA  K'&EROPT                                           13549 13680000
         AGO   .DGN6I                                             13549 13770000
.OMITTED ANOP                                                     13549 13860000
&ERROPTN SETC  'E'                     ASSIGN BTAM STANDARD VALUE 13549 13950000
&A2      SETA  1                                                  13549 14040000
.DGN6I   ANOP                                                     13549 14130000
.*                                                                      14220000
.*                      DIAGNOSE COMMON OPERANDS                        14310000
.*                                                                      14400000
.DGN7    AIF   (&COMSW AND NOT (&DSORG3 AND (&MACRF1 OR &MACRF9))).DGN7*14401000
               C                                               @ZA02213 14402000
         AIF   ('&BUFNO' EQ '0').DGN7A                                  14670000
         IHBERMAC 115,BUFNO                                             14760000
.DGN7A   AIF   ('&BUFCB' EQ '1').DGN7B                                  14850000
         IHBERMAC 116,BUFCB                                             14940000
.DGN7B   AIF   ('&BUFL' EQ '0').DGN7C                                   15030000
         IHBERMAC 117,BUFL                                              15120000
.DGN7C   AIF   ('&IOBAD' EQ '1' OR &DSORG3 OR &MACRF0).DGN7D   @ZA02213 15210000
         IHBERMAC 118,IOBAD                                             15300000
.*                                                                      15390000
.*                      DIAGNOSE EXTENSION OPERANDS                     15480000
.*                                                                      15570000
.DGN7D   AIF   (&FXSW AND NOT (&DSORG3 AND (&MACRF1 OR &MACRF9))).DGN7I 15571000
.*                                                             @ZA02213 15572000
         AIF   (T'&BFTEK EQ 'O').DGN7E                                  15840000
         IHBERMAC 119,BFTEK                                             15930000
.DGN7E   AIF   (T'&BFALN EQ 'O').DGN7F                                  16020000
         IHBERMAC 120,BFALN                                             16110000
.DGN7F   AIF   ('&EODAD' EQ '1').DGN7G                         @ZA02213 16200000
         IHBERMAC 121,EODAD                                             16380000
.DGN7G   AIF   (T'&RECFM EQ 'O').DGN7H                                  16470000
         IHBERMAC 122,RECFM                                             16560000
.DGN7H   AIF   ('&EXLST' EQ '0' OR &DSORG3).DGN7I                       16650000
         IHBERMAC 123,EXLST                                             16740000
.DGN7I   AIF   ('&DDNAME' NE '0').DGN7J                                 16830000
         IHBERMAC 167                                                   16920000
         AGO   .DGN7L                                                   17010000
.DGN7J   AIF   (K'&DDNAME LE 8).DGN7K                                   17100000
         IHBERMAC 168                                                   17190000
.DGN7K   ANOP                'DDNAME SHORT' MSG REMOVED            MCOK 17280000
.*                                                                      17370000
.*                      DIAGNOSE EXCP INTERFACE OPERANDS                17460000
.*                                                                      17550000
.DGN7L   AIF   (&MACRF0).DGN7T                                          17640000
         AIF   (T'&IMSK EQ 'O').DGN7M                                   17730000
         IHBERMAC 124,IMSK                                              17820000
.DGN7M   AIF   (T'&UMSK EQ 'O').DGN7N                                   17910000
         IHBERMAC 125,UMSK                                              18000000
.DGN7N   AIF   ('&EOEA' EQ '0').DGN7O                                   18090000
         IHBERMAC 126,EOEA                                              18180000
.DGN7O   AIF   ('&PCIA' EQ '0').DGN7P                                   18270000
         IHBERMAC 127,PCIA                                              18360000
.DGN7P   AIF   ('&SIOA' EQ '0').DGN7Q                                   18450000
         IHBERMAC 128,SIOA                                              18540000
.DGN7Q   AIF   ('&CENDA' EQ '0').DGN7R                                  18630000
         IHBERMAC 129,CENDA                                             18720000
.DGN7R   AIF   ('&XENDA' EQ '0').DGN7S                                  18810000
         IHBERMAC 130,XENDA                                             18900000
.DGN7S   AIF   ('&AERR' EQ '0').DGN7T                                   18990000
         IHBERMAC 131,AERR                                              19080000
.DGN7T   AIF   (T'&UMSK EQ 'O' OR '&AERR' NE '0' OR NOT &MACRF0).DGN7U  19170000
         IHBERMAC 175                                                   19260000
.DGN7U   AIF   ('&SIOA' NE '0' AND '&PGFX' NE 'YES').DGN8               19270000
         AIF   ('&SIOA' EQ '0' AND '&PGFX' NE 'YES').DGN8               19280000
         AIF   ('&SIOA' NE '0' AND '&PGFX' EQ 'YES').DGN8               19290000
         IHBERMAC 128,PGFX                                              19300000
.*                                                                      19350000
.*                      DIAGNOSE ACCESS METHOD INTERFACE OPERANDS       19440000
.*                                                                      19530000
.DGN8    AIF   (NOT &MACRF0 AND (&DSORG0 OR &DSORG1 OR &DSORG6)).DGN8D  19620000
         AIF   ('&SYNAD' EQ '1' OR &DSORG2).DGN8A              @ZA02213 19710000
         IHBERMAC 132,SYNAD                                             19800000
.DGN8A   AIF   ('&BLKSIZE' EQ '0' OR (&DSORG2 OR &DSORGA)).DGN8B        19890000
.*                                                           ICBI DCB-9 19940000
         IHBERMAC 133,BLKSIZE                                           19980000
.DGN8B   AIF   ('&NCP' EQ '0').DGN8C                                    20070000
         IHBERMAC 134,NCP                                               20160000
.DGN8C   AIF   ('&LRECL' EQ '0').DGN8D                                  20250000
         IHBERMAC 135,LRECL                                             20340000
.DGN8D   AIF   (T'&EROPT EQ 'O' OR (&DSORG1 OR &DSORG3)).DGN8E    13549 20430000
         IHBERMAC 136,EROPT                                             20520000
.DGN8E   AIF   ('&LIMCT' EQ '0' OR &DSORG2).DGN8F                       20610000
         IHBERMAC 137,LIMCT                                             20700000
.DGN8F   AIF   (&DSORG0).DGN9                                           20790000
         AIF   ('&NTM' EQ '0').DGN8G                                    20880000
         IHBERMAC 138,NTM                                               20970000
.DGN8G   AIF   ('&CYLOFL' EQ '0').DGN8H                                 21060000
         IHBERMAC 139,CYLOFL                                            21150000
.DGN8H   AIF   ('&RKP' EQ '0').DGN8I                                    21240000
         IHBERMAC 140,RKP                                               21330000
.DGN8I   AIF   ('&MSWA' EQ '1').DGN8J                                   21420000
         IHBERMAC 141,MSWA                                              21510000
.DGN8J   AIF   ('&SMSI' EQ '0').DGN8K                                   21600000
         IHBERMAC 142,SMSI                                              21690000
.DGN8K   AIF   ('&SMSW' EQ '0').DGN8L                                   21780000
         IHBERMAC 143,SMSW                                              21870000
.DGN8L   AIF   ('&MSHI' EQ '1').DGN8M                                   21960000
         IHBERMAC 144,MSHI                                              22050000
.DGN8M   AIF   ('&DBUFNO' EQ '0').DGN9                                  22140000
         IHBERMAC 145,DBUFNO                                            22230000
.DGN9    ANOP                                                           22320000
.*                                                                      22322000
.*             DIAGNOSE FUNC OPERAND                                    22324000
.*                                                                      22326000
&AFUNC   SETA  0                                                        22328000
         AIF   ('&FUNC' EQ '').DGN90Z                                   22330000
&AFUNC1  SETA  K'&FUNC                                                  22332000
         AIF   ('&DEVD' EQ 'RD' OR '&DEVD' EQ 'PC').DGN90A     @ZA00022 22332300
         IHBERMAC 100,FUNC   IHB050 FUNC INCONSISTENT--IGNORED @ZA00022 22332900
.DGN90A  ANOP                                                           22334000
&AFUNC2  SETA  2                                                        22336000
&AFUNC3  SETA  7                                                        22338000
.DGN90C  AIF   ('&FUNC'(&AFUNC1,1) EQ 'IRPWDXT'(&AFUNC3,1)).DGN90E      22340000
&AFUNC3  SETA  &AFUNC3-1                                                22342000
&AFUNC2  SETA  &AFUNC2+&AFUNC2                                          22344000
         AIF   (&AFUNC3 NE 0).DGN90C                                    22346000
&LFUNC   SETC  '&FUNC'(&AFUNC1,1)                                       22348000
         MNOTE 12,'IBH0132 INVALID CHARACTER IN FUNC OPERAND-&LFUNC'    22350000
&AFUNC   SETA  0                                                        22352000
         AGO   .DGN90Z                                                  22354000
.DGN90E  ANOP                                                           22356000
&AFUNC   SETA  &AFUNC+&AFUNC2                                           22358000
&AFUNC1  SETA  &AFUNC1-1                                                22360000
         AIF   (&AFUNC1 NE 0).DGN90A                                    22362000
         AIF   (&AFUNC EQ 128 OR &AFUNC EQ 64 OR &AFUNC EQ 32).DGN90Z   22364000
         AIF   (&AFUNC EQ 16 OR &AFUNC EQ 18 OR &AFUNC EQ 22).DGN90Z    22366000
         AIF   (&AFUNC EQ 96 OR &AFUNC EQ 104 OR &AFUNC EQ 80).DGN90Z   22368000
         AIF   (&AFUNC EQ 82 OR &AFUNC EQ 86 OR &AFUNC EQ 48).DGN90Z    22370000
         AIF   (&AFUNC EQ 52 OR &AFUNC EQ 54 OR &AFUNC EQ 112).DGN90Z   22372000
         AIF   (&AFUNC EQ 116 OR &AFUNC EQ 118 OR &AFUNC EQ 120).DGN90Z 22374000
         AIF   (&AFUNC EQ 20 OR &AFUNC EQ 84).DGN90Z                    22376000
         MNOTE 12,'IHB0131 INVALID COMBINATION OF CHARACTERS IN FUNC OP*22378000
               ERAND-&FUNC'                                             22380000
&AFUNC   SETA  0                                                        22382000
.DGN90Z  ANOP                                                           22384000
.*                                                                      22410000
.*                      GENERATE ORIGIN OF DCB                          22500000
.*                                                                      22590000
         SPACE 2                                                        22680000
*                       DATA CONTROL BLOCK                              22770000
*                                                                       22860000
.* THE FOLLOWING LINES OF CODE CHECK TO SEE WHETHER THE ORG VALUE       22869000
.* CALCULATED BY IHB01 HAS A MEANING OTHER THAN ZERO.  IF THE VALUE     22878000
.* IS ZERO, THE ORG WILL NOT BE PERFORMED.  THE DCB WILL BE ALIGNED     22887000
.* TO A FULL WORD BOUNDARY.                           @ZA43308 @ZA41552 22896000
         AIF   (&A0 NE 0).DGN9A                                         22905000
&NAME    DC    0F'0'                   ORIGIN ON WORD BOUNDARY          22914000
         SPACE 1                                                        22923000
         AGO   .DGN9B                                                   22932000
.DGN9A   ANOP                                                           22941000
.*       ORG   *-&A0                   TO ELIMINATE UNUSED SPACE        22950000
&NAME    DS    0F'0'                    ORIGIN ON WORD BOUNDARY         23040000
         ORG   *+&A0                   TO ORIGIN GENERATION             23130000
         SPACE 1                                                        23220000
.DGN9B   ANOP                                                           23310000
         AIF   (&A0 EQ 40).GEN4A       IF NO COMMON OR EXTENSION        23400000
.*                                                                      23490000
.*                      GENERATE DEVICE DEPENDENCY INTERFACE            23580000
.*                                                                      23670000
         AIF   (&DSORG3 AND '&DEVD' EQ 'WT').GEN1Q                      23760000
         AIF   (&A0 GT 4).GEN10         IF NOT TA,DA,OR MR              23850000
&A1      SETA  16-&A0                                                   23940000
         AIF   ('&DEVD' NE 'TA').GEN1D   IF NOT TA                      24030000
*                       MAGNETIC TAPE DEVICE INTERFACE                  24120000
         SPACE 1                                                        24210000
         DC    BL&A1.'0'                NERRS,NOISE,UERRS,BLKCT         24300000
         AIF   (T'&TRTCH EQ 'O').TA1         IF TRTCH NOT SPECIFIED     24390000
         AIF   ('&TRTCH' EQ 'E' OR '&TRTCH' EQ 'T' OR '&TRTCH' EQ 'C' O*24480000
               R '&TRTCH' EQ 'ET' OR '&TRTCH' EQ 'TE').TA1  IF VALID    24570000
         IHBERMAC 150,TRTCH,&TRTCH                                      24660000
.*                                                                      24750000
.TA1     ANOP                                                           24840000
&B2      SETB  ('&TRTCH' EQ 'T' OR '&TRTCH' EQ 'E' OR '&TRTCH' EQ 'TE' *24930000
               OR '&TRTCH' EQ 'ET')                                     25020000
&B3      SETB  ('&TRTCH' EQ 'C' OR '&TRTCH' EQ 'T')                     25110000
&B4      SETB  ('&TRTCH' EQ 'T' OR '&TRTCH' EQ 'TE' OR '&TRTCH' EQ 'ET'*25200000
               )                                                        25290000
&B6      SETB  (&B2 OR &B3 OR &B4)                                      25380000
&B7      SETB  (&B2 OR &B3 OR &B4)                                      25470000
         DC    BL1'00&B2&B3&B4.0&B6&B7'      TRTCH                      25560000
&B6      SETB  (T'&DEN NE 'O')         IF DEN SPECIFIED                 25650000
&B7      SETB  (T'&DEN NE 'O')                                          25740000
         AIF   (NOT &B7).TA3                 IF DEN NOT SPECIFIED       25830000
         AIF   ('&DEN' EQ '0' OR '&DEN' EQ '1' OR '&DEN' EQ '2' OR '&DEN25920000
               N' EQ '3' OR '&DEN' EQ '4').TA3                    99223 26010000
         IHBERMAC 151,DEN,&DEN                                          26100000
&B6      SETB  0                       ZERO FIELD                       26190000
&B7      SETB  0                                                        26280000
.TA3     ANOP                                                           26370000
&B0      SETB  ('&DEN' EQ '2' OR '&DEN' EQ '3' OR '&DEN' EQ '4')        26460000
.*                                                             @ZA01331 26510000
&B1      SETB  ('&DEN' EQ '1' OR '&DEN' EQ '3' OR '&DEN' EQ '4')        26550000
.*                                                             @ZA01331 26560000
&B3      SETB  ('&DEN' EQ '4')                                    99223 26600000
         DC    BL3'00000000&B0&B1.0&B3.00&B6&B7.00000000'    DEVT,DEN   26640000
         SPACE 1                                                        26730000
         AGO   .GEN2A                  SKIP TO COMMON INTERFACE         26820000
.GEN10   AIF   (&DSORG0 OR &DSORG2).GEN1E  IF ISAM OR BDAM              26910000
         AIF   (&DSORG1 OR &MACRF0).GEN1F                               27000000
         AGO   .GEN2A                                                   27090000
.GEN1D   AIF   ('&DEVD' EQ 'OR').GEN1OR IF OPTICAL READER               27180000
         AIF   ('&DEVD' EQ 'MR').GENMR  IF MAG CHAR READER              27270000
*                       DIRECT ACCESS DEVICE INTERFACE                  27360000
         SPACE 1                                                        27450000
         DC    BL&A1.'0'                FDAD,DVTBL                      27540000
.GEN1E   AIF   (T'&KEYLEN NE 'O').GEN1C                                 27630000
         DC    A(0)                     KEYLE,DEVT,TRBAL                27720000
         SPACE 1                                                        27810000
         AGO   .GEN2A                   SKIP TO COMMON INTERFACE        27900000
.GEN1C   DC    AL1(&KEYLEN)            KEYLE                            27990000
&RECFM7  SETB  1                       PREVENT OPEN MERGE TO KEYLEN     28080000
         DC    BL3'0'                   DEVT,TRBAL                      28170000
         SPACE 1                                                        28260000
         AGO   .GEN2A                  SKIP TO COMMON INTERFACE         28350000
.GENMR   ANOP                                                           28440000
*                       MAGNETIC CHARACTER READER INTERFACE             28530000
         SPACE 1                                                        28620000
         AIF   ('&SSRTN' EQ '0' AND '&IMGADR' EQ '0' AND               ,28621000
               '&DCBHDR' EQ '0' AND '&IMGRTE' EQ '0' AND               ,28622000
               '&QSAMEX' EQ '0').GENMR10                       @Y30GS11 28622400
         AIF   (('&SSRTN' EQ '0' AND '&IMGADR' EQ '0') OR              ,28623000
               ('&DCBHDR' EQ '0' AND '&IMGRTE' EQ '0' AND              ,28624000
               '&QSAMEX' EQ '0')).GENMR20                      @Y30GS11 28624400
         IHBERMAC 171                                           YL03123 28625000
.GENMR10 DC    BL20'0'                                                  28626000
         AGO   .GENMR90                                         YL03123 28627000
.GENMR20 AIF   ('&SSRTN' NE '0' OR '&IMGADR' NE '0').GENMR30    YL03123 28628000
         DC    A(&QSAMEX)               QSAM EXIT ADDR                  28629000
         DC    A(&IMGRTE)               IMAGE PROC RTN ADDR             28630000
         DC    BL4'0'                                                   28631000
         DC    A(&DCBHDR)               HEADER DATA AREA ADDR           28632000
         DC    BL4'0'                   FLAG/DEVT                       28633000
         AGO   .GENMR90                                         YL03123 28634000
.GENMR30 AIF   (K'&SSRTN LE 8).GENMR1                           YL03123 28710000
         IHBERMAC  201                  SSRTN TOO LONG                  28800000
.GENMR1  ANOP                                                           28890000
         DC    CL8'&SSRTN'              STACKER SEL RTN ADDR            28980000
         DC    A(&IMGADR)               IMAGE PROCESSING PARAM LIST     29070000
         DC    A(0)                     ECB LIST ADDR                   29160000
         DC    BL4'0'                   MRFLG,DEVT,APPIN,RES            29250000
&BI      SETB  1                        SET 1419 SWITCH         YL03123 29340000
.GENMR90 SPACE 1                                                YL03123 29430000
         AGO   .GEN2A                   SKIP TO COMMON INTERFACE        29520000
.GEN1OR  ANOP                                                           29610000
*                       OPTICAL READER DEVICE INTERFACE                 29700000
         SPACE 1                                                        29790000
         AIF   ('&ERRCNT' EQ '0' AND '&FRID' EQ '').GENOR10     YL03127 29791000
         AIF   ('&ERRCNT' EQ '0' OR  '&FRID' EQ '').GENOR20     YL03127 29792000
         IHBERMAC 171                                           YL03127 29793000
.GENOR10 DC    BL20'0'                                                  29794000
         AGO   .GENOR90                                         YL03127 29795000
.GENOR20 AIF   ('&ERRCNT' NE '0').GENOR30                               29796000
         DC    BL4'0'                                                   29797000
         DC    X'00FF0000'              LINE NO./LINE FMT NO.           29798000
         AIF   (K'&FRID LE 4).GENOR25                           YL03127 29799000
         IHBERMAC 254,,&FRID                                    YL03127 29800000
.GENOR25 DC    CL4'&FRID'               INITIAL FMT RECORD ID           29801000
         DC    BL8'0'                   CURRENT FMT RCD ID/DEVT         29802000
         AGO   .GENOR90                                         YL03127 29803000
.GENOR30 DC    BL4'0'                   WTO ID NUMBER                   29880000
         DC    A(&ERRCNT)               ERROR COUNTERS                  29970000
         DC    BL12'0'                 DSPLY,RESCN/RDLNE,ORBYT,DEVT,EIB 30060000
.GENOR90 SPACE 1                                                YL03127 30150000
         AGO   .GEN2A                                                   30240000
.GEN1F   AIF   ('&DEVD' NE 'PT').GEN1M IF NOT PAPER TAPE                30330000
*                      PAPER TAPE DEVICE INTERFACE                      30420000
         SPACE 1                                                        30510000
         DC    A(1)                    LCTBL                            30600000
         DC    A(1)                    TRTBL, UCTBL                     30690000
&B0      SETB  ('&CODE' EQ 'N')        IF NO CONVERSION                 30780000
&B1      SETB  ('&CODE' EQ 'I')        IF IBM BCD                       30870000
&B2      SETB  ('&CODE' EQ 'F')        IF FRIDEN                        30960000
&B3      SETB  ('&CODE' EQ 'B')        IF BURROUGHS                     31050000
&B4      SETB  ('&CODE' EQ 'C')        IF NCR                           31140000
&B5      SETB  ('&CODE' EQ 'A')        IF ASCII                         31230000
&B6      SETB  ('&CODE' EQ 'T')        IF TELETYPE                      31320000
         DC    BL1'&B0&B1&B2&B3&B4&B5&B6.0'  CODE                       31410000
         DC    BL3'0'                  DEVT                             31500000
         SPACE 1                                                        31590000
         AGO   .GEN2A                  SKIP TO COMMON INTERFACE         31680000
.*                                                                      31770000
.GEN1M   AIF   ('&DEVD' NE 'RD' AND '&DEVD' NE 'PC').GEN1N READER-PUNCH 31860000
*                       READER/PUNCH DEVICE INTERFACE                   31950000
         SPACE 1                                                        32040000
&AMODE   SETA  K'&MODE                                                  32050000
&B0      SETB  0                                                        32060000
&B1      SETB  0                                                        32070000
&B2      SETB  0                                                        32080000
&B3      SETB  0                                                        32090000
.GEN1F1  AIF   (&AMODE EQ 0).GEN1F2                                     32100000
&B0      SETB  ('&MODE'(&AMODE,1) EQ 'C' OR &B0)  IF COLUMN BINARY MODE 32110000
&B1      SETB  ('&MODE'(&AMODE,1) EQ 'E' OR &B1)  IF EBCDIC MODE        32120000
&B2      SETB  ('&MODE'(&AMODE,1) EQ 'O' OR &B2)                        32130000
&B3      SETB  ('&MODE'(&AMODE,1) EQ 'R' OR &B3)                        32140000
&AMODE   SETA  &AMODE-1                                                 32150000
         AGO   .GEN1F1                                                  32160000
.GEN1F2  ANOP                                                           32170000
&B6      SETB  ('&STACK' EQ '2')                                        32310000
&B7      SETB  ('&STACK' EQ '1')                                        32400000
         DC    BL2'&B0&B1&B2&B3.00&B6&B7.00000000'  MODE, STACK, DEVT   32490000
         DC    X'00'                                                    32550000
         DC    AL1(&AFUNC)         FUNC                                 32610000
         SPACE 1                                                        32670000
         AGO   .GEN2A                  SKIP TO COMMON INTERFACE         32760000
.*                                                                      32850000
.GEN1N   AIF   ('&DEVD' NE 'PR').GEN2A IF NOT PRINTER                   32940000
*                       PRINTER DEVICE INTERFACE                        33030000
         SPACE 1                                                        33120000
&B3      SETB  ('&PRTSP' EQ '2' OR '&PRTSP' EQ '3')                     33210000
&B4      SETB  ('&PRTSP' EQ '1' OR '&PRTSP' EQ '3')                     33300000
&B7      SETB  (&B3 OR &B4 OR '&PRTSP' EQ '0')                          33390000
         DC    BL2'000&B3&B4.00&B7.00000000' PRTSP,DEVT                 33480000
         DC    H'0'                                                     33570000
         SPACE 1                                                        33660000
         AGO   .GEN2A                                                   33750000
.*                                                                      33840000
.GEN1Q   ANOP                                                           33930000
*           WORLD TRADE TELEGRAPH DEVICE INTERFACE                      34020000
         SPACE 1                                                        34110000
&MTROFF  SETC  '00'                                                     34200000
&EOMC    SETC  '32'                                                     34290000
&EOTC    SETC  '00'                                                     34380000
         AIF   ('&MON' EQ 'YES').DGNW30                                 34470000
&MTROFF  SETC  '15'                                                     34560000
         AIF   ('&MON' EQ 'NO' OR T'&MON EQ 'O').DGNW20                 34650000
         IHBERMAC 180,MON,NO                                            34740000
.DGNW20  AIF   (T'&MONDLY EQ 'O').DGNW30                                34830000
         AIF   (T'&MONDLY NE 'N' OR '&MONDLY' GT '20').DGNW22           34920000
&MTROFF  SETC '&MONDLY'                                                 35010000
         AGO   .DGNW30                                                  35100000
.DGNW22  IHBERMAC 180,MONDLY,15                                         35190000
.DGNW30  AIF   ('&WRU' NE 'YES').DGNW32                                 35280000
&WTTFLG2 SETB  1                                                        35370000
&WTTFLG3 SETB  1                                                        35460000
         AGO   .DGNW50                                                  35550000
.DGNW32  AIF   ('&WRU' EQ 'NO' OR T'&WRU EQ 'O').DGNW40                 35640000
         IHBERMAC 180,WRU,NO                                            35730000
.DGNW40  AIF   ('&IAM' EQ 'NO' OR T'&IAM EQ 'O').DGNW50                 35820000
         AIF   ('&IAM' NE 'YES').DGNW44                                 35910000
&WTTFLG3 SETB  1                                                        36000000
         AGO   .DGNW50                                                  36090000
.DGNW44  IHBERMAC 180,IAM,NO                                            36180000
.DGNW50  AIF   ('&EOM' EQ 'WRU' OR T'&EOM EQ 'O').DGNW60                36270000
         AIF   (K'&EOM EQ 5).DGNW52                                     36360000
         AIF   (K'&EOM NE 7 OR '&EOM'(5,3) NE '1F''').DGNW56            36450000
.DGNW52  AIF   ('&EOM'(1,2) NE 'X''').DGNW56                            36540000
         AIF   ('&EOM'(3,1) NE '2' AND '&EOM'(3,1) NE '3').DGNW56       36630000
&EOMC    SETC  '&EOM'(3,2)                                              36720000
         AGO   .DGNW60                                                  36810000
.DGNW56  IHBERMAC 180,EOM,WRU                                           36900000
.DGNW60  AIF   ('&EOT' EQ '2EOM' OR T'&EOT EQ 'O').DGNW7                36990000
         AIF   (K'&EOT NE 7).DGNW64                                     37080000
         AIF   ('&EOT'(1,2) NE 'X''' OR '&EOT'(5,3) NE '1F''').DGNW64   37170000
         AIF   ('&EOT'(3,1) NE '2' AND '&EOT'(3,1) NE '3').DGNW64       37260000
&EOTC    SETC  '&EOT'(3,2)                                              37350000
         AGO   .DGNW7                                                   37440000
.DGNW64  IHBERMAC 180,EOT,2EOM                                          37530000
.DGNW7   ANOP                                                           37620000
         DC    BL1'0&WTTFLG2&WTTFLG3.00000' WTTA FLAGS                  37710000
         DC    X'&EOMC' WTTA EOM CHARACTER                              37800000
         DC    X'&EOTC' WTTA EOT CHARACTER                              37890000
         DC    AL1(&MTROFF) WTTA PADDING                                37980000
         SPACE 1                                                        38070000
.GEN2A   AIF   (NOT &COMSW).GEN3A      IF NOT COMMON                    38160000
.*                                                                      38250000
         AIF   (NOT &DSORG3 OR NOT (&MACRF1 OR &MACRF9)).GEN2AB         38340000
.*                                                             @ZA02213 38341000
*                       QTAM LINE GROUP INTERFACE                       38430000
         SPACE 1                                                        38520000
         DC    AL1(&BUFRQ)             BUFRQ                            38610000
         DC    AL3(&CLPS)              CLPS                             38700000
         DC    AL1(&INTVL)             INTVL                            38790000
         DC    AL1(0)                                                   38880000
         DC    BL2'0001000000000000'   DSORG                            38970000
         DC    A(&IOBAD)               IOBAD                            39060000
.TCAM2X  ANOP                                                           39150000
         AIF   ('&DEVD' NE 'WT' OR '&CPRI' NE 'R').QTAM1B0              39240000
&B6      SETB  1                                                        39330000
         AGO   .QTAM1B                                                  39420000
.QTAM1B0 ANOP                                                           39510000
&B5      SETB  ('&CPRI' EQ 'R')                                         39600000
&B6      SETB  ('&CPRI' EQ 'E')                                         39690000
&B7      SETB  ('&CPRI' EQ 'S')                                         39780000
         AIF   (&B5 OR &B6 OR &B7 OR T'&CPRI EQ 'O').QTAM1B             39870000
         IHBERMAC 152,CPRI,&CPRI                                        39960000
.QTAM1B  DC    BL1'00000&B5&B6&B7'     CPRI                             40050000
         AIF   (&DSORG9).TCAM2A                                         40140000
.*                                                                      40230000
         DC    AL3(1)                   LCBAD                           40320000
         AGO   .TCAM2B                                                  40410000
.TCAM2A  ANOP                                                           40500000
&SW      SETB  0                                                        40590000
&TRNTBL  SETC  '&TRANS'                                                 40680000
         AIF   (T'&TRANS NE 'O').IN                                     40770000
         DC    AL3(1)                   TRANS                           40860000
         IHBERMAC   180,TRANS,1                                         40950000
         AGO   .TCAM21                                                  41040000
.IN      ANOP                                                           41130000
&SCTAD   SETA  10                                                       41220000
         AIF   ('&TRNTBL' EQ '1030').SETUP                              41310000
&SCTAD   SETA  &SCTAD+1                                                 41400000
         AIF   ('&TRNTBL' EQ '1050').SETUP                              41490000
&SCTAD   SETA  &SCTAD+1                                                 41580000
         AIF   ('&TRNTBL' EQ '105F').SETUP                              41670000
&SCTAD   SETA  &SCTAD+1                                                 41760000
         AIF   ('&TRNTBL' EQ '1060').SETUP                              41850000
&SCTAD   SETA  &SCTAD+1                                                 41940000
         AIF   ('&TRNTBL' EQ '2260').SETUP                              42030000
         AIF   ('&TRNTBL' EQ '2265').SETUP                       A42398 42130000
&SCTAD   SETA  &SCTAD+2                                          A42398 42230000
         AIF   ('&TRNTBL' EQ '2740').SETUP                              42390000
&SCTAD   SETA  &SCTAD+1                                                 42480000
         AIF   ('&TRNTBL' EQ '274F').SETUP                              42570000
&SCTAD   SETA  &SCTAD+1                                                 42660000
         AIF   ('&TRNTBL' EQ 'ITA2').SETUP                              42750000
&SCTAD   SETA  &SCTAD+1                                                 42840000
         AIF   ('&TRNTBL' EQ 'ZSC3').SETUP                              42930000
&SCTAD   SETA  &SCTAD+1                                                 43020000
         AIF   ('&TRNTBL' EQ 'TTYA').SETUP                              43110000
&SCTAD   SETA  &SCTAD+1                                                 43200000
         AIF   ('&TRNTBL' EQ 'TTYB').SETUP                              43290000
&SCTAD   SETA  &SCTAD+1                                                 43380000
         AIF   ('&TRNTBL' EQ 'TTYC').SETUP                              43470000
&SCTAD   SETA  &SCTAD+1                                                 43560000
         AIF   ('&TRNTBL' EQ '6BIT').SETUP                              43650000
&SCTAD   SETA  &SCTAD+1                                                 43740000
         AIF   ('&TRNTBL' EQ 'ASCI').SETUP                              43830000
&SCTAD   SETA  &SCTAD+1                                                 43920000
         AIF   ('&TRNTBL' EQ 'EBCD').SETUP                              44010000
&SCTAD   SETA  &SCTAD+1                                                 44100000
         AIF   ('&TRNTBL' EQ 'BC41').SETUP                              44190000
&SCTAD   SETA  &SCTAD+1                                                 44280000
         AIF   ('&TRNTBL' EQ 'EB41').SETUP                              44370000
&SCTAD   SETA  &SCTAD+1                                                 44460000
         AIF   ('&TRNTBL' EQ 'CR41').SETUP                              44550000
         AIF   (&SW).BADXIT                                             44640000
         DC    AL3(&TRANS)              USER TRANSLATE TABLE            44730000
.TCAM21  ANOP                                                           44820000
&SW      SETB  1                                                        44910000
&TRNTBL  SETC  '&SCT'                                                   45000000
         AGO   .TCAM2B                                                  45090000
.BADXIT  DC    XL1'00'                  UNTCT                           45180000
         IHBERMAC 157,SCT,&TRNTBL                                       45270000
         AGO   .TCAM3B                                                  45360000
.SETUP   AIF   (&SW).SCTDC                                              45450000
&TRNNO   SETC  '&SCTAD'                                                 45540000
         DC    VL3(IEDQ&TRNNO)          TRANS                           45630000
&TRNTBL  SETC  '&SCT'                                                   45720000
&SW      SETB  1                                                        45810000
         AIF   (T'&SCT NE 'O').TCAM2B                                   45900000
         AIF   (T'&TRANS EQ 'O').BADEXIT                                45990000
&TRNTBL  SETC  '&TRANS'                                                 46080000
         AGO   .TCAM2B                                                  46170000
.SCTDC   DC    XL1'&SCTAD'              UNTCT                           46260000
         AGO   .TCAM3B                                                  46350000
.BADEXIT ANOP                                                           46440000
&TRNTBL  SETC  'ZERO'                                                   46530000
.TCAM2B  ANOP                                                           46620000
         DC    AL1(0)                   EIOBX                           46710000
         DC    AL3(&EXLST)              EXLST                           46800000
         SPACE 1                                                        46890000
         AGO   .GEN4A                  SKIP TO FOUNDATION GENERATION    46980000
.*                                                                      47070000
.GEN2AB  ANOP                                                           48600000
*                       COMMON ACCESS METHOD INTERFACE                  48690000
         SPACE 1                                                        48780000
         AIF   (&DSORG9).TCAM1                                          48870000
         DC    AL1(&BUFNO)             BUFNO                            49050000
         AGO   .GEN9A                                                   49140000
.TCAM1   ANOP                                                           49230000
&WRKC    SETA  0                                                        49320000
         AIF   (T'&BUFIN EQ 'O' AND T'&BUFOUT EQ 'O' AND T'&BUFMAX EQ '*49410000
               O').TCAM1E                                               49500000
         AIF   (T'&BUFIN EQ 'O' OR T'&BUFOUT EQ 'O' OR T'&BUFMAX EQ 'O'*49590000
               ).TCAM1D                                                 49680000
         AIF   (T'&BUFIN NE 'N' OR T'&BUFOUT NE 'N').TCAM1FA     M4043  49720000
&WRKA    SETA  &BUFIN                                                   49770000
&WRKB    SETA  &BUFOUT                                                  49860000
         AIF   ('&BUFIN' GT '15' OR '&BUFIN' LT '1' OR '&BUFOUT' LT '2'*49950000
                OR '&BUFOUT' GT '15').TCAM1D                            50040000
         AIF   (T'&BUFMAX NE 'N').TCAMR                          M4043  50080000
         AIF   ('&BUFMAX' GT '255' OR '&BUFMAX' LT '&BUFIN' OR '&BUFMAX*50130000
               ' LT '&BUFOUT').TCAM1D                                   50220000
&WRKA    SETA  (&WRKA*16)                                               50310000
&WRKA    SETA  (&WRKA+&WRKB)                                            50400000
&WRKC    SETA  &BUFMAX                                                  50490000
         AGO   .TCAM1F                                                  50580000
.TCAM1D  IHBERMAC 180,BUFIN-BUFOUT-BUFMAX,0                             50670000
.TCAM1E  ANOP                                                           50760000
&WRKA    SETA  0                                                        50850000
.TCAM1F  DC    AL1(&WRKA)               BUFIN/BUFOUT                    50940000
         AGO   .TCAM1FB                                          M4043  50950000
.TCAM1FA ANOP                                                           50960000
         DC    AL1((&BUFIN.*16)+(&BUFOUT)) BUFIN/BUFOUT                 50970000
.TCAM1FB ANOP                                                    M4043  50980000
         AIF   (T'&MH EQ 'O').TCAM1G                                    51030000
         DC    AL3(&MH)                 MH                              51120000
         AGO   .TCAM1H                                                  51210000
.TCAM1G  ANOP                                                           51300000
         DC    AL3(1)                   MH                              51390000
         IHBERMAC 24                                                    51480000
.TCAM1H  ANOP                                                           51570000
         AIF   (T'&INTVL NE 'N').TCAM1HA                         M4043  51600000
         AIF   ('&INTVL' GT '255').TCAM1J                        M4043  51630000
.TCAM1HA ANOP                                                    M4043  51660000
         AIF   (T'&INTVL EQ 'O').TCAM1J                                 51690000
         DC    AL1(&INTVL)              INTVL                           51750000
         AGO   .TCAM1K                                                  51840000
.TCAM1J  ANOP                                                           51930000
         IHBERMAC   180,INTVL,0                                         52020000
         DC    AL1(0)                   INTVL                           52110000
.TCAM1K  ANOP                                                           52200000
         AIF   (T'&PCI(1) EQ 'O' AND T'&PCI(2) EQ 'O').TCAM1L           52290000
&B2      SETB  ('&PCI(1)' EQ '')                                        52380000
&B3      SETB  ('&PCI(2)' EQ '')                                        52470000
&B4      SETB  ('&PCI(1)' EQ 'N')                                       52560000
&B6      SETB  ('&PCI(1)' EQ 'R')                                       52650000
&B2      SETB  ('&PCI(1)' EQ 'A')                                       52740000
&B5      SETB  ('&PCI(2)' EQ 'N')                                       52830000
&B7      SETB  ('&PCI(2)' EQ 'R')                                       52920000
&B3      SETB  ('&PCI(2)' EQ 'A')                                       53010000
&B0      SETB  ('&PCI(1)' EQ 'X')                            ICBI DCB-8 53060000
&B1      SETB  ('&PCI(2)' EQ 'X')                            ICBI DCB-8 53070000
         AIF   ((&B0 OR &B2 OR &B4 OR &B6) AND (&B1 OR &B3 OR &B5 OR   X53120000
               &B7)).TCAMP                                   ICBI DCB-8 53170000
         IHBERMAC 180,PCI,0                                             53190000
.TCAM1L  ANOP                                                           53280000
         DC    AL1(0)                   PCI                             53370000
         AGO   .TCAMQ                                                   53460000
.TCAMP   DC    BL1'&B0&B1&B2&B3&B4&B5&B6&B7'   PCI           ICBI DCB-8 53550000
.TCAMQ   ANOP                                                           53640000
         DC    BL2'0000000001000000'    DSORG                           53730000
.TCAMR   ANOP                                                    M4043  53740000
         AIF   (T'&BUFMAX EQ 'N' OR T'&BUFMAX EQ 'O').TCAMS      A39771 53750000
         DC    AL1(&BUFMAX)             BUFMAX                          53760000
         AGO   .TCAMT                                            M4043  53770000
.TCAMS   ANOP                                                    M4043  53780000
         DC    AL1(&WRKC)               BUFMAX                          53820000
.TCAMT   ANOP                                                           53860000
         DC    AL3(IEDQAVT)                                             53910000
         AGO   .TCAM2X                                                  54000000
.GEN9A   ANOP                                                  @ZA02213 54630000
         DC    AL3(&BUFCB)             BUFCB                            54720000
         AIF   ('&BUFL' EQ '0' AND (&BI AND '&LRECL' EQ '0')).GMR2C     54810000
         DC    AL2(&BUFL)         BUFL                                  55170000
         AGO   .GEN2AB2                                                 55260000
.GMR2C   ANOP                                                           55350000
         DC    AL2(0)                   BUFL                            55440000
         AGO   .GEN2AB2                                                 55530000
.GEN2AB1 DC    AL3(TERMTBL)            BUFCB                            55620000
         DC    AL2(IECKBUFL)           BUFL                             55710000
.GEN2AB2 DC    BL2'&DSORG0&DSORG1&DSORG2&DSORG3&DSORG4&DSORG5&DSORG6&DS*55800000
               ORG7&DSORG8&DSORG9&DSORGA.00000'  DSORG                  55890000
         AIF   (NOT &DSORGA).TCAML5                                     55980000
         DC    A(IEDQAVT)                                               56070000
         SPACE 1                                                        56160000
         AGO   .GEN3A                                                   56250000
.TCAML5  DC    A(&IOBAD)                IOBAD                           56340000
         SPACE 1                                                        56430000
.GEN3A   AIF   (NOT &FXSW).GEN4A       IF EXTENSION NOT NEEDED          56520000
*                       FOUNDATION EXTENSION                            56610000
&B0      SETB  0                                                        56700000
&B5      SETB  0                                                        56790000
         AIF   ( T'&HIARCHY EQ 'O').GEN3A4      NO PARA. PASS           56880000
         AIF   ('&HIARCHY' EQ '0' OR '&HIARCHY' EQ '1').GEN3A2          56970000
         IHBERMAC 195,HIARCHY                                           57060000
         AGO   .GEN3A4                                                  57150000
.GEN3A2  ANOP                                                           57240000
         AIF   ( NOT(&DSORG3 OR &DSORG8)).GEN3A3               @ZA02213 57241000
         IHBERMAC 195,HIARCHY                                           57420000
         AGO   .GEN3A4                                                  57510000
.GEN3A3  ANOP                                                           57600000
&B0      SETB  ( '&HIARCHY' EQ '1' )     IF HIARCHY =1                  57690000
&B5      SETB   ( '&HIARCHY' EQ '0' )       IF  HIARCHY=0               57780000
.GEN3A4  ANOP                                                           57870000
         SPACE 1                                                        57960000
&B1      SETB  ('&BFTEK' EQ 'S' OR '&BFTEK' EQ 'A')  SIMPLE BUFF        58050000
&B2      SETB  ('&BFTEK' EQ 'A' OR '&BFTEK' EQ 'R')  SPANNED            58140000
&B3      SETB  ('&BFTEK' EQ 'E')        IF EXCHANGE                     58230000
&B4      SETB  ('&BFTEK' EQ 'D')        IF DYNAMIC                      58320000
         AIF   (&B1 OR &B2 OR &B3 OR &B4 OR T'&BFTEK EQ 'O').GEN3A1     58410000
.*             IF BFTEK IS SPECIFIED O.K.                               58500000
         IHBERMAC 153,BFTEK,&BFTEK                                      58590000
.GEN3A1  ANOP                                                           58680000
&B6      SETB  ('&BFALN' EQ 'D')       IF DOUBLE WORD ALIGNMENT         58770000
&B7      SETB  ('&BFALN' EQ 'F')       IF SINGLE WORD ALIGNMENT         58860000
         AIF   (&B6 OR &B7 OR T'&BFALN EQ 'O').GEN3C                    58950000
         IHBERMAC 154,BFALN,&BFALN                                      59040000
.GEN3C   AIF   (NOT &DSORGA).GEN3CY                                     59130000
         AIF   (T'&THRESH EQ 'O').GEN3CV                                59220000
         AIF   (T'&THRESH NE 'N').GEN3CT                         M4043  59260000
         AIF   ('&THRESH' GT '100').GEN3CW                              59310000
.GEN3CT  ANOP                                                    M4043  59350000
         DC    AL1(&THRESH)             TCAM THRESH                     59400000
         AGO   .GEN3CZ                                                  59490000
.GEN3CW  IHBERMAC  180,THRESH,0                                         59580000
.GEN3CV  DC    AL1(0)                   TCAM THRESH                     59670000
         AGO   .GEN3CZ                                                  59760000
.GEN3CY  DC    BL1'&B0&B1&B2&B3&B4&B5&B6&B7'  BFTEK,BFLN,HIARCHY        59850000
.GEN3CZ  ANOP                                                           59940000
         AIF   (NOT &DSORG3 OR NOT (&MACRF2 OR &MACRFA)).NERROPT        60030000
&B3      SETB  0                                                        60120000
&B4      SETB  0                                                        60210000
&B5      SETB  0                                                        60300000
&B6      SETB  0                                                        60390000
&B7      SETB  0                                                        60480000
         AIF   (&A2 LE 5).START                                   13549 60570000
&A2      SETA  5                                                  13549 60660000
.START   AIF   ('&ERROPTN'(&A2,1) NE 'N').R                       13549 60750000
&B7      SETB  1                                                        60840000
         AGO   .LOOPCTL                                                 60930000
.R       AIF   ('&ERROPTN'(&A2,1) NE 'R').W                       13549 61020000
&B6      SETB  1                                                        61110000
         AGO   .LOOPCTL                                                 61200000
.W       AIF   ('&ERROPTN'(&A2,1) NE 'W').C                       13549 61290000
&B5      SETB  1                                                        61380000
         AGO   .LOOPCTL                                                 61470000
.C       AIF   ('&ERROPTN'(&A2,1) NE 'C').T                       13549 61560000
&B4      SETB  1                                                        61650000
         AGO   .LOOPCTL                                                 61740000
.T       AIF   ('&ERROPTN'(&A2,1) NE 'T').LOOPCTL                 13549 61830000
&B3      SETB  1                                                        61920000
.LOOPCTL AIF   (&A2 LE 1).SCANOK                                  13549 62010000
&A2      SETA  &A2-1                                              13549 62100000
         AGO   .START                                                   62190000
.SCANOK  AIF   ('&DEVD' NE 'BS').NOK                                    62280000
         AIF   (NOT &B7).NOK                                            62370000
&B7      SETB  0                                                        62460000
         MNOTE *,'*** IHB085  DEVD=BS       &C2.=N IGNORED'    @ZA21103 62550000
.NOK     AIF   ('&DEVD' NE 'WT').NOK1                                   62590000
         AIF   (NOT &B6).NOKA                                           62630000
&B6      SETB  0                                                        62670000
         MNOTE *,'*** IHB085  DEVD=WT       ERROPT=R IGNORED'  @ZA21103 62710000
.NOKA    AIF   (NOT &B5).NOKB                                           62750000
&B5      SETB  0                                               @ZA13469 62790000
         MNOTE *,'*** IHB085  DEVD=WT       ERROPT=W IGNORED'  @ZA21103 62830000
.NOKB    AIF   (NOT &B3).NOK1                                  @ZA21103 62870000
&B3      SETB  0                                                        62910000
         MNOTE *,'*** IHB085  DEVD=WT       ERROPT=T IGNORED'  @ZA21103 62950000
.NOK1    AIF   ('&DEVD' NE 'LD').NOK2                          @ZA21103 62990000
         AIF   (NOT &B4).NOKC                                  @ZA13469 63030000
&B4      SETB  0                                               @ZA13469 63070000
         MNOTE *,'*** IHB085  DEVD=LD         EROPT=C IGNORED' @ZA21103 63110000
.NOKC    AIF   (NOT &B5).NOKD                                  @ZA13469 63150000
&B5      SETB  0                                               @ZA13469 63190000
         MNOTE *,'*** IHB085  DEVD=LD         EROPT=W IGNORED' @ZA21103 63230000
.NOKD    AIF   (NOT &B6).NOK2                                  @ZA21103 63270000
&B6      SETB  0                                               @ZA13469 63310000
         MNOTE *,'*** IHB085  DEVD=LD         EROPT=R IGNORED' @ZA21103 63350000
.NOK2    AIF   (NOT &B7).OUTPUT3                               @ZA13469 63500000
&B4      SETB  0                                                        63630000
&B5      SETB  0                                                        63720000
&B6      SETB  0                                                        63810000
.OUTPUT3 AIF   (T'&LERB EQ 'O').OUTPUT1                                 63900000
         AIF   (&B7).OUTPUT2                                   @ZA13469 63990000
         AIF   (&B4).OUTPUT                                             64080000
&B4      SETB  1                                                        64170000
         IHBERMAC 178,&C2,C            EROPT NOT SPEC'D,SET TO C. 13549 64260000
         AGO   .OUTPUT                                                  64350000
.OUTPUT1 AIF   (NOT &B4).OUTPUT                                         64440000
&B4      SETB  0                                                        64530000
         IHBERMAC 147,&C2              EROPT OPERAND INCONSISTENT 13549 64620000
         AGO   .OUTPUT                                                  64710000
.OUTPUT2 ANOP                                                           64800000
         IHBERMAC 147,LERB                                              64890000
.OUTPUT  DC    BL1'000&B3&B4&B5&B6&B7'  BTAM EROPT CODE                 65250000
         DC    AL1(&BUFCT)              BTAM BUFFER COUNT               65340000
         DC    AL1(0)                                                   65430000
         AGO   .GEN3C2                                                  65520000
.NERROPT ANOP                                                           65610000
.GEN3C1  DC    AL3(&EODAD)             EODAD                            65970000
.GEN3C2  ANOP                                                           66060000
         DC    BL1'&RECFM0&RECFM1&RECFM2&RECFM3&RECFM4&RECFM5&RECFM6&RE*66150000
               CFM7'                   RECFM                            66240000
         DC    AL3(&EXLST)             EXLST                            66330000
         SPACE 1                                                        66420000
.*                                                                      66510000
.GEN4A   ANOP                                                           66600000
*                       FOUNDATION BLOCK                                66690000
         SPACE 1                                                        66780000
         DC    CL8'&DDNAME'            DDNAME                           66870000
.*                                                                      66960000
.*                      ANALYZE IMSK, AND UMSK                          67050000
.*                                                                      67140000
&C0      SETC  'FFFFFFFF'               PRESET TO STANDARD VALUES       67230000
&C1      SETC  '00000000'                                               67320000
         AIF   (T'&IMSK EQ 'O' OR NOT &MACRF0).GEN4C                    67410000
&C0      SETC  '&IMSK'                  SET CODED VALUE                 67500000
.GEN4C   AIF   (T'&UMSK EQ 'O' OR NOT &MACRF0).GEN4E                    67590000
&C1      SETC  '&UMSK'                  SET CODED VALUE                 67680000
.GEN4E   ANOP                                                           67770000
&IFLGS4  SETB  ('&C0' EQ '00000000')   IF NEVER IBM ROUTINES            67860000
&IFLGS5  SETB  ('&C0' NE 'FFFFFFFF')   IF NOT ALWAYS IBM ROUTINES       67950000
&IFLGS6  SETB  ('&C1' EQ 'FFFFFFFF')   IF ALWAYS USER ROUTINES          68040000
&IFLGS7  SETB  ('&C1' NE '00000000')   IF SOMETIMES USER ROUTINES       68130000
         DC    BL1'00000010'           OFLGS                            68220000
         DC    BL1'0000&IFLGS4&IFLGS5&IFLGS6&IFLGS7'  IFLG              68310000
         AIF   (&MACRF0 OR &MACRF4 OR NOT(&DSORG0 AND &MACRFD)).MACRF1  68360000
         IHBERMAC 240,MACRF,&MACRF      INCONSISTANT (GM,PU)   @ZA00012 68370000
         DC    BL2'0000000000000000'    MACRF                           68380000
         AGO   .MACRF2                                         @ZA00012 68390000
.MACRF1  ANOP                                                  @ZA00012 68392000
         DC    BL2'&MACRF0&MACRF1&MACRF2&MACRF3&MACRF4&MACRF5&MACRF6&MA*68400000
               CRF7&MACRF8&MACRF9&MACRFA&MACRFB&MACRFC&MACRFD&MACRFE&MA*68490000
               CRFF'                   MACR                             68580000
.MACRF2  ANOP                                                  @ZA00012 68630000
.*                                                                      68670000
         AIF   (NOT &DSORGA).TCAM3X                                     68760000
         DC    BL1'&OPTCD0&OPTCD1&OPTCD2&OPTCD3&OPTCD4&OPTCD5&OPTCD6&OP*68850000
               TCD7'                    OPTCD                           68940000
         DC    AL3(0)                                                   69030000
         DC    F'0'                                          ICBI DCB-9 69120000
         DC    H'0'                                          ICBI DCB-9 69170000
         DC    AL2(&BLKSIZE)           BLKSIZE               ICBI DCB-9 69180000
.TCAM3X  ANOP                                                           69210000
         AIF   (&DSORG9).TCAM3A                                         69300000
         AIF   (NOT &MACRF0).QTAM1D    IF NOT EXCP ACCESS      @ZA02213 69301000
         AIF   (NOT &MACRF2 AND T'&UMSK EQ 'O' AND T'&IMSK EQ 'O').GEN7*69570000
               C                                                        69660000
         SPACE 1                                                        69750000
*                       EXCP APPENDAGE LIST                             69840000
         SPACE 1                                                        69930000
         DC    BL1'00000&OPTCD5.00'                                RER1 70020000
         DC    XL3'000000'                                         RER1 70110000
         AIF   (NOT &MACRF2 AND T'&UMSK EQ 'O').GEN7C                   70200000
         DC    XL4'&C1'                UMSK                             70290000
         AIF   (NOT &MACRF2).GEN7C     IF NO APPENDAGES                 70380000
         AIF   ('&EOEA' EQ '0').EXCP2                            M0624  70390000
         AIF   (K'&EOEA EQ 2).EXCP2                              M0624  70400000
         AIF   (K'&EOEA LT 2).EXCP1                              M0624  70410000
         IHBERMAC  176,EOEA,&EOEA                                M4043  70420000
         AGO   .EXCP2                                            M0624  70430000
.EXCP1   IHBERMAC  177,EOEA,&EOEA                                M4043  70440000
.EXCP2   DC    CL2'&EOEA'               EOEA                            70450000
         AIF   ('&PCIA' EQ '0').EXCP4                            M0624  70460000
         AIF   (K'&PCIA EQ 2).EXCP4                              M0624  70470000
         AIF   (K'&PCIA LT 2).EXCP3                              M0624  70480000
         IHBERMAC  176,PCIA,&PCIA                                M4043  70490000
         AGO   .EXCP4                                            M0624  70500000
.EXCP3   IHBERMAC  177,PCIA,&PCIA                                M4043  70510000
.EXCP4   DC    CL2'&PCIA'               PCIA                            70520000
         AIF   ('&SIOA' EQ '0').EXCP6                            M0624  70530000
         AIF   (K'&SIOA EQ 2).EXCP6                              M0624  70540000
         AIF   (K'&SIOA LT 2).EXCP5                              M0624  70550000
         IHBERMAC  176,SIOA,&SIOA                                M4043  70560000
         AGO   .EXCP6                                            M0624  70570000
.EXCP5   IHBERMAC  177,SIOA,&SIOA                                M4043  70580000
.EXCP6   DC    CL2'&SIOA'               SIOA                            70590000
         AIF   ('&CENDA' EQ '0').EXCP8                           M0624  70600000
         AIF   (K'&CENDA EQ 2).EXCP8                             M0624  70610000
         AIF   (K'&CENDA LT 2).EXCP7                             M0624  70620000
         IHBERMAC  176,CENDA,&CENDA                              M4043  70630000
         AGO   .EXCP8                                            M0624  70640000
.EXCP7   IHBERMAC  177,CENDA,&CENDA                              M4043  70650000
.EXCP8   DC    CL2'&CENDA'              CENDA                           70660000
         AIF   ('&XENDA' EQ '0').EXCP10                          M0624  70670000
         AIF   (K'&XENDA EQ 2).EXCP10                            M0624  70680000
         AIF   (K'&XENDA LT 2).EXCP9                             M0624  70690000
         IHBERMAC  176,XENDA,&XENDA                              M4043  70700000
         AGO   .EXCP10                                           M0624  70710000
.EXCP9   IHBERMAC  177,XENDA,&XENDA                              M4043  70720000
.EXCP10  DC    CL2'&XENDA'              XENDA                           70730000
         AIF   ('&AERR' EQ '0').EXCP12                           M0624  70740000
         AIF   (K'&AERR EQ 2).EXCP12                             M0624  70750000
         AIF   (K'&AERR LT 2).EXCP11                             M0624  70760000
         IHBERMAC  176,AERR,&AERR                                M4043  70770000
         AGO   .EXCP12                                           M0624  70780000
.EXCP11  IHBERMAC  177,AERR,&AERR                                M4043  70790000
.EXCP12  DC    CL2'&AERR'               AERR                            70800000
         MEXIT                                                          71010000
.*                                                                      71100000
.QTAM1D  AIF   (NOT (&DSORG3 AND (&MACRF1 OR &MACRF9))).QTAM1F          71640000
&A1      SETA  1                                                        71730000
&B(1)    SETA  255                                                      71820000
&B(2)    SETA  10                                                       71910000
&B(3)    SETA  5                                                        72000000
&B(4)    SETA  5                                                        72090000
         SPACE 1                                                        72180000
.THRESH  ANOP                                                           72270000
         AIF   (N'&THRESH LT &A1).SVAL                                  72360000
         AIF   ('&THRESH(&A1)' EQ '').SVAL                              72450000
&B(&A1)  SETA  &THRESH(&A1)                                             72540000
.SVAL    ANOP                                                           72630000
         DC    AL1(&B(&A1))             KSTAT                           72720000
&A1      SETA  &A1+1                                                    72810000
         AIF   (&A1 LT 5).THRESH                                        72900000
         SPACE 1                                                        72990000
.*                                                                      73080000
.QTAM1F  AIF   (T'&CPOLL EQ 'O' OR NOT (&DSORG3 AND (&MACRF1 OR &MACRF9*73170000
               ))).GEN5B                                                73260000
         SPACE 1                                                        73350000
*                       QTAM LINE GROUP POLLING LIST                    73440000
         SPACE 1                                                        73530000
&A0      SETA  1                       TO INDEX 1ST ITEM                73620000
.QTAM1G  DC    A(&CPOLL(&A0))                                           73710000
&A0      SETA  &A0+1                   STEP INDEX                       73800000
         AIF   (&A0 LE N'&CPOLL).QTAM1G  REPEAT LOOP FOR NEXT ITEM      73890000
         MEXIT                                                          73980000
.GEN5B   AIF   (&DSORG3).GEN7B5         IF LINE GROUP                   74070000
.*                                                                      74160000
         AIF   (NOT &DSORG1 AND NOT &DSORG6).GEN7A  IF NOT PHYSICAL SEQ 74250000
         SPACE 1                                                        74340000
*                       BSAM-BPAM-QSAM INTERFACE                        74430000
         SPACE 1                                                        74520000
         DC    BL1'&OPTCD0&OPTCD1&OPTCD2&OPTCD3&OPTCD4&OPTCD5&OPTCD6&OP*74610000
               TCD7'                                               RER1 74700000
         DC    AL3(1)                  CHECK, GERR, PERR                74790000
         DC    A(&SYNAD)               SYNAD                            74880000
         AIF   (T'&STOP EQ 'O').GEN5B2                       ICBI DCB-3 74930000
&B0      SETB  ('&STOP' EQ 'QUICK' OR '&STOP' EQ 'BOTH')     ICBI DCB-3 74942000
&B1      SETB  ('&STOP' EQ 'FLUSH' OR '&STOP' EQ 'BOTH')     ICBI DCB-3 74950000
         AIF   (NOT &B0 AND NOT &B1).GEN5B1                  ICBI DCB-3 74960000
         DC    BL1'&B0&B1.000000'  CIND1                     ICBI DCB-3 74962000
         DC    AL1(0)              CIND2                     ICBI DCB-3 74964000
         AGO   .GEN5B3                                       ICBI DCB-3 74966000
.GEN5B1  ANOP                                                ICBI DCB-3 74968000
         IHBERMAC 153,STOP,&STOP                             ICBI DCB-3 74968400
.GEN5B2  ANOP                                                ICBI DCB-3 74968800
         DC    H'0'                    CIND1, CIND2                     74970000
.GEN5B3  ANOP                                                ICBI DCB-3 75020000
.*  IF BUFL AND BLKSIZE ARE CODED FOR 1419 THEY MUST BE EQUAL   YL03123 75060000
         AIF   (&BI).GENMRA             BR IF 1419              YL03123 75150000
         DC    AL2(&BLKSIZE)           BLKSIZE                          75240000
         AGO   .GENMRC                                                  75330000
.GENMRA  AIF   ('&BUFL' EQ '&BLKSIZE').GENMRB                           75420000
         IHBERMAC  199                  BUFL NE BLKSIZE                 75510000
.GENMRB  ANOP                                                           75600000
         DC    AL2(&BUFL)               BLKSIZE                         75690000
.GENMRC  ANOP                                                           75780000
         DC    F'0'                    WCPO, WCPL, OFFSR, OFFSW         75870000
         DC    A(1)                    IOBA                             75960000
         DC    AL1(&NCP)               NCP                              76050000
         DC    AL3(1)                  EOBR, EOBAD                      76140000
         SPACE 1                                                        76230000
         AIF   (&MACRF1 OR &MACRF9).GEN6E   IF GET/PUT                  76320000
*                         BSAM-BPAM INTERFACE                           76410000
         SPACE 1                                                        76500000
         DC    A(1)                    EOBW                             76590000
         AIF   (T'&BUFOFF EQ 'O').GEN5C9                                76680000
.GEN5C2A AIF   (&DSORG0 OR &DSORG2 OR &DSORG3 OR &DSORG6 OR &DSORG8).GE*76681000
               NER1                                            @ZA02213 76682000
         AIF   ('&BUFOFF' EQ 'L' OR '&BUFOFF' EQ '(L)').GEN5C2          76950000
&A4      SETA  &BUFOFF(1)                                               77040000
         AIF   (&A4 GT 99).GENER3                                       77130000
         DC    X'00',AL1(&BUFOFF)       USASCI,BUFOFF                   77220000
         AGO   .GENCR                                                   77310000
.GEN5C2  AIF   (&RECFM1 OR &RECFM0).GENER1                              77400000
         DC    X'4004'                  USASCI,BUFOFF                   77490000
         AGO   .GENCR                                                   77580000
.GENER1  IHBERMAC 147,BUFOFF  BUFOFF INVALID FOR RECFM OR DSORG         77670000
         DC    H'0'                                                     77760000
         AGO   .GENCR                                                   77850000
.GENER3  IHBERMAC 47,,BUFOFF                                            77940000
         MEXIT                                                          78030000
.GEN5C9  ANOP                                                           78120000
         DC    H'0'                    DIRCT                            78210000
         AGO   .GENCR                                                   78300000
.GEN5C   ANOP                                                           78390000
         DC    A(1)                    CNTRL, NOTE, POINT               78480000
         AIF   (T'&EROPT EQ 'O').GEN7C                                  78570000
         IHBERMAC 147,EROPT                                             78660000
         MEXIT                                                          78750000
.*                                                                      78840000
.GENCR   AIF   (&DSORG6).GEN6A         ( IF BPAM)                       78930000
         AIF   ('&LRECL' NE 'X').GEN6A                                  79020000
         AIF    (NOT(&MACRF1 OR &MACRF9)).GEN6B     (IF BSAM)           79110000
         AIF   (&MACRF4 OR &MACRFC).GEN6B          (IF  LOCATE MODE )   79200000
         DC    X'0000'    LRECL                                         79290000
         IHBERMAC  99,LRECL                                             79380000
         AGO   .GEN6G                                                   79470000
.GEN6B   AIF   (T'&RECFM  NE 'O').GEN6C                                 79560000
         DC    X'8000'    LRECL=X                                       79650000
         MNOTE *,'***  IHB085A  LRECL IMPLIES VRE,RECFM OMITTED'        79740000
         AGO   .GEN6F                                                   79830000
.GEN6C   AIF   (&RECFM1 AND &RECFM4  AND  NOT (&RECFM0)).GEN6D          79920000
         DC    X'0000'    LRECL                                         80010000
         IHBERMAC   99,LRECL                                            80100000
         AGO   .GEN6F                                                   80190000
.GEN6D   ANOP                                                           80280000
         DC    X'8000'        LRECL=X                                   80370000
         AGO   .GEN6F                                                   80460000
.GEN6A   ANOP                                                           80550000
         AIF   ('&LRECL' EQ '0' AND (&BI AND '&BUFL' EQ '0')).GMR1E     80640000
         DC    AL2(&LRECL)    LRECL                                     80730000
         AGO   .GEN6F                                                   80820000
.GMR1E   ANOP                                                           80910000
         DC    AL2(0)                   LRECL                           81000000
.GEN6F   AIF   (&MACRF1 OR &MACRF9).GEN6G          GO TO  QSAM          81090000
         AGO   .GEN5C                              GO TO  BSAM          81180000
.*                                                                      81270000
.GEN6E   ANOP                                                           81360000
*                            QSAM INTERFACE                             81450000
         SPACE 1                                                        81540000
         DC    A(1)                     RECAD                           81630000
         AIF   (T'&BUFOFF NE 'O').GEN5C2A                               81720000
         DC    H'0'                    QSWS                             81810000
         AGO   .GENCR                                                   81900000
.GEN6G   ANOP                                                           81990000
&B0      SETB  ('&EROPT' EQ 'ACC')                                      82080000
&B1      SETB  ('&EROPT' EQ 'SKP')                                      82170000
&B2      SETB  ('&EROPT' EQ 'ABE')                                      82260000
         AIF   (&B0 OR &B1 OR &B2 OR T'&EROPT EQ 'O').GEN6L             82350000
         IHBERMAC 155,EROPT,&EROPT                                      82440000
.GEN6L   DC    BL1'&B0&B1&B2.00000'    EROPT                            82530000
         DC    AL3(1)                  CNTRL                            82620000
         DC    F'0'                    PRECL                            82710000
         DC    A(1)                    EOB                              82800000
         MEXIT                                                          82890000
.GEN7A   AIF   (NOT &DSORG0).GEN7B     IF NOT INDEXED SEQUENTIAL        82980000
         SPACE 1                                                        83070000
*                       BISAM-QISAM INTERFACE                           83160000
         SPACE 1                                                        83250000
         DC    BL1'&OPTCD0&OPTCD1&OPTCD2&OPTCD3&OPTCD4.0&OPTCD6&OPTCD7' 83340000
         DC    BL1'0000&MAC4&MAC5&MAC6&MAC7'     MAC                    83430000
         DC    AL1(&NTM)               NTM                              83520000
         DC    AL1(&CYLOFL)            CYLOFL                           83610000
         DC    A(&SYNAD)               SYNAD                            83700000
         DC    AL2(&RKP)               RKP                              83790000
         DC    AL2(&BLKSIZE)           BLKSIZE                          83880000
         DC    A(&MSWA)                MSWA                             83970000
         DC    AL2(&SMSI)              SMSI                             84060000
         DC    AL2(&SMSW)              SMSW                             84150000
         DC    AL1(&NCP)               NCP                              84240000
         DC    AL3(&MSHI)              MSHI                             84330000
         DC    A(1)                    SETL                             84420000
         DC    H'0'                    EXCD1, EXCD2                     84510000
         DC    AL2(&LRECL)             LRECL                            84600000
         DC    A(1)                    ESETL                            84690000
         DC    A(1)                    LRAN                             84780000
         DC    A(1)                    LWKN                             84870000
         DC    A(1)                    RELSE                            84960000
         DC    A(1)                    PUTX                             85050000
         DC    A(1)                    RELEX                            85140000
         DC    A(1)                    FREED                            85230000
         DC    AL1(&DBUFNO)            DBUFNO                           85320000
         DC    BL31'0'                                                  85410000
         DC    BL32'0'                                                  85500000
         DC    BL32'0'                                                  85590000
         DC    BL20'0'                                                  85680000
         DC    A(1)                    WKPT1                            85770000
         DC    A(1)                    WKPT2                            85860000
         DC    A(1)                    WKPT3                            85950000
         DC    A(1)                    WKPT4                            86040000
         DC    A(1)                    WKPT5                            86130000
         DC    A(1)                    WKPT6                            86220000
         MEXIT                                                          86310000
.*                                                                      86400000
.GEN7B   AIF   (NOT &DSORG2).GEN7C     IF NOT BDAM                      86490000
         SPACE 1                                                        86580000
*                       BDAM INTERFACE                                  86670000
         SPACE 1                                                        86760000
         DC    BL1'&OPTCD0.0&OPTCD2&OPTCD3&OPTCD4.0&OPTCD6&OPTCD7'      86850000
         DC    AL3(1)                  CHECK                            86940000
         DC    A(&SYNAD)               SYNAD                            87030000
         DC    H'0'                                                     87120000
         DC    AL2(&BLKSIZE)           BLKSIZE                          87210000
         DC    A(1)                    IOBSQ                            87300000
         DC    A(1)                    SQND                             87390000
         DC    A(1)                    IOBUQ                            87480000
         DC    A(1)                    UQND                             87570000
         DC    A(&LIMCT)               LIMCT                            87660000
         DC    F'1'                    XCNT,XARG                        87750000
         DC    A(1)                    DRDX                             87840000
         DC    A(1)                    DFOR                             87930000
         DC    A(1)                    DFBK                             88020000
         DC    A(1)                    DYNB                             88110000
         MEXIT                                                  YA02128 88160000
.GEN7B5  AIF   (NOT (&MACRF2 OR &MACRFA)).GEN7C                         88200000
         AIF   ('&DEVD' NE 'BS' AND (T'&LERB EQ 'O' OR &B7) AND        *88290000
               ('&DEVD' EQ 'BS' OR '&DEVD' EQ 'WT' OR &B4 OR &B5 OR    *88340000
               &B6 OR &B7) AND NOT &B3 AND T'&READYQ EQ 'O').GEN7C      88370000
*                                                              @ZA21103 88400000
         SPACE 1                                                        88470000
*                       BTAM INTERFACE                                  88560000
         SPACE 1                                                        88650000
         AIF   (T'&LERB EQ 'O' OR &B7).GEN7B7                   YA02128 88740000
         DC    A(&LERB)                 LERB                            88920000
         AIF   (T'&READYQ EQ 'O').BYTE56                        YA02128 88970000
         IHBERMAC 1016,LERB,READYQ IHB276 LERB INCOMP W READYQ  YA02128 88980000
         AGO   .BYTE56                                                  89010000
.GEN7B7  AIF   (T'&READYQ EQ 'O').NOLERB                        YA02128 89060000
         AIF   ('&DEVD' EQ 'BS' OR '&DEVD' EQ 'WT').GEN7B8     @ZA21103 89070000
         AIF   ('&POWERON' EQ 'YES').GEN7B9                        @01A 89075000
         DC    X'02',AL3(&READYQ)       READYQ                          89080000
         AGO   .BYTE56                                          YA02128 89090000
.GEN7B9  DC    X'06',AL3(&READYQ)       READYQ&POWERON             @01A 89090600
         AGO   .BYTE56                                             @01A 89091200
.GEN7B8  IHBERMAC 1016,DEVD,READYQ IHB276 DEVD INCOMP W READYQ  YA02128 89092000
.NOLERB  DC    A(0)                     LERB                            89100000
.BYTE56  AIF   ('&DEVD' NE 'BS').GEN7C                          YA02128 89190000
&BA2     SETA  1                                                        89280000
&BS3     SETB  1                                                        89370000
         AIF   ('&MODE' EQ '').CHKCODE                                  89460000
&BA1     SETA  (N'&MODE)                                                89550000
&BS2     SETB  ('&MODE(&BA2)' EQ 'IBC')                                 89640000
         AIF   ('&MODE(&BA2)' NE '' AND NOT &BS2).ERROR                 89730000
         AIF   (&BA2 EQ &BA1).CHKCODE                                   89820000
&BA2     SETA  &BA2+1                                                   89910000
         AIF   ('&MODE(&BA2)' NE 'CNTRL').REMOTE                        90000000
&BS3     SETB  0                                                        90090000
.REMOTE  AIF   ('&MODE(&BA2)' NE '' AND &BS3).ERROR                     90180000
         AIF   (&BA2 EQ &BA1).CHKCODE                                   90270000
&BA2     SETA  &BA2+1                                                   90360000
&BS4     SETB  ('&MODE(&BA2)' EQ 'B')                                   90450000
         AIF   ('&MODE(&BA2)' NE 'A' AND '&MODE(&BA2)' NE ''           C90540000
               AND NOT &BS4).ERROR                                      90630000
         AIF   (&BA2 EQ &BA1).CHKCODE                                   90720000
&BA2     SETA  &BA2+1                                                   90810000
&BS5     SETB  ('&MODE(&BA2)' EQ 'B')                                   90900000
         AIF   ('&MODE(&BA2)' NE 'A' AND '&MODE(&BA2)' NE ''           C90990000
               AND NOT &BS5).ERROR                                      91080000
.CHKCODE ANOP                                                           91170000
&BS6     SETB  ('&CODE' EQ 'EBCDIC' OR '&CODE' EQ '')                   91260000
&BS7     SETB  ('&CODE' EQ 'USASCII')                                   91350000
&BS8     SETB  ('&CODE' EQ 'TRANSC')                                    91440000
         AIF   (NOT (&BS6 OR &BS7 OR &BS8)).ERROR2                      91530000
         DC    BL1'0&BS2&BS4.0&BS5.000'          MODE                   91620000
         DC    BL1'&BS3.0&BS8&BS7&BS8&BS7.00'    MAS,CODE               91710000
         DC    XL26'0'                           CONTROL CHARS          91800000
         DC    4F'0'                    RESERVED                        91890000
         SPACE 1                                                        91980000
         AGO   .GEN7C                                                   92070000
.ERROR   IHBERMAC 45,,&MODE(&BA2)                                       92160000
         MEXIT                                                          92250000
.ERROR2  MNOTE 12,'***  IHB002  INVALID CODE OPERAND SPECIFIED-&CODE'   92340000
.TCAM3A  ANOP                                                           92430000
&LGTH    SETA  0                                                        92520000
&INCR    SETA  1                                                        92610000
&NUMENT  SETA  N'&INVLIST                                               92700000
&NUMENT  SETA  &NUMENT+2                                                92790000
&NUMENT  SETA  &NUMENT/3                                                92880000
         DC    AL1(&NUMENT)             ILCT                            92970000
         AGO   .IN                                                      93060000
.TCAM3B  ANOP                                                           93150000
         AIF   (T'&BUFSIZE EQ 'O').TCAM31                               93240000
         AIF   (T'&BUFSIZE NE 'N').TCAM3C                        M4043  93280000
         AIF   ('&BUFSIZE' GT '35' AND '&BUFSIZE' LE '65535').TCAM3C    93350000
         IHBERMAC 180,BUFSIZE,0                                         93420000
.TCAM31  DC    AL2(0)                   BUFSIZE                         93510000
         AGO   .TCAM3CA                                                 93600000
.TCAM3C  DC    AL2(&BUFSIZE)            BUFSIZE                         93690000
.TCAM3CA ANOP                                                           93730000
&TC1     SETA  4                                                        93830000
.TCAM3C2 AIF   (&TC1 EQ 0).TCAM3D8                                      93930000
       AIF (T'&RESERVE(&TC1) EQ 'O' OR T'&RESERVE(&TC1) EQ 'U').TCAM3D2 94030000
         AIF   (&RESERVE(&TC1) LE 255).TCAM3D2                          94130000
         IHBERMAC 180,RESERVE,0                                         94230000
.TCAM3D  DC    A(0)                     RESERVE                         94330000
         AGO   .LOOPA                                                   94430000
.TCAM3D2 AIF   (T'&RESERVE(&TC1) EQ 'O').TCAM3D4                        94530000
&TC(&TC1) SETC '&RESERVE(&TC1)'                                         94630000
         AGO   .TCAM3D6                                                 94730000
.TCAM3D4 ANOP                                                           94830000
&TC(&TC1) SETC  '0'                                                     94930000
.TCAM3D6 ANOP                                                           95030000
&TC1     SETA  &TC1-1                                                   95130000
         AGO   .TCAM3C2                                                 95230000
.TCAM3D8 DC    AL1(&TC(1))         RESERVE                              95330000
         DC    AL1(&TC(2))         RESERVE                              95430000
         DC    AL1(&TC(3))         RESERVE                              95530000
         DC    AL1(&TC(4))         RESERVE                              95630000
.LOOPA   ANOP                                                           95850000
         AIF   (T'&INVLIST NE 'O').LOOP                                 95940000
         DC    A(1)                     INVLIST                         96030000
         IHBERMAC 24                                                    96120000
         AGO   .GEN7C                                                   96210000
.LOOP    AIF   ('&LGTH' EQ '&NUMENT').GEN7C                             96300000
         AIF   ('&INVLIST(&INCR+1)' EQ 'B').SETFCE                      96390000
&INTFACE SETA  0                                                        96480000
         AIF   ('&INVLIST(&INCR+1)' EQ 'A' OR '&INVLIST(&INCR+1)' EQ ''*96570000
               ).ISA1                                                   96660000
         IHBERMAC  183,INTERFACE,A                                      96750000
.ISA1    AIF   ('&INCR+1' LE '&LGTH').DCLR                              96840000
         AGO   .TSTCDE                                                  96930000
.SETFCE  ANOP                                                           97020000
&INTFACE SETA  20                                                       97110000
.TSTCDE  AIF   ('&INVLIST(&INCR+2)' EQ 'B').SETCDE                      97200000
         AIF   ('&INVLIST(&INCR+2)' EQ 'A' OR '&INVLIST(&INCR+2)' EQ ''*97290000
               ).ISA2                                                   97380000
         IHBERMAC   183,CODE,A                                          97470000
.ISA2    ANOP                                                           97560000
&ICDE    SETA  &INTFACE                                                 97650000
         AGO   .DCLR                                                    97740000
.SETCDE  ANOP                                                           97830000
&ICDE    SETA  &INTFACE+8                                               97920000
.DCLR    DC    XL1'&ICDE'                                               98010000
         DC    AL3(&INVLIST(&INCR))                                     98100000
&INCR    SETA  &INCR+3                                                  98190000
&LGTH    SETA  &LGTH+1                                                  98280000
         AGO   .LOOP                                                    98370000
.GEN7C   MEND                                                           98460000
