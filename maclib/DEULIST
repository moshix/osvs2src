         MACRO                                                          01000019
&NAME    DEULIST &DIGIT=,&MSG=,&LENGTH=,&MODULUS=,&DIGIT2=              02000021
         GBLA  &IECNDGP(100)                                            03000019
.*             IECNDGP(3)  COUNTER FOR NUMBER OF DEULIST MACROS         04000019
         GBLB  &IECSW(9),&IECTXT,&IECSEQ(10)                      12094 05000021
.*             IECSW(5)  INDICATES NOT FIRST MACRO                      06000019
.*             IECSW(8) SET WHEN MSG TXT APPEARS.INDICATES TO FOLLOWING 07000019
.*               TRLIST OR STEND MACRO THAT AN END OF LIST BYTE         08000019
.*             GENERATED BY THIS MACRO                                  09000019
.*             IECSEQ(5)  SEQUENCE INDICATOR                            10000019
         GBLB  &IECDE                                             21094 10200021
.*             IECDE   INDICATES DEULIST MACRO CODED              21094 10400021
         GBLB  &IECAS                                             21094 10600021
.*             IECAS    INDICATES ASLIST MACRO CODED              21094 10800021
         GBLB  &IECM10,&IECM11                                          10850021
.*             IECM10  INDICATES MODULUS 10 CHECKING IN TRLIST          10900021
.*             IECM11  INDICATES MODULUS 11 CHECKING IN TRLIST          10950021
         LCLA  &A,&B,&C                                                 11000019
         LCLB  &NCODE                                                   12000021
         LCLB  &SW(4)                                                   12500021
         LCLC  &CHAR                                                    13000019
&IECSEQ(5) SETB 1                                                       14000019
&IECDE   SETB 1                                                   21094 14500021
         AIF   (&IECSEQ(1) AND &IECSEQ(2) AND &IECSEQ(3) AND &IECSEQ(4)-15000019
               AND &IECSEQ(5) AND NOT&IECSEQ(6)).SEQOK                  16000019
.J       ANOP                                                     21094 16500021
         MNOTE 12,'MACRO SEQUENCE ERROR'                                17000019
         MEXIT                                                          18000019
.SEQOK   ANOP                                                           19000019
         AIF   (&IECAS).J                                         21094 19500021
&IECNDGP(3) SETA &IECNDGP(3)+1                                          20000019
         AIF   (&IECNDGP(3) LE 16).NOK                                  21000019
         MNOTE 12,'NO OF DEULIST MACROS EXCEEDS 16'                     22000019
         MEXIT                                                          23000019
.NOK     AIF   (T'&LENGTH EQ 'O').NOK1                                  24000019
         AIF   (T'&LENGTH EQ 'N').LTYPOK1                               25000019
&SW(3)   SETB  1                                                        26000019
&CHAR    SETC  T'&LENGTH                                                27000019
         MNOTE 12,'LENGTH TYPE ATTRIBUTE = &CHAR IMPROPER'              28000019
         AGO   .NOK1                                                    29000019
.LTYPOK1 ANOP                                                           30000019
&A       SETA  &LENGTH                                                  31000019
         AIF   (&A LE 18).NOK1                                          32000019
&SW(3)   SETB  1                                                        33000019
         MNOTE 3,'LENGTH = &A EXCEEDS MAXIMUM ALLOWED'                  34000019
.NOK1    AIF   (T'&DIGIT EQ 'O').CKMSG                                  35000019
         AIF   (T'&DIGIT(1) EQ 'N' AND T'&DIGIT(2) EQ 'N').TYPOK        36000019
&SW(1)   SETB  1                                                        37000019
&CHAR    SETC  T'&DIGIT                                                 38000019
         MNOTE 12,'DIGIT TYPE ATTRIBUTE = &CHAR IMPROPER'               39000019
         AGO   .CKMSG                                                   40000019
.TYPOK   ANOP                                                           41000019
&A       SETA  &DIGIT(1)                                                42000019
         AIF   (&A GE 1 AND &A LE 15).VALOK                             43000019
&SW(1)   SETB  1                                                        44000019
         MNOTE 3,'DIGIT CHECK POSITION = &A INVALID'                    45000019
.VALOK   ANOP                                                           46000019
&A       SETA  &DIGIT(2)                                                47000019
         AIF   (&A LE 9).CKMSG                                          48000019
&SW(1)   SETB  1                                                        49000019
         MNOTE 3,'DIGIT VALUE TO BE CHECKED=&A INVALID'                 50000019
.CKMSG   AIF   (T'&MSG EQ 'O').GENCODE                                  51000019
         AIF   (T'&MSG NE 'O' AND &IECTXT).CKMRMSG                      52000019
         MNOTE 3,'MSG OPERAND ILLEGALLY CODED'                          53000019
&SW(2)   SETB  1                                                        54000019
         AGO   .GENCODE                                                 55000019
.CKMRMSG AIF   ('&MSG'(1,1) EQ '''' AND '&MSG'(K'&MSG,1) EQ '''').MFOK  56000019
         MNOTE 3,'MSG OPERAND IN INCORRECT FORMAT,OPERAND IGNORED'      57000019
&SW(2)   SETB  1                                                        58000019
         AGO   .GENCODE                                                 59000019
.MFOK    ANOP                                                           60000019
&B       SETA  K'&MSG-2                                                 61000019
         AIF   (&B GE 0 AND &B LE 127).GENCODE                          62000019
         MNOTE 3,'MESSAGE LENGTH EXCEEDS 127,OPERAND IGNORED'           63000019
&SW(2)   SETB  1                                                        64000019
.GENCODE ANOP                                                           65000019
         AIF   (T'&MODULUS EQ 'O').MOD6                                 65010021
         AIF   (T'&MODULUS(1) EQ 'N' AND T'&MODULUS(2) EQ 'N').MOD1     65020021
&SW(1)   SETB  1                                                        65030021
         MNOTE 3,'MODULUS = &MODULUS INVALID'                           65040021
         AGO   .MOD3                                                    65050021
.MOD1    ANOP                                                           65060021
&A       SETA  &MODULUS(1)                                              65070021
         AIF   (&A GE 2 AND &A LE 16).MOD2                              65080021
&SW(1)   SETB  1                                                        65090021
         MNOTE 3,'MODULUS POSITION = &A INVALID'                        65100021
.MOD2    ANOP                                                           65110021
&A       SETA  &MODULUS(2)                                              65120021
         AIF   (&A GE 1 AND &A LE 15).MOD3                              65130021
&SW(1)   SETB  1                                                        65140021
         MNOTE 3,'MODULUS LENGTH = &A INVALID'                          65150021
.MOD3    ANOP                                                           65160021
         AIF   (T'&MODULUS EQ 'O').MOD6                                 65170021
         AIF   (T'&DIGIT EQ 'O').MOD4                                   65180021
&NCODE   SETB  1                                                        65190021
         MNOTE 12,' MODULUS AND DIGIT OPERANDS MUTUALLY EXCLUSIVE'      65200021
.MOD4    ANOP                                                           65210021
         AIF   (&IECSW(1)).MOD5                                         65220021
&NCODE   SETB  1                                                        65230021
         MNOTE 12,'MODULUS OPERAND NOT VALID UNLESS CORE=32 IN CONFIGURX65240021
               MACRO'                                                   65250021
.MOD5    ANOP                                                           65260021
         AIF   (&IECM10 OR &IECM11).MOD6                                65270021
&NCODE   SETB  1                                                        65280021
         MNOTE 12,'MODULUS OPERAND REQUIRES THAT EITHER DEMOD10=YES OR X65290021
               DEMOD11=YES BE CODED IN TRLIST MACRO'                    65300021
.MOD6    ANOP                                                           65310021
         AIF   (T'&DIGIT EQ 'O').MOD7                                   65320021
         AIF   (&IECM10 OR &IECM11).ERROR1                              65330021
         AGO   .MOD7                                                    65340021
.ERROR1  ANOP                                                           65350021
&NCODE   SETB  1                                                        65360021
         MNOTE 12,'DIGIT OPERAND CAN NOT BE CODED IF DEMOD10=YES OR    X65370021
               DEMOD11=YES IN TRLIST MACRO'                             65380021
.MOD7    ANOP                                                           65390021
         AIF   (T'&DIGIT2 EQ 'O').D2                                    65400021
         AIF   (T'&DIGIT2(1) EQ 'N' AND T'&DIGIT2(2) EQ 'N').D3         65410021
&SW(4)   SETB  1                                                        65420021
&CHAR    SETC  T'&DIGIT2                                                65430021
         MNOTE 3,'DIGIT2 TYPE ATTRIBUTE = &CHAR IMPROPER'               65440021
         AGO   .D2                                                      65450021
.D3      ANOP                                                           65460021
&A       SETA  &DIGIT2(1)                                               65470021
         AIF   (&A GE 1 AND &A LE 15).D4                                65480021
&SW(4)   SETB  1                                                        65490021
         MNOTE 3,'DIGIT2 CHECK POSITION = &A INVALID'                   65500021
.D4      ANOP                                                           65510021
&A       SETA  &DIGIT2(2)                                               65520021
         AIF   (&A LE 9 AND &A GE 0).D2                                 65530021
&SW(4)   SETB  1                                                        65540021
         MNOTE 3,'DIGIT2 VALUE TO BE CHECKED = &A INVALID'              65550021
.D2      ANOP                                                           65560021
&A       SETA  0                                                        66000019
&B       SETA  0                                                        67000019
         AIF   (NOT &IECSW(5)).SKIP                                     68000019
&C       SETA  X'C0'                                                    69000019
.SKIP    DC    YL1(&C)                                                  70000019
         AIF   (T'&DIGIT EQ 'O' OR &SW(1)).NOSET                        71000019
&A       SETA  &DIGIT(1)                                                72000019
&B       SETA  &DIGIT(2)                                                73000019
.NOSET   ANOP                                                           74000021
         AIF   (T'&MODULUS EQ 'O' OR &SW(1)).NOSET1                     74100021
&A       SETA  &MODULUS(1)-1                                            74200021
&B       SETA  &MODULUS(2)                                              74300021
.NOSET1  ANOP                                                           74400021
         DC    YL1(&A*16+&B) DIGIT OR MODULUS POSITION AND VALUE        74500021
&A       SETA  0                                                        75000019
         AIF   (T'&LENGTH EQ 'O' OR &SW(3)).SETNOT                      76000019
&A       SETA  &LENGTH                                                  77000019
.SETNOT  DC    YL1(&A)  LENGTH                                          78000019
         DC    X'00'                                                    79000021
&A       SETA  0                                                        79100021
&B       SETA  0                                                        79200021
         AIF   (T'&DIGIT2 EQ 'O' OR &SW(4)).SKIP1                       79300021
&A       SETA  &DIGIT2(1)                                               79400021
&B       SETA  &DIGIT2(2)                                               79500021
.SKIP1   ANOP                                                           79600021
         DC    YL1(&A*16+&B) SECOND DIGIT POSITION AND VALUE OR NULL    79700021
&B       SETA  0                                                        80000019
         AIF   (T'&MSG EQ 'O' OR &SW(2)).ADD                            81000019
&IECSW(8) SETB 1                                                        82000019
         DC    YL1(&IECNDGP(4))  END OF LIST BYTE                       83000019
&B       SETA  K'&MSG-2                                                 84000019
         DC    YL1(&B)  MESSAGE LENGTH                                  85000019
         DC    C&MSG                                                    86000019
&B       SETA  &B+1                                                     87000019
&IECTXT  SETB  0  RESET TO PREVENT DEULIST EXPANSION FOLLOWING MSG TXT  88000019
.ADD     ANOP                                                           89000019
&IECNDGP(1) SETA &IECNDGP(1)+5+&B                                       90000019
&IECSW(5) SETB 1                                                        91000019
.MEND    MEND                                                           92000019
