*%/*                                                                    00060002
* MACSTAT Y-3                                                  @ZA00466 00061003
* MACSTAT Y-3                                                  @ZA14267 00062003
* MACSTAT Y-3                                                  @ZA24620 00063003
* MACSTAT Y-3 77.277/OZ26012                                   @ZA26012 00064003
* MACSTAT Y-3 77.277/OZ26497                                   @ZA26497 00065003
* MACSTAT Y-3 79.066/OZ37604 FIX DEQ EXECUTE WITH UCB          @ZA37604 00070003
* MACSTAT Y-3 81.293/OZ53727 UPDATE PARAMETER BYTE WITH PARAMETERS      00072503
*                            SPECIFIED IN EACH ELEMENT ON MULTIPLE      00075003
*                            ENQUEUE.                          @ZA53727 00077503
         MACRO                                                          00080003
&NAME    ENQ   &P,&SMC=,&RET=,&UCB=,&ECB=,&TCB=,&GENERIC=NO,&MF=I,     X00100002
               &RELATED=                                                00110002
.*                                                               X02113 00150002
.*                                                                      00200002
.* DEFINE VARIABLES                                                     00250002
.*                                                                      00300002
         GBLB  &IHBRES                 RESERVE MACRO CALL INDICATOR     00350002
         GBLB  &IHBDEQ                 DEQ MACRO CALL INDICATOR         00400002
         GBLC  &LABEL                  USED TO BRANCH PAST PARM LIST    00450002
         LCLA  &QN,&RN,&ES,&RL,&SS     INDICES TO PARM SUB OPERANDS     00500002
         LCLA  &LEN                    LENGTH INTERMEDIARY              00550002
         LCLA  &LIST                   PARAMETER BUILD LIST POINTER     00600002
         LCLA  &LISTA                  PARAMETER BUILD LIST POINTER     00620002
         LCLA  &MASK                   TO GATHER 'AND' AND 'OR' FOR EXC 00650002
         LCLA  &NUMBER                 COUNT OF POSITIONAL PARMS        00700002
         LCLA  &LSTEND                 USED TO SET LISTEND BITS  X02113 00750002
         LCLB  &NQ                     ENQ/RES EXTRA PARM INDICATOR     00800002
         LCLB  &B(8),&BB(5),&BA(2)     REPRESENTING BITS OF CODE FIELD  00850002
         LCLC  &C                      TO GATHER REG PARM W/O PARENS    00900002
.*                                                                      00950002
.* SET MACRO COUNTS                                                     01000002
&NQ      SETB  (NOT(&IHBDEQ))                                           01050002
         AIF   ('&MF(1)' NE 'E' AND '&P' EQ '').ERR1                    01100002
&NUMBER  SETA  N'&P                                                     01150002
         AIF   ('&NUMBER' GT '5' AND '&UCB' NE '').ERR7                 01200002
.*                                                                      01250002
.* INDICATORS FOR KEYWORD OPERANDS APPLYING TO ALL ENTRIES              01300002
.*                                                                      01350002
         AIF   (&IHBDEQ).CHKGEN                                  X02113 01400002
         AIF   ('&GENERIC' NE 'NO').ERR18                        X02113 01450002
         AGO   .NCHKGEN                                          X02113 01500002
.CHKGEN  ANOP                                                    X02113 01550002
         AIF   ('&GENERIC' NE 'NO' AND '&GENERIC' NE 'YES').ERR16       01600002
.*                                                               X02113 01650002
         AIF   ('&GENERIC' EQ 'YES' AND '&RET' NE 'HAVE').ERR17  X02113 01700002
.NCHKGEN ANOP                                                    X02113 01750002
         AIF   (&IHBRES OR &IHBDEQ).NOTENQ                       X02113 01800002
         AIF   ('&TCB' NE '' AND '&ECB' NE '').BOTH2  RET NOT  @ZA14267 01805003
.*                                     PERMITTED WITH ECB AND  @ZA14267 01810003
.*                                     TCB (SAME AS ECB ONLY)  @ZA14267 01825003
         AIF   ('&RET' EQ 'HAVE' AND '&TCB' NE '').ERR13         X02113 01850002
         AIF   ('&RET' EQ 'NONE' AND '&TCB' NE '').ERR13         X02113 01900002
         AIF   ('&RET' EQ '' AND '&TCB' NE '').ERR13             X02113 01950002
.*                                     TCB NOT ALLOWED WITH      X02113 02000002
.*                                     RET=HAVE,NONE,OMITTED     X02113 02050002
.*                                     ON ENQ                    X02113 02100002
.BOTH2   ANOP                                                  @ZA14267 02110003
         AIF   ('&TCB' NE '' AND '&SMC' NE '').ERR12             X02113 02150002
.*                                     TCB WITH SMC INVALID      X02113 02200002
.NOTENQ  ANOP                                                    X02113 02250002
         AIF   ('&ECB' NE '' AND '&SMC' NE '' OR '&ECB' NE '' AND '&RET*02300002
               ' NE '').ERR11            SMC, RET NOT ALLOWED WITH ECB  02350002
.SMC     AIF   ('&SMC' EQ '' OR '&SMC' EQ 'NONE').RET                   02400002
&B(2)    SETB  0                                               @ZA12435 02420003
&B(3)    SETB  ('&SMC' EQ 'STEP')                                       02500002
         AIF   (NOT &B(3)).ERR8                                @ZA12435 02520003
.RET     AIF   ('&RET' EQ '' OR '&RET' EQ 'NONE').LOOP                  02600002
         AIF   (&IHBDEQ).RETDEQ                                         02650002
&B(5)    SETB  ('&RET' EQ 'TEST' OR '&ECB' NE '')                       02700002
&B(6)    SETB ('&RET' EQ 'TEST' OR '&RET' EQ 'USE' OR '&RET' EQ 'CHNG') 02750002
&B(7)    SETB ('&RET' EQ 'TEST' OR '&RET' EQ 'USE' OR '&RET' EQ 'HAVE') 02800002
         AGO   .RETCK                                                   02850002
.RETDEQ  ANOP                                                           02900002
&B(7)    SETB  ('&RET' EQ 'HAVE')                                       02950002
.RETCK   AIF   (NOT &B(5) AND NOT &B(6) AND NOT &B(7)).ERR5             03000002
.LOOP    ANOP                                                           03050002
.*                                                                      03100002
.* SORT MACRO FORM                                                      03150002
         AIF   ('&MF(1)' EQ 'E').EROUT EXECUTE FORM ROUTINE             03200002
         AIF   ('&MF' EQ 'L').DS       SET NAME FIELD FOR LIST FORM     03250002
         AIF   ('&MF' NE 'I').ERR4     LAST POSSIBLE CHOICE             03300002
.*                                                                      03350002
.* SET THE NAME FIELD AND ADDRESS THE LIST                              03400002
&LABEL   SETC  'IHB'.'&SYSNDX'         UNIQUE TAG TO BRANCH AROUND LIST 03450002
         CNOP  0,4                                                      03500002
&NAME    BAL   1,&LABEL                BRANCH AROUND AND ADDRESS LIST   03550002
         AGO   .CHKTCB1                CHECK FOR PREFIX        @ZA14267 03570003
.DS      ANOP                                                           03650002
         DS    0F                      ESTABLISH A FULLWORD BOUNBARY    03700002
.*                                                                      03750002
.* DEFINE THE PARAMETER LIST                                            03800002
.*                                                                      03850002
.* TCB PARAMETER                                               @ZA14267 03853003
.CHKTCB1 AIF ('&TCB' EQ '').ECB        NOT TCB, CHECK ECB      @ZA14267 03859003
&LSTEND  SETA  1                       SHOW DIRECTED ENQ/DEQ     X02113 03868003
         AIF   ('&MF' EQ 'I').STNDARD  IF LIST FORM, TCB=0       X02113 03874003
         AIF   ('&TCB' NE '0').ERR15   ERROR IN SPECIFYING TCB   X02113 03880003
.STNDARD ANOP                                                    X02113 03886003
.TCBREG  DC    A(0)                    PREFIX - TCB ADDRESS      X02113 03892003
.*                                                                      03896003
.* ECB PARAMETER                                                        03900002
.ECB     AIF   ('&ECB' EQ '').DEFLOOP  IF NOT ECB, CONTINUE    @ZA14267 03910003
         AIF   (&IHBDEQ).ERR6          ECB NOT ALLOWED W. DEQ           04000002
&B(5)    SETB  1                       ECB INDICATOR                    04100002
         AIF   ('&ECB'(1,1) EQ '(').ECBREG     ADDRESS FOUND IN A REG   04150002
         DC    A(&ECB)                 PREFIX - ECB ADDRESS             04200002
         AGO   .DEFLOOP                                                 04250002
.ECBREG  AIF   ('&MF' EQ 'L').ERR3                                      04300002
         DC    A(0)                    PREFIX - ECB ADDRESS             04350002
.*                                                                      04750002
.* SET POSITIONAL PARAMETER INDICES                                     04800002
.DEFLOOP ANOP                                                           04850002
         AIF   ('&GENERIC' EQ 'NO').NOGEN1                       X02113 04900002
&LSTEND  SETA  &LSTEND+2               INDICATE GENERIC DEQ      X02113 04950002
.NOGEN1  ANOP                                                    X02113 05000002
         AIF   ('&MF' EQ 'I').STNDFRM                            X02113 05050002
         AIF   ('&NAME' EQ '').STNDFRM                           X02113 05100002
&NAME    EQU   *                                                 X02113 05150002
.STNDFRM ANOP                                                    X02113 05200002
&QN      SETA  1                       INDEX TO QNAME POSITIONAL PARM   05250002
.LOOP1   ANOP                                                           05300002
&RN      SETA  &QN+1                   RNAME - 2ND POSITIONAL PARM      05350002
&ES      SETA  &RN+&NQ                 EX/SHR - 3RD W. ENQ RES          05400002
&RL      SETA  &ES+1                   RNAME LENGTH - NEXT PARM         05450002
&SS      SETA  &RL+1                   STEP/SYSTEM - LAST PARM OF SEQ   05500002
.* ENTRY VARIABLES                                                      05550002
&B(8)    SETB  0                       SHARED/EXCLUSIVE - EX DEFAULTS   05600002
&B(1)    SETB  0                       SCOPE - 1 EQ SYSTEM OR SYSTEMS   05650002
&B(4)    SETB  0                       0 EQ STEP; 1 EQ SYSTEMS OR UCB   05700002
.*                                                                      05750002
.* EXCLUSIVE/SHARED PARAMETER - ENQ/RES ONLY                            05800002
         AIF   (&IHBDEQ).SCOPE                                          05850002
         AIF   ('&P(&ES)' EQ '' OR '&P(&ES)' EQ 'E').SCOPE              05900002
         AIF   ('&P(&ES)' NE 'S').ERR9                                  05950002
&B(8)    SETB  1                       SHARED REQUEST                   06000002
.* SCOPE - STEP/SYSTEM/SYSTEMS                                          06050002
.SCOPE   AIF   ('&UCB' NE '').UCB                                       06100002
         AIF   ('&P(&SS)' EQ '' OR '&P(&SS)' EQ 'STEP').LISTEND         06150002
&B(1)    SETB  ('&P(&SS)' EQ 'SYSTEMS')                                 06200002
&B(4)    SETB  ('&P(&SS)' EQ 'SYSTEMS')                                 06250002
         AIF   (&B(1)).LISTEND                                          06300002
&B(1)    SETB  ('&P(&SS)' EQ 'SYSTEM')                                  06350002
         AIF   (NOT &B(1)).ERR10                                        06400002
         AGO   .LISTEND                                                 06450002
.UCB     ANOP                                                           06500002
&B(4)    SETB  1                                                   SDS1 06550002
.*                                                                      06600002
.* DEFINE THE FIELDS FOR ONE ENTRY                                      06650002
.LISTEND AIF   ('&LSTEND' NE '0').NOLD IF NO NEW OPTIONS, SET    X02113 06700002
.*                                     TO DISREGARD BITS 2-7     X02113 06750002
&LSTEND  SETA  64                      INDICATE NO NEW OPTIONS   X02113 06800002
.NOLD    ANOP                                                    X02113 06850002
         AIF   (&QN+4+&NQ LE &NUMBER).NOTLAST                    X02113 06900002
&LSTEND  SETA  &LSTEND+128             SET TO SHOW END OF LIST   X02113 06950002
.NOTLAST DC    AL1(&LSTEND)            LISTEND BYTE              X02113 07000002
.* RNAME LENGTH                                                         07050002
.LENGTH  AIF   ('&P(&RL)' EQ '' AND '&MF' EQ 'L').NAMEL                 07100002
         AIF   ('&P(&RN)' EQ '').SKIP                                   07150002
         AIF   ('&P(&RL)' EQ '' AND '&P(&RN)'(1,1) EQ '(').ERR2         07200002
.SKIP    AIF   ('&P(&RL)' EQ '').NAMEL                                  07250002
         AIF   ('&P(&RL)'(1,1) EQ '(').REGL                             07300002
         DC    AL1(&P(&RL))            RNAME LENGTH                     07350002
         AGO   .CODE                                                    07400002
.REGL    AIF   ('&MF' EQ 'L').ERR3                                      07450002
.ZEROL   DC    AL1(0)                   RNAME LENGTH                    07500002
         AGO   .CODE                                                    07550002
.NAMEL   AIF   ('&P(&RN)' EQ '').ZEROL                                  07600002
&LEN     SETA  L'&P(&RN)                                                07650002
         DC    AL1(&LEN)               RNAME LENGTH                     07700002
.* OPTIONS AND CODE                                                     07750002
.CODE    DC    BL1'&B(8)&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)'  OPTIONS   07800002
         DC    AL1(0)                  RETURN CODE FIELD                07850002
.* QNAME AND RNAME ADDRESSES                                            07900002
         AIF   ('&P(&QN)' EQ '' AND '&MF' EQ 'L').ZEROQ                 07950002
         AIF   ('&P(&QN)' EQ '').ERR2                                   08000002
         AIF   ('&P(&QN)'(1,1) EQ '(').REGQ                             08050002
         DC    A(&P(&QN))              QNAME ADDRESS                    08100002
         AGO   .RNAME                                                   08150002
.REGQ    AIF   ('&MF' EQ 'L').ERR3                                      08200002
.ZEROQ   DC    A(0)                    QNAME ADDRESS                    08250002
.RNAME   AIF   ('&P(&RN)' EQ '' AND '&MF' EQ 'L').ZEROR                 08300002
         AIF   ('&GENERIC' EQ 'NO').NOGEN2                       X02113 08350002
         AIF   ('&P(&RN)' EQ '').ZEROR SHOULD BE NO RNAME W GEN. X02113 08400002
         IHBERMAC 1016,RNAME,GENERIC                             X02113 08450002
         AGO   .ZEROR                                            X02113 08500002
.NOGEN2  ANOP                                                    X02113 08550002
         AIF   ('&P(&RN)' EQ '').ERR2                                   08600002
         AIF   ('&P(&RN)'(1,1) EQ '(').REGR                             08650002
         DC    A(&P(&RN))              RNAME ADDRESS                    08700002
         AGO   .CONT                                                    08750002
.REGR    AIF   ('&MF' EQ 'L').ERR3                                      08800002
.ZEROR   DC    A(0)                    RNAME ADDRESS                    08850002
.CONT    ANOP                                                           08900002
&QN      SETA  &QN+4+&NQ                                                08950002
         AIF   (&QN LE &NUMBER).LOOP1                            X02113 09000002
.*                                                                      09050002
.* UCB PARAMETER                                                        09100002
.END     AIF   ('&UCB' EQ '').ENQ050                               SDS1 09150002
         AIF   ('&UCB'(1,1) EQ '(').ENQ040                         SDS1 09200002
         DC    A(&UCB)                 UCB PARAMETER                    09250002
         AGO   .ENQ050                                             SDS1 09300002
.ENQ040  AIF   ('&MF' EQ 'L').ERR3                                      09350002
         DC    A(0)                    UCB PARAMETER                    09400002
.* LIST FORM EXIT                                                       09450002
.ENQ050  AIF   ('&MF' EQ 'I').STORE                                     09500002
&IHBDEQ  SETB  0                                                        09550002
&IHBRES  SETB  0                                                   SDS1 09600002
         MEXIT                                                          09650002
.*                                                                      09700002
.*  STORE VALUES IF PRESENT                                    @ZA14267 09710003
.*                                                                      09800002
.STORE   ANOP                                                           09850002
&LABEL   DS    0H            OBJECT OF THE BAL                          09900002
         AIF   ('&TCB' EQ '').CHKECB   IF NOT TCB, CHECK ECB   @ZA14267 09901003
         AIF   ('&TCB'(1,1) EQ '(').STRGTCB CHK FOR NONREG PTR @ZA14267 09903003
         L     0,&TCB                  PICK UP TCB ADDRESS     @ZA14267 09906003
         ST    0,0(0,1)                PUT IN PREFIX           @ZA14267 09909003
         AGO   .CHKECB                 GO CHECK FOR ECB PFX    @ZA14267 09913003
.STRGTCB ANOP                          TCB PTR PASSED IN REG   @ZA14267 09914003
&LEN     SETA  K'&TCB-2                SET LEN OF REG NBR      @ZA14267 09918003
&C       SETC  '&TCB'(2,&LEN)          SET DC TO REG NBR       @ZA14267 09921003
         ST    &C,0(0,1)               STORE TCB ADDRESS       @ZA14267 09925003
.CHKECB  ANOP                                                  @ZA14267 09926003
         AIF   ('&ECB' EQ '').CHKLA    ECB NOT CODED           @ZA14267 09931003
         AIF   ('&ECB'(1,1) NE '(').CHKLA                      @ZA14267 09932003
.* (IF ECB WAS CODED BUT NOT AS A REG, IT IS ALREADY IN PFX)   @ZA14267 09933003
&LEN     SETA  K'&ECB-2                SET LEN OF REG NBR      @ZA14267 09934003
&C       SETC  '&ECB'(2,&LEN)          SET &C TO REG NBR       @ZA14267 09935003
         AIF   ('&TCB' NE '').BOTH4    8-BYTE PREFIX           @ZA14267 09936003
.* STORE ECB PTR IN 4-BYTE PREFIX                              @ZA14267 09937003
         ST    &C,0(0,1)               STORE ECB ADDRESS       @ZA14267 09938003
         AGO   .CHKLA                  CONTINUE                @ZA14267 09939003
.BOTH4   ANOP  STORE ECB PTR IN SECOND HALF OF PREFIX          @ZA14267 09940003
         ST    &C,4(0,1)               STORE ECB ADDRESS       @ZA14267 09941003
.*                                                                      09950002
.* ADJUST PARAMETER LIST POINTER PAST THE PREFIX IF PRESENT             09970003
.CHKLA   AIF   ('&TCB' EQ '' AND '&ECB' EQ '').SETUP NO PREFIX @ZA14267 09980003
         AIF   ('&TCB' NE '' AND '&ECB' NE '').BOTH 8-BYTE PFX @ZA14267 09990003
         LA    1,4(0,1)               MOVE POINTER PAST PREFIX @ZA14267 10000003
         AGO   .SETUP                                          @ZA14267 10024003
.BOTH    LA    1,8(0,1)               MOVE POINTER PAST PREFIX @ZA14267 10032003
.*                                                                      10080003
.* ESTABLISH COUNTS                                                     10800002
.SETUP   ANOP                                                           10850002
&LIST    SETA  0                         INDEX TO PARAMETER LIST        10900002
&QN      SETA  1                                                        10950002
.LOOP2   ANOP                                                           11000002
&RN      SETA  &QN+1                                                    11050002
&RL      SETA  &QN+2+&NQ                                                11100002
&LIST    SETA  &LIST+1                  POINT INDEX TO RNAME LENGTH     11150002
         AIF   ('&P(&RL)' EQ '').NOREGL                                 11200002
         AIF   ('&P(&RL)'(1,1) NE '(').NOREGL                           11250002
&LEN     SETA  K'&P(&RL)-2                                              11300002
&C       SETC  '&P(&RL)'(2,&LEN)                                        11350002
         STC   &C,&LIST.(0,1)                     STORE RNAME LENGTH    11400002
.*                                                                      11450002
.* QNAME ADDRESS                                                        11500002
.NOREGL  ANOP                                                           11550002
&LIST    SETA  &LIST+3                   ADDRESS QNAME ADDRESS SLOT     11600002
         AIF   ('&P(&QN)'(1,1) NE '(').NOREGQ                           11650002
&LEN     SETA  K'&P(&QN)-2                                              11700002
&C       SETC  '&P(&QN)'(2,&LEN)                                        11750002
         ST    &C,&LIST.(0,1)                     STORE QNAME ADDRESS   11800002
.*                                                                      11850002
.* RNAME ADDRESS                                                        11900002
.NOREGQ  ANOP                                                           11950002
&LIST    SETA  &LIST+4                                                  12000002
         AIF   ('&GENERIC' EQ 'YES').NOREGR                      X02113 12050002
.*                                     IGNORE RNAME IF GENERIC   X02113 12100002
         AIF   ('&P(&RN)'(1,1) NE '(').NOREGR                           12150002
&LEN     SETA  K'&P(&RN)-2                                              12200002
&C       SETC  '&P(&RN)'(2,&LEN)                                        12250002
         ST    &C,&LIST.(0,1)                     STORE RNAME ADDRESS   12300002
.NOREGR  ANOP                                                           12350002
&LIST    SETA  &LIST+4                                                  12400002
&QN      SETA  &QN+4+&NQ                                                12450002
         AIF   (&QN LE &NUMBER).LOOP2                            X02113 12500002
.END1    AIF   ('&UCB' EQ '').ENQ060                               SDS1 12550002
         AIF   ('&UCB'(1,1) NE '(').ENQ060                         SDS1 12600002
&LEN     SETA  K'&UCB-2                                            SDS1 12650002
&C       SETC  '&UCB'(2,&LEN)                                     SDS1  12700002
         ST    &C,&LIST.(0,1)     STORE UCB PARAMETER              SDS1 12750002
.ENQ060  AIF   (&IHBDEQ OR &IHBRES).MEXIT                          SDS1 12800002
         SVC   56                                                       12850002
.* RETURN WITHOUT SVC                                                   12900002
.MEXIT   MEXIT                                                          12950002
.*                                                                      13000002
.* EXECUTE FORM                                                         13050002
.*                                                                      13100002
.EROUT   ANOP                                                           13150002
         AIF   (N'&MF NE 2).ERR4                                        13200002
         AIF   ('&TCB' NE '' AND '&ECB' NE '').BOTH3           @ZA14267 13210003
.*                                     BRANCH IF 8-BYTE PREFIX @ZA14267 13250003
         AIF   ('&TCB' EQ '').CHKECB2  GO CHECK FOR ECB        @ZA14267 13290003
.*                                                                      15200003
.* BUILD PREFIX IF ONLY TCB WAS SPECIFIED                      @ZA14267 15205003
.*                                                                      15210003
&BA(1)   SETB  1                                                        15220002
         AIF   ('&MF(2)'(1,1) EQ '(').NEGADR                     X02113 15250002
.*                                     MUST ADDR TCB W NEG REG   X02113 15300002
         AIF   ('&TCB'(1,1) EQ '(').STRTCB                       X02113 15350002
&NAME    L     1,&TCB                  PICK UP TCB ADDRESS       X02113 15400002
         ST    1,&MF(2)-4              STORE IN PARM LIST PREFIX X02113 15450002
         AGO   .ADDRLST                                          X02113 15500002
.*                                                               X02113 15550002
.STRTCB  ANOP                                                    X02113 15600002
&LEN     SETA  K'&TCB-2                SET &LEN TO LEN OF REG NBRX02113 15650002
&C       SETC  '&TCB'(2,&LEN)          SET &C TO REG NBR         X02113 15700002
&NAME    ST    &C,&MF(2)-4             PUT TCB ADDR IN PARM LIST X02113 15750002
.ADDRLST LA    1,&MF(2)                ADDRESS THE LIST          X02113 15800002
         AGO   .EXLOOPS                                          X02113 15850002
.*                                                               X02113 15900002
.* PARM LIST ADDRESS IS IN REG                                   X02113 15950002
.NEGADR  ANOP                                                    X02113 16050002
&NAME    LA    0,4(0,0)                LENGTH OF PREFIX          YM1995 16100002
         AIF   (K'&MF(2) EQ 3 AND '&MF(2)'(2,1) EQ '1').INREG1   X02113 16150002
.*                                     CHECK IF PARM LIST ADDR   X02113 16200002
.*                                     IS IN REG 1               X02113 16250002
&LEN     SETA  K'&MF(2)-2              IF NOT IN REG1, GET REG   X02113 16300002
&C       SETC  '&MF(2)'(2,&LEN)        AND PUT CONTENTS IN REG 1 X02113 16350002
         LR    1,&C                    SET PARM LIST IN REG 1    X02113 16400002
.INREG1  SR    1,0                     ADDRESS THE PREFIX        X02113 16450002
         AIF   ('&TCB'(1,1) EQ '(').TCBINR                       X02113 16500002
         L     0,&TCB                  PICK UP TCB ADDRESS       X02113 16550002
         ST    0,0(0,1)                SET ITS ADDR IN PREFIX    YM1995 16600002
         LA    1,4(0,1)                ADDRESS PARM LIST BODY    YM1995 16650002
         AGO   .EXLOOPS                                          X02113 16700002
.*                                                               X02113 16750002
.TCBINR  ANOP                          TCB IS IN REG             X02113 16800002
&LEN     SETA  K'&TCB-2                                          X02113 16850002
&C       SETC  '&TCB'(2,&LEN)                                    X02113 16900002
         ST    &C,0(0,1)               SET TCB IN PARM PREFIX    YM1995 16950002
         AR    1,0                     ADDRESS PARM LIST BODY    X02113 17000002
         AGO   .EXLOOPS                                          X02113 17050002
.*                                                                      17050103
.CHKECB2 AIF   ('&ECB' EQ '').INNRA    NO PREFIX               @ZA14267 17050203
.*                                                                      17050903
.*BUILD PREFIX IF ONLY ECB WAS SPECIFIED                       @ZA14267 17051003
.*                                                                      17051903
         AIF   ('&MF(2)'(1,1) EQ '(').NEG   MUST ADDRESS W NEG REG      17052003
.*                                                                      17052103
.* THE PARAMETER LIST IS NAMED                                          17052203
         AIF   ('&ECB'(1,1) EQ '(').STORECB                             17052303
&NAME    LA    1,&ECB                  . ADDRESS THE ECB                17052403
         ST    1,&MF(2)-4              . SET IN PARM LIST PREFIX        17052503
         AGO   .ADLIST                                                  17052603
.*                                                                      17052703
.STORECB ANOP                                                           17052803
&LEN     SETA  K'&ECB-2                                          X02113 17052903
&C       SETC  '&ECB'(2,&LEN)          GET REGISTER NAME         X02113 17053003
&NAME    ST    &C,&MF(2)-4             . SET ECB ADDR IN PREFIX         17053103
.ADLIST  LA    1,&MF(2)                . ADDRESS THE LIST               17053203
         AGO   .EXLOOPS                                                 17053303
.*                                                                      17053403
.* MUST ADDRESS THE ECB SLOT IN A REG                                   17053503
.NEG     ANOP                                                           17053603
&NAME    LA    0,4(0,0)                . LENGTH OF PREFIX        YM1995 17053703
         AIF   (K'&MF(2) EQ 3 AND '&MF(2)'(2,1) EQ '1').PASS2           17053803
&LEN     SETA  K'&MF(2)-2                                               17053903
&C       SETC  '&MF(2)'(2,&LEN)                                         17054003
         LR    1,&C                    . SET PARM LIST REG 1            17054103
.PASS2   SR    1,0                     . ADDRESS THE PREFIX             17054203
         AIF   ('&ECB'(1,1) EQ '(').STREG                               17055103
         LA    0,&ECB                  . AND THE ECB                    17055203
         ST    0,0(0,1)            . SET ITS ADDR IN PARM PREFIX YM1995 17055303
         LA    1,4(0,1)            . ADDRESS PARM LIST BODY      YM1995 17055403
         AGO   .EXLOOPS                                                 17055503
.*                                                                      17055603
.STREG   ANOP                                                           17055703
&LEN     SETA  K'&ECB-2                                                 17055803
&C       SETC  '&ECB'(2,&LEN)                                           17056003
         ST    &C,0(0,1)               . SET ECB IN PARM PREFIX  YM1995 17056103
         AR    1,0                     . ADDRESS PARM LIST BODY         17056203
         AGO   .EXLOOPS                                                 17056303
.*                                                                      17056403
.*                                                                      17056503
.* BUILD PREFIX IF BOTH TCB AND ECB ARE SPECIFIED              @ZA14267 17056603
.*                                                                      17056803
.BOTH3   ANOP                                                  @ZA14267 17056903
&BA(1)   SETB  1                       SET TCB                 @ZA14267 17057003
         AIF   ('&MF(2)'(1,1) EQ '(').NEGADR2                  @ZA14267 17057103
.*                                     A REG POINTS TO LIST    @ZA14267 17057203
.*       THE PARAMETER LIST IS NAMED                           @ZA14267 17057303
.*                                                                      17057903
         AIF   ('&TCB'(1,1) EQ '(').STRTCB2 PTR TO TCB IN REG  @ZA14267 17058103
&NAME    L     1,&TCB                  PICK UP TCB ADDRESS     @ZA14267 17058503
         ST    1,&MF(2)-8              STORE IN PARM LIST PFX  @ZA14267 17058903
         AGO   .YECB1                  PROCESS ECB             @ZA14267 17059303
.*                                                             @ZA14267 17059703
.STRTCB2 ANOP                                                  @ZA14267 17060103
&LEN     SETA  K'&TCB-2                SET &LEN TO LEN/REG NBR @ZA14267 17060503
&C       SETC  '&TCB'(2,&LEN)          SET &C TO REG NBR       @ZA14267 17060903
&NAME    ST    &C,&MF(2)-8             PUT TCB ADDR IN PARMLST @ZA14267 17061303
.*                                                                      17062603
.YECB1   AIF   ('&ECB'(1,1) EQ '(').STOREC2 ECB PTR IN REG     @ZA14267 17062803
         LA    1,&ECB                  ADDRESS THE ECB         @ZA14267 17062903
         ST    1,&MF(2)-4              SET IN PARM LIST PFX    @ZA14267 17063003
         AGO   .ADLIST2                GO ADDRESS PARMLIST     @ZA14267 17063103
.*                                                                      17063603
.STOREC2 ANOP                                                  @ZA14267 17063803
&LEN     SETA  K'&ECB-2                GET LENGTH              @ZA14267 17064003
&C       SETC  '&ECB'(2,&LEN)          GET REGISTER NAME       @ZA14267 17064203
         ST    &C,&MF(2)-4             SET ECB ADDR IN PREFIX  @ZA14267 17064403
.ADLIST2 LA    1,&MF(2)                ADDRESS THE LIST        @ZA14267 17064603
         AGO   .EXLOOPS                CONTINUE PROCESSING     @ZA14267 17064803
.*                                                                      17065603
.* PARM LIST ADDRESS IS IN REG                                 @ZA14267 17065803
.*                                                                      17066003
.NEGADR2 ANOP                                                  @ZA14267 17066203
&NAME    LA    0,8(0,0)                LENGTH OF PREFIX        @ZA14267 17066903
         AIF   (K'&MF(2) EQ 3 AND '&MF(2)'(2,1) EQ '1').INREG2 @ZA14267 17067603
.*                                     CHECK IF PARM LIST ADDR @ZA14267 17068303
.*                                     IS IN REG 1             @ZA14267 17069003
&LEN     SETA  K'&MF(2)-2              IF NOT IN REG1, GET REG @ZA14267 17069703
&C       SETC  '&MF(2)'(2,&LEN)        AND PUT CONTENTS IN R1  @ZA14267 17070403
         LR    1,&C                    SET PARM LIST IN REG 1  @ZA14267 17071103
.*                                                                      17072903
.INREG2  SR    1,0                     ADDRESS THE PREFIX      @ZA14267 17073403
.*                                                                      17073803
         AIF   ('&TCB'(1,1) EQ '(').TCBINR2 PTR TO TCB IN REG  @ZA14267 17074303
         L     0,&TCB                  PICK UP TCB ADDRESS     @ZA14267 17075203
         ST    0,0(0,1)                SET ITS ADDR IN PREFIX  @ZA14267 17076103
         AGO   .YECB2                  GO SET ECB PTR          @ZA14267 17077003
.*                                                                      17078803
.TCBINR2 ANOP                          PTR TO TCB IS IN REG    @ZA14267 17079703
&LEN     SETA  K'&TCB-2                GET LENGTH              @ZA14267 17082703
&C       SETC  '&TCB'(2,&LEN)          GET REGISTER NAME       @ZA14267 17085703
         ST    &C,0(0,1)               SET TCB IN PARM PREFIX  @ZA14267 17088703
.*                                                                      17096803
.YECB2   ANOP                                                  @ZA14267 17097703
         AIF   ('&ECB'(1,1) EQ '(').STREG2 PTR TO ECB IN REG   @ZA14267 17100703
         LA    0,&ECB                  ADDRESS THE ECB         @ZA14267 17103703
         ST    0,4(0,1)                SET ADDR IN PARM PREFIX @ZA14267 17106703
         AGO   .EXLOOP1                GO ADDRESS PARM LIST    @ZA14267 17109703
.*                                                                      17118003
.STREG2  ANOP                                                  @ZA14267 17119003
&LEN     SETA  K'&ECB-2                GET LENGTH              @ZA14267 17120003
&C       SETC  '&ECB'(2,&LEN)          GET REGISTER NUMBER     @ZA14267 17121003
         ST    &C,4(0,1)               SET ECB IN PARM PREFIX  @ZA14267 17122003
.*                                                                      17128003
.EXLOOP1 LA    1,8(0,1)                ADDRESS PARM LIST BODY  @ZA14267 17130003
         AGO   .EXLOOPS                SKIP  IHBINNRA          @ZA14267 17131003
.*                                                                      17133003
.INNRA   ANOP                                                           17200002
&NAME    IHBINNRA &MF(2)                                                17250002
.*                                                               X02113 17300003
.EXLOOPS ANOP                                                           17310003
&QN      SETA  1                                                        17350002
&LIST    SETA  0                                                        17400002
&BB(1)   SETB  ('&SMC' EQ '')                                           17450002
&BB(2)   SETB  ('&RET' EQ '')                                           17500002
&BB(5)   SETB  ('&UCB' EQ '')                                      SDS1 17550002
         AIF   ('&P' NE '').LLOOP                                       17600002
         AIF   (&BB(1) AND &BB(2) AND &BB(5) AND NOT &BA(1)).ENQ060     17650002
&BB(3)   SETB  1                                                        17700002
&BB(4)   SETB  1                                                        17750002
         AIF   (&BB(5)).ENQ065                                     SDS1 17800002
&BB(4)   SETB  0                                                   SDS1 17850002
&B(4)    SETB  1                                                   SDS1 17900002
.ENQ065  ANOP                                                      SDS1 17950002
&LIST    SETA  &LIST+2                                                  18000002
         AGO   .ENQ080                                             SDS1 18050002
.LLOOP   AIF   (&QN GT &NUMBER).ENQ110                        BH A33990 18100002
&RN      SETA  &QN+1                                                    18150002
&ES      SETA  &RN+&NQ                                                  18200002
&RL      SETA  &ES+1                                                    18250002
&SS      SETA  &RL+1                                                    18300002
         AIF   (&IHBDEQ).SHR                                            18350002
&BB(3)   SETB  ('&P(&ES)' EQ '')                                        18400002
.SHR     ANOP                                                           18450002
&BB(4)   SETB  ('&P(&SS)' EQ '')                                        18500002
.NOGEN3  ANOP                                                    X02113 18700002
&LIST    SETA  &LIST+1                                                  18750002
         AIF   ('&P(&RL)' EQ '').ECODES                                 18800002
         AIF   ('&P(&RL)'(1,1) EQ '(').EREGL                            18850002
         MVI   &LIST.(1),&P(&RL)         MOVE RNAME LENGTH TO LIST      18900003
         AGO   .ECODES                                                  18950002
.EREGL   ANOP                                                           19000002
&LEN     SETA  K'&P(&RL)-2                                              19050002
&C       SETC  '&P(&RL)'(2,&LEN)                                        19100002
         STC   &C,&LIST.(0,1)                                           19150002
.ECODES  ANOP                                                           19200002
&LIST    SETA  &LIST+1                                                  19250002
         AIF   (&BB(1) AND &BB(2) AND &BB(5) AND (&BB(3) OR &IHBDEQ) ANX19300002
               D &BB(4) AND NOT &BA(1)).ENQ090                   YM2888 19350002
         AIF   (&IHBDEQ).SHRD                                           19400002
&B(8)    SETB  ('&P(&ES)' EQ 'S')                                       19450002
         AIF   (NOT &B(8) AND NOT &BB(3) AND NOT '&P(&ES)' EQ 'E').ERR9 19500002
.SHRD    ANOP                                                           19550002
&BB(4)   SETB  0                                                   SDS1 19600002
&BB(5)   SETB  0                                                   SDS1 19650002
         AIF   (&IHBRES).ENQ070                                    SDS1 19700003
         AIF   ('&UCB' NE '').ENQ070                           @ZA37604 19710003
&B(1)    SETB  ('&P(&SS)' EQ 'SYSTEMS')                      SDS1       19800002
&B(4)    SETB  ('&P(&SS)' EQ 'SYSTEMS')                      SDS1       19850002
         AIF   (&B(1)).ENQ080                                      SDS1 19900002
&B(1)    SETB  ('&P(&SS)' EQ 'SYSTEM')                       SDS1       19950002
         AIF   (&B(1)).ENQ080                                 BH A33990 20000002
         AIF   ('&P(&SS)' EQ 'STEP').ENQ080                    @ZA53727 20050003
         AIF   ('&P(&SS)' EQ '' AND ('&MF' EQ 'L')).ENQ080    BH A33990 20100002
&BB(4)   SETB  1                                              BH A33990 20150002
&BB(5)   SETB  1                                              BH A33990 20200002
.*                                                            BH A33990 20250002
         AIF   ('&P(&SS)' EQ '' AND ('&MF(1)' EQ 'E')).ENQ080 BH A33990 20300002
         AGO   .ERR10                                         BH A33990 20350002
.ENQ070  ANOP                                                      SDS1 20400002
&B(4)    SETB  1                                                   SDS1 20450002
.ENQ080  ANOP                                                      SDS1 20500002
&BA(2)   SETB  ('&GENERIC' EQ 'YES')                                    20505002
         AIF   ('&TCB' NE '' OR '&GENERIC' EQ 'YES').ENQ083             20510002
         AGO   .ENQ085                                                  20515002
.ENQ083  ANOP                                                           20520002
&LISTA   SETA  &LIST-2                                                  20525002
         NI    &LISTA.(1),191            TURN OFF OPTIONS               20530003
&MASK    SETA  2*&BA(2)+&BA(1)                                          20535002
         OI    &LISTA.(1),&MASK          TURN ON OPTIONS                20537503
.ENQ085  ANOP                            GENERATE THE NI AND OI@ZA53727 20540003
.*                                       TO UPDATE THE FLAG    @ZA53727 20542503
.*                                       BYTE IN THE RESOURCE  @ZA53727 20545003
.*                                       ELEMENTS SPECIFIED.   @ZA53727 20547503
&MASK    SETA  128*&BB(3)+64*&BB(4)+48*&BB(1)+8*&BB(5)+7*&BB(2)    SDS1 20550002
         AIF   (&MASK EQ 255).ENQ090                               SDS1 20570002
         LR    14,1                      PRESERVE REG 1        @ZA00466 20580003
         NI    &LIST.(14),&MASK          SET OPTIONS SPECIFIED @ZA00466 20610003
&MASK    SETA  128*&B(8)+64*&B(1)+32*&B(2)+16*&B(3)+8*&B(4)+4*&B(5)+2*&X20620003
               B(6)+&B(7)                                          SDS1 20630003
         AIF   (&MASK EQ 0).ENQNOOI      GENERATE LOOP BUT NOT @ZA26497 20640003
.*                                       OI IF RET=NONE        @ZA26497 20650003
         OI    &LIST.(14),&MASK          FOR THIS ELEMENT      @ZA00466 20660003
         AIF   ('&UCB' NE '').ENQ090     NO LOOP IF RESERVE    @ZA26012 20680003
         AIF   ('&MF(1)' NE 'E').ENQ090  IS IT EXEC FORM       @ZA00466 20808004
         AIF   (&QN GT 1).ENQ090         BRANCH AROUND BUILDING@ZA53727 20810003
.*                                       CODE FOR LOOP IF NOT  @ZA53727 20812003
.*                                       FIRST TIME THROUGH    @ZA53727 20814003
.*                                                             @ZA53727 20814103
.*                                       IT IS NECESSARY       @ZA53727 20814203
.*                                       GENERATE THE FOLLOWING@ZA53727 20814303
.*                                       LOOP BECAUSE ALL      @ZA53727 20814403
.*                                       RESOURCE ELEMENTS IN  @ZA53727 20814503
.*                                       THE PARM LIST MAY NOT @ZA53727 20814603
.*                                       BE SPECIFIED IN THE   @ZA53727 20814703
.*                                       EXECUTE FORM. IF RET  @ZA53727 20814803
.*                                       OR SMC PARAMETERS WERE@ZA53727 20814903
.*                                       SPECIFIED, THE FLAG   @ZA53727 20815003
.*                                       BYTE IN EACH ELEMENT  @ZA53727 20815103
.*                                       IN THE PARMLIST MUST  @ZA53727 20815203
.*                                       BE UPDATED.           @ZA53727 20815303
.*                                                             @ZA53727 20815403
         TM    0(14),128                 IS IT END OF LIST     @ZA00466 20816004
         BO    *+20                      YES, GET OUT OF LOOP  @ZA53727 20820003
         LA    14,12(14)                 INDEX TO NEXT ENTRY   @ZA00466 20824004
&MASK    SETA  128+64+48*&BB(1)+8+7*&BB(2)                     @ZA53727 20825603
         NI    &LIST.(14),&MASK          SET RET AND SMC IN ALL@ZA53727 20827203
&MASK    SETA  32*&B(2)+16*&B(3)+4*&B(5)+2*&B(6)+&B(7)         @ZA53727 20828803
         OI    &LIST.(14),&MASK          ELEMENTS IN LIST.     @ZA53727 20830403
         B     *-20                      STAY IN LOOP          @ZA53727 20832003
         AGO   .ENQ090                   CONTINUE MAINLINE     @ZA26497 20834003
.ENQNOOI ANOP                                                  @ZA26497 20836003
         AIF   ('&UCB' NE '').ENQ090     NO LOOP IF RESERVE    @ZA26012 20838003
         AIF   ('&MF(1)' NE 'E').ENQ090  IS IT EXEC FORM       @ZA26497 20840003
         AIF   (&QN GT 1).ENQ090         NOT FIRST TIME THROUGH@ZA53727 20841003
         TM    0(14),128                 IS IT END OF LIST     @ZA26497 20842003
         BO    *+16                      YES, GET OUT OF LOOP  @ZA53727 20843003
         LA    14,12(14)                 INDEX TO NEXT ENTRY   @ZA26497 20844003
&MASK    SETA  128+64+48*&BB(1)+8+7*&BB(2)                     @ZA53727 20845503
         NI    &LIST.(14),&MASK          SET RET AND SMC       @ZA53727 20847003
         B     *-16                      STAY IN LOOP          @ZA53727 20848503
.ENQ090  AIF   ('&P' EQ '').ENQ100                             SDS1     20850002
&LIST    SETA  &LIST+2                                                  20900002
         AIF   ('&P(&QN)' EQ '').ERN                                    20950002
         AIF   ('&P(&QN)'(1,1) EQ '(').EQNREG                           21000002
         LA    14,&P(&QN)                GET QNAME ADDRESS              21050003
         ST    14,&LIST.(0,1)            STORE QNAME ADDRESS            21100003
         AGO   .ERN                                                     21150002
.EQNREG  ANOP                                                           21200002
&LEN     SETA  K'&P(&QN)-2                                              21250002
&C       SETC  '&P(&QN)'(2,&LEN)                                        21300002
         ST    &C,&LIST.(0,1)            STORE QNAME ADDRESS            21350003
.ERN     ANOP                                                           21400002
&LIST    SETA  &LIST+4                                                  21450002
         AIF   ('&P(&RN)' EQ '').EEND                                   21500002
         AIF   ('&GENERIC' EQ 'NO').NOGEN4                       X02113 21550002
         IHBERMAC 1016,RNAME,GENERIC                             X02113 21600002
         AGO   .EEND                                             X02113 21650002
.NOGEN4  ANOP                                                    X02113 21700002
         AIF   ('&P(&RN)'(1,1) EQ '(').ERNREG                           21750002
         LA    14,&P(&RN)                GET RNAME ADDRESS              21800003
         ST    14,&LIST.(0,1)            STORE RNAME ADDRESS            21850003
         AGO   .EEND                                                    21900002
.ERNREG  ANOP                                                           21950002
&LEN     SETA  K'&P(&RN)-2                                              22000002
&C       SETC  '&P(&RN)'(2,&LEN)                                        22050002
         ST    &C,&LIST.(0,1)            STORE RNAME ADDRESS            22100003
.EEND    ANOP                                                           22150002
&LIST    SETA  &LIST+4                                                  22200002
&QN      SETA  &QN+4+&NQ                                                22250002
         AGO   .LLOOP                                                   22300002
.ENQ100  ANOP                                                      SDS1 22350002
&LIST    SETA  12                                                  SDS1 22400002
.ENQ110  AIF   ('&UCB' EQ '').ENQ060                               SDS1 22450002
         AIF   ('&UCB'(1,1) EQ '(').ENQ120                         SDS1 22500002
         LA    14,&UCB            GET UCB PARAMETER                SDS1 22550002
         ST    14,&LIST.(0,1)     STORE UCB PARAMETER              SDS1 22600002
         AGO   .ENQ060                                             SDS1 22650002
.ENQ120  ANOP                                                      SDS1 22700002
&LEN     SETA  K'&UCB-2                                            SDS1 22750002
&C       SETC  '&UCB'(2,&LEN)                                      SDS1 22800002
         ST    &C,&LIST.(0,1)     STORE UCB PARAMETER              SDS1 22850002
         AGO   .ENQ060                                             SDS1 22900002
.*                                                                      22950002
.*                                                                      23000002
.* ERROR EXITS                                                          23050002
.*                                                                      23100002
.*                                                                      23150002
.ERR1    IHBERMAC 2                    INVALID FIRST OPERAND            23200002
         AGO   .ERREX                                                   23250002
.ERR2    IHBERMAC  24                  REQ'D OPERANDS NOT SPECIFIED     23300002
         AGO   .ERREX                                                   23350002
.ERR3    IHBERMAC 69                   INVALID REG NOTATION WITH MF=L   23400002
         AGO   .ERREX                                                   23450002
.ERR4    IHBERMAC  35,,&MF             INVALID MF OPERAND SPEC - MF=XXX 23500002
         AGO   .ERREX                                                   23550002
.ERR5    IHBERMAC 157,RET,&RET         INVALID CODE FOR RET - IGNORED   23600002
         AGO   .ERREX                                                   23650002
.ERR6    IHBERMAC 1001,DEQ,,&ECB       INVALID DEQ OP SPEC - ECB=       23700002
         AGO   .ERREX                                                   23750002
.ERR7    IHBERMAC 196                 MORE THAN 5 POSITIONAL OPERANDS   23800002
&IHBRES  SETB  0                                                   SDS1 23850002
         MEXIT                                                          23900002
.ERR8    IHBERMAC 1001,SMC,&SMC       INVALID SMC SPECIFIED    @ZA12435 23920003
         AGO   .ERREX                                                   24000002
.ERR9    IHBERMAC 157,SCOPE,&P(&ES)   INVALID CODE FOR SCOPE-IGNORED    24050002
         AGO   .ERREX                                                   24100002
.ERR10   IHBERMAC 157,SYSTEMS,&P(&SS) INVALID CODE FOR SYSTEMS - IGNORE 24150002
         AGO   .ERREX                                                   24200002
.ERR11   IHBERMAC 1003,RET,SMC       RET AND/OR SMC PARAMETERS INVALID  24250002
         AGO   .ERREX                                            X02113 24300002
.ERR12   IHBERMAC 1020,SMC,TCB         SMC INVALID WITH TCB      X02113 24350002
         AGO   .ERREX                                            X02113 24400002
.ERR13   IHBERMAC 1003,RET,TCB         INVALID RET AND/OR TCB    X02113 24450002
         AGO   .ERREX                                            X02113 24500002
.ERR15   IHBERMAC 1001,TCB,&TCB        INVALID TCB SPECIFIED     X02113 24650002
         AGO   .ERREX                                            X02113 24700002
.ERR16   IHBERMAC 1001,GENERIC,&GENERIC                          X02113 24750002
.*                                     INVALID GENERIC SPECIFIED X02113 24800002
         AGO   .ERREX                                            X02113 24850002
.ERR17   IHBERMAC 1003,RET,GENERIC     RET AND/OR GENERIC INVALIDX02113 24900002
         AGO   .ERREX                                            X02113 24950002
.ERR18   IHBERMAC 1014,GENERIC         GENERIC INVALID ON ENQ OR X02113 25000002
.*                                     RESERVE                   X02113 25050002
.ERREX   ANOP                                                           25100002
&IHBDEQ  SETB  0                                                        25150002
&IHBRES  SETB  0                                                   SDS1 25200002
         MEND                                                           25250002
**/                                                                     25300002
*   ENQ:/*************************************************************/ 25350002
*   /* PL/S VERSION OF ENQ MACRO                                     */ 25400002
*   /*****************************************************************/ 25450002
*      MACRO KEYS(MF,RET,ECB,SMC,TCB,LS,RELATED);                       25500002
*        ANS('?'||MACLABEL||'ENQP '||MACLIST||MACKEYS||';');            25550002
*%END;                                                                  25600002
