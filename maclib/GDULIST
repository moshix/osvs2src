         MACRO                                                          00050000
&NAME    GDULIST  &PARAMNO=,&NORGUID=,&DISPMSG=,&MSG=,&ENTRY=1,&IDENT=  00100000
         GBLA  &IECPARN,&IECNDGP(100),&IECGID                           00150000
.*             IECPARN  PARAMETER LIST NUMBER OF LAST MACRO             00200000
.*             IECGID  NUMBER OF GDU IDENTIFIERS                        00250000
         GBLB  &IECGDL,&IECTXT,&IECSW(9),&IECSEQ(10),&IECSQ(7),&IECGDSW 00300000
.*             IECGDL ON INDICATES NOT FIRST GDULIST MACRO IN THIS TRNS 00350000
.*             IECTXT  ON WHEN IMPLICIT TEXT ALREADY GENERATED          00400000
.*             IECSW(8) SET WHEN MSG TXT APPEARS.INDICATES TO FOLLOWING 00450000
.*                      TRLIST OR STEND MACRO THAT AN END OF LIST BYTE  00500000
.*                      HAS BEEN GENERATED BY THIS MACRO                00550000
         LCLA &A,&B,&C                                                  00600000
         LCLB  &NOCODE,&NORSW(16),&D,&E                                 00650000
.*             &E INDICATES MSG OPERAND IS INVALID                      00700000
.*             &D INDICATES ENTRY=M IS CODED                            00750000
.*             &NORSW(16) USED TO DEFINE 2 BYTES OF NORMAL GUIDANCE     00800000
         LCLC  &CHAR                                                    00850000
         ACTR  1000                                                     00900000
         AIF   (&IECSEQ(1) AND &IECSEQ(2) AND &IECSQ(1) AND &IECSQ(2)  X00950000
               AND &IECSEQ(4) AND NOT &IECSEQ(6)).SEQOK                 01000000
&NOCODE  SETB  1                                                        01050000
         MNOTE 12,'MACRO SEQUENCE ERROR'                                01100000
.SEQOK   ANOP                                                           01150000
         AIF   (&IECGDSW).SEQOK1                                        01200000
&NOCODE  SETB  1                                                        01250000
         MNOTE 12,'GDULIST MACRO CAN NOT BE CODED UNLESS GDU=YES IN    X01300000
               CONFIGUR MACRO'                                          01350000
.SEQOK1  ANOP                                                           01400000
         AIF   (T'&PARAMNO NE 'O').PAR1                                 01450000
&NOCODE  SETB  1                                                        01500000
         MNOTE 12,'PARAMNO OPERAND MUST BE CODED'                       01550000
         AGO   .NOR1                                                    01600000
.PAR1    ANOP                                                           01650000
         AIF   (T'&PARAMNO EQ 'N').PAR2                                 01700000
&NOCODE  SETB  1                                                        01750000
         MNOTE 12,'PARAMNO OPERAND HAS INVALID TYPE ATTRIBUTE'          01800000
         AGO   .NOR1                                                    01850000
.PAR2    ANOP                                                           01900000
         AIF   (&PARAMNO GE 1 AND &PARAMNO LE 127).PAR3                 01950000
&NOCODE  SETB  1                                                        02000000
         MNOTE 12,'PARAMNO OPERAND NOT IN VALID RANGE OF 1 TO 127'      02050000
         AGO   .NOR1                                                    02100000
.PAR3    ANOP                                                           02150000
         AIF   (&PARAMNO LE &IECPARN).NOR1                              02200000
&NOCODE  SETB  1                                                        02250000
         MNOTE 12,'PARAMNO OPERAND CAN NOT BE GREATER THAN HIGHEST     X02300000
               PLN OPERAND IN PARAMNUM MACRO'                           02350000
.NOR1    ANOP                                                           02400000
&C       SETA  N'&NORGUID                                               02450000
         AIF   (T'&NORGUID EQ 'O' AND &C EQ 0).DIS1                     02500000
         AIF   (&C LE 16).NOR2                                          02550000
&NOCODE  SETB  1                                                        02600000
         MNOTE 12,'NUMBER OF SUBOPERANDS IN NORGUID OPERAND INVALID'    02650000
.NOR2    ANOP                                                           02700000
&B       SETA  1                                                        02750000
.NOR3    ANOP                                                           02800000
         AIF   (T'&NORGUID(&B) EQ 'N').NOR4                             02850000
&NOCODE  SETB  1                                                        02900000
         MNOTE 12,'NORGUID SUBOPERAND INVALID'                          02950000
         AGO   .DIS1                                                    03000000
.NOR4    ANOP                                                           03050000
         AIF   (&NORGUID(&B) GE 1 AND &NORGUID(&B) LE 16).NOR5          03100000
&NOCODE  SETB  1                                                        03150000
         MNOTE 12,'NORGUID SUBOPERAND NOT IN VALID RANGE OF 1 TO 16'    03200000
         AGO   .NOR21                                                   03250000
.NOR5    ANOP                                                           03300000
&A       SETA  &NORGUID(&B)                                             03350000
&NORSW(&A) SETB 1                                                       03400000
.NOR21   ANOP                                                           03450000
         AIF   (&B EQ &C).DIS1   IF LAST SUBOPERAND,BRANCH              03500000
&B       SETA  &B+1                                                     03550000
         AGO   .NOR3                                                    03600000
.DIS1    ANOP                                                           03650000
         AIF   (T'&DISPMSG EQ 'O').IDEN1                                03700000
         AIF   (T'&DISPMSG EQ 'M').DIS2                                 03750000
&NOCODE  SETB  1                                                        03800000
         MNOTE 12,'D1SPMSG OPERAND HAS INVALID TYPE ATTRIBUTE'          03850000
.DIS2    ANOP                                                           03900000
         AIF   (T'&DISPMSG NE 'O' AND T'&IDENT NE 'O').DIS3             03950000
         AGO   .IDEN1                                                   04000000
.DIS3    ANOP                                                           04050000
&NOCODE  SETB  1                                                        04100000
         MNOTE 12,'D1SPMSG AND IDENT OPERANDS CAN NOT BOTH BE CODED'    04150000
.IDEN1   ANOP                                                           04200000
         AIF   (T'&IDENT EQ 'O').ENT1                                   04250000
         AIF   (T'&IDENT EQ 'N').IDEN2                                  04300000
&NOCODE  SETB  1                                                        04350000
         MNOTE 12,'IDENT OPERAND HAS INVALID TYPE ATTRIBUTE'            04400000
         AGO   .ENT1                                                    04450000
.IDEN2   ANOP                                                           04500000
         AIF   (&IDENT GE 0 AND &IDENT LE 99).IDEN3                     04550000
&NOCODE  SETB  1                                                        04600000
         MNOTE 12,'IDENT OPERAND NOT IN VALID RANGE OF 0 TO  99'        04650000
         AGO   .ENT1                                                    04700000
.IDEN3   ANOP                                                           04750000
&B       SETA  &IDENT+1                                                 04800000
         AIF   (&IDENT LE &IECGID).ENT1                                 04850000
&NOCODE  SETB  1                                                        04900000
         MNOTE 12,'IDENT OPERAND SPECIFIED IS GREATER THAN NUMBER OF   X04950000
               IDENTIFIERS SPECIFIED BY USER'                           05000000
.ENT1    ANOP                                                           05050000
         AIF   ('&ENTRY' EQ '1' OR '&ENTRY' EQ 'M').ENT2                05100000
         MNOTE 3,'ENTRY OPERAND INVALID,DEFAULT ASSUMED'                05150000
.ENT2    ANOP                                                           05200000
&D       SETB  ('&ENTRY' EQ 'M')                                        05250000
         AIF   ('&ENTRY' EQ 'M' AND &IECGDL OR '&ENTRY' EQ '1').MSG1    05300000
&D       SETB  0                                                        05350000
         MNOTE 3,'ENTRY=M ILLEGAL ON FIRST GDULIST MACRO,DEFAULT ASSUMEX05400000
               D'                                                       05450000
.MSG1    ANOP                                                           05500000
         AIF   (T'&MSG EQ 'O').CKGEN                                    05550000
         AIF   (T'&MSG NE 'O' AND &IECTXT).MSG2                         05600000
&E       SETB  1                                                        05650000
         AGO   .CKGEN                                                   05700000
.MSG2    AIF   ('&MSG'(1,1) EQ '''' AND '&MSG'(K'&MSG,1) EQ '''').MSG3  05750000
         MNOT3 3,'MSG OPERAND IN INCORRECT FORMAT,OPERAND IGNORED'      05800000
&E       SETB  1                                                        05850000
         AGO   .CKGEN                                                   05900000
.MSG3    ANOP                                                           05950000
&B       SETA  K'&MSG-2                                                 06000000
         AIF   (&B GE 0 AND &B LE 127).CKGEN                            06050000
         MNOTE 3,'MESSAGE LENGTH EXCEEDS 127,OPERAND IGNORED'           06100000
&E       SETB  1                                                        06150000
.CKGEN   ANOP                                                           06200000
         AIF   (NOT &IECSW(8)).CKGEN1                                   06250000
&NOCODE  SETB  1                                                        06300000
         MNOTE 12,'GDULIST MACRO NOT VALID FOLLOWING IMPLICIT TEXT IN  X06350000
               THIS TRANSACTION'                                        06400000
.CKGEN1  ANOP                                                           06450000
         AIF   (NOT &NOCODE).GENCODE                                    06500000
         MNOTE 12,'TEXT GENERATION SUPPRESSED'                          06550000
         AGO   .MEND                                                    06600000
.GENCODE ANOP                                                           06650000
         DC    YL1(X'80'*&D+&PARAMNO) PARAM LIST NUMBER + REPEAT REC    06700000
         DC      B'&NORSW(1)&NORSW(2)&NORSW(3)&NORSW(4)&NORSW(5)&NORSW(X06750000
               6)&NORSW(7)&NORSW(8)'  FIRST BYTE OF NORMAL GUIDANCE     06800000
         DC    B'&NORSW(9)&NORSW(10)&NORSW(11)&NORSW(12)&NORSW(13)&NORSX06850000
               W(14)&NORSW(15)&NORSW(16)' SECOND BYTE OF NORMAL GUID    06900000
         AIF   (T'&DISPMSG EQ 'O').GEN1                                 06950000
&CHAR    SETC  '&DISPMSG'                                               07000000
         DC    AL2(&CHAR-IEC15TAB)                                      07050000
         AGO   .MSG5                                                    07100000
.GEN1    AIF   (T'&IDENT EQ 'O').GEN2                                   07150000
         DC    YL2((IECIDENT-IEC15TAB)+14*&IDENT)                       07200000
         AGO   .MSG5                                                    07250000
.GEN2    DC    YL2(0)                                                   07300000
.MSG5    ANOP                                                           07350000
&B       SETA  0                                                        07400000
         AIF   (T'&MSG EQ 'O' OR &E).SET                                07450000
&IECSW(8) SETB 1                                                        07500000
         DC    YL1(0)    END OF LIST BYTE                               07550000
&B       SETA  K'&MSG-2                                                 07600000
         DC    YL1(&B)   LENGTH OF MSG TEXT                             07650000
         DC    C&MSG                                                    07700000
&B       SETA  &B+1                                                     07750000
&IECTXT  SETB  0  RESET TO PREVENT GDULIST EXPANSION FOLLOWING MSG TEXT 07800000
.SET     ANOP                                                           07850000
&IECGDL  SETB  1                                                        07900000
&IECNDGP(1) SETA &IECNDGP(1)+5+&B                                       07950000
.MEND    MEND                                                           08000000
