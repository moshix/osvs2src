         MACRO                                                          00050001
         IDACB2 &CALLER=GEN,&BLKTYPE=,&MF=,   *** INTERNAL KEYWORDS ***C00100001
               &LABEL=,                                                C00150001
               &AM=,                                            X04SVHSC00200001
               &ACBLEN=,&ATRB=,&AVSPAC=,&BUFND=,   *** ACB KEYWORDS ***C00250001
               &BUFNI=,&BUFNO=,&BUFSP=,&CINV=,&DDNAME=,&ENDRBA=,       C00300001
               &ERROR=,&EXLST=,&FS=,&KEYLEN=,&LRECL=,&JFCB=,   @XM01140C00350001
               &MACRF=,&NCIS=,&NDELR=,&NEXCP=,&NEXT=,&NINSR=,&NIXL=,   C00400001
               &NLOGR=,&NRETR=,&NSSS=,&NUPDR=,&OFLAGS=,&PASSWD=,&RKP=, C00450001
               &BSTRNO=,&CRA=,&OPENOBJ=,&AIXRKP=,               X04SVHSC00500001
               &MAREA=,&MLEN=,                                  X04SVHSC00550001
               &STRNO=,&STMST=,&CATALOG=,&APPLID=,               X03004C00600001
               &NSEXIT=,                                       @G40AKCM*00605040
               &USERPTR=,                                      @XM01129C00610001
               &EODAD=,&JRNAD=,                  *** EXLST KEYWORDS ***C00650001
               &LERAD=,&SYNAD=,&EXLLEN=,&LOGON=,&LOSTERM=,       X03004C00700001
               &RELREQ=,&ATTN=,&TPEND=,                        @Z40BHUC*00750001
               &SCIP=,&DFASY=,&RESP=,                          @Z40BHUC*00800001
               &ACB=,&AREA=,&AREALEN=,&ARG=,&ECB=, *** RPL KEYWORDS ***C00850001
               &FDBK=,&MSGAREA=,&MSGLEN=,&NXTRPL=,&OPTCD=,             C00900001
               &RBA=,&RECLEN=,&IO=,&RPLLEN=,&AAREA=,&AAREALN=,   X03004C00950001
               &ARECLEN=,&EXIT=,&NIB=,                          X04SVHSC01000001
               &BRANCH=,&USER=,&RTNCD=,&FDBK2=,&SENSE=,          X03004C01050001
               &REQ=,&DATAFLG=,                                  X03004C01100001
               &TRANSID=,&AIXPC=,&FTNCD=,&AIXFLAG=,             X04SVHSC01150001
               &CHNGDIR=,&STYPE=,&RTYPE=,&CHAIN=,&POST=,        X3004BSC01200001
               &RESPOND=,&CONTROL=,&OBSQAC=,&IBSQAC=,           X3004BSC01250001
               &OBSQVAL=,&IBSQVAL=,&SEQNO=,&SSENSEO=,           X3004BSC01300001
               &SSENSEI=,&USENSEO=,&USENSEI=,                  @Z40BHUCC01350001
               &BRACKET=,&SSENSMO=,&SSENSMI=,&SIGDATA=,        X03004HSC01400001
               &NAME=,&USERFLD=,&MODE=,      *** NIB KEYWORDS ***X03004C01450001
               &LISTEND=,&CONDN=,&PROC=,&NIBLEN=,                X03004C01500001
               &CID=,&DEVCHAR=,&CON=,&RESPLIM=,&SDT=,           X3004BSC01550001
               &LOGMODE=,&BNDAREA=,&CODESEL=,                  @Z40BHUC*01600040
               &CRYPT=,&ENCR=                                  @G40AKSL 01620040
.* FUNCTION - 1. VALIDITY CHECK AND TRANSFORM ALL CONTROL BLOCK         01650001
.*               KEYWORDS                                               01700001
.*            2. GENERATE THE CODE REQUIRED TO BUILD AND DYNAMICALLY    01750001
.*               MODIFY THE PARAMETER LIST AND ARGUMENT CONTROL ENTRIES 01800001
.*            3. GENERATE THE CODE FOR LINKAGE TO THE CONTROL BLOCK     01850001
.*               MANIPULATION ROUTINE                                   01900001
.* INNER MACROS - IDACB1,IDAERMAC                                       01950001
.* CALLERS - GENCB,MODCB,SHOWCB,TESTCB                                  02000001
.* CHANGE ACTIVITY                                                      02010001
.*   A64988,C79600,79800,D85000-85200                          XM07073  02020001
.*   MOVED 57020-57420 AFTER 59500, A115500,440100-442858     @ZA07565  02030001
.*   A443066                                                  @ZA07565  02036001
.*   D078920,C443597-444347                                   @ZA10861  02042001
.*   C(444397,444715-444719)                                  @ZA25133  02046140
.*   C(057300)                                                @ZA33610  02048001
.* GLOBALS                                                              02050001
         GBLB  &IDACB01                ERROR INDICATOR                  02100001
         GBLA  &IDACB02                NUMBER OF FIELDS IN HEADER ACE   02150001
         GBLA  &IDACB03                LENGTH OF HEADER ACE             02200001
         GBLA  &IDACB04(5)             HEADER TYPE ARRAY                02250001
         GBLC  &IDACB05(5)             HEADER VALUE ARRAY               02300001
         GBLA  &IDACB06(5)             HEADER OFFSET ARRAY              02350001
         GBLA  &IDACB07(5)             HEADER FIELD LENGTH ARRAY        02400001
         GBLA  &IDACB09                NUMBER OF SHOWCB ELEMENTS        02450001
         GBLA  &IDACB10(50)            SHOWCB ELEMENT ID ARRAY          02500001
         GBLA  &IDACB11                VALUE TYPE-SET BY IDACB1         02550001
         GBLC  &IDACB12                EXIT LIST CODES-SET BY IDACB1    02600001
         GBLC  &IDACB13                OPERAND VALUE - SET BY IDACB1    02650001
         GBLB  &IDABUG                 DEBUG SWITCH                     02700001
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               02750001
         GBLA  &IDAETYP(50)            ELEMENT TYPE ARRAY               02800001
         GBLA  &IDAEID(50)             ELEMENT ID ARRAY                 02850001
         GBLA  &IDAELEN(50)            ELEMENT FIELD LENGTH ARRAY       02900001
         GBLC  &IDAVALX(50)            ELEMENT ARITHMETIC VALUE ARRAY   03000001
         GBLC  &IDAVALC(50)            ELEMENT CHARACTER VALUE ARRAY    03050001
         GBLC  &IDAOPT2,&IDAOPT3       OPTCD BIT STRING EXTENSION       03060001
         GBLC  &IDAPRC2                PROC BIT STRING EXTENSION        03070001
.* LOCALS                                                               03100001
         GBLA  &EOFF(50)               ELEMENT OFFSET ARRAY             03110001
         LCLA  &ACBID,&EXLID,&RPLID    BLOCK TYPE CODES                 03150001
         LCLA  &NIBID                  BLOCK TYPE CODES          X03004 03200001
         LCLA  &VN1,&VN2,&VN3,&AN1,&AN2,&AN3,&AN4 OPERAND TYPE CODES    03250001
         LCLA  &I,&J,&WORKA            WORK VARIABLES           X04SVHS 03300001
         LCLA  &BTC                    BLOCK TYPE CODE                  03350001
         LCLA  &FTC                    FUNCTION TYPE CODE               03400001
         LCLB  &RMF                    REENTRANT MACRO FORM SWITCH      03450001
         LCLA  &PLLEN                  PARAMETER LIST LENGTH            03500001
         LCLC  &PLLBL,&LNKLBL,&ERRLBL  GENERATED LABELS                 03550001
         LCLC  &PLADR                  REMOTE PARAMETER LIST ADDRESS    03600001
         LCLC  &H                      USED TO FORM STH OP CODE         03650001
         LCLC  &WORKC                  WORK VARIABLE                    03700001
         LCLC  &BLK                    BLOCK TYPE CODE                  03750001
         LCLC  &Z16                     WORK CONSTANT           X04SVHS 03760001
.* INITIALIZATION ***************************************************** 03800001
&ACBID   SETA  X'0A0'                  ACB BLOCK TYPE CODE              03850001
&EXLID   SETA  X'0B0'                  EXLST BLOCK TYPE CODE            03900001
&RPLID   SETA  X'0C0'                  RPL BLOCK TYPE CODE              03950001
&NIBID   SETA  X'0D0'                  NIB BLOCK TYPE CODE       X03004 04000001
&VN1     SETA  1                       SELF-DEFINING TERM < 4096        04050001
&VN2     SETA  2                       BIT CODE SUBLIST                 04100001
&VN3     SETA  3                       CHARACTER STRING                 04150001
&AN1     SETA  4                       REGISTER SPECIFICATION           04200001
&AN2     SETA  5                       S-ADCON EXPRESSION               04250001
&AN3     SETA  6                       INDIRECT ADDRESS                 04300001
&AN4     SETA  7                       A-ADCON EXPRESSION               04350001
&PLLBL   SETC  'IDA'.'&SYSNDX'.'A'                                      04400001
&ERRLBL  SETC  'IDA'.'&SYSNDX'.'A'                                      04450001
.*                                                                      04460001
&Z16     SETC  '0000000000000000'       INITIALIZE TO 16 ZEROES X04SVHS 04470001
.*             INITIALIZE GLOBAL ARRAYS TO ZERO                         04472001
&IDAENO  SETA  0                        INIT NUMBER OF ELEMENTS X04SVHS 04480001
.I000050 ANOP                                                   X04SVHS 04492001
&I       SETA  &I+1                     BUMP INDEX              X04SVHS 04494001
         AIF   (&I GT 50).I000075       ARE ALL ELEMENTS INIT   X04SVHS 04494401
&IDAETYP(&I) SETA 0                     INIT TYPE ELEMENT       X04SVHS 04496001
&IDAEID(&I) SETA 0                      INIT ID ELEMENT         X04SVHS 04498001
&IDAELEN(&I) SETA 0                     INIT LENGTH ELEMENT     X04SVHS 04498401
&IDAVALX(&I) SETC '&Z16&Z16'            INIT EXLST CODE ELEMENT X04SVHS 04498801
&IDAVALC(&I) SETC '&Z16&Z16'            INIT VALUE ELEMENT      X04SVHS 04499201
         AGO   .I000050                 POINT TO NEXT ELEMENT   X04SVHS 04499601
.********************************************************************** 04512201
.I000075 ANOP                                                   X04SVHS 04524801
         AIF   ('&MF' EQ '' OR '&MF(1)' EQ 'L' OR '&MF(1)' EQ 'E' OR   C04537401
               '&MF(1)' EQ 'G').I000100 VALIDITY CHECK MF               04550001
         IDAERMAC 3,MF,&MF                                              04600001
&IDACB01 SETB  1                                                        04650001
.I000100 ANOP                                                           04700001
.* SET REENTRANT FORM OF MACRO SWITCH                                   04750001
&RMF     SETB  ('&MF(1)' EQ 'G' OR ('&MF(1)' EQ 'L' AND N'&MF GT 1))    04800001
.********************************************************************** 04810001
.* SET FUNCTION TYPE CODE                                               04850001
&FTC     SETA  1                                                        04900001
         AIF   ('&CALLER' EQ 'GEN').I000200  TEST FOR GENCB             04950001
&FTC     SETA  2                                                        05000001
         AIF   ('&CALLER' EQ 'MOD').I000200  TEST FOR MODCB             05050001
&FTC     SETA  3                                                        05100001
         AIF   ('&CALLER' EQ 'SHOW').I000200 TEST FOR SHOWCB            05150001
&FTC     SETA  4                             ASSUME TESTCB              05200001
.I000200 AIF   ('&AM' NE 'VTAM').I000300                                05250001
&FTC     SETA  &FTC+16                                                  05260001
.********************************************************************** 05310001
.*             PROCESS SHOWCB                                           05320001
.********************************************************************** 05330001
.I000300 AIF   ('&CALLER' NE 'SHOW').I000900                            05350001
         AIF   ('&BLKTYPE' NE 'ACB').I000400                            05400001
&BTC     SETA  &ACBID                                                   05450001
         AGO   .I000700                                                 05500001
.I000400 AIF   ('&BLKTYPE' NE 'EXLST').I000500                          05550001
&BTC     SETA  &EXLID                                                   05600001
         AGO   .I000700                                                 05650001
.I000500 AIF   ('&BLKTYPE' NE 'RPL').I000600                            05700001
&BTC     SETA  &RPLID                                                   05700301
         AGO   .I000700                                                 05700601
.I000600 AIF   ('&BLKTYPE' NE 'NIB').I000700                            05700901
&BTC     SETA  &NIBID                                            X03004 05701201
.I000700 ANOP                                                           05701501
.*************************************************             @ZA07565 05702001
.* LOOK FOR REGISTER FORM                        *             @Z40BHCJ 05704001
.*************************************************             @Z40BHCJ 05706001
         AIF   (&IDACB09 NE 1).I000710                         @Z40BHCJ 05710001
         AIF   (&IDACB10(1) NE X'35').I000710                  @Z40BHCJ 05720001
         AIF   ('&IDACB05(4)' LT '4').I000710                  @ZA33610 05730040
         AIF   (&IDACB04(3) EQ &AN1 AND '&IDACB05(3)' EQ '1').I000710   05732001
         AIF   ('&MF(1)' EQ '').I022700                        @Z40BHCJ 05740001
.I000710 ANOP                                                  @ZA07565 05742001
&IDAENO  SETA  &IDACB09                 SET NO. OF FIELDS TO BE SHOWN   06000001
&I       SETA  0                       BYPASS VALIDITY CHECKS AND ...   06050001
.I000800 ANOP                             TRANSFORMATIONS FOR SHOWCB    06100001
&I       SETA  &I+1                                                     06150001
         AIF   (&I GT &IDAENO).I013500 HAVE ALL ELEMENTS BEEN PROCESSED 06200001
&IDAEID(&I) SETA  &IDACB10(&I)         SET ELEMENT ID ARRAY             06250001
         AGO   .I000800                CHECK NEXT ELEMENT               06300001
.********************************************************************** 06310001
.*       CHECK BLKTYPE                                                  06320001
.********************************************************************** 06330001
.I000900 AIF   ('&BLKTYPE' EQ 'ACB').I001400 CHECK FOR ACB              06350001
         AIF   ('&BLKTYPE' EQ 'RPL').I001100 CHECK FOR RPL              06400001
         AIF   ('&BLKTYPE' EQ 'NIB').I001300 CHECK FOR NIB              06450001
.*             'BLKTYPE' IS EITHER NULL OR 'EXLST'. IF NULL, IDACB2 HAS 06460001
.*             BEEN CALLED BY THE EXECUTE FORM OF GENCB, MODCB, OR      06470001
.*             TESTCB, AND TO DETERMINE WHAT TYPE CONTROL BLOCK WILL BE 06480001
.*             AFFECTED, EACH INNER MACRO (IDACBRPL, IDACBEXL, IDACBACB 06490001
.*             IDACBNIB) IS CALLED UNTIL A VALID KEYWORD (OTHER THAN    06492001
.*             AM) IS FOUND. IF NO VALID KEYWORD IS FOUND, AN ERROR     06494001
.*             MESSAGE IS ISSUED BECAUSE IT IS IMPOSSIBLE TO DETERMINE  06496001
.*             WHAT TYPE CONTROL BLOCK THE USER WANTS.                  06498001
.*             IF BLOCK IS A NIB AND EXLST IS THE ONLY         @XA07799 06498401
.*             PARAMETER ON A GENCB, BLK=NIB IS REQUIRED.      @XA07799 06498501
.*             WHEN USING MODCB OR TESTCB, NIB OR ACB MUST BE  @XA07799 06498601
.*             USED IF EXLST IS A PARAMETER AND NOT A BLKTYPE. @XA07799 06498701
.*                                                                      06498801
.********************************************************************** 06499501
.*             EXLST                                                    06499901
.********************************************************************** 06516601
         IDACBEXL AM=&AM,MF=&MF,CALLER=&CALLER,EODAD=&EODAD,           *06533301
               JRNAD=&JRNAD,LERAD=&LERAD,SYNAD=&SYNAD,EXLLEN=&EXLLEN,  *06550001
               LOGON=&LOGON,LOSTERM=&LOSTERM,RELREQ=&RELREQ,           *06600001
               NSEXIT=&NSEXIT,                                 @G40AKCM*06620040
               ATTN=&ATTN,TPEND=&TPEND,                        @Z40BHUC*06650001
               SCIP=&SCIP,DFASY=&DFASY,RESP=&RESP              @Z40BHUC 06700001
         AIF   (&IDAENO EQ 1 AND '&AM' NE '' AND                       *06750001
               '&BLKTYPE' NE 'EXLST' AND '&CALLER' EQ 'GEN').I001000    06800001
.*                                                              X04SVHS 06802001
.*             IF THE ABOVE CONDITIONS ARE MET, NO VALID EXLST KEYWORD  06802401
.*             EXCEPT AM WAS FOUND AND IT IS ASSUMED THAT AN EXLST      06802801
.*             IS NOT TO BE GENERATED.                                  06803201
         AIF   (&IDAENO EQ 0 AND '&BLKTYPE' NE 'EXLST').I001100 X04SVHS 06804001
.*             IF BLKTYPE ISN'T EQUAL TO EXLST AND ELEMENT COUNT        06806001
.*             IS ZERO, TRY RPL.                                        06806401
&BTC     SETA  &EXLID                   INDICATE EXLST          X04SVHS 06808001
         AGO   .I001500                                                 06810001
.I001000 ANOP                                                   X04SVHS 06850001
&IDAENO  SETA  0                                                X04SVHS 06900001
.I001100 ANOP                                                           07000001
.********************************************************************** 07010001
.*             RPL                                                      07020001
.********************************************************************** 07030001
         IDACBRPL AM=&AM,MF=&MF,CALLER=&CALLER,ACB=&ACB,AREA=&AREA,    *07050001
               AREALEN=&AREALEN,ARG=&ARG,ECB=&ECB,FDBK=&FDBK,          *07100001
               MSGAREA=&MSGAREA,MSGLEN=&MSGLEN,NXTRPL=&NXTRPL,         *07150001
               OPTCD=&OPTCD,RBA=&RBA,RECLEN=&RECLEN,IO=&IO,            *07200001
               RPLLEN=&RPLLEN,AAREA=&AAREA,AAREALN=&AAREALN,           *07250001
               ARECLEN=&ARECLEN,EXIT=&EXIT,KEYLEN=&KEYLEN,             *07300001
               NIB=&NIB,BRANCH=&BRANCH,USER=&USER,                     *07350001
               RTNCD=&RTNCD,FDBK2=&FDBK2,SENSE=&SENSE,REQ=&REQ,        *07400001
               DATAFLG=&DATAFLG,TRANSID=&TRANSID,AIXPC=&AIXPC,         *07450001
               FTNCD=&FTNCD,AIXFLAG=&AIXFLAG,CHNGDIR=&CHNGDIR,         *07500001
               STYPE=&STYPE,RTYPE=&RTYPE,CHAIN=&CHAIN,POST=&POST,      *07550001
               RESPOND=&RESPOND,CONTROL=&CONTROL,OBSQAC=&OBSQAC,       *07600001
               IBSQAC=&IBSQAC,OBSQVAL=&OBSQVAL,IBSQVAL=&IBSQVAL,       *07650001
               SEQNO=&SEQNO,SSENSEO=&SSENSEO,SSENSEI=&SSENSEI,         *07700001
               USENSEO=&USENSEO,USENSEI=&USENSEI,              @Z40BHUC*07750001
               BRACKET=&BRACKET,SSENSMO=&SSENSMO,SSENSMI=&SSENSMI,     *07800001
               SIGDATA=&SIGDATA,CODESEL=&CODESEL,              @Z40BHUC*07850040
               CRYPT=&CRYPT                                    @G40AKSL 07855040
.**********************************************************    @Z40BHCJ 07860001
.* TEST FOR POSSIBLE REGISTER FORM                             @Z40BHCJ 07862001
.**********************************************************    @Z40BHCJ 07870001
         AIF   ('&BLKTYPE' NE 'RPL' OR '&CALLER' NE 'MOD').I001190      07880001
         AIF   ('&MF(1)' NE '').I001190   NOT L, E, OR G MODE  @ZA10885 07895001
         AIF   ('&RECLEN' EQ '').I001190                       @Z40BHCJ 07905001
         AIF   (&IDAENO EQ 1).I022700                          @Z40BHCJ 07915001
.I001190 ANOP                                                  @Z40BHCJ 07946001
         AIF   ('&BLKTYPE' NE 'RPL' AND &IDAENO EQ 1 AND               *07950801
               '&AM' NE '' AND '&CALLER' EQ 'GEN').I001200              07954001
.*             IF THE ABOVE CONDITIONS ARE MET, NO VALID RPL KEYWORD    07957201
.*             EXCEPT AM WAS FOUND AND IT IS ASSUMED THAT AN RPL        07960401
.*             IS NOT TO BE GENERATED.                                  07963601
         AIF   (&IDAENO EQ 0 AND '&BLKTYPE' NE 'RPL').I001300  @XA07799 07966801
.*             IF BLKTYPE IS NOT RPL AND ELEMENT COUNT IS ZERO,         07970001
.*             TRY NIB.                                        @XA07799 07980001
&BTC     SETA  &RPLID                                                   08000001
         AGO   .I001500                                                 08050001
.I001200 ANOP                                                   X04SVHS 08100001
&IDAENO  SETA  0                                                X04SVHS 08150001
.I001300 ANOP                                                   X04SVHS 08250001
.********************************************************************** 08260001
.*             NIB                                                      08270001
.********************************************************************** 08280001
         IDACBNIB EXLST=&EXLST,MF=&MF,CALLER=&CALLER,NAME=&NAME,       *08300001
               USERFLD=&USERFLD,MODE=&MODE,LISTEND=&LISTEND,           *08350001
               CONDN=&CONDN,PROC=&PROC,NIBLEN=&NIBLEN,CID=&CID,        *08400001
               DEVCHAR=&DEVCHAR,CON=&CON,RESPLIM=&RESPLIM,SDT=&SDT,    *08450001
               LOGMODE=&LOGMODE,BNDAREA=&BNDAREA,              @Z40BHUC*08470040
               ENCR=&ENCR                                      @G40AKSL 08490040
         AIF   (&IDAENO EQ 0 AND '&BLKTYPE' NE 'NIB').I001400  @XA07799 08510001
         AIF   (&IDAENO EQ 1 AND '&EXLST' NE '' AND                    C08520001
               '&BLKTYPE' NE 'NIB').I001350                    @XA07799 08530001
&BTC     SETA  &NIBID                                            X03004 08550001
         AGO   .I001500                                                 08600001
.I001350 ANOP                                                           08610001
&IDAENO  SETA  0                                                        08620001
.I001400 ANOP                                                           08650001
.********************************************************************** 08660001
.*             ACB                                                      08670001
.********************************************************************** 08680001
         IDACBACB AM=&AM,MF=&MF,CALLER=&CALLER,ACBLEN=&ACBLEN,         *08700001
               ATRB=&ATRB,AVSPAC=&AVSPAC,BUFND=&BUFND,BUFNI=&BUFNI,    *08750001
               BUFNO=&BUFNO,BUFSP=&BUFSP,CINV=&CINV,DDNAME=&DDNAME,    *08800001
               ENDRBA=&ENDRBA,ERROR=&ERROR,EXLST=&EXLST,FS=&FS,        *08850001
               KEYLEN=&KEYLEN,LRECL=&LRECL,MACRF=&MACRF,NCIS=&NCIS,    *08900001
               NDELR=&NDELR,NEXCP=&NEXCP,NEXT=&NEXT,NINSR=&NINSR,      *08950001
               NIXL=&NIXL,NLOGR=&NLOGR,NRETR=&NRETR,NSSS=&NSSS,        *09000001
               NUPDR=&NUPDR,OFLAGS=&OFLAGS,PASSWD=&PASSWD,RKP=&RKP,    *09050001
               BSTRNO=&BSTRNO,CRA=&CRA,OPENOBJ=&OPENOBJ,AIXRKP=&AIXRKP,*09100001
               STRNO=&STRNO,STMST=&STMST,CATALOG=&CATALOG,             *09150001
               USERPTR=&USERPTR,JFCB=&JFCB,                    @XM01140*09160001
               APPLID=&APPLID,MAREA=&MAREA,MLEN=&MLEN                   09170140
.*                                                                      09202001
         AIF   ('&BLKTYPE' NE 'ACB' AND &IDAENO EQ 1                   *09210001
               AND '&AM' NE '' AND '&CALLER' EQ 'GEN').I001450          09220001
.*             IF THESE ABOVE CONDITIONS ARE MET, THEN ONLY 'AM'        09230001
.*             KEYWORD WAS SPECIFIED WITH MF=E FOR GENCB, AND THERE     09240001
.*             IS NO WAY TO DETERMINE WHAT TYPE CONTROL BLOCK IS        09242001
.*             REQUIRED                                                 09244001
         AIF   (&IDAENO NE 0 OR '&BLKTYPE' EQ 'ACB').I001475    X04SVHS 09246001
.*             IF ELEMENT COUNT IS 0 AND BLKTYPE NOT ACB,               09246401
.*             THEN THERE ARE NO VALID KEYWORDS SPECIFIED, BLOCK TYPE   09248001
.*             HAS NOT BEEN SPECIFIED, AND IT IS IMPOSSIBLE TO          09254401
.*             DETERMINE WHAT TYPE CONTROL BLOCK IS REQUIRED.           09255201
         AIF   ('&AM' NE 'VTAM' AND '&MF(1)' EQ 'E').I001500            09256401
.*             IF AM=VTAM, THEN BLOCK TYPE MUST BE SPECIFIED.  ELSE     09258401
.*             IT MUST BE SPECIFIED EXCEPT WHEN USING EXECUTE FORM      09260401
.*             OF GENCB.                                                09260501
.I001450 ANOP                                                           09260801
         AIF   ('&CALLER' NE 'GEN').I001500                     X04SVHS 09262801
.*             IF CALLER IS EQUAL GEN, THEN AT THIS POINT IT IS         09264801
.*             IMPOSSIBLE TO DETERMINE WHAT TYPE CONTROL BLOCK THE      09265201
.*             USER IS REQUESTING. THIS WILL OCCUR ONLY ON THE          09265601
.*             EXECUTE FORM OF GENCB.                                   09266001
         IDAERMAC 2,BLOCK-TYPE                                          09266401
&IDACB01 SETB  1                                                        09272001
         AGO   .I001500                                         X04SVHS 09277601
.I001475 ANOP                                                   X04SVHS 09283201
&BTC     SETA  &ACBID                   INDICATE BLK=ACB        X04SVHS 09288801
.********************************************************************** 09290801
.* SCAN CONTROL BLOCK LENGTH KEYWORDS    -    TESTCB ONLY               09294401
.********************************************************************** 09296401
.I001500 AIF   ('&CALLER' NE 'TEST').I001900                            09300001
         AIF   ('&EXLLEN' EQ '').I001600         *** EXLLEN ***         09350001
         AIF   ('&BLKTYPE' NE 'EXLST' AND '&BLKTYPE' NE '').I001600     09400001
         AIF   (NOT ('&AM' EQ 'VSAM' OR '&AM' EQ '')).I001510           09410001
         IDACB3 ARG=&EXLLEN,ARGNAME=EXLLEN,KWTC=X'2A',MF=&MF            09450001
.I001510 AIF   ('&AM' NE 'VTAM').I001600                                09500001
         IDACB3 ARG=&EXLLEN,ARGNAME=EXLLEN,KWTC=X'3F',MF=&MF            09600001
.I001600 AIF   ('&RPLLEN' EQ '').I001700         *** RPLLEN ***         09800001
         AIF   ('&BLKTYPE' NE 'RPL' AND '&BLKTYPE' NE '').I001700       09850001
         AIF   (NOT ('&AM' EQ 'VSAM' OR '&AM' EQ '')).I001610           09860001
         IDACB3 ARG=&RPLLEN,ARGNAME=RPLLEN,KWTC=X'37',MF=&MF            09900001
.I001610 AIF   ('&AM' NE 'VTAM').I001700                                09950001
         IDACB3 ARG=&RPLLEN,ARGNAME=RPLLEN,KWTC=X'3E',MF=&MF            10000001
.I001700 AIF   ('&ACBLEN' EQ '').I001800         *** ACBLEN ***         10250001
         AIF   ('&BLKTYPE' NE 'ACB' AND '&BLKTYPE' NE '').I001800       10300001
         AIF   (NOT ('&AM' EQ 'VSAM' OR '&AM' EQ '')).I001710           10310001
         IDACB3 ARG=&ACBLEN,ARGNAME=ACBLEN,KWTC=X'03',MF=&MF            10350001
.I001710 AIF   ('&AM' NE 'VTAM').I001800                                10400001
         IDACB3 ARG=&ACBLEN,ARGNAME=ACBLEN,KWTC=X'3D',MF=&MF            10500001
.I001800 AIF   ('&NIBLEN' EQ '').I001900         *** NIBLEN ***         10700001
         AIF   ('&BLKTYPE' NE 'NIB' AND '&BLKTYPE' NE '').I001900       10750001
         IDACB3 ARG=&NIBLEN,ARGNAME=NIBLEN,KWTC=X'53',MF=&MF            10800001
.********************************************************************** 10850001
.* SCAN FOR INVALID CONTROL BLOCK KEYWORDS                              11050001
.********************************************************************** 11060001
.I001900 AIF   (&BTC NE &ACBID).I002000                                 11100001
&BLK     SETC  'ACB'                                                    11150001
         AGO   .I002300                                                 11200001
.I002000 AIF   (&BTC NE &RPLID).I002100                                 11250001
&BLK     SETC  'RPL'                                                    11300001
         AGO   .I002300                                                 11350001
.I002100 AIF   (&BTC NE &NIBID).I002200                          X03004 11400001
&BLK     SETC  'NIB'                                             X03004 11450001
         AGO   .I002300                                                 11500001
.I002200 AIF   (&BTC NE &EXLID).I002300                        @ZA07565 11550001
&BLK     SETC  'EXLST'                                                  11600001
.********************************************************************** 11610001
.*             THE FOLLOWING BLOCK OF CODE CHECKS TO SEE IF ALL         11640001
.*             KEYWORDS SPECIFIED ARE VALID FOR THE CONTROL BLOCK       11642001
.*             SPECIFIED.                                               11644001
.********************************************************************** 11646001
.*             EXLST KEYWORDS ONLY                                      11648001
.******************************                                         11648401
.I002300 AIF   ('&BLK' EQ 'EXLST').I003900                              11648801
         AIF   ('&EODAD' EQ '').I002400                                 11650001
         IDAERMAC 11,EODAD,&BLK                                         11700001
.I002400 AIF   ('&JRNAD' EQ '').I002500                                 11750001
         IDAERMAC 11,JRNAD,&BLK                                         11800001
.I002500 AIF   ('&LERAD' EQ '').I002600                                 11850001
         IDAERMAC 11,LERAD,&BLK                                         11900001
.I002600 AIF   ('&SYNAD' EQ '').I002700                          X03004 11950001
         IDAERMAC 11,SYNAD,&BLK                                         12000001
.I002700 AIF   ('&LOGON' EQ '').I002800                          X03004 12050001
         IDAERMAC 11,LOGON,&BLK                                  X03004 12100001
.I002800 AIF   ('&LOSTERM' EQ '').I002900                        X03004 12150001
         IDAERMAC 11,LOSTERM,&BLK                                X03004 12200001
.I002900 AIF   ('&RELREQ' EQ '').I003200                       @Z40BHUC 12250001
         IDAERMAC 11,RELREQ,&BLK                                 X03004 12300001
.I003200 AIF   ('&ATTN' EQ '').I003300                           X03004 12550001
         IDAERMAC 11,ATTN,&BLK                                   X03004 12600001
.I003300 AIF   ('&TPEND' EQ '').I003350                        @G40AKCM 12650040
         IDAERMAC 11,TPEND,&BLK                                  X03004 12670040
.I003350 AIF   ('&NSEXIT' EQ '').I003400                       @G40AKCM 12690040
         IDAERMAC 11,NSEXIT,&BLK                               @G40AKCM 12710040
.I003400 AIF   ('&SCIP' EQ '').I003500                          X3004BS 12750001
         IDAERMAC 11,SCIP,&BLK                                  X3004BS 12800001
.I003500 AIF   ('&DFASY' EQ '').I003600                         X3004BS 12850001
         IDAERMAC 11,DFASY,&BLK                                 X3004BS 12900001
.I003600 AIF   ('&RESP' EQ '').I003800                         @Z40BHUC 12950001
         IDAERMAC 11,RESP,&BLK                                  X3004BS 13000001
.I003800 AIF   ('&EXLLEN' EQ '' OR '&BLKTYPE' EQ '').I003900            13150001
         IDAERMAC  11,EXLLEN,&BLK                                       13200001
.******************************                                         13220001
.*       RPL KEYWORDS ONLY                                              13240001
.******************************                                         13260001
.I003900 AIF   ('&BLK' EQ 'RPL').I008600                                13280001
         AIF   ('&ACB' EQ '').I004000                                   13300001
         AIF   ('&CALLER' NE 'GENCB'  AND  '&BLK' EQ 'ACB').I004000     13350001
         IDAERMAC 11,ACB,&BLK                                           13400001
.I004000 AIF   ('&AREA' EQ '').I004100                                  13450001
         IDAERMAC 11,AREA,&BLK                                          13500001
.I004100 AIF   ('&AREALEN' EQ '').I004200                               13550001
         IDAERMAC 11,AREALEN,&BLK                                       13600001
.I004200 AIF   ('&ARG' EQ '').I004300                                   13650001
         IDAERMAC 11,ARG,&BLK                                           13700001
.I004300 AIF   ('&ECB' EQ '').I004400                                   13750001
         IDAERMAC 11,ECB,&BLK                                           13800001
.I004400 AIF   ('&KEYLEN' EQ ''  OR  '&BLK' EQ 'ACB').I004500   X04SVHS 13850001
         IDAERMAC 11,KEYLEN,&BLK                                        13900001
.I004500 AIF   ('&MSGAREA' EQ '').I004600                               13950001
         IDAERMAC 11,MSGAREA,&BLK                                       14050001
.I004600 AIF   ('&MSGLEN' EQ '').I004700                                14100001
         IDAERMAC 11,MSGLEN,&BLK                                        14200001
.I004700 AIF   ('&NXTRPL' EQ '').I004800                                14250001
         IDAERMAC 11,NXTRPL,&BLK                                        14300001
.I004800 AIF   ('&OPTCD' EQ '').I004900                                 14350001
         IDAERMAC 11,OPTCD,&BLK                                         14400001
.I004900 AIF   ('&RECLEN' EQ '').I005000                                14450001
         IDAERMAC 11,RECLEN,&BLK                                        14500001
.I005000 AIF   ('&IO' EQ '').I005100                                    14550001
         IDAERMAC 11,IO,&BLK                                            14600001
.I005100 AIF   ('&FDBK' EQ '').I005200                                  14650001
         IDAERMAC 11,FDBK,&BLK                                          14700001
.I005200 AIF   ('&RBA' EQ '').I005300                                   14750001
         IDAERMAC 11,RBA,&BLK                                           14800001
.I005300 AIF   ('&AAREA' EQ '').I005400                          X03004 14850001
         IDAERMAC 11,AAREA,&BLK                                  X03004 14900001
.I005400 AIF   ('&AAREALN' EQ '').I005500                        X03004 14950001
         IDAERMAC 11,AAREALN,&BLK                                X03004 15000001
.I005500 AIF   ('&ARECLEN' EQ '').I005600                        X03004 15050001
         IDAERMAC 11,ARECLEN,&BLK                                X03004 15100001
.I005600 AIF   ('&EXIT' EQ '').I005900                           X03004 15150001
         IDAERMAC 11,EXIT,&BLK                                   X03004 15200001
.I005900 AIF   ('&NIB' EQ '').I006000                            X03004 15450001
         AIF ('&CALLER' NE 'GENCB' AND '&BLK' EQ 'NIB').I006000  X03004 15500001
         IDAERMAC 11,NIB,&BLK                                    X03004 15550001
.I006000 AIF   ('&BRANCH' EQ '').I006100                         X03004 15600001
         IDAERMAC 11,BRANCH,&BLK                                 X03004 15650001
.I006100 AIF   ('&USER' EQ '').I006300                           X03004 15700001
         IDAERMAC 11,USER,&BLK                                   X03004 15750001
.I006300 AIF   ('&RTNCD' EQ '').I006400                          X03004 15800001
         IDAERMAC 11,RTNCD,&BLK                                  X03004 15850001
.I006400 AIF   ('&FDBK2' EQ '').I006500                          X03004 15900001
         IDAERMAC 11,FDBK2,&BLK                                  X03004 15950001
.I006500 AIF   ('&SENSE' EQ '').I006600                          X03004 16000001
         IDAERMAC 11,SENSE,&BLK                                  X03004 16050001
.I006600 AIF   ('&REQ' EQ '').I006700                            X03004 16100001
         IDAERMAC 11,REQ,&BLK                                    X03004 16150001
.I006700 AIF   ('&DATAFLG' EQ '').I006800                        X03004 16200001
         IDAERMAC 11,DATAFLG,&BLK                                X03004 16250001
.I006800 AIF   ('&CHNGDIR' EQ '').I006850                       X3004BS 16300001
         IDAERMAC 11,CHNGDIR,&BLK                               X3004BS 16350001
.I006850 AIF   ('&CODESEL' EQ '').I006900                      @Z40BHUC 16360001
         IDAERMAC 11,CODESEL,&BLK                              @Z40BHUC 16370001
.I006900 AIF   ('&STYPE' EQ '').I007000                         X3004BS 16400001
         IDAERMAC 11,STYPE,&BLK                                 X3004BS 16450001
.I007000 AIF   ('&RTYPE' EQ '').I007100                         X3004BS 16500001
         IDAERMAC 11,RTYPE,&BLK                                 X3004BS 16550001
.I007100 AIF   ('&CHAIN' EQ '').I007200                         X3004BS 16600001
         IDAERMAC 11,CHAIN,&BLK                                 X3004BS 16650001
.I007200 AIF   ('&POST' EQ '').I007300                          X3004BS 16700001
         IDAERMAC 11,POST,&BLK                                  X3004BS 16750001
.I007300 AIF   ('&RESPOND' EQ '').I007400                       X3004BS 16800001
         IDAERMAC 11,RESPOND,&BLK                               X3004BS 16850001
.I007400 AIF   ('&CONTROL' EQ '').I007500                       X3004BS 16900001
         IDAERMAC 11,CONTROL,&BLK                               X3004BS 16950001
.I007500 AIF   ('&OBSQAC' EQ '').I007600                        X3004BS 17000001
         IDAERMAC 11,OBSQAC,&BLK                                X3004BS 17050001
.I007600 AIF   ('&IBSQAC' EQ '').I007700                        X3004BS 17100001
         IDAERMAC 11,IBSQAC,&BLK                                X3004BS 17150001
.I007700 AIF   ('&OBSQVAL' EQ '').I007800                       X3004BS 17200001
         IDAERMAC 11,OBSQVAL,&BLK                               X3004BS 17250001
.I007800 AIF   ('&IBSQVAL' EQ '').I007850                      @Z40BHUC 17300001
         IDAERMAC 11,IBSQVAL,&BLK                               X3004BS 17350001
.I007850 AIF   ('&SIGDATA' EQ '').I007900                      @Z40BHUC 17360001
         IDAERMAC 11,SIGDATA,&BLK                              @Z40BHUC 17370001
.I007900 AIF   ('&SEQNO' EQ '').I008000                         X3004BS 17400001
         IDAERMAC 11,SEQNO,&BLK                                 X3004BS 17450001
.I008000 AIF   ('&SSENSEO' EQ '').I008100                       X3004BS 17500001
         IDAERMAC 11,SSENSEO,&BLK                               X3004BS 17550001
.I008100 AIF   ('&SSENSEI' EQ '').I008200                       X3004BS 17600001
         IDAERMAC 11,SSENSEI,&BLK                               X3004BS 17650001
.I008200 AIF   ('&USENSEO' EQ '').I008300                       X3004BS 17700001
         IDAERMAC 11,USENSEO,&BLK                               X3004BS 17750001
.I008300 AIF   ('&USENSEI' EQ '').I008410                      @Z40BHUC 17800001
         IDAERMAC 11,USENSEI,&BLK                               X3004BS 17850001
.I008410 AIF   ('&BRACKET' EQ '').I008420                       X04SVHS 17953001
         IDAERMAC 11,BRACKET,&BLK                               X04SVHS 17956001
.I008420 AIF   ('&SSENSMO' EQ '').I008430                       X04SVHS 17959001
         IDAERMAC 11,SSENSMO,&BLK                               X04SVHS 17962001
.I008430 AIF   ('&SSENSMI' EQ '').I008440                       X04SVHS 17965001
         IDAERMAC 11,SSENSMI,&BLK                               X04SVHS 17968001
.I008440 AIF   ('&SIGDATA' EQ '').I008450                       X04SVHS 17971001
         IDAERMAC 11,SIGDATA,&BLK                               X04SVHS 17974001
.I008450 AIF   ('&AIXPC' EQ '').I008460                         X04SVHS 17977001
         IDAERMAC 11,AIXPC,&BLK                                 X04SVHS 17980001
.I008460 AIF   ('&AIXFLAG' EQ '').I008470                       X04SVHS 17983001
         IDAERMAC 11,AIXFLAG,&BLK                               X04SVHS 17986001
.I008470 AIF   ('&TRANSID' EQ '').I008480                       X04SVHS 17989001
         IDAERMAC 11,TRANSID,&BLK                               X04SVHS 17992001
.I008480 AIF   ('&FTNCD' EQ '').I008500                         X04SVHS 17995001
         IDAERMAC 11,FTNCD,&BLK                                 X04SVHS 17998001
.I008500 AIF   ('&RPLLEN' EQ '' OR '&BLKTYPE' EQ '').I008510   @G40AKSL 18000040
         IDAERMAC  11,RPLLEN,&BLK                                       18010040
.I008510 AIF   ('&CRYPT' EQ '').I008600                        @G40AKSL 18020040
         IDAERMAC  11,CRYPT,&BLK                               @G40AKSL 18030040
.******************************                                         18110001
.*       NIB KEYWORDS ONLY                                              18120001
.******************************                                         18130001
.I008600 AIF   ('&BLK' EQ 'NIB').I010000                                18150001
         AIF   ('&NAME' EQ '').I008700                           X03004 18200001
         IDAERMAC 11,NAME,&BLK                                   X03004 18250001
.I008700 AIF   ('&USERFLD' EQ '').I008800                        X03004 18300001
         IDAERMAC 11,USERFLD,&BLK                                X03004 18350001
.I008800 AIF   ('&MODE' EQ '').I008900                           X03004 18400001
         IDAERMAC 11,MODE,&BLK                                   X03004 18450001
.I008900 AIF   ('&LISTEND' EQ '').I009000                        X03004 18500001
         IDAERMAC 11,LISTEND,&BLK                                X03004 18550001
.I009000 AIF   ('&CONDN' EQ '').I009100                          X03004 18600001
         IDAERMAC 11,CONDN,&BLK                                  X03004 18650001
.I009100 AIF   ('&PROC' EQ '').I009200                           X03004 18700001
         IDAERMAC 11,PROC,&BLK                                   X03004 18750001
.I009200 AIF   ('&CID' EQ '').I009300                            X03004 18800001
         IDAERMAC 11,CID,&BLK                                    X03004 18850001
.I009300 AIF   ('&DEVCHAR' EQ '').I009400                        X03004 18900001
         IDAERMAC 11,DEVCHAR,&BLK                                X03004 18950001
.I009400 AIF   ('&CON' EQ '').I009500                            X03004 19000001
         IDAERMAC 11,CON,&BLK                                    X03004 19050001
.I009500 AIF   ('&EXLST' EQ '' OR '&BLK' EQ 'ACB').I009600      X3004BS 19100001
         AIF   ('&CALLER' NE 'GENCB'  AND  '&BLK' EQ 'EXLST').I009600   19150001
         IDAERMAC 11,EXLST,&BLK                                 X3004BS 19200001
.I009600 AIF   ('&RESPLIM' EQ '').I009700                       X3004BS 19250001
         IDAERMAC 11,RESPLIM,&BLK                               X3004BS 19300001
.I009700 AIF   ('&SDT' EQ '').I009800                           X3004BS 19350001
         IDAERMAC 11,SDT,&BLK                                   X3004BS 19400001
.I009800 AIF   ('&PROC' EQ '').I009840                         @Z40BHUC 19450001
         IDAERMAC 11,PROC,&BLK                                  X3004BS 19500001
.I009840 AIF   ('&LOGMODE' EQ '').I009870                      @Z40BHUC 19510001
         IDAERMAC 11,LOGMODE,&BLK                              @Z40BHUC 19520001
.I009870 AIF   ('&BNDAREA' EQ '').I009900                      @Z40BHUC 19530001
         IDAERMAC 11,BNDAREA,&BLK                              @Z40BHUC 19540001
.I009900 AIF   ('&NIBLEN' EQ ''  OR  '&BLKTYPE' EQ '').I009910 @G40AKSL 19550040
         IDAERMAC 11,NIBLEN,&BLK                                 X03004 19560040
.I009910 AIF   ('&ENCR' EQ '').I010000                         @G40AKSL 19570040
         IDAERMAC 11,ENCR,&BLK                                 @G40AKSL 19580040
.******************************                                         19610001
.*       ACB KEYWORDS ONLY                                              19620001
.******************************                                         19630001
.I010000 AIF   ('&BLK' EQ 'ACB').I013100                                19650001
         AIF   ('&ATRB' EQ '').I010100                                  19700001
         IDAERMAC 11,ATRB,&BLK                                          19750001
.I010100 AIF   ('&AVSPAC' EQ '').I010200                                19800001
         IDAERMAC 11,AVSPAC,&BLK                                        19850001
.I010200 AIF   ('&BUFND' EQ '').I010300                                 19900001
         IDAERMAC 11,BUFND,&BLK                                         19950001
.I010300 AIF   ('&BUFNI' EQ '').I010400                                 20000001
         IDAERMAC 11,BUFNI,&BLK                                         20050001
.I010400 AIF   ('&BUFNO' EQ '').I010500                                 20100001
         IDAERMAC 11,BUFNO,&BLK                                         20150001
.I010500 AIF   ('&BUFSP' EQ '').I010600                                 20200001
         IDAERMAC 11,BUFSP,&BLK                                         20250001
.I010600 AIF   ('&CINV' EQ '').I010700                                  20300001
         IDAERMAC 11,CINV,&BLK                                          20350001
.I010700 AIF   ('&DDNAME' EQ '').I010800                                20400001
         IDAERMAC 11,DDNAME,&BLK                                        20450001
.I010800 AIF   ('&ENDRBA' EQ '').I010900                                20500001
         IDAERMAC 11,ENDRBA,&BLK                                        20550001
.I010900 AIF   ('&ERROR' EQ '').I011000                                 20600001
         IDAERMAC 11,ERROR,&BLK                                         20650001
.I011000 AIF   ('&EXLST' EQ '').I011100                                 20700001
         AIF   ('&BLK' EQ 'NIB').I011100                        X3004BS 20750001
         AIF   ('&CALLER' NE 'GENCB'  AND  '&BLK' EQ 'EXLST').I011100   20800001
         IDAERMAC 11,EXLST,&BLK                                         20850001
.I011100 AIF   ('&FS' EQ '').I011150                           @XM01140 20900001
         IDAERMAC 11,FS,&BLK                                            20950001
.I011150 AIF   ('&JFCB' EQ '').I011200                         @XM01140 20960001
         IDAERMAC 11,JFCB,&BLK                                 @XM01140 20970001
.I011200 AIF   ('&LRECL' EQ '').I011300                                 21000001
         IDAERMAC 11,LRECL,&BLK                                         21050001
.I011300 AIF   ('&MACRF' EQ '').I011400                                 21100001
         IDAERMAC 11,MACRF,&BLK                                         21150001
.I011400 AIF   ('&NCIS' EQ '').I011500                                  21200001
         IDAERMAC 11,NCIS,&BLK                                          21250001
.I011500 AIF   ('&NDELR' EQ '').I011600                                 21300001
         IDAERMAC 11,NDELR,&BLK                                         21350001
.I011600 AIF   ('&NEXCP' EQ '').I011700                                 21400001
         IDAERMAC 11,NEXCP,&BLK                                         21450001
.I011700 AIF   ('&NEXT' EQ '').I011800                                  21500001
         IDAERMAC 11,NEXT,&BLK                                          21550001
.I011800 AIF   ('&NINSR' EQ '').I011900                                 21600001
         IDAERMAC 11,NINSR,&BLK                                         21650001
.I011900 AIF   ('&NIXL' EQ '').I012000                                  21700001
         IDAERMAC 11,NIXL,&BLK                                          21750001
.I012000 AIF   ('&NLOGR' EQ '').I012100                                 21800001
         IDAERMAC 11,NLOGR,&BLK                                         21850001
.I012100 AIF   ('&NRETR' EQ '').I012200                                 21900001
         IDAERMAC 11,NRETR,&BLK                                         21950001
.I012200 AIF   ('&NSSS' EQ '').I012300                                  22000001
         IDAERMAC 11,NSSS,&BLK                                          22050001
.I012300 AIF   ('&NUPDR' EQ '').I012400                                 22100001
         IDAERMAC 11,NUPDR,&BLK                                         22150001
.I012400 AIF   ('&OFLAGS' EQ '').I012500                                22200001
         IDAERMAC 11,OFLAGS,&BLK                                        22250001
.I012500 AIF   ('&PASSWD' EQ '').I012600                                22300001
         IDAERMAC 11,PASSWD,&BLK                                        22350001
.I012600 AIF   ('&RKP' EQ '').I012700                                   22400001
         IDAERMAC 11,RKP,&BLK                                           22450001
.I012700 AIF   ('&STRNO' EQ '').I012800                                 22500001
         IDAERMAC 11,STRNO,&BLK                                         22550001
.I012800 AIF   ('&STMST' EQ '').I012900                                 22600001
         IDAERMAC 11,STMST,&BLK                                         22650001
.I012900 AIF   ('&APPLID' EQ '').I013010                        X04SVHS 22700001
         IDAERMAC 11,APPLID,&BLK                                 X03004 22750001
.I013010 AIF   ('&BSTRNO' EQ '').I013020                        X04SVHS 22753001
         IDAERMAC 11,BSTRNO,&BLK                                X04SVHS 22756001
.I013020 AIF   ('&MAREA' EQ '').I013030                         X04SVHS 22759001
         IDAERMAC 11,MAREA,&BLK                                 X04SVHS 22762001
.I013030 AIF   ('&MLEN' EQ '').I013040                          X04SVHS 22765001
         IDAERMAC 11,MLEN,&BLK                                  X04SVHS 22768001
.I013040 AIF   ('&CRA' EQ '').I013050                           X04SVHS 22771040
         IDAERMAC 11,CRA,&BLK                                   X04SVHS 22774040
.I013050 AIF   ('&AIXRKP' EQ '').I013060                        X04SVHS 22777001
         IDAERMAC 11,AIXRKP,&BLK                                X04SVHS 22780001
.I013060 AIF   ('&OPENOBJ' EQ '').I013070                               22783040
         IDAERMAC 11,OPENOBJ,&BLK                               X04SVHS 22784040
.I013070 ANOP                                                           22785040
.I013080 AIF   ('&USERPTR' EQ '').I013000                      @XM01129 22790001
         IDAERMAC 11,USERPTR,&BLK                              @XM01129 22795001
.I013000 AIF   ('&ACBLEN' EQ ''  OR  '&BLKTYPE' EQ '').I013100          22800001
         IDAERMAC 11,ACBLEN,&BLK                                        22850001
.I013100   AIF   ('&CALLER' NE 'TEST'  OR  &IDAENO LE 1).I013200        22900001
         IDAERMAC 9,&IDAENO                                             22950001
         MEXIT                                                          23000001
.I013200 AIF   (NOT &IDACB01).I013300                                   23050001
         MEXIT                         EXIT IF ANY ERRORS DETECTED      23100001
.********************************************************************** 23110001
.I013300 ANOP                                                           23150001
&I       SETA  &IDAENO+1                                                23200001
.I013400 ANOP                          SET DEFAULT ELEMENT LENGTH TO 4  23250001
&I       SETA  &I-1                                                     23300001
         AIF   (&I LE 0).I013500                                        23350001
         AIF   (&IDAELEN(&I) NE 0).I013400                              23400001
&IDAELEN(&I) SETA 4                                                     23450001
         AIF   (&BTC NE &EXLID OR '&MF(1)' EQ 'E').I013400              23500001
&IDAELEN(&I) SETA 8                                                     23550001
         AGO   .I013400                                                 23600001
.*                                                                      23650001
.* CODE GENERATION                                                      23700001
.*                                                                      23750001
.I013500 ANOP                                                           23800001
         AIF   ('&MF(1)' NE 'E').I016600                                23850001
.********************************************************************** 23860001
.* EXECUTE FORM ******************************************************* 23900001
.********************************************************************** 23910001
         IDACB1 ARG=&MF,ARGNAME=MF,TYPE=C,POS=2,MF=E                    23950001
         AIF   (&IDACB11 EQ &AN2).I013600 S TYPE ADCON SPECIFIED        24000001
         AIF   (&IDACB11 EQ &AN3).I013700 INDIRECT ADDR SPECIFIED       24050001
         AIF   (&IDACB11 EQ &AN4).I013800 A TYPE ADCON SPECIFIED        24100001
         AIF   ('&IDACB13' EQ '1').I013900  PARM LIST IN REG 1          24150001
&LABEL   LR    1,&IDACB13              POINT TO PARAMETER LIST          24200001
         AGO   .I014000                                                 24250001
.I013600 ANOP                                                           24300001
.*                                      S TYPE ADCON                    24310001
&LABEL   DC    X'4110'                 POINT TO ...                     24350001
         DC    S(&IDACB13)             PARAMETER LIST                   24400001
         AGO   .I014000                                                 24450001
.I013700 ANOP                                                           24500001
.*                                      INDIRECT ADDRESS                24510001
&LABEL   DC    X'4110'                 POINT TO ...                     24550001
         DC    S(&IDACB13)             PARAMETER LIST ADDRESS           24600001
         L     1,0(,1)                 POINT TO PARAMETER LIST          24650001
         AGO   .I014000                                                 24700001
.I013800 ANOP                                                           24750001
.*                                      A TYPE ADCON                    24760001
&LABEL   LA    1,&IDACB13              POINT TO PARAMETER LIST          24800001
         AGO   .I014000                                                 24850001
.I013900 AIF   ('&LABEL' EQ '').I014000                                 24900001
         DS    0H                                               XA03893 24910001
&LABEL   EQU   *                                                        24950001
.I014000 ANOP                                                           25000001
         L     15,0(,1)                POINT TO HEADER                  25050001
         TM    1(15),X'10'             TEST LIST FOR AM=VTAM     X03004 25100001
         AIF   ('&AM' EQ 'VTAM').I014100                                25150001
         BO    &ERRLBL                 ERROR IF ON EXECUTE       X03004 25200001
         AGO   .I014200                                                 25250001
.I014100 ANOP                                                    X03004 25300001
         BZ    &ERRLBL                 ERROR IF NOT ON EXECUTE   X03004 25350001
.I014200 ANOP                                                    X03004 25400001
&I       SETA  &IDACB04(1)+&IDACB04(2)+&IDACB04(3)+&IDACB04(4)          25450001
.*             NO HEADER ACE IS BUILT IF EXECUTE FORM AND WAREA,        25460001
.*             LENGTH, AND COPIES PARAMETERS ARE NULL                   25470001
         AIF   (&I+&IDAENO LE 0).I016400                                25500001
         AIF   (&I LE 0).I015100                                        25550001
.* MODIFY HEADER ARGUMENT CONTROL ENTRY  -  MF=E                        25600001
&I       SETA  &IDACB02+1              NUMBER OF FIELDS IN HEADER       25650001
.I014300 ANOP                                                           25700001
&I       SETA  &I-1                                                     25750001
         AIF   (&I LE 0).I015000         TEST FOR END OF LIST           25800001
         AIF   (&IDACB04(&I) LE 0).I014300 TEST FOR FLD TO BE MODIFIED  25850001
&WORKA   SETA  4-&IDACB07(&I)                                           25900001
         AIF   (&IDACB04(&I) EQ &AN3).I014800  INDIRECT ADDR SPECIFIED  25950001
         AIF   (&IDACB04(&I) EQ &AN4).I014900  A TYPE ADCON SPECIFIED   26000001
&H       SETC  ''                                                       26050001
         AIF   (&IDACB07(&I) NE 2).I014400 TEST FOR HALF-WORD FIELD     26100001
&H       SETC  'H'                                                      26150001
.I014400 AIF   (&IDACB04(&I) EQ &AN1).I014600  REGISTER SPECIFICATION   26200001
         AIF   (&IDACB04(&I) EQ &AN2).I014700  S TYPE ADCON SPECIFIED   26250001
         AIF   (&IDACB04(&I) EQ &VN1).I014500  SELF DEFINING TERM       26300001
         IDAERMAC 7,IDACB2-HMOD        INVALID HEADER TYPE CODE         26350001
         MEXIT                                                          26400001
.*                                     *** VN1 ***  SELF DEFINING TERM  26450001
.I014500 LA    14,&IDACB05(&I)         LOAD HEADER FIELD VALUE          26500001
         ST&H  14,&IDACB06(&I)(,15)    STORE VALUE IN HEADER            26550001
         AGO   .I014300                                                 26600001
.*                                     *** AN1 ***  REG SPECIFIECATION  26650001
.I014600 ST&H  &IDACB05(&I),&IDACB06(&I)(,15) STORE VALUE IN HEADER     26700001
         AGO   .I014300                                                 26750001
.*                                     *** AN2 ***  S TYPE ADCON        26800001
.I014700 DC    X'41E0'                 LOAD VALUE ...                   26850001
         DC    S(&IDACB05(&I))         OF HEADER FIELD                  26900001
         ST&H  14,&IDACB06(&I)(,15)    STORE VALUE IN HEADER            26950001
         AGO   .I014300                                                 27000001
.*                                     *** AN3 ***  INDIRECT ADDRESS    27050001
.I014800 DC    X'41E0'                 LOAD POINTER TO ...              27100001
         DC    S(&IDACB05(&I))         VALUE OF HEADER FIELD            27150001
         MVC   &IDACB06(&I)(&IDACB07(&I),15),&WORKA.(14)               C27200001
                                       MOVE VALUE TO HEADER             27250001
         AGO   .I014300                                                 27300001
.*                                     *** AN4 ***  A TYPE ADCON        27350001
.I014900 CNOP  0,4                                                      27400001
         BAL   14,*+8                  BRANCH AROUND CONSTANT           27450001
         DC    A(&IDACB05(&I))         VALUE OF HEADER FIELD            27500001
         MVC   &IDACB06(&I)(&IDACB07(&I),15),&WORKA.(14)               C27550001
                                       MOVE VALUE TO HEADER             27600001
         AGO   .I014300                                                 27650001
.I015000 AIF   (&IDAENO LE 0).I016400    TEST FOR NO ELEMENTS TO MODIFY 27700001
.******************************                                         27710001
.* LOCATE AND MODIFY ELEMENT ARGUMENT CONTROL ENTRIES   -   MF=E        27750001
.******************************                                         27760001
.I015100 ANOP                                                           27800001
&I       SETA  0                                                        27850001
.I015200 ANOP                                                           27900001
&I       SETA  &I+1                                                     27950001
         AIF   (&I GT &IDAENO).I016400 TEST FOR ALL ELEMENTS MODIFIED   28000001
         LR    14,1                    POINT TO PARAMETER LIST          28050001
         AIF   (&I GT 1).I015300         TEST FOR FIRST ELEMENT         28100001
         B     *+20                    BYPASS HEADER                    28150001
.I015300 LA    14,4(,14)               POINT TO NEXT PLIST ENTRY        28200001
         L     15,0(,14)               POINT TO NEXT ELEMENT            28250001
         CLI   1(15),&IDAEID(&I)       TEST ELEMENT ID                  28300001
         BE    *+14                    BRANCH IF ELEMENT FOUND          28350001
         LTR   15,15                   TEST FOR END OF PARAMETER LIST   28400001
         BP    *-18                    CONTINUE SEARCH IF NOT END       28450001
         B     &ERRLBL                 ELEMENT NOT FOUND - ERROR        28500001
.*                                                                      28510001
         AIF   (&IDAETYP(&I) EQ &VN1).I015400 SELF DEFINING TERM        28550001
         AIF   (&IDAETYP(&I) EQ &VN2).I015500 BIT STRING                28600001
         AIF   (&IDAETYP(&I) EQ &VN3).I015800 CHARACTER STRING          28650001
         AIF   (&IDAETYP(&I) EQ &AN1).I015900 REGISTER SPECIFICATION    28700001
         AIF   (&IDAETYP(&I) EQ &AN2).I016000 S TYPE ADCON              28750001
         AIF   (&IDAETYP(&I) EQ &AN3).I016100 INDIRECT ADDRESS          28800001
         AIF   (&IDAETYP(&I) EQ &AN4).I016200 A TYPE ADCON              28850001
         AIF   (&IDAETYP(&I) EQ 0).I016300                              28900001
         IDAERMAC 7,IDACB2-EMOD                                         28950001
         MEXIT                                                          29000001
.*                                     *** VN1 *** SELF DEFINING TERM   29050001
.I015400 LA    14,&IDAVALC(&I)         LOAD ELEMENT VALUE               29100001
         ST    14,4(,15)               STORE VALUE IN ELEMENT           29150001
         AGO   .I015200                                                 29200001
.*                                     *** VN2 *** BIT STRING           29250001
.I015500 AIF   (&IDAEID(&I) EQ X'34').I015600 TEST FOR OPTCD     X03004 29300001
         AIF   (&IDAEID(&I) EQ X'50').I015700 TEST FOR PROC      X03004 29350001
         BAL   14,*+8                  BRANCH AROUND CONSTANT    X03004 29400001
         DC    B'&IDAVALC(&I)'         BINARY VALUE                     29450001
         MVC   4(4,15),0(14)           MOVE VALUE TO ELEMENT            29500001
         AIF   (&IDAEID(&I) EQ X'40').I016300                   X04SVHS 29510001
.*             IF KEYWORD IS AM, CHECK FOR EXLST                        29520001
         AGO   .I015200                                                 29550001
.I015600 BAL   14,*+16                 BRANCH AROUND CONSTANT    X03004 29600001
         DC    B'&IDAVALC(&I)'         BINARY VALUE              X03004 29650001
         DC    B'&IDAOPT2'             BINARY VALUE              X03004 29700001
         DC    B'&IDAOPT3'             BINARY VALUE              X03004 29750001
         MVC   4(12,15),0(14)          MOVE VALUE TO ELEMENT     X03004 29800001
         AGO   .I015200                                                 29850001
.I015700 BAL   14,*+12                 BRANCH AROUND CONSTANT    X03004 29900001
         DC    B'&IDAVALC(&I)'         BINARY VALUE              X03004 29950001
         DC    B'&IDAPRC2'             BINARY VALUE              X03004 30000001
         MVC   4(8,15),0(14)           MOVE VALUE TO ELEMENT     X03004 30050001
         AGO   .I015200                                                 30100001
.*                                     *** VN3 *** CHARACTER STRING     30150001
.I015800 BAL   14,*+12                 BRANCH AROUND CONSTANT           30200001
         DC    CL8'&IDAVALC(&I)'       EIGHT-BYTE CHARACTER STRING      30250001
         MVC   4(8,15),0(14)           MOVE CHARACTER STRING TO ELEMENT 30300001
         AGO   .I015200                                                 30350001
.*                                     *** AN1 *** REG SPECIFICATION    30400001
.I015900 ST    &IDAVALC(&I),4(,15)     STORE VALUE IN ELEMENT           30450001
         AGO   .I016300                                                 30500001
.*                                     *** AN2 *** S TYPE ADCON         30550001
.I016000 DC    X'41E0'                 LOAD ADDRESS VALUE               30600001
         DC    S(&IDAVALC(&I))                                          30650001
         ST    14,4(,15)               STORE VALUE IN ELEMENT           30700001
         AGO   .I016300                                                 30750001
.*                                     *** AN3 *** INDIRECT ADDRESS     30800001
.I016100 DC    X'41E0'                 LOAD POINTER ...                 30850001
         DC    S(&IDAVALC(&I))         TO VALUE                         30900001
         MVC   4(&IDAELEN(&I),15),0(14) MOVE VALUE TO ELEMENT           30950001
         AGO   .I016300                                                 31000001
.*                                     *** AN4 *** A TYPE ADCON         31050001
.I016200 CNOP  0,4                                                      31100001
         BAL   14,*+8                  BRANCH AROUND CONSTANT           31150001
         DC    A(&IDAVALC(&I))         ADDRESS VALUE                    31200001
         MVC   4(4,15),0(14)           MOVE VALUE TO ELEMENT            31250001
.I016300 AIF   (&BTC NE &EXLID OR &IDAEID(&I) EQ 42).I015200            31300001
.*             IF EXLST EXIT FLAGS MUST BE GENERATED                    31310001
.*                                     *** EXIT LIST ENTRY ***          31350001
         BAL   14,*+8                  BRANCH AROUND CONSTANT           31400001
         DC    B'&IDAVALX(&I)'         EXIT ATTRIBUTES                  31450001
         MVC   8(4,15),0(14)           MOVE ATTRIBUTES TO ELEMENT       31500001
         AGO   .I015200                                                 31550001
.I016400 B     IDA&SYSNDX.B            BRANCH AROUND ERR CODE  X03004HS 31600001
&ERRLBL  LA    15,8                    SET ERROR RETURN CODE            31650001
         AIF   (&IDABUG).I016500         TEST FOR DEBUG MODE            31700001
         CNOP  0,4                     ADJUST TO WORD BOUNDARY @Z40BHCJ 31710001
         B     *+20                    BYPASS LINKAGE          @Z40BHCJ 31750001
         AGO   .I022100                                         X04SVHS 31800001
.I016500 ANOP                                                  X03004HS 31850001
         CNOP  0,4                     ADJUST TO WORD BOUNDARY X03004HS 31900001
         B     *+20                    BYPASS LINKAGE          @Z40BHCJ 31950001
         AGO   .I022000                  ISSUE CALL FOR IDA019C1        32000001
.********************************************************************** 32010001
.* STANDARD FORM ****************************************************** 32050001
.* DYNAMIC MODIFICATION *********************************************** 32100001
.********************************************************************** 32110001
.I016600 ANOP                                                           32150001
&PLLEN   SETA  4*(&IDAENO+1)              CALCULATE LENGTH OF PARM LIST 32200001
.*      CALC OFFSET FROM START OF PARM LIST TO EACH ELEMENT VALUE FIELD 32250001
&EOFF(1) SETA  &PLLEN+&IDACB03+4        ACCOUNT FOR LENGTH OF HEADER    32300001
&I       SETA  1                                                        32350001
.I016700 ANOP                                                           32400001
&I       SETA  &I+1                                                     32450001
         AIF   (&I GT &IDAENO).I016800  CHECK FOR END OF LIST           32500001
&EOFF(&I) SETA &EOFF(&I-1)+&IDAELEN(&I-1)+4                             32550001
.*                                      SET ELEMENT OFFSET ARRAY        32560001
         AGO   .I016700                                                 32600001
.*      MODIFY HEADER ARGUMENT CONTROL ENTRY  -  MF=S                   32650001
.I016800 AIF   ('&MF' NE 'L').I016900   CHECK FOR LIST FORM             32700001
         AIF   ('&LABEL' EQ '').I018700                                 32750001
&PLLBL   SETC  '&LABEL'                                                 32800001
         AGO   .I018700                                                 32850001
.I016900 AIF   ('&LABEL' EQ '').I017000                                 32900001
         DS    0H                                               XA03893 32910001
&LABEL   EQU   *                                                        32950001
.I017000 AIF   (&RMF).I020600            GO IF MF = REENTRANT           33000001
.I017100 ANOP                                                           33050001
&I       SETA  0                                                        33100001
.I017200 ANOP                                                           33150001
&I       SETA  &I+1                                                     33200001
         AIF   (&I GT &IDACB02).I017800  TEST FOR END OF HEADER LIST    33250001
         AIF   (&IDACB04(&I) LT &AN1 OR &IDACB04(&I) GT &AN3).I017200   33300001
.*             CHECK IF HEADER ELEMENT IS REGISTER SPECIFICATION,       33310001
.*             S TYPE ADCON, OR INDIRECT ADDRESS                        33320001
&H       SETC  ''                                                       33350001
         AIF   (&IDACB07(&I) NE 2).I017300                              33400001
&H       SETC  'H'                                                      33450001
.I017300 ANOP                                                           33500001
&WORKA   SETA  &PLLEN+&IDACB06(&I)     CALC OFFSET FROM START OF PLIST  33550001
         AIF   (&IDACB04(&I) EQ &AN3).I017600                           33600001
.*                                      CHECK FOR INDIRECT ADDRESS      33610001
&WORKC   SETC  '&WORKA'.'(,1)'         OPERAND 2 FOR MF = REENTRANT     33650001
         AIF   (&RMF).I017400                                           33700001
&WORKC   SETC  '&PLLBL'.'+'.'&WORKA'   OPERAND 2 FOR MF = S/L           33750001
.I017400 AIF   (&IDACB04(&I) EQ &AN2).I017500 CHECK FOR S TYPE ADCON    33800001
         AIF   (&IDACB04(&I) EQ &AN3).I017600 CHECK FOR INDIRECT ADDR   33850001
.*                                     *** AN1 *** REG SPECIFICATION    33900001
         ST&H  &IDACB05(&I),&WORKC     STORE VALUE IN HEADER            33950001
         AGO   .I017200                                                 34000001
.*                                     *** AN2 *** S TYPE ADCON         34050001
.I017500 DC    X'41F0'                 LOAD ADDRESS VALUE ...           34100001
         DC    S(&IDACB05(&I))         FOR HEADER FIELD                 34150001
         ST&H  15,&WORKC               STORE VALUE IN HEADER            34200001
         AGO   .I017200                                                 34250001
.*                                     *** AN3 *** INDIRECT ADDRESS     34300001
.I017600 DC    X'41F0'                 LOAD POINTER TO VALUE            34350001
         DC    S(&IDACB05(&I))         FOR HEADER FIELD                 34400001
&J       SETA  4-&IDACB07(&I)          CALC OFFSET IN USER FIELD        34450001
&WORKC   SETC  '&WORKA'.'('.'&IDACB07(&I)'.',1)' OPERND 1 FOR MF=REENT  34500001
         AIF   (&RMF).I017700                                           34550001
&WORKC   SETC  '&PLLBL'.'+'.'&WORKA'.'('.'&IDACB07(&I)'.')' OP1 MF=S/L  34600001
.I017700 MVC   &WORKC,&J.(15)          MOVE VALUE TO HEADER             34650001
         AGO   .I017200                                                 34700001
.******************************                                         34710001
.*      MODIFY ELEMENT ARGUMENT CONTROL ENTRIES  -  MF=S                34750001
.******************************                                         34760001
.I017800 ANOP                                                           34800001
&I       SETA  0                                                        34850001
.I017900 ANOP                                                           34900001
&I       SETA  &I+1                                                     34950001
         AIF   (&I GT &IDAENO).I018500    TEST FOR END OF ELEMENT LIST  35000001
         AIF   (&IDAETYP(&I) LT &AN1 OR &IDAETYP(&I) GT &AN3).I017900   35050001
.*             CHECK IF ELEMENT TYPE IS REGISTER SPECIFICATION,         35060001
.*             S TYPE ADCON, OR INDIRECT ADDRESS                        35070001
         AIF   (&IDAETYP(&I) EQ &AN3).I018200 CHECK FOR INDIRECT ADDR   35100001
&WORKC   SETC  '&EOFF(&I)'.'(,1)'      OPERAND 2 FOR MF = REENTRANT     35150001
         AIF   (&RMF).I018000                                           35200001
&WORKC   SETC  '&PLLBL'.'+'.'&EOFF(&I)' OPERAND 2 FOR MF = S/L          35250001
.I018000 AIF   (&IDAETYP(&I) EQ &AN2).I018100                           35300001
.*                                     *** AN1 *** REG SPECIFICATION    35350001
         ST    &IDAVALC(&I),&WORKC     STORE VALUE IN ELEMENT           35400001
         AGO   .I017900                                                 35450001
.*                                     *** AN2 *** S TYPE ADCON         35500001
.I018100 DC    X'41F0'                 LOAD ADDRESS VALUE               35550001
         DC    S(&IDAVALC(&I))                                          35600001
         ST    15,&WORKC                                                35650001
         AGO   .I017900                                                 35700001
.*                                     *** AN3 *** INDIRECT ADDRESS     35750001
.I018200 DC    X'41F0'                 LOAD POINTER TO VALUE            35800001
         DC    S(&IDAVALC(&I))                                          35850001
&J       SETA  4                                                        35900001
         AIF   (&BTC EQ &EXLID AND &IDAEID(&I) NE 42).I018300           35950001
&J       SETA  &IDAELEN(&I)                                             36000001
.I018300 ANOP                                                           36050001
&WORKC   SETC  '&EOFF(&I)'.'('.'&J'.',1)' OPERAND 1 FOR MF = REENT      36100001
         AIF   (&RMF).I018400                                           36150001
&WORKC   SETC  '&PLLBL'.'+'.'&EOFF(&I)'.'('.'&J'.')'                    36200001
.*                                     OP 1 FOR MF = S/L                36202001
.I018400 MVC   &WORKC,0(15)            MOVE VALUE TO ELEMENT            36250001
         AGO   .I017900                                                 36300001
.I018500 AIF   (&RMF).I021900            GO IF MF = REENTRANT           36350001
         AIF   (&IDAENO GE 1).I018600   TEST FOR NO ELEMENTS IN LIST    36400001
         CNOP  0,4                                                      36450001
&WORKA   SETA  &IDACB03+4                                               36500001
         BAL   1,&PLLBL+&WORKA         BRANCH AROUND CONSTANTS          36550001
         AGO   .I018700                                                 36600001
.I018600 CNOP  0,4                                                      36650001
&WORKA   SETA  &EOFF(&IDAENO)+&IDAELEN(&IDAENO)                         36700001
         BAL   1,&PLLBL+&WORKA         BRANCH AROUND CONSTANTS          36750001
.********************************************************************** 36760001
.* STANDARD AND LIST FORMS ******************************************** 36800001
.* BUILD PARAMETER LIST                                                 36850001
.********************************************************************** 36860001
.I018700 AIF   (&IDAENO GT 0).I018800  TEST FOR NO ELEMENTS IN LIST     36900001
&PLLBL   DC    A(*+4+X'80000000')      ADDRESS OF HEADER                36950001
         AGO   .I019100                                                 37000001
.I018800 ANOP                                                           37050001
&PLLBL   DC    A(*+&PLLEN)             ADDRESS OF HEADER                37100001
&I       SETA  0                                                        37150001
.I018900 ANOP                                                           37200001
&I       SETA  &I+1                                                     37250001
         AIF   (&I GE &IDAENO).I019000                                  37300001
&WORKA   SETA  &EOFF(&I)-4                                              37350001
         DC    A(&PLLBL+&WORKA)        ELEMENT ADDRESS                  37400001
         AGO   .I018900                                                 37450001
.I019000 ANOP                                                           37500001
&WORKA   SETA  &EOFF(&I)-4                                              37550001
         DC    A(&PLLBL+&WORKA+X'80000000') ADDRESS OF LAST ELEMENT     37600001
.******************************                                         37610001
.* BUILD HEADER ARGUMENT CONTROL ENTRY                                  37650001
.******************************                                         37660001
.I019100 DC    AL1(&BTC)               BLOCK TYPE CODE                  37700001
         DC    AL1(&FTC)               FUNCTION TYPE CODE               37750001
&I       SETA  0                                                        37800001
.I019200 ANOP                                                           37850001
&I       SETA  &I+1                                                     37900001
         AIF   (&I GT &IDACB02).I019400                                 37950001
         AIF   (&IDACB04(&I) EQ &VN1 OR &IDACB04(&I) EQ &AN4).I019300   38000001
.******************************                                         38002001
.*             CHECK IF HEADER TYPE IS SELF DEFINING TERM OR            38010001
.*             A TYPE ADCON.                                            38020001
.******************************                                         38030001
         DC    AL&IDACB07(&I)(0)        HEADER FIELD VALUE              38050001
         AGO   .I019200                                                 38100001
.I019300 DC    AL&IDACB07(&I)(&IDACB05(&I)) HEADER FIELD VALUE          38150001
         AGO   .I019200                                                 38200001
.******************************                                         38210001
.* BUILD ELEMENT ARGUMENT CONTROL ENTRIES                               38250001
.******************************                                         38260001
.I019400 ANOP                                                           38300001
&I       SETA  0                                                        38350001
.I019500 ANOP                                                           38400001
&I       SETA  &I+1                                                     38450001
         AIF   (&I GT &IDAENO).I020500                                  38500001
         DC    AL2(&IDAEID(&I))           ELEMENT ID                    38550001
         AIF   (&IDAEID(&I) NE X'34').I019600 TEST FOR OPTCD     X03004 38600001
         DC    AL2(2)                  BIT STRING LENGTH         X03004 38650001
         AGO   .I019800                                          X03004 38700001
.I019600 AIF   (&IDAEID(&I) NE X'50').I019700 TEST FOR PROC      X03004 38750001
         DC    AL2(1)                  BIT STRING LENGTH         X03004 38800001
         AGO   .I019800                                          X03004 38850001
.I019700 DC    AL2(0)                  RESERVED                  X03004 38900001
         AIF   ('&CALLER' EQ 'SHOW').I019500                            38950001
.I019800 AIF   (&IDAETYP(&I) EQ &VN2).I019900 CHECK FOR BIT STRING      39000001
         AIF   (&IDAETYP(&I) EQ &VN3).I020100 CHECK FOR CHAR STRING     39050001
         AIF   (&IDAETYP(&I) GE &AN1 AND &IDAETYP(&I) LE &AN3).I020200  39100001
.******************************                                         39110001
.*                                     *** VN1 OR AN4 ***               39150001
.*             SELF DEFINING TERM OR A TYPE ADCON                       39160001
.******************************                                         39170001
         DC    A(&IDAVALC(&I))         ELEMENT VALUE                    39200001
         AGO   .I020300                                                 39250001
.*                                     *** VN2 *** BIT STRING           39300001
.I019900 DC    B'&IDAVALC(&I)'         ELEMENT VALUE                    39350001
         AIF   (&IDAEID(&I) NE X'34').I020000 TEST FOR OPTCD     X03004 39400001
         DC    B'&IDAOPT2'             ELEMENT VALUE             X03004 39450001
         DC    B'&IDAOPT3'             ELEMENT VALUE             X03004 39500001
         AGO   .I019500                                                 39550001
.I020000 AIF   (&IDAEID(&I) NE X'50').I020050 TEST FOR PROC             39600001
         DC    B'&IDAPRC2'             ELEMENT VALUE             X03004 39650001
         AGO   .I019500                                                 39700001
.I020050 AIF   (&IDAEID(&I) EQ X'40').I020300                   X04SVHS 39710001
.*             IF KEYWORD IS AM, CHECK FOR EXLST                X04SVHS 39720001
         AGO   .I019500                 CHECK NEXT ELEMENT      X04SVHS 39730001
.*                                     *** VN3 *** CHAR STRING          39750001
.I020100 DC    CL8'&IDAVALC(&I)'       ELEMENT VALUE                    39800001
         AGO   .I019500                                                 39850001
.*                                     *** AN1, AN2, OR AN3 ***         39900001
.*             REGISTER SPECIFICATION, S TYPE ADCON, OR INDIRECT ADDR   39910001
.I020200 DC    A(0)                    ELEMENT VALUE TO BE MODIFIED     39950001
.I020300 AIF   (&BTC EQ &EXLID AND &IDAEID(&I) NE 42 AND               C40000001
               &IDAEID(&I) NE 63).I020400                               40050001
         AIF   (&IDAELEN(&I) LE 4).I019500                              40100001
         DC    A(0)                    REMAINDER OF ELEMENT FIELD       40150001
         AIF   (&IDAELEN(&I) LE 8).I019500                              40200001
         DC    A(0)                   REMAINDER OF ELEMENT FIELD X03004 40250001
         AGO   .I019500                                                 40300001
.I020400 DC    B'&IDAVALX(&I)'         EXIT ATTRIBUTES                  40350001
         AGO   .I019500                                                 40400001
.I020500 AIF   (&RMF).I021200            GO IF MF = REENTRANT           40450001
         AIF   ('&MF' NE 'L').I022000                                   40500001
         MEXIT                                                          40550001
.********************************************************************** 40560001
.* REENTRANT MACRO FORMS - GENERATE AND LIST ************************** 40600001
.* GENERATE EQUATE FOR LENGTH OF PARAMETER LIST AREA USED               40650001
.********************************************************************** 40660001
.I020600 AIF   (N'&MF LT 3).I020900                                     40700001
         AIF   (&IDAENO GT 0).I020700                                   40750001
&WORKA   SETA  &IDACB03+4                                               40800001
         AGO   .I020800                                                 40850001
.I020700 ANOP                                                           40900001
&WORKA   SETA  &EOFF(&IDAENO)+&IDAELEN(&IDAENO) CALC AREA LENGTH        40950001
.I020800 ANOP                                                           41000001
&MF(3)   EQU   &WORKA                  LENGTH OF PARM LIST AREA USED    41050001
.I020900 CNOP  0,4                                                      41100001
         AIF   (&IDAENO GT 0).I021000                                   41150001
&WORKA   SETA  &IDACB03+4                                               41200001
         AGO   .I021100                                                 41250001
.I021000 ANOP                                                           41300001
&WORKA   SETA  &EOFF(&IDAENO)+&IDAELEN(&IDAENO)-&PLLEN+4                41350001
.*                                     CALC LENGTH OF ACES              41360001
.I021100 BAL   15,*+&WORKA             BRANCH OVER CONSTANTS            41400001
.******************************                                         41410001
.* BUILD HEADER AND ELEMENT ACES INLINE                                 41450001
         AGO   .I019100                  SHARE MF = L/S CODE            41500001
.******************************                                         41510001
.* TRANSFORM AREA ADDRESS AND LOAD REGISTER 1                           41550001
.******************************                                         41560001
.I021200 IDACB1 ARG=&MF,TYPE=C,POS=2,MF=&MF                             41600001
.*             THE VALUES IN GLOBALS &IDACB11 AND &IDACB13 ARE SET      41610001
.*             BY IDACB1.                                               41620001
         AIF   (&IDACB11 EQ &AN2).I021300 S TYPE ADCON                  41650001
         AIF   (&IDACB11 EQ &AN3).I021400 INDIRECT ADDRESS              41700001
         AIF   (&IDACB11 EQ &AN4).I021500 A TYPE ADCON                  41750001
         AIF   ('&IDACB13' EQ '1').I021600 IS PARM LIST IN REG 1        41800001
         LR    1,&IDACB13              POINT TO PARAMETER LIST AREA     41850001
         AGO   .I021600                                                 41900001
.I021300 ANOP                          *** AN2 *** S TYPE ADCON         41950001
         DC    X'4110'                 POINT TO ...                     42000001
         DC    S(&IDACB13)             PARAMETER LIST AREA              42040001
         AGO   .I021600                                                 42080001
.I021400 ANOP                          *** AN3 *** INDIRECT ADDRESS     42120001
         DC    X'4110'                 POINT TO ...                     42160001
         DC    S(&IDACB13)             ADDRESS OF PARAMETER LIST AREA   42250001
         L     1,0(,1)                 POINT TO PARAMETER LIST AREA     42300001
         AGO   .I021600                                                 42350001
.I021500 ANOP                          *** AN4 *** A TYPE ADCON         42400001
         LA    1,&IDACB13              POINT TO PARAMETER LIST AREA     42450001
.I021600 ANOP                                                           42500001
&WORKA   SETA  &WORKA-4                                                 42550001
         MVC   &PLLEN.(&WORKA,1),0(15) MOVE ACES TO AREA                42600001
.******************************                                         42610001
.* BUILD PARAMETER LIST                                                 42650001
.******************************                                         42660001
         LA    15,&PLLEN.(,1)          POINT TO HEADER ACE              42700001
         ST    15,0(,1)                STORE ADDRESS IN PARAMETER LIST  42750001
&I       SETA  0                       INIT ELEMENT STACK INDEX         42800001
&J       SETA  0                       INIT PLIST ENTRY OFFSET          42850001
.I021700 ANOP                                                           42900001
&I       SETA  &I+1                    INCR ELEMENT STACK INDEX         42950001
         AIF   (&I GT &IDAENO).I021800                                  43000001
&J       SETA  &J+4                    INCR PLIST ENTRY OFFSET          43050001
&WORKA   SETA  &EOFF(&I)-4          OFFSET TO ELEMENT ACE               43100001
         LA    15,&WORKA.(,1)          POINT TO ELEMENT ACE             43150001
         ST    15,&J.(,1)              STORE ADDRESS IN PARAMETER LIST  43200001
         AGO   .I021700                                                 43250001
.I021800 OI    &J.(1),X'80'            MARK END OF PARAMETER LIST       43300001
.******************************                                         43310001
.* MODIFY HEADER AND ELEMENT ACES                                       43350001
.******************************                                         43360001
         AGO   .I017100                  SHARE CODE WITH MF = S         43400001
.I021900 AIF   ('&MF(1)' EQ 'G').I022000                                43450001
         MEXIT                                                          43500001
.********************************************************************** 43510001
.* LINKAGE ************************************************************ 43550001
.********************************************************************** 43560001
.I022000 ANOP                                                  X03004HS 43600001
         AIF   (NOT(&IDABUG)).I022100   CHECK FOR DEBUG MODE            43650001
         CNOP  0,4                     ALIGN TO FULL WORD BOUNDRY       43660001
IDA&SYSNDX.B B     *+8                                         X03004HS 43700001
         DC    V(IDA019C1)                                              43710001
         L     15,*-4                                                   43750001
         AGO  .I022200                                                  43760001
.* LOCATE AND BRANCH TO CONTROL BLOCK MANIPULATION ROUTINE              43800001
.I022100 ANOP                                                  X03004HS 43850001
IDA&SYSNDX.B L     15,16                  POINT TO CVT         X03004HS 43900001
         L     15,256(,15)             POINT TO AMCBS                   43950001
         L     15,12(,15)              POINT TO CB MANIPULATION ROUTINE 44000001
.I022200 AIF   ('&BLK' EQ '').I022650  NO VALID BLKTYPE        @ZA07565 44010001
.* EITHER BLK WAS SPECIFIED OR A VALID PARAMETER IDENTIFIED BLK@ZA07565 44015001
.I022250 ANOP                          CHECK FOR GENCB         @ZA07565 44020001
&WORKA   SETA  8                       SET INDEX TO GENCB/ACB  @Z40BHCJ 44025001
         AIF  ('&CALLER' NE 'GEN').I022300                     @Z40BHCJ 44030001
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44035001
&WORKA   SETA  12                      SET INDEX TO GENCB/RPL  @Z40BHCJ 44040001
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44045001
&WORKA   SETA  16                      SET INDEX TO GENCB/EXLST@Z40BHCJ 44050001
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44055001
&WORKA   SETA  20                      SET INDEX TO GENCB/NIB  @Z40BHCJ 44060001
         AIF  ('&BLK' EQ 'NIB').I022600                        @ZA07565 44065001
.I022300 ANOP                          CHECK FOR MODCB         @Z40BHCJ 44070001
&WORKA   SETA  24                       SET INDEX TO MODCB/ACB @Z40BHCJ 44075001
         AIF  ('&CALLER' NE 'MOD').I022400                     @Z40BHCJ 44080001
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44085001
&WORKA   SETA  28                      SET INDEX TO MODCB/RPL  @Z40BHCJ 44090001
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44095001
&WORKA   SETA  32                      SET INDEX TO MODCB/EXLST@Z40BHCJ 44100001
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44105001
&WORKA   SETA  36                      SET INDEX TO MODCB/NIB  @Z40BHCJ 44110001
         AIF  ('&BLK' EQ 'NIB').I022600                        @ZA07565 44115001
.I022400 ANOP                          CHECK FOR SHOWCB        @Z40BHCJ 44120001
&WORKA   SETA  40                      SET INDEX TO SHOWCB/ACB @Z40BHCJ 44125001
         AIF  ('&CALLER' NE 'SHOW').I022500                    @Z40BHCJ 44130001
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44135001
&WORKA   SETA  44                      SET INDEX TO SHOWCB/RPL @Z40BHCJ 44140001
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44145001
&WORKA   SETA  48                      SET INDEX TO SHOWCB/EXL @Z40BHCJ 44150001
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44155001
&WORKA   SETA  52                      SET INDEX TO SHOWCB/NIB @Z40BHCJ 44160001
         AIF  ('&BLK' EQ 'NIB').I022600                        @ZA07565 44165001
.*                TESTCB CHECK                                          44199601
.I022500 ANOP                          ASSUME TESTCB           @Z40BHCJ 44237301
         AIF  ('&CALLER' NE 'TEST').I022650                    @Z40BHCJ 44247301
&WORKA   SETA  56                      SET INDEX TO TESTCB/ACB @Z40BHCJ 44249801
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44269801
&WORKA   SETA  60                      SET INDEX TO TESTCB/RPL @Z40BHCJ 44273801
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44277801
&WORKA   SETA  64                      SET INDEX TO TESTCB/EXL @Z40BHCJ 44281801
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44285801
&WORKA   SETA  68                      SET INDEX TO TESTCB/NIB @Z40BHCJ 44289801
.I022600 ANOP                          BUILD BRANCH INSTRUCTION@Z40BHCJ 44298601
         BAL   14,&WORKA.(,15)         BRANCH TO ROUTINE       @Z40BHCJ 44299001
         MEXIT                                                 @Z40BHCJ 44299401
.*****************************************************         @Z40BHCJ 44299501
.* DON'T KNOW CALLER OR BLKTYPE SO USE OLD INTERFACE *         @Z40BHCJ 44299601
.*****************************************************         @Z40BHCJ 44299701
.I022650 ANOP                                                  @Z40BHCJ 44304601
         BAL   14,0(,15)               BRANCH TO ROUTINE       @ZA07565 44306601
         MEXIT                                                 @Z40BHCJ 44308601
.**********************************************                @Z40BHCJ 44309701
.*  REGISTER FORM CODE GENERATION             *                @Z40BHCJ 44314601
.**********************************************                @Z40BHCJ 44319501
.I022700 ANOP                                                  @Z40BHCJ 44319701
&I       SETA  2                                               @Z40BHCJ 44329701
         AIF   (&IDACB04(&I) NE &AN1).I022800  NOT REGISTER    @Z40BHCJ 44339701
         AIF   ('&IDACB05(&I)' EQ '1').I023100  REGISTER1      @Z40BHCJ 44343701
&LABEL   LR    1,&IDACB05(&I)          POINT TO RPL            @ZA10861 44347701
         AGO   .I023110                                        @Z40BHCJ 44351701
.I022800 AIF   (&IDACB04(&I) NE &AN2).I022900 NOT S-TYPE ADCON @Z40BHCJ 44355701
&LABEL   DC    X'4110'                 POINT TO                @ZA10861 44359701
         DC    S(&IDACB05(&I))         RPL                     @Z40BHCJ 44363701
         AGO   .I023110                                        @Z40BHCJ 44367701
.I022900 AIF  (&IDACB04(&I) NE &AN3).I023000 NOT INDIRECT ADDR @Z40BHCJ 44371701
&LABEL   DC    X'4110'                 POINT TO                @ZA10861 44375701
         DC    S(&IDACB05(&I))         ADDRESS OF RPL          @Z40BHCJ 44379701
         L     1,0(,1)                 POINT TO RPL            @Z40BHCJ 44383701
         AGO   .I023110                                        @ZA10861 44387701
.I023000 ANOP                          DIRECT ADDRESS          @Z40BHCJ 44391701
&LABEL   LA    1,&IDACB05(&I)          POINT TO RPL            @ZA10884 44395701
         AGO   .I023110                                        @ZA10884 44399701
.I023100 ANOP                          RPL IN REGISTER 1       @Z40BHCJ 44403701
&LABEL   DS    0H                                              @ZA10861 44407701
.I023110 AIF  ('&CALLER' NE 'MOD').I023600                     @Z40BHCJ 44411701
         IDACB1 ARG=&RECLEN,ARGNAME=RECLEN                     @Z40BHCJ 44415701
         AIF   (&IDACB11 NE &AN1).I023300  RECLEN NOT IN REG   @Z40BHCJ 44419701
         AIF   ('&IDACB13' EQ '0').I023600                     @Z40BHCJ 44423701
         LR    0,&IDACB13              LOAD RECLEN             @Z40BHCJ 44427701
         AGO   .I023600                                        @Z40BHCJ 44431701
.I023300 AIF   (&IDACB11 NE &AN2).I023400  NOT S-TYPE ADCON    @Z40BHCJ 44435701
         DC    X'4100'                 LOAD REGISTER 0         @ZA25133 44439740
         DC    S(&IDACB13)             WITH RECLEN             @Z40BHCJ 44443740
         AGO   .I023600                                        @Z40BHCJ 44447740
.I023400 AIF   (&IDACB11 NE &AN3).I023500  NOT INDIRECT ADDR   @Z40BHCJ 44451740
         DC    X'41F0'                 POINT TO                @ZA25133 44455740
         DC    S(&IDACB13)             ADDRESS OF RECLEN       @ZA25133 44459840
         L     0,0(,15)                POINT TO RECLEN         @Z40BHCJ 44472301
         AGO   .I023600                                        @Z40BHCJ 44472701
.I023500 ANOP                                                  @Z40BHCJ 44472801
         CNOP  0,4                     ALIGN TO WORD BOUNDARY           44472901
         B     *+8                     BRANCH AROUND CONSTANT  @Z40BHCJ 44474901
         DC    AL4(&IDACB13)           RECLEN                  @Z40BHCJ 44476901
         L     0,*-4                   LOAD RECLEN             @Z40BHCJ 44478901
.I023600 ANOP                                                  @Z40BHCJ 44481701
         AIF   (NOT(&IDABUG)).I023700                          @Z40BHCJ 44481801
         CNOP  0,4                     ALIGN TO WORD BOUNDRY   @Z40BHCJ 44481901
         B     *+8                     BRANCH AROUND ADCON     @Z40BHCJ 44482001
         DC    V(IDA019C1)             ADDRESS OF IDA019C1     @Z40BHCJ 44482101
         L     15,*-4                  POINT TO ROUTINE        @Z40BHCJ 44482801
         AGO   .I023800                                        @Z40BHCJ 44484801
.I023700 ANOP                                                  @Z40BHCJ 44485001
         L     15,16                   POINT TO CVT            @Z40BHCJ 44485801
         L     15,256(,15)             POINT TO AMCBS          @Z40BHCJ 44486601
         L     15,12(,15)              POINT TO ROUTINE        @Z40BHCJ 44487401
.I023800 ANOP                                                  @Z40BHCJ 44487801
         AIF  ('&CALLER' NE 'MOD').I023900                     @Z40BHCJ 44488201
         BAL   14,80(,15)              BRANCH TO ROUTINE       @Z40BHCJ 44489001
         MEXIT                                                 @Z40BHCJ 44491001
.I023900 ANOP                                                  @Z40BHCJ 44496301
         BAL   14,76(,15)               BRANCH TO ROUTINE      @Z40BHCJ 44496701
         AIF  (&IDACB04(3) NE &AN1).I024000                    @Z40BHCJ 44498301
         ST    0,0(,&IDACB05(3))        STORE RECLEN IN AREA   @Z40BHCJ 44498701
         MEXIT                                                 @Z40BHCJ 44499101
.I024000 AIF  (&IDACB04(3) NE &AN2).I024100                    @Z40BHCJ 44499501
         DC    X'5000'                  STORE RECLEN           @Z40BHCJ 44549501
         DC    S(&IDACB05(3))           IN AREA                @Z40BHCJ 44559501
         MEXIT                                                 @Z40BHCJ 44569501
.I024100 ANOP                                                  @Z40BHCJ 44579501
         AIF  (&IDACB04(3) NE &AN3).I024200                    @Z40BHCJ 44589501
         L     1,&IDACB05(3)            LOAD ADDRESS OF AREA   @Z40BHCJ 44591501
         ST    0,0(,1)                  STORE RECLEN IN AREA   @Z40BHCJ 44593501
         MEXIT                                                 @Z40BHCJ 44593901
.I024200 ANOP                                                  @Z40BHCJ 44597501
         ST    0,&IDACB05(3)            STORE ADDRESS IN AREA  @Z40BHCJ 44597901
         MEND                                                  @Z40BHCJ 44599501
