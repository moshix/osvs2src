         MACRO                                                          00050038
         IDACBACB &AM=,&MF=,&CALLER=,                                  C00100038
               &ACBLEN=,&ATRB=,&AVSPAC=,&BUFND=,   *** ACB KEYWORDS ***C00150038
               &BUFNI=,&BUFNO=,&BUFSP=,&CINV=,&DDNAME=,&ENDRBA=,       C00200038
               &ERROR=,&EXLST=,&FS=,&KEYLEN=,&LRECL=,                  C00250038
               &MACRF=,&NCIS=,&NDELR=,&NEXCP=,&NEXT=,&NINSR=,&NIXL=,   C00300038
               &NLOGR=,&NRETR=,&NSSS=,&NUPDR=,&OFLAGS=,&PASSWD=,&RKP=, C00350038
               &BSTRNO=,&CRA=,&OPENOBJ=,&AIXRKP=,               X04SVHSC00400038
               &MAREA=,&MLEN=,&JFCB=,                          @XM01140*00410038
               &USERPTR=,                                      @XM01129*00420038
               &STRNO=,&STMST=,&CATALOG=,&APPLID=                       00450038
.*                                                                      00460038
.*       CHANGE LEVEL = 0                                               00470038
.*       DATE OF LAST CHANGE = 5 FEB 79 ( 79*036 )             @ZA38002 00480040
.*                                                                      00500038
.* FUNCTION    THIS MACRO ACTS AS A CONTROLLER FOR GENCB, MODCB, AND    00510038
.*             TESTCB FOR PROCESSING AN ACB.                            00560038
.*             IT IS CALLED BY IDACB2 TO BUILD VARIOUS ARRAYS TO BE     00610038
.*             USED BY IDACB2 TO BUILD A PARAMETER LIST OF ARGUMENT     00660038
.*             CONTROL ENTRIES THAT WILL BE PASSED TO THE CONTROL       00710038
.*             BLOCK MANIPULATION MODULE AT EXECUTE TIME.               00760038
.*             FOR NON-BIT KEYWORDS, THIS MACRO CALLS IDACB3 WHICH      00810038
.*             ACTUALLY SETS VALUES INTO ALL THE ARRAYS THAT ARE        00860038
.*             REQUIRED.                                                00910038
.*                                                                      00920038
.*             FOR BIT KEYWORDS, IDACB3 IS CALLED, BUT THIS MACRO       00930038
.*             SETS THE VALUE IN THE &IDAVALC ARRAY.                    00960038
.*             IT ALSO VALIDITY CHECKS BIT OPTIONS AND IF MUTUALLY      01010038
.*             EXCLUSIVE OPTIONS ARE SPECIFIED, AN ERROR MESSAGE IS     01060038
.*             ISSUED.                                                  01110038
.*                                                                      01120038
.*             IT IS ALSO CALLED BY THE ACB DECLARATIVE MACRO TO        01130038
.*             PROCESS THE BIT KEYWORDS MACRF, CATALOG, AND CRA.        01140038
.*             WHEN CALLED BY ACB, DIFFERENT GLOBALS ARE SET THAN       01150038
.*             THOSE USED BY THE CBMM. THESE GLOBALS ARE SET IN SUCH    01160038
.*             A MANNER TO ALLOW THE DECLARATIVE MACRO TO GENERATE      01170038
.*             A 'DC' USING THE GLOBALS DIRECTLY.                       01172038
.* GLOBALS                                                              01180038
         GBLB  &IDACB01                ERROR INDICATOR                  01200038
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               01250038
         GBLA  &IDAELEN(50)            ELEMENT FIELD LENGTH ARRAY       01300038
         GBLC  &IDAVALC(50)            ELEMENT CHARACTER VALUE ARRAY    01450038
         GBLC  &IDAMAC1,&IDAMAC2,&IDAMAC3                       X04SVHS 01452038
.*             MACRF VALUES FOR ACB DECLARATIVE MACRO           X04SVHS 01454038
         GBLC  &IDAIFL1                 CATALOG/CRA VALUES FOR  X04SVHS 01456038
.*                                      ACB DECLARATIVE MACRO   X04SVHS 01458038
.* LOCALS                                                               01460038
         LCLA  &I,&A,&B,&C                       WORK VARIABLES         01500038
         LCLB  &ESDS,&KSDS,&WCK,&SSWD,&REPL      ATRB CODES             01550038
         LCLB  &RRDS,&SPAN,&UNQ                  ATRB CODES     X04SVHS 01600038
         LCLB  &PATH,&BASE,&OAIX                 OPENOBJ CODES  X04SVHS 01650038
         LCLB  &SCRA,&UCRA                       CRA CODES      X04SVHS 01700038
         LCLB  &MKEY,&MADR,&MCNV,&MSEQ,&MSKP     MACRF CODES            01750038
         LCLB  &MDIR,&IN,&OUT,&NUB,&UBF          MACRF CODES            01800038
         LCLB  &LOGONF,&NLOGON                   MACRF CODES     X03004 01900038
         LCLB  &NFX,&CFX,&RST,&NRS,&DDN,&DSN     MACRF CODES   @XM01125 01950038
         LCLB  &NRM,&AIX,&NSR,&LSR,&GSR          MACRF CODES    X04SVHS 02000038
         LCLB  &NCI,&ICI,&NDF,&DFR,&NIS,&SIS     MACRF CODES    X04SVHS 02050038
         LCLB  &OPEN                             OFLAGS CODE    X04SVHS 02060038
         LCLB  &VSAM,&VTAM                       AM CODES        X03004 02100038
         LCLB  &YES,&NO                          CATALOG CODES  X04SVHS 02110038
         LCLC  &Z16                     UNUSED PORTION OF BIT STRING    02150038
.* INITIALIZATION                                                       02160038
&Z16     SETC  '0000000000000000'       SET TO 16 ZEROES                02170038
.* SCAN ACB KEYWORDS ************************************************** 02200038
.*                                      BUFND                           02220038
         IDACB3 ARG=&BUFND,ARGNAME=BUFND,KWTC=X'04',MF=&MF      X04SVHS 02250038
.********************************************************************** 02260038
.*                                      BUFNI                   X04SVHS 02300038
         IDACB3 ARG=&BUFNI,ARGNAME=BUFNI,KWTC=X'05',MF=&MF      X04SVHS 02550038
.********************************************************************** 02560038
.*                                      BUFSP                   X04SVHS 02600038
         IDACB3 ARG=&BUFSP,ARGNAME=BUFSP,KWTC=X'07',MF=&MF      X04SVHS 02850038
.********************************************************************** 02860038
.*                                      DDNAME                          02900038
         AIF   ('&DDNAME' EQ '').A000300  *** DDNAME ***                03150038
         AIF   ('&DDNAME(1)' EQ '*').A000200                            03350038
.*             IF INDIRECT ADDRESS SPECIFIED, BYPASS VALIDITY CHECKS    03400038
         AIF   (K'&DDNAME GT 8).A000100                        @ZA38002 03800040
         AIF   (('&DDNAME'(1,1) LT 'A' OR '&DDNAME'(1,1) GT 'Z') AND   C03820040
               ('&DDNAME'(1,1) NE '#' AND '&DDNAME'(1,1) NE '@' AND    C03840040
               '&DDNAME'(1,1) NE '$')).A000100                 @ZA38002 03860040
.*             DDNAME MUST BE 8 OR FEWER CHARS, AND FIRST CHAR MUST     03880040
.*                             BE ALPHABETIC OR NATIONAL       @ZA38002 03900040
         AGO   .A000200                                                 04000038
.A000100 IDAERMAC 3,DDNAME,&DDNAME      ISSUE ERROR MESSAGE             04050038
&IDACB01 SETB  1                        SET ERROR SWITCH                04100038
         AGO   .A000300                 SKIP PROCESSING                 04102038
.A000200 ANOP                                                           04110038
         IDACB3 ARG=&DDNAME,ARGNAME=DDNAME,KWTC=X'09',MF=&MF,          *04120038
               INDRECT=YES                                      X04SVHS 04130038
&IDAELEN(&IDAENO) SETA 8                ELEMENT LENGTH IS 8 BYTES       04140038
.********************************************************************** 04140438
.A000300 ANOP                                                           04142038
.*                                      EXLST                           04144038
         IDACB3 ARG=&EXLST,ARGNAME=EXLST,KWTC=X'0C',MF=&MF      X04SVHS 04150038
.********************************************************************** 04152038
.*                                      JFCB                   @XM01140 04156038
         IDACB3 ARG=&JFCB,ARGNAME=JFCB,KWTC=X'8D',MF=&MF       @XM01140 04158038
.********************************************************************** 04160038
.*                                      CATALOG                         04200038
         AIF   ('&CATALOG' EQ '').A000500 *** CATALOG ***               04450038
         IDACB3 ARG=&CATALOG,ARGNAME=CATALOG,KWTC=X'22',MF=&MF,        *04600038
               INDRECT=YES,BIT=YES                              X04SVHS 04650038
         AIF   ('&CATALOG(1)' EQ '*').A000500                   X04SVHS 04660038
.*             IF INDIRECT ADDRESS SPECIFIED, VALUE ARRAY(&IDAVALC)     04670038
.*                                      WAS SET IN IDACB3               04680038
&YES     SETB  ('&CATALOG' EQ 'YES')                            X04SVHS 04700038
&NO      SETB  ('&CATALOG' EQ 'NO')                             X04SVHS 04750038
         AIF   (&YES OR &NO).A000400                            X04SVHS 04800038
         IDAERMAC 3,CATALOG,&CATALOG  ISSUE ERROR MESSAGE       X04SVHS 04850038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 04860038
.A000400 ANOP                                                   X04SVHS 04880038
         AIF   ('&CALLER' EQ 'ACB').A000500                     X04SVHS 04890038
.*             IF CALLER IS ACB, VALUE WILL BE SET IN CRA RTN   X04SVHS 04892038
&IDAVALC(&IDAENO) SETC '&YES&NO.00000000000000&Z16'             X04SVHS 04900038
.********************************************************************** 04910038
.*                                      MACRF                           04950038
.A000500 AIF   ('&MACRF' EQ '').A001750   *** MACRF ***         X04SVHS 05500038
         IDACB3 ARG=&MACRF,ARGNAME=MACRF,KWTC=X'12',MF=&MF,BIT=YES,    *05550038
               INDRECT=YES                                      X04SVHS 05600038
         AIF   ('&MACRF(1)' EQ '*').A001800                             05650038
.*             IF INDIRECT ADDRESS SPECIFIED, VALUE ARRAY(&IDAVALC)     05700038
.*                                      WAS SET IN IDACB3               05750038
&I       SETA  0                        CLEAR                   X04SVHS 06200038
&A       SETA  0                        WORK                    X04SVHS 06210038
&B       SETA  0                        VARIABLES               X04SVHS 06220038
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 06270038
.A000600 ANOP                                                           06322238
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 06336138
         AIF   (&I GT N'&MACRF).A000800 HAVE ALL OPTIONS BEEN CHECKED   06350038
&MKEY    SETB  ('&MACRF(&I)' EQ 'KEY' OR &MKEY)                 X04SVHS 06400038
&MADR    SETB  ('&MACRF(&I)' EQ 'ADR' OR &MADR)                 X04SVHS 06450038
&MCNV    SETB  ('&MACRF(&I)' EQ 'CNV' OR &MCNV)                 X04SVHS 06500038
&MSEQ    SETB  ('&MACRF(&I)' EQ 'SEQ' OR &MSEQ)                 X04SVHS 06550038
&MSKP    SETB  ('&MACRF(&I)' EQ 'SKP' OR &MSKP)                 X04SVHS 06600038
&MDIR    SETB  ('&MACRF(&I)' EQ 'DIR' OR &MDIR)                 X04SVHS 06650038
&OUT     SETB  ('&MACRF(&I)' EQ 'OUT' OR &OUT)                  X04SVHS 06700038
&IN      SETB  ('&MACRF(&I)' EQ 'IN' OR &IN)                    X04SVHS 06750038
&NUB     SETB  ('&MACRF(&I)' EQ 'NUB' OR &NUB)                  X04SVHS 06800038
&UBF     SETB  ('&MACRF(&I)' EQ 'UBF' OR &UBF)                  X04SVHS 06850038
&NFX     SETB  ('&MACRF(&I)' EQ 'NFX' OR &NFX)                  X04SVHS 06900038
&CFX     SETB  ('&MACRF(&I)' EQ 'CFX' OR &CFX)                  X04SVHS 06950038
&DDN     SETB  ('&MACRF(&I)' EQ 'DDN' OR &DDN)                  X04SVHS 07050038
&DSN     SETB  ('&MACRF(&I)' EQ 'DSN' OR &DSN)                  X04SVHS 07100038
&NRM     SETB  ('&MACRF(&I)' EQ 'NRM' OR &NRM)                  X04SVHS 07150038
&AIX     SETB  ('&MACRF(&I)' EQ 'AIX' OR &AIX)                  X04SVHS 07200038
&NSR     SETB  ('&MACRF(&I)' EQ 'NSR' OR &NSR)                  X04SVHS 07250038
&LSR     SETB  ('&MACRF(&I)' EQ 'LSR' OR &LSR)                  X04SVHS 07300038
&GSR     SETB  ('&MACRF(&I)' EQ 'GSR' OR &GSR)                  X04SVHS 07350038
&NCI     SETB  ('&MACRF(&I)' EQ 'NCI' OR &NCI)                  X04SVHS 07400038
&ICI     SETB  ('&MACRF(&I)' EQ 'ICI' OR &ICI)                  X04SVHS 07450038
&NDF     SETB  ('&MACRF(&I)' EQ 'NDF' OR &NDF)                  X04SVHS 07500038
&DFR     SETB  ('&MACRF(&I)' EQ 'DFR' OR &DFR)                  X04SVHS 07550038
&NIS     SETB  ('&MACRF(&I)' EQ 'NIS' OR &NIS)                  X04SVHS 07600038
&SIS     SETB  ('&MACRF(&I)' EQ 'SIS' OR &SIS)                  X04SVHS 07650038
&RST     SETB  ('&MACRF(&I)' EQ 'RST' OR &RST)                 @XM01125 07652038
&NRS     SETB  ('&MACRF(&I)' EQ 'NRS' OR &NRS)                 @XM01125 07654038
&A       SETA  &MKEY+&MADR+&MCNV+&MSEQ+&MSKP+&MDIR+&OUT+&IN+&NUB+&UBF+&*07660038
               NFX+&CFX+&DDN+&DSN+&NRM+&AIX+&NSR+&LSR+&GSR+&NCI+&ICI+&N*07670038
               DF+&DFR+&NIS+&SIS+&RST+&NRS                     @XM01125 07680038
.*             &A CONTAINS THE NUMBER OF VSAM OPTIONS SPECIFIED         07682038
.*             &B CONTAINS THE NUMBER OF VTAM OPTIONS SPECIFIED         07684038
.*             &C CONTAINS THE NUMBER OF ERRORS                         07684438
.*             IF THEY EQUAL &I AT THIS POINT, THEN THE LAST            07686038
.*             OPTION SPECIFIED WAS A VALID VSAM OPTION                 07688038
         AIF   (&A+&B+&C EQ &I).A000600 IF NEW VSAM BIT SET CHK X04SVHS 07690038
.*                                      NEXT SUBPARAMETER               07692038
.*                                      ELSE CHECK VTAM OPTIONS X04SVHS 07694038
&LOGONF  SETB  ('&MACRF(&I)' EQ 'LOGON' OR &LOGONF)              X03004 07700038
&NLOGON  SETB  ('&MACRF(&I)' EQ 'NLOGON' OR &NLOGON)             X03004 07750038
&B       SETA  &LOGONF+&NLOGON                                  X04SVHS 07760038
         AIF   (&A+&B+&C EQ &I).A000700 IF NEW VTAM BIT SET CHK X04SVHS 07770038
.*                                      FOR AM=VTAM             X04SVHS 07780038
.*             IF &A + &B + &C DO NOT EQUAL &I AT THIS POINT, THEN THE  07790038
.*             LAST OPTION CHECKED WAS INVALID OR DUPLICATED A          07792038
.*             PREVIOUSLY CHECKED OPTION                                07794038
         IDAERMAC 5,MACRF,&MACRF(&I)    ISSUE ERROR MESSAGE     X04SVHS 07800038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 07850038
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 07860038
         AGO   .A000600                                                 07900038
.A000700 AIF   ('&AM' EQ 'VTAM').A000600 IF VTAM NOT SPECIFIED,         08200038
         IDAERMAC 20,&MACRF(&I),MACRF    ISSUE ERROR MESSAGE     X03004 08250038
&IDACB01 SETB  1                         SET ERROR SWITCH        X03004 08300038
         AGO   .A000600                  CHECK NEXT OPTION      X04SVHS 08350038
.*                                                                      08360038
.*             THE FOLLOWING CODE CHECKS FOR MUTUALLY EXCLUSIVE         08370038
.*             OPTIONS SPECIFIED,AND IF ANY ARE FOUND, AN ERROR         08380038
.*             MESSAGE IS ISSUED AND THE ERROR SWITCH IS SET            08390038
.A000800 AIF   (NOT(&UBF AND &NUB)).A000900                     X04SVHS 08400038
         IDAERMAC 8,MACRF,UBF,NUB                                       08450038
&IDACB01 SETB  1                                                        08500038
.A000900 AIF   (NOT(&LOGONF AND &NLOGON)).A001000               X04SVHS 08550038
         IDAERMAC 8,MACRF,LOGON,NLOGON                           X03004 08600038
&IDACB01 SETB  1                                                 X03004 08650038
.A000950 AIF   (NOT(&RST AND &NRS)).A001000                    @XM01125 08660038
         IDAERMAC 8,MACRF,RST,NRS                              @XM01125 08670038
&IDACB01 SETB  1                        SET ERR SWITCH         @XM01125 08680038
.A001000 AIF   (NOT(&NFX AND &CFX)).A001100                     X04SVHS 08700038
         IDAERMAC 8,MACRF,NFX,CFX                               X04SVHS 08750038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 08800038
.A001100 AIF   (NOT(&DDN AND &DSN)).A001200                     X04SVHS 08850038
         IDAERMAC 8,MACRF,DDN,DSN                               X04SVHS 08900038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 08950038
.A001200 AIF   (NOT(&NRM AND &AIX)).A001300                     X04SVHS 09000038
         IDAERMAC 8,MACRF,NRM,AIX                               X04SVHS 09050038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09100038
.A001300 AIF   ((NOT(&NSR AND &GSR)) AND (NOT(&GSR AND &LSR)) AND      *09150038
               (NOT(&LSR AND &NSR))).A001400                    X04SVHS 09200038
         IDAERMAC 25,MACRF,&NSR,&LSR,&GSR                       X04SVHS 09250038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09300038
.A001400 AIF   (NOT(&NCI AND &ICI)).A001500                     X04SVHS 09350038
         IDAERMAC 8,MACRF,NCI,ICI                               X04SVHS 09400038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 09450038
.A001500 AIF   (NOT(&NDF AND &DFR)).A001600                     X04SVHS 09500038
         IDAERMAC 8,MACRF,NDF,DFR                               X04SVHS 09550038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09600038
.A001600 AIF   (NOT(&NIS AND &SIS)).A001700                     X04SVHS 09650038
         IDAERMAC 8,MACRF,NIS,SIS                               X04SVHS 09700038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09750038
.A001700 ANOP                                                   X04SVHS 09800038
         AIF   ('&CALLER' EQ 'ACB').A001750                     X04SVHS 09810038
.*             IF CALLED BY DECLARATIVE, BYPASS CBMM PROCESSING         09820038
.*                                                                      09830038
&IDAVALC(&IDAENO) SETC '&MKEY&MADR&MCNV&MSEQ&MSKP&MDIR&IN&OUT&NUB&UBF&L*09850038
               OGONF&NLOGON.0&DDN&DSN&NRM&AIX&NSR&LSR&GSR&NCI&ICI&NDF&D*09900038
               FR&NIS&SIS&NFX&CFX&RST&NRS.00'                  @XM01139 09950038
.*             SET GLOBAL ARRAY TO BE USED BY IDACB2 TO BUILD           09952038
.*             PARAMETER LIST                                           09954038
         AGO   .A001800                 BYPASS DECLARATIVE PROC X04SVHS 09960038
.A001750 ANOP                                                   X04SVHS 09962038
         AIF   ('&CALLER' NE 'ACB').A001800                     X04SVHS 09962138
.*             THE FOLLOWING CODE SETS DEFAULT VALUES FOR ACB           09962438
.*             DECLARATIVE.  THE DEFAULTS FOR CBM WILL BE SET AT        09962838
.*             EXECUTE TIME.                                            09963238
.*                                                                      09963638
&MKEY    SETB  (NOT(&MADR OR &MCNV) OR &MKEY)                   X04SVHS 09963738
.*             MKEY IS DEFAULT IF MADR OR MCNV ARE NOT SPECIFIED        09963838
&MSEQ    SETB  (NOT(&MSKP OR &MDIR) OR &MSEQ)                   X04SVHS 09963938
.*             MSEQ IS DEFAULT IF MSKP OR MDIR ARE NOT SPECIFIED        09965938
&IN      SETB  (NOT(&OUT) OR &IN)                               X04SVHS 09967938
.*             IN IS DEFAULT IF OUT IS NOT SPECIFIED            X04SVHS 09968038
.*                                                                      09968138
.*             SET MACRF VALUES IN GLOBALS FOR ACB DECLARATIVE  X04SVHS 09968438
&IDAMAC1 SETC  '&MKEY&MADR&MCNV&MSEQ&MDIR&IN&OUT&UBF'           X04SVHS 09970038
&IDAMAC2 SETC  '000&MSKP&NLOGON&RST&DSN&AIX'                    X04SVHS 09972038
&IDAMAC3 SETC  '0&LSR&GSR&ICI&DFR&SIS&CFX.0'                    X04SVHS 09974038
         AGO   .A002200                 PROCESS CRA             X04SVHS 09976038
.********************************************************************** 09976438
.A001800 ANOP                                                   X04SVHS 09978038
.*                                      PASSWD                          09980038
         IDACB3 ARG=&PASSWD,ARGNAME=PASSWD,KWTC=X'1E',MF=&MF    X04SVHS 10000038
.********************************************************************** 10010038
.*                                      STRNO                           10050038
         IDACB3 ARG=&STRNO,ARGNAME=STRNO,KWTC=X'20',MF=&MF      X04SVHS 10100038
.********************************************************************** 10150038
.*                                      USERPTR                @XM01129 10200038
         AIF ('&USERPTR' EQ '' OR '&USERPTR' EQ '0').A001850   @XM01129 10220038
         IDACB3 ARG=&USERPTR,ARGNAME=USERPTR,KWTC=X'8C',MF=&MF @XM01129 10230038
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '').A001825       @XM01129 10240038
.*                                   IF AM NOT VSAM OR NULL, ERROR      10250038
         AGO   .A001850                                        @XM01129 10260038
.A001825 IDAERMAC 24,USERPTR                                   @XM01129 10270038
&IDACB01 SETB  1                                               @XM01129 10290038
.********************************************************************** 10300038
.A001850  ANOP                                                          10310038
.*                                      APPLID                          10350038
         IDACB3 ARG=&APPLID,ARGNAME=APPLID,KWTC=X'41',MF=&MF,          *10400038
               CHKAM=VTAM,AM=&AM                                X04SVHS 10450038
.********************************************************************** 10452038
.*                                       AM                             10460038
         AIF   ('&AM' EQ '' OR '&CALLER' NE 'GEN').A002000      X04SVHS 10500038
.*             ARGUMENT CONTROL ENTRY IS ONLY BUILT FOR GENCB FOR AM    10550038
         IDACB3 ARG=&AM,ARGNAME=AM,KWTC=X'40',BIT=YES           X04SVHS 10750038
&VSAM    SETB  ('&AM' EQ 'VSAM')                                X04SVHS 10800038
&VTAM    SETB  ('&AM' EQ 'VTAM')                                X04SVHS 10850038
         AIF   (&VSAM OR &VTAM).A001900                         X04SVHS 10900038
.*             CHECK FOR VALID OPTION                           X04SVHS 10910038
         IDAERMAC 5,AM,&AM                                      X04SVHS 10950038
&IDACB01 SETB  1                         SET ERROR SWITCH       X04SVHS 11000038
.A001900    ANOP                                                X04SVHS 11050038
&IDAVALC(&IDAENO) SETC '&VSAM&VTAM.00000000000000&Z16'          X04SVHS 11100038
.********************************************************************** 11110038
.A002000 ANOP                                                   X04SVHS 11150038
.*                                      MAREA                           11660038
         IDACB3 ARG=&MAREA,ARGNAME=MAREA,KWTC=X'0E',MF=&MF      X04SVHS 11750038
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '' AND '&MAREA' NE        *12000038
               '').A002050                                      X04SVHS 12010038
.*                                      IF AM NOT VSAM OR NULL  X04SVHS 12050038
.*                                      ERROR                   X04SVHS 12100038
         AGO   .A002100                                         X04SVHS 12110038
.A002050 ANOP                                                   X04SVHS 12120038
         IDAERMAC 24,MAREA                                      X04SVHS 12150038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 12200038
.********************************************************************** 12210038
.A002100 ANOP                                                   X04SVHS 12250038
.*                                        MLEN                  X04SVHS 12260038
         IDACB3 ARG=&MLEN,ARGNAME=MLEN,KWTC=X'0F',MF=&MF        X04SVHS 12350038
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '' AND '&MLEN' NE         *12600038
               '').A002150                                      X04SVHS 12610038
.*                                      IF AM NOT EQUAL TO VSAM X04SVHS 12650038
.*                                      OR NULL, ERROR          X04SVHS 12700038
         AGO   .A002200                                         X04SVHS 12710038
.A002150 ANOP                                                   X04SVHS 12720038
         IDAERMAC 24,MLEN                                       X04SVHS 12750038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 12800038
.********************************************************************** 12810038
.A002200 ANOP                                                   X04SVHS 12850038
.*                                      CRA                             13200038
         AIF   ('&CRA' EQ '').A002350 *** CRA ***               X04SVHS 13250038
.*             IF CRA IS NULL, CHECK FOR CALLER = ACB           X04SVHS 13260038
&SCRA    SETB  ('&CRA' EQ 'SCRA')                              @XM07755 13300038
&UCRA    SETB  ('&CRA' EQ 'UCRA')                              @XM07755 13350038
         AIF   (&SCRA OR &UCRA).A002300 CHK FOR VALID OPTION    X04SVHS 13400038
         IDAERMAC 5,CRA,&CRA            ISSUE ERROR MESSAGE     X04SVHS 13450038
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 13500038
         AGO   .A002400                 BYPASSING PROCESSING KEYWORD    13550038
.*                                                              X04SVHS 13560038
.A002300 ANOP                                                   X04SVHS 13600038
         AIF   ('&CALLER' EQ 'ACB').A002375                     X04SVHS 13610038
.*             IF CALLER IS ACB BYPASS CBM PROCESSING           X04SVHS 13620038
         IDACB3 ARG=&CRA,KWTC=X'59',BIT=YES                     X04SVHS 13650038
&IDAVALC(&IDAENO) SETC '&SCRA&UCRA.00000000000000&Z16'          X04SVHS 13800038
         AGO   .A002400                 BYPASS DECLARATIVE PROC X04SVHS 13810038
.A002350 ANOP                                                   X04SVHS 13820038
.*             AT THIS POINT, EITHER CRA IS NOT SPECIFIED, OR   X04SVHS 13830038
.*             CALLER = ACB                                     X04SVHS 13840038
         AIF   ('&CALLER' NE 'ACB').A002400                     X04SVHS 13842038
.*             IF CALLER NOT ACB, BYPASS DECLARATIVE PROCESSING X04SVHS 13844038
.A002375 ANOP                                                   X04SVHS 13844438
&IDAIFL1 SETC  '000&YES&SCRA&UCRA.00'   SET ACB INFLGS BYTE 1   X04SVHS 13846038
.*             ALL BIT KEYWORDS HAVE BEEN PROCESSED FOR DECLARATIVE     13848038
         MEXIT                                                  X04SVHS 13848438
.********************************************************************** 13848838
.A002400 ANOP                                                   X04SVHS 13850038
.*                                      BSTRNO                          13860038
         IDACB3 ARG=&BSTRNO,ARGNAME=BSTRNO,KWTC=X'24',MF=&MF    X04SVHS 13900038
.********************************************************************** 13950038
.*                                                                      14200038
         AIF   ('&CALLER' NE 'TEST').A003800                            14250038
.*                                                                      14252038
.*             THE FOLLOWING KEYWORDS ARE VALID FOR TESTCB ONLY         14260038
.*                                                                      14262038
.********************************************************************** 14264038
.*                                      ATRB                            14270038
         AIF   ('&ATRB' EQ '').A002800    *** ATRB ***                  14300038
         IDACB3 ARG=&ATRB,ARGNAME=ATRB,KWTC=X'01',MF=&MF,INDRECT=YES,  *14350038
               BIT=YES                                          X04SVHS 14400038
         AIF   ('&ATRB(1)' EQ '*').A002800                      X04SVHS 14450038
.*             IF INDIRECT ADDRESS WAS SPECIFIED, VALUE ARRAY(&IDAVALC) 14500038
.*             WAS SET IN IDACB3                                        14550038
&I       SETA  0                        ZERO INDEX INTO LIST            15000038
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 15010038
.A002500 ANOP                                                           15050038
&I       SETA  &I+1                     BUMP INDEX INTO LIST            15100038
         AIF   (&I GT N'&ATRB).A002600  HAVE ALL OPTIONS BEEN CHECKED   15150038
&ESDS    SETB  ('&ATRB(&I)' EQ 'ESDS' OR &ESDS)                 X04SVHS 15200038
&KSDS    SETB  ('&ATRB(&I)' EQ 'KSDS' OR &KSDS)                 X04SVHS 15250038
&WCK     SETB  ('&ATRB(&I)' EQ 'WCK' OR &WCK)                   X04SVHS 15300038
&SSWD    SETB  ('&ATRB(&I)' EQ 'SSWD' OR &SSWD)                 X04SVHS 15350038
&REPL    SETB  ('&ATRB(&I)' EQ 'REPL' OR &REPL)                 X04SVHS 15400038
&RRDS    SETB  ('&ATRB(&I)' EQ 'RRDS' OR &RRDS)                 X04SVHS 15450038
&SPAN    SETB  ('&ATRB(&I)' EQ 'SPAN' OR &SPAN)                 X04SVHS 15500038
&UNQ     SETB  ('&ATRB(&I)' EQ 'UNQ' OR &UNQ)                   X04SVHS 15550038
         AIF   (&ESDS+&KSDS+&WCK+&SSWD+&REPL+&RRDS+&SPAN+&UNQ+&C EQ &I)*15560038
               .A002500                 CHK FOR VALID OPTION    X04SVHS 15570038
.*             IF A NEW BIT WAS NOT SET, THEN LAST OPTION CHECKED       15580038
.*             IS INVALID OR DUPLICATES A PREVIOUSLY SPEC OPTION        15590038
         IDAERMAC 5,ATRB,&ATRB(&I)      ISSUE ERROR MESSAGE     X04SVHS 15600038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 15650038
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 15660038
         AGO   .A002500                                         X04SVHS 15700038
.A002600 AIF   (NOT(&ESDS AND &KSDS)).A002700                           15750038
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     15760038
         IDAERMAC 8,ATRB,ESDS,KSDS      ISSUE ERROR MESSAGE             15800038
&IDACB01 SETB  1                        SET ERROR SWITCH                15850038
.A002700 ANOP                                                           15900038
&IDAVALC(&IDAENO) SETC '&KSDS&ESDS&WCK&SSWD&REPL&RRDS&SPAN&UNQ.00000000*15950038
               &Z16'                                                    15950438
.********************************************************************** 15950838
.A002800 ANOP                                                           15952038
.*                                      AVSPAC                          15960038
         IDACB3 ARG=&AVSPAC,ARGNAME=AVSPAC,KWTC=X'02',MF=&MF    X04SVHS 16000038
.********************************************************************** 16010038
.*                                      BUFNO                           16050038
         IDACB3 ARG=&BUFNO,ARGNAME=BUFNO,KWTC=X'06',MF=&MF      X04SVHS 16300038
.********************************************************************** 16310038
.*                                      CINV                            16350038
         IDACB3 ARG=&CINV,ARGNAME=CINV,KWTC=X'08',MF=&MF        X04SVHS 16600038
.********************************************************************** 16610038
.*                                      ENDRBA                          16650038
         IDACB3 ARG=&ENDRBA,ARGNAME=ENDRBA,KWTC=X'0A',MF=&MF    X04SVHS 16900038
.********************************************************************** 16910038
.*                                      ERROR                           16950038
         IDACB3 ARG=&ERROR,ARGNAME=ERROR,KWTC=X'0B',MF=&MF      X04SVHS 17200038
.********************************************************************** 17210038
.*                                      FS                              17250038
         IDACB3 ARG=&FS,ARGNAME=FS,KWTC=X'0D',MF=&MF            X04SVHS 17500038
.********************************************************************** 17510038
.*                                      KEYLEN                          17550038
         IDACB3 ARG=&KEYLEN,ARGNAME=KEYLEN,KWTC=X'10',MF=&MF    X04SVHS 17800038
.********************************************************************** 17810038
.*                                      LRECL                           17850038
         IDACB3 ARG=&LRECL,ARGNAME=LRECL,KWTC=X'11',MF=&MF      X04SVHS 18100038
.********************************************************************** 18110038
.*                                      NCIS                            18150038
         IDACB3 ARG=&NCIS,ARGNAME=NCIS,KWTC=X'13',MF=&MF        X04SVHS 18400038
.********************************************************************** 18410038
.*                                      NDELR                           18450038
         IDACB3 ARG=&NDELR,ARGNAME=NDELR,KWTC=X'14',MF=&MF      X04SVHS 18700038
.********************************************************************** 18710038
.*                                      NEXCP                           18750038
         IDACB3 ARG=&NEXCP,ARGNAME=NEXCP,KWTC=X'15',MF=&MF      X04SVHS 19000038
.********************************************************************** 19010038
.*                                      NEXT                            19050038
         IDACB3 ARG=&NEXT,ARGNAME=NEXT,KWTC=X'16',MF=&MF        X04SVHS 19300038
.********************************************************************** 19310038
.*                                      NINSR                           19350038
         IDACB3 ARG=&NINSR,ARGNAME=NINSR,KWTC=X'17',MF=&MF      X04SVHS 19600038
.********************************************************************** 19610038
.*                                      NIXL                            19650038
         IDACB3 ARG=&NIXL,ARGNAME=NIXL,KWTC=X'18',MF=&MF        X04SVHS 19900038
.********************************************************************** 19910038
.*                                      &NLOGR                          19950038
         IDACB3 ARG=&NLOGR,ARGNAME=NLOGR,KWTC=X'19',MF=&MF      X04SVHS 20200038
.********************************************************************** 20210038
.*                                      NRETR                           20250038
         IDACB3 ARG=&NRETR,ARGNAME=NRETR,KWTC=X'1A',MF=&MF      X04SVHS 20300038
.********************************************************************** 20350038
.*                                      NSSS                            20500038
         IDACB3 ARG=&NSSS,ARGNAME=NSSS,KWTC=X'1B',MF=&MF        X04SVHS 20800038
.********************************************************************** 20810038
.*                                      NUPDR                           20850038
         IDACB3 ARG=&NUPDR,ARGNAME=NUPDR,KWTC=X'1C',MF=&MF      X04SVHS 21100038
.********************************************************************** 21110038
.*                                                                      21150038
         AIF   ('&OFLAGS' EQ '').A003000 *** OFLAGS ***                 21400038
         IDACB3 ARG=&OFLAGS,ARGNAME=OFLAGS,KWTC=X'1D',MF=&MF,BIT=YES,  *21450038
               INDRECT=YES                                      X04SVHS 21500038
         AIF   ('&OFLAGS(1)' EQ '*').A003000                            21550038
.*             IF INDIRECT ADDRESS WAS SPECIFIED, VALUE ARRAY(&IDAVALC) 21600038
.*             WAS SET IN IDACB3                                        21650038
&OPEN    SETB  ('&OFLAGS' EQ 'OPEN')                            X04SVHS 22000038
         AIF   (&OPEN).A002900                                  X04SVHS 22010038
.*             CHECK FOR VALID OPTION SPECIFIED                         22020038
         IDAERMAC 3,OFLAGS,&OFLAGS                                      22050038
&IDACB01 SETB  1                                                        22100038
.A002900 ANOP                                                           22200038
&IDAVALC(&IDAENO) SETC '&OPEN.000000000000000&Z16'              X04SVHS 22300038
.********************************************************************** 22300438
.A003000 ANOP                                                   X04SVHS 22302038
.*                                      RKP                             22310038
         IDACB3 ARG=&RKP,ARGNAME=RKP,KWTC=X'1F',MF=&MF          X04SVHS 22350038
.********************************************************************** 22360038
.*                                      AIXRKP                          22400038
         IDACB3 ARG=&AIXRKP,ARGNAME=AIXRKP,KWTC=X'3C',MF=&MF    X04SVHS 22650038
.********************************************************************** 22700038
.*                                      STMST                           22750038
         AIF   ('&STMST' EQ '').A003300  *** STMST ***                  22950038
         AIF   ('&STMST(1)' EQ '*').A003100                             23050038
.*                                      STMST MUST BE INDIRECT ADDRESS  23060038
         IDAERMAC 3,STMST,&STMST        ELSE, ISSUE ERROR MESSAGE       23100038
         AGO   .A003300                                                 23150038
.A003100 ANOP                                                           23160038
         IDACB3 ARG=&STMST,ARGNAME=STMST,KWTC=X'23',MF=&MF,INDRECT=YES  23200038
.*                                                              X04SVHS 23250038
&IDAELEN(&IDAENO) SETA 8                                        X04SVHS 23500038
.********************************************************************** 23550038
.*                                      OPENOBJ                         23600038
.A003300 ANOP                                                   X04SVHS 23850038
         AIF   ('&OPENOBJ' EQ '').A003800 *** OPENOBJ ***       X04SVHS 23900038
&I       SETA  0                        CLEAR SUBPARM CTR       X04SVHS 23950038
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 23960038
.A003400 ANOP                                                   X04SVHS 24000038
&I       SETA  &I+1                     BUMP SUBPARM CTR        X04SVHS 24050038
         AIF   (&I GT N'&OPENOBJ).A003500 CHK FOR END OF LIST   X04SVHS 24100038
&PATH    SETB  ('&OPENOBJ(&I)' EQ 'PATH' OR &PATH)              X04SVHS 24150038
&BASE    SETB  ('&OPENOBJ(&I)' EQ 'BASE' OR &BASE)              X04SVHS 24200038
&AIX     SETB  ('&OPENOBJ(&I)' EQ 'AIX' OR &AIX)                X04SVHS 24250038
         AIF   (&PATH+&BASE+&AIX+&C EQ &I).A003400              X04SVHS 24300038
.*                                      CHK FOR NEW BIT SET     X04SVHS 24350038
         IDAERMAC 5,OPENOBJ,&OPENOBJ(&I)                        X04SVHS 24400038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 24450038
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 24460038
         AGO   .A003400                                         X04SVHS 24500038
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS             X04SVHS 24510038
.A003500 AIF   (NOT(&PATH AND &BASE)).A003600                   X04SVHS 24550038
         IDAERMAC 8,OPENOBJ,PATH,BASE                           X04SVHS 24600038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 24650038
.A003600 AIF   (NOT(&PATH AND &AIX)).A003700                    X04SVHS 24700038
         IDAERMAC 8,OPENOBJ,PATH,AIX                            X04SVHS 24750038
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 24800038
.A003700 ANOP                                                   X04SVHS 24850038
         IDACB3 ARG=&OPENOBJ,KWTC=X'21',BIT=YES                 X04SVHS 24900038
&IDAVALC(&IDAENO) SETC '&AIX&PATH&BASE.0000000000000&Z16'      @XM07772 25050038
.********************************************************************** 25060038
.A003800 ANOP                                                   X04SVHS 25100038
         MEND                                                           25700038
