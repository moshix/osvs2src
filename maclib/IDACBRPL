         MACRO                                                          00050001
         IDACBRPL &AM=,&MF=,&CALLER=,                                  C00100001
               &ACB=,&AREA=,&AREALEN=,&ARG=,&ECB=, *** RPL KEYWORDS ***C00150001
               &FDBK=,&MSGAREA=,&MSGLEN=,&NXTRPL=,&OPTCD=,&KEYLEN=,    C00200001
               &RBA=,&RECLEN=,&IO=,&RPLLEN=,&AAREA=,&AAREALN=,   X03004C00250001
               &ARECLEN=,&EXIT=,&NIB=,                          X04SVHSC00300001
               &BRANCH=,&USER=,&RTNCD=,&FDBK2=,&SENSE=,          X03004C00350001
               &REQ=,&DATAFLG=,                                  X03004C00400001
               &TRANSID=,&AIXPC=,&FTNCD=,&AIXFLAG=,             X04SVHSC00450001
               &CHNGDIR=,&STYPE=,&RTYPE=,&CHAIN=,&POST=,        X3004BSC00500001
               &RESPOND=,&CONTROL=,&OBSQAC=,&IBSQAC=,           X3004BSC00550001
               &OBSQVAL=,&IBSQVAL=,&SEQNO=,&SSENSEO=,           X3004BSC00600001
               &SSENSEI=,&USENSEO=,&USENSEI=,                  @Z40BHUCC00650001
               &BRACKET=,&SSENSMO=,&SSENSMI=,                          C00700001
               &SIGDATA=,&CODESEL=,                            @Z40BHUCC00702048
               &CRYPT=                                         @G40AKSL 00722000
.*                                                                      00750001
.* FUNCTION    THIS MACRO ACTS AS A CONTROLLER FOR GENCB, MODCB, AND    00800001
.*             TESTCB FOR PROCESSING AN RPL.                            00850001
.*             IT IS CALLED BY IDACB2 TO BUILD VARIOUS ARRAYS TO BE     00900001
.*             USED BY THAT MACRO TO BUILD A PARAMETER LIST OF ARGUMENT 00950001
.*             CONTROL ENTRIES THAT WILL BE PASSED TO THE CONTROL       01000001
.*             BLOCK MANIPULATION MODULE AT EXECUTE TIME.               01050001
.*             FOR NON-BIT KEYWORDS, THIS MACRO CALLS IDACB3 WHICH      01100001
.*             SETS VALUES INTO ALL THE ARRAYS THAT ARE REQUIRED.       01150001
.*                                                                      01250001
.*             FOR BIT KEYWORDS, IDACB3 IS CALLED, BUT THIS MACRO       01300001
.*             SETS THE VALUE IN THE &IDAVALC ARRAY.                    01350001
.*             IT ALSO VALIDITY CHECKS BIT OPTIONS AND IF MUTUALLY      01400001
.*             EXCLUSIVE OPTIONS ARE SPECIFIED, AN ERROR MESSAGE IS     01450001
.*             ISSUED. THE ONE EXCEPTION IS OPTCD.                      01460001
.*             IDACBOPT IS ISSUED TO PROCESS OPTCD                      01464001
.*                                                                      01470001
.*             IT IS ALSO CALLED BY THE RPL DECLARATIVE MACRO TO        01520001
.*             PROCESS THE BIT KEYWORDS OPTCD, BRANCH, POST, RESPOND,   01570001
.*             CHAIN, CONTROL, CHNGDIR, BRACKET, SSENSEO, RTYPE,        01580001
.*             STYPE, IBSQAC, AND OBSQAC.                               01590001
.*             WHEN CALLED BY RPL, DIFFERENT GLOBALS ARE SET THAN       01620001
.*             THOSE USED BY THE CBMM. THESE GLOBALS ARE SET IN SUCH    01670001
.*             A MANNER TO ALLOW THE DECLARATIVE MACRO TO GENERATE      01680001
.*             A 'DC' USING THE GLOBALS DIRECTLY.                       01690001
.*             THEREFORE THE BITS SET IN THESE GLOBALS MUST BE          01692001
.*             IDENTICAL TO THE WAY THEY WILL APPEAR WHEN THE           01694001
.*             CONTROL BLOCK IS GENERATED.                              01696001
.* GLOBALS                                                              01700001
         GBLB  &IDACB01                ERROR INDICATOR                  01710001
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               01720001
         GBLC  &IDAVALC(50)            ELEMENT CHARACTER VALUE ARRAY    01750001
.*             THE FOLLOWING GLOBALS ARE SET WHEN CALLED BY THE RPL     01752001
.*             DECLARATIVE MACRO TO SET BIT STRING KEYWORDS             01754001
         GBLC  &IDABRCH                 BRANCH CODE             X04SVHS 01756001
         GBLC  &IDASNSO                 SSENSEO CODES           X04SVHS 01756501
         GBLC  &IDARH3                  CHNGDIR/BRACKET CODES   X04SVHS 01757001
         GBLC  &IDASRTY                 STYPE/RTYPE CODES       X04SVHS 01757501
         GBLC  &IDACHN                  CHAIN CODES             X04SVHS 01758001
         GBLC  &IDAPORE                 POST/RESPOND CODES      X04SVHS 01758501
         GBLC  &IDACRYP                 ENCRIPTION FEATURE     @G40AKSL 01758700
         GBLC  &IDACON1,&IDACON2,&IDACON3 CONTROL CODES         X04SVHS 01759001
         GBLC  &IDAOBQC                 OBSQAC CODES            X04SVHS 01759501
         GBLC  &IDAIBQC                 IBSQAC CODES            X04SVHS 01759601
.* LOCALS                                                               01760001
         LCLA  &I,&A                             WORK VARIABLES X04SVHS 01800001
         LCLB  &VSAM,&VTAM                       AM CODES               01850001
         LCLB  &PRIME,&AIXRBA                    AIXFLAG CODES  X04SVHS 02750001
         LCLB  &NCMD,&CMD,&NREQ,&CREQ            CHNGDIR CODES  X3004BS 02800001
         LCLB  &SREQ,&SRESP                      STYPE CODES    X3004BS 02850001
         LCLB  &NRESP,&RRESP,&RDFSYN,&NDFSYN     RTYPE CODES    X3004BS 02900001
         LCLB  &NDFASY,&RDFASY                   RTYPE CODES   @Z40BHUC 02950001
         LCLB  &ONLY,&FIRST,&MIDDLE,&LAST        CHAIN CODES    X3004BS 03000001
         LCLB  &PRESP,&SCHED                     POST CODES     X3004BS 03050001
         LCLB  &NEX,&EX,&FME,&NFME,&NRRN,&RRN    RESPOND CODES  X3004BS 03100001
         LCLB  &QRESP,&NQRESP                    RESPOND CODES @G40AKSL 03120000
         LCLB  &DATA,&CANCEL,&QC,&QEC,&CHASE     CONTROL CODES  X3004BS 03150001
         LCLB  &RELQ,&CSDT,&CLEAR,&STSN          CONTROL CODES X03004HS 03200001
         LCLB  &SHUTD,&RQR,&SHUTC                CONTROL CODES @ZA07554 03250001
         LCLB  &BID,&LUS,&SIGNAL,&RTR,&RSHUTD    CONTROL CODES X03004HS 03300001
         LCLB  &SBI,&BIS,&BIND,&UNBIND           CONTROL CODES @G40AKCM 03320000
         LCLB  &STDRD,&ALT                       CODESEL CODE  @Z40BHUC 03340001
         LCLB  &SET,&TESTSET,&RESET,&IGNORE      OBSQAC CODES   X3004BS 03350001
         LCLB  &TESTPOS,&TESTNEG,&INVALID        OBSQAC CODES   X3004BS 03400001
         LCLB  &ISET,&ITESTSE,&IRESET,&IIGNORE   IBSQAC CODES   X3004BS 03450001
         LCLB  &ITESTPO,&ITESTNE,&IINVALI        IBSQAC CODES   X3004BS 03500001
         LCLB  &OCPM,&OSTATE,&OFI,&ORR           SSENSEO CODES X03004HS 03550001
         LCLB  &IPATH,&ICPM,&ISTATE,&IFI,&IRR    SSENSEI CODES X03004HS 03600001
         LCLB  &BB,&NBB,&EB,&NEB                 BRACKET CODES X03004HS 03650001
         LCLB  &NO,&YES                          SWITCHC CODES  X3004BS 03700001
         LCLB  &UNSOL,&EOB,&EOM,&EOT,&LOGOFF     DATAFLG CODES   X03004 03750001
         LCLB  &LG,&SOH                          DATAFLG CODES   X03004 03800001
         LCLB  &BRYES,&BRNO             BRANCH CODES            X04SVHS 03802001
         LCLB  &COMPLET                 IO CODE                 X04SVHS 03810001
         LCLB  &CRYES,&CRNO             ENCRIPTION CODES       @G40AKSL 03850000
         LCLC  &Z16,&Z8                 UNUSED PORTION OF BITSTRING     03900001
.*                                                                      03902001
&Z16     SETC  '0000000000000000'       INITIALIZE CONSTANT     X04SVHS 03910001
&Z8      SETC  '00000000'               INITIALIZE CONSTANT    @Z40BHUC 03920001
.* SCAN RPL KEYWORDS ************************************************** 03950001
.*                                      ACB                             03952001
         IDACB3 ARG=&ACB,ARGNAME=ACB,KWTC=X'2B',MF=&MF          X04SVHS 03960001
.********************************************************************** 03970001
.*                                      AREA                            04010001
         IDACB3 ARG=&AREA,ARGNAME=AREA,KWTC=X'2C',MF=&MF        X04SVHS 04060001
.********************************************************************** 04070001
.*                                      AREALEN                         04110001
         IDACB3 ARG=&AREALEN,ARGNAME=AREALEN,KWTC=X'2D',MF=&MF  X04SVHS 04160001
.********************************************************************** 04170001
.*                                      ARG                             04600001
         IDACB3 ARG=&ARG,ARGNAME=ARG,KWTC=X'2E',MF=&MF          X04SVHS 04650001
.********************************************************************** 04660001
.*                                      ECB                             04900001
         AIF ('&AM' EQ 'VTAM' AND '&ECB' EQ 'INTERNAL').R000050         04916600
.*                                    CHECK VTAM ECB=INTERNAL  @ZA53800 04933200
         IDACB3 ARG=&ECB,ARGNAME=ECB,KWTC=X'2F',MF=&MF          X04SVHS 04950001
.R000050 ANOP                                                  @ZA53800 04955000
.********************************************************************** 04960001
.*                                      KEYLEN                          05200001
         IDACB3 ARG=&KEYLEN,ARGNAME=KEYLEN,KWTC=X'30',MF=&MF    X04SVHS 05250001
.********************************************************************** 05260001
.*                                      MSGAREA                         05500001
         IDACB3 ARG=&MSGAREA,ARGNAME=MSGAREA,KWTC=X'31',MF=&MF  X04SVHS 05550001
.********************************************************************** 05560001
.*                                      MSGLEN                          05800001
         IDACB3 ARG=&MSGLEN,ARGNAME=MSGLEN,KWTC=X'32',MF=&MF    X04SVHS 05850001
.********************************************************************** 05860001
.*                                      NXTRPL                          06100001
         IDACB3 ARG=&NXTRPL,ARGNAME=NXTRPL,KWTC=X'33',MF=&MF    X04SVHS 06150001
.********************************************************************** 06160001
.*                                      OPTCD                           06200001
         IDACBOPT OPTCD=&OPTCD,AM=&AM,MF=&MF,CALLER=&CALLER     X04SVHS 06800001
.*             OPTCD IS PROCESSED BY THE INNER MACRO IDACBOPT           06810001
.********************************************************************** 06820001
.*                                      CHNGDIR                         06850001
.R000100 AIF   ('&CHNGDIR' EQ '').R000600 *** CHNGDIR ***       X3004BS 38650001
         IDACB3 ARG=&CHNGDIR,KWTC=X'65',BIT=YES,CHKAM=VTAM,AM=&AM       38700001
.*                                                              X04SVHS 38710001
&I       SETA  0                        CLEAR INDEX VARIABLE    X3004BS 39050001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 39060001
.R000200 ANOP                                                   X3004BS 39100001
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 39150001
         AIF   (&I GT N'&CHNGDIR).R000300 CHECK FOR END OF LIST X04SVHS 39200001
&NCMD    SETB  ('&CHNGDIR(&I)' EQ 'NCMD' OR &NCMD)              X3004BS 39250001
&CMD     SETB  ('&CHNGDIR(&I)' EQ 'CMD' OR &CMD)                X3004BS 39300001
&NREQ    SETB  ('&CHNGDIR(&I)' EQ 'NREQ' OR &NREQ)              X3004BS 39350001
&CREQ    SETB  ('&CHNGDIR(&I)' EQ 'REQ' OR &CREQ)               X3004BS 39400001
         AIF   (&NCMD+&CMD+&NREQ+&CREQ+&A EQ &I).R000200        X04SVHS 39410001
.*             CHK FOR NEW BIT SET                                      39420001
         IDAERMAC 5,CHNGDIR,&CHNGDIR(&I)                        X3004BS 39450001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 39500001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 39510001
         AGO   .R000200                 CHECK NEXT OPTION       X04SVHS 39550001
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     39600001
.R000300 AIF   (NOT(&NCMD AND &CMD)).R000400                    X3004BS 40200001
         IDAERMAC 8,CHNGDIR,NCMD,CMD                            X3004BS 40250001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 40260001
.R000400 AIF   (NOT(&NREQ AND &CREQ)).R000500                   X3004BS 40300001
         IDAERMAC 8,CHNGDIR,NREQ,REQ                            X3004BS 40350001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 40360001
.R000500 ANOP                                                   X3004BS 40400001
         AIF   ('&CALLER' EQ 'RPL').R000600                     X04SVHS 40400501
.*             IF CALLED BY RPL, VALUE SET IN RPLRH3 UNDER CODESEL CODE 40420501
&IDAVALC(&IDAENO) SETC '&NCMD&CMD&NREQ&CREQ.000000000000&Z16'   X3004BS 40450001
.********************************************************************** 40460001
.R000600 ANOP                                                  X03004HS 40500001
.*                                      BRACKET                         40510001
         AIF   ('&BRACKET' EQ '').R001010                      X03004HS 40550001
         IDACB3 ARG=&BRACKET,KWTC=X'85',CHKAM=VTAM,AM=&AM,BIT=YES       40600001
&I       SETA  0                        INITIALIZE INDEX VALUE X03004HS 40750001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 40760001
.R000700 ANOP                                                  X03004HS 40950001
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 41000001
         AIF   (&I GT N'&BRACKET).R000800                      X03004HS 41100001
.*             DETERMINE IF ALL SUBPARMS HAVE BEEN CHECKED     X03004HS 41110001
&BB      SETB  ('&BRACKET(&I)' EQ 'BB' OR &BB)                 X03004HS 41150001
&NBB     SETB  ('&BRACKET(&I)' EQ 'NBB' OR &NBB)               X03004HS 41200001
&EB      SETB  ('&BRACKET(&I)' EQ 'EB' OR &EB)                 X03004HS 41250001
&NEB     SETB  ('&BRACKET(&I)' EQ 'NEB' OR &NEB)               X03004HS 41300001
         AIF   (&BB+&NBB+&EB+&NEB+&A EQ &I).R000700             X04SVHS 41310001
.*                                      CHK FOR NEW BIT SET             41320001
         IDAERMAC 5,BRACKET,&BRACKET(&I)                       X03004HS 41350001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 41360001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 41370001
         AGO   .R000700                 CHK NEXT SUBPARM       X03004HS 41400001
.R000800 ANOP                                                  X03004HS 42050001
         AIF   (NOT(&BB AND &NBB)).R000900 CHK MUTUALLY        X03004HS 42100001
.*                                      EXCLUSIVE KEYWORDS     X03004HS 42150001
         IDAERMAC 8,BRACKET,BB,NBB                             X03004HS 42200001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 42210001
.R000900 ANOP                                                  X03004HS 42250001
         AIF   (NOT(&EB AND &NEB)).R001000 CHK MUTUALLY        X03004HS 42300001
.*                                      EXCLUSIVE KEYWORDS     X03004HS 42350001
         IDAERMAC 8,BRACKET,EB,NEB                             X03004HS 42400001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 42410001
.R001000 ANOP                                                  X03004HS 42450001
         AIF   ('&CALLER' EQ 'RPL').R001010                     X04SVHS 42450501
.*             IF CALLED BY RPL, VALUE SET IN RPLRH3 UNDER CODESEL CODE 42470501
&IDAVALC(&IDAENO) SETC '&BB&NBB&EB&NEB.000000000000&Z16'       X03004HS 42500001
.*                                                              X04SVHS 42502001
.********************************************************************** 42504001
.*                                      CODESEL                @Z40BHUC 42510001
.R001010 AIF   ('&CODESEL' EQ '').R001070 *** CODESEL ***      @Z40BHUC 42520001
         IDACB3 ARG=&CODESEL,KWTC=X'91',CHKAM=VTAM,AM=&AM,BIT=YES       42540001
&STDRD SETB ('&CODESEL' EQ 'STANDARD' OR '&CODESEL' EQ '(STANDARD)')    42560001
&ALT   SETB ('&CODESEL' EQ 'ALT' OR '&CODESEL' EQ '(ALT)')     @Z40BHUC 42580001
         AIF   (&STDRD+&ALT EQ 1).R001020 CHECK VALID OPTION   @Z40BHUC 42600001
         IDAERMAC  5,CODESEL,&CODESEL                          @Z40BHUC 42620001
&IDACB01 SETB  1                                               @Z40BHUC 42640001
.R001020 AIF   (N'&CODESEL EQ 1).R001050   ONE OPTION ALLOWED  @Z40BHUC 42660001
         IDAERMAC 22,CODESEL                                   @Z40BHUC 42680001
&IDACB01 SETB  1                                               @Z40BHUC 42700001
.R001050 AIF   ('&CALLER' EQ 'RPL').R001070                    @Z40BHUC 42720001
.*             IF CALLED BY RPL, BYPASS SETTING CBM GLOBAL     @Z40BHUC 42740001
&IDAVALC(&IDAENO) SETC '&STDRD&ALT.000000&Z8&Z16'              @Z40BHUC 42760001
         AGO   .R001100                                        @Z40BHUC 42780001
.R001070 ANOP                                                  @Z40BHUC 42800001
.*    IDACBRPL HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO    @Z40BHUC 42820001
.*    OR CODESEL IS NULL                                       @Z40BHUC 42840001
&IDARH3  SETC  '&BB&EB&CMD&CREQ&ALT.000'   SET BRACKET/CHNGDIR/CODESEL  42860001
.********************************************************************** 42900001
.*                                      STYPE                           42910001
.R001100 AIF   ('&STYPE' EQ '').R001500 *** STYPE ***           X3004BS 42920001
         IDACB3 ARG=&STYPE,KWTC=X'66',CHKAM=VTAM,AM=&AM,BIT=YES         42930001
&I       SETA  0                                                X3004BS 42950001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 42960001
.R001200 ANOP                                                   X3004BS 43000001
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 43050001
         AIF   (&I GT N'&STYPE).R001300 CHECK FOR END OF LIST   X04SVHS 43100001
&SREQ    SETB  ('&STYPE(&I)' EQ 'REQ' OR &SREQ)                 X3004BS 43150001
&SRESP   SETB  ('&STYPE(&I)' EQ 'RESP' OR &SRESP)               X3004BS 43200001
         AIF   (&SREQ+&SRESP+&A EQ &I).R001200                  X04SVHS 43210001
.*                                      CHK FOR NEW BIT SET             43220001
         IDAERMAC 5,STYPE,&STYPE(&I)                            X3004BS 43250001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 43300001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 43310001
         AGO   .R001200                                         X3004BS 43350001
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     43400001
.R001300 AIF   (NOT(&SREQ AND &SRESP)).R001400                  X3004BS 43700001
         IDAERMAC 8,STYPE,REQ,RESP                              X3004BS 43750001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 43760001
.R001400 ANOP                                                   X3004BS 43800001
         AIF   ('&CALLER' EQ 'RPL').R001500                     X04SVHS 43800501
.*             IF CALLED BY RPL, BYPASS SETTING CBM GLOBAL              43801001
&IDAVALC(&IDAENO) SETC '&SREQ&SRESP.00000000000000&Z16'         X3004BS 43850001
.********************************************************************** 43852001
.*                                      RTYPE                           43860001
.R001500 AIF   ('&RTYPE' EQ '').R002150 *** RTYPE ***           X3004BS 43900001
         IDACB3 ARG=&RTYPE,KWTC=X'67',CHKAM=VTAM,AM=&AM,BIT=YES X04SVHS 43950001
&I       SETA  0                        ZERO INDEX              X3004BS 44300001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 44310001
.R001600 ANOP                                                   X3004BS 44350001
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 44400001
         AIF   (&I GT N'&RTYPE).R001700 CHECK FOR END OF LIST   X04SVHS 44450001
&NRESP   SETB  ('&RTYPE(&I)' EQ 'NRESP' OR &NRESP)              X3004BS 44500001
&RRESP   SETB  ('&RTYPE(&I)' EQ 'RESP' OR &RRESP)               X3004BS 44550001
&RDFSYN  SETB  ('&RTYPE(&I)' EQ 'DFSYN' OR &RDFSYN)             X3004BS 44600001
&NDFSYN  SETB  ('&RTYPE(&I)' EQ 'NDFSYN' OR &NDFSYN)            X3004BS 44650001
&NDFASY  SETB  ('&RTYPE(&I)' EQ 'NDFASY' OR &NDFASY)            X3004BS 44700001
&RDFASY  SETB  ('&RTYPE(&I)' EQ 'DFASY' OR &RDFASY)             X3004BS 44750001
         AIF   (&NRESP+&RRESP+&RDFSYN+&NDFSYN+&NDFASY+&RDFASY+&A EQ &I)*44860001
               .R001600                                        @Z40BHUC 44870001
.*                                      CHK FOR NEW BIT SET             44880001
         IDAERMAC 5,RTYPE,&RTYPE(&I)                            X3004BS 44900001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 44950001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 44960001
         AGO   .R001600                                         X3004BS 45000001
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     45050001
.R001700 AIF   (NOT(&NRESP AND &RRESP)).R001800                 X3004BS 46250001
         IDAERMAC 8,RTYPE,NRESP,RESP                            X3004BS 46300001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 46310001
.R001800 AIF   (NOT(&NDFSYN AND &RDFSYN)).R001900               X3004BS 46350001
         IDAERMAC 8,RTYPE,NDFSYN,DFSYN                          X3004BS 46400001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 46410001
.R001900 AIF   (NOT(&NDFASY AND &RDFASY)).R002100              @Z40BHUC 46450001
         IDAERMAC 8,RTYPE,NDFASY,DFASY                          X3004BS 46500001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 46510001
.R002100 ANOP                                                   X3004BS 46650001
         AIF   ('&CALLER' EQ 'RPL').R002150                     X04SVHS 46650501
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               46651001
&IDAVALC(&IDAENO) SETC '&NRESP&RRESP&RDFSYN&NDFSYN&NDFASY&RDFASY.000000*46700001
               0000&Z16'                                                46750001
         AGO   .R002200                                         X04SVHS 46750501
.R002150 ANOP                                                   X04SVHS 46751001
&IDASRTY SETC  '&SRESP.000&RRESP&NDFSYN&RDFASY.0'              @Z40BHUC 46751501
.*             SET STYPE/RTYPE CODES FOR RPL                    X04SVHS 46752001
.********************************************************************** 46754001
.*                                      CHAIN                           46760001
.R002200 AIF   ('&CHAIN' EQ '').R002450 *** CHAIN ***           X3004BS 46800001
         IDACB3 ARG=&CHAIN,KWTC=X'68',CHKAM=VTAM,AM=&AM,BIT=YES X04SVHS 46900001
&ONLY    SETB  ('&CHAIN' EQ 'ONLY' OR '&CHAIN' EQ '(ONLY)')     X04SVHS 47450001
&FIRST   SETB  ('&CHAIN' EQ 'FIRST' OR '&CHAIN' EQ '(FIRST)')   X04SVHS 47500001
&MIDDLE  SETB  ('&CHAIN' EQ 'MIDDLE' OR '&CHAIN' EQ '(MIDDLE)') X04SVHS 47550001
&LAST    SETB  ('&CHAIN' EQ 'LAST' OR '&CHAIN' EQ '(LAST)')     X04SVHS 47600001
         AIF   (&ONLY+&FIRST+&MIDDLE+&LAST EQ 1).R002300        X04SVHS 47610001
.*                                      CHK FOR NEW BIT SET             47620001
         IDAERMAC 5,CHAIN,&CHAIN                                X3004BS 47650001
&IDACB01 SETB  1                                                X3004BS 47700001
.R002300 ANOP                                                   X04SVHS 47750001
         AIF   (N'&CHAIN EQ 1).R002400 ONLY ONE OPTION MAY BE SPECIFIED 48600001
         IDAERMAC 22,CHAIN                                      X3004BS 48650001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 48660001
.R002400 ANOP                                                   X3004BS 48700001
         AIF   ('&CALLER' EQ 'RPL').R002450                     X04SVHS 48710001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               48720001
&IDAVALC(&IDAENO) SETC '&FIRST&MIDDLE&LAST&ONLY.000000000000&Z16'       48750001
.*                                                              X04SVHS 48750401
         AGO   .R002500                                         X04SVHS 48752001
.R002450 ANOP                                                   X04SVHS 48754001
.*       AT THIS POINT CHAIN IS EITHER UNSPECIFIED, OR IDACBRPL         48754401
.*       WAS CALLED BY THE RPL DECLARATIVE MACRO                        48754801
         AIF   ('&CHAIN' NE '').R002475 IF CHAIN IS SPEC,       X04SVHS 48755201
.*             THEN CALLER IS RPL AND DECLARATIVE GLOBAL MUST BE SET    48755601
         AIF   ('&CALLER' NE 'RPL').R002500 ICALLER IS RPL,     X04SVHS 48755701
.*             THEN DEFAULT VALUE MUST BE SET                           48755801
&ONLY    SETB  1                        SET DEFAULT VALUE       X04SVHS 48755901
.R002475 ANOP                                                   X04SVHS 48763201
&IDACHN  SETC  '&FIRST&MIDDLE&LAST&ONLY.0000'                   X04SVHS 48770801
.*                                      SET CHAIN CODES         X04SVHS 48778101
.********************************************************************** 48788101
.*                                      POST                            48792701
.R002500 AIF   ('&POST' EQ '').R002900 *** POST ***             X3004BS 48800001
         IDACB3 ARG=&POST,KWTC=X'69',CHKAM=VTAM,AM=&AM,BIT=YES  X04SVHS 48850001
&I       SETA  0                                                X3004BS 49200001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 49210001
.R002600 ANOP                                                   X3004BS 49250001
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 49300001
         AIF   (&I GT N'&POST).R002700  CHECK FOR END OF LIST   X04SVHS 49350001
&PRESP   SETB  ('&POST(&I)' EQ 'RESP' OR &PRESP)                X3004BS 49400001
&SCHED   SETB  ('&POST(&I)' EQ 'SCHED' OR &SCHED)               X3004BS 49450001
         AIF   (&PRESP+&SCHED+&A EQ &I).R002600                 X04SVHS 49460001
.*                                      CHK FOR NEW BIT SET             49470001
         IDAERMAC 5,POST,&POST(&I)                              X3004BS 49500001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 49550001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 49560001
         AGO   .R002600                                         X3004BS 49600001
.*             CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS                    49650001
.R002700 AIF   (NOT(&PRESP AND &SCHED)).R002800                 X3004BS 49950001
         IDAERMAC 8,POST,RESP,SCHED                             X3004BS 50000001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 50010001
.R002800 ANOP                                                   X3004BS 50050001
         AIF   ('&CALLER' EQ 'RPL').R002900                     X04SVHS 50060001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               50070001
&IDAVALC(&IDAENO) SETC '&PRESP&SCHED.00000000000000&Z16'        X3004BS 50100001
.********************************************************************** 50102001
.*                                      RESPOND                         50110001
.R002900 AIF   ('&RESPOND' EQ '').R003450 *** RESPOND ***       X3004BS 50150001
         IDACB3 ARG=&RESPOND,KWTC=X'6A',CHKAM=VTAM,AM=&AM,BIT=YES       50200001
.*                                                              X04SVHS 50210001
&I       SETA  0                                                X3004BS 50550001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 50560001
.R003000 ANOP                                                   X3004BS 50600001
&I       SETA  &I+1                     BUMP INDEX INTO ARRAYS  X04SVHS 50650001
         AIF   (&I GT N'&RESPOND).R003100 CHECK FOR END OF LIST X04SVHS 50700001
&NEX     SETB  ('&RESPOND(&I)' EQ 'NEX' OR &NEX)                X3004BS 50750001
&EX      SETB  ('&RESPOND(&I)' EQ 'EX' OR &EX)                  X3004BS 50800001
&FME     SETB  ('&RESPOND(&I)' EQ 'FME' OR &FME)                X3004BS 50850001
&NFME    SETB  ('&RESPOND(&I)' EQ 'NFME' OR &NFME)              X3004BS 50900001
&NRRN    SETB  ('&RESPOND(&I)' EQ 'NRRN' OR &NRRN)              X3004BS 50950001
&RRN     SETB  ('&RESPOND(&I)' EQ 'RRN' OR &RRN)                X3004BS 51000001
&QRESP   SETB  ('&RESPOND(&I)' EQ 'QRESP' OR &QRESP)           @G40AKSL 51010000
&NQRESP  SETB  ('&RESPOND(&I)' EQ 'NQRESP' OR &NQRESP)         @G40AKSL 51012000
         AIF   (&NEX+&EX+&FME+&NFME+&NRRN+&RRN+&A+&QRESP+&NQRESP EQ &I)*51014000
               .R003000                                        @G40AKSL 51016000
.*             CHECK FOR VALID OPTION                                   51020001
         IDAERMAC 5,RESPOND,&RESPOND(&I)                        X3004BS 51050001
&IDACB01 SETB  1                          SET ERROR SWITCH      X3004BS 51100001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 51110001
         AGO   .R003000                                         X3004BS 51150001
.*             CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS                    51200001
.R003100 AIF   (NOT(&NEX AND &EX)).R003200                      X3004BS 52050001
         IDAERMAC 8,RESPOND,NEX,EX                              X3004BS 52100001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 52110001
.R003200 AIF   (NOT(&FME AND &NFME)).R003300                    X3004BS 52150001
         IDAERMAC 8,RESPOND,FME,NFME                            X3004BS 52200001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 52210001
.R003300 AIF   (NOT(&NRRN AND &RRN)).R003400                    X3004BS 52250001
         IDAERMAC 8,RESPOND,NRRN,RRN                            X3004BS 52300001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 52310001
.R003400 ANOP                                                   X3004BS 52350001
         AIF   ('&CALLER' EQ 'RPL').R003450                     X04SVHS 52360001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               52370001
&IDAVALC(&IDAENO) SETC '&NEX&EX&FME&NFME&NRRN&RRN&QRESP&NQRESP.00000000*52400048
               &Z16'                                           @G40AKSL 52401000
         AGO   .R003500                                         X04SVHS 52402000
.R003450 ANOP                                                   X04SVHS 52403000
&IDAPORE SETC  '&SCHED.000&QRESP&EX&NFME&RRN' SET POST/RESPOND @G40AKCM 52404000
.********************************************************************** 52408001
.*                                      CONTROL                         52410001
.R003500 AIF   ('&CONTROL' EQ '').R003750                       X04SVHS 52450001
         AIF   ('&AM' NE 'VTAM').AMERR                                  52510001
         IDACB3 ARG=&CONTROL,KWTC=X'6B',BIT=YES                         52550001
.*                                                              X04SVHS 52560001
&DATA    SETB  ('&CONTROL' EQ 'DATA' OR '&CONTROL' EQ '(DATA)') X04SVHS 53100001
&CANCEL  SETB  ('&CONTROL' EQ 'CANCEL' OR '&CONTROL' EQ '(CANCEL)')     53150001
.*                                                              X04SVHS 53160001
&QC      SETB  ('&CONTROL' EQ 'QC' OR '&CONTROL' EQ '(QC)')     X04SVHS 53200001
&QEC     SETB  ('&CONTROL' EQ 'QEC' OR '&CONTROL' EQ '(QEC)')   X04SVHS 53250001
&CHASE   SETB  ('&CONTROL' EQ 'CHASE' OR '&CONTROL' EQ '(CHASE)')       53300001
.*                                                              X04SVHS 53310001
&RELQ    SETB  ('&CONTROL' EQ 'RELQ' OR '&CONTROL' EQ '(RELQ)') X04SVHS 53350001
&CSDT    SETB  ('&CONTROL' EQ 'SDT' OR '&CONTROL' EQ '(SDT)')   X04SVHS 53400001
&CLEAR   SETB  ('&CONTROL' EQ 'CLEAR' OR '&CONTROL' EQ '(CLEAR)')       53450001
.*                                                              X04SVHS 53460001
&STSN    SETB  ('&CONTROL' EQ 'STSN' OR '&CONTROL' EQ '(STSN)') X04SVHS 53500001
&SHUTD   SETB  ('&CONTROL' EQ 'SHUTD' OR '&CONTROL' EQ '(SHUTD)')       53550001
.*                                                              X04SVHS 53560001
&RQR     SETB  ('&CONTROL' EQ 'RQR' OR '&CONTROL' EQ '(RQR)')   X04SVHS 53600001
&BID     SETB  ('&CONTROL' EQ 'BID' OR '&CONTROL' EQ '(BID)')   X04SVHS 53650001
&LUS     SETB  ('&CONTROL' EQ 'LUS' OR '&CONTROL' EQ '(LUS)')   X04SVHS 53700001
&RTR     SETB  ('&CONTROL' EQ 'RTR' OR '&CONTROL' EQ '(RTR)')   X04SVHS 53750001
&SIGNAL  SETB  ('&CONTROL' EQ 'SIGNAL' OR '&CONTROL' EQ '(SIGNAL)')     53800001
.*                                                              X04SVHS 53810001
&RSHUTD  SETB  ('&CONTROL' EQ 'RSHUTD' OR '&CONTROL' EQ '(RSHUTD)')     53850001
.*                                                              X04SVHS 53852001
&SHUTC   SETB  ('&CONTROL' EQ 'SHUTC' OR '&CONTROL' EQ '(SHUTC)')       53860001
.*             CHECK IF VALID OPTION WAS SPECIFIED             @ZA07554 53864001
&BIND    SETB  ('&CONTROL' EQ 'BIND'   OR '&CONTROL' EQ '(BIND)')       53964048
.*                                                             @G40AKCM 54014000
&UNBIND  SETB  ('&CONTROL' EQ 'UNBIND' OR '&CONTROL' EQ '(UNBIND)')     54064000
.*             CHECK IF VALID OPTION WAS SPECIFIED             @G40AKCM 54114000
&SBI     SETB  ('&CONTROL' EQ 'SBI'    OR '&CONTROL' EQ '(SBI)')        54164000
.*                                                             @G40AKCM 54214000
&BIS     SETB  ('&CONTROL' EQ 'BIS'   OR '&CONTROL' EQ '(BIS)')         54264000
.*             CHECK IF VALID OPTION WAS SPECIFIED             @G40AKCM 54314000
         AIF   (&DATA+&CANCEL+&QC+&QEC+&CHASE+&RELQ+&CSDT+&CLEAR+&STSN+*54364000
               &SHUTD+&RQR+&BID+&LUS+&RTR+&SIGNAL+&RSHUTD+&SHUTC+&BIND+*54414000
               &UNBIND+&SBI+&BIS EQ 1).R003600                 @G40AKCM 54464000
         IDAERMAC 5,CONTROL,&CONTROL                            X3004BS 54600001
&IDACB01 SETB  1                         SET ERROR SWITCH       X3004BS 54650001
.R003600 ANOP                                                           54700001
         AIF (N'&CONTROL EQ 1).R003700   ONLY ONE OPTION IS ALLOWED     54750001
         IDAERMAC 22,CONTROL                                    X3004BS 54800001
&IDACB01 SETB  1                         SET ERROR SWITCH       X04SVHS 54850001
.R003700 ANOP                                                   X3004BS 54900001
         AIF   ('&CALLER' EQ 'RPL').R003750                     X04SVHS 54950001
.*   IF CALLED BY RPL BYPASS SETTING CBM GLOBAL                         55000001
&IDAVALC(&IDAENO) SETC '&DATA&CANCEL&QC&QEC&CHASE&RELQ&BID&RTR&LUS&SIGN*55100001
               AL&CSDT&CLEAR&STSN&SHUTD&RQR&RSHUTD&SHUTC&BIND&UNBIND&SB*55150048
               I&BIS.000&Z8'                                   @G40AKCM 55170000
         AGO   .R003900                                                 55200001
.R003750 ANOP                                                           55400001
.*       AT THIS POINT EITHER CONTROL IS NOT SPECIFIED, OR IDACBRPL     55450001
.*       HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO                   55500001
         AIF   ('&CONTROL' NE '').R003775 IF CONTROL IS SPEC,   X04SVHS 55550001
.*             THEN CALLER IS RPL, AND DECLARATIVE GLOBALS MUST BE SET  55600001
         AIF   ('&CALLER' NE 'RPL').R003900 IF CONTROL IS NULL  X04SVHS 55650001
.*             AND CALLER IS RPL, THEN VTAM DEFAULT VALUE MUST BE SET   55700001
&DATA    SETB  1                        SET VTAM DEFAULT        X04SVHS 55750001
.R003775 ANOP                                                           55800001
&IDACON1 SETC  '&DATA&CANCEL&QC&QEC&CHASE&RELQ.00'              X04SVHS 55850001
&IDACON2 SETC  '&BID&RTR&LUS&SIGNAL&BIND&UNBIND&SBI&BIS'       @G40AKCM 55900000
&IDACON3 SETC  '&CSDT&CLEAR&STSN&SHUTD&SHUTC&RQR.00'           @G40AKCM 55930000
         AGO   .R003900                                                 56000001
.AMERR   MNOTE 8,'CONTROL IS INVALID UNLESS AM IS SPECIFIED'            56170001
&IDACB01 SETB  1                                                        56180001
.********************************************************************** 56200001
.*                                      OBSQAC                          57460001
.R003900 AIF   ('&OBSQAC' EQ '').R004050 *** OBSQAC ***                 57500001
         IDACB3 ARG=&OBSQAC,KWTC=X'6C',CHKAM=VTAM,AM=&AM,BIT=YES        57600001
.*                                                              X04SVHS 57610001
&SET     SETB  ('&OBSQAC' EQ 'SET' OR '&OBSQAC' EQ '(SET)')     X04SVHS 58150001
&TESTSET SETB  ('&OBSQAC' EQ 'TESTSET' OR '&OBSQAC' EQ '(TESTSET)')     58200001
.*                                                              X04SVHS 58210001
&RESET   SETB  ('&OBSQAC' EQ 'RESET' OR '&OBSQAC' EQ '(RESET)') X04SVHS 58250001
&IGNORE  SETB  ('&OBSQAC' EQ 'IGNORE' OR '&OBSQAC' EQ '(IGNORE)')       58300001
.*                                                              X04SVHS 58310001
&TESTPOS SETB  ('&OBSQAC' EQ 'TESTPOS' OR '&OBSQAC' EQ '(TESTPOS)')     58350001
.*                                                              X04SVHS 58360001
&TESTNEG SETB  ('&OBSQAC' EQ 'TESTNEG' OR '&OBSQAC' EQ '(TESTNEG)')     58400001
.*                                                              X04SVHS 58410001
&INVALID SETB  ('&OBSQAC' EQ 'INVALID' OR '&OBSQAC' EQ '(INVALID)')     58450001
.*                                                              X04SVHS 58452001
         AIF   (&SET+&TESTSET+&RESET+&IGNORE+&TESTPOS+&TESTNEG+&INVALID*58460001
                EQ 1).R003950                                           58470001
.*             CHECK FOR VALID OPTION                                   58480001
         IDAERMAC 5,OBSQAC,&OBSQAC(&I)                          X3004BS 58500001
&IDACB01 SETB  1                    SET ERROR SWITCH            X3004BS 58550001
.R003950 AIF   (N'&OBSQAC EQ 1).R004000  ONE OPTION IS ALLOWED          60050001
         IDAERMAC 22,OBSQAC                                     X3004BS 60100001
&IDACB01 SETB  1                    SET ERROR SWITCH            X04SVHS 60110001
.R004000 ANOP                                                   X3004BS 60150001
         AIF   ('&CALLER' EQ 'RPL').R004050                     X04SVHS 60160001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               60170001
&IDAVALC(&IDAENO) SETC '&SET&TESTSET&RESET&IGNORE&TESTPOS&TESTNEG&INVAL*60200001
               ID.000000000&Z16'                                        60250001
         AGO   .R004100                                         X04SVHS 60252001
.R004050 ANOP                                                   X04SVHS 60254001
.*       AT THIS POINT, EITHER OBSQAC IS NOT SPECIFIED, OR IDACBRPL     60254101
.*       HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO                   60254201
         AIF   ('&OBSQAC' NE '').R004075 I FOBSQAC IS SPEC,     X04SVHS 60254401
.*             THEN CALLER I SRPL, AND DECLARATIVE GLOBALS MUST BE SET  60254801
         AIF   ('&CALLER' NE 'RPL').R004100                     X04SVHS 60255201
.*             IF OBSQAC IS NULL, AND CALLER IS RPL, THEN DEFAULT       60255601
.*             VALUE MUST BE SET                                        60255701
&SET     SETB  1                        SET DEFAULT VALUE       X04SVHS 60255801
.R004075 ANOP                                                   X04SVHS 60255901
&IDAOBQC SETC  '&SET&TESTSET&RESET&IGNORE&TESTPOS&TESTNEG&INVALID.0'    60256001
.*                                      SET OBSQAC CODES        X04SVHS 60258001
.********************************************************************** 60258401
.*                                      IBSQAC                          60260001
.R004100 AIF   ('&IBSQAC' EQ '').R004350 *** IBSQAC ***         X3004BS 60300001
         IDACB3 ARG=&IBSQAC,KWTC=X'6D',CHKAM=VTAM,AM=&AM,BIT=YES        60400001
.*                                                              X04SVHS 60410001
&ISET    SETB  ('&IBSQAC' EQ 'SET' OR '&IBSQAC' EQ '(SET)')     X04SVHS 60950001
&ITESTSE SETB  ('&IBSQAC' EQ 'TESTSET' OR '&IBSQAC' EQ '(TESTSET)')     61000001
.*                                                              X04SVHS 61010001
&IRESET  SETB  ('&IBSQAC' EQ 'RESET' OR '&IBSQAC' EQ '(RESET)') X04SVHS 61050001
&IIGNORE SETB  ('&IBSQAC' EQ 'IGNORE' OR '&IBSQAC' EQ '(IGNORE)')       61100001
.*                                                              X04SVHS 61110001
&ITESTPO SETB  ('&IBSQAC' EQ 'TESTPOS' OR '&IBSQAC' EQ '(TESTPOS)')     61150001
.*                                                              X04SVHS 61160001
&ITESTNE SETB  ('&IBSQAC' EQ 'TESTNEG' OR '&IBSQAC' EQ '(TESTNEG)')     61200001
.*                                                              X04SVHS 61210001
&IINVALI SETB  ('&IBSQAC' EQ 'INVALID' OR '&IBSQAC' EQ '(INVALID)')     61250001
.*                                                              X04SVHS 61252001
         AIF   (&ISET+&ITESTSE+&IRESET+&IIGNORE+&ITESTPO+&ITESTNE+&IINV*61260001
               ALI EQ 1).R004200                                X04SVHS 61270001
.*             CHECK FOR VALID OPTION                                   61280001
         IDAERMAC 5,IBSQAC,&IBSQAC                              X3004BS 61300001
&IDACB01 SETB  1                         SET ERROR SWITCH       X3004BS 61350001
.R004200 AIF   (N'&IBSQAC EQ 1).R004300  ONLY ONE OPTION IS ALLOWED     62850001
         IDAERMAC 22,IBSQAC                                     X3004BS 62900001
&IDACB01 SETB  1                         SET ERROR SWITCH       X3004BS 62910001
.R004300 ANOP                                                   X3004BS 62950001
         AIF   ('&CALLER' EQ 'RPL').R004350                     X04SVHS 62960001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               62970001
&IDAVALC(&IDAENO) SETC '&ISET&ITESTSE&IRESET&IIGNORE&ITESTPO&ITESTNE&II*63000001
               NVALI.000000000&Z16'                             X04SVHS 63050001
         AGO   .R004400                                         X04SVHS 63052001
.R004350 ANOP                                                   X04SVHS 63054001
.*       AT THIS POINT EITHER IBSQAC IS NOT SPECIFIED, OR IDACBRPL      63054401
.*       HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO                   63054801
         AIF   ('&IBSQAC' NE '').R004375 IF IBSQAC IS SPEC,     X04SVHS 63055201
.*             THEN CALLER IS RPL AND DECLARATIVE GLOBALS MUST BE SET   63055701
         AIF   ('&CALLER' NE 'RPL').R004400 IF CALLER IS RPL,   X04SVHS 63055801
.*             THEN DEFAULT VALUE MUST BE SET                   X04SVHS 63055901
&ISET    SETB  1                        SET DEFAULT VALUE       X04SVHS 63063201
.R004375 ANOP                                                   X04SVHS 63065201
&IDAIBQC SETC  '&ISET&ITESTSE&IRESET&IIGNORE&ITESTPO&ITESTNE&IINVALI.0' 63070801
.*                                      SET IBSQAC CODES        X04SVHS 63078101
.********************************************************************** 63088101
.*                                      SSENSEO                         63092701
.R004400 AIF   ('&SSENSEO' EQ '').R004700 *** SSENSEO ***       X3004BS 63100001
         AIF   ('&SSENSEO' EQ '0' OR '&SSENSEO' EQ '(0)').R004700       63116601
.*                                                             @ZA42444 63133201
         IDACB3 ARG=&SSENSEO,KWTC=X'71',CHKAM=VTAM,AM=&AM,BIT=YES       63150001
.*                                                              X04SVHS 63160001
&OCPM    SETB  ('&SSENSEO' EQ 'CPM' OR '&SSENSEO' EQ '(CPM)')   X04SVHS 63750001
&OSTATE  SETB  ('&SSENSEO' EQ 'STATE' OR '&SSENSEO' EQ '(STATE)')       63800001
.*                                                              X04SVHS 63810001
&OFI     SETB  ('&SSENSEO' EQ 'FI' OR '&SSENSEO' EQ '(FI)')     X04SVHS 63850001
&ORR     SETB  ('&SSENSEO' EQ 'RR' OR '&SSENSEO' EQ '(RR)')     X04SVHS 63900001
         AIF   (&OCPM+&OSTATE+&OFI+&ORR EQ 1).R004500           X04SVHS 63910001
.*                                      TEST FOR VALID OPTION SPEC      63920001
         IDAERMAC 5,SSENSEO,&SSENSEO                            X3004BS 63950001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 64000001
.R004500 ANOP                                                  X03004HS 64900001
         AIF   (N'&SSENSEO EQ 1).R004600                        X04SVHS 64950001
         IDAERMAC 22,SSENSEO            ONLY ONE OPTION IS ALLOWED      65000001
&IDACB01 SETB  1                        SET ERROR SWITCH       X03004HS 65050001
.R004600 ANOP                                                  X03004HS 65100001
         AIF   ('&CALLER' EQ 'RPL').R004650                     X04SVHS 65110001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               65120001
&IDAVALC(&IDAENO) SETC '&OCPM&OSTATE&OFI&ORR.000000000000&Z16' X03004HS 65150001
         AGO   .R004700                                         X04SVHS 65152001
.R004650 ANOP                                                   X04SVHS 65154001
&IDASNSO SETC  '0&OCPM&OSTATE&OFI&ORR.000'                      X04SVHS 65156001
.*                                      SET SSENSEO CODES       X04SVHS 65158001
         AGO   .R005250                 WHEN CALLED BY RPL, PROCESS     65158401
.*                                      BRANCH KEYWORD          X04SVHS 65158801
.********************************************************************** 65159201
.*                                      SSENSEI                         65160001
.R004700 AIF   ('&SSENSEI' EQ '').R005000 *** SSENSEI ***       X3004BS 65200001
         IDACB3 ARG=&SSENSEI,KWTC=X'72',CHKAM=VTAM,AM=&AM,BIT=YES       65250001
.*                                                              X04SVHS 65260001
&IPATH   SETB  ('&SSENSEI' EQ 'PATH' OR '&SSENSEI' EQ '(PATH)') X04SVHS 65850001
&ICPM    SETB  ('&SSENSEI' EQ 'CPM' OR '&SSENSEI' EQ '(CPM)')   X04SVHS 65900001
&ISTATE  SETB  ('&SSENSEI' EQ 'STATE' OR '&SSENSEI' EQ '(STATE)')       65950001
.*                                                              X04SVHS 65960001
&IFI     SETB  ('&SSENSEI' EQ 'FI' OR '&SSENSEI' EQ '(FI)')     X04SVHS 66000001
&IRR     SETB  ('&SSENSEI' EQ 'RR' OR '&SSENSEI' EQ '(RR)')     X04SVHS 66050001
         AIF   (&IPATH+&ICPM+&ISTATE+&IFI+&IRR EQ 1).R004800            66060001
.*                                      TEST FOR VALID OPTION SPEC      66070001
         IDAERMAC 5,SSENSEI,&SSENSEI                            X3004BS 66100001
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 66150001
.R004800 ANOP                                                  X03004HS 67250001
         AIF   (N'&SSENSEI EQ 1).R004900 ONLY ONE OPTION IS ALLOWED     67300001
         IDAERMAC 22,SSENSEI                                   X03004HS 67350001
&IDACB01 SETB  1                        SET ERROR SWITCH       X03004HS 67400001
.R004900 ANOP                                                   X04SVHS 67450001
&IDAVALC(&IDAENO) SETC '&IPATH&ICPM&ISTATE&IFI&IRR.00000000000&Z16'     67500001
.R005000 ANOP                                                  @Z40BHUC 67550001
.********************************************************************** 67600001
.*                                      SSENSMO                         67650001
         IDACB3 ARG=&SSENSMO,ARGNAME=SSENSMO,KWTC=X'86',MF=&MF,        *68870001
               CHKAM=VTAM,AM=&AM                                X04SVHS 68920001
.********************************************************************** 68930001
.*                                      SSENSMI                         68970001
         IDACB3 ARG=&SSENSMI,ARGNAME=SSENSMI,KWTC=X'87',MF=&MF,        *69020001
               CHKAM=VTAM,AM=&AM                                X04SVHS 69070001
.********************************************************************** 69080001
.*                                      SIGDATA                         69120001
         IDACB3 ARG=&SIGDATA,ARGNAME=SIGDATA,KWTC=X'88',MF=&MF,        *69170001
               CHKAM=VTAM,AM=&AM                                X04SVHS 69220001
.********************************************************************** 69230001
.*                                      OBSQVAL                         69270001
         IDACB3 ARG=&OBSQVAL,ARGNAME=OBSQVAL,KWTC=X'6E',MF=&MF,        *69320001
               CHKAM=VTAM,AM=&AM                                X04SVHS 69370001
.********************************************************************** 69380001
.*                                      IBSQVAL                         69420001
         IDACB3 ARG=&IBSQVAL,ARGNAME=IBSQVAL,KWTC=X'6F',MF=&MF,        *69470001
               CHKAM=VTAM,AM=&AM                                X04SVHS 69520001
.********************************************************************** 69530001
.*                                      SEQNO                           70750001
         IDACB3 ARG=&SEQNO,ARGNAME=SEQNO,KWTC=X'70',MF=&MF,            *70800001
               CHKAM=VTAM,AM=&AM                                X04SVHS 70850001
.********************************************************************** 70860001
.*                                      USENSEO                         70900001
         IDACB3 ARG=&USENSEO,ARGNAME=USENSEO,KWTC=X'73',MF=&MF,        *71200001
               CHKAM=VTAM,AM=&AM                                X04SVHS 71250001
.********************************************************************** 71260001
.*                                      USENSEI                         71650001
         IDACB3 ARG=&USENSEI,ARGNAME=USENSEI,KWTC=X'74',MF=&MF,        *71700001
               CHKAM=VTAM,AM=&AM                                X04SVHS 71750001
.********************************************************************** 71760001
.*                                      RECLEN                          72100001
         IDACB3 ARG=&RECLEN,ARGNAME=RECLEN,KWTC=X'35',MF=&MF    X04SVHS 72150001
.********************************************************************** 72160001
.*                                      AAREA                           72550001
         IDACB3 ARG=&AAREA,ARGNAME=AAREA,KWTC=X'57',MF=&MF,            *72600001
               CHKAM=VTAM,AM=&AM                                X04SVHS 72650001
.********************************************************************** 72660001
.*                                      AAREALN                         72850001
         IDACB3 ARG=&AAREALN,ARGNAME=AAREALN,KWTC=X'49',MF=&MF,        *72900001
               CHKAM=VTAM,AM=&AM                                X04SVHS 72950001
.********************************************************************** 72960001
.*                                      ARECLEN                         73300001
         IDACB3 ARG=&ARECLEN,ARGNAME=ARECLEN,KWTC=X'4A',MF=&MF,        *73350001
               CHKAM=VTAM,AM=&AM                                X04SVHS 73400001
.********************************************************************** 73410001
.*                                      EXIT                            73450001
         IDACB3 ARG=&EXIT,ARGNAME=EXIT,KWTC=X'4B',MF=&MF,CHKAM=VTAM,   *73500001
               AM=&AM                                           X04SVHS 73550001
.********************************************************************** 73560001
.*                                      NIB                             74650001
         IDACB3 ARG=&NIB,ARGNAME=NIB,KWTC=X'4F',MF=&MF,CHKAM=VTAM,     *74700001
               AM=&AM                                           X04SVHS 74750001
.********************************************************************** 74760001
.*                                      BRANCH                          74800001
.R005250 ANOP                                                   X04SVHS 74810001
         AIF   ('&BRANCH' EQ '').R005400 *** BRANCH ***          X03004 76000001
         IDACB3 ARG=&BRANCH,KWTC=X'58',CHKAM=VTAM,AM=&AM,BIT=YES        76050001
.*                                                              X04SVHS 76060001
&BRYES   SETB  ('&BRANCH' EQ 'YES')                                     76100001
&BRNO    SETB  ('&BRANCH' EQ 'NO')                                      76150001
         AIF   (&BRYES OR &BRNO).R005300 TEST FOR VALID OPTION  X04SVHS 76200001
         IDAERMAC 3,BRANCH,&BRANCH                               X03004 76250001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 76300001
.R005300 ANOP                                                           76350001
         AIF   ('&CALLER' EQ 'RPL').R005350                     X04SVHS 76360001
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               76370001
&IDAVALC(&IDAENO) SETC '&BRYES&BRNO.00000000000000&Z16'          X03004 76550001
         AGO   .R005400                                        @G40AKSL 76560000
.R005350 ANOP                                                   X04SVHS 76561000
&IDABRCH SETC  '&BRYES'                 SET BRANCH CODE         X04SVHS 76562000
.********************************************************************** 76563000
.*                                      CRYPT                  @G40AKSL 76564000
.R005400 ANOP                                                  @G40AKSL 76565000
         AIF   ('&CRYPT' EQ '').R005440      ***CRYPT***       @G40AKSL 76566000
         IDACB3 ARG=&CRYPT,KWTC=X'95',AM=&AM,CHKAM=VTAM,BIT=YES         76567000
&CRYES   SETB  ('&CRYPT' EQ 'YES')                             @G40AKSL 76568000
&CRNO    SETB  ('&CRYPT' EQ 'NO')                              @G40AKSL 76569000
         AIF   (&CRYES OR &CRNO).R005425    TEST FOR VALID OPTION       76570000
         IDAERMAC 3,CRYPT,&CRYPT                               @G40AKSL 76571000
&IDACB01 SETB  1                                               @G40AKSL 76572000
.R005425 ANOP                                                  @G40AKSL 76573000
         AIF   ('&CALLER' EQ 'RPL').R005430                    @G40AKSL 76574000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL      @G40AKSL 76575000
&IDAVALC(&IDAENO) SETC '&CRYES&CRNO.00000000000000&Z16'        @G40AKSL 76576000
         AGO   .R005440                                        @G40AKSL 76577000
.R005430 ANOP                                                  @G40AKSL 76578000
&IDACRYP SETC  '&CRYES'   SET CRYPT CODE                       @G40AKSL 76579000
.********************************************************************** 76591648
.R005440 AIF   ('&CALLER' NE 'RPL').R005450                     X04SVHS 76591748
.*             IF CALLER IS RPL, ALL KEYWORDS HAVE BEEN PROCESSED       76592001
         MEXIT                                                  X04SVHS 76594001
.*                                                                      76600001
.* TEST FOR INCOMPATIBLE VTAM KEYWORDS                           X03004 76700001
.R005450 AIF ('&ARG' EQ '' OR '&NIB' EQ '').R005500              X03004 76750001
         IDAERMAC 19,ARG,NIB                                     X03004 76800001
&IDACB01 SETB  1                                                 X03004 76850001
.R005500 AIF ('&ECB' EQ '' OR '&EXIT' EQ '').R006100             X03004 76900001
         IDAERMAC 19,ECB,EXIT                                    X03004 76950001
&IDACB01 SETB  1                                                 X03004 77450001
.R006100 AIF ('&RBA' EQ '' OR '&SEQNO' EQ '').R006200           X3004BS 77800001
         IDAERMAC 19,RBA,SEQNO                                  X3004BS 77850001
&IDACB01 SETB  1                                                X3004BS 77900001
.R006200 AIF ('&KEYLEN' EQ '' OR '&CHNGDIR' EQ '').R006300      X3004BS 77950001
         IDAERMAC 19,KEYLEN,CHNGDIR                             X3004BS 78000001
&IDACB01 SETB  1                                                X3004BS 78050001
.R006300 AIF ('&KEYLEN' EQ '' OR '&STYPE' EQ '').R006400        X3004BS 78100001
         IDAERMAC 19,KEYLEN,STYPE                               X3004BS 78150001
&IDACB01 SETB  1                                                X3004BS 78200001
.R006400 AIF ('&KEYLEN' EQ '' OR '&RTYPE' EQ '').R006450        X04SVHS 78250001
         IDAERMAC 19,KEYLEN,RTYPE                               X3004BS 78300001
&IDACB01 SETB  1                                                X3004BS 78350001
.R006450 AIF   ('&KEYLEN' EQ '' OR '&BRACKET' EQ '').R006500    X04SVHS 78360001
         IDAERMAC 19,KEYLEN,BRACKET                             X04SVHS 78370001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 78380001
.R006500 ANOP                                                   X04SVHS 78400001
.********************************************************************** 78402001
.*                                      TRANSID                         78410001
         IDACB3 ARG=&TRANSID,ARGNAME=TRANSID,KWTC=X'5F',MF=&MF  X04SVHS 78420001
.********************************************************************** 78430001
.*                                      AM                              78450001
         AIF   ('&AM' EQ '' OR '&CALLER' NE 'GEN').R006700      X04SVHS 78500001
.*             ARGUMENT CONTROL ENTRY IS ONLY BUILT FOR GENCB FOR AM    78510001
&VSAM    SETB  ('&AM' EQ 'VSAM')        CHK FOR AM=VSAM         X04SVHS 78550001
&VTAM    SETB  ('&AM' EQ 'VTAM')        CHK FOR AM=VTAM         X04SVHS 78600001
         AIF   (&VSAM OR &VTAM).R006600                                 78650001
.*             IF NOT VSAM OR VTAM, ERROR                               78700001
         IDAERMAC 5,AM,&AM                                      X04SVHS 78750001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 78800001
.R006600 ANOP                                                   X04SVHS 78850001
         IDACB3 ARG=&AM,KWTC=X'40',BIT=YES                      X04SVHS 78900001
&IDAVALC(&IDAENO) SETC '&VSAM&VTAM.00000000000000&Z16'                  78950001
.********************************************************************** 78960001
.R006700 ANOP                                                   X04SVHS 79000001
         AIF   ('&CALLER' EQ 'GEN' OR '&CALLER' EQ 'MOD').R007500       79500001
.*                                                              X04SVHS 79510001
.*             THE FOLLOWING KEYWORDS ARE VALID ONLY FOR TESTCB         79520001
.*                                                                      79522001
.********************************************************************** 79524001
.*                                      IO                              79530001
         AIF   ('&IO' EQ '').R006900   *** IO ***                       79550001
         IDACB3 ARG=&IO,ARGNAME=IO,KWTC=X'36',MF=&MF,INDRECT=YES,      *79600001
               BIT=YES                                          X04SVHS 79650001
         AIF   ('&IO(1)' EQ '*').R006900                                79700001
.*       IF INDIRECT ADDRESS WAS SPECIFIED, THE VALUE ARRAY(&IDAVALC)   79710001
.*       WAS SET IN IDACB3                                              79720001
&COMPLET SETB  ('&IO' EQ 'COMPLETE')                            X04SVHS 79750001
         AIF   (&COMPLET).R006800       CHK FOR CORRECT OPTION  X04SVHS 79800001
         IDAERMAC 3,IO,&IO                                              79810001
&IDACB01 SETB  1                        SET ERROR SWITCH                79820001
.R006800 ANOP                                                           79830001
&IDAVALC(&IDAENO) SETC '&COMPLET.000000000000000&Z16'           X04SVHS 79850001
.********************************************************************** 79860001
.R006900 ANOP                                                           79900001
.*                                      FDBK                            80410001
         IDACB3 ARG=&FDBK,ARGNAME=FDBK,KWTC=X'38',MF=&MF        X04SVHS 80420001
.********************************************************************** 80430001
.*                                      RBA                             80450001
         IDACB3 ARG=&RBA,ARGNAME=RBA,KWTC=X'39',MF=&MF          X04SVHS 80500001
.********************************************************************** 80510001
.*                                      AIXPC                           80750001
         IDACB3 ARG=&AIXPC,ARGNAME=AIXPC,KWTC=X'3A',MF=&MF      X04SVHS 80800001
.********************************************************************** 80810001
         AIF   ('&AIXFLAG' EQ '').R007100 ** AIXFLAG ***        X04SVHS 81450001
&PRIME   SETB  ('&AIXFLAG' EQ 'AIXPKP')                        @XM07772 81750001
         AIF   (&PRIME).R007000                                @XM07772 81810001
.*                                      CHK FOR VALID OPTION SPEC       81820001
         IDAERMAC 5,AIXFLAG,&AIXFLAG                            X04SVHS 81850001
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 81900001
.R007000 ANOP                                                   X04SVHS 82000001
         IDACB3 ARG=&AIXFLAG,KWTC=X'3B',BIT=YES                 X04SVHS 82300001
&IDAVALC(&IDAENO) SETC '&PRIME.000000000000000&Z16'            @XM07772 82450001
.********************************************************************** 82450401
.R007100 ANOP                                                   X04SVHS 82452001
.*                                      USER                            82460001
         IDACB3 ARG=&USER,ARGNAME=USER,KWTC=X'4E',MF=&MF,              *82470001
               CHKAM=VTAM,AM=&AM                                X04SVHS 82480001
.********************************************************************** 82490001
.*                                      RTNCD                           82500001
         IDACB3 ARG=&RTNCD,ARGNAME=RTNCD,KWTC=X'5E',MF=&MF      X04SVHS 82550001
.********************************************************************** 82560001
.*                                      FDBK2                           82950001
         IDACB3 ARG=&FDBK2,ARGNAME=FDBK2,KWTC=X'60',MF=&MF      X04SVHS 83000001
.********************************************************************** 83010001
.*                                      SENSE                           83250001
         IDACB3 ARG=&SENSE,ARGNAME=SENSE,KWTC=X'61',MF=&MF,            *83300001
               CHKAM=VTAM,AM=&AM                                X04SVHS 83350001
.********************************************************************** 83360001
.*                                      REQ                             83550001
         IDACB3 ARG=&REQ,ARGNAME=REQ,KWTC=X'62',MF=&MF          X04SVHS 83600001
.********************************************************************** 83610001
.*                                      DATAFLG                         83650001
         AIF   ('&DATAFLG' EQ '').R007400 *** DATAFLG ***       X04SVHS 84300001
         IDACB3 ARG=&DATAFLG,KWTC=X'5D',CHKAM=VTAM,AM=&AM,BIT=YES       84350001
.*                                                              X04SVHS 84360001
&I       SETA  0                                                 X03004 84700001
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 84710001
.R007200 ANOP                                                    X03004 84750001
&I       SETA  &I+1                     BUMP INDEX INTO LIST     X03004 84800001
         AIF   (&I GT N'&DATAFLG).R007300 CHECK FOR END OF LIST  X03004 84850001
&UNSOL   SETB  ('&DATAFLG(&I)' EQ 'UNSOL' OR &UNSOL)             X03004 84900001
&EOB     SETB  ('&DATAFLG(&I)' EQ 'EOB' OR &EOB)                 X03004 84950001
&EOM     SETB  ('&DATAFLG(&I)' EQ 'EOM' OR &EOM)                 X03004 85000001
&EOT     SETB  ('&DATAFLG(&I)' EQ 'EOT' OR &EOT)                 X03004 85050001
&LOGOFF  SETB  ('&DATAFLG(&I)' EQ 'LOGOFF' OR &LOGOFF)           X03004 85100001
&LG      SETB  ('&DATAFLG(&I)' EQ 'LG' OR &LG)                   X03004 85150001
&SOH     SETB  ('&DATAFLG(&I)' EQ 'SOH' OR &SOH)                 X03004 85200001
         AIF   (&UNSOL+&EOB+&EOM+&EOT+&LOGOFF+&LG+&SOH+&A EQ &I).R00720*85210001
               0                                                X04SVHS 85212001
                                        TEST FOR VALID OPTION SPEC      85220001
         IDAERMAC 5,DATAFLG,&DATAFLG(&I)                         X03004 85250001
&IDACB01 SETB  1                        SET ERROR SWITCH         X03004 85300001
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 85310001
         AGO   .R007200                                          X03004 85350001
.R007300 ANOP                                                    X03004 86450001
&IDAVALC(&IDAENO) SETC '&UNSOL&EOB&EOM&EOT&LOGOFF&LG&SOH.000000000&Z16' 86500001
.*                                                              X04SVHS 86510001
.********************************************************************** 86520001
.R007400 ANOP                                                   X04SVHS 86550001
.*                                      FTNCD                           86600001
         IDACB3 ARG=&FTNCD,ARGNAME=FTNCD,KWTC=X'63',MF=&MF              86610001
.********************************************************************** 86620001
.R007500 ANOP                                                           86660001
         MEND                                                           87050003
