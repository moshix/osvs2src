         MACRO                                                          00100021
&NAME    IECRES &FUNC,&IDTTR,&BCODE,&STM=,&LV=,&A=,&SP=,&KEY=,   Y02080*00150002
               &ID=,&PREFIX=,&EXTPR=,&MODID=,&MODNM=,&BRCODE=,   Y02080*00200002
               &EXITAD=,&REG0=,&REG1=,                           Y02082*00250002
               &DEB=,                                            Y02134*00300002
               &DCBCOPY=,                                        Y02082*00350002
               &BRANCH=,&EPA=,&REUSE=                            Y02080 00400002
.*                                                               Y02080 00450002
.*       MACRO DELETIONS/CHANGES FOR VS2 RELEASE 2                      00500002
.*                                                                      00600002
.*                                                                      00650002
.********************************************************************** 00700002
.*                                                                      00750002
.* MODULE NAME = IECRES (VS2-2)                                         00800002
.*                                                                      00850002
.* DESCRIPTIVE NAME = OPEN/CLOSE/EOV/DADSM SERVICE ROUTINE MACRO        00900002
.*                                                                      00950002
.* COPYRIGHT = NONE                                                     01000002
.*                                                                      01050002
.* STATUS = CHANGE LEVEL 000                                            01100002
.*                                                                      01150002
.* FUNCTION = THERE ARE TWELVE FUNCTIONS WHICH CAN BE SPECIFIED FOR     01200002
.*            THE IECRES MACRO.  NINE OF THESE FUNCTIONS SET UP THE     01210002
.*            VARIOUS INTERFACES TO THE OPEN/CLOSE/EOV/DADSM SERVICE    01220002
.*            ROUTINE (IFG019RA):                                       01250002
.*                                                                      01350002
.*            IFG019RA+0  - ENTRY FOR WAIT FACILITY                     01400002
.*            IFG019RA+4  - ENTRY FOR SELECT-LOAD FACILITY              01450002
.*            IFG019RA+8  - ENTRY FOR DCB SYNCHRONIZATION FACILITY      01500002
.*            IFG019RA+12 - ENTRY FOR QMNGRIO FACILITY                  01550002
.*            IFG019RA+20 - ENTRY FOR LOAD AND BRANCH FACILITY          01600002
.*            IFG019RA+24 - ENTRY FOR LOAD AND RETURN FACILITY          01650002
.*            IFG019RA+28 - ENTRY FOR GET WORK AREA FACILITY            01700002
.*            IFG019RA+32 - ENTRY FOR GET WTG/EOV WORK AREA FACILITY    01750002
.*            IFG019RA+36 - ENTRY FOR GET FIRST WORK AREA FACILITY      01800002
.*            IFG019RA+40 - ENTRY TO INITIALIZE PREFIX=FIRST WKAREA     01850002
.*            IFG019RA+44 - ENTRY TO INITIALIZE AND/OR COPY THE DCB     01900002
.*            IFG019RA+48 - ENTRY FOR FREE WORK AREA FACILITY           01950002
.*            IFG019RA+52 - ENTRY FOR FREE FIRST OR WTG/EOV FACILITY    02000002
.*            IFG019RA+56 - ENTRY FOR UEXIT FACILITY                    02050002
.*                                                                      02060002
.*            THE OTHER THREE FUNCTIONS (IECRES BRANCH, IECRES EXIT,    02070002
.*            AND IECRES LOCJFCB) DO NOT SET UP AN INTERFACE TO         02080002
.*            IFG019RA, BUT MERELY GENERATE EXECUTABLE CODE.            02090002
.*                                                                      02100002
.* NOTES = SEE BELOW                                                    02150002
.*                                                                      02200002
.*      DEPENDENCIES = THE USE OF IECRES XCTL,&IDTTR,&BCODE USES        02250002
.*                     THE BRT=NO EXPANSION OF THE XCTLTABL MACRO.      02300002
.*                                                                      02350002
.*                     SOME OF THE MACRO FUNCTIONS USE SYMBOLS WHICH    02400002
.*                     MUST BE EQUATED SOMEHOW IN THE CALLING MODULE.   02450002
.*                                                                      02500002
.*                     SYMBOL     FUNCTION USING THE SYMBOL             02550002
.*                                                                      02600002
.*                     EOVSIZE    IECRES GET,PREFIX=EOV                 02650002
.*                     RES        IECRES LOAD,BRANCH=QUEUED             02850002
.*                                IECRES SYNCH                          02900002
.*                                IECRES WAIT                           02950002
.*                                IECRES XCTL                           03000002
.*                     RESSYNCH   IECRES SYNCH                          03050002
.*                     RESXCTL    IECRES LOAD,BRANCH=QUEUED             03100002
.*                                IECRES XCTL                           03150002
.*                     RWTGC      IECRES LOAD,BRANCH=QUEUED             03200002
.*                                IECRES XCTL                           03250002
.*                                                                      03300002
.*                     ADDITIONALLY, ALMOST ALL OF THE FOURTEEN         03350002
.*                     FUNCTIONS REFERENCE FIELDS DEFINED IN THE        03400002
.*                     PREFIX, EXTENDED PREFIX, OR WTG TABLE PORTIONS   03450002
.*                     OF THE OPEN/CLOSE/EOV OR DADSM WORK AREAS.       03500002
.*                                                                      03550002
.*      RESTRICTIONS = ONLY THE OPEN, CLOSE, AND EOV ROUTINES           03600002
.*                     (INCLUDING RDJFCB) USE THE WAIT, SELECT-LOAD,    03650002
.*                     SYNCH DCB, QMNGRIO, GET WTG/EOV, INIT/COPY,      03700002
.*                     AND UEXIT FACILITIES.                            03750002
.*                     ONLY DADSM ROUTINES, TASK CLOSE, AND THE         03800002
.*                     RECOVERY ROUTINES USE THE GET FIRST AND          03810002
.*                     INITIALIZE PREFIX=FIRST FACILITIES.              03850002
.*                                                                      03900002
.*      REGISTER CONVENTIONS = NOT APPLICABLE                           03950002
.*                                                                      04000002
.* PATCH LABEL = NOT APPLICABLE                                         04050002
.*                                                                      04100002
.* MODULE TYPE = MACRO                                                  04150002
.*                                                                      04200002
.*      PROCESSOR = ASSEMBLER LANGUAGE                                  04250002
.*                                                                      04300002
.*      MODULE SIZE = NOT APPLICABLE                                    04350002
.*                                                                      04400002
.*      ATTRIBUTES = NOT APPLICABLE                                     04450002
.*                                                                      04500002
.* ENTRY POINT = NOT APPLICABLE                                         04550002
.*                                                                      04600002
.*      PURPOSE = SEE FUNCTION                                          04650002
.*                                                                      04700002
.*      LINKAGE = LABEL IECRES &FUNC,&IDTTR,&BCODE,KEYWORDS=            04750002
.*                                                                      04800002
.*      INPUT =   OPTIONAL LABEL SPECIFIED AS AN ACCEPTABLE ASSEMBLER   05050002
.*                LABEL WHICH CAN BE USED BY THE CALLING CSECT.         05100002
.*                                                                      05150002
.*                                                                      05200002
.*                &FUNC IS THE FIRST POSITIONAL PARAMETER.  THE         05250002
.*                FUNCTIONS WHICH CAN BE SPECIFIED FOR IECRES ARE:      05300002
.*                                                                      05350002
.*                BRANCH   - GENERATES CODE TO BRANCH ON THE CONTENTS   05400002
.*                           OF A REGISTER                              05450002
.*                EXIT     - GENERATES CODE TO LOAD REGISTERS AND       05500002
.*                           RETURN                                     05550002
.*                FREE     - BUILDS THE INTERFACE FOR BOTH OF THE       05600002
.*                           FREE WORK AREA FACILITIES                  05610002
.*                GET      - BUILDS THE INTERFACE FOR ALL THREE GET     05620002
.*                           WORK AREA FACILITIES                       05630002
.*                INIT     - BUILDS THE INTERFACE FOR THE INITIALIZE-   05650002
.*                           DCB COPY FACILITY                          05700002
.*                LOAD     - BUILDS THE INTERFACE FOR ALL THREE LOAD    05750002
.*                           FACILITIES                                 05800002
.*                LOCJFCB  - GENERATES CODE TO INCREMENT PAST THE JFCB  05850002
.*                           PREFIX                                     05900002
.*                SYNCHDCB - BUILDS THE INTERFACE FOR THE DCB SYNCHRO-  05950002
.*                           NIZATION FACILITY                          06000002
.*                UEXIT    - BUILDS THE INTERFACE FOR THE USER EXIT     06050002
.*                           FACILITY                                   06100002
.*                WAIT     - BUILDS THE INTERFACE FOR THE WAIT FACILITY 06150002
.*                WRJFCB   - BUILDS THE INTERFACE FOR THE QMNGRIO       06200002
.*                           FACILITY                                   06250002
.*                XCTL     - BUILDS THE INTERFACE FOR THE SELECT-LOAD   06300002
.*                           FACILITY                                   06350002
.*                                                                      06400002
.*                                                                      06450002
.*                &IDTTR, THE SECOND POSITIONAL PARAMETER, IS OPTIONAL. 06500002
.*                IT CAN BE USED WITH FOUR OF THE IECRES FUNCTIONS.     06550002
.*                                                                      06600002
.*                FOR IECRES GET/FREE, IF &IDTTR IS SPECIFIED (AS THE   06650002
.*                CHARACTERS 'WLH' WHICH STAND FOR 'WITH LOCK HELD'),   06700002
.*                THEN IFG019RA DOES NOT ACQUIRE THE LOCAL LOCK.        06750002
.*                                                                      06800002
.*                FOR IECRES LOCJFCB, &IDTTR IS THE NAME OF A REGISTER  06850002
.*                WHICH POINTS TO A WORD CONTAINING THE JFCB PREFIX     06900002
.*                ADDRESS.                                              06950002
.*                                                                      07000002
.*                FOR IECRES WRJFCB, &IDTTR IS THE NAME OF A REGISTER   07050002
.*                WHICH POINTS TO 3 BYTES CONTAINING THE JFCB PREFIX    07100002
.*                ADDRESS.                                              07150002
.*                                                                      07200002
.*                FOR IECRES XCTL, IF &IDTTR IS SPECIFIED, IT MUST      07210002
.*                POINT TO THE ID AND TTR OF A MODULE TO WHICH CONTROL  07220002
.*                SHOULD BE GIVEN BY IFG019RA.                          07230002
.*                                                                      07250002
.*                                                                      07300002
.*                &BCODE, THE THIRD POSITIONAL PARAMETER IS OPTIONAL.   07350002
.*                IT CAN BE USED WITH TWO OF THE IECRES FUNCTIONS.      07400002
.*                                                                      07450002
.*                FOR IECRES WRJFCB, &BCODE IS THE NAME OF A REGISTER   07500002
.*                WHICH POINTS TO THE JFCB TO BE 'WRITTEN' TO SWA.      07550002
.*                                                                      07600002
.*                FOR IECRES XCTL, IF &BCODE IS SPECIFIED, IT IS THE    07650002
.*                NAME OF A REGISTER WHICH CONTAINS THE BRANCH TABLE    07700002
.*                OFFSET.                                               07750002
.*                                                                      07800002
.*                                                                      07850002
.*                THE OPTIONAL KEYWORD PARAMETERS ARE:                  07900002
.*                                                                      07950002
.*                A=                                                    08000002
.*                BRANCH=                                               08050002
.*                BRCODE=                                               08100002
.*                DCBCOPY=                                              08150002
.*                DEB=                                                  08200002
.*                EPA=                                                  08250002
.*                EXITAD=                                               08300002
.*                EXTPR=                                                08350002
.*                ID=                                                   08400002
.*                KEY=                                                  08450002
.*                LV=                                                   08500002
.*                MODID=                                                08550002
.*                MODNM=                                                08600002
.*                PREFIX=                                               08650002
.*                REG0=                                                 08700002
.*                REG1=                                                 08750002
.*                REUSE=                                                08800002
.*                SP=                                                   08850002
.*                STM=                                                  08900002
.*                                                                      10250002
.*                                                                      10300002
.*      OUTPUT = INTERFACE TO IFG019RA                                  10350002
.*                                                                      10400002
.* EXIT-NORMAL = MEXIT OR MEND STATEMENT                                10950002
.*                                                                      11000002
.* EXIT-ERROR = ERROR MESSAGES:                                         11050002
.*                                                                      11100002
.*      MNOTE 8,***** INVALID FUNCTION - &FUNC                          11150002
.*      MNOTE 4,WAIT CAN HAVE NO PARAMETERS                             11200002
.*      MNOTE 4,XCTL CAN HAVE ONLY 2 PARAMETERS                         11250002
.*      MNOTE 4,SYNCHDCB CAN HAVE NO PARAMETERS                         11300002
.*      MNOTE 4,LV ONLY ON FREE PREFIX=NO                               11350002
.*      MNOTE 4,SP ONLY ON FREE PREFIX=NO                               11400002
.*      MNOTE 4,KEY ONLY ON FREE PREFIX=NO                              11450002
.*      MNOTE 4,ID= INVALID FOR FREE                                    11500002
.*      MNOTE 8,CODE PREFIX OR EXTPR WITH GET OR FREE                   11550002
.*      MNOTE 8,STM ON LAST FREE INVALID                                11600002
.*      MNOTE 8,STM MUST HAVE 3 PARAMETERS                              11650002
.*      MNOTE 8,STM ERROR - GET RETURNS ADDR OF AREA IN R1              11700002
.*      MNOTE 8,A= ADDR OF DCB PARAM LIST                               11750002
.*      MNOTE 8,A= ADDR TO FREE OR GET PREFIX ADDR MISSING              11800002
.*      MNOTE 8,LV= LENGTH MISSING                                      11850002
.*      MNOTE 8,PREFIX=&PREFIX INCOMPATIBLE WITH GET REQUEST            11900002
.*      MNOTE 8,PREFIX OR EXTPR PARAMETER REQUIRED FOR LOAD UNLESS      11950002
.*            BRANCH=QUEUED                                             12000002
.*      MNOTE 8,BRANCH PARAMETER INVALID                                12100002
.*      MNOTE 8,BRANCH PARAMETER REQUIRED FOR LOAD                      12150002
.*      MNOTE 8,DEB= OR DCBCOPY= MUST BE CODED                          12200002
.*      MNOTE 8,INITIAL CALL ALWAYS TOWKAR                              12250002
.*      MNOTE 12,***  IHB002 INVALID DEB OPERAND SPECIFIED-&DEB         12300002
.*      MNOTE 12,***  IHB002 INVALID DCBCOPY OPERAND SPECIFIED-&DCBCOPY 12350002
.*                                                                      12400002
.* EXTERNAL REFERENCES = NONE                                           12550002
.*                                                                      12600002
.*      ROUTINES = NONE                                                 12800002
.*                                                                      12850002
.*      DATA AREAS = NONE                                               12900002
.*                                                                      12950002
.*      CONTROL BLOCKS = CVT                                            13150002
.*                                                                      13200002
.* TABLES = EOV WORK AREA                                               13400002
.*          OPEN/CLOSE WORK AREA                                        13450002
.*          OPEN/CLOSE WTG TABLE                                        13500002
.*          VARIOUS DADSM WORK AREAS                                    13550002
.*                                                                      13600002
.* MACROS = IHBERMAC                                                    13800002
.*          MODESET                                                     13850002
.*          RETURN                                                      13900002
.*                                                                      13950002
.* CHANGE ACTIVITY = SEE DELETIONS/CHANGES PRECEDING THE MACRO PROLOGUE 14100002
.*                                                                      14150002
.********************************************************************** 14200002
.*                                                                      14250002
         LCLA  &IECPRFX,&CODE                                    Y02080 14300002
         LCLC  &PREFX                                            Y02080 14350002
.*                                                                      14400002
         AIF   ('&FUNC' EQ 'WAIT').WAIT  WAITS ON DXECB IN WORK AREA    14450002
         AIF   ('&FUNC' EQ 'XCTL').XCTL  XCTL TO NEXT MODULE            14500002
         AIF   ('&FUNC' EQ 'SYNCHDCB').SYNCHDC ALL DCB'S TO SAME POINT  14550002
         AIF   ('&FUNC' EQ 'UEXIT').IECE000 USER EXIT EXPANSION  Y02082 14600002
         AIF   ('&FUNC' EQ 'LOAD').LOAD GET MODULE EPA           Y02080 14650002
         AIF   ('&FUNC' EQ 'BRANCH').BRANCH BRANCH TO MODULE     Y02080 14700002
         AIF   ('&FUNC' EQ 'GET').IECA000 LINK TO GETMAIN        Y02080 14750002
         AIF   ('&FUNC' EQ 'FREE').IECA000 LINK TO FREEMAIN      Y02080 14800002
         AIF   ('&FUNC' EQ 'LOCJFCB').IECB000 GO TO READ JFCB    Y02080 14850002
         AIF   ('&FUNC' EQ 'WRJFCB').IECC000 GO TO WRITE JFCB    Y02080 14900002
         AIF   ('&FUNC' EQ 'INIT').IECA000 LINK TO INITIALIZE    Y02134 14950002
         AIF   ('&FUNC' EQ 'EXIT').IECD000 SET UP CALLER RETURN  Y02134 15000002
.*                                                                      15050002
         MNOTE 8,'***** INVALID FUNCTION - &FUNC'                Y02080 15100002
&NAME    DC    H'0'                     DEFINE NAME, HALT EXECUTION     15150002
         MEXIT                                                          15200002
.********************************************************************** 15250002
.*       FUNCTION = WAIT                                                15300002
.********************************************************************** 15350002
.WAIT    AIF   (N'&SYSLIST EQ 1).WAIT1                                  15400002
         MNOTE 4,'WAIT CAN HAVE NO PARAMETERS'                          15450002
.WAIT1   ANOP                                                           15500002
&NAME    BALR  14,RES                   BRANCH TO WAIT SUBROUTINE       15550002
         MEXIT                                                          15600002
.********************************************************************** 15650002
.*       FUNCTION = XCTL                                                15700002
.********************************************************************** 15750002
.XCTL    AIF   (N'&SYSLIST LE 3).XCTL1                                  15800002
         MNOTE 4,'XCTL CAN HAVE ONLY 2 PARAMETERS'                      15850002
.XCTL1   AIF   ('&IDTTR' EQ '').XCTL6                                   15900002
.*                                                                      15950002
         AIF   ('&IDTTR'(1,1) EQ '(').XCTL2                             16000002
&NAME    MVC   0(5,RWTGC),&IDTTR        MOVE ID & TTR INTO WTG TABLE    16050002
         AGO   .XCTL3                                                   16100002
.XCTL2   ANOP                                                           16150002
&NAME    MVC   0(5,RWTGC),0&IDTTR       MOVE ID & TTR INTO WTG TABLE    16200002
.XCTL3   AIF   ('&BCODE' EQ '').XCTL4A                                  16250002
         AIF   ('&BCODE'(1,1) EQ '(').XCTL4                             16300002
         LA    14,&BCODE.(,0)           LOAD BRANCH TABLE OFFSET/INDR   16350002
         AGO   .XCTL4A                                                  16400002
.XCTL4   AIF   ('&BCODE' EQ '(14)').XCTL4A                              16450002
         LR    14,&BCODE(1)             LOAD BRANCH TABLE OFFSET/INDR   16550002
.XCTL4A  AIF   ('&IDTTR'(1,1) EQ '(').XCTL4B                            16600002
         ICM   14,8,&IDTTR+5            INSERT LENGTH IN HI ORDER BYTE  16650002
         AGO   .XCTL5                                                   16700002
.XCTL4B  ICM   14,8,5&IDTTR             INSERT LENGTH IN HI ORDER BYTE  16750002
.XCTL5   B     RESXCTL(,RES)            BRANCH TO IFG019RA TO DO XCTL   16800002
         MEXIT                                                          16850002
.*                                                                      16900002
.XCTL6   AIF   ('&BCODE' EQ '').XCTL9                                   16950002
         AIF   ('&BCODE'(1,1) EQ '(').XCTL7                             17000002
&NAME    LA    14,&BCODE.(,0)           LOAD BRANCH TABLE OFFSET/INDR   17050002
         AGO   .XCTL8                                                   17100002
.XCTL7   AIF   ('&BCODE' EQ '(14)').XCTL9                               17150002
&NAME    LR    14,&BCODE(1)             LOAD BRANCH TABLE OFFSET/INDR   17250002
.XCTL8   B     RESXCTL(,RES)            BRANCH TO IFG019RA TO DO XCTL   17300002
         MEXIT                                                          17350002
.*                                                                      17400002
.XCTL9   ANOP                                                           17450002
&NAME    B     RESXCTL(,RES)            BRANCH TO IFG019RA TO DO XCTL   17500002
         MEXIT                                                          17550002
.********************************************************************** 17600002
.*       FUNCTION = SYNCHDCB                                            17650002
.********************************************************************** 17700002
.SYNCHDC AIF   (N'&SYSLIST EQ 1).SYNCHD1                                17750002
         MNOTE 4,'SYNCHDCB CAN HAVE NO PARAMETERS'                      17800002
.SYNCHD1 ANOP                                                           17850002
&NAME    BAL   14,RESSYNCH(,RES)       BRANCH TO SYNCH DCB SUBROUTINE   17900002
         MEXIT                                                   Y02080 17950002
.********************************************************************** 18000002
.*       FUNCTION = GET, FREE, OR INIT                                  18050002
.********************************************************************** 18100002
.IECA000 AIF   ('&NAME' EQ '').IECA010  IF NAME OMITTED          Y02080 18150002
&NAME    DS    0H                       LABEL AND ALIGN                 18200002
.***                                                             Y02080 18250002
.*       CHECK IF VALID CALL                                     Y02080 18300002
.***                                                             Y02080 18350002
.IECA010 ANOP                                                    Y02080 18400002
&PREFX   SETC  '&PREFIX'                SET TO SPECIFIED VALUE   Y02080 18450002
&CODE    SETA  0                        SET RECOVERY CODE TO 0   Y02134 18500002
         AIF   ('&PREFX' NE '').IECA015 TEST IF SPECIFIED        Y02080 18550002
         AIF   (T'&EXTPR EQ 'O').IECA014  TEST IF SPECIFIED      YM1410 18600002
&PREFX   SETC  'YES'                    INDICATE PREFIX EXISTS   YM1410 18650002
         AGO   .IECA015                                          YM1410 18700002
.IECA014 ANOP                                                    YM1410 18750002
&PREFX   SETC  'NO'                     SET TO DEFAULT           Y02080 18800002
.IECA015 AIF   ('&PREFX'(1,1) NE 'R').IECA016 CHECK FOR RECOVERY Y02080 18850002
         AIF   ('&FUNC' EQ 'GET').IECA930 GET RWTG INVALID       Y02134 18900002
&PREFX   SETC  '&PREFX'(2,K'&PREFX-1)   INDICATE PROPER ENTRY    Y02080 18950002
&CODE    SETA  1                        SET RECOVERY CODE TO 1   Y02134 19000002
.IECA016 AIF   ('&FUNC' NE 'INIT' AND T'&EXTPR EQ 'O' AND              *19050002
               '&PREFIX' EQ '').IECA900                          Y02080 19100002
         AIF   (T'&STM EQ 'O').IECA100 NO STM                    Y02080 19150002
.***                                                             Y02080 19200002
.*       STM PROCESSING                                          Y02080 19250002
.***                                                             Y02080 19300002
         AIF   ('&FUNC' NE 'FREE').IECA020 STM ALWAYS ALLOWED GETY02080 19350002
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV' OR              *19400002
               '&PREFX' EQ 'FIRST').IECA905 NO STM FOR LAST      Y02080 19450002
.IECA020 AIF   (N'&STM NE 3).IECA910    STM CODED BAD            Y02080 19500002
         AIF   ('&FUNC' NE 'GET').IECA040 GO TO INIT RESTRICTIONSY02080 19550002
         AIF   ('&STM(1)' EQ '0' OR '&STM(1)' EQ '1' OR                *19600002
               '&STM(1)' EQ '(R0)' OR '&STM(1)' EQ '(R1)').IECA913     *19650002
                                        GET RTNS ADDR AREA IN R1 Y02080 19700002
.***                                                                    19750002
.*       STM GEN                                                        19800002
.***                                                                    19850002
.IECA040 AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV' OR              *19900002
               '&PREFX' EQ 'FIRST' OR '&PREFX' EQ 'EXTPR').IECA050     *19950002
                                        FIRST TIMERS             Y02080 20000002
         AIF   ('&STM(3)' EQ 'DXXPREFX' OR '&STM(3)' EQ 'WTGPREFX').IEC*20050002
               A060                     CHECK FOR STD SAVE AREA  Y02080 20100002
.IECA050 ANOP                                                    Y02080 20150002
         STM   &STM(1),&STM(2),&STM(3)  SAVE REGISTERS                  20200002
         LA    15,&STM(3)               ADDRESS OF REGISTER SAVE AREA   20250002
         AGO   .IECA100                 PROC A=                  Y02080 20300002
.IECA060 ANOP                                                    Y02080 20350002
         L     15,&STM(3)               GET ADDRESS OF PREFIX           20400002
         LA    15,IECREGSV-IECPREFX(,15) ADDR OF REGISTER SAVE AREA     20450002
         STM   &STM(1),&STM(2),0(15)    SAVE REGISTERS                  20500002
.***                                                             Y02080 20550002
.*       A = ADDRESS OF WORK AREA FOR GET,PREFIX=YES OR                 20600002
.*           ADDRESS OF PREFIX FOR GET WITH DEFAULT OF PREFIX=NO OR     20650002
.*           ADDRESS OF A DCB PARAMETER LIST FOR GET,PREFIX=WTG/EOV     20700002
.***                                                             Y02080 20750002
.IECA100 AIF   ('&FUNC' EQ 'INIT').INIT100 INIT PROC             Y02080 20800002
         AIF   (T'&EXTPR NE 'O').IECA105 EXTPR= ADDR OF W/A      Y02080 20850002
         AIF   ('&FUNC' EQ 'FREE').IECA140 FREE PROC             Y02080 20900002
         AIF   ('&PREFX' EQ 'FIRST').IECA135 1ST GET EXPANSION   Y02080 20950002
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA125        *21000002
                                        WTG, EOV ADDR OF PARMS   Y02080 21050002
         AIF   ('&PREFX' EQ 'YES').IECA120 GET YES EXPAN         Y02080 21100002
         AIF   ('&PREFX' EQ 'NO').IECA200 NO PREFIX IN R1        Y02080 21150002
.***                                                                    21200002
.*       GET EXTPR PROCESSING                                           21250002
.***                                                                    21300002
.IECA105 AIF   ('&EXTPR'(1,1) EQ '(').IECA110 REG FORM           Y02080 21350002
         LA    1,&EXTPR                 ADDRESS OF EXTENDED PREFIX      21400002
         AGO   .IECA200                 CONTINUE                 Y02080 21450002
.IECA110 AIF   ('&EXTPR' EQ '(1)' OR '&EXTPR' EQ '(R1)').IECA200 Y02080*21500002
                                        RIGHT REGISTER ALREADY   Y02080 21550002
         LR    1,&EXTPR(1)              ADDRESS OF EXTENDED PREFIX      21600002
         AGO   .IECA200                 CONTINUE                 Y02080 21650002
.***                                                                    21700002
.*       GET PREFIX=YES                                                 21750002
.***                                                                    21800002
.IECA120 ANOP                                                    Y02080 21850002
         AIF   (T'&STM EQ 'O').IECA140  CHECK A=                 Y02080 21900002
         AIF   ('&STM(3)' EQ 'WTGPREFX' OR '&STM(3)' EQ 'DXXPREFX').IEC*21950002
               A122                     CHECK FOR A=             Y02080 22000002
         AIF   ('&STM(3)'(1,8) NE 'IECREGSV').IECA140 BASE NOT   Y02080*22050002
                                        IMPLIED BY SAVE          Y02080 22100002
.IECA122 ANOP                                                    Y02080 22150002
         LR    1,15                     GET PREFIX ADDRESS              22200002
         AGO   .IECA200                 CONTINUE                 Y02080 22250002
.IECA125 AIF   (T'&A EQ 'O').IECA917    NO ADDR OF DCBLIST       Y02080 22300002
         AIF   ('&A' EQ '(1)').IECA200  RIGHT REG                Y02080 22350002
         LR    1,&A(1)                  ADDRESS OF DCB PARAMETER LIST   22400002
         AGO   .IECA200                 CONTINUE                 Y02080 22450002
.***                                                                    22500002
.*       GET FIRST PREFIX                                               22550002
.***                                                                    22600002
.IECA135 ANOP                                                    Y02080 22650002
         SR    1,1                      NO PREVIOUS PREFIX              22700002
         AGO   .IECA200                 CONTINUE                 Y02080 22750002
.***                                                                    22800002
.*       FREE                                                           22850002
.***                                                                    22900002
.IECA140 AIF   (T'&A EQ 'O').IECA920    NO ADDR FOR FREE OR GET HAS    *22950002
                                        NO ADDRESSABILITY TO PREFIX     23000002
         AIF   ('&PREFX' EQ 'WTG').IECA160 A PTS TO THE WTG TABL Y02080 23050002
         AIF   ('&PREFX' EQ 'EOV').IECA170 A PTS TO THE WTG TABL Y02080 23100002
         AIF   ('&A'(1,1) EQ '(').IECA150 REG FORM               Y02080 23150002
         LA    1,&A                     ADDRESS OF WORK AREA            23200002
         AGO   .IECA200                 CONTINUE                 Y02080 23250002
.IECA150 AIF   ('&A' EQ '(1)' OR '&A' EQ '(R1)').IECA200  REG OK Y02080 23300002
         LR    1,&A(1)                  ADDRESS OF WORK AREA            23350002
         AGO   .IECA200                 CONTINUE                 Y02080 23400002
.***                                                                    23450002
.*       A = ADDRESS OF WTG TABLE                                       23500002
.***                                                                    23550002
.IECA160 AIF   ('&A'(1,1) EQ '(').IECA165 REG FORM               Y02080 23600002
         L     1,WTGPREFX-WTG+&A        ADDRESS OF BASE PREFIX          23650002
         AGO   .IECA180                 INCR PAST BASE           Y02080 23700002
.IECA165 ANOP                                                    Y02080 23750002
         L     1,WTGPREFX-WTG&A         ADDRESS OF BASE PREFIX          23800002
         AGO   .IECA180                 INCR PAST BASE           Y02080 23850002
.***                                                                    23900002
.*       A = ADDRESS OF EOV WORK AREA                                   23950002
.***                                                                    24000002
.IECA170 AIF   ('&A'(1,1) EQ '(').IECA175 REG FORM               Y02080 24050002
         L     1,DXXPREFX-FORCORE+&A    ADDRESS OF BASE PREFIX          24100002
         AGO   .IECA180                 INCR PAST BASE           Y02080 24150002
.IECA175 ANOP                                                    Y02080 24200002
         L     1,DXXPREFX-FORCORE&A     ADDRESS OF BASE PREFIX          24250002
.IECA180 ANOP                                                    Y02080 24300002
         LA    1,IECSTART-IECPREFX(,1)  INCREMENT PAST BASE PREFIX      24350002
.***                                                             Y02080 24400002
.*       LV = LENGTH OF WORK AREA                                Y02080 24450002
.***                                                             Y02080 24500002
.IECA200 AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'NO').IECA210  Y02080 24550002
         AIF   ('&FUNC' EQ 'GET').IECA210 GET MUST HAVE LV       Y02080 24600002
         AIF   (T'&LV EQ 'O').IECA300   OK NO LENGTH             Y02080 24650002
         MNOTE 4,'LV ONLY ON FREE PREFIX=NO'                     Y02080 24700002
         AGO   .IECA300                 CONTINUE                 Y02080 24750002
.IECA210 AIF   ('&PREFX' EQ 'WTG').IECA240  OPEN OR CLOSE WTG TABLE     24800002
         AIF   ('&PREFX' EQ 'EOV').IECA230  EOV WORK AREA        Y02080 24850002
         AIF   (T'&LV EQ 'O').IECA925   LV ON GET FREE NO        Y02080 24900002
         AIF   ('&LV'(1,1) EQ '(').IECA220 REG FORM              Y02080 24950002
         LA    0,&LV.(,0)               LENGTH OF WORK AREA             25000002
         AGO   .IECA300                 CONTINUE                 Y02080 25050002
.IECA220 AIF   ('&LV' EQ '(0)' OR '&LV' EQ '(R0)').IECA300 REG OKY02080 25250002
         LR    0,&LV(1)                 LENGTH OF WORK AREA             25300002
         AGO   .IECA300                 CONTINUE                 Y02080 25350002
.IECA230 ANOP                                                    Y02080 25400002
         LA    0,EOVSIZE(,0)            EOV WORK AREA SIZE              25450002
         AGO   .IECA300                 CONTINUE                 Y02080 25500002
.IECA240 ANOP                                                    Y02080 25550002
         SR    0,0                      LENGTH COMPUTED IN IFG019RA     25600002
.***                                                             Y02080 25650002
.*       SP = SUBPOOL OF WORK AREA                               Y02080 25700002
.***                                                             Y02080 25750002
.IECA300 AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'NO').IECA310  Y02080 25800002
         AIF   ('&FUNC' EQ 'GET').IECA310 CHECK GET              Y02080 25850002
         AIF   (T'&SP EQ 'O').IECA400   NO SP ON FREE            Y02080 25900002
         MNOTE 4,'SP ONLY ON FREE PREFIX=NO'                     Y02080 25950002
         AGO   .IECA400                 CONTINUE                 Y02080 26000002
.IECA310 AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA400        *26050002
                                        SP DEFAULT               Y02080 26100002
         AIF   (T'&SP EQ 'O').IECA330   DEFAULT SP               Y02080 26150002
         AIF   ('&SP'(1,1) EQ '(').IECA320 REG FORM              Y02080 26200002
         LA    2,&SP.(,0)               SUBPOOL                         26250002
         AGO   .IECA400                 CONTINUE                 Y02080 26300002
.IECA320 AIF   ('&SP' EQ '(2)' OR '&SP' EQ '(R2)').IECA400 REG OKY02080 26350002
         LR    2,&SP(1)                 SUBPOOL                         26400002
         AGO   .IECA400                 CONTINUE                 Y02080 26450002
.IECA330 ANOP                                                    Y02080 26500002
         LA    2,230(,0)                DEFAULT SUBPOOL 230             26550002
.***                                                             Y02080 26600002
.*       KEY = KEY OF WORK AREA                                  Y02080 26650002
.***                                                             Y02080 26700002
.IECA400 AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'NO').IECA410  Y02080 26750002
         AIF   ('&FUNC' EQ 'GET').IECA410 GET PROC               Y02080 26800002
         AIF   (T'&KEY EQ 'O').IECA500  OK NO KEY FOR FREE       Y02080 26850002
         MNOTE 4,'KEY ONLY ON FREE PREFIX=NO'                    Y02080 26900002
         AGO   .IECA500                 CONTINUE                 Y02080 26950002
.IECA410 AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA500        *27000002
                                        DEFAULT KEY              Y02080 27050002
         AIF   (T'&KEY EQ 'O').IECA440  DEFAULT KEY              Y02080 27100002
         AIF   ('&KEY' EQ 'USER').IECA430 USER ENTRY KEY         Y02080 27150002
         AIF   ('&KEY'(1,1) EQ '(').IECA420 REG FORM             Y02080 27200002
         LA    3,&KEY.(,0)              KEY OF AREA                     27250002
         AGO   .IECA500                 CONTINUE                 Y02080 27300002
.IECA420 AIF   ('&KEY' EQ '(3)' OR '&KEY' EQ '(R3)').IECA500 R OKY02080 27350002
         LR    3,&KEY(1)                KEY OF AREA                     27400002
         AGO   .IECA500                 CONTINUE                 Y02080 27450002
.IECA430 ANOP                           USER KEY                 Y02080 27500002
         SR    3,3                      CLEAR REGISTER                  27550002
         IC    3,DXUKEY                 GET USER'S KEY                  27600002
         SRL   3,4(0)                   PLACE IN LOW BYTE               27650002
         AGO   .IECA500                 CONTINUE                 Y02080 27700002
.IECA440 ANOP                           DEFAULT KEY              Y02080 27750002
         LA    3,5(,0)                  DEFAULT KEY 5                   27800002
.***                                                             Y02080 27850002
.*       OPTIONS INDEX                                           Y02080 27900002
.***                                                             Y02080 27950002
.IECA500 AIF   ('&PREFX' EQ 'WTG').IECA540 CODE ALREADY SET      Y02080 28000002
&CODE    SETA  &CODE+2                  SET EOV FREEMAIN CODE    Y02080 28050002
         AIF   ('&PREFX' EQ 'EOV').IECA540                       Y02080 28100002
&CODE    SETA  &CODE+2                  SET FIRST FREEMAIN CODE  Y02080 28150002
         AIF   ('&PREFX' EQ 'FIRST').IECA540                     Y02080 28200002
         AIF   ('&PREFX' EQ 'NO' AND '&IDTTR' NE 'WLH').IECA510  Y02080 28250002
         AIF   ('&PREFX' NE 'NO' AND '&IDTTR' NE 'WLH').IECA515  Y02080 28300002
         AIF   ('&PREFX' NE 'NO' AND '&IDTTR' EQ 'WLH').IECA520  Y02080 28350002
         AIF   ('&PREFX' EQ 'NO' AND '&IDTTR' EQ 'WLH').IECA525  Y02080 28400002
.IECA510 SR    4,4                      NO PREFIX/NO LOCK               28450002
         AGO   .IECA550                 CONTINUE                 Y02080 28500002
.IECA515 LA    4,1(,0)                  PREFIX/NO LOCK                  28550002
         AGO   .IECA550                 CONTINUE                 Y02080 28600002
.IECA520 LA    4,2(,0)                  PREFIX/LOCK HELD                28650002
         AGO   .IECA550                 CONTINUE                 Y02080 28700002
.IECA525 LA    4,3(,0)                  NO PREFIX/LOCK HELD             28750002
         AGO   .IECA550                 CONTINUE                 Y02080 28800002
.*                                                                      28850002
.IECA540 AIF   ('&FUNC' EQ 'FREE').IECA545 CHECK FOR FREEMAIN    Y02134 28900002
&CODE    SETA  0                        SET CODE TO ZERO         Y02134 28950002
         AIF   ('&PREFX' EQ 'WTG').IECA545 CHECK FOR GET WTG     Y02134 29000002
&CODE    SETA  1                        SET EOV/FIRST ENTRY CODE Y02134 29050002
.IECA545 LA    4,&CODE.(,0)             ENTRY INDICATOR                 29100002
.***                                                             Y02080 29150002
.*       BRANCH ENTRY                                            Y02080 29200002
.***                                                             Y02080 29250002
.IECA550 ANOP                                                    Y02080 29300002
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS                29350002
         L     5,CVTDMSR-CVT(,5)        LOAD ADDRESS OF IFG019RA        29400002
         AIF   ('&FUNC' EQ 'FREE').IECA590 FREE                  Y02080 29450002
         AIF   ('&PREFX' EQ 'WTG').IECA580 WTG ENTRY             Y02080 29500002
         AIF   ('&PREFX' EQ 'EOV').IECA580 EOV ENTRY             Y02080 29550002
         AIF   ('&PREFX' EQ 'FIRST').IECA560 FIRST ENTRY         Y02080 29600002
         BAL   14,28(,5)                LINK TO GETMAIN                 29650002
         AGO   .IECA600                 CONTINUE                 Y02080 29700002
.IECA560 ANOP                                                    Y02080 29750002
         BAL   14,36(,5)                LINK TO GETMAIN FIRST           29800002
         AGO   .IECA600                 CONTINUE                 Y02080 29850002
.IECA580 ANOP                                                    Y02080 29900002
         BAL   14,32(,5)                LINK TO GETMAIN EOV/WTG         29950002
         AGO   .IECA600                 CONTINUE                 Y02080 30000002
.IECA590 AIF   ('&PREFX' EQ 'WTG').IECA595 WTG ENTRY             Y02080 30050002
         AIF   ('&PREFX' EQ 'EOV').IECA595 EOV ENTRY             Y02080 30100002
         AIF   ('&PREFX' EQ 'FIRST').IECA595 FIRST ENTRY         Y02080 30150002
         BAL   14,48(,5)                LINK TO FREEMAIN                30200002
         AGO   .IECA600                 CONTINUE                 Y02080 30250002
.IECA595 ANOP                                                    Y02080 30300002
         BAL   14,52(,5)                LINK TO FREEMAIN FIRST,WTG,EOV  30350002
.***                                                             Y02080 30400002
.*       ID = ID OF CONTROL BLOCK                                Y02080 30450002
.***                                                             Y02080 30500002
.IECA600 AIF   ('&FUNC' EQ 'FREE').IECA620                       Y02080 30550002
         AIF   ('&PREFX' EQ 'NO').IECA650 NO PREFIX - NO ID      Y02080 30600002
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA650        *30650002
                                        STD ID IN 19RA           Y02080 30700002
         AIF   (T'&ID EQ 'O').IECA610   NO ID                    Y02080 30750002
         DC    CL4'&ID'                 ID OF WORK AREA                 30800002
         AGO   .IECA630                 CONTINUE                 Y02080 30850002
.IECA610 ANOP                                                    Y02080 30900002
         DC    CL4' '                   BLANK ID OF WORK AREA           30950002
         AGO   .IECA630                 CONTINUE                 Y02080 31000002
.IECA620 AIF   (T'&ID EQ 'O').IECA650   OK NO ID FOR FREE        Y02080 31050002
         MNOTE 4,'ID= INVALID FOR FREE'                          Y02080 31100002
         AGO   .IECA650                 CONTINUE                 Y02080 31150002
.IECA630 AIF   ('&PREFX' NE 'FIRST').IECA650                     Y02080 31200002
         BAL   14,40(,5)                INITIALIZE WORK AREA            31250002
.***                                                             Y02080 31300002
.*       STM = DO LM ON RETURN                                   Y02080 31350002
.***                                                             Y02080 31400002
.IECA650 AIF   (T'&STM EQ 'O').IECA700 NO STM                    Y02080 31450002
         LM    &STM(1),&STM(2),0(15)    RESTORE REGISTERS               31500002
         AIF   ('&FUNC' EQ 'INIT').IECA710 NO REG COMMENT        Y02080 31550002
.IECA700 AIF   ('&FUNC' EQ 'FREE').IECA705 REG COMMENT           Y02080 31600002
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA710  Y02080 31650002
.IECA705 ANOP                                                    Y02080 31750002
*  IECRES GET/FREE PRESERVES THE CONTENTS OF REGISTERS 8-10.            31800002
.IECA710 MEXIT                                                   Y02080 31850002
.***                                                                    31900002
.*       GET/FREE ERRORS                                         Y02080 31950002
.***                                                             Y02080 32000002
.IECA900 MNOTE 8,'CODE PREFIX OR EXTPR WITH GET OR FREE'         Y02080 32050002
         MEXIT                                                   Y02080 32100002
.IECA905 MNOTE 8,'STM ON LAST FREE INVALID'                      Y02080 32150002
         MEXIT                                                   Y02080 32200002
.IECA910 MNOTE 8,'STM MUST HAVE 3 PARAMETERS'                    Y02080 32250002
         MEXIT                                                   Y02080 32300002
.IECA913 MNOTE 8,'STM ERROR - GET RETURNS ADDR OF AREA IN R1'    Y02080 32350002
         MEXIT                                                   Y02080 32400002
.IECA917 MNOTE 8,'A= ADDR OF DCB PARAM LIST'                     Y02080 32450002
         MEXIT                                                          32500002
.IECA920 MNOTE 8,'A= ADDR TO FREE OR GET PREFIX ADDR MISSING'    Y02080 32550002
         MEXIT                                                   Y02080 32600002
.IECA925 MNOTE 8,'LV= LENGTH MISSING'                            Y02080 32650002
         MEXIT                                                   Y02080 32700002
.IECA930 MNOTE 8,'PREFIX=&PREFIX INCOMPATIBLE WITH GET REQUEST'  Y02080 32750002
         MEXIT                                                   Y02080 32800002
.********************************************************************** 32850002
.*       FUNCTION = LOAD                                                32900002
.********************************************************************** 32950002
.LOAD    ANOP                                                    Y02080 33000002
         AIF   ('&NAME' EQ '').LOAD001  IF NAME MISSING          Y02080 33050002
&NAME    DS    0H                       LABEL AND ALIGN                 33100002
.LOAD001 AIF   ('&BRANCH' EQ 'QUEUED').LOAD008 BYPASS REG SAVE   Y02080 33150002
         AIF   ('&PREFIX' EQ '').LOAD004 NO PREFIX PARAMETER     Y02080 33200002
         AIF   ('&PREFIX' EQ 'NO').LOAD004 NO PREFIX PARAMETER   Y02080 33250002
         AIF   ('&PREFIX'(1,1) EQ '(').LOAD003 REG CONTAINS PTR  Y02080 33300002
         L     15,&PREFIX               GET POINTER TO A PREFIX         33350002
.LOAD002 STM   0,14,IECREGSV-IECPREFX(15) SAVE REGISTERS                33400002
         AGO   .LOAD008                 GO CHECK MODID           Y02080 33450002
.LOAD003 AIF   ('&PREFIX' EQ '(15)').LOAD002 REG 15 ALREADY SET  Y02080 33500002
         AIF   ('&PREFIX' EQ '(15)').LOAD002                     Y02080 33550002
         LR    15,&PREFIX(1)            GET POINTER TO A PREFIX         33600002
         AGO   .LOAD002                                          Y02080 33650002
.LOAD004 AIF   ('&EXTPR' EQ '').LOAD007 NEED PREFIX PARAMETER    Y02080 33700002
         AIF   ('&EXTPR'(1,1) EQ '(').LOAD006 REG CONTAINS PTR   Y02080 33750002
         L     15,&EXTPR                GET PTR TO EXTENDED PREFIX      33800002
.LOAD005 STM   0,14,IECREGSV-IECEXTPR(15) SAVE REGISTERS                33850002
         LA    1,IECEXTPR-IECPREFX(0,0) BACK UP REGISTER 15 TO          33900002
         SR    15,1                     POINT TO START OF PREFIX        33950002
         AGO   .LOAD008                                          Y02080 34000002
.LOAD006 AIF   ('&EXTPR' EQ '(15)').LOAD005 REG 15 ALREADY SET   Y02080 34050002
         LR    15,&EXTPR(1)             GET PTR TO EXTENDED PREFIX      34100002
         AGO   .LOAD005                                          Y02080 34150002
.LOAD007 MNOTE 8,'PREFIX OR EXTPR PARAMETER REQUIRED FOR LOAD UNLESS BR*34200002
               ANCH=QUEUED'                                      Y02080 34250002
         AGO   .LOAD099                 GENERATE INVALID OP CODE Y02080 34300002
.*                                                               Y02080 34350002
.LOAD008 AIF   ('&PREFIX' NE 'DXXPREFX').LOAD08A                 Y02080 34400002
         LA    6,DXXMODNM               LOAD PTR TO WTG MODULE NAME     34450002
.LOAD08A AIF   ('&MODID' EQ '').LOAD010 IF MODID NOT CODED       Y02080 34500002
         AIF   ('&BRANCH' EQ 'QUEUED').LOAD11A                   Y02080 34550002
         AIF   ('&MODID'(1,1) EQ '(').LOAD009 IF PTR IN REGISTER Y02080 34600002
.*                                                               Y02080 34650002
         MVC   WTGMODNM+6(2),&MODID     MOVE ID TO LIST                 34700002
         MVC   WTGMODEP+1(3),&MODID+2   MOVE EPA TO LIST                34750002
         AGO   .LOAD012                                          Y02080 34800002
.*                                                               Y02080 34850002
.LOAD009 MVC   WTGMODNM+6(2),0&MODID    MOVE ID TO LIST                 34900002
         MVC   WTGMODEP+1(3),2&MODID    MOVE EPA TO LIST                34950002
         AGO   .LOAD012                                          Y02080 35000002
.*                                                               Y02080 35050002
.LOAD010 AIF   ('&MODNM' EQ '').LOAD012 IF MODNM NOT CODED       Y02080 35100002
         AIF   ('&BRANCH' EQ 'QUEUED').LOAD11C                   Y02080 35150002
         AIF   ('&MODNM'(1,1) EQ '(').LOAD011 IF PTR IN REGISTER Y02080 35200002
.*                                                               Y02080 35250002
         MVC   WTGMODNM(12),&MODNM      MOVE MODULE NAME & EPA          35300002
         AGO   .LOAD012                                          Y02080 35350002
.*                                                               Y02080 35400002
.LOAD011 MVC   WTGMODNM(12),0&MODNM     MOVE MODULE NAME & EPA          35450002
         AGO   .LOAD012                                          Y02080 35500002
.*                                                               Y02080 35550002
.LOAD11A AIF   ('&MODID'(1,1) EQ '(').LOAD11B                    Y02080 35600002
         MVC   0(5,RWTGC),&MODID        MOVE ID & EPA TO WTG TABLE      35650002
         AGO   .LOAD012                                          Y02080 35700002
.*                                                               Y02080 35750002
.LOAD11B MVC   0(5,RWTGC),0&MODID       MOVE ID & EPA TO WTG TABLE      35800002
         AGO   .LOAD012                                          Y02080 35850002
.*                                                               Y02080 35900002
.LOAD11C AIF   ('&MODNM'(1,1) EQ '(').LOAD11D IF PTR IN REGISTER Y02080 35950002
         MVC   0(2,RWTGC),&MODNM+6      MOVE ID TO WTG TABLE            36000002
         MVC   2(3,RWTGC),&MODNM+9      MOVE V-CON TO WTG TABLE         36050002
         AGO   .LOAD012                                          Y02080 36100002
.*                                                               Y02080 36150002
.LOAD11D MVC   0(2,RWTGC),6&MODNM       MOVE ID TO WTG TABLE            36200002
         MVC   2(3,RWTGC),9&MODNM       MOVE V-CON TO WTG TABLE         36250002
.*                                                               Y02080 36300002
.LOAD012 AIF   ('&BRANCH' EQ 'QUEUED').LOAD015 REG 5 & 6 LOADED  Y02080 36350002
         AIF   ('&PREFIX' EQ 'DXXPREFX').LOAD014                 Y02080 36400002
         LA    6,WTGMODNM               LOAD PTR TO WTG MODULE NAME     36450002
.LOAD014 L     5,CVTPTR(,0)             LOAD ADDRESS OF CVT             36500002
         L     5,CVTDMSR-CVT(,5)        LOAD ADDRESS OF IFG019RA        36550002
         AIF   ('&BRANCH' EQ 'NO').LOAD021 RETURN TO CALLER      Y02080 36600002
.*                                                               Y02080 36650002
.LOAD015 AIF   ('&BRCODE' EQ '').LOAD017 BRANCH OFFSET NOT CODED Y02080 36700002
         AIF   ('&BRANCH' EQ 'NO').LOAD017 REG 14 USED TO RETURN Y02080 36750002
         AIF   ('&BRCODE'(1,1) EQ '(').LOAD016 BRNCH CODE IN REG Y02080 36800002
         LA    14,&BRCODE               LOAD BRANCH TABLE OFFSET        36850002
         AGO   .LOAD017                                          Y02080 36900002
.LOAD016 AIF   ('&BRCODE' EQ '(14)').LOAD017 REG 14 ALREADY SET  Y02080 36950002
         AIF   ('&BRCODE' EQ '(14)').LOAD017                     Y02080 37000002
         LR    14,&BRCODE(1)            LOAD BRANCH TABLE OFFSET        37050002
.*                                                               Y02080 37100002
.LOAD017 AIF   ('&BRANCH' EQ 'QUEUED').LOAD019 IF QUEUED BRANCH  Y02080 37150002
         AIF   ('&BRANCH' EQ 'DIRECT').LOAD020 LOAD AND BRANCH   Y02080 37200002
         AIF   ('&BRANCH' EQ 'NO').LOAD021 LOAD AND RETURN       Y02080 37250002
         AIF   ('&BRANCH' EQ '').LOAD018 BRANCH PARM OMMITTED    Y02080 37300002
         MNOTE 8,'BRANCH PARAMETER INVALID'                      Y02080 37350002
         AGO   .LOAD099                 GENERATE INVALID OP CODE Y02080 37400002
.LOAD018 MNOTE 8,'BRANCH PARAMETER REQUIRED FOR LOAD'            Y02080 37450002
         AGO   .LOAD099                 GENERATE INVALID OP CODE Y02080 37500002
.LOAD019 B     RESXCTL(,RES)            SELECTIVE LOAD AND BRANCH       37550002
         MEXIT                                                   Y02080 37600002
.LOAD020 B     20(,5)                   LOAD AND BRANCH DIRECT          37650002
         MEXIT                                                   Y02080 37700002
.LOAD021 BAL   14,24(5)                 LOAD AND RETURN                 37750002
         LM    0,14,IECREGSV-IECPREFX(15) RESTORE REGISTERS             37800002
         MEXIT                                                   Y02080 37850002
.LOAD099 DC    H'0'                     HALT EXECUTION           Y02080 37900002
         MEXIT                                                   Y02080 37950002
.********************************************************************** 38000002
.*       FUNCTION = BRANCH                                              38050002
.********************************************************************** 38100002
.BRANCH  ANOP                                                    Y02080 38150002
         AIF   ('&NAME' EQ '').BRANCH1  IF NAME OMITTED          Y02080 38200002
&NAME    DS    0H                       LABEL AND ALIGN                 38250002
.BRANCH1 AIF   ('&EPA' EQ '').BRANCH2   NO EPA PARAMETER         Y02080 38300002
         AIF   ('&EPA'(1,1) EQ '(').BRANCH3 EPA IN A REGISTER    Y02080 38350002
         L     15,&EPA                  LOAD CSECT EPA                  38400002
         AIF   ('&REUSE' EQ 'YES').BRANCH2 DO NOT CLEAR EPA      Y02080 38450002
         XC    &EPA,&EPA                ZERO EPA FOR REUSE              38500002
.BRANCH2 BR    15                       TRANSFER TO NEXT CSECT          38550002
         MEXIT                                                   Y02080 38600002
.BRANCH3 AIF   ('&EPA' EQ '(15)').BRANCH2 REG 15 ALREADY SET     Y02080 38650002
         LR    15,&EPA(1)               LOAD CSECT EPA                  38700002
         AGO   .BRANCH2                                          Y02080 38750002
.********************************************************************** 38800002
.*       FUNCTION = LOCJFCB                                             38850002
.********************************************************************** 38900002
.IECB000 ANOP                           LOCATE JFCB              Y02134 38950002
&NAME    ICM   &IDTTR(1),B'0111',0&IDTTR LOAD JFCB PREFIX ADDRESS       39000002
         LA    &IDTTR(1),16&IDTTR       POINT TO JFCB                   39050002
         MEXIT                                                   Y02134 39100002
.********************************************************************** 39150002
.*       FUNCTION = WRJFCB                                              39200002
.********************************************************************** 39250002
.IECC000 ANOP                           WRITE JFCB               Y02134 39300002
&NAME    L     15,WTGPREFX              LOAD POINTER TO PREFIX          39350002
         STM   0,15,IECREGSV-IECPREFX(15) SAVE REGISTERS                39400002
         LR    0,&BCODE(1)              LOAD POINTER TO JFCB            39450002
         LR    1,&IDTTR(1)              LOAD POINTER TO JFCB PREFIX     39500002
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS                39510002
         L     5,CVTDMSR-CVT(,5)        LOAD ADDRESS OF IFG019RA        39520002
         BAL   14,12(,5)                LINK TO QMNGRIO ROUTINE         39550002
         LM    0,15,IECREGSV-IECPREFX(15) RESTORE REGISTERS             39600002
         MEXIT                                                   Y02134 39650002
.********************************************************************** 39700002
.*       FUNCTION = INIT                                                39750002
.********************************************************************** 39800002
.INIT100 ANOP                                                    Y02134 39850002
         AIF   (T'&DEB EQ 'O' AND T'&DCBCOPY EQ 'O').INIT950     Y02134 39900002
         AIF   (T'&DEB NE 'O').INIT200  WAS &DEB OMITTED?        Y02134 39950002
         SR    0,0                      DO NOT INIT WORK AREA FIELDS    40000002
         AIF   (T'&PREFIX EQ 'O').INIT150  NO PREFIX PARAMETER   YM3810 40010002
         L     6,&PREFIX                R6 POINTS TO BASE PREFIX        40020002
         AGO   .INIT500                                          Y02134 40030002
.INIT150 ANOP                                                    YM3810 40040002
         AIF   (T'&STM EQ 'O').INIT170  STM OMITTED              YM3810 40050002
         AIF   ('&STM(3)' NE 'DXXPREFX' AND '&STM(3)' NE 'WTGPREFX').IN*40060002
               IT170                    CHECK FOR STD SAVE AREA  YM3810 40070002
         L     6,&STM(3)                R6 POINTS TO BASE PREFIX        40080002
         AGO   .INIT500                                          YM3810 40090002
.INIT170 ANOP                           DEFAULT TO WTGPREFX      YM3810 40100002
         L     6,WTGPREFX               R6 POINTS TO BASE PREFIX        40110002
         AGO   .INIT500                                          YM3810 40120002
.INIT200 ANOP                                                    Y02134 40200002
         AIF   (T'&PREFIX EQ 'O').INIT250                        Y02134 40250002
         L     6,&PREFIX                R6 POINTS TO BASE PREFIX        40300002
         AGO   .INIT260                 CONTINUE                 Y02134 40350002
.INIT250 ANOP                                                    Y02134 40400002
         L     6,WTGPREFX               R6 POINTS TO BASE PREFIX        40450002
.INIT260 ANOP                                                    Y02134 40500002
         AIF   ('&DEB' NE 'YES').INIT300                         Y02134 40550002
         LA    0,4(,0)                  INDICATE DEB PRESENT            40600002
         AGO   .INIT500                                          Y02134 40650002
.INIT300 ANOP                                                    Y02134 40700002
         AIF   ('&DEB' NE 'NO').INIT400 BRANCH IF INVALID &DEB   Y02134 40750002
         LA    0,8(,0)                  INDICATE DEB ABSENT             40800002
         AGO   .INIT500                                          Y02134 40850002
.INIT400 ANOP                           INVALID &DEB VALUE       Y02134 40900002
         IHBERMAC 1001,DEB,&DEB                                  Y02134 40950002
.INIT500 ANOP                                                    Y02134 41000002
         AIF   (T'&DCBCOPY NE 'O').INIT640 BRANCH IF NOT OMITTED Y02134 41050002
         SR    1,1                      DCB NOT TO BE COPIED            41100002
         AGO   .INIT900                                          Y02134 41150002
.INIT640 ANOP                                                    Y02134 41200002
         AIF   ('&DCBCOPY' NE 'TOWKAR').INIT700                  Y02134 41250002
         LA    1,4(,0)                  COPY USER DCB TO WORK AREA DCB  41300002
         AGO   .INIT900                                          Y02134 41350002
.INIT700 ANOP                                                    Y02134 41400002
         AIF   ('&DCBCOPY' NE 'FRWKAR').INIT800                  Y02134 41450002
         AIF   (T'&DEB NE 'O').INIT960  IMPOSSIBLE               Y02134 41500002
         LA    1,8(,0)                  COPY WORK AREA DCB TO USER DCB  41550002
         AGO   .INIT900                                          Y02134 41600002
.INIT800 ANOP                                                    Y02134 41650002
         IHBERMAC 1001,DCBCOPY,&DCBCOPY INVALID DCBCOPY VALUE    Y02134 41700002
.INIT900 ANOP                                                    Y02134 41750002
         L     5,CVTPTR(,0)             LOAD ADDRESS OF CVT             41800002
         L     5,CVTDMSR-CVT(,5)        LOAD ADDRESS OF IFG019RA        41850002
         BAL   14,44(,5)                LINK TO IFG019RA                41900002
         AGO   .IECA650                 GO TO RELOAD REGISTERS   Y02134 41950002
.INIT950 MNOTE 8,'DEB= OR DCBCOPY= MUST BE CODED'                Y02134 42000002
         AGO   .IECA650                 DO LM                    Y02134 42050002
.INIT960 MNOTE 8,'INITIAL CALL ALWAYS TOWKAR'                    Y02134 42100002
         AGO   .IECA650                 DO LM                    Y02134 42150002
.********************************************************************** 42200002
.*       FUNCTION = EXIT                                                42250002
.********************************************************************** 42300002
.IECD000 ANOP                                                    Y02080 42350002
&NAME    L     14,CVTPTR(0,0)           LOAD CVT ADDRESS                42400002
         L     14,CVTEXPRO-CVT(0,14)    LOAD EXIT PROLOGUE ADDRESS      42450002
*        MODESET EXTKEY=SUPR            GO TO SUPERVISOR KEY            42500002
         MODESET EXTKEY=SUPR            GO TO SUPERVISOR KEY            42550002
*        RETURN ,                       RETURN TO CALLER                42600002
         RETURN ,                       RETURN TO CALLER                42650002
         MEXIT                                                          42700002
.********************************************************************** 42750002
.*       FUNCTION = UEXIT                                               42800002
.********************************************************************** 42850002
.IECE000 ANOP                                                    Y02082 42900002
         AIF   ('&NAME' EQ '').IECE010  BRANCH IF NAME OMITTED   Y02082 42950002
&NAME    DS    0H                                                       43000002
.IECE010 ANOP                                                    Y02082 43050002
         AIF   (T'&REG0 EQ 'O').IECE020 BRANCH IF &REG 0 OMITTED Y02082 43100002
         AIF   ('&REG0'(1,1) EQ '(').IECE015 BR IF REG FORMAT    Y02082 43150002
         L     0,&REG0                  REG 0 PARAMETER TO EXIT         43200002
         AGO   .IECE020                 TEST &REG1 PARM          Y02082 43250002
.IECE015 ANOP                                                    Y02082 43300002
         LR    0,&REG0(1)               REG 0 PARAMETER TO EXIT         43350002
.IECE020 ANOP                                                    Y02082 43400002
         AIF   (T'&REG1 EQ 'O').IECE030 BRANCH IF &REG 1 OMITTED Y02082 43450002
         AIF   ('&REG1'(1,1) EQ '(').IECE025 BR IF REG FORMAT    Y02082 43500002
         L     1,&REG1                  REG 1 PARAMETER TO EXIT         43550002
         AGO   .IECE030                 TEST &EXITAD PARM        Y02082 43600002
.IECE025 ANOP                                                    Y02082 43650002
         LR    1,&REG1(1)               REG 1 PARAMETER TO EXIT         43700002
.IECE030 ANOP                                                    Y02082 43750002
         AIF   (T'&EXITAD EQ 'O').IECE040 BRANCH IF &EXITAD OMIT Y02082 43800002
         AIF   ('&EXITAD'(1,1) EQ '(').IECE035 BR IF REG FORMAT  Y02082 43850002
         L     15,&EXITAD               EXIT ENTRY POINT                43900002
         AGO   .IECE040                 SAVE REGISTERS           Y02082 43950002
.IECE035 ANOP                                                    Y02082 44000002
         LR    15,&EXITAD(1)            EXIT ENTRY POINT                44050002
.IECE040 ANOP                                                    Y02082 44100002
         AIF   (T'&STM EQ 'O').IECE060  BRANCH IF &STM OMITTED   Y02082 44150002
         AIF   ('&STM(3)' EQ 'DXXPREFX' OR                             *44200002
               '&STM(3)' EQ 'WTGPREFX').IECE050 BR IF REGS SAVED Y02082 44250002
.*                                      IN WORKAREA PREFIX       Y02082 44300002
         STM   &STM(1),&STM(2),&STM(3)  SAVE REGISTERS                  44350002
         LA    2,&STM(3)                SAVE ADDRESS OF SAVE AREA       44400002
         AGO   .IECE060                                          Y02082 44450002
.IECE050 ANOP                                                    Y02082 44500002
         L     14,&STM(3)               GET ADDRESS OF PREFIX           44550002
         STM   &STM(1),&STM(2),IECREGSV-IECPREFX(14) SAVE REGISTERS     44600002
         LA    2,IECREGSV-IECPREFX(,14) SAVE ADDRESS OF SAVE AREA       44650002
.IECE060 ANOP                                                    Y02082 44700002
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS                44750002
         L     5,CVTDMSR-CVT(,5)        LOAD ADDRESS OF IFG019RA        44800002
         BAL   14,56(,5)                LINK TO UEXIT ROUTINE           44850002
         AIF   (T'&STM EQ 'O').IECA710  EXIT IF &STM OMITTED     Y02082 44900002
         LM    &STM(1),&STM(2),0(2)     RESTORE REGISTERS               44950002
.********************************************************************** 45000002
         MEND                                                           45050002
