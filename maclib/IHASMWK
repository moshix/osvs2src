*/********************************************************************/ 00006033
*/*                                                                  */ 00012033
*/* MACRO NAME = SMWK                                                */ 00020033
*/*                                                                  */ 00021033
*/* MICROFICHE NAME = IHASMWK                                        */ 00022033
*/*                                                                  */ 00023033
*/* DESCRIPTIVE NAME = SUMMARY DUMP WORK AREA                        */ 00024033
*/*                                                                  */ 00025033
*/* STATUS = OS/VS2 RELEASE 3.7 PLUS SU 33     1/10/77       @G33VPHD*/ 00026033
*/*          SETDIE PTM FIX                    1/10/77 MJD   @ZM44932*/ 00026533
*/*          ENABLED SUMDUMP FIELD ADDED       2/4/77 MJD    @ZM45052*/ 00027033
*/*          STATISTICS FIELDS ADDED           2/11/77 MJD   @ZM45073*/ 00027533
*/*                                                                  */ 00028033
*/* FUNCTION = IHASMWK IS A MAPPING MACRO WHICH MAPS THE             */ 00029033
*/*     SUMMARY DUMP WORK AREA.  THE SMWK IS USED BY THE             */ 00030033
*/*     SUMMARY DUMP PORTION OF SVC DUMP TO CONTAIN SAVE             */ 00031033
*/*     AREAS, IMPORTANT ADDRESSES AND A TABLE OF REAL STORAGE       */ 00032033
*/*     ADDRESSES DESCRIBING THE REAL STORAGE FRAMES OBTAINED        */ 00033033
*/*     FROM RSM.  THE SMWK IS GETMAINED OUT OF SUBPOOL 245          */ 00034033
*/*     OF SQA DURING IPL BY MODULE IEAVTSDI.                        */ 00035033
*/*                                                                  */ 00036033
*/* METHOD OF ACCESS=                                                */ 00037033
*/*   BAL  - DSECT IS ALWAYS PRODUCED.  USING ON SMWK GIVES          */ 00038033
*/*          ADDRESSABILITY TO ALL SYMBOLS.  CVTRTMCT POINTS         */ 00039033
*/*          TO THE RTCT.  RTCTSDSW POINTS TO THE SMWK.              */ 00040033
*/*   PLS/2- INCLUDE IHASMWK FROM SYSLIB.  ALSO INCLUDE CVT TO       */ 00041033
*/*          DEFINE BASE OF CVTRTMCT.  ALSO INCLUDE IHARTCT          */ 00050033
*/*          FROM SYSLIB TO DEFINE BASE OF RTCTSDSW.                 */ 00054033
*/*                                                                  */ 00058033
*/* NOTES = FIELD SMWKRSM IS MAPPED BY MAPPING MACRO IHASDRSM.       */ 00062033
*/*         IT MUST ALSO BE INCLUDED FROM SYSLIB BEFORE IHASMWK      */ 00066033
*/*         IS INCLUDED BECAUSE IHASMWK REFERENCES THE LENGTH        */ 00068033
*/*         OF THE AREA MAPPED BY IHASDRSM.                          */ 00070033
*/*                                                                  */ 00074033
*/* SIZE = DECIMAL 972, X'3CC'                                       */ 00075033
*/*                                                                  */ 00082033
*/********************************************************************/ 00086033
*        %GOTO SMWKPLS;           /* BILINGUAL MAPPING       @G33VPHD*/ 00090033
         MACRO                                                          00100033
         IHASMWK                                                        00150033
SMWK     DSECT ,                  BAL MAPPING OF SMWK                   00200033
         IEZBITS ,                SYMBOLIC BIT NAMES                    00250033
*                                 SU 33                      @G33VPHD   00300033
SMWKNAME DS    CL4                CONTAIN EBCDIC NAME C'SMWK'           00350033
SMWKFLGS DS    0BL4               SUMMARY DUMP WORKING FLAGS            00400033
SMWKFLG1 DS    B                  FIRST BYTE OF FLAGS                   00450033
SMWKSLCK EQU   BIT0               1=SALLOC LOCK OBTAINED                00500033
SMWKRBUF EQU   BIT1               1=REAL STORAGE BUFFER OBTAINED        00550033
SMWKRBFL EQU   BIT2               1=REAL STORAGE BUFFER FULL            00600033
SMWKRSNM EQU   BIT3               1-ALL REQUESTED STORAGE NOT MOVED     00650033
SMWKSLCL EQU   BIT4               1=SALLOC LOCK HELD BY CALLER @ZM45073 00670033
SMWKSTBK EQU   BIT5               1=A STEAL BACK HAS OCCURRED  @ZM45073 00700033
SMWKRES2 EQU   BIT6               RESERVED                              00800033
SMWKRES3 EQU   BIT7               RESERVED                              00850033
SMWKFLG2 DS    B                  SECOND BYTE OF FLAGS                  00900033
SMWKFLG3 DS    B                  THIRD BYTE OF FLAGS                   00950033
SMWKFLG4 DS    B                  FOURTH BYTE OF FLAGS                  01000033
SMWKSAVE DS    CL72               REGISTER SAVE AREA                    01050033
SMWKSAV1 DS    CL72               REGISTER SAVE AREA                    01050633
SMWKENTY DS    A                  ADDR SUM DUMP ROUTINE                 01052033
SMWKSSDE DS    A                  END ADDRESS OF SUMDUMP                01052533
SMWKPFXB DS    A                  BEGIN ADDRESS OF PAGE FIXED AREA      01053033
SMWKPFXE DS    A                  END ADDRESS OF PAGE FIXED AREA        01053533
SMWKPSW  DS    0D                 MODEL PSW FOR SUM DUMP LPSW           01101033
SMWKPSWS DS    X                  SYSTEM MASK PORTION OF PSW            01102033
SMWKPSWK DS    X                  PROTECTION KEY PORTION OF PSW         01103033
         DS    H                  RESERVED - INIT TO ZERO               01104033
SMWKPSWA DS    A                  ADDRESS PORTION OF PSW                01105033
SMWKVADR DS    F                  CURRENT VIRTUAL AREA ADDRESS          01107033
SMWKENDA DS    F                  END OF CURRENT VIRTUAL AREA           01112033
SMWKSAVA DS    F                  SAVED CURRENT VIRTUAL AREA ADDRESS    01117033
SMWKPEND DS    F                  END ADDRESS OF REFERENCED PAGE        01122033
SMWKCPUS DS    F                  SAVE AREA FOR SHIFTED CSDCPUAL BITS   01127033
SMWKRSM  DS    CL416              REAL STORAGE BUFFER CONTROL AREA      01140033
SMWKRFAD DS    A                  PTR TO NEXT REAL FRAME SPACE          01900033
SMWKNFAV DS    H                  NUMBER OF REAL FRAMES AVAILABLE       02000033
SMWKRSIX DS    H                  INDEX INTO FRAME ADDR TABLE           02005033
SMWKFRUS DS    H                  NUMBER OF FRAMES USED BY SUMDUMP      02010033
         DS    H                  RESERVED                              02020033
SMWKSMLK DS    A                  SUMLOCK RETURN REG SAVE AREA          02108033
SMWKSDMP DS    A                  SUMDUMP RETURN REGISTER SAVE AREA     02116033
SMWKSMDT DS    A                  SUMDATA RETURN REGISTER SAVE AREA     02124033
SMWKSMRG DS    A                  SUMREGS RETURN REGISTER SAVE AREA     02132033
SMWKSMLS DS    A                  SUMLIST RETURN REGISTER SAVE AREA     02140033
SMWKSMBF DS    A                  SUMBUFF RETURN REGISTER SAVE AREA     02142033
SMWKSMMV DS    A                  SUMMOVE RETURN REGISTER SAVE AREA     02144033
SMWKSMVL DS    A                  SUMVALID RETURN REGISTER SAVE AREA    02146033
SMWKHEAD DS    CL12               HEADER FOR STORAGE TO BE MOVED        02150033
SMWKREGS DS    0CL128             TABLE OF NON DUPLICATE REG CONTENTS   02300033
SMWKSREG DS    F                  ONE NON DUPLICATE REG CONTENT         02310033
SMWKREGL EQU   *-SMWKREGS         LENGTH OF ON TABLE ENTRY              02320033
         DS    CL124              REST OF REGISTER CONTENTS TABLE       02330033
SMWKIDX1 DS    H                  INDEX VALUE FOR REGISTER SORTING      02350033
SMWKIDX2 DS    H                  INDEX VALUE FOR REGISTER SORTING      02400033
SMWKREGN DS    H                  NUMBER OF SAVED REGISTERS             02450033
SMWKSCBF DS    H                  AVAILABLE SPACE ON CURRENT BUFFER     02500033
SMWKALEN DS    H                  LENGTH OF AREA TO BE MOVED            02550033
SMWKNFRI DS    H                  NUMBER OF BUFFERS FREED THIS INTERVAL 02750033
SMWKNFRE DS    H                  NUMBER OF BUFFERS TO BE FREED         02800033
SMWKNDIE DS    H                  NUMBER TIMES DIE ENTERED NO FREE      02850033
SMWKSVLN DS    F                  SAVED AREA LENGTH FOR SUMLIST         02870033
SMWKTQEA DS    A                  ADDRESS OF TQE FOR TIMER DIE          02900033
         DS    F                  RESERVED                     @ZM44932 02905033
SMWKTQE  DS    0D                INSURE TQE ON DOUBLE WORD BDY @ZM44932 02910033
         DS    CL128             TQE FOR TIMER DIE IN SUMDUMP  @ZM44932 02920033
SMWKPSSE DS    F                 PSEUDO ADDRESS FOR IEAVTSSE   @ZM45052 02950033
*                                FOR ENABLED SUMMARY DUMPS OF  @ZM45052 02960033
*                                MORE THAN ONE ADDRESS SPACE   @ZM45052 02970033
SMWKNFRQ DS    H                  NUMBER OF FRAMES REQUESTED   @ZM45073 02973033
SMWKNFAQ DS    H                  NUMBER OF FRAMES AQUIRED     @ZM45073 02976033
SMWKNFUS DS    H                  NUMBER OF FRAMES USED        @ZM45073 02979033
SMWKNTDI DS    H                  NUMBER OF TIMES DIE ENTERED  @ZM45073 02982033
SMWKNTDQ DS    H                  NUMBER OF TIMES DIE REQUEUED @ZM45073 02985033
SMWKNFFD DS    H                 NUMBER OF FRAMES FREED BY DIE @ZM45073 02988033
SMWKNSTB DS    H           NUMBER OF TIMES STEAL BACK OCCURRED @ZM45073 02991033
         DS    H                  RESERVED                     @ZM45073 02994033
*                                                                       03000033
SMWKLEN  EQU   *-SMWK             TOTAL LENGTH OF SUMMARY DUMP WORKAREA 03050033
         MEND                                                           03070033
*%SMWKPLS: ;                                                            03100033
*DECLARE                                                                03150033
*  1 SMWK  BASED(RTCTSDSW),       /* SU 33                   @G33VPHD*/ 03200033
*    2 SMWKNAME    CHAR(4),       /* EBCDIC NAME C'SMWK'             */ 03230033
*    2 SMWKFLGS    CHAR(4),       /*SUMMARY DUMP WORKING FLAGS       */ 03300033
*      3 SMWKFLG1    BIT(8),      /*FIRST BYTE OF FLAGS              */ 03350033
*        4 SMWKSLCK  BIT(1),      /*1=SUM DUMP GOT SALLOC LOCK       */ 03400033
*        4 SMWKRBUF  BIT(1),      /*1=SUMMARY DUMP GOT REAL BUFFER   */ 03450033
*        4 SMWKRBFL  BIT(1),      /*1=REAL STORAGE BUFFER FULL       */ 03500033
*        4 SMWKRSNM  BIT(1),      /*1=ALL REQUESTED STORAGE NOT MOVED*/ 03550033
*        4 SMWKSLCL  BIT(1),     /*1=CALLER HELD SALLOC LOCK @ZM45073*/ 03570033
*        4 SMWKSTBK  BIT(1),      /*1=STEAL BACK HAS OCCURED @ZM45073*/ 03600033
*        4 *         BIT(1),      /*RESERVED                         */ 03680033
*        4 *         BIT(1),      /*RESERVED                         */ 03720033
*      3 SMWKFLG2    BIT(8),      /*SECOND BYTE OF FLAGS             */ 03800033
*      3 SMWKFLG3    BIT(8),      /*THIRD BYTE OF FLAGS              */ 03850033
*      3 SMWKFLG4    BIT(8),      /*FOURTH BYTE OF FLAGS             */ 03900033
*    2 SMWKSAVE    CHAR(72),      /* REGISTER SAVE AREA              */ 03950033
*    2 SMWKSAV1    CHAR(72),      /*REGISTER SAVE AREA               */ 03950633
*    2 SMWKENTY    PTR(31),       /*ADDRESS OF SUMDUMP ROUTINE       */ 03952033
*    2 SMWKSSDE    PTR(31),       /*END ADDRESS OF SUMDUMP           */ 03952533
*    2 SMWKPFXB    PTR(31),       /*BEGIN ADDRESS OF PAGE FIXED AREA */ 03953033
*    2 SMWKPFXE    PTR(31),       /*END ADDRESS OF PAGE FIXED AREA   */ 03953533
*    2 SMWKPSW BDY(DWORD),        /*MODEL PSW FOR LPSW USE           */ 04001033
*      3 SMWKPSWS  BIT(8),        /*SYSTEM MASK PORTION OF PSW       */ 04002033
*      3 SMWKPSWK  BIT(8),        /*PROTECT KEY PORTION OF PSW       */ 04003033
*      3 *         BIT(16),       /*RESERVED - INIT TO ZERO          */ 04004033
*      3 SMWKPSWA  PTR(31),       /*ADDRESS PORTION OF MODEL PSW     */ 04005033
*    2 SMWKVADR    PTR(31),       /*CURRENT VIRTUAL AREA ADDRESS     */ 04007033
*    2 SMWKENDA    PTR(31),       /*END OF CURRENT VIRTUAL AREA      */ 04011033
*    2 SMWKSAVA    PTR(31),       /*SAVED CURRENT VIRTUAL AREA ADDR  */ 04015033
*    2 SMWKPEND    PTR(31),       /*END ADDRESS OF REFERENCED PAGE   */ 04019033
*    2 SMWKCPUS    BIT(32),       /*SAVE AREA FOR SHIFTED CSDCPUAL BITS 04023033
*                                                                    */ 04027033
*    2 SMWKRSM CHAR(LENGTH(SMWKRSCB)), /*REAL STORAGE BUFFER CONTROL    04036033
*                                        AREA                        */ 04042033
*    2 SMWKRFAD    PTR(31),       /* PTR TO NEXT REAL FRAME SPACE    */ 04500033
*    2 SMWKNFAV    FIXED(15),     /* NUMBER OF REAL FRAMES AVAILABLE */ 04580033
*    2 SMWKRSIX    FIXED(15),     /*INDEX INTO FRAME ADDRESS TABLE   */ 04600033
*    2 SMWKFRUS    FIXED(15),     /*NUMBER OF FRAMES USED BY SUMDUMP */ 04620033
*    2 *           FIXED(15),     /*RESERVED                         */ 04640033
*      /*SAVE AREAS FOR IEAVTSSD INTERNAL PROCEDURES*/                  04660033
*    2 SMWKSMLK    PTR(31),       /*SUMLOCK RETURN REGISTER SAVE AREA*/ 04710033
*    2 SMWKSDMP    PTR(31),       /*SUMDUMP RETURN REGISTER SAVE AREA*/ 04720033
*    2 SMWKSMDT    PTR(31),       /*SUMDATA RETURN REGISTER SAVE AREA*/ 04730033
*    2 SMWKSMRG    PTR(31),       /*SUMREGS RETURN REGISTER SAVE AREA*/ 04735033
*    2 SMWKSMLS    PTR(31),       /*SUMLIST RETURN REGISTER SAVE AREA*/ 04740033
*    2 SMWKSMBF    PTR(31),       /*SUMBUFF RETURN REGISTER SAVE AREA*/ 04742033
*    2 SMWKSMMV    PTR(31),       /*SUMMOVE RETURN REGISTER SAVE AREA*/ 04744033
*    2 SMWKSMVL    PTR(31),       /*SUMVALID RETURN REG SAVE AREA    */ 04746033
*    2 SMWKHEAD    CHAR(LENGTH(SMDLRHDR)), /*HEADER FOR STORAGE AREA TO 04750033
*                                                         BE MOVED   */ 04760033
*    2 SMWKREGS,                  /*TABLE OF NON DUPL REG CONTENTS   */ 04800033
*      3 SMWKSREG(32) PTR(31),    /*NON-DUPLICATE REGISTER CONTENTS  */ 04900033
*    2 SMWKIDX1    FIXED(15),     /*INDEX VALUE FOR REGISTER SORT    */ 04950033
*    2 SMWKIDX2    FIXED(15),     /*INDEX VALUE FOR REGISTER SORT    */ 05000033
*    2 SMWKREGN    FIXED(15),     /*NUMBER OF SAVED REGISTERS        */ 05050033
*    2 SMWKSCBF    FIXED(15),     /*AVAILABLE SPACE ON CURRENT BUFFER*/ 05100033
*    2 SMWKALEN    FIXED(15),     /*LENGTH OF AREA TO BE MOVED       */ 05150033
*    2 SMWKNFRI    FIXED(15),     /*NUMBER OF BUFFERS FREED INTERVAL */ 05350033
*    2 SMWKNFRE    FIXED(15),     /*NUMBER BUFFERS TO BE FREED       */ 05400033
*    2 SMWKNDIE    FIXED(15),     /*NUMBER TIME DIE ENTERED NO FREE  */ 05450033
*    2 SMWKSVLN    FIXED(31),     /*SAVED AREA LENGTH FOR SUMLIST    */ 05470033
*    2 SMWKTQEA    PTR(31),       /*ADDRESS OF TQE FOR TIMER DIE     */ 05500033
*    2 *           PTR(31),       /*RESERVED                 @ZM44932*/ 05505033
*    2 SMWKTQE     CHAR(128) BDY(DWORD), /*TQE FOR TIMER DIE @ZM44932*/ 05510033
*    2 SMWKPSSE    FIXED(31),   /*PSEUDO ADDRESS FOR IEAVTSSE FOR       05515033
*            ENABLED SUMDUMPS OF MORE THAN ONE ADDRESS SPACE @ZM45052*/ 05530033
*    /*AREAS USED TO INDICATE THE STATISICS OF A SUMMARY DUMP*/         05533033
*    2 SMWKNFRQ    FIXED(15),   /*NUMBER OF FRAMES REQUESTED @ZM45073*/ 05536033
*    2 SMWKNFAQ    FIXED(15),   /*NUMBER OF FRAMES AQUIRED   @ZM45073*/ 05539033
*    2 SMWKNFUS    FIXED(15),   /*NUMBER OF FRAMES USED      @ZM45073*/ 05542033
*    2 SMWKNTDI    FIXED(15),  /*NUMBER OF TIMES DIE ENTERED @ZM45073*/ 05545033
*    2 SMWKNTDQ    FIXED(15),   /*NUMBER OF DIE REQUEUED     @ZM45073*/ 05548033
*    2 SMWKNFFD    FIXED(15),   /*NUMBER FRAMES FREED BY DIE @ZM45073*/ 05551033
*    2 SMWKNSTB    FIXED(15),   /*TIMES STEAL BACKS OCCURRED @ZM45073*/ 05554033
*    2 *           FIXED(15);   /*RESERVED                   @ZM45073*/ 05557033
* DCL SMWKLEN      FIXED(31) STATIC LOCAL INIT(LENGTH(SMWK)); /* LENGTH 05560033
*                                                        OF THE SMWK */ 05610033
