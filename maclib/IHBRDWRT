         MACRO                                                          00020000
&NAME    IHBRDWRT &DECB,&TYPE,&DCB,&AREA,&LENGTH,&KEYADR,&RCDREF,&MF=I  00040000
         GBLB  &IHBWR,&IHBS(4),&IHBT(2)                                 00060000
         LCLB  &TYPRR,&TYPL,&WRTSW,&SWONE,&SWTWO,&SWTHREE,&SWFOUR       00080000
         LCLB  &S1,&S2,&S3,&ISW,&ESW                                    00100019
         LCLB  &A1,&A2,&A3,&A4,&A5,&A6,&C1,&C2,&C3,&C4,&C5,&C6     000B 00123014
         LCLB  &B1,&B2,&B3,&B4,&B5,&B6,&B7,&B8,&B9,&B10,&B11,&B12,&B13  00125019
         LCLB  &B14,&B15,&B16,&B17,&B18,&B19,&B20,&B21,&B22,&B23        00127019
         LCLB  &B24,&B25,&B26,&B27,&B28,&B29,&B30,&B31,&B32    @ZA41588 00127500
         LCLB  &TSW                                                000B 00129014
         LCLB  &CTR0SW                                          YA01248 00131002
         LCLA  &CNT                                                000B 00132014
         LCLC  &CHAR,&CHARS,&REG                                   000B 00135014
         LCLA  &CTR                                                     00140000
&TYPRR   SETB  (&IHBT(2))                                               00160000
&TYPL    SETB  (&IHBT(1))                                               00180000
&WRTSW   SETB  (&IHBWR)                                                 00200000
&SWONE   SETB  (&IHBS(1))                                               00220000
&SWTWO   SETB  (&IHBS(2))                                               00240000
&SWTHREE SETB  (&IHBS(3))                                               00260000
&SWFOUR  SETB  (&IHBS(4))                                               00280000
&ESW     SETB  ('&MF(1)' EQ 'E')                                        00300000
&ISW     SETB  ('&MF' EQ 'I')                                           00320000
         AIF   ((N'&AREA NE 2 AND N'&LENGTH EQ 2) OR (N'&AREA EQ 2 AND C00325014
               N'&LENGTH NE 2)).E13                                000B 00330014
&TSW     SETB  (N'&AREA EQ 2)                                      000B 00335014
         AIF   ('&MF' EQ 'I').IROUT                                     00340000
         AIF   ('&MF(1)' EQ 'E').EROUT                                  00360000
         AIF   ('&MF' NE 'L').E1                                        00380000
&NAME    DS    0F                                                       00400000
         AGO   .ILROUT                                                  00420000
.E2      IHBERMAC 87                                                    00440000
         MEXIT                                                          00460000
.E3      ANOP                                                           00480000
.E4      ANOP                                                           00500000
.E5      ANOP                                                           00520000
.E6      IHBERMAC 48,,&TYPE                                             00540000
         MEXIT                                                          00560000
.E7      IHBERMAC 69                                                    00580000
         MEXIT                                                          00600000
.E13     IHBERMAC 47                                               000B 00606014
         MEXIT                                                     000B 00612014
.ILROUT  AIF   ('&DECB'(1,1) EQ '(').E2                                 00620000
&DECB    DC    A(0)                              EVENT CONTROL BLOCK    00640000
&S1      SETB  ('&KEYADR' EQ '''S''')                                   00660000
&S2      SETB  ('&AREA(1)' EQ '''S''')                             000B 00662014
&A2      SETB  ('&AREA' EQ '')                                     000B 00664014
         AIF   (&A2).GNEXT                                         000B 00666014
&A1      SETB  (N'&AREA NE 2)                                      000B 00668014
         AIF   ('&AREA'(1,1) NE '(' OR &A1).GNEXT                  000B 00670014
&A2      SETB  ('&AREA(1)' EQ '')                                  000B 00672014
         AIF   (&A2).SKIPA                                         000B 00674014
&A4      SETB  ('&AREA(1)'(1,1) EQ '(')                            000B 00676014
.SKIPA   ANOP                                                      000B 00678014
&A3      SETB  ('&AREA(2)' EQ '')                                  000B 00680014
         AIF   (&A3).GNEXT                                         000B 00682014
&A5      SETB  ('&AREA(2)'(1,1) EQ '(')                            000B 00684014
&A6      SETB  ('&AREA(2)' EQ '''S''')                             000B 00686014
.GNEXT   ANOP                                                      000B 00688014
&S3      SETB  ('&LENGTH(1)' EQ '''S''')                           000B 00690014
&C2      SETB  ('&LENGTH' EQ '')                                   000B 00692014
         AIF   (&C2).GTNEXT                                        000B 00694014
&C1      SETB  (N'&LENGTH NE 2)                                    000B 00696014
         AIF   ('&LENGTH'(1,1) NE '(' OR &C1).GTNEXT               000B 00698014
&C2      SETB  ('&LENGTH(1)' EQ '')                                000B 00700014
         AIF   (&C2).SKIPC                                         000B 00702014
&C4      SETB  ('&LENGTH(1)'(1,1) EQ '(')                          000B 00704014
.SKIPC   ANOP                                                      000B 00706014
&C3      SETB  ('&LENGTH(2)' EQ '')                                000B 00708014
         AIF   (&C3).GTNEXT                                        000B 00710014
&C5      SETB  ('&LENGTH(2)'(1,1) EQ '(')                          000B 00712014
&C6      SETB  ('&LENGTH(2)' EQ '''S''')                           000B 00714014
.GTNEXT  ANOP                                                      000B 00716014
         DC    BL1'&S1&S2&S3'                                           00720000
         AIF   (NOT &ISW AND &SWONE AND '&TYPE' EQ 'T').OUTQUIK         00740000
.SHORTRT AIF   (&SWTWO+&SWTHREE+&SWFOUR NE 1).E3                        00760000
         AIF   (&SWFOUR).TXXX                                           00764019
         AIF   (&SWTHREE).TXX                                           00768019
.*                                                                      00772019
.*      THIS TABLE FOR TWO CHARACTER                   OPER.  OPTYPE    00776019
.*      OPERATION TYPES                                NAME  (DEC)      00780019
.*                                                                      00784019
&B1      SETB  ('&TYPE'(2,1) EQ 'B' AND (NOT &WRTSW))  RD TB    11      00788019
&B2      SETB  ('&TYPE'(2,1) EQ 'B' AND &WRTSW)        WR TB    00      00792019
&B3      SETB  ('&TYPE'(2,1) EQ 'I' AND (NOT &WRTSW))  RD TI    01      00796019
&B4      SETB  ('&TYPE'(2,1) EQ 'I' AND &WRTSW)        WR TI    02      00800019
&B5      SETB  ('&TYPE'(2,1) EQ 'T' AND (NOT &WRTSW))  RD TT    03      00804019
&B6      SETB  ('&TYPE'(2,1) EQ 'T' AND &WRTSW)        WR TT    04      00808019
&B7      SETB  ('&TYPE'(2,1) EQ 'V' AND (NOT &WRTSW))  RD TV    05      00812019
&B8      SETB  ('&TYPE'(2,1) EQ 'V' AND &WRTSW)        WR TV    06      00816019
&B9      SETB  ('&TYPE'(2,1) EQ 'P' AND (NOT &WRTSW))  RD TP    07      00820019
&B10     SETB  ('&TYPE'(2,1) EQ 'A' AND &WRTSW)        WR TA    08      00824019
&B11     SETB  ('&TYPE'(2,1) EQ 'S' AND (NOT &WRTSW))  RD TS    09      00828019
&B12     SETB  ('&TYPE'(2,1) EQ 'S' AND &WRTSW)        WR TS    14      00832019
&B13     SETB  ('&TYPE'(2,1) EQ 'N' AND &WRTSW)        WR TN    10      00836019
&B14     SETB  ('&TYPE'(2,1) EQ 'R' AND &WRTSW)        WR TR    10      00840019
&B15     SETB  ('&TYPE'(2,1) EQ 'L' AND &WRTSW)        WR TL    12      00844019
&B16     SETB  ('&TYPE'(2,1) EQ 'D' AND &WRTSW)        WR TD    16      00848019
&B17     SETB  ('&TYPE'(2,1) EQ 'Q' AND (NOT &WRTSW))  RD TQ    21      00852019
&B18     SETB  ('&TYPE'(2,1) EQ 'Q' AND &WRTSW)        WR TQ    22      00856019
&B19     SETB  ('&TYPE'(2,1) EQ 'W' AND &WRTSW)        WR TW    26      00860019
&B20     SETB  ('&TYPE'(2,1) EQ 'C' AND (NOT &WRTSW))  RD TC    17      00864019
&B21     SETB  ('&TYPE'(2,1) EQ 'C' AND &WRTSW)        WR TC    28      00868019
&B22     SETB  ('&TYPE'(2,1) EQ 'E' AND (NOT &WRTSW))  RD TE    07      00872019
&B23     SETB  ('&TYPE'(2,1) EQ 'M' AND (NOT &WRTSW))  RD TM    17      00874002
         AIF   (&B1+&B2+&B3+&B4+&B5+&B6+&B7+&B8+&B9+&B10+&B11+&B12+&B13*00876019
               +&B14+&B15+&B16+&B17+&B18+&B19+&B20+&B21+&B22+&B23 NE 1)X00880002
               .E4                                                      00882002
&CTR     SETA  11*&B1+&B3+2*&B4+3*&B5+4*&B6+5*&B7+6*&B8+7*&B9+8*&B10    00884019
&CTR     SETA  &CTR+9*&B11+14*&B12+10*&B13+10*&B14+12*&B15+16*&B16      00888019
&CTR     SETA  &CTR+21*&B17+22*&B18+26*&B19+17*&B20+28*&B21+7*&B22      00892019
&CTR     SETA  &CTR+17*&B23                                             00894002
         AGO   .ALLDONE                                                 00896019
.*                                                                      00900019
.*      THIS TABLE FOR THREE CHARACTER                 OPER.  OPTYPE    00904019
.*      OPERATION TYPES                                NAME  (DEC)      00908019
.*                                                                      00912019
.TXX     ANOP                                                           00916019
&B1      SETB  ('&TYPE'(2,2) EQ 'IR' AND (NOT &WRTSW)) RD TIR  129      00920019
&B2      SETB  ('&TYPE'(2,2) EQ 'IR' AND &WRTSW)       WR TIR  130      00924019
&B3      SETB  ('&TYPE'(2,2) EQ 'TR' AND (NOT &WRTSW)) RD TTR  131      00928019
&B4      SETB  ('&TYPE'(2,2) EQ 'TR' AND &WRTSW)       WR TTR  132      00932019
&B5      SETB  ('&TYPE'(2,2) EQ 'VR' AND (NOT &WRTSW)) RD TVR  133      00936019
&B6      SETB  ('&TYPE'(2,2) EQ 'VR' AND &WRTSW)       WR TVR  134      00940019
&B7      SETB  ('&TYPE'(2,2) EQ 'PR' AND (NOT &WRTSW)) RD TPR  135      00944019
&B8      SETB  ('&TYPE'(2,2) EQ 'TA' AND (NOT &WRTSW)) RD TTA   13      00948019
&B9      SETB  ('&TYPE'(2,2) EQ 'LR' AND &WRTSW)       WR TLR  140      00952019
&B10     SETB  ('&TYPE'(2,2) EQ 'IO' AND &WRTSW)       WR TIO   12      00956019
&B11     SETB  ('&TYPE'(2,2) EQ 'IV' AND &WRTSW)       WR TIV   13      00960019
&B12     SETB  ('&TYPE'(2,2) EQ 'CO' AND &WRTSW)       WR TCO   14      00964019
&B13     SETB  ('&TYPE'(2,2) EQ 'TV' AND &WRTSW)       WR TTV   15      00968019
&B14     SETB  ('&TYPE'(2,2) EQ 'US' AND &WRTSW)       WR TUS   18      00972002
&B15     SETB  ('&TYPE'(2,2) EQ 'IX' AND &WRTSW)       WR TIX   18      00976019
&B16     SETB  ('&TYPE'(2,2) EQ 'VO' AND &WRTSW)       WR TVO   18      00980019
&B17     SETB  ('&TYPE'(2,2) EQ 'TL' AND (NOT &WRTSW)) RD TTL   19      00984019
&B18     SETB  ('&TYPE'(2,2) EQ 'TX' AND &WRTSW)       WR TTX   20      00988019
&B19     SETB  ('&TYPE'(2,2) EQ 'PL' AND (NOT &WRTSW)) RD TPL   23      00992019
&B20     SETB  ('&TYPE'(2,2) EQ 'IQ' AND (NOT &WRTSW)) RD TIQ   25      00996019
&B21     SETB  ('&TYPE'(2,2) EQ 'RV' AND (NOT &WRTSW)) RD TRV   27      01000019
&B22     SETB  ('&TYPE'(2,2) EQ 'SR' AND &WRTSW)       WR TSR  142      01004019
&B23     SETB  ('&TYPE'(2,2) EQ 'CW' AND (NOT &WRTSW)) RD TCW   30      01008019
&B24     SETB  ('&TYPE'(2,2) EQ 'IE' AND &WRTSW)       WR TIE   12      01009019
&B25     SETB  ('&TYPE'(2,2) EQ 'TE' AND &WRTSW)       WR TTE   14      01010019
&B26     SETB  ('&TYPE'(2,2) EQ 'BR' AND (NOT &WRTSW)) RD TBR  139      01011021
&B27     SETB  ('&TYPE'(2,2) EQ 'MP' AND (NOT &WRTSW)) RD TMP   25      01011602
&B28     SETB  ('&TYPE'(2,2) EQ 'BP' AND (NOT &WRTSW)) RD TBP   19      01011802
&B29     SETB  ('&TYPE'(2,2) EQ 'RM' AND &WRTSW)  WR TRM 11     YA01571 01011902
&B30     SETB  ('&TYPE'(2,2) EQ 'QM' AND (NOT &WRTSW)) RD TQM09 YA01552 01018602
&B31     SETB  ('&TYPE'(2,2) EQ 'SA' AND &WRTSW)      WRT SA 06 ZA25924 01021600
&B32     SETB  ('&TYPE'(2,2) EQ 'SF' AND &WRTSW)               @ZA41588 01023600
         AIF   (&B1+&B2+&B3+&B4+&B5+&B6+&B7+&B8+&B9+&B10+&B11+&B12+&B13*01026002
               +&B14+&B15+&B16+&B17+&B18+&B19+&B20+&B21+&B22+&B23+&B24+X01032702
               &B25+&B26+&B27+&B28+&B29+&B30+&B31+&B32 NE 1).E5 ZA99999 01035700
&CTR     SETA  129*&B1+130*&B2+131*&B3+132*&B4+133*&B5+134*&B6          01046102
&CTR     SETA  &CTR+135*&B7+13*&B8+140*&B9+12*&B10+13*&B11+14*&B12      01052802
&CTR     SETA  &CTR+15*&B13+18*&B14+18*&B15+18*&B16+19*&B17+20*&B18     01059502
&CTR     SETA  &CTR+23*&B19+25*&B20+27*&B21+142*&B22+30*&B23+12*&B24    01066202
&CTR     SETA  &CTR+14*&B25+139*&B26+25*&B27+19*&B28             A41108 01072902
&CTR     SETA  &CTR+11*&B29+9*&B30+6*&B31+8*&B32               @ZA41588 01074900
         AGO   .ALLDONE                                                 01079602
.*                                                                      01086302
.*      THIS TABLE FOR FOUR CHARACTER                  OPER.  OPTYPE    01093002
.*      OPERATION TYPES                                NAME  (DEC)      01099702
.*                                                                      01106402
.TXXX    ANOP                                                           01113102
&B1      SETB  ('&TYPE'(2,3) EQ 'IVX' AND &WRTSW)      WR TIVX  29      01119802
&B2      SETB  ('&TYPE'(2,3) EQ 'TVX' AND &WRTSW)      WR TTVX  31      01126502
&B3      SETB  ('&TYPE'(2,3) EQ 'IXR' AND &WRTSW)      WR TIXR 146      01133202
&B4      SETB  ('&TYPE'(2,3) EQ 'TXR' AND &WRTSW)      WR TTXR 148      01139902
         AIF   (&B1+&B2+&B3+&B4 NE 1).E6                                01146602
&CTR     SETA  29*&B1+31*&B2+146*&B3+148*&B4                            01153302
.ALLDONE ANOP                                                           01160000
         AIF   (&ESW).ERETURN                                           01720000
.OUTQUIK DC    AL1(&CTR)                         TYPE FIELD             01740000
         AIF   (&ISW).IRETURN                                           01760000
         AIF   (&C4 OR &C5 OR &C6).E13                             000B 01770014
         AIF   ('&LENGTH' EQ '' OR &S3 OR &C2).NOLENG              000B 01780014
         AIF   ('&LENGTH'(1,1) EQ '(' AND &C1).E13                 000B 01790014
         DC    AL2(&LENGTH(1))                   LENGTH            000B 01800014
         AGO   .CHKDCB                                                  01840000
.NOLENG  DC    AL2(0)                            LENGTH                 01860000
.CHKDCB  AIF   ('&DCB' EQ '').NODCB                                     01880000
         AIF   ('&DCB'(1,1) EQ '(').E7                                  01900000
         DC    A(&DCB)                           DCB ADDRESS            01920000
         AGO   .CHKAREA                                                 01940000
.NODCB   DC    A(0)                              DCB ADDRESS            01960000
.CHKAREA AIF   (&A4 OR &A5 OR &A6).E13                             000B 01970014
         AIF   ('&AREA' EQ '' OR &S2 OR &A2).NOAREA                000B 01980014
         AIF   ('&AREA'(1,1) EQ '(' AND &A1).E13                   000B 01990014
         DC    A(&AREA(1))                       AREA ADDRESS      000B 02000014
         AGO   .PTRWD                                                   02040000
.NOAREA  DC    A(0)                              AREA ADDRESS           02060000
.PTRWD   DC    A(0)                              ERROR INFO. FIELD ADDR 02080000
         AIF   (&S1 OR '&KEYADR' EQ '').NOKEY                           02100000
         AIF   ('&KEYADR'(1,1) EQ '(').E7                               02120000
         DC    A(&KEYADR)                        TERMINAL LIST ADDRESS  02140000
         AGO   .CHKARG2                                                 02160000
.NOKEY   DC    A(0)                              TERMINAL LIST ADDRESS  02180000
.CHKARG2 AIF   ('&RCDREF' EQ '').NOARG2                                 02200000
         AIF   ('&RCDREF'(1,1) EQ '(').E7                               02220000
         DC    AL2(&RCDREF)                      LINE NUMBER            02240000
         AGO   .RPFLD                                                   02260000
.NOARG2  DC    AL2(0)                            LINE NUMBER            02280000
.RPFLD   DC    AL2(0)                            RESPONSE FIELD         02300000
         DC    AL1(0)                   TP-OP CODE                      02320000
         DC    AL1(0)                   ERROR STATUS                    02340000
         DC    AL2(0)                   CSW STATUS                      02360000
         DC    AL4(0)                   CURRENT ADDR LIST PTR           02380000
         DC    AL4(0)                   CURRENT ADDR POLL PTR           02400000
         AIF   (NOT &TSW).END                                      000B 02401014
         DC    AL2(0)                   RESERVED                   000B 02402014
.CHKLN2  AIF   ('&LENGTH' EQ '').NOLEN2                            000B 02403014
         AIF   ('&LENGTH'(1,1) NE '(').NOLEN2                      000B 02404014
         AIF   (&C5 OR &C3).NOLEN2                                 000B 02405014
         DC    AL2(&LENGTH(2))                   WLENGTH           000B 02406014
         AGO   .CHKAR2                                             000B 02407014
.NOLEN2  DC    AL2(0)                            WLENGTH           000B 02408014
.CHKAR2  AIF   ('&AREA' EQ '').NOAREA2                             000B 02409014
         AIF   ('&AREA'(1,1) NE '(').NOAREA2                       000B 02410014
         AIF   (&A3).NOAREA2                                       000B 02411014
         DC    A(&AREA(2))                       WRITE AREA ADDR   000B 02412014
         AGO   .END                                                000B 02413014
.NOAREA2 DC    A(0)                              WRITE AREA ADDR   000B 02414014
         AGO   .END                                                     02420000
.IROUT   CNOP  0,4                                                      02440000
         AIF   (&TSW).LNGDECB                                      000B 02450014
&NAME    BAL   1,*+44                                                   02460000
         AGO   .ILROUT                                             000B 02465014
.LNGDECB ANOP                                                      000B 02470014
&NAME    BAL   1,*+52                                              000B 02475014
         AGO   .ILROUT                                                  02480000
.IRETURN ANOP                                                           02490014
         AIF   (&C6).E13                                           000B 02500014
         AIF   ('&LENGTH' EQ '').ZLENGTH                           000B 02510014
         AIF   ('&LENGTH'(1,1) EQ '(' AND N'&LENGTH EQ 1).ZLENGTH  000B 02520014
         AIF   (&S3 OR &C2 OR &C4).ZLENGTH                         000B 02530014
         DC    AL2(&LENGTH(1))                   LENGTH            000B 02540014
         AGO   .CKDCB                                                   02560000
.ZLENGTH DC    AL2(0)                            LENGTH                 02580000
.CKDCB   AIF   ('&DCB' EQ '').E9                                        02600000
         AIF   ('&DCB'(1,1) EQ '(').ZDCB                                02620000
         DC    A(&DCB)                           DCB ADDRESS            02640000
         AGO   .CKAREA                                                  02660000
.ZDCB    DC    A(0)                              DCB ADDRESS            02680000
.CKAREA  AIF   ('&AREA' EQ '').ZAREA                               000B 02690014
         AIF   ('&AREA'(1,1) EQ '(' AND N'&AREA EQ 1).ZAREA        000B 02700014
         AIF   (&S2 OR &A2 OR &A4).ZAREA                           000B 02710014
         DC    A(&AREA(1))                       AREA ADDRESS      000B 02720014
         AGO   .ZPTRWD                                                  02760000
.ZAREA   DC    A(0)                              AREA ADDRESS           02780000
.ZPTRWD  DC    A(0)                              ERROR INFO. FIELD ADDR 02800000
         AIF   ('&KEYADR' EQ '').ZKEY                                   02820000
         AIF   (&S1 OR '&KEYADR'(1,1) EQ '(' OR '&KEYADR' EQ '').ZKEY   02840000
         DC    A(&KEYADR)                        TERMINAL LIST ADDRESS  02860000
         AGO   .CKARG2                                                  02880000
.ZKEY    DC    A(0)                              TERMINAL LIST ADDRESS  02900000
.CKARG2  AIF   ('&RCDREF' EQ '').E12                                    02920000
         AIF   ('&RCDREF'(1,1) EQ '(').ZARG2                            02940000
         DC    AL2(&RCDREF)                      LINE NUMBER            02960000
         AGO   .EXCPCD                                                  02980000
.ZARG2   DC    AL2(0)                            LINE NUMBER            03000000
.EXCPCD  DC    AL2(0)                            RESPONSE FIELD         03020000
         DC    AL1(0)                   TP-OP CODE                      03040000
         DC    AL1(0)                   ERROR STATUS                    03060000
         DC    AL2(0)                   CSW STATUS                      03080000
         DC    AL4(0)                   CURRENT ADDR LIST PTR           03100000
         DC    AL4(0)                   CURRENT ADDR POLL PTR           03120000
         AIF   (NOT &TSW).TSTLNG                                   000B 03122014
         DC    AL2(0)                   RESERVED                   000B 03124014
         AIF   ('&LENGTH' EQ '').ZLEN2                             000B 03126014
.CKLEN2  AIF   (('&LENGTH'(1,1) EQ '(' AND N'&LENGTH EQ 1) OR          C03128014
               '&LENGTH'(1,1) NE '(').ZLEN2                        000B 03130014
         AIF   (&C3 OR &C5).ZLEN2                                  000B 03132014
         DC    AL2(&LENGTH(2))                   WLENGTH           000B 03134014
         AGO   .CKAREA2                                            000B 03136014
.ZLEN2   DC    AL2(0)                            WLENGTH           000B 03138014
.CKAREA2 AIF   ('&AREA' EQ '').ZAREA2                              000B 03140014
         AIF   (('&AREA'(1,1) EQ '(' AND N'&AREA EQ 1) OR              C03142014
               '&AREA'(1,1) NE '(').ZAREA2                         000B 03144014
         AIF   (&A3 OR &A5 OR &A6).ZAREA2                          000B 03146014
         DC    A(&AREA(2))                       WRITE AREA ADDR   000B 03148014
         AGO   .TSTLNG                                             000B 03150014
.ZAREA2  DC    A(0)                              WRITE AREA ADDR   000B 03152014
.TSTLNG  AIF   ('&LENGTH' EQ '').TSTDCB                            000B 03154014
         AIF   ('&LENGTH'(1,1) NE '(' AND N'&LENGTH EQ 1).TSTDCB   000B 03156014
         AIF   (N'&LENGTH EQ 2).LREGS                              000B 03158014
         STH   &LENGTH(1),6(0,1)                 STORE LENGTH      000B 03160014
         AGO   .TSTDCB                                             000B 03162014
.LREGS   AIF   (NOT &C4).LCHK2                                     000B 03164014
&CNT     SETA  K'&LENGTH(1)                                        000B 03166014
&REG     SETC  '&LENGTH(1)'(2,&CNT-2)                              000B 03168014
.OUT3    STH   &REG,6(0,1)                       STORE LENGTH      000B 03170014
.LCHK2   AIF   (NOT (&C5 AND &TSW)).TSTDCB                         000B 03172014
&CNT     SETA  K'&LENGTH(2)                                        000B 03174014
&REG     SETC  '&LENGTH(2)'(2,&CNT-2)                              000B 03176014
.OUT4    STH   &REG,42(0,1)                      STORE WLENGTH     000B 03178014
.TSTDCB  AIF   ('&DCB'(1,1) NE '(').TSTAREA                             03180000
         ST    &DCB(1),8(0,1)                    STORE DCB ADDRESS      03200000
.TSTAREA AIF   ('&AREA' EQ '').TSTKEY                              000B 03204014
         AIF   ('&AREA'(1,1) NE '(' AND N'&AREA EQ 1).TSTKEY       000B 03208014
         AIF   (N'&AREA EQ 2).REGS                                 000B 03212014
         ST    &AREA(1),12(0,1)                  STORE AREA ADDR   000B 03216014
         AGO   .TSTKEY                                             000B 03220014
.REGS    AIF   (NOT &A4).CHK2                                      000B 03224014
&CNT     SETA  K'&AREA(1)                                          000B 03228014
&REG     SETC  '&AREA(1)'(2,&CNT-2)                                000B 03232014
.OUT1    ST    &REG,12(0,1)                      STORE AREA ADDR   000B 03236014
.CHK2    AIF   (NOT (&A5 AND &TSW)).TSTKEY                         000B 03240014
&CNT     SETA  K'&AREA(2)                                          000B 03244014
&REG     SETC  '&AREA(2)'(2,&CNT-2)                                000B 03248014
.OUT2    ST    &REG,44(0,1)                      STORE WAREA ADDR  000B 03252014
.TSTKEY  AIF   ('&KEYADR' EQ '').TSTARG2                                03260000
         AIF   ('&KEYADR'(1,1) NE '(').TSTARG2                          03280000
         ST    &KEYADR(1),20(0,1)                STORE TERM. LIST ADDR. 03300000
.TSTARG2 AIF   ('&RCDREF'(1,1) NE '(').CONTA                            03320000
         STH   &RCDREF(1),24(0,1)                STORE LINE NUMBER      03340000
.CONTA   AIF   ('&DCB' EQ '').CONTAA                                    03360000
         AIF   ('&DCB'(1,1) EQ '(').REGDCB                              03380000
&CTR     SETA  K'&DCB                                                   03400000
         AIF   ('&DCB'(&CTR,1) EQ ')').CONTAA                           03420000
         L     15,&DCB+48                        LOAD RDWRT ROUT ADDR   03440000
.FINISH  ANOP                                                    A38557 03445020
         AIF   ('&AREA' EQ '' OR &A2).FINISH1                    A38557 03450020
         AIF   ('&LENGTH' EQ '' OR &C2).FINISH1                  A38557 03455020
         AIF   ('&TYPE' EQ 'T').WRTQCK                           A46830 03458021
         AIF   ('&TYPE'(2,1) EQ 'Q' AND &WRTSW).WRTQCK           A46830 03461021
.FINISH1 ANOP                                                   YA01248 03465002
         AIF   (&CTR0SW).FINISH2                                YA01248 03467002
         NI    4(1),X'F7'                                       YA01248 03469002
.FINISH2 BALR  14,15                                             A38557 03470020
         AGO   .END                                                     03480000
.CONTAA  L     15,8(0,1)                                                03500000
         L     15,48(0,15)                       LOAD RDWR ROUT. ADDR.  03520000
         AGO   .FINISH                                                  03540000
.REGDCB  L     15,48(0,&DCB(1))                  LOAD RDWR ROUT. ADDR.  03560000
         AGO   .FINISH                                                  03580000
.WRTQCK  OI    4(1),X'08'                                        A38557 03586020
         AGO   .FINISH2                                          A38557 03593020
.EROUT   AIF   ('&DECB'(1,1) EQ '(').DECBREG                            03600000
&NAME    LA    1,&DECB                           LOAD DECB ADDRESS      03620000
         AGO   .CONTB                                                   03640000
.DECBREG AIF   ('&DECB' EQ '(1)').NAMEIT                                03660000
&NAME    LR    1,&DECB(1)                        LOAD DECB ADDRESS      03680000
         AGO   .CONTB                                                   03700000
.NAMEIT  AIF   ('&NAME' EQ '').CONTB                                    03720000
&NAME    DS    0H                                                       03740000
.CONTB   ANOP                                                           03760000
&S1      SETB  ('&KEYADR' EQ '')                                        03780000
&S2      SETB  ('&AREA(1)' EQ '')                                  000B 03800014
&S3      SETB  ('&LENGTH(1)' EQ '')                                000B 03820014
&CTR     SETA  4*&S1+2*&S2+&S3                                          03840000
         AIF   (&CTR EQ 7).SETTYPE                                      03860000
         AIF   (&CTR EQ 0).SETSW                                        03880000
&S1      SETB  ('&KEYADR' EQ '''S''' OR '&KEYADR' EQ '')                03900000
&S2      SETB  ('&AREA(1)' EQ '''S''' OR '&AREA(1)' EQ '')         000B 03920014
&S3      SETB  ('&LENGTH(1)' EQ '''S''' OR '&LENGTH(1)' EQ '')     000B 03940014
&CTR     SETA  4*&S1+2*&S2+&S3                                          03960000
         AIF   (&CTR EQ 7).ORRT                                         03980000
         NI    4(1),&CTR                                                04000000
&CTR0SW  SETB  1                                                YA02145 04010002
         AGO   .ORRT                                                    04020000
.SETSW   ANOP                                                           04040000
&B1      SETB  1                                                        04060000
.ORRT    ANOP                                                           04080000
&S1      SETB  ('&KEYADR' EQ '''S''')                                   04100000
&S2      SETB  ('&AREA(1)' EQ '''S''')                             000B 04120014
&S3      SETB  ('&LENGTH(1)' EQ '''S''')                           000B 04140014
&CTR     SETA  4*&S1+2*&S2+&S3                                          04160000
         AIF   (&B1).MVIRT                                              04180000
         AIF   (&CTR EQ 0).SETTYPE                                      04200000
         OI    4(1),&CTR                                                04220000
         AGO   .SETTYPE                                                 04240000
.MVIRT   ANOP                                                   YA01248 04260002
         MVI   4(1),&CTR                                        YA02145 04260402
&CTR0SW  SETB  1                                                YA01248 04260802
.SETTYPE ANOP                                                      000B 04261014
&A2      SETB  ('&AREA' EQ '')                                     000B 04262014
         AIF   (&A2).GMNEXT                                        000B 04263014
&A1      SETB  (N'&AREA NE 2)                                      000B 04264014
         AIF   ('&AREA'(1,1) NE '(' OR &A1).GMNEXT                 000B 04265014
&A2      SETB  ('&AREA(1)' EQ '')                                  000B 04266014
         AIF   (&A2).SKIPB                                         000B 04267014
&A4      SETB  ('&AREA(1)'(1,1) EQ '(')                            000B 04268014
.SKIPB   ANOP                                                      000B 04269014
&A3      SETB  ('&AREA(2)' EQ '')                                  000B 04270014
         AIF   (&A3).GMNEXT                                        000B 04271014
&A5      SETB  ('&AREA(2)'(1,1) EQ '(')                            000B 04272014
&A6      SETB  ('&AREA(2)' EQ '''S''')                             000B 04273014
.GMNEXT  ANOP                                                      000B 04274014
&C2      SETB  ('&LENGTH' EQ '')                                   000B 04275014
         AIF   (&C2).GTTNEXT                                       000B 04276014
&C1      SETB  (N'&LENGTH NE 2)                                    000B 04277014
         AIF   ('&LENGTH'(1,1) NE '(' OR &C1).GTTNEXT              000B 04278014
&C2      SETB  ('&LENGTH(1)' EQ '')                                000B 04279014
         AIF   (&C2).SKIPD                                         000B 04280014
&C4      SETB  ('&LENGTH(1)'(1,1) EQ '(')                          000B 04281014
.SKIPD   ANOP                                                      000B 04282014
&C3      SETB  ('&LENGTH(2)' EQ '')                                000B 04283014
         AIF   (&C3).GTTNEXT                                       000B 04284014
&C5      SETB  ('&LENGTH(2)'(1,1) EQ '(')                          000B 04285014
&C6      SETB  ('&LENGTH(2)' EQ '''S''')                           000B 04286014
.GTTNEXT ANOP                                                      000B 04287014
         AIF   ('&TYPE' EQ 'T').LENTEST                            000B 04288014
         AGO   .SHORTRT                                                 04300000
.ERETURN MVI   5(1),&CTR                                                04320000
.LENTEST AIF   (&C6).E8                                            000B 04330014
         AIF   ('&LENGTH' EQ '').XLENGTH                           000B 04340014
         AIF   (&S3 OR &C2).OPER2                                  000B 04350014
         AIF   ('&LENGTH'(1,1) EQ '(' AND N'&LENGTH EQ 1).ONREG    000B 04360014
         AIF   ('&LENGTH'(1,1) NE '(' OR NOT &C4).OPERTYP          000B 04370014
         AIF   (N'&LENGTH EQ 2).REG1                               000B 04380014
.ONREG   STH   &LENGTH(1),6(0,1)                 STORE LENGTH      000B 04390014
         AGO   .XLENGTH                                                 04400000
.REG1    ANOP                                                      000B 04405014
&CNT     SETA  K'&LENGTH(1)                                        000B 04410014
&REG     SETC  '&LENGTH(1)'(2,&CNT-2)                              000B 04415014
.OUT5    STH   &REG,6(0,1)                       STORE LENGTH      000B 04420014
         AGO   .TSTOP2                                             000B 04425014
.OPERTYP AIF   (NOT (&TYPL AND NOT &C2)).MOVTYP                    000B 04430014
         AIF   (&LENGTH(1) LE 4095).LASTR                          000B 04435014
.MOVTYP  B     *+6                                                 000B 04440014
         DC    AL2(&LENGTH(1))                                     000B 04445014
         MVC   6(2,1),*-2                        MOVE IN LENGTH    000B 04450014
         AGO   .NXTST                                              000B 04455014
.LASTR   LA    14,&LENGTH(1).(0,0)                                 000B 04460014
         STH   14,6(0,1)                         STORE LENGTH      000B 04465014
.NXTST   AIF   (N'&LENGTH EQ 2).TSTOP2                             000B 04470014
         AGO   .XLENGTH                                            000B 04475014
.OPER2   AIF   (N'&LENGTH NE 2 OR &C3).XLENGTH                     000B 04480014
.TSTOP2  AIF   (&C5).REG2                                          000B 04485014
         AIF   (&C3).XLENGTH                                       000B 04490014
         AIF   ('&LENGTH(2)'(1,1) LT '0').MOVTYP2                  000B 04495014
         AIF   (&LENGTH(2) LE 4095).LASTR2                         000B 04500014
.MOVTYP2 B     *+6                                                 000B 04505014
         DC    AL2(&LENGTH(2))                                     000B 04510014
         MVC   42(2,1),*-2                       MOVE IN WLENGTH   000B 04515014
         AGO   .XLENGTH                                            000B 04520014
.LASTR2  LA    14,&LENGTH(2).(0,0)                                 000B 04525014
         STH   14,42(0,1)                        STORE WLENGTH     000B 04530014
         AGO   .XLENGTH                                            000B 04535014
.REG2    ANOP                                                      000B 04540014
&CNT     SETA  K'&LENGTH(2)                                        000B 04545014
&REG     SETC  '&LENGTH(2)'(2,&CNT-2)                              000B 04550014
.OUT6    STH   &REG,42(0,1)                      STORE WLENGTH     000B 04555014
.XLENGTH AIF   ('&DCB' EQ '').XDCB                                      04580000
         AIF   ('&DCB'(1,1) EQ '(').DCBRG                               04600000
         LA    14,&DCB                                                  04620000
         ST    14,8(0,1)                         STORE DCB ADDRESS      04640000
         AGO   .XDCB                                                    04660000
.DCBRG   ST    &DCB(1),8(0,1)                    STORE DCB ADDRESS      04680000
.XDCB    AIF   ('&AREA' EQ '' OR &S2 OR &A2).XAREA                 000B 04686014
         AIF   ('&AREA'(1,1) EQ '(' AND N'&AREA EQ 1).AREARG0      000B 04692014
         AIF   (&A4).AREARG1                                       000B 04698014
         LA    14,&AREA(1)                                         000B 04704014
         ST    14,12(0,1)                        STORE AREA ADDR   000B 04710014
         AGO   .XAREA                                              000B 04716014
.AREARG0 ST    &AREA(1),12(0,1)                  STORE AREA ADDR   000B 04722014
         AGO   .XAREA                                              000B 04728014
.AREARG1 ANOP                                                      000B 04734014
&CNT     SETA  K'&AREA(1)                                          000B 04740014
&REG     SETC  '&AREA(1)'(2,&CNT-2)                                000B 04746014
.OUT7    ST    &REG,12(0,1)                      STORE AREA ADDR   000B 04752014
.XAREA   AIF   ('&AREA' EQ '' OR N'&AREA EQ 1 OR &A3 OR &A6).XAREA2 00B 04758014
         AIF   (&A5).AREARG2                                       000B 04764014
         LA    14,&AREA(2)                                         000B 04770014
         ST    14,44(0,1)                        STORE WAREA ADDR  000B 04776014
         AGO   .XAREA2                                             000B 04782014
.AREARG2 ANOP                                                      000B 04788014
&CNT     SETA  K'&AREA(2)                                          000B 04794014
&REG     SETC  '&AREA(2)'(2,&CNT-2)                                000B 04800014
.OUT8    ST    &REG,44(0,1)                      STORE WAREA ADDR  000B 04806014
.XAREA2  AIF   ('&KEYADR' EQ '' OR &S1).XKEY                       000B 04812014
         AIF   ('&KEYADR'(1,1) EQ '(').KEYRG                            04840000
         LA    14,&KEYADR                                               04860000
         ST    14,20(0,1)                        STORE TERM. LIST ADDR. 04880000
         AGO   .XKEY                                                    04900000
.KEYRG   ST    &KEYADR(1),20(0,1)                STORE TERM. LIST ADDR. 04920000
.XKEY    AIF   ('&RCDREF' EQ '').CONTA                                  04940000
         AIF   ('&RCDREF'(1,1) NE '(').NOREGB                           04960000
         STH   &RCDREF(1),24(0,1)                STORE LINE NUMBER      04980000
         AGO   .CONTA                                                   05000000
.NOREGB  AIF   (NOT &TYPRR).LARGER                                      05020000
         AIF   (&RCDREF GT 4095).LARGER                                 05040000
         LA    14,&RCDREF.(0,0)                                         05060000
         STH   14,24(0,1)                        STORE LINE NUMBER      05080000
         AGO   .CONTA                                                   05100000
.LARGER  B     *+6                                                      05120000
         DC    AL2(&RCDREF)                                             05140000
         MVC   24(2,1),*-2                       MOVE IN LINE NUMBER    05160000
         AGO   .CONTA                                                   05180000
.E1      IHBERMAC 35,,&MF                                               05200000
         MEXIT                                                          05220000
.E8      IHBERMAC 14                                                    05240000
         MEXIT                                                          05260000
.E9      IHBERMAC 6                                                     05280014
         MEXIT                                                          05300000
.E10     IHBERMAC 13                                                    05320000
         MEXIT                                                          05340000
.E11     IHBERMAC 32                                                    05360000
         MEXIT                                                          05380000
.E12     IHBERMAC 33                                                    05400000
.END     MEND                                                           05420000
