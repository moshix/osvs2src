* %GOTO IKJEXECPLS;                       /*                            00002003
         MACRO                                                          00006003
&NAME    IKJEXEC &LV=,&A=    MACRO FOR ISSUING OWN GETMAIN              00008003
         GBLA  &IKJEXA                                                  00010003
         AIF   ('&SYSECT.' NE 'IKJCT433').IKJT436 TEST ID 433/436       00014003
         AIF   (&IKJEXA NE 0).T3FMAN    TEST IF FIRST CALL              00018003
&IKJEXA SETA 1                                                          00020003
&NAME    LA    @00,4092      GET 4092 TO ADD TO COMPILERS SIZE          00022003
         AL    @00,@SIZDATD  ADD COMPILERS SIZE AND SUBPOOL             00026003
         GETMAIN R,LV=(0)    GETMAIN                                    00030003
         LR    @08,@01       GET ADDRESSABLILITY TO COMMON AREA         00032003
         LA    @01,4092(0,@01) ADD 4092 AND GIVE NORMAL AREA TO COMPLR  00034003
         MEXIT                                                          00037003
.T3FMAN  ANOP                                                           00040003
&NAME    LA    @00,4092      GET 4092 CONSTANT TO ADD TO SIZDATD        00043003
         AL    @00,@SIZDATD  GET SUBPOOL AND NORMAL SIZE                00046003
         FREEMAIN R,LV=(0),A=(8)                                        00050003
         MEXIT                                                          00053003
.IKJT436 ANOP                                                           00057003
         AIF   (&IKJEXA NE 0).T6FMAN   TEST IF FIRST CALL               00059003
&IKJEXA SETA 1                                                          00061003
&NAME    LA    @01,300(0,@08) USE AREA GOTTEN IN 433 (SKIP COMMON)      00064003
         MEXIT                                                          00067003
.T6FMAN  ANOP                                                           00070003
&NAME    NOPR  @00                                                      00073003
         MEND                                                           00076003
*  */                                                                   00080003
 %IKJEXECPLS: ;                                                         00083003
                                                                        00087003
 @EJECT;                                                                00089003
 /********************************************************************/ 00091003
 /*                                                                  */ 00094003
 /* *** IKJEXEC ***      LEVEL=11/05/75     OS/VS2 RELEASE 3.0       */ 00097000
 /*                                                                  */ 00100003
 /* DESCRIPTION - PLS MAPPING MACRO FOR CONTROL BLOCKS USED BY THE   */ 00103003
 /*               TSO EXEC COMMAND PROCESSOR                         */ 00106003
 /*                                                                  */ 00110003
 /* FUNCTION    - CONTAINS CONTROL BLOCK MAPPINGS FOR THE FOLLOWING  */ 00113003
 /*               DATA AREAS USED BY THE TSO EXEC COMMAND            */ 00117003
 /*                 - PHASE 1 EXEC COMMAND COMMON DATA AREA          */ 00119003
 /*                 - EXECDATA CONTROL BLOCK                         */ 00121003
 /*                 - COMMAND PROCEDURE STORAGE BLOCK                */ 00124003
 /*                 - SYMBOLIC NAME TABLE (SNTAB)                    */ 00127003
 /*                 - SYMBOLIC VALUE TABLE (SVTAB)                   */ 00130003
 /*                 - SNTAB CONTROL SYMBOLIC PARAMETER AREA          */ 00133003
 /*                 - PHASE2 COMMON DECLARES                         */ 00136003
 /*                                                                  */ 00140003
 %GOTO PROEND;                                                          00143003
 /* METHOD OF ACCESS                                                 */ 00147003
 /*             - PHASE 1 EXEC COMMAND DATA AREA                     */ 00149003
 /*                 %IKJECDA='' TO INCLUDE MAP                       */ 00151003
 /*                 %ECDABASE='ANY BASE'  - - - DEFAULT IS           */ 00154003
 /*                                            BASED(ECDAPTR)        */ 00157003
 /*             - EXECDATA CONTROL BLOCK                             */ 00161003
 /*                 %IKJEDAT='' TO INCLUDE MAP                       */ 00164003
 /*                 %EDATBASE='ANY BASE' - - DEFAULT IS              */ 00167003
 /*                                         BASED(LSDEXEC)           */ 00170003
 /*             - COMMAND PROCEDURE STORAGE BLOCK                    */ 00173003
 /*                 %IKJCOMP='' TO INCLUDE MAP                       */ 00176003
 /*                 %COMPBASE='ANY BASE' - - DEFAULT IS              */ 00180003
 /*                                         BASED(ECDACBLK)          */ 00183003
 /*             - SYMBOLIC NAME TABLE AND ELEMENT                    */ 00186003
 /*                 %IKJNTAB='' TO INCLUDE MAP                       */ 00188003
 /*               SNTAB TABLE IS BASED ON SNTABPTR (INCLUDED)        */ 00192003
 /*               SNTAB ELEMENT IS BASED ON SNTELPTR (INCLUDED UNLESS*/ 00194003
 /*                 %IKJSNTELPTR='NO' NOT TO INCLUDE SNTELPTR        */ 00197003
 /*                                                                  */ 00200003
 /*             - SYMBOLIC VALUE TABLE AND ELEMENT                   */ 00203003
 /*                 %IKJVTAB='' TO INCLUDE MAP                       */ 00207003
 /*               SVTAB TABLE IS BASED ON SVTABPTR (INCLUDED)        */ 00209003
 /*                 %SVELBASE='ANY BASE' - USE TO SET SVTAB ELEMENT  */ 00211003
 /*                                       BASE. THE DEFAULT IS       */ 00214003
 /*                                       BASED(SNTVLPTR)            */ 00218003
 /*             - SNTAB CONTROL SYMBOLIC PARAMETER AREA              */ 00222003
 /*                 %IKJCVMAP='' TO INCLUDE MAP                      */ 00225003
 /*                 %CVARBASE='ANY BASE' - - DEFAULT IS              */ 00228003
 /*                                         BASED(SNTELFST)          */ 00231003
 /*             - PHASE2 COMMON DECLARES                             */ 00234003
 /*                 NORMALLY NOT INCLUDED. TO INCLUDE                */ 00237003
 /*                 SET %IKJEXECPHASE2='YES'                         */ 00240003
 /*                                                                  */ 00243003
 /*                                                                  */ 00246003
 /*           %INCLUDE SYSLIB(IKJEXEC)                               */ 00248003
 /*                                                                  */ 00252003
 /* NOTES        - IF AN INDIVIDUAL DATA AREA MAP IS NOT REQUIRED    */ 00254003
 /*                THEN SET THE APPROPRIATE MACRO VARIABLE TO A      */ 00257003
 /*                NON NULL STATE                                    */ 00260003
 /*                                                                  */ 00263003
 /* CHANGE ACTIVITY =                                                */ 00264000
 /* ADD NOLASTCC BIT IN EXECDATA CONTROL BLOCK               @ZA03879*/ 00265000
 /* A 020450                                                @OZ32353 */ 00266000
 /*                                                                  */ 00267003
 %PROEND: ;                                                             00269003
 /********************************************************************/ 00271003
 @EJECT;                                                                00274003
    %NPAGE='@EJECT';                                                    00277003
    %IF IKJECDA^='' %THEN                                               00280003
      %GOTO EDATCHK;                                                    00283003
    %IF ECDABASE^='' %THEN                                              00286003
      %GOTO ECDA1;                                                      00290003
    %ECDABASE='BASED(ECDAPTR)';                                         00294003
    DCL                                                                 00296003
      ECDAPTR PTR(31);              /* PHASE 1 COMMON DATA ADDRESS   */ 00298003
 %ECDA1:                                                                00302003
    ;                                                                   00306003
                                                                        00308003
    /*****************************************************************/ 00310003
    /*                                                               */ 00314003
    /* PHASE 1 EXEC COMMON DATA AREA                                 */ 00317003
    /*                                                               */ 00320003
    /*****************************************************************/ 00323003
                                                                        00326003
    DCL                                                                 00330003
      1 ECDA ECDABASE,                                                  00332003
       2 ECDACPPL PTR(31),          /* CPPL ADDRESS                  */ 00336003
       2 ECDAGADD PTR(31),          /* ADDRESS OF FIRST SP78 CORE    */ 00338003
       2 ECDAEANS PTR(31),          /* PARSE PDL ADDRESS FOR EXPLICIT   00340003
                                       EXEC                          */ 00343003
       2 ECDALSD PTR(31),           /* LSD FOR THE COMMAND PROCEDURE    00346003
                                       BEING BUILT                   */ 00350003
       2 ECDAIREC PTR(31),          /* CURRENT INPUT RECORD ADDR     */ 00353003
       2 ECDACBLK PTR(31),          /* CURRENT COMMAND PROCEDURE        00357003
                                       BLOCK ADDRESS                 */ 00359003
       2 ECDACPRE PTR(31),          /* LAST COMMAND PROCEDURE RECORD    00361003
                                       ADDRESS                       */ 00364003
       2 ECDACNXT PTR(31),          /* NEXT COMMAND PROCEDURE RECORD    00367003
                                       ADDRESS                       */ 00370003
       2 ECDASPTR PTR(31),          /* ADDRESS OF IOPL PREPARED BY      00373003
                                       IKJCT430 FOR GETALINE RTN     */ 00376003
       2 ECDALCTR FIXED(31),        /* NUMBER OF COMMAND RECORDS READ   00380003
                                       FROM INPUT DATA SET           */ 00383003
       2 ECDALNEL PTR(31),          /* ADDRESS OF LAST SNTAB ELMT    */ 00386003
       2 ECDAGCNT FIXED(31),        /* GLOBAL COUNT AREA             */ 00389003
       2 ECDANDO FIXED(15),         /* OPEN DO COUNT                 */ 00392003
       2 ECDAELNG FIXED(15),        /* ALTERNATE END LENGTH          */ 00395003
       2 ECDAAEND CHAR(4),          /* ALTERNATE END                 */ 00398003
       2 ECDAFLAG CHAR(2),          /* PHASE 1 FLAG AREA             */ 00401003
        3 IMPLICIT BIT(1),          /* ON IF IMPLICIT EXEC           */ 00404003
        3 NOTEXEC BIT(1),           /* ON IF PROCEDURE CAN NOT BE       00407003
                                       EXECUTED DUE TO ERRORS        */ 00410003
        3 SP78CORE BIT(1),          /* ON WHEN SUBPOOL 78 CORE HAS      00413003
                                       BEEN GOTTEN                   */ 00416003
        3 * BIT(1),                                                     00419003
        3 * BIT(1),                                                     00422003
        3 SP78BLK BIT(1),           /* ON IF CORE HAS BEEN GOTTEN FOR   00425003
                                       THE EXEC TABLES BUT NOT CARVED   00428003
                                       UP                            */ 00431003
        3 NESTED BIT(1),            /* ON IF THIS IS A NESTED EXEC   */ 00434003
       2 * CHAR(2),                                                     00437003
       2 ECDAGETL PTR(31),          /* ADDRESS OF IKJGETL            */ 00440003
       2 ECDAGDAT PTR(31),          /* ADDRESS OF GLOBAL EXECDATA    */ 00443003
       2 ECDACPGM PTR(31),          /* SIZE OF CMD PROC GETMAIN      */ 00446003
       2 ECDAINME PTR(31),         /* ADDR OF IMPLICIT NAME          */ 00449003
        3 ECDAILNG PTR(8);         /* LENGTH OF IMPLICIT NAME        */ 00452003
    DCL                                                                 00455003
      CPPLPTR PTR(31) DEF(ECDACPPL);/* ADDRESS OF CPPL               */ 00458003
 NPAGE;                                                                 00461003
 %EDATCHK:                                                              00464003
    IF IKJEDAT^=''                                                      00467003
        %THEN                                                           00470003
      %GOTO COMPCHK;                                                    00473003
                                                                        00476003
    DCL                                                                 00480003
    /*****************************************************************/ 00482003
    /*                                                               */ 00486003
    /* EXECDATA CONTROL BLOCK                                        */ 00488003
    /*                                                               */ 00490003
    /*****************************************************************/ 00493003
                                                                        00496003
    %IF EDATBASE='' %THEN                                               00499003
      %EDATBASE='BASED(LSDEXEC)';                                       00502003
      1 EXECDATA EDATBASE,                                              00505003
       2 SNTABFST PTR(31),          /* ADDRESS OF FIRST SNTAB        */ 00510003
       2 SVTABFST PTR(31),          /* ADDRESS OF THE FIRST SVTAB    */ 00512003
       2 GEXECDAT PTR(31),          /* ADDRESS OF THE GLOBAL EXECDATA*/ 00514003
       2 LASTTSO PTR(31),           /* ADDRESS OF LAST TSO COMMAND      00518003
                                       EXECUTED                      */ 00522003
       2 * PTR(31),                 /*                               */ 00524003
        3 EXINSAVE BIT(8) BDY(BYTE),/* TERMIN INSTACK SAVE AREA      */ 00526003
       2 ERACTSTR PTR(31),          /* ADDRESS OF THE START OF THE      00530003
                                       ERROR ACTION FOR THIS CLIST -    00534003
                                       THIS FIELD IS ZERO WHEN THERE    00536003
                                       IS NO ERROR ACTION            */ 00540003
       2 ERACTEND PTR(31),          /* END OF THE ERROR ACTION RANGE */ 00542003
       2 RETPTR PTR(31),            /* ADDRESS OF THE COMMAND           00544003
                                       FOLLOWING THE ONE IN ERROR    */ 00547003
       2 EXDATFLG CHAR(4),          /* EXEC DATA FLAG AREA           */ 00550003
        3 * BIT(32),                                                    00553003
         4 CONLST BIT(1),           /* ON IF CONTROL STATEMENTS ARE     00556003
                                       TO BE LISTED AS THEY ARE         00560003
                                       EXECUTED                      */ 00563003
         4 ERRCMD BIT(1),           /* ON IF AN ERROR COMMAND IS IN     00566003
                                       EFFECT                        */ 00570003
         4 NOFLUSH BIT(1),          /* ON IF NOFLUSH OPTION IN EFFECT*/ 00572003
         4 SYMLST BIT(1),           /* ON IF SYMLIST OPTION IN EFFECT*/ 00576003
         4 ERINCNTL BIT(1),         /* ON WHEN THE PROCESSING IN AN     00578003
                                       ERROR RANGE IS A DIRECT RESULT   00580003
                                       OF A CLIST STMT ERROR         */ 00583003
         4 CMAIN BIT(1),            /* ON FOR CONTROL CLIST (MAIN)   */ 00586003
         4 NOMSG BIT(1),            /* ON FOR NOMSG OPTION           */ 00590003
         4 ATTNCMD BIT(1),          /* ON IF ATTENTION CMD IN EFFECT */ 00593003
         4 ATINCNTL BIT(1),         /* IN ATTN ON BEHALF OF ATTN     */ 00596003
      4 NOLASTCC BIT(1), /* SKIP LASTCC UPDATE AFTER STMT    @ZA03879*/ 00598000
       2 GEXECCNT FIXED(31),        /* NUMBER OF GLOBAL VARIABLES       00600003
                                       SUPPORTED FOR NESTED             00601003
                                       PROCEDURES                    */ 00604003
       2 EXDLMPTR PTR(31),          /* ADDRESS OF TERMIN DELIMS      */ 00607003
       2 ATACTSTR PTR(31),          /* ATTENTION ACTION START        */ 00611003
       2 ATACTEND PTR(31),          /* ATTENTION ACTION END          */ 00614003
       2 RETPTR2  PTR(31),          /* ALTERNATE RETURN POINTER     */  00617003
       2 FILEDCBS PTR(31),          /* ADDRESS OF FILE I/O DCB CHAIN*/  00621003
       2 * PTR(31);                                                     00623003
 NPAGE;                                                                 00627003
 %COMPCHK:                                                              00629003
    IF IKJCOMP^=''                                                      00632003
        %THEN                                                           00635003
      %GOTO NTABCHK;                                                    00638003
                                                                        00641003
    DCL                                                                 00644003
    /*****************************************************************/ 00647003
    /*                                                               */ 00650003
    /* MAPPING OF THE COMMAND PROCEDURE STORAGE BLOCK BUILT BY EXEC  */ 00653003
    /*                                                               */ 00656003
    /*****************************************************************/ 00659003
                                                                        00662003
    %IF COMPBASE='' %THEN                                               00665003
      %COMPBASE='BASED(ECDACBLK)';                                      00668003
      1 COMPROC COMPBASE,                                               00671003
       2 COMPRPTR PTR(31),          /* ADDRESS OF NEXT COMMAND          00674003
                                       PROCEDURE BLOCK               */ 00677003
        4 COMPRID PTR(8),           /* BLOCK NUMBER FOR THIS COMMAND    00681003
                                       PROCEDURE BLOCK               */ 00684003
        4 COMPRNXT PTR(24),         /* ADDRESS OF THE NEXT COMMAND      00687003
                                       PROCEDURE STORAGE BLOCK - THIS   00690003
                                       FIELD IS ZERO IF THIS IS THE     00693003
                                       LAST BLOCK                    */ 00695003
       2 COMPRLNG FIXED(31),        /* LENGTH OF THIS BLOCK          */ 00697003
       2 COMPRUSE FIXED(31),        /* NUMBER OF UNUSED BYTES IN THIS   00701003
                                       BLOCK                         */ 00705003
       2 COMRCDS CHAR(*);           /* COMMAND PROCEDURE RECORD AREA    00707003
                                                                     */ 00709003
 NPAGE;                                                                 00712003
 %NTABCHK:                                                              00715003
    IF IKJNTAB^=''                                                      00718003
        %THEN                                                           00721003
      %GOTO VTABCHK;                                                    00724003
    DCL                                                                 00727003
      SNTABPTR PTR(31);             /* CURRENT SNTAB ADDRESS         */ 00730003
                                                                        00733003
      /***************************************************************/ 00736003
      /*                                                             */ 00739003
      /* SYMBOLIC NAME TABLE                                         */ 00742003
      /*                                                             */ 00745003
      /***************************************************************/ 00748003
    DCL                                                                 00751003
      1 SNTAB BASED(SNTABPTR),      /* SNTAB TABLE HEADER            */ 00754003
       2 SNTABNXT PTR(31),          /* ADDRESS OF NEXT SNTAB         */ 00757003
       2 SNTABLNG FIXED(31),        /* LENGTH OF THIS SNTAB          */ 00760003
       2 SNTABUSE FIXED(31),        /* NUMBER OF BYTES IN THIS SNTAB    00763003
                                       THAT ARE IN USE               */ 00766003
       2 SNTELFST CHAR(*);          /* FIRST SNTAB ELEMENT           */ 00770003
                                                                        00773003
                                                                        00776003
                                                                        00779003
 %IF  IKJSNTELPTR='NO' %THEN                                            00782003
   %GOTO  NOSNTELPTR;                                                   00785003
    DCL                                                                 00788003
      SNTELPTR PTR(31);             /* CURRENT SNTAB ELEMENT ADDRESS */ 00791003
 %NOSNTELPTR: ;                                                         00794003
    /*****************************************************************/ 00797003
    /*                                                               */ 00800003
    /* SYMBOLIC NAME TABLE ELEMENT                                   */ 00803003
    /*                                                               */ 00806003
    /*****************************************************************/ 00810003
    DCL                                                                 00812003
      1 SNTELEM BASED(SNTELPTR),    /* SNTAB ELEMENT                 */ 00816003
       2 SNTVLPTR PTR(31),          /* ADDRESS OF THE SVTAB ELEMENT     00818003
                                       FOR THIS SYMBOLIC PARAMETER OR*/ 00820003
        3 SNTGVAL FIXED(31),        /* THE GLOBAL VARIABLE NAME IF      00825003
                                       PARAMETER IS GLOBAL           */ 00828003
       2 SNTFLAGS CHAR(2),          /* SNTAB ELEMENT FLAGS - DEFINES    00831003
                                       THE TYPE OF PARM              */ 00833003
        3 SNTPOSIT BIT(1),          /* POSITIONAL ELEMENT            */ 00837003
        3 SNTKEY BIT(1),            /* KEYWORD ELEMENT               */ 00839003
        3 SNTKEYW BIT(1),           /* KEYWORD WITH VALUE ELEMENT    */ 00842003
        3 SNTLABEL BIT(1),          /* LABEL ELEMENT                 */ 00845003
        3 SNTNOSCN BIT(1),          /* VARIABLE NOT RESCANNABLE      */ 00848003
        3 SNTNAUTH BIT(1),          /* CONTROL VARIABLE CAN NOT BE      00851003
                                       SET BY THE USER               */ 00854003
        3 SNTEVAL BIT(1),           /* CONTROL VARIABLE REQUIRES        00857003
                                       IMMEDIATE EVALUATION          */ 00860003
        3 SNTLAST BIT(1),           /* DEFINES THE LAST ELEMENT IN      00863003
                                       THIS SNTAB                    */ 00866003
        3 SNTGLOB BIT(1),           /* VARIABLE IS A GLOBAL VAR      */ 00869003
        3 * BIT(7),                 /* RESERVED                      */ 00872003
       2 SNTLNG FIXED(15),          /* LENGTH OF THE SYMBOLIC           00875003
                                       PARAMETER NAME                */ 00878003
       2 SNTDATA CHAR(*);           /* NAME OF THE SYMBOLIC PARAMETER   00881003
                                                                     */ 00884003
 NPAGE;                                                                 00887003
 %VTABCHK:                                                              00891003
    IF IKJVTAB^=''                                                      00893003
        %THEN                                                           00897003
      %GOTO CVARCHK;                                                    00899003
    DCL                                                                 00903003
      SVTABPTR PTR(31);             /* CURRENT SVTAB ADDRESS         */ 00905003
                                                                        00907003
    /*****************************************************************/ 00910003
    /*                                                               */ 00913003
    /* SYMBOLIC VALUE TABLE                                          */ 00916003
    /*                                                               */ 00919003
    /*****************************************************************/ 00922003
                                                                        00925003
    DCL                                                                 00928003
      1 SVTAB BASED(SVTABPTR),      /* SVTAB TABLE HEADER            */ 00931003
       2 SVTABNXT PTR(31),          /* ADDRESS OF NEXT SVTAB         */ 00934003
       2 SVTABLNG FIXED(31),        /* LENGTH OF THIS SVTAB          */ 00937003
       2 SVTABUSE FIXED(31),        /* NUMBER OF BYTES IN THIS SVTAB    00941003
                                       THAT ARE IN USE               */ 00944003
       2 SVTABFRE FIXED(31),        /* NUMBER OF BYTES IN THIS SVTAB    00947003
                                       THAT ARE ASSIGNED (IN USE) BUT   00951003
                                       UNUSED                        */ 00953003
       2 SVTELFST CHAR(*);          /* FIRST SYMBOLIC VALUE ELEMENT  */ 00957003
                                                                        00959003
    /*****************************************************************/ 00961003
    /*                                                               */ 00964003
    /* SYMBOLIC VALUE TABLE ELEMENT                                  */ 00967003
    /*                                                               */ 00971003
    /*****************************************************************/ 00974003
                                                                        00977003
    %IF SVELBASE='' %THEN                                               00981003
      %SVELBASE='BASED(SNTVLPTR)';                                      00983003
    DCL                                                                 00987003
      1 SVTELEM SVELBASE,           /* SVTAB ELEMENT                 */ 00989003
       2 SVTLNG FIXED(15),          /* LENGTH OF THE SYMBOLIC           00991003
                                       PARMETER VALUE                */ 00994003
       2 SVTORIG FIXED(15),         /* ORIGIONAL LENGTH OF THIS         00997003
                                       ELEMENT                       */ 01001003
       2 SVTDATA CHAR(*);           /* VALUE OF THE SYMBOLIC            01004003
                                       PARAMETER                        01007003
                                                                     */ 01011003
 NPAGE;                                                                 01013003
 %CVARCHK:                                                              01017003
    IF IKJCVMAP^=''                                                     01019003
        %THEN                                                           01021003
      %GOTO EXECPHASE2CK;                                               01024003
                                                                        01027003
    DCL                                                                 01031003
    /*****************************************************************/ 01034003
    /*                                                               */ 01037003
    /* MAP OF EXEC COMMAND CONTROL VARIABLES IN THE FIRST SNTAB FIXED*/ 01041003
    /* AREA. CORRECT PROCESSING IS DEPENDENT UPON THE POSITIONS OF   */ 01041200
    /* THE VARIABLES IN THIS STRUCTURE. THE ORDER OF VARIABLES IN    */ 01041900
    /* THIS STRUCTURE MUST AGREE WITH THE NULLVARX TABLE. NOTE THAT  */ 01042600
    /* THE FIRST 10 VARIABLES ARE INITIALIZED AS REQUIRING IMMEDIATE */ 01043300
    /* EVALUATION (IN IKJCT433) AND THE FIRST 15 ARE INITIALIZED AS  */ 01044000
    /* BEING NOT AUTHORIZED (THAT IS, A USER MAY NOT SET THEM).      */ 01044700
    /*                                                               */ 01047003
    /*****************************************************************/ 01049003
                                                                        01051003
    %IF CVARBASE='' %THEN                                               01054003
      %CVARBASE='DEF(SNTELFST)';                                        01057003
      1 CVARMAP CVARBASE BDY(BYTE),                                     01061003
       2 CTIMEVAL PTR(31) BDY(BYTE),/* SYSTIME VALUE IS NULL         */ 01064003
       2 CTIMEFLG CHAR(2),          /* FLAG AREA                     */ 01067003
       2 CTIMELNG FIXED(15) BDY(BYTE),/* LENGTH IS 7                 */ 01071003
       2 SYSTIME CHAR(7),           /* NAME AREA                     */ 01073003
       2 CPCMDVAL PTR(31) BDY(BYTE),/* SYSPCMD VALUE IS NULL */         01077003
       2 CPCMDFLG CHAR(2),          /* FLAG AREA                     */ 01079003
       2 CPCMDLNG FIXED(15) BDY(BYTE),/* LENGTH                      */ 01081003
       2 SYSPCMD CHAR(7),           /* NAME AREA                     */ 01084003
       2 CSCMDVAL PTR(31) BDY(BYTE),/* SYSSCMD VALUE IS NULL         */ 01087003
       2 CSCMDFLG CHAR(2),          /* FLAG AREA                     */ 01091003
       2 CSCMDLNG FIXED(15) BDY(BYTE),/* LENGTH                      */ 01094003
       2 SYSSCMD CHAR(7),           /* NAME AREA                     */ 01097003
       2 CDATEVAL PTR(31) BDY(BYTE),/* SYSDATE VALUE IS NULL         */ 01101003
       2 CDATEFLG CHAR(2),          /* FLAG AREA                     */ 01103003
       2 CDATELNG FIXED(15) BDY(BYTE),/* LENGTH IS 7                 */ 01107003
       2 SYSDATE CHAR(7),           /* SYSDATE NAME AREA             */ 01109003
       2 CPREFVAL PTR(31) BDY(BYTE),/* SYSPREF VALUE IS NULL         */ 01111003
       2 CPREFLG CHAR(2),           /* FLAG AREA                     */ 01114003
       2 CPREFLNG FIXED(15) BDY(BYTE),/* LENGTH IS 7                 */ 01117003
       2 SYSPREF CHAR(7),           /* SYSPREF NAME AREA             */ 01121003
       2 CLENVAL PTR(31) BDY(BYTE), /* LENGTH VALUE IS NULL          */ 01124003
       2 CLENFLG CHAR(2),           /* FLAG AREA                     */ 01127003
       2 CLENLNG FIXED(15) BDY(BYTE),/* LENGTH IS 6                  */ 01131003
       2 CLENGTH CHAR(6),           /* LENGTH NAME AREA              */ 01133003
       2 CTYPEVAL PTR(31) BDY(BYTE),/* DATATYPE VALUE IS NULL        */ 01137003
       2 CTYPEFLG CHAR(2),          /* FLAG AREA                     */ 01139003
       2 CTYPELNG FIXED(15) BDY(BYTE),/* LENGTH IS 8                 */ 01141003
       2 DATATYPE CHAR(8),          /* DATATYPE NAME AREA            */ 01144003
       2 CSTRVAL PTR(31) BDY(BYTE), /* STR VALUE IS NULL             */ 01147003
       2 CSTRFLG CHAR(2),           /* FLAG AREA                     */ 01151003
       2 CSTRLNG FIXED(15) BDY(BYTE),/* LENGTH IS 3                  */ 01154003
       2 STRING CHAR(3),            /* STRING NAME AREA              */ 01157003
       2 CSSTRVAL PTR(31) BDY(BYTE),/* SUBSTRING VALUE IS NULL       */ 01161003
       2 CSSTRFLG CHAR(2),          /* FLAG AREA                     */ 01163003
       2 CSSTRLNG FIXED(15) BDY(BYTE),/* LENGTH IS 6                 */ 01167003
       2 SUBSTR CHAR(6),            /* SUBSTRING NAME AREA           */ 01169003
       2 CEVALVAL PTR(31) BDY(BYTE),/* EVAL BUILT IN IS NULL         */ 01171003
       2 CEVALFLG CHAR(2),          /* IMMEDIATE EVALUATION          */ 01174003
       2 CEVALLNG FIXED(15) BDY(BYTE),/* LENGTH IS 4                 */ 01177003
       2 EVAL CHAR(4),              /* EVAL NAME AREA                */ 01181003
       2 CICMDVAL PTR(31) BDY(BYTE),/* ADDRESS OF VALUE              */ 01184003
       2 CICMDFLG CHAR(2),         /* FLAG AREA                      */ 01187003
       2 CICMDLNG FIXED(15) BDY(BYTE),/* LENGTH OF NAME IS 7         */ 01191003
       2 SYSICMD CHAR(7),          /* NAME AREA                      */ 01193003
  NPAGE;                                                                01197003
       2 CDLMVAL PTR(31) BDY(BYTE), /* SYSDLM VALUE IS ZERO          */ 01199003
       2 CDLMFLG CHAR(2),           /* FLAG AREA                     */ 01201003
       2 CDLMLNG FIXED(15) BDY(BYTE),/* LENGTH IS 6                  */ 01204003
       2 SYSDLM CHAR(6),             /* SYSDLM VALUE AREA            */ 01207003
       2 CUIDVAL PTR(31) BDY(BYTE), /* SYSUID VALUE TAKEN FROM PSCB  */ 01211003
       2 CUIDFLG CHAR(2),           /* FLAG AREA                     */ 01214003
       2 CUIDLNG FIXED(15) BDY(BYTE),/* LENGTH IS 6                  */ 01217003
       2 SYSUID CHAR(6),            /* SYSUID NAME AREA              */ 01221003
       2 CPROCVAL PTR(31) BDY(BYTE),/* SYSPROC VALUE TAKEN FROM TCB  */ 01223003
       2 CPROCFLG CHAR(2),          /* FLAG AREA                     */ 01227003
       2 CPROCLNG FIXED(15) BDY(BYTE),/* LENGTH IS 7                 */ 01229003
       2 SYSPROC CHAR(7),           /* SYSPROC NAME AREA             */ 01231003
       2 CNESTVAL PTR(31) BDY(BYTE),/* SYSNEST VALUE IS YES OR NO    */ 01234003
       2 CNESTFLG CHAR(2),          /* FLAG AREA                     */ 01237003
       2 CNESTLNG FIXED(15) BDY(BYTE),/* LENGTH IS 7                 */ 01241003
       2 SYSNEST CHAR(7),           /* SYSNEST NAME AREA             */ 01244003
       2 CDVALVAL PTR(31) BDY(BYTE),/* SYSDVAL VALUE IS NULL         */ 01247003
       2 CDVALFLG CHAR(2),          /* FLAG AREA                     */ 01251003
       2 CDVALLNG FIXED(15) BDY(BYTE),/* LENGTH IS 7                 */ 01253003
       2 SYSDVAL CHAR(7),          /* SYSDVAL NAME AREA              */ 01257003
       2 CLCCVAL PTR(31) BDY(BYTE), /* LASTCC VALUE IS ZERO          */ 01259003
       2 CLCCFLG CHAR(2),           /* FLAG AREA                     */ 01261003
       2 CLCCLNG FIXED(15) BDY(BYTE),/* LENGTH IS 6                  */ 01264003
       2 LASTCC CHAR(6),            /* LASTCC NAME AREA              */ 01267003
       2 CMCCVAL PTR(31) BDY(BYTE), /* MAXCC VALUE IS ZERO           */ 01271003
       2 CMCCFLG CHAR(2),           /* FLAG AREA                     */ 01274003
       2 CMCCLNG FIXED(15) BDY(BYTE),/* LENGTH IS 5                  */ 01277003
       2 MAXCC CHAR(5),             /* MAXCC NAME AREA               */ 01281003
       2 CSCANVAL PTR(31) BDY(BYTE),/* SYSSCAN VALUE IS 16           */ 01283003
       2 CSCANFLG CHAR(2),          /* FLAG AREA                     */ 01287003
       2 CSCANLNG FIXED(15) BDY(BYTE),/* LENGTH OF 7                 */ 01289003
       2 SYSSCAN CHAR(7);           /* SYSSCAN NAME AREA                01291003
                                                                     */ 01294003
 NPAGE;                                                                 01297003
 %EXECPHASE2CK:                                                         01301003
  IF IKJEXECPHASE2^='YES' %THEN                                         01304003
   %GOTO MACEND;                                                        01307003
                                                                        01311003
    DCL                                                                 01313003
                                                                        01317003
      /***************************************************************/ 01319003
      /*                                                             */ 01321003
      /* CONSTANTS USED BY THIS PROGRAM                              */ 01324003
      /*                                                             */ 01327003
      /***************************************************************/ 01331003
                                                                        01334003
      ZEROS CHAR(16) CONSTANT('0000000000000000'),/* ZERO STRING   */   01337003
       BLANKS BIT(32)CONSTANT('40000000'X),/* PADD CHAR FOR MVCL     */ 01341003
       YES BIT(1)CONSTANT('1'B),    /* A BIT IS ON                   */ 01343003
       COLON CHAR(1)CONSTANT(':'),  /* THE TIME XX:XX:XX             */ 01347003
      OPENCMT CHAR(2) CONSTANT('/*'),/* OPEN COMMENT DELIMETER       */ 01349003
      CLOSCMT CHAR(2) CONSTANT('*/'),/* END OF COMMENT               */ 01351003
      XEQUAL CHAR(2) CONSTANT('X='),/* DUMMY ASSIGN STRING           */ 01354003
      EQUAL CHAR(1) CONSTANT('='),  /* EQUAL SIGN                    */ 01357003
      NULVAL FIXED(31) CONSTANT(0), /* NULL ELEMENT VALUE            */ 01361003
      SLASH CHAR(1) CONSTANT('/'),  /* DATE DELIM XX/XX/XX           */ 01364003
      NO BIT(1) CONSTANT('0'B),     /* A BIT IS OFF                  */ 01367003
      MAXCC CHAR(LENGTH('MAXCC')) CONSTANT('MAXCC'),/* ARG FOR MAXCC */ 01371003
      LASTCC CHAR(LENGTH('LASTCC')) CONSTANT('LASTCC'),/* ARG LASTCC */ 01373003
      SYSSCAN CHAR(LENGTH('SYSSCAN')) CONSTANT('SYSSCAN'),/* SCAN ARG*/ 01377003
      SYSDVAL CHAR(LENGTH('SYSDVAL')) CONSTANT('SYSDVAL'),/* DLM VAL */ 01379003
      WRITE   FIXED(31)CONSTANT(4), /* WRITE OP CODE                 */ 01381003
      IGOTO FIXED(31) CONSTANT(15), /* INTERNAL GOTO                 */ 01384003
      RELAT FIXED(31) CONSTANT(2),  /* RELATIONAL ENTRY TO IKJCT434  */ 01387003
      LPAREN CHAR(1) CONSTANT('('), /* OPEN PAREN                    */ 01391003
      RPAREN CHAR(1) CONSTANT(')'), /* CLOSE PAREN                   */ 01394003
      MINUS CHAR(1) CONSTANT('-'),  /* MINUS SIGN                    */ 01397003
      PERIOD CHAR(1) CONSTANT('.'), /* PERIOD                        */ 01401003
      AMPSAND CHAR(1) CONSTANT('&'),/* AMPERSAND                     */ 01403003
      DAMPSAND CHAR(2) CONSTANT('&&'),/* DOUBLE AMPERSAND            */ 01407003
      FDMPSAND BIT(16) CONSTANT('1010'X),/* FOLDED AMPERSANDS        */ 01409003
      QUOTE CHAR(1) CONSTANT(''''), /* QUOTE                         */ 01411003
      DQUOTE CHAR(2) CONSTANT(''''''),/* DOUBLE QUOTE                */ 01414003
      COMMA CHAR(1) CONSTANT(','),  /* A COMMA                       */ 01417003
      BLANK CHAR(1) CONSTANT(' '),  /* BLANK                         */ 01421003
      TAB BIT(8) CONSTANT('05'X),   /* TAB                           */ 01424003
      TERMDLM BIT(8) CONSTANT('88'X),/* TERMINAL DELIM OPTIONS       */ 01427003
      ABNDFLG BIT(8) CONSTANT('80'X),/* ABEND FLAG IN ECT            */ 01431003
      SENTNLL BIT(8) CONSTANT('01'X),/* LEFT SENTINAL                */ 01433003
      SENTNLR BIT(8) CONSTANT('02'X),/* RIGHT SENTINAL               */ 01435003
      NOSCNAMP BIT(8) CONSTANT('03'X),/* NO RESCAN FOLDED AMPERSAND  */ 01437003
      FEBRUARY FIXED(31) CONSTANT(2),/* MONTH OF FEBRUARY            */ 01439003
 NPAGE;                                                                 01441003
                                                                        01444003
      /***************************************************************/ 01447003
      /*                                                             */ 01451003
      /* MORE CONSTANTS USED BY THIS PROGRAM                         */ 01454003
      /*                                                             */ 01457003
      /***************************************************************/ 01461003
                                                                        01463003
     CCA CHAR(1) CONSTANT('A'),     /* CHAR 'A'                      */ 01467003
     CCF CHAR(1) CONSTANT('F'),     /* CHAR 'F'                      */ 01470003
     CCI CHAR(1) CONSTANT('I'),     /* CHAR 'I'                      */ 01473003
     CCJ CHAR(1) CONSTANT('J'),     /* CHAR 'J'                      */ 01475003
     CCR CHAR(1) CONSTANT('R'),     /* CHAR 'R'                      */ 01477003
     CCS CHAR(1) CONSTANT('S'),     /* CHAR 'S'                      */ 01481003
     CCU CHAR(1) CONSTANT('U'),     /* CHAR 'U'                      */ 01484003
     CCZ CHAR(1) CONSTANT('Z'),     /* CHAR 'Z'                      */ 01487003
     CC0 CHAR(1) CONSTANT('0'),     /* CHAR '0'                      */ 01491003
     CC9 CHAR(1) CONSTANT('9'),     /* CHAR '9'                      */ 01493003
      F0 FIXED(31) CONSTANT(0),     /* FULLWORD ZERO                 */ 01497003
      F1 FIXED(31) CONSTANT(1),     /* FULLWORD ONE                  */ 01499003
      F2 FIXED(31) CONSTANT(2),     /* FULLWORD TWO                  */ 01501003
      F3 FIXED(31) CONSTANT(3),     /* FULLWORD THREE                */ 01504003
      F4 FIXED(31) CONSTANT(4),     /* FULLWORD FOUR                 */ 01507003
      F5 FIXED(31) CONSTANT(5),     /* FULLWORD FIVE                 */ 01511003
      F6 FIXED(31) CONSTANT(6),     /* FULLWORD SIX                  */ 01514003
      F7 FIXED(31) CONSTANT(7),     /* FULLWORD SEVEN                */ 01517003
      F8 FIXED(31) CONSTANT(8),     /* FULLWORD EIGHT                */ 01521003
      F15 FIXED(31) CONSTANT(15),   /* FULLWORD FIFTEEN              */ 01523003
      F16 FIXED(31) CONSTANT(16),   /* FULLWORD 16                   */ 01527003
      F17 FIXED(31) CONSTANT(17),   /* FULLWORD 17                   */ 01529003
      F31 FIXED(31) CONSTANT(31),   /* FULLWORD 31                   */ 01531003
      F57 FIXED(31) CONSTANT(57),   /* FULLWORD 57                   */ 01534003
      F239 FIXED(31) CONSTANT(239), /* FULLWORD 239                  */ 01537003
      F249 FIXED(31) CONSTANT(249), /* FULLWORD 249                  */ 01541003
      F252 FIXED(31) CONSTANT(252), /* FULLWORD 252                  */ 01544003
      F256 FIXED(31) CONSTANT(256), /* FULLWORD 256                  */ 01547003
      F4096 FIXED(31) CONSTANT(4096),/* FULLWORD 4096                */ 01551003
      CTHEN CHAR(4) CONSTANT('THEN'),/* CHAR 'THEN'                 */  01553003
      GAS FIXED(31) CONSTANT(200),  /* GAS FOR GETMAIN OF NEW BUF    */ 01557003
      IFCODE FIXED(31) CONSTANT(2), /* OP CODE OF 'IF'               */ 01559003
      DOCODE FIXED(31) CONSTANT(7), /* OP CODE OF 'DO'               */ 01561003
      READ   FIXED(31)CONSTANT(12), /* OP CODE OF 'READ'             */ 01564003
      SETCODE FIXED(31) CONSTANT(13),/* OP CODE OF 'SET'             */ 01567003
      NOOPTION BIT(16) CONSTANT('0000'X),/* NO CONTROL OPTIONS       */ 01571003
      OPENCODE FIXED(31) CONSTANT(18),/* OPENFILE OP CODE (LOW FILE) */ 01574003
      PUTCODE FIXED(31) CONSTANT(21),/* PUTFILE OP CODE (HIGH FILE)  */ 01577003
                                                                        01581003
 NPAGE;                                                                 01583003
                                                                        01587003
      /***************************************************************/ 01589003
      /*                                                             */ 01591003
      /* ERROR CODES                                                 */ 01594003
      /*                                                             */ 01597003
      /***************************************************************/ 01601003
                                                                        01604003
      E4 FIXED(31) CONSTANT(4),     /* USED TO GET A NEW LINE        */ 01607003
      E8 FIXED(31) CONSTANT(8),     /* ATTN HAS OCCURED              */ 01611003
      E16 FIXED(31) CONSTANT(16),   /* GETMAIN FAIL                  */ 01613003
      E300 FIXED(31) CONSTANT(300), /* UPDATE TO UNAUTH VAR          */ 01617003
      E304 FIXED(31) CONSTANT(304), /* INVALID KEYWORD ON EXIT       */ 01619003
      E308 FIXED(31) CONSTANT(308), /* NO VALUE ON CODE ON EXIT      */ 01621003
      E312 FIXED(31) CONSTANT(312), /* GLOBAL VARIABLE NOT FOUND     */ 01624003
      E316 FIXED(31) CONSTANT(316), /* DELIMETER GT THAN 256         */ 01627003
      E320 FIXED(31) CONSTANT(320), /* (RESERVED)                    */ 01631003
      E324 FIXED(31) CONSTANT(324), /* GETLINE ERROR                 */ 01634003
      E328 FIXED(31) CONSTANT(328), /* TOO MANY DELIMETERS           */ 01637003
      E332 FIXED(31) CONSTANT(332), /* INVALID FILENAME              */ 01641003
      E336 FIXED(31) CONSTANT(336), /* OPEN AN ALREADY OPEN FILE     */ 01643003
      E340 FIXED(31) CONSTANT(340), /* INVALID OPEN TYPE SYNTAX      */ 01647003
      E344 FIXED(31) CONSTANT(344), /* INVALID OPEN TYPE VALUE       */ 01649003
      E348 FIXED(31) CONSTANT(348), /* DCB DID NOT OPEN              */ 01651003
      E352 FIXED(31) CONSTANT(352), /* GET FILENAME NOT FOUND        */ 01654003
      E356 FIXED(31) CONSTANT(356), /* GET DCB NOT OPEN              */ 01657003
      E360 FIXED(31) CONSTANT(360), /* PUT FILENAME NOT FOUND        */ 01661003
      E364 FIXED(31) CONSTANT(364), /* PUT DCB NOT OPEN              */ 01664003
      E368 FIXED(31) CONSTANT(368), /* FILE TO BE CLOSED NOT FOUND   */ 01667003
      E372 FIXED(31) CONSTANT(372), /* PUTX BEFORE GETFILE           */ 01671003
      E400 FIXED(31) CONSTANT(400), /* END OF FILE ON GET            */ 01673003
      E900 FIXED(31) CONSTANT(900), /* SINGLE AMPERSAND ALONE        */ 01677003
      E904 FIXED(31) CONSTANT(904), /* SYMBOLIC VARIABLE NOT FOUND   */ 01679003
      E908 FIXED(31) CONSTANT(908), /* ERROR OCCURRED IN ERROR RANGE */ 01681003
      E912 FIXED(31) CONSTANT(912), /* INVALID RANGE IN SUBSTRING    */ 01684003
      E916 FIXED(31) CONSTANT(916), /* ALPHA DATA IN SUBSTRING EXPRES*/ 01687003
      E920 FIXED(31) CONSTANT(920), /* NEGATIVE VALUE IN RANGE       */ 01691003
      E924 FIXED(31) CONSTANT(924), /* VALUE TOO LONG FOR SUBSTR EXP */ 01694003
      E928 FIXED(31) CONSTANT(928), /* NOT USED                      */ 01697003
      E932 FIXED(31) CONSTANT(932), /* SUBSTRING OUTSIDE RANGE       */ 01701003
      E936 FIXED(31) CONSTANT(936), /* NO P-STRING ON BUILT IN FUNC  */ 01703003
      E940 FIXED(31) CONSTANT(940), /* INVALID SYMBOLIC VARIABLE     */ 01707003
      E944 FIXED(31) CONSTANT(944), /* LABEL AS VALUE OR VAL AS LABEL*/ 01709003
      E948 FIXED(31) CONSTANT(948), /* INVALID GOTO LABEL            */ 01711003
      E952 FIXED(31) CONSTANT(952), /* LABEL NOT FOUND               */ 01714003
      E956 FIXED(31) CONSTANT(956), /* NO LABEL ON GOTO              */ 01717003
      E960 FIXED(31) CONSTANT(960), /* BAD SYSSCAN VALUE             */ 01721003
      E964 FIXED(31) CONSTANT(964), /* BAD LASTCC VALUE              */ 01724003
      E972 FIXED(31) CONSTANT(972), /* TERMIN INVALID IN BACKGROUND  */ 01725003
      E999 FIXED(31) CONSTANT(999); /* INTERNAL CLIST ERROR          */ 01727003
 NPAGE;                                                                 01731003
    DCL                                                                 01733003
                                                                        01737003
      /***************************************************************/ 01739003
      /*                                                             */ 01741003
      /* MAIN BUFFER                                                 */ 01744003
      /*                                                             */ 01747003
      /***************************************************************/ 01751003
                                                                        01754003
      1 * BASED(BUFBASE),           /* BUFFER                        */ 01757003
       2 LL FIXED(15),              /* LENGTH OF THIS BUFFER         */ 01761003
       2 OO FIXED(15),              /* COMMAND SCAN OFFSET           */ 01763003
       2 O2 FIXED(15),              /* OFFSET TO START OF SUB        */ 01767003
        3 C CHAR(*),                /* BUFFER STRING                 */ 01769003
                                                                        01771003
      /***************************************************************/ 01774003
      /*                                                             */ 01777003
      /* ALTERNATE BUFFER                                            */ 01781003
      /*                                                             */ 01784003
      /***************************************************************/ 01787003
                                                                        01791003
      1 * BASED(NEWBASE),           /* ALTERNATE BUFFER              */ 01793003
       2 NEWLL FIXED(15),           /* LENGTH OF ALTERNATE BUFFER    */ 01797003
       2 NEWOO FIXED(15),           /* OFFSET IN ALTERNATE BUFFER    */ 01799003
       2 NEWC CHAR(*),              /* STRING IN ALTERNATE BUFFER    */ 01801003
      /***************************************************************/ 01804003
      /*                                                             */ 01807003
      /* GETLINE PARM BLOCK FROM T55                                 */ 01811003
      /*                                                             */ 01814003
      /***************************************************************/ 01817003
                                                                        01821003
      1 GTPB,                       /* GETLINE PARM BLOCK            */ 01823003
       2 * CHAR(4),                 /* GETLINE PARMS                 */ 01827003
       2 GTPBLINE PTR(31),          /* POINTER TO RETURNED BFR       */ 01829003
 NPAGE;                                                                 01831003
      /***************************************************************/ 01834003
      /*                                                             */ 01837003
      /* TOP ELEMENT OF STACK                                        */ 01841003
      /*                                                             */ 01844003
      /***************************************************************/ 01847003
                                                                        01851003
      1 * BASED(IOSTELM),           /* INPUT STACK TOP ELEMENT       */ 01853003
       2 INSCODE BIT(8),            /* INPUT STACK OPTIONS           */ 01857003
        3 INSTERM BIT(1),           /* TURNED ON FOR TERMIN DELIM    */ 01859003
        3 * BIT(3),                 /* NOT USED IN IKJCT433          */ 01861003
        3 INSEXEC BIT(1),           /* EXEC STACK                    */ 01864003
        3 INSPROM BIT(1),           /* PROMPT ALLOWED                */ 01867003
        3 * BIT(1),                 /* NOT USED IN IKJCT433          */ 01871003
        3 INSLIST BIT(1),           /* LIST LINES BEFORE EXEC        */ 01874003
       2 INSADLSD PTR(24),          /* POINTER TO LSD                */ 01877003
                                                                        01881003
      /***************************************************************/ 01883003
      /*                                                             */ 01887003
      /* SERVICE ROUTINE WORKAREA                                    */ 01889003
      /*                                                             */ 01891003
      /***************************************************************/ 01894003
                                                                        01897003
      1 * BASED(ECTIOWA),           /* SERVICE RTN WORKAREA          */ 01901003
       2 IOSTELM PTR(31),           /* POINTER TO TOP ELEMENT        */ 01904003
       2 *(3) PTR(31),              /* NOT USED IN IKJCT433          */ 01907003
 NPAGE;                                                                 01911003
      /***************************************************************/ 01913003
      /*                                                             */ 01917003
      /* ORIGINAL BUFFER FOR OPCODE                                  */ 01919003
      /*                                                             */ 01921003
      /***************************************************************/ 01924003
                                                                        01927003
      1 * BASED(OLDLINE),           /* ORIGINAL BUFFER FROM T55      */ 01931003
       2 *(3) FIXED(15),            /* LENGTH - OFFSET - O2          */ 01934003
       2 OPCODE FIXED(8),           /* EXEC FUNCTION CODE            */ 01937003
       2 FLSEPATH PTR(31) BDY(BYTE),/* IF FALSE PATH                 */ 01941003
      /***************************************************************/ 01943003
      /*                                                             */ 01947003
      /* MASTER SWITCHES                                             */ 01949003
      /*                                                             */ 01951003
      /***************************************************************/ 01954003
                                                                        01957003
      1 SWS CHAR(5) DEF(SWSAREA),   /* MASTER SWITCHES               */ 01961003
       2 EXITA BIT(1),              /* USED TO EXIT DO WHILES        */ 01964003
       2 EXITB BIT(1),              /* USED TO EXIT DO WHILES        */ 01967003
       2 FREESW BIT(1),             /* A GETMAIN WAS ISSUED          */ 01971003
       2 WAIT BIT(1),               /* SCAN VALUE FIRST              */ 01973003
       2 RANGE BIT(1),              /* SUBSTRING RANGE SPECIFIED     */ 01977003
       2 LEAP BIT(1),               /* LEAP YEAR                     */ 01979003
       2 ALPHA BIT(1),              /* ANSWER IS ALPHA               */ 01981003
       2 EXITC BIT(1),              /* USED TO EXIT DO WHILES        */ 01984003
       2 SEPS BIT(1),               /* SEPARATORS ON LINE            */ 01987003
       2 ENDDLM BIT(1),             /* WORD NOT ENDED BY GOOD DLM    */ 01991003
       2 QUIT BIT(1),               /* EXIT QUIT SPECIFIED           */ 01994003
       2 MATCH BIT(1),              /* MESSAGE FOUND                 */ 01997003
       2 SKPCOMMA BIT(1),           /* SKIP OVER COMMA AS BLANK      */ 02001003
       2 SYSUPDTE BIT(1),           /* ON TO UPDATE UNAUTH VARIABLES */ 02003003
       2 NOAMPER BIT(1),            /* NO AMPERSAND ON VARIABLE      */ 02007003
       2 INSTHEN BIT(1),            /* INSERT THEN ON IF STMT        */ 02009003
       2 SENTINAL BIT(1),           /* WAIT ROUTINE SENTINAL PROCESS */ 02011003
       2 SKIP1 BIT(1),              /* SKIP OVER ONE BYTE            */ 02014003
       2 LISTONLY BIT(1),           /* TSO COMMAND LIST ONLY         */ 02017003
       2 FOLD BIT(1),               /* STRING BIF UNFOLD             */ 02021003
       2 LISTED BIT(1),             /* COMMAND IN ERROR LISTED       */ 02024003
       2 ERRRANGE BIT(1),           /* EXECUTING IN ERRANGE          */ 02027003
       2 ATRANGE BIT(1),            /* EXECUTING IN ATTN RANGE       */ 02031003
       2 BACKUP BIT(1),             /* BACKUP AND LIST TSO CMD       */ 02033003
       2 RCABEND BIT(1),            /* TELL RCUPDT CODE IS ABEND     */ 02037003
       2 NODATA BIT(1),             /* NO DATA FOR UPDATE ROUTINE    */ 02039003
       2 STAECNTL BIT(1),           /* ANY ABEND OCCURRED            */ 02041003
       2 STABND BIT(1),             /* ALWAYS OFF (TO SKIP CODE)     */ 02044003
       2 SVTMOV BIT(1),             /* UPDATE HAS MOVED SVT @OZ32353 */ 02045000
                                                                        02047003
 NPAGE;                                                                 02051003
          /* 433 SPECIAL PARMS */                                       02054003
      1 PARM433 CHAR(8),            /* SPECIAL PARM BLOCK   @ZA08099*/  02054300
      2 * PTR(31),                  /*                       @ZA08099*/ 02054600
       3 PARMDEFR BIT(1),           /* CAN CHANGE STATUS    @ZA08099*/  02054900
       3 EOCLIST BIT(1),            /* END OF CLIST IND TO              02055000
                                       GETLINE              @ZA08099*/  02055500
       3 EXITSTMT BIT(1),           /* EXIT STMT INDICATOR  @ZA08099*/  02055800
       3 * BIT(5),                  /* RESERVED             @ZA08099*/  02055900
       3 * CHAR(3),                 /* RESERVED             @ZA08099*/  02056000
      2 SUSPENDI PTR(31),           /* SUSPENDED ELMT PTR   @ZA08099*/  02056100
      /***************************************************************/ 02063003
      /*                                                             */ 02067003
      /* ATTENTION ECB                                               */ 02069003
      /*                                                             */ 02071003
      /***************************************************************/ 02074003
                                                                        02077003
      1 ECB,                        /* THE ECB                       */ 02081003
       2 * BIT(1),                  /* WAIT BIT                      */ 02084003
       2 ECBCBIT BIT(1),            /* POSTED BIT - TERMINATE        */ 02087003
                                                                        02091003
      /***************************************************************/ 02093003
      /*                                                             */ 02097003
      /* MASTER LOOP CONTROL SWITCHES                                */ 02099003
      /*                                                             */ 02101003
      /***************************************************************/ 02104003
                                                                        02107003
      1 SW2 CHAR(1) DEF(SW2AREA),   /* LOOP SWITCHES                 */ 02111003
       2 CORE BIT(1),               /* CORE ALREADY GOTTEN           */ 02114003
       2 CONTINU BIT(1),            /* CONTINUE IN LOOP              */ 02117003
       2 RECURSE BIT(1);            /* RECURSIVE CLIST ERROR         */ 02121003
 NPAGE;                                                                 02123003
    DCL                                                                 02127003
       COMONPTR PTR(31) REG(8) RSTD,/* MUST BE SAME IN ALL CSECTS    */ 02129003
       1 COMAREA BASED(COMONPTR) BDY(WORD),    /* THE COMMON WORKAREA*/ 02131003
        2 * CHAR(300) BDY(WORD),    /* DEFINE 300 BYTES AS COMMON    */ 02134003
         3 IOPL(4) PTR(31),         /* I/O PARM LIST                 */ 02137003
         3 BUFPTR PTR(31),          /* POINTER TO 434 BFR            */ 02141003
         3 SNTELPTR PTR(31),        /* POINTER TO LOCATED VARIABLE   */ 02144003
         3 EXECDPTR PTR(31),        /* POINTER TO EXEC DATA          */ 02147003
         3 OLDLINE PTR(31),         /* POINTER TO ORIG BUFFER        */ 02151003
         3 BUFBASE PTR(31),         /* POINTER TO CURRENT RECORD     */ 02153003
         3 NEWBASE PTR(31),         /* POINTER TO ALT RECORD         */ 02157003
         3 LSDPTR PTR(31),          /* POINTER TO LSD                */ 02159003
         3 TYPE PTR(31),            /* (ANSPTR FOR CONVERT RTN)      */ 02161003
         3 CNVTANS FIXED(31),       /* CONVERTS ANSWER               */ 02164003
         3 CLEN FIXED(15),          /* CONVERT INPUT LENGTH          */ 02167003
         3 * FIXED(15),             /* FILLER                        */ 02171003
         3 MYO2 FIXED(31),          /* OFFSET TO START PRINT         */ 02174003
         3 BEGIN FIXED(31),         /* START OF WORD FROM FINDWORD   */ 02177003
         3 I FIXED(31),             /* CURRENT CHARACTER IN BUFFER   */ 02181003
         3 LEN FIXED(31),           /* LENGTH OF WORD FORM FINDWORD  */ 02183003
         3 FREEAMT FIXED(31),       /* AMOUNT OF FREE CORE IN BFR    */ 02187003
         3 ERCOM FIXED(31),         /* COMMON ERROR AREA             */ 02189003
         3 REGAREA CHAR(16),        /* AREA FOR REGS 9-12            */ 02191003
         3 REGAREA2 CHAR(16),       /* AREA FOR REGS 9-12            */ 02194003
         3 SWSAREA CHAR(LENGTH(SWS)),/* AREA FOR SWS                 */ 02197003
         3 SW2AREA CHAR(LENGTH(SW2)),/* AREA FOR SW2                 */ 02201003
         3 STAEREGS CHAR(64),       /* AREA FOR STAE REGISTERS       */ 02204003
         3 SYNREGS CHAR(64),        /* AREA FOR SYNAD REGS           */ 02207003
        2 DYNAREA CHAR(*);          /* AREA FOR 436 GOTTOM CORE      */ 02211003
                                                                        02213003
                                                                        02217003
 %MACEND:                                                               02219003
    DEACT NPAGE;                                                        02221003
