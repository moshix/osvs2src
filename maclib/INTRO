         MACRO                                                          00050000
&N       INTRO &PROGID=IEDIMCP,&CROSSRF=0,&DISK=YES,             X03039*00100000
               &MSMIN=50,&MSMAX=70,&DLQ=,&CPRCDS=2,&TOPMSG=YES,        *00150000
               &CONTROL=,&PASSWRD=,&CPB=0,                             *00200000
               &PRIMARY=SYSCON,&INTVAL=0,&CKREQS=0,                    *00250000
               &STARTUP=,&COMWRTE=NO,&WTTONE=0,&APDUMP=YES,    @ZA08385*00300000
               &TRACE=(0),&CIB=2,&ENVIRON=TCAM,                @Y17XANA*00350000
               &USEREG=0,&OLTEST=56,&DTRACE=(0),&TTRACE=,      @Y17XANA*00400000
               &RESTART=0,&LINETYP=BOTH,&THRESH=(255,1,1,1),    SA65392*00450000
               &FEATURE=(DIAL,2741,TIMER,NOCONC,NO3705,NOSNA), @YM06919*00500000
               &SIBCNT=0,&SUBAREA=0,&MAXSUBA=0,                @Y17XANU*00550000
               &OPMASK=(FFFC,FFFC,0008,FFFC,0008,0008,FFFC,C000,FF0C), *00600000
               &MSKVAL=(FFFC,FFFC,0008,FFFC,0008,0008,FFFC,C000,FF0C), *00630000
               &BTRACE=,&PLCBNO=0,&VM=NO,&COMMBUF=,            @PI02856*00700000
               &ABEFMT=,&BUFFTR=(0,PAR,C),&BFRRTN=HI,          @OY19405*00750082
               &LNUNITS=0,&MSUNITS=0,&CPINTVL=1800,&KEYLEN=,     Y02027*00800000
               &UNITSZ=,&APWAS=4024,&AUTHA=YES,&BRACKET=NO     @X50X9FI 00850000
.*A000000-999999                                               @X31X8F0 00900000
.* CHANGE ACTIVITY AS FOLLOWS                                           00950000
.*                  VERSION DATED 08/03/77                     @G36XR0S 01000000
.*C321000,434000-435000                                          Y02027 01050000
.*C032000,595000,601000-602000,665000                           SA51078 01100000
.*A043900,579500,596200-596600,665300-665600                    SA51078 01150000
.*C142000                                                        S21903 01200000
.*D286000-294000                                                 S21903 01250000
.*A286000                                                        S21903 01300000
.*C010000,032000,057000,354550,416000                            S22027 01350000
.*A014100,030500,043800,045300-045600,327000-343960              S22027 01400000
.*A354554-354590,416090-416900                                   S22027 01450000
.*D327000-327600                                                 S22027 01500000
.*C008000,311000,315000,317000                                   S99258 01550000
.*C057000,684000                                                 S22029 01600000
.*D685000-687000                                                 S22029 01650000
.*D327000,354500                                                 S22026 01700000
.*C010000,032000                                                 S22026 01750000
.*A014500,043300-043600,066050-066850,326500-327500              S22026 01800000
.*A343090-343900,347300-347600,354460-354520                     S22026 01850000
.*                               CLEAN-UP                        S21903 01900000
.*A014000,074000                                                SA50203 01950000
.*C085000                                                       SA62343 02000000
.*A689125-689150                                                 Y01004 02050000
.*C307500,321000,434000-435000                                   Y01004 02100000
.*D689400                                                        Y01004 02150000
.*C142000,425000,669000                                          Y05330 02200000
.*A354636                                                        Y06328 02250000
.*A354637,354638                                                 Y05330 02300000
.*A011130,013100,030700                                          X03039 02350000
.*C000200,010000,011000,057000,063000,066700-066750,070000,079000X03039 02400000
.*C091000,096000,101100-101250,101500-101550,115500,127000,134000X03039 02450000
.*C142000,200000,227000,239000,254000,264000,274000,302000,31500X03039  02500000
.*C327060,327450,327730,354550-354558,354605-354624,354626-354650X03039 02550000
.*C356000-357000,366000,390000,400000,444000,495000,519000,525000X03039 02600000
.*C539000,551000,561000,612000,626000,638000,679000,715000       X03039 02650000
.*A396000                                                       SA63008 02700000
.*A030700,285000                                                SA65392 02750000
.*C007000,009000                                                SA65392 02800000
.*D286000                                                       SA65392 02850000
.*C010100,C032000,A043901-043902,D354593,C354596,A344597,        Y05331 02900000
.*A354628-354647                                                 Y05331 02950000
.*A143000                                                       OX02212 03000000
.*D690000                                                       OX02212 03050000
.*A115000,307500                                               @Z30X8FG 03100000
.*C008000,057000,142000,315000,327060,327450                   @Z30X8FG 03150000
.*C327730,348160,348600,375600,513000,533000                   @Z30X8FG 03200000
.*D124000-129000                                               @Z30X8FG 03250000
.*A311000                                                      @SA68227 03300000
.*C670000                                                      @SA71946 03350000
.*A600000                                                      @XA05310 03400000
.*C601000-602000,604000                                        @XA05310 03450000
.*D571000                                                      @XA05310 03500000
.*A195000                                                      @ZA02609 03550000
.*C202000,200000                                               @ZA02609 03600000
.*C011050,354657-354698                                        @X50X9FI 03650000
.*A354657                                                      @X50X9FI 03700000
.*C008000                                                      @SA74046 03750000
.*C354658                                                      @ZA05019 03800000
.*C354555-354558                                               @OX11333 03850000
.*A032000,043902                                               @ZA07083 03900000
.*C006000,327780-327810                                        @ZA07083 03950000
.*C010000,010100,013400-013700,057300,101120,142000            @Y17XANU 04000000
.*C353450-353510,354092,354160-354547                          @Y17XANU 04050000
.*A010000,030700,057000,057600,101750,616000                   @Y17XANU 04100000
.*D101122,307550-307950                                        @Y17XANU 04150000
.*A010300,075200,219110-219670                                 @Y17XAB3 04200000
.*D219800                                                      @Y17XAB3 04250000
.*C348600,351400,352800                                        @Y17XAXU 04300000
.*A082000-082100,740000-741050,742105-742195                   @Y17XANA 04350000
.*C004900,005200                                               @Y17XANA 04400000
.*D010100                                                      @Y17XANA 04450000
.*D219660-219670                                               @YM07738 04500000
.*C219650,729100                                               @YM07738 04550000
.*A058070,060900,702900                                        @YM07790 04600000
.*C011900,170100,171500,702900,711200                          @YM07790 04650000
.*D078600-079200                                               @YM07790 04700000
.* A289800,290100                                              @Y17XAXF 04750000
.*C355600,414900-699900,732400,732500,755400                   @G36XRFG 04800000
.*D414500-414800,700000                                        @G36XRFG 04850000
.*C738300-738400                                               @G36XRYP 04900000
.*A043942,579500                                               @OS77945 04950000
.*C032000,382000,595000,596400                                 @OS77945 05000000
.*C348120                                                      @OZ17630 05050000
.*C348080-348140                                               @OZ24197 05100000
.* RESEQUENCED AT THIS POINT. ALL LINE NUMBERS BELOW ARE VALID          05103000
.* A121000                                                     @OY16094 05106000
.* D122500                                                     @OY16094 05109000
.* C121500                                                     @OY16348 05112000
.* C126500-127000                                              @OY16351 05115000
.* C006000-006500                                              @OY16438 05118000
.* A065500,170000,171000,172500,                               @OY18015 05121000
.* A174000,175500,177000,178500,180000,181500,183000,184500,   @OY18015 05124000
.* A186000,187500,189000,190500,192000,193500                  @OY18015 05127000
.* D171500,173000,                                             @OY18015 05130000
.* D174500,176000,177500,179000,180500,182000,183500,185000,   @OY18015 05133000
.* D186500,188000,189500,191000,192500,194000                  @OY18015 05136000
.*A461000                                                      @OY19488 05136182
.*A007500,080000,135500,525500,523000                          @OY19124 05136282
.*C007500,066000,229000                                        @OY19405 05136382
.*C130000,132000                                               @OX20976 05136482
.*A131000                                                      @OX20976 05136582
.*A051500,611000                                               @OZ36390 05136682
.*A530500,535500,537500                                        @OZ36974 05136782
.* C193600,195000,506500                                       @OZ35527 05136882
.* A170200                                                     @OZ35527 05136982
.*A433000                                                      @OZ46929 05137082
.*C435000-436000                                               @OZ46929 05137182
.*D114000-115000                                               @OZ49910 05143582
.*D433100-433400                                               @OZ53057 05145682
.*C435000-435500                                               @OZ53057 05147782
         GBLA  &IEDQZF                                                  05150000
         GBLA  &KEYLN                                          @OZ36390 05170082
.* &IEDQZF NUMBER WORDS TO BE ADDED TO SCB FOR SAVEAREA                 05200000
         GBLB  &IEDQRN(8)                                        S22024 05250000
.* &IEDQRN(1) 0=NO 3705,1=3705 W/ OR W/O 270X SUPPORT)         @Y17XANU 05300000
.* &IEDQRN(2) 1=3705 ONLY SUPPORT                              @Y17XANU 05350000
.* &IEDQRN(3) 1=SNA ONLY SUPPORT                               @YM07790 05400000
.* &IEDQRN(4) 1=SNA ENVIRONMENT (W/ OR W/O PRE-SNA)            @YM07790 05450000
         GBLB  &IEDQZA(64)                                              05500000
.* &IEDQZA(44) SET BY COMMBUF=(N,N,N) OPERAND                    S22027 05550000
.* &IEDQZA(60) SET BY &FEATURE=NODIAL                           SA50203 05600000
.* &IEDQZA(13) SET BY FEATURE=(,,,CONCO) OR FEATURE=(,,,CONC)    S22026 05650000
.* &IEDQZA(42) SET BY NON-ZERO RESPONSE TO MSUNITS=INTEGER              05700000
.* &IEDQZA(51) SET BY &ENVIRON=TSO OR MIXED                             05750000
.* &IEDQZA(52) SET BY &ENVIRON=TCAM OR MIXED                            05800000
.* &IEDQZA(41) SET BY DISK=YES                                          05850000
.* &IEDQZA(7)  SET BY INTRO, DISTINGUISHES TCAM FROM QTAM.              05900000
.*             CHECKED BY INTRO TO AVOID DUPLICATE INTROS.              05950000
         GBLC  &IEDQSV1(50)             SET TO PROGID          @YM04652 06000000
         LCLA  &IEDLKEY                                                 06050000
         LCLA  &IEDLSA                                                  06100000
.* &IEDLSA IS INDEX THRU STARTUP OPERANDS                               06150000
         LCLA  &IEDLSCB                                                 06200000
         LCLA  &IEDLTON                                                 06250000
         LCLA  &IEDLMIN,&IEDLMAX                                        06300000
         LCLA  &IEDLMS                                                  06350000
         LCLA  &IEDLTRA                                                 06400000
.* &IEDLTRA IS TRACE OPERAND SAVED FOR TREXIT                           06450000
         LCLA  &A                                                S22027 06500000
         LCLA  &ABDUMP                  ABDUMP FORMATTING      @Y17XAB3 06550000
         LCLB  &AF(32)                                         @OY18015 06560000
         LCLA  &B,&TR,&BUFF                                    @OY19405 06600082
         LCLA  &G,&ECNT                 INDEX USED IN          @Y17XANU 06650000
.*                                      ANALYZING &OPMSK       @Y17XANU 06700000
         LCLC  &H                                              @Y17XANU 06750000
         LCLC  &SUBTVAL,&SUBIVAL        SUBT AND IOTR VALUES   @Y17XAXF 06800000
         LCLA  &IEDIDLN                                          X03039 06850000
         LCLA  &C,&D,&E,&F              THRESHHOLD VALUES       SA65392 06900000
         LCLB  &IEDLDSK                                                 06950000
         LCLB  &IEDLSB(18)                                     @OS77945 07000000
         LCLA  &DTRACEN                 DTRACE TABLE ENTRIES   @Y17XANA 07050000
         LCLA  &TRACEN                  TRACE  TABLE ENTRIES   @Y17XANA 07100000
.* &IEDLSB(1)  STARTUP=C OR W SPECIFIED                                 07150000
.* &IEDLSB(2)  STARTUP=C SPECIFIED                                      07200000
.* &IEDLSB(3)  STARTUP=I SPECIFIED                                      07250000
.* &IEDLSB(4)  STARTUP=Y SPECIFIED                                      07300000
.* &IEDLSB(5)  LINETYP=STSP OR LINETYP=BOTH SPECIFIED - ZEROED          07350000
.* &IEDLSB(6)  LINETYP=BISC OR LINETYP=BOTH SPECIFIED - ZEROED          07400000
.* &IEDLSB(5) AND (6) BOTH SET IF LINETYP=MINI SPECIFIED                07450000
.* &IEDLSB(7)  TOPMSG=NO SPECIFIED                                      07500000
.* &IEDLSB(8)  FEATURE=NODIAL                                           07550000
.* &IEDLSB(9)  FEATURE=(,NO2741)                                        07600000
.* &IEDLSB(10) FEATURE=(,,NOTIMER)                                      07650000
.* &IEDLSB(11) FEATURE=(,,,CONC)                                 S22026 07700000
.* &IEDLSB(12) FEATURE=(,,,CONCO)                                S22026 07750000
.* &IEDLSB(13) COMMBUF=(N,N,N) SPECIFIED                         S22027 07800000
.* &IEDLSB(14) STARTUP=E SPECIFIED                              SA51078 07850000
.* &IEDLSB(15) VM=YES SPECIFIED                                  Y05331 07900000
.* &IEDLSB(16) VM=PROMPT SPECIFIED                               Y05331 07950000
.* &IEDLSB(18) STARTUP=N SPECIFIED                             @OS77945 08000000
         LCLC  &BRETURN                                        @OY19124 08020082
         LCLC  &IEDLSEC                                                 08050000
         LCLC  &IEDLSKP                                                 08100000
         LCLC  &IEDCBUF(3)                                       S22027 08150000
.* &IEDCBUF SET TO COMBUF VALUES                                 S22027 08200000
&IEDLSB(5) SETB 1                       SET TO DEFAULT OF               08250000
&IEDLSB(6) SETB 1                         LINETYP=BOTH                  08300000
&IEDLSKP SETC  'IEDQ&SYSNDX'                                            08350000
         AIF   (NOT &IEDQZA(7)).GOODINT                                 08400000
         SPACE                                                          08450000
         MNOTE 12,'IHB067 INTRO MACRO PREVIOUSLY SPECIFIED'             08500000
         SPACE 2                                                        08550000
         MEXIT                                                          08600000
.GOODINT ANOP                                                           08650000
&IEDQZA(7) SETB 1                                                       08700000
         SPACE                                                          08750000
*                                                            * @Y17XANU 08800000
*              INTRO UPDATE - LEVEL A0                       * @Y17XANU 08850000
*                                                            * @Y17XANU 08900000
         SPACE 2                                                        08950000
&IEDQZA(52) SETB ('&ENVIRON' EQ 'TCAM' OR '&ENVIRON' EQ 'MIXED')        09000000
&IEDQZA(51) SETB ('&ENVIRON' EQ 'TSO' OR '&ENVIRON' EQ 'MIXED')         09050000
         AIF   (&IEDQZA(51) OR &IEDQZA(52)).SKIPINV                     09100000
         SPACE                                                          09150000
         MNOTE 4,'IHB303  INVALID OPERAND ENVIRON, TCAM ASSUMED'        09200000
         SPACE 2                                                        09250000
&IEDQZA(52) SETB 1                      SET DEFAULT TO 'TCAM'           09300000
.SKIPINV ANOP                                                           09350000
         AIF   ('&FEATURE(4)' NE 'CONCO').CTEST2                 S22026 09400000
&IEDLSB(12) SETB 1                      FEATURE=(,,,CONCO)       S22026 09450000
&IEDQZA(13) SETB 1                      FEATURE=(,,,CONCO)       S22026 09500000
&IEDLSB(8)  SETB 1                      FORCE FEATURE=NODIAL     S22026 09550000
&IEDLSB(9)  SETB 1                      FORCE FEATURE=(,NO2741)  S22026 09600000
         AGO   .GOODFEA                                          S22026 09650000
.CTEST2  AIF   ('&FEATURE(4)' NE 'CONC').CTEST3                  S22026 09700000
&IEDLSB(11) SETB 1                      FEATURE=(,,,CONC)        S22026 09750000
&IEDQZA(13) SETB 1                      FEATURE=(,,,CONC)        S22026 09800000
         AGO   .DTST                                             S22026 09850000
.CTEST3  AIF   ('&FEATURE(4)' EQ 'NOCONC' OR '&FEATURE(4)' EQ '').DTST  09900000
.*                                                               S22026 09950000
         SPACE 1                                                 S22026 10000000
         MNOTE 4,'IHB303 INVALID OPERAND FEATURE, (,,,NOCONC) ASSUMED'  10050000
         SPACE 2                                                 S22026 10100000
.DTST    ANOP                                                    S22026 10150000
         AIF   ('&FEATURE(1)' EQ 'DIAL' OR '&FEATURE(1)' EQ '').DIAL    10200000
         AIF   ('&FEATURE(1)' EQ 'NODIAL').NODIAL                       10250000
         SPACE                                                          10300000
         MNOTE 4,'IHB303  INVALID OPERAND FEATURE, DIAL ASSUMED'        10350000
         SPACE 2                                                        10400000
         AGO   .DIAL                                                    10450000
.NODIAL  ANOP                                                           10500000
&IEDLSB(8) SETB 1                       FEATURE=NODIAL                  10550000
&IEDQZA(60) SETB 1                                              SA50203 10600000
.DIAL    ANOP                                                           10650000
         AIF   ('&FEATURE(2)' EQ '2741' OR '&FEATURE(2)' EQ '').T2741   10700000
         AIF   ('&FEATURE(2)' EQ 'NO2741').NO2741                       10750000
         SPACE                                                          10800000
         MNOTE 4,'IHB303  INVALID OPERAND FEATURE, (,2741) ASSUMED'     10850000
         SPACE 2                                                        10900000
         AGO   .T2741                                                   10950000
.NO2741  ANOP                                                           11000000
&IEDLSB(9) SETB 1                       FEATURE=(,NO2741)               11050000
.T2741   ANOP                                                           11100000
         AIF   (&IEDQZA(51) AND &IEDLSB(9)).BADFEA              SA62343 11150000
         AGO   .GOODFEA                                                 11200000
.BADFEA  ANOP                                                           11250000
&IEDLSB(8) SETB 0                                                       11300000
&IEDLSB(9) SETB 0                                                       11350000
.GOODFEA ANOP                                                  @Y17XANU 11550000
         AIF   ('&FEATURE(3)' EQ 'TIMER' OR '&FEATURE(3)' EQ '').TIMER  11600000
         AIF   ('&FEATURE(3)' EQ 'NOTIMER').NOTIME                      11650000
         SPACE                                                          11700000
         MNOTE 4,'IHB303  INVALID OPERAND FEATURE, (,,TIMER) ASSUMED'   11750000
         SPACE 2                                                        11800000
         AGO   .TIMER                                                   11850000
.NOTIME  ANOP                                                           11900000
&IEDLSB(10) SETB 1                      FEATURE=(,,NOTIMER)             11950000
.TIMER   ANOP                                                           12000000
&IEDQRN(1)  SETB  1                                              S22024 12050000
         AIF   ('&FEATURE(5)' EQ 'NO3705' OR                           *12100000
               '&FEATURE(5)' EQ '' OR                                  *12110000
               '&FEATURE(5)' EQ 'NOVTAM').NO3705               @OY16348 12150000
         AIF   ('&FEATURE(5)' EQ 'MIXD3705' OR                         *12200000
               '&FEATURE(5)' EQ 'MIXDVTAM').T3705                X03039 12300000
         AIF   ('&FEATURE(5)' NE 'ONLY3705' AND                        *12350000
               '&FEATURE(5)' NE 'ONLYVTAM').BAD3705              X03039 12400000
&IEDQRN(2)  SETB  1                                              S22024 12450000
         AGO   .T3705                                            S22024 12500000
.BAD3705 ANOP                                                    S22024 12550000
         SPACE                                                          12600000
         MNOTE 4,'IHB303 INVALID OPERAND FEATURE, (,,,,NO3705) ASSUMED' 12650000
.*                                                             @OY16351 12700000
         SPACE 2                                                        12750000
.NO3705  ANOP                                                    S22024 12800000
&IEDQRN(1)  SETB  0                                              S22024 12850000
.T3705   ANOP                                                    S22024 12900000
         AIF   (NOT &IEDQRN(1)).BYPSNA  BRANCH IF EP ONLY      @PI02859 12950000
         AIF   ('&FEATURE(6)' EQ '').BYPSNA                    @OX20976 13000082
         AIF   ('&FEATURE(6)' EQ 'ONLYSNA').ONSNA ONLY SNA     @Y17XANU 13050000
         AIF   ('&FEATURE(6)' EQ 'MIXDSNA').MXSNA MIXED SNA    @Y17XANU 13100000
         AIF   ('&FEATURE(6)' EQ 'NOSNA').BYPSNA               @OX20976 13110082
         SPACE 1                                               @Y17XANU 13150000
         MNOTE 4,'IHB303 INVALID OPERAND FEATURE,(NOSNA) ASSUMED'       13200082
.*                                                             @OX20976 13250082
         AGO   .BYPSNA                  FORCE NO SNA           @OX20976 13300082
.ONSNA   ANOP                                                  @Y17XANU 13301082
&IEDQRN(3) SETB 1                       SET ONLY SNA           @YM07790 13400000
.MXSNA   ANOP                                                  @Y17XANU 13450000
&IEDQRN(4) SETB 1                       SET SNA ENVIRONMENT    @YM07790 13500000
.BYPSNA  ANOP                                                  @PI02859 13550000
&BRETURN SETC  '&BFRRTN'                                       @OY19124 13557082
         AIF   ('&BFRRTN' EQ 'HI' OR '&BFRRTN' EQ 'LO' OR '&BFRRTN' EQ X13564082
               '').BFRGOD                                      @OY19124 13571082
         MNOTE 4,'IHB304 INVALID OPERAND BFRRTN, HI ASSUMED'   @OY19124 13578082
&BRETURN SETC 'HI'                                             @OY19124 13585082
.BFRGOD ANOP                                                   @OY19124 13592082
         AIF   (NOT &IEDQRN(1)).BYPTR   BYPASS IF EP ONLY      @PI02856 13600000
         AIF   ('&BTRACE' EQ '' AND '&TTRACE' EQ '').TRDEF     @PI02856 13650000
         AIF   ('&BTRACE' NE '' AND '&TTRACE' NE '').BTRDEF    @PI02856 13700000
         AIF   ('&BTRACE' EQ '').TTRDEF CHECK TTRACE           @PI02856 13750000
.BTRDEF  ANOP                                                  @PI02856 13800000
         AIF   (T'&BTRACE NE 'N').BADTR     VALID NUMBER       @PI02856 13850000
&TR      SETA  &BTRACE                  SET BTRACE VALUE       @PI02856 13900000
         AGO   .TRSPSE                                         @PI02856 13950000
.TTRDEF  ANOP                                                  @PI02856 14000000
         AIF   (T'&TTRACE NE 'N').BADTR     VALID NUMBER       @PI02856 14050000
&TR      SETA  &TTRACE                  SET TTRACE VALUE       @PI02856 14100000
         AGO   .TRSPSE                                         @PI02856 14150000
.TRDEF   ANOP                                                  @PI02856 14200000
&TR      SETA  200                      SET DEFAULT            @PI02856 14250000
.TRSPSE  ANOP                                                  @PI02856 14300000
         AIF   (&TR LT 0 OR &TR GT 65535).BADTR INVALID ENTRY  @PI02856 14350000
         AGO   .BYPTR                                          @PI02856 14400000
.BADTR   MNOTE 4,'IED900 INVALID BTRACE/TTRACE, 200 ASSUMED'   @PI02856 14450000
&TR      SETA  200                      SET DEFAULT            @PI02856 14500000
.BYPTR   ANOP                                                  @PI02856 14550000
.*       &TR WILL BE USED TO SET NO. OF PIU TRACE ENTRIES IN SAVT       14600000
.*                                                             @PI02856 14650000
         AIF   (&IEDQZA(52)).SETCOR                                     14700000
         AGO   .NODISK                  SKIP IF TSO ONLY                14750000
.SETCOR  ANOP                                                           14800000
         AIF   ('&MSUNITS' EQ 'YES').COREYES                            14850000
         AIF   ('&MSUNITS' EQ 'NO').CORENO                              14900000
         IEDQMASK &MSUNITS,2                                            14950000
         AIF   (&IEDQZA(24)).CORERR                                     15000000
         AIF   ('&MSUNITS'(1,1) EQ 'X' OR &MSUNITS LT 0).CORERR         15050000
         AIF   (&MSUNITS EQ 0).CORENO                                   15100000
&IEDLMS  SETA  &MSUNITS                                                 15150000
.SETGBL  ANOP                                                           15200000
&IEDQZA(42) SETB 1                      MSUNITS REQUESTED               15250000
         AGO   .COROUT                                                  15300000
.COREYES ANOP                                                           15350000
.CORERR  ANOP                                                  @Z30X8FG 15400000
         MNOTE 4,'IHB303 INVALID OPERAND MSUNITS, 1 ASSUMED'            15450000
&IEDLMS  SETA  1                        MSUNITS=1 DEFAULT VALUE         15500000
         AGO   .SETGBL                                                  15550000
.CORENO  ANOP                                                           15600000
&IEDLMS  SETA  0                        MSUNITS=0 OR NO                 15650000
         AIF   ('&DISK' NE 'NO').COROUT                                 15700000
         SPACE                                                          15750000
         MNOTE 12,'IHB300 MSUNITS/DISK OPERAND INVALID AS SPECIFIED'    15800000
         SPACE 2                                                        15850000
.COROUT  ANOP                                                           15900000
         AIF   ('&DISK' EQ 'NO').NODISK                                 15950000
         AIF   ('&DISK' EQ 'YES').DODSK                                 16000000
         SPACE                                                          16050000
         MNOTE 4,'IHB303  INVALID OPERAND DISK, YES ASSUMED'            16100000
         SPACE 2                                                        16150000
.DODSK   ANOP                                                           16200000
&IEDQZA(41) SETB 1                      DISK=YES                        16250000
.NODISK  ANOP                                                           16300000
         CNOP  0,8 .                    FORCE DOUBLEWORD BOUNDARY       16350000
         USING *,15 .                   TEMPORARY BASE                  16400000
&N       B     &IEDLSKP .               SKIP CONSTANTS                  16450000
         DC    AL1(3),C'VA0' .          PROGRAM LEVEL AND ID   @Y17XANU 16500000
&IEDLDSK SETB  ('&DISK' NE 'NO' AND &IEDQZA(52))                        16550000
&IEDLSEC SETC  '&SYSECT'                                        OX02212 16600000
&IEDLSEC CSECT                                                  OX02212 16650000
IEDQAVT  DS    0D                                                       16700000
         ENTRY IEDQAVT                                                  16750000
IEDSAVE1 DC    18F'0' .                 MESSAGE CONTROL PROG SAVEAREA   16800000
IEDSAVE2 DC    14F'0',A(IEDQAVT),3F'0' .DISPATCHER SAVEAREA             16850000
&ABDUMP  SETA  0                   INITIALIZE VALUE            @Y17XAB3 16900000
         AIF   (T'&ABEFMT EQ 'O').ABEFMTX                      @Y17XAB3 16950000
&A       SETA  0                   INITIALIZE INDEX            @Y17XAB3 17000000
         AIF   (N'&ABEFMT NE 1 OR '&ABEFMT(1)' NE 'ALL').ABEFMT1        17010000
&ABDUMP  SETA  131070                                          @OY18015 17020000
&AF(32)  SETB  1                       ALL INCLUDES HIER       @OZ35527 17025082
         AGO   .ABEFMTX                                        @OY18015 17030000
.ABEFMT1 ANOP                                                  @Y17XAB3 17050000
&A       SETA   &A+1               BUMP INDEX                  @Y17XAB3 17100000
         AIF   (&AF(2) OR '&ABEFMT(&A)' NE 'AMWA').ABEFMT2     @OY18015 17110000
&AF(2)   SETB  1                                               @OY18015 17120000
&ABDUMP  SETA  &ABDUMP+2                                       @Y17XAB3 17200000
         AGO   .ABEFMTY                                        @Y17XAB3 17250000
.ABEFMT2 AIF   (&AF(3) OR '&ABEFMT(&A)' NE 'PEWA').ABEFMT3     @OY18015 17260000
&AF(3)   SETB  1                                               @OY18015 17270000
&ABDUMP  SETA  &ABDUMP+4                                       @Y17XAB3 17350000
         AGO   .ABEFMTY                                        @Y17XAB3 17400000
.ABEFMT3 AIF   (&AF(4) OR '&ABEFMT(&A)' NE 'PCB').ABEFMT4      @OY18015 17410000
&AF(4)   SETB  1                                               @OY18015 17420000
&ABDUMP  SETA  &ABDUMP+8                                       @Y17XAB3 17500000
         AGO   .ABEFMTY                                        @Y17XAB3 17550000
.ABEFMT4 AIF   (&AF(5) OR '&ABEFMT(&A)' NE 'SIB').ABEFMT5      @OY18015 17560000
&AF(5)   SETB  1                                               @OY18015 17570000
&ABDUMP  SETA  &ABDUMP+16                                      @Y17XAB3 17650000
         AGO   .ABEFMTY                                        @Y17XAB3 17700000
.ABEFMT5 AIF   (&AF(6) OR '&ABEFMT(&A)' NE 'RVT').ABEFMT6      @OY18015 17710000
&AF(6)   SETB  1                                               @OY18015 17720000
&ABDUMP  SETA  &ABDUMP+32                                      @Y17XAB3 17800000
         AGO   .ABEFMTY                                        @Y17XAB3 17850000
.ABEFMT6 AIF   (&AF(7) OR '&ABEFMT(&A)' NE 'DCT').ABEFMT7      @OY18015 17860000
&AF(7)   SETB  1                                               @OY18015 17870000
&ABDUMP  SETA  &ABDUMP+64                                      @Y17XAB3 17950000
         AGO   .ABEFMTY                                        @Y17XAB3 18000000
.ABEFMT7 AIF   (&AF(8) OR '&ABEFMT(&A)' NE 'LGB').ABEFMT8      @OY18015 18010000
&AF(8)   SETB  1                                               @OY18015 18020000
&ABDUMP  SETA  &ABDUMP+128                                     @Y17XAB3 18100000
         AGO   .ABEFMTY                                        @Y17XAB3 18150000
.ABEFMT8 AIF   (&AF(9) OR '&ABEFMT(&A)' NE 'DCB').ABEFMT9      @OY18015 18160000
&AF(9)   SETB  1                                               @OY18015 18170000
&ABDUMP  SETA  &ABDUMP+256                                     @Y17XAB3 18250000
         AGO   .ABEFMTY                                        @Y17XAB3 18300000
.ABEFMT9 AIF   (&AF(10) OR '&ABEFMT(&A)' NE 'DEB').ABEFMTA     @OY18015 18310000
&AF(10)  SETB  1                                               @OY18015 18320000
&ABDUMP  SETA  &ABDUMP+512                                     @Y17XAB3 18400000
         AGO   .ABEFMTY                                        @Y17XAB3 18450000
.ABEFMTA AIF   (&AF(11) OR '&ABEFMT(&A)' NE 'SCB').ABEFMTB     @OY18015 18460000
&AF(11)  SETB  1                                               @OY18015 18470000
&ABDUMP  SETA  &ABDUMP+1024                                    @Y17XAB3 18550000
         AGO   .ABEFMTY                                        @Y17XAB3 18600000
.ABEFMTB AIF   (&AF(12) OR '&ABEFMT(&A)' NE 'PLCB').ABEFMTC    @OY18015 18610000
&AF(12)  SETB  1                                               @OY18015 18620000
&ABDUMP  SETA  &ABDUMP+2048                                    @Y17XAB3 18700000
         AGO   .ABEFMTY                                        @Y17XAB3 18750000
.ABEFMTC AIF   (&AF(13) OR '&ABEFMT(&A)' NE 'LCB').ABEFMTD     @OY18015 18760000
&AF(13)  SETB  1                                               @OY18015 18770000
&ABDUMP  SETA  &ABDUMP+4096                                    @Y17XAB3 18850000
         AGO   .ABEFMTY                                        @Y17XAB3 18900000
.ABEFMTD AIF   (&AF(14) OR '&ABEFMT(&A)' NE 'QCB').ABEFMTE     @OY18015 18910000
&AF(14)  SETB  1                                               @OY18015 18920000
&ABDUMP  SETA  &ABDUMP+8192                                    @Y17XAB3 19000000
         AGO   .ABEFMTY                                        @Y17XAB3 19050000
.ABEFMTE AIF   (&AF(15) OR '&ABEFMT(&A)' NE 'OPT').ABEFMTF     @OY18015 19060000
&AF(15)  SETB  1                                               @OY18015 19070000
&ABDUMP  SETA  &ABDUMP+16384                                   @Y17XAB3 19150000
         AGO   .ABEFMTY                                        @Y17XAB3 19200000
.ABEFMTF AIF   (&AF(16) OR '&ABEFMT(&A)' NE 'TTE').ABEFMTG     @OY18015 19210000
&AF(16)  SETB  1                                               @OY18015 19220000
&ABDUMP  SETA  &ABDUMP+32768                                   @Y17XAB3 19300000
         AGO   .ABEFMTY                                        @Y17XAB3 19350000
.ABEFMTG AIF   (&AF(17) OR '&ABEFMT(&A)' NE 'UCB').ABEFMTH     @OZ35527 19360082
&AF(17)  SETB  1                                               @OY18015 19370000
&ABDUMP  SETA  &ABDUMP+65536                                   @Y17XAB3 19450000
         AGO   .ABEFMTY                                        @OZ35527 19500082
.ABEFMTH AIF   (&AF(32) OR '&ABEFMT(&A)' NE 'HIER').ABEFMTY    @OZ35527 19510082
&AF(32)  SETB  1                                               @OZ35527 19520082
.ABEFMTY AIF   (&A LT N'&ABEFMT).ABEFMT1 LOOP BACK UNTIL DONE  @OZ35527 19530082
.ABEFMTX ANOP                                                  @Y17XAB3 19550000
IEDSAVE3 DS    18F'0'                   SUBTASK'S SAVEAREA     @YM07738 19600000
IEDSAVE4 DC    18F'0' .                 1ST LEVEL SUBROUTINE SAVEAREA   19650000
         DC    8F'0' .                  DISABLED SAVEAREA               19700000
         AIF   (K'&PROGID LT 8).SETEQU  PROGID LESS THAN 8 CHAR@Y17XANU 19750000
&IEDQSV1(5) SETC '&PROGID'(1,8)         SET PROGID             @Y17XANU 19800000
         AGO   .PROGSET                 CONTINUE PROCESSING    @Y17XANU 19850000
.SETEQU  ANOP                                                  @Y17XANU 19900000
&IEDQSV1(5) SETC '&PROGID'              SET PROGID             @Y17XANU 19950000
.PROGSET ANOP                                                  @Y17XANU 20000000
         AIF   ('&DLQ' EQ '').NODLQ                                     20050000
         AIF   ('&DLQ'(1,1) EQ '0' AND K'&DLQ EQ 1).NODLQ               20100000
         AIF   (K'&DLQ GT 8).BADDLQ                                     20150000
         DC    CL8'&DLQ' .              DLQ=TERMNAME                    20200000
         AGO   .SKIPDLQ                                                 20250000
.BADDLQ  SPACE                                                          20300000
         MNOTE 12,'IHB304 DLQ SPECIFIED TOO MANY CHARACTERS'            20350000
         SPACE 2                                                        20400000
.NODLQ   DC    2F'0' .                  DLQ=TERMNAME NOT SPECIFIED      20450000
.SKIPDLQ ANOP                                                           20500000
         DC    A(IEDQSTCS,0) .                                          20550000
         AIF   ('&PRIMARY' EQ 'SYSCON' OR '&PRIMARY' EQ '').NOPRI       20600000
         AIF   ('&PRIMARY'(1,1) EQ '0' AND K'&PRIMARY EQ 1).NOPRI       20650000
         AIF   (K'&PRIMARY GT 8).BADMARY                                20700000
         DC    CL8'&PRIMARY' .          PRIMARY=TERMNAME                20750000
         AGO   .SKIPRI                                                  20800000
.BADMARY SPACE                                                          20850000
         MNOTE 12,'IHB304 PRIMARY SPECIFIED TOO MANY CHARACTERS'        20900000
         SPACE 2                                                        20950000
.NOPRI   DC    8X'00' .                 PRIMARY=SYSCON                  21000000
.SKIPRI  ANOP                                                           21050000
IEDDOUBL DC    2F'0' .                                                  21100000
         AIF   ('&CONTROL' EQ '').NOTROL                                21150000
         AIF   ('&CONTROL'(1,1) EQ '0' AND K'&CONTROL EQ 1).NOTROL      21200000
         AIF   (K'&CONTROL GT 8).BADTROL                                21250000
         DC    CL8'&CONTROL' .          CONTROL=CHARS SPECIFIED         21300000
         AGO   .SKIPTRL                                                 21350000
.BADTROL SPACE                                                          21400000
         MNOTE 12,'IHB304 CONTROL SPECIFIED TOO MANY CHARACTERS'        21450000
         SPACE 2                                                        21500000
.NOTROL  DC    8X'FF' .                 CONTROL=CHARS OMITTED           21550000
.SKIPTRL AIF   ('&PASSWRD' EQ '').NOPASS                                21600000
         AIF   ('&PASSWRD'(1,1) EQ '0' AND K'&PASSWRD EQ 1).NOPASS      21650000
         AIF   (K'&PASSWRD GT 8).BADPAS                                 21700000
         DC    CL8'&PASSWRD' .          PASSWRD=CHARS SPECIFIED         21750000
         AGO   .SKIPASS                                                 21800000
.BADPAS  SPACE                                                          21850000
         MNOTE 12,'IHB304 PASSWRD SPECIFIED TOO MANY CHARACTERS'        21900000
         SPACE 2                                                        21950000
.NOPASS  DC    CL8' ' .                 PASSWRD=CHARS OMITTED           22000000
.SKIPASS ANOP                                                           22050000
         DC    A(0) .                   ADDR OF MESSAGE CONTROL TCB     22100000
         IEDQMASK &TRACE(1),2                                  @Y17XANA 22150000
         AIF   (&IEDQZA(24)).BADTRA                                     22200000
         AIF   ('&TRACE'(1,1) EQ 'X' OR &TRACE(1) LT 0).BADTRA @Y17XANA 22250000
         AIF   (&TRACE(1) GT 0 AND &TRACE(1) LT 20).BADTRA     @Y17XANA 22300000
&TRACEN  SETA  &TRACE(1)         TRACE TABLE ENTRIES           @Y17XANA 22350000
         AGO   .SKPTRA                                                  22400000
.BADTRA  SPACE                                                          22450000
         MNOTE  4,'IHB303 INVALID OPERAND TRACE, 20 ASSUMED'   @Z30X8FJ 22500000
         SPACE 2                                                        22550000
&TRACEN  SETA  20                       TRACE=20  MIN VALUE    @Y17XANA 22600000
.SKPTRA  ANOP                                                           22650000
&IEDLTRA SETA  &TRACEN           SAVE TRACE OPERAND FOR TREXIT @Y17XANA 22700000
IEDRACE  DC    F'&TRACEN' .             TRACE=INTEGER          @Y17XANA 22750000
IEDREADY DC    A(IEDDELEM) .            ADDRESS OF FIRST OF CHAIN       22800000
*                                         OF ELEMENTS,PRIORITY ORDER    22850000
         AIF   ('&BUFFTR' EQ '').BUFDEF SET DEFAULT            @OY19405 22900082
         AIF   (T'&BUFFTR(1) NE 'N').BADBUF INVALID ENTRY      @OY19405 22902082
&BUFF    SETA  &BUFFTR(1)               SET UP SPECIFIED VAL   @OY19405 22904082
         AIF   (&BUFF LT 0).BADBUF               INVALID ENTRY @OY19405 22906082
         AIF   (&BUFF GT 200).SETNO     ENTRY OK WITH COMWRITE @OY19405 22908082
         AGO   .BUFFAOK                                        @OY19405 22910082
.SETNO   ANOP                                                  @OY19405 22910682
&BUFF    SETA  200                      SET TO 200             @OY19405 22912082
         MNOTE 4,'IED303 INVALID OPERAND BUFFTR, 200 ASSUMED'  @OY19405 22914082
.BUFFAOK ANOP                                                  @OY19405 22916082
         AIF   (N'&BUFFTR LT 2).BUFFOK  NO MORE PARAMETERS     @OY19405 22916982
         AIF   ('&BUFFTR(2)' EQ 'PAR').CKCON CHECK NEXT PARM   @OY19405 22917882
         AIF   ('&BUFFTR(2)' EQ 'FULL').SETFU SET FULL TRACE   @OY19405 22918782
         MNOTE 4,'IED303 INVALID OPERAND BUFFTR, PAR ASSUMED'  @OY19405 22919682
         AGO   .CKCON                   CHECK C OPERAND        @OY19405 22920582
.SETFU   ANOP                                                  @OY19405 22921482
&BUFF    SETA  &BUFF+16777216           SET FLAG FOR FULL BUFF @OY19405 22922382
.CKCON   ANOP                                                  @OY19405 22923282
         AIF   (N'&BUFFTR LT 3).BUFFOK  NO MORE PARAMETERS     @OY19405 22924182
         AIF   ('&BUFFTR(3)' NE 'U').SETCON TAKE DEFAULT       @OY19405 22925082
&BUFF    SETA  &BUFF+33554432           SET FLAG FOR UNCOND TR @OY19405 22925982
         AGO   .BUFFOK                                         @OY19405 22926882
.SETCON  ANOP                                                  @OY19405 22927782
         AIF   ('&BUFFTR(3)' EQ 'C').BUFFOK                    @OY19405 22928682
         MNOTE 4,'IED303 INVALID OPERAND BUFFTR, C ASSUMED'    @OY19405 22929582
         AGO   .BUFFOK                  CONTINUE               @OY19405 22932082
.BADBUF  MNOTE 4,'IED303 INVALID OPERAND BUFFTR, 0 ASSUMED'    @OY19405 22934082
.BUFDEF  ANOP                                                  @OY19405 22936082
&BUFF    SETA 0                         DEFAULT VALUE          @OY19405 22938082
.BUFFOK  ANOP                                                  @OY19405 22940082
IEDREADD DC    A(0)                     ADD. OF BUFF TRAC TAB  @OY19405 22942082
         DC    F'&BUFF' .               NO. ENTRIES ON  INTRO  @OY19405 22944082
IEDCKGET DC    A(0) .                   CHECKPOINT WORKAREA-GETMAIN     22950000
IEDOCGET DC    A(0) .                   OPERATOR CONTROL WORKAREA       23000000
&IEDLSCB SETA  84 .                     SIZE OF SCB WITHOUT SAVEAREA    23050000
         IEDQMASK &USEREG,1                                             23100000
         AIF   (&IEDQZA(24)).ERREG                                      23150000
         AIF   (&USEREG EQ 0).ZEREG                                     23200000
         AIF   ('&USEREG'(1,1) EQ 'X' OR &USEREG GT 10).ERREG           23250000
&IEDQZF  SETA  &USEREG                                                  23300000
         MVC   &IEDLSCB.(4*&IEDQZF,3),28(13) USEREG=INTEGER             23350000
         MVC   28(4*&IEDQZF,13),&IEDLSCB.(3)                            23400000
.* &IEDQZF IS GLOBAL, NUMBER WORDS TO BE ADDED TO SCB FOR SAVEAREA      23450000
         AGO   .SKIPREG                                                 23500000
.ZEREG   ANOP                                                           23550000
&IEDQZF  SETA  0                        ASSUME 0 DEFAULT VALUE          23600000
         NOPR  0 .                      USEREG=0                        23650000
         DC    4X'00' .                                                 23700000
         NOPR  0 .                                                      23750000
         DC    4X'00' .                                                 23800000
         AGO   .SKIPREG                                                 23850000
.ERREG   SPACE                                                          23900000
         MNOTE 4,'IHB303  INVALID OPERAND USEREG, 0 ASSUMED'            23950000
         SPACE 2                                                        24000000
         AGO   .ZEREG                                                   24050000
.SKIPREG ANOP                                                           24100000
&IEDLSCB SETA  &IEDLSCB+4*&IEDQZF                                       24150000
IEDPARM  DC    A(0,IEDQAVT,0) .         PARAMETER LIST                  24200000
         IEDQMASK &DTRACE(1),2                                 @Y17XANA 24250000
         AIF   (&IEDQZA(24)).DTRERR                                     24300000
         AIF   ('&DTRACE'(1,1) EQ 'X' OR &DTRACE(1) LT 0).DTRERR        24350000
&DTRACEN SETA  &DTRACE(1)                     DTRACE=INTEGER   @Y17XANA 24400000
         AGO   .DTROUT                                                  24450000
.DTRERR  SPACE                                                          24500000
         MNOTE 4,'IHB303  INVALID OPERAND DTRACE, 0 ASSUMED'            24550000
         SPACE 2                                                        24600000
&DTRACEN SETA  0                        DTRACE=0 DEFAULT VALUE @Y17XANA 24650000
.DTROUT  ANOP                                                           24700000
IEDDISTR DC    F'&DTRACEN' .            DTRACE=INTEGER         @Y17XANA 24750000
IEDRNMPT DC    A(IEDQTNT) .             TERMNAME TABLE POINTER          24800000
         DC    A(IEDQRDYA) .            USER EXIT ADDRESS IN READY      24850000
         DC    A(0) .                   LINE END BSC MSG SCAN           24900000
         DC    A(IEDDUMBR) .            LINE TRACE TABLE UPDATE         24950000
         DC    V(IEDQSBT)               OP CTL SET BIT ROUTINE @YM07020 25000000
         AIF (&IEDQRN(1) OR &OLTEST NE 0).MVBFR                @Y17XAXF 25050000
         DC    A(0)                     RESERVED               @YM07020 25100000
         AGO   .SPARM                                          @Y17XAXF 25150000
.MVBFR   DC    V(IEDMVBFR) .                                   @Y17XAXF 25200000
.SPARM   ANOP .                                                @Y17XAXF 25250000
IEDSPLPT DC    A(0) .                   START PARAMETER LIST POINTER    25300000
         IEDQMASK &CIB,1                                                25350000
         AIF   (&IEDQZA(24)).CIBERR                                     25400000
         AIF   ('&CIB'(1,1) EQ 'X').CIBERR                              25450000
         AIF   ('&CIB' EQ '0').CIBERR                            S21903 25500000
         DC    AL1(&CIB) .              CIB=INTEGER                     25550000
         AGO   .CIBOUT                                                  25600000
.CIBERR  SPACE                                                          25650000
         MNOTE 4,'IHB303  INVALID OPERAND CIB, 2 ASSUMED'               25700000
         SPACE 2                                                        25750000
         DC    AL1(2) .                 CIB=2 DEFAULT VALUE             25800000
.CIBOUT  ANOP                                                           25850000
         IEDQMASK &CKREQS,1                                             25900000
         AIF   (&IEDQZA(24)).BADREQ                                     25950000
         AIF   ('&CKREQS'(1,1) EQ 'X' OR &CKREQS LT 0).BADREQ           26000000
         DC    AL1(&CKREQS) .           CKREQS=INTEGER                  26050000
         AGO   .SKPREQ                                                  26100000
.BADREQ  SPACE                                                          26150000
         MNOTE 4,'IHB303  INVALID OPERAND CKREQS, 0 ASSUMED'            26200000
         SPACE 2                                                        26250000
         DC    AL1(0) .                 CKREQS=0 DEFAULT VALUE          26300000
.SKPREQ  ANOP                                                           26350000
         IEDQMASK &LNUNITS,2                                            26400000
         AIF   (&IEDQZA(24)).LINERR                                     26450000
         AIF   ('&LNUNITS'(1,1) EQ 'X' OR &LNUNITS LT 0).LINERR         26500000
         DC    AL2(&LNUNITS) .          LNUNITS=INTEGER                 26550000
         AGO   .LINOUT                                                  26600000
.LINERR  SPACE                                                          26650000
         MNOTE 4,'IHB303  INVALID OPERAND LNUNITS, 0 ASSUMED'           26700000
         SPACE 2                                                        26750000
         DC    AL2(0) .                 LNUNITS=0 DEFAULT VALUE         26800000
.LINOUT  ANOP                                                           26850000
IEDAS    DC    A(0) .                   RELEASE                         26900000
         DC    4F'0' .                  TCB ADDRS OF ATTACHED TASKS     26950000
         DC    X'40',AL3(0) .           COMMON WRITE FE TASK ECB        27000000
         DC    3F'0' .                  EVENT CONTROL BLOCKS            27050000
IEDOSECB DC    F'0' .                   DISPATCHER'S ECB                27100000
IEDPCBPT DC    A(0) .                   FIRST PROCESS CONTROL BLOCK     27150000
IEDOPTPT DC    F'0' .                   ORGED BY OPTION,OPTION TAB ADDR 27200000
         AIF   (NOT &IEDQRN(2)).IOGEN                            S22024 27250000
IEDKA02  DC    A(0)                                              S22024 27300000
         AGO   .SKIOGN                                           S22024 27350000
.IOGEN   ANOP                                                    S22024 27400000
IEDKA02  DC    V(IEDQKA02) .            I/O GENERATOR                   27450000
.SKIOGN  ANOP                                                    S22024 27500000
&C       SETA  0                                                SA65392 27550000
.THRESH1 ANOP                                                   SA65392 27600000
&C       SETA  &C+1                                             SA65392 27650000
         AIF   (T'&THRESH(&C) NE 'N').THRESH2                   SA65392 27700000
         AIF   (&THRESH(&C) GT 0 AND &THRESH(&C) LT 256).THRESH3        27750000
.THRESH2 MNOTE 12,'*** IHB002 INVALID THRESH OPERAND SPECIFIED - &THRESC27800000
               H(&C)'                                           SA65392 27850000
         AGO   .THRESH6                                         SA65392 27900000
.THRESH3 AIF   (&C NE 4).THRESH1                                SA65392 27950000
&C       SETA  &THRESH(1)                                       SA65392 28000000
&D       SETA  &THRESH(2)                                       SA65392 28050000
&E       SETA  &THRESH(3)                                       SA65392 28100000
&F       SETA  &THRESH(4)                                       SA65392 28150000
         AIF   (&D LE &C).THRESH4                               SA65392 28200000
&D       SETA  &C                                               SA65392 28250000
.THRESH4 AIF   (&E LE &C).THRESH5                               SA65392 28300000
&E       SETA  &C                                               SA65392 28350000
.THRESH5 AIF   (&F LE &C).THRESH6                               SA65392 28400000
&F       SETA  &C                                               SA65392 28450000
.THRESH6 ANOP                                                   SA65392 28500000
         DC    AL1(&C),AL1(&D),AL1(&E),AL1(&F)                  SA65392 28550000
.SKIPTR  ANOP                                                           28600000
         IEDQMASK &CROSSRF,2                                            28650000
         AIF   (&IEDQZA(24)).CROSSER                                    28700000
         AIF   ('&CROSSRF'(1,1) EQ 'X').CROSSER                         28750000
IEDCRSRF DC    F'&CROSSRF' .            CROSSRF=INTEGER                 28800000
         AGO   .CROSSOT                                                 28850000
.CROSSER SPACE                                                          28900000
         MNOTE 4,'IHB303  INVALID OPERAND CROSSRF, 0 ASSUMED'           28950000
         SPACE 2                                                        29000000
IEDCRSRF DC    F'0' .                   CROSSRF=0 DEFAULT VALUE         29050000
.CROSSOT ANOP                                                           29100000
         DC    A(0) .                   ADDR OF COMMUNICATIONS PARM     29150000
IEDUI    DC    V(IEDQUI) .              USER INTERFACE ROUTINE   S22025 29200000
         DC    A(0) .                   UNASSIGNED               Y01004 29250000
         IEDQMASK &OLTEST,1                                             29300000
         AIF   (&IEDQZA(24)).EROLT                                      29350000
         AIF   ('&OLTEST'(1,1) EQ 'X' OR &OLTEST LT 0).EROLT            29400000
         AIF   (&OLTEST LT 56 AND &OLTEST GT 0).EROLT          @Y17XAXU 29450000
         DC    AL1(&OLTEST) .           OLTEST=INTEGER                  29500000
         AGO   .SKPOLT                                                  29550000
.EROLT   SPACE                                                          29600000
         MNOTE 4,'IHB303  INVALID OPERAND OLTEST,56 ASSUMED'   @Y17XAUU 29650000
         SPACE 2                                                        29700000
         DC    AL1(56)                  OLTEST=56 DEFAULT      @Y17XAUU 29750000
.SKPOLT  ANOP                                                           29800000
         DC    VL3(IEDQHG02) .          REMOVE TIME DELAY ELEMENT       29850000
IEDAL    DC    V(IEDQAL) .              ADDRESS COMPUTATION             29900000
IEDGD    DC    V(IEDQGD) .              BUFFER ASSOCIATION     @G36XRXF 29950000
IEDA3    DC    A(0) .                   TRANSPARENCY CCW BUILDER (GT)   30000000
IEDAX    DC    V(IEDQAX) .              SCAN                            30050000
IEDEA    DC    A(0) .                   DISPATCHER                      30100000
IEDDISP  EQU   *                                                        30150000
         DC    A(0) IGG019R3            RECEIVE SCHEDULER               30200000
&A       SETA  0                                               @YM08551 30250000
         AIF   ('&COMMBUF' EQ '').NCMBUF                         S22027 30300000
         AIF   (N'&COMMBUF EQ 3).CMBFOK                          S22027 30350000
.CMBERR  ANOP                                                  @Z30X8FG 30400000
         MNOTE 12,'IHB300 COMMBUF OPERAND INVALID AS SPECIFIED'         30450000
.*                                                             @Z30X8FG 30500000
&IEDQZA(44) SETB 0                                               S22027 30550000
         AGO   .NCMBUF                                           S22027 30600000
.CMBFOK  ANOP                                                    S22027 30650000
&IEDQZA(44) SETB 1                                               S22027 30700000
         AIF   (K'&COMMBUF(1) GT 8 OR K'&COMMBUF(2) GT 8 OR K'&COMMBUF(X30750000
               3) GT 8).CMBERR                                   S22027 30800000
.LOOP    ANOP                                                    S22027 30850000
         AIF   (&A EQ 3).CKCMBUF                                 S22027 30900000
&A       SETA  &A+1                                              S22027 30950000
&IEDCBUF(&A) SETC '&COMMBUF(&A)'                                 S22027 31000000
         IEDQMASK &IEDCBUF(&A),2                                 S22027 31050000
         AIF   (NOT &IEDQZA(24)).LOOP                            S22027 31100000
         MNOTE 12,'IHB300 COMMBUF OPERAND INVALID AS SPECIFIED'         31150000
.*                                                             @Z30X8FG 31200000
&IEDQZA(44) SETB 0                                               S22027 31250000
         AIF   (&A LT 3).LOOP                                    S22027 31300000
.CKCMBUF AIF   (NOT &IEDQZA(44)).NCMBUF                          S22027 31350000
         AIF   (&COMMBUF(1) EQ 0 OR &COMMBUF(2) EQ 0 OR &COMMBUF(3) EQ X31400000
               0).NCMBUF1                                        S22027 31450000
&A       SETA  &IEDCBUF(3)                                       S22027 31500000
&B       SETA  &A/4                                              S22027 31550000
&B       SETA  &B*4                                              S22027 31600000
         AIF   (&B NE &A).NCMBUF1                                S22027 31650000
&IEDLSB(13) SETB 1                                               S22027 31700000
         AGO   .NCMBUF                                           S22027 31750000
.NCMBUF1 ANOP                                                    S22027 31800000
&IEDQZA(44) SETB 0                                               S22027 31850000
         MNOTE 12,'IHB300 COMMBUF OPERAND INVALID AS SPECIFIED'         31900000
.*                                                             @Z30X8FG 31950000
.NCMBUF  ANOP                                                    S22027 32000000
         AIF   ('&APDUMP' EQ 'YES').APDMP                      @ZA07083 32050000
         AIF   ('&APDUMP' EQ 'NO').NODMP                       @ZA07083 32100000
         MNOTE 4,'IHB303 INVALID OPERAND APDUMP,NO ASSUMED'    @ZA07083 32150000
         AGO   .NODMP                                          @ZA07083 32200000
.APDMP   ANOP                                                  @ZA07083 32250000
&IEDLSB(17) SETB 1                                             @ZA07083 32300000
.NODMP   ANOP                                                  @ZA07083 32350000
         DC    B'00&IEDLSB(17)&IEDLSB(13)&IEDLSB(11)&IEDLSB(12)&IEDLSB(X32400000
               9)&IEDLSB(8)' .                                 @ZA07083 32450000
         AIF   (&IEDLSB(8)).XXDIAL                                      32500000
*                                         DIAL                          32550000
         AGO   .XXSKDI                                                  32600000
.XXDIAL  ANOP                                                           32650000
*                                         NODIAL                        32700000
.XXSKDI  AIF   (&IEDLSB(9)).XX27                                        32750000
*                                         2741                          32800000
         AGO   .XXSK27                                                  32850000
.XX27    ANOP                                                           32900000
*                                         NO2741                        32950000
.XXSK27  AIF   (&IEDLSB(10)).XXTI                                       33000000
*                                         TIMER                         33050000
         AGO   .XXSKTI                                                  33100000
.XXTI    ANOP                                                           33150000
*                                         NOTIMER                       33200000
.XXSKTI  ANOP                                                           33250000
         AIF   (&IEDLSB(11) OR &IEDLSB(12)).XXCONC               S22026 33300000
*                                         NOCONC                 S22026 33350000
         AGO   .XXCONCX                                          S22026 33400000
.XXCONC  AIF   (&IEDLSB(11)).XXCONCM                             S22026 33450000
*                                         CONCO (OVERIDES DIAL   S22026 33500000
*                                         AND 2741 IF SPECIFIED) S22026 33550000
         AGO   .XXCONCX                                          S22026 33600000
.XXCONCM ANOP                                                    S22026 33650000
*                                         CONC                   S22026 33700000
.XXCONCX ANOP                                                    S22026 33750000
         AIF   (NOT &IEDQZA(44)).NOCBCMT                         S22027 33800000
*                                  COMMBUF KEYWORD SPECIFIED     S22027 33850000
.NOCBCMT ANOP                                                    S22027 33900000
         DC    AL3(0) .                 SEND SCHEDULER                  33950000
*                     IGG019R4          HAS TSO,DIAL,2741 SUPPORT       34000000
*                     IGG019Q6          NO TSO, NO DIAL, NO 2741 S21903 34050000
*                     IGG019Q7          NO TSO, NO 2741, BUT HAS DIAL   34100000
*                                       NONE OF ABOVE IF CONC    S22026 34150000
*                                         ONLY (CONCO) SPECIFIED S22026 34200000
.*                                                                      34250000
         DS    0A .                     AFTER OPEN, GET SCHED  @G36XRFF 34300000
         AIF   ('&APWAS' EQ '184' OR '&APWAS' EQ '440' OR '&APWAS' EQ  *34350000
               '952' OR '&APWAS' EQ '1976' OR '&APWAS' EQ '4024' OR    *34400000
               ('&APWAS' GE '4025' AND '&APWAS' LE '32695')).GDAPWA     34450000
*                                                              @OZ24197 34500000
         MNOTE 4,'IHB303 INVALID OPERAND APWAS, 4024 ASSUMED'  @G36XRFF 34550000
         SPACE 2                                               @G36XRFF 34600000
         DC    AL2(4024) .              APWAS=4024 DEFAULT VAL @G36XRFF 34650000
         AGO   .SKPAPWA                                        @G36XRFF 34700000
.GDAPWA  ANOP                                                  @G36XRFF 34750000
         DC    AL2(&APWAS) .            APPLICATION PROGRAM    @G36XRFF 34800000
.*                                      WORKAREA SIZE          @G36XRFF 34850000
.SKPAPWA ANOP                                                  @G36XRFF 34900000
         AIF   ('&AUTHA' EQ 'NO').NOAUTH                       @G36XRFF 34950000
         AIF   ('&AUTHA' EQ 'YES').YESAUTH                     @G36XRFF 35000000
         SPACE                                                          35050000
         MNOTE 4,'IHB303 INVALID OPERAND AUTHA, YES ASSUMED'   @G36XRFF 35100000
         SPACE                                                          35150000
.YESAUTH DC   X'8000'  .               AUTHORIZED APP. PROGRAMS@G36XRFF 35200000
         AGO   .SKPAUTH                                        @G36XRFF 35250000
.NOAUTH  DC    AL2(0) .                 UNAUTHORIZED APP. PGM  @G36XRFF 35300000
.SKPAUTH ANOP                                                  @G36XRFF 35350000
         DC    A(0) .                   PUT SCHEDULER                   35400000
         DC    A(0) .                   RESERVED                 Y02027 35450000
IEDBZ    DC    A(0) .                   LOG SCHEDULER                   35500000
IEDR1    DC    A(0) .                   DIAL SCHEDULER                  35550000
IEDHB    DC    A(0) .                   BUFFERED SCHEDULER              35600000
         DC    A(0) .                   RETRIEVE SCHEDULER              35650000
         DC    A(0) .                   LOCAL SCHEDULER                 35700000
IEDCSCH  DC    A(0) .                   CONC SEND SCHEDULER      S22026 35750000
         AIF   (&IEDQRN(1)).GENSCHD .   GENERATE SCHD ADDRESS    X03039 35800000
         DC    A(0) .                                            X03039 35850000
         DC    A(0) .                                            X03039 35900000
         AGO   .NOSCHD .                DONT GEN SCHD ADDRESSES  X03039 35950000
.GENSCHD ANOP                                                           36000000
         DC    V(IEDIAQ) .              3705 RESOURCES SEND    @Y17XANU 36050000
*                                       SCHEDULER              @Y17XANU 36100000
         DC    V(IEDIAM) .              3705 RESOURCES RECEIVE @Y17XANU 36150000
*                                       SCHEDULER              @Y17XANU 36200000
.NOSCHD  ANOP                                                           36250000
         AIF   (NOT &IEDQZA(44)).XXCMBF                          S22027 36300000
IEDCMBSS DC    H'0' .                   COMMBUF SEND SCHEDULER   S22027 36350000
*                                       AFTER OPEN               S22027 36400000
&A       SETA  &IEDCBUF(3)                                       S22027 36450000
         DC    AL2(&A) .                SIZE OF CB DATA AREA     S22027 36500000
         AGO   .XXCMBF1                                          S22027 36550000
.XXCMBF  ANOP                                                    S22027 36600000
IEDCMBSS DC    A(0) .                   COMMBUF SEND SCHEDULER   S22027 36650000
.XXCMBF1 ANOP                                                    S22027 36700000
         DC    A(0) .                                            S22024 36750000
         DC    B'&IEDQRN(1).&IEDQRN(3).&IEDQRN(4).00000' . SAVT@YM07790 36800000
*                                                        FLAGS @YM07790 36850000
         DC    AL3(IEDNSAVT)                                            36900000
&IEDLSEC SETC  '&SYSECT'                                         S22024 36950000
IEDNSAVT CSECT .                                                S22024  37000000
         AIF   ('&VM' EQ 'NO').NOVM                              Y05331 37050000
         AIF   ('&VM' EQ 'YES').YESVM                            Y05331 37100000
         AIF   ('&VM' EQ 'PROMPT').MAYBVM                        Y05331 37150000
         SPACE                                                          37200000
         MNOTE 4,'IHB303 INVALID OPERAND VM, NO ASSUMED'                37250000
         SPACE 2                                                        37300000
.NOVM    ANOP                                                    Y05331 37350000
&IEDLSB(15) SETB 0                                               Y05331 37400000
&IEDLSB(16) SETB 0                                               Y05331 37450000
         AGO   .ENDVM                                            Y05331 37500000
.YESVM   ANOP                                                    Y05331 37550000
&IEDLSB(15) SETB 1                                               Y05331 37600000
&IEDLSB(16) SETB 0                                               Y05331 37650000
         AGO   .ENDVM                                            Y05331 37700000
.MAYBVM  ANOP                                                    Y05331 37750000
&IEDLSB(15) SETB 0                                               Y05331 37800000
&IEDLSB(16) SETB 1                                               Y05331 37850000
.ENDVM   ANOP                                                    Y05331 37900000
         DC    B'&IEDLSB(15).&IEDLSB(16).000000' .               Y05331 37950000
         DC    AL3(0) .                 VIRTUAL DIAGNOSE ROUTINE Y05331 38000000
         AIF   (NOT &IEDQRN(1)).SKP3705                          Y05331 38050000
         DC    A(0) .                   PLCB POOL ADDRESS        X03039 38100000
         DC    A(0) .                   NEXT FREE PLCB           X03039 38150000
         DC    H'0' .                   PLCB IN-USE COUNT      @Y17XANU 38200000
         DC    H'0' .                   PLCB HI WATER COUNT    @Y17XANU 38250000
         DC    V(IEDIAP01) .            ADDRESS OF PLCB        @Y17XANU 38300000
*                                       ALLOCATION ROUTINE     @Y17XANU 38350000
         DC    A(0) .                   ANCHOR FOR PLCB        @Y17XANU 38400000
*                                       REQUEST WAIT CHAIN     @Y17XANU 38450000
         DC    H'0' .                   PLCB WAIT COUNT        @Y17XANU 38500000
         DC    H'0' .                   PLCB HI WATER WAIT CNT @Y17XANU 38550000
         DC    V(IEDIAP7S) .            ADDRESS OF STCB FOR    @Y17XANU 38600000
*                                       PLCB DEALLOCATION      @Y17XANU 38650000
         DC    V(IEDIAP07) .            BRANCH ENTRY ADDRESS   @Y17XANU 38700000
*                                       OF PLCB DEALLOCTION    @Y17XANU 38750000
*                                       ROUTINE                @Y17XANU 38800000
         DC    A(0) .                   NEXT FREE SIB ADDRESS  @Y17XANU 38850000
         DC    H'0' .                   SIB IN USE COUNT       @Y17XANU 38900000
         DC    H'0' .                   COUNT OF SIB REQUESTS  @Y17XANU 38950000
*                                       THAT FAILED            @Y17XANU 39000000
         DC    V(IEDIAP02) .            ADDRESS OF SIB         @Y17XANU 39050000
*                                       ALLOCATION ROUTINE     @Y17XANU 39100000
         DC    V(IEDIAP08) .            ADDRESS OF SIB         @Y17XANU 39150000
*                                       DEALLOCATION ROUTINE   @Y17XANU 39200000
         DC    A(0) .                   3705 FLDH QCB          @Y17XANU 39250000
         DC    V(IEDNKA) .              CONTROL NIR GENR QCB   @Y17XANU 39300000
*                                       ADDRESS                @Y17XANU 39350000
         DC    V(IEDNGD) .              DATA NIR GENR QCB ADDR @Y17XANU 39400000
         DC    A(0) .                   3705 TRACE ROUTINE     @Y17XANU 39450000
*                                       ADDRESS                @Y17XANU 39500000
         DC    F'&TR' .                 ADDRESS OF PIU TRACE   @Y17XANU 39550000
*                                       TABLE                  @Y17XANU 39600000
         DC    V(IEDNCU) .              3705 CLEANUP ROUTINE   @YM06020 39650000
*                                       ADDRESS                @Y17XANU 39700000
         DC    A(0) .                   NAT ADDRESS            @Y17XANU 39750000
         DC    A(0) .                   SAT ADDRESS            @Y17XANU 39800000
         DC    A(0) .                   MODE BYTE TABLE        @Y17XANU 39850000
*                                       ADDRESS                @Y17XANU 39900000
IEDLUQCB DC    A(0),A(0),V(IEDLUS) .    LUS QCB                @Y17XAXF 39950000
         ENTRY IEDLUQCB                                        @Y17XAXF 40000000
         DC    A(0) .                   OPERATOR SERVICES      @Y17XANU 40050000
*                                       REQUEST CHAIN          @Y17XANU 40100000
         DC    A(0) .                   SSCP LCB               @Y17XANU 40150000
         DC    A(0),A(0),V(IEDSCPSS) .  SSCP QCB               @Y17XANU 40200000
         DC    V(IEDXFMO) .             OUTBOUND               @YM03681 40250000
*                                       XFORMER QCB ADDRESS    @YM03681 40300000
         DC    2F'0' .                  RESERVED               @YM03681 40350000
         DC    V(IEDXFMI) .             INBOUND                @YM03681 40400000
*                                       XFORMER ENTRY ADDRESS  @YM03681 40450000
         DC    2F'0' .                  RESERVED               @YM03681 40500000
         DC    V(IEDPCIN) .             PATH CONTROL           @YM03681 40550000
*                                       INBOUND QCB ADDRESS    @YM03681 40600000
         DC    2F'0' .                  RESERVED               @YM03681 40650000
         DC    A(0) .                   REQ BUILDER RTN        @YM08099 40700000
         DC    V(IEDMVBFR) .            MOVE DATA RTN          @Y17XANU 40750000
         DC    V(IEDXTREQ) .            CROSS TASK REQ HDLR    @Y17XANU 40800000
         DC    V(IEDSCLU) .             SC ENTRY ADDRESS       @Y17XANU 40850000
         DC    V(IEDSCPRQ) .            SSCP REQ HDLR ADDRESS  @Y17XANU 40900000
         DC    V(IEDSCPRP) .            SSCP RESP HDLR ADDRESS @Y17XANU 40950000
         DC    V(IEDCSCIN) .            FID1 COM SC INBOUND    @Y17XANU 41000000
         AIF   (&IEDQRN(3)).NOSAI       DEFINE VCON FOR SAI    @YM07790 41050000
         DC    V(IEDSAI) .              FID0 SA INBOUND        @Y17XANU 41100000
         DC    V(IEDSAC) .              COMMAND PROCESSOR      @Y17XANU 41150000
         DC    V(IEDSARI) .             COMMAND PROCESSOR      @Y17XANU 41200000
         AGO   .ENDSAI                                                  41250000
.NOSAI   ANOP                                                           41300000
         DC    A(0) .                   FID0 SA INBOUND        @Y17XANU 41350000
         DC    A(0) .                   COMMAND PROCESSOR      @Y17XANU 41400000
         DC    A(0) .                   COMMAND PROCESSOR      @Y17XANU 41450000
.ENDSAI  ANOP                                                           41500000
         DC    V(IEDSAO) .              COMMAND ID PROC        @Y17XANU 41550000
         DC    V(IEDDFOUT) .            DFC OUTBOUND           @Y17XANU 41600000
         DC    V(IEDRQIN) .             INBOUND REQ PROCESSOR  @Y17XANU 41650000
         DC    V(IEDQRS) .              RESPONSE GENERATOR     @Y17XANU 41700000
*                                       ADDRESS                @Y17XANU 41750000
         DC    A(IEDSCPMH)              SSCP MH ADDRESS        @YM03679 41800082
         DC    A(IEDQMHTB) .            MH TABLE ADDRESS       @YM04651 41850000
         DC    H'0' .                   INDEX OF LAST NAT ENTR @Y17XANU 41900000
         DC    H'0' .                   CONSTANT TO CALCULATE  @Y17XANU 41950000
*                                       NAT ENTRY FROM MH INDX @Y17XANU 42000000
         DC    V(IEDNSL) .              3705 STOPLINE          @YM04612 42050000
*                                       QCB ADDRESS            @Y17XANU 42100000
         DC    A(0) .                   MANUAL DIAL ROUTINE    @Y17XANU 42150000
*                                       ADDRESS                @Y17XANU 42200000
         DC    A(0) .                   APPL REQUEST QUEUE     @Y17XANU 42250000
         DC    H'0' .                   APPL REQUEST TAG       @Y17XANU 42300000
         DC    H'0' .                   SSCP TTCIN             @Y17XANU 42350000
*                                       /TCAM PU TTCIN         @Y17XANU 42400000
         AIF   ('&BRACKET' EQ 'YES').BRKTYES  BRACKET=YES      @Y17XANU 42450000
         AIF   ('&BRACKET' EQ 'NO').BRKTNO    BRACKET=NO       @Y17XANU 42500000
         SPACE 1                                               @Y17XANU 42550000
         MNOTE 4,'IHB303 INVALID OPERAND BRACKET, NO ASSUMED'  @Y17XANU 42600000
         SPACE 1                                               @Y17XANU 42650000
.BRKTNO  ANOP                                                  @Y17XANU 42700000
         DC    F'0' .                   BRACKET STATE MANAGER  @Y17XANU 42750000
*                                       ADDR(ZERO=NO LOADED)   @Y17XANU 42800000
         AGO   .BRKTSKP                                        @Y17XANU 42850000
.BRKTYES ANOP                                                  @Y17XANU 42900000
.*             ANY NON ZERO VALUE IN THIS DC WILL CAUSE IEDQOA @Y17XANU 42950000
.*             TO LOAD THE  RACKET STATE MANAGER MODULE AND    @Y17XANU 43000000
.*             PUT ITS ADDRESS HERE                            @Y17XANU 43050000
         DC    F'1' .                   BRACKET STATE MANAGER  @Y17XANU 43100000
*                                       ADDR(ZERO=NOT LOADED   @Y17XANU 43150000
.BRKTSKP ANOP                                                  @Y17XANU 43200000
         AIF   (T'&SIBCNT NE 'N').BADSIB  SIB COUNT INVALID    @Y17XANU 43250000
         AIF   (&SIBCNT LT 0 OR &SIBCNT GT 65535).BADSIB       @Y17XANU 43300000
         DC    H'&SIBCNT' .             NUMBER OF SIBS         @Y17XANU 43350000
         AGO   .SIBCOK                                         @Y17XANU 43400000
.BADSIB  ANOP                                                           43450000
         MNOTE 4,'IHB303 INVALID OPERAND SIBCNT, DEFAULT ASSUMED'       43500082
.*                                                             @OZ53057 43550082
IEDSSIBC DC    AL2(0) .                 SIB COUNT              @OZ53057 43600082
.SIBCOK  ANOP                                                  @Y17XANU 43650000
         AIF   (T'&MAXSUBA NE 'N').BDSMAX MAXSUBA BAD          @Y17XANU 43700000
         AIF   (&MAXSUBA LT 1 OR &MAXSUBA GT 255).BDSMAX       @Y17XANU 43750000
         DC    AL1(&MAXSUBA) .          MAX SUBAREA VALUE      @Y17XANU 43800000
         AGO   .MAXOK                                          @Y17XANU 43850000
.BDSMAX  ANOP                                                  @Y17XANU 43900000
         MNOTE 4,'IHB303 INVALID OPERAND MAXSUBA, 0 ASSUMED'   @Y17XANU 43950000
         DC    XL1'0' .                 MAXSUBAREA VALUE       @Y17XANU 44000000
.MAXOK   ANOP                                                  @Y17XANU 44050000
         AIF   (T'&SUBAREA NE 'N').BADSUBV  SUBAREA VALUE BAD  @Y17XANU 44100000
         AIF   (&SUBAREA LT 1 OR &SUBAREA GT 255).BADSUBV      @Y17XANU 44150000
         DC    AL1(&SUBAREA) .          SUBAREA VALUE          @Y17XANU 44200000
         AGO   .SUBVOK                                         @Y17XANU 44250000
.BADSUBV ANOP                                                  @Y17XANU 44300000
         MNOTE 4,'IHB303 INVALID OPERAND SUBAREA, 0 ASSUMED'   @Y17XANU 44350000
         DC    XL1'0' .                 SUBAREA VALUE          @Y17XANU 44400000
.SUBVOK  ANOP                                                  @Y17XANU 44450000
         DC    V(IEDIAP03) .            NETWORK ADDR TO TTCIN  @Y17XANU 44500000
*                                       CONVERSION RTN ADDRESS @Y17XANU 44550000
         DC    V(IEDIAP04) .            TTCIN TO NETWORK ADDR  @Y17XANU 44600000
*                                       CONVERSION RTN ADDRESS @Y17XANU 44650000
         DC    V(IEDIAP05) .            INDEX TO TTE/MH ENTRY  @Y17XANU 44700000
*                                       CONVERSION RTN ADDRESS @Y17XANU 44750000
         DC    V(IEDIAP06) .            SA LCB FETCH ROUTINE   @Y17XANU 44800000
         DC    H'0' .                   SIB POOL UTIL. HI-WATER         44850000
*                                       COUNT                  @Y17XANU 44900000
         DC    H'0' .                   TNT INDEX OF FIRST     @Y17XANU 44950000
*                                       NAT ENTRY              @Y17XANU 45000000
         DC    H'0' .                   TTCIN OF FIRST MH      @Y17XANU 45050000
*                                       ENTRY                  @Y17XANU 45100000
         DS    0H .                     NETWORK ADDR SA MASK   @Y17XANU 45150000
         DC    XL1'0' .                 SUBAREA MASK           @Y17XANU 45200000
         DC    XL1'0' .                 BYTE OF ZEROS          @Y17XANU 45250000
         DC    XL1'0' .                 SUBAREA VALUE LENGTH   @Y17XANU 45300000
         DC    XL1'0' .                 RESERVED               @YM02919 45350000
         DC    H'0' .                  (PLCB,SAT,SIB,RVT, AND  @YM02919 45400000
*                                       NAT POOL SIZE)/8       @YM02919 45450000
         DC    V(IEDDVAS) .             DEV ASSOCIATION RTN    @Y17XANU 45500000
IEDID    DC    A(0) . IEDNID            BSC ID VERFICATION RTN @YM05633 45550000
         DS    0F .                     ACT/DEACT REDRIVE ELEM @YM03726 45600000
         DC    X'00' .                  KEY FIELD              @YM03697 45650000
         DC    AL3(IEDOPCOB) .          QCB ADDRESS FIELD      @YM03697 45700000
         DC    X'00' .                  PRIORITY FIELD         @YM03697 45750000
         DC    XL7'00' .                RESERVED               @YM03697 45800000
         DC    X'0A' .                  FLAG FIELD             @YM03697 45850000
         DC    AL3(0) .                 RESERVED               @Y17XAXF 45900000
IEDNCKPT DC    X'02',AL3(IEDDELEM)      3705 CKPOINT QCB       @Y17XAXF 45950000
         DC    A(0) .                    *                     @Y17XAXF 46000000
         DC    A(IEDNCKPT)               *                     @Y17XAXF 46050000
         DC    V(IEDBITN) .             BIND IMAGE TABLE ADDR  @Y17XAXF 46100000
         DC    A(0)                     LAST FREE PLCB         @OY19488 46120082
.SKP3705 ANOP                                                  @Y17XANU 46150000
         SPACE 1                                               @Y17XANU 46200000
&IEDLSEC CSECT                                                          46250000
         AIF   ( T'&PLCBNO NE 'N' ).BDPLCB                       S22024 46300000
         DC    H'&PLCBNO' .             NUMBER OF PLCBS          S22024 46350000
         AGO   .GABND                                            S22024 46400000
.BDPLCB  SPACE 1 .                                               S22024 46450000
         MNOTE 4,'IHB303 INVALID OPERAND PLCBNO,DEFAULT ASSUMED' X03039 46500000
         SPACE 2                                               @ZA05019 46550000
         AGO   .NOPLCB                                           S22024 46600000
.NORN    DC    A(0) .                   SECONDARY AVT POINTER    S22024 46650000
.NOPLCB  DC    H'0' .                   RESERVED                 S22024 46700000
.GABND   ANOP                                                    S22024 46750000
IEDABEND BALR  1,0 .                    ESTABLISH BASE REG              46800000
         USING *,1 .                      FOR ABEND S045                46850000
         B     IEDSVC13 .               GO DO ABEND, SYSTEM 045         46900000
         DC    F'0' .                   DUMMY LINE I/O ECB              46950000
IEDA3TL  DC    A(0) .                   IEDQA3, TRANSLATE LIST          47000000
         IEDQMASK &WTTONE,2                                             47050000
         AIF   (&IEDQZA(24)).BADTONE                                    47100000
         AIF   ('&WTTONE'(1,1) EQ 'X').BADTONE                          47150000
         AIF   (&WTTONE GT 450).BADTONE                                 47200000
         AIF   (&WTTONE EQ 0).ZEROTON                                   47250000
&IEDLTON SETA  &WTTONE                                                  47300000
         DC    A(IEDTON) .              ADDR OF WORLD TRADE TONE CHARS  47350000
         AGO   .GOODTON                                                 47400000
.BADTONE SPACE                                                          47450000
         MNOTE 4,'IHB303  INVALID OPERAND WTTONE, 0 ASSUMED'            47500000
         SPACE 2                                                        47550000
.ZEROTON ANOP                                                           47600000
&IEDLTON SETA  0                                                        47650000
         DC    A(0) .                   WTTONE=0                        47700000
.GOODTON ANOP                                                           47750000
         DC    A(0) IEDQNX              OPERATOR AWARENESS MSG ROUTER   47800000
         DC    A(0) IGG019Q0            I/O TRACE TABLE HANDLER         47850000
         DC    A(0) IEDQHI              SYSTEM DELAY SUBTASK QCB ADDR   47900000
         AIF   ( &IEDQRN(2) ).NOHK .                             S22024 47950000
         DC    V(IEDQHK) .              STOPLINE SUBTASK QCB ADDR       48000000
         AGO   .NOHK1 .                                          S22024 48050000
.NOHK    ANOP                                                    S22024 48100000
         DC    A(0) .                   HK UNUSED IN VTAM ONLY @Z30X8FG 48150000
.NOHK1   ANOP .                                                  S22024 48200000
         DC    X'20',AL3(IEDCPRMB),X'F0',AL3(0),A(IEDCKELE,IEDCKPTB)    48250000
*                                         CKPT ELE FROM TIME Q          48300000
IEDCKELE DC    X'70',AL3(IEDCKPTB),X'EC',AL3(0) CKPT TIME DELAY ELE     48350000
         DC    AL1(&IEDLSCB) .          SCB SIZE INCLUDING SAVEAREA     48400000
         DC    AL3(IEDCKPTB) .          QCB TO RECEIVE ELE WHEN         48450000
*                                         INTERVAL IS UP                48500000
         AIF   ('&STARTUP' EQ '').NOSN                         @OS77945 48550000
&IEDLSA  SETA  1                                               @OS77945 48600000
.SNLOOP  AIF   (K'&STARTUP LT &IEDLSA).NOSN                    @OS77945 48650000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'N').GOSN             @OS77945 48700000
&IEDLSA  SETA  &IEDLSA+1                                       @OS77945 48750000
         AGO   .SNLOOP                                         @OS77945 48800000
.GOSN    ANOP                                                  @OS77945 48850000
&IEDLSB(18) SETB 1                                             @OS77945 48900000
.NOSN    DC    B'&IEDLSB(18).0000000'                          @OS77945 48950000
         IEDQMASK &CPRCDS,1                                             49000000
         AIF   (&IEDQZA(24)).BADCPR                                     49050000
         AIF   ('&CPRCDS'(1,1) EQ 'X').BADCPR                           49100000
         AIF   (&CPRCDS LT 2 OR &CPRCDS GT 75).BADCPR                   49150000
         DC    AL1(&CPRCDS) .           CPRCDS=INTEGER                  49200000
         AGO   .SKIPCPR                                                 49250000
.BADCPR  SPACE                                                          49300000
         MNOTE 4,'IHB303  INVALID OPERAND CPRCDS, 2 ASSUMED'            49350000
         SPACE 2                                                        49400000
         DC    AL1(2) .                 CPRCDS=2 DEFAULT VALUE          49450000
.SKIPCPR ANOP                                                           49500000
         IEDQMASK &CPINTVL,2                                            49550000
         AIF   (&IEDQZA(24)).BADCPVL                                    49600000
         AIF   ('&CPINTVL'(1,1) EQ 'X' OR &CPINTVL LT 30).BADCPVL       49650000
         AIF   (&CPINTVL GE 43200).BADCPVL                      SA63008 49700000
         DC    AL2(&CPINTVL) .          CPINTVL=INTEGER                 49750000
         AGO   .SKPCPVL                                                 49800000
.BADCPVL SPACE                                                          49850000
         MNOTE 4,'IHB303  INVALID OPERAND CPINTVL, 1800 ASSUMED'        49900000
         SPACE 2                                                        49950000
         DC    AL2(1800) .              CPINTVL=1800 DEFAULT VALUE      50000000
.SKPCPVL ANOP                                                           50050000
         DC    H'0' .                   TIME OF DAY OF INTERRUPT        50100000
         DC    X'08' .                  OFFSET TO CKPT QCB ADDR         50150000
         DC    4X'00' .                 OPEN CONSTANTS                  50200000
         DC    X'00' .                  CKPT ELE STATUS                 50250000
IEDOPETR DS    0X .                     INTRO RETURN CODE               50300000
         DC    V(IEDQHG01) .            TIME DELAY SUBROUTINE           50350000
IEDBSX   DC    AL1(8) .                 OFFSET TO BINARY SEARCH ADDR    50400000
         DC    AL3(0) .                 LINK ON TIME QUEUE              50450000
IEDDELEM DC    A(IEDREADY-8,IEDDELEM) . DUMMY LAST ELEMENT              50500000
         DC    X'20',AL3(IEDCKPTB),A(0) CLOSE CHECKPOINT ELEMENT        50550000
IEDCLRHI DC    X'0000FFFF' .            CLEARS HIGH HALF OF REG         50600000
IEDADBUF DC    B'&AF(32).0000000'      ADBUMP PARM/MH PTR      @OZ35527 50650082
         DC    AL3(&ABDUMP)                                    @OZ35527 50660082
         DC    A(0) .                   2260 LOCAL APPENDAGE            50700000
         DC    AL1(0) .                 RESERVED                        50750000
IEDMSGS  DC    AL3(IEDQMSGS) .          LIST OF OPTIONAL VCONS          50800000
         AIF   (NOT &IEDQZA(44)).XXCMBF2                         S22027 50850000
&A       SETA  &IEDCBUF(1)                                       S22027 50900000
IEDCBSTB DC    AL2(&A) .                NUMBER OF COMMBUF STCBS  S22027 50950000
&A       SETA  &IEDCBUF(2)                                       S22027 51000000
IEDCBNDA DC    AL2(&A) .                NUMBER OF CB DATA AREAS  S22027 51050000
*                                       AFTER INTRO THE ABOVE    S22027 51100000
*                                       TWO HALF WORDS CONTAIN   S22027 51150000
*                                       THE ADDR OF CB MASTER QCBS22027 51200000
         AGO   .XXCMBF3                                          S22027 51250000
.XXCMBF2 DC    A(0) .                   RESERVED FOR CB          S22027 51300000
.XXCMBF3 ANOP                                                    S22027 51350000
IEDSUPPT DC    A(0) .                   STARTUP MESSAGE                 51400000
         AIF   (&IEDQZA(51)).DOQCB                                      51450000
         DC    A(0) .                   TIME SHARING INPUT QCB ADDR     51500000
*                                        (UNUSED WHEN ENVIRON=TCAM)     51550000
         AGO   .SKDOQCB                                                 51600000
.DOQCB   ANOP                                                           51650000
IEDTSOPT DC    A(IEDAYTSQ) .            TS INPUT QCB ADDR (QCB IS       51700000
*                                         GENERATED BY TSINPUT MACRO)   51750000
.SKDOQCB ANOP                                                           51800000
IEDOCQPT DC    A(0) IEDQEU .            OPEN/CLOSE APPL PGM      Y02027 51850000
IEDDELYB DC    A(*,0),V(IEDQHG) .       TIME DELAY QCB                  51900000
         DC    A(0) .                   STIMER INTERVAL                 51950000
         DC    H'0' .                   REFERENCE TIME                  52000000
IEDINOUT DC    X'0100' .                DUMMY INEND/OUTEND PARM LIST    52050000
         DC    X'0C',AL3(IEDDELYB),A(IEDDELYB) PARM TO SVC 102 TO POST  52100000
*                                       TIME DELAY QCB TO ITSELF WHEN   52150000
*                                       TIME INTERRUPT IS RECEIVED      52200000
         DC    A(IEDDELYB) .            TIME DELAY Q                    52250000
         AIF   ('&BRETURN' EQ 'LO').LOBACK                     @OY19124 52270082
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQGA)  AVAIL BFR   @G36XRFF 52300000
         AGO   .HIBACK                                         @OY19124 52310082
.LOBACK  ANOP                                                  @OY19124 52320082
         DC    X'02',AL3(IEDDELEM),XL1'80',AL3(0),V(IEDQGA)    @OY19124 52330082
.HIBACK  ANOP                                                  @OY19124 52340082
IEDBFRTB DC    X'02',AL3(IEDDELEM),A(0),V(IEDQGB) BFR RET QCB  @G36XRFF 52350000
IEDCKPTB DC    X'02',AL3(IEDDELEM),A(0,IEDCKPTB) CHECKPOINT QCB         52400000
IEDOPCOB DC    X'02',AL3(IEDDELEM),A(0,IEDOPCOB) OPERATOR CONTROL       52450000
IEDOLTQB DC    X'02',AL3(IEDDELEM),A(0,IEDOLTQB) ON LINE TEST           52500000
         AIF   (NOT &IEDQRN(2)).ACTQCB                           S22024 52550000
         DC    X'02',AL3(IEDDELEM),A(0),A(0) ACTIVATE QCB        S22024 52600000
&IEDLSB(5) SETB 0                                                S22024 52650000
&IEDLSB(6) SETB 0                                                S22024 52700000
         AGO   .LNTOUT                                           S22024 52750000
.ACTQCB  ANOP                                                    S22024 52800000
         AIF   ('&LINETYP' EQ 'STSP').LNTSTSP                           52850000
         AIF   ('&LINETYP' EQ 'BISC').LNTBISC                           52900000
         AIF   ('&LINETYP' EQ 'MINI').LNTMINI                           52950000
         AIF   ('&LINETYP' EQ 'BOTH').LNTBOTH                           53000000
         SPACE                                                          53050000
.TSOERR   ANOP                                                 @OZ36974 53070082
         MNOTE 4,'IHB303  INVALID OPERAND LINETYP, BOTH ASSUMED'        53100000
         SPACE 2                                                        53150000
.LNTBOTH ANOP                                                           53200000
*                                       LINETYP=BOTH SPECIFIED          53250000
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKA) ACTIVATE QCB          53300000
&IEDLSB(5) SETB 0                                                       53350000
&IEDLSB(6) SETB 0                                                       53400000
         AGO   .LNTOUT                                                  53450000
.LNTMINI ANOP                                                           53500000
*                                       LINETYP=MINI SPECIFIED          53550000
.* CHECK IF TSO                                                @OZ36974 53560082
         AIF   (&IEDQZA(51)).TSOERR                            @OZ36974 53570082
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKD) ACTIVATE QCB          53600000
         AGO   .LNTOUT                                                  53650000
.LNTBISC ANOP                                                           53700000
*                                       LINETYP=BISC SPECIFIED          53750000
.* CHECK IF TSO                                                @OZ36974 53760082
         AIF   (&IEDQZA(51)).TSOERR                            @OZ36974 53770082
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKB) ACTIVATE QCB          53800000
&IEDLSB(6) SETB 0                       BISC ONLY                       53850000
         AGO   .LNTOUT                                                  53900000
.LNTSTSP ANOP                                                           53950000
*                                       LINETYP=STSP                    54000000
         AIF   (&IEDQZA(51)).STSPTSO                                    54050000
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKE) ACTIVATE QCB          54100000
         AGO   .SETSTSP                                                 54150000
.STSPTSO ANOP                                                           54200000
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKC) ACTIVATE QCB          54250000
.SETSTSP ANOP                                                           54300000
&IEDLSB(5) SETB 0                       STSP ONLY                       54350000
.LNTOUT  ANOP                                                           54400000
IEDCLOSB DC    X'02',AL3(*-1),A(0),V(IEDQNA) CLOSEDOWN COMPLETION       54450000
IEDCPRMB DC    X'02',AL3(*-1),A(0),V(IEDQHG03) REMOVE TIME DELAY        54500000
*                                         REQUEST ELE FROM TIME Q       54550000
         AIF   (&IEDQZA(51)).DOYO                                       54600000
         AIF   (&IEDQZA(41) AND &IEDQZA(42)).FA IF CORE AND DISK        54650000
         AIF   (&IEDQZA(41)).FA2        IF DISK ONLY                    54700000
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQFA1) CORE ONLY Q QCB      54750000
         AGO   .SKFA                                                    54800000
.FA2     ANOP                                                           54850000
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQFA2) DISK ONLY Q QCB      54900000
         AGO   .SKFA                                                    54950000
.FA      ANOP                                                           55000000
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQFA) QUEUE QCB             55050000
.SKFA    ANOP                                                           55100000
IEDCPBCB DC    X'02',AL3(*-1),A(0),V(IEDQFQ) CPB CLEANUP QCB            55150000
         AGO   .SKIPYO                                                  55200000
.DOYO    DC    X'02',AL3(IEDDELEM),A(0),V(IEDAYN) QUEUE QCB   G36XRYP   55250000
IEDCPBCB DC    X'02',AL3(*-1),A(0),V(IEDAYN02) CPB CLEANUP QCBG36XRYP   55300000
.SKIPYO  ANOP                                                           55350000
         DC    2F'0' .                  COREC AND CADDR                 55400000
         DC    F'0' .                   FULLWORD OF ZEROES              55450000
         DC    V(IEDQFE) .              FE PATCH MODULE                 55500000
         DC    F'0',X'40',AL3(0) .                                      55550000
         AIF   ('&COMWRTE' EQ 'NO').NOCMWR                              55600000
         AIF   ('&COMWRTE' EQ 'YES').YESCMWR                            55650000
         SPACE                                                          55700000
         MNOTE 4,'IHB303  INVALID OPERAND COMWRTE, NO ASSUMED'          55750000
         SPACE 2                                                        55800000
.NOCMWR  DC    X'00' .                  COMWRTE=NO SPECIFIED            55850000
         AGO   .SKCMWR                                                  55900000
.YESCMWR DC    X'80' .                  COMWRTE=YES SPECIFIED           55950000
.SKCMWR  ANOP                                                           56000000
&SUBTVAL SETC  '00'                     ASSIGN DEFAULT VALUE   @Y17XAXF 56050000
         AIF   ('&DTRACE(2)' NE '').DTRACET                    @Y17XANA 56100000
         AIF   (&DTRACEN EQ 0).DTRACEE                         @Y17XANA 56150000
         AIF   (&DTRACEN GT 0).DTRACEN                         @Y17XANA 56200000
.DTRACET ANOP                                                  @Y17XANA 56250000
         AIF   ('&DTRACE(2)' EQ 'OFF').DTRACEE                 @Y17XANA 56300000
         AIF   (&DTRACEN GT 0).DTRACEX                         @Y17XANA 56350000
         MNOTE 4,'IHB300 DTRACE OPTION REQUIRES TRACE TABLE'   @Y17XANA 56400000
         AGO   .DTRACEE                                        @Y17XANA 56450000
.DTRACEX ANOP                                                  @Y17XANA 56500000
         AIF   ('&DTRACE(2)' EQ 'ON').DTRACEN                  @Y17XANA 56550000
         AIF   ('&DTRACE(2)' EQ 'POST').DTRACEP                @Y17XANA 56600000
         AIF   ('&DTRACE(2)' EQ 'ALL').DTRACEL                 @Y17XANA 56650000
         MNOTE 4,'IHB300 DTRACE OPTION INVALID ON ASSUMED'     @Y17XANA 56700000
.DTRACEN ANOP                                                  @Y17XANA 56750000
&SUBTVAL SETC  '80'                                            @Y17XANA 56800000
         AGO   .DTRACEE                                        @Y17XANA 56850000
.DTRACEP ANOP                                                  @Y17XANA 56900000
&SUBTVAL SETC  'C0'                                            @Y17XANA 56950000
         AGO   .DTRACEE                                        @Y17XANA 57000000
.DTRACEL ANOP                                                  @Y17XANA 57050000
&SUBTVAL SETC  'FF'                                            @Y17XANA 57100000
.DTRACEE ANOP                                                  @Y17XANA 57150000
&SUBIVAL SETC  '00'                     SET DEFAULT VALUE               57200000
         AIF   ('&TRACE(2)' NE '').TRACET                      @Y17XANA 57250000
         AIF   (&TRACEN EQ 0).TRACEE                           @Y17XANA 57300000
         AIF   (&TRACEN GT 0).TRACEN                           @Y17XANA 57350000
.TRACET  ANOP                                                  @Y17XANA 57400000
         AIF   ('&TRACE(2)' EQ 'OFF').TRACEE                   @Y17XANA 57450000
         AIF   (&TRACEN GT 0).TRACEX                           @Y17XANA 57500000
         MNOTE 4,'IHB300 TRACE OPTION REQUIRES TRACE TABLE'    @Y17XANA 57550000
         AGO   .TRACEE                                         @Y17XANA 57600000
.TRACEX  ANOP                                                  @Y17XANA 57650000
         AIF   ('&TRACE(2)' EQ 'ON').TRACEN                    @Y17XANA 57700000
         AIF   ('&TRACE(2)' EQ 'HOLD').TRACEH                  @Y17XANA 57750000
         AIF   ('&TRACE(2)' EQ 'ALL').TRACEL                   @Y17XANA 57800000
         MNOTE 4,'IHB300 TRACE OPTION INVALID ON ASSUMED'      @Y17XANA 57850000
.TRACEN  ANOP                                                  @Y17XANA 57900000
&SUBIVAL SETC  '80'                                            @Y17XANA 57950000
         AGO   .TRACEE                                         @Y17XANA 58000000
.TRACEH  ANOP                                                  @Y17XANA 58050000
&SUBIVAL SETC  'C0'                                            @Y17XANA 58100000
         AGO   .TRACEE                                         @Y17XANA 58150000
.TRACEL  ANOP                                                  @Y17XANA 58200000
&SUBIVAL SETC  'FF'                                            @Y17XANA 58250000
.TRACEE  ANOP                                                  @Y17XANA 58300000
.TREXIT  ANOP                                                  @Y17XANU 58350000
         DC    X'00FFFF0000000040000000',3F'0'  FE PATCH AREA  @Y17XANU 58400000
         DC    X'&SUBTVAL' .            SUBT FLAGS             @Y17XAXF 58450000
         DC    X'&SUBIVAL' .            IOTR FLAGS             @Y17XANU 58500000
         DC    H'0' .                   RESERVED               @Y17XANU 58550000
         DC    A(0) .                   FE SERVICE ROUTINE     @Y17XANU 58600000
         DC    13F'0' .                 FE PATCH AREA          @Y17XANU 58650000
         DC    F'0' .                   TOTE AREA              @Y17XANU 58700000
*        GETMAIN EC,MF=L                GETMAIN PARAMETER LIST          58750000
         GETMAIN EC,MF=L                                                58800000
         DC    H'2,3,4,7,16' .          HALFWORD CONSTANTS              58850000
&IEDLKEY SETA  0                        DEFAULT FOR KEYLEN (UNITSZ)     58900000
         AIF   ('&KEYLEN' EQ '').TRYUNSZ                                58950000
         AIF   ('&UNITSZ' NE '').BOTHBAD                                59000000
         AGO   .TRYKEY                                                  59050000
.TRYUNSZ AIF   ('&UNITSZ' EQ '').SKPKYX                                 59100000
         IEDQMASK &UNITSZ,1                                             59150000
         AIF   (&IEDQZA(24)).BADUNSZ                                    59200000
         AIF   (&UNITSZ EQ 0).GOODUNS                                   59250000
         AIF   (&IEDQRN(1)).CK05        CK FOR 3705 ENVIRON    @YM06968 59300000
         AIF   ('&UNITSZ'(1,1) EQ 'X' OR &UNITSZ LT 36).BADUNSZ         59350000
.*                                                             @Z30X8FG 59400000
         AGO   .GOODUNS                                        @YM06968 59450000
.CK05    AIF  ('&UNITSZ'(1,1) EQ 'X' OR &UNITSZ LT 44).BADUNSZ @YM06968 59500000
.GOODUNS ANOP                                                           59550000
&IEDLKEY SETA  &UNITSZ                                                  59600000
*                                       UNITSZ=INTEGER                  59650000
         AGO   .SKPKY                                                   59700000
.BOTHBAD SPACE                                                          59750000
         MNOTE 4,'IHB303  INVALID OPERAND KEYLEN/UNITSZ, 0 ASSUMED'     59800000
         SPACE 2                                                        59850000
.SKPKYX  ANOP                                                           59900000
*                                       KEYLEN=0 (UNITSZ=0) DEFAULT     59950000
         AGO   .SKPKY                                                   60000000
.BADUNSZ SPACE                                                          60050000
         MNOTE 4,'IHB303  INVALID OPERAND UNITSZ, 0 ASSUMED'            60100000
         SPACE 2                                                        60150000
*                                       UNITSZ=0 DEFAULT VALUE          60200000
         AGO   .SKPKY                                                   60250000
.TRYKEY  ANOP                                                           60300000
         IEDQMASK &KEYLEN,1                                             60350000
         AIF   (&IEDQZA(24)).BADKY                                      60400000
         AIF   (&KEYLEN EQ 0).GOODKEY                                   60450000
         AIF   (&IEDQRN(1)).CK3705      CK FOR 3705 ENVIRON    @YM06968 60500000
         AIF   ('&KEYLEN'(1,1) EQ 'X' OR &KEYLEN LT 36).BADKY  @Z30X8FG 60550000
         AGO   .GOODKEY                                        @YM06968 60600000
.CK3705  AIF   ('&KEYLEN'(1,1) EQ 'X' OR &KEYLEN LT 44).BADKY  @YM06968 60650000
.GOODKEY ANOP                                                           60700000
&IEDLKEY SETA  &KEYLEN                                                  60750000
*                                       KEYLEN=INTEGER                  60800000
         AGO   .SKPKY                                                   60850000
.BADKY   SPACE                                                          60900000
         MNOTE 4,'IHB303  INVALID OPERAND KEYLEN, 0 ASSUMED'            60950000
         SPACE 2                                                        61000000
*                                       KEYLEN=0 DEFAULT VALUE          61050000
.SKPKY   ANOP                                                           61100000
&KEYLN   SETA  &IEDLKEY                 KEYLN=KEYLEN OR UNITSZ @OZ36390 61120082
         DC    H'&IEDLKEY'                                              61150000
         DC    5H'0' .                  LNCNT,OPCNT,OPCON,AVFCT,SMCNT   61200000
         IEDQMASK &INTVAL,2                                             61250000
         AIF   (&IEDQZA(24)).BADINT                                     61300000
         AIF   ('&INTVAL'(1,1) EQ 'X' OR &INTVAL LT 0).BADINT           61350000
         DC    AL2(&INTVAL) .               INTVAL=INTEGER              61400000
         AGO   .SKPINT                                                  61450000
.BADINT  SPACE                                                          61500000
         MNOTE 4,'IHB303  INVALID OPERAND INTVAL, 0 ASSUMED'            61550000
         SPACE 2                                                        61600000
         DC    H'0' .                   INTVAL=0 DEFAULT VALUE          61650000
.SKPINT  ANOP                                                           61700000
IEDDLQX  DC    H'0' .                   DEAD LETTER Q OFFSET            61750000
IEDDUMBR BR    11 .                     DUMMY TRACE TABLE UPDATE        61800000
IEDBIT1  DC    B'0&IEDQZA(51).&IEDQZA(52).0000&IEDLDSK'                 61850000
         AIF   ('&TOPMSG' EQ 'NO').NOTOP                                61900000
         AIF   ('&TOPMSG' EQ 'YES').YESTOP                              61950000
         SPACE                                                          62000000
         MNOTE 4,'IHB303  INVALID OPERAND TOPMSG, YES ASSUMED'          62050000
         SPACE 2                                                        62100000
.YESTOP  ANOP                                                           62150000
&IEDLSB(7) SETB 0                                                       62200000
*                                       TOPMSG=YES, DISPLAY T.O. MSGS   62250000
         AGO   .ENDTOP                                                  62300000
.NOTOP   ANOP                                                           62350000
&IEDLSB(7) SETB 1                                                       62400000
*                                       TOPMSG=NO, SUPPRESS T.O. MSGS   62450000
.ENDTOP  ANOP                                                           62500000
         AIF   ('&STARTUP' EQ '').ENDSTRT                               62550000
         AIF   (K'&STARTUP GT 3).ERRSTRT                                62600000
&IEDLSA  SETA  1                        PRESET INDEX                    62650000
.STALOOP AIF   (K'&STARTUP LT &IEDLSA).ENDSTR                           62700000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'C').GOTC                      62750000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'W').GOTW                      62800000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'I').GOTI                      62850000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'Y').GOTY                      62900000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'E').GOTE              SA51078 62950000
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'N').STABUMP          @OS77945 63000000
.ERRSTRT SPACE                                                          63050000
         MNOTE 12,'IHB300 STARTUP OPERAND INVALID AS SPECIFIED'         63100000
         SPACE 2                                                        63150000
         AGO   .ENDSTRT                                                 63200000
.GOTC    AIF   (&IEDLSB(1)).ERRSTRT                                     63250000
&IEDLSB(1) SETB 1                       STARTUP SPECIFIED               63300000
&IEDLSB(2) SETB 1                       'C' SPECIFIED                   63350000
         AGO   .STABUMP                                                 63400000
.GOTW    AIF   (&IEDLSB(1)).ERRSTRT                                     63450000
&IEDLSB(1) SETB 1                       STARTUP SPECIFIED               63500000
&IEDLSB(2) SETB 0                       'W' SPECIFIED                   63550000
         AGO   .STABUMP                                                 63600000
.GOTI    AIF   (&IEDLSB(3)).ERRSTRT                                     63650000
&IEDLSB(3) SETB 1                       'I' SPECIFIED                   63700000
         AGO   .STABUMP                                                 63750000
.GOTY    AIF   (&IEDLSB(4) OR &IEDLSB(14) OR                           X63800000
               &IEDLSB(18)).ERRSTRT                            @OS77945 63850000
&IEDLSB(4) SETB 1                       'Y' SPECIFIED                   63900000
         AGO   .STABUMP                                         SA51078 63950000
.GOTE    AIF   (&IEDLSB(4) OR &IEDLSB(14) OR                           X64000000
               &IEDLSB(18)).ERRSTRT                            @OS77945 64050000
&IEDLSB(14) SETB 1                                              SA51078 64100000
.STABUMP ANOP                                                           64150000
&IEDLSA  SETA  &IEDLSA+1                BUMP INDEX                      64200000
         AGO   .STALOOP                 LOOK AT NEXT CHARACTER          64250000
.ENDSTR  AIF   (NOT &IEDLSB(1)).ERRSTRT                                 64300000
         DC    B'&IEDLSB(14).00&IEDLSB(7).00&IEDLSB(6).&IEDLSB(5)'      64350000
*                                       STARTUP CODE SPECIFIED @XA05310 64400000
         DC    B'0000&IEDLSB(4).&IEDLSB(3).&IEDLSB(2).&IEDLSB(1)'       64450000
         AGO   .MOREBIT                                                 64500000
.ENDSTRT ANOP                                                  @XA05310 64550000
         DC    B'&IEDLSB(14).00&IEDLSB(7).00&IEDLSB(6).&IEDLSB(5)'      64600000
         DC    B'00000000'              STARTUP CODE NOT SPEC  @XA05310 64650000
.MOREBIT ANOP                                                           64700000
         IEDQMASK &RESTART,1                                            64750000
         AIF   (&IEDQZA(24)).BADREST                                    64800000
         AIF   ('&RESTART'(1,1) EQ 'X').BADREST                         64850000
         DC    AL1(&RESTART) .          RESTART=INTEGER                 64900000
         AGO   .SKPREST                                                 64950000
.BADREST SPACE                                                          65000000
         MNOTE 4,'IHB303  INVALID OPERAND RESTART, 0 ASSUMED'           65050000
         SPACE 2                                                        65100000
         DC    AL1(0) .                 RESTART=0 DEFAULT VALUE         65150000
.SKPREST ANOP                                                           65200000
         DC    2AL1(0) .                                                65250000
         DC    V(IEDOPTN) .             OPTION SEARCH RTN      @Y17XANU 65300000
         DC    V(IEDQGA02) .            BUFFER STEAL RTN       @G36XRFF 65350000
         DC    V(IEDQTL) .              DEVICE DEP FIELD       @Y17XANU 65400000
*                                       LOOKUP RTN             @Y17XANU 65450000
         DC    A(IEDOPMSK) .            OP CTL MASK TABLE ADDR @Y17XANU 65500000
IEDOPMSK CSECT                                                 @Y17XANU 65550000
         DC    H'9' .                   DEFINE ENTRY COUNT     @Y17XANU 65600000
&G       SETA  0                        INIT LOOP COUNTER      @Y17XANU 65650000
         AIF   (N'&OPMASK LT 9 OR N'&OPMASK EQ 9).MSKLOOP      @Y17XANU 65700000
.*                                      VALID ENTRY            @Y17XANU 65750000
         MNOTE 4,'IED901 TOO MANY MASK ENTRIES - FIRST 9 ARE CANDIDATESC65800000
               '                                               @Y17XANU 65850000
.MSKLOOP ANOP                                                  @Y17XANU 65900000
         AIF   (&G EQ 9).MSKEND         ALL MASKS CHECKED      @Y17XANU 65950000
&G       SETA  &G+1                     INCREMENT COUNTER      @Y17XANU 66000000
&H       SETC  '&OPMASK(&G)'             GET NEXT ENTRY        @Y17XANU 66050000
         AIF   ('&H' EQ '').DEFMSK      USE DEFAULT VALUE      @Y17XANU 66100000
         AIF   (K'&H EQ 4).MSKCHK0      4 DIGIT ENTRY          @Y17XANU 66150000
.*                                                             @Y17XANU 66200000
         AGO   .ERRMSK1                 USE DEFAULT            @Y17XANU 66250000
.MSKCHK0 ANOP                                                  @Y17XANU 66300000
&ECNT    SETA  0                        INIT LOOP COUNT        @Y17XANU 66350000
.MSKCHK1 ANOP                                                  @Y17XANU 66400000
         AIF   (&ECNT EQ 4).MSKFIN      MASK ENTRY VALID       @Y17XANU 66450000
&ECNT    SETA  &ECNT+1                  INCREMENT COUNTER      @Y17XANU 66500000
         AIF   ('&H'(K'&H,1) GE '0' AND '&H'(K'&H,1) LE '9').MSKCHK1    66550000
.*             IF DIGIT BETWEEN 0 AND 9 - VALID HEX            @Y17XANU 66600000
         AIF   ('&H'(K'&H,1) LT 'A' OR '&H'(K'&H,1) GT 'F').ERRMSK1     66650000
.*             IF DIGIT NOT BETWEEN A AND F - INVALID HEX      @Y17XANU 66700000
         AGO   .MSKCHK1                 CHECK NEXT DIGIT       @Y17XANU 66750000
.ERRMSK1 ANOP                                                  @Y17XANU 66800000
         MNOTE 4,'IED902 INVALID OPMASK VALUE, DEFAULT ASSUMED'         66850000
.*                                                             @Y17XANU 66900000
.DEFMSK  ANOP                                                           66950000
         DC    XL2'&MSKVAL(&G)' .       OP CONTROL MASK        @Y17XANU 67000000
         AGO   .MSKLOOP                 SPARSE NEXT ENTRY      @Y17XANU 67050000
.MSKFIN  ANOP                                                  @Y17XANU 67100000
         DC    XL2'&H'                  OP CONTROL MASK        @Y17XANU 67150000
         AGO   .MSKLOOP                 SPARSE NEXT ENTRY      @Y17XANU 67200000
.MSKEND  ANOP                           END OF TABLE           @Y17XANU 67250000
&IEDLSEC CSECT                                                 @Y17XANU 67300000
         DC    H'6' .                   LENGTH OF DCT MASK FLD @Y17XANU 67350000
         DC    H'0' .                   TTCIN OF PRIMARY       @Y17XADU 67400000
*                                       TERMINAL               @Y17XANU 67450000
.* &IEDQZA(52) SET BY ENVIRON=TCAM OR MIXED                             67500000
         AIF   (NOT &IEDQZA(52)).TSONLY                                 67550000
         DC    V(IEDQHM02) .            DESTINATION ASSIGNEMNT          67600000
         IEDQMASK &MSMIN,1                                              67650000
         AIF   (&IEDQZA(24)).BADMIN                                     67700000
         AIF   ('&MSMIN'(1,1) EQ 'X' OR &MSMIN GE 100).BADMIN           67750000
&IEDLMIN SETA  &MSMIN                                                   67800000
         AGO   .SKIPMIN                                                 67850000
.BADMIN  SPACE                                                          67900000
         MNOTE 4,'IHB303  INVALID OPERAND MSMIN, 50 ASSUMED'            67950000
         SPACE 2                                                        68000000
*                                       DEFAULT VALUE FOR MSMIN USED    68050000
&IEDLMIN SETA  50                                                       68100000
.SKIPMIN ANOP                                                           68150000
         IEDQMASK &MSMAX,1                                              68200000
         AIF   (&IEDQZA(24)).BADMAX                                     68250000
         AIF   ('&MSMAX'(1,1) EQ 'X' OR &MSMAX GT 100 OR &MSMAX LT 1).BA68300000
               ADMAX                                                    68350000
&IEDLMAX SETA  &MSMAX                                                   68400000
         AGO   .SKIPMAX                                                 68450000
.BADMAX  SPACE                                                          68500000
         MNOTE 4,'IHB303  INVALID OPERAND MSMAX, 70 ASSUMED'            68550000
         SPACE 2                                                        68600000
*                                       DEFAULT VALUE FOR MSMAX USED    68650000
&IEDLMAX SETA  70                                                       68700000
.SKIPMAX ANOP                                                           68750000
         AIF   (&IEDLMAX GT &IEDLMIN).OKINAX                            68800000
         SPACE                                                          68850000
         MNOTE 12,'IHB300 MSMIN/MSMAX OPERAND INVALID AS SPECIFIED'     68900000
         SPACE 2                                                        68950000
         DC    F'50' .                  MSMIN=50 DEFAULT VALUE          69000000
         DC    F'70' .                  MSMAX=70 DEFAULT VALUE          69050000
         AGO   .MINMAX                                                  69100000
.OKINAX  ANOP                                                           69150000
         DC    F'&IEDLMIN' .                  MSMIN=INTEGER             69200000
         DC    F'&IEDLMAX' .                  MSMAX=INTEGER             69250000
.MINMAX  ANOP                                                           69300000
         DC    F'&IEDLMS' .             MSUNITS=INTEGER                 69350000
         DC    AL1(4),AL3(0),A(0) .     ELEMENTS WAITING FOR CPBS       69400000
         AIF   (&IEDQZA(41)).GOTDISK                                    69450000
         AGO   .END                                                     69500000
.GOTDISK ANOP                                                           69550000
IEDFL    DC    A(0) .                   DISK EXCP DRIVER                69600000
IEDIA    DC    A(0) .                   REUS                            69650000
         DC    A(0) .                   ADDR OF COPY SUBTASK QCB        69700000
         DC    AL1(40),AL3(0),A(0) .    CPBS FOR CPB CLEANUP-DISABLE    69750000
         DC    AL1(40),AL3(0),A(0) .    SAME, BUT ENABLED               69800000
         DC    AL1(40),AL3(0),A(0) .    CPBS WITHOUT BUFFERS            69850000
IEDBIT4  DC    XL1'00' .                FLAGBITS                SA51078 69900000
         DC    AL3(0) .                 RESERVED                SA51078 69950000
         DC    A(0) .                   RESERVED                SA51078 70000000
         DC    AL1(40),AL3(0),A(0) .    CPBS WANTING I/O                70050000
IEDFCPB  DC    A(0) .                   CPB FREEPOOL                    70100000
         DC    17F'0' .                 DISK OPEN CONSTANTS             70150000
IEDNADDR DC    A(IEDQNADN,IEDQNADR)     DISK RECORD ADDRESSES    Y05330 70200000
         DC    A(IEDOPCOB),X'EA',AL3(0),X'310C00FF'            @SA71946 70250000
*                                       NON-REUSABLE DISK               70300000
*                                         THRESHOLD CLOSEDOWN ELE       70350000
         IEDQMASK &CPB,2                                                70400000
         AIF   (&IEDQZA(24)).BADCPB                                     70450000
         AIF   ('&CPB'(1,1) EQ 'X' OR &CPB LT 0).BADCPB                 70500000
         DC    AL2(&CPB) .                 CPB=INTEGER                  70550000
         AGO   .SKPCPB                                                  70600000
.BADCPB  SPACE                                                          70650000
         MNOTE 4,'IHB303  INVALID OPERAND CPB, 0 ASSUMED'               70700000
         SPACE 2                                                        70750000
         DC    AL2(0) .                 CPB=0 DEFAULT VALUE             70800000
.SKPCPB  ANOP                                                           70850000
         AGO   .END                                                     70900000
.TSONLY  ANOP                                                    S22029 70950000
.END     SPACE 2                                                        71000000
IEDOA    DC    CL8'IEDQOA  ' .          INITIALIZATION LINKOR SUBRT     71050000
IEDSVC13 DS    0H .                                                     71100000
         STM   14,12,12(13) .           SAVE REGISTERS IN      @Y17XANA 71150000
*                                       CURRENT SAVE AREA        Y01004 71200000
         L     1,IED045 .               GET ABEND CODE                  71250000
         DROP  1 .                      FORGET BASE                     71300000
*        ABEND (1) .                    SYSTEM 045,SUBCODE IN R15       71350000
         ABEND (1) .                    SYSTEM 045,SUBCODE IN R15       71400000
         DS    0F .                     WORD BOUNDARY                   71450000
IED045   DC    X'80045000' .            ABEND SYSTEM CODE               71500000
         AIF   (&IEDLTON EQ 0).NOTONE                                   71550000
IEDTON   CSECT                                                          71600000
         DC    AL2(&IEDLTON),&IEDLTON.X'FF' .     TONE CHAR WORLD TRADE 71650000
.NOTONE  AIF   (&IEDLSB(10) EQ 0).HGOK                                  71700000
         SPACE 3                                                        71750000
IEDQHG   CSECT .                        DUMMY TIME DELAY SUBTASK        71800000
*                                       FEATURE=(,,NOTIMER)             71850000
IEDQHG03 DS    0H                                                       71900000
         ENTRY IEDQHG01,IEDQHG02,IEDQHG03                               71950000
         DC    X'0400' .                STCB FOR TIME DELAY SUBTASK     72000000
IEDQHG01 DS    0H .                     SUBROUTINE TYPE ENTRY           72050000
IEDQHG02 DS    0H .                       POINTS TO TIME DELAY          72100000
         LA    15,6 .                   ABEND SUBCODE                   72150000
         BAL   14,IEDABEND-IEDSAVE2(13) ILLEGAL CALL TO TIME            72200000
*                                         DELAY, SO ABEND               72250000
.HGOK    ANOP                                                           72300000
         SPACE 3                                                        72350000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 72400000
*                                                                       72450000
*                      TCAM MESSAGE CONTROL PROGRAM                     72500000
*                                                                       72550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 72600000
&IEDLSEC CSECT                                                          72650000
&IEDIDLN  SETA K'&PROGID                                         X03039 72700000
IEDPGMID DC    AL1(&IEDIDLN) .          LENGTH OF PROGID         X03039 72750000
         DC    C'&PROGID'                                               72800000
.SKIPSEC ANOP                                                           72850000
*                                                                       72900000
&IEDLSKP DS    0H                                                       72950000
         STM   14,12,12(13) .           SAVE CALLERS REGISTERS          73000000
         ST    1,IEDSPLPT .             SAVE ADDRESS OF START           73050000
*                                         PARAMETER LIST POINTER        73100000
         LA    1,IEDSAVE1 .             GET ADDRESS OF SAVEAREA         73150000
         ST    13,IEDSAVE1+4 .          EXCHANGE                        73200000
         ST    1,8(13) .                  SAVEAREA ADDRESSES            73250000
         USING IEDSAVE1,13 .            IDENTIFY PROGRAM BASE           73300000
         LR    13,1 .                   SET PROGRAM BASE                73350000
         DROP  15 .                     FORGET TEMPORARY                73400000
*                                       PASS ADDR OF AVT AS PARM IN R1  73450000
*        LINK  EPLOC=IEDOA,MF=(E,(1))   GET OPERATOR REPLY ROUTINE      73500000
         LINK  EPLOC=IEDOA,MF=(E,(1))                                   73550000
         SPACE 2                                                        73600000
         MEND                                                           73650000
