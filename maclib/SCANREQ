         MACRO                                                          00050002
&NAME    SCANREQ    &DACAA,&OPTYP,&SOURA,&SINKA,&SOURL,&SINKL,&DEVAD,  -00100002
               &SCR1,&SCR2,&RVOID=,&PROT=,&MF=                          00150002
         LCLB  &LBOPR(5)      OPERAND REGISTER FLAGS                    00200002
.*                  WHERE     LBOPR(1) ON INDICATES DACAA IS REG        00250002
.*                            LBOPR(2) ON INDICATES SOURA IS REG        00300002
.*                            LBOPR(3) ON INDICATES SINKA IS REG        00350002
.*                            LBOPR(4) ON INDICATES SOURL IS REG        00400002
.*                            LBOPR(5) ON INDICATES SINKL IS REG        00450002
         LCLB  &NOCODE        FLAG TO PREVENT CODE GENERATION           00500002
         LCLA  &LAOPTY        BTAM OPERATION TYPE                       00550002
         LCLB  &LBMFE,&LBMFL  SWITCHES FOR REMEMBERING MF               00600002
         LCLC  &LCM1          CHARACTER DATA                            00650002
         LCLC  &LCM2          CHARACTER REGISTER DATA                   00700002
         LCLC  &LCM3          CHARACTER DATA - PART OF NI INSTRUCTION   00750002
         LCLC  &LCM4          CHARACTER DATA - 000000 OR 111111         00800002
         LCLC &SCREEN6       2260 SCREEN SIZE                           00850002
         LCLC  &NORVOID       INDICATES RVOID = NO IF 0                 00900002
         LCLC  &NOPROT        INDICATES PROT  = NO IF 0                 00950002
         LCLB  &OPTP(8)  SET UP BYTE FOR DACOPTYP                       01000002
.*                  WHERE     OPTP(1) ON INDICATES RVOID = YES          01050002
.*                            OPTP(2) ON INDICATES PROT  = YES          01100002
.*                            OPTP(3) ON INDICATES OPTYP = 1            01150002
.*                            OPTP(4) ON INDICATES OPTYP = 2            01200002
.*                            OPTP(5) ON INDICATES OPTYP = 3            01250002
.*                            OPTP(6) ON INDICATES OPTYP = 4            01300002
.*                            OPTP(7) ON INDICATES OPTYP = 5            01350002
.*                            OPTP(8) ON INDICATES OPTYP = 6            01400002
         LCLB  &NLOPTYP       INDICATES OPTYPE = 0                      01450002
         LCLB  &OMSCR1                                                  01500002
         LCLB  &VLSCR1(6)     REMEMBER 2260 SCREEN SIZE                 01550002
.*                  WHERE     VLSCR1(1) ON INDICATES SCR1 =  6X40       01600002
.*                            VLSCR1(2) ON INDICATES SCR1 = 12X40       01650002
.*                            VLSCR1(3) ON INDICATES SCR1 = 12X80       01700002
.*                            VLSCR1(4) ON INDICATES SCR1 = 15X64       01750002
.*                            VLSCR1(5) ON INDICATES SCR1 = 24X80       01800002
.*                            VLSCR1(6) ON INDICATES SCR1 = __X132      01850002
         LCLB  &VLSCR2(3)     REMEMBER 3270 SCREEN SIZE                 01900002
.*                  WHERE     VLSCR2(1) ON INDICATES SCR2 = 12X40       01950002
.*                            VLSCR2(2) ON INDICATES SCR2 = 24X80       02000002
.*                            VLSCR2(3) ON INDICATES SCR2 = __X132      02050002
         LCLA  &LATEMP        ARITHMETIC SCRATCH                        02100002
&LBMFE   SETB  ('&MF' EQ 'E')                                           02150002
&LBMFL   SETB  ('&MF' EQ 'L')                                           02200002
         AIF   (&LBMFE OR &LBMFL OR T'&MF EQ 'O').CKDACA1               02250002
         MNOTE 9,'MF=&MF INVALID, MACRO IGNORED.'                       02300002
         MEXIT                                                          02350002
.CKDACA1 ANOP                                                           02400002
&NORVOID SETC  '1'                                                      02450002
&NOPROT  SETC  '1'                                                      02500002
&LCM4    SETC  '000000'                                                 02550002
         AIF   (T'&DACAA NE 'O').CKDACA2                                02600002
         MNOTE 5,'DACA OPERAND OMITTED, REQUIRED PARAMETER.'            02650002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      02700002
         AGO   .CKOPTP1                                                 02750002
.CKDACA2 ANOP                                                           02800002
         AIF   ('&DACAA'(1,1) EQ '(' AND '&DACAA'(K'&DACAA,1)          -02850002
               EQ ')').DACAAR                                           02900002
         AGO   .CKOPTP1  IF DACAA IS NOT REGISTER, T' SHOULD BE U       02950002
.DACAAR  ANOP                                                           03000002
         AIF   (&LBMFE).CKDACA3    DACAA REGISTER ONLY FOR MF=E         03050002
.DACAMNT MNOTE 5,'DACA=&DACAA, REGISTER FORM INVALID.'                  03100002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      03150002
         AGO   .CKOPTP1                                                 03200002
.CKDACA3 ANOP                                                           03250002
&LBOPR(1) SETB (1)            REMEMBER DACA IS REGISTER                 03300002
         AIF   (T'&DACAA EQ 'U').CKOPTP1                                03350002
         AIF   (T'&DACAA NE 'N').DACAMNT                                03400002
&LCM1    SETC  '&DACAA'(2,K'&DACAA-2)                                   03450002
&LATEMP  SETA  &LCM1                                                    03500002
         AIF   (&LATEMP GE 1 AND &LATEMP LE 12).CKOPTP1                 03550002
         MNOTE 5,'DACA=&DACAA, ILLEGAL REGISTER.'                       03600002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      03650002
.CKOPTP1 ANOP                                                           03700002
         AIF   (T'&OPTYP NE 'O').CKOPTP2                                03750002
         MNOTE 5,'OPTYPE OPERAND OMITTED, REQUIRED PARAMETER.'          03800002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      03850002
         AGO   .CKSRA1                                                  03900002
.CKOPTP2 ANOP                                                           03950002
         AIF   (K'&OPTYP EQ 1).CKOPTP3                                  04000002
         MNOTE 5,'OPTYPE=&OPTYP, FIELD SIZE ILLEGAL.'                   04050002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      04100002
         AGO   .CKSRA1                                                  04150002
.CKOPTP3 ANOP                                                           04200002
         AIF   (T'&OPTYP EQ 'N').CKOPTP4                                04250002
&LCM1    SETC  T'&OPTYP                                                 04300002
         MNOTE 5,'OPTYPE=&OPTYP, TYPE-ATTRIBUTE &LCM1 ILLEGAL.'         04350002
&NOCODE  SETB  (1)                                                      04400002
         AGO   .CKSRA1                                                  04450002
.CKOPTP4 ANOP                                                           04500002
&LATEMP  SETA  &OPTYP                                                   04550002
         AIF   (&LATEMP LE 6).CKOPTP5                                   04600002
         MNOTE 5,'OPTYPE=&OPTYP, ILLEGAL OPERATION TYPE.'               04650002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      04700002
         AGO   .CKSRA1                                                  04750002
.CKOPTP5 ANOP                                                           04800002
&NLOPTYP SETB  ('&OPTYP' EQ '0')                                        04850002
&OPTP(3) SETB  ('&OPTYP' EQ '1')                                        04900002
&OPTP(4) SETB  ('&OPTYP' EQ '2')                                        04950002
&OPTP(5) SETB  ('&OPTYP' EQ '3')                                        05000002
&OPTP(6) SETB  ('&OPTYP' EQ '4')                                        05050002
&OPTP(7) SETB  ('&OPTYP' EQ '5')                                        05100002
&OPTP(8) SETB  ('&OPTYP' EQ '6')                                        05150002
.CKSRA1  ANOP                                                           05200002
         AIF   (T'&SOURA EQ 'O').CKSKA1                                 05250002
         AIF   ('&SOURA'(1,1) EQ '(' AND '&SOURA'(K'&SOURA,1) EQ ')').C-05300002
               KSRA2                                                    05350002
&LCM1    SETC  T'&SOURA                                                 05400002
         AIF   (T'&SOURA EQ 'C' OR T'&SOURA EQ 'F' OR T'&SOURA EQ 'H'  -05450002
               OR T'&SOURA EQ 'X' OR T'&SOURA EQ 'T' OR T'&SOURA EQ    -05500002
               'U').CKSKA1                                              05550002
         MNOTE 0,'SOURCE ADDRESS=&SOURA, TYPE-ATTRIBUTE &LCM1 MAY BE IM-05600002
               PROPER.'                                                 05650002
         AGO   .CKSKA1                                                  05700002
.CKSRA2  ANOP                                                           05750002
         AIF   (&LBMFL).CKSRAE1                                         05800002
&LBOPR(2) SETB (1)            REMEMBER SOURCE AREA IS REGISTER          05850002
         AIF   (T'&SOURA EQ 'U').CKSKA1                                 05900002
         AIF   (T'&SOURA NE 'N').CKSRAE1                                05950002
&LCM1    SETC  '&SOURA'(2,K'&SOURA-2)                                   06000002
&LATEMP  SETA  &LCM1                                                    06050002
         AIF   (&LATEMP GE 2 AND &LATEMP LE 12).CKSKA1                  06100002
         MNOTE 5,'SOURCE AREA=&SOURA, ILLEGAL REGISTER.'                06150002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      06200002
         AGO   .CKSKA1                                                  06250002
.CKSRAE1 ANOP                                                           06300002
         MNOTE 5,'SOURCE AREA=&SOURA, REGISTER FORM INVALID.'           06350002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      06400002
.CKSKA1  ANOP                                                           06450002
         AIF   (T'&SINKA EQ 'O').CKSRL1                                 06500002
         AIF   ('&SINKA'(1,1) EQ '(' AND '&SINKA'(K'&SINKA,1) EQ ')').C-06550002
               KSKA2                                                    06600002
&LCM1    SETC  T'&SINKA                                                 06650002
         AIF   ('&LCM1' EQ 'C' OR '&LCM1' EQ 'F' OR '&LCM1' EQ 'H' OR  -06700002
               '&LCM1' EQ 'X' OR '&LCM1' EQ 'T' OR '&LCM1' EQ 'U').CKSR-06750002
               L1                                                       06800002
         MNOTE 0,'SINK ADDRESS=&SINKA, TYPE-ATTRIBUTE &LCM1 MAY BE IMPR-06850002
               OPER.'                                                   06900002
         AGO   .CKSRL1                                                  06950002
.CKSKA2  ANOP                                                           07000002
         AIF   (&LBMFL).CKSKAE1                                         07050002
&LBOPR(3) SETB (1)            REMEMBER SINK AREA IS REGISTER            07100002
         AIF   (T'&SINKA EQ 'U').CKSRL1                                 07150002
         AIF   (T'&SINKA NE 'N').CKSKAE1                                07200002
&LCM1    SETC  '&SINKA'(2,K'&SINKA-2)                                   07250002
&LATEMP  SETA  &LCM1                                                    07300002
         AIF   (&LATEMP GE 2 AND &LATEMP LE 12).CKSRL1                  07350002
         MNOTE 5,'SINK AREA=&SINKA, ILLEGAL REGISTER.'                  07400002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      07450002
         AGO   .CKSRL1                                                  07500002
.CKSKAE1 ANOP                                                           07550002
         MNOTE 5,'SINK AREA=&SINKA, REGISTER FORM INVALID.'             07600002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      07650002
.CKSRL1  ANOP                                                           07700002
         AIF   (T'&SOURL EQ 'O').CKSKL1                                 07750002
         AIF   ('&SOURL'(1,1) EQ '(' AND '&SOURL'(K'&SOURL,1) EQ ')').C-07800002
               KSRL3                                                    07850002
&LCM1    SETC  T'&SOURL                                                 07900002
         AIF   ('&LCM1' EQ 'U').CKSKL1                                  07950002
         AIF   ('&LCM1' EQ 'N').CKSRL2                                  08000002
         MNOTE 5,'SOURCE LENGTH=&SOURL, TYPE-ATTRIBUTE &LCM1 ILLEGAL.  -08050002
               '                                                        08100002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      08150002
         AGO   .CKSKL1                                                  08200002
.CKSRL2  ANOP                                                           08250002
&LATEMP  SETA  &SOURL                                                   08300002
         AIF   (&LATEMP GE 1 AND &LATEMP LE 32767).CKSKL1               08350002
         MNOTE 5,'SOURCE LENGTH=&SOURL, VALUE ILLEGAL.'                 08400002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      08450002
         AGO   .CKSKL1                                                  08500002
.CKSRL3  ANOP                                                           08550002
         AIF   (&LBMFL).CKSRLE1                                         08600002
&LBOPR(4) SETB (1)            REMEMBER SOURCE LENGTH IS REGISTER        08650002
         AIF   (T'&SOURL EQ 'U').CKSKL1                                 08700002
         AIF   (T'&SOURL NE 'N').CKSRLE1                                08750002
&LCM1    SETC  '&SOURL'(2,K'&SOURL-2)                                   08800002
&LATEMP  SETA  &LCM1                                                    08850002
         AIF   (&LATEMP GE 2 AND &LATEMP LE 12).CKSKL1                  08900002
         MNOTE 5,'SOURCE LENGTH=&SOURL, ILLEGAL REGISTER.'              08950002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      09000002
         AGO   .CKSKL1                                                  09050002
.CKSRLE1 ANOP                                                           09100002
         MNOTE 5,'SOURCE LENGTH=&SOURL, REGISTER FORM INVALID.'         09150002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      09200002
.CKSKL1  ANOP                                                           09250002
         AIF   (T'&SINKL EQ 'O').CKDVD1                                 09300002
         AIF   ('&SINKL'(1,1) EQ '(' AND '&SINKL'(K'&SINKL,1) EQ ')').C-09350002
               KSKL3                                                    09400002
&LCM1    SETC  T'&SINKL                                                 09450002
         AIF   ('&LCM1' EQ 'U').CKDVD1                                  09500002
         AIF   ('&LCM1' EQ 'N').CKSKL2                                  09550002
         MNOTE 5,'SINK LENGTH=&SINKL, TYPE-ATTRIBUTE &LCM1 ILLEGAL.'    09600002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      09650002
         AGO   .CKDVD1                                                  09700002
.CKSKL2  ANOP                                                           09750002
&LATEMP  SETA  &SINKL                                                   09800002
         AIF   (&LATEMP GE 1 AND &LATEMP LE 32767).CKDVD1               09850002
         MNOTE 5,'SINK LENGTH=&SINKL, VALUE ILLEGAL.'                   09900002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      09950002
         AGO   .CKDVD1                                                  10000002
.CKSKL3  ANOP                                                           10050002
         AIF   (&LBMFL).CKSKLE1                                         10100002
&LBOPR(5) SETB (1)            REMEMBER SINK LENGTH IS REGISTER          10150002
         AIF   (T'&SINKL EQ 'U').CKDVD1                                 10200002
         AIF   (T'&SINKL NE 'N').CKSKLE1                                10250002
&LCM1    SETC  '&SINKL'(2,K'&SINKL-2)                                   10300002
&LATEMP  SETA  &LCM1                                                    10350002
         AIF   (&LATEMP GE 2 AND &LATEMP LE 12).CKDVD1                  10400002
         MNOTE 5,'SINK LENGTH=&SINKL, ILLEGAL REGISTER.'                10450002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      10500002
         AGO   .CKDVD1                                                  10550002
.CKSKLE1 ANOP                                                           10600002
         MNOTE 5,'SINK LENGTH=&SINKL, REGISTER FORM INVALID.'           10650002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      10700002
.CKDVD1  ANOP                                                           10750002
         AIF   (T'&DEVAD EQ 'O').CKSR11                                 10800002
         AIF   (K'&DEVAD LE 2).CKDVD2                                   10850002
         MNOTE 5,'2260 DEVICE ADDRESS=&DEVAD INVALID.'                  10900002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      10950002
.CKDVD2  ANOP                                                           11000002
.CKSR11  ANOP                                                           11050002
         AIF   (T'&SCR1 EQ 'O').CKSR13                                  11100002
&LCM1    SETC  T'&SCR1                                                  11150002
         AIF   ('&LCM1' EQ 'U').CKSR12                                  11200002
         MNOTE 5,'2260 SCREEN SIZE=&SCR1, TYPE-ATTRIBUTE &LCM1 ILLEGAL.-11250002
               '                                                        11300002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      11350002
         AGO   .CKSR21                                                  11400002
.CKSR12  ANOP                                                           11450002
&VLSCR1(1) SETB ('&SCR1' EQ  '6X40')                                    11500002
&VLSCR1(2) SETB ('&SCR1' EQ '12X40')                                    11550002
&VLSCR1(3) SETB ('&SCR1' EQ '12X80')                                    11600002
&VLSCR1(4) SETB ('&SCR1' EQ '15X64')                                    11650002
&VLSCR1(5) SETB ('&SCR1' EQ '24X80')                                    11700002
&VLSCR1(6) SETB ('&SCR1'(K'&SCR1-3,4) EQ 'X132')                        11750002
         AIF   (&VLSCR1(1) OR &VLSCR1(2) OR &VLSCR1(3) OR &VLSCR1(4)   -11800002
               OR &VLSCR1(5) OR &VLSCR1(6)).CKSR21                      11850002
         MNOTE 5,'2260 SCREEN SIZE=&SCR1, VALUE ILLEGAL.'               11900002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      11950002
         AGO   .CKSR21                                                  12000002
.CKSR13  ANOP                                                           12050002
&OMSCR1  SETB  (1)            REMEMBER THAT &SCR1 IS OMITTED            12100002
.CKSR21  ANOP                                                           12150002
         AIF   (T'&SCR2 EQ 'O').SETSCRN                                 12200002
&LCM1    SETC  T'&SCR2                                                  12250002
         AIF   ('&LCM1' EQ 'U').CKSR22                                  12300002
         MNOTE 5,'3270 SCREEN SIZE=&SCR2, TYPE-ATTRIBUTE &LCM1 ILLEGAL.-12350002
               '                                                        12400002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      12450002
         AGO  .CKRVD1                                                   12500002
.CKSR22  ANOP                                                           12550002
&VLSCR2(1) SETB ('&SCR2' EQ '12X40')                                    12600002
&VLSCR2(2) SETB ('&SCR2' EQ '24X80')                                    12650002
&VLSCR2(3) SETB ('&SCR2'(K'&SCR2-3,4) EQ 'X132')                        12700002
         AIF   (&VLSCR2(1) OR &VLSCR2(2) OR &VLSCR2(3)).CKSR23          12750002
         MNOTE 5,'3270 SCREEN SIZE=&SCR2, VALUE ILLEGAL.'               12800002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      12850002
         AGO   .CKRVD1                                                  12900002
.CKSR23  ANOP                                                           12950002
         AIF   (NOT &OMSCR1).SETSCRN                                    13000002
&VLSCR1(2) SETB (&VLSCR2(1))                                            13050002
&VLSCR1(5) SETB (&VLSCR2(2))                                            13100002
&VLSCR1(6) SETB (&VLSCR2(3))                                            13150002
.SETSCRN ANOP                                                           13200002
         AIF   (NOT &VLSCR2(1)).SCRNOK1                                 13250002
         AIF   (&VLSCR1(3) OR &VLSCR1(4) OR &VLSCR1(5) OR &VLSCR1(6)).S-13300002
               CRNBAD                                                   13350002
.SCRNOK1 ANOP                                                           13400002
         AIF   (&VLSCR2(2) AND &VLSCR1(6)).SCRNBAD                      13450002
         AGO   .SCRNOK2                                                 13500002
.SCRNBAD ANOP                                                           13550002
         MNOTE 5,'2260 SCREEN SIZE IS GREATER THAN 3270 SCREEN SIZE'    13600002
&NOCODE  SETB  (1)                                                      13650002
         AGO   .CKRVD1                                                  13700002
.SCRNOK2 ANOP                                                           13750002
         AIF   (NOT &VLSCR1(1)).DACAG9                                  13800002
&SCREEN6 SETC  '0628'                                                   13850002
         AGO   .CKRVD1                                                  13900002
.DACAG9  ANOP                                                           13950002
         AIF   (NOT &VLSCR1(2)).DACAG10                                 14000002
&SCREEN6 SETC  '0C28'                                                   14050002
         AGO   .CKRVD1                                                  14100002
.DACAG10 ANOP                                                           14150002
         AIF   (NOT &VLSCR1(3)).DACAG11                                 14200002
&SCREEN6 SETC  '0C50'                                                   14250002
         AGO   .CKRVD1                                                  14300002
.DACAG11 ANOP                                                           14350002
         AIF   (NOT &VLSCR1(4)).DACAG12                                 14400002
&SCREEN6 SETC  '0F40'                                                   14450002
         AGO   .CKRVD1                                                  14500002
.DACAG12 ANOP                                                           14550002
         AIF   (NOT &VLSCR1(5)).DCAG12E                                 14600002
&SCREEN6 SETC  '1850'                                                   14650002
         AGO   .CKRVD1                                                  14700002
.DCAG12E ANOP                                                           14750002
&SCREEN6 SETC  'FF84'                                                   14800002
.CKRVD1  ANOP                                                           14850002
         AIF   (T'&RVOID EQ 'O').CKPRT1                                 14900002
&OPTP(1) SETB  ('&RVOID' EQ 'YES')                                      14950002
         AIF   ('&RVOID' EQ 'YES' OR '&RVOID' EQ 'NO').CKPRT1           15000002
         MNOTE 5,'RVOID=&RVOID, VALUE ILLEGAL.'                         15050002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      15100002
.CKPRT1  ANOP                                                           15150002
         AIF   (T'&PROT EQ 'O').CKCODE                                  15200002
&OPTP(2) SETB  ('&PROT' EQ 'YES')                                       15250002
         AIF   ('&PROT' EQ 'YES' OR '&PROT' EQ 'NO').CKCODE             15300002
         MNOTE 5,'PROT=&PROT, VALUE ILLEGAL.'                           15350002
&NOCODE  SETB  (1)            SKIP CODE GENERATION                      15400002
.CKCODE  ANOP                                                           15450002
         AIF   (NOT &NOCODE).SRCODE                                     15500002
         MNOTE 9,'CODE GENERATION SUPPRESSED.'                          15550002
         MEXIT                                                          15600002
.*                                                                      15650002
.*       CODE GENERATION                                                15700002
.*                                                                      15750002
.SRCODE  ANOP                                                           15800002
         AIF   (&LBMFE).GENMFE                                          15850002
         AIF   (&LBMFL).GENMFL                                          15900002
.*                                                                      15950002
.*       OTHERWISE, GENERATE CODE FOR MF OMITTED                        16000002
         CNOP  0,4                                                      16050002
&NAME    BAL   1,*+28         SET ADDRESS OF DACA AND BRANCH AROUND     16100002
         AGO   .DACAGEN                                                 16150002
.*                                                                      16200002
.GENMFL  ANOP                 GENERATE CODE FOR MF=L                    16250002
&NAME    DC    0F'0'                                                    16300002
.*                                                                      16350002
.DACAGEN ANOP                                                           16400002
&DACAA   DC    H'0'                     CURSOR ADDRESS                  16450002
         DC    X'FFFF'                  SOM ADDRESS                     16500002
         AIF   (&LBOPR(2) OR T'&SOURA EQ 'O').DACAG1                    16550002
         DC    AL4(&SOURA)              SOURCE AREA ADDRESS             16600002
         AGO   .DACAG2                                                  16650002
.DACAG1  ANOP                                                           16700002
         DC    AL4(0)                   NULL SOURCE AREA ADDRESS        16750002
.DACAG2  ANOP                                                           16800002
         AIF   (&LBOPR(3) OR T'&SINKA EQ 'O').DACAG3                    16850002
         DC    AL4(&SINKA)              SINK AREA ADDRESS               16900002
         AGO   .DACAG4                                                  16950002
.DACAG3  ANOP                                                           17000002
         DC    AL4(0)                   NULL SINK AREA ADDRESS          17050002
.DACAG4  ANOP                                                           17100002
         AIF   (&LBOPR(4) OR T'&SOURL EQ 'O').DACAG5                    17150002
         DC    Y(&SOURL)                SOURCE AREA LENGTH              17200002
         AGO   .DACAG6                                                  17250002
.DACAG5  ANOP                                                           17300002
         DC    Y(0)                     NULL SOURCE AREA LENGTH         17350002
.DACAG6  ANOP                                                           17400002
         AIF   (&LBOPR(5) OR T'&SINKL EQ 'O').DACAG7                    17450002
         DC    Y(&SINKL)                SINK AREA LENGTH                17500002
         AGO   .DACAG8                                                  17550002
.DACAG7  ANOP                                                           17600002
         DC    Y(0)                     NULL SINK AREA LENGTH           17650002
.DACAG8  ANOP                                                           17700002
         AIF   (&OMSCR1).DACAG13                                        17750002
         DC    X'&SCREEN6'              2260 SCREEN ADDRESS             17800002
         AGO   .DACAG16                                                 17850002
.DACAG13 ANOP                                                           17900002
         AIF   (T'&SCR2 NE 'O').DACAG14                                 17950002
         DC    X'0000'                  NULL 2260 SCREEN SIZE           18000002
         AGO   .DACAG16                                                 18050002
.DACAG14 ANOP                                                           18100002
         DC    X'&SCREEN6'              2260 SCREEN SIZE = 3270         18150002
.DACAG16 ANOP                                                           18200002
         AIF   (T'&SCR2 NE 'O').DACAG17                                 18250002
         DC    X'0000'                  NULL 3270 SCREEN SIZE           18300002
         AGO   .DACAG19                                                 18350002
.DACAG17 ANOP                                                           18400002
         AIF   (NOT &VLSCR2(1)).DACAG18                                 18450002
         DC    X'0C28'                  3270 SCREEN SIZE                18500002
         AGO   .DACAG19                                                 18550002
.DACAG18 ANOP                                                           18600002
         AIF   (NOT &VLSCR2(2)).DCAG18E                                 18650002
         DC    X'1850'                  3270 SCREEN SIZE                18700002
         AGO   .DACAG19                                                 18750002
.DCAG18E ANOP                                                           18800002
         DC    X'FF84'                  3270 LINE LENGTH                18850002
.DACAG19 ANOP                                                           18900002
         AIF   (T'&DEVAD NE 'O').DACAG20                                18950002
         DC    X'00'                    NULL 2260 DEVICE ADDRESS        19000002
         AGO   .DACAG21                                                 19050002
.DACAG20 ANOP                                                           19100002
         DC    X'&DEVAD'                2260 DEVICE ADDRESS             19150002
.DACAG21 ANOP                                                           19200002
         DC    B'&OPTP(1)&OPTP(2)&OPTP(3)&OPTP(4)&OPTP(5)&OPTP(6)&OPTP(-19250002
               7)&OPTP(8)'              OPTYPE BYTE                     19300002
         DC    X'0000'                  RESERVED                        19350002
         AIF   (&LBMFL).MEND            DONE IF MF=L                    19400002
         AIF   (NOT &LBOPR(2)).GLINK1                                   19450002
&LCM2    SETC  '&SOURA'(2,K'&SOURA-2)                                   19500002
         ST    &LCM2,4(1)               STORE SOURCE ADDRESS REG        19550002
.GLINK1  ANOP                                                           19600002
         AIF   (NOT &LBOPR(3)).GLINK2                                   19650002
&LCM2    SETC  '&SINKA'(2,K'&SINKA-2)                                   19700002
         ST    &LCM2,8(1)               STORE SINK ADDRESS REG          19750002
.GLINK2  ANOP                                                           19800002
         AIF   (NOT &LBOPR(4)).GLINK3                                   19850002
&LCM2    SETC  '&SOURL'(2,K'&SOURL-2)                                   19900002
         STH   &LCM2,12(1)              STORE SOURCE LENGTH REG         19950002
.GLINK3  ANOP                                                           20000002
&LCM1    SETC  ' '                                                      20050002
         AIF   (NOT &LBOPR(5)).GENLINK                                  20100002
&LCM2    SETC  '&SINKL'(2,K'&SINKL-2)                                   20150002
         STH   &LCM2,14(1)              STORE SINK LENGTH REG           20200002
         AGO   .GENLINK                                                 20250002
.*                                                                      20300002
.*                                                                      20350002
.GENMFE  ANOP                                                           20400002
.*                                                                      20450002
.*                                                                      20500002
&LCM1    SETC  '&NAME'                  PICK UP NAME, IF ANY            20550002
         AIF   (&LBOPR(1)).RDACA        TEST FOR REGISTER DACA          20600002
&LCM1    LA    1,&DACAA                 GET DACA ADDRESS                20650002
&LCM1    SETC  ' '                      NULLIFY ANY EXISTING NAME       20700002
         AGO   .RDACA1                                                  20750002
.RDACA   ANOP                                                           20800002
         AIF   ('&DACAA'(2,K'&DACAA-2) EQ '1').RDACA1  LEGIT REG 1      20850002
&LCM1    LR    1,&DACAA(1)              LOAD 1 FROM USER REGISTER       20900002
&LCM1    SETC  ' '            CLEAR NAME IF ANY                         20950002
.RDACA1  ANOP                                                           21000002
         AIF   (T'&SOURA EQ 'O').RDACA3                                 21050002
         AIF   (&LBOPR(2)).RDACA2                                       21100002
&LCM1    LA    14,&SOURA                GET SOURCE AREA ADDRESS         21150002
         ST    14,4(1)                  PLACE SOURCE ADDRESS IN YA01255 21200002
&LCM1    SETC  ' '                                                      21250002
         AGO   .RDACA3                                                  21300002
.RDACA2  ANOP                                                           21350002
&LCM2    SETC  '&SOURA'(2,K'&SOURA-2)                                   21400002
&LCM1    ST    &LCM2,4(1)               STORE SOURCE ADDRESS REG        21450002
&LCM1    SETC  ' '                                                      21500002
.RDACA3  ANOP                                                           21550002
         AIF   (T'&SINKA EQ 'O').RDACA5                                 21600002
         AIF   (&LBOPR(3)).RDACA4                                       21650002
&LCM1    LA    14,&SINKA                GET SINK AREA ADDRESS           21700002
         ST    14,8(1)                  PLACE SINK ADDRESS IN   YA01255 21750002
&LCM1    SETC  ' '                                                      21800002
         AGO   .RDACA5                                                  21850002
.RDACA4  ANOP                                                           21900002
&LCM2    SETC  '&SINKA'(2,K'&SINKA-2)                                   21950002
&LCM1    ST    &LCM2,8(1)               STORE SINK ADDRESS REG          22000002
&LCM1    SETC  ' '                                                      22050002
.RDACA5  ANOP                                                           22100002
         AIF   (T'&SOURL EQ 'O').RDACA7                                 22150002
         AIF   (&LBOPR(4)).RDACA6                                       22200002
&LCM1    B     *+6                                                      22250002
         DC    AL2(&SOURL)              SOURCE LENGTH                   22300002
         MVC   12(2,1),*-2              MOVE IN SOURCE LENGTH           22350002
&LCM1    SETC  ' '                                                      22400002
         AGO   .RDACA7                                                  22450002
.RDACA6  ANOP                                                           22500002
&LCM2    SETC  '&SOURL'(2,K'&SOURL-2)                                   22550002
&LCM1    STH   &LCM2,12(1)              STORE SOURCE LENGTH REG         22600002
&LCM1    SETC  ' '                                                      22650002
.RDACA7  ANOP                                                           22700002
         AIF   (T'&SINKL EQ 'O').RDACA9                                 22750002
         AIF   (&LBOPR(5)).RDACA8                                       22800002
&LCM1    B     *+6                                                      22850002
         DC    AL2(&SINKL)              SINK LENGTH                     22900002
         MVC   14(2,1),*-2              MOVE IN SINK LENGTH             22950002
&LCM1    SETC  ' '                                                      23000002
         AGO   .RDACA9                                                  23050002
.RDACA8  ANOP                                                           23100002
&LCM2    SETC  '&SINKL'(2,K'&SINKL-2)                                   23150002
&LCM1    STH   &LCM2,14(1)              STORE SINK LENGTH REG           23200002
&LCM1    SETC  ' '                                                      23250002
.RDACA9  ANOP                                                           23300002
         AIF   (&OMSCR1).RDACA14                                        23350002
&LCM1    B     *+6                                                      23400002
         DC    X'&SCREEN6'              2260 SCREEN SIZE                23450002
         MVC   16(2,1),*-2              MOVE IN 2260 SCREEN SIZE        23500002
&LCM1    SETC  ' '                                                      23550002
         AGO   .RDACA16                                                 23600002
.RDACA14 ANOP                                                           23650002
         AIF   (T'&SCR2 EQ 'O').RDACA16                                 23700002
&LCM1    B     *+6                                                      23750002
         DC    X'&SCREEN6'              2260 = 3270 SCREEN SIZE         23800002
         MVC   16(2,1),*-2              MOVE IN 2260 SCREEN SIZE        23850002
&LCM1    SETC  ' '                                                      23900002
.RDACA16 ANOP                                                           23950002
         AIF    (T'&SCR2 EQ 'O').RDACA18                                24000002
         AIF   (NOT &VLSCR2(1)).RDACA17                                 24050002
&LCM1    B     *+6                                                      24100002
         DC    X'0C28'                  3270 SCREEN SIZE                24150002
         MVC   18(2,1),*-2              MOVE IN 3270 SCREEN SIZE        24200002
&LCM1    SETC  ' '                                                      24250002
         AGO   .RDACA18                                                 24300002
.RDACA17 ANOP                                                           24350002
         AIF   (NOT &VLSCR2(2)).RDCA17E                                 24400002
&LCM1    B     *+6                                                      24450002
         DC    X'1850'                  3270 SCREEN SIZE                24500002
         MVC   18(2,1),*-2              MOVE IN 3270 SCREEN SIZE        24550002
&LCM1    SETC  ' '                                                      24600002
         AGO   .RDACA18                                                 24650002
.RDCA17E ANOP                                                           24700002
&LCM1    B     *+6                                                      24750002
         DC    X'FF84'                  3270 LINE LENGTH                24800002
         MVC   18(2,1),*-2              MOVE IN 3270 LINE LENGTH        24850002
&LCM1    SETC  ' '                      NULLIFY ANY EXISTING NAME       24900002
.RDACA18 ANOP                                                           24950002
         AIF   (T'&DEVAD EQ 'O').RDACA19                                25000002
&LCM1    MVI   20(1),X'&DEVAD'          MOVE 2260 DEVICE ADDRESS        25050002
&LCM1    SETC  ' '                                                      25100002
.RDACA19 ANOP                                                           25150002
         AIF   (NOT &NLOPTYP).RDACA20                                   25200002
&LCM4    SETC  '111111'                                                 25250002
.RDACA20 ANOP                                                           25300002
         AIF   (NOT &NLOPTYP  AND   T'&RVOID NE 'O' AND T'&PROT NE 'O')-25350002
               .RDACA24                                                 25400002
         AIF   (&NLOPTYP AND T'&RVOID EQ 'O' AND T'&PROT EQ 'O').GENLIN-25450002
               K                                                        25500002
         AIF   ('&RVOID' NE 'NO').RDACA31                               25550002
&NORVOID SETC  '0'                                                      25600002
.RDACA31 ANOP                                                           25650002
         AIF   ('&PROT' NE 'NO').RDACA32                                25700002
&NOPROT  SETC  '0'                                                      25750002
.RDACA32 ANOP                                                           25800002
         AIF   ('&RVOID' EQ 'NO' OR '&PROT' EQ 'NO' OR NOT &NLOPTYP).RD-25850002
               ACA21                                                    25900002
         AGO   .RDACA22                                                 25950002
.RDACA21 ANOP                                                           26000002
&LCM3    SETC  '&NORVOID'.'&NOPROT'.'&LCM4'                             26050002
&LCM1    NI    21(1),B'&LCM3'                                           26100002
&LCM1    SETC  ' '                                                      26150002
.RDACA22 ANOP                                                           26200002
         AIF   ('&RVOID' EQ 'YES' OR '&PROT' EQ 'YES' OR NOT &NLOPTYP).-26250002
               RDACA23                                                  26300002
         AGO   .GENLINK                                                 26350002
.RDACA23 ANOP                                                           26400002
&LCM1    OI    21(1),B'&OPTP(1)&OPTP(2)&OPTP(3)&OPTP(4)&OPTP(5)&OPTP(6)-26450002
               &OPTP(7)&OPTP(8)'                                        26500002
&LCM1    SETC  ' '                                                      26550002
         AGO   .GENLINK                                                 26600002
.RDACA24 ANOP                                                           26650002
&LCM1    MVI   21(1),B'&OPTP(1)&OPTP(2)&OPTP(3)&OPTP(4)&OPTP(5)&OPTP(6)-26700002
               &OPTP(7)&OPTP(8)'        MOVE OPTYPE BYTE                26750002
&LCM1    SETC  ' '                                                      26800002
.GENLINK ANOP                                                           26850002
         CNOP  0,4                      ALIGN TO A FULL WORD            26900002
&LCM1    BAL   15,*+8                   GET ADDRESS OF VCON             26950002
         DC    V(IECTSCAN)              ADDRESS OF IECTSCAN ROUTINE     27000002
         L     15,0(15)                 LOAD ADDRESS OF IECTSCAN        27050002
         BALR  14,15                    LINK TO IECTSCAN ROUTINE        27100002
.MEND    MEND                                                           27150002
