         MACRO                                                 @Z40MSCD 00050000
&ANYNAME SETPRT &DCB,&UCS=,&FCB=,&MF=,&OPTCD=,&COPIES=,&BURST=,&FLASH=,X00100000
               &MODIFY=,&CHARS=,&COPYNR=,&INIT=,&REXMIT=,      @G38ESMHX00133300
               &DISP=,&PRTMSG=,&MSGAREA=,&LIBDCB=              @G38ESMH 00166600
.*                                                             @Z40MSCD 00200000
.*   THE SETPRT MACRO FOR VS/2-4                               @Z40MSCD 00250000
.*                                                             @Z40MSCD 00300000
.* LAST CHANGE                                                 @ZA51640 00310000
.* C422500,423500                                              @ZA51640 00320000
.* C120708                                                     @ZA58194 00325000
.*                                                                      00330000
         LCLA  &SPPLEN                  LENGTH OF PARM LIST    @G38ESMH 00340000
         LCLA  &NO                      BRACH INDEX NUMBER     @Z40MSCD 00350000
         LCLA  &K                       LENG OF DCB PARM       @Z40MSCD 00650000
         LCLC  &STRIP                   REMOVE 1ST 2 AND LAST CHAR      00700000
         LCLB  &DCBNREG                 DCB IN REG SWITCH      @Z40MSCD 00750000
         LCLB  &MSGANRG                 MSGAREA IN REG SWITCH  @G38ESMH 00766600
         LCLB  &LDCBNRG                 LIBDCB IN REG SWITCH   @G38ESMH 00783200
         LCLB  &FCBNCOR                 FCB IN STORAGE         @Z40MSCD 00800000
         LCLB  &FCBNREG                 FCB IN REGISTER        @Z40MSCD 00850000
         LCLB  &FCBILIB                 FCB ON SYS1.IMAGELIB   @Z40MSCD 00900000
         LCLB  &MODNCOR                 MOD IN STORAGE         @Z40MSCD 01200000
         LCLB  &MODNREG                 MOD IN REGISTER        @Z40MSCD 01250000
         LCLB  &MODILIB                 MOD ON SYS1.IMAGELIB   @Z40MSCD 01300000
         LCLB  &CH1NCOR                 CH1 IN STORAGE         @Z40MSCD 01350000
         LCLB  &CH1NREG                 CH1 IN REGISTER        @Z40MSCD 01400000
         LCLB  &CH1ILIB                 CH1 ON SYS1.IMAGELIB   @Z40MSCD 01450000
         LCLB  &CH2NCOR                 CH2 IN STORAGE         @Z40MSCD 01500000
         LCLB  &CH2NREG                 CH2 IN REGISTER        @Z40MSCD 01800000
         LCLB  &CH2ILIB                 CH2 ON SYS1.IMAGELIB   @Z40MSCD 01850000
         LCLB  &CH3NCOR                 CH3 IN STORAGE         @Z40MSCD 01900000
         LCLB  &CH3NREG                 CH3 IN REGISTER        @Z40MSCD 01950000
         LCLB  &CH3ILIB                 CH3 ON SYS1.IMAGELIB   @Z40MSCD 02000000
         LCLB  &CH4NCOR                 CH4 IN STORAGE         @Z40MSCD 02050000
         LCLB  &CH4NREG                 CH4 IN REGISTER        @Z40MSCD 02100000
         LCLB  &CH4ILIB                 CH4 ON SYS1.IMAGELIB   @Z40MSCD 02400000
         LCLC  &PAREN1                  1ST CHAR OF DCB PARM   @Z40MSCD 02450000
         LCLC  &PAREN2                  LAST CHAR OF DCB PARM  @Z40MSCD 02500000
         LCLC  &PAREN3                  1ST CHAR OF 2ND MF PARM         02550000
         LCLC  &PAREN4                  LST CHAR OF 2ND MF PARM         02600000
         LCLA  &TO                      TO MOVE ADDR - LIST    @Z40MSCD 02650000
         LCLA  &FROM                    FROM MOVE ADDR - CODE  @Z40MSCD 03000000
         LCLA  &LENG                    LENGTH OF MOVE         @Z40MSCD 03050000
         LCLB  &DCSW                    MOVE SWITCH            @Z40MSCD 03100000
         LCLB  &ERRSW                   AN ERROR WAS DETECTED  @Z40MSCD 03150000
         LCLB  &SWDCBA                  MOVE DCB PARM          @Z40MSCD 03200000
         LCLB  &SWUCS1                  MOVE UCS PARM 1        @Z40MSCD 03250000
         LCLB  &SWUCS2                  MOVE UCS PARM 2        @Z40MSCD 03300000
         LCLB  &SWUCS3                  MOVE UCS PARM 3        @Z40MSCD 03600000
         LCLB  &SWOPTC                  MOVE OPTCD PARM        @Z40MSCD 03650000
         LCLB  &SWFCB1                  MOVE FCB PARM 1        @Z40MSCD 03700000
         LCLB  &SWFCB2                  MOVE FCB PARM 2        @Z40MSCD 03750000
         LCLB  &SWFLG1                  MOVE FLAG 1            @Z40MSCD 03800000
         LCLB  &SWFLG2                  MOVE FLAG 2            @Z40MSCD 03850000
         LCLB  &SWCPYS                  MOVE COPIES PARM       @Z40MSCD 03900000
         LCLB  &SWCPNR                  MOVE COPY NUMBER PARM  @Z40MSCD 04200000
         LCLB  &SWLEN                   LENGTH BYTES           @G38ESMH 04250000
         LCLB  &SWFLHC                  MOVE FLASH COUNT PARM  @Z40MSCD 04300000
         LCLB  &SWTRCN                  MOVE MODIFY TRC PARM   @Z40MSCD 04350000
         LCLB  &SWMODI                  MOVE MODIFY ID PARM    @Z40MSCD 04400000
         LCLB  &SWFLSH                  MOVE FLASH ID PARM     @Z40MSCD 04450000
         LCLB  &SWCHAR                  MOVE CHARS PARM        @Z40MSCD 04800000
         LCLB  &SWMSGA                  MOVE MSGAREA PARM      @G38ESMH 04802700
         LCLB  &SWLDCB                  MOVE LIBDCB PARM       @G38ESMH 04805400
         LCLB  &BLKON                   SET BLOCK BIT          @G38ESMH 04808100
         LCLB  &UBLKON                  SET UNBLOCK BIT        @G38ESMH 04810800
         LCLB  &SCDON                   SET SCHEDULE BIT       @G38ESMH 04813500
         LCLB  &NOSCDON                 SET NOSCHEDULE BIT     @G38ESMH 04816200
         LCLB  &UFLDON                  SET UNFOLD BIT         @G38ESMH 04818900
         LCLB  &FLDON                   SET FOLD BIT           @G38ESMH 04821600
         LCLB  &RESVD                   RESERVED BIT           @G38ESMH 04824300
         LCLB  &RESVDOF                 RESERVED BIT RESET     @G38ESMH 04827000
         LCLB  &EXTLST                  EXTENDED PARM LIST     @G38ESMH 04829700
         LCLB  &BLKOFF                  CLEAR BLOCK BIT        @G38ESMH 04832400
         LCLB  &UBLKOFF                 CLEAR UNBLOCK BIT      @G38ESMH 04835100
         LCLB  &SCDOFF                  CLEAR SCHEDULE BIT     @G38ESMH 04837800
         LCLB  &NOSCDOF                 CLEAR NOSCHEDULE BIT   @G38ESMH 04840500
         LCLB  &UFLDOFF                 CLEAR UNFOLD BIT       @G38ESMH 04843200
         LCLB  &FLDOFF                  CLEAR FOLD BIT         @G38ESMH 04845900
         LCLB  &BRSTON                  BRSTON ON              @Z40MSCD 04850000
         LCLB  &RXMTON                  RXMTON ON              @Z40MSCD 04900000
         LCLB  &INITON                  INITON ON              @Z40MSCD 04950000
         LCLB  &NOPRTON                 SET NO PRTMSG BIT      @G38ESMH 04975000
         LCLB  &BRSTOFF                 SET FLAG 1 NEG         @Z40MSCD 05000000
         LCLB  &RXMTOFF                 SET FLAG 1 NEG         @Z40MSCD 05050000
         LCLB  &INITOFF                 SET FLAG 1 NEG         @Z40MSCD 05100000
         LCLB  &NOPRTOF                 CLEAR NO PRTMSG BIT    @G38ESMH 05150000
&NO      SETA  &SYSNDX                  SET BRANCH INDEX NUMBER         05400000
&SPPLEN  SETA  56                       LENGTH OF PARM LIST    @G38ESMH 05405000
&RESVDOF SETB  1                        DO NOT CLEAR RESERVED  @G38ESMH 05410000
&BLKOFF  SETB  1                        INIT OPTC-DISP FLAG NEG@G38ESMH 05415000
&UBLKOFF SETB  1                        INIT OPTC-DISP FLAG NEG@G38ESMH 05420000
&SCDOFF  SETB  1                        INIT OPTC-DISP FLAG NEG@G38ESMH 05425000
&NOSCDOF SETB  1                        INIT OPTC-DISP FLAG NEG@G38ESMH 05430000
&UFLDOFF SETB  1                        INIT OPTC-DISP FLAG NEG@G38ESMH 05435000
&FLDOFF  SETB  1                        INIT OPTC-DISP FLAG NEG@G38ESMH 05440000
&EXTLST  SETB  1                        INIT EXT. PARM LIST    @G38ESMH 05445000
&BRSTOFF SETB  (1)                      INIT. FLAG 1 NEGS      @Z40MSCD 05450000
&RXMTOFF SETB  (1)                      INIT FLAG 1 NEGS       @Z40MSCD 05500000
&INITOFF SETB  (1)                      INIT. FLAG 1 NEGS      @Z40MSCD 05550000
&NOPRTOF SETB  1                        INIT. FLAG 1 NEGS      @G38ESMH 05575000
&FCBILIB SETB  (1)                      INIT FCB ON IMAGELIB   @Z40MSCD 05600000
&MODILIB SETB  (1)                      INIT MOD ON IMAGELIB   @Z40MSCD 05650000
&CH1ILIB SETB  (1)                      INIT CH1 ON IMAGELIB   @Z40MSCD 05700000
&CH2ILIB SETB  (1)                      INIT CH2 ON IMAGELIB   @Z40MSCD 06000000
&CH3ILIB SETB  (1)                      INIT CH3 IN IMAGELIB   @Z40MSCD 06050000
&CH4ILIB SETB  (1)                      INIT CH4 IN IMAGELIB   @Z40MSCD 06100000
.* *********************                                       @Z40MSCD 06150000
.* MF PARAMETER VERIFICATION                                   @Z40MSCD 06200000
.* *********************                                       @Z40MSCD 06250000
*                                                                       06600000
         AIF   ('&MF' EQ '').TESTDCB    GO DCB IF MF MISSING   @Z40MSCD 06650000
         AIF   ('&MF(1)' NE 'E' AND '&MF' NE 'L').ERROR03      @Z40MSCD 06700000
         AIF   ('&MF(1)' EQ 'E' AND '&MF(2)' EQ '').ERROR03    @Z40MSCD 06750000
         AIF   (N'&MF GT 2).ERROR03     ERR IF OVER 2 SUB PARMS         06800000
         AIF   ('&MF(2)' EQ '').TESTDCB GO DCB IF MF2 MISSING  @Z40MSCD 06850000
         AIF   ('&MF(2)' EQ '*').ERROR03 MF= CANNOT BE *       @Z40MSCD 06900000
&K       SETA  K'&MF(2)                 LENGTH OF &MF(2)       @Z40MSCD 07200000
&PAREN3  SETC  '&MF(2)'(1,1)            FIRST CHARACTER OF &MF(2)       07250000
&PAREN4  SETC  '&MF(2)'(&K,1)           LAST CHARACTER OF &MF(2)        07300000
         AIF   ('&PAREN3' EQ '(' AND '&PAREN4' EQ ')').MF2NREG @Z40MSCD 07350000
         AIF   (K'&MF(2) GT 8).ERROR03  ERR IF MF2 OVER 8 CHARS         07400000
         AGO   .TESTDCB                 GO DCB                 @Z40MSCD 07450000
.MF2NREG ANOP                                                  @Z40MSCD 07500000
         AIF   (K'&MF(2) LT 11 AND K'&MF(2) GT 2).TESTDCB      @Z40MSCD 07800000
.ERROR03 IGGERMAC 3                     ISSUE MNOTE            @G38ESJC 07850000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 07900000
.* *********************                                       @Z40MSCD 07950000
.* DCB PARAMETER VERIFICATION                                  @Z40MSCD 08000000
.* *********************                                       @Z40MSCD 08050000
.TESTDCB ANOP                                                  @Z40MSCD 08400000
         AIF   ('&DCB' EQ '' AND '&MF' EQ '').ERROR01          @Z40MSCD 08450000
         AIF   ('&DCB' EQ '').TESTUCS   GO UCS IF DCB MISSING  @Z40MSCD 08500000
         AIF   ('&DCB' EQ '&MF(2)').ERROR01                    @Z40MSCD 08550000
&K       SETA  K'&DCB                   STORE NO. OF CHARS IN DCB       08600000
&PAREN1  SETC  '&DCB'(1,1)              FIRST CHARACTER OF &DCB         08650000
&PAREN2  SETC  '&DCB'(&K,1)             LAST CHARACTER OF &DCB @Z40MSCD 08700000
         AIF   ('&PAREN1' EQ '(' AND '&PAREN2' EQ ')').DCBNREG @Z40MSCD 09000000
         AIF   ('&DCB' EQ '*').ERROR01  DCB CANNOT BE *        @Z40MSCD 09050000
         AIF   ('&MF(1)' EQ 'E').TESTUCS IF MF=E, GO ON        @Z40MSCD 09100000
         AIF   (K'&DCB GT 8).ERROR01    TEST IF NAME GT 8      @Z40MSCD 09150000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 09200000
         AGO   .TESTUCS                 GO UCS                 @Z40MSCD 09250000
.DCBNREG ANOP                                                  @Z40MSCD 09300000
         AIF   ('&DCB(1)' EQ '*').ERROR01  DCB CANNOT BE *     @Z40MSCD 09350000
         AIF   ('&DCB' EQ '(1)' OR '&DCB' EQ '(0)').ERROR01    @Z40MSCD 09600000
         AIF   ('&MF' EQ 'L').ERROR01   NO DCB IN REG FOR LIST @Z40MSCD 09650000
         AIF   (K'&DCB(1) GT 8 AND K'&DCB(1) LT 1).ERROR01     @Z40MSCD 09700000
         AIF   (N'&DCB GT 1).ERROR01    ONLY 1 DCB PARM ALLOWED         09750000
&DCBNREG SETB  (1)                      SET DCB IN REG SW.     @Z40MSCD 09800000
         AGO   .TESTUCS                 GO UCS                 @Z40MSCD 09850000
.ERROR01 IGGERMAC 1                     ISSUE MNOTE            @G38ESJC 10200000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 10250000
.* *********************                                       @Z40MSCD 10300000
.* UCS PARAMETER VERIFICATION                                  @Z40MSCD 10350000
.* *********************                                       @Z40MSCD 10400000
.TESTUCS AIF   (N'&UCS LT 1).TSTOPCD    TEST IF UCS PARMS PRESENT       10450000
         AIF   (N'&UCS GT 3).ERROR02    ERR IF OVER 3 SUB PARMS         10500000
         AIF   ('&UCS' EQ '*').ERROR02  UCS CANNOT BE *        @Z40MSCD 10850000
         AIF   ('&UCS(1)' EQ '').ERROR02 TEST IF UCS-ID IS MISSING      10900000
         AIF   (K'&UCS(1) GT 4).ERROR02 TEST IF UCS ID GT 4    @Z40MSCD 11000000
         AIF   ('&UCS(1)' EQ '*').ERROR02  UCS CANNOT BE *     @Z40MSCD 11050000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 11100000
         AIF   ('&UCS(2)' EQ '').TSTUCS3 GO UCS3 IF UCS2 MISSING        11150000
         AIF   ('&UCS(2)' NE 'F' AND '&UCS(2)' NE 'FOLD').ERROR02       11200000
.TSTUCS3 AIF   ('&UCS(3)' EQ '').TSTOPCD GO OPTCD IF UCS3 MISS.         11400000
         AIF   ('&UCS(3)' EQ 'V' OR '&UCS(3)' EQ 'VERIFY').TSTOPCD      11450000
.ERROR02 IGGERMAC 2                     ISSUE MNOTE            @G38ESJC 11500000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 11550000
.* *********************                                       @Z40MSCD 11600000
.* OPTCD PARAMETER VERIFICATION                                @Z40MSCD 11650000
.* *********************                                       @Z40MSCD 12000000
.TSTOPCD AIF   ('&OPTCD' EQ '').TSTDISP TEST IF OPTCD PRESENT  @G38ESMH 12035400
         AIF   (N'&OPTCD GT 2).ERROR04  TOO MANY PARMS         @ZA58194 12070800
         AIF   ('&OPTCD(1)' NE 'B').UNBLOCK                    @G38ESMH 12106200
&BLKON   SETB  (1)                      SET BLOCK BIT          @G38ESMH 12141600
&UBLKOFF SETB  (0)                      CLEAR UNBLOCK BIT      @G38ESMH 12177000
         AGO   .TSTFOLD                 TEST FOLD OPTION       @G38ESMH 12212400
.UNBLOCK AIF   ('&OPTCD(1)' NE 'U').ERROR04                    @G38ESMH 12247800
&UBLKON  SETB  (1)                      SET UNBLOCK BIT        @G38ESMH 12283200
&BLKOFF  SETB  (0)                      CLEAR BLOCK BIT        @G38ESMH 12318600
.TSTFOLD ANOP                                                  @G38ESMH 12354000
&SWOPTC  SETB  (1)                      SET CHANGE SWITCH      @G38ESMH 12389400
         AIF   (N'&OPTCD LT 2).TSTDISP  ONLY 1 PARM SPECIFIED  @G38ESMH 12424800
         AIF   ('&OPTCD(2)' NE 'F' AND '&OPTCD(2)' NE 'FOLD').UNFOLD    12460200
.*                                      FOLD OPTION ?          @G38ESMH 12495600
&FLDON   SETB  (1)                      SET FOLD BIT           @G38ESMH 12531000
&UFLDOFF SETB  (0)                      CLEAR UNFOLD BIT       @G38ESMH 12566400
         AGO   .TSTDISP                 GO TEST DISP           @G38ESMH 12601800
.UNFOLD  AIF   ('&OPTCD(2)' NE 'U' AND '&OPTCD(2)' NE 'UNFOLD').ERROR04 12637200
.*                                      UNFOLD OPTION ?        @G38ESMH 12672600
&UFLDON  SETB  (1)                      SET UNFOLD BIT         @G38ESMH 12708000
&FLDOFF  SETB  (0)                      CLEAR FOLD BIT         @G38ESMH 12743400
         AGO   .TSTDISP                 GO TEST DISP           @G38ESMH 12778800
.ERROR04 IGGERMAC 4                     ISSUE MNOTE            @G38ESJC 12814200
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 12850000
.* *********************                                       @G38ESMH 12851300
.* DISP PARAMETER VERIFICATION                                 @G38ESMH 12852600
.* *********************                                       @G38ESMH 12853900
.TSTDISP AIF   ('&DISP' EQ '').TSTPMSG  TEST IF DISP PRESENT   @G38ESMH 12855200
         AIF   ('&DISP' NE 'S' AND '&DISP' NE 'SCHEDULE').NOSCHED       12856500
.*                                      SCHEDULE ?             @G38ESMH 12857800
&SCDON   SETB  (1)                      SET SCHEDULE BIT       @G38ESMH 12859100
&NOSCDOF SETB  (0)                      CLEAR NOSCHEDULE BIT   @G38ESMH 12860400
         AGO   .CHFLG                   SET FLAG TO BE CHANGED @G38ESMH 12861700
.NOSCHED AIF   ('&DISP' NE 'N' AND '&DISP' NE 'NOSCHEDULE').EXT         12863000
.*                                      NOSCHEDULE ?           @G38ESMH 12864300
&NOSCDON SETB  (1)                      SET NOSCHEDULE BIT     @G38ESMH 12865600
&SCDOFF  SETB  (0)                      CLEAR SCHEDULE BIT     @G38ESMH 12866900
         AGO   .CHFLG                                          @G38ESMH 12868200
.EXT     AIF   ('&DISP' NE 'E' AND '&DISP' NE 'EXTERNAL').ERROR05       12869500
.*                                      EXTERNAL ?             @G38ESMH 12870800
&SCDOFF  SETB  (0)                      CLEAR SCHEDULE BIT     @G38ESMH 12872100
&NOSCDOF SETB  (0)                      CLEAR NOSCHEDULE BIT   @G38ESMH 12873400
.CHFLG   ANOP                                                  @G38ESMH 12874700
&SWOPTC  SETB  (1)                      SET FLAG TO CHANGE BYTE@G38ESMH 12876000
         AGO   .TSTPMSG                 GO TO PRTMSG VERIFY    @G38ESMH 12877300
.ERROR05 IGGERMAC 5                     ISSUE MNOTE            @G38ESJC 12878600
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @G38ESMH 12879900
.* *********************                                       @G38ESMH 12881200
.* PRTMSG PARAMETER VERIFICATION                               @G38ESMH 12882500
.* *********************                                       @G38ESMH 12883800
.TSTPMSG AIF   ('&PRTMSG' EQ '').TSTFCB TEST IF PRTMSG PRESENT @G38ESMH 12885100
         AIF   ('&PRTMSG' NE 'Y').NOPRT IF PRTMSG=Y THEN       @G38ESMH 12886400
&NOPRTOF SETB  (0)                        CLEAR NO PRINT BIT   @G38ESMH 12887700
         AGO   .CHFLAG1                                        @G38ESMH 12889000
.NOPRT   AIF   ('&PRTMSG' NE 'N').ERROR15                      @G38ESMH 12890300
&NOPRTON SETB  (1)                      SET NO PRINT BIT       @G38ESMH 12891600
.CHFLAG1 ANOP                                                  @G38ESMH 12892900
&SWFLG1  SETB  (1)                      FLAG 1 TO BE CHANGED   @G38ESMH 12894200
         AGO   .TSTFCB                  GO FCB VERIFY          @G38ESMH 12895500
.ERROR15 IGGERMAC 15                    ISSUE MNOTE            @G38ESJC 12896800
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @G38ESMH 12898100
.* *********************                                       @Z40MSCD 12900000
.* FCB PARAMETER VERIFICATION                                  @Z40MSCD 13200000
.* *********************                                       @Z40MSCD 13250000
.TSTFCB  ANOP                                                  @Z40MSCD 13300000
         AIF   ('&MF(1)' EQ 'E' AND '&INIT' EQ 'Y' AND N'&FCB LT 1).RST*13350000
               FCB                      MUST SET FLAG 2        @Z40MSCD 13400000
         AIF   (N'&FCB LT 1).TSTFLSH    TEST IF FCB PARMS PRES @Z40MSCD 13450000
         AIF   ('&FCB' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y').T*13800000
               STFLSH                   SKIP IF '*'            @Z40MSCD 13850000
         AIF   ('&FCB' EQ '*').ERROR06  NOT VALID              @Z40MSCD 13900000
         AIF   ('&FCB(1)' EQ '').ERROR06 TEST IF FCB ID MISSING         13950000
         AIF   ('&FCB(1)' EQ '*').ERROR06  NOT VALID           @Z40MSCD 14000000
         AIF   (N'&FCB GT 2).ERROR06    ERR IF OVER 2 SUB PARMS         14050000
&K       SETA  K'&FCB(1)                NO. CHARS IN FCB1      @Z40MSCD 14100000
         AIF   ('&FCB(1)'(1,2) EQ 'A(' AND '&FCB(1)'(&K,1) EQ ')').FCBAX14400000
               DR                       GO SET ADDR SW.        @Z40MSCD 14450000
         AIF   ('&FCB(1)'(1,2) NE 'R(' AND '&FCB(1)'(&K,1) NE ')').FCBIX14500000
               D                        GO ID PROCESSING       @Z40MSCD 14550000
         AIF   ('&MF' EQ 'L').ERROR06   ERR IF IN REG AMD MF=L @Z40MSCD 14600000
&FCBNREG SETB  (1)                      SET FCB IN REG         @Z40MSCD 14650000
.FCBADR  ANOP                                                  @Z40MSCD 14700000
&FCBNCOR SETB  (1)                      SET FCB IN STORAGE     @Z40MSCD 15000000
.FCBID   ANOP                                                  @Z40MSCD 15100000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 15200000
         AIF   (&FCBNCOR EQ (1)).FCBFG2 FCB IN STORAGE, SET FLG 2       15300000
.RSTFCB  ANOP                                                  @Z40MSCD 15350000
&FCBILIB SETB  (0)                      SET FCB ON IMAGELIB    @Z40MSCD 15400000
.FCBFG2  ANOP                                                  @Z40MSCD 15600000
&SWFLG2  SETB  (1)                      SET FLAG2 TO BE CHNGD  @Z40MSCD 15650000
         AIF   ('&MF(1)' EQ 'E' AND '&INIT' EQ 'Y' AND '&FCB' EQ '').TS*15800000
               TFLSH                    ALL DONE, GO FLASH     @Z40MSCD 15850000
         AIF   (&FCBNCOR EQ (1) AND K'&FCB(1) GT 11).ERROR06   @Z40MSCD 15900000
         AIF   (&FCBNCOR EQ (1) AND K'&FCB(1) LT 4).ERROR06    @Z40MSCD 15950000
         AIF   (&FCBNCOR EQ (0) AND K'&FCB(1) GT 4).ERROR06    @Z40MSCD 16000000
         AIF   ('&FCB(2)' EQ '' OR '&FCB(2)' EQ 'ALIGN' OR '&FCB(2)' EQX16200000
                'VERIFY' OR '&FCB(2)' EQ 'V' OR '&FCB(2)' EQ 'A').TSTFLX16250000
               SH                       VALIDATE FCB SUB PARMS @Z40MSCD 16300000
.ERROR06 IGGERMAC 6                     ISSUE MNOTE            @G38ESJC 16350000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 16400000
.* *********************                                       @Z40MSCD 16450000
.* FLASH PARAMETER VERIFICATION                                @Z40MSCD 16500000
.* *********************                                       @Z40MSCD 16800000
.TSTFLSH AIF   (N'&FLASH LT 1).TSTMOD   TEST IF FLASH PARM     @Z40MSCD 16850000
         AIF   ('&FLASH' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y')*16900000
               .TSTMOD                  SKIP IF '*'            @Z40MSCD 16950000
         AIF   ('&FLASH' EQ '*').ERROR09  NOT VALID            @Z40MSCD 17000000
         AIF   (N'&FLASH GT 2).ERROR09  ERR IF OVER 2 SUB PARMS         17050000
         AIF   ('&FLASH(1)' EQ '').FLSH2  IS FLASH ID PRESENT  @Z40MSCD 17400000
         AIF   ('&FLASH(1)' EQ '*').ERROR09  NOT VALID         @Z40MSCD 17450000
         AIF   (K'&FLASH(1) GT 4).ERROR09 IS FLASH(1) GT 4     @Z40MSCD 17500000
.FLSH2   ANOP                                                  @Z40MSCD 17550000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 17600000
         AIF   ('&FLASH(2)' EQ '').TSTMOD GO TEST MODIFY       @Z40MSCD 17650000
         AIF   (T'&FLASH(2) NE 'N').ERROR09  IS RIGHT TYPE     @Z40MSCD 17700000
         AIF   (&FLASH(2) LT 0 OR &FLASH(2) GT 255).ERROR09    @Z40MSCD 18000000
         AGO   .TSTMOD                  GO MODIFY VERIFICATION @Z40MSCD 18050000
.ERROR09 IGGERMAC 9                     ISSUE MNOTE            @G38ESJC 18100000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 18150000
.* *********************                                       @Z40MSCD 18200000
.* MODIFY PARAMETER VERIFICATION                               @Z40MSCD 18250000
.* *********************                                       @Z40MSCD 18300000
.TSTMOD  ANOP                                                  @Z40MSCD 18600000
         AIF   ('&MF(1)' EQ 'E' AND '&INIT' EQ 'Y' AND N'&MODIFY LT 1).*18650000
               RSTMOD                   MUST SET FLAG 2        @Z40MSCD 18700000
         AIF   (N'&MODIFY LT 1).TSTCHAR IS MODIFY ID PRESENT   @Z40MSCD 18750000
         AIF   ('&MODIFY' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y'*18800000
               ).TSTCHAR                SKIP IF '*'            @Z40MSCD 18850000
         AIF   ('&MODIFY' EQ '*').ERROR10 NOT VALID            @Z40MSCD 19200000
         AIF   (N'&MODIFY GT 2).ERROR10 ERR IF OVER 2 SUB PARMS         19250000
         AIF   ('&MODIFY(1)' EQ '').ERROR10  IS MODIFY ID PRES @Z40MSCD 19300000
         AIF   ('&MODIFY(1)' EQ '*').ERROR10 NOT VALID         @Z40MSCD 19350000
&K       SETA  K'&MODIFY(1)             NO. CHARS IN MODIFY1   @Z40MSCD 19400000
         AIF   ('&MODIFY(1)'(1,2) EQ 'A(' AND '&MODIFY(1)'(&K,1) EQ ')'X19450000
               ).MODADR                 GO SET ADDR SW.        @Z40MSCD 19500000
         AIF   ('&MODIFY(1)'(1,2) NE 'R(' AND '&MODIFY(1)'(&K,1) NE ')'X19800000
               ).MODYID                 GO ID PROCESSING       @Z40MSCD 19850000
         AIF   ('&MF' EQ 'L').ERROR10   ERR IF IN REG AND MF=L @Z40MSCD 19900000
&MODNREG SETB  (1)                      SET MODIFY IN REG      @Z40MSCD 19950000
.MODADR  ANOP                                                  @Z40MSCD 20000000
&MODNCOR SETB  (1)                      SET MODIFY IN STORAGE  @Z40MSCD 20050000
.MODYID  ANOP                                                  @Z40MSCD 20100000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 20400000
         AIF   (&MODNCOR EQ (1)).MODFG2 MOD IN STORAGE, SET FLG2        20450000
.RSTMOD  ANOP                                                  @Z40MSCD 20500000
&MODILIB SETB  (0)                      SET MODIFY ON IMAGELIB @Z40MSCD 20550000
.MODFG2  ANOP                                                  @Z40MSCD 20600000
&SWFLG2  SETB  (1)                      SET FLAG2 TO BE CHNGD  @Z40MSCD 20650000
         AIF   ('&MF(1)' EQ 'E' AND '&INIT' EQ 'Y' AND '&MODIFY' EQ '')*21000000
               .TSTCHAR                 ALL DONE,GO CHARS      @Z40MSCD 21100000
         AIF   (&MODNCOR EQ (1) AND K'&MODIFY(1) GT 11).ERROR10         21200000
         AIF   (&MODNCOR EQ (1) AND K'&MODIFY(1) LT 4).ERROR10 @Z40MSCD 21230000
         AIF   (&MODNCOR EQ (0) AND K'&MODIFY(1) GT 4).ERROR10 @Z40MSCD 21300000
         AIF   ('&MODIFY(2)' EQ '').TSTCHAR  GO TEST CHARS     @Z40MSCD 21400000
         AIF   (T'&MODIFY(2) NE 'N').ERROR10  IS RIGHT TYPE    @Z40MSCD 21450000
         AIF   (&MODIFY(2) LT 0 OR &MODIFY(2) GT 3).ERROR10    @Z40MSCD 21600000
         AGO   .TSTCHAR                 GO CHARS PROCESSING    @Z40MSCD 21650000
.ERROR10 IGGERMAC 10                    ISSUE MNOTE            @G38ESJC 21700000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 21750000
.* *********************                                       @Z40MSCD 21800000
.* CHARS PARAMETER VERIFICATION                                @Z40MSCD 21850000
.* *********************                                       @Z40MSCD 21900000
.TSTCHAR ANOP                                                  @Z40MSCD 22200000
         AIF   ('&MF(1)' EQ 'E' AND '&INIT' EQ 'Y' AND N'&CHARS LT 1).R*22300000
               STCHR                    MUST SET FLAG 2        @Z40MSCD 22400000
         AIF   (N'&CHARS LT 1).TSTCOPY  IS CHARS PARM PRESENT  @Z40MSCD 22500000
         AIF   (N'&CHARS GT 4).ERROR11  CHARS ERROR            @Z40MSCD 22600000
         AIF   ('&CHARS' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y')*22700000
               .TSTCOPY                 SKIP IF '*'            @Z40MSCD 22800000
         AIF   ('&CHARS' EQ '*').ERROR11 NOT VALID             @Z40MSCD 22850000
         AIF   ('&CHARS(1)' EQ '').ERROR11                     @Z40MSCD 22900000
         AIF   ('&CHARS(1)' EQ '*').ERROR11 NOT VALID          @Z40MSCD 22950000
&K       SETA  K'&CHARS(1)              NO. CHARS IN CHARS1    @Z40MSCD 23000000
         AIF   ('&CHARS(1)'(1,2) EQ 'A(' AND '&CHARS(1)'(&K,1) EQ ')').X23050000
               CH1ADR                   GO SET ADDR SW.        @Z40MSCD 23100000
         AIF   ('&CHARS(1)'(1,2) NE 'R(' AND '&CHARS(1)'(&K,1) NE ')').X23400000
               CH1ID                    GO ID PROCESSING       @Z40MSCD 23450000
         AIF   ('&MF' EQ 'L').ERROR11   ERR IF IN REG AND MF=L @Z40MSCD 23500000
&CH1NREG SETB  (1)                      SET CHARS1 IN REG      @Z40MSCD 23550000
.CH1ADR  ANOP                                                  @Z40MSCD 23600000
&CH1NCOR SETB  (1)                      SET CHARS 1 IN STORAGE @Z40MSCD 23650000
         AIF   (&CH1NREG EQ (1)).CH1FG2 CHAR1 IN REG, SET FLG2 @Z40MSCD 23700000
.CH1ID   ANOP                                                  @Z40MSCD 24000000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 24050000
         AIF   (&CH1NCOR EQ (1)).CH1FG2 CHAR1 IN STORAGE, SET FLG2      24100000
&CH1ILIB SETB  (0)                      SET CHARS 1 ON IMAGELIB         24150000
.CH1FG2  ANOP                                                  @Z40MSCD 24200000
&SWFLG2  SETB  (1)                      SET FLAGS2 TO BE CHNGD @Z40MSCD 24250000
         AIF   (&CH1NCOR EQ (1) AND K'&CHARS(1) GT 11).ERROR11 @Z40MSCD 24600000
         AIF   (&CH1NCOR EQ (1) AND K'&CHARS(1) LT 4).ERROR11  @Z40MSCD 24650000
         AIF   (&CH1NCOR EQ (0) AND K'&CHARS(1) GT 4).ERROR11  @Z40MSCD 24700000
         AIF   ('&CHARS(2)' EQ '' AND N'&CHARS GT 1).ERROR11   @Z40MSCD 24750000
         AIF   ('&CHARS(2)' EQ '').LCHR1 CHAR2 MISS., SET NULL @Z40MSCD 24800000
         AIF   ('&CHARS(2)' EQ '*').ERROR11 NOT VALID          @Z40MSCD 24850000
&K       SETA  K'&CHARS(2)              SET NO. CHARS IN CHAR2 @Z40MSCD 24900000
         AIF   ('&CHARS(2)'(1,2) EQ 'A(' AND '&CHARS(2)'(&K,1) EQ ')').X25200000
               CH2ADR                   CHK FOR ADDR SPEC.     @Z40MSCD 25250000
         AIF   ('&CHARS(2)'(1,2) NE 'R(' AND '&CHARS(2)'(&K,1) NE ')').X25300000
               CH2ID                    CHK FOR ID SPEC.       @Z40MSCD 25350000
         AIF   ('&MF' EQ 'L').ERROR11   MF=L AND REG INVALID   @Z40MSCD 25400000
&CH2NREG SETB  (1)                      SET CHAR2 IN REG       @Z40MSCD 25450000
.CH2ADR  ANOP                                                  @Z40MSCD 25500000
&CH2NCOR SETB  (1)                      SET CHAR2 IN STORAGE   @Z40MSCD 25800000
         AIF   (&CH2NREG EQ (1)).CH2FG2 CHAR2 IN REG, SET FLG2 @Z40MSCD 25850000
.CH2ID   ANOP                                                  @Z40MSCD 25900000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 25950000
         AIF   (&CH2NCOR EQ (1)).CH2FG2 CHAR2 IN STORAGE, SET FLG2      26000000
&CH2ILIB SETB  (0)                      SET CHAR2 ON IMAGELIB  @Z40MSCD 26050000
.CH2FG2  ANOP                                                  @Z40MSCD 26400000
&SWFLG2  SETB  (1)                      SET FLG2 TO BE CHNGD   @Z40MSCD 26450000
         AIF   (&CH2NCOR EQ (1) AND K'&CHARS(2) GT 11).ERROR11 @Z40MSCD 26500000
         AIF   (&CH2NCOR EQ (1) AND K'&CHARS(2) LT 4).ERROR11  @Z40MSCD 26550000
         AIF   (&CH2NCOR EQ (0) AND K'&CHARS(2) GT 4).ERROR11  @Z40MSCD 26700000
         AIF   ('&CHARS(3)' EQ '' AND N'&CHARS GT 2).ERROR11   @Z40MSCD 26750000
         AIF   ('&CHARS(3)' EQ '').LCHR2 CHAR3 MISS., SET NULL @Z40MSCD 26800000
         AIF   ('&CHARS(3)' EQ '*').ERROR11 NOT VALID          @Z40MSCD 27000000
&K       SETA  K'&CHARS(3)              SET NO. CHAR IN CHAR3  @Z40MSCD 27050000
         AIF   ('&CHARS(3)'(1,2) EQ 'A(' AND '&CHARS(3)'(&K,1) EQ ')').X27100000
               CH3ADR                   CHK FOR ADDR SPEC.     @Z40MSCD 27150000
         AIF   ('&CHARS(3)'(1,2) NE 'R(' AND '&CHARS(3)'(&K,1) NE ')').X27200000
               CH3ID                    CHK FOR ID SPEC.       @Z40MSCD 27250000
         AIF   ('&MF' EQ 'L').ERROR11   MF=L AND REG INVALID   @Z40MSCD 27300000
&CH3NREG SETB  (1)                      SET CHAR3 IN REGISTER  @Z40MSCD 27600000
.CH3ADR  ANOP                                                  @Z40MSCD 27650000
&CH3NCOR SETB  (1)                      SET CHAR3 IN STORAGE   @Z40MSCD 27700000
         AIF   (&CH3NREG EQ (1)).CH3FG2 CHAR3 IN REG, SET FLG2 @Z40MSCD 27750000
.CH3ID   ANOP                                                  @Z40MSCD 27800000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 27850000
         AIF   (&CH3NCOR EQ (1)).CH3FG2 CHAR3 IN STORAGE, SET FLG2      28200000
&CH3ILIB SETB  (0)                      SET CHAR3 ON IMAGELIB  @Z40MSCD 28250000
.CH3FG2  ANOP                                                  @Z40MSCD 28300000
&SWFLG2  SETB  (1)                      SET FLG2 TO BE CHANGED @Z40MSCD 28350000
         AIF   (&CH3NCOR EQ (1) AND K'&CHARS(3) GT 11).ERROR11 @Z40MSCD 28400000
         AIF   (&CH3NCOR EQ (1) AND K'&CHARS(3) LT 4).ERROR11  @Z40MSCD 28450000
         AIF   (&CH3NCOR EQ (0) AND K'&CHARS(3) GT 4).ERROR11  @Z40MSCD 28500000
         AIF   ('&CHARS(4)' EQ '' AND N'&CHARS GT 3).ERROR11   @Z40MSCD 28800000
         AIF   ('&CHARS(4)' EQ '').LCHR3 CHAR4 MISS., SET NULL @Z40MSCD 28850000
         AIF   ('&CHARS(4)' EQ '*').ERROR11 NOT VALID          @Z40MSCD 28900000
&K       SETA  K'&CHARS(4)              SET NO. CHAR IN CHAR4  @Z40MSCD 28950000
         AIF   ('&CHARS(4)'(1,2) EQ 'A(' AND '&CHARS(4)'(&K,1) EQ ')').X29000000
               CH4ADR                   CHK FOR ADDR SPEC.     @Z40MSCD 29050000
         AIF   ('&CHARS(4)'(1,2) NE 'R(' AND '&CHARS(4)'(&K,1) NE ')').X29100000
               CH4ID                    CHK FOR ID SPEC.       @Z40MSCD 29400000
         AIF   ('&MF' EQ 'L').ERROR11   MF=L AND REG INVALID   @Z40MSCD 29450000
&CH4NREG SETB  (1)                      SET CHAR4 IN REGISTER  @Z40MSCD 29500000
.CH4ADR  ANOP                                                  @Z40MSCD 29550000
&CH4NCOR SETB  (1)                      SET CHAR4 IN STORAGE   @Z40MSCD 29600000
         AIF   (&CH4NREG EQ (1)).CH4FG2 CHAR4 IN REG, SET FLG2 @Z40MSCD 29650000
.CH4ID   ANOP                                                  @Z40MSCD 30000000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 30050000
         AIF   (&CH4NCOR EQ (1)).CH4FG2 CHAR4 IN STORAGE, SET FLG2      30200000
&CH4ILIB SETB  (0)                      SET CHAR4 ON IMAGELIB  @Z40MSCD 30250000
.CH4FG2  ANOP                                                  @Z40MSCD 30300000
&SWFLG2  SETB  (1)                      SET FLG2 TO BE CHANGED @Z40MSCD 30400000
         AIF   (&CH4NCOR EQ (1) AND K'&CHARS(4) GT 11).ERROR11 @Z40MSCD 30450000
         AIF   (&CH4NCOR EQ (1) AND K'&CHARS(4) LT 4).ERROR11  @Z40MSCD 30600000
         AIF   (&CH4NCOR EQ (0) AND K'&CHARS(4) GT 4).ERROR11  @Z40MSCD 30650000
         AGO   .TSTCOPY                 GO VERIFY COPIES       @Z40MSCD 30700000
.RSTCHR  ANOP                                                  @Z40MSCD 30750000
&CH1ILIB SETB  (0)                      SET CHAR1 ON IMAGELIB  @Z40MSCD 30800000
.LCHR1   ANOP                                                  @Z40MSCD 30850000
&CH2ILIB SETB (0)                       SET CHAR2 ON IMAGELIB  @Z40MSCD 30900000
.LCHR2   ANOP                                                  @Z40MSCD 31200000
&CH3ILIB SETB (0)                       SET CHAR3 ON IMAGELIB  @Z40MSCD 31250000
.LCHR3   ANOP                                                  @Z40MSCD 31300000
&CH4ILIB SETB (0)                       SET CHAR4 ON IMAGELIB  @Z40MSCD 31350000
&SWFLG2  SETB  (1)                      SET FLG2 TO BE CHANGED @Z40MSCD 31400000
         AGO   .TSTCOPY                 GO VERIFY COPIES       @Z40MSCD 31450000
.ERROR11 IGGERMAC 11                    ISSUE MNOTE            @G38ESJC 31800000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 31850000
.* *********************                                       @Z40MSCD 31900000
.* COPIES PARAMETER VERIFICATION                               @Z40MSCD 31950000
.* *********************                                       @Z40MSCD 32000000
.TSTCOPY AIF   ('&COPIES' EQ '').TSTBRST  IS COPIES PRESENT    @Z40MSCD 32050000
         AIF   ('&COPIES' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y'*32100000
               ).TSTBRST                SKIP IF '*'            @Z40MSCD 32400000
         AIF   (T'&COPIES NE 'N').SKIPCK1 CAN COPIES BE VERIF. @ZA45505 32437500
         AIF   (&COPIES GT 255).ERROR07 MAX VALUE IS 255       @ZA45505 32475000
.SKIPCK1 ANOP                                                  @ZA45505 32512500
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 32550000
         AGO   .TSTBRST                 GO VERIFY BURST        @Z40MSCD 32600000
.ERROR07 IGGERMAC 7                     ISSUE MNOTE            @G38ESJC 32650000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 32700000
.* *********************                                       @Z40MSCD 33000000
.* BURST PARAMETER VERIFICATION                                @Z40MSCD 33050000
.* *********************                                       @Z40MSCD 33100000
.TSTBRST AIF   ('&BURST' EQ '' AND '&INIT' EQ 'Y').SETBOFF     @Z40MSCD 33150000
         AIF   ('&BURST' EQ '').TSTCPNR BURST MISS., GO COPYNR @Z40MSCD 33200000
         AIF   ('&BURST' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y')*33250000
               .TSTCPNR                 SKIP IF '*'            @Z40MSCD 33600000
         AIF   ('&BURST' EQ 'Y').SETBON BURST EQ YES           @Z40MSCD 33650000
         AIF   ('&BURST' NE 'N').ERROR08 BURST NOT 'NO' INV.   @Z40MSCD 33700000
.SETBOFF ANOP                                                  @Z40MSCD 33750000
&BRSTOFF SETB  (0)                      SET BURST EQ NO        @Z40MSCD 33800000
         AGO   .SETBON2                 GO SET FLG1 TO BE CHNGD         33850000
.SETBON  ANOP                                                  @Z40MSCD 33900000
&BRSTON  SETB  (1)                      SET BURST EQ YES       @Z40MSCD 34200000
.SETBON2 ANOP                                                  @Z40MSCD 34250000
&SWFLG1  SETB  (1)                      SET FLG1 TO BE CHANGED @Z40MSCD 34300000
         AGO   .TSTCPNR                 GO VERIFY COPYNR       @Z40MSCD 34350000
.ERROR08 IGGERMAC 8                     ISSUE MNOTE            @G38ESJC 34400000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 34450000
.* *********************                                       @Z40MSCD 34500000
.* COPYNR PARAMETER VERIFICATION                               @Z40MSCD 34800000
.* *********************                                       @Z40MSCD 34850000
.TSTCPNR ANOP                                                  @Z40MSCD 34900000
         AIF   ('&COPYNR' EQ '').TSTINIT COPYNR MISS., GO INIT @Z40MSCD 34950000
         AIF   ('&COPYNR' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y'*35000000
               ).TSTINIT                SKIP IF '*'            @Z40MSCD 35050000
         AIF   (T'&COPYNR NE 'N').SKIPCK2 CAN COPYNR BE VERIF. @ZA45505 35100000
         AIF   (&COPYNR GT 255).ERROR12 MAX VALUE IS 255       @ZA45505 35150000
.SKIPCK2 ANOP                                                  @ZA45505 35200000
&DCSW    SETB  (1)                      SET DC SWITCH          @Z40MSCD 35500000
         AGO   .TSTINIT                 GO VERIFY PRT INIT.    @Z40MSCD 35550000
.ERROR12 IGGERMAC 12                    ISSUE MNOTE            @G38ESJC 35600000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 35650000
.* *********************                                       @Z40MSCD 35700000
.* INIT PARAMETER VERIFICATION                                 @Z40MSCD 36000000
.* *********************                                       @Z40MSCD 36050000
.TSTINIT AIF   ('&INIT' EQ '').TSTRXMT  INIT MISS., GO REXMIT  @Z40MSCD 36100000
         AIF   ('&INIT' EQ 'Y').SETEON  CHK FOR INIT=YES       @Z40MSCD 36150000
         AIF   ('&INIT' NE 'N').ERROR13 INIT NOT EQ N INV.     @Z40MSCD 36200000
&INITOFF SETB  (0)                      SET INIT EQ OFF        @Z40MSCD 36250000
         AGO   .SETEON2                                        @Z40MSCD 36300000
.SETEON  ANOP                                                  @Z40MSCD 36600000
&INITON  SETB  (1)                      SET INIT EQ ON         @Z40MSCD 36650000
.SETEON2 ANOP                                                  @Z40MSCD 36700000
&SWFLG1  SETB  (1)                      SET FLG1 TO BE CHANGED @Z40MSCD 36750000
         AGO   .TSTRXMT                 GO VERIFY REXMIT       @Z40MSCD 36800000
.ERROR13 IGGERMAC 13                    ISSUE MNOTE            @G38ESJC 36850000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 37200000
.* *********************                                       @Z40MSCD 37250000
.* REXMIT PARAMETER VERIFICATION                               @Z40MSCD 37300000
.* *********************                                       @Z40MSCD 37350000
.TSTRXMT ANOP                                                  @Z40MSCD 37400000
         AIF   ('&REXMIT' EQ '' AND '&INIT' EQ 'Y').SETROFF    @Z40MSCD 37450000
         AIF   ('&REXMIT' EQ '').TSTMSGA GO TSTMSGA IF MISSING @G38ESMH 37500000
         AIF   ('&REXMIT' EQ '*' AND '&MF(1)' EQ 'E' AND '&INIT' EQ 'Y'*37800000
               ).TSTMSGA                SKIP IF '*'            @G38ESMH 37850000
         AIF   ('&REXMIT' EQ 'N').SETROFF CHK REXIT EQ N       @Z40MSCD 37900000
         AIF   ('&REXMIT' NE 'Y').ERROR14 REXMIT NOT EQ Y INV. @Z40MSCD 37950000
&RXMTON  SETB  (1)                      SET REXMIT FLAG ON     @Z40MSCD 38000000
         AIF   ('&BURST' EQ '' AND '&FCB' EQ '' AND '&MODIFY' EQ '' AND*38050000
                '&OPTCD' EQ '' AND '&INIT' EQ '' AND '&CHARS' EQ '' AND*38100000
                '&UCS' EQ '').SETRON2   COPIES-COPYNR-FLASH    @Z40MSCD 38400000
.WARN51  IGGERMAC 51                    ISSUE WARNING MNOTE    @G38ESJC 38450000
.*       THIS IS ONLY A WARNING MNOTE, DO NOT SET ERROR SWITCH @Z40MSCD 38500000
         AGO   .SETRON2                                        @Z40MSCD 38550000
.SETROFF ANOP                                                  @Z40MSCD 38600000
&RXMTOFF SETB  (0)                      SET REXMIT OFF         @Z40MSCD 38650000
.SETRON2 ANOP                                                  @Z40MSCD 39000000
&SWFLG1  SETB  (1)                      SET FLG1 TO BE CHANGED @Z40MSCD 39050000
         AGO   .TSTMSGA                 GO MSGAREA VERIFY      @G38ESMH 39100000
.ERROR14 IGGERMAC 14                    ISSUE MNOTE            @G38ESJC 39150000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @Z40MSCD 39200000
.* *********************                                       @G38ESMH 39201500
.* MSGAREA PARAMETER VERIFICATION                              @G38ESMH 39203000
.* *********************                                       @G38ESMH 39204500
.TSTMSGA AIF   ('&MSGAREA' EQ '').TSTLDCB                      @G38ESMH 39206000
&K       SETA  K'&MSGAREA               SET K TO # OF CHARS.   @G38ESMH 39207500
         AIF   ('&MSGAREA'(1,1) NE '(' AND &K GT 8).ERROR16    @G38ESMH 39209000
         AIF   ('&MSGAREA'(1,1) NE '(').SETMDC                 @G38ESMH 39210500
         AIF   ('&MSGAREA'(&K,1) NE ')' OR &K GT 10 OR &K LT 3).ERROR16 39212000
.*                                                             @G38ESMH 39213500
&MSGANRG SETB  (1)                      SET IN REGISTER SWITCH @G38ESMH 39215000
         AIF   ('&MF' EQ 'L').ERROR16   REG NOT VALID FOR MF=L @G38ESMH 39216500
.SETMDC  ANOP                                                  @G38ESMH 39218000
&DCSW    SETB  (1)                      SET DC SWITCH          @G38ESMH 39219500
         AGO   .TSTLDCB                 GO LIBDCB VERIFY       @G38ESMH 39221000
.ERROR16 IGGERMAC 16                    ISSUE MNOTE            @G38ESJC 39222500
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @G38ESMH 39224000
.* *********************                                       @G38ESMH 39225500
.* LIBDCB PARAMETER VERIFICATION                               @G38ESMH 39227000
.* *********************                                       @G38ESMH 39228500
.TSTLDCB AIF   ('&LIBDCB' EQ '').ENDTST                        @G38ESMH 39230000
&K       SETA  K'&LIBDCB                SET K TO # OF CHARS.   @G38ESMH 39231500
         AIF   ('&LIBDCB'(1,1) NE '(').SETLDC                  @G38ESMH 39233000
         AIF   ('&LIBDCB'(&K,1) NE ')' OR &K GT 10 OR &K LT 3).ERROR17  39234500
.*                                      VERIFY REGISTER SYNTAX @G38ESMH 39236000
&LDCBNRG SETB  (1)                      SET IN-REGISTER SWITCH @G38ESMH 39237500
         AIF   ('&MF' EQ 'L').ERROR17   REG NOT VALID FOR MF=L @G38ESMH 39239000
.SETLDC  AIF   (&LDCBNRG NE (1) AND &K GT 8).ERROR17           @G38ESMH 39240500
&DCSW    SETB  (1)                      SET DC SWITCH          @G38ESMH 39242000
         AGO   .ENDTST                  GO TO END OF VERIFY    @G38ESMH 39243500
.ERROR17 IGGERMAC 17                    ISSUE MNOTE            @G38ESJC 39245000
&ERRSW   SETB  (1)                      SET ERROR SWITCH       @G38ESMH 39246500
.* *********************                                       @Z40MSCD 39250000
.* TEST TO SEE IF ERROR HAS OCCURRED AND TERMINATE             @Z40MSCD 39300000
.* *********************                                       @Z40MSCD 39600000
.ENDTST  ANOP                                                  @Z40MSCD 39650000
         AIF   (&ERRSW EQ 1).EXIT       STOP HERE IF ERROR     @Z40MSCD 39700000
.* *********************                                       @Z40MSCD 39750000
.* ALL PARAMETERS ARE GOOD - BUILD LIST OR DEFINED CONSTANTS.  @Z40MSCD 39800000
.* *********************                                       @Z40MSCD 39850000
         AIF   ('&MF' EQ '').STNDRD     TEST IF STANDARD FORM  @G38ESMH 39900000
         AIF   ('&MF(1)' EQ 'E').EXECUTE TEST IF EXECUTE FORM  @G38ESMH 39950000
.LIST    ANOP                                                  @G38ESMH 40000000
&ANYNAME DC    0F'0'                    ALIGN PARMLIST ON FULLWORD      40050000
.*                                                             @G38ESMH 40100000
         AGO   .COMMON                  GENERATE DC'S          @G38ESMH 40150000
.* **********************                                      @Z40MSCD 40250000
.* BEGIN BUILD FOR EXECUTE FORM OF MACRO                       @Z40MSCD 40300000
.* **********************                                      @Z40MSCD 40350000
.EXECUTE ANOP                                                  @G38ESMH 40400000
         AIF   ('&ANYNAME' EQ '').SKPLBL                       @G38ESMH 40450000
&ANYNAME DC    0H'0'                                                    40800000
.SKPLBL  ANOP                                                  @G38ESMH 40850000
         AIF   ('&MF(2)' EQ '(1)').BLDB LIST ADDR IN REG 1     @Z40MSCD 40900000
         AIF   ('&PAREN3' EQ '(' AND '&PAREN4' EQ ')').LOADREG @Z40MSCD 40950000
         LA    1,&MF(2)                 LOAD PARAMETER LIST ADDR        41000000
         AGO   .BLDB                    GO CHK FOR DC          @Z40MSCD 41050000
.LOADREG ANOP                                                  @Z40MSCD 41100000
&K       SETA  K'&MF(2)                 NO. CHAR IN LIST PARM  @Z40MSCD 41400000
&STRIP   SETC  '&MF(2)'(2,&K-2)         REMOVE NAME FROM PARM  @Z40MSCD 41450000
         LR    1,&STRIP                 LOAD SETPRT LIST ADDRESS        41500000
.BLDB    ANOP                                                  @Z40MSCD 41550000
         AIF   ('&DCB' EQ '' OR &DCBNREG EQ (1)).SKPLA         @Z40MSCD 41600000
         LA    0,&DCB                   LOAD DCB ADDRESS                41650000
         ST    0,0(0,1)                 STORE DCB ADDR IN PARM LIST     41700000
.SKPLA   ANOP                                                  @Z40MSCD 41750000
         AIF   (&DCSW EQ (0) AND &INITON EQ (0)).BLDFLAG       @G38ESMH 41800000
         B     IHB&NO.B                 BRANCH AROUND CONSTANTS         41850000
IHB&NO.A EQU   *                                                        41900000
         AGO   .COMMON                  GO COMMON PROCESSING   @Z40MSCD 42000000
.* **********************                                      @Z40MSCD 42050000
.* BEGIN BUILD FOR STANDARD FORM OF MACRO                      @Z40MSCD 42800000
.* **********************                                      @Z40MSCD 42850000
.STNDRD  ANOP                                                  @G38ESMH 42900000
         CNOP  0,4                      ALIGN ON FULLWORD BOUNDARY      42950000
.*                                                             @ZA51640 43000000
&ANYNAME BAL   1,*+4+&SPPLEN            LOAD SETPRT LIST ADDRESS        43050000
.*                                                             @ZA51640 43100000
*                                         AND BRANCH OVER CONSTANTS     43150000
.*                                                             @G38ESMH 43200000
.* **********************                                      @Z40MSCD 43300000
.* COMMON BUILD CODE                                           @Z40MSCD 43350000
.* **********************                                      @Z40MSCD 43400000
.COMMON  ANOP                                                  @Z40MSCD 43450000
.*                                                             @G38ESMH 43475000
.* *******************                                         @Z40MSCD 43500000
.* DCB PARAMETER PROCESSING                                    @Z40MSCD 43800000
.* *******************                                         @Z40MSCD 43850000
         AIF   ('&DCB' EQ '' AND '&MF(1)' EQ 'E').PUCS         @Z40MSCD 43900000
         AIF   (&DCBNREG EQ (1)).NODCB  DCB ADDR IN REGISTER   @Z40MSCD 43950000
         AIF   ('&DCB' EQ '').NODCB     DCB MISSING            @Z40MSCD 44000000
         AIF   ('&MF(1)' EQ 'E').PUCS   IF ITS E FORM LA WAS DO@Z40MSCD 44050000
         DC    AL4(&DCB)                DCB ADDRESS                     44100000
&SWDCBA  SETB  (1)                      DCB DC GENERATED       @Z40MSCD 44400000
         AGO   .PUCS                    GO PROC. UCS           @Z40MSCD 44450000
.NODCB   ANOP                                                  @Z40MSCD 44500000
         AIF   ('&MF(1)' EQ 'E').PUCS   SKIP IF MF=E           @Z40MSCD 44550000
         DC    AL4(0)                   DCB ADDRESS                     44600000
.* *******************                                         @Z40MSCD 44650000
.* UCS PARAMETER PROCESSING                                    @Z40MSCD 44700000
.* *******************                                         @Z40MSCD 45000000
.PUCS    AIF   ('&UCS(1)' NE '').NONULL UCS NOT MISSING        @Z40MSCD 45050000
         AIF   ('&MF(1)' EQ 'E').CONTSKP SKIP IF MF=E          @Z40MSCD 45100000
         DC    AL4(0)                   CHARACTER SET IMAGE ID          45150000
         AGO   .CONTSKP                 GO PROC. UCS2          @Z40MSCD 45200000
.NONULL  ANOP                                                  @Z40MSCD 45250000
         DC    CL4'&UCS(1)'             CHARACTER SET IMAGE ID          45300000
&SWUCS1  SETB  (1)                      UCS1 DC GENERATED      @Z40MSCD 45600000
.CONTSKP ANOP                                                  @Z40MSCD 45650000
         AIF   ('&UCS(2)' EQ 'F' OR '&UCS(2)' EQ 'FOLD').FOLD  @Z40MSCD 45700000
         AIF   ('&MF(1)' EQ 'E').TSTVRFY SKIP IF MF=E          @Z40MSCD 45750000
         DC    X'00'                    LOAD MODE = NO FOLD             45800000
         AGO   .TSTVRFY                 GO PROC. UCS3          @Z40MSCD 45850000
.FOLD    ANOP                           FOLD SPECIFIED         @Z40MSCD 46200000
         DC    X'40'                    LOAD MODE = FOLD                46250000
&SWUCS2  SETB  (1)                      UCS2 DC GENERATED      @Z40MSCD 46300000
.TSTVRFY ANOP                           TEST IF VERIFY IS SPECIFIED     46350000
         AIF   ('&UCS(3)' EQ 'V' OR '&UCS(3)' EQ 'VERIFY').VERIFY       46400000
         AIF   ('&MF(1)' EQ 'E').OPTCD  SKIP IF MF=E           @Z40MSCD 46450000
         DC    X'00'                    VERIFY = NO                     46500000
         AGO   .OPTCD                   GO PROC. OPTCD         @Z40MSCD 46800000
.VERIFY  ANOP                           VERIFY SPECIFIED       @Z40MSCD 46850000
         DC    X'10'                    VERIFY = YES                    46900000
&SWUCS3  SETB  (1)                      UCS3 DC GENERATED      @Z40MSCD 46950000
.* *******************                                         @G38ESMH 46957100
.* OPTCD-DISP PARAMETER PROCESSING                             @G38ESMH 46964200
.* *******************                                         @G38ESMH 46971300
.OPTCD   AIF   ('&MF(1)' EQ 'E').FCBPAR SKIP DC IF MF=E        @G38ESMH 46978400
         DC    B'&BLKON&UBLKON&SCDON&NOSCDON&UFLDON&FLDON&RESVD&EXTLST' 46985500
.*                                                             @G38ESMH 46992600
.* *******************                                         @Z40MSCD 47000000
.* FCB PARAMETER PROCESSING                                    @Z40MSCD 50050000
.* *******************                                         @Z40MSCD 50100000
.FCBPAR  ANOP                                                  @Z40MSCD 50400000
         AIF   ('&FCB(1)' EQ '').FCBPAR1 NO FCB PARM           @Z40MSCD 50450000
         AIF   ('&FCB' EQ '*').FLAGS1   IF * SKIP              @Z40MSCD 50500000
         AIF   (&FCBNREG EQ (1) AND '&MF(1)' EQ 'E').FCBFLG    @Z40MSCD 50550000
         AIF   (&FCBNREG EQ (1)).FCBPAR1 FCB ADDR IN REG       @Z40MSCD 50600000
         AIF   (&FCBNCOR EQ (0)).FCBCL  FCB ID SPEC.           @Z40MSCD 50650000
&K       SETA  K'&FCB(1)                NO. CHAR IN FCB        @Z40MSCD 50700000
&STRIP   SETC  '&FCB(1)'(3,&K-3)        STRIP 1ST 2 AND LAST CHAR       51000000
         DC    AL4(&STRIP)              FCB ADDRESS                     51050000
         AGO   .FCBPAR2                                        @Z40MSCD 51100000
.FCBCL   ANOP                                                  @Z40MSCD 51150000
         DC    CL4'&FCB(1)'             FCB IMAGE ID                    51200000
         AGO   .FCBPAR2                                        @Z40MSCD 51250000
.FCBPAR1 ANOP                                                  @Z40MSCD 51600000
         AIF   ('&MF(1)' EQ 'E' AND &INITON EQ (0)).FLAGS1     @Z40MSCD 51650000
         DC    AL4(0)                   NO FCB ID SPECIFIED             51700000
.FCBPAR2 ANOP                                                  @Z40MSCD 51750000
&SWFCB1  SETB  (1)                      FCB DC GENERATED       @Z40MSCD 51800000
.* *******************                                         @Z40MSCD 51850000
.* FCB FLAG PARAMETER PROCESSING                                        51900000
.* *******************                                         @Z40MSCD 52200000
.FCBFLG  ANOP                                                  @Z40MSCD 52250000
         AIF   ('&FCB(2)' NE '').CKVFY  CK FOR VERIFY/ALIGN PARM        52300000
         AIF   ('&FCB(1)' EQ '' AND '&MF(1)' EQ 'E' AND &INITON EQ (0))*52500000
               .FLAGS1                  DO NOT CREATE DEFLT    @Z40MSCD 52550000
         DC    X'00'                    NO FCB OPTIONS                  52600000
         AGO   .FCBFLG2                 GO PROC. FLAG1         @Z40MSCD 52650000
.CKVFY   AIF   ('&FCB(2)' EQ 'VERIFY' OR '&FCB(2)' EQ 'V').STVFY        52800000
         DC    X'01'                    ALIGN FORMS                     52850000
         AGO   .FCBFLG2                 ALIGN FORMS SPECIFIED  @Z40MSCD 52900000
.STVFY   ANOP                                                  @Z40MSCD 53100000
         DC    X'80'                    VERIFY FCB SPECIFIED            53150000
.FCBFLG2 ANOP                                                  @Z40MSCD 53200000
&SWFCB2  SETB  (1)                      FCB2 DC GENERATED      @Z40MSCD 53400000
.* *******************                                         @Z40MSCD 53450000
.* FLAG 1 PARAMETER PROCESSING                                 @Z40MSCD 53500000
.* *******************                                         @Z40MSCD 53550000
.FLAGS1  ANOP                                                  @Z40MSCD 53700000
         AIF   ('&MF(1)' EQ 'E').COPYS  SKIP IF MF=E           @Z40MSCD 53750000
         DC    B'&BRSTON&RXMTON&INITON&NOPRTON.0000'                    53800000
.*                                                             @G38ESMH 53850000
.* *******************                                         @Z40MSCD 54000000
.* FLAG 2 PARAMETER PROCESSING                                 @Z40MSCD 54050000
.* *******************                                         @Z40MSCD 54100000
.FLAGS2  ANOP                                                  @Z40MSCD 54300000
         DC    BL1'&MODNCOR&CH1NCOR&CH2NCOR&CH3NCOR&CH4NCOR&FCBNCOR.00' 54350000
.* *******************                                         @Z40MSCD 54400000
.* COPIES PARAMETER PROCESSING                                 @Z40MSCD 54450000
.* *******************                                         @Z40MSCD 54600000
.COPYS   ANOP                                                  @Z40MSCD 54650000
         AIF   ('&COPIES' EQ '').COPY0  NO COPIES SPECIFIED    @ZA45505 54700000
         AIF   ('&COPIES' EQ '*').STCPY LEAVE COPIES           @Z40MSCD 54750000
         DC    AL1(&COPIES)             NUMBER OF COPIES REQ            54800000
         AGO   .COPY2                   GO SET DC SWITCH       @ZA45505 54850000
.COPY0   ANOP                           COPIES NOT SPECIFIED   @ZA45505 54900000
         AIF   (&INITON EQ (1)).COPY1   ONE COPY FOR INIT=Y    @ZA45505 54950000
         AIF   ('&MF(1)' EQ 'E').STCPY  LEAVE COPIES FOR MF=E  @ZA45505 55000000
.*                                      COPIES=0 FOR NO SPEC.  @ZA45505 55050000
         DC    X'00'                    COPIES=0                        55100000
         AGO   .COPY2                   GO SET DC SWITCH       @ZA45505 55150000
.COPY1   ANOP                           DEFAULT TO 1 FOR INIT  @ZA45505 55200000
         DC    X'01'                    ONE COPY IMPLIED                55400000
.COPY2   ANOP                                                  @Z40MSCD 55430000
&SWCPYS  SETB  (1)                      COPIES DC GENERATED    @Z40MSCD 55500000
.* *******************                                         @Z40MSCD 55600000
.* COPYNR PARAMETER PROCESSING                                 @Z40MSCD 55700000
.* *******************                                         @Z40MSCD 55800000
.STCPY   AIF   ('&COPYNR' EQ '').COPYNR0 COPYNR NOT SPECIFIED  @ZA45505 55900000
         AIF   ('&COPYNR' EQ '*').SPPLEN  LEAVE COPYNR         @G38ESMH 56000000
         DC    AL1(&COPYNR)             STARTING COPY NUMBER            56100000
         AGO   .COPYNR2                 GO SET DC SWITCH       @ZA45505 56143700
.COPYNR0 AIF   (&INITON EQ (1)).COPYNR1 COPYNR=1 FOR NO SPEC.  @ZA45505 56187400
         AIF   ('&MF(1)' EQ 'E').SPPLEN LEAVE COPYNR FOR MF=E  @ZA45505 56231100
         DC    X'00'                    COPYNR=0                        56274800
         AGO   .COPYNR2                 GO SET DC SWITCH       @ZA45505 56318500
.COPYNR1 ANOP                           DEFAULT TO 1 FOR INIT  @ZA45505 56362200
         DC    X'01'                    COPYNR ONE IMPLIED              56405900
.COPYNR2 ANOP                                                  @Z40MSCD 56450000
&SWCPNR  SETB  (1)                      COPYNR DC GENERATED    @Z40MSCD 56500000
.* *******************                                         @G38ESMH 56506200
.* LENGTH FIELD PROCESSING                                     @G38ESMH 56512400
.* *******************                                         @G38ESMH 56518600
.SPPLEN  AIF ('&MF(1)' EQ 'E').FLHCNT   SKIP DC IF EXECUTE FORM@G38ESMH 56524800
         DC    AL2(&SPPLEN)             LENGTH OF PARMLIST              56531000
.*                                                             @G38ESMH 56537200
&SWLEN   SETB  (1)                      LENGTH DC GENERATED    @G38ESMH 56543400
.* *******************                                         @Z40MSCD 56550000
.* FLASH COUNT PARAMETER PROCESSING                            @Z40MSCD 57450000
.* *******************                                         @Z40MSCD 57600000
.FLHCNT  ANOP                                                  @Z40MSCD 57650000
         AIF   ('&FLASH' EQ '*').MDFY   LEAVE FLASH            @Z40MSCD 57700000
         AIF   ('&FLASH(2)' EQ '' AND '&FLASH(1)' NE '').DFTO1 @Z40MSCD 57750000
         AIF   ('&FLASH(2)' EQ '').NOFLSH NO FLASH, DFT IT     @Z40MSCD 57800000
         DC    AL1(&FLASH(2))           COPIES FORMS FLASHED            57850000
         AGO   .FLSHFLG                 GO SET FLSH DC FLG     @Z40MSCD 57900000
.DFTO1   ANOP                                                  @Z40MSCD 57950000
         AIF   ('&COPIES' NE '').DFTCPC WAS COPIES SPEC.       @Z40MSCD 58000000
         DC    X'01'                    DEFAULT FLASH = COPIES          58050000
         AGO   .FLSHFLG                 GO SET FLSH DC FLG     @Z40MSCD 58100000
.DFTCPC  ANOP                                                  @Z40MSCD 58150000
         DC    AL1(&COPIES)             DEFAULT FLASH = COPIES          58200000
         AGO   .FLSHFLG                 GO SET FLAG            @Z40MSCD 58800000
.NOFLSH  ANOP                                                  @Z40MSCD 58850000
         AIF   ('&MF(1)' EQ 'E' AND &INITON EQ (0)).MDFY       @Z40MSCD 58900000
         DC    X'00'                    FORMS NOT BEING FLASHED         58950000
.FLSHFLG ANOP                                                  @Z40MSCD 59000000
&SWFLHC  SETB  (1)                      FLASH COUNT DC GEN.    @Z40MSCD 59050000
.* *******************                                         @Z40MSCD 59100000
.* MODIFY TRC PARAMETER PROCESSING                             @Z40MSCD 59400000
.* *******************                                         @Z40MSCD 59450000
.MDFY    ANOP                                                  @Z40MSCD 59500000
         AIF   ('&MODIFY' EQ '*').FLASH SKIP IF '*'            @Z40MSCD 59550000
         AIF   ('&MODIFY(2)' NE '').TRC TRC SPECIFIED          @Z40MSCD 59600000
         AIF   ('&MF(1)' EQ 'E' AND '&MODIFY(1)' EQ '' AND &INITON EQ (*59650000
               0)).FLASH                NO DEFAULTS            @Z40MSCD 59700000
         DC    X'00'                    TABLE REF CHAR 0 IMPLIED        60000000
         AGO   .TRC2                    GO SET TRC DC FLG      @Z40MSCD 60050000
.TRC     ANOP                                                  @Z40MSCD 60100000
         DC    AL1(&MODIFY(2))          TABLE REF CHAR REQUESTED        60150000
.TRC2    ANOP                                                  @Z40MSCD 60200000
&SWTRCN  SETB  (1)                      MODIFY TRC DC GEN.     @Z40MSCD 60250000
.* *******************                                         @Z40MSCD 60600000
.* MODIFY ID PARAMETER PROCESSING                              @Z40MSCD 60650000
.* *******************                                         @Z40MSCD 60700000
.MODPT   AIF   ('&MODIFY(1)' EQ '').MODPT1  COPY MOD SPECIFIED @Z40MSCD 60750000
         AIF   ('&MODIFY' EQ '*').FLASH  LEAVE COPY MOD        @Z40MSCD 60800000
         AIF   (&MODNREG EQ (1) AND '&MF(1)' EQ 'E').FLASH     @Z40MSCD 60850000
         AIF   (&MODNREG EQ (1)).MODPT1 MODIFY ADDR IN REG     @Z40MSCD 60900000
         AIF   (&MODNCOR EQ (0)).MODCL  MODIFY ID SPEC.        @Z40MSCD 61200000
&K       SETA  K'&MODIFY(1)             NO.CHAR IN MODIFY LABEL         61250000
&STRIP   SETC  '&MODIFY(1)'(3,&K-3)     STRIP 1ST 2 AND LAST CHAR       61300000
         DC    AL4(&STRIP)              COPY MOD ADDRESS                61350000
         AGO   .MODPT2                  GO PROC.FLASH ID       @Z40MSCD 61400000
.MODCL   ANOP                                                  @Z40MSCD 61450000
         DC    CL4'&MODIFY(1)'          COPY MOD ID                     61500000
         AGO   .MODPT2                  GO PROC.FLASH ID       @Z40MSCD 61800000
.MODPT1  ANOP                                                  @Z40MSCD 61850000
         AIF   ('&MF(1)' EQ 'E' AND &INITON EQ (0)).FLASH      @Z40MSCD 61900000
         DC    AL4(0)                   COPY MOD                        61950000
.MODPT2  ANOP                                                  @Z40MSCD 62000000
&SWMODI  SETB  (1)                                             @Z40MSCD 62050000
.* *******************                                         @Z40MSCD 62400000
.* FLASH ID PARAMETER PROCESSING                               @Z40MSCD 62450000
.* *******************                                         @Z40MSCD 62500000
.FLASH   AIF   ('&FLASH(1)' EQ '').FLASH1  FLASH FORMS REQUEST @Z40MSCD 62550000
         AIF   ('&FLASH' EQ '*').XLAT1  LEAVE FLASH            @Z40MSCD 62600000
         DC    CL4'&FLASH(1)'           FLASH FORMS REQUESTED           62650000
         AGO   .FLASH2                  GO TO XLAT1            @Z40MSCD 62700000
.FLASH1  ANOP                                                  @Z40MSCD 63000000
         AIF   ('&MF(1)' EQ 'E' AND &INITON EQ (0)).XLAT1      @Z40MSCD 63050000
         DC    AL4(0)                   FLASH FORMS NOT REQUEST         63100000
.FLASH2  ANOP                                                  @Z40MSCD 63150000
&SWFLSH  SETB  (1)                      FLASH DC GENERATED     @Z40MSCD 63200000
.* *******************                                         @Z40MSCD 63250000
.* CHARS PARAMETER PROCESSING                                  @Z40MSCD 63300000
.* *******************                                         @Z40MSCD 63600000
.XLAT1   ANOP                                                  @Z40MSCD 63650000
         AIF   ('&CHARS' EQ '*').MSGAREA SKIP IF '*'           @G38ESMH 63700000
         AIF   ('&CHARS(1)' NE '').XLAT11 GO GEN CHAR 1 DC     @Z40MSCD 63750000
         AIF   ('&MF(1)' EQ 'E' AND &INITON EQ (0)).MSGAREA    @G38ESMH 63800000
         DC    4AL4(0)                  NO CHAR ARRANGEMENT TBLS REQ    63850000
         AGO   .LISTDON                 GO SET CHAR DC FLG     @Z40MSCD 64200000
.XLAT11  ANOP                                                  @Z40MSCD 64250000
         AIF   (&CH1NREG EQ (1) AND &CH2NREG EQ (1) AND &CH3NREG EQ (1)X64300000
               AND &CH4NREG EQ (1) AND '&MF(1)' EQ 'E').MSGAREA         64333300
.*                                                             @G38ESMH 64366600
         AIF   (&CH1NREG EQ (1)).CH1RG  CHAR 1 IN REG          @Z40MSCD 64400000
         AIF   (&CH1NCOR EQ (0)).CH1CL  CHAR 1 ID SPEC.        @Z40MSCD 64450000
&K       SETA  K'&CHARS(1)              NO. CHAR IN CHAR1      @Z40MSCD 64500000
&STRIP   SETC  '&CHARS(1)'(3,&K-3)      STRIP 1ST 2 AND LAST CHAR       64800000
         DC    AL4(&STRIP)              CHAR ARRANGEMENT TBL 1 ADDR     64850000
         AGO   .XLAT12                  GO PROCESS TABLE 2     @Z40MSCD 64900000
.CH1RG   ANOP                                                  @Z40MSCD 64950000
         DC    AL4(0)                   CHAR ARRANGEMENT TBL 1 ADDR     65000000
         AGO   .XLAT12                  GO PROCESS TABLE 2     @Z40MSCD 65050000
.CH1CL   ANOP                                                  @Z40MSCD 65100000
         DC    CL4'&CHARS(1)'           CHAR ARRANGEMENT TBL 1 ID       65400000
.XLAT12  ANOP                                                  @Z40MSCD 65450000
         AIF   ('&CHARS(2)' NE '').XLAT2 GO GEN CHAR 2 DC      @Z40MSCD 65500000
         DC    3AL4(0)                  NO MORE CHAR ARRANGEMENT TBLS   65550000
         AGO   .LISTDON                 GO TO FINISH           @Z40MSCD 65600000
.XLAT2   ANOP                                                  @Z40MSCD 65650000
         AIF   (&CH2NREG EQ (1)).CH2RG  CHAR 2 IN REG          @Z40MSCD 66000000
         AIF   (&CH2NCOR EQ (0)).CH2CL  CHAR2 SPEC. AS ID      @Z40MSCD 66050000
&K       SETA  K'&CHARS(2)              NO. CHAR IN CHAR2      @Z40MSCD 66100000
&STRIP   SETC  '&CHARS(2)'(3,&K-3)      STRIP 1ST 2 AND LAST CHAR       66150000
         DC    AL4(&STRIP)              CHAR ARRANGEMENT TBL 2 ADDR     66200000
         AGO   .XLAT22                  GO PROCESS TABLE 3     @Z40MSCD 66250000
.CH2RG   ANOP                                                  @Z40MSCD 66300000
         DC    AL4(0)                   CHAR ARRANGEMENT TBL 2 ADDR     66600000
         AGO   .XLAT22                  GO PROCESS TABLE 3     @Z40MSCD 66650000
.CH2CL   ANOP                                                  @Z40MSCD 66700000
         DC    CL4'&CHARS(2)'           CHAR ARRANGEMENT TBL 2 ID       66750000
.XLAT22  ANOP                                                  @Z40MSCD 66800000
         AIF   ('&CHARS(3)' NE '').XLAT3 GO GEN CHAR3 DC       @Z40MSCD 66850000
         DC    2AL4(0)                  NO MORE CHAR ARRANGEMENT TBLS   66900000
         AGO   .LISTDON                 GO TO FINISH           @Z40MSCD 67200000
.XLAT3   ANOP                                                  @Z40MSCD 67250000
         AIF   (&CH3NREG EQ (1)).CH3RG  CHAR3 SPEC. IN REG     @Z40MSCD 67300000
         AIF   (&CH3NCOR EQ (0)).CH3CL  CHAR3 SPEC. AS ID      @Z40MSCD 67350000
&K       SETA  K'&CHARS(3)              NO. CHAR IN CHAR3      @Z40MSCD 67400000
&STRIP   SETC  '&CHARS(3)'(3,&K-3)      STRIP 1ST 2 AND LAST CHAR       67450000
         DC    AL4(&STRIP)              CHAR ARRANGEMENT TBL 3 ADDR     67800000
         AGO   .XLAT32                  GO PROCESS TABLE 4     @Z40MSCD 67850000
.CH3RG   ANOP                                                  @Z40MSCD 67900000
         DC    AL4(0)                   CHAR ARRANGEMENT TBL 3 ADDR     67950000
         AGO   .XLAT32                  GO PROCESS TABLE 4     @Z40MSCD 68000000
.CH3CL   ANOP                                                  @Z40MSCD 68050000
         DC    CL4'&CHARS(3)'           CHAR ARRANGEMENT TBL 3 ID       68100000
.XLAT32  ANOP                                                  @Z40MSCD 68400000
         AIF   ('&CHARS(4)' NE '').XLAT4 GO GEN CHAR4 DC       @Z40MSCD 68450000
         DC    AL4(0)                   NO MORE CHAR ARRANGEMENT TBLS   68500000
         AGO   .LISTDON                 GO TO FINISH           @Z40MSCD 68550000
.XLAT4   ANOP                                                  @Z40MSCD 68600000
         AIF   (&CH4NREG EQ (1)).CH4RG  CHAR4 SPEC. IN REG     @Z40MSCD 68650000
         AIF   (&CH4NCOR EQ (0)).CH4CL  CHAR4 SPEC. AS ID      @Z40MSCD 68700000
&K       SETA  K'&CHARS(4)              NO. CHAR IN CHAR4      @Z40MSCD 69000000
&STRIP   SETC  '&CHARS(4)'(3,&K-3)      STRIP 1ST 2 AND LAST CHAR       69050000
         DC    AL4(&STRIP)              CHAR ARRANGEMENT TBL 4 ADDR     69100000
         AGO   .LISTDON                 GO SET CHARS FLAG      @Z40MSCD 69150000
.CH4RG   ANOP                                                  @Z40MSCD 69200000
         DC    AL4(0)                   CHAR ARRANGEMENT TBL 4 ADDR     69250000
         AGO   .LISTDON                 GO SET CHARS FLAG      @Z40MSCD 69600000
.CH4CL   ANOP                                                  @Z40MSCD 69650000
         DC    CL4'&CHARS(4)'           CHAR ARRANGEMENT TBL 4 ID       69700000
.LISTDON ANOP                           LIST FINISH            @Z40MSCD 69750000
&SWCHAR  SETB  (1)                      CHARS DC GENERATED     @Z40MSCD 69800000
.* *********************                                       @G38ESMH 69802000
.* MSGAREA PARAMETER PROCESSING                                @G38ESMH 69804000
.* *********************                                       @G38ESMH 69806000
.MSGAREA AIF   ('&MSGAREA' EQ '' OR &MSGANRG).MSGA1            @G38ESMH 69808000
         DC    AL4(&MSGAREA)            MSGAREA ADDRESS                 69810000
.*                                                             @G38ESMH 69812000
         AGO   .MSGA2                   SET MOVE SWITCH        @G38ESMH 69814000
.MSGA1   AIF   ('&MF(1)' EQ 'E').LIBDCB SKIP DC=0 FOR MF=E     @G38ESMH 69816000
         DC    AL4(0)                   MSGAREA ADDRESS                 69818000
.*                                                             @G38ESMH 69820000
.MSGA2   ANOP                                                  @G38ESMH 69822000
&SWMSGA  SETB  (1)                      SET MOVE SWITCH        @G38ESMH 69824000
.* *********************                                       @G38ESMH 69826000
.* LIBDCB PARAMETER PROCESSING                                 @G38ESMH 69828000
.* *********************                                       @G38ESMH 69830000
.LIBDCB  AIF   ('&LIBDCB' EQ '' OR &LDCBNRG).LDCB1             @G38ESMH 69832000
         DC    AL4(&LIBDCB)             LIBRARY DCB ADDRESS             69834000
.*                                                             @G38ESMH 69836000
         AGO   .LDCB2                   GO SET MOVE SWITCH     @G38ESMH 69838000
.LDCB1   AIF   ('&MF(1)' EQ 'E').BEGIN  SKIP DC=0 FOR EXECUTE  @G38ESMH 69840000
         DC    AL4(0)                   LIBRARY DCB ADDRESS             69842000
.*                                                             @G38ESMH 69844000
.LDCB2   ANOP                                                  @G38ESMH 69846000
&SWLDCB  SETB  (1)                      SET MOVE SWITCH        @G38ESMH 69848000
.* *********************                                       @Z40MSCD 69850000
.* END OF DEFINE CONSTANTS PROCESSING                          @Z40MSCD 69900000
.* *********************                                       @Z40MSCD 70200000
         AIF   ('&MF' EQ 'L').EXIT      STOP HERE IF MF=L      @Z40MSCD 70300000
         AIF   ('&MF' EQ '').STREGS     SKIP MVC PROC. IF STAN.         70350000
.* *******************                                         @Z40MSCD 70400000
.* BUILD MVC INSTRUCTIONS TO MOVE PARAMETERS INTO SETPRT LIST  @Z40MSCD 70450000
.* *******************                                         @Z40MSCD 70500000
.BEGIN   ANOP                                                  @Z40MSCD 70800000
IHB&NO.B DS    0H                                                       70850000
.* *******************                                         @Z40MSCD 70900000
.*  CHECK FOR AND ALTER LENGTHS FOR DCB    PARM MOVE           @Z40MSCD 70950000
.* *******************                                         @Z40MSCD 71000000
.BEGIN10 AIF   (&SWDCBA EQ (0)).TSWUCS1 SKIP IF NO DCB         @G38ESMH 71050000
&TO      SETA  0                        MOVE TO LOCATION 0     @Z40MSCD 71500000
&LENG    SETA  &LENG+4                  ADD 4 TO MOVE LENGTH   @Z40MSCD 71550000
&SWDCBA  SETB  (0)                      RESET DCB MOVE SW.     @Z40MSCD 71600000
.* *******************                                         @Z40MSCD 71650000
.*  CHECK FOR AND ALTER LENGTHS FOR UCS PARM MOVE              @Z40MSCD 71700000
.* *******************                                         @Z40MSCD 72000000
.TSWUCS1 ANOP                                                  @Z40MSCD 72050000
         AIF   (&SWUCS1 EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 72100000
         AIF   (&SWUCS1 EQ (0)).TSWUCS2 SKIP IF NO UCS1        @Z40MSCD 72150000
         AIF   ('&LENG' NE '0').UCS1D   IS TO LOCATION SET     @Z40MSCD 72200000
&TO      SETA  4                        MOVE TO LOCATION 4     @Z40MSCD 72250000
.UCS1D   ANOP                                                  @Z40MSCD 72300000
&LENG    SETA  &LENG+4                  ADD 4 TO MOVE LENGTH   @Z40MSCD 72600000
&SWUCS1  SETB  (0)                      RESET UCS1 MOVE SW.    @Z40MSCD 72650000
.* *******************                                         @Z40MSCD 72700000
.*  CHECK FOR AND ALTER LENGTHS FOR UCS    PARM MOVE           @Z40MSCD 72750000
.* *******************                                         @Z40MSCD 72800000
.TSWUCS2 ANOP                                                  @Z40MSCD 72850000
         AIF   (&SWUCS2 EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 73200000
         AIF   (&SWUCS2 EQ (0)).TSWUCS3 SKIP IF NO UCS2        @Z40MSCD 73250000
         AIF   ('&LENG' NE '0').UCS2D   IS TO LOCATION SET     @Z40MSCD 73300000
&TO      SETA  8                        MOVE TO LOCATION 8     @Z40MSCD 73350000
.UCS2D   ANOP                                                  @Z40MSCD 73400000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 73450000
&SWUCS2  SETB  (0)                      RESET UCS2 MOVE SW.    @Z40MSCD 73500000
.* *******************                                         @Z40MSCD 73800000
.*  CHECK FOR AND ALTER LENGTHS FOR UCS    PARM MOVE           @Z40MSCD 73850000
.* *******************                                         @Z40MSCD 73900000
.TSWUCS3 ANOP                                                  @Z40MSCD 73950000
         AIF   (&SWUCS3 EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 74000000
         AIF   (&SWUCS3 EQ (0)).TSWOPTC SKIP IF NO UCS3        @Z40MSCD 74050000
         AIF   ('&LENG' NE '0').UCS3D   IS TO LOCATION SET     @Z40MSCD 74100000
&TO      SETA  9                        MOVE TO LOCATION 9     @Z40MSCD 74400000
.UCS3D   ANOP                                                  @Z40MSCD 74450000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 74500000
&SWUCS3  SETB  (0)                      RESET UCS3 MOVE SW.    @Z40MSCD 74550000
.* ********************                                        @Z40MSCD 74600000
.*  CHECK FOR AND ALTER LENGTHS FOR OPTCD  PARM MOVE           @Z40MSCD 74650000
.* ********************                                        @Z40MSCD 75000000
.TSWOPTC AIF   ('&LENG' NE '0').MOVEIT  MOVE ANY PREVIOUS DCS  @G38ESMH 75050000
.* ********************                                        @Z40MSCD 75700000
.*  CHECK FOR AND ALTER LENGTHS FOR FCB 1  PARM MOVE           @Z40MSCD 75750000
.* ********************                                        @Z40MSCD 75800000
.TSWFCB1 AIF   (&SWFCB1 EQ (0)).TSWFCB2 SKIP IF NO FCB1        @G38ESMH 75850000
&TO      SETA  11                       SET TO LOACTION FOR 11 @G38ESMH 75900000
.FCB1D   ANOP                                                  @Z40MSCD 76350000
&LENG    SETA  &LENG+4                  ADD 4 TO MOVE LENGTH   @Z40MSCD 76400000
&SWFCB1  SETB  (0)                      RESET FCB1 MOVE SW.    @Z40MSCD 76450000
.* ********************                                        @Z40MSCD 76800000
.*  CHECK FOR AND ALTER LENGTHS FOR FCB 2  PARM MOVE           @Z40MSCD 76850000
.* ********************                                        @Z40MSCD 76900000
.TSWFCB2 ANOP                                                  @Z40MSCD 76950000
         AIF   (&SWFCB2 EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 77000000
         AIF   (&SWFCB2 EQ (0)).TSWFLG1 SKIP IF NO FCB2        @Z40MSCD 77050000
         AIF   ('&LENG' NE '0').FCB2D   IS MOVE TO LOC. SET    @Z40MSCD 77100000
&TO      SETA  15                       SET MOVE LOC. FOR 15   @Z40MSCD 77400000
.FCB2D   ANOP                                                  @Z40MSCD 77450000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 77500000
&SWFCB2  SETB  (0)                      RESET FCB2 MOVE SW.    @Z40MSCD 77550000
.* ********************                                        @Z40MSCD 77600000
.*  CHECK FOR AND ALTER LENGTHS FOR FLAG1  PARM MOVE           @Z40MSCD 77650000
.* ********************                                        @Z40MSCD 77700000
.TSWFLG1 ANOP                                                  @Z40MSCD 78000000
         AIF   ('&LENG' NE '0').MOVEIT  DO MOVE IF PREVIOUS DC @Z40MSCD 78050000
.* ********************                                        @Z40MSCD 78100000
.*  CHECK FOR AND ALTER LENGTHS FOR COPIES PARM MOVE           @Z40MSCD 78150000
.* ********************                                        @Z40MSCD 78200000
.TSWCPYS AIF   (&SWCPYS EQ (0)).TSWCPNR SKIP IF NO COPIES      @G38ESMH 78250000
&TO      SETA  18                       SET LOCATION TO 18     @G38ESMH 78300000
.CPYSD   ANOP                                                  @Z40MSCD 78800000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 78850000
&SWCPYS  SETB  (0)                      RESET COPIES MOVE SW.  @Z40MSCD 78900000
.* ********************                                        @Z40MSCD 79200000
.*  CHECK FOR AND ALTER LENGTHS FOR COPYNR PARM MOVE           @Z40MSCD 79250000
.* ********************                                        @Z40MSCD 79300000
.TSWCPNR ANOP                                                  @Z40MSCD 79350000
         AIF   (&SWCPNR EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 79400000
         AIF   (&SWCPNR EQ (0)).TSWLEN  SKIP IF NO COPYNR      @G38ESMH 79450000
         AIF   ('&LENG' NE '0').CPNRD   IS LOCATION SET        @Z40MSCD 79500000
&TO      SETA  19                       SET LOCATION TO 19     @Z40MSCD 79800000
.CPNRD   ANOP                                                  @Z40MSCD 79850000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 79900000
&SWCPNR  SETB  (0)                      RESET COPYNR MOVE SW.  @Z40MSCD 79950000
.* ********************                                        @G38ESMH 79954500
.*  CHECK FOR AND ALTER LENGTHS FOR LENGTH BYTES MOVE          @G38ESMH 79959000
.* ********************                                        @G38ESMH 79963500
.TSWLEN  AIF   (&SWLEN EQ (0) AND '&LENG' NE '0').MOVEIT       @G38ESMH 79968000
         AIF   (&SWLEN EQ (0)).TSWFLHC SKIP IF NO LENGTH       @G38ESMH 79972500
         AIF   ('&LENG' NE '0').LEN     IS LOCATION SET        @G38ESMH 79977000
&TO      SETA  20                       SET LOCATION TO 20     @G38ESMH 79981500
.LEN     ANOP                                                  @G38ESMH 79986000
&LENG    SETA  &LENG+2                  ADD 2 TO MOVE LENGTH   @G38ESMH 79990500
&SWLEN   SETB  (0)                      RESET LENGTH MOVE SW.  @G38ESMH 79995000
.* ********************                                        @Z40MSCD 80000000
.*  CHECK FOR AND ALTER LENGTHS FOR FLHCNT PARM MOVE           @Z40MSCD 81150000
.* ********************                                        @Z40MSCD 81200000
.TSWFLHC ANOP                                                  @Z40MSCD 81250000
         AIF   (&SWFLHC EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 81300000
         AIF   (&SWFLHC EQ (0)).TSWTRCN SKIP IF NO FLASH CNT   @Z40MSCD 81600000
         AIF   ('&LENG' NE '0').FLHCD   IS LOCATION SET        @Z40MSCD 81650000
&TO      SETA  22                       SET LOCATION TO 22     @Z40MSCD 81700000
.FLHCD   ANOP                                                  @Z40MSCD 81750000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 81800000
&SWFLHC  SETB  (0)                      RESET FLSH CNT MOVE SW.         81850000
.* ********************                                        @Z40MSCD 82200000
.*  CHECK FOR AND ALTER LENGTHS FOR TRC    PARM MOVE           @Z40MSCD 82250000
.* ********************                                        @Z40MSCD 82300000
.TSWTRCN ANOP                                                  @Z40MSCD 82350000
         AIF   (&SWTRCN EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 82400000
         AIF   (&SWTRCN EQ (0)).TSWMODI SKIP IF NO MODIFY TRC  @Z40MSCD 82450000
         AIF   ('&LENG' NE '0').TRCND   IS LOCATION SET        @Z40MSCD 82500000
&TO      SETA  23                       SET LOCATION TO 23     @Z40MSCD 82800000
.TRCND   ANOP                                                  @Z40MSCD 82850000
&LENG    SETA  &LENG+1                  ADD 1 TO MOVE LENGTH   @Z40MSCD 82900000
&SWTRCN  SETB  (0)                      RESET MOD TRC MOVE SW. @Z40MSCD 82950000
.* ********************                                        @Z40MSCD 83000000
.*  CHECK FOR AND ALTER LENGTHS FOR MODIFY PARM MOVE           @Z40MSCD 83050000
.* ********************                                        @Z40MSCD 83100000
.TSWMODI ANOP                                                  @Z40MSCD 83400000
         AIF   (&SWMODI EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 83450000
         AIF   (&SWMODI EQ (0)).TSWFLSH SKIP IF NO MODIFY ID   @Z40MSCD 83500000
         AIF   ('&LENG' NE '0').MODID   IS LOCATION SET        @Z40MSCD 83550000
&TO      SETA  24                       SET LOCATION TO 24     @Z40MSCD 83600000
.MODID   ANOP                                                  @Z40MSCD 83650000
&LENG    SETA  &LENG+4                  ADD 4 TO MOVE LENGTH   @Z40MSCD 84000000
&SWMODI  SETB  (0)                      RESET MOD ID MOVE SW.  @Z40MSCD 84050000
.* ********************                                        @Z40MSCD 84100000
.*  CHECK FOR AND ALTER LENGTHS FOR FLASH  PARM MOVE           @Z40MSCD 84150000
.* ********************                                        @Z40MSCD 84200000
.TSWFLSH ANOP                                                  @Z40MSCD 84250000
         AIF   (&SWFLSH EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 84300000
         AIF   (&SWFLSH EQ (0)).TSWCHR1 SKIP IF NO FLASH ID    @Z40MSCD 84600000
         AIF   ('&LENG' NE '0').FLSHD   IS LOCATION SET        @Z40MSCD 84650000
&TO      SETA  28                       SET LOCATION TO 28     @Z40MSCD 84700000
.FLSHD   ANOP                                                  @Z40MSCD 84750000
&LENG    SETA  &LENG+4                  ADD 4 TO MOVE LENGTH   @Z40MSCD 84800000
&SWFLSH  SETB  (0)                      RESET FLASH ID MOVE SW.         84850000
.* ********************                                        @Z40MSCD 84900000
.*  CHECK FOR AND ALTER LENGTHS FOR CHARS  PARM MOVE           @Z40MSCD 85200000
.* ********************                                        @Z40MSCD 85250000
.TSWCHR1 ANOP                                                  @Z40MSCD 85300000
         AIF   (&SWCHAR EQ (0) AND '&LENG' NE '0').MOVEIT      @Z40MSCD 85500000
         AIF   (&SWCHAR EQ (0)).TSWMSGA SKIP IF NO CHARS       @G38ESMH 85550000
         AIF   ('&LENG' NE '0').CHR1D   IS LOCATION SET        @Z40MSCD 85600000
&TO      SETA  32                       SET LOCATION TO 32     @Z40MSCD 85650000
.CHR1D   ANOP                                                  @Z40MSCD 85900000
&LENG    SETA  &LENG+16                 ADD 16 TO MOVE LENGTH  @Z40MSCD 85950000
&SWCHAR  SETB  (0)                      RESET CHARS MOVE SW.   @Z40MSCD 86000000
.* **********************                                      @G38ESMH 86003800
.* CHECK FOR AND ALTER LENGTHS FOR MSGAREA MOVE                @G38ESMH 86007600
.* **********************                                      @G38ESMH 86011400
.TSWMSGA AIF   (&SWMSGA EQ (0) AND &LENG NE 0).MOVEIT          @G38ESMH 86015200
         AIF   (&SWMSGA EQ (0)).TSWLDCB IF NO MOVE NEEDED SKIP @G38ESMH 86019000
         AIF   (&LENG NE 0).MSGA        IS THIS FIRST LOCATION @G38ESMH 86022800
&TO      SETA  48                       SET BEGIN LOCATION     @G38ESMH 86026600
.MSGA    ANOP                                                  @G38ESMH 86030400
&LENG    SETA  &LENG+4                  INCREMENT LENGTH COUNT @G38ESMH 86034200
&SWMSGA  SETB  (0)                      CLEAR MOVE SWITCH      @G38ESMH 86038000
.* **********************                                      @G38ESMH 86041800
.* CHECK FOR AND ALTER LENGTHS FOR LIBDCB MOVE                 @G38ESMH 86045600
.* **********************                                      @G38ESMH 86049400
.TSWLDCB AIF   (&SWLDCB EQ (0) AND &LENG NE 0).MOVEIT          @G38ESMH 86053200
         AIF   (&SWLDCB EQ (0)).ENDMOVE IF NO MOVE NEEDED SKIP @G38ESMH 86057000
         AIF   (&LENG NE 0).LDCB        IS THIS FIRST LOCATION @G38ESMH 86060800
&TO      SETA  52                       SET STARTING LOCATION  @G38ESMH 86064600
.LDCB    ANOP                                                  @G38ESMH 86068400
&LENG    SETA  &LENG+4                  INCREMENT LENGTH       @G38ESMH 86072200
&SWLDCB  SETB  (0)                      CLEAR MOVE SWITCH      @G38ESMH 86076000
.* *********************                                       @G38ESMH 86079800
.* END OF MOVES FOR EXECUTE FORM                               @G38ESMH 86083600
.* *********************                                       @G38ESMH 86087400
.ENDMOVE AIF   (&LENG NE 0).MOVEIT      MOVE LAST BLOCK OF DCS @G38ESMH 86091200
.* *********************                                       @G38ESMH 86095000
.* GENERATE CODE TO ALTER OPTCD-DISP FLAG                      @G38ESMH 86098800
.* *********************                                       @G38ESMH 86102600
.BLDFLAG AIF   (NOT &SWOPTC).BLDFLG1    ANY CHANGES TO FLAG?   @G38ESMH 86106400
         AIF   (&BLKOFF AND &UBLKOFF AND &SCDOFF AND &NOSCDOF AND      X86110200
               &UFLDOFF AND &FLDOFF).NOAND0                    @G38ESMH 86114000
         NI    10(1),B'&BLKOFF&UBLKOFF&SCDOFF&NOSCDOF&UFLDOFF&FLDOFF&REX86117800
               SVDOF&EXTLST'                                            86121600
.*                                                             @G38ESMH 86125400
.NOAND0  AIF   (NOT(&BLKON OR &UBLKON OR &SCDON OR &NOSCDON OR &UFLDON X86129200
               OR &FLDON)).BLDFLG1      ANY BITS TO SET?       @G38ESMH 86133000
         OI    10(1),B'&BLKON&UBLKON&SCDON&NOSCDON&UFLDON&FLDON&RESVD&E*86136800
               XTLST'                                                   86140600
.*                                                             @G38ESMH 86144400
.* **********************                                      @Z40MSCD 86150000
.* GENERATE CODE TO ALTER FLAG1                                @Z40MSCD 86400000
.* **********************                                      @Z40MSCD 86450000
.BLDFLG1 AIF   (NOT &SWFLG1).BLDFLG2    SKIP IF NO CHANGES     @G38ESMH 86500000
         AIF   (&BRSTOFF AND &RXMTOFF AND &INITOFF AND &NOPRTOF).NOAND  86550000
.*                                                             @G38ESMH 86600000
         NI    16(1),B'&BRSTOFF&RXMTOFF&INITOFF&NOPRTOF.1111'           86650000
.*                                                             @G38ESMH 86700000
.NOAND   AIF   (NOT(&BRSTON OR &RXMTON OR &INITON OR &NOPRTON)).BLDFLG2 86750000
.*                                                             @G38ESMH 86800000
         OI    16(1),B'&BRSTON&RXMTON&INITON&NOPRTON.0000'              86850000
.*                                                             @G38ESMH 87300000
.* **********************                                      @Z40MSCD 87350000
.* GENERATE CODE TO ALTER FLAG2                                @Z40MSCD 87400000
.* **********************                                      @Z40MSCD 87600000
.BLDFLG2 ANOP                                                  @Z40MSCD 87650000
         AIF   (&SWFLG2 EQ (0) AND '&INIT' EQ 'Y' AND '&MF(1)' EQ 'E').*87700000
               ANDOFF                   GO RESET ALLFLAG TWO   @Z40MSCD 87750000
         AIF   (&SWFLG2 EQ (0)).STREGS  CHK FOR FLAG2 CHANGES  @Z40MSCD 87800000
         AIF   (&MODILIB EQ (1) AND &CH1ILIB EQ (1) AND &CH2ILIB EQ (1)X87850000
                AND &CH3ILIB EQ (1) AND &CH4ILIB EQ (1) AND &FCBILIB EQX87900000
                (1)).NOAND2             IS AND NEEDED          @Z40MSCD 88230000
         NI    17(1),B'&MODILIB&CH1ILIB&CH2ILIB&CH3ILIB&CH4ILIB&FCBILIBX88320000
               .11'                                                     88410000
.NOAND2  ANOP                                                  @Z40MSCD 88500000
         AIF   (&MODNCOR EQ (0) AND &CH1NCOR EQ (0) AND &CH2NCOR EQ (0)X88590000
                AND &CH3NCOR EQ (0) AND &CH4NCOR EQ (0) AND &FCBNCOR EQX88680000
                (0)).STREGS             IS OR NEEDED           @Z40MSCD 88770000
         OI    17(1),B'&MODNCOR&CH1NCOR&CH2NCOR&CH3NCOR&CH4NCOR&FCBNCORX88800000
               .00'                                                     88850000
         AGO   .STREGS                  GO SAVE REGS           @Z40MSCD 88900000
.ANDOFF  ANOP                                                  @Z40MSCD 88950000
         AIF   ('&MODIFY' EQ '*' AND '&CHARS' EQ '*' AND '&FCB' EQ '*')X89000000
               .STREGS                  SKIP IF ALL ARE '*'    @Z40MSCD 89050000
         NI    17(1),B'00000011'        RESET FLAG I                    89100000
.* ***********************                                     @Z40MSCD 89150000
.* STORE VALUES IN REGISTERS INTO SETPRT LIST                  @Z40MSCD 89400000
.* ***********************                                     @Z40MSCD 89450000
.STREGS   ANOP                                                 @Z40MSCD 89500000
         AIF   (&DCBNREG EQ (0)).FCBREG TEST IF DCB=(R)        @Z40MSCD 89550000
         ST    &DCB(1),0(0,1)           SET DCB ADDRESS                 89600000
.FCBREG  ANOP                                                  @Z40MSCD 89650000
         AIF   (&FCBNREG EQ (0)).MODREG FCB NOT IN REG         @Z40MSCD 89700000
&K       SETA  K'&FCB(1)                NO. CHAR IN FCB REGNAME         90000000
&STRIP   SETC  '&FCB(1)'(3,&K-3)        REMOVE NAME FROM PARM  @Z40MSCD 90050000
         ST    &STRIP,11(0,1)           SET FCB ADDRESS                 90100000
.MODREG  ANOP                                                  @Z40MSCD 90150000
         AIF   (&MODNREG EQ (0)).CH1REG MODIFY NOT IN REG      @Z40MSCD 90200000
&K       SETA  K'&MODIFY(1)             NO. CHAR IN MOD REGNAME         90250000
&STRIP   SETC  '&MODIFY(1)'(3,&K-3)     REMOVE NAME FROM PARM  @Z40MSCD 90300000
         ST    &STRIP,24(0,1)           SET MODIFY ADDRESS              90600000
.CH1REG  ANOP                                                  @Z40MSCD 90650000
         AIF   (&CH1NREG EQ (0)).CH2REG CHAR1 NOT IN REG       @Z40MSCD 90700000
&K       SETA  K'&CHARS(1)              NO. CHAR IN CHAR1      @Z40MSCD 90750000
&STRIP   SETC  '&CHARS(1)'(3,&K-3)      REMOVE REGNAM FROM PARM         90800000
         ST    &STRIP,32(0,1)           SET CHAR ARRANGEMENT TBL 1 ADDR 90850000
.CH2REG  ANOP                                                  @Z40MSCD 91200000
         AIF   (&CH2NREG EQ (0)).CH3REG CHAR2 NOT IN REG       @Z40MSCD 91250000
&K       SETA  K'&CHARS(2)              NO. CHAR IN CHAR2      @Z40MSCD 91300000
&STRIP   SETC  '&CHARS(2)'(3,&K-3)      REMOVE REGNAM FROM PARM         91350000
         ST    &STRIP,36(0,1)           SET CHAR ARRANGEMENT TBL 2 ADDR 91400000
.CH3REG  ANOP                                                  @Z40MSCD 91450000
         AIF   (&CH3NREG EQ (0)).CH4REG CHAR3 NOT IN REG       @Z40MSCD 91500000
&K       SETA  K'&CHARS(3)              NO.CHAR IN CHARS3      @Z40MSCD 91800000
&STRIP   SETC  '&CHARS(3)'(3,&K-3)      REMOVE REGNAME FROM PARM        91850000
         ST    &STRIP,40(0,1)           SET CHAR ARRANGEMENT TBL 3 ADDR 91900000
.CH4REG  ANOP                                                  @Z40MSCD 91950000
         AIF   (&CH4NREG EQ (0)).MSGREG CHARS4 NOT IN REGISTER @G38ESMH 92000000
&K       SETA  K'&CHARS(4)              NO. CHAR IN CHARS4     @Z40MSCD 92050000
&STRIP   SETC  '&CHARS(4)'(3,&K-3)      REMOVE REGNAM FROM PARM         92100000
         ST    &STRIP,44(0,1)           SET CHAR ARRANGEMENT TBL 4 ADDR 92400000
.MSGREG  AIF   (NOT &MSGANRG).LDCBREG   MSGAREA NOT IN REGISTER@G38ESMH 92411100
&STRIP   SETC  '&MSGAREA'(2,K'&MSGAREA-2) REMOVE REG. NAME     @G38ESMH 92422200
         ST    &STRIP,48(0,1)           SET MSGAREA ADDRESS             92433300
.*                                                             @G38ESMH 92444400
.LDCBREG AIF   (NOT &LDCBNRG).SVC81     LIBDCB NOT IN REG.     @G38ESMH 92455500
&STRIP   SETC  '&LIBDCB'(2,K'&LIBDCB-2)                        @G38ESMH 92466600
         ST    &STRIP,52(0,1)           SET LIBDCB ADDRESS              92477700
.*                                                             @G38ESMH 92488800
.* ********************                                        @Z40MSCD 92500000
.*  ISSUE SVC 81                                               @Z40MSCD 92550000
.* ********************                                        @Z40MSCD 92600000
.SVC81   ANOP                                                  @Z40MSCD 92650000
*                                                                       93000000
         SVC   81                       ISSUE SETPRT SVC                93050000
.EXIT    ANOP                                                  @Z40MSCD 93100000
*                                                                       93150000
         MEXIT                                                 @Z40MSCD 93200000
.* ********************                                        @Z40MSCD 93250000
.*  MOVE FROM CODE GENERATED BY EXEC TO SETPRT PARM LIST       @Z40MSCD 93300000
.* ********************                                        @Z40MSCD 93600000
.MOVEIT  ANOP                                                  @Z40MSCD 93650000
         MVC   &TO.(&LENG,1),IHB&NO.A+&FROM MOVE TO LIST                93700000
&FROM    SETA  &FROM+&LENG              INCREMENT FROM PTR     @Z40MSCD 93750000
&LENG    SETA  0                        RESET LENGTH           @Z40MSCD 93800000
&TO      SETA  0                        RESET TO PTR           @Z40MSCD 93850000
         AGO   .BEGIN10                 GO LOOK FOR DC         @Z40MSCD 93900000
         MEND                                                  @Z40MSCD 94200000
