         MACRO                                                          00050000
         SGDEBCHK &DEBTSIZ=0,&DEBTINC=0                                 00100000
         TITLE 'IFGDEBCK                        DEB VALIDITY CHECK ROUTI00150000
               INE'                                                     00200000
.********************************************************************** 00250000
.********************************************************************** 00300000
.*0000                                                           YM2643 00310000
.*0000                                                           XM8956 00320000
.*0000                                                           XM0423 00330000
.*0000461600,657600                                              XM0882 00340000
.*0000417700                                                   @ZA02852 00342000
.*             VS2 RELEASE 037 CHANGES                                  00344000
.*A674500-674700                                               @ZA26208 00346000
.*A535501-535509,712200-712200                                 @ZA20762 00347000
.*D441000-442000,A450770-450910                                @ZA38025 00348000
.*C712200-712200                                               @ZA42565 00348900
.*                                                             @ZA31908 00349200
.*C712200                                                      @ZA46200 00349500
.*                                                             @ZA47942 00349700
.*$01=OZ79269,EDM1102,,FEGHA: ABEND16E                             @01A 00349800
.*$02=OZ85799,EDM1102,,FEGHA: ABEND16E                             @02A 00349900
.*                                                                      00350000
.* STATUS - NOT APPLICABLE                                              00400000
.*                                                                      00450000
.* FUNCTION -                                                           00500000
.*                                                                      00550000
.*       THE SGDEBCHK MACRO WILL BE EXPANDED AT SYSGEN TO PRODUCE       00600000
.*       THE IFGDEBCK ROUTINE WHICH WILL PROVIDE DEB VALIDITY           00650000
.*       CHECKING.  (THE DESCRIPTION OF THIS ROUTINE APPEARS IN         00700000
.*       THE PROLOGUE OF THE ASSEMBLED MODULE.)                         00750000
.*                                                                      00800000
.*       THE USER MAY SPECIFY TWO PARAMETERS AT SYSGEN WHICH            00850000
.*       PREVIOUSLY AFFECTED THE SIZE OF THE DEB TABLE BUT WHICH        00900000
.*       ARE NOW IGNORED: DEBTSIZE, INITIAL SIZE OF DEB TABLE           00950000
.*       (VALID VALUES: 8 - 32,760 BYTES); DEBTINCR, INCREMENTAL        01000000
.*       SIZE TO THE THE TABLE WHEN IT IS FULL (VALID VALUES:           01050000
.*       8 - 32,752 BYTES).                                             01100000
.*                                                                      01150000
.*       INSTEAD, IFGDEBCK ASSIGNS VALUES OF DEBTSIZE=24 AND            01500000
.*       DEBTINCR=24.                                                   01520000
.*                                                                      01650000
.*       THE DEB VALIDITY ROUTINE WILL BE LINK EDITED INTO              02150000
.*       IEANUC01 IN SYS1.NUCLEUS AT SYSGEN PHASE III VIA               02200000
.*       GROUP III MACRO SGIEC3FB.                                      02250000
.*                                                                      02300000
.* ENTRY POINTS -                                                       02350000
.*                                                                      02400000
.*       SGDEBCHK (GROUP 0 SYSGEN MACRO) IS CALLED VIA MACRO            02450000
.*       CALL FROM THE SYSGEN GROUP 0 ASSEMBLY PHASE VIA                02500000
.*       PUNCHED OUTPUT FROM THE GROUP II MACRO SGIEC2DT.               02550000
.*       THE DEB VALIDITY ROUTINE WILL BE LINK EDITED INTO              02600000
.*       IEANUC01 IN SYS1.NUCLEUS AT SYSGEN PHASE III VIA               02650000
.*       INCLUDE CARD PUNCHED FROM GROUP III MACRO SGIEC3FB.            02700000
.*                                                                      02750000
.* INPUT - NONE                                                         02800000
.*                                                                      03200000
.* OUTPUT -                                                             03250000
.*                                                                      03300000
.*       THIS MACRO EXPANDS AN ASSEMBLED DEB VALIDITY CHECK ROUTINE.    03350000
.*                                                                      03550000
.* EXTERNAL REFERENCES -                                                03600000
.*                                                                      03650000
.*       THIS MACRO CALLS THE FOLLOWING MACROS VIA MACRO CALL:          03700000
.*                                                                      03750000
.*       IECRES                                                         03800000
.*       IECDSECS                                                       03850000
.*       XCTLTABL                                                       03900000
.*       DEBCHK                                                         03910000
.*       TESTAUTH                                                       03950000
.*       MODESET                                                        03960000
.*       RETURN                                                         04000000
.*       ABEND                                                          04050000
.*                                                                      04250000
.* EXITS,NORMAL -                                                       04300000
.*                                                                      04350000
.*       THIS MACRO EXPANDS THE DEB VALIDITY CHECK SVC ROUTINE AND      04400000
.*       DEB VALIDITY CHECK BRANCH ENTRY ROUTINE WITH AN END CARD       04450000
.*       AND THEN RETURNS TO THE ASSEMBLER VIA MEND STATEMENT.          04500000
.*                                                                      04550000
.* EXITS,ERROR - NONE                                                   04600000
.*                                                                      05700000
.* TABLES/WORKAREAS - NONE                                              05750000
.*                                                                      05800000
.* ATTRIBUTES - NOT APPLICABLE                                          06000000
.*                                                                      06100000
.* CHARACTER CODE DEPENDENCY - NOT APPLICABLE                           06150000
.*                                                                      06200000
.* NOTES -                                                              06300000
.*                                                                      06350000
.*       ASSEMBLER XF OR COMPARABLE ASSEMBLER MUST BE USED IN           06400000
.*       CONJUNCTION WITH THIS MACRO TO ASSEMBLE 370 INSTRUCTIONS.      06450000
.*                                                                      06500000
.*       A DESCRIPTION OF THE DEB VALIDITY CHECK ROUTINE FOLLOWS        06550000
.*       IN THE PROLOGUE BELOW.                                         06600000
.*                                                                      06650000
.********************************************************************** 06700000
.********************************************************************** 06750000
*/*IFGDEBCK:                                                            06800000
*/*      CHART (AMODE)                  DEB VALIDITY CHECK ROUTINE   */ 06850000
         SPACE                                                          06900000
IGC117   CSECT                                                  YM01216 06950000
         SPACE                                                          07000000
         ENTRY IFGDEBCK                                                 07010000
         ENTRY IFGDEBVR                                                 07050000
IFGDEBCK EQU   *                        SECONDARY ENTRY POINT    Y02080 07060000
         SPACE                                                          07100000
*********************************************************************** 07150000
*********************************************************************** 07200000
*                                                                       07250000
* STATUS - NOT APPLICABLE                                               07300000
*                                                                       07350000
* FUNCTION -                                                            07400000
*                                                                       07450000
*        DEB VALIDITY CHECKING PREVENTS A USER FROM UNAUTHORIZED        07500000
*        ACCESS TO DATA ON AN EXTERNAL DEVICE AND ALLEVIATES            07550000
*        SEVERAL POSSIBILITIES OF TRANSFERRING CONTROL IN THE           07600000
*        SUPERVISOR STATE TO AN UNAUTHORIZED ROUTINE.                   07650000
*                                                                       07700000
*        THE FOLLOWING FUNCTION IS PROVIDED:                            07750000
*                                                                       07800000
*           1. A JOBSTEP TABLE IN PROTECTED CORE CONTAINING             07850000
*              POINTERS TO ALL VALID USER DEBS.                         07900000
*                                                                       07950000
*           2. A METHOD BY WHICH ANY SYSTEM FUNCTION WHICH              08000000
*              CREATES A USER DEB CAN ENTER THE POINTER TO              08050000
*              THAT DEB IN THE DEB TABLE.                               08100000
*                                                                       08150000
*           3. A METHOD BY WHICH ANY SYSTEM FUNCTION WHICH              08200000
*              DELETES A USER DEB CAN REMOVE THE POINTER                08250000
*              TO THAT DEB FROM THE TABLE.                              08300000
*                                                                       08350000
*           4. A METHOD BY WHICH ANY FUNCTION WHICH DEPENDS             08400000
*              ON THE INTEGRITY OF THE DEB CAN VALIDATE THAT DEB.       08450000
*                                                                       08500000
*        DEB VALIDITY CHECKING IS ACCOMPLISHED VIA A DEB VALIDITY       08550000
*        CHECK ROUTINE WHICH MAINTAINS AND UPDATES A TABLE OF           08600000
*        VALID DEB POINTERS IN PROTECTED CORE (LSQA). THIS FUNCTION     08650000
*        IS PROVIDED IN ADDITION TO THE EXISTING DEB VALIDITY           08700000
*        CHECKING SCHEME.                                               08750000
*                                                                       08800000
*        THE DEB VALIDITY CHECK SVC ROUTINE (DEBCHK) IS                 08850000
*        IMPLEMENTED IN THE NUCLEUS AS A TYPE II RESIDENT               08900000
*        REENTRANT SVC. IT IS ENTERED DISABLED USING THE DEBCHK         08950000
*        MACRO WHICH GENERATES AN SVC 117.                              09000000
*                                                                       09050000
*        INITIALIZATION:                                                09100000
*                                                                       09150000
*        TESTAUTH IS USED TO DETERMINE IF THE CALLING ROUTINE IS        09250000
*        AUTHORIZED. IF THE CALLING ROUTINE IS AUTHORIZED, A            09300000
*        POINTER IS INITIALIZED TO A SET OF AUTHORIZED BXLE MASKS       09400000
*        WHICH WILL CONTROL PROGRAM FLOW. IF THE CALLING ROUTINE        09450000
*        IS NOT AUTHORIZED, A POINTER IS INITIALIZED TO A SET           09500000
*        OF UNAUTHORIZED BXLE MASKS WHICH WILL CONTROL PROGRAM FLOW.    09550000
*                                                                       09600000
*        TYPE FUNCTION CHECK:                                           09650000
*                                                                       09700000
*        THE INPUT REGISTER 0 IS VALIDITY CHECKED FOR TYPE FUNCTION     09750000
*        AND USED AS AN INDEX TO AN APPROPRIATE TYPE FUNCTION BXLE      09800000
*        MASK. IF THE TYPE FUNCTION IS NOT VERIFY (0), ADD (1),         09850000
*        DELETE (2), OR PURGE (3), THE VERIFY FUNCTION BXLE MASK        09900000
*        IS LOADED AND THE ERROR EXIT IS TAKEN. IF A VALID TYPE         09950000
*        FUNCTION IS SPECIFIED, A CHECK IS MADE TO DETERMINE IF         10000000
*        THE CALLER IS AUTHORIZED FOR THE FUNCTION (I.E. CALLER         10050000
*        MUST BE AUTHORIZED FOR TYPE: ADD, DELETE, PURGE).              10100000
*                                                                       10150000
*        DCB - DEB CHECK:                                               10200000
*                                                                       10250000
*        THIS ROUTINE IS BYPASSED FOR TYPE=PURGE. FOR                   10300000
*        TYPE=VERIFY/ADD/DELETE, THE DEB ADDRESS IS LOADED INTO A       10350000
*        REGISTER FROM THE DCBDEBAD FIELD OF THE DCB, POINTED TO BY     10400000
*        THE INPUT REGISTER 1. THE HI-ORDER BYTE IS CLEARED AND THE     10450000
*        DCB ADDRESS IS EXTRACTED FROM THE DEBDCBAD FIELD OF THE        10500000
*        DEB. THE DCB ADDRESS PASSED IS COMPARED TO THE DCB ADDRESS     10550000
*        EXTRACTED. THE DEB ADDRESS IS LOADED INTO REGISTER 1 AND       10600000
*        IF THE DCB ADDRESSES ARE NOT EQUAL THE ERROR EXIT IS TAKEN.    10650000
*                                                                       10700000
*        ACCESS METHOD CHECK:                                           11050000
*                                                                       11100000
*        IF TYPE=ADD IS SPECIFIED, THE ACCESS METHOD CHECK IS           11150000
*        BYPASSED AND CONTROL IS PASSED TO THE ADD ROUTINE. IF THE      11200000
*        ACCESS METHOD VALUE (AM) IN THE HI-ORDER BYTE OF INPUT         11250000
*        REGISTER 0 IS NOT SPECIFIED (0), THE ACCESS METHOD CHECK       11300000
*        IS BYPASSED AND CONTROL IS PASSED TO THE VERIFY ROUTINE.       11350000
*        IF THE ACCESS METHOD VALUE IS SPECIFIED, THE VALUE IS          11400000
*        COMPARED TO THE ACCESS METHOD VALUE IN THE DEBAMTYP FIELD      11450000
*        IN THE DEB. IF THE VALUES ARE EQUAL, CONTROL IS PASSED TO      11500000
*        THE VERIFY ROUTINE FOR FURTHER VALIDATION. IF THE VALUES       11550000
*        ARE NOT EQUAL, CONTROL IS PASSED TO THE ERROR ROUTINE.         11600000
*                                                                       11650000
*        VERIFY:                                                        11700000
*                                                                       11750000
*        IF NO ERRORS ARE DETECTED BY THE THE FUNCTION CHECK            11800000
*        ROUTINE, THE DCB-DEB CHECK ROUTINE, OR THE ACCESS METHOD       11850000
*        CHECK ROUTINE, CONTROL WILL BE PASSED TO THIS ROUTINE IF       11900000
*        TYPE=VERIFY/DELETE/PURGE WAS SPECIFIED. ON ENTRY, THIS         11950000
*        ROUTINE LINKS TO THE BRANCH ENTRY VERIFY ROUTINE AT THE        12000000
*        SECONDARY ENTRY POINT (IFGDEBVR) TO VERIFY THE DEB             12050000
*        POINTER IN REGISTER 1. ON NORMAL RETURN FROM THE VERIFY        12100000
*        BRANCH ENTRY ROUTINE, CONTROL IS PASSED TO THE DELETE          12150000
*        ROUTINE. ON ERROR RETURN FROM THE VERIFY BRANCH ENTRY          12200000
*        ROUTINE, THE ERROR EXIT IS TAKEN.                              12250000
*                                                                       13050000
*        ADD:                                                           13100000
*                                                                       13150000
*        THIS ROUTINE WILL GET CONTROL WHEN TYPE=ADD IS SPECIFIED.      13200000
*        A TEST IS MADE TO DETERMINE IF THE DEBAMTYP FIELD AND THE      13250000
*        DEBTBLOF FIELD OF THE DEB ARE ZERO. IF NOT ZERO, THE ERROR     13300000
*        EXIT IS TAKEN. OTHERWISE, THE DEB TABLE POINTER IS TESTED      13350000
*        TO DETERMINE IF THE DEB TABLE EXISTS. IF IT DOES NOT EXIST,    13400000
*        A NEW TABLE IS CREATED. OTHERWISE, THE EMPTY QUEUE OFFSET      13450000
*        FROM THE EXISTING DEB TABLE IS TESTED TO DETERMINE IF ANY      13500000
*        EMPTY ENTRIES EXIST IN THE TABLE. IF NO EMPTY ENTRIES          13550000
*        EXIST, A NEW TABLE IS CREATED, THE OLD TABLE IS MOVED INTO     13600000
*        THE NEW TABLE, AND THE OLD TABLE IS FREED UP. IF THE NEW       13650000
*        TABLE WOULD REQUIRE IT TO EXCEED 32760 BYTES THE ERROR EXIT    13700000
*        IS TAKEN. GETMAIN/FREEMAIN WILL ABEND THE TASK IF IT           13750000
*        ENCOUNTERS AN ERROR CONDITION. WHEN AN EMPTY ENTRY IS          13800000
*        AVAILABLE, ITS FULLWORD OFFSET FROM THE BEGINNING OF THE       13850000
*        TABLE IS PLACED INTO THE DEBTBLOF FIELD OF THE DEB, THE        13900000
*        OFFSET OF THE NEXT EMPTY ENTRY IS PLACED IN THE TABLE          13950000
*        CONTROL FIELD, AND THE VALIDATED DEB ADDRESS IS INSERTED       14000000
*        INTO THE EMPTY ENTRY. CONTROL IS THEN PASSED TO THE            14050000
*        NORMAL EXIT ROUTINE.                                           14100000
*                                                                       14150000
*        DELETE/PURGE:                                                  14200000
*                                                                       14250000
*        IF TYPE=VERIFY IS SPECIFIED, THE NORMAL EXIT IS TAKEN.         14300000
*        IF TYPE=DELETE OR TYPE=PURGE IS SPECIFIED, THE VALIDATED       14350000
*        DEB POINTER IS DELETED FROM THE TABLE BY MOVING THE            14400000
*        POINTER OF THE FIRST EMPTY ENTRY FROM THE CONTROL FIELD        14450000
*        INTO THE FIRST TWO BYTES OF THE DEB TABLE ENTRY. THE           14500000
*        SECOND TWO BYTES OF THE DEB TABLE ENTRY ARE PADDED WITH        14550000
*        BINARY ONES (THIS WILL INSURE A COMPLETELY INVALID ENTRY).     14600000
*        THE OFFSET OF THE NEWLY DELETED TABLE ENTRY IS STORED          14650000
*        INTO THE CONTROL FIELD TO COMPLETE THE EMPTY ENTRY CHAIN.      14700000
*        THIS ROUTINE GIVES CONTROL TO THE NORMAL EXIT ROUTINE.         14750000
*                                                                       14800000
*        IFGDEBVR BRANCH ENTRY - VERIFY                                 14850000
*                                                                       14900000
*        THE IOS BRANCH ENTRY VERIFY ROUTINE IS POINTED TO BY           14950000
*        THE CVTDEBCK FIELD OF THE AOS CVT EXTENSION. THE               15000000
*        ENTRY POINT TO THE ROUTINE IS LABELED IFGDEBVR.                15050000
*        THE IOS BRANCH ENTRY VERIFY ROUTINE CONTAINS FROM THIRTY THREE 15250000
*        TO THIRTY SIX INSTRUCTIONS IF COMPLETED NORMALLY.              15283300
*        IOS PASSES THE ROUTINE FIVE REGISTERS.                         15316600
*        THE FUNCTION OF THE ROUTINE IS TO VERIFY THAT THE              15350000
*        DEB PASSED TO IT IS ENTERED IN THE JOBSTEP DEB TABLE           15400000
*        AT THE OFFSET INDICATED BY THE DEBTBLOF FIELD OF THE           15450000
*        DEB. IF THE VALIDATE FAILS, THE ERROR EXIT IS TAKEN            15500000
*        BY RETURNING TO AN OFFSET FOUR PAST THE RETURN REGISTER        15550000
*        14 WITH A FOUR IN REGISTER 15. IF THE POINTER TO THE           15600000
*        DEB IS ENTERED IN THE DEB TABLE THE NORMAL EXIT IS             15650000
*        TAKEN BY BRANCHING ON THE RETURN REGISTER 14 WITH A            15700000
*        ZERO IN REGISTER 15.                                           15750000
*        ALTHOUGH INTENDED SPECIFICALLY FOR USE BY IOS, THE VERIFY      15800000
*        BRANCH ENTRY ROUTINE CAN BE USED BY ANY ROUTINE WHICH          15850000
*        CONFORMS TO THE CALLING SEQUENCE REGISTER CONVENTIONS.         15900000
*        HOWEVER, ALL CALLERS MUST BE AWARE THAT A PROGRAM CHECK        15950000
*        COULD OCCUR AND SHOULD BE PREPARED TO HANDLE IT.               16000000
*                                                                       16100000
* ENTRY POINTS -                                                        16150000
*                                                                       16200000
*        IN ORDER TO ADD, DELETE, OR PURGE A DEB POINTER,               16250000
*        THE CALLER OF THE DEBCHK MACRO INSTRUCTION MUST                16300000
*        BE AN AUTHORIZED FUNCTION (SUPERVISOR STATE, KEY 0,            16350000
*        OR AUTHORIZED PROGRAM).                                        16360000
*                                                                       16400000
*        OPEN/OPENJ                                                     16450000
*                                                                       16500000
*        OPEN EXECUTORS (SAM/PAM/DAM/ISAM/EXCP/VSAM/GAM/BTAM/           16550000
*        VTAM/SUBSYSTEM) WILL BUILD THE DEB AND CHAIN IT TO THE         16560000
*        TCB AND DCB AND ISSUE THE DEBCHK MACRO WITH TYPE=ADD.          16600000
*        ON RETURN FROM THE DEBCHK ROUTINE, OPEN EXECUTORS              16650000
*        WILL STORE THE VALIDATED DEB ADDRESS IN THE DCBDEBAD           16700000
*        FIELD OF THE DCB.                                              16750000
*                                                                       16800000
*        EOV/FEOV                                                       16850000
*                                                                       16900000
*        EOV AND FEOV WILL VERIFY THE DEB AFTER ENTRY USING:            16950000
*        DEBCHK TYPE=VERIFY, AND WILL POINT THE DEB TO THE COPIED       17000000
*        DCB UNTIL EOV/FEOV RETURNS TO THE CALLER.  IF A NEW            17050000
*        DEB IS TO BE BUILT, THE OLD DEB IS DELETED USING:              17100000
*        DEBCHK TYPE=DELETE AND A NEW DEB IS ADDED USING:               17150000
*        DEBCHK TYPE=ADD. IF A USER EXIT IS TAKEN, THE DEB NEED         17200000
*        NOT BE REVERIFIED, AS IT POINTS TO THE COPIED DCB.             17250000
*                                                                       17350000
*        AN EXCEPTION TO THE ABOVE OCCURS IN THE CASE OF                17400000
*        RECORD FORMAT VBS DATA SETS OPEN FOR UPDATE. WHEN              17450000
*        THE OLD DEB IS SAVED IN THE IOB, ITS POINTER IS NOT            17500000
*        DELETED FROM THE DEB TABLE. INSTEAD, THE LAST BIT OF           17550000
*        THE DEBDCBAD FIELD IS FLIPPED (USING AN XI INSTRUCTION)        17600000
*        SO THE DEB CAN NOT BE USED AFTER EOV. WHEN FEOV IS             17650000
*        ISSUED TO DELETE THIS DEB, IT IS DELETED USING DEBCHK          17700000
*        TYPE=DELETE. WHEN FEOV IS ISSUED TO ACTIVATE THE SAVED         17750000
*        DEB THE BRANCH ENTRY VERIFY ROUTINE POINTED TO BY THE          17800000
*        SECONDARY CVT IS USED TO INSURE THAT THE DEB SAVED IN          17850000
*        THE IOB IS STILL VALID. IF VALID, THE LAST BIT OF THE          17900000
*        DEBDCBAD FIELD IS FLIPPED AGAIN AND THE OLD DEB IS             17950000
*        DELETED USING DEBCHK TYPE=DELETE.                              18000000
*                                                                       18050000
*        CLOSE:                                                         18100000
*                                                                       18150000
*        IN ADDITION TO THE REGULAR VERIFICATION, CLOSE WILL            18200000
*        VERIFY THE DEB AFTER ENTRY USING: DEBCHK TYPE=VERIFY.          18250000
*        THE DEB IS DELETED ON RETURN FROM THE ACCESS METHOD            18300000
*        EXECUTORS USING: DEBCHK TYPE=DELETE.  IF A USER EXIT           18350000
*        IS TAKEN OR IF AN EXIT IS MADE TO DO I/O, THE DEB NEED         18400000
*        NOT BE REVERIFIED AS IT IS NO LONGER IN THE DEB TABLE.         18450000
*                                                                       18500000
*        TCLOSE:                                                        18550000
*                                                                       18650000
*        TCLOSE WILL VERIFY THE DEB AFTER ENTRY USING: DEBCHK           18700000
*        TYPE=VERIFY, AND WILL POINT THE DEB TO THE COPIED DCB          18750000
*        UNTIL TCLOSE RETURNS TO THE CALLER.  IF A USER EXIT            18800000
*        IS TAKEN, THE DEB NEED NOT BE REVERIFIED, AS IT                18850000
*        POINTS TO THE COPIED (PROTECTED) DCB.                          18900000
*                                                                       19000000
*        SAM/PAM/DAM DEB VALIDITY CHECKING                              19050000
*                                                                       19100000
*        THE SVC ROUTINES LISTED WILL VALIDITY CHECK THE DEB            19150000
*        ON ENTRY USING DEBCHK TYPE=VERIFY: STOW, FREEDBUF.             19200000
*                                                                       19250000
*        ISAM DEB VALIDITY CHECKING                                     19300000
*                                                                       19350000
*        DISABLE SVC(IGC054) AND BISAM ASYNCHROUNOUS MODULES            19400000
*        WILL USE DEBCHK TYPE=VERIFY UPON ENTRY.                        19450000
*                                                                       19500000
*        ISAM CLOSE EXECUTORS:                                          19550000
*                                                                       19600000
*        WHENEVER A BRANCH WILL BE TAKEN TO AN ADDRESS TAKEN            19650000
*        FROM THE DEB, DEBCHK WILL BE USED TO GET                       19700000
*        ADDRESSABILITY TO THE DEB AND/OR SYNCH WILL BE USED            19750000
*        TO PASS CONTROL TO THE ADDRESS IN THE DEB.                     19800000
*                                                                       19850000
*        LINK/LOAD/XCTL/ATTACH DEB VALIDITY CHECKING                    19900000
*                                                                       19950000
*        LINK/LOAD/XCTL/ATTACH WILL VERIFY THE DEB ADDRESS USING        20000000
*        DEBCHK TYPE=VERIFY.                                            20050000
*                                                                       20100000
*        RESTART DEB VALIDITY CHECKING                                  20150000
*                                                                       20200000
*        AT RESTART TIME: DEBCHK TYPE=ADD WILL BE ISSUED AGAINST        20250000
*        EACH DEB REBUILT. THIS WILL ENSURE THAT EACH DEB GETS          20300000
*        ENTERED INTO THE DEB TABLE.                                    20350000
*                                                                       20400000
*        UTILITIES DEB VALIDITY CHECKING                                20450000
*                                                                       20500000
*        IEHDASDR - IGC0008B: DEBCHK TYPE=ADD AND TYPE=DELETE           20550000
*        ARE USED TO ADD AND DELETE ITS DEB FROM THE DEB TABLE.         20600000
*                                                                       20650000
*        OLTEP - A DEB IS BUILT BY IGC0005I (SVC59) AND USED            20700000
*                BY OLTEP. DEBCHK TYPE=ADD AND TYPE=DELETE              20750000
*                ARE USED TO ADD AND DELETE THE DEB FROM THE            20800000
*                DEB TABLE.                                             20850000
*                                                                       20900000
*        IOS DEB VALIDITY CHECKING                                      20950000
*                                                                       21000000
*        IOS USES A SPECIAL BRANCH ENTRY INTERFACE INTO THE             21050000
*        DEB VALIDITY CHECK VERIFY ROUTINE TO VERIFY THE DEB            21100000
*        POINTER ASSOCIATED WITH AN EXCP OPERATION. WHEN AN             21150000
*        EXCP IS ISSUED IOS GAINS CONTROL AND DISABLES ALL              21200000
*        INTERRUPTS. A 'RING' CHECK (THE DCB POINTER IN THE             21250000
*        IOB IS COMPARED TO THE DCB POINTER IN THE DEB) AND             21300000
*        KEY 0 TEST ARE MADE ON THE DCB/DEB POINTERS AS AN              21350000
*        INITIAL VALIDITY CHECK OF THE CONTROL BLOCKS. THEN             21400000
*        BEFORE SIO IS ISSUED, THE FINAL VALIDITY CHECK IS              21450000
*        MADE USING THE DEB VALIDITY CHECK VERIFY BRANCH                21500000
*        ENTRY WITH THE FOLLOWING CALLING SEQUENCE:                     21550000
*                                                                       21600000
*              TEST FOR EXCP ISSUED FROM KEY 0 ROUTINE:                 21650000
*              BZ   CONTINUE         IF KEY ZERO, AVOID DEBCHK          21700000
*              LR   R10,RTCB         RQE'S TCB IN REGISTER 10           21750000
*              LR   R1,RDEB          DEB POINTER IN REGISTER 1          21800000
*              L    R15,=V(IFGDEBVR) ENTRY POINT IN REGISTER 15         21850000
*              BALR R14,R15          LINK TO DEBCHK VERIFY              21900000
*              B    CONTINUE         NORMAL RETURN (REG 15 = 0)         21950000
*              B    ERROR            INVALID DEB (REG 15 = 4)           22000000
*                                                                       22050000
*        ABEND/STAE DEB VALIDITY CHECKING                               22100000
*                                                                       22150000
*        DURING ABEND/STAE PROCESSING, EACH OPEN DATA SET               22200000
*        ASSOCIATED WITH A TASK IS CLOSED. IF CLOSE ABENDS,             22250000
*        A RECURSIVE ABEND SITUATION DEVELOPS. TO ALLEVIATE             22300000
*        THIS PROBLEM, ABEND WILL PURGE THE DEB FROM THE DEB            22350000
*        TABLE AND THEN UNCHAIN IT FROM THE TCB. ABEND WILL             22400000
*        PASS THE DEB ADDRESS TO DEBCHK TYPE=PURGE. ON                  22450000
*        NORMAL RETURN REGISTER 15 IS SET TO ZERO.  IF AN               22500000
*        ERROR CONDITION IS ENCOUNTERED CONTROL WILL BE                 22550000
*        RETURNED TO ABEND/STAE WITH A NON-ZERO RETURN                  22600000
*        CODE IN REGISTER 15 (SEE RETURN CODES UNDER                    22650000
*        DESCRIPTION OF EXITS,ERROR). DEBCHK WITH THE                   22700000
*        DELETE OPTION SPECIFIED IS NOT USED FOR TWO                    22750000
*        REASONS:                                                       22800000
*                                                                       22850000
*              1. THE DCB POINTED TO BY THE DEB MAY HAVE                22900000
*                 HAD ITS DCBDEBAD FIELD OVERLAID, THUS                 22950000
*                 PREVENTING DEBCHK FROM OBTAINING THE DEB              23000000
*                 ADDRESS AND CAUSING EITHER A PROGRAM CHECK            23050000
*                 OR A 16E ABEND, EITHER OF WHICH IS A                  23100000
*                 RECURSIVE ABEND SITUATION.                            23150000
*                                                                       23200000
*              2. FOR REASONS OTHER THAN ABOVE DEBCHK MAY               23250000
*                 ABEND WITH A 16E COMPLETION CODE CAUSING              23300000
*                 ANOTHER RECURSIVE ABEND SITUATION.                    23350000
*                                                                       23400000
* INPUT -                                                               23450000
*                                                                       23500000
*        IFGDEBCK SVC ROUTINE                                           23550000
*                                                                       23600000
*        REGISTER 0: BITS 0-7: ACCESS METHOD VALUE: ISAM   = X'80'      23650000
*                                                   BDAM   = X'40'      23700000
*                                                   SAM    = X'20'      23750000
*                                                   BPAM   = X'20'      23800000
*                                                   TAM    = X'10'      23850000
*                                                   GAM    = X'08'      23900000
*                                                   TCAM   = X'04'      23950000
*                                                   EXCP   = X'02'      24000000
*                                                   VSAM   = X'01'      24010000
*                                                   SUBSYS = X'81'      24020000
*                                                   VTAM   = X'82'      24030000
*                                                   TCAMAP = X'84'      24040000
*                                                   NONE   = X'00'      24050000
*                    BITS 8-31: TYPE FUNCTION CODE: VERIFY = 0          24100000
*                                                   ADD    = 1          24150000
*                                                   DELETE = 2          24200000
*                                                   PURGE  = 3          24250000
*        REGISTER 1: BITS 0-7: X'00'                                    24300000
*                    BITS 8-31: DCB POINTER IF TYPE NOT PURGE           24350000
*                               DEB POINTER IF TYPE=PURGE               24400000
*        REGISTER 3: CVT POINTER (INITIALIZED BY SVC HANDLER)           24450000
*        REGISTER 4: TCB POINTER (INITIALIZED BY SVC HANDLER)           24500000
*        REGISTER 5: RB  POINTER (INITIALIZED BY SVC HANDLER)           24550000
*                                                                       24600000
*        IFGDEBVR BRANCH ENTRY VERIFY ROUTINE                           24650000
*                                                                       24700000
*        REGISTER  1 CONTAINS A DEB POINTER (HI BYTE = 0).              24750000
*        REGISTER 10 CONTAINS THE TCB ADDRESS FROM THE RQE              24800000
*        REGISTER 11 CONTAINS NOTHING TO BE SAVED.                      24850000
*        REGISTER 14 CONTAINS THE RETURN ADDRESS OF A BRANCH TABLE.     24900000
*        REGISTER 15 CONTAINS THE ENTRY POINT TO DEBCHK VERIFY.         24950000
*                                                                       25000000
* OUTPUT -                                                              25050000
*                                                                       25100000
*        ON NORMAL EXIT FROM THE IFGDEBCK SVC ROUTINE:                  25150000
*                                                                       25160000
*        RETURN (BR 14) TO EXIT PROLOGUE                                25170000
*                                                                       25200000
*        REGISTER  0: UNRELIABLE                                        25250000
*        REGISTER  1: BITS 0-7: X'00'                                   25300000
*                     BITS 8-31: DEB POINTER                            25350000
*        REGISTER 15: BITS 0-31: X'00'                                  25400000
*        REGISTERS 2 - 14: RESTORED                                     25450000
*                                                                       25500000
*        ON ERROR EXIT FROM THE IFGDEBCK SVC ROUTINE:  -  ABEND 16E     25550000
*                                                                       25600000
*        REGISTER  0: UNRELIABLE                                        25650000
*        REGISTER  1: UNRELIABLE                                        25700000
*        REGISTER 15: RETURN CODE - SEE ERROR EXIT                      25750000
*        REGISTERS 2 - 14: RESTORED                                     25800000
*                                                                       25850000
*        ON NORMAL EXIT FROM THE IFGDEBVR                               25900000
*        BRANCH ENTRY VERIFY ROUTINE  -   RETURN (BR 14)                25950000
*                                                                       26000000
*        REGISTER  1 CONTAINS A VERIFIED DEB POINTER.                   26050000
*        REGISTER 10 CONTAINS THE DEB TABLE POINTER.                    26100000
*        REGISTER 11 CONTAINS THE DEB TABLE OFFSET.                     26150000
*        REGISTER 14 CONTAINS THE RETURN ADDRESS.                       26200000
*        REGISTER 15 CONTAINS ZERO (0).                                 26250000
*        REGISTERS 0-9 AND 12-14 REMAIN UNCHANGED.                      26300000
*                                                                       26350000
*        ON ERROR EXIT FROM THE IFGDEBVR                                26400000
*        BRANCH ENTRY VERIFY ROUTINE  -   B   0(R15,R14)                26450000
*                                                                       26500000
*        REGISTER  1 CONTAINS AN INVALID DEB POINTER.                   26550000
*        REGISTER 10 UNRELIABLE                                         26600000
*        REGISTER 11 UNRELIABLE                                         26650000
*        REGISTER 14 CONTAINS THE RETURN ADDRESS.                       26700000
*        REGISTER 15 CONTAINS FOUR (4).                                 26750000
*        REGISTERS 0-9 AND 12-14 REMAIN UNCHANGED.                      26800000
*                                                                       26850000
* EXTERNAL REFERENCES -                                                 26900000
*                                                                       26950000
*        CVT:                                                           27000000
*              CVTDEBCK - BRANCH ENTRY POINT TO DEBCHK VERIFY           27050000
*              CVTEXPRO - BRANCH ENTRY TO PROLOGUE                      27060000
*              CVTDMSR  - BRANCH ENTRY TO IFG019RA TO GET/FREE CORE     27070000
*        TCB:                                                           27100000
*              TCBJSCB  - POINTER TO JSCB                               27150000
*        SVRB:                                                          27200000
*              RBEXSAVE - SAVE AREA FOR 12 REGISTERS                    27350000
*        JSCB:                                                          27400000
*              JSCBDBTB - POINTER TO DEBCHK DEB TABLE (SUBPOOL 254)     27450000
*        DEB:                                                           27550000
*              DEBAMTYP - ACCESS METHOD VALUE AS SPECIFIED              27600000
*                         BY AM= WITH DEBCHK TYPE=ADD                   27650000
*              DEBTBLOF - HALFWORD OFFSET TO PROTECTED                  27700000
*                         DEB POINTER IN THE DEB TABLE                  27750000
*                                                                       27800000
* EXITS,NORMAL -                                                        27850000
*                                                                       27900000
*        REGISTER 15 IS SET TO 0 AND EXIT IS INVOKED (RETURN - BR 14).  27950000
*                                                                       28000000
* EXITS,ERROR -                                                         28050000
*                                                                       28100000
*        IFGDEBCK - SVC ROUTINE ERROR EXIT                              28150000
*                                                                       28200000
*        REGISTER 15 IS LOADED WITH AN ERROR CODE INDICATING            28250000
*        THE CAUSE OF THE ERROR AND:                                    28300000
*                                                                       28320000
*              - IF THE CALLER IS AUTHORIZED AND TYPE=ADD,              28330000
*                DELETE, OR VERIFY IS SPECIFIED, ABEND IS               28350000
*                INVOKED WITH A 16E COMPLETION CODE.                    28400000
*                                                                       28410000
*              - IF THE CALLER IS NOT AUTHORIZED, OR IF                 28450000
*                TYPE=PURGE IS SPECIFIED, EXIT IS INVOKED,              28500000
*                RETURN (BR 14) TO EXIT PROLOGUE, R15 = CODE.           28510000
*                                                                       28520000
*        THE ERROR CONDITIONS AND THE ERROR RETURN CODES PASSED         28550000
*        IN REGISTER 15 ARE:                                            28600000
*                                                                       28650000
*               4 IFGDEBVR RETURNED WITH REGISTER 15 = 4                28700000
*               8 INVALID TYPE SPECIFIED (MACRO NOT USED)               28750000
*              12 CALLER NOT AUTHORIZED: TYPE NOT VERIFY                28800000
*              16 DEBDCBAD DOES NOT POINT TO DCB PASSED                 28850000
*              20 AM VALUE DOES NOT EQUAL DEBAMTYP VALUE                28900000
*              24 DEB NOT ON TCB CHAIN FOR TYPE=ADD                     28950000
*              28 DEBAMTYP OR DEBTBLOF NOT 0 FOR TYPE=ADD               29000000
*              32 DEB TABLE CONTAINS 32760 BYTES AND TYPE=ADD           29050000
*                                                                       29100000
*        IFGDEBVR - VERIFY BRANCH ENTRY ERROR EXIT                      29150000
*                                                                       29200000
*        IF AN ERROR CONDITION IS DETECTED BY THE BRANCH                29250000
*        ENTRY ROUTINE, CONTROL IS RETURNED TO AN OFFSET FOUR           29300000
*        PAST THE RETURN REGISTER 14 WITH A FOUR IN REGISTER 15.        29350000
*        THE ERROR CONDITIONS WHICH CAUSE AN ERROR EXIT ARE:            29400000
*                                                                       29450000
*              1. THE JOBSTEP DEB TABLE DOES NOT EXIST.                 29500000
*              2. A ZERO OR NEGATIVE DEBTBLOF FIELD IN THE DEB.         29550000
*              3. DEBTBLOF IS LARGER THAN THE DEB TABLE.                29600000
*              4. THE DEB POINTER AND DEB TABLE ENTRY ARE NOT EQUAL.    29650000
*                                                                       29700000
*        IF THE CALLER IS NOT AUTHORIZED, THE MODESET MACRO WILL        29712400
*        RESULT IN AN ABEND.                                            29724800
*                                                                       29737200
* TABLES/WORKAREAS -                                                    29750000
*                                                                       29800000
*        THE DEB TABLE IS MAINTAINED AND UPDATED BY THE DEB             29850000
*        VALIDITY CHECK ROUTINE. THERE WILL BE ONE DEB TABLE            29900000
*        FOR EACH JOBSTEP TCB IN THE SYSTEM WITH AT LEAST ONE           29950000
*        OPEN DATA SET (OLTEP AND DASDR EXCEPTED). THE DEB              30000000
*        TABLE IS POINTED TO BY THE JSCBDBTB FIELD OF THE JSCB.         30050000
*        IT IS FIRST CREATED WHEN THE FIRST DEBCHK TYPE=ADD IS          30100000
*        ISSUED BY THE JOBSTEP IN SUBPOOL 255 (KEY 5),                  30150000
*        USUALLY WHEN THE FIRST OPEN IS ISSUED (OLTEP AND               30200000
*        DASDR EXCEPTED). THE SPACE IS RETURNED TO THE SYSTEM           30210000
*        BY THE DATA RESOURCE MANAGER AT TASK TERMINATION.              30250000
*        WHEN THE DEB TABLE BECOMES FULL AND ANOTHER ENTRY IS           30450000
*        REQUESTED, A NEW LARGER TABLE IS OBTAINED, THE OLD TABLE       30500000
*        IS MOVED INTO THE NEW TABLE (THE UNUSED ENTRIES ARE            30550000
*        ZEROED OUT), THE OLD TABLE IS FREED, AND THE JSCBDBTB          30600000
*        FIELD OF THE JSCB IS UPDATED TO POINT TO THE NEW TABLE.        30650000
*              NOTE: WHEN A NEW DEB TABLE IS CREATED, THE OLD           30700000
*              DEB TABLE IS NOT FREED UNTIL ITS ENTRIES ARE             30750000
*              TRANSFERRED TO THE NEW DEB TABLE.                        30800000
*        THE DEB TABLE MAY GROW IN SIZE UNTIL IT REACHES A              30850000
*        MAXIMUM OF 32760 BYTES. ACTUALLY IT MAY REACH 32792            30900000
*        BYTES, HOWEVER, THE EXTRA 32 BYTES ARE FOR IDENTIFICATION      30920000
*        PURPOSES AND ARE OTHERWISE IGNORED. THE DEB TABLE              30930000
*        CONSISTS OF CONSECUTIVE FOUR BYTE ENTRIES:                     30950000
*                                                                       31000000
*        CONTROL FIELD:                                                 31050000
*              THE FIRST FOUR BYTES OF THE DEB TABLE ARE                31100000
*              RESERVED FOR THE CONTROL FIELD (I.E. 0 IS                31150000
*              AN INVALID OFFSET): THE FIRST TWO BYTES                  31200000
*              INDICATES THE LENGTH IN BYTES OF THE TABLE.              31250000
*              THE SECOND TWO BYTES IS A BYTE OFFSET TO                 31300000
*              THE FIRST EMPTY ENTRY.                                   31350000
*                                                                       31400000
*        DEB TABLE ENTRY:                                               31450000
*              A DEB TABLE ENTRY IS EITHER AN EMPTY ENTRY               31500000
*              OR IT CONTAINS A DEB POINTER WITH THE                    31550000
*              HI-ORDER BYTE SET TO ZERO.                               31600000
*                                                                       31650000
*        DEB TABLE EMPTY ENTRY:                                         31700000
*              AN EMPTY ENTRY IS EITHER FOUR BYTES OF BINARY            31750000
*              ZEROS (USED IF THE ENTRIES ARE AT THE END OF             31800000
*              THE TABLE AND HAVE NEVER BEEN USED) OR 1) THE            31850000
*              FIRST TWO BYTES ARE A BYTE OFFSET TO THE NEXT            31900000
*              EMPTY ENTRY (ZERO IF IT'S THE LAST) 2) THE               31950000
*              SECOND TWO BYTES ARE BINARY ONES (USED IF THE            32000000
*              ENTRY WAS PREVIOUSLY DELETED).                           32050000
*                                                                       32100000
*        THE INITIAL SIZE OF THE DEB TABLE IS 80 DECIMAL BYTES.         32150000
*                                                                       32200000
*        THE 48 BYTES OF THE RBEXSAVE FIELD OF THE SVRB ARE USED        32250000
*        AS A SAVE AREA FOR REGISTERS.                                  32300000
*                                                                       32350000
* ATTRIBUTES -                                                          32400000
*                                                                       32450000
*        TYPE II SVC                                                    32500000
*        RE-ENTRANT                                                     32550000
*        DISABLED (LOCAL LOCK)                                          32600000
*        DOWNWARD COMPATIBLE                                            32650000
*        RESIDENT                                                       32700000
*        SCATTER LOADED                                                 32750000
*        PRIVELEGED                                                     32800000
*        SUPERVISOR STATE                                               32850000
*        KEY 0 AND KEY 5                                                32900000
*                                                                       32950000
* CHARACTER CODE DEPENDENCY - NOT APPLICABLE                            33000000
*                                                                       33050000
* NOTES -                                                               33100000
*                                                                       33500000
*        ISAM APPENDAGES                                                33550000
*                                                                       33600000
*        ISAM APPENDAGES GET THE DEB ADDRESS FROM THE RQE.              33650000
*                                                                       33700000
*        CHECKPOINT/RESTART DEB VALIDITY CHECKING                       33750000
*                                                                       33800000
*        AT CHECKPOINT TIME A MODESET WILL BE ISSUED TO                 33850000
*        ASSUME THE PROTECT KEY OF THE CALLER WHEN I/O IS               33900000
*        PERFORMED AGAINST THE CHECKPOINT DCB. THIS WILL                33950000
*        ENSURE THAT IOS WILL ISSUE A DEBCHK AGAINST THE                34000000
*        USER'S DEB WHEN EXCP IS ISSUED.                                34050000
*                                                                       34100000
*        UTILITIES DEB VALIDITY CHECKING                                34150000
*                                                                       34200000
*        IEHDASDR - WILL BE PROTECTED FROM UNAUTHORIZED                 34250000
*                   ROUTINES BY THE APF FACILITY.                       34300000
*        IEHATLAS - DEB VALIDITY CHECKING IS NOT BE REQUIRED            34350000
*                   FOR ATLAS SVC86 BECAUSE EXECUTES IN                 34400000
*                   SUPERVISOR STATE AND IS ISOLATED FROM               34450000
*                   USER MODIFICATION.                                  34500000
*        OLTEP IGC0005I - WILL BE PROTECTED FROM                        34550000
*                         UNAUTHORIZED ROUTINES                         34600000
*                         BY THE APF FACILITY.                          34650000
*                                                                       34700000
*        SCHEDULER INITIATOR SUPPORT FOR DEB VALIDITY CHECKING          34750000
*                                                                       34800000
*        IN SUPPORT OF DATA SETS OPENED BY THE INITIATOR WHICH          34850000
*        ARE TO BE AVAILABLE TO THE PROBLEM PROGRAM (I.E. JOBLIB,       34900000
*        STEPLIB, *.PGM), THE INITIATOR WILL BUILD A NEW JSCB           34950000
*        EACH TIME A TASK IS INITIATED TO AVOID REUSING AN OLD          35000000
*        DEBTABLE FREED AT TASK TERMINATION INSTEAD OF VIA              35150000
*        THE DATA RESOURCE MANAGER.                                     35200000
*                                                                       35450000
*        ATTACH SUPPORT FOR DEB VALIDITY CHECKING                       35750000
*                                                                       35800000
*        ANY ROUTINE USING THE ATTACH JSTCB=YES FUNCTION MUST           35850000
*        FOLLOW THE FOLLOWING CONVENTION IN SUPPORT OF DEB              35900000
*        VALIDITY CHECKING:                                             35950000
*                                                                       36000000
*              A SEPARATE JSCB MUST BE CREATED FOR THE NEW              36050000
*              TASK (I.E. THE JSCB FOR THE NEW TASK MAY NOT             36100000
*              BE DEFAULTED.). THE JSCBDBTB FIELD OF THE                36150000
*              CREATED JSCB MUST BE SET TO ZERO. IF THE                 36200000
*              MOTHER TASK EXPECTS TO SHARE DCBS WITH THE               36250000
*              DUAGHTER TASK.                                           36300000
*                                                                       36500000
*********************************************************************** 36550000
*********************************************************************** 36600000
         EJECT                                                          36650000
*********************************************************************** 36700000
*              REGISTER ASSIGNMENTS                                     36750000
*********************************************************************** 36800000
         SPACE                                                          36850000
R0       EQU   0                        REGISTER 0                      36900000
R1       EQU   1                        REGISTER 1                      36950000
R2       EQU   2                        REGISTER 2                      37000000
R3       EQU   3                        REGISTER 3                      37050000
R4       EQU   4                        REGISTER 4                      37100000
R5       EQU   5                        REGISTER 5                      37150000
R6       EQU   6                        REGISTER 6                      37200000
R7       EQU   7                        REGISTER 7                      37250000
R8       EQU   8                        REGISTER 8                      37300000
R9       EQU   9                        REGISTER 9                      37350000
RA       EQU   10                       REGISTER A                      37400000
RB       EQU   11                       REGISTER B                      37450000
RC       EQU   12                       REGISTER C                      37500000
RD       EQU   13                       REGISTER D                      37550000
RE       EQU   14                       REGISTER E                      37600000
RF       EQU   15                       REGISTER F                      37650000
         SPACE                                                          37700000
*********************************************************************** 37750000
*              SYMBOLIC REGISTER ASSIGNMENTS                            37800000
*********************************************************************** 37850000
         SPACE                                                          37900000
RI0      EQU   R0                       INPUT REGISTER (TYPE-FUNCTION)  37950000
RI1      EQU   R1                       INPUT REGISTER (DCB-DEB)        38000000
RCVT     EQU   R3                       CVT POINTER                     38050000
RTCB     EQU   R4                       CURRENT TCB POINTER             38100000
RSVRB    EQU   R5                       SVRB POINTER                    38150000
RNOTUSED EQU   R6                       UNUSED REGISTER                 38200000
RBXLE    EQU   R7                       BXLE MASK REGISTER              38250000
RNEW     EQU   R8                       NEW DEB TABLE POINTER           38300000
RNEWLGTH EQU   R9                       NEW DEB TABLE LENGTH            38350000
RTABLE   EQU   RA                       CURRENT DEB TABLE POINTER       38400000
ROFFSET  EQU   RB                       OFFSET TO DEB TABLE ENTRY       38450000
RW1      EQU   RC                       WORK REGISTER ONE               38500000
RW2      EQU   R2                       WORK REGISTER TWO               38550000
RBASE    EQU   RD                       BASE REGISTER                   38600000
RETURN   EQU   RE                       RETURN REGISTER                 38650000
R15      EQU   RF                       ENTRY POINT REGISTER            38700000
RETCODE  EQU   RF                       RETURN CODE REGISTER            38750000
         SPACE                                                          38800000
*********************************************************************** 38850000
*              EQUATED CONSTANTS                                        38900000
*********************************************************************** 38950000
         SPACE                                                          39000000
K0       EQU   0                        ZERO                            39050000
K1       EQU   1                        ONE                             39100000
K2       EQU   2                        TWO                             39150000
K3       EQU   3                        THREE                           39200000
K4       EQU   4                        FOUR                            39250000
K8       EQU   8                        EIGHT                           39300000
K32      EQU   32                       THITRY TWO               Y02080 39310000
M7       EQU   7                        MASK SEVEN                      39350000
M8       EQU   8                        MASK EIGHT                      39400000
SP255    EQU   255                      DEB TABLE SUBPOOL ID     Y02080 39450000
XFF      EQU   X'FF'                    FLAG                            39500000
KEY0     EQU   0                        KEY OF DEBTABLE          Y02080 39550000
         SPACE                                                          39700000
*********************************************************************** 39750000
*              EQUATED ERROR CONDITIONS                                 39800000
*********************************************************************** 39850000
         SPACE                                                          39900000
ERRORV   EQU   4                        ERROR RETURN FROM VERIFY        39950000
ERROR1   EQU   8                        INVALID FUNCTION REQUESTED      40000000
ERROR2   EQU   12                       UNAUTHORIZED FUNCTION REQUESTED 40050000
ERROR3   EQU   16                       INVALID DCB-DEB POINTERS        40100000
ERROR4   EQU   20                       DEBAMTYP NOT EQUAL TO AM        40150000
ERROR5   EQU   24                       ASYNCHRONOUS DCB MODIFICATION   40200000
ERROR6   EQU   28                       DEBAMTYP OR DEBTBLOF NOT 0      40250000
ERROR7   EQU   32                       DEB TABLE HAS EXCEEDED 32760    40300000
         SPACE                                                          40350000
*********************************************************************** 40400000
         EJECT                                                          40450000
*********************************************************************** 40500000
*/*                                                                     40550000
*/*      COMMENT (2,2,H)                INITIALIZATION ROUTINE          40600000
*/*                                                                  */ 40650000
*********************************************************************** 40700000
         SPACE                                                          40750000
*/*DCK00000:                                                            40800000
*/*      E                              INITIALIZATION                  40850000
*/*                                                                  */ 40900000
         SPACE                                                          40950000
DCK00000 BALR  RBASE,R0                 ESTABLISH BASE ADDRESS AT ENTRY 41000000
         USING *,RBASE                  ESTABLISH ADDRESSABILITY        41050000
         B     DCK00001                 GO AROUND ID           @ZA31908 41058300
         DC    CL8'IFGDEBCK'            ID                     @ZA31908 41066600
         DC    CL8'@ZA47942'            LAST CHANGE ACTIVITY   @ZA47942 41074900
         DC    CL8'09/26/80'            LAST CHANGE DATE       @ZA47942 41083200
DCK00001 DS    0H                                              @ZA31908 41091500
         LA    RI1,K0(R0,RI1)           CLEAR HI-ORDER BYTE OF R1       41100000
         SPACE                                                          41150000
*/*                                                                     41200000
*/*      M                              INITIALIZE BXLE MASK TO         41250000
*/*                                     AUTHORIZED BXLE MASK        */  41300000
         SPACE                                                          41350000
         LA    RBXLE,BXLEMSKS           AUTHORIZED MASKS         Y02080 41400000
         SPACE                                                          41450000
*/*                                                                     41500000
*/*      S     (YES,,NO,%DCK0100)       TESTAUTH: IS CALLER             41550000
*/*                                     AUTHORIZED? */           Y02080 41600000
         SPACE                                                          41650000
         USING RBSECT,RSVRB             RSVRB POINTS TO SVRB     Y02080 41652000
         STM   RA,R5,RBEXSAVE           SAVE REGS 10-5           Y02080 41660000
*        TESTAUTH FCTN=1,STATE=YES,KEY=YES,BRANCH=YES            Y02080 41700000
         TESTAUTH FCTN=1,STATE=YES,KEY=YES,BRANCH=YES            Y02080 41760000
         LM    RA,RE,RBEXSAVE           RESTORE REGS 10-14     @ZA02852 41770000
         LM    R0,R5,RBEXSAVE+24        RESTORE REGS 0-5       @ZA02852 41780000
         DROP  RSVRB                                             Y02080 41820000
         LTR   RF,RF                    TEST RETURN CODE       @ZA02852 41870000
         BZ    DCK00100                 BRANCH IF AUTHORIZED     Y02080 42000000
         SPACE                                                          42050000
*/*                                                                     42100000
*/*      M                              INITIALIZE BXLE MASK TO         42150000
*/*                                     UNAUTHORIZED BXLE MASK       */ 42200000
         SPACE                                                          42250000
         LA    RBXLE,BXLEMSKP           UNAUTHORIZED MASKS       Y02080 42300000
         EJECT                                                          42350000
*********************************************************************** 42400000
*/*%DCK0100:                                                            42450000
*/*      N                              FUNCTION CHECK ROUTINE          42500000
*/*                                                                  */ 42550000
*********************************************************************** 42600000
         SPACE                                                          42650000
*/*DCK00100:                                                            42700000
*/*      M                              LOAD BXLE MASK FOR ERROR EXIT   42750000
*/*                                     ROUTINE                      */ 42800000
         SPACE                                                          42850000
DCK00100 ICM   RBASE,M8,K0(RBXLE)       SET UP EXIT ROUTINE MASKS       42900000
         SPACE                                                          42950000
*/*                                                                     43000000
*/*      D     (YES,,NO,%DCK1000)       VALID TYPE SPECIFIED? (0-1-2-3) 43050000
*/*                                                                  */ 43100000
         SPACE                                                          43150000
         CLM   RI0,M7,THREE             TEST FOR VALID TYPE (0-1-2-3)   43200000
         LA    RETCODE,ERROR1           ERROR CODE FOR INVALID FUNCTION 43250000
         BH    DCK01000                 BRANCH IF INPUT INVALID         43300000
         SPACE                                                          43350000
*/*                                                                     43400000
*/*      M                              LOAD BXLE FUNCTION MASK         43450000
*/*                                                                  */ 43500000
         SPACE                                                          43550000
         ALR   RBXLE,RI0                INCREMENT TO FUNCTION TYPE MASK 43600000
         ICM   RBASE,M8,K0(RBXLE)       SAVE BXLE MASK FOR EXIT         43650000
         LR    RBXLE,RBASE              LOAD BXLE FUNCTION MASK         43700000
         SPACE                                                          43750000
*/*                                                                     43800000
*/*      D     (YES,,NO,%DCK1000)       CALLER AUTHORIZED FOR TYPE      43850000
*/*                                     SPECIFIED ?                  */ 43900000
         SPACE                                                          43950000
         LA    RETCODE,ERROR2           ERROR CODE FOR UNAUTH FUNCTION  44000000
         BXLE  RBXLE,RBXLE,DCK01000     BRANCH IF UNAUTHORIZED TYPE     44050000
         EJECT                                                          44250000
*********************************************************************** 44300000
*/*                                                                     44350000
*/*      N                              DCB - DEB VALIDITY CHECK        44400000
*/*                                     ROUTINE                      */ 44450000
*********************************************************************** 44500000
         SPACE                                                          44550000
*/*                                                                     44600000
*/*      D     (NO,,YES,%DCK0200)       TYPE=PURGE SPECIFIED?           44650000
*/*                                                                  */ 44700000
         SPACE                                                          44750000
         BXLE  RBXLE,RBXLE,DCK00200     BRANCH FOR TYPE=PURGE           44800000
         SPACE                                                          44850000
*/*                                                                     44900000
*/*      D     (YES,,NO,%DCK1000)       VALID DCB-DEB POINTERS?         44950000
*/*                                                                  */ 45000000
         SPACE                                                          45050000
DCK00110 EQU   *                        DCB-DEB VALIDITY CHECK         C45060000
                                        ROUTINE                 YM01224 45070000
         USING TCB,RTCB                 ESTABLISH TCB          @ZA31908 45072300
         CLM   RI0,M7,DBCHKADD    IS THIS AN ADD REQUEST?      @ZA47942 45073400
         BE    DCK00120           YES,STAY IN KEY ZERO         @ZA47942 45073700
         L     RW2,TCBJSCB        ADDRESS THE JSCB             @ZA47942 45074000
         USING IEZJSCB,RW2                                     @ZA47942 45074300
         TM    JSCBOPTS,JSCBAUTH  IS USER AUTHORIZED?          @ZA47942 45074600
         BO    DCK00120           YES, BRANCH                  @ZA47942 45074900
         DROP  RW2                                             @ZA47942 45075200
         CLI   TCBPKF,X'80'       IS USER IN A SUPVR KEY?      @ZA47942 45075500
         BL    DCK00120           YES,BRANCH                   @ZA47942 45075800
*        MODESET EXTKEY=TCB,WORKREG=2       USE USER KEY       @ZA31908 45076100
         MODESET EXTKEY=TCB,WORKREG=2       USE USER KEY       @ZA31908 45076400
DCK00120 DS    0H                                              @ZA47942 45076700
         USING IHADCB,RI1               RI1 PTS TO DCB AT ENTRY@ZA38025 45077000
         L     RW1,DCBDEBAD             LOAD POINTER TO DEB    @ZA38025 45084000
         DROP  RI1                                             @ZA38025 45091000
         USING DEBBASIC,RW1             RW1 POINTS TO DEB               45100000
*                                       *                      @ZA31908 45150000
         L     RW2,DEBDCBAD             LOAD POINTER TO DCB             45153000
*        MODESET EXTKEY=SUPR            CHANGE BACK TO OUR KEY @ZA31908 45187400
         MODESET EXTKEY=SUPR            CHANGE BACK TO OUR KEY @ZA31908 45189000
         LA    RW2,K0(R0,RW2)           CLEAR HI-ORDER BYTE FOR COMPARE 45200000
         CR    RI1,RW2                  VALIDITY CHECK DCB-DEB POINTERS 45250000
         LA    RI1,DEBBASIC             RI1=DEB POINTER AT ANY EXIT     45300000
         DROP  RW1                                                      45350000
         LA    RETCODE,ERROR3           ERROR CODE FOR INVALID DCB-DEB  45400000
         BNE   DCK01000                 BRANCH IF BAD DCB-DEB POINTERS  45450000
         EJECT                                                          46300000
*********************************************************************** 46350000
*/*%DCK0200:                                                            46400000
*/*      N                              ACCESS METHOD VALIDITY CHECK    46450000
*/*                                     ROUTINE                      */ 46500000
*********************************************************************** 46550000
         SPACE                                                          46600000
*/*DCK00200:                                                            46650000
*/*      D     (NO,,YES,%DCK0400)       IS TYPE=ADD SPECIFIED?          46700000
*/*                                                                  */ 46750000
         SPACE                                                          46800000
DCK00200 BXLE  RBXLE,RBXLE,DCK00400     BRANCH IF TYPE=ADD              46850000
         SPACE                                                          46900000
*/*                                                                     46950000
*/*      D     (YES,,NO,%DCK0300)       IS AM SPECIFIED?                47000000
*/*                                                                  */ 47050000
         SPACE                                                          47100000
         CLM   RI0,M8,ZERO              CHECK ACCESS METHOD SPECIFIED   47150000
         BZ    DCK00300                 BRANCH IF NOT SPECIFIED         47200000
         SPACE                                                          47250000
*/*                                                                     47300000
*/*      D     (YES,,NO,%DCK1000)       IS AM VALUE = DEBAMTYP VALUE?   47350000
*/*                                                                  */ 47400000
         SPACE                                                          47450000
DCK00210 EQU   *                        AM VALIDITY CHK ROUTINE YM01224 47460000
         LA    RW1,DEBBASIC-DEBAMTYP    LOAD NEGATIVE OFFSET            47500000
         SR    RI1,RW1                  DECREMENT TO NEGATIVE OFFSET    47550000
         USING DEBAMTYP,RI1             RI1 POINTS TO DEB - 3           47600000
         L     RW2,TCBJSCB        ADDRESS THE JSCB             @ZA47942 47650000
         USING IEZJSCB,RW2                                     @ZA47942 47650900
         TM    JSCBOPTS,JSCBAUTH  IS USER AUTHORIZED?          @ZA47942 47651800
         BO    DCK00220           YES, BRANCH                  @ZA47942 47652700
         DROP  RW2                                             @ZA47942 47653600
         CLI   TCBPKF,X'80'       IS USER IN A SUPVR KEY?      @ZA47942 47654500
         BL    DCK00220           YES,BRANCH                   @ZA47942 47655400
*        MODESET EXTKEY=TCB,WORKREG=2      USE USER KEY        @ZA31908 47656300
         MODESET EXTKEY=TCB,WORKREG=2      USE USER KEY        @ZA31908 47657200
DCK00220 DS    0H                                              @ZA47942 47658100
         CLM   RI0,M8,DEBAMTYP          TEST ACCESS METHOD TYPE         47659000
*        MODESET EXTKEY=SUPR            GO BACK TO OUR KEY     @ZA31908 47663500
         MODESET EXTKEY=SUPR            GO BACK TO OUR KEY     @ZA31908 47668000
         DROP  RTCB                                            @ZA31908 47687500
         LA    RI1,DEBBASIC             INCREMENT TO NORMAL DEB POINTER 47700000
         DROP  RI1                                                      47750000
         LA    RETCODE,ERROR4           ERROR CODE FOR INVALID AM       47800000
         BNE   DCK01000                 BRANCH IF INVALID ACCESS METHOD 47850000
         EJECT                                                          47900000
*********************************************************************** 47950000
*/*%DCK0300:                                                            48000000
*/*      N                              DEB VALIDITY CHECK ROUTINE      48050000
*/*                                                                  */ 48100000
*********************************************************************** 48150000
         SPACE                                                          48200000
*/*DCK00300:                                                            48250000
*/*      S     (GOOD,%DCK0500,BAD,)     IFGDEBVR: DEB VALIDITY CHECK    48300000
*/*                                     BRANCH ENTRY                 */ 48350000
         SPACE                                                          48400000
DCK00300 EQU   *                        VALIDATE DEB ADDRESS            48450000
         LR    RTABLE,RTCB              LOAD TCB POINTER         Y02080 48460000
         LA    R15,IFGDEBVR             LOAD POINTER TO VERIFY ROUTINE  48500000
         BALR  RETURN,R15               LINK TO VALIDATE DEB            48550000
         B     DCK00500                 VALIDITY CHECK NORMAL RETURN    48600000
         B     DCK01000                 VALIDITY CHECK ERROR RETURN     49950000
         EJECT                                                          50000000
*********************************************************************** 50050000
*/*%DCK0400:                                                            50100000
*/*      N                              DEB VALIDITY CHECK ADD ROUTINE  50150000
*/*                                                                  */ 50200000
*********************************************************************** 50250000
         SPACE                                                          50300000
*/*DCK00400:                                                            50350000
*/*      D     (NO,,YES,%DCK1000)       WAS THE DEB ADDRESS MODIFIED ?  50400000
*/*                                                                  */ 50450000
         SPACE                                                          50500000
DCK00400 EQU   *                        ADD DEB TO TABLE                50550000
         SPACE                                                          50600000
         LA    RETCODE,ERROR5           ERROR CODE FOR ASYNCHRONOUS     50650000
*                                       MODIFICATION                    50700000
         USING TCB,RTCB                 RTCB POINTS TO TCB              50750000
DCK00402 L     RW1,TCBDEB               LOAD POINTER TO CHAIN OF DEBS   50800000
         DROP  RTCB                                                     50850000
         SPACE                                                          50900000
         USING DEBBASIC,RW1             RW1 POINTS TO DEB               50950000
DCK00403 LA    RW1,DEBBASIC             CLEAR HI-ORDER BYTE             51000000
         CR    RI1,RW1                  CHECK FOR DEB ON TCB CHAIN      51050000
         BE    DCK00406                 BRANCH IF DEB ON CHAIN          51100000
         C     RW1,ZERO                 TEST FOR END OF CHAIN           51150000
         BE    DCK00404                 BRANCH IF DEB NOT FOUND  Y02080 51200000
         L     RW1,DEBDEBAD             LOAD POINTER TO NEXT ON CHAIN   51250000
         DROP  RW1                                                      51300000
         B     DCK00403                 BRANCH TO CHECK NEXT DEB        51310000
         SPACE 1                                                 Y02080 51320000
DCK00404 CLM   RI0,M8,VSAM              CHECK FOR VSAM           Y02080 51330000
         BNE   DCK01000                 BRANCH IF NOT VSAM       Y02080 51340000
         SPACE 1                                                 Y02080 51350000
         USING TCB,RTCB                 RTCB POINTS TO TCB       Y02080 51360000
         CLM   RTCB,M7,TCBJSTCB+1       TEST FOR JOBSTEP TCB     Y02080 51370000
         BE    DCK01000                 BRANCH IF JOBSTEP TCB    Y02080 51380000
         L     RTCB,TCBJSTCB            LOAD JOBSTEP TCB POINTER Y02080 51390000
         B     DCK00402                 BRANCH, CHK JOBSTEP TCB  Y02080 51400000
         DROP  RTCB                                              Y02080 51410000
         SPACE                                                          51420000
*/*DCK00406:                                                            51450000
*/*      D     (YES,,NO,%DCK1000)       IS DEBAMTYP OR DEBTBLOF VALUE 0 51500000
*/*                                     ?                            */ 51550000
         SPACE                                                          51600000
DCK00406 LA    RW1,DEBBASIC-DEBAMTYP    LOAD NEGATIVE DEB OFFSET        51650000
         SR    RI1,RW1                  CALCULATE NEGATIVE OFFSET       51700000
         USING DEBAMTYP,RI1             RI1 POINTS TO DEB               51750000
         CLC   DEBAMTYP(3),ZERO         TEST FOR PREVIOUS ACCESS METHOD 51800000
         LA    RETCODE,ERROR6           ERROR CODE FOR NON-ZERO FIELDS  51850000
         BNZ   DCK01000                 BRANCH IF NOT ZERO              51900000
         SPACE                                                          51950000
*/*                                                                     52000000
*/*      D     (YES,,NO,DCK00440)       DOES A DEB TABLE EXIST?         52050000
*/*                                                                  */ 52100000
         SPACE                                                          52150000
         USING TCB,RTCB                 RTCB POINTS TO TCB       Y02080 52160000
         L     RTABLE,TCBJSCB           LOAD TASK JSCB POINTER   Y02080 52170000
         DROP  RTCB                                              Y02080 52180000
         USING IEZJSCB,RTABLE           RTABLE POINTS TO JSCB           52200000
         L     RTABLE,JSCBDBTB          LOAD DEBTABLE POINTER           52250000
         DROP  RTABLE                                                   52300000
         LTR   RTABLE,RTABLE            TEST FOR EXISTING DEB TABLE     52350000
         BZ    DCK00440                 BRANCH IF NONE EXISTS           52400000
         SPACE                                                          52450000
*/*                                                                     52500000
*/*      D     (YES,,NO,DCK00450)       ARE ANY EMPTY ENTRIES IN DEB    52550000
*/*                                     TABLE?                       */ 52600000
         SPACE                                                          52650000
         USING DEBTABLE,RTABLE          RTABLE POINTS TO DEB TABLE      52700000
         LH    ROFFSET,TABLEQUE         LOAD EMPTY QUE OFFSET           52750000
         LTR   ROFFSET,ROFFSET          TEST FOR NO EMPTY ENTRIES       52800000
         BZ    DCK00450                 BRANCH IF NO EMPTY ENTRIES      52850000
         SPACE                                                          52900000
*/*DCK00410:                                                            52950000
*/*      P                              STORE FULLWORD OFFSET OF EMPTY  53000000
*/*                                     ENTRY IN DEBTBLOF FIELD      */ 53050000
         SPACE                                                          53100000
DCK00410 SRL   ROFFSET,K2               SHIFT TO FULLWORD OFFSET        53150000
         STH   ROFFSET,DEBTBLOF         SAVE TABLE OFFSET IN DEB        53200000
         SPACE                                                          53250000
*/*                                                                     53300000
*/*      P                              STORE AM VALUE IN DEBAMTYP      53350000
*/*                                     FIELD OF DEB                 */ 53400000
         SPACE                                                          53450000
         STCM  RI0,M8,DEBAMTYP          STORE AM VALUE IN DEB           53500000
         OI    DEBFLGS1,X'10'           SET DEBEXCPA ON        @ZA20762 53505000
         CLM   RI0,M8,VSAM              TEST FOR VSAM          @ZA20762 53510000
         BE    DCK00412                 BRANCH IF AM IS VSAM   @ZA20762 53515000
         CLM   RI0,M8,ISAM              TEST FOR ISAM          @ZA20762 53520000
         BE    DCK00412                 BRANCH IF AM IS ISAM   @ZA20762 53525000
         CLM   RI0,M8,TCAMAP            TEST FOR TCAM          @ZA20762 53528300
         BE    DCK00412                 BRANCH IF AM IS TCAM   @ZA20762 53531600
         CLM   RI0,M8,SUBSYS            TEST FOR SUBSYSTEM     @ZA20762 53534900
         BNE   DCK00414                 BRANCH IF NOT SUBSYS   @ZA20762 53538200
DCK00412 NI    DEBFLGS1,X'EF'           SET DEBEXCPA OFF       @ZA46200 53541500
DCK00414 EQU   *                                               @ZA20762 53545000
         LA    RI1,DEBBASIC             INCREMENT POINTER TO MAIN DEB   53550000
         DROP  RI1                                                      53600000
         SLL   ROFFSET,K2               SHIFT BACK TO BYTE OFFSET       53650000
         SPACE                                                          53700000
*/*                                                                     53750000
*/*      D     (YES,,NO,DCK00490)       IS THE DEB TABLE EMPTY ENTRY    53800000
*/*                                     FORMATTED ?                  */ 53850000
         SPACE                                                          53900000
         LA    RW1,DEBTABLE(ROFFSET)    LOAD POINTER TO DEB TABLE ENTRY 53950000
         USING TBLENTRY,RW1             RW1 POINTS TO EMPTY ENTRY       54000000
         CLC   NEXTEQUE,ZERO            TEST FOR EMPTY CHAIN            54050000
         BZ    DCK00490                 BRANCH IF NO CHAIN EXISTS       54100000
         SPACE                                                          54150000
*/*DCK00420:                                                            54200000
*/*      P                              UPDATE EMPTY ENTRY CHAIN IN     54250000
*/*                                     CONTROL FIELD                */ 54300000
         SPACE                                                          54350000
DCK00420 MVC   TABLEQUE,NEXTEQUE        MOVE NEXT TO CURRENT            54400000
         SPACE                                                          54450000
*/*DCK00430:                                                            54500000
*/*      P     (,%DCK2000)              STORE VALIDATED DEB POINTER IN  54550000
*/*                                     THE DEB TABLE                */ 54600000
         SPACE                                                          54650000
DCK00430 ST    RI1,TBLENTRY             STORE VALIDATED DEB IN TABLE    54700000
         DROP  RTABLE,RW1                                               54750000
         B     DCK02000                 RETURN TO CALLER                54800000
         SPACE                                                          54850000
*/*DCK00440:                                                            54900000
*/*      M     (,DCK00460)              INITIALIZE TO GET CORE FOR AND  54950000
*/*                                     ZERO A NEW DEB TABLE         */ 55000000
         SPACE                                                          55050000
DCK00440 EQU   *                        BUILD INITIAL DEB TABLE         55100000
         XR    ROFFSET,ROFFSET          ZERO LENGTH TO ZERO NEW TABLE   55150000
         LH    RNEWLGTH,DEBTSIZE        LOAD INITIAL DEB TABLE SIZE     55200000
         B     DCK00460                 BRANCH TO GET TABLE             55250000
         SPACE                                                          55300000
*/*DCK00450:                                                            55350000
*/*      M                              INITIALIZE TO MOVE THE OLD DEB  55400000
*/*                                     TABLE TO A NEW DEB TABLE     */ 55450000
         SPACE                                                          55500000
DCK00450 EQU   *                        BUILD A LARGER DEB TABLE        55550000
         USING DEBTABLE,RTABLE          RTABLE POINTS TO DEB TABLE      55600000
         LH    ROFFSET,TABLELEN         SAVE NEW OFFSET AND OLD LENGTH  55650000
         DROP  RTABLE                                                   55700000
         LR    RNEWLGTH,ROFFSET         LOAD SIZE OF OLD TABLE          55750000
         AH    RNEWLGTH,DEBTINCR        ADD INCREMENTAL TABLE LENGTH    55800000
         SPACE                                                          55850000
*/*DCK00460:                                                            55900000
*/*      D     (NO,,YES,%DCK1000)       IS THE NEW TABLE LENGTH GT      55950000
*/*                                     32760 ?                      */ 56000000
         SPACE                                                          56050000
DCK00460 EQU   *                        PREPARE TO GET DEB TABLE        56100000
         LTR   RNEWLGTH,RNEWLGTH        TEST IF DEB TABLE IS    YA02826X56110000
                                        GREATER THAN 32767      YA02826 56120000
         LA    RETCODE,ERROR7           ERROR IF NEGATIVE       YA02826 56130000
         BM    DCK01000                 BRANCH IF NEGATIVE      YA02826 56140000
         LH    RF,DEBTMAXL              GET MAXIMUM LENGTH      YA02826 56150000
         CR    RNEWLGTH,RF              COMPARE TO MAX LENGTH   YA02826 56160000
         LA    RETCODE,ERROR7           ERROR CODE FOR TABLE TOO LONG   56200000
         BH    DCK01000                 BRANCH IF LONGER THAN MAXIMUM   56250000
         SPACE                                                          56300000
*/*                                                                     56350000
*/*      S                              GETMAIN: GET LSQA CORE FOR NEW  56400000
*/*                                     TABLE                        */ 56450000
         SPACE                                                          56500000
         USING RBSECT,RSVRB             RSVRB POINTS TO SVRB            56550000
         STM   R0,RB,RBEXSAVE           SAVE REGISTERS 0-11      Y02080 56570000
         DROP  RSVRB                                             Y02080 56590000
         LR    R0,RNEWLGTH              SAVE LENGTH              Y02080 56610000
         LR    R8,RSVRB                 SAVE REGISTER RSVRB      Y02080 56630000
         LR    R9,RC                    SAVE REGISTER 12         Y02080 56650000
         LR    RA,RD                    SAVE REGISTER 13         Y02080 56670000
         XR    R1,R1                    SET PREFIX INDICATOR     Y02080 56690000
*        IECRES GET,WLH,LV=(0),SP=SP255,KEY=KEY0,A=(1),ID=DEBT,  Y02080X56710000
               PREFIX=YES                                        Y02080 56730000
         IECRES GET,WLH,LV=(0),SP=SP255,KEY=KEY0,A=(1),ID=DEBT,  Y02080X56750000
               PREFIX=YES                                        Y02080 56770000
         LR    RC,R9                    RESTORE REGISTER 12      Y02080 56790000
         LR    RD,RA                    RESTORE REGISTER 13      Y02080 56810000
         USING RBSECT,R8                R8 POINTS TO SVRB        Y02080 56830000
         ST    R1,RBEXSAVE+K32          UPDATE REGISTER RNEW     Y02080 56850000
         LM    R0,RB,RBEXSAVE           RESTORE REGISTERS 0-11   Y02080 56870000
         DROP  R8                                                Y02080 56890000
         SPACE                                                          56910000
*/*                                                                     56930000
*/*      D     (YES,,NO,DCK00470)       IS THERE AN OLD DEB TABLE?      56950000
*/*                                                                  */ 56970000
         SPACE                                                          56990000
         LTR   RTABLE,RTABLE            TEST FOR OLD TABLE       Y02080 57010000
         BZ    DCK00470                 BRANCH IF NO OLD TABLE   Y02080 57030000
         SPACE                                                          57050000
*/*                                                                     57070000
*/*      P                              MOVE OLD DEB TABLE TO NEW       57090000
*/*                                     DEB TABLE                    */ 57110000
         SPACE                                                          57130000
         LR    RNEWLGTH,ROFFSET         GET OLD LENGTH           Y02080 57150000
         MVCL  RNEW,RTABLE              MOVE OLD TO NEW          Y02080 57170000
         USING RBSECT,RSVRB             RSVRB POINTS TO SVRB     Y02080 57190000
         LM    R0,RB,RBEXSAVE           RESTORE REGISTERS 0-11   Y02080 57210000
         DROP  RSVRB                                                    57230000
         B     DCK00480                 BRANCH TO CHAIN TABLE    Y02080 57250000
         SPACE                                                          57270000
*/*DCK00470:                                                            57290000
*/*      M                              MODIFY EMPTY QUE OFFSET         57310000
*/*                                     INDICATOR                    */ 57330000
         SPACE                                                          57350000
DCK00470 EQU   *                        INITIALIZE OFFSET        Y02080 57370000
         LA    ROFFSET,TBLENTRY-DEBTABLE LOAD EMPTY QUE OFFSET   Y02080 57390000
         SPACE                                                          57410000
*/*DCK00480:                                                            57430000
*/*      P     (,DCK00410)              INITIALIZE CONTROL FIELD IN THE 57450000
*/*                                     NEW DEB TABLE                */ 57470000
         SPACE                                                          57490000
DCK00480 EQU   *                        INITIALIZE CONTROL FIELD Y02080 57510000
         USING DEBTABLE,RNEW            RNEW POINTS TO DEB TABLE Y02080 57530000
         STH   RNEWLGTH,TABLELEN        LENGTH OF NEW DEB TABLE  Y02080 57550000
         STH   ROFFSET,TABLEQUE         INITIALIZE EMPTY QUE     Y02080 57570000
         DROP  RNEW                                              Y02080 57590000
         USING TCB,RTCB                 RTCB POINTS TO TCB       Y02080 57610000
         L     RW1,TCBJSCB              LOAD TASK JSCB POINTER   Y02080 57630000
         DROP  RTCB                                              Y02080 57650000
         USING IEZJSCB,RW1              RW1 POINTS TO TASK JSCB  Y02080 57670000
         ST    RNEW,JSCBDBTB            STORE NEW DEB TABLE      Y02080 57690000
         DROP  RW1                                               Y02080 57710000
         SPACE                                                          57730000
*/*                                                                     57750000
*/*      D     (YES,,NO,DCK00485)       IS THERE AN OLD DEB TABLE?      57770000
*/*                                                                  */ 57790000
         SPACE                                                          57810000
         LTR   RTABLE,RTABLE            TEST FOR OLD TABLE              57830000
         BZ    DCK00485                 BRANCH IF NO OLD TABLE   Y02080 57850000
         SPACE                                                          57870000
*/*                                                                     57890000
*/*      S                              FREEMAIN: FREE UP THE OLD DEB   57910000
*/*                                     TABLE                        */ 57930000
         SPACE                                                          57950000
         LR    R1,RTABLE                POINTER TO OLD TABLE     Y02080 57970000
         LR    R8,RSVRB                 SAVE REGISTER RSVRB      Y02080 57990000
         LR    R9,RC                    SAVE REGISTER 12         Y02080 58010000
         LR    RA,RD                    SAVE REGISTER 13         Y02080 58030000
*        IECRES FREE,WLH,A=(1),PREFIX=YES                        Y02080 58050000
         IECRES FREE,WLH,A=(1),PREFIX=YES                        Y02080 58070000
*        MODESET EXTKEY=ZERO            GET BACK TO KEY ZERO     Y02080 58090000
         MODESET EXTKEY=ZERO            GET BACK TO KEY ZERO     Y02080 58110000
         LR    RC,R9                    RESTORE REGISTER 12      Y02080 58130000
         LR    RD,RA                    RESTORE REGISTER 13      Y02080 58150000
         USING RBSECT,R8                R8 POINTS TO SVRB        Y02080 58170000
         LM    R0,RB,RBEXSAVE           RESTORE REGISTERS 0-11   Y02080 58190000
         DROP  R8                                                Y02080 58210000
         SPACE                                                          58230000
*/*DCK00470:                                                            58250000
*/*      M                              RESTORE AND RETURN              58270000
*/*                                                                  */ 58290000
         SPACE                                                          58310000
DCK00485 EQU   *                        RESTORE & RETURN         Y02080 58330000
         LR    RTABLE,RNEW              POINTER TO NEW TABLE     Y02080 58500000
         B     DCK00410                 RETURN TO ADD ROUTINE           59700000
         SPACE                                                          59750000
*/*DCK00490:                                                            59800000
*/*      D     (YES,,NO,DCK00420)       IS THE NEXT ENTRY WITHIN THE    59850000
*/*                                     DEB TABLE ?                  */ 59900000
         SPACE                                                          59950000
DCK00490 EQU   *                        CHECK FOR UNFORMATTED ENTRY     60000000
         LA    ROFFSET,K4(R0,ROFFSET)   INCREMENT OFFSET TO NEXT ENTRY  60050000
         USING DEBTABLE,RTABLE          RTABLE POINTS TO DEB TABLE      60100000
         CH    ROFFSET,TABLELEN         TEST FOR ENTRY IN TABLE         60150000
         BNL   DCK00420                 BRANCH IF NOT IN TABLE          60200000
         SPACE                                                          60250000
*/*                                                                     60300000
*/*      D     (YES,,NO,DCK00420)       IS NEXT ENTRY AN UNFORMATTED    60350000
*/*                                     ENTRY?                       */ 60400000
         SPACE                                                          60450000
         USING TBLENTRY,RW1             RW1 POINTS TO TABLE ENTRY       60500000
         CLC   TBLENTRY+K4(K4),ZERO     TEST NEXT ENTRY FOR ZERO Y02080 60550000
         BNZ   DCK00420                 BRANCH IF NOT ZERO              60600000
         SPACE                                                          60650000
*/*                                                                     60700000
*/*      P     (,DCK00430)              UPDATE THE EMPTY CHAIN WITH     60750000
*/*                                     THE UNFORMATTED EMPTY ENTRY  */ 60800000
         SPACE                                                          60850000
         STH   ROFFSET,TABLEQUE         STORE OFFSET IN EMPTY QUE       60900000
         DROP  RTABLE,RW1                                               60950000
         B     DCK00430                 RETURN TO ADD ROUTINE           61000000
         EJECT                                                          61050000
*********************************************************************** 61100000
*/*%DCK0500:                                                            61150000
*/*         N                              DEB VALIDITY CHECK DELETE    61200000
*/*                                        AND PURGE ROUTINE         */ 61250000
*********************************************************************** 61300000
         SPACE                                                          61350000
*/*DCK00500:                                                            61400000
*/*      D     (NO,,YES,%DCK2000)       IS TYPE=VERIFY SPECIFIED?       61450000
*/*                                                                  */ 61500000
         SPACE                                                          61550000
DCK00500 BXLE  RBXLE,RBXLE,DCK02000     BRANCH FOR TYPE=VERIFY          61600000
         SPACE                                                          61650000
*/*                                                                     61700000
*/*      P                              DELETE AND FORMAT DEB TABLE     61750000
*/*                                     ENTRY                        */ 61800000
         SPACE                                                          61850000
         USING DEBTABLE,RTABLE          RTABLE POINTS TO DEB TABLE      61900000
         LA    RW1,DEBTABLE(ROFFSET)    VALIDATED DEB TABLE ENTRY       61950000
         USING TBLENTRY,RW1             RW1 POINTS TO TABLE ENTRY       62000000
         MVI   TBLDELTE,XFF             FLAG FOR DELETE/PURGE           62050000
         MVI   TBLDELTE+K1,XFF          FLAG FOR DELETE/PURGE           62100000
         SPACE                                                          62150000
*/*                                                                     62200000
*/*      P                              CHAIN FORMATTED EMPTY ENTRY TO  62250000
*/*                                     EMPTY CHAIN                  */ 62300000
         SPACE                                                          62350000
         MVC   NEXTEQUE,TABLEQUE        CHAIN PUSH DOWN EMPTY QUE       62400000
         STH   ROFFSET,TABLEQUE         STORE OFFSET TO FIRST IN CHAIN  62450000
         DROP  RTABLE,RW1                                               62500000
         EJECT                                                          62550000
*********************************************************************** 62600000
*/*%DCK2000:                                                            62650000
*/*      N                              DEBCHK NORMAL RETURN - REGISTER 62700000
*/*                                     15 = 0                       */ 62750000
*********************************************************************** 62800000
         SPACE                                                          62850000
*/*DCK02000:                                                            62900000
*/*      M                              SET RETURN CODE TO ZERO         62950000
*/*                                                                  */ 63000000
         SPACE                                                          63050000
DCK02000 XR    RETCODE,RETCODE          SET RETURN CODE TO ZERO         63100000
         SPACE                                                          63150000
*/*DCK02100:                                                            63200000
*/*      R                              EXIT                            63250000
*/*                                                                  */ 63300000
         SPACE                                                          63350000
         USING CVT,RCVT                 CVT ADDRESSABILITY       Y02080 63360000
DCK02100 L     RE,CVTEXPRO              LOAD EXIT PROLOGUE ADDR  Y02080 63400000
         DROP  RCVT                                              Y02080 63410000
*        RETURN ,                       RETURN TO CALLER         Y02080 63420000
         RETURN ,                       RETURN TO CALLER         Y02080 63430000
         SPACE                                                          63450000
*********************************************************************** 63500000
*/*%DCK1000:                                                            63550000
*/*      N                              DEBCHK ERROR RETURN - REGISTER  63600000
*/*                                     15 = ERROR CODE              */ 63650000
*********************************************************************** 63700000
         SPACE                                                          63750000
*/*DCK01000:                                                            63800000
*/*      D     (NO,,YES,DCK02100)       PROBLEM STATE OR TYPE=PURGE?    63850000
*/*                                                                  */ 63900000
         SPACE                                                          63950000
DCK01000 EQU   *                        ERROR RETURN ROUTINE            64000000
         LR    RBXLE,RBASE              LOAD FUNCTION TYPE MASK         64050000
         SRL   RBXLE,K1                 SHIFT TO GET EXIT INDICATOR     64100000
         BXLE  RBXLE,RBXLE,DCK02100     BRANCH IF TYPE=PURGE            64150000
         SPACE                                                          64200000
*/*                                                                     64250000
*/*      R                              ABEND 16E                       64300000
*/*                                                                  */ 64350000
         SPACE                                                          64400000
         L     RI1,ABNDCODE             LOAD ABEND PARAMETERS           64450000
         SPACE                                                          64500000
*        ABEND (1),DUMP,,SYSTEM                                  Y02080 64550000
         ABEND (1),DUMP,,SYSTEM                                  Y02080 64560000
         DROP  RBASE                                                    64650000
         SPACE                                                          64700000
*/*IFGDEBCK:                                                            64750000
*/*      END                                                         */ 64800000
         EJECT                                                          64850000
*********************************************************************** 64900000
*/*IFGDEBVR:                                                            64950000
*/*      CHART (AMODE)                  DEBCHK BRANCH ENTRY VERIFY      65000000
*/*                                     ROUTINE                      */ 65050000
*********************************************************************** 65100000
         SPACE                                                          65150000
*/*                                                                     65200000
*/*      E                              BRANCH ENTRY (IOS)              65250000
*/*                                                                  */ 65300000
         SPACE                                                          65350000
IFGDEBVR EQU   *                        BRANCH ENTRY DEB VERIFY ROUTINE 65400000
         USING *,RETCODE                                       @ZA47942 65424900
         SPACE                                                          65450000
*/*                                                                     65500000
*/*      M                              LOAD THE DEB TABLE OFFSET FROM  65550000
*/*                                     THE DEB                      */ 65558600
         SPACE                                                          65567200
         LA    ROFFSET,K3               MASK FOR FULL WORD CK  @ZA26208 65575800
         NR    ROFFSET,RI1              IS DEB ON FULL WORD?   @ZA26208 65578300
         BZ    DBV01000           YES, BRANCH TO CONTINUE      @ZA47942 65580800
         LA    RETCODE,ERRORV     ERROR CODE FOR BAD DEB       @ZA47942 65583300
         B     0(RETCODE,RETURN)  RETURN WITH ERROR            @ZA47942 65585800
DBV01000 DS    0H                                              @ZA47942 65588300
         USING TCB,RTABLE               ESTABLISH TCB          @ZA31908 65590800
         L     ROFFSET,TCBJSCB    ADDRESS THE JSCB             @ZA47942 65593300
         USING IEZJSCB,ROFFSET                                 @ZA47942 65595800
         TM    JSCBOPTS,JSCBAUTH  IS USER AUTHORIZED?          @ZA47942 65598300
         DROP  ROFFSET                                         @ZA47942 65600800
         LA    ROFFSET,0          SET KEY TO SUPERVISOR        @ZA47942 65603300
         BO    DBV01100           BRANCH IF USER IS AUTHORIZED @ZA47942 65605800
         CLI   TCBPKF,X'80'       IS USER IN A SUPVR KEY?      @ZA47942 65608300
         BL    DBV01100           YES, BRANCH TO USE KEY ZERO  @ZA47942 65610800
         IC    ROFFSET,TCBPKF     USE USERS KEY                @ZA47942 65613300
DBV01100 DS    0H                                              @ZA47942 65615800
         DROP  RETCODE                                         @ZA47942 65618300
         LR    R15,R2              SAVE REG 2                  @ZA31908 65620800
*                                       GET USERS KEY          @ZA31908 65623300
*        MODESET SAVEKEY=(2)                                   @ZA47942 65625800
         MODESET SAVEKEY=(2)                                   @ZA47942 65628300
         SLL   R2,8               SAVE CALLERS KEY             @ZA47942 65630800
         OR    R2,ROFFSET         GET USERS KEY                @ZA47942 65633300
*        MODESET KEYADDR=(2)                                   @ZA47942 65635800
         MODESET KEYADDR=(2)                                   @ZA47942 65638300
         SRL   R2,8               RESTORE CALLERS KEY          @ZA47942 65640800
         LA    ROFFSET,4                                       @ZA31908 65644600
         LCR   ROFFSET,ROFFSET                                 @ZA31908 65648600
         AR    ROFFSET,RI1              BACKUP DEB PTR BY FOUR @ZA31908 65652600
         USING DEBLNGTH,ROFFSET         ROFFSET POINTS TO DEB - 4       65661800
         LH    ROFFSET,DEBTBLOF         LOAD DEB TABLE FULLWORD OFFSET  65670400
         DROP  ROFFSET                                                  65679000
*        MODESET KEYADDR=(2)            RETURN TO CALLERS KEY  @ZA31908 65681400
         MODESET KEYADDR=(2)            RETURN TO CALLERS KEY  @ZA31908 65684000
         LR    R2,R15                   RESTORE REG 2          @ZA31908 65689000
         SPACE                                                          65704800
*/*                                                                     65713400
*/*      M                              INITIALIZE JSCB POINTER         65722000
*/*                                                                  */ 65730600
         SPACE                                                          65739200
         L     RTABLE,TCBJSCB           LOAD POINTER TO JSCB            65750000
         DROP  RTABLE                                                   65800000
         SPACE                                                          65850000
         USING IEZJSCB,RTABLE           RTABLE POINTS TO JSCB           66400000
         L     RTABLE,JSCBDBTB          LOAD POINTER TO DEB TABLE       66450000
         DROP  RTABLE                                                   66500000
         SPACE                                                          66550000
         BALR  RETCODE,R0               REGAIN ADDRESSABILITY      @01A 66566600
         USING *,RETCODE                                           @01A 66583200
*/*                                                                     66600000
*/*      D     (YES,,NO,%ERROR)         IS THE OFFSET POSITIVE?         67800000
*/*                                                                  */ 67850000
         SPACE                                                          67900000
         LTR   ROFFSET,ROFFSET          TEST FOR INVAL. OFFSET     @01C 67937500
         BNP   DBV01160                 OFFSET IS BAD, ABEND       @01C 67975000
         SLL   ROFFSET,K2               ALIGN TO BYTE OFFSET       @01M 68012500
         SPACE                                                          68050000
*/*                                                                     68100000
*/*      D     (YES,,NO,%ERROR)         DOES THE DEB TABLE EXIST?       68142800
*/*                                                                  */ 68185600
         SPACE                                                          68228400
         LTR   RTABLE,RTABLE            TEST FOR EXISTING DEB TABLE     68271200
         BZ    DBV01125                 NO TABLE, CK FOR VSAM      @01C 68314000
         SPACE                                                          68356800
*/*                                                                     68400000
*/*      D     (NO,,YES,%ERROR)         OFFSET LONGER THAN DEB TABLE    68450000
*/*                                     LENGTH?                      */ 68500000
         SPACE                                                          68550000
         USING DEBTABLE,RTABLE          RTABLE POINTS TO DEB TABLE      68600000
         CH    ROFFSET,TABLELEN         TEST FOR OFFSET TO LARGE        68650000
         BNL   DBV01125                 TO BIG, CK FOR VSAM        @01C 68700000
*/*                                                                     68800000
*/*      D     (YES,,NO,%ERROR)         IS THE DEB POINTER IN THE DEB   68850000
*/*                                     TABLE?                       */ 68900000
         C     RI1,DEBTABLE(ROFFSET)    TEST FOR VALID DEB POINTER      69000000
         DROP  RTABLE                                                   69050000
         BE    DBV01150                 VALID, RETURN              @01C 69100000
*/*                                                                     69200000
DBV01125 DS    0H                                                  @01A 69210000
         CLC   K0(K4,RI1),ZERO          A TCB PTR IN DEB?          @02A 69220000
         BE    DBV01160                 NO, ERROR                  @02A 69230000
         S     RI1,TRES                 BACKUP DEB PTR             @01A 69240000
         USING DEBAMTYP,RI1             ACCESS DEBAMTYP            @01A 69250000
         CLI   DEBAMTYP,X'01'           VSAM?                      @01A 69260000
         DROP  RI1                                                 @01A 69270000
         BNE   DBV01155                 NOT VSAM, ERROR            @01A 69280000
         A     RI1,TRES                 RESTORE DEB PTR            @01A 69290000
*/*                                                                  */ 69300000
*/*                                                                  */ 69304400
         L     RTABLE,0(0,RI1)          GET TCB FROM DEB,          @01A 69320500
         USING TCB,RTABLE               POSSIBLE JSTCB             @01A 69336600
         L     RTABLE,TCBJSCB           PT TO JSCB IN JSTCB        @01A 69352800
         DROP  RTABLE                                              @01A 69359400
*/*                                                                  */ 69366000
         USING IEZJSCB,RTABLE                                           69372600
         L     RTABLE,JSCBDBTB          POINT RTABLE TO DEBTBL     @01A 69379200
         DROP  RTABLE                                              @01A 69399000
         LTR   RTABLE,RTABLE            TEST FOR EXIST. DBTBL      @01A 69401200
         BZ    DBV01160                 NO TABLE, RET W/ERROR      @01A 69403400
*/*                                                                  */ 69405600
         USING DEBTABLE,RTABLE          RTABLE PTS. TO             @01A 69412200
         CH    ROFFSET,TABLELEN         TEST FOR OFFSET TO BIG     @01A 69418800
         BNL   DBV01160                 INVALID OFFSET,ERROR       @01A 69425400
         C     RI1,DEBTABLE(ROFFSET)    TEST FOR VALID DEB PTR     @01A 69432000
         DROP  RTABLE                                              @01A 69438600
         BNE   DBV01160                 PTR. NOT VALID, RET.       @01A 69451800
*/*                                                                  */ 69455100
*/*      M                              SET RETURN CODE TO 0       @01M 69458400
*/*                                                                  */ 69465000
         SPACE                                                          69471600
DBV01150 DS    0H                                                  @01A 69478200
         XR    RETCODE,RETCODE          SET RETURN CODE TO ZERO  C      69484800
         SPACE                                                          69491400
*/*                                                                     69500000
*/*      R                              BR 14                           69550000
*/*                                                                  */ 69600000
         SPACE                                                          69650000
*/*                                                                     69700000
*/*      COMMENT (9,10,H)               (R15 = 0)                       69750000
*/*                                                                  */ 69800000
         SPACE                                                          69850000
         RETURN ,                       NORMAL RETURN TO CALLER  Y02080 69910000
         SPACE                                                          69950000
DBV01155 A     RI1,TRES                 RESTORE DEB PTR            @01M 70308300
DBV01160 DS    0H                                                  @01A 70316600
         DROP  RETCODE                                             @01M 70324900
         LA    RETCODE,ERRORV           ERR CODE FOR BAD RET.      @01M 70333200
         B     K0(RETCODE,RETURN)       RETURN,ERROR               @01M 70341500
*/*                                                                  */ 70343600
*/*      COMMENT (9,10,H)               (R15 = 4)                       70345700
*/*                                                                  */ 70347800
         SPACE                                                          70350000
*/*IFGDEBVR:                                                            70400000
*/*      END                                                         */ 70450000
         EJECT                                                          70500000
*********************************************************************** 70510000
*        CONSTANTS                                                      70520000
*********************************************************************** 70530000
BXLEMSKS DS    0F                       AUTHORIZED BXLE MASKS    Y02080 70550000
         DC    BL1'00001001'            TYPE=VERIFY MASK                70600000
         DC    BL1'00010001'            TYPE=ADD MASK                   70650000
         DC    BL1'00000001'            TYPE=DELETE MASK                70700000
         DC    BL1'10100001'            TYPE=PURGE MASK                 70750000
         SPACE                                                          70800000
BXLEMSKP DS    0F                       UNAUTHORIZED BXLE MASKS  Y02080 70850000
         DC    BL1'10001001'            TYPE=VERIFY MASK                70900000
         DC    BL1'11000001'            TYPE=ADD MASK                   70950000
         DC    BL1'11000001'            TYPE=DELETE MASK                71000000
         DC    BL1'11000001'            TYPE=PURGE MASK                 71050000
         SPACE                                                          71100000
*VSAM    DEBCHK AM=VSAM,MF=L            VSAM ACCESS METHOD PARM  Y02080 71210000
VSAM     DEBCHK AM=VSAM,MF=L            VSAM ACCESS METHOD PARM  Y02080 71220000
ISAM     DC    XL1'80'                  ISAM AM CODE           @ZA42565 71230000
SUBSYS   DC    XL1'81'                  SUBSYSTEM AM CODE      @ZA42565 71240000
TCAMAP   DC    XL1'84'                  TCAMAP AM CODE         @ZA20762 71244900
THREE    DC    AL3(K3)                  THREE                           71250000
TRES     DC    A(K3)                    THREE IN 4 BYTES       @ZA79269 71252400
DBCHKADD DC    AL3(1)             ADD REQUEST                  @ZA47942 71254900
ZERO     DC    A(K0)                    ZERO                     Y02080 71260000
ABNDCODE DC    XL4'0000016E'            ABEND PARAMETER LIST     Y02080 71300000
DEBTMAXL DC    AL2(32760)               MAXIMUM LENGTH OF DEB TABLE     71350000
DEBTSIZE DC    H'24'                    INITIAL DEB TABLE SIZE   YM3882 71400000
DEBTINCR DC    H'24'                    DEB TABLE INCREMENT      YM3882 71450000
*********************************************************************** 71500000
*        PATCH AREA                                                     71550000
*********************************************************************** 71600000
*        XCTLTABL SVC=117,BRT=YES,LENGTH=                        Y02080 71610000
         XCTLTABL SVC=117,BRT=YES,LENGTH=                        Y02080 71620000
         EJECT                                                          71650000
DEBTABLE DSECT                                                          71700000
TABLELEN DS    H                        LENGTH OF TABLE IN BYTES        71750000
TABLEQUE DS    H                        OFFSET OF EMPTY QUE IN BYTES    71800000
TBLENTRY EQU   *                        TABLE ENTRY                     71850000
NEXTEQUE DS    H                        BYTE OFFSET OF NEXT EMPTY ENTRY 71900000
TBLDELTE DS    H                        DELETION FLAG BYTES             71950000
         SPACE 2                                                 YM2377 71960000
*        IECDSECS CVT,TCB,JSCB,RB,PSA,DCB,IEZDEB,EXPAND=YES      Y02080 72000000
         IECDSECS CVT,TCB,JSCB,RB,PSA,DCB,IEZDEB,EXPAND=YES      Y02080 72060000
         MEND                                                           73100000
         END                                                            73150000
