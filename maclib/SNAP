* /* MACCOMP Y-1 SC1C5/PZD81                                         */ 00000443
* /* MACSTAT Y-1 72179/Y02705,     G33SPHW                           */ 00000843
* /* APAR OZ51152 - A-TYPE ADDR NOT GENERATED FOR STRHDR WHEN LIST   */ 00000903
* /*                IS REG FORMAT  ZA51152                           */ 00001003
         MACRO                                                          00001243
&NAME    SNAP  &DCB=,&TCB=,&SDATA=,&PDATA=,&STORAGE=,&LIST=,&ID=,&MF=,&X00001643
               STRHDR=                                                  00002043
* /* MACDATE Y-1 72179  LAST UPDATED -02/03/81 EBB1102 - APAR OZ51152*/ 00002403
.*A016000,020000,022000,034000,060000,094000,104000,284000       Y02705 00002843
.*A380000,490000,678000                                          Y02705 00003243
.*D330000-378000,384000-386000,484000-488000,638000              Y02705 00003643
.*C034000,276000-278000,320000,326000,392000,432000,438000       Y02705 00004043
.*C574000,588000,594000,616000,620000,018000,420000,634000       Y02705 00004443
         LCLC  &C1,&C2,&GNAME                                           00004843
         LCLB  &B0,&B1,&B2,&B3,&B4,&B5,&B6,&B7,&B8,&B9,&B10,&B11,&B12,&X00005243
               B13,&B14,&B15,&B16                               G33SPHW 00005643
         LCLB  &B17,&B18,&B19          SQA,LSQA,SWA              Y02705 00006043
         LCLB  &B20,&B21,&B22,&B23,&B24,&B25                            00006443
         LCLB  &OSVS2R2           OSVS2R2 LEVEL OF PARAM LIST    Y02705 00006843
         LCLB  &OSENVS2           OSVS2R2 ENHANCED SNAP         G33SPHW 00007243
         LCLA  &FLAGS4,&CTR3,&CTR4,&CTR5,&CTR7,&CTR8,&CTRA,&CTRB        00007643
         LCLC  &C3,&C4                                                  00008043
         LCLA  &FLAGS3                 FLAG FIELD                Y02705 00008443
         LCLA   &FLAGS1,&FLAGS2,&CTR1,&CTR2,&DISP                       00008843
         ACTR   9000                                                    00009243
&B0      SETB  1                  INDICATES SNAP REQUEST         Y02705 00009643
&OSVS2R2 SETB  1                  INDICATES AN OSVS2R2 LEVEL     Y02705 00010043
&OSENVS2 SETB  1                  INDICATES A SNAP ENHANCED     G33SPHW 00010443
         AIF   (T'&MF EQ 'O').STAND    STANDARD FORM             Y02705 00010843
         AIF   ('&MF'(1,3) EQ '(E,' AND '&TCB' EQ '''S''').EXCUR Y02705 00011243
.STAND   ANOP                                                    Y02705 00011643
&B1      SETB  ('&TCB' NE '')                                           00012043
.EXCUR   ANOP                                                    Y02705 00012443
         AIF   ('&SDATA' EQ '').ABC7                                    00012843
         AIF    ('&SDATA'(1,1) EQ '(').ABC2                             00013243
&B2      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'CB')                  00013643
&B3      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'TRT')                 00014043
&B4      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'NUC')                 00014443
&B7      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'Q')                   00014843
&B17     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SQA')          Y02705 00015243
&B18     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'LSQA')         Y02705 00015643
&B19     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SWA')          Y02705 00016043
&B20   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'DM')            G33SPHW 00016443
&B21   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'IO')            G33SPHW 00016743
&B22   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'ERR')           G33SPHW 00017043
&CTR1    SETA  &B2+&B3+&B4+&B17+&B18+&B19+&B7+&B20+&B21+&B22    G33SPHW 00017343
         AIF   ('&CTR1' EQ '0').MSG2                                    00018043
         AGO   .ABC7                                                    00018443
.ABC2    ANOP                                                           00018843
&CTR1    SETA  N'&SDATA                                                 00019243
&CTR2    SETA  0                                                        00019643
.LOOPA   ANOP                                                           00020043
&CTR2    SETA  &CTR2+1                                                  00020443
&C1      SETC  '&SDATA(&CTR2)'                                          00020843
         AIF   ('&C1' EQ 'TRT').ABC4                                    00021243
         AIF   ('&C1' EQ 'NUC').ABC5                                    00021643
         AIF   ('&C1' EQ 'CB').ABC6                                     00022043
         AIF   ('&C1' EQ 'Q').ABC67                                     00022443
         AIF   ('&C1' EQ 'SQA').SETSQA      IS SQA SPECIFIED     Y02705 00022843
         AIF   ('&C1' EQ 'LSQA').SETLSQA    IS LSQA SPECIFIED    Y02705 00023243
         AIF   ('&C1' EQ 'SWA').SETSWA      IS SWA SPECIFIED     Y02705 00023643
         AIF   ('&C1' EQ 'DM').SETDM        IS DM SPECIFIED     G33SPHW 00024043
         AIF   ('&C1' EQ 'IO').SETIO        IS IO SPECIFIED     G33SPHW 00024343
         AIF   ('&C1' EQ 'ERR').SETERR      IS ERR SPECIFIED    G33SPHW 00024643
         AIF   ('&C1' EQ 'ALL').SETALL                                  00025243
         AGO   .MSG2                                                    00025643
.ABC3    ANOP                                                           00026043
         AIF   ('&CTR2' NE '&CTR1').LOOPA                               00026443
         AGO   .ABC7                                                    00026843
.ABC4    ANOP                                                           00027243
&B3      SETB  1                                                        00027643
         AGO   .ABC3                                                    00028043
.ABC5    ANOP                                                           00028443
&B4      SETB  1                                                        00028843
         AGO   .ABC3                                                    00029243
.ABC6    ANOP                                                           00029643
&B2      SETB  1                                                        00030043
         AGO   .ABC3                                                    00030443
.ABC67   ANOP                                                           00030843
&B7      SETB  1                                                        00031243
         AGO   .ABC3                                                    00031643
.SETSQA  ANOP                          SQA SPECIFIED             Y02705 00032043
&B17     SETB  1                       SET SQA INDICATOR         Y02705 00032443
         AGO   .ABC3                   RETURN                    Y02705 00032843
.SETLSQA ANOP                          LSQA SPECIFIED            Y02705 00033243
&B18     SETB  1                       SET LSQA INDICATOR        Y02705 00033643
         AGO   .ABC3                   RETURN                    Y02705 00034043
.SETSWA  ANOP                          SWA SPECIFIED             Y02705 00034443
&B19     SETB  1                       SET SWA INDICATOR         Y02705 00034843
         AGO   .ABC3                   RETURN                    Y02705 00035243
.SETDM   ANOP                                                   G33SPHW 00035643
&B20     SETB  1                       DM SPECIFIED             G33SPHW 00035943
         AGO .ABC3                     RETURN                   G33SPHW 00036243
.SETIO   ANOP                          IO SPECIFIED             G33SPHW 00036543
&B21     SETB  1                       SET IO INDICATOR         G33SPHW 00036843
         AGO .ABC3                     RETURN                   G33SPHW 00037143
.SETERR  ANOP                          ERR SPECIFIED            G33SPHW 00037443
&B22     SETB  1                       SET ERR INDICATOR        G33SPHW 00037743
         AGO .ABC3                     RETURN                   G33SPHW 00038043
.SETALL  ANOP                                                           00039243
&B2      SETB  1                                                        00039643
&B3      SETB  1                                                        00040043
&B4      SETB  1                                                        00040443
&B7      SETB  1                                                        00040843
&B17     SETB  1                       SQA INDICATOR             Y02705 00041243
&B18     SETB  1                       LSQA INDICATOR            Y02705 00041643
&B19     SETB  1                       SWA  INDICATOR            Y02705 00042043
&B20     SETB  1                       DM  INDICATOR            G33SPHW 00042443
&B21     SETB  1                       IO  INDICATOR            G33SPHW 00042743
&B22     SETB  1                       ERR INDICATOR            G33SPHW 00043043
.ABC7    ANOP                                                           00043643
&B5      SETB  ('&STORAGE' NE '')                                       00044043
&B16     SETB  ('&LIST' NE '')                                          00044443
&B23    SETB   ('&STRHDR' NE '')       WAS STRHDR SPECIFIED     G33SPHW 00044843
         AIF   ('&B5' EQ '1' AND '&B16' EQ '1').MSG4                    00045243
&B25     SETB  ('&B5' EQ '1' OR '&B16' EQ '1')                  G33SPHW 00045643
         AIF   ('&B23' EQ '1' AND '&B25' EQ '0').MSG9           G33SPHW 00045943
         AIF   ('&B23' NE '1').SKIPT                            G33SPHW 00046243
&CTR4    SETA  N'&STRHDR                                        G33SPHW 00046543
         AIF  (&CTR4 LT 1).MSG7                                 G33SPHW 00046843
.SKIPT   ANOP                                                   G33SPHW 00047143
         AIF   ('&B5' EQ '0').ABC7B                                     00048043
&CTR1    SETA  N'&STORAGE                                               00048443
         AIF   (&CTR1 LT 2).MSG4                               AS100400 00048843
         AIF   ('&B23' EQ '0').NOSHA   STRHDR SPECIFIED         G33SPHW 00049243
&CTR3    SETA  N'&STRHDR*2             GET NUMBER OF HEADER*2   G33SPHW 00049543
         AIF  ( &CTR3 GT &CTR1).MSG8 TOO MANY HEADERS           G33SPHW 00049843
.NOSHA   ANOP                                                   G33SPHW 00050143
.ABC7A   ANOP                                                           00050843
&CTR1    SETA  &CTR1-2                                                  00051243
         AIF   (&CTR1 EQ 0).ABC7C                              AS100400 00051643
         AIF   (&CTR1 LT 1).MSG4                          0880 AS100400 00052043
         AGO   .ABC7A                                                   00052443
.ABC7B   ANOP                                                           00052843
         AIF   ('&B16' EQ '0').ABC7C                                    00053243
         AIF   (N'&LIST NE 1).MSG4      LIST PARSM^=1                   00053643
         AIF   ('&B23' EQ '0').ABC7C    STRHDR SPECIFIED        G33SPHW 00054043
         AIF   (N'&STRHDR NE 1).MSGA     LIST FORMAT            G33SPHW 00054243
.ABC7C   ANOP                                                           00054843
&B6      SETB  ('&ID' NE '')                                            00055243
         AIF   ('&PDATA' EQ '').ABC18                                   00055643
         AIF   ('&PDATA'(1,1) EQ '(').ABC8                              00056043
&B8 SETB ('&PDATA' EQ 'SAH' OR '&PDATA' EQ 'SA' OR '&PDATA' EQ 'ALL')   00056443
&B9      SETB  ('&PDATA' EQ 'SAH')                                      00056843
&B10      SETB  ('&PDATA' EQ 'REGS' OR '&PDATA' EQ 'ALL')               00057243
&B11 SETB ('&PDATA' EQ 'LPA' OR '&PDATA' EQ 'ALLPA' OR '&PDATA' EQ 'ALLX00057643
               ')                                                       00058043
&B12 SETB ('&PDATA' EQ 'JPA' OR '&PDATA' EQ 'ALLPA' OR '&PDATA' EQ 'ALLX00058443
               ')                                                       00058843
.PDATA1  ANOP                                                           00059243
&B13     SETB  ('&PDATA' EQ 'PSW' OR '&PDATA' EQ 'ALL')                 00059643
&B14     SETB  ('&PDATA' EQ 'SPLS' OR '&PDATA' EQ 'ALL')                00060043
&CTR1    SETA  &B8+&B9+&B10+&B11+&B12+&B13+&B14                         00060443
         AIF   ('&CTR1' EQ '0').MSG3                                    00060843
&B15     SETB  0                                                        00061243
         AGO   .ABC18                                                   00061643
.ABC8    ANOP                                                           00062043
&CTR1    SETA  N'&PDATA                                                 00062443
&CTR2    SETA  0                                                        00062843
.LOOPB   ANOP                                                           00063243
&CTR2    SETA  &CTR2+1                                                  00063643
&C1      SETC  '&PDATA(&CTR2)'                                          00064043
         AIF   ('&C1' EQ 'SA').ABC10                                    00064443
         AIF   ('&C1' EQ 'SAH').ABC11                                   00064843
         AIF   ('&C1' EQ 'REGS').ABC12                                  00065243
         AIF   ('&C1' EQ 'LPA').ABC13                                   00065643
         AIF   ('&C1' EQ 'JPA').ABC14                                   00066043
         AIF   ('&C1' EQ 'ALLPA').ABC15                                 00066443
         AIF   ('&C1' EQ 'PSW').ABC16                                   00066843
         AIF   ('&C1' EQ 'SPLS').ABC17                                  00067243
         AIF   ('&C1' EQ 'ALL').ABC17A                                  00067643
         AGO   .MSG3                                                    00068043
.ABC9    ANOP                                                           00068443
         AIF   ('&CTR2' NE '&CTR1').LOOPB                               00068843
         AGO   .ABC18                                                   00069243
.ABC10    ANOP                                                          00069643
&B8      SETB  1                                                        00070043
         AGO   .ABC9                                                    00070443
.ABC11   ANOP                                                           00070843
&B8      SETB    1                                                      00071243
&B9      SETB  1                                                        00071643
         AGO    .ABC9                                                   00072043
.ABC12    ANOP                                                          00072443
&B10     SETB  1                                                        00072843
         AGO   .ABC9                                                    00073243
.ABC13   ANOP                                                           00073643
&B11     SETB  1                                                        00074043
         AGO   .ABC9                                                    00074443
.ABC14   ANOP                                                           00074843
&B12     SETB   1                                                       00075243
         AGO   .ABC9                                                    00075643
.ABC15    ANOP                                                          00076043
&B11     SETB  1                                                        00076443
&B12     SETB  1                                                        00076843
         AGO   .ABC9                                                    00077243
.ABC16    ANOP                                                          00077643
&B13     SETB  1                                                        00078043
         AGO   .ABC9                                                    00078443
.ABC17    ANOP                                                          00078843
&B14     SETB   1                                                       00079243
         AGO   .ABC9                                                    00079643
.ABC17A  ANOP                                                           00080043
&B8      SETB  1                                                        00080443
&B10     SETB  1                                                        00080843
&B11     SETB  1                                                        00081243
&B12     SETB  1                                                        00081643
&B13     SETB  1                                                        00082043
&B14     SETB  1                                                        00082443
.ABC18    ANOP                                                          00082843
&FLAGS1  SETA  128*&B4+64*&B17+32*&B18+16*&B19+8*&B3+4*&B2+2*&B7+1*&B20 00083243
&FLAGS2  SETA  128*&B8+64*&B9+32*&B10+16*&B11+8*&B12+4*&B13+2*&B14+1*&BX00083643
               15                                                       00084043
&FLAGS3  SETA  64*&OSVS2R2+32*&OSENVS2+16*&B0+8*&B6+4*&B1+2*&B5+2*&B16+X00084443
               1*&B23                                           G33SPHW 00084843
&FLAGS4  SETA  128*&B21+64*&B22                                 G33SPHW 00085043
         AIF   ('&DCB' EQ '' AND ('&MF' EQ '')).MSG1                    00085643
         AIF   ('&MF' EQ '').STYPE                                      00086043
         AIF   ('&MF' EQ 'L').LTYPE                                     00086443
         AIF   ('&MF'(1,3) NE '(E,').MSG5                               00086843
         AIF ('&NAME' EQ '').NONM                                       00087243
&NAME    DS    0H                                                  0918 00087643
.NONM    ANOP                                                           00088043
&C1      SETC  '&MF(2)'                                                 00088443
         AIF   ('&C1'(1,1) EQ '(').REG                                  00088843
         LA    1,&MF(2)                                            0918 00089243
         AGO   .CONT0                                                   00089643
.REG     ANOP                                                           00090043
         AIF   ('&C1' EQ '(1)').CONT0                                   00090443
         LR    1,&C1         GET ADDR OF PARM LIST                      00090843
.CONT0   ANOP                                                           00091243
         AIF   ('&DCB' EQ '').NODCB                                     00091643
         AIF   ('&DCB'(1,1) EQ '(').REGDCB                              00092043
         LA    0,&DCB               GET DCB ADDRESS                     00092443
         ST    0,8(0,1)             STORE INTO PARAMETER LIST    Y02705 00092643
         AGO    .NODCB                                                  00093243
.REGDCB  ANOP                                                           00093643
         LA    &DCB,0&DCB    CLEAR HIGH ORDER BYTE OF DCB ADR  @ZA09196 00093843
         ST    &DCB,8(0,1)   STORE DCB ADDR INTO PARAM LIST      Y02705 00094043
.NODCB   ANOP                                                           00094443
         OI    1(1),&FLAGS3        SET OPTION FLAGS              Y02705 00094843
         AIF   (T'&SDATA EQ 'O').CKPDATA    IS SDATA SPECIFIED   Y02705 00095243
         MVI   4(1),&FLAGS1        SET OPTION FLAGS              Y02705 00095643
         MVI   5(1),&FLAGS4        SET OPTIONS FLAGS            G33SPHW 00095843
.CKPDATA AIF   (T'&PDATA EQ 'O').GO1        IS PDATA SPECIFIED   Y02705 00096443
         MVI   6(1),&FLAGS2        SET OPTION FLAGS              Y02705 00096843
.GO1     ANOP                                                    Y02705 00097243
         AIF   ('&B1' EQ '0').NOTCB         IS TCB SPECIFIED     Y02705 00097643
         AIF   ('&TCB'(1,1) EQ '(').REGTCB  IS TCB ADDR IN A REG Y02705 00098043
         L     0,&TCB                       ADDRESS OF TCB       Y02705 00098443
         ST    0,12(0,1)                    INTO PARAMETER LIST  YM1995 00098843
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 00099243
.NOTCB   AIF   ('&TCB' EQ '''S''').CURRTCB  CURRENT TCB REQUEST  YO2705 00099643
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 00100043
.CURRTCB NI    1(1),X'FB'                   CURRENT TCB REQUEST  Y02705 00100443
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 00100843
.REGTCB  ANOP                                                    Y02705 00101243
         ST    &TCB,12(0,1)                 TCB ADDR INTO PARAM  YM1995 00101643
.GO2     ANOP                                                    Y02705 00102043
         AIF   ('&B5' EQ '0').NOSHOT                                    00102443
&CTR1    SETA  N'&STORAGE                                               00102843
         LA    0,24(0,1)           SET UP SNAPSHOT LIST ADDRESS G33SPHW 00103243
         ST    0,16(0,1)           STORE INTO PARAMETER LIST     Y02705 00103443
         AIF   ('&B23' EQ '0').NOHEAD   STRHDR SPECIFIED        G33SPHW 00104043
&CTR4    SETA  N'&STRHDR                NUMBER OF HEADERS       G33SPHW 00104343
&CTR8    SETA  &CTR1*4                  DISPLACEMENT            G33SPHW 00104643
&CTR8    SETA  &CTR8+24                 SKIP LIST               G33SPHW 00104943
         LA    0,&CTR8.(0,1)       SET UP HEADER ADDRESS        G33SPHW 00105243
         ST    0,20(0,1)           STORE INTO PARMLIST          G33SPHW 00105543
.NOHEAD  ANOP                      NOHEADERS SPECIFIED          G33SPHW 00105843
.DPA1    ANOP                                                           00106843
&CTR2    SETA   0                                                       00107243
&DISP    SETA  20        DISPLACEMENT INTO STORAGE ADDRESS LIST  Y02705 00107643
.LOOP1   ANOP                                                           00108043
&CTR2    SETA  &CTR2+1                                                  00108443
&DISP    SETA  &DISP+4                                                  00108843
&C1      SETC  '&STORAGE(&CTR2)'                                        00109243
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').STOR1                    00109643
         AIF   ('&MF' EQ '').AIF1                                       00110043
         LA    0,&STORAGE(&CTR2)   GET STARTING/ENDING ADDRESS     5139 00110443
         ST    0,&DISP.(0,1)                                            00110843
         AGO   .AIF1                                                    00111243
.STOR1   ANOP                                                           00111643
         ST    &C1,&DISP.(0,1)     GET STARTING/ENDING ADDRESS          00112043
.AIF1    ANOP                                                           00112443
         AIF   ('&CTR2' NE '&CTR1').LOOP1                               00112843
         OI    &DISP.(1),X'80'     SET END OF LIST INDICATOR     Y02705 00113243
         AGO   .DPA2                 CHECK HEADER               G33SPHW 00113643
.DPA2    ANOP                        STRHDR PROCESS             G33SPHW 00113943
         AIF   ('&B23' EQ '0').AIF3  NO STRHDR                  G33SPHW 00114243
&CTR4    SETA  N'&STRHDR             NUMBER OF HEADERS          G33SPHW 00114543
&CTR3    SETA  0                     COUNTER INITIALIZED        G33SPHW 00114843
.LOOP6   ANOP                        LOOP THRU HEADERS          G33SPHW 00115143
&CTR3    SETA  &CTR3+1               BUMP COUNTER               G33SPHW 00115443
&DISP    SETA  &DISP+4               BUMP DISPLACEMENT          G33SPHW 00115543
&C3      SETC  '&STRHDR(&CTR3)'      GET HEADER ADDRESS         G33SPHW 00116843
         AIF   ('&STRHDR(&CTR3)' EQ '').COMA                    G33SPHW 00117143
         AIF   ('&STRHDR(&CTR3)'(1,1) EQ '(').STOR3             G33SPHW 00117343
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 00117543
         LA    0,&STRHDR(&CTR3)    GET HEADER ADDRESS           G33SPHW 00118043
         ST    0,&DISP.(0,1)       STORE IN PARMLIST            G33SPHW 00118143
         AGO   .CHKIF                END OF HEADERS             G33SPHW 00118443
.STOR3   ANOP                        STORE REG IN PARMLIST      G33SPHW 00118843
         ST    &C3,&DISP.(0,1)     STORE HEADER ADDRESS         G33SPHW 00119243
.CHKIF   ANOP                        CHECK END OF HEADERS       G33SPHW 00119343
         AIF   ('&CTR3' NE '&CTR4').LOOP6 NOT END               G33SPHW 00119643
         OI    &DISP.(1),X'80'     SET END OF HEADER INDICATOR  G33SPHW 00120043
         AGO   .AIF3               HEADERS COMPLETE             G33SPHW 00120443
.COMA    ANOP                                                   G33SPHW 00120543
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 00120843
         LA    0,&STRHDR(&CTR3)    GET HEADER ADDRESS           G33SPHW 00121243
         ST    0,&DISP.(0,1)       STORE IN PARMLIST            G33SPHW 00121643
         AGO  .CHKIF                                            G33SPHW 00121743
.AIF3    ANOP                                                   G33SPHW 00122043
         AIF   ('&MF' EQ '').HOCH                                       00124443
.NOSHOT  ANOP                                                           00124843
         AIF   ('&B16' EQ '0').IDPREP                                   00125243
         AIF   ('&LIST'(1,1) EQ '(').LL1                                00125343
         LA    0,&LIST             GET LIST ADDRESS             G33SPHW 00125443
         ST    0,16(0,1)           STORE LIST ADDRESS IN PARM   G33SPHW 00125543
         AGO   .CHKH               CHECK HEADER SPECIFIED       G33SPHW 00125643
         OI    &DISP.(1),X'80'     SET END OF LIST INDICATOR    G33SPHW 00125843
         AGO   .AIF3               HEADERS COMPLETE             G33SPHW 00126243
         ST    0,16(0,1)     STORAGE IN PARAMETER LIST           Y02705 00126443
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 00126843
         LA    0,0                 ZERO ENTRY                   G33SPHW 00127143
         ST    0,&DISP.(0,1)       STORE ZERO HEADER LIST       G33SPHW 00127343
.LL1     ANOP                                                           00127543
         ST    &LIST,16(0,1) SNAPSHOT LIST ADDR INTO PARAM LIST  Y02705 00128043
         AGO   .CHKH                                            G33SPHW 00128443
.CHKH    ANOP                                                   G33SPHW 00128743
         AIF   ('&B23' EQ '0').NOHD   NO STRHDR SPECIFIED       G33SPHW 00129043
         AIF   ('&STRHDR'(1,1) EQ '(').STRHED                   G33SPHW 00129343
         LA    0,&STRHDR     GET HEADER ADDRESS                 G33SPHW 00129643
         ST    0,20(0,1)     STORE HEADER ADDRESS               G33SPHW 00129943
.NOHD    ANOP                                                   G33SPHW 00130243
         AGO   .IDPREP       PREPARE FOR ID                     G33SPHW 00130543
.STRHED  ANOP                HEADER IN REGISTER                 G33SPHW 00130843
         ST    &STRHDR,20(0,1) STORE HEADER ADDRESS             G33SPHW 00131143
         AGO   .IDPREP       PREPARE FOR ID                     G33SPHW 00131443
.IDPREP  ANOP                                                           00132843
         AIF   ('&B6' EQ '0').NOID                                      00133243
         AIF   ('&ID'(1,1) EQ '(').IDPREP1                              00133643
         MVI   0(1),&ID            GET ID NUMBER                        00134043
         AGO    .NOID                                                   00134443
.IDPREP1  ANOP                                                          00134843
         STC   &ID,0(0,1)         GET ID NUMBER                  YM1995 00135243
.NOID    ANOP                                                           00135643
         SVC   51                                                       00136043
         MEXIT                                                          00136443
.STYPE   ANOP                                                           00136843
&GNAME   SETC  'IHB'.'&SYSNDX'                                          00137243
         CNOP  0,4                                                      00137643
&NAME    BAL   1,&GNAME            BRANCH AROUND PARAM LIST             00138043
.LSTYPE  ANOP                                                           00138443
         AIF   ('&B6' EQ '0').NOIDS                                     00138843
         AIF   ('&ID'(1,1) EQ '(').NOIDS                                00139243
         DC    AL1(&ID)            ID NUMBER                            00139643
         AGO   .CONT2                                                   00140043
.NOIDS   ANOP                                                           00140443
         DC    AL1(0)              ID NUMBER                            00140843
.CONT2   ANOP                                                           00141243
         DC    AL1(&FLAGS3)        OPTION FLAGS                  Y02705 00141643
         DC    H'0'                RESERVED                      Y02705 00141843
         DC    AL1(&FLAGS1)        SDATA FLAGS ONE               Y02705 00142443
         DC    AL1(&FLAGS4)        SDATA FLAGS TWO              G33SPHW 00142543
         DC    AL1(&FLAGS2)        PDATA FLAGS                   Y02705 00142743
         DC    AL1(0)              RESERVED                      Y02705 00143343
         AIF   ('&DCB' EQ '').DCBA0                                     00144043
         AIF   ('&DCB'(1,1) EQ '(').DCBA0                          9943 00144443
         DC    A(&DCB)             DCB ADDRESS                          00144843
         AGO   .DCBA1                                                   00145243
.DCBA0   ANOP                                                           00145643
         DC    A(0)                TCB ADDRESS                          00146043
.DCBA1    ANOP                                                          00146443
         DC    A(0)                TCB ADDRESS                          00146843
         AIF   ('&B5' EQ '0' AND '&B16' EQ '0').SS3                     00147243
         AIF   ('&B5' EQ '1').SS1                                       00147643
         AIF   ('&LIST'(1,1) EQ '(').LISTRG                    @ZA51152 00148003
         DC    A(&LIST)            ADDRESS OF SNAPSHOT LIST             00148443
         AGO   .CHHDR                                          @ZA51152 00148503
.LISTRG  ANOP                                                  @ZA51152 00148603
         DC    A(0)                ADDRESS OF SNAP-SHOT LIST   @ZA51152 00148703
.CHHDR   ANOP                                                  @ZA51152 00148803
         AIF   ('&B23' EQ '1').HHHV    STRHDR SPECIFIED         G33SPHW 00148903
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 00149043
         AGO   .CONT8                                           G33SPHW 00149343
.HHHV    ANOP                                                   G33SPHW 00149643
         AIF   ('&STRHDR'(1,1) EQ '(').SSL                      G33SPHW 00149943
         DC    A(&STRHDR)          ADDRESS OF HEADER LIST       G33SPHW 00150243
         AGO   .CONT8                                           G33SPHW 00150543
.SSL     ANOP                                                   G33SPHW 00150843
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 00151143
         AGO   .CONT8                                                   00152443
.SS1     ANOP                                                           00152843
&CTR1    SETA  N'&STORAGE                                               00153243
         AGO   .SS2                                                     00153643
.SS3     ANOP                                                           00154043
         DC    A(0)                ADDRESS OF SNAP-SHOT LIST            00154443
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 00154843
         AGO   .CONT8                                                   00155243
.SS2     ANOP                                                           00155643
         DC    A(*+8)              ADDRESS OF SNAP-SHOT LIST            00156043
         AIF   ('&B23' EQ '0').HHH4       STRHDR SPECIFIED      G33SPHW 00156443
&CTR3    SETA  N'&STORAGE+1             NUMBER OF STORAGE ADDR  G33SPHW 00156743
&CTR5    SETA  &CTR3*4                  DISP. FOR HEADER        G33SPHW 00157043
         DC    A(*+&CTR5.)         ADDRESS OF HEADER LIST       G33SPHW 00157343
         AGO   .HHH5                      AROUND DC             G33SPHW 00157643
.HHH4    ANOP                                                   G33SPHW 00157943
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 00158243
.HHH5    ANOP                                                           00159243
&CTR2    SETA  0                                                        00159643
.LOOP3   ANOP                                                           00160043
&CTR2    SETA  &CTR2+1                                                  00160443
         AIF   ('&STORAGE(&CTR2)' EQ '').STYPE3                         00160843
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').STYPE2                   00161243
         DC    A(&STORAGE(&CTR2))  STARTING/ENDING ADDRESS              00161643
         AIF   ('&CTR2' NE '&CTR1').LOOP3                               00162443
         AIF   ('&B23' EQ '1').HHHZ                             G33SPHW 00162843
         AGO   .CONT8                                           G33SPHW 00163743
.HHHZ    ANOP                                                   G33SPHW 00164043
         AIF   ('&MF' NE 'L').ARND                              G33SPHW 00164343
         AIF   ('&STORAGE' EQ '').ARND                          G33SPHW 00164643
         ORG   *-4                                              G33SPHW 00164943
         DC    X'80'               END  OF LIST                 G33SPHW 00165243
         ORG   *+3                                              G33SPHW 00165543
.ARND    ANOP                                                   G33SPHW 00165843
&CTR3    SETA  N'&STRHDR                                        G33SPHW 00166143
&CTRB    SETA  0                                                G33SPHW 00166443
.LOOP9   ANOP                                                   G33SPHW 00166743
&CTRB    SETA  &CTRB+1                                          G33SPHW 00167043
         AIF   ('&STRHDR(&CTRB)' EQ '').HHHA                    G33SPHW 00167343
         AIF   ('&STRHDR(&CTRB)'(1,1) EQ '(').HHHB              G33SPHW 00167643
         DC    A(&STRHDR(&CTRB))   ADDRESS OF HEADER            G33SPHW 00167943
.HHHD    ANOP                                                   G33SPHW 00168243
         AIF   ('&CTR3' NE '&CTRB').LOOP9                       G33SPHW 00168543
         AGO   .CONT8                                           G33SPHW 00168843
.HHHA    ANOP                                                   G33SPHW 00169143
         DC   A(0)                ADDRESS OF HEADER             G33SPHW 00169443
         AGO  .HHHD                                             G33SPHW 00169743
.HHHB    ANOP                                                   G33SPHW 00170043
         AIF   ('&MF' EQ 'L').MSGB REG FORMAT WITH MF=L         G33SPHW 00170343
         DC    A(0)               ADDRESS OF HEADER             G33SPHW 00170643
         AGO   .HHHD                                            G33SPHW 00170943
.STYPE1  ANOP                                                           00171043
         AIF   ('&CTR2' NE '&CTR1').LOOP3                               00171243
         AIF   ('&B23' EQ '1').HHHZ                                     00172143
.CONT8   ANOP                                                           00174043
         AIF   ('&MF' EQ 'L').EXIT                                      00174443
&GNAME   DS    0H                                                       00174843
         AIF   ('&B6' EQ '0').HOCH0                                     00175243
         AIF   ('&ID'(1,1) NE '(').HOCH0                                00175643
         STC   &ID,0(0,1)       GET ID NUMBER                    YM1995 00176043
.HOCH0   ANOP                                                           00176443
         AIF   ('&B5' EQ '0').HOCH1                                     00176843
         AGO   .DPA1                                                    00177243
.LHDRS   ANOP                                                   G33SPHW 00177643
         AIF  ('&B23' EQ '0').DPA1                              G33SPHW 00177943
&CTRB    SETA   0                                               G33SPHW 00178243
&CTR5    SETA   N'&STRHDR                                       G33SPHW 00178543
.LOOP8   ANOP                                                   G33SPHW 00178843
&CTRB    SETA  &CTRB+1                                          G33SPHW 00179143
         AIF   ('&STRHDR(&CTRB)' EQ '').SKIPHD                  G33SPHW 00179443
         AIF   ('&STRHDR(&CTRB)'(1,1) EQ '(').CHKL              G33SPHW 00179743
         DC    A(&STRHDR(&CTRB))   ADDRESS OF HEADER            G33SPHW 00180043
.CHKEND  ANOP                                                   G33SPHW 00180343
         AIF   ('&CTRB' NE '&CTR5').LOOP8                       G33SPHW 00180643
         AIF   ('&MF' EQ 'L').EXIT                              G33SPHW 00180943
         DS   0H       ALLIGN ON WORD BDY                               00182443
         AGO  .DPA1                                             G33SPHW 00182743
.SKIPHD  ANOP                                                   G33SPHW 00183043
         DC   A(0)                 ADDRESS OF HEADER            G33SPHW 00183343
         AGO   .CHKEND                                          G33SPHW 00183643
.CHKL    ANOP                                                   G33SPHW 00184043
         AIF   ('&MF' EQ 'L').MSGB                              G33SPHW 00184243
         DC    A(0)                ADDRESS OF HEADER            G33SPHW 00184443
         AGO     .CHKEND                                        G33SPHW 00184843
.HOCH    ANOP                                                           00186043
         AIF   ('&B1' EQ '0').YYY                                  9943 00186443
         AIF   ('&TCB'(1,1) EQ '(').XXX                                 00186843
         L     0,&TCB        GET TCB ADDRESS                            00187243
         ST    0,12(0,1)     STORE IN PARAMETER LIST             Y02705 00187643
         AGO   .YYY                                                9943 00188043
.HOCH1   ANOP                                                           00188443
         AIF   ('&B16' EQ '0').HOCH                                     00188843
         AIF   ('&LIST'(1,1) EQ '(').XXX2                               00189243
         AIF   ('&MF' EQ '').HHH1                                       00189643
         LA    0,&LIST       GET ADDRESS OF SNAPSHOT LIST               00190043
         ST    0,16(0,1)       STORE INTO PARAMETER LIST         Y02705 00190443
.HHH1    ANOP                                                   G33SPHW 00190743
         AIF   ('&B23' EQ '0').HOCH                             G33SPHW 00191043
         AIF   ('&STRHDR'(1,1) EQ '(').HHH2  REG FORM ADDRESS   G33SPHW 00191343
         AIF   ('&MF' EQ '').HOCH            STANDARD FORM      G33SPHW 00191643
         LA    0,&STRHDR       GET ADDRESS OF HEADER LIST       G33SPHW 00191943
         ST    0,20(0,1)       STORE HEADER ADDRESS             G33SPHW 00192243
         AGO   .HOCH           RETURN                           G33SPHW 00192543
.HHH2    ANOP                                                   G33SPHW 00192843
         ST    &STRHDR,20(0,1) STORE INTO PARMLIST              G33SPHW 00193143
         AGO  .HOCH                                                     00194443
         AGO   .HOCH                                                    00194843
.XXX2    ANOP                                                           00195243
         ST    &LIST,16(0,1)       STORE SNAPSHOT ADDR INTO PARM LIST   00195643
         AGO   .HHH1                                                    00196043
.STYPE2  ANOP                                                           00196443
         AIF   ('&MF' EQ 'L').MSG4                                      00196843
         DC    A(0)                STARTING/ENDING ADDRESS              00197243
         AGO   .STYPE1                                                  00197643
.STYPE3  ANOP                                                           00198043
         AIF   ('&MF' EQ '').MSG4                                       00198443
         DC    A(0)                STARTING/ENDING ADDRESS              00198843
         AGO   .STYPE1                                                  00199043
.XXX     ANOP                                                           00199643
         ST    &TCB,12(0,1)        STORE ADDRESS OF TCB INTO PARM LIST  00200043
.YYY     AIF   ('&DCB'(1,1) NE '(').SVC51                          9943 00200443
         LA    &DCB,0&DCB    CLEAR HIGH ORDER BYTE OF DCB ADR  @ZA09196 00200643
         ST    &DCB,8(0,1)   STORE DCB ADDRESS INTO PARM LIST   G33SPHW 00200843
.SVC51   ANOP                                                           00201243
         SVC   51                                                       00201643
         AGO   .EXIT1                                                   00202043
.EXIT    ANOP                                                           00202443
         AIF   ('&STORAGE' EQ '').EXIT1                                 00202843
         ORG   *-4                                                      00203243
         DC    X'80'                                             YM1577 00203643
         ORG   *+3                                               YM1577 00204043
.EXIT1   ANOP                                                           00204443
         MEXIT                                                          00204843
.LTYPE   ANOP                                                           00205243
         AIF   ('&TCB' NE '').MSG6                                 2607 00205643
         AIF   ('&STORAGE' EQ '').LTYPE1                                00206043
         AIF   ('&STORAGE'(2,1) EQ '(').MSG4 NO STRHDR                  00206443
         AIF   ('&STRHDR' EQ '').SKIPL  ONE HEADER              G33SPHW 00206743
         AIF   (N'&STRHDR EQ 1).HHHK    REG FORMAT W/MF=L       G33SPHW 00207043
         AIF   ('&STRHDR'(2,1) EQ '(').MSGB                     G33SPHW 00207343
.HHHK    ANOP                                                   G33SPHW 00207643
.SKIPL   ANOP                                                   G33SPHW 00207943
         AGO   .LTYPE2                                                  00208843
.LTYPE1  ANOP                                                           00209243
         AIF   ('&LIST' EQ '').LTYPE2                                   00209643
         AIF   ('&LIST'(1,1) EQ '(').MSG4                               00210043
         AIF   ('&STRHDR' EQ '').SKIPM   NO STRHDR              G33SPHW 00210443
         AIF   ('&STRHDR'(1,1) EQ '(').MSGB REG FORMAT W/MF=L   G33SPHW 00210643
.SKIPM  ANOP                                                            00211243
.LTYPE2  ANOP                                                           00211643
&NAME    DS    0F                                                       00212043
         AGO   .LSTYPE                                                  00212443
.MSG1    IHBERMAC  6                                                    00212843
         MEXIT                                                          00213243
.MSG2    ANOP                                                           00213643
&B2      SETB  1                                                        00214043
&B3      SETB  0                                                        00214443
&B4      SETB  0                                                        00214843
&B7      SETB  0                                                        00215243
&B17     SETB  0                  NO SQA                         Y02705 00215643
&B18     SETB  0                  NO LSQA                        YO2705 00216043
&B19     SETB  0                  NO SWA                         Y02705 00216443
&B20     SETB  0                                                        00216543
&B21     SETB  0                                                        00216643
&B22     SETB  0                                                        00216743
         IHBERMAC  183,&SDATA,CB                                        00216843
         AGO   .ABC7                                                    00217243
.MSG4    IHBERMAC  189                                                  00217643
         MEXIT                                                          00218043
.MSG7   MNOTE 7,'STRHDR FORMAT INCORRECT'                       G33SPHW 00218443
        MEXIT                                                           00218843
.MSG8   MNOTE 7,'NUMBER OF STRHDR ADDRESSES EXCEED STORAGE RANGES'      00219243
        MEXIT                                                           00219643
.MSG9   MNOTE 7,'INVALID USE OF STRHDR NO STORAGE OR LIST SPECIFIED'    00220043
        MEXIT                                                           00220443
.MSGA   MNOTE 8,'LIST FORMAT NOT SPECIFIED ON STRHDR REQ. ON LIST'      00220843
        MEXIT                                                           00221243
.MSGB   MNOTE 8,'REGISTER FORMAT USED WITH MF=L'                G33SPHW 00221643
        MEXIT                                                           00222043
.MSG3    ANOP                                                           00222443
&B8      SETB  1                                                        00222843
&B9      SETB    0                                                      00223243
&B10     SETB  1                                                        00223643
&B11     SETB  1                                                        00224043
&B12     SETB  1                                                        00224443
&B13     SETB  1                                                        00224843
&B14     SETB  1                                                        00225243
         IHBERMAC  183,&PDATA,ALL                                       00225643
         AGO   .ABC18                                                   00226043
.MSG5    IHBERMAC  35,,&MF                                              00226443
         MEXIT                                                          00226843
.MSG6    IHBERMAC   197                                            2607 00227243
         MEND                                                           00227643
