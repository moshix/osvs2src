         MACRO                                                          00070005
&NAM     TSOMCP &OPTIONS=,&TRACE=0,&LNUNITS=,&UNITSIZ=60,              X00140005
               &DTRACE=0,&OLTEST=0,                                    X00210005
               &PLCBNO=,&BTRACE=,&IPLTXID=,&AUTOIPL=,          @ZM46739X00280010
               &SIBCNT=,&SUBAREA=,&MAXSUBA=,&TTRACE=,          @ZM46739X00280310
               &IEDHALT=,                                      @Y17XAYPX00320000
               &DMPNAME=,&AUTODMP=,&THRESH=(255,1,1,1),        @OY18934X00350082
               &INHDR=,&INBUF=,&INMSG=,&OUTHDR=,&OUTBUF=,      @OY18934X00360082
               &OUTMSG=,&LOGSCAN=12                            @OY18934 00370082
.********************************************************************** 00420058
.*                                                                    * 00429058
.*       MACRO NAME = TSOMCP                                          * 00438058
.*                                                                    * 00447058
.*       DESCRIPTIVE NAME = TCAM/TSO SOURCE GENERATOR                 * 00456058
.*                                                                    * 00465058
.*       COPYRIGHT = 'NONE'                                           * 00474058
.*                                                                    * 00483058
.*       STATUS: CHANGE LEVEL 10.0                                    * 00492000
.*                                                                    * 00501058
.* CHANGE ACTIVITY = AS FOLLOWS:                                        00510005
.* C655200                                                      OY03474 00530005
.*                                                              @Y06327 00530158
.*                                                              @YM2220 00530258
.* C426300                                                     @YA07414 00530358
.*C653100-653800                                               @YA04034 00540057
.*A875700,876400                                               @YA03674 00550057
.* A445200                                                     @ZA03733 00550158
.* C653100-653800                                              @ZA03733 00550258
.* D375200,404600-406000                                       @YA10436 00550358
.* C849800                                                     @YA11714 00550458
.* D875700-876700                                              @YA11714 00550558
.* C411200-411220,411260-411300,411380                         @OZ15632 00551500
.* C345800,393400                                              @OZ16520 00552500
.* D410940-411460                                              @OZ16520 00553500
.* C338800                                                     @OZ16602 00554500
.*A189700                                                      @OY16449 00554684
.*C076300,198100-200280,316000-316100,340900,343000-343700     @OY16449 00554784
.*C631065,631079                                               @OY16449 00554884
.*A630000                                                      @OY18058 00554984
.*C625800                                                      @OY18058 00555084
.*A067900,247800,250600,334600                                 @OY19258 00555182
.*C198800-199600                                               @OY19259 00555282
.* A078400,849100,874360                                       @OZ27297 00555382
.* C802200                                                     @OY19814 00555482
.*C003500,183400,186200,340200-343700,877300,881300            @OY18934 00555582
.*A079800,193200                                               @OY18934 00555682
.*A630907                                                      @OY20324 00555782
.*C315000-315700                                               @OY19429 00555882
.*A107100                                                      @OY20431 00555982
.*C318500-320600                                               @OY20431 00556082
.*C200680,204400                                               @OY20379 00556182
.*A102900,209700                                               @OY20834 00556282
.*C216640-216660,216711-216712,217000                          @OY20834 00556382
.*C630957-630958,631223                                        @OZ33108 00556482
.*A033600                                                      @OZ34694 00556582
.*C802200                                                      @OZ34694 00556682
.*A102200                                                      @OY21130 00556782
.*C216680-216707,216711,217000                                 @OY21130 00556882
.*D103200                                                      @OY21130 00556982
.*C145600,148400                                               @OZ45570 00557082
.*C861700                                                      @OZ48953 00557182
.*D392700-393400,352100,368200                                 @OZ50273 00558082
.*C356300                                                      @OZ50273 00558982
.* C148400                                                     @OZ58371 00559482
.*                                                                      00560005
.*                                                                      00630005
.*FUNCTION -- THIS MACRO USES THE VALUES PLACED IN GLOBAL VARIABLES     00700005
.*   BY PREVIOUS LINEGRP AND LIST MACROS AND THE VALUES SPECIFIED       00770005
.*   IN ITS OWN MACRO PARAMETERS TO GENERATE THE TCAM SOURCE            00840005
.*   STATEMENTS WHICH CONSTITUTE A MESSAGE CONTROL PROGRAM.             00910005
.*                                                                      00980005
.*ENTRY POINTS -- NOT APPLICABLE                                        01050005
.*                                                                      01120005
.*INPUT -- VALUES PLACED IN GLOBAL VARIABLES BY PREVIOUS MACRO CALLS    01190005
.*   AND MACRO CALL PARAMETER VALUES SPECIFIED BY THE USER.             01260005
.*                                                                      01330005
.*OUTPUT -- TCAM MACRO STATEMENTS.  MNOTES IF ERRORS ARE DETECTED.      01400005
.*                                                                      01470005
.*EXTERNAL REFERENCES -- NOT APPLICABLE                                 01540005
.*                                                                      01610005
.*EXITS, NORMAL -- NORMAL EXIT OCCURS AFTER A COMPLETE SOURCE MESSAGE   01680005
.*   CONTROL PROGRAM HAS BEEN GENERATED.                                01750005
.*                                                                      01820005
.*EXITS, ERROR -- IF PREVIOUS MACROS ENCOUNTERED SERIOUS                01890005
.*   ERRORS (QUITSW = 1) A MNOTE WITH SEVERITY 16 IS ISSUED             01960005
.*   AND GENERATION IS BYPASSED.                                        02030005
.*                                                                      02100005
.*TABLES/WORK AREAS -- SEE DESCRIPTIONS ACCOMPANYING VARIABLE           02170005
.*   DECLARATIONS.                                                      02240005
.*                                                                      02310005
.*ATTRIBUTES -- NOT APPLICABLE                                          02380005
.*                                                                      02450005
.*CHARACTER CODE DEPENDENCY -- NONE                                     02520005
.*                                                                      02590005
.*NOTES -- NONE                                                         02660005
.*                                                                      02730005
.*                                                                      02800005
.*       GLOBAL VARIABLES                                               02870005
.*                                                                      02940005
         GBLB  &T3705              3705 LINE GROUP               Y06327 03010005
         GBLB  &T270X              NON-3705 LINE GROUP           Y06327 03080005
         GBLA  &RNNUMB             COUNT OF 3705'S               Y06327 03150005
         GBLA  &RNLINES            NO. OF 3705 LINES             Y06327 03220005
         GBLA  &RNTERMS            NO. OF 3705 TERMINALS         Y06327 03290005
         GBLA  &LUTERMS            NO. NCP TERM-LU             @Y17XAYP 03320000
         GBLA  &NLG                NUMBER OF LINEGRP MACROS ISSUED      03360005
         GBLA  &NONLU                   NON SNA OR 327C TERMS  @OZ34694 03390082
         GBLB  &MCPSW              INDICATES TSOMCP MACRO ISSUED        03430005
         GBLB  &QUITSW             ON MEANS SERIOUS ERROR OCCURRED      03500005
         GBLB  &BISYNC             BISYNCHRONOUS LINE                   03570005
         GBLB  &SNA                SNA RESOURCE INCLUDED       @Y17XAYP 03600000
         GBLB  &FSCR               FULL SCREEN REQ FLAG          Y06327 03640005
         GBLB  &USSB(2500)         USS CHARACTER SETSWITCHES   @Y17XAYP 03670000
         GBLB  &SCRALL(2500)            FULL SCREEN READ SWITCHESY06327 03710005
         GBLB  &LUSB(2500)         LU/LU SESSION SWITCHES      @Y17XAYP 03740000
         GBLA  &DDCT                    COUNT OF UNIQUE DDNAMES  Y06327 03780005
         GBLA  &ADRPT              ADCHAR ARRAY POINTER                 03850005
         GBLA  &SCRPT              USED AS POINTER TO ARRAYS WITH       03920005
.*                                 ONE ENTRY PER LINE                   03990005
         GBLA  &NFM(63)            CONTAINS NCPFM= PARAMETER   @YM07290 04000000
         GBLA  &NTS(63)            CONTAINS NCPTS= PARAMETER   @YM07290 04010000
         GBLA  &PFM(63)            CONTAINS PUFM= PARAMETER    @YM07290 04020000
         GBLA  &PTS(63)            CONTAINS PUTS= PARAMETER    @YM07290 04030000
         GBLA  &LFM(63)            CONTAINS LUFM= PARAMETER    @YM07290 04040000
         GBLA  &LTS(63)            CONTAINS LUTS= PARAMETER    @YM07290 04050000
         GBLA  &LUTYP(63)          CONTAINS THE LU TYPE        @YM08503 04055000
         GBLA  &LNO(63)            NUMBER OF LINES PER GROUP            04060005
.*                                 (ONE ENTRY PER LINEGRP)              04130005
         GBLA  &UNO(63)            NO. OF UNITS PER BUFFER              04200005
.*                                 (ONE ENTRY PER LINEGRP)              04270005
         GBLA  &INT(63)            POLLING INTERVAL                     04340005
.*                                 (ONE ENTRY PER LINEGRP)              04410005
         GBLB  &DIALSW(63)         NETWORK TYPE INDICATORS              04480005
.*                                 (ONE ENTRY PER LINEGRP)              04550005
         GBLC  &T(63)              TERMINAL TYPE                        04620005
.*                                 (ONE ENTRY PER LINEGRP)              04690005
         GBLC  &DDNME(63)          DDNAMES OF LINE GROUPS               04760005
.*                                 (ONE ENTRY PER LINEGRP)              04830005
         GBLC  &GRPNAME(63)        GROUP NAME OF 3705 LINE GROUP Y06327 04900005
.*                                 (ONE ENTRY PER LINE GROUP)    Y06327 04970005
         GBLB  &FETAB(189)         FEATURES PRESENT INDICATORS          05040005
.*                                 (THREE ENTRIES PER LINEGRP)          05110005
         GBLC  &TTAB(252)          TRANSLATION TABLES                   05180005
.*                                 (FOUR ENTRIES PER LINEGRP)           05250005
         GBLC  &CTAB(252)          CODE SELECTION CHAR SEQUENCES        05320005
.*                                 (FOUR ENTRIES PER LINEGRP)           05390005
         GBLA  &SCRH(2500)         SCREEN HEIGHT                        05460005
.*                                 (ONE ENTRY PER LINE)                 05530005
         GBLA  &SCRW(2500)         SCREEN WIDTH                         05600005
.*                                 (ONE ENTRY PER LINE)                 05670005
         GBLA  &TRMNO(2500)        NO. OF TERMINALS PER LINE            05740005
.*                                 (ONE ENTRY PER LINE)                 05810005
         GBLC  &ADCHAR(2500)       ADDRESSING CHARACTERS                05880005
.*                                 (ONE ENTRY PER TERMINAL)             05950005
         GBLC  &HALT               IEDHALT OPERAND             @Y17XAYP 05980000
.*                                                                      06020005
.*       LOCAL VARIABLES                                                06090005
.*                                                                      06160005
         LCLA  &PNCHCO             COUNT FOR PUNCH CONTINUE     @YM8503 06190000
         LCLA  &BTRCNO             NO. OF BTU TRACE ENTRIES      Y06327 06230005
         LCLA  &LC                 3705 TERMINAL LINE COUNTER    Y06327 06300005
         LCLA  &RN                 DCB SUFFIX FOR 3705           Y06327 06370005
         LCLB  &FLG                FLAG                          Y06327 06440005
         LCLC  &DMP                TEMPORARY STORAGE             Y06327 06510005
         LCLC  &IPL                TEMPORARY STORAGE             Y06327 06580005
         LCLC  &GNAME              GROUP MACRO LABEL             Y06327 06650005
         LCLC  &LNAME              3705 TERMINAL LINE NAME       Y06327 06720005
         LCLC  &CNAME              CLUSTER OR PUNT NAME        @Y17XAYP 06750000
         LCLC  &FEATURE            3705 FEATURE                  Y06327 06790005
         LCLC  &BRACK                   BRACKET OPTION         @OY19258 06820082
         LCLA  &PLCB               3705 PLCBS                    Y06327 06860005
         LCLC  &GTRANS             TRANSTAB FOR GROUP MACRO      Y06327 06930005
         LCLC  &OPDT               OPTION FIELD CHARS            Y06327 07000005
         LCLC  &OPDT1              OPTION FIELD DATA             Y06327 07070005
         LCLC  &OPDT2              OPTION BIND IMAGE NAME      @YM08503 07100000
         LCLA  &LNEPT              LINE ARRAY POINTER            Y06327 07140005
         LCLC  &AUTOI              AUTOIPL PARAMETER             Y06327 07210005
         LCLC  &AUTOD              AUTODMP PARAMETER             Y06327 07280005
         LCLA  &SIBCT              SIBCOUNT                    @Y17XAYP 07290000
         LCLA  &MAXSA              MAXSUBAREA                  @Y17XAYP 07300000
         LCLA  &SUBA               SUBAREA                     @Y17XAYP 07310000
         LCLC  &TRM                TERM TYPE                   @Y17XAYP 07320000
         LCLA  &OLTST              NO. OF ON-LINE TEST PROCEDURES       07350005
         LCLC  &CRSREF             INDICATES CROSSRF OPTION DESIRED     07420005
         LCLB  &PROMPT             ON MEANS PROMPT USER FOR TCAM PARMS  07490005
         LCLA  &TRCNO              NO. OF TRACE TABLE ENTRIES WANTED    07560005
         LCLA  &DTRCN1             NO. OF DISPATCHER TRACE ENT.@OY16449 07630084
         LCLC  &DTRCN2             ON, OFF, POST SWITCH        @OY16449 07660084
         LCLA  &LNUNNO             NO. OF BASIC UNITS IN BUFFER POOL    07700005
         LCLA  &UNSIZ              SIZE OF TCAM BASIC UNIT              07770005
         LCLB  &CPIDSW             ON MEANS CPU.ID. CONSTANT NEEDED     07840005
         LCLB  &CPID1              ON MEANS CPU ID  EVEN PARITY@OZ27297 07843082
         LCLB  &CPID2              ON MEANS CPU ID ODD PARITY  @OZ27297 07846082
         LCLA  &ADDON              LNUNITS ADDON VALUE FOR 3270  Y06327 07850005
.*                                 TERMINALS                     Y06327 07860005
         LCLA  &DISPLAY            LARGEST 3270 SCREEN SIZE      Y06327 07870005
.*                                 PER LINE                      Y06327 07880005
         LCLC  &C                  COMMA                         Y06327 07910005
         LCLC  &D                  PERIOD                        Y06327 07980005
         LCLA  &TH,&THS1,&THS2,&THS3,&THS4                     @OY18934 07985082
         LCLA  &E                  WORK VARIABLE               @Y17XAYP 07990000
         LCLA  &G                  WORK VARIABLE               @Y17XAYP 08000000
         LCLA  &H                  WORK VARIABLE               @Y17XAYP 08010000
         LCLA  &I                  WORK VARIABLE                        08050005
         LCLA  &J                  WORK VARIABLE                        08120005
         LCLA  &K                  WORK VARIABLE                        08190005
         LCLA  &L                  WORK VARIABLE                        08260005
         LCLA  &M                  WORK VARIABLE                        08330005
         LCLA  &N                  WORK VARIABLE                        08400005
         LCLA  &MM                 WORK VARIABLE                        08470005
         LCLA  &Q                  WORK VARIABLE                        08540005
         LCLC  &LUACT              LU/LU ACTIVATE OPERAND      @Y17XAYP 08570000
         LCLC  &X                  WORK VARIABLE                        08610005
         LCLC  &Y                  WORK VARIABLE                        08680005
         LCLA  &Z                  WORK VARIABLE                        08750005
         LCLC  &EOT                CONTAINS EOT CHARACTER               08820005
         LCLC  &TBL(32)            3270 POLLING/ADDRESSING CHARACTERS   08890005
.*                                 LOOKUP TABLE. THE TABLE HAS 32       08960005
.*                                 ENTRIES. EACH ENTRY HAS 4 ELEMENTS.  09030005
.*                                 EACH ELEMENT HAS TWO CHARACTERS.     09100005
.*                                 1. POLLING CHARACTERS (EBCDIC)       09170005
.*                                 2. CORRESSPONDING ADDRESSING CHARS.  09240005
.*                                 3. POLLING CHARACTERS (ASCII)        09310005
.*                                 4. CORRESPONDING ADDRESSING CHARS.   09380005
         LCLC  &QBYP               CONTAINS QBY PARAMETER               09450005
         LCLC  &TYP                INTRO ENVIRON TYPE          @Y17XAYP 09480000
         LCLC  &L2741(4)           2741 TRANSLATE TABLE ARRAY           09520005
         LCLC  &L1050(4)           1050 TRANSLATE TABLE ARRAY           09590005
         LCLA  &N2741              2741 TRANSLATE TABLE ARRAY COUNTER   09660005
         LCLA  &N1050              1050 TRANSLATE TABLE ARRAY COUNTER   09730005
         LCLC  &FEAT(3)            CONTAINS FEATURE DESCRIPTORS         09800005
         LCLC  &TNAME              TEMP HOLD AREA FOR CHAR EXPRESSION   09870005
         LCLA  &TN                 COUNTER OF TERMINAL/LINE MACRO NAMES 09940005
         LCLA  &IN                 COUNTER FOR INVLIST MACRO NAMES      10010005
         LCLC  &CM(3)              SUBLIST SEPARATORS, COMMAS OR NULLS  10080005
         LCLC  &CS(36)             WILL CONTAIN ALPHAMERIC CHAR SET     10150005
.*                                 (26 ALPHABETIC, 10 NUMERIC)          10220005
         LCLA  &SCSPT                   SCREEN SIZE ARRAY PTR  @OY21130 10250082
         LCLC  &CP(3)              CONTINUATION POSITIONERS -- THESE    10290005
.*                                 ARE SET TO EITHER '' OR '     '.     10360005
.*                                 THEIR FUNCTION IS TO TAKE UP THE     10430005
.*                                 RIGHT AMOUNT OF SPACE IN THE PUNCHED 10500005
.*                                 SOURCE STATEMENTS SUCH THAT THERE    10570005
.*                                 WILL BE A CONTINUATION CHAR IN       10640005
.*                                 COLUMN 72.                           10710005
         LCLA  &TOTERMS            TOTAL OF 3705 TERMINALS     @OY20431 10730082
.*                                 PLUS 3705 LU'S              @OY20431 10750082
.*                                                                      10780005
         ACTR  (&NLG+6)*4096       ADJUST ACTR                   Y06327 10850005
.*                                                                      10920005
.*       INITIALIZE ALPHAMERIC CHARACTER SET ARRAY                      10990005
.*                                                                      11060005
&CS(1)   SETC  'A'                                                      11130005
&CS(2)   SETC  'B'                                                      11200005
&CS(3)   SETC  'C'                                                      11270005
&CS(4)   SETC  'D'                                                      11340005
&CS(5)   SETC  'E'                                                      11410005
&CS(6)   SETC  'F'                                                      11480005
&CS(7)   SETC  'G'                                                      11550005
&CS(8)   SETC  'H'                                                      11620005
&CS(9)   SETC  'I'                                                      11690005
&CS(10)  SETC  'J'                                                      11760005
&CS(11)  SETC  'K'                                                      11830005
&CS(12)  SETC  'L'                                                      11900005
&CS(13)  SETC  'M'                                                      11970005
&CS(14)  SETC  'N'                                                      12040005
&CS(15)  SETC  'O'                                                      12110005
&CS(16)  SETC  'P'                                                      12180005
&CS(17)  SETC  'Q'                                                      12250005
&CS(18)  SETC  'R'                                                      12320005
&CS(19)  SETC  'S'                                                      12390005
&CS(20)  SETC  'T'                                                      12460005
&CS(21)  SETC  'U'                                                      12530005
&CS(22)  SETC  'V'                                                      12600005
&CS(23)  SETC  'W'                                                      12670005
&CS(24)  SETC  'X'                                                      12740005
&CS(25)  SETC  'Y'                                                      12810005
&CS(26)  SETC  'Z'                                                      12880005
&CS(27)  SETC  '0'                                                      12950005
&CS(28)  SETC  '1'                                                      13020005
&CS(29)  SETC  '2'                                                      13090005
&CS(30)  SETC  '3'                                                      13160005
&CS(31)  SETC  '4'                                                      13230005
&CS(32)  SETC  '5'                                                      13300005
&CS(33)  SETC  '6'                                                      13370005
&CS(34)  SETC  '7'                                                      13440005
&CS(35)  SETC  '8'                                                      13510005
&CS(36)  SETC  '9'                                                      13580005
.*                                                                      13650005
.*       INITIALIZE 3270 POLLING/ADDRESSING CHARACTER LOOK-UP TABLE     13720005
.*                                                                      13790005
&TBL(1)  SETC  '4060202D'                                               13860005
&TBL(2)  SETC  'C161412F'                                               13930005
&TBL(3)  SETC  'C2E24253'                                               14000005
&TBL(4)  SETC  'C3E34354'                                               14070005
&TBL(5)  SETC  'C4E44455'                                               14140005
&TBL(6)  SETC  'C5E54556'                                               14210005
&TBL(7)  SETC  'C6E64657'                                               14280005
&TBL(8)  SETC  'C7E74758'                                               14350005
&TBL(9)  SETC  'C8E84859'                                               14420005
&TBL(10) SETC  'C9E9495A'                                               14490005
&TBL(11) SETC  '4A6A5B7C'                                      @OZ45570 14560082
&TBL(12) SETC  '4B6B2E2C'                                               14630005
&TBL(13) SETC  '4C6C3C25'                                               14700005
&TBL(14) SETC  '4D6D285F'                                               14770005
&TBL(15) SETC  '4E6E2B3E'                                      @OZ58371 14840082
&TBL(16) SETC  '4F6F213F'                                               14910005
&TBL(17) SETC  '50F02630'                                               14980005
&TBL(18) SETC  'D1F14A31'                                               15050005
&TBL(19) SETC  'D2F24B32'                                               15120005
&TBL(20) SETC  'D3F34C33'                                               15190005
&TBL(21) SETC  'D4F44D34'                                               15260005
&TBL(22) SETC  'D5F54E35'                                               15330005
&TBL(23) SETC  'D6F64F36'                                               15400005
&TBL(24) SETC  'D7F75037'                                               15470005
&TBL(25) SETC  'D8F85138'                                               15540005
&TBL(26) SETC  'D9F95239'                                               15610005
&TBL(27) SETC  '5A7A5D3A'                                               15680005
&TBL(28) SETC  '5B7B2423'                                               15750005
&TBL(29) SETC  '5C7C2A40'                                               15820005
&TBL(30) SETC  '5D7D2927'                                               15890005
&TBL(31) SETC  '5E7E3B3D'                                               15960005
&TBL(32) SETC  '5F7F5E22'                                               16030005
.*                                                                      16100005
.*       CHECK FOR MULTIPLE TSOMCP MACRO CALLS                          16170005
.*                                                                      16240005
         AIF   (NOT &MCPSW).SETMCP                                      16310005
         MNOTE 16,'IKJ54125I MORE THAN ONE TSOMCP MACRO CALL ISSUED'    16380005
         MEXIT                                                          16450005
.SETMCP  ANOP                                                           16520005
&MCPSW   SETB  1                   INDICATE A TSOMCP MACRO CALL ISSUED  16590005
&HALT    SETC  '&IEDHALT'                                      @Y17XAYP 16620000
.*                                                                      16660005
.*       TEST FOR LINEGRP MACRO CALL HAVING BEEN ISSUED                 16730005
.*                                                                      16800005
         AIF   (&NLG GT 0).LGISUD                                       16870005
         MNOTE 16,'IKJ54126I NO LINEGRP MACRO ISSUED BEFORE TSOMCP MACRO16940005
               O'                                                       17010005
         MEXIT                                                          17080005
.LGISUD  ANOP                                                           17150005
.*                                                                      17220005
.*       CHECK PARAMETER VALIDITY                                       17290005
.*                                                                      17360005
&OLTST   SETA  &OLTEST             NO. OF ON-LINE TEST PROCEDURES       17430005
         AIF   (&OLTST EQ 0).CHKXREF                                    17500005
         AIF   (&OLTST LE 255 AND &OLTST GE 10).CHKXREF                 17570005
         MNOTE 4,'IKJ54110I OLTEST OPERAND OUT OF RANGE, DEFAULT USED'  17640005
&OLTST   SETA  0                        SET DEFAULT                     17710005
.CHKXREF ANOP                                                           17780005
&CRSREF  SETC  '0'                 SET DEFAULT                          18270005
         AIF   ('&OPTIONS' EQ '').CKTHRSH                      @OY18934 18340082
&I       SETA  0                   INITIALIZE SUB-OPERAND SELECTOR      18410005
.OPLOOP  ANOP                                                           18480005
&I       SETA  &I+1                BUMP SUB-OPERAND SELECTOR            18550005
         AIF   (&I GT N'&OPTIONS).CKTHRSH                      @OY18934 18620082
         AIF   ('&OPTIONS(&I)' EQ 'XREF').SETCR                         18690005
         AIF   ('&OPTIONS(&I)' EQ 'PROMPT').SETPR                       18760005
         MNOTE 4,'IKJ54104I &OPTIONS(&I) INVALID FOR OPTIONS OPERAND'   18830005
         AGO   .OPLOOP             CONTINUE SCANNING                    18900005
.SETCR   ANOP                                                           18970005
&N       SETA  &ADRPT-1            SET TERMINAL COUNT          @OY16449 18980084
&M       SETA  0                   SET LOOP VARIBLE            @OY16449 18990084
.XREFLOP ANOP                      LOOP ONCE/LINE IN LAST L.G. @OY16449 19000084
&N       SETA  &N+&TRMNO(&SCRPT+&M) UPDATE TERMINAL COUNT      @OY16449 19010084
&M       SETA  &M+1                BUMP LOOP CONTROL VARIABLE  @OY16449 19020084
         AIF   (&M LT &LNO(&NLG)).XREFLOP BR IF MORE LINES     @OY16449 19030084
&CRSREF  SETC  '&N'                SET NO. OF XREF ENTRIES              19040005
         AGO   .OPLOOP             CONTINUE SCANNING                    19110005
.SETPR   ANOP                                                           19180005
&PROMPT  SETB  1                   INDICATE PROMPT REQUESTED            19250005
         AGO   .OPLOOP             CONTINUE SCANNING                    19320005
.CKTHRSH ANOP                                                  @OY18934 19323082
&TH      SETA  0                                               @OY18934 19326082
.TH1     ANOP                                                  @OY18934 19329082
&TH      SETA  &TH+1                                           @OY18934 19332082
         AIF   (T'&THRESH(&TH) NE 'N').TH2                     @OY18934 19335082
         AIF   (&THRESH(&TH) GT 0 AND &THRESH(&TH) LT 256).TH3 @OY18934 19338082
.TH2     MNOTE 4,'IKJ54110I THRESH OPERAND OUT OF RANGE, DEFAULT USED'  19341082
&THS1    SETA  255                                             @OY18934 19344082
&THS2    SETA  1                                               @OY18934 19347082
&THS3    SETA  1                                               @OY18934 19350082
&THS4    SETA  1                                               @OY18934 19353082
         AGO   .CKTR                                           @OY18934 19356082
.TH3     AIF   (&TH NE 4).TH1                                  @OY18934 19359082
&THS1    SETA  &THRESH(1)                                      @OY18934 19362082
&THS2    SETA  &THRESH(2)                                      @OY18934 19365082
&THS3    SETA  &THRESH(3)                                      @OY18934 19368082
&THS4    SETA  &THRESH(4)                                      @OY18934 19371082
.CKTR    ANOP                                                           19390005
&TRCNO   SETA  &TRACE                                                   19460005
         AIF   (&TRCNO LE 65535).CKDTR                                  19530005
         MNOTE 4,'IKJ54110I TRACE OPERAND OUT OF RANGE, DEFAULT USED'   19600005
&TRCNO   SETA  0                                                        19670005
.CKDTR   ANOP                                                           19740005
&I       SETA  1                   INITIALIZE SUB-OPERAND SEL  @OY16449 19810084
&DTRCN1  SETA  &DTRACE(&I)         SET NO. OF TRACE ENTRIES    @OY16449 19820084
         AIF   (&DTRCN1 LE 65535).CKUN                         @OY16449 19830084
         MNOTE 4,'IKJ54110I DTRACE OPERAND OUT OF RANGE, DEFAULT USED'  19840084
&DTRCN1  SETA  0                                               @OY16449 19850084
.CKUN    ANOP                                                  @OY16449 19860084
&I       SETA  2                   BUMP TO NEXT OPERAND        @OY16449 19870084
         AIF   (&I GT N'&DTRACE).ENDDT  ONLY ONE OPERAND       @OY19259 19880082
&DTRCN2  SETC  '(&DTRCN1,&DTRACE(&I))'  SET DTRACE OPERAND     @OY19259 19900082
         AGO   .CKUNSIZ                                        @OY19259 19920082
.ENDDT   ANOP                                                  @OY19259 19940082
&DTRCN2  SETC  '&DTRCN1'                SET DTRACE OPERAND     @OY19259 19960082
.CKUNSIZ ANOP                                                  @OY19259 19980082
&UNSIZ   SETA  &UNITSIZ                                                 20036005
         AIF   (&UNSIZ LT 41).BADUNS                                    20044005
         AIF   (&T3705 EQ 1 AND &UNSIZ LT 44).BADUNS             Y06327 20052005
         AIF   (&UNSIZ LE 255).CKLN                              Y06327 20060005
.BADUNS  MNOTE 4,'IKJ54110I UNITSIZ OPERAND OUT OF RANGE,DEFAULT USED'  20068082
&UNSIZ   SETA  60                  SET DEFAULT BASIC UNIT SIZE          20076005
.CKLN    AIF   ('&LNUNITS' EQ '').LNUDEF  CHK IF DEFAULT WANTED@Y17XAYP 20160000
&LNUNNO  SETA  &LNUNITS                                                 20230005
         AIF   (&LNUNNO GT 65535).BADLNU                                20300005
         AIF   (&LNUNNO GT 0).GOTEST                             Y06327 20370005
.BADLNU  MNOTE 4,'IKJ54110I LNUNITS OPERAND OUT OF RANGE,DEFAULT USED'  20440082
.LNUDEF  AIF   (&QUITSW).GOTEST    IF QUITSW SET, BYPASS         Y06327 20480000
.*                                                                      20510005
.*       THE FOLLOWING ROUTINE COMPUTES THE DEFAULT VALUE FOR LNUNITS   20580005
.*       USING THE PARAMETERS SUPPLIED IN PREVIOUS LINEGRP MACRO CALLS  20650005
.*                                                                      20720005
&I       SETA  1                   SET LOOP INDEX                       20860005
&LNUNNO  SETA  0                                                        20930005
&LNEPT   SETA  1                   INITIALIZE LINE ARRAY POINTER Y06327 20950005
&SCRPT   SETA  1                   INITIALIZE SCREEN ARRAY PTR @Y17XAYP 20970000
&SCSPT   SETA  1                                               @OY20834 21020082
.LNULOOP AIF   (&I GT &NLG).TRUNC  BR IF ALL LINE GROUPS       @Y17XAYP 21070000
&K       SETA  20                  ASSUME 2 BUFFERS/TERMINAL            21140005
&ADDON   SETA  0                   ADDON VALUE INITIALIZED       Y06327 21210005
&N       SETA  0                   INITIALIZE TERMINAL COUNT     Y06327 21240005
         AIF   ('&T(&I)' EQ 'PUNT').M25 2.5 MULTIPLIER         @Y17XAYP 21260000
         AIF   ('&T(&I)'(1,3) EQ '327').M25                    @Y17XAYP 21280000
         AIF   ('&T(&I)'(1,3) NE '226').LNULOP2                         21350005
.M25     ANOP                                                  @Y17XAYP 21420000
&K       SETA  25                  ASSUME 2.5 BFRS/TERM FOR 2260/65     21490005
.*                                 AND FOR 3270                         21560005
.LNULOP2 ANOP                                                           21630005
.*                                                                      21632005
.*       THE FOLLOWING ROUTINE COMPUTES AN ADDON VALUE PER LINE, TO     21634005
.*       LNUNITS, FOR 3270 DISPLAY TERMINALS. THIS SHOULD PROVIDE       21636005
.*       SUFFICIENT LNUNITS FOR FULL SCREEN OPERATIONS.                 21638005
.*                                                                      21640005
&DISPLAY SETA  1                                                 Y06327 21650005
&Q       SETA  0                   LUNO COUNTER                @Y17XAYP 21651000
&L       SETA  0                   LU COUNT                    @Y17XAYP 21652000
&E       SETA  0                   LUNO ENTRY SELECTOR         @Y17XAYP 21652300
&J       SETA  0                   TERMNO SELECTOR             @Y17XAYP 21652600
.TRMLOOP ANOP                                                  @Y17XAYP 21652900
&M       SETA  &TRMNO(&SCRPT+&E+&J) GET TERMNO VALUE           @Y17XAYP 21653200
         AIF   ('&T(&I)' EQ 'PUNT').CKSCR                      @Y17XAYP 21653500
         AIF   ('&T(&I)'(1,3) NE '327').LNUA BR NOT 3270         Y06327 21662005
.CKSCR   AIF   (((&SCRH(&SCSPT+&L))*(&SCRW(&SCSPT+&L))) LE &DISPLAY).LNX21664082
               UA                                              @OY20834 21665082
&DISPLAY SETA  &SCRH(&SCSPT+&L)*&SCRW(&SCSPT+&L) LARGEST SCREEN@OY20834 21666082
.LNUA    ANOP                                                    Y06327 21668082
&L       SETA  &L+1                COUNT LU ENTRY              @Y17XAYP 21668282
         AIF   (&L LT &TRMNO(&SCRPT+&E+&J+1)).CKSCR            @Y17XAYP 21668482
.*                                 MORE LU ENTRIES/LUNO        @Y17XAYP 21668682
&L       SETA  0                   CLEAR LU ENTRY COUNT        @Y17XAYP 21668882
&E       SETA  &E+1                INCREMENT LUNO SELECTOR     @Y17XAYP 21669082
&Q       SETA  &Q+1                INCREMENT LUNO COUNTER      @Y17XAYP 21669282
&N       SETA  &N+1                CUMULATIVE LUCOUNT          @Y17XAYP 21669482
         AIF   (&Q LT &M).CKSCR    MORE LUNO ENTRIES/TERMNO    @Y17XAYP 21669682
&J       SETA  &J+1                INCREMENT TERMNO SELECTOR   @Y17XAYP 21670800
&Q       SETA  0                   ZERO LUNO COUNTER           @Y17XAYP 21670900
         AIF   (&J LT &LNO(&I)).TRMLOOP    MORE TERMNO/LINEGRP @Y17XAYP 21671000
&SCSPT   SETA  &SCSPT+&J                SET ARRAY PTR          @OY21130 21671182
&SCRPT   SETA  &SCRPT+&E+&J                                    @OY20834 21672182
         AIF   ('&T(&I)' EQ 'PUNT').ADIT USE ADDON VALUE       @OY20834 21673182
         AIF   ('&T(&I)'(1,3) NE '327').LNULOP3 BR NOT 3270    @Y17XAYP 21676000
.ADIT    ANOP                                                  @Y17XAYP 21677000
&ADDON   SETA  &ADDON+((&DISPLAY+48)*10)/(&UNSIZ*&UNO(&I))       Y06327 21678005
.*                                 48 = PREFIX(MIN 41,44) + DBLWD ALIGN 21680005
.LNULOP3 ANOP                                                    Y06327 21692005
&LNUNNO  SETA  &LNUNNO+&ADDON*&J+&K*&N*&UNO(&I)                @OY21130 21700082
&I       SETA  &I+1                                                     21770005
         AGO   .LNULOOP                                                 21840005
.TRUNC   ANOP                                                           21910005
&LNUNNO  SETA  (&LNUNNO+5)/10      ROUND & TRUNCATE                     21980005
.GOTEST  ANOP                                                           22540005
.*                                                                      22610005
.*       TEST FOR SERIOUS ERRORS IN PREVIOUS MACROS                     22680005
.*                                                                      22750005
.TSTQUIT AIF   (NOT &QUITSW).INTRO                                      22820005
         MNOTE 16,'IKJ54127I SERIOUS ERROR IN PREVIOUS MACRO CALL PREVEN22890005
               NTS FURTHER GENERATION'                                  22960005
         MEXIT                                                          23030005
.*                                                                      23100005
.*********************************************************************  23170005
.*       INTRO                                                          23240005
.*********************************************************************  23310005
.*                                                                      23380005
.INTRO   AIF   ('&NAM' EQ '').NERR      NAME REQUIRED          @Y17XAYP 23520000
         AIF   (K'&NAM GT 8 OR N'&NAM GT 1).NERR  NAME VALID     Y06327 23590005
&I       SETA  1                   CHARACTER COUNTER             Y06327 23660005
&J       SETA  K'&NAM              LENGTH OF NAME                Y06327 23730005
.NAMEOK  AIF   ('&NAM'(&I,1) EQ '$' OR '&NAM'(&I,1) EQ '#'             X23870000
               OR '&NAM'(&I,1) EQ '@').OKNME                   @Y17XAYP 23940000
         AIF   ('&NAM'(&I,1) GE 'A' AND '&NAM'(&I,1) LE 'Z').OKNME      24010005
         AIF   ('&NAM'(&I,1) GE '0' AND '&NAM'(&I,1) LE '9'            X24080005
               AND &I NE 1).OKNME                                Y06327 24150005
.NERR    MNOTE 16,'IKJ54104I &NAM INVALID FOR NAME OPERAND'      Y06327 24290000
         MEXIT                                                   Y06327 24360005
.OKNME   ANOP                                                    Y06327 24430005
&I       SETA  &I+1                UPDATE CHARACTER COUNTER      Y06327 24500005
         AIF   (&I GT 8 OR '&I' GT '&J').INTR1                   Y06327 24570005
         AGO   .NAMEOK                                           Y06327 24640005
.INTR1   ANOP                                                    Y06327 24710005
&FEATURE SETC  'MIXD'              270X/3705 MCP                 Y06327 24780005
&BRACK   SETC  'YES'                    BRACKET OPTION         @OY19258 24810082
         AIF   (&T3705 EQ 1 AND &T270X EQ 1).INTRO1 BOTH         Y06327 24850005
&FEATURE SETC  'ONLY'              3705 MCP                      Y06327 24920005
         AIF   (&T270X NE 1 AND &T3705 EQ 1).INTRO1 3705 ONLY    Y06327 24990005
&FEATURE SETC  'NO'                270X MCP                      Y06327 25060005
&BRACK   SETC  'NO'                     BRACKET OPTION         @OY19258 25090082
         AGO   .PLCB               BYPASS IF NOT 3705            Y06327 25130005
.*                                                                      25270005
.********************************************************************** 25340005
.*       IPLTXID= KEYWORD ANALYSIS                                      25410005
.********************************************************************** 25480005
.*                                                                      25550005
.INTRO1  AIF   ('&AUTOIPL' EQ '').AUTOI AUTOIPL DEFAULT        @Y17XAYP 25620000
         AIF   (N'&AUTOIPL EQ &RNNUMB).AUTOI SUBLIST VALID       Y06327 25690005
         MNOTE 16,'IKJ54104I &AUTOIPL INVALID FOR AUTOIPL OPERAND'      25760005
&QUITSW  SETB  1                   SET QUIT SWITCH               Y06327 25830005
.AUTOI   AIF   ('&IPLTXID' EQ '').DMP   BYPASS IF NOT CODED    @Y17XAYP 25970000
         AIF   (N'&IPLTXID EQ &RNNUMB).IPL CORRECT NUMBER OF IPL Y06327 26040005
         AGO   .IPLBD              NO. EXIT                      Y06327 26110005
.IPL     ANOP                                                    Y06327 26180005
&K       SETA  1                   OUTER LOOP COUNTER            Y06327 26250005
.IPLGO   ANOP                                                    Y06327 26320005
&I       SETA  1                   CHARACTER COUNTER             Y06327 26390005
&J       SETA  K'&IPLTXID(&K)      LENGTH OF SUBOPERAND          Y06327 26460005
         AIF   (&J EQ 0).IPLSUB    SKIP OMITTED SUBOPERANDS      Y06327 26530005
         AIF   (&J GT 7).IPLBD     SUBOPERAND LENGTH MAX 7       Y06327 26600005
&IPL     SETC  '&IPLTXID(&K)'      GET PROPER SUBOPERAND         Y06327 26670005
.OKI     AIF   ('&IPL'(&I,1) EQ '$' OR '&IPL'(&I,1) EQ '#'             X26810000
               OR '&IPL'(&I,1) EQ '@').OKIPL                   @Y17XAYP 26880000
         AIF   ('&IPL'(&I,1) GE 'A' AND '&IPL'(&I,1) LE 'Z').OKIPL      26950005
.*                                                               Y06327 27020005
         AIF   ('&IPL'(&I,1) GE '0' AND '&IPL'(&I,1) LE '9' AND &I     X27090005
               NE 1).OKIPL                                       Y06327 27160005
.IPLBD   MNOTE 16,'IKJ54104I &IPLTXID INVALID FOR IPLTXID OPERAND'      27300000
&QUITSW  SETB  1                                                 Y06327 27370005
         AGO   .DMP                                              Y06327 27440005
.OKIPL   ANOP                                                    Y06327 27510005
&I       SETA  &I+1                SET FOR NEXT CHARACTER        Y06327 27580005
         AIF   (&I GT 7 OR '&I' GT '&J').IPLSUB                  Y06327 27650005
         AGO   .OKI                                              Y06327 27720005
.IPLSUB  ANOP                                                    Y06327 27790005
&K       SETA  &K+1                UPDATE OUTER LOOP COUNTER     Y06327 27860005
         AIF   ('&K' GT '&RNNUMB').DMP                           Y06327 27930005
         AGO   .IPLGO                                            Y06327 28000005
.*                                                                      28070005
.********************************************************************** 28140005
.*       DMPNAME= KEYWORD ANALYSIS                                      28210005
.********************************************************************** 28280005
.*                                                                      28350005
.DMP     AIF   ('&AUTODMP' EQ '').AUTOD AUTODMP DEFAULT        @Y17XAYP 28490000
         AIF   (N'&AUTODMP EQ &RNNUMB).AUTOD SUBLIST VALID       Y06327 28560005
         MNOTE 16,'IKJ54104I &AUTODMP INVALID FOR AUTODMP OPERAND'      28630005
&QUITSW  SETB  1                   SET QUIT SWITCH               Y06327 28700005
.AUTOD   AIF   ('&DMPNAME' EQ '').PLCB  BYPASS IF NOT CODED    @Y17XAYP 28840000
         AIF   (N'&DMPNAME EQ &RNNUMB).DMP1 CORRECT NUMBER OF OP Y06327 28910005
         AGO   .DMPBD              NO. EXIT                      Y06327 28980005
.DMP1    ANOP                                                    Y06327 29050005
&K       SETA  1                   OUTER LOOP CONTROL            Y06327 29120005
.DMPGO   ANOP                                                    Y06327 29190005
&I       SETA  1                   CHARACTER COUNTER             Y06327 29260005
&J       SETA  K'&DMPNAME(&K)      LENGTH OF SUBOPERAND          Y06327 29330005
         AIF   (&J EQ 0).DMPSUB    SKIP OMITTED SUBOPERAND       Y06327 29400005
         AIF   (&J GT 8).DMPBD     MAX SUBOPERAND LENGTH 8       Y06327 29470005
&DMP     SETC  '&DMPNAME(&K)'      GET PROPER SUBOPERAND         Y06327 29540005
.OKD     AIF   ('&DMP'(&I,1) EQ '$' OR '&DMP'(&I,1) EQ '#'             X29680000
               OR '&DMP'(&I,1) EQ '@').OK                      @Y17XAYP 29750000
         AIF   ('&DMP'(&I,1) GE 'A' AND '&DMP'(&I,1) LE 'Z').OK  Y06327 29820005
         AIF   ('&DMP'(&I,1) GE '0' AND '&DMP'(&I,1) LE '9'            X29890005
               AND &I NE 1).OK                                   Y06327 29960005
.DMPBD   MNOTE 16,'IKJ54104I &DMPNAME INVALID FOR DMPNAME OPERAND'      30100000
&QUITSW  SETB  1                                                 Y06327 30170005
         AGO   .PLCB                                             Y06327 30240005
.OK      ANOP                                                    Y06327 30310005
&I       SETA  &I+1                                              Y06327 30380005
         AIF   (&I GT 8 OR '&I' GT '&J').DMPSUB                  Y06327 30450005
         AGO   .OKD                                              Y06327 30520005
.DMPSUB  ANOP                                                    Y06327 30590005
&K       SETA  &K+1                                              Y06327 30660005
         AIF   ('&K' GT '&RNNUMB').PLCB                          Y06327 30730005
         AGO   .DMPGO                                            Y06327 30800005
.********************************************************************** 30870005
.*       PLCBNO= AND BTRACE= KEYWORDS ANALYSIS                          30940005
.********************************************************************** 31010005
.*                                                                      31080005
.PLCB    AIF   (NOT &QUITSW).PLCBGO                            @Y17XAYP 31220000
         MEXIT                                                   Y06327 31290005
.PLCBGO  ANOP                                                    Y06327 31360005
 PUNCH '&NAM CSECT'                                                     31430005
&TYP     SETC  'TSO'               ASSUME NO SNA RESOURCE      @Y17XAYP 31440000
.TSO     ANOP                                                  @Y17XAYP 31470000
 PUNCH '         INTRO ENVIRON=&TYP,KEYLEN=&UNSIZ,LNUNITS=&LNUNNO,CIB=2X31500082
               ,  .................'                           @OY19429 31520082
 PUNCH '               ABEFMT=(SIB,RVT,DCT,LGB,DCB,DEB,SCB,PLCB,LCB,   X31580000
                  .........'                                            31590000
 PUNCH '               QCB,OPT,TTE),                           @OY16449X31600084
                  ..........'                                  @OY16449 31620084
         AIF   (NOT &T3705).NO3705      BYPASS IF NO 3705        Y06327 31640005
         AIF   ('&PLCBNO' EQ '').PLCBDEF DEFAULT IF NOT CODED    Y06327 31710005
&PLCB    SETA  &PLCBNO             GET NUMBER OF PLCB'S          Y06327 31780005
         AIF   ('&PLCB' GE '&RNLINES').PLCBOK                  @OY20431 31850082
&TOTERMS SETA  &RNTERMS+&LUTERMS   3705 TERMINAL/LU TOTAL      @OY20431 31900082
         AIF   ('&PLCB' LE '&TOTERMS').PLCBOK                  @OY20431 31950082
.PLCB2   MNOTE 4,'IKJ60003I PLCBNO MUST BE GE NUMBER OF 3705 LINES OR LX32200000
               E NUMBER OF 3705 TERMINALS -- DEFAULT VALUE USED' Y06327 32270005
.*                                                               Y06327 32340005
.PLCBDEF ANOP                                                    Y06327 32410005
&PLCB    SETA  &RNLINES            DEFAULT PLCBNO                Y06327 32480005
.PLCBOK  AIF   ('&BTRACE' NE '' AND '&TTRACE' NE '').UBTRCE    @ZM46739 32480310
         AIF   ('&BTRACE' EQ '' AND '&TTRACE' EQ '').USEDEF    @ZM46739 32480610
         AIF   ('&BTRACE' EQ '').UTTRCE IF NO BTRACE USE TTRACE@ZM46739 32480910
.UBTRCE  ANOP                                                  @ZM46739 32481210
&BTRCNO  SETA  &BTRACE                  SET VALUE              @ZM46739 32481510
         AIF   (&BTRCNO LE 65535).TBTU  VALUE WITHIN RANGE     @ZM46739 32490010
         MNOTE 4,'IKJ54110I BTRACE OPERAND OUT OF RANGE, DEFAULT USED'  32490310
         AGO   .USEDEF                                         @ZM46739 32490610
.UTTRCE  ANOP                                                  @ZM46739 32490910
&BTRCNO  SETA  &TTRACE                  SET VALUE              @ZM46739 32491210
         AIF   (&BTRCNO LE 65535).TBTU  VALUE WITHIN RANGE     @ZM46739 32491510
         MNOTE 4,'IKJ54110I TTRACE OPERAND OUT OF RANGE, DEFAULT USED'  32491810
.*                                                             @ZM46739 32492110
.USEDEF  ANOP                                                  @ZM46739 32492410
&BTRCNO  SETA  0                        SET FOR DEFAULT        @ZM46739 32492710
.TBTU    ANOP                                                    Y06327 32970005
 PUNCH '               FEATURE=(,,,,&FEATURE.3705),BTRACE=&BTRCNO,PLCBNX33040005
               O=&PLCB, ...............'                         Y06327 33110005
         AGO   .GO3705                                           Y06327 33180005
.NO3705  ANOP                                                    Y06327 33250005
 PUNCH '               FEATURE=(,,,,NO3705),                           X33320005
                    ......'                                      Y06327 33390005
.GO3705  ANOP                                                    Y06327 33460005
 PUNCH '               BRACKET=&BRACK,                                 X33480082
               ................'                               @OY19258 33500082
&X       SETC  'STSP'              ASSUME START/STOP LINE               33530005
         AIF   (NOT &BISYNC).LINE2                                      33600005
&X       SETC  'BOTH'              SET LINETYPE TO BOTH FOR BISYNC LINE 33670005
.LINE2   ANOP                                                           33740005
 PUNCH '               CROSSRF=&CRSREF,TRACE=&TRCNO,LINETYP=&X,        -33810005
                        .........'                             @OZ16602 33880000
         AIF   (NOT &T3705).LINE3 SKIP NCP OPERANDS            @Y17XAYP 33883000
         AIF   (T'&SIBCNT NE 'N').BADSIB  VALID SIB SOUNT      @Y17XAYP 33886000
         AIF   (&SIBCNT LT 0 OR &SIBCNT GT 65535).BADSIB       @Y17XAYP 33889000
&SIBCT   SETA  &SIBCNT             SET SIB COUNT               @Y17XAYP 33892000
         AGO   .CKSAL              CK VALID SUBAREA LENGTH     @Y17XAYP 33895000
.BADSIB  ANOP                                                  @Y17XAYP 33898000
&SIBCT   SETA  0                   SET DEFAULT SIB COUNT       @Y17XAYP 33901000
         MNOTE 4,'IKJ54110I SIBCNT OPERAND OUT OF RANGE, DEFAULT USED'  33904000
.CKSAL   AIF   (T'&MAXSUBA NE 'N').BADSAL VALID SUBAREA LEN    @Y17XAYP 33907000
&MAXSA   SETA  &MAXSUBA            SET MAX SUBAREA VALUE       @YM08080 33910000
         AGO   .CKSA               CHECK SUBAREA VALUE         @Y17XAYP 33913000
.BADSAL  MNOTE 4,'IKJ54110I MAXSUBA OPERAND OUT OF RANGE,DEFAULT USED'  33916000
&MAXSA   SETA  0                   SET DEFAULT MAXSUBAREA      @Y17XAYP 33919000
.CKSA    AIF   (T'&SUBAREA NE 'N').BADSA  VALID SUBAREA        @Y17XAYP 33922000
&SUBA    SETA  &SUBAREA            SET SUBAREA VALUE           @Y17XAYP 33925000
         AGO .LINE2A                                           @Y17XAYP 33928000
.BADSA   MNOTE 4,'IKJ54110I SUBAREA OPERAND OUT OF RANGE, DEFAULT USED' 33931000
&SUBA    SETA  0                   SET DEFAULT SUBAREA         @Y17XAYP 33934000
.LINE2A  ANOP                                                  @Y17XAYP 33935000
 PUNCH '               SIBCNT=&SIBCT,SUBAREA=&SUBA,MAXSUBA=&MAXSA,     X33936000
                            .............'                     @Y17XAYP 33937000
.LINE3   ANOP                                                  @OY18934 34020082
&D       SETC  '....'                                          @OY18934 34040082
&L       SETA  K'&DTRACE+K'&OLTEST+K'&NAM                      @OY18934 34060082
         AIF   (&L LT 9).SET6                                  @OY18934 34080082
         AIF   (&L LT 16).PCHIT                                @OY18934 34100082
&D       SETC  '..'                                            @OY18934 34120082
         AGO   .PCHIT                                          @OY18934 34140082
.SET6    ANOP                                                  @OY18934 34160082
&D       SETC  '......'                                        @OY18934 34180082
.PCHIT   ANOP                                                  @OY18934 34200082
 PUNCH '               DTRACE=&DTRCN2,OLTEST=&OLTST,PROGID=&NAM,       X34220082
                 &D&D&D&D'                                     @OY18934 34240082
         AIF   (NOT &PROMPT).NOPRMPT                           @OY18934 34260082
 PUNCH '               THRESH=(&THS1,&THS2,&THS3,&THS4)'       @OY18934 34280082
         AGO   .OPEN                                           @OY18934 34300082
.NOPRMPT ANOP                                                  @OY18934 34320082
 PUNCH '               STARTUP=C,THRESH=(&THS1,&THS2,&THS3,&THS4)'      34340082
.OPEN    ANOP                                                           34440005
 PUNCH '         LTR   15,15'                                           34510005
 PUNCH '         BNZ   IEDAYBYE'    INTRO FAILED               @OZ16520 34580000
.*                                                                      34650005
.*********************************************************************  34720005
.*       OPEN'S                                                         34790005
.*********************************************************************  34860005
.*                                                                      34930005
 PUNCH '         LA    3,DCBL1'                                         35000005
 PUNCH '         LA    4,DCBL2-DCBL1'                                   35070005
 PUNCH '         LA    5,DCBLAST'                                       35140005
 PUNCH 'OPENLOOP LR    1,3'                                             35280005
 PUNCH '         OPEN  MF=(E,(1))'                                      35350005
 PUNCH '         USING IHADCB,6'                                        35420005
 PUNCH '         L     6,0(,3)'                                         35490005
 PUNCH '         TM    DCBOFLGS,X''10'''                                35560005
 PUNCH '         BO    OPENNEXT'                               @OZ50273 35630082
         AIF   ('&DMPNAME' EQ '').NOOPD  NO DUMP DATASET TO OPEN Y06327 35700005
 PUNCH '         TM    DCBDSORG,X''40'''                                35770005
 PUNCH '         BO    OPNDMP'                                          35840005
.NOOPD   ANOP                                                    Y06327 35910005
 PUNCH '         MVC   OPENWTO+34(8),DCBDDNAM'                          35980005
 PUNCH 'OPENWTO  WTO   ''IKJ403I LINE GROUP FOR DD          NOT OPENED'-36050005
               ',DESC=6, -'                                             36120005
 PUNCH '               ROUTCDE=2'                                       36190005
 PUNCH '         B     OPENNEXT'                                 YM2220 36260005
         AIF   ('&DMPNAME' EQ '').NOOPD1 NO DUMPDATASET TO OPEN  Y06327 36330005
 PUNCH 'OPNDMP   MVC   OPENWTR+17(8),DCBDDNAM'                          36400005
 PUNCH 'OPENWTR  WTO   ''IED183I          DUMP DCB SPECIFICATION ERROR'X36470005
               ',DESC=6, -'                                             36540005
 PUNCH '               ROUTCDE=2'                                       36610005
 PUNCH '         B     OPENNEXT'                                 YM2220 36680005
.NOOPD1  ANOP                                                    Y06327 36750005
 PUNCH 'OPENNEXT BXLE  3,4,OPENLOOP'                             YM2220 36890005
 PUNCH '         DROP  6'                                               36960005
 PUNCH '         B     OPENDONE'                                        37030005
&FLG     SETB  0                   CLEAR FLAG                    Y06327 37100005
 PUNCH 'DCBL1    DS    0F'                                              37170005
.OPDCB   ANOP                                                    Y06327 38150005
&I       SETA  1                                                        38220005
.OPNLOOP AIF   (&I EQ &DDCT).OPNLAST                           @Y17XAYP 38360000
 PUNCH '         OPEN  (DCB&I,(INOUT)),MF=L'                            38430005
         AGO   .OPLTST                                                  38500005
.OPNLAST ANOP                                                           38570005
 PUNCH 'DCBLAST  OPEN  (DCB&I,(INOUT)),MF=L'                            38640005
.OPLTST  AIF   (&I NE 1).OPLTST2                               @Y17XAYP 38780000
 PUNCH 'DCBL2    EQU   *'                                               38920005
.OPLTST2 ANOP                                                           38990005
&I       SETA  &I+1                                                     39060005
         AIF   (&I LE &DDCT).OPNLOOP                             Y06327 39130005
 PUNCH 'OPENDONE DS    0H'                                              39200005
.*                                                                      39410005
.*********************************************************************  39480005
.*       READY                                                          39550005
.*********************************************************************  39620005
.*                                                                      39690005
 PUNCH '         READY'                                                 39760005
.*                                                                      39830005
.*********************************************************************  39900005
.*       CLOSE'S                                                        39970005
.*********************************************************************  40040005
.*                                                                      40110005
&I       SETA  1                                                        40180005
         AIF   ('&DMPNAME' EQ '').CLSLOOP BYPASS IF NO DUMP      Y06327 40250005
&RN      SETA  1                   INITIALIZE DCB COUNTER        Y06327 40320005
.CLSDMP  ANOP                                                    Y06327 40390005
&RN      SETA  &RN+1               UPDATE DCB POINTER            Y06327 40670005
         AIF   ('&RN' GT '&RNNUMB').CLSLOOP                      Y06327 40740005
         AGO   .CLSDMP                                           Y06327 40810005
.CLSLOOP ANOP                                                           40880005
 PUNCH '         CLOSE (DCB&I)'                                         40950005
&I       SETA  &I+1                                                     41020005
         AIF   (&I LE &DDCT).CLSLOOP                             Y06327 41090005
.*                                                                      41160005
.*********************************************************************  41230005
.*       RETURN                                                         41300005
.*********************************************************************  41370005
.*                                                                      41440005
 PUNCH 'IEDAYBYE L     13,4(,13)'                                       41510005
 PUNCH '         RETURN (14,12)'                                        41580005
.********************************************************************** 41583000
.*             NCP DCB AND NCP DUMP DCB                                 41586000
.********************************************************************** 41589000
&I       SETA  1                   LINEGRP LOOP CONTROL        @Y17XAYP 41592000
&RN      SETA  0                   SET DCB COUNTER             @Y17XAYP 41595000
.NCPDCB4 AIF   ('&GRPNAME(&I)' EQ '').NCPDCB1  NCP GROUP       @Y17XAYP 41598000
         AIF   (&I EQ 1).NCPDCB2   FIRST DCB                   @Y17XAYP 41601000
         AIF   ('&DDNME(&I)' EQ '&DDNME(&I-1)').ILOOP          @Y17XAYP 41604000
.*                                 SMAE NCP                    @Y17XAYP 41607000
.NCPDCB2 ANOP                                                  @Y17XAYP 41610000
&RN      SETA  &RN+1               INCREMENT DCB COUNTER       @Y17XAYP 41613000
 PUNCH 'DCB&RN   DCB   DSORG=TR,MACRF=(G,P),DDNAME=&DDNME(&I)' @Y17XAYP 41616000
         AIF   ('&DMPNAME(&RN)' EQ '').ILOOP                   @Y17XAYP 41619000
 PUNCH 'DCBD&RN  DCB   DSORG=PS,MACRF=(WP),BLKSIZE=512,RECFM=F,LRECL=51X41622000
               2,  ........'                                   @Y17XAYP 41625000
 PUNCH '               DDNAME=&DMPNAME(&RN)'                   @Y17XAYP 41628000
         AGO   .ILOOP              CK MORE LINEGRPS            @Y17XAYP 41631000
.NCPDCB1 ANOP                                                  @Y17XAYP 41634000
&RN      SETA  &RN+1               INCREMENT DCB COUNT         @Y17XAYP 41637000
.ILOOP   ANOP                                                  @Y17XAYP 41640000
&I       SETA  &I+1                INCREMENT LINEGRP COUNTER   @Y17XAYP 41643000
         AIF   (&I LE &NLG).NCPDCB4                            @Y17XAYP 41646000
.*                                                                      41650005
.*********************************************************************  41720005
.*       TTABLE                                                         41790005
.*********************************************************************  41860005
.*                                                                      41930005
 PUNCH '         TTABLE LAST=TLAST,MAXLEN=8'                            42000005
.*                                                                      42070005
.*********************************************************************  42140005
.*       OPTION                                                         42210005
.*********************************************************************  42280005
.*                                                                      42350005
         AIF   (NOT &FSCR).NOFS    IF FULLSCR REQUESTED                 42420005
 PUNCH 'IEDQFSCR OPTION XL1'            FULLSCR OPTION FIELD            42490000
.NOFS    ANOP                                                           42560005
 PUNCH 'IEDQCAN  OPTION A'              TRANS TABLE OPTION     @YA07414 42630000
         AIF   (NOT &SNA).SKPMODE    ANY SNA RESOURCES         @YM08503 42631000
 PUNCH 'IEDLMODE OPTION CL8'            BIND IMAGE OPTION FLD  @YM08503 42632000
.SKPMODE ANOP                                                  @YM08503 42633000
.********************************************************************** 42635000
.*             NCP TERMINAL AND SSCP TERMINAL                           42640000
.********************************************************************** 42645000
&I       SETA  1                   SET LINEGRP LOOP CONTROL    @Y17XAYP 42650000
&RN      SETA  0                   SET DCB COUNTER             @Y17XAYP 42655000
.NCPTRM1 AIF   ('&GRPNAME(&I)' EQ '').NCPTRM4   NOT NCP GROUP  @Y17XAYP 42660000
         AIF   (&I EQ 1).NCPTRM2 FIRST GROUP BYPASS DDNAME CK  @Y17XAYP 42665000
         AIF   ('&DDNME(&I)' EQ '&DDNME(&I-1)').DB12           @Y17XAYP 42670000
.NCPTRM2 ANOP                                                  @Y17XAYP 42675000
&RN      SETA  &RN+1               INCREMENT DCB COUNTER       @Y17XAYP 42680000
.NCPTRM3 AIF   ('&AUTOIPL(&RN)' EQ '').NOI AUTOIPL SUBLIST     @Y17XAYP 42685000
         AIF   ('&AUTOIPL(&RN)' EQ 'YES' OR                            X59640005
               '&AUTOIPL(&RN)' EQ 'NO').I1 OPERANDS VALID      @Y17XAYP 59710000
         MNOTE 4,'IKJ60004I AUTOIPL SUBLIST OPERAND &AUTOIPL(&RN) INCORX59780005
               RECT -- IGNORED'                                @Y17XAYP 59850000
.NOI     ANOP                                                  @Y17XAYP 59920000
&AUTOI   SETC  'NO'                DEFAULT TO NO AUTOIPL       @Y17XAYP 59990000
         AGO   .I2                                             @Y17XAYP 60060000
.I1      ANOP                                                  @Y17XAYP 60130000
&AUTOI   SETC  '&AUTOIPL(&RN)'                                 @Y17XAYP 60200000
.I2      AIF   ('&AUTODMP(&RN)' EQ '').NOD AUTODMP SUBLIST     @Y17XAYP 60340000
         AIF   ('&AUTODMP(&RN)' EQ 'YES' OR                            X60410005
               '&AUTODMP(&RN)' EQ 'NO').D1 OPERANDS VALID      @Y17XAYP 60480000
         MNOTE 4,'IKJ60004I AUTODMP SUBLIST OPERAND &AUTODMP(&RN) INCORX60550005
               RECT -- IGNORED'                                @Y17XAYP 60620000
.NOD     ANOP                                                  @Y17XAYP 60690000
&AUTOD   SETC  'NO'                DEFAULT TO NO AUTODMP       @Y17XAYP 60760000
         AGO   .D2                                             @Y17XAYP 60830000
.D1      ANOP                                                  @Y17XAYP 60900000
&AUTOD   SETC  '&AUTODMP(&RN)'                                 @Y17XAYP 60970000
.D2      ANOP                                                  @Y17XAYP 61040000
&C       SETC  ','                 ASSUME DCB CONTINUATION     @Y17XAYP 61110000
&D       SETC  '.'                                             @Y17XAYP 61180000
         AIF   ('&DMPNAME(&RN)' NE '' OR '&IPLTXID(&RN)' NE '' OR      X61250005
               '&AUTOIPL(&RN)' NE '').DB6                      @Y17XAYP 61320000
&C       SETC  ' '                 NO CONTINUATION             @Y17XAYP 61350000
&D       SETC  ' '                                             @Y17XAYP 61380000
.DB6     ANOP                                                  @Y17XAYP 61410000
 PUNCH 'NCP&RN    TERMINAL TERM=LNCP,DCB=DCB&RN&C              @ZM46739X61440010
                       &D&D&D&D&D&D&D&D&D&D'                   @ZM46739 61440310
.*PUNCH'               FMPROF=&NFM(&I),TSPROF=&NTS(&I)&C       @ZM46739 61440610
.*                               &D&D&D&D&D&D&D&D&D&D'         @ZM46739 61440910
&C       SETC  ' '                 ASSUME NO                   @Y17XAYP 61500000
&D       SETC  ' '                 CONTINUATION                @Y17XAYP 61530000
         AIF   ('&IPLTXID(&RN)' EQ '').DB10                    @Y17XAYP 61880000
         AIF   ('&AUTOIPL(&RN)' EQ '' AND '&DMPNAME(&RN)' EQ '').DB11   61950005
&C       SETC  ','                 ASSUME                      @Y17XAYP 62020000
&D       SETC  '.'                 CONTINUATION                @Y17XAYP 62090000
.DB11    ANOP                                                  @Y17XAYP 62160000
 PUNCH '               IPLTXID=&IPLTXID(&RN)&C                         X62230005
                             &D&D&D&D&D&D&D&D'                 @Y17XAYP 62300000
&C       SETC  ' '                 ASSUME NO                   @Y17XAYP 62370000
&D       SETC  ' '                 CONTINUATION                @Y17XAYP 62440000
.DB10    ANOP                                                  @Y17XAYP 62510000
         AIF   ('&AUTOIPL(&RN)' EQ '').DB14                    @OY18058 62580084
         AIF   ('&DMPNAME(&RN)' EQ '').DB13                    @Y17XAYP 62650000
&C       SETC  ','                 ASSUME                      @Y17XAYP 62720000
&D       SETC  '.'                 CONTINUATION                @Y17XAYP 62790000
.DB13    ANOP                                                  @Y17XAYP 62860000
 PUNCH '               IPLAUTO=&AUTOI&C                                X62930005
                          &D&D&D'                              @Y17XAYP 63000000
.DB14    ANOP                                                  @OY18058 63005084
         AIF   ('&DMPNAME(&RN)' EQ '').DB12                    @Y17XAYP 63010000
 PUNCH '               DUMPDCB=DCBD&RN,DMPAUTO=&AUTOD'         @Y17XAYP 63020000
         AGO   .DB12                                           @Y17XAYP 63030000
.NCPTRM4 ANOP                                                  @Y17XAYP 63040000
&RN      SETA  &RN+1               INCREMENT DCB COUNTER       @Y17XAYP 63050000
.DB12    ANOP                                                  @Y17XAYP 63070000
&I       SETA  &I+1                INCREMENT LINEGRP CTR       @Y17XAYP 63070200
         AIF   (&I LE &NLG).NCPTRM1                            @Y17XAYP 63070400
         AIF   (NOT &SNA).NOSSCP  NO SNA RESOURCES             @Y17XAYP 63070600
 PUNCH 'SSCP    TERMINAL TERM=SSCP'                            @Y17XAYP 63070800
.NOSSCP  ANOP                                                           63071000
.*                                                                      63071200
.********************************************************************** 63071400
.*       GROUP MACROS                                                   63071600
.********************************************************************** 63071800
.*                                                                      63072000
&SCRPT   SETA  1                   INITIALIZE SCREEN ARRAY POINTER      63072200
&LNEPT   SETA  1                   INITIALIZE LINE ARRAY POINTER Y06327 63072400
&TN      SETA  1000                INITIALIZE MACRO COUNTER             63072600
&I       SETA  1                   SET OUTER LOOP CONTROL               63072800
&RN      SETA  0                   INITIALIZE DCB COUNTER        Y06327 63073000
.GRPLIN  AIF   ('&GRPNAME(&I)' EQ '').GRP2 BYPASS IF NOT 3705  @Y17XAYP 63073200
         AIF   (&I EQ 1).GRP3      BYPASS EQ DDNAME CHECK        Y06327 63073400
.*                                 IF FIRST LINE GROUP           Y06327 63073600
         AIF   ('&DDNME(&I)' EQ '&DDNME(&I-1)').GRP1  EQUAL      Y06327 63073800
.*                                 DDNAMES MEANS SAME 3705       Y06327 63074000
.GRP3    ANOP                                                    Y06327 63074200
&RN      SETA  &RN+1               UPDATE DCB COUNTER            Y06327 63074400
.GRP1    ANOP                                                    Y06327 63074600
&GNAME   SETC  '&GRPNAME(&I)'                                    Y06327 63074800
&GTRANS  SETC  '&TTAB((&I-1)*4+1)' GET NAME OF TRANSLATE TABLE   Y06327 63075000
 PUNCH '&GNAME GROUP MH=TSOMH,TRANS=&GTRANS,                           X63075200
                     ...........'                                Y06327 63075400
&N       SETA  2                   DEFAULT BUFOUT                Y06327 63075600
         AIF   ('&T(&I)'(1,3) NE '327').GRP4  BUFOUT=1 FOR       Y06327 63075800
.*                                 3705/3270                     Y06327 63076000
&N       SETA  1                                                 Y06327 63076200
         AIF   ('&T(&I)'(1,4) NE '327L').GRP4  BYPASS IF NOT   @ZA03733 63076400
.*                                 3270 LOCAL                  @ZA03733 63076600
 PUNCH '               PCI=(,N),                               @ZA03733X63076800
                       X'          PCI=(,N) FOR 3270 LOCAL     @ZA03733 63077000
.GRP4    ANOP                                                    Y06327 63077200
 PUNCH '               DCB=DCB&RN,BUFOUT=&N,BUFSIZE=&UNSIZ,BUFMAX=2'    63077400
.*                                                                      63077600
.********************************************************************** 63077800
.*       3705 LINES                                                     63078000
.********************************************************************** 63078200
.*                                                                      63078400
&LC      SETA  1                   INITIALIZE LINE CTR           Y06327 63078600
.LCINCR  ANOP                                                    Y06327 63078800
&TRM     SETC  '&T(&I)'            SET TERM TYPE               @Y17XAYP 63079000
         AIF   (&LC GT &LNO(&I)).TERMLIN ALL DONE WITH 3705 LINESY06327 63079200
         AIF   ('&GRPNAME(&I)' EQ '').TERMLIN                  @Y17XAYP 63079400
&TN      SETA  &TN+1               INCREMENT TTABLE ENTRY COUNT  Y06327 63079600
&LNAME   SETC  'L&TN'              BUILD TTABLE ENTRY NAME       Y06327 63079800
&TRM     SETC  'LINE'                                          @Y17XAYP 63081000
.BLDLN   ANOP                                                  @Y17XAYP 63081200
 PUNCH '&LNAME   TERMINAL GROUP=&GRPNAME(&I),RLN=&LC,TERM=&TRM'         63081400
.*                                                             @Y17XAYP 63081600
.INLNCT  ANOP                                                  @Y17XAYP 63081800
&LC      SETA  &LC+1               INCREMENT LINE COUNTER        Y06327 63082000
         AGO   .LCINCR             PROCESS MORE 3705 LINES       Y06327 63082200
.GRP2    ANOP                                                    Y06327 63082400
&RN      SETA  &RN+1               UPDATE DCB COUNTER            Y06327 63082600
.*********************************************************************  63082800
.*       TERMINAL'S                                                     63083000
.*********************************************************************  63083210
.*                                                                      63083400
.TERMLIN ANOP                      LOOP EXECUTED ONCE FOR EACH LINEGRP  63083510
.*                                                                      63083610
.*       BUILD DESCRIPTIVE NAMES OF FEATURES                            63083710
.*                                                                      63083910
&J       SETA  (&I-1)*3            SET FEATUR TABLE OFFSET VALUE        63084010
         AIF   (&FETAB(&J+1)).TL1  TEST PRESENCE OF BREAK FEATURE       63084110
&FEAT(1) SETC  'NOBREAK'                                                63084210
         AGO   .TL2                                                     63084410
.TL1     ANOP                                                           63084510
&FEAT(1) SETC  'BREAK'                                                  63084710
.TL2     AIF   (&FETAB(&J+2)).TL3  TEST PRESENCE OF ATTN FEATURE        63084810
&FEAT(2) SETC  'NOATTN'                                                 63085010
         AGO   .TL4                                                     63085410
.TL3     ANOP                                                           63085510
&FEAT(2) SETC  'ATTN'                                                   63085710
.TL4     AIF   (&FETAB(&J+3)).TL5  TEST PRESENCE OF TOSUPPR FEATURE     63086110
&FEAT(3) SETC  ''                                                       63086210
         AGO   .TL6                                                     63086510
.TL5     ANOP                                                           63086910
&FEAT(3) SETC  ',TOSUPPR'                                               63087010
.TL6     ANOP                                                           63087310
.*                                                                      63087710
.*       BUILD MACRO LABEL                                              63087810
.*                                                                      63088110
&J       SETA  1                   INITIALIZE LINE COUNTER     @Y17XAYP 63090410
&H       SETA  1                   INITIALIZE LUNO COUNTER     @Y17XAYP 63090510
&K       SETA  0                   INITIALIZE TERM/PU COUNTER  @Y17XAYP 63090710
&M       SETA  0                        SET LU COUNT           @OY20324 63090882
.TLINLOP ANOP                      LOOP EXECUTED ONCE PER LINE          63091010
&TRM     SETC  '&T(&I)'            SET TERMINAL TYPE           @Y17XAYP 63091110
         AIF   ('&GRPNAME(&I)' EQ '').LUNOL  NCP LINEGRP       @Y17XAYP 63091310
         AIF   ('&T(&I)' EQ 'PUNT').PPUNT IS THIS A NCP        @Y17XAYP 63091610
         AIF   ('&T(&I)' NE '327C').LUNOL THIS NOT A CLUSTER   @Y17XAYP 63091710
&TN      SETA  &TN+1               SET MACRO NUMBER            @ZM46739 63091910
&CNAME   SETC  'T&TN'              SET MACRO NAME              @ZM46739 63092210
&K       SETA  &K+1                INCREMENT TERM COUNTER      @ZM46739 63092510
 PUNCH '&CNAME   TERMINAL TERM=&TRM,QBY=T,RLN=&J,GROUP=&GRPNAME(&I)'    63092810
.*                                                             @YM07798 63093110
&M       SETA  0                                               @YM08503 63093310
         AGO   .LUNOL                                          @Y17XAYP 63093410
.PPUNT   ANOP                                                  @Y17XAYP 63093510
&TN      SETA  &TN+1               SET MACRO NUMBER            @ZM46739 63093610
&CNAME   SETC  'T&TN'              SET MACRO NAME              @ZM46739 63093710
&K       SETA  &K+1                INCREMENT TERM COUNTER      @ZM46739 63093810
 PUNCH '&CNAME   TERMINAL TERM=&TRM'                           @ZM46739 63093910
&M       SETA  0                                               @YM08503 63094010
.LUNOL   ANOP                                                  @Y17XAYP 63094110
         AIF   ('&T(&I)' EQ 'PUNT').PLUNT IS THIS FOR A LU     @Y17XAYP 63094210
         AIF   ('&T(&I)' EQ '327C').PREM IS THIS A CLUSTER     @Y17XAYP 63094410
&K       SETA  &K+1                INCREMENT TERMNO COUNT      @YM07381 63094610
         AGO   .PNCHLU                                         @Y17XAYP 63094810
.PLUNT   ANOP                                                  @Y17XAYP 63095010
&TRM     SETC  'LUNT'              SET TERM TYPE FOR LU        @Y17XAYP 63095110
         AGO   .PNCHLU                                         @Y17XAYP 63095210
.PREM    ANOP                                                  @Y17XAYP 63095310
&TRM     SETC  '327R'              SET TERM TYPE FOR REMOTE    @Y17XAYP 63095410
.PNCHLU  ANOP                                                  @Y17XAYP 63095510
&M       SETA  &M+1                INCREMENT LU COUNT          @Y17XAYP 63095610
         AIF   (&I EQ &NLG AND &J EQ &LNO(&I) AND &K EQ &TRMNO(&LNEPT) X63095782
               AND &M EQ &TRMNO(&LNEPT+&H)                             X63095882
               AND &I EQ &NLG).TLAST    LAST MACRO             @OZ33108 63095982
&TN      SETA  &TN+1               INCREMENT MACRO COUNT       @Y17XAYP 63096082
&TNAME   SETC  'T&TN'              SET TERMINAL NAME           @Y17XAYP 63096110
         AGO   .TL10                                           @Y17XAYP 63096210
.TLAST   ANOP                                                           63096310
&TNAME   SETC  'TLAST'             BUILD SPECIAL NAME FOR LAST ENTRY    63096510
.TL10    ANOP                                                           63096610
&CRSREF  SETC  'NO'                ASSUME NON-SWITCHED LINE             63096710
&QBYP    SETC  'QBY=T,'            INCLUDE QBY PARAMETER                63096810
         AIF   (NOT &DIALSW(&I)).LINE                                   63096910
&CRSREF  SETC  'YES'               INDICATE SWITCHED LINE               63097010
&QBYP    SETC  '      '            OMIT QBY PARAMETER                   63097110
.*                                                                      63097210
.*       BUILD FIRST LINE OF TERMINAL MACRO                             63097310
.*                                                                      63097410
.LINE    AIF   ('&GRPNAME(&I)' EQ '').CARD1 NOT 3705           @Y17XAYP 63097510
 PUNCH '&TNAME   TERMINAL GROUP=&GRPNAME(&I),QBY=T,RLN=&J,TERM=&TRM,QUEX63097610
               UES=TS,  .............'                           Y06327 63097710
         AGO   .CARD1A                                           Y06327 63097810
.CARD1   ANOP                                                    Y06327 63097910
 PUNCH '&TNAME   TERMINAL &QBYP.DCB=DCB&RN,RLN=&J,TERM=&TRM,QUEUES=TS, X63098010
                        .........'                                      63098110
.*                                                                      63098200
.*       PUNCH SECOND LINE OF TERMINAL MACRO                            63098300
.*                                                                      63098400
.CARD1A  AIF   ('&TTAB((&I-1)*4+2)' NE '' OR '&SCRALL(&SCRPT)' NE      X63098500
               '0').OPT1           NEED AN OPTION FIELD INITIAL@Y17XAYP 63098600
         AIF   ('&TRM' EQ 'LUNT').OPT1    PUT BIND IMAGE OPTN  @YM08503 63098700
&PNCHCO  SETA  0                                               @YM08503 63098800
         AGO   .OPT3                                             Y06327 63098900
.OPT1    ANOP                                                    Y06327 63099000
&OPDT    SETC  'OPDATA='                                         Y06327 63099100
&OPDT2   SETC  '),'           ASSUME NO BIND OPTION FIELD      @YM08503 63099200
&PNCHCO  SETA  2                                               @YM08503 63099300
         AIF   ('&TRM' NE 'LUNT').CKTRAN     NO BIND IMAGE RQD @YM08503 63099400
&PNCHCO  SETA  11                                              @YM08503 63099500
         AIF   (&LUTYP(&I) EQ 0).LU0     IS LU TYPE ZERO       @YM08503 63099600
         AIF   (&LUTYP(&I) EQ 1).LU1     IS LU TYPE ONE        @YM08503 63099700
         AIF   (&LUTYP(&I) EQ 2).LU2     IS LU TYPE TWO        @YM08503 63099800
         AGO   .CKTRAN                                         @YM08503 63099900
.LU0     ANOP                LU TYPE 0                         @YM08503 63100000
&OPDT2   SETC  ',IEDTSOB0),' LU TYPE 0 BIND IMAGE NAME         @YM08503 63100100
         AGO   .CKTRAN                                         @YM08503 63100200
.LU1     ANOP                LU TYPE 1                         @YM08503 63100300
&OPDT2   SETC  ',IEDTSOB1),' LU TYPE 1 BIND IMAGE NAME         @YM08503 63100400
         AGO   .CKTRAN                                         @YM08503 63100500
.LU2     ANOP                LU TYPE 2                         @YM08503 63100600
&OPDT2   SETC  ',IEDTSOB2),' LU TYPE 2 BIND IMAGE NAME         @YM08503 63100700
.CKTRAN  ANOP                                                  @YM08503 63100800
&OPDT1   SETC  '(0,0'              BOTH OPTION FIELDS INITIAL. @YM08503 63100900
&PNCHCO  SETA  &PNCHCO+4                                       @YM08503 63101000
         AIF   ('&TTAB((&I-1)*4+2)' NE '' AND '&SCRALL(&SCRPT)' NE '0')X63101100
               .TSCRN              BOTH FIELDS INITIALIZED       Y06327 63101200
         AIF   (&FSCR).TSCRN       OK IF FULLSCR                 Y06327 63101300
&OPDT1   SETC  '(0'                INITIALIZE  FIELD           @YM08503 63101400
&PNCHCO  SETA  &PNCHCO-2                                       @YM08503 63101500
.*                                 IF NO FULLSCR                 Y06327 63102000
         AGO   .TSCRN                                            Y06327 63102200
.OPT3    ANOP                                                    Y06327 63102400
&OPDT    SETC  '       '                                         Y06327 63102600
&OPDT1   SETC  '      '                                          Y06327 63102800
.TSCRN   AIF   ('&GRPNAME(&I)' EQ '').CARD2 NOT 3705           @Y17XAYP 63103000
&CRSREF  SETC  'NO'                                              Y06327 63103200
.CARD2   AIF   (&SCRH(&SCRPT) EQ 0 AND &SCRW(&SCRPT) EQ 0).TNOSCR       63103400
 PUNCH '               UTERM=&CRSREF,SCRSIZE=(&SCRH(&SCRPT),&SCRW(&SCRPX63103600
               T)),                              ....'           Y06327 63103800
         AIF   ('&T(&I)'(1,3) NE '327' AND '&T(&I)' NE 'PUNT').NOBUF    63104000
         AIF   (&SCRH(&SCRPT) EQ 24 AND &SCRW(&SCRPT) EQ 80).LGBUF      63104200
         AIF   (&SCRH(&SCRPT) EQ 12 AND &SCRW(&SCRPT) EQ 40).SMBUF      63104400
         AGO   .NOBUF              NO BUFSIZE NEEDED             Y06327 63104600
.LGBUF   ANOP                      LARGE SCREEN BUFSIZE          Y06327 63104800
 PUNCH '               BUFSIZE=1968,                                   X63105000
                     ....'                                              63105200
         AGO   .NOBUF                                            Y06327 63105400
.SMBUF   ANOP                      SMALL SCREEN BUFSIZE          Y06327 63105600
 PUNCH '               BUFSIZE=528,                                    X63105800
                     ....'                                              63106000
.NOBUF   AIF   ('&OPDT' EQ '       ').TPUN3                    @Y17XAYP 63106200
         AIF   (&PNCHCO GT 9).BND                              @YM08503 63106300
 PUNCH '               &OPDT&OPDT1&OPDT2                               X63106400
                  ...........'                                 @OY16449 63106500
         AGO   .TPUN3                                          @YM08503 63106600
.BND     ANOP                                                           63106700
 PUNCH '               &OPDT&OPDT1&OPDT2                               X63106800
               ........'                                         Y06327 63106900
         AGO   .TPUN3              GO PUNCH 3RD LINE                    63107000
.TNOSCR  ANOP                                                           63107100
 PUNCH '               UTERM=&CRSREF,                                  X63107200
                         .....'                                  Y06327 63107400
         AIF   ('&OPDT' EQ '       ').TPUN3                      Y06327 63107600
         AIF   (&PNCHCO GT 9).BND1                             @YM08503 63107700
 PUNCH '               &OPDT&OPDT1&OPDT2                               X63107800
                   ...........'                                @OY16449 63107984
         AGO   .TPUN3                                          @YM08503 63108000
.BND1    ANOP                                                           63108100
 PUNCH '               &OPDT&OPDT1&OPDT2                               X63108200
               ........'                                         Y06327 63108300
.TPUN3   AIF   ('&GRPNAME(&I)' NE '').TLPNOAD BYPASS FOR 3705  @Y17XAYP 63108400
.*                                                                      63108500
.*       PUNCH THIRD LINE OF TERMINAL MACRO                             63108600
.*                                                                      63108800
&Y       SETC  ''                                                       63109000
         AIF   ('&ADCHAR(&SCRPT)' EQ '').TLNOAD TEST           @Y17XAYP 63109200
.*                                 FOR NULL ADDR.                Y06327 63109400
&X       SETC  '&ADCHAR(&SCRPT)' ASSUME NOT 1050 OR            @Y17XAYP 63109600
.*                                 226R/5 OR 327R                Y06327 63109800
         AIF   ('&T(&I)' EQ '327R' OR '&T(&I)' EQ '327S').T3270         63110000
         AIF   ('&T(&I)' NE '226R' AND '&T(&I)' NE '2265').T1050        63110200
&X       SETC  '&X'(1,4)'A0'                                            63110400
         AGO   .TLPAST                                                  63110600
.T3270   ANOP                                                           63110800
&Z       SETA  1                        INITIALIZE PTR FOR TABLE LOOKUP 63111000
         AIF   ('&TTAB((&I-1)*4+1)' EQ 'ASCI').ASCI CHECK TRANTAB       63111200
.EBCD    ANOP                                                           63111400
&Q       SETA  1                        POSITION IN TABLE ELEMENT       63111600
&Y       SETC  '2D'                                                     63111800
         AGO   .SEARCH                                                  63112000
.ASCI    ANOP                                                           63112200
&Q       SETA  5                        POSITION IN TABLE ELEMENT       63112400
&Y       SETC  '05'                                                     63112600
.SEARCH  AIF   ('&X'(1,2) EQ '&TBL(&Z)'(&Q,2)).FOUND           @Y17XAYP 63112800
&Z       SETA  &Z+1                     POINTS AT NEXT ENTRY            63113000
         AIF   (&Z LE 32).SEARCH                                        63113200
         MNOTE 8,'IKJ54128I ADDRESSING CHARACTERS INVALID OR MISSING FOX63113400
               R TERMINAL IN LINE GROUP &I'                             63113600
&X       SETC  '        '                                               63113800
         AGO   .TLPNOAD                                          Y06327 63114000
.FOUND   ANOP                                                           63114200
&X       SETC  '&TBL(&Z)'(&Q+2,2)'&TBL(&Z)'(&Q+2,2)'&X'(3,2)'&X'(3,2)   63114400
.*                                 REPLICATING ADDRESSING CHARS         63114600
         AGO   .TLPAST                                                  63114800
.T1050   ANOP                                                           63115000
         AIF   ('&T(&I)' NE '1050' AND '&T(&I)' NE '5041').TLPAST       63115200
&X       SETC  '&X'(1,2)'13'       ADD COMPONENT SELECTOR               63115400
.TLPAST  ANOP                                                           63115600
 PUNCH '               ADDR=&X&Y,FEATURE=(&FEAT(1),&FEAT(2)&FEAT(3))'   63115800
         AGO   .TL11                                                    63116000
.TLNOAD  AIF   ('&T(&I)'(1,3) NE '226' AND '&T(&I)'(1,3) NE '327' AND '&63116200
               &T(&I)' NE '1050').TLPNOAD                      @Y17XAYP 63116400
         AIF   ('&T(&I)' EQ '327L').TLPNOAD                             63116600
         AIF   ('&T(&I)' EQ '226L').TLPNOAD                             63116800
         MNOTE 8,'IKJ54128I ADDRESSING CHARACTERS INVALID OR MISSING FOX63117000
               R TERMINAL IN LINE GROUP &I'                             63117200
.TLPNOAD AIF   ('&T(&I)' NE 'PUNT').SKPUSS                     @Y17XAYP 63117400
         AIF   (&LUSB(&SCRPT) EQ 1).ACTLU ACTIVATE LU/LU SES   @Y17XAYP 63117600
&LUACT   SETC  'NO'                                            @Y17XAYP 63117800
         AGO   .PACT               PUNCH ACTIVE CARD           @Y17XAYP 63118000
.ACTLU   ANOP                                                  @Y17XAYP 63118200
&LUACT   SETC  'YES'               ACTIVATE LU/LU SESSION      @Y17XAYP 63118400
.PACT    ANOP                                                  @Y17XAYP 63118500
 PUNCH '               ACTIVE=(YES,&LUACT),                            X63118600
                       .....'                                  @Y17XAYP 63118700
 PUNCH '               TCMSESN=LUTERM,                                 X63118800
                     .....'                                    @Y17XAYP 63118900
.*PUNCH'               FMPROF=&LFM(&I),TSPROF=&LTS(&I),        @ZM46739 63119110
.*                                 .....'                      @ZM46739 63119210
.SKPACT  AIF   (&USSB(&SCRPT) NE 1).SETSCS USS 3270 SPECIFIED  @Y17XAYP 63119410
 PUNCH '               USS=3270,                                       X63119510
                    .......'                                   @Y17XAYP 63119600
         AGO   .SKPUSS                                         @Y17XAYP 63119800
.SETSCS  ANOP                                                  @Y17XAYP 63120000
 PUNCH '               USS=SCS,                                        X63120200
                     .......'                                  @Y17XAYP 63120400
.SKPUSS  ANOP                                                  @Y17XAYP 63120600
 PUNCH '               FEATURE=(&FEAT(1),&FEAT(2)&FEAT(3))'             63120800
.TL11    ANOP                                                           63121000
.*                                                             @ZM46739 63121210
&SCRPT   SETA  &SCRPT+1            BUMP SCREEN ARRAY POINTER            63121400
         AIF   (&M LT &TRMNO(&LNEPT+&H)).LUNOL  MORE LU        @Y17XAYP 63121600
&M       SETA  0                   RESET LU/LUNO  COUNT        @Y17XAYP 63121800
&H       SETA  &H+1                INCREMENT LUNO COUNTER      @Y17XAYP 63122000
         AIF   (&H LE &TRMNO(&LNEPT)).TLINLOP  MORE LUNO       @Y17XAYP 63122200
&K       SETA  0                                               @OZ33108 63122382
&LNEPT   SETA  &LNEPT+&H           SET PTR TO NEXT TERMNO      @Y17XAYP 63122400
&H       SETA  1                   RESET LUNO COUNTER          @Y17XAYP 63122600
&J       SETA  &J+1                INCREMENT LINE COUNTER      @Y17XAYP 63122800
         AIF   (&J LE &LNO(&I)).TLINLOP MORE LINES/LINEGRP     @Y17XAYP 63123000
.*       OUTER LOOP TEST                                                63123200
.TLOUT   ANOP                                                           63123400
&I       SETA  &I+1                INCREMENT OUTER LOOP INDEX           63123600
         AIF   (&I LE &NLG).GRPLIN BR IF MORE LINE GROUPS        Y06327 63123800
.*                                                                      63124000
.*********************************************************************  63124200
.*       TSINPUT                                                        63124400
.*********************************************************************  63124600
.*                                                                      63124800
 PUNCH '         TSINPUT'                                               63125000
.*                                                                      63125200
.*********************************************************************  63125400
.*       DCB'S                                                          63125600
.*********************************************************************  63125800
.*                                                                      63126000
&IN      SETA  0                   INITIALIZE INVLIST COUNTER           63126200
&I       SETA  1                   SET LOOP CONTROL VARIABLE            63126400
&RN      SETA  0                   INITIALIZE 3705 DCB CTR       Y06327 63126600
.DCBLOOP AIF   ('&GRPNAME(&I)' EQ '').DCB2 BYPASS IF NOT 3705  @Y17XAYP 63126800
         AIF   (&I EQ 1).DCB1      BYPASS EQ DDNAME CHECK        Y06327 63127000
.*                                 IF FIRST LINE GROUP           Y06327 63127200
         AIF   ('&DDNME(&I)' EQ '&DDNME(&I-1)').DCBTEST EQUAL    Y06327 63127400
.*                                 DDNAMES MEANS SAME 3705       Y06327 63127600
.DCB1    ANOP                                                    Y06327 63127800
&RN      SETA  &RN+1               UPDATE 3705 DCB COUNTER       Y06327 63128000
         AGO   .DCBTEST                                          Y06327 63490005
.DCB2    ANOP                                                    Y06327 63560005
&RN      SETA  &RN+1               UPDATE DCB COUNTER            Y06327 63630005
&J       SETA  1                   ASSUME BUFIN=1                       63700005
         AIF   ('&T(&I)'(1,3) NE '226' AND '&T(&I)'(1,3) NE '327').PUNDX63770005
               CB                                                       63840005
&J       SETA  2                   BUFIN=2 FOR 2260/65 AND FOR 3270     63910005
.PUNDCB  ANOP                                                           63980005
 PUNCH 'DCB&RN   DCB   DSORG=TX,MACRF=(G,P),INTVL=&INT(&I),CPRI=S, ....X64050005
               ...................'                                     64120005
 PUNCH '               DDNAME=&DDNME(&I),MH=TSOMH,                     X64190005
                         ........'                               Y06327 64260005
 PUNCH '               BUFIN=&J,BUFOUT=2,                              X64330005
                     .......'                                           64400005
&X       SETC  '&TTAB((&I-1)*4+1)'  SET SCT TABLE NAME                  64470005
&K       SETA  &UNSIZ*&UNO(&I)     COMPUTE BUFFER SIZE                  64540005
&J       SETA  &J+1                COMPUTE BUFMAX                       64610005
         AIF   ('&TTAB((&I-1)*4+2)' EQ '').DB1 BR IF ONLY 1 TRAN TBL    64680005
&TNAME   SETC  'TL&RN'             BUILD NAME OF TRANLIST        Y06327 64750005
         AIF   ('&T(&I)' NE '5041').DB2   BR IF NOT 5041 LINE GROUP     64820005
&X       SETC  '1050'              1050 IS SCT FOR 5041 LINE GROUPS     64890005
         AGO   .DB2                                                     64960005
.DB1     ANOP                                                           65030005
&TNAME   SETC  '&TTAB((&I-1)*4+1)' GET NAME OF TRANSLATE TABLE          65100005
.DB2     ANOP                                                           65170005
&OPDT1   SETC  '(A,A)'             SET DEFAULT PCI               Y06327 65240005
         AIF  ('&T(&I)' NE '327L' AND '&T(&I)' NE '226L').DB20 @ZA03733 65310058
&OPDT1   SETC  '(N,N)'             SET PCI FOR LOCAL DEVICE    @ZA03733 65380058
.DB20    ANOP                                                    Y06327 65450005
 PUNCH '               BUFSIZE=&K,BUFMAX=&J,PCI=&OPDT1,                X65520005
                     .....'                                     OY03474 65550005
 PUNCH '               TRANS=&TNAME,                                   X65580005
                     ......'                                    OY03474 65610005
&IN      SETA  &IN+1               BUMP INVLIST COUNTER                 65660005
.*                                                                      65730005
.*       BRANCH IF SEVERAL INVLIST SUB-OPERANDS                         65800005
         AIF   (&LNO(&I) GT 1).DB3                                      65870005
.*                                                                      65940005
.*       COMPUTE VALUES FOR SELECTION OF CHARACTERS IN THE              66010005
.*       ALPHAMERIC CHARACTER SET ARRAY.  THESE TWO SELECTED CHARACTERS 66080005
.*       WILL BE CONCATENATED TO FORM THE INVLIST MACRO NAME.           66150005
&L       SETA  (&IN-1)/36+1        SET 1ST CHARACTER SELECTOR           66220005
&M       SETA  &IN-(&L-1)*36       SET 2ND CHAR SELECTOR                66290005
 PUNCH '               SCT=&X,INVLIST=(&CS(&L)&CS(&M))'                 66360005
         AGO   .DCBTEST            GO TEST FOR MORE LINE GROUPS         66430005
.DB3     ANOP                                                           66500005
&L       SETA  (&IN-1)/36+1        SET 1ST CHARACTER SELECTOR           66570005
&M       SETA  &IN-(&L-1)*36       SET 2ND CHAR SELECTOR                66640005
 PUNCH '               SCT=&X,INVLIST=(&CS(&L)&CS(&M),,,               X66710005
                             .........'                                 66780005
.*                                                                      66850005
.*       SET UP LOOP TO GENERATE REST OF INVLIST SUB-OPERANDS           66920005
.*                                                                      66990005
&J       SETA  2                   INITIALIZE LINE COUNTER              67060005
.DCBINLP ANOP                                                           67130005
&IN      SETA  &IN+1               BUMP INVLIST COUNTER                 67200005
.*       BRANCH IF LAST SUB-OPERAND COMING UP NEXT                      67270005
         AIF   (&J EQ &LNO(&I)).DB4                                     67340005
.*                                                                      67410005
.*       COMPUTE VALUES FOR SELECTION OF CHARACTERS IN THE              67480005
.*       ALPHAMERIC CHARACTER SET ARRAY.  THESE TWO SELECTED CHARACTERS 67550005
.*       WILL BE CONCATENATED TO FORM THE INVLIST MACRO NAME.           67620005
&L       SETA  (&IN-1)/36+1        SET 1ST CHARACTER SELECTOR           67690005
&M       SETA  &IN-(&L-1)*36       SET 2ND CHAR SELECTOR                67760005
 PUNCH '               &CS(&L)&CS(&M),,,                               X67830005
                                   X'                                   67900005
&J       SETA  &J+1                BUMP LINE COUNTER                    67970005
         AGO   .DCBINLP                                                 68040005
.DB4     ANOP                                                           68110005
&L       SETA  (&IN-1)/36+1        SET 1ST CHARACTER SELECTOR           68180005
&M       SETA  &IN-(&L-1)*36       SET 2ND CHAR SELECTOR                68250005
 PUNCH '               &CS(&L)&CS(&M))' PUNCH LAST SUBOPERAND           68320005
.*                                                                      68390005
.*       DCB GENERATION LOOP TEST                                       68460005
.*                                                                      68530005
.DCBTEST ANOP                                                           68600005
&I       SETA  &I+1                INCREMENT LOOP CONTROL VARIABLE      68670005
         AIF   (&I LE &NLG).DCBLOOP BR IF MORE LINE GROUPS              68740005
.*                                                                      68810005
.*********************************************************************  68880005
.*       TRANLIST'S                                                     68950005
.*********************************************************************  69020005
.*                                                                      69090005
&I       SETA  1                   SET OUTER LOOP INDEX VARIABLE        69160005
&RN      SETA  0                   INITIALIZE DCB COUNTER        Y06327 69230005
.TRLOOP  AIF   ('&GRPNAME(&I)' EQ '').TRAN2  BYPASS IF NOT 3705@Y17XAYP 69370000
         AIF   (&I EQ 1).TRAN1     BYPASS EQ DDNAME CHECK        Y06327 69440005
.*                                 IF FIRST LINE GROUP           Y06327 69510005
         AIF   ('&DDNME(&I)' EQ '&DDNME(&I-1)').TRLPTST  EQUAL   Y06327 69580005
.*                                 DDNAMES MEANS SAME 3705       Y06327 69650005
.TRAN1   ANOP                                                    Y06327 69720005
&RN      SETA  &RN+1               UPDATE DCB COUNTER            Y06327 69790005
         AGO   .TRLPTST                                          Y06327 69860005
.TRAN2   ANOP                                                    Y06327 69930005
&RN      SETA  &RN+1               UPDATE DCB COUNTER            Y06327 70000005
&J       SETA  (&I-1)*4+1          PT TO 1ST OF GROUP IN &TTAB, &CTAB   70070005
         AIF   ('&TTAB(&J+1)' EQ '').TRLPTST BE IF TRANLIST UNNECESSARY 70140005
.*                                                                      70210005
.*       THIS ROUTINE SCANS THE TRANSLATE TABLE NAMES OF A LINEGRP      70280005
.*       LOOKING FOR 2741 OR 1050 TABLES.  WHEN (AND IF) FOUND THEY ARE 70350005
.*       PLACED IN  ARRAYS  FROM WHICH THE L2741= AND L1050=            70420005
.*       PARAMETERS WILL LATER BE GENERATED IF BOTH 2740'S AND 1050'S   70490005
.*       ARE INVOLVED IN THE LINE GROUP.                                70560005
.*                                                                      70630005
&L2741(1) SETC  ''                 INITIALIZE ARRAYS                    70700005
&L2741(2) SETC  ''                                                      70770005
&L2741(3) SETC  ''                                                      70840005
&L2741(4) SETC  ''                                                      70910005
&L1050(1) SETC  ''                                                      70980005
&L1050(2) SETC  ''                                                      71050005
&L1050(3) SETC  ''                                                      71120005
&L1050(4) SETC  ''                                                      71190005
&N2741   SETA  0                   INITIALIZE ARRAY COUNTERS            71260005
&N1050   SETA  0                                                        71330005
&K       SETA  0                   SET LOOP CONTROL VARIABLE            71400005
.*       SKIP NULL TABLE ENTRIES                                        71470005
.TRLP2   AIF   ('&TTAB(&J+&K)' EQ '').TRLP2T                            71540005
         AIF   ('&TTAB(&J+&K)'(3,2) NE '41').TRLP3                      71610005
&N2741   SETA  &N2741+1                                                 71680005
&L2741(&N2741) SETC '&TTAB(&J+&K)'                                      71750005
         AGO   .TRLP2T             GO TO SCANNING LOOP TEST             71820005
.TRLP3   AIF   ('&TTAB(&J+&K)'(3,2) NE '50').TRLP2T                     71890005
&N1050   SETA  &N1050+1                                                 71960005
&L1050(&N1050) SETC '&TTAB(&J+&K)'                                      72030005
.TRLP2T  ANOP                                                           72100005
&K       SETA  &K+1                                                     72170005
         AIF   (&K LE 3).TRLP2     BR UNTIL ALL TBL NAMES ARE CHECKED   72240005
         AIF   (&N2741 NE 0 AND &N1050 NE 0).TRLBOTH                    72310005
.*                                                                      72380005
.*       THIS ROUTINE IS EXECUTED UNLESS THE LINE GROUP HAS BOTH        72450005
.*       2740 AND 1050 TERMINALS.  THIS ROUTINE GENERATES THE           72520005
.*       LIST= PARAMETER.                                               72590005
.*                                                                      72660005
&CM(2)   SETC  ''                  INITIALIZE SUBLIST SEPARATORS        72730005
&CM(3)   SETC  ''                                                       72800005
&CP(2)   SETC  '     '             INITIALIZE CONTINUATION POSITIONERS  72870005
&CP(3)   SETC  '     '                                                  72940005
.*       MAKE SUBLIST SEPARATORS COMMAS IF THERE ARE, IN FACT,          73010005
.*       OPERANDS TO SEPARATE.  ALSO SET THE CONTINUATION POSITIONERS   73080005
.*       TO THE PROPER LENGTH SO THAT A CONTINUATION CHARACTER WILL     73150005
.*       APPEAR IN COLUMN 72.                                           73220005
         AIF   ('&TTAB(&J+2)' EQ '').TRL1                               73290005
&CM(2)   SETC  ','                                                      73360005
&CP(2)   SETC  ''                                                       73430005
.TRL1    AIF   ('&TTAB(&J+3)' EQ '').TRL2                               73500005
&CM(3)   SETC  ','                                                      73570005
&CP(3)   SETC  ''                                                       73640005
.TRL2    ANOP                                                           73710005
 PUNCH 'TL&RN    TRANLIST LIST=(&TTAB(&J),&TTAB(&J+1)&CM(2)&TTAB(&J+2)&X73780005
               CM(3)&TTAB(&J+3)),&CP(2)&CP(3)                 .........X73850005
               ........'                                                73920005
         AGO   .TRLCHAR            GO GENERATE CHARS= PARAMETER         73990005
.*                                                                      74060005
.*       THIS ROUTINE GENERATES THE L2741= PARAMETER                    74130005
.*                                                                      74200005
.TRLBOTH ANOP                                                           74270005
&CM(1)   SETC  ''                  INITIALIZE SUBLIST SEPARATORS        74340005
&CM(2)   SETC  ''                                                       74410005
&CM(3)   SETC  ''                                                       74480005
&CP(1)   SETC  '     '             INITIALIZE CONTINUATION POSITIONERS  74550005
&CP(2)   SETC  '     '                                                  74620005
&CP(3)   SETC  '     '                                                  74690005
.*       MAKE SUBLIST SEPARATORS COMMAS IF THERE ARE, IN FACT,          74760005
.*       OPERANDS TO SEPARATE.  ALSO SET THE CONTINUATION POSITIONERS   74830005
.*       TO THE PROPER LENGTH SO THAT A CONTINUATION CHARACTER WILL     74900005
.*       APPEAR IN COLUMN 72.                                           74970005
         AIF   (&N2741 LT 2).TRL3                                       75040005
&CM(1)   SETC  ','                                                      75110005
&CP(1)   SETC  ''                                                       75180005
         AIF   (&N2741 LT 3).TRL3                                       75250005
&CM(2)   SETC  ','                                                      75320005
&CP(2)   SETC  ''                                                       75390005
         AIF   (&N2741 LT 4).TRL3                                       75460005
&CM(3)   SETC  ','                                                      75530005
&CP(3)   SETC  ''                                                       75600005
.TRL3    ANOP                                                           75670005
 PUNCH 'TL&RN    TRANLIST L2741=(&L2741(1)&CM(1)&L2741(2)&CM(2)&L2741(3X75740005
               )&CM(3)&L2741(4)),&CP(1)&CP(2)&CP(3)                 ...X75810005
               .............'                                           75880005
.*                                                                      75950005
.*       THIS ROUTINE GENERATES THE L1050= PARAMETER                    76020005
.*                                                                      76090005
&CM(1)   SETC  ''                  INITIALIZE SUBLIST SEPARATORS        76160005
&CM(2)   SETC  ''                                                       76230005
&CM(3)   SETC  ''                                                       76300005
&CP(1)   SETC  '     '             INITIALIZE CONTINUATION POSITIONERS  76370005
&CP(2)   SETC  '     '                                                  76440005
&CP(3)   SETC  '     '                                                  76510005
.*       MAKE SUBLIST SEPARATORS COMMAS IF THERE ARE, IN FACT,          76580005
.*       OPERANDS TO SEPARATE.  ALSO SET THE CONTINUATION POSITIONERS   76650005
.*       TO THE PROPER LENGTH SO THAT A CONTINUATION CHARACTER WILL     76720005
.*       APPEAR IN COLUMN 72.                                           76790005
         AIF   (&N1050 LT 2).TRL4                                       76860005
&CM(1)   SETC  ','                                                      76930005
&CP(1)   SETC  ''                                                       77000005
         AIF   (&N1050 LT 3).TRL4                                       77070005
&CM(2)   SETC  ','                                                      77140005
&CP(2)   SETC  ''                                                       77210005
         AIF   (&N1050 LT 4).TRL4                                       77280005
&CM(3)   SETC  ','                                                      77350005
&CP(3)   SETC  ''                                                       77420005
.TRL4    ANOP                                                           77490005
 PUNCH '               L1050=(&L1050(1)&CM(1)&L1050(2)&CM(2)&L1050(3)&CX77560005
               M(3)&L1050(4)),&CP(1)&CP(2)&CP(3)                    ...X77630005
               .............'                                           77700005
.*                                                                      77770005
.*       THIS ROUTINE GENERATES THE CHARS= PARAMETERS                   77840005
.*                                                                      77910005
.TRLCHAR ANOP                                                           77980005
&CM(1)   SETC  ''                  INITIALIZE SUBLIST SEPARATORS        78050005
&CM(2)   SETC  ''                                                       78120005
&CM(3)   SETC  ''                                                       78190005
.*       MAKE SUBLIST SEPARATORS COMMAS IF THERE ARE, IN FACT,          78260005
.*       OPERANDS TO SEPARATE                                           78330005
         AIF   ('&CTAB(&J+1)' EQ '').TRL5                               78400005
&CM(1)   SETC  ','                                                      78470005
         AIF   ('&CTAB(&J+2)' EQ '').TRL5                               78540005
&CM(2)   SETC  ','                                                      78610005
         AIF   ('&CTAB(&J+3)' EQ '').TRL5                               78680005
&CM(3)   SETC  ','                                                      78750005
.TRL5    ANOP                                                           78820005
 PUNCH '               CHARS=(&CTAB(&J)&CM(1)&CTAB(&J+1)&CM(2)&CTAB(&J+X78890005
               2)&CM(3)&CTAB(&J+3)),OPFLD=IEDQCAN'               Y06327 78960005
.*                                                                      79030005
.*       TRANLIST LOOP TEST                                             79100005
.*                                                                      79170005
.TRLPTST ANOP                                                           79240005
&I       SETA  &I+1                                                     79310005
         AIF   (&I LE &NLG).TRLOOP BR IF MORE LINE GROUPS TO HANDLE     79380005
.*                                                                      79450005
.*********************************************************************  79520005
.*       INVLIST'S                                                      79590005
.*********************************************************************  79660005
.*                                                                      79730005
&SCRPT   SETA  1                   INITIALIZE TRMNO ARRAY POINTER       79800005
&ADRPT   SETA  0                   INITIALIZE ADCHAR ARRAY POINTER      79870005
&IN      SETA  1                   INITIALIZE INVLIST COUNTER           79940005
&K       SETA  1000                INITIALIZE TTABLE NAME COUNTER       80010005
         AIF   (NOT &T3705).IL270X      IF 3705                  Y06327 80080005
&K       SETA  &RNLINES+&RNTERMS+&LUTERMS+1000   INIT PST 3705 @YM08503 80150000
&ADRPT   SETA  &ADRPT+&LUTERMS+&NONLU   ADJUST ADCHAR ARRAY    @OZ34694 80220082
.*                                 POINTER FOR THE 3705          Y06327 80290005
&SCRPT   SETA  &SCRPT+&RNLINES+&RNTERMS   TRMNO ARRAY POINTER    Y06327 80360000
.*                                 FOR THE 3705                  Y06327 80430005
.IL270X  ANOP                                                    Y06327 80500005
&I       SETA  1                   SET OUTER LOOP CONTROL VARIABLE      80570005
.IVL1    ANOP                      LOOP EXECUTED ONCE FOR EACH LINEGRP  80640005
         AIF   ('&GRPNAME(&I)' NE '').IVL1T INVLIST NOT          Y06327 80710005
.*                                 NEEDED FOR 3705               Y06327 80780005
&J       SETA  1                   SET INNER LOOP CONTROL VARIABLE      80850005
&EOT     SETC  ''                                                       80920005
.IVL2    ANOP                      LOOP EXECUTED ONCE FOR EACH LINE     80990005
&N       SETA  1                   SET INNERMOST LOOP COUNTER           81060005
.IVL3    AIF   (&J GT &LNO(&I)).IVL1T BR IF ALL LINES IN LINEGRP DONE   81200000
         AIF   (&N GT &TRMNO(&SCRPT)).IVL2T  BR IF ALL TERM'S ON LINE   81270005
         AIF   (&N LT &TRMNO(&SCRPT)).IL1  BR IF NOT LAST TERM ON LINE  81340005
         AIF   (&J LT &LNO(&I)).IL1 BR IF NOT LAST LINE IN LINEGRP      81410005
         AIF   (&I LT &NLG).IL1    BR IF NOT LAST LINE IN WHOLE SYSTEM  81480005
&TNAME   SETC  'TLAST'             BUILD SPECIAL NAME FOR LAST LINE     81550005
         AGO   .IL2                SKIP NORMAL NAME BUILDING            81620005
.IL1     ANOP                                                           81690005
&K       SETA  &K+1                BUMP TTABLE NAME COUNTER             81760005
&TNAME   SETC  'T&K'               BUILD TTABLE ENTRY NAME              81830005
.IL2     ANOP                                                           81900005
&ADRPT   SETA  &ADRPT+1            BUMP ADCHAR ARRAY POINTER            81970005
&Y       SETC  ''                                                       82040005
&X       SETC  '&ADCHAR(&ADRPT)'   ASSUME NOT 1050 OR 226R/5 OR 327R    82110005
         AIF   ('&X' EQ '').ILPAST  SKIP PROCESSING IF NULL             82180005
         AIF   ('&T(&I)' EQ '327R' OR '&T(&I)' EQ '327S').IL327R        82250005
         AIF   ('&T(&I)' NE '226R' AND '&T(&I)' NE '2265').IL1050       82320005
&X       SETC  '&X'(1,4)'40'                                            82390005
         AGO   .ILPAST3                                                 82460005
.IL327R  ANOP                                                           82530005
&X       SETC  '&X'(1,2)'&X'(1,2)'&X'(3,2)'&X'(3,2)                     82600005
.*                                 REPLICATING ADDRESSING CHARS         82670005
         AIF   ('&TTAB((&I-1)*4+1)' EQ 'ASCI').ASCITAB                  82740005
&Y       SETC  '2D'                     SET ENQ FOR EBCD                82810005
&EOT     SETC  ',EOT=37'                                                82880005
         AGO   .ILPAST3                                                 82950005
.ASCITAB ANOP                                                           83020005
&Y       SETC  '05'                     SET ENQ FOR ASCI                83090005
&EOT     SETC  ',EOT=04'                                                83160005
         AGO   .ILPAST3                                                 83230005
.IL1050  AIF   ('&T(&I)' NE '1050' AND '&T(&I)' NE '5041').ILPAST       83370000
&X       SETC  '&X'(1,2)'15'       ADD COMPONENT SELECTOR               83440005
         AGO   .ILPAST3                                                 83510005
.ILPAST  AIF   ('&T(&I)' NE '226L' AND '&T(&I)' NE '327L').ILPAST2      83650000
.*                                 TEST FOR 226L AND 327L               83720005
         AIF   ('&T(&I)' EQ '327L').IL327L                              83790005
&X       SETC  '02'                SET 226L INVLIST VALUE               83860005
         AGO   .ILPAST3                                                 83930005
.IL327L  ANOP                                                           84000005
&X       SETC  '06'                SET 327L INVLIST VALUE               84070005
         AGO   .ILPAST3                                                 84140005
.ILPAST2 AIF   ('&X' NE '').ILPAST3                            @Y17XAYP 84280000
&X       SETC  'DF'                SET DEFAULT VALUE                    84350005
.ILPAST3 ANOP                                                           84420005
.*       COMPUTE VALUES FOR SELECTION OF CHARACTERS IN THE              84490005
.*       ALPHAMERIC CHARACTER SET ARRAY.  THESE TWO SELECTED CHARACTERS 84560005
.*       WILL BE CONCATENATED TO FORM THE INVLIST MACRO NAME.           84630005
&L       SETA  (&IN-1)/36+1        SET 1ST CHARACTER SELECTOR           84700005
&M       SETA  &IN-(&L-1)*36       SET 2ND CHAR SELECTOR                84770005
         AIF   ('&T(&I)' NE '3335').IVLNTWX  BR IF NOT TWX              84840005
&IN      SETA  &IN+1               BUMP INVLIST MACRO COUNTER           84910005
         AIF   ('&TTAB((&I-1)*4+1)' NE 'TTYB').TTYBBYP         @OZ27297 84918082
 PUNCH '&CS(&L)&CS(&M)       INVLIST ORDER=(&TNAME+89),CPUID=CPIDE'     84926082
&CPID1   SETB  1                                               @OZ27297 84934082
&CPIDSW  SETB  1                                               @OZ27297 84942082
         AGO   .IVLPND                                         @OZ27297 84950082
.TTYBBYP ANOP                                                  @OZ27297 84958082
&CPID2   SETB  1                                               @OZ27297 84966082
 PUNCH '&CS(&L)&CS(&M)       INVLIST ORDER=(&TNAME+89),CPUID=CPID'      84980000
&CPIDSW  SETB  1                                               @YA11714 84990000
         AGO   .IVLPND             GO TO LOOP MODIFICATION              85120005
.IVLNTWX ANOP                                                           85190005
&MM      SETA  (&N-((&N-1)/14)*14) CONVERT TO MODULO 14         SA59196 85260005
         AIF   (&N GE &TRMNO(&SCRPT)).ILEOL BR IF LAST INVLIST ENTRY    85330005
         AIF   (&MM EQ 14).ILEOG   BR IF END OF GROUP OF 14     SA59196 85400005
         AIF   (&N GT 1 AND &MM NE 1).ILPMID  BR IF NOT FIRST OR LAST   85470005
 PUNCH '&CS(&L)&CS(&M)       INVLIST ORDER=(&TNAME+&X&Y,               X85540005
                              .........'                                85610005
         AGO   .IVLPND             GO TO LOOP MODIFICATION              85680005
.ILPMID  ANOP                      PUNCH NOT-FIRST/NOT-LAST ENTRY       85750005
 PUNCH '               &TNAME+&X&Y,                                    X85820005
                  .........'                                            85890005
         AGO   .IVLPND             GO TO LOOP MODIFICATION              85960005
.ILEOG   ANOP                                                           86030005
&Y       SETC  '&Y'.','            ADD COMMA                            86100005
 PUNCH '               &TNAME+&X&Y)'                           @OZ48953 86170082
         AGO   .IVLPND             GO TO LOOP MODIFICATION     @OZ48953 86190082
.ILEOL   ANOP                      END OF THIS INVLIST MACRO            86240005
&IN      SETA  &IN+1               BUMP INVLIST MACRO COUNTER           86310005
         AIF   (&MM EQ 1).ILFAL    BR IF 1ST & LAST ENTRY               86380005
.ILPLAST ANOP                                                           86450005
 PUNCH '               &TNAME+&X&Y),AUTO=NO&EOT'               @YA14062 86520000
         AGO   .IVLPND             GO TO LOOP MODIFICATION              86590005
.ILFAL   ANOP                      PUNCH FIRST-AND-LAST ENTRY           86660005
 PUNCH '&CS(&L)&CS(&M)       INVLIST ORDER=(&TNAME+&X&Y),AUTO=NO&EOT'   86730000
.IVLPND  ANOP                                                           86800005
&N       SETA  &N+1                BUMP INNERMOST LOOP COUNTER          86870005
         AGO   .IVL3               GO TO INNERMOST LOOP TEST            86940005
.IVL2T   ANOP                                                           87010005
&SCRPT   SETA  &SCRPT+&TRMNO(&SCRPT)+1    TRMNO ARRAY PTR      @Y17XAYP 87080000
&J       SETA  &J+1                BUMP INNER LOOP CONTROL VARIABLE     87150005
         AGO   .IVL2               GO INCREMENT INNERMOST LOOP CTR      87220005
.IVL1T   ANOP                                                           87290005
&I       SETA  &I+1                BUMP OUTER LOOP CONTROL VARIABLE     87360005
         AIF   (&I LE &NLG).IVL1   BR IF ALL LINEGRP'S NOT HANDLED      87430005
         AIF   (NOT &CPIDSW).CKSSCP                            @Y17XAYP 87436000
         AIF   (NOT &CPID1).ODDPRTY                            @OZ27297 87437082
 PUNCH 'CPIDE    DC    X''0288C9'''                            @OZ27297 87438082
.ODDPRTY ANOP                                                  @OZ27297 87439082
         AIF   (NOT &CPID2).CKSSCP                             @OZ27297 87440082
 PUNCH 'CPID      DC     X''0289C9'''                                   87442000
.CKSSCP  ANOP                                                  @Y17XAYP 87446000
         AIF   (&SNA NE 1).OLDTSMH  NO SSCP MH REQUIRED        @Y17XAYP 87450000
 PUNCH '         IEDMHGEN SSCP=YES'                            @Y17XAYP 87470000
TSOMH    TSOMH IEDHALT=&IEDHALT,LU=YES,INHDR=&INHDR,INBUF=&INBUF,      X87730082
               INMSG=&INMSG,OUTHDR=&OUTHDR,OUTBUF=&OUTBUF,             X87732082
               OUTMSG=&OUTMSG,LOGSCAN=&LOGSCAN                 @OY18934 87734082
         AGO    .PNDCBD                                        @Y17XAYP 87740000
.OLDTSMH ANOP                                                  @Y17XAYP 87750000
TSOMH    TSOMH INHDR=&INHDR,INBUF=&INBUF,INMSG=&INMSG,OUTBUF=&OUTBUF,  X88130082
               OUTHDR=&OUTHDR,OUTMSG=&OUTMSG,LOGSCAN=&LOGSCAN  @OY18934 88140082
.PNDCBD  ANOP                                                  @Y17XAYP 88160000
 PUNCH '         DCBD  DSORG=TX'                                        88270005
.ALLTHRU ANOP                                                           88340005
 PUNCH '         END'                                                   88410005
         MEND                                                           88480005
