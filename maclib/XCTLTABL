         MACRO                                                          00100002
&LABEL   XCTLTABL &ID=,&TAG=,&SVC=019,&LENGTH=1024,&PATCH=,&BRT=NO      00200002
         GBLC  &IECXCT                  LABEL FOR PATCH ARGUMENT Y02080 00202002
.*                                                                      00210002
.********************************************************************** 00250002
.*                                                                      00300000
.* MODULE NAME = XCTLTABL (VS2-2)                                       00350002
.*                                                                      00360002
.* DESCRIPTIVE NAME = O/C/E/D CSECT ADDRESSING MACRO                    00370002
.*                                                                      00372002
.* COPYRIGHT = NONE.                                                    00374002
.*                                                                      00376002
.* STATUS = CHANGE LEVEL 000                                            00378002
.*                                                                      00378402
.* FUNCTION = O/C/E/D MACRO USED TO PROVIDE ADDRESSABILITY TO EXTERNAL  00378802
.*            CSECTS VIA VCONS. THIS WILL ALLOW MANY CSECTS TO BE       00379202
.*            COMBINED INTO ONE LARGE LOAD MODULE. IN THIS WAY, CSECTS  00379602
.*            MAY BRANCH TO EACH OTHER INSTEAD OF USING THE XCTL        00379702
.*            FACILITY, THUS INCREASING PERFORMANCE. THIS MACRO ALSO    00379902
.*            PROVIDES A 5% PATCH AREA FOR CSECT MAINTENANCE.           00386602
.*            THIS MACRO ALSO ALLOWS FOR PAGE BOUNDRY CONSIDERATIONS.   00388602
.*            A STATUS/RECOGNITION AREA IS PROVIDED AT THE END OF A     00390602
.*            CSECT WHICH UTILIZES THIS MACRO.                          00392602
.*                                                                      00393002
.* NOTES = THIS MACRO IS AN INTERNAL MACRO USED IN THE FOLLOWING        00393102
.*         O/C/E/D FUNCTIONS:                                           00395102
.*                                                                      00400402
.*             OPEN                                                     00402002
.*             OPEN TYPE=J                                              00402402
.*             CLOSE                                                    00402802
.*             CLOSE TYPE=T                                             00402902
.*             EOV                                                      00403002
.*             FEOV                                                     00408602
.*             RDJFCB                                                   00418602
.*             DEBCHK                                                   00418702
.*             SCRATCH                                                  00419002
.*             RENAME                                                   00419402
.*             ALLOCATE                                                 00419802
.*             LSPACE                                                   00423102
.*             OBTAIN                                                   00425102
.*             EXTEND                                                   00425502
.*             PARTIAL RELEASE                                          00425902
.*                                                                      00426302
.*       IF A CSECT, REFERENCED BY A CALL OF THIS MACRO, EXISTS         00426402
.*       WITHIN THE SAME LOAD MODULE, A VCON WILL BE GENERATED          00431902
.*       TO POINT TO THE CSECT. IF THE CSECT EXISTS IN A DIFFERENT      00433902
.*       LOAD MODULE, A VCON OF ZERO WILL BE GENERATED.                 00434302
.*                                                                      00434402
.*      DEPENDENCIES = THIS MACRO IS DESIGNED TO BE USED IN             00435502
.*                     CONJUNCTION WITH THE IECRES MACRO, WTG TABLE     00437602
.*                     DEFINED IN THE IECDSECS MACRO, MODULE            00438002
.*                     IFG019RA, AND IN GENERAL WITH ALL O/C/E/D        00438402
.*                     ROUTINES.                                        00438602
.*                                                                      00438802
.*                     THIS MACRO IS DESIGNED TO BE USED IN A           00439202
.*                     VIRTUAL ADDRESSING SYSTEM WITH RELOCATE          00439302
.*                     CAPABILITY. THIS FEATURE MAKES THE XCTLTABL      00439402
.*                     GENERATED CODE, REENTRANT.                       00443602
.*                                                                      00448102
.*      RESTRICTIONS = THE ABOVE DESCRIPTION IS APPLICABLE ONLY IF      00452302
.*                     BRT=YES OR BRT=SHORT IN VS2 O/C/E/D CSECTS.      00456502
.*                     BRT=NO IS NOT USED IN O/C/E/D BUT IS             00460702
.*                     PROVIDED FOR COMPATIBILITY.                      00464902
.*                                                                      00469102
.*      REGISTER CONVENTIONS = REFERENCE THE SECTION OF CONSTANTS.      00469502
.*                                                                      00469902
.* PATCH LABEL = LBLNNNNC (LBL4 - SEE BELOW)                            00470302
.*                                                                      00470702
.* MODULE TYPE = MACRO                                                  00470802
.*                                                                      00470902
.*      PROCESSOR = ASSEMBLER LANGUAGE                                  00471002
.*                                                                      00478202
.*      MODULE SIZE = 16 BYTES/ID PARM + PATCH AREA + 24 BYTES STATUS   00480202
.*                                                                      00482202
.*      ATTRIBUTES = REENTRANT, REUSABLE, NONTRANSIENT                  00484202
.*                                                                      00484602
.* ENTRY POINT = LBLNNNNA (LBL1 - UNLESS SPECIFIED)                     00485002
.*                                                                      00485402
.*      PURPOSE = THIS MACRO WILL BUILD                                 00485502
.*                                                                      00508402
.*                1. VCON ENTRY POINT TABLE (TWO TYPES)                 00518402
.*                2. PATCH AREA FOR MAINTENANCE AND BOUNDRY ALLIGNMENT  00520402
.*                3. CSECT STATUS AREA FOR EASY IDENTIFICATION          00522402
.*                                                                      00528402
.*                THIS MACRO IS CALLED BY O/C/E/D CSECTS AT ASSEMBLY    00530402
.*                TIME TO EXPAND THE LAST PART OF THE EXECUTABLE CSECT  00530802
.*                LOAD MODULE OBJECT CODE.                              00531202
.*                                                                      00538802
.*      LINKAGE =                                                       00540802
.*                                                                      00541202
.*            LABEL XCTLTABL ID=LIST,SVC=CODE,LENGTH=NK,PATCH=N,BRT=YES 00542802
.*                                                                      00546602
.*      INPUT =                                                         00548602
.*                                                                      00549002
.*            BRT=NO IS NOT TO BE SPECIFIED AND IS NOT DESCRIBED HERE.  00549402
.*                                                                      00550602
.*            BRT=YES TO BE SPECIFIED FOR CSECTS UNDER 4K.              00551002
.*                                                                      00551102
.*            BRT=SHORT TO BE SPECIFIED FOR CSECTS OVER 4K OR FOR       00551202
.*                      MULTIPLE CALLS OF THIS MACRO. LAST CALL         00551302
.*                      OF THIS MACRO SHOULD SPECIFY BRT=YES.           00552702
.*                                                                      00558602
.*            LABEL SPECIFIED AS AN ACCEPTABLE ASSEMBLER LABEL, THE     00560002
.*                  FIRST THREE CHARACTERS ARE USED TO GENERATE OTHER   00561402
.*                  LABELS. IF NOT SPECIFIED, IHBNNNNA IS USED WHERE    00562802
.*                  NNNN IS GENERATED FROM SYSNDX.                      00564202
.*                                                                      00565602
.*            ID=LIST WHERE LIST IS OF THE FORM:                        00567002
.*                                                                      00568402
.*                    (LABEL1,CSECT1,LABEL2,CSECT2,...)                 00569802
.*                                                                      00571202
.*                    SEE DESCRIPTION BELOW.                            00572602
.*                                                                      00574002
.*            SVC=CODE WHERE CODE IS: 019,020,022,023,031,055,117.      00575402
.*                     IF SVC IS NOT SPECIFIED, DEFAULT IS 019.         00576802
.*                     IF SVC IS SPECIFIED AS NULL, CSECTS SPECIFIED    00578202
.*                     VIA THE ID PARAMETER MUST BE 8 CHARACTERS.       00579602
.*                                                                      00581002
.*            LENGTH=NK WHERE N IS 1-4 AND K INDICATES 1024 BYTES.      00582402
.*                      FOR MORE INFORMATION, SEE DESCRIPTION BELOW.    00583802
.*                                                                      00585202
.*            PATCH=N WHERE N IS THE NUMBER OF BYTES TO BE USED FOR A   00586602
.*                    PATCH AREA. SEE DESCRIPTION BELOW FOR MORE        00588002
.*                    INFORMATION.                                      00589402
.*                                                                      00590802
.*            SYSECT IS THE NAME OF THE CURRENT CSECT AUTOMATICALLY     00592202
.*                   SUPPLIED BY THE ASSEMBLER.                         00593602
.*                                                                      00595002
.*            SYSDATE IS THE CURRENT DATE AUTOMATICALLY SUPPLIED        00596402
.*                    BY THE ASSEMBLER.                                 00597802
.*                                                                      00599202
.*            SYSPARM IS A PARAMETER SPECIFIED IN THE PARM FIELD        00600602
.*                    OF THE ASSEMBLER. IF THE CHARACTER STRING         00602002
.*                    SDC=XXXXXX APPEARS WITHIN THE SYSPARMS            00603402
.*                    PARAMETERS THEN XXXXXX IS USED FOR PTF OR         00604802
.*                    APAR STATUS IDENTIFIERS.                          00606202
.*                                                                      00607602
.*            SYSNDX IS A UNIQUE 4 DIGIT NUMBER PROVIDED BY THE         00609002
.*                   ASSEMBLER USED IN GENERATING LABELS USED           00610402
.*                   WITH THIS MACRO.                                   00611802
.*                                                                      00613202
.*      OUTPUT =                                                        00614602
.*                                                                      00616002
.*                1. VCON ENTRY POINT TABLE (TWO TYPES)                 00617402
.*                                                                      00618802
.*                   IF ID=(NAME,CSECT) WHERE CSECT=2 CHARS             00620202
.*                                                                      00621602
.*                            DC    CL3'SVC'                            00623002
.*                   NAME     DC    CL2'CSECT',VL3(PFXSVCCSECT)         00624402
.*                                                                      00625802
.*                   PFX=(IGC/IFG/IGG) SVC=(019,055,020,...)            00627202
.*                                                                      00628602
.*                   IF ID=(NAME,CSECT) WHERE CSECT=8 CHARS             00630002
.*                                                                      00631402
.*                   NAME     DC    CL8'CSECT',V(CSECT)                 00634202
.*                                                                      00635602
.*                2. PATCH AREA FOR MAINTENANCE AND BOUNDRY ALLIGNMENT  00637002
.*                                                                      00638402
.*                   LBLNNNND DC (PATCH)X'00' OR                        00639802
.*                                                                      00641202
.*                   LBLNNNND DC (LENGTH-CSECT LENGTH-STATUS AREA)X'00' 00642602
.*                                                                      00644002
.*                3. CSECT STATUS AREA FOR EASY IDENTIFICATION          00645402
.*                   NOTE - NOT EXPANDED IF BRT=SHORT.                  00646102
.*                                                                      00646802
.*          &TAG     DC    0D'0'                                        00648202
.*                   DC    CL8.'SYSECT'                                 00649602
.*                   DC    CL8.'SYSDATE '                               00651002
.*                   DC    CL6.'SYSPARM '                               00652402
.*                   DC    AL2.(LBLNNNND-SYSECT)                        00653802
.*          LBLNNNNE DS    0D                                           00655202
.*          LBLNNNNF EQU   LENGTH                                       00655602
.*                                                                      00656602
.*                   ORG   SYSECT+LENGTH-(*-SYSECT)                     00658002
.*                                                                      00659402
.* EXIT NORMAL = MEND STATEMENT                                         00660802
.*                                                                      00662202
.* EXIT ERROR =                                                         00663602
.*                                                                      00665002
.*       MNOTE 12,'** INVALID ID PARAMETER - 'ID' **'                   00666402
.*       MNOTE 12,'** CSECT NAME INVALID - CSECT **'                    00667802
.*       MNOTE  4,'** INCORRECT OPERAND - LENGTH= **'                   00669202
.*                                                                      00670602
.* EXTERNAL REFERENCES = NONE.                                          00672002
.*                                                                      00673402
.*      ROUTINES = NONE.                                                00674802
.*                                                                      00676202
.*      DATA AREAS = REFERENCE CONSTANTS SECTION BELOW.                 00677602
.*                                                                      00679002
.*      CONTROL BLOCKS = NONE.                                          00680402
.*                                                                      00681802
.* TABLES = REFERENCE CONSTANTS SECTION BELOW.                          00683202
.*                                                                      00684602
.* MACROS = NONE.                                                       00686002
.*                                                                      00687402
.* CHANGE ACTIVITY = Y02080                                             00688802
.*                                                                      00690202
.********************************************************************** 00691602
.*                                                                      00693002
.*  THIS MACRO IS USED MAINLY BY OPEN/CLOSE/EOV TRANSIENT SVC           00694402
.*  MODULES TO BUILD AN XCTL IDTTRL TABLE.                              00695802
.*  THE TTRL IS FILLED IN BY THE SYSTEM UTILITY PROGRAM IEHIOSUP.       00697202
.*  A VALID NULL ENTRY IS REPRESENTED BY A '#' IN THE ID FIELD   XM5707 00698602
.*                                                                      00700000
         LCLA  &L40,&L41                LENGTHS FOR EQUATE CALCS        00900002
         LCLC  &PATCHLY,&PATCHLZ        NAMES FOR ASSEMBLED STATEMENTS  01000002
         LCLC  &PATCHL0,&PATCHL1        NAMES FOR ASSEMBLED STATEMENTS  01100000
         LCLC  &NAME                    EP NAME                  Y02080 01150002
.*                                                               Y02080 01210002
.********************************************************************** 01212002
.*                                                               Y02080 01220002
.*       BRT=YES LOCAL VARIABLES (ALSO BRT=SHORT)                Y02080 01230002
.*                                                               Y02080 01240002
.********************************************************************** 01240402
.*                                                               Y02080 01242002
         LCLA  &L0,&L1,&L2,&L3,&L4,&L5,&L6   DECIMAL CONSTANTS   Y02080 01247302
         LCLA  &L7,&L8,&L12,&L20,&L24,&L1024 DECIMAL CONSTANTS   Y02080 01249002
         LCLA  &C1,&C2,&C3,&C4          INDEXES                  Y02080 01250702
         LCLC  &X00                     HEX CONSTANTS            Y02080 01252402
         LCLC  &A,&B,&C,&D,&E,&F,&K     CHARACTER CONSTANTS      Y02080 01254102
         LCLC  &NULL1,&NULL2            NULL CONSTANTS           Y02080 01255802
         LCLC  &FFFF                    DELIMITERS               Y02080 01257502
         LCLC  &IHB,&IGC,&IGG,&IFG      LABEL CONSTANTS          Y02080 01259202
         LCLC  &L,&LBL,&LBL1,&LBL2      NAMES FOR ASM STATEMENTS Y02080 01260902
         LCLC  &LBL3,&LBL4,&LBL5        NAMES FOR ASM STATEMENTS Y02080 01262602
         LCLC  &LBL6,&LBL7,&LBL8        NAMES FOR ASM STATEMENTS Y02080 01263302
         LCLC  &OPEN,&CLOSE,&EOV        DECIMAL SVC NUMBERS      Y02080 01264302
         LCLC  &OPENJ,&TCLOSE,&FEOV     DECIMAL SVC NUMBERS      Y02080 01266002
         LCLC  &CSECT,&I,&CSECTID       GENERATED CSECT NAMES    Y02080 01267702
         LCLC  &PATCHL,&LNGTH,&N        CSECT LENGTHS            Y02080 01269402
         LCLC  &SDC,&CODE               PTF, APAR, S/D CODE      Y02080 01271102
.*                                                               Y02080 01272802
.********************************************************************** 01274502
.*                                                               Y02080 01276202
.*       TEST FOR BRT=YES                                        Y02080 01277902
.*                                                               Y02080 01279602
.********************************************************************** 01281302
.*                                                               Y02080 01283002
         AIF   ('&BRT' EQ 'YES').XCT0010 EXPAND BRANCH TABLE     Y02080 01284702
         AIF   ('&BRT' EQ 'SHORT').XCT0010 EXPAND BRANCH TABLE   Y02080 01286402
.*                                                               Y02080 01288102
.********************************************************************** 01289802
.*                                                               Y02080 01291502
.*       BRT=NO PROCESSING                                       Y02080 01293202
.*                                                               Y02080 01294902
.********************************************************************** 01296602
.*                                                               Y02080 01298302
         AIF   ('&LABEL' EQ '').A1      IF LABEL OMITTED                01300000
&NAME    SETC  '&LABEL'                 USE SPECIFIED LABEL NAME        01400000
         AGO   .A2                                                      01500000
.A1      ANOP                                                           01600000
&NAME    SETC  'IHB&SYSNDX.X'           DEFAULT NAME TO IHBNNNNX        01700000
.A2      ANOP                                                           01800000
&NAME    DC    0D'0'                    ALIGN TO DOUBLE WORD BOUNDARY   01900000
.*                                                                      02000000
         AIF   ('&SYSECT' LT '        ').A4  IF NOT 8 CHAR CSECT NAME   02100000
&IGG     SETC  '&SYSECT'(1,3)           FIRST 3 CHARS OF CSECT NAME     02200000
         AIF   ('&IGG' EQ 'IFG').A5     IFG MODULE REFERS TO IFG        02300000
         AIF   ('&IGG' EQ 'IGG').A5     IGG MODULE REFERS TO IGG        02400000
         AIF   ('&IGG' NE 'IGC').A4     IF NOT RECOGNIZABLE CSECT NAME  02500000
         AIF   ('&SVC' EQ '019').A3     IGC019 REFERS TO IFG019         02600000
         AIF   ('&SVC' EQ '020').A3     IGC020 REFERS TO IFG020         02700000
         AIF   ('&SVC' EQ '023').A3     IGC023 REFERS TO IFG023         02800000
         AIF   ('&SVC' EQ '055').A3     IGC055 REFERS TO IFG055         02900000
.*       NOTE THAT IGC0002B REFERS TO IFG019ID.                         03000000
&IGG     SETC  'IGG'                    ALL OTHER IGC REFER TO IGG      03100000
         AGO   .A5                                                      03200000
.A3      ANOP                                                           03300000
&IGG     SETC  'IFG'                    IGC019-055 REFERS TO IFG        03400000
         AGO   .A5                                                      03500000
.A4      ANOP                                                           03600000
&IGG     SETC  ''                       CAN NOT DETERMINE MODULE NAME   03700000
.*                                                                      03800000
.A5      ANOP                           START OF ID PARAMETER LOOP      03900000
&C1      SETA  &C2+1                    INCR C1 BY 2, START AT 1        04000000
&C2      SETA  &C1+1                    INCR C2 BY 2, START AT 2        04100000
         AIF   (&C1 GT N'&ID).A9        IF END OF ID PARAMETERS         04200000
         AIF   ('&ID(&C2)' EQ 'FFFF').A11  IF IFG/IGG DELIMITER         04250021
         AIF   ('&ID(&C2)' EQ '#').A5   NULL ENTRY LOOP          XM5707 04260001
         AIF   (K'&ID(&C2) NE 2).A8     ERROR IF MODULE ID NOT 2 CHAR   04300000
&I       SETC  '&ID(&C2)'               GET MODULE ID FROM LIST         04400000
         AIF   ('&IGG' NE '').A6        IF MODULE NAME KNOWN            04500000
&ID(&C1) DC    C'&I'                    ID OF MODULE                    04600000
         AGO   .A7                                                      04700000
.A6      ANOP  C'ID',0C'                ID OF MODULE IGG019ID'          04800000
&ID(&C1) DC    C'&I',0C'                ID OF MODULE &IGG&SVC&I'        04900000
.A7      DC    X'00000000'              TTRL                            05000000
         AGO   .A5                      LOOP ON ID PARAMETERS           05100000
.*                                                                      05110021
.A11     DC    X'FFFF'                  END OF IFG, START OF IGG        05120021
         AIF   ('&IGG' EQ '').A5        LOOP ON ID PARAMETERS           05130021
&IGG     SETC  'IGG'                    CHANGE FROM IFG TO IGG          05140021
         AGO   .A5                      LOOP ON ID PARAMETERS           05150021
.*                                                                      05200000
.A8      MNOTE 12,'** ID PARAMETER ''&ID(&C2)'' MUST HAVE 2 CHARS **'   05300000
.A9      DC    X'0000'                  END OF XCTL TABLE               05400000
*                                                                       05500000
         AIF   ('&PATCH' EQ '0').A20    IF MINIMUM LENGTH MODULE        05600000
&L20     SETA  &LENGTH-4                USUALLY 1020                    05700000
&L40     SETA  2*&L20                   USUALLY 2040                    05800000
&L41     SETA  &L40+1                   USUALLY 2041                    05900000
&PATCHLY SETC  'IHB&SYSNDX.Y'           SET NAME TO IBHNNNNY            06000000
&PATCHLZ SETC  'IHB&SYSNDX.Z'           SET NAME TO IBHNNNNZ            06100000
.*  IHBNNNNZ WILL NEVER BE NEGATIVE (OR LARGE POSITIVE).                06200000
.*  THIS DEVIOUS EQUATE PREVENTS A LONG LOOP IN ASSEMBLER F IF          06300000
.*  THE PATCH AREA LENGTH WOULD HAVE BEEN NEGATIVE.                     06400000
&PATCHLY EQU   *-&SYSECT                LENGTH BEFORE PATCH AREA        06500000
         AIF   ('&PATCH' NE '').A10     IF VARIABLE LENGTH WITH PATCH   06600000
&PATCHLZ EQU   (&L41-2*&PATCHLY)/(&L40-2*&PATCHLY)*(&L20-&PATCHLY)      06700000
         DC    (&PATCHLZ)X'00'          ZEROED PATCH AREA               06800000
*                                                                       06900000
         AGO   .A21                                                     07000000
.A10     ANOP                                                           07100000
&PATCHL0 SETC  'IHB&SYSNDX.0'           SET NAME TO IBHNNNN0            07200000
&PATCHL1 SETC  'IHB&SYSNDX.1'           SET NAME TO IBHNNNN1            07300000
&PATCHL0 EQU   (&L41-2*&PATCHLY)/(&L40-2*&PATCHLY)*(&L20-&PATCHLY)      07400000
&L20     SETA  &L20-&PATCH              USUALLY  970                    07500000
&L40     SETA  2*&L20                   USUALLY 1940                    07600000
&L41     SETA  &L40+1                   USUALLY 1941                    07700000
&PATCHL1 EQU   (&L41-2*&PATCHLY)/(&L40-2*&PATCHLY)*(&L20-&PATCHLY)      07800000
&PATCHLZ EQU   &PATCHL0-&PATCHL1        LENGTH OF PATCH AREA            07900000
         DC    (&PATCHLZ)X'00'          ZEROED PATCH AREA               08000000
*                                                                       08100000
.A20     CNOP  4,8                      ALIGN TO END MODULE ON DW       08200000
.A21     AIF   ('&SVC' EQ '019').A22    IF OPEN SVC CODE                08300000
         AIF   ('&SVC' EQ '020').A23    IF CLOSE SVC CODE               08400000
         AIF   ('&SVC' EQ '023').A24    IF TCLOSE SVC CODE              08500000
         AIF   ('&SVC' EQ '055').A25    IF EOV SVC CODE                 08600000
&TAG     DC    C'&SVC'                  SVC CODE                        08700000
         AGO   .A26                                                     08800000
.A22     ANOP                                                           08900000
&TAG     DC    C'019'                   OPEN SVC CODE                   09000000
         AGO   .A26                                                     09100000
.A23     ANOP                                                           09200000
&TAG     DC    C'020'                   CLOSE SVC CODE                  09300000
         AGO   .A26                                                     09400000
.A24     ANOP                                                           09500000
&TAG     DC    C'023'                   TCLOSE SVC CODE                 09600000
         AGO   .A26                                                     09700000
.A25     ANOP                                                           09800000
&TAG     DC    C'055'                   EOV SVC CODE                    09900000
.*                                                                      10000000
.A26     DC    AL1((&NAME-&SYSECT)/8)     DOUBLE WORDS TO XCTL TABLE    10100000
*                                                                XM0166 10150000
&PATCHLY SETC  'IHB&SYSNDX.E'           SET NAME TO IHBNNN E     XM0166 10200000
&PATCHLY EQU   *-&SYSECT                ACTUAL LENGTH OF MODULE  XM0166 10250000
&L40     SETA  2*&LENGTH+1              USUALLY 2049             XM0166 10300000
&L41     SETA  &L40+1                   USUALLY 2050             XM0166 10350000
         ORG   &SYSECT+(&L41-2*&PATCHLY)/(&L40-2*&PATCHLY)-1     XM0166 10400000
*                                                                XM0166 10450000
         MEXIT                                                   Y02080 10460002
.*                                                               Y02080 10462002
.XCT0010 ANOP                                                    Y02080 10462402
.*                                                               Y02080 10462802
.********************************************************************** 10464002
.*                                                               Y02080 10466002
.*       CONSTANTS                                               Y02080 10468002
.*                                                               Y02080 10468402
.********************************************************************** 10468502
.*                                                               Y02080 10468802
&L0      SETA  0                        CONSTANT ZERO            Y02080 10469202
&L1      SETA  1                        CONSTANT ONE             Y02080 10469402
&L2      SETA  2                        CONSTANT TWO             Y02080 10469502
&L3      SETA  3                        CONSTANT THREE           Y02080 10469602
&L4      SETA  4                        CONSTANT FOUR            Y02080 10469702
&L5      SETA  5                        CONSTANT FIVE            Y02080 10469802
&L6      SETA  6                        CONSTANT SIX             Y02080 10469902
&L7      SETA  7                        CONSTANT SEVEN           Y02080 10470002
&L8      SETA  8                        CONSTANT EIGHT           Y02080 10470102
&L12     SETA  12                       CONSTANT TWELVE          Y02080 10470202
&L20     SETA  20                       CONSTANT TWENTY          Y02080 10470302
&L24     SETA  24                       LENGTH OF PTF SECTION    Y02080 10470402
&L1024   SETA  1024                     CONSTANT 1024            Y02080 10470502
&C1      SETA  0                        ID PARAMETER INDEX       Y02080 10470602
&C2      SETA  0                        ID PARAMETER INDEX       Y02080 10470702
&A       SETC  'A'                      LABEL IDENTIFIER         Y02080 10471302
&B       SETC  'B'                      LABEL IDENTIFIER         Y02080 10475402
&C       SETC  'C'                      LABEL IDENTIFIER         Y02080 10475802
&D       SETC  'D'                      LABEL IDENTIFIER         Y02080 10475902
&E       SETC  'E'                      LABEL IDENTIFIER         Y02080 10476102
&F       SETC  'F'                      LABEL IDENTIFIER         Y02080 10476502
&X00     SETC  '00'                     HEX 00                   Y02080 10477002
&K       SETC  'K'                      K=1024 BYTES             Y02080 10477202
&NULL1   SETC  ''                       NULL CHARACTER STRING    Y02080 10477802
&NULL2   SETC  '#'                      NULL ID ENTRY            Y02080 10478402
&FFFF    SETC  'FFFF'                   ID DELIMITER             Y02080 10479002
&IHB     SETC  'IHB'                    LABEL CONVENTION         Y02080 10479602
&OPEN    SETC  '019'                    DECIMAL OPEN SVC NUMBER  Y02080 10480202
&OPENJ   SETC  '022'                    DECIMAL OPENJ SVC NUMBER Y02080 10480802
&CLOSE   SETC  '020'                    DECIMAL CLOSE SVC NUMBER Y02080 10481402
&TCLOSE  SETC  '023'                    DECIMAL TCLOSE SVC NO.   Y02080 10482002
&EOV     SETC  '055'                    DECIMAL EOV SVC NUMBER   Y02080 10482602
&FEOV    SETC  '031'                    DECIMAL FEOV SVC NUMBER  Y02080 10483202
&IFG     SETC  'IFG'                    IFG CSECT PREFIX         Y02080 10483802
&IGC     SETC  'IGC'                    IGC CSECT PREFIX         Y02080 10484402
&IGG     SETC  'IGG'                    IGG CSECT PREFIX         Y02080 10485002
&SDC     SETC  'SDC='                   SDC CODE=XXXXXX          Y02080 10485402
.*                                                               Y02080 10485602
.********************************************************************** 10486202
.*                                                               Y02080 10486802
.*       THIS SECTION DETERMINES A LABEL FOR THE BRANCH TABLE.   Y02080 10487402
.*                                                               Y02080 10488002
.********************************************************************** 10488602
.*                                                               Y02080 10489202
&LBL     SETC  '&IHB'                   EQUATE LABEL             Y02080 10489802
         AIF   ('&IECXCT' EQ '').XCT0013 MULTIPLE CALLS          Y02080 10490202
&LBL     SETC  '&IECXCT'(&L1,&L3)       DEFAULT LABEL            Y02080 10492302
         AGO   .XCT0014                 BYPASS DEFAULT           Y02080 10496202
.*                                                               Y02080 10496602
.XCT0013 ANOP                                                    Y02080 10497402
&IECXCT  SETC  '&SYSECT'                SET DEFAULT              Y02080 10497802
.*                                                               Y02080 10498002
.XCT0014 ANOP                                                    Y02080 10498302
&LBL1    SETC  '&LBL&SYSNDX&A'          DEFAULT NAME= IHBNNNNA   Y02080 10498402
         AIF   ('&LABEL' EQ '&NULL1').XCT0020 NAME SPECIFIED?    Y02080 10498502
         AIF   (K'&LABEL LT &L3).XCT0015 TEST FOR 3 CHARACTERS   Y02080 10499902
&LBL     SETC  '&LABEL'(&L1,&L3)        LABEL CONVENTION         Y02080 10501902
.XCT0015 ANOP                                                    Y02080 10503902
&LBL1    SETC  '&LABEL'                 LABEL SPECIFIED          Y02080 10505902
.*                                                               Y02080 10506302
.XCT0020 ANOP                                                    Y02080 10507902
&LBL2    SETC  '&LBL&SYSNDX&B'          LBLNNNNB                 Y02080 10509902
&LBL3    SETC  '&LBL&SYSNDX&C'          LBLNNNNC                 Y02080 10511902
&LBL4    SETC  '&LBL&SYSNDX&D'          LBLNNNND                 Y02080 10513902
&LBL5    SETC  '&LBL&SYSNDX&E'          LBLNNNNE                 Y02080 10515902
&LBL6    SETC  '&LBL&SYSNDX&F'          LBLNNNNF                 Y02080 10516402
&LBL7    SETC  '&IECXCT'                PATCH AREA ARGUMENT      Y02080 10516702
&IECXCT  SETC  '&LBL5'                  SAVE FOR MULTIPLE CALLS  Y02080 10517102
         LTORG                                                   Y02080 10517902
&LBL1    DC    &L0.D'&L0'               ALIGN & ZERO BOUNDARY    Y02080 10519902
.*                                                               Y02080 10521902
.********************************************************************** 10523902
.*                                                               Y02080 10525902
.*       THIS SECTION DETERMINES THE FIRST THREE CHARACTERS      Y02080 10527902
.*       OF A CSECT TO GET CONTROL FROM THIS ONE. THE NAMES      Y02080 10529902
.*       ARE IMPLIED BY THE CALLING CSECT IF NOT SPECIFIED.      Y02080 10531902
.*                                                               Y02080 10533902
.********************************************************************** 10535902
.*                                                               Y02080 10537902
         AIF   (K'&SYSECT LT &L8).XCT0040 BRANCH NOT 8 CHAR NAME Y02080 10539902
&CSECT   SETC  '&SYSECT'(&L1,&L3)       FIRST 3 CHARS OF NAME    Y02080 10541902
         AIF   ('&CSECT' EQ '&IFG').XCT0050 IFG GENERATES IFG    Y02080 10543902
         AIF   ('&CSECT' EQ '&IGG').XCT0050 IGG GENERATES IGG    Y02080 10545902
         AIF   ('&CSECT' NE '&IGC').XCT0050 UNRECOGNIZABLE NAME  Y02080 10547902
         AIF   ('&SVC' EQ '&OPEN').XCT0030  IGC019 GENERATES IFG Y02080 10549902
         AIF   ('&SVC' EQ '&OPENJ').XCT0030 IGC022 GENERATES IFG Y02080 10551902
         AIF   ('&SVC' EQ '&CLOSE').XCT0030 IGC020 GENERATES IFG Y02080 10569902
         AIF   ('&SVC' EQ '&TCLOSE').XCT0030 IGC023 GENRATES IFG Y02080 10573902
         AIF   ('&SVC' EQ '&EOV').XCT0030   IGC055 GENERATES IFG Y02080 10575902
         AIF   ('&SVC' EQ '&FEOV').XCT0030  IGC031 GENERATES IFG Y02080 10577902
&CSECT   SETC  '&IGG'                   OTHER IGC GENERATE IGG   Y02080 10591902
         AGO   .XCT0050                 CONTINUE                 Y02080 10593902
.XCT0030 ANOP                                                    Y02080 10595902
&CSECT   SETC  '&IFG'                   GENERATE IFG PREFIX      Y02080 10597902
         AGO   .XCT0050                 CONTINUE                 Y02080 10598302
.XCT0040 ANOP                                                    Y02080 10598702
&IGG     SETC  '&NULL1'                 CAN NOT DETERMINE PREFIX Y02080 10599102
.*                                                               Y02080 10599502
.********************************************************************** 10609502
.*                                                               Y02080 10649502
.*       THIS SECTION WILL EVALUATE THE ID PARAMETER.            Y02080 10659502
.*       ID FORMAT= (LABEL1,CSECT1,LABEL2,CSECT2,...)            Y02080 10669502
.*       IF LABEL IS NOT SPECIFIED, LABEL=CSECT (PFXSVCID).      Y02080 10679502
.*       IF CSECT IS NOT SPECIFIED OR IS NOT 2 OR 8 CHARACTERS,  Y02080 10681502
.*       A MNOTE MESSAGE WILL BE GENERATED. IF CSECT IS THE      Y02080 10683502
.*       CHARACTER # THE LABEL AND CSECT PARAMETERS ARE IGNORED. Y02080 10685502
.*       NOTE-IF CSECT=FFFF, THE CSECT PREFIX IS CHANGED TO IGG. Y02080 10685902
.*       IF CSECT IS 2 CHARACTERS, THE ENTRY FORMAT IS-          Y02080 10687502
.*                                                               Y02080 10687602
.*       DC    CL3'&SVC'                ALIGN BOUNDARY FOR VCON  Y02080 10687902
.*LABEL  DC    CL2'ID',0C               ID OF CSECT PFXSVCID     Y02080 10688302
.*       DC    VL3(PFXSVCID)            VIRTUAL ADDRESS OF CSECT Y02080 10688702
.*                                                               Y02080 10697702
.*       IF CSECT IS 8 CHARACTERS, THE ENTRY FORMAT IS-          Y02080 10706502
.*                                                               Y02080 10708502
.*LABEL  DC    CL8'CSECT',V(CSECT)      CSECT NAME AND ADDRESS   Y02080 10715102
.*                                                               Y02080 10723702
.********************************************************************** 10725702
.*                                                               Y02080 10732302
.XCT0050 ANOP                           EVALUATE ID PARAMETER    Y02080 10740902
&C1      SETA  &C2+&L1                  C1=C1+2, START AT LABEL1 Y02080 10742902
&C2      SETA  &C1+&L1                  C2=C2+2, START AT CSECT1 Y02080 10746902
         AIF   (&C2 GT N'&ID).XCT0120   TEST FOR END OF ID PARMS Y02080 10748902
&L       SETC  '&ID(&C1)'               L=LABEL                  Y02080 10749402
&I       SETC  '&ID(&C2)'               I=CSECT ID OR NAME       Y02080 10766002
         AIF   ('&I' EQ '&FFFF').XCT0110 CONVERT PREFIX TO IGG   Y02080 10799402
         AIF   ('&I' EQ '&NULL2').XCT0050 NULL ENTRY, LOOP       Y02080 10809402
         AIF   (K'&I EQ &L2).XCT0060    ENTRY FOR FORMAT 1       Y02080 10819402
         AIF   (K'&I EQ &L8).XCT0090    ENTRY FOR FORMAT 2       Y02080 10829402
         MNOTE &L12,'** INVALID ID PARAMETER - ''&I'' **'        Y02080 10839402
         AGO   .XCT0050                 CONTINUE FOR MORE ERRORS Y02080 10841402
.*                                                               Y02080 10843502
.XCT0060 ANOP                           BUILD CSECT NAME         Y02080 10843802
&CSECTID SETC  '&CSECT&SVC&I'           PREFIX/SVC/ID            Y02080 10844202
         AIF   (K'&CSECTID EQ &L8).XCT0070 TEST FOR 8 CHAR NAME  Y02080 10846202
         MNOTE &L12,'** CSECT NAME INVALID - &CSECTID **'        Y02080 10847402
         AGO   .XCT0050                 CONTINUE FOR MORE ERRORS Y02080 10847802
.*                                                               Y02080 10847902
.XCT0070 AIF   ('&L' NE '&NULL1').XCT0080 LABEL=NULL             Y02080 10848202
&L       SETC  '&CSECTID'               LABEL=CSECT NAME         Y02080 10848602
.*                                                               Y02080 10848702
.XCT0080 ANOP                           GENERATE FORMAT 1 ENTRY  Y02080 10849002
         DC    CL&L3.'&SVC'             ALIGN BOUNDARY FOR VCON  Y02080 10849102
&L       DC    CL2'&I',0C'              ID FOR &CSECTID'         Y02080 10849202
         DC    VL3(&CSECTID),0C'        ADDRESS OF &CSECTID'     Y02080 10849302
         AGO   .XCT0050                 LOOP                     Y02080 10899302
.*                                                               Y02080 10909302
.XCT0090 AIF   ('&L' NE '&NULL1').XCT0100 LABEL=NULL             Y02080 10919302
&L       SETC  '&I'                     LABEL=CSECT NAME         Y02080 10929302
.*                                                               Y02080 10939302
.XCT0100 ANOP                           GENERATE FORMAT 2 ENTRY  Y02080 10941302
&CSECTID SETC  '&I'                     8 CHARACTER CSECT NAME   Y02080 10943302
&L       DC    CL8'&CSECTID',0C'        &CSECTID LPALIB NAME'    Y02080 10947302
         DC    V(&CSECTID),0C'          &CSECTID VIRTUAL ADDR'   Y02080 10947702
         AGO   .XCT0050                 LOOP                     Y02080 10948102
.*                                                               Y02080 10948502
.XCT0110 ANOP                           CHANGE TO PREFIX=IGG     Y02080 10948902
&CSECT   SETC  '&IGG'                   PREFIX=IGG               Y02080 10949002
         AGO   .XCT0050                 LOOP                     Y02080 10949102
.*                                                               Y02080 10949202
.********************************************************************** 10959202
.*                                                               Y02080 10999202
.*       THIS SECTION COMPUTES THE PATCH AREA FOR THIS CSECT.    Y02080 11009202
.*       IF PATCH=0 IS SPECIFIED, NO PATCH AREA IS GENERATED.    Y02080 11019202
.*       IF LENGTH=NK IS SPECIFIED, PATCH OPERAND IS IGNORED.    Y02080 11021202
.*       IF LENGTH=NK IS NOT SPECIFIED AND PATCH IS NOT          Y02080 11025202
.*       SPECIFIED, THEN THE PATCH AREA IS 5% OF THE TOTAL       Y02080 11027602
.*       LENGTH OF THE CSECT OR 5% OF THE LENGTH BETWEEN         Y02080 11028002
.*       MACRO CALLS.                                            Y02080 11028802
.*                                                               Y02080 11029202
.********************************************************************** 11031202
.*                                                               Y02080 11039202
.XCT0120 AIF   ('&LENGTH' EQ '&NULL1').XCT0130 GO COMPUTE PATCH  Y02080 11041302
         AIF   ('&LENGTH'(K'&LENGTH,&L1) EQ '&K').XCT0160 =NK?   Y02080 11041402
.*                                                               Y02080 11041702
.XCT0130 AIF   ('&PATCH' EQ '&NULL1').XCT0140 GO COMPUTE PATCH   Y02080 11041902
&PATCHL  SETC  '&PATCH'                 PATCH AREA LENGTH        Y02080 11042302
         AGO   .XCT0150                 CONTINUE                 Y02080 11042402
.*                                                               Y02080 11042502
.XCT0140 ANOP                           PATCH AREA LENGTH=5%     Y02080 11042602
&PATCHL  SETC  '&LBL2/&L20'             PATCH AREA LENGTH= 5 0/0 Y02080 11042702
.*                                                               Y02080 11042802
.XCT0150 ANOP                           TOTAL LENGTH WITH PATCH  Y02080 11042902
&LNGTH   SETC  '(((&LBL4-&SYSECT+&LBL3+&L24)+&L7)/&L8)*&L8' LEN  Y02080 11043002
         AGO   .XCT0180                 CONTINUE                 Y02080 11045402
.*                                                               Y02080 11045802
.XCT0160 AIF   (K'&LENGTH NE &L2).XCT0170 LENGTH=NK              Y02080 11046202
&N       SETC  '&LENGTH'(&L1,&L1)       N=NK                     Y02080 11046602
&C3      SETA  &N                       C3=N                     Y02080 11047002
&C4      SETA  &C3*&L1024               C4 = C3 X 1024 = NK      Y02080 11047402
&LNGTH   SETC  '&C4'                    TOTAL LENGTH IN BYTES    Y02080 11047802
         AIF   (&C3 LT &L1 OR &C3 GT &L4).XCT0170 TEST LIMITS    Y02080 11048202
         AIF   ('&BRT' EQ 'SHORT').XCT0165 TEST FOR SHORT TABLE  Y02134 11048302
&PATCHL  SETC  '&LNGTH-&LBL2-&L24'      PATCH=LENGTH-CSECT LNGTH Y02080 11048602
         AGO   .XCT0180                 CONTINUE                 Y02080 11049002
.*                                                               Y02080 11049402
.XCT0165 ANOP                                                    Y02134 11049502
&PATCHL  SETC  '&LNGTH-&LBL2'           PATCH=LENGTH-CSECT LNGTH Y02080 11049702
         AGO   .XCT0180                 CONTINUE                 Y02080 11049802
.*                                                               Y02080 11049902
.XCT0170 MNOTE &L4,'** INCORRECT OPERAND - LENGTH=&LENGTH **'    Y02080 11050002
.*                                                               Y02080 11050202
.XCT0180 ANOP                                                    Y02080 11050602
&LBL2    EQU   *-&LBL7                  LENGTH BEFORE PATCH AREA Y02080 11051202
&LBL3    EQU   &PATCHL                  LENGTH OF PATCH AREA     Y02080 11051802
&LBL4    DC    (&LBL3)X'&X00'           ZEROED PATCH AREA        Y02080 11052402
.*                                                               Y02080 11053002
         AIF   ('&BRT' NE 'SHORT').XCT0185 MULTIPLE CALLS        Y02080 11053102
&LBL5    DC    0D'0'                    END OF TABLE             Y02080 11053202
         MEXIT                                                   Y02080 11053402
.*                                                               Y02080 11055202
.XCT0185 ANOP                                                    Y02080 11057202
.*                                                               Y02080 11059902
.********************************************************************** 11061802
.*                                                               Y02080 11063702
.*       THE FOLLOWING SECTION IS NECESSARY TO RECORD            Y02080 11065602
.*       INFORMATION AS TO CSECT STATUS. NOTE. THE SYSPARMS=     Y02080 11067502
.*       PARAMETER IN THE PARM FIELD OF THE ASSEMBLER            Y02080 11069402
.*       WILL BE SCANNED FOR SDC=XXXXXX AND XXXXXX               Y02080 11071302
.*       WILL BE PLACED INTO A CHARACTER STRING BELOW.           Y02080 11073202
.*                                                               Y02080 11075102
.********************************************************************** 11077002
.*                                                               Y02080 11078902
&CODE    SETC  'Y02080'                 DEFAULT IF NO SYSPARM    Y02080 11080802
&C1      SETA  &L1                      SET C1=1                 Y02080 11082702
.XCT0190 AIF   (K'&SDC+&C1+&L5 GT K'&SYSPARM).XCT0210            Y02080 11084602
         AIF   ('&SYSPARM'(&C1,K'&SDC) EQ '&SDC').XCT0200        Y02080 11086502
&C1      SETA  &C1+&L1                  C1=C1+1                  Y02080 11088402
         AGO   .XCT0190                 LOOP                     Y02080 11090302
.*                                                               Y02080 11092202
.XCT0200 ANOP                           SET SDC CODE             Y02080 11094102
&CODE    SETC  '&SYSPARM'(&C1+K'&SDC,&L6) SYSPARM CODE = XXXXXX  Y02080 11096002
.*                                                               Y02080 11097902
.XCT0210 ANOP                                                    Y02080 11099002
&TAG     DC    &L0.D'&L0'               ALIGN & ZERO BOUNDARY    Y02080 11099802
         DC    CL&L8.'&SYSECT'          CSECT NAME               Y02080 11101702
         DC    CL&L8.'&SYSDATE '        DATE OF ASSEMBLY         Y02080 11103602
         DC    CL&L6.'&CODE'            RELEASE OR PTF NUMBER    Y02080 11105502
         DC    AL&L2.(&LBL5-&SYSECT)    LENGTH OF CSECT          Y02080 11107402
&LBL5    DS    &L0.D                    END OF CSECT             Y02080 11109302
&LBL6    EQU   &LNGTH                                      TOTAL Y02080 11109702
*                                                                Y02080 11111202
*********************************************************************** 11113102
*        THE FOLLOWING INSTRUCTION WILL CAUSE AN ASSEMBLY        Y02080 11115002
*        ERROR IF THIS MODULE IS TOO LONG.                       Y02080 11116902
*********************************************************************** 11118802
*                                                                Y02080 11128802
         ORG   &SYSECT+&LBL6-(*-&SYSECT)                         Y02080 11148802
*                                                                Y02080 11158802
*********************************************************************** 11168802
         MEND                                                    XM0166 11198802
