         TITLE '*************** IDCAL01: IDCAMS ALTER ROUTINE **********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCAL01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCAL01   77.271'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         LA    @08,4095(,@09)                                      0002 00025000
         USING @PSTART,@12                                         0002 00026000
         USING @PSTART+4095,@11                                    0002 00027000
         USING @PSTART+8190,@10                                    0002 00028000
         USING @PSTART+12285,@09                                   0002 00029000
         USING @PSTART+16380,@08                                   0002 00030000
         L     @00,@SIZDATD                                        0002 00031000
         GETMAIN  R,LV=(0)                                              00032000
         LR    @07,@01                                             0002 00033000
         USING @DATD,@07                                           0002 00034000
         ST    @13,@SA00001+4                                      0002 00035000
         LM    @00,@01,20(@13)                                     0002 00036000
         ST    @07,8(,@13)                                         0002 00037000
         LR    @13,@07                                             0002 00038000
         MVC   @PC00001(12),0(@01)                                 0002 00039000
*        /************************************************************/ 00040000
*        /*                                                          */ 00041000
*        /* ENTRY POINT TO IDCAL01                           @Y30SSJH*/ 00042000
*        /* REMOVE THE CATALOG DNAME PTR SO THE CATALOG CAN BE       */ 00043000
*        /*  DYNAMICALLY ALLOCATED BY VSAM CATALOG MGMT.     @YL026UA*/ 00044000
*        /*                                                  @YL026UA*/ 00045000
*        /************************************************************/ 00046000
*                                                                  0325 00047000
*        OLDERID2 = NEWERID2;                                      0325 00048000
         L     @06,@PC00001                                        0325 00049000
         L     @15,GDTTR2(,@06)                                    0325 00050000
         MVC   @TS00001(95),NEWERID2(@15)                          0325 00051000
         MVC   OLDERID2(95,@15),@TS00001                           0325 00052000
*        NEWID2 = 'AL01';                                          0326 00053000
         MVC   NEWID2(4,@15),@CC01147                              0326 00054000
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/ 00055000
*        RESPECIFY CIRAGL BASED(CIRPTR);                   /*@YL026UA*/ 00056000
*                                                                  0328 00057000
*        /************************************************************/ 00058000
*        /*                                                          */ 00059000
*        /* PRELIMINARY INITIALIZATION                               */ 00060000
*        /*                                                          */ 00061000
*        /************************************************************/ 00062000
*                                                                  0329 00063000
*        ALSTID = NORMAL;              /* SET NORMAL STATUS INDICATOR*/ 00064000
         MVC   ALSTID(5),@CB01034                                  0329 00065000
*        ALSTIDLB = 'HERE I AM';       /* DUMP ID FOR ALSTID         */ 00066000
         MVC   ALSTIDLB(9),@CC01394                                0330 00067000
*        CATRTNID = 'CATLGRTN';        /* DUMP ID FOR CATLG RTN CODE */ 00068000
         MVC   CATRTNID(8),@CC01396                                0331 00069000
*        CATACBPT = NULLPTR;           /* ZERO CATLG ACB POINTER     */ 00070000
         SLR   @15,@15                                             0332 00071000
         ST    @15,CATACBPT                                        0332 00072000
*        DALCINDX = NULLPTR;           /* SET ALLOCATION INDEX       */ 00073000
         ST    @15,DALCINDX                                        0333 00074000
*        LOCTABLE = ''B;               /* INITILAIZE LOCTABLE TO ZERO*/ 00075000
         XC    LOCTABLE(80),LOCTABLE                               0334 00076000
*        OPNPTR   = ADDR(ALOPNAGL);    /* SET POINTER TO OPNAGL      */ 00077000
         LA    @14,ALOPNAGL                                        0335 00078000
         ST    @14,OPNPTR                                          0335 00079000
*        DDSTRU   = ADDR(DARGAREA);    /* SET POINTER TO DARGLIST    */ 00080000
         LA    @14,DARGAREA                                        0336 00081000
         ST    @14,DDSTRU                                          0336 00082000
*        ERCNVADR = ADDR(ALERRTBL);    /*SET POINTER TO ERROR TABLE     00083000
*                                                            @Y30SSJH*/ 00084000
         LA    @14,ALERRTBL                                        0337 00085000
         ST    @14,ERCNVADR                                        0337 00086000
*        IOCSPTR  = NULLPTR;           /* ZERO IOCSPOINTER           */ 00087000
         ST    @15,IOCSPTR                                         0338 00088000
*        BYPASSSW = GO;                /* ZERO BYPASS SECURITY     0339 00089000
*                                         SWITCH             @Y30SSJH*/ 00090000
         MVI   BYPASSSW,X'00'                                      0339 00091000
*        KEYRECRC = 0;                 /* INITIALIZE KEYS/RECORDSIZE    00092000
*                                         RETURN CODE        @Y30SSJH*/ 00093000
         ST    @15,KEYRECRC                                        0340 00094000
*        DATACI = INITVALU;            /* INITIALIZE CI VARIABLE   0341 00095000
*                                                            @Y30SSJH*/ 00096000
         MVC   DATACI(3),INITVALU                                  0341 00097000
*        INDEXCI = INITVALU;           /* INITIALIZE CI VARIABLE   0342 00098000
*                                                            @Y30SSJH*/ 00099000
         MVC   INDEXCI(3),INITVALU                                 0342 00100000
*        BDATACI = INITVALU;           /* INITIALIZE CI VARIABLE   0343 00101000
*                                                            @Y30SSJH*/ 00102000
         MVC   BDATACI(3),INITVALU                                 0343 00103000
*        BCLUSCI = INITVALU;           /* INITIALIZE CI VARIABLE   0344 00104000
*                                                            @Y30SSJH*/ 00105000
         MVC   BCLUSCI(3),INITVALU                                 0344 00106000
*        RFY IDAAMDSB BASED(DSBCATPT); /* ESTABLISH AMDSB ADDRESS    */ 00107000
*                                                                  0345 00108000
*        /************************************************************/ 00109000
*        /*                                                          */ 00110000
*        /* GET DYNAMIC STORAGE FOR THE PARAMETER LISTS WHICH        */ 00111000
*        /* COMPRISE THE CPL-FVT-FPL COMPLEX                         */ 00112000
*        /*                                                          */ 00113000
*        /************************************************************/ 00114000
*                                                                  0346 00115000
*        CALL IDCSAGP0(GDTTBL,                                     0346 00116000
*               (LENGTH(ALCTGPRM)),    /* LENGTH OF STORAGE REQUEST  */ 00117000
*               ALPRMPTR,              /* ADDRESS OF DYNAMIC STORAGE */ 00118000
*               ALGPID,                /* UGPOOL ID                  */ 00119000
*                SETZERO);             /* SET AREA TO ZERO           */ 00120000
*                                                                  0346 00121000
         ST    @06,@AL00001                                        0346 00122000
         LA    @15,632                                             0346 00123000
         ST    @15,@AFTEMPS+12                                     0346 00124000
         LA    @15,@AFTEMPS+12                                     0346 00125000
         ST    @15,@AL00001+4                                      0346 00126000
         LA    @15,ALPRMPTR                                        0346 00127000
         ST    @15,@AL00001+8                                      0346 00128000
         LA    @15,ALGPID                                          0346 00129000
         ST    @15,@AL00001+12                                     0346 00130000
         LA    @15,SETZERO                                         0346 00131000
         ST    @15,@AL00001+16                                     0346 00132000
         MVI   @AL00001+16,X'80'                                   0346 00133000
         L     @15,GDTGPL(,@06)                                    0346 00134000
         LA    @01,@AL00001                                        0346 00135000
         BALR  @14,@15                                             0346 00136000
*        RESPECIFY RTNREG RSTD;                                    0347 00137000
*        TESTRC = RTNREG;                                          0348 00138000
         STH   RTNREG,TESTRC                                       0348 00139000
*        RESPECIFY RTNREG UNRSTD;                                  0349 00140000
*                                                                  0349 00141000
*        /************************************************************/ 00142000
*        /*                                                          */ 00143000
*        /* STORAGE NOT AVAILABLE - TERMINAL ERROR                   */ 00144000
*        /*                                                          */ 00145000
*        /************************************************************/ 00146000
*                                                                  0350 00147000
*        IF TESTRC ^= 0                                            0350 00148000
*          THEN                                                    0350 00149000
         LH    @06,TESTRC                                          0350 00150000
         LTR   @06,@06                                             0350 00151000
         BZ    @RF00350                                            0350 00152000
*            ALSTID = NOSTORAG;                                    0351 00153000
*                                                                  0351 00154000
         MVC   ALSTID(5),@CB01039                                  0351 00155000
*     IF ALSTID = NORMAL                                           0352 00156000
*       THEN                                                       0352 00157000
@RF00350 CLC   ALSTID(5),@CB01034                                  0352 00158000
         BNE   @RF00352                                            0352 00159000
*GOODCAT: DO;                                              /*@YL026UA*/ 00160000
*                                                                  0353 00161000
GOODCAT  DS    0H                                                  0354 00162000
*         ENTRYVAL = NTRYVAL;                              /*@YL026UA*/ 00163000
         L     @06,@PC00001+4                                      0354 00164000
         L     @06,FDTPTR(,@06)                                    0354 00165000
         MVC   ENTRYVAL(44),NTRYVAL(@06)                           0354 00166000
*         ENTRYLEN = NTRYLEN;                              /*@YL026UA*/ 00167000
*                                                                  0355 00168000
         SLR   @15,@15                                             0355 00169000
         IC    @15,NTRYLEN(,@06)                                   0355 00170000
         STH   @15,ENTRYLEN                                        0355 00171000
*        /************************************************************/ 00172000
*        /*                                                  @YL026UA*/ 00173000
*        /*  IF THE ENTRY IS NOT FULLY QUALIFIED - ISSUE     @YL026UA*/ 00174000
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIER        */ 00175000
*        /*                                                  @YL026UA*/ 00176000
*        /************************************************************/ 00177000
*                                                                  0356 00178000
*          IF NTRYFUQ = ON                                         0356 00179000
*            THEN                                                  0356 00180000
         TM    NTRYFUQ(@06),B'10000000'                            0356 00181000
         BNO   @RF00356                                            0356 00182000
*              DO;                                         /*@YL026UA*/ 00183000
*                QUALLIST = ''B;                           /*@YL026UA*/ 00184000
         XC    QUALLIST(12),QUALLIST                               0358 00185000
*                QUALADDR = ADDR(ENTRYVAL);                /*@YL026UA*/ 00186000
         LA    @15,ENTRYVAL                                        0359 00187000
         ST    @15,QUALADDR                                        0359 00188000
*                IF NTRYPLN ^= 0                                   0360 00189000
*                  THEN                                            0360 00190000
         CLI   NTRYPLN(@06),0                                      0360 00191000
         BE    @RF00360                                            0360 00192000
*                    QUALPAS = ADDR(NTRYPAS);              /*@YL026UA*/ 00193000
         LA    @06,NTRYPAS(,@06)                                   0361 00194000
         ST    @06,QUALPAS                                         0361 00195000
*                IF ADDR(CATLG) ^= NULLPTR & CATLGLEN ^= 0         0362 00196000
*                  THEN                                            0362 00197000
@RF00360 L     @06,@PC00001+4                                      0362 00198000
         L     @06,FDTPTR+8(,@06)                                  0362 00199000
         LTR   @06,@06                                             0362 00200000
         BZ    @RF00362                                            0362 00201000
         CLI   CATLGLEN(@06),0                                     0362 00202000
         BE    @RF00362                                            0362 00203000
*                    DO;                                   /*@YL026UA*/ 00204000
*                      QUALCAT = ADDR(CATLGVAL);           /*@YL026UA*/ 00205000
         LA    @15,CATLGVAL(,@06)                                  0364 00206000
         ST    @15,QUALCAT                                         0364 00207000
*                      IF CATLGPLN ^= 0                            0365 00208000
*                        THEN                                      0365 00209000
         CLI   CATLGPLN(@06),0                                     0365 00210000
         BE    @RF00365                                            0365 00211000
*                          QUALPAS = ADDR(CATLGPAS);       /*@YL026UA*/ 00212000
         LA    @06,CATLGPAS(,@06)                                  0366 00213000
         ST    @06,QUALPAS                                         0366 00214000
*                    END;                                  /*@YL026UA*/ 00215000
*                                                                  0367 00216000
@RF00365 DS    0H                                                  0368 00217000
*                CALL IDCSAQL0(GDTTBL,QUALADDR,ENTRYLEN,QUALCAT,QUALPAS 00218000
*;                                                                 0368 00219000
@RF00362 L     @06,@PC00001                                        0368 00220000
         ST    @06,@AL00001                                        0368 00221000
         LA    @15,QUALADDR                                        0368 00222000
         ST    @15,@AL00001+4                                      0368 00223000
         LA    @15,ENTRYLEN                                        0368 00224000
         ST    @15,@AL00001+8                                      0368 00225000
         LA    @15,QUALCAT                                         0368 00226000
         ST    @15,@AL00001+12                                     0368 00227000
         LA    @15,QUALPAS                                         0368 00228000
         ST    @15,@AL00001+16                                     0368 00229000
         MVI   @AL00001+16,X'80'                                   0368 00230000
         L     @15,GDTQAL(,@06)                                    0368 00231000
         LA    @01,@AL00001                                        0368 00232000
         BALR  @14,@15                                             0368 00233000
*                                                          /*@YL026UA*/ 00234000
*                RESPECIFY RTNREG RSTD;                            0369 00235000
*                TESTRC = RTNREG;                                  0370 00236000
         STH   RTNREG,TESTRC                                       0370 00237000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/ 00238000
*                IF TESTRC ^= 0                                    0372 00239000
*                  THEN                                            0372 00240000
         LH    @06,TESTRC                                          0372 00241000
         LTR   @06,@06                                             0372 00242000
         BZ    @RF00372                                            0372 00243000
*                    ALSTID = TERMERR;                     /*@YL026UA*/ 00244000
         MVC   ALSTID(5),@CB01042                                  0373 00245000
*              END;                                        /*@YL026UA*/ 00246000
*                                                                  0374 00247000
@RF00372 DS    0H                                                  0375 00248000
*        IF (ADDR(NEWNM)) ^= NULLPTR                               0375 00249000
*         THEN                                                     0375 00250000
@RF00356 L     @06,@PC00001+4                                      0375 00251000
         L     @15,FDTPTR+16(,@06)                                 0375 00252000
         LTR   @15,@15                                             0375 00253000
         BZ    @RF00375                                            0375 00254000
*          DO;                                             /*@YL026UA*/ 00255000
*          NEWNAME = NEWNMVAL;                             /*@YL026UA*/ 00256000
*                                                                  0377 00257000
         MVC   NEWNAME(44),NEWNMVAL(@15)                           0377 00258000
*        /************************************************************/ 00259000
*        /*                                                  @YL026UA*/ 00260000
*        /*  IF THE NEWNAME IS NOT FULLY QUALIFIED - USE     @YL026UA*/ 00261000
*        /*  THE QUALIFIER FROM ENTRY UQUAL AS QUALIFIER     @YL026UA*/ 00262000
*        /*  ALSO CHECK FOR PROPER NEWNAME GENERICS          @YL026UA*/ 00263000
*        /*                                                  @YL026UA*/ 00264000
*        /************************************************************/ 00265000
*                                                                  0378 00266000
*          IF NEWNMFUQ = ON & ENTRYLEN ^= NTRYLEN                  0378 00267000
*            THEN                                                  0378 00268000
         TM    NEWNMFUQ(@15),B'10000000'                           0378 00269000
         BNO   @RF00378                                            0378 00270000
         L     @06,FDTPTR(,@06)                                    0378 00271000
         SLR   @14,@14                                             0378 00272000
         IC    @14,NTRYLEN(,@06)                                   0378 00273000
         CH    @14,ENTRYLEN                                        0378 00274000
         BE    @RF00378                                            0378 00275000
*              NEWNAME(NEWNMLEN + 1:44) = ENTRYVAL(NTRYLEN + 1:44);     00276000
         SLR   @06,@06                                             0379 00277000
         IC    @06,NEWNMLEN(,@15)                                  0379 00278000
         LA    @01,NEWNAME(@06)                                    0379 00279000
         LCR   @06,@06                                             0379 00280000
         AL    @06,@CF00684                                        0379 00281000
         LA    @15,ENTRYVAL(@14)                                   0379 00282000
         EX    @06,@SM01681                                        0379 00283000
*          IF NTRYPOS ^= 0 & NEWNMPOS = 0 |                        0380 00284000
*            NTRYPOS = 0 & NEWNMPOS ^= 0                           0380 00285000
*            THEN                                                  0380 00286000
@RF00378 L     @06,@PC00001+4                                      0380 00287000
         L     @01,FDTPTR(,@06)                                    0380 00288000
         CLI   NTRYPOS(@01),0                                      0380 00289000
         BE    @GL00003                                            0380 00290000
         L     @06,FDTPTR+16(,@06)                                 0380 00291000
         CLI   NEWNMPOS(@06),0                                     0380 00292000
         BE    @RT00380                                            0380 00293000
@GL00003 L     @06,@PC00001+4                                      0380 00294000
         L     @01,FDTPTR(,@06)                                    0380 00295000
         CLI   NTRYPOS(@01),0                                      0380 00296000
         BNE   @RF00380                                            0380 00297000
         L     @06,FDTPTR+16(,@06)                                 0380 00298000
         CLI   NEWNMPOS(@06),0                                     0380 00299000
         BE    @RF00380                                            0380 00300000
@RT00380 DS    0H                                                  0381 00301000
*                DO;                                       /*@YL026UA*/ 00302000
*                ALSTID = BADGENER;                        /*@YL026UA*/ 00303000
         MVC   ALSTID(5),@CB01070                                  0382 00304000
*                DARGLIST = ''B;                           /*@YL026UA*/ 00305000
         L     @06,DDSTRU                                          0383 00306000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0383 00307000
*                DARGDBP = NULLPTR;                        /*@YL026UA*/ 00308000
         SLR   @15,@15                                             0384 00309000
         ST    @15,DARGDBP(,@06)                                   0384 00310000
*                DARGSMOD = ALMODID;                       /*@YL026UA*/ 00311000
         MVC   DARGSMOD(3,@06),ALMODID                             0385 00312000
*                DARGSENT = ALSTD;                         /*@YL026UA*/ 00313000
         IC    @14,ALSTD                                           0386 00314000
         STC   @14,DARGSENT(,@06)                                  0386 00315000
*                DARGILP  = 0;                             /*@YL026UA*/ 00316000
         STH   @15,DARGILP(,@06)                                   0387 00317000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@YL026UA*/ 00318000
         L     @06,@PC00001                                        0388 00319000
         ST    @06,@AL00001                                        0388 00320000
         LA    @15,@CF00117                                        0388 00321000
         ST    @15,@AL00001+4                                      0388 00322000
         LA    @15,DDSTRU                                          0388 00323000
         ST    @15,@AL00001+8                                      0388 00324000
         MVI   @AL00001+8,X'80'                                    0388 00325000
         L     @15,GDTPRT(,@06)                                    0388 00326000
         LA    @01,@AL00001                                        0388 00327000
         BALR  @14,@15                                             0388 00328000
*                ALSTID = TERMERR;                         /*@YL026UA*/ 00329000
         MVC   ALSTID(5),@CB01042                                  0389 00330000
*                END;                                      /*@YL026UA*/ 00331000
*          END;                                            /*@YL026UA*/ 00332000
*                                                                  0391 00333000
@RF00380 DS    0H                                                  0392 00334000
*        IF ALSTID = NORMAL                                        0392 00335000
*          THEN                                                    0392 00336000
*                                                                  0392 00337000
@RF00375 CLC   ALSTID(5),@CB01034                                  0392 00338000
         BNE   @RF00392                                            0392 00339000
*        /************************************************************/ 00340000
*        /*                                                  @YL026UA*/ 00341000
*        /*  IF THE ENTRY IS FOR PDS MEMBER RENAME -         @YL026UA*/ 00342000
*        /*  RENAME THE MEMBER IN ITS DIRECTORY              @YL026UA*/ 00343000
*        /*                                                  @YL026UA*/ 00344000
*        /************************************************************/ 00345000
*                                                                  0393 00346000
*          IF NTRYMLN ^= 0                                         0393 00347000
*            THEN                                                  0393 00348000
         L     @06,@PC00001+4                                      0393 00349000
         L     @06,FDTPTR(,@06)                                    0393 00350000
         CLI   NTRYMLN(@06),0                                      0393 00351000
         BE    @RF00393                                            0393 00352000
*              DO;                                         /*@YL026UA*/ 00353000
*                CALL MEMRENAM;                            /*@YL026UA*/ 00354000
         BAL   @14,MEMRENAM                                        0395 00355000
*                RESPECIFY RTNREG RSTD;                            0396 00356000
*                TESTRC = RTNREG;                                  0397 00357000
         STH   RTNREG,TESTRC                                       0397 00358000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/ 00359000
*                LASTCC = MAX(TESTRC,LASTCC);              /*@YL026UA*/ 00360000
         L     @06,@PC00001+8                                      0399 00361000
         LH    @15,TESTRC                                          0399 00362000
         LH    @14,LASTCC(,@06)                                    0399 00363000
         CR    @15,@14                                             0399 00364000
         BNL   *+6                                                      00365000
         LR    @15,@14                                             0399 00366000
         STH   @15,LASTCC(,@06)                                    0399 00367000
*              END;                                        /*@YL026UA*/ 00368000
*            ELSE                                                  0401 00369000
*                                                                  0401 00370000
*        /************************************************************/ 00371000
*        /*                                                  @YL026UA*/ 00372000
*        /*  IF THE ENTRY IS FOR PDS MEMBER RENAME -         @YL026UA*/ 00373000
*        /*  PROCESSING IS COMPLETE AT THIS POINT            @YL026UA*/ 00374000
*        /*                                                  @YL026UA*/ 00375000
*        /************************************************************/ 00376000
*                                                                  0401 00377000
*NOTPDS:   DO;                                             /*@YL026UA*/ 00378000
*                                                                  0401 00379000
         B     @RC00393                                            0401 00380000
@RF00393 DS    0H                                                  0401 00381000
NOTPDS   DS    0H                                                  0402 00382000
*        /************************************************************/ 00383000
*        /*                                                  @YL026UA*/ 00384000
*        /*  IF THE ENTRY IS GENERIC - ISSUE UCIR MACRO TO   @YL026UA*/ 00385000
*        /*  OBTAIN THE LIST OF ENTRIES SATISFYING THE GENERIC NAME  */ 00386000
*        /*                                                  @YL026UA*/ 00387000
*        /************************************************************/ 00388000
*                                                                  0402 00389000
*          IF NTRYPOS ^= 0                                         0402 00390000
*            THEN                                                  0402 00391000
         L     @06,@PC00001+4                                      0402 00392000
         L     @06,FDTPTR(,@06)                                    0402 00393000
         CLI   NTRYPOS(@06),0                                      0402 00394000
         BE    @RF00402                                            0402 00395000
*              DO;                                         /*@YL026UA*/ 00396000
*                CIRPTR = ADDR(CIRLIST);                   /*@YL026UA*/ 00397000
         LA    @15,CIRLIST                                         0404 00398000
         ST    @15,CIRPTR                                          0404 00399000
*                CIRLIST = ''B;                            /*@YL026UA*/ 00400000
         XC    CIRLIST(32),CIRLIST                                 0405 00401000
*                CIRTYP1Q = ON;                            /*@YL026UA*/ 00402000
         OI    CIRTYP1Q(@15),B'10000000'                           0406 00403000
*                CIRHLN = NTRYPOS - 1;                     /*@YL026UA*/ 00404000
         SLR   @14,@14                                             0407 00405000
         IC    @14,NTRYPOS(,@06)                                   0407 00406000
         LR    @06,@14                                             0407 00407000
         BCTR  @06,0                                               0407 00408000
         STH   @06,CIRHLN(,@15)                                    0407 00409000
*                CIRHDR = ADDR(ENTRYVAL);                  /*@YL026UA*/ 00410000
         LA    @06,ENTRYVAL                                        0408 00411000
         ST    @06,CIRHDR(,@15)                                    0408 00412000
*                IF ENTRYLEN ^= NTRYPOS                            0409 00413000
*                  THEN                                            0409 00414000
         LH    @05,ENTRYLEN                                        0409 00415000
         CR    @05,@14                                             0409 00416000
         BE    @RF00409                                            0409 00417000
*                    DO;                                   /*@YL026UA*/ 00418000
*                CIRTLR = CIRHDR + NTRYPOS;                /*@YL026UA*/ 00419000
         ALR   @06,@14                                             0411 00420000
         ST    @06,CIRTLR(,@15)                                    0411 00421000
*                CIRTLN = ENTRYLEN - NTRYPOS;              /*@YL026UA*/ 00422000
         SLR   @05,@14                                             0412 00423000
         STH   @05,CIRTLN(,@15)                                    0412 00424000
*                    END;                                  /*@YL026UA*/ 00425000
*                CIRWKP = ADDR(GENWKPTR);                  /*@YL026UA*/ 00426000
@RF00409 L     @06,CIRPTR                                          0414 00427000
         LA    @15,GENWKPTR                                        0414 00428000
         ST    @15,CIRWKP(,@06)                                    0414 00429000
*                IF NTRYPLN ^= 0                                   0415 00430000
*                  THEN                                            0415 00431000
         L     @15,@PC00001+4                                      0415 00432000
         L     @15,FDTPTR(,@15)                                    0415 00433000
         CLI   NTRYPLN(@15),0                                      0415 00434000
         BE    @RF00415                                            0415 00435000
*                     CIRPWD = ADDR(NTRYPAS);              /*@YL026UA*/ 00436000
         LA    @15,NTRYPAS(,@15)                                   0416 00437000
         ST    @15,CIRPWD(,@06)                                    0416 00438000
*                IF ADDR(CATLG) ^= NULLPTR & CATLGLEN ^= 0         0417 00439000
*                  THEN                                            0417 00440000
@RF00415 L     @06,@PC00001+4                                      0417 00441000
         L     @06,FDTPTR+8(,@06)                                  0417 00442000
         LTR   @06,@06                                             0417 00443000
         BZ    @RF00417                                            0417 00444000
         CLI   CATLGLEN(@06),0                                     0417 00445000
         BE    @RF00417                                            0417 00446000
*                    DO;                                   /*@YL026UA*/ 00447000
*                      CIRCAT = ADDR(CATLGVAL);            /*@YL026UA*/ 00448000
         L     @15,CIRPTR                                          0419 00449000
         LA    @14,CATLGVAL(,@06)                                  0419 00450000
         ST    @14,CIRCAT(,@15)                                    0419 00451000
*                      IF CATLGPLN ^= 0                            0420 00452000
*                        THEN                                      0420 00453000
         CLI   CATLGPLN(@06),0                                     0420 00454000
         BE    @RF00420                                            0420 00455000
*                          CIRPWD = ADDR(CATLGPAS);        /*@YL026UA*/ 00456000
         LA    @06,CATLGPAS(,@06)                                  0421 00457000
         ST    @06,CIRPWD(,@15)                                    0421 00458000
*                    END;                                  /*@YL026UA*/ 00459000
@RF00420 DS    0H                                                  0423 00460000
*                CIRPID = ALGPID2;                         /*@OZ02157*/ 00461000
*                                                                  0423 00462000
@RF00417 L     @06,CIRPTR                                          0423 00463000
         MVC   CIRPID(4,@06),ALGPID2                               0423 00464000
*                CALL IDCSACR0(GDTTBL,CIRAGL);             /*@YL026UA*/ 00465000
*                                                                  0424 00466000
         L     @15,@PC00001                                        0424 00467000
         ST    @15,@AL00001                                        0424 00468000
         ST    @06,@AL00001+4                                      0424 00469000
         MVI   @AL00001+4,X'80'                                    0424 00470000
         L     @15,GDTCIR(,@15)                                    0424 00471000
         LA    @01,@AL00001                                        0424 00472000
         BALR  @14,@15                                             0424 00473000
*                RESPECIFY RTNREG RSTD;                            0425 00474000
*                TESTRC = RTNREG;                                  0426 00475000
         STH   RTNREG,TESTRC                                       0426 00476000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/ 00477000
*                IF TESTRC ^= 0                                    0428 00478000
*                  THEN                                            0428 00479000
         LH    @06,TESTRC                                          0428 00480000
         LTR   @06,@06                                             0428 00481000
         BZ    @RF00428                                            0428 00482000
*                    ALSTID = TERMERR;                     /*@YL026UA*/ 00483000
         MVC   ALSTID(5),@CB01042                                  0429 00484000
*                  ELSE                                            0430 00485000
*                                                                  0430 00486000
*        /************************************************************/ 00487000
*        /*                                                  @YL026UA*/ 00488000
*        /*  SET LOOP CONTROL FOR GENLOOP (USED BY GENERIC   @YL026UA*/ 00489000
*        /*  & NON-GENERIC) WITH ONLY 1 PASS THRU LOOP FOR NONGENERIC*/ 00490000
*        /*                                                  @YL026UA*/ 00491000
*        /************************************************************/ 00492000
*                                                                  0430 00493000
*                    GENCNT = GENNUM;                      /*@YL026UA*/ 00494000
         B     @RC00428                                            0430 00495000
@RF00428 L     @06,GENWKPTR                                        0430 00496000
         L     @06,GENNUM(,@06)                                    0430 00497000
         ST    @06,GENCNT                                          0430 00498000
*              END;                                        /*@YL026UA*/ 00499000
*            ELSE                                                  0432 00500000
*              DO;                                         /*@YL026UA*/ 00501000
         B     @RC00402                                            0432 00502000
@RF00402 DS    0H                                                  0433 00503000
*                GENCNT = 1;                               /*@YL026UA*/ 00504000
         MVC   GENCNT(4),@CF00220                                  0433 00505000
*                ATYPE = 0;                                /*@YL026UA*/ 00506000
         MVI   ATYPE,X'00'                                         0434 00507000
*                GENWKPTR = ADDR(ENTRIES);                 /*@YL026UA*/ 00508000
         LA    @06,ENTRIES                                         0435 00509000
         ST    @06,GENWKPTR                                        0435 00510000
*              END;                                        /*@YL026UA*/ 00511000
*GENLOOP: DO ENT = 1 TO GENCNT WHILE LASTCC < LASTCC12             0437 00512000
*                                   & ALSTID = NORMAL;     /*@OZ01484*/ 00513000
*                                                                  0437 00514000
@RC00402 DS    0H                                                  0437 00515000
GENLOOP  LA    @06,1                                               0437 00516000
         B     @DE00437                                            0437 00517000
@DL00437 L     @15,@PC00001+8                                      0437 00518000
         LH    @15,LASTCC(,@15)                                    0437 00519000
         C     @15,@CF00035                                        0437 00520000
         BNL   @DC00437                                            0437 00521000
         CLC   ALSTID(5),@CB01034                                  0437 00522000
         BNE   @DC00437                                            0437 00523000
*        /************************************************************/ 00524000
*        /*                                                  @YL026UA*/ 00525000
*        /*  IF THE ENTRY IS GENERIC - GET THE CATALOG NAME  @YL026UA*/ 00526000
*        /*  FROM THE LIST TO USE IN DIRECTING THE ALTER     @YL026UA*/ 00527000
*        /*                                                  @YL026UA*/ 00528000
*        /************************************************************/ 00529000
*                                                                  0438 00530000
*      IF ENTTYP(ENT) = '0'                                        0438 00531000
*        THEN                                                      0438 00532000
         L     @15,GENWKPTR                                        0438 00533000
         MH    @06,@CH00687                                        0438 00534000
         ST    @06,@TF00001                                        0438 00535000
         ALR   @06,@15                                             0438 00536000
         AL    @06,@CF01684                                        0438 00537000
         CLI   ENTTYP-4(@06),C'0'                                  0438 00538000
         BNE   @RF00438                                            0438 00539000
*            CATNAME = ENTVAL(ENT);                        /*@YL026UA*/ 00540000
         AL    @15,@TF00001                                        0439 00541000
         AL    @15,@CF01685                                        0439 00542000
         MVC   CATNAME(44),ENTVAL-5(@15)                           0439 00543000
*        ELSE                                                      0440 00544000
*SAMECAT:  DO;                                             /*@YL026UA*/ 00545000
         B     @RC00438                                            0440 00546000
@RF00438 DS    0H                                                  0440 00547000
SAMECAT  DS    0H                                                  0441 00548000
*              IF NEWNMPOS ^= 0 & ADDR(NEWNM) ^= NULLPTR           0441 00549000
*              THEN                                                0441 00550000
         L     @06,@PC00001+4                                      0441 00551000
         L     @06,FDTPTR+16(,@06)                                 0441 00552000
         CLI   NEWNMPOS(@06),0                                     0441 00553000
         BE    @RF00441                                            0441 00554000
         LTR   @06,@06                                             0441 00555000
         BZ    @RF00441                                            0441 00556000
*                DO;                                       /*@YL026UA*/ 00557000
*                                                                  0442 00558000
*        /************************************************************/ 00559000
*        /*                                                  @YL026UA*/ 00560000
*        /*  BUILD A NEWNAME BY REPLACING THE * WITH THE     @YL026UA*/ 00561000
*        /*  LEVEL THAT REPLACED THE * IN THE ENTRYNAME      @YL026UA*/ 00562000
*        /*                                                  @YL026UA*/ 00563000
*        /************************************************************/ 00564000
*                                                                  0443 00565000
*                  NEWNAME = NEWNMVAL(1:NEWNMPOS);         /*@YL026UA*/ 00566000
         MVI   NEWNAME+1,C' '                                      0443 00567000
         MVC   NEWNAME+2(42),NEWNAME+1                             0443 00568000
         SLR   @15,@15                                             0443 00569000
         IC    @15,NEWNMPOS(,@06)                                  0443 00570000
         BCTR  @15,0                                               0443 00571000
         EX    @15,@SM01686                                        0443 00572000
*NAMEBLD: DO I = NTRYPOS TO 44;                            /*@YL026UA*/ 00573000
NAMEBLD  L     @06,@PC00001+4                                      0444 00574000
         L     @06,FDTPTR(,@06)                                    0444 00575000
         SLR   @15,@15                                             0444 00576000
         IC    @15,NTRYPOS(,@06)                                   0444 00577000
         B     @DE00444                                            0444 00578000
@DL00444 DS    0H                                                  0445 00579000
*           IF ENTVAL(ENT,I) = '.' | ENTVAL(ENT,I) = ' '           0445 00580000
*           THEN                                                   0445 00581000
         L     @06,GENWKPTR                                        0445 00582000
         L     @14,ENT                                             0445 00583000
         MH    @14,@CH00687                                        0445 00584000
         ALR   @14,@15                                             0445 00585000
         ST    @14,@TF00001                                        0445 00586000
         ALR   @14,@06                                             0445 00587000
         AL    @14,@CF01684                                        0445 00588000
         CLI   ENTVAL-5(@14),C'.'                                  0445 00589000
         BE    @RT00445                                            0445 00590000
         AL    @06,@TF00001                                        0445 00591000
         AL    @06,@CF01684                                        0445 00592000
         CLI   ENTVAL-5(@06),C' '                                  0445 00593000
         BNE   @RF00445                                            0445 00594000
@RT00445 DS    0H                                                  0446 00595000
*             IF ((NEWNMPOS - 1) + (I - NTRYPOS) +                 0446 00596000
*               (NEWNMLEN - NEWNMPOS)) ^> 44                       0446 00597000
*             THEN                                                 0446 00598000
         LA    @06,44                                              0446 00599000
         L     @15,@PC00001+4                                      0446 00600000
         L     @14,FDTPTR+16(,@15)                                 0446 00601000
         SLR   @05,@05                                             0446 00602000
         IC    @05,NEWNMPOS(,@14)                                  0446 00603000
         LR    @04,@05                                             0446 00604000
         BCTR  @04,0                                               0446 00605000
         L     @03,I                                               0446 00606000
         L     @01,FDTPTR(,@15)                                    0446 00607000
         SLR   @02,@02                                             0446 00608000
         IC    @02,NTRYPOS(,@01)                                   0446 00609000
         LR    @15,@03                                             0446 00610000
         SLR   @15,@02                                             0446 00611000
         ALR   @04,@15                                             0446 00612000
         SLR   @15,@15                                             0446 00613000
         IC    @15,NEWNMLEN(,@14)                                  0446 00614000
         SLR   @15,@05                                             0446 00615000
         ALR   @04,@15                                             0446 00616000
         CR    @04,@06                                             0446 00617000
         BH    @RF00446                                            0446 00618000
*               DO;                                        /*@YL026UA*/ 00619000
*                 NEWNAME(NEWNMPOS:NEWNMPOS + I - NTRYPOS) =       0448 00620000
*                 ENTVAL(ENT,NTRYPOS:I);                   /*@YL026UA*/ 00621000
         LA    @04,NEWNAME-1(@05)                                  0448 00622000
         ALR   @03,@05                                             0448 00623000
         SLR   @03,@02                                             0448 00624000
         LR    @15,@03                                             0448 00625000
         SLR   @15,@05                                             0448 00626000
         L     @01,ENT                                             0448 00627000
         MH    @01,@CH00687                                        0448 00628000
         ALR   @01,@02                                             0448 00629000
         L     @02,GENWKPTR                                        0448 00630000
         ALR   @02,@01                                             0448 00631000
         AL    @02,@CF01684                                        0448 00632000
         EX    @15,@SM01688                                        0448 00633000
*                 NEWNAME(NEWNMPOS + I - NTRYPOS:44) =             0449 00634000
*                 NEWNMVAL(NEWNMPOS + 1:44);               /*@YL026UA*/ 00635000
         LA    @02,NEWNAME-1(@03)                                  0449 00636000
         SLR   @06,@03                                             0449 00637000
         ALR   @14,@05                                             0449 00638000
         EX    @06,@SM01690                                        0449 00639000
*                 I=50;                                    /*@YL026UA*/ 00640000
         MVC   I(4),@CF00724                                       0450 00641000
*               END;                                       /*@YL026UA*/ 00642000
*             ELSE                                                 0452 00643000
*               ALSTID = BADNEWNM;                         /*@YL026UA*/ 00644000
         B     @RC00446                                            0452 00645000
@RF00446 MVC   ALSTID(5),@CB01064                                  0452 00646000
*         END NAMEBLD;                                     /*@YL026UA*/ 00647000
@RC00446 DS    0H                                                  0453 00648000
@RF00445 LA    @15,1                                               0453 00649000
         AL    @15,I                                               0453 00650000
@DE00444 ST    @15,I                                               0453 00651000
         C     @15,@CF00594                                        0453 00652000
         BNH   @DL00444                                            0453 00653000
*           IF I = 45                                              0454 00654000
*             THEN                                                 0454 00655000
         L     @06,I                                               0454 00656000
         LA    @15,45                                              0454 00657000
         CR    @06,@15                                             0454 00658000
         BNE   @RF00454                                            0454 00659000
*             IF ((NEWNMPOS - 1) + (I - NTRYPOS) +                 0455 00660000
*               (NEWNMLEN - NEWNMPOS)) ^> 44                       0455 00661000
*             THEN                                                 0455 00662000
         LA    @14,44                                              0455 00663000
         L     @05,@PC00001+4                                      0455 00664000
         L     @04,FDTPTR+16(,@05)                                 0455 00665000
         SLR   @03,@03                                             0455 00666000
         IC    @03,NEWNMPOS(,@04)                                  0455 00667000
         LR    @02,@03                                             0455 00668000
         BCTR  @02,0                                               0455 00669000
         L     @01,FDTPTR(,@05)                                    0455 00670000
         SLR   @05,@05                                             0455 00671000
         IC    @05,NTRYPOS(,@01)                                   0455 00672000
         LR    @01,@06                                             0455 00673000
         SLR   @01,@05                                             0455 00674000
         ALR   @02,@01                                             0455 00675000
         SLR   @01,@01                                             0455 00676000
         IC    @01,NEWNMLEN(,@04)                                  0455 00677000
         SLR   @01,@03                                             0455 00678000
         ALR   @02,@01                                             0455 00679000
         CR    @02,@14                                             0455 00680000
         BH    @RF00455                                            0455 00681000
*               DO;                                        /*@YL026UA*/ 00682000
*                 NEWNAME(NEWNMPOS:NEWNMPOS + I - NTRYPOS) =       0457 00683000
*                 ENTVAL(ENT,NTRYPOS:I);                   /*@YL026UA*/ 00684000
         LA    @02,NEWNAME-1(@03)                                  0457 00685000
         ALR   @06,@03                                             0457 00686000
         SLR   @06,@05                                             0457 00687000
         LR    @01,@06                                             0457 00688000
         SLR   @01,@03                                             0457 00689000
         M     @14,ENT                                             0457 00690000
         ALR   @15,@05                                             0457 00691000
         L     @14,GENWKPTR                                        0457 00692000
         ALR   @14,@15                                             0457 00693000
         AL    @14,@CF01684                                        0457 00694000
         EX    @01,@SM01692                                        0457 00695000
*                 NEWNAME(NEWNMPOS + I - NTRYPOS:44) =             0458 00696000
*                 NEWNMVAL(NEWNMPOS + 1:44);               /*@YL026UA*/ 00697000
         LA    @01,NEWNAME-1(@06)                                  0458 00698000
         LA    @05,44                                              0458 00699000
         SLR   @05,@06                                             0458 00700000
         ALR   @04,@03                                             0458 00701000
         EX    @05,@SM01694                                        0458 00702000
*               END;                                       /*@YL026UA*/ 00703000
*             ELSE                                                 0460 00704000
*               ALSTID = BADNEWNM;                         /*@YL026UA*/ 00705000
         B     @RC00455                                            0460 00706000
@RF00455 MVC   ALSTID(5),@CB01064                                  0460 00707000
*                  END;                                    /*@YL026UA*/ 00708000
@RC00455 DS    0H                                                  0461 00709000
@RF00454 DS    0H                                                  0462 00710000
*        /************************************************************/ 00711000
*        /*                                                          */ 00712000
*        /* CURRENT ATTRIBUTES OF COMPLEX FIELDS MUST BE LOCATED SO  */ 00713000
*        /* ALTERATIONS MAY BE DONE IN CONTEXT - VERIFY THE NEED FOR */ 00714000
*        /* LOCATING THE ORIGINAL ENTRY.                             */ 00715000
*        /* THIS SERIES WILL CAUSE INVOCATION OF 'LOCATPRC' IF ANY   */ 00716000
*        /* ATTRIBUTE OF A COMPLEX FIELD IS TO BE ALTERED, THE ADDR  */ 00717000
*        /* OF FDT VALUES MUST HAVE A NON-NULL VALUE  FOR INVOCATION */ 00718000
*        /* TO OCCUR.                                                */ 00719000
*        /*                                                          */ 00720000
*        /************************************************************/ 00721000
*        IF ALSTID = NORMAL                                        0462 00722000
*          THEN                                                    0462 00723000
@RF00441 CLC   ALSTID(5),@CB01034                                  0462 00724000
         BNE   @RF00462                                            0462 00725000
*            IF ((ADDR(MASTR)) ^= NULLPTR |                        0463 00726000
*               (ADDR(CNTVL)) ^= NULLPTR  |                        0463 00727000
*               (ADDR(UPDAT)) ^= NULLPTR  |                        0463 00728000
*               (ADDR(READ))  ^= NULLPTR  |                        0463 00729000
*               (ADDR(CODNM)) ^= NULLPTR  |                        0463 00730000
*               (ADDR(ATTP))  ^= NULLPTR  |                        0463 00731000
*               (ADDR(AUTH))  ^= NULLPTR  |                        0463 00732000
*               (ADDR(NMSTR)) ^= NULLPTR  |                        0463 00733000
*               (ADDR(NCNTV)) ^= NULLPTR  |                        0463 00734000
*               (ADDR(NUPDT)) ^= NULLPTR  |                        0463 00735000
*               (ADDR(NREAD)) ^= NULLPTR  |                        0463 00736000
*               (ADDR(NCDNM)) ^= NULLPTR  |                        0463 00737000
*               (ADDR(NAUTH)) ^= NULLPTR  |                        0463 00738000
*               (ADDR(ERASE)) ^= NULLPTR  |                        0463 00739000
*               (ADDR(NERAS)) ^= NULLPTR  |                        0463 00740000
*               (ADDR(SHAR1)) ^= NULLPTR  |                        0463 00741000
*               (ADDR(FSPAC)) ^= NULLPTR  |                        0463 00742000
*               (ADDR(WRTCK)) ^= NULLPTR  |                        0463 00743000
*               (ADDR(NWTCK)) ^= NULLPTR  |                        0463 00744000
*               (ADDR(INHIB)) ^= NULLPTR  |                        0463 00745000
*               (ADDR(UNHIB)) ^= NULLPTR  |                        0463 00746000
*               (ADDR(GDGEM)) ^= NULLPTR  |                        0463 00747000
*               (ADDR(GDGNE)) ^= NULLPTR  |                        0463 00748000
*               (ADDR(GDGSC)) ^= NULLPTR  |                        0463 00749000
*               (ADDR(GDGNS)) ^= NULLPTR  |                        0463 00750000
*               (ADDR(UPG))   ^= NULLPTR  |                /*@Y30SSJH*/ 00751000
*               (ADDR(UNQK))  ^= NULLPTR  |                /*@Y30SSJH*/ 00752000
*               (ADDR(NUNQK)) ^= NULLPTR  |                /*@Y30SSJH*/ 00753000
*               (ADDR(KEY))   ^= NULLPTR  |                /*@Y30SSJH*/ 00754000
*               (ADDR(RECSZ)) ^= NULLPTR  |                /*@Y30SSJH*/ 00755000
*               (ADDR(STAGE)) ^= NULLPTR  |                /*@Y30LSJH*/ 00756000
*               (ADDR(BIND))  ^= NULLPTR  |                /*@Y30LSJH*/ 00757000
*               (ADDR(CYLF))  ^= NULLPTR  |                /*@Y30LSJH*/ 00758000
*               (ADDR(NSTGW)) ^= NULLPTR  |                /*@Y30LSJH*/ 00759000
*               (ADDR(STGW))  ^= NULLPTR  |                /*@Y30SSJH*/ 00760000
*               (ADDR(ADDVL)) ^= NULLPTR  |                /*@Y30SSJH*/ 00761000
*               (ADDR(REMVL)) ^= NULLPTR  )                /*@Y30SSJH*/ 00762000
*                                                                  0463 00763000
*              THEN                                                0463 00764000
         SLR   @06,@06                                             0463 00765000
         L     @15,@PC00001+4                                      0463 00766000
         C     @06,FDTPTR+28(,@15)                                 0463 00767000
         BNE   @RT00463                                            0463 00768000
         C     @06,FDTPTR+32(,@15)                                 0463 00769000
         BNE   @RT00463                                            0463 00770000
         C     @06,FDTPTR+36(,@15)                                 0463 00771000
         BNE   @RT00463                                            0463 00772000
         C     @06,FDTPTR+40(,@15)                                 0463 00773000
         BNE   @RT00463                                            0463 00774000
         C     @06,FDTPTR+44(,@15)                                 0463 00775000
         BNE   @RT00463                                            0463 00776000
         C     @06,FDTPTR+48(,@15)                                 0463 00777000
         BNE   @RT00463                                            0463 00778000
         C     @06,FDTPTR+52(,@15)                                 0463 00779000
         BNE   @RT00463                                            0463 00780000
         C     @06,FDTPTR+100(,@15)                                0463 00781000
         BNE   @RT00463                                            0463 00782000
         C     @06,FDTPTR+104(,@15)                                0463 00783000
         BNE   @RT00463                                            0463 00784000
         C     @06,FDTPTR+108(,@15)                                0463 00785000
         BNE   @RT00463                                            0463 00786000
         C     @06,FDTPTR+112(,@15)                                0463 00787000
         BNE   @RT00463                                            0463 00788000
         C     @06,FDTPTR+168(,@15)                                0463 00789000
         BNE   @RT00463                                            0463 00790000
         C     @06,FDTPTR+176(,@15)                                0463 00791000
         BNE   @RT00463                                            0463 00792000
         C     @06,FDTPTR+80(,@15)                                 0463 00793000
         BNE   @RT00463                                            0463 00794000
         C     @06,FDTPTR+84(,@15)                                 0463 00795000
         BNE   @RT00463                                            0463 00796000
         C     @06,FDTPTR+188(,@15)                                0463 00797000
         BNE   @RT00463                                            0463 00798000
         C     @06,FDTPTR+120(,@15)                                0463 00799000
         BNE   @RT00463                                            0463 00800000
         C     @06,FDTPTR+132(,@15)                                0463 00801000
         BNE   @RT00463                                            0463 00802000
         C     @06,FDTPTR+136(,@15)                                0463 00803000
         BNE   @RT00463                                            0463 00804000
         C     @06,FDTPTR+156(,@15)                                0463 00805000
         BNE   @RT00463                                            0463 00806000
         C     @06,FDTPTR+160(,@15)                                0463 00807000
         BNE   @RT00463                                            0463 00808000
         C     @06,FDTPTR+196(,@15)                                0463 00809000
         BNE   @RT00463                                            0463 00810000
         C     @06,FDTPTR+200(,@15)                                0463 00811000
         BNE   @RT00463                                            0463 00812000
         C     @06,FDTPTR+204(,@15)                                0463 00813000
         BNE   @RT00463                                            0463 00814000
         C     @06,FDTPTR+208(,@15)                                0463 00815000
         BNE   @RT00463                                            0463 00816000
         C     @06,FDTPTR+252(,@15)                                0463 00817000
         BNE   @RT00463                                            0463 00818000
         C     @06,FDTPTR+244(,@15)                                0463 00819000
         BNE   @RT00463                                            0463 00820000
         C     @06,FDTPTR+248(,@15)                                0463 00821000
         BNE   @RT00463                                            0463 00822000
         C     @06,FDTPTR+220(,@15)                                0463 00823000
         BNE   @RT00463                                            0463 00824000
         C     @06,FDTPTR+232(,@15)                                0463 00825000
         BNE   @RT00463                                            0463 00826000
         C     @06,FDTPTR+272(,@15)                                0463 00827000
         BNE   @RT00463                                            0463 00828000
         C     @06,FDTPTR+276(,@15)                                0463 00829000
         BNE   @RT00463                                            0463 00830000
         C     @06,FDTPTR+280(,@15)                                0463 00831000
         BNE   @RT00463                                            0463 00832000
         C     @06,FDTPTR+284(,@15)                                0463 00833000
         BNE   @RT00463                                            0463 00834000
         C     @06,FDTPTR+288(,@15)                                0463 00835000
         BNE   @RT00463                                            0463 00836000
         C     @06,FDTPTR+144(,@15)                                0463 00837000
         BNE   @RT00463                                            0463 00838000
         C     @06,FDTPTR+148(,@15)                                0463 00839000
         BE    @RF00463                                            0463 00840000
@RT00463 DS    0H                                                  0464 00841000
*                DO;                                       /*@Y30SSJH*/ 00842000
*                                                                  0464 00843000
*                CALL LOCATPRC;                            /*@Y30SSJH*/ 00844000
*                                                                  0465 00845000
         BAL   @14,LOCATPRC                                        0465 00846000
*                /****************************************************/ 00847000
*                /*                                          @Y30SSJH*/ 00848000
*                /* IF ANY PARAMETERS HAVE BEEN SPECIFIED    @Y30SSJH*/ 00849000
*                /* WHICH REQUIRE FURTHER CHECKING, CAUSE    @Y30SSJH*/ 00850000
*                /* INVOCATION OF 'CHECKPRC'                 @Y30SSJH*/ 00851000
*                /*                                          @Y30SSJH*/ 00852000
*                /****************************************************/ 00853000
*                                                                  0466 00854000
*                IF ALSTID = NORMAL                                0466 00855000
*                  THEN                                            0466 00856000
         CLC   ALSTID(5),@CB01034                                  0466 00857000
         BNE   @RF00466                                            0466 00858000
*                    IF ((ADDR(UPG))  ^= NULLPTR |                 0467 00859000
*                       (ADDR(UNQK))  ^= NULLPTR |                 0467 00860000
*                       (ADDR(KEY))   ^= NULLPTR |                 0467 00861000
*                       (ADDR(RECSZ)) ^= NULLPTR )                 0467 00862000
*                      THEN                                        0467 00863000
         SLR   @06,@06                                             0467 00864000
         L     @15,@PC00001+4                                      0467 00865000
         C     @06,FDTPTR+252(,@15)                                0467 00866000
         BNE   @RT00467                                            0467 00867000
         C     @06,FDTPTR+244(,@15)                                0467 00868000
         BNE   @RT00467                                            0467 00869000
         C     @06,FDTPTR+220(,@15)                                0467 00870000
         BNE   @RT00467                                            0467 00871000
         C     @06,FDTPTR+232(,@15)                                0467 00872000
         BE    @RF00467                                            0467 00873000
@RT00467 DS    0H                                                  0468 00874000
*                        CALL CHECKPRC;                    /*@Y30SSJH*/ 00875000
*                                                                  0468 00876000
         BAL   @14,CHECKPRC                                        0468 00877000
*                /****************************************************/ 00878000
*                /*                                          @OZ05940*/ 00879000
*                /* CALL PARAMCHK TO VERIFY THAT PARAMETERS  @OZ05940*/ 00880000
*                /* SPECIFIED ON THE ALTER COMMAND ARE VALID @OZ05940*/ 00881000
*                /* FOR THE ENTRY TYPE.                      @OZ05940*/ 00882000
*                /*                                          @OZ05940*/ 00883000
*                /****************************************************/ 00884000
*                                                                  0469 00885000
*                IF ALSTID = NORMAL                                0469 00886000
*                  THEN                                            0469 00887000
@RF00467 DS    0H                                                  0469 00888000
@RF00466 CLC   ALSTID(5),@CB01034                                  0469 00889000
         BNE   @RF00469                                            0469 00890000
*                    CALL PARAMCHK(LCETYPVL);              /*@OZ05940*/ 00891000
*                                                                  0470 00892000
         L     @06,LCETYPPT                                        0470 00893000
         ST    @06,@AL00001                                        0470 00894000
         LA    @01,@AL00001                                        0470 00895000
         BAL   @14,PARAMCHK                                        0470 00896000
*                END;                                      /*@Y30SSJH*/ 00897000
*                                                                  0471 00898000
@RF00469 DS    0H                                                  0472 00899000
*                                                                  0472 00900000
*        /************************************************************/ 00901000
*        /*                                                          */ 00902000
*        /* ALTERPRC BUILDS THE CPL/FVT/FPL INTERFACE FOR THE ALTER  */ 00903000
*        /* REQUEST.  THE FDTTBL IS KNOWN TO ALTERPRC AS IS THE      */ 00904000
*        /* LOCTABLE. THE INFORMATION FROM THE FDTTBL AND LOCTABLE   */ 00905000
*        /* IS USED TO BUILD THE INTERFACE - THE INTERFACE STRUCTURE */ 00906000
*        /* IS BUILT IN ALCTGPRM                                     */ 00907000
*        /*                                                          */ 00908000
*        /************************************************************/ 00909000
*                                                                  0472 00910000
*        IF ALSTID = NORMAL                                        0472 00911000
*          THEN                                                    0472 00912000
@RF00463 DS    0H                                                  0472 00913000
@RF00462 CLC   ALSTID(5),@CB01034                                  0472 00914000
         BNE   @RF00472                                            0472 00915000
*            CALL ALTERPRC(                                        0473 00916000
*              CATACBPT);               /* ADDRESS OF CATLG ACB      */ 00917000
*                                                                  0473 00918000
         LA    @06,CATACBPT                                        0473 00919000
         ST    @06,@AL00001                                        0473 00920000
         LA    @01,@AL00001                                        0473 00921000
         BAL   @14,ALTERPRC                                        0473 00922000
*        /************************************************************/ 00923000
*        /*                                                          */ 00924000
*        /* THE ALTER INTERFACE HAS BEEN BUILT INVOKE VSAM CATALOG   */ 00925000
*        /* MANAGEMENT. THE CPL IS REFERENCED BY THE UCATLG MACRO    */ 00926000
*        /*                                                          */ 00927000
*        /************************************************************/ 00928000
*                                                                  0474 00929000
*        IF GDTDBG = NULLPTR                                       0474 00930000
*          THEN;                                                   0474 00931000
@RF00472 L     @06,@PC00001                                        0474 00932000
         L     @06,GDTDBG(,@06)                                    0474 00933000
         LTR   @06,@06                                             0474 00934000
         BZ    @RT00474                                            0474 00935000
*          ELSE                                                    0476 00936000
*            CALL IDCDB010(GDTTBL,'AL01');                         0476 00937000
*                                                                  0476 00938000
         L     @06,@PC00001                                        0476 00939000
         ST    @06,@AL00001                                        0476 00940000
         LA    @15,@CC01147                                        0476 00941000
         ST    @15,@AL00001+4                                      0476 00942000
         MVI   @AL00001+4,X'80'                                    0476 00943000
         L     @15,GDTDBG(,@06)                                    0476 00944000
         LA    @01,@AL00001                                        0476 00945000
         BALR  @14,@15                                             0476 00946000
*        IF ALSTID = NORMAL                                        0477 00947000
*          THEN                                                    0477 00948000
@RT00474 CLC   ALSTID(5),@CB01034                                  0477 00949000
         BNE   @RF00477                                            0477 00950000
*            DO;                                                   0478 00951000
*            DEFINED = ON;                                 /*@YL026UA*/ 00952000
*                                                                  0479 00953000
         OI    DEFINED,B'10000000'                                 0479 00954000
*        /************************************************************/ 00955000
*        /*                                                  @YL026UA*/ 00956000
*        /*  CALL THE VSAM CATALOG WITH REGISTER 1 POINTING TO THE   */ 00957000
*        /*  CATALOG PARAMETER LIST (CATALOG LOOP IS NECESSARY IF    */ 00958000
*        /*  NONVSAM OR UNIQUE WERE DEFINED FOR THE ENTRY SO @YL026UA*/ 00959000
*        /*  THAT IT CAN BE DYNAMICALLY ALLOCATED AND THE    @YL026UA*/ 00960000
*        /*  UCATLG REISSUED                                 @YL026UA*/ 00961000
*        /*                                                  @YL026UA*/ 00962000
*        /************************************************************/ 00963000
*                                                                  0480 00964000
*CATALOG: DO N = 1  TO  2  BY  1                           /*@YL026UA*/ 00965000
*              WHILE ( DEFINED = ON );                             0480 00966000
CATALOG  LA    @06,1                                               0480 00967000
         ST    @06,N                                               0480 00968000
@DL00480 TM    DEFINED,B'10000000'                                 0480 00969000
         BNO   @DC00480                                            0480 00970000
*            DEFINED = OFF;                                /*@YL026UA*/ 00971000
         NI    DEFINED,B'01111111'                                 0481 00972000
*            RENEWCPL = CTGPL;                             /*@YL026UA*/ 00973000
*                                                                  0482 00974000
         L     @06,CTGPLPTR                                        0482 00975000
         MVC   RENEWCPL(28),CTGPL(@06)                             0482 00976000
*            CALL IDCSACA0 (GDTTBL,CTGPLPTR);                      0483 00977000
*                                                                  0483 00978000
         L     @06,@PC00001                                        0483 00979000
         ST    @06,@AL00001                                        0483 00980000
         LA    @15,CTGPLPTR                                        0483 00981000
         ST    @15,@AL00001+4                                      0483 00982000
         L     @15,GDTCAT(,@06)                                    0483 00983000
         LA    @01,@AL00001                                        0483 00984000
         BALR  @14,@15                                             0483 00985000
*            /********************************************************/ 00986000
*            /*                                                      */ 00987000
*            /* SAVE CATALOG RETURN CODE, RTNREG, THEN INTERROGATE   */ 00988000
*            /* THE RETURN CODE. A NONZERO RETURN CODE CAUSES ALSTID */ 00989000
*            /* TO BE SET INDICATING A CATALOG ERROR. TERMINATION    */ 00990000
*            /* WILL ISSUE THE CATALOG ERROR MESSAGE, USING THE VALUE*/ 00991000
*            /* SAVED IN CTGRTNCC.                                   */ 00992000
*            /*                                                      */ 00993000
*            /********************************************************/ 00994000
*                                                                  0484 00995000
*        RESPECIFY (RTNREG) RSTD;                          /*@Y30SSJH*/ 00996000
*        CTGRTNCC = RTNREG;                                /*@YL026UA*/ 00997000
         ST    RTNREG,CTGRTNCC                                     0485 00998000
*        RESPECIFY (RTNREG) UNRSTD;                        /*@Y30SSJH*/ 00999000
*                                                                  0486 01000000
*        IF CTGRTNCC ^= 0                                          0487 01001000
*          THEN                                                    0487 01002000
*                                                                  0487 01003000
         L     @06,CTGRTNCC                                        0487 01004000
         LTR   @06,@06                                             0487 01005000
         BZ    @RF00487                                            0487 01006000
*        /************************************************************/ 01007000
*        /*                                                  @YL026UA*/ 01008000
*        /*  IF THE ENTRY NEEDED ALLOCATION - ISSUE THE      @YL026UA*/ 01009000
*        /*  UALLOC TO DYNAMICALLY ALLOCATE IT               @YL026UA*/ 01010000
*        /*                                                  @YL026UA*/ 01011000
*        /************************************************************/ 01012000
*                                                                  0488 01013000
*            IF ( CTGRTNCC = 240 |                         /*@Y30LSJH*/ 01014000
*                 CTGRTNCC = 72  |                         /*@Y30SSJH*/ 01015000
*                 CTGRTNCC = 76  |                         /*@Y30SSJH*/ 01016000
*                 ( CTGRTNCC = 136 & CTGFBFLG = 22 ))  &   /*@Y30SSJH*/ 01017000
*                 N = 1                                    /*@Y30SSJH*/ 01018000
*              THEN                                                0488 01019000
         C     @06,@CF01421                                        0488 01020000
         BE    @GL00049                                            0488 01021000
         C     @06,@CF00770                                        0488 01022000
         BE    @GL00049                                            0488 01023000
         C     @06,@CF01422                                        0488 01024000
         BE    @GL00049                                            0488 01025000
         C     @06,@CF01423                                        0488 01026000
         BNE   @RF00488                                            0488 01027000
         L     @06,CTGPLPTR                                        0488 01028000
         CLC   CTGFBFLG(2,@06),@CH00662                            0488 01029000
         BNE   @RF00488                                            0488 01030000
@GL00049 CLC   N(4),@CF00220                                       0488 01031000
         BNE   @RF00488                                            0488 01032000
*                DO;                                       /*@Y30SSJH*/ 01033000
*                ALLPTR = ADDR(ALLLIST);                   /*@YL026UA*/ 01034000
         LA    @06,ALLLIST                                         0490 01035000
         ST    @06,ALLPTR                                          0490 01036000
*                ALLAGL = ''B;                             /*@YL026UA*/ 01037000
         XC    ALLAGL(31,@06),ALLAGL(@06)                          0491 01038000
*                ALLDSN = ADDR(ENTVAL(ENT));               /*@YL026UA*/ 01039000
         L     @15,ENT                                             0492 01040000
         MH    @15,@CH00687                                        0492 01041000
         L     @01,GENWKPTR                                        0492 01042000
         AL    @01,@CF01685                                        0492 01043000
         LA    @15,ENTVAL-5(@15,@01)                               0492 01044000
         ST    @15,ALLDSN(,@06)                                    0492 01045000
*                IF NTRYPLN ^= 0                                   0493 01046000
*                  THEN                                            0493 01047000
         L     @15,@PC00001+4                                      0493 01048000
         L     @15,FDTPTR(,@15)                                    0493 01049000
         CLI   NTRYPLN(@15),0                                      0493 01050000
         BE    @RF00493                                            0493 01051000
*                    ALLPWD = ADDR(NTRYPAS);               /*@YL026UA*/ 01052000
         LA    @15,NTRYPAS(,@15)                                   0494 01053000
         ST    @15,ALLPWD(,@06)                                    0494 01054000
*                ALLOPTVL = OFF;                           /*@YL026UA*/ 01055000
@RF00493 DS    0H                                                  0496 01056000
*                ALLOPTDS = ON;                            /*@YL026UA*/ 01057000
         L     @06,ALLPTR                                          0496 01058000
         OI    ALLOPTDS(@06),B'01000000'                           0496 01059000
         NI    ALLOPTVL(@06),B'01111111'                           0496 01060000
*                ALLSTSOD = ON;                            /*@YL026UA*/ 01061000
         OI    ALLSTSOD(@06),B'00000001'                           0497 01062000
*                ALLDSPKP = ON;                            /*@YL026UA*/ 01063000
         OI    ALLDSPKP(@06),B'00001000'                           0498 01064000
*                CALL IDCSAAL0(GDTTBL,ALLAGL);             /*@YL026UA*/ 01065000
         L     @15,@PC00001                                        0499 01066000
         ST    @15,@AL00001                                        0499 01067000
         ST    @06,@AL00001+4                                      0499 01068000
         MVI   @AL00001+4,X'80'                                    0499 01069000
         L     @15,GDTALC(,@15)                                    0499 01070000
         LA    @01,@AL00001                                        0499 01071000
         BALR  @14,@15                                             0499 01072000
*                RESPECIFY RTNREG RSTD;                            0500 01073000
*                TESTRC = RTNREG;                                  0501 01074000
         STH   RTNREG,TESTRC                                       0501 01075000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/ 01076000
*                IF TESTRC = 0                                     0503 01077000
*                  THEN                                            0503 01078000
*                                                                  0503 01079000
         LH    @06,TESTRC                                          0503 01080000
         LTR   @06,@06                                             0503 01081000
         BNZ   @RF00503                                            0503 01082000
*        /************************************************************/ 01083000
*        /*                                                  @YL026UA*/ 01084000
*        /*  UPON SUCCESSFUL ALLOCATION - PUT THE ADDRESS OF @YL026UA*/ 01085000
*        /*  THE DDNAME IN THE RENEWED CPL AND GO REISSUE THE UCATLG */ 01086000
*        /*                                                  @YL026UA*/ 01087000
*        /************************************************************/ 01088000
*                                                                  0504 01089000
*                    DO;                                   /*@YL026UA*/ 01090000
*                    DALCINDX = DALCINDX + 1;              /*@Y30SSJH*/ 01091000
         LA    @06,1                                               0505 01092000
         AL    @06,DALCINDX                                        0505 01093000
         ST    @06,DALCINDX                                        0505 01094000
*                    ALSAVPTR(DALCINDX) = ALLPTR;          /*@Y30SSJH*/ 01095000
         L     @15,ALLPTR                                          0506 01096000
         SLA   @06,2                                               0506 01097000
         ST    @15,ALSAVPTR-4(@06)                                 0506 01098000
*                    CTGPL = RENEWCPL;                     /*@YL026UA*/ 01099000
         L     @06,CTGPLPTR                                        0507 01100000
         MVC   CTGPL(28,@06),RENEWCPL                              0507 01101000
*                    CTGFVIND = ADDR(ALLDDN);              /*@YL026UG*/ 01102000
         L     @06,CTGFVT(,@06)                                    0508 01103000
         LA    @15,ALLDDN(,@15)                                    0508 01104000
         ST    @15,CTGFVIND(,@06)                                  0508 01105000
*                    DEFINED = ON;                         /*@YL026UA*/ 01106000
         OI    DEFINED,B'10000000'                                 0509 01107000
*                    END;                                  /*@YL026UA*/ 01108000
*                  ELSE                                            0511 01109000
*                    ALSTID = NOENTALT;                    /*@YL026UA*/ 01110000
         B     @RC00503                                            0511 01111000
@RF00503 MVC   ALSTID(5),@CB01058                                  0511 01112000
*                  END;                                    /*@YL026UA*/ 01113000
*                ELSE                                              0513 01114000
*                  ALSTID = CATERROR;                      /*@YL026UA*/ 01115000
*                                                                  0513 01116000
         B     @RC00488                                            0513 01117000
@RF00488 MVC   ALSTID(5),@CB01016                                  0513 01118000
*            END CATALOG;                                  /*@YL026UA*/ 01119000
@RC00488 DS    0H                                                  0514 01120000
@RF00487 LA    @06,1                                               0514 01121000
         AL    @06,N                                               0514 01122000
         ST    @06,N                                               0514 01123000
         C     @06,@CF00155                                        0514 01124000
         BNH   @DL00480                                            0514 01125000
@DC00480 DS    0H                                                  0515 01126000
*            END;                                          /*@YL026UA*/ 01127000
*        /************************************************************/ 01128000
*        /*                                                  @Y30SSJH*/ 01129000
*        /* IF KEYS HAS BEEN SPECIFIED, THE INDEX AMDSB MUST @Y30SSJH*/ 01130000
*        /* ALSO BE ALTERED. CALL INDEXPRC TO CONSTRUCT THE  @Y30SSJH*/ 01131000
*        /* CATALOG PARAMETER LIST BEFORE ISSUING THE ALTER  @Y30SSJH*/ 01132000
*        /* REQUEST.                                         @Y30SSJH*/ 01133000
*        /*                                                  @Y30SSJH*/ 01134000
*        /************************************************************/ 01135000
*                                                                  0516 01136000
*        IF ALSTID = NORMAL  &                                     0516 01137000
*           KEYRECRC = 0     &                                     0516 01138000
*           (ADDR(KEY)) ^= NULLPTR                                 0516 01139000
*          THEN                                                    0516 01140000
@RF00477 CLC   ALSTID(5),@CB01034                                  0516 01141000
         BNE   @RF00516                                            0516 01142000
         SLR   @06,@06                                             0516 01143000
         C     @06,KEYRECRC                                        0516 01144000
         BNE   @RF00516                                            0516 01145000
         L     @15,@PC00001+4                                      0516 01146000
         C     @06,FDTPTR+220(,@15)                                0516 01147000
         BE    @RF00516                                            0516 01148000
*            DO;                                           /*@Y30SSJH*/ 01149000
*                                                                  0517 01150000
*            CALL INDEXPRC;                                /*@Y30SSJH*/ 01151000
*                                                                  0518 01152000
         BAL   @14,INDEXPRC                                        0518 01153000
*            IF GDTDBG = NULLPTR                                   0519 01154000
*              THEN;                                               0519 01155000
         L     @06,@PC00001                                        0519 01156000
         L     @06,GDTDBG(,@06)                                    0519 01157000
         LTR   @06,@06                                             0519 01158000
         BZ    @RT00519                                            0519 01159000
*              ELSE                                                0521 01160000
*                CALL IDCDB010 (GDTTBL,'AL04');                    0521 01161000
         L     @06,@PC00001                                        0521 01162000
         ST    @06,@AL00001                                        0521 01163000
         LA    @15,@CC01425                                        0521 01164000
         ST    @15,@AL00001+4                                      0521 01165000
         MVI   @AL00001+4,X'80'                                    0521 01166000
         L     @15,GDTDBG(,@06)                                    0521 01167000
         LA    @01,@AL00001                                        0521 01168000
         BALR  @14,@15                                             0521 01169000
*                                                          /*@Y30SSJH*/ 01170000
*                                                                  0522 01171000
*            IF ALSTID = NORMAL                                    0522 01172000
*              THEN                                                0522 01173000
@RT00519 CLC   ALSTID(5),@CB01034                                  0522 01174000
         BNE   @RF00522                                            0522 01175000
*                DO;                                       /*@Y30SSJH*/ 01176000
*                                                                  0523 01177000
*                CALL IDCSACA0 (GDTTBL,CPLSAVE);           /*@Y30SSJH*/ 01178000
*                                                                  0524 01179000
         L     @06,@PC00001                                        0524 01180000
         ST    @06,@AL00001                                        0524 01181000
         LA    @15,CPLSAVE                                         0524 01182000
         ST    @15,@AL00001+4                                      0524 01183000
         L     @15,GDTCAT(,@06)                                    0524 01184000
         LA    @01,@AL00001                                        0524 01185000
         BALR  @14,@15                                             0524 01186000
*                RESPECIFY (RTNREG) RSTD;                  /*@Y30SSJH*/ 01187000
*                CTGRTNCC = RTNREG;                        /*@Y30SSJH*/ 01188000
         ST    RTNREG,CTGRTNCC                                     0526 01189000
*                RESPECIFY (RTNREG) UNRSTD;                /*@Y30SSJH*/ 01190000
*                                                                  0527 01191000
*                IF CTGRTNCC ^= 0                                  0528 01192000
*                  THEN                                            0528 01193000
         L     @06,CTGRTNCC                                        0528 01194000
         LTR   @06,@06                                             0528 01195000
         BZ    @RF00528                                            0528 01196000
*                    DO;                                   /*@Y30SSJH*/ 01197000
*                                                                  0529 01198000
*                    ALSTID = CATERROR;                    /*@Y30SSJH*/ 01199000
         MVC   ALSTID(5),@CB01016                                  0530 01200000
*                    CTGPLPTR = CPLSAVE;                   /*@Y30SSJH*/ 01201000
*                                                                  0531 01202000
         L     @06,CPLSAVE                                         0531 01203000
         ST    @06,CTGPLPTR                                        0531 01204000
*                    END;                                  /*@Y30SSJH*/ 01205000
*                                                                  0532 01206000
*                END;                                      /*@Y30SSJH*/ 01207000
*                                                                  0533 01208000
@RF00528 DS    0H                                                  0534 01209000
*            END;                                          /*@Y30SSJH*/ 01210000
@RF00522 DS    0H                                                  0535 01211000
*                                                                  0535 01212000
*        /************************************************************/ 01213000
*        /*                                                          */ 01214000
*        /* LIST THE STATUS OF VOLUMES SPECIFIED VIA THE ADD/REMOVE  */ 01215000
*        /* VOLUMES PARAMETER                                        */ 01216000
*        /*                                                          */ 01217000
*        /************************************************************/ 01218000
*                                                                  0535 01219000
*        IF ALSTID = NORMAL                                        0535 01220000
*          THEN                                                    0535 01221000
@RF00516 CLC   ALSTID(5),@CB01034                                  0535 01222000
         BNE   @RF00535                                            0535 01223000
*            DO;                                           /*@Y30SSJH*/ 01224000
*            /********************************************************/ 01225000
*            /*                                                      */ 01226000
*            /* CTGFVVLT (POINTER IN ALTER FVT) INDICATES BY A NON-  */ 01227000
*            /* NULL VALUE THE PRESENCE OF AN ALTER VOLUME LIST. THE */ 01228000
*            /* VOLUMES IN THIS LIST ARE LISTED WITH THEIR STATUS AS */ 01229000
*            /* INDICATED BY VSAM ON RETURN FROM CATALOG MANAGEMENT  */ 01230000
*            /* EACH ENTRY IN THE VOLUME LIST IS 8 BYTES LONG.       */ 01231000
*            /* . BYTE 1 - ALLOCATION STATUS(SET BY VSAM)            */ 01232000
*            /* . BYTE 2 - RESERVED                                  */ 01233000
*            /* . BYTE 3-8 - VOLUME SERIAL NUMBER                    */ 01234000
*            /*                                                      */ 01235000
*            /********************************************************/ 01236000
*                                                                  0537 01237000
*            IF CTGFVVLT ^= NULLPTR                                0537 01238000
*              THEN                                                0537 01239000
         L     @06,CTGPLPTR                                        0537 01240000
         L     @06,CTGFVT(,@06)                                    0537 01241000
         L     @06,CTGFVVLT(,@06)                                  0537 01242000
         LTR   @06,@06                                             0537 01243000
         BZ    @RF00537                                            0537 01244000
*                DO;                                               0538 01245000
*                /****************************************************/ 01246000
*                /*                                                  */ 01247000
*                /* BUILD THE TEXT PROCESSOR DARGLIST, WHICH COMMUN- */ 01248000
*                /* ICATES THE REQUEST TO PRINT OUT VOLUME ALLOCATION*/ 01249000
*                /* AND DEALLOCATION STATUS.                         */ 01250000
*                /*                                                  */ 01251000
*                /****************************************************/ 01252000
*                                                                  0539 01253000
*                DARGLIST = ''B;          /* SET DARGLIST TO ZERO    */ 01254000
         L     @15,DDSTRU                                          0539 01255000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0539 01256000
*                DARGDBP  = CTGFVVLT + 2; /* SET POINTER TO VOL LIST */ 01257000
         LA    @14,2                                               0540 01258000
         ALR   @14,@06                                             0540 01259000
         ST    @14,DARGDBP(,@15)                                   0540 01260000
*                DARGILP  = VLISTLEN;     /* LENGTH OF VOLUME LIST   */ 01261000
         LH    @06,VLISTLEN(,@06)                                  0541 01262000
         STH   @06,DARGILP(,@15)                                   0541 01263000
*                DARGCNT  = 1;            /* REFERENCE GROUPS        */ 01264000
         LA    @14,1                                               0542 01265000
         STH   @14,DARGCNT(,@15)                                   0542 01266000
*                DARGINS(1)  = 1;         /* # OF INSERTS IN MESSAGE */ 01267000
         STH   @14,DARGINS(,@15)                                   0543 01268000
*                DARGPCT(1) = DARGILP / 8;/* REDO LOOP COUNT         */ 01269000
         LR    @00,@06                                             0544 01270000
         SRDA  @00,32                                              0544 01271000
         D     @00,@CF00039                                        0544 01272000
         STH   @01,DARGPCT(,@15)                                   0544 01273000
*                DARGSMOD = 'AL0';        /* STATIC TEXT MODULE ID   */ 01274000
         MVC   DARGSMOD(3,@15),@CC01426                            0545 01275000
*                DARGSENT = ALVLSTID;     /* MESSAGE ID              */ 01276000
*                                                                  0546 01277000
         MVI   DARGSENT(@15),X'01'                                 0546 01278000
*                /****************************************************/ 01279000
*                /*                                                  */ 01280000
*                /* INVOKE IDCAMS TEXT PROCESSOR FOR PRINT REQUEST   */ 01281000
*                /*                                                  */ 01282000
*                /****************************************************/ 01283000
*                                                                  0547 01284000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);            0547 01285000
*                                                                  0547 01286000
         L     @06,@PC00001                                        0547 01287000
         ST    @06,@AL00001                                        0547 01288000
         LA    @15,@CF00117                                        0547 01289000
         ST    @15,@AL00001+4                                      0547 01290000
         LA    @15,DDSTRU                                          0547 01291000
         ST    @15,@AL00001+8                                      0547 01292000
         MVI   @AL00001+8,X'80'                                    0547 01293000
         L     @15,GDTPRT(,@06)                                    0547 01294000
         LA    @01,@AL00001                                        0547 01295000
         BALR  @14,@15                                             0547 01296000
*                RESPECIFY RTNREG RSTD;                            0548 01297000
*                TESTRC = RTNREG;                                  0549 01298000
         STH   RTNREG,TESTRC                                       0549 01299000
*                RESPECIFY RTNREG UNRSTD;                          0550 01300000
*                                                                  0550 01301000
*                /****************************************************/ 01302000
*                /*                                                  */ 01303000
*                /* UPRINT ERROR - NOTE CONDITION IN STATUS FLAG     */ 01304000
*                /*                                                  */ 01305000
*                /****************************************************/ 01306000
*                                                                  0551 01307000
*                IF TESTRC ^= 0                                    0551 01308000
*                  THEN                                            0551 01309000
         LH    @06,TESTRC                                          0551 01310000
         LTR   @06,@06                                             0551 01311000
         BZ    @RF00551                                            0551 01312000
*                    LASTCC = MAX(LASTCC,LASTCC04);        /*@Y30SSJH*/ 01313000
*                                                                  0552 01314000
         L     @06,@PC00001+8                                      0552 01315000
         LH    @15,LASTCC(,@06)                                    0552 01316000
         LA    @14,4                                               0552 01317000
         CR    @15,@14                                             0552 01318000
         BNL   *+6                                                      01319000
         LR    @15,@14                                             0552 01320000
         STH   @15,LASTCC(,@06)                                    0552 01321000
*                END;                                              0553 01322000
*                                                                  0553 01323000
@RF00551 DS    0H                                                  0554 01324000
*              /******************************************************/ 01325000
*              /*                                            @Y30SSJH*/ 01326000
*              /* PRINT KEYS/RECORDSIZE NON-TERMINAL ERR MSG @Y30SSJH*/ 01327000
*              /*                                            @Y30SSJH*/ 01328000
*              /******************************************************/ 01329000
*                                                                  0554 01330000
*                IF ((ADDR(KEY)) ^= NULLPTR   |                    0554 01331000
*                    (ADDR(RECSZ)) ^= NULLPTR )  &                 0554 01332000
*                    KEYRECRC ^= 0                                 0554 01333000
*                  THEN                                            0554 01334000
@RF00537 SLR   @06,@06                                             0554 01335000
         L     @15,@PC00001+4                                      0554 01336000
         C     @06,FDTPTR+220(,@15)                                0554 01337000
         BNE   @GL00056                                            0554 01338000
         C     @06,FDTPTR+232(,@15)                                0554 01339000
         BE    @RF00554                                            0554 01340000
@GL00056 L     @06,KEYRECRC                                        0554 01341000
         LTR   @06,@06                                             0554 01342000
         BZ    @RF00554                                            0554 01343000
*                    DO;                                   /*@Y30SSJH*/ 01344000
*                                                                  0555 01345000
*                    DARGLIST = ''B;                       /*@Y30SSJH*/ 01346000
         L     @15,DDSTRU                                          0556 01347000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0556 01348000
*                    DARGSMOD = 'AL0';                     /*@Y30SSJH*/ 01349000
         MVC   DARGSMOD(3,@15),@CC01426                            0557 01350000
*                    ALSTCOND = 4;                         /*@Y30SSJH*/ 01351000
         MVI   ALSTCOND,X'04'                                      0558 01352000
*                    IF KEYRECRC = 4                               0559 01353000
*                      THEN                                        0559 01354000
         C     @06,@CF00044                                        0559 01355000
         BNE   @RF00559                                            0559 01356000
*                        DARGSENT = ALDFSTID;              /*@Y30SSJH*/ 01357000
         MVI   DARGSENT(@15),X'12'                                 0560 01358000
*                      ELSE                                        0561 01359000
*                        DARGSENT = ALNWSTID;              /*@Y30SSJH*/ 01360000
*                                                                  0561 01361000
         B     @RC00559                                            0561 01362000
@RF00559 L     @06,DDSTRU                                          0561 01363000
         MVI   DARGSENT(@06),X'13'                                 0561 01364000
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30SSJH*/ 01365000
*                                                                  0562 01366000
@RC00559 L     @06,@PC00001                                        0562 01367000
         ST    @06,@AL00001                                        0562 01368000
         LA    @15,@CF00117                                        0562 01369000
         ST    @15,@AL00001+4                                      0562 01370000
         LA    @15,DDSTRU                                          0562 01371000
         ST    @15,@AL00001+8                                      0562 01372000
         MVI   @AL00001+8,X'80'                                    0562 01373000
         L     @15,GDTPRT(,@06)                                    0562 01374000
         LA    @01,@AL00001                                        0562 01375000
         BALR  @14,@15                                             0562 01376000
*                    END;                                  /*@Y30SSJH*/ 01377000
*                /****************************************************/ 01378000
*                /*                                          @Y30SSJH*/ 01379000
*                /* UPRINT THE NAME OF THE ENTRY ALTERED     @Y30SSJH*/ 01380000
*                /*                                          @Y30SSJH*/ 01381000
*                /****************************************************/ 01382000
*                                                                  0564 01383000
*            DARGLIST = ''B;                               /*@Y30SSJH*/ 01384000
@RF00554 L     @06,DDSTRU                                          0564 01385000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0564 01386000
*            ALSTID = ENTRYALT;                            /*@Y30SSJH*/ 01387000
         MVC   ALSTID(5),@CB01061                                  0565 01388000
*            DARGDBP = ADDR(ENTVAL(ENT));                  /*@Y30SSJH*/ 01389000
         L     @15,ENT                                             0566 01390000
         MH    @15,@CH00687                                        0566 01391000
         L     @01,GENWKPTR                                        0566 01392000
         AL    @01,@CF01685                                        0566 01393000
         LA    @15,ENTVAL-5(@15,@01)                               0566 01394000
         ST    @15,DARGDBP(,@06)                                   0566 01395000
*            DARGSMOD = ALMODID;                           /*@Y30SSJH*/ 01396000
         MVC   DARGSMOD(3,@06),ALMODID                             0567 01397000
*            DARGSENT = ALSTD;                             /*@Y30SSJH*/ 01398000
         IC    @15,ALSTD                                           0568 01399000
         STC   @15,DARGSENT(,@06)                                  0568 01400000
*            DARGILP  = 44;                                 /*@YL026UA* 01401000
*                                                                  0569 01402000
         MVC   DARGILP(2,@06),@CH00594                             0569 01403000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/ 01404000
*                                                                  0570 01405000
         L     @06,@PC00001                                        0570 01406000
         ST    @06,@AL00001                                        0570 01407000
         LA    @15,@CF00117                                        0570 01408000
         ST    @15,@AL00001+4                                      0570 01409000
         LA    @15,DDSTRU                                          0570 01410000
         ST    @15,@AL00001+8                                      0570 01411000
         MVI   @AL00001+8,X'80'                                    0570 01412000
         L     @15,GDTPRT(,@06)                                    0570 01413000
         LA    @01,@AL00001                                        0570 01414000
         BALR  @14,@15                                             0570 01415000
*            ALSTID = NORMAL;                              /*@Y30SSJH*/ 01416000
*                                                                  0571 01417000
         MVC   ALSTID(5),@CB01034                                  0571 01418000
*            END;                                          /*@Y30SSJH*/ 01419000
*      ELSE                                                /*@Y30SSJH*/ 01420000
*CATERR: DO;                                               /*@OZ17504*/ 01421000
*                                                                  0573 01422000
         B     @RC00535                                            0573 01423000
@RF00535 DS    0H                                                  0573 01424000
CATERR   DS    0H                                                  0574 01425000
*        /************************************************************/ 01426000
*        /*                                                          */ 01427000
*        /* ISSUE TERMINATION MESSAGES AND SET LASTCC                */ 01428000
*        /* . THE TEXT PROCESSOR PRINTS MESSAGES AS DIRECTED BY THE  */ 01429000
*        /*   DARGLIST PARAMETER LIST                                */ 01430000
*        /* . THE SETTING OF 'ALSTID' CONTROLS THE BUILDING OF THE   */ 01431000
*        /*   DARGLIST.                                              */ 01432000
*        /*                                                          */ 01433000
*        /************************************************************/ 01434000
*                                                                  0574 01435000
*        DARGLIST = ''B;                                           0574 01436000
*                                                                  0574 01437000
         L     @06,DDSTRU                                          0574 01438000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0574 01439000
*        /************************************************************/ 01440000
*        /*                                                  @Y30SSJH*/ 01441000
*        /* A TERMINAL VSAM CATALOG ERROR OCCURRED. A MESSAGE IS     */ 01442000
*        /* PRINTED GIVING THE CATALOG ERROR CODE VIA        @Y30SSJH*/ 01443000
*        /* THE UERROR MACRO                                 @Y30SSJH*/ 01444000
*        /*                                                  @Y30SSJH*/ 01445000
*        /************************************************************/ 01446000
*                                                                  0575 01447000
*        IF ALSTID = CATERROR                                      0575 01448000
*          THEN                                                    0575 01449000
         CLC   ALSTID(5),@CB01016                                  0575 01450000
         BNE   @RF00575                                            0575 01451000
*            DO;                                           /*@Y30SSJH*/ 01452000
*                                                                  0576 01453000
*            ERCNVTAB = ''B;                               /*@Y30SSJH*/ 01454000
         L     @06,ERCNVADR                                        0577 01455000
         XC    ERCNVTAB(32,@06),ERCNVTAB(@06)                      0577 01456000
*            ERCATLG = ON;                                 /*@Y30SSJH*/ 01457000
         OI    ERCATLG(@06),B'10000000'                            0578 01458000
*            IF CTGFUNC = CTGLOC                                   0579 01459000
*              THEN                                                0579 01460000
         L     @01,CTGPLPTR                                        0579 01461000
         TM    CTGFUNC(@01),B'00100000'                            0579 01462000
         BNO   @RF00579                                            0579 01463000
         TM    CTGFUNC(@01),B'11000000'                            0579 01464000
         BNZ   @RF00579                                            0579 01465000
*                ERCATLC = ON;                             /*@Y30SSJH*/ 01466000
         OI    ERCATLC(@06),B'10000000'                            0580 01467000
*              ELSE                                                0581 01468000
*                ERCATAL = ON;                             /*@Y30SSJH*/ 01469000
         B     @RC00579                                            0581 01470000
@RF00579 L     @06,ERCNVADR                                        0581 01471000
         OI    ERCATAL(@06),B'00010000'                            0581 01472000
*            ERDSNM = ADDR(ENTVAL(ENT));                   /*@Y30SSJH*/ 01473000
@RC00579 L     @06,ERCNVADR                                        0582 01474000
         L     @15,ENT                                             0582 01475000
         MH    @15,@CH00687                                        0582 01476000
         L     @01,GENWKPTR                                        0582 01477000
         AL    @01,@CF01685                                        0582 01478000
         LA    @15,ENTVAL-5(@15,@01)                               0582 01479000
         ST    @15,ERDSNM(,@06)                                    0582 01480000
*            ERCATRC = CTGRTNCC;                           /*@Y30SSJH*/ 01481000
         L     @15,CTGRTNCC                                        0583 01482000
         ST    @15,ERCATRC(,@06)                                   0583 01483000
*            ERCPLPT = CTGPLPTR;                           /*@Y30SSJH*/ 01484000
*                                                                  0584 01485000
         L     @15,CTGPLPTR                                        0584 01486000
         ST    @15,ERCPLPT(,@06)                                   0584 01487000
*            CALL IDCTPER0 (GDTTBL,ERCNVADR);              /*@Y30SSJH*/ 01488000
*                                                                  0585 01489000
         L     @06,@PC00001                                        0585 01490000
         ST    @06,@AL00001                                        0585 01491000
         LA    @15,ERCNVADR                                        0585 01492000
         ST    @15,@AL00001+4                                      0585 01493000
         MVI   @AL00001+4,X'80'                                    0585 01494000
         L     @15,GDTERR(,@06)                                    0585 01495000
         LA    @01,@AL00001                                        0585 01496000
         BALR  @14,@15                                             0585 01497000
*            RESPECIFY RTNREG RSTD;                                0586 01498000
*            TESTRC = RTNREG;                                      0587 01499000
         STH   RTNREG,TESTRC                                       0587 01500000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/ 01501000
*                                                                  0588 01502000
*            /********************************************************/ 01503000
*            /*                                              @Y30SSJH*/ 01504000
*            /* UERROR WILL RETURN A RETURN CODE OF          @Y30SSJH*/ 01505000
*            /*   . 0 - SUCCESSFUL COMPLETION                @Y30SSJH*/ 01506000
*            /*   . 8 - UERROR UNABLE TO PRINT MESSAGE       @Y30SSJH*/ 01507000
*            /*                                              @Y30SSJH*/ 01508000
*            /********************************************************/ 01509000
*                                                                  0589 01510000
*            IF TESTRC ^= 0                                        0589 01511000
*              THEN                                                0589 01512000
         LH    @06,TESTRC                                          0589 01513000
         LTR   @06,@06                                             0589 01514000
         BZ    @RF00589                                            0589 01515000
*                LASTCC = MAX(LASTCC,LASTCC04);            /*@Y30SSJH*/ 01516000
*                                                                  0590 01517000
         L     @06,@PC00001+8                                      0590 01518000
         LH    @15,LASTCC(,@06)                                    0590 01519000
         LA    @14,4                                               0590 01520000
         CR    @15,@14                                             0590 01521000
         BNL   *+6                                                      01522000
         LR    @15,@14                                             0590 01523000
         STH   @15,LASTCC(,@06)                                    0590 01524000
*            ALSTID = TERMERR;                             /*@Y30SSJH*/ 01525000
*                                                                  0591 01526000
@RF00589 MVC   ALSTID(5),@CB01042                                  0591 01527000
*            END;                                          /*@Y30SSJH*/ 01528000
*                                                                  0592 01529000
*          ELSE                                                    0593 01530000
*            /********************************************************/ 01531000
*            /*                                              @OZ05940*/ 01532000
*            /* PARAMCHK DETECTED AN INCONSISTENCY BETWEEN THE       */ 01533000
*            /* ENTRY TYPE AND ONE OF THE PARAMETERS SPECIFIED       */ 01534000
*            /* ON THE ALTER COMMAND. PRINT A MESSAGE        @OZ05940*/ 01535000
*            /* INDICATING WHICH PARAMETER IS IN ERROR.      @OZ05940*/ 01536000
*            /*                                              @OZ05940*/ 01537000
*            /********************************************************/ 01538000
*                                                                  0593 01539000
*            IF ALSTID = BADPARM                                   0593 01540000
*              THEN                                                0593 01541000
         B     @RC00575                                            0593 01542000
@RF00575 CLC   ALSTID(5),@CB01098                                  0593 01543000
         BNE   @RF00593                                            0593 01544000
*                DO;                                       /*@OZ05940*/ 01545000
*                                                                  0594 01546000
*                DARGSMOD = ALMODID;                       /*@OZ05940*/ 01547000
         L     @06,DDSTRU                                          0595 01548000
         MVC   DARGSMOD(3,@06),ALMODID                             0595 01549000
*                DARGSENT = ALSTD;                         /*@OZ05940*/ 01550000
         IC    @15,ALSTD                                           0596 01551000
         STC   @15,DARGSENT(,@06)                                  0596 01552000
*                DARGDBP = ADDR(PARMTAB(PARMINDX));        /*@OZ05940*/ 01553000
         LA    @15,13                                              0597 01554000
         LR    @14,@15                                             0597 01555000
         MH    @14,PARMINDX                                        0597 01556000
         LA    @14,PARMTAB-13(@14)                                 0597 01557000
         ST    @14,DARGDBP(,@06)                                   0597 01558000
*                DARGILP = LENGTH(PARMTAB(PARMINDX));      /*@OZ05940*/ 01559000
*                                                                  0598 01560000
         STH   @15,DARGILP(,@06)                                   0598 01561000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@OZ05940*/ 01562000
*                                                                  0599 01563000
         L     @06,@PC00001                                        0599 01564000
         ST    @06,@AL00001                                        0599 01565000
         LA    @15,@CF00117                                        0599 01566000
         ST    @15,@AL00001+4                                      0599 01567000
         LA    @15,DDSTRU                                          0599 01568000
         ST    @15,@AL00001+8                                      0599 01569000
         MVI   @AL00001+8,X'80'                                    0599 01570000
         L     @15,GDTPRT(,@06)                                    0599 01571000
         LA    @01,@AL00001                                        0599 01572000
         BALR  @14,@15                                             0599 01573000
*                END;                                      /*@OZ05940*/ 01574000
*                                                                  0600 01575000
*              ELSE                                                0601 01576000
*                /****************************************************/ 01577000
*                /*                                          @OZ05940*/ 01578000
*                /* A TERMINAL NON-CATALOG ERROR OCCURRED. PRINT THE */ 01579000
*                /* MESSAGE AS DIRECTED BY 'ALSTID'.         @OZ05940*/ 01580000
*                /*                                          @OZ05940*/ 01581000
*                /****************************************************/ 01582000
*                                                                  0601 01583000
*                IF ALSTID ^= NORMAL       &                       0601 01584000
*                   ALSTID ^= NOENTALT                             0601 01585000
*                  THEN                                            0601 01586000
         B     @RC00593                                            0601 01587000
@RF00593 CLC   ALSTID(5),@CB01034                                  0601 01588000
         BE    @RF00601                                            0601 01589000
         CLC   ALSTID(5),@CB01058                                  0601 01590000
         BE    @RF00601                                            0601 01591000
*                    DO;                                   /*@OZ05940*/ 01592000
*                                                                  0602 01593000
*                    DARGSMOD = ALMODID;                   /*@OZ05940*/ 01594000
         L     @06,DDSTRU                                          0603 01595000
         MVC   DARGSMOD(3,@06),ALMODID                             0603 01596000
*                    DARGSENT = ALSTD;                     /*@OZ05940*/ 01597000
*                                                                  0604 01598000
         IC    @15,ALSTD                                           0604 01599000
         STC   @15,DARGSENT(,@06)                                  0604 01600000
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@OZ05940*/ 01601000
*                                                                  0605 01602000
         L     @06,@PC00001                                        0605 01603000
         ST    @06,@AL00001                                        0605 01604000
         LA    @15,@CF00117                                        0605 01605000
         ST    @15,@AL00001+4                                      0605 01606000
         LA    @15,DDSTRU                                          0605 01607000
         ST    @15,@AL00001+8                                      0605 01608000
         MVI   @AL00001+8,X'80'                                    0605 01609000
         L     @15,GDTPRT(,@06)                                    0605 01610000
         LA    @01,@AL00001                                        0605 01611000
         BALR  @14,@15                                             0605 01612000
*                    ALSTID = TERMERR;                     /*@OZ05940*/ 01613000
*                                                                  0606 01614000
         MVC   ALSTID(5),@CB01042                                  0606 01615000
*                    END;                                  /*@OZ05940*/ 01616000
*                                                                  0607 01617000
*                                                                  0607 01618000
*        /************************************************************/ 01619000
*        /*                                                  @Y30SSJH*/ 01620000
*        /* PRINT MESSAGE INDICATING ALTER WAS NOT PERFORMED @Y30SSJH*/ 01621000
*        /*                                                  @Y30SSJH*/ 01622000
*        /************************************************************/ 01623000
*                                                                  0608 01624000
*        IF ALSTID ^= NORMAL                                       0608 01625000
*          THEN                                                    0608 01626000
@RF00601 DS    0H                                                  0608 01627000
@RC00593 DS    0H                                                  0608 01628000
@RC00575 CLC   ALSTID(5),@CB01034                                  0608 01629000
         BE    @RF00608                                            0608 01630000
*            DO;                                           /*@Y30SSJH*/ 01631000
*                                                                  0609 01632000
*            DARGLIST = ''B;                               /*@Y30SSJH*/ 01633000
         L     @06,DDSTRU                                          0610 01634000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0610 01635000
*            ALSTID = NOENTALT;                            /*@Y30SSJH*/ 01636000
         MVC   ALSTID(5),@CB01058                                  0611 01637000
*            DARGDBP = ADDR(ENTVAL(ENT));                  /*@Y30SSJH*/ 01638000
         L     @15,ENT                                             0612 01639000
         MH    @15,@CH00687                                        0612 01640000
         L     @01,GENWKPTR                                        0612 01641000
         AL    @01,@CF01685                                        0612 01642000
         LA    @15,ENTVAL-5(@15,@01)                               0612 01643000
         ST    @15,DARGDBP(,@06)                                   0612 01644000
*            DARGSMOD = ALMODID;                           /*@Y30SSJH*/ 01645000
         MVC   DARGSMOD(3,@06),ALMODID                             0613 01646000
*            DARGSENT = ALSTD;                             /*@Y30SSJH*/ 01647000
         IC    @15,ALSTD                                           0614 01648000
         STC   @15,DARGSENT(,@06)                                  0614 01649000
*            DARGILP = 44;                                 /*@Y30SSJH*/ 01650000
*                                                                  0615 01651000
         MVC   DARGILP(2,@06),@CH00594                             0615 01652000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/ 01653000
*                                                                  0616 01654000
         L     @06,@PC00001                                        0616 01655000
         ST    @06,@AL00001                                        0616 01656000
         LA    @15,@CF00117                                        0616 01657000
         ST    @15,@AL00001+4                                      0616 01658000
         LA    @15,DDSTRU                                          0616 01659000
         ST    @15,@AL00001+8                                      0616 01660000
         MVI   @AL00001+8,X'80'                                    0616 01661000
         L     @15,GDTPRT(,@06)                                    0616 01662000
         LA    @01,@AL00001                                        0616 01663000
         BALR  @14,@15                                             0616 01664000
*            END;                                          /*@Y30SSJH*/ 01665000
*                                                                  0617 01666000
*        END CATERR;                                       /*@OZ17504*/ 01667000
*                                                                  0618 01668000
@RF00608 DS    0H                                                  0619 01669000
*        /************************************************************/ 01670000
*        /*                                                  @Y30SSJH*/ 01671000
*        /*  IF THE ENTRY HAS BEEN DYNAMICALLY ALLOCATED -   @Y30SSJH*/ 01672000
*        /*  ISSUE THE UDEALLOC MACRO TO DEALLOCATE IT       @Y30SSJH*/ 01673000
*        /*                                                  @Y30SSJH*/ 01674000
*        /************************************************************/ 01675000
*                                                                  0619 01676000
*          IF DALCINDX > 0                                         0619 01677000
*            THEN                                                  0619 01678000
@RC00535 L     @06,DALCINDX                                        0619 01679000
         LTR   @06,@06                                             0619 01680000
         BNP   @RF00619                                            0619 01681000
*              DO;                                         /*@Y30SSJH*/ 01682000
*                                                                  0620 01683000
*              CALL DALCPROC ('D',                                 0621 01684000
*                NULLPARM,                                         0621 01685000
*                NULLPARM,                                         0621 01686000
*                DALCINDX);                                /*@Y30SSJH*/ 01687000
*                                                                  0621 01688000
         LA    @06,@CC00855                                        0621 01689000
         ST    @06,@AL00001                                        0621 01690000
         SLR   @06,@06                                             0621 01691000
         ST    @06,@AL00001+4                                      0621 01692000
         ST    @06,@AL00001+8                                      0621 01693000
         LA    @06,DALCINDX                                        0621 01694000
         ST    @06,@AL00001+12                                     0621 01695000
         LA    @01,@AL00001                                        0621 01696000
         BAL   @14,DALCPROC                                        0621 01697000
*              IF TESTRC ^= 0                                      0622 01698000
*                THEN                                              0622 01699000
         LH    @06,TESTRC                                          0622 01700000
         LTR   @06,@06                                             0622 01701000
         BZ    @RF00622                                            0622 01702000
*                  LASTCC = MAX(LASTCC,LASTCC04);          /*@Y30SSJH*/ 01703000
*                                                                  0623 01704000
         L     @06,@PC00001+8                                      0623 01705000
         LH    @15,LASTCC(,@06)                                    0623 01706000
         LA    @14,4                                               0623 01707000
         CR    @15,@14                                             0623 01708000
         BNL   *+6                                                      01709000
         LR    @15,@14                                             0623 01710000
         STH   @15,LASTCC(,@06)                                    0623 01711000
*              END;                                        /*@Y30SSJH*/ 01712000
*                                                                  0624 01713000
@RF00622 DS    0H                                                  0625 01714000
*          /**********************************************************/ 01715000
*          /*                                                @Y30SSJH*/ 01716000
*          /*  SET THE LAST CONDITION CODE TO THE MAXIMUM CODE       */ 01717000
*          /*  ENCOUNTERED FOR THIS ENTRY.                   @Y30SSJH*/ 01718000
*          /*                                                @Y30SSJH*/ 01719000
*          /**********************************************************/ 01720000
*                                                                  0625 01721000
*          LASTCC = MAX(ALSTCOND,LASTCC);                  /*@Y30SSJH*/ 01722000
@RF00619 L     @06,@PC00001+8                                      0625 01723000
         SLR   @15,@15                                             0625 01724000
         IC    @15,ALSTCOND                                        0625 01725000
         LH    @14,LASTCC(,@06)                                    0625 01726000
         CR    @15,@14                                             0625 01727000
         BNL   *+6                                                      01728000
         LR    @15,@14                                             0625 01729000
         STH   @15,LASTCC(,@06)                                    0625 01730000
*          ALSTID = NORMAL;                                /*@Y30SSJH*/ 01731000
*                                                                  0626 01732000
         MVC   ALSTID(5),@CB01034                                  0626 01733000
*        END SAMECAT;                                      /*@Y30SSJH*/ 01734000
*        END GENLOOP;                                      /*@Y30SSJH*/ 01735000
@RC00438 LA    @06,1                                               0628 01736000
         AL    @06,ENT                                             0628 01737000
@DE00437 ST    @06,ENT                                             0628 01738000
         C     @06,GENCNT                                          0628 01739000
         BNH   @DL00437                                            0628 01740000
@DC00437 DS    0H                                                  0629 01741000
*        END NOTPDS;                                       /*@YL026UA*/ 01742000
*                                                                  0629 01743000
*        END GOODCAT;                                      /*@YL026UA*/ 01744000
*                                                                  0630 01745000
@RC00393 DS    0H                                                  0630 01746000
@RF00392 DS    0H                                                  0631 01747000
*        /************************************************************/ 01748000
*        /*                                                          */ 01749000
*        /* ISSUE SUMMARY MESSAGE                            @YL026UA*/ 01750000
*        /*                                                          */ 01751000
*        /************************************************************/ 01752000
*                                                                  0631 01753000
*        LASTCC = MAX(LASTCC,ALSTCOND);                    /*@YL026UA*/ 01754000
@RF00352 L     @06,@PC00001+8                                      0631 01755000
         LH    @15,LASTCC(,@06)                                    0631 01756000
         SLR   @14,@14                                             0631 01757000
         IC    @14,ALSTCOND                                        0631 01758000
         CR    @15,@14                                             0631 01759000
         BNL   *+6                                                      01760000
         LR    @15,@14                                             0631 01761000
         STH   @15,LASTCC(,@06)                                    0631 01762000
*        IF ALSTID = NORMAL & LASTCC = 0                   /*@YL026UA*/ 01763000
*          THEN                                                    0632 01764000
         CLC   ALSTID(5),@CB01034                                  0632 01765000
         BNE   @RF00632                                            0632 01766000
         LTR   @15,@15                                             0632 01767000
         BNZ   @RF00632                                            0632 01768000
*            ALSTD = NOTCOMP;                              /*@YL026UA*/ 01769000
         MVI   ALSTD,X'09'                                         0633 01770000
*        DARGLIST = ''B;                                           0634 01771000
@RF00632 L     @06,DDSTRU                                          0634 01772000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0634 01773000
*        DARGSMOD = ALMODID;                                       0635 01774000
         MVC   DARGSMOD(3,@06),ALMODID                             0635 01775000
*        IF LASTCC ^= 0     &                                      0636 01776000
*           GDTECT ^= NULLPTR                                      0636 01777000
*          THEN                                                    0636 01778000
         SLR   @15,@15                                             0636 01779000
         L     @14,@PC00001+8                                      0636 01780000
         CH    @15,LASTCC(,@14)                                    0636 01781000
         BE    @RF00636                                            0636 01782000
         L     @14,@PC00001                                        0636 01783000
         C     @15,GDTECT(,@14)                                    0636 01784000
         BE    @RF00636                                            0636 01785000
*            DARGSENT = 15;                                        0637 01786000
         MVI   DARGSENT(@06),X'0F'                                 0637 01787000
*          ELSE                                                    0638 01788000
*            IF LASTCC > LASTCC08                          /*@OZ18341*/ 01789000
*              THEN                                        /*@OZ18341*/ 01790000
         B     @RC00636                                            0638 01791000
@RF00636 L     @06,@PC00001+8                                      0638 01792000
         LH    @06,LASTCC(,@06)                                    0638 01793000
         C     @06,@CF00039                                        0638 01794000
         BNH   @RF00638                                            0638 01795000
*                DARGSENT = 3;                             /*@OZ18341*/ 01796000
         L     @06,DDSTRU                                          0639 01797000
         MVI   DARGSENT(@06),X'03'                                 0639 01798000
*              ELSE                                        /*@OZ18431*/ 01799000
*                DARGSENT = ALSTD;                         /*@OZ18341*/ 01800000
         B     @RC00638                                            0640 01801000
@RF00638 IC    @06,ALSTD                                           0640 01802000
         L     @01,DDSTRU                                          0640 01803000
         STC   @06,DARGSENT(,@01)                                  0640 01804000
*        DARGDBP  = ADDR(LASTCC);                                  0641 01805000
@RC00638 DS    0H                                                  0641 01806000
@RC00636 L     @06,DDSTRU                                          0641 01807000
         L     @15,@PC00001+8                                      0641 01808000
         ST    @15,DARGDBP(,@06)                                   0641 01809000
*        DARGILP  = 2;                                             0642 01810000
*                                                                  0642 01811000
         MVC   DARGILP(2,@06),@CH00155                             0642 01812000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     0643 01813000
*                                                                  0643 01814000
*                                                                  0643 01815000
         L     @06,@PC00001                                        0643 01816000
         ST    @06,@AL00001                                        0643 01817000
         LA    @15,@CF00117                                        0643 01818000
         ST    @15,@AL00001+4                                      0643 01819000
         LA    @15,DDSTRU                                          0643 01820000
         ST    @15,@AL00001+8                                      0643 01821000
         MVI   @AL00001+8,X'80'                                    0643 01822000
         L     @15,GDTPRT(,@06)                                    0643 01823000
         LA    @01,@AL00001                                        0643 01824000
         BALR  @14,@15                                             0643 01825000
*        IF GDTDBG = NULLPTR                                       0644 01826000
*          THEN;                                                   0644 01827000
         L     @06,@PC00001                                        0644 01828000
         L     @06,GDTDBG(,@06)                                    0644 01829000
         LTR   @06,@06                                             0644 01830000
         BZ    @RT00644                                            0644 01831000
*          ELSE                                                    0646 01832000
*            CALL IDCDB010(GDTTBL,'AL02');                         0646 01833000
*                                                                  0646 01834000
         L     @06,@PC00001                                        0646 01835000
         ST    @06,@AL00001                                        0646 01836000
         LA    @15,@CC01430                                        0646 01837000
         ST    @15,@AL00001+4                                      0646 01838000
         MVI   @AL00001+4,X'80'                                    0646 01839000
         L     @15,GDTDBG(,@06)                                    0646 01840000
         LA    @01,@AL00001                                        0646 01841000
         BALR  @14,@15                                             0646 01842000
*        CALL IDCSAFP0(GDTTBL,ALGPID,ALL);                 /*@OZ02157*/ 01843000
@RT00644 MVC   @AL00001+4(8),@AL00647                              0647 01844000
         L     @06,@PC00001                                        0647 01845000
         ST    @06,@AL00001                                        0647 01846000
         L     @15,GDTFPL(,@06)                                    0647 01847000
         LA    @01,@AL00001                                        0647 01848000
         BALR  @14,@15                                             0647 01849000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0648 01850000
         L     @06,@PC00001                                        0648 01851000
         ST    @06,@AL00001                                        0648 01852000
         LA    @15,MODID                                           0648 01853000
         ST    @15,@AL00001+4                                      0648 01854000
         MVI   @AL00001+4,X'80'                                    0648 01855000
         L     @15,GDTEPL(,@06)                                    0648 01856000
         LA    @01,@AL00001                                        0648 01857000
         BALR  @14,@15                                             0648 01858000
*/********************************************************************/ 01859000
*/*                                                                  */ 01860000
*/* PROCEDURE NAME - LOCATPRC (STAGE 2 PROCESSOR)                    */ 01861000
*/*                                                                  */ 01862000
*/* FUNCTION - LOCATES CATALOG FIELDS WHICH MAY BE ALTERED, BUT DUE  */ 01863000
*/*            TO THEIR COMPLEX NATURE (I.E. THEY CONTAIN MORE THAN  */ 01864000
*/*            ONE ATTRIBUTE), THEY MUST BE ALTERED IN THEIR ORIGINAL*/ 01865000
*/*            CONTEXT.                                              */ 01866000
*/*                                                                  */ 01867000
*/*            THIS PROCEDURE IS ENTERED FROM IDCAL01 FOR    @Y30SSJH*/ 01868000
*/*            THE FIRST, OR PRIMARY, LOCATE.  IF THE KEYS   @Y30SSJH*/ 01869000
*/*            AND/OR RECORDSIZE PARAMETERS HAVE BEEN        @Y30SSJH*/ 01870000
*/*            SPECIFIED, IT MAY BE ENTERED FROM CHECKPRC    @Y30SSJH*/ 01871000
*/*            FOR A SECONDARY LOCATE.                       @Y30SSJH*/ 01872000
*/*                                                          @Y30SSJH*/ 01873000
*/*            THE FIELDS REQUIRING THIS CONSIDERATION ARE:          */ 01874000
*/*              . PASSWALL - SECURITY COMBINATION FIELD             */ 01875000
*/*              . DSATTR - DATA SET ATTRIBUTES                      */ 01876000
*/*              . AMDSBCAT - RECORD MANAGEMENT COMBINATION FIELD    */ 01877000
*/*              . GDGATTR - GDG ATTRIBUTES                  @YL026UA*/ 01878000
*/*            IN ADDITION, THE ENTYPE, CATACB, NAMEDS,      @Y30SSJH*/ 01879000
*/*            HURBADS AND RGATTR FIELDS ARE LOCATED         @Y30SSJH*/ 01880000
*/*            TO BE USED IN LATER PROCESSING.               @Y30SSJH*/ 01881000
*/*                                                                  */ 01882000
*/*            LOCATPRC BUILDS THE CPL-FPL COMPLEX WHICH TRANSMITS   */ 01883000
*/*            THE LOCATE REQUEST TO VSAM CATALOG MANAGEMENT         */ 01884000
*/*              . THE CPL GIVES THE NAME OF THE OBJECT BEING LOCATED*/ 01885000
*/*                AND REFERENCES THE FPLS                           */ 01886000
*/*              . THE FPLS REFERENCE THE FIELDS WHICH ARE TO BE     */ 01887000
*/*                LOCATED (THE LENGTH AND ADDRESS TO THE LOCATED    */ 01888000
*/*                FIELD IS RETURNED TO LOCATPRC IN THE FPLS AS SET  */ 01889000
*/*                BY VSAM CATALOG MANAGEMENT)                       */ 01890000
*/*            THE CATALOG IS INVOKED BY THE IDCAMS UCATLG MACRO     */ 01891000
*/*                                                                  */ 01892000
*/* INPUT -                                                          */ 01893000
*/*            THE FDTTBL IN IDCAL01 IS REFERENCED                   */ 01894000
*/*                                                                  */ 01895000
*/* OUTPUT -                                                         */ 01896000
*/*            . LOCTABLE - DECLARED IN IDCAL01 IS INITIALIZED       */ 01897000
*/*            . ALSTID   - THE GLOBAL STATUS COMMUNICATOR IS SET    */ 01898000
*/*              ON ERROR DETECTION:                                 */ 01899000
*/*                ALSTID = NOSTORAG                                 */ 01900000
*/*                ALSTID = CATERROR                                 */ 01901000
*/*                ALSTID = LOCRTNER                                 */ 01902000
*/*                ALSTID = PSWDSUPR                                 */ 01903000
*/*                                                                  */ 01904000
*/********************************************************************/ 01905000
*                                                                  0649 01906000
*LOCATPRC:                                                         0649 01907000
*        PROCEDURE;                                                0649 01908000
@EL00001 L     @13,4(,@13)                                         0649 01909000
@EF00001 L     @00,@SIZDATD                                        0649 01910000
         LR    @01,@07                                             0649 01911000
         FREEMAIN R,LV=(0),A=(1)                                        01912000
@ER00001 LM    @14,@12,12(@13)                                     0649 01913000
         BR    @14                                                 0649 01914000
LOCATPRC STM   @14,@12,@SA00002                                    0649 01915000
*        /************************************************************/ 01916000
*        /*                                                          */ 01917000
*        /* UGPOOL/LOCATE CYCLE CONTROL AND DATA AREAS               */ 01918000
*        /*                                                          */ 01919000
*        /************************************************************/ 01920000
*        DCL                                                       0650 01921000
*          CYCLEFLG    CHAR(1),        /* CYCLE CONTROL FLAG         */ 01922000
*          LWKALEN     FIXED(31),      /* UGPOOL REQUEST LENGTH      */ 01923000
*          CYCLECNT    FIXED(8);       /* CYCLE COUNT                */ 01924000
*                                                                  0650 01925000
*                                                                  0650 01926000
*        /************************************************************/ 01927000
*        /*                                                          */ 01928000
*        /* OVERLAY OF LOCATE WORKAREA                       @Y30SSJH*/ 01929000
*        /*                                                          */ 01930000
*        /************************************************************/ 01931000
*        DCL                                                       0651 01932000
*          1 LOCATWKA  BASED(CTGWKA)BDY(WORD),                     0651 01933000
*            2 MYLENGTH  FIXED(15),    /* WKA LENGTH                 */ 01934000
*            2 REQDLEN   FIXED(15),    /* REQUIRED LENGTH SET BY VSAM*/ 01935000
*            2 *         CHAR(*);                                  0651 01936000
*                                                                  0651 01937000
*        /************************************************************/ 01938000
*        /*                                                          */ 01939000
*        /* ENTRY POINT TO LOCATPRC                                  */ 01940000
*        /*                                                          */ 01941000
*        /************************************************************/ 01942000
*                                                                  0652 01943000
*        OLDERID2 = NEWERID2;                                      0652 01944000
         L     @06,@PC00001                                        0652 01945000
         L     @06,GDTTR2(,@06)                                    0652 01946000
         MVC   @TS00001(95),NEWERID2(@06)                          0652 01947000
         MVC   OLDERID2(95,@06),@TS00001                           0652 01948000
*        NEWID2 = 'AL31';                                          0653 01949000
*                                                                  0653 01950000
         MVC   NEWID2(4,@06),@CC01441                              0653 01951000
*        /************************************************************/ 01952000
*        /*                                                          */ 01953000
*        /* INITIALIZE CPL FOR LOCATE                                */ 01954000
*        /*                                                          */ 01955000
*        /************************************************************/ 01956000
*                                                                  0654 01957000
*        CTGPLPTR = ADDR(ALCTGPL);     /* SET POINTER TO THE CPL     */ 01958000
         L     @06,ALPRMPTR                                        0654 01959000
         LA    @15,ALCTGPL(,@06)                                   0654 01960000
         ST    @15,CTGPLPTR                                        0654 01961000
*        ALCPLID = 'CPL';              /* CPL DUMP ID                */ 01962000
         MVI   ALCPLID+3(@06),C' '                                 0655 01963000
         MVC   ALCPLID+4(4,@06),ALCPLID+3(@06)                     0655 01964000
         MVC   ALCPLID(3,@06),@CC01442                             0655 01965000
*        CTGNAME = ON;                 /* LOCATE BY ENTRY NAME       */ 01966000
         OI    CTGNAME(@15),B'00000100'                            0656 01967000
*        CTGFUNC = CTGLOC;             /* SET NON-CMS LOCATE FUNCTION*/ 01968000
         NI    CTGFUNC(@15),B'00111111'                            0657 01969000
         OI    CTGFUNC(@15),B'00100000'                            0657 01970000
*        CTGNUM = ON;                  /* SEARCH ONE CATALOG         */ 01971000
*        CTGAM0 = ON;                  /* VSAM CATALOG REQUEST       */ 01972000
         OI    CTGNUM(@15),B'00000011'                             0659 01973000
*        IF DATACI = INITVALU                                      0660 01974000
*          THEN                                                    0660 01975000
         CLC   DATACI(3),INITVALU                                  0660 01976000
         BNE   @RF00660                                            0660 01977000
*            CTGENT = ADDR(ENTVAL(ENT));                   /*@Y30SSJH*/ 01978000
         L     @06,ENT                                             0661 01979000
         MH    @06,@CH00687                                        0661 01980000
         L     @01,GENWKPTR                                        0661 01981000
         AL    @01,@CF01685                                        0661 01982000
         LA    @06,ENTVAL-5(@06,@01)                               0661 01983000
         ST    @06,CTGENT(,@15)                                    0661 01984000
*          ELSE                                                    0662 01985000
*            DO;                                           /*@Y30SSJH*/ 01986000
*                                                                  0662 01987000
         B     @RC00660                                            0662 01988000
@RF00660 DS    0H                                                  0663 01989000
*            CTGNAME = OFF;                                /*@Y30SSJH*/ 01990000
         L     @06,CTGPLPTR                                        0663 01991000
         NI    CTGNAME(@06),B'11111011'                            0663 01992000
*            CTGENT = ADDR(DATACI);                        /*@Y30SSJH*/ 01993000
*                                                                  0664 01994000
         LA    @15,DATACI                                          0664 01995000
         ST    @15,CTGENT(,@06)                                    0664 01996000
*            END;                                          /*@Y30SSJH*/ 01997000
*        CTGCNAME = ON;                /* CATLG NAME SUPPLIED OR NULL*/ 01998000
*                                                                  0666 01999000
@RC00660 L     @06,CTGPLPTR                                        0666 02000000
         OI    CTGCNAME(@06),B'00000010'                           0666 02001000
*        /************************************************************/ 02002000
*        /*                                                  @OZ24944*/ 02003000
*        /* LEAVE CTGMAST OFF DURING LOCATES FOR GDG ATTRIBUTES.     */ 02004000
*        /*                                                  @OZ24944*/ 02005000
*        /************************************************************/ 02006000
*                                                                  0667 02007000
*        IF (ADDR(GDGEM) = NULLPTR &                       /*@OZ24944*/ 02008000
*           ADDR(GDGNE) = NULLPTR &                        /*@OZ24944*/ 02009000
*           ADDR(GDGSC) = NULLPTR &                        /*@OZ24944*/ 02010000
*           ADDR(GDGNS) = NULLPTR)                         /*@OZ24944*/ 02011000
*        THEN                                              /*@OZ24944*/ 02012000
         SLR   @15,@15                                             0667 02013000
         L     @14,@PC00001+4                                      0667 02014000
         C     @15,FDTPTR+196(,@14)                                0667 02015000
         BNE   @RF00667                                            0667 02016000
         C     @15,FDTPTR+200(,@14)                                0667 02017000
         BNE   @RF00667                                            0667 02018000
         C     @15,FDTPTR+204(,@14)                                0667 02019000
         BNE   @RF00667                                            0667 02020000
         C     @15,FDTPTR+208(,@14)                                0667 02021000
         BNE   @RF00667                                            0667 02022000
*          CTGMAST = ON;               /* FORCE MASTER PSWD VERIFY   */ 02023000
*                                                                  0668 02024000
         OI    CTGMAST(@06),B'01000000'                            0668 02025000
*        /************************************************************/ 02026000
*        /*                                                          */ 02027000
*        /* SET CPL REFERENCE TO CATALOG IN WHICH ENTRY RESIDES      */ 02028000
*        /* . CATACBPT IS PASSED TO THIS PROCEDURE AS AN ARGUMENT OF */ 02029000
*        /*   INVOCATION IF THE CATALOG HAS BEEN OPENED IN IDCAL01.  */ 02030000
*        /*                                                          */ 02031000
*        /************************************************************/ 02032000
*                                                                  0669 02033000
*        IF CATACBPT ^= NULLPTR                                    0669 02034000
*          THEN                                                    0669 02035000
@RF00667 L     @06,CATACBPT                                        0669 02036000
         LTR   @06,@06                                             0669 02037000
         BZ    @RF00669                                            0669 02038000
*            DO;                                                   0670 02039000
*                                                                  0670 02040000
*            CTGCNAME = OFF;            /* INDICATE CATLG ACB GIVEN  */ 02041000
         L     @15,CTGPLPTR                                        0671 02042000
         NI    CTGCNAME(@15),B'11111101'                           0671 02043000
*            CTGCAT = CATACBPT;         /* ACB ADDRESS OF CATALOG    */ 02044000
*                                                                  0672 02045000
         ST    @06,CTGCAT(,@15)                                    0672 02046000
*            END;                                                  0673 02047000
*                                                                  0673 02048000
*          /**********************************************************/ 02049000
*          /*                                                        */ 02050000
*          /* CATLG ACB ADDRESS NOT SPECIFIED - SET PTR TO CATLG NAME*/ 02051000
*          /* IF A CATALOG NAME NOR ACB IS NOT PROVIDED THE CATALOG  */ 02052000
*          /* SEARCH FOLLOWS THE STEPCAT|JOBCAT, MASTERCATALOG HIER- */ 02053000
*          /* ARCHY.                                                 */ 02054000
*          /*                                                        */ 02055000
*          /**********************************************************/ 02056000
*                                                                  0674 02057000
*          ELSE                                                    0674 02058000
*            IF (ADDR(CATLG)) ^= NULLPTR                           0674 02059000
*              THEN                                                0674 02060000
         B     @RC00669                                            0674 02061000
@RF00669 L     @06,@PC00001+4                                      0674 02062000
         L     @06,FDTPTR+8(,@06)                                  0674 02063000
         LTR   @06,@06                                             0674 02064000
         BZ    @RF00674                                            0674 02065000
*                CTGCAT = ADDR(CATLGVAL);                  /*@YL026UA*/ 02066000
         LA    @06,CATLGVAL(,@06)                                  0675 02067000
         L     @01,CTGPLPTR                                        0675 02068000
         ST    @06,CTGCAT(,@01)                                    0675 02069000
*              ELSE                                                0676 02070000
*                IF NTRYPOS ^= 0                                   0676 02071000
*                  THEN                                            0676 02072000
         B     @RC00674                                            0676 02073000
@RF00674 L     @06,@PC00001+4                                      0676 02074000
         L     @06,FDTPTR(,@06)                                    0676 02075000
         CLI   NTRYPOS(@06),0                                      0676 02076000
         BE    @RF00676                                            0676 02077000
*                    CTGCAT = ADDR(CATNAME);               /*@YL026UA*/ 02078000
*                                                                  0677 02079000
         LA    @06,CATNAME                                         0677 02080000
         L     @01,CTGPLPTR                                        0677 02081000
         ST    @06,CTGCAT(,@01)                                    0677 02082000
*        /************************************************************/ 02083000
*        /*                                                          */ 02084000
*        /* INITIALIZE THE PASSWORD ADDRESS - EITHER CATLG OR ENTRY  */ 02085000
*        /* PASSWORD. THE CATALOG PASSWORD HAS THE HIGHEST PRIORITY  */ 02086000
*        /*                                                          */ 02087000
*        /************************************************************/ 02088000
*                                                                  0678 02089000
*        IF (ADDR(CATLG)) ^= NULLPTR                               0678 02090000
*          THEN                                                    0678 02091000
@RF00676 DS    0H                                                  0678 02092000
@RC00674 DS    0H                                                  0678 02093000
@RC00669 L     @06,@PC00001+4                                      0678 02094000
         L     @06,FDTPTR+8(,@06)                                  0678 02095000
         LTR   @06,@06                                             0678 02096000
         BZ    @RF00678                                            0678 02097000
*            IF CATLGPLN ^= 0                                      0679 02098000
*              THEN                                                0679 02099000
         CLI   CATLGPLN(@06),0                                     0679 02100000
         BE    @RF00679                                            0679 02101000
*                CTGPSWD = ADDR(CATLGPAS);  /* CATALOG PASSWORD      */ 02102000
*                                                                  0680 02103000
         LA    @06,CATLGPAS(,@06)                                  0680 02104000
         L     @01,CTGPLPTR                                        0680 02105000
         ST    @06,CTGPSWD(,@01)                                   0680 02106000
*        IF CTGPSWD = NULLPTR                                      0681 02107000
*          THEN                                                    0681 02108000
@RF00679 DS    0H                                                  0681 02109000
@RF00678 L     @06,CTGPLPTR                                        0681 02110000
         L     @15,CTGPSWD(,@06)                                   0681 02111000
         LTR   @15,@15                                             0681 02112000
         BNZ   @RF00681                                            0681 02113000
*            IF NTRYPLN ^= 0                                       0682 02114000
*              THEN                                                0682 02115000
         L     @15,@PC00001+4                                      0682 02116000
         L     @15,FDTPTR(,@15)                                    0682 02117000
         CLI   NTRYPLN(@15),0                                      0682 02118000
         BE    @RF00682                                            0682 02119000
*                CTGPSWD = ADDR(NTRYPAS);   /* ENTRY PASSWORD        */ 02120000
*                                                                  0683 02121000
         LA    @15,NTRYPAS(,@15)                                   0683 02122000
         ST    @15,CTGPSWD(,@06)                                   0683 02123000
*        /************************************************************/ 02124000
*        /*                                                  @Y30SSJH*/ 02125000
*        /* IF THE KEYS AND/OR RECORDSIZE PARAMETER HAS BEEN @Y30SSJH*/ 02126000
*        /* SPECIFIED AND A LOCATE HAS BEEN PERFORMED AT A   @Y30SSJH*/ 02127000
*        /* LEVEL HIGHER THAN DATA, SET BYPASS VERIFICATION  @Y30SSJH*/ 02128000
*        /* - EFFECTIVE IN DOS ONLY                          @Y30SSJH*/ 02129000
*        /*                                                  @Y30SSJH*/ 02130000
*        /************************************************************/ 02131000
*                                                                  0684 02132000
*        IF ((ADDR(KEY))   ^= NULLPTR |                            0684 02133000
*            (ADDR(RECSZ)) ^= NULLPTR )                            0684 02134000
*          THEN                                                    0684 02135000
@RF00682 DS    0H                                                  0684 02136000
@RF00681 SLR   @06,@06                                             0684 02137000
         L     @15,@PC00001+4                                      0684 02138000
         C     @06,FDTPTR+220(,@15)                                0684 02139000
         BNE   @RT00684                                            0684 02140000
         C     @06,FDTPTR+232(,@15)                                0684 02141000
         BE    @RF00684                                            0684 02142000
@RT00684 DS    0H                                                  0685 02143000
*            IF BYPASSSW = STOP                                    0685 02144000
*              THEN                                                0685 02145000
         CLI   BYPASSSW,X'0F'                                      0685 02146000
         BNE   @RF00685                                            0685 02147000
*                CTGBYPSS = ON;                            /*@Y30SSJH*/ 02148000
*                                                                  0686 02149000
         L     @06,CTGPLPTR                                        0686 02150000
         OI    CTGBYPSS(@06),B'10000000'                           0686 02151000
*        /************************************************************/ 02152000
*        /*                                                          */ 02153000
*        /* INITIALIZE FPLS FOR FIELDS TO BE LOCATED - ENTYPE,CATACB */ 02154000
*        /*    PASSWALL,DSATTR,AMDSBCAT,GDGATTR                      */ 02155000
*        /* . SET CTGFLPTR TO FIRST (ENTYPE) FPL                     */ 02156000
*        /* . SET DUMP ID'S FOR FPL'S                                */ 02157000
*        /* . SET CTGNOFLD TO # OF FPLS IN LOCATE REQUEST            */ 02158000
*        /*                                                          */ 02159000
*        /************************************************************/ 02160000
*                                                                  0687 02161000
*        ALFPLLST(1:256) = ''B;                            /*@Y30SSJH*/ 02162000
@RF00685 DS    0H                                                  0687 02163000
@RF00684 L     @06,ALPRMPTR                                        0687 02164000
         XC    ALFPLLST(256,@06),ALFPLLST(@06)                     0687 02165000
*        ALFPLLST(257:LENGTH(ALFPLLST)) = ''B;             /*@Y30SSJH*/ 02166000
*                                                                  0688 02167000
         XC    ALFPLLST+256(192,@06),ALFPLLST+256(@06)             0688 02168000
*        CTGFLPTR = ADDR(ALFPLTYP);                                0689 02169000
         LA    @15,ALFPLTYP(,@06)                                  0689 02170000
         ST    @15,CTGFLPTR                                        0689 02171000
*        ALTYP = 'TYPE';                                           0690 02172000
         MVC   ALTYP(4,@06),@CC01444                               0690 02173000
*        ALACB = 'ACB';                                            0691 02174000
         MVI   ALACB+3(@06),C' '                                   0691 02175000
         MVC   ALACB(3,@06),@CC01445                               0691 02176000
*        ALNAM = 'NAME';                                   /*@Y30SSJH*/ 02177000
         MVC   ALNAM(4,@06),@CC00205                               0692 02178000
*        ALRBA = 'RBA';                                    /*@Y30SSJH*/ 02179000
         MVI   ALRBA+3(@06),C' '                                   0693 02180000
         MVC   ALRBA(3,@06),@CC01446                               0693 02181000
*        ALCRA = 'CRA';                                    /*@Y30SSJH*/ 02182000
         MVI   ALCRA+3(@06),C' '                                   0694 02183000
         MVC   ALCRA(3,@06),@CC01447                               0694 02184000
*        ALPSW = 'PSWD';                                           0695 02185000
         MVC   ALPSW(4,@06),@CC01448                               0695 02186000
*        ALDAT = 'DSAT';                                   /*@Y30SSJH*/ 02187000
         MVC   ALDAT(4,@06),@CC01449                               0696 02188000
*        ALAMD = 'AMDB';                                           0697 02189000
         MVC   ALAMD(4,@06),@CC01450                               0697 02190000
*        ALGDG = 'GDG';                                    /*@YL026UA*/ 02191000
         MVI   ALGDG+3(@06),C' '                                   0698 02192000
         MVC   ALGDG(3,@06),@CC01451                               0698 02193000
*        ALRGA = 'RGAT';                                   /*@Y30SSJH*/ 02194000
         MVC   ALRGA(4,@06),@CC01452                               0699 02195000
*        CTGNOFLD = 10;                                    /*@Y30SSJH*/ 02196000
*                                                                  0700 02197000
         L     @06,CTGPLPTR                                        0700 02198000
         MVI   CTGNOFLD(@06),X'0A'                                 0700 02199000
*        /************************************************************/ 02200000
*        /*                                                          */ 02201000
*        /* INITIALIZE EACH FPL AND REFERENCE IT IN THE CPL          */ 02202000
*        /*                                                          */ 02203000
*        /************************************************************/ 02204000
*                                                                  0701 02205000
*        DO N = 1 TO 10;                                   /*@Y30SSJH*/ 02206000
*                                                                  0701 02207000
         LA    @06,1                                               0701 02208000
         ST    @06,N                                               0701 02209000
@DL00701 DS    0H                                                  0702 02210000
*          CTGFLDNO = 1;                                           0702 02211000
         L     @15,CTGFLPTR                                        0702 02212000
         MVI   CTGFLDNO(@15),X'01'                                 0702 02213000
*          CTGFLDNM = ADDR(ALFLDNAM(N));                           0703 02214000
         LR    @14,@06                                             0703 02215000
         SLA   @14,3                                               0703 02216000
         LA    @14,ALFLDNAM-8(@14)                                 0703 02217000
         ST    @14,CTGFLDNM(,@15)                                  0703 02218000
*          CTGFIELD(N) = CTGFLPTR;                                 0704 02219000
         LR    @14,@06                                             0704 02220000
         SLA   @14,2                                               0704 02221000
         L     @01,CTGPLPTR                                        0704 02222000
         ST    @15,CTGFIELD-4(@14,@01)                             0704 02223000
*          CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL)+8) + 4;            0705 02224000
*                                                                  0705 02225000
         AL    @15,@CF00678                                        0705 02226000
         ST    @15,CTGFLPTR                                        0705 02227000
*        END;                                                      0706 02228000
         AL    @06,@CF00220                                        0706 02229000
         ST    @06,N                                               0706 02230000
         C     @06,@CF00037                                        0706 02231000
         BNH   @DL00701                                            0706 02232000
*        /************************************************************/ 02233000
*        /*                                                  @Y30SSJH*/ 02234000
*        /* INITIALIZE NAMEDS TEST FPL AND REFERENCE IT IN   @Y30SSJH*/ 02235000
*        /* THE NAMEDS FPL - THIS LIMITS THE NUMBER OF       @Y30SSJH*/ 02236000
*        /* ASSOCIATIONS RETURNED TO FIVE                    @Y30SSJH*/ 02237000
*        /*                                                  @Y30SSJH*/ 02238000
*        /************************************************************/ 02239000
*                                                                  0707 02240000
*        CTGFLPTR = ADDR(ALFPLTST);                        /*@Y30SSJH*/ 02241000
         L     @06,ALPRMPTR                                        0707 02242000
         LA    @15,ALFPLTST(,@06)                                  0707 02243000
         ST    @15,CTGFLPTR                                        0707 02244000
*        ALNAMTST = 'TEST';                                /*@Y30SSJH*/ 02245000
         MVC   ALNAMTST(4,@06),@CC01453                            0708 02246000
*        CTGFLDNO = 1;                                     /*@Y30SSJH*/ 02247000
         MVI   CTGFLDNO(@15),X'01'                                 0709 02248000
*        CTGFLDCD = CTGFLDLE;                              /*@Y30SSJH*/ 02249000
         MVI   CTGFLDCD(@15),X'C0'                                 0710 02250000
*        CTGFLDNM = ADDR(ALFLDNAM(16));                    /*@Y30SSJH*/ 02251000
         LA    @14,ALFLDNAM+120                                    0711 02252000
         ST    @14,CTGFLDNM(,@15)                                  0711 02253000
*        CTGFLNG(1) = 2;                                   /*@Y30SSJH*/ 02254000
         MVC   CTGFLNG(4,@15),@CF00155                             0712 02255000
*        CTGFLPT(1) = ADDR(NAMEMASK);                      /*@Y30SSJH*/ 02256000
*                                                                  0713 02257000
         LA    @14,NAMEMASK                                        0713 02258000
         ST    @14,CTGFLPT(,@15)                                   0713 02259000
*        CTGFLPTR = ADDR(ALFPLNAM);                        /*@Y30SSJH*/ 02260000
         LA    @06,ALFPLNAM(,@06)                                  0714 02261000
         ST    @06,CTGFLPTR                                        0714 02262000
*        CTGFLCHN = ADDR(ALFPLTST);                        /*@Y30SSJH*/ 02263000
*                                                                  0715 02264000
         ST    @15,CTGFLCHN(,@06)                                  0715 02265000
*        /************************************************************/ 02266000
*        /*                                                          */ 02267000
*        /* UGPOOL/LOCATE CYCLE - WORKAREA SPACE IS PROCURED AND THE */ 02268000
*        /* LOCATE REQUEST IS ISSUED. THIS CYCLE WILL REPEAT IF THE  */ 02269000
*        /* FIRST LOCATE WAS ISSUED WITH INSUFFICIENT WORKAREA       */ 02270000
*        /*                                                          */ 02271000
*        /************************************************************/ 02272000
*                                                                  0716 02273000
*        LWKALEN = WKALEN1;                                /*@Y30SSJH*/ 02274000
         MVC   LWKALEN(4),@CF01117                                 0716 02275000
*        CYCLEFLG = GO;                                            0717 02276000
         MVI   CYCLEFLG,X'00'                                      0717 02277000
*        CYCLECNT = 1;                                             0718 02278000
*                                                                  0718 02279000
         MVI   CYCLECNT,X'01'                                      0718 02280000
*UGPLLOC: DO WHILE CYCLEFLG = GO;                                  0719 02281000
*                                                                  0719 02282000
UGPLLOC  B     @DE00719                                            0719 02283000
@DL00719 DS    0H                                                  0720 02284000
*        CALL IDCSAGP0(GDTTBL,                                     0720 02285000
*               LWKALEN,               /* LENGTH OF STORAGE REQUEST  */ 02286000
*               CTGWKA,                /* POINTER TO WORKAREA        */ 02287000
*               ALGPID,                /* UGPOOL ID                  */ 02288000
*               SETZERO);              /* SET AREA TO ZERO           */ 02289000
*                                                                  0720 02290000
         L     @06,@PC00001                                        0720 02291000
         ST    @06,@AL00001                                        0720 02292000
         LA    @15,LWKALEN                                         0720 02293000
         ST    @15,@AL00001+4                                      0720 02294000
         L     @01,CTGPLPTR                                        0720 02295000
         LA    @15,CTGWKA(,@01)                                    0720 02296000
         ST    @15,@AL00001+8                                      0720 02297000
         LA    @15,ALGPID                                          0720 02298000
         ST    @15,@AL00001+12                                     0720 02299000
         LA    @15,SETZERO                                         0720 02300000
         ST    @15,@AL00001+16                                     0720 02301000
         MVI   @AL00001+16,X'80'                                   0720 02302000
         L     @15,GDTGPL(,@06)                                    0720 02303000
         LA    @01,@AL00001                                        0720 02304000
         BALR  @14,@15                                             0720 02305000
*        RESPECIFY RTNREG RSTD;                                    0721 02306000
*        TESTRC = RTNREG;                                          0722 02307000
         STH   RTNREG,TESTRC                                       0722 02308000
*        RESPECIFY RTNREG UNRSTD;                                  0723 02309000
*                                                                  0723 02310000
*        IF TESTRC ^= 0                                            0724 02311000
*          THEN                                                    0724 02312000
         LH    @06,TESTRC                                          0724 02313000
         LTR   @06,@06                                             0724 02314000
         BZ    @RF00724                                            0724 02315000
*            DO;                                                   0725 02316000
*                                                                  0725 02317000
*            ALSTID = NOSTORAG;                                    0726 02318000
         MVC   ALSTID(5),@CB01039                                  0726 02319000
*            RETURN;                                               0727 02320000
*                                                                  0727 02321000
@EL00002 DS    0H                                                  0727 02322000
@EF00002 DS    0H                                                  0727 02323000
@ER00002 LM    @14,@12,@SA00002                                    0727 02324000
         BR    @14                                                 0727 02325000
*            END;                                                  0728 02326000
*                                                                  0728 02327000
*        MYLENGTH = LWKALEN;                                       0729 02328000
*                                                                  0729 02329000
@RF00724 L     @06,CTGPLPTR                                        0729 02330000
         L     @06,CTGWKA(,@06)                                    0729 02331000
         L     @15,LWKALEN                                         0729 02332000
         STH   @15,MYLENGTH(,@06)                                  0729 02333000
*        /************************************************************/ 02334000
*        /*                                                          */ 02335000
*        /* ISSUE CATALOG LOCATE REQUEST                             */ 02336000
*        /*                                                          */ 02337000
*        /************************************************************/ 02338000
*                                                                  0730 02339000
*        CALL IDCSACA0 (GDTTBL,CTGPLPTR);                          0730 02340000
*                                                                  0730 02341000
         L     @06,@PC00001                                        0730 02342000
         ST    @06,@AL00001                                        0730 02343000
         LA    @15,CTGPLPTR                                        0730 02344000
         ST    @15,@AL00001+4                                      0730 02345000
         L     @15,GDTCAT(,@06)                                    0730 02346000
         LA    @01,@AL00001                                        0730 02347000
         BALR  @14,@15                                             0730 02348000
*        RESPECIFY (RTNREG) RSTD;                          /*@Y30SSJH*/ 02349000
*        CTGRTNCC = RTNREG;                                        0732 02350000
         ST    RTNREG,CTGRTNCC                                     0732 02351000
*        RESPECIFY (RTNREG) UNRSTD;                        /*@Y30SSJH*/ 02352000
*                                                                  0733 02353000
*        IF GDTDBG = NULLPTR                                       0734 02354000
*          THEN;                                                   0734 02355000
         L     @06,@PC00001                                        0734 02356000
         L     @06,GDTDBG(,@06)                                    0734 02357000
         LTR   @06,@06                                             0734 02358000
         BZ    @RT00734                                            0734 02359000
*          ELSE                                                    0736 02360000
*            CALL IDCDB010(GDTTBL,'AL03');                         0736 02361000
         L     @06,@PC00001                                        0736 02362000
         ST    @06,@AL00001                                        0736 02363000
         LA    @15,@CC01456                                        0736 02364000
         ST    @15,@AL00001+4                                      0736 02365000
         MVI   @AL00001+4,X'80'                                    0736 02366000
         L     @15,GDTDBG(,@06)                                    0736 02367000
         LA    @01,@AL00001                                        0736 02368000
         BALR  @14,@15                                             0736 02369000
*                                                                  0737 02370000
*        /************************************************************/ 02371000
*        /*                                                          */ 02372000
*        /* CHECK CATALOG RETURN CODES - INSUFFICIENT WKA WILL RESULT*/ 02373000
*        /* IN REISSUANCE OF THE CYCLE  ON FIRST TIME THRU           */ 02374000
*        /*                                                          */ 02375000
*        /************************************************************/ 02376000
*                                                                  0737 02377000
*        IF CTGRTNCC = 0                                           0737 02378000
*          THEN                                                    0737 02379000
@RT00734 L     @06,CTGRTNCC                                        0737 02380000
         LTR   @06,@06                                             0737 02381000
         BNZ   @RF00737                                            0737 02382000
*            CYCLEFLG = STOP;                                      0738 02383000
*                                                                  0738 02384000
         MVI   CYCLEFLG,X'0F'                                      0738 02385000
*          ELSE                                                    0739 02386000
*            IF CTGRTNCC = 40          /* INSUFFICIENT WORKAREA      */ 02387000
*              THEN                                                0739 02388000
         B     @RC00737                                            0739 02389000
@RF00737 CLC   CTGRTNCC(4),@CF00720                                0739 02390000
         BNE   @RF00739                                            0739 02391000
*                IF CYCLECNT = 1       /* FIRST CYCLE                */ 02392000
*                  THEN                                            0740 02393000
         CLI   CYCLECNT,1                                          0740 02394000
         BNE   @RF00740                                            0740 02395000
*                    DO;                                           0741 02396000
*                                                                  0741 02397000
*                    /************************************************/ 02398000
*                    /*                                              */ 02399000
*                    /* INSUFFICIENT WORKAREA FOR FIRST CYCLE LOCATE */ 02400000
*                    /* . BUMPCYCLECNT TO INDICATE LOCATE REISSUE    */ 02401000
*                    /* . SET 'LWKALEN TO REQUIRED LENGTH AS RETURNED*/ 02402000
*                    /*   BY VSAM FROM FIRST LOCATE(PLUS 8 BYTES)    */ 02403000
*                    /* THE CONTROL OF UGPLLOC WILL CAUSE ANOTHER    */ 02404000
*                    /* UGPOOL REQUEST WITH THE INCREASED WORKAREA   */ 02405000
*                    /* AND THE REISSUANCE OF THE LOCATE REQUEST     */ 02406000
*                    /*                                              */ 02407000
*                    /************************************************/ 02408000
*                                                                  0742 02409000
*                    CYCLECNT = 2;                                 0742 02410000
         MVI   CYCLECNT,X'02'                                      0742 02411000
*                    LWKALEN = REQDLEN +8;                         0743 02412000
*                                                                  0743 02413000
         L     @06,CTGPLPTR                                        0743 02414000
         L     @06,CTGWKA(,@06)                                    0743 02415000
         LA    @15,8                                               0743 02416000
         AH    @15,REQDLEN(,@06)                                   0743 02417000
         ST    @15,LWKALEN                                         0743 02418000
*                    END;                                          0744 02419000
*                                                                  0744 02420000
*                  ELSE;                                           0745 02421000
*                                                                  0745 02422000
@RF00740 DS    0H                                                  0746 02423000
*              ELSE                                                0746 02424000
*                DO;                   /* CATALOG ERROR - RETURN     */ 02425000
*                                                                  0746 02426000
         B     @RC00739                                            0746 02427000
@RF00739 DS    0H                                                  0747 02428000
*                CYCLEFLG = STOP;                                  0747 02429000
         MVI   CYCLEFLG,X'0F'                                      0747 02430000
*                ALSTID = CATERROR;                                0748 02431000
         MVC   ALSTID(5),@CB01016                                  0748 02432000
*                RETURN;                                           0749 02433000
*                                                                  0749 02434000
         B     @EL00002                                            0749 02435000
*                END;                                              0750 02436000
*                                                                  0750 02437000
*        END UGPLLOC;                                              0751 02438000
@RC00739 DS    0H                                                  0751 02439000
@RC00737 DS    0H                                                  0751 02440000
@DE00719 CLI   CYCLEFLG,X'00'                                      0751 02441000
         BE    @DL00719                                            0751 02442000
*        /************************************************************/ 02443000
*        /*                                                          */ 02444000
*        /* INITIALIZE LOCTABLE WITH THE LENGTH AND ADDRESS OF NON-  */ 02445000
*        /* NULL FIELDS RETRIEVED VIA LOCATE                         */ 02446000
*        /* THE FIRST ENTRY PROCESSED IS THE ENTRY TYPE FIELD        */ 02447000
*        /*                                                          */ 02448000
*        /************************************************************/ 02449000
*                                                                  0752 02450000
*        CTGFLPTR = ADDR(ALFPLTYP);                                0752 02451000
*                                                                  0752 02452000
         L     @06,ALPRMPTR                                        0752 02453000
         LA    @06,ALFPLTYP(,@06)                                  0752 02454000
         ST    @06,CTGFLPTR                                        0752 02455000
*        IF CTGFLNG(1) ^= 0            /* IS OCCURRENCE PRESENT      */ 02456000
*          THEN                                                    0753 02457000
         L     @15,CTGFLNG(,@06)                                   0753 02458000
         LTR   @15,@15                                             0753 02459000
         BZ    @RF00753                                            0753 02460000
*            DO;                                                   0754 02461000
*                                                                  0754 02462000
*            IF CTGFLPT(1) -> LCETYPVL ^= 'FF'X  /*IS IT NON-NULL    */ 02463000
*              THEN                                                0755 02464000
         L     @06,CTGFLPT(,@06)                                   0755 02465000
         CLI   LCETYPVL(@06),X'FF'                                 0755 02466000
         BE    @RF00755                                            0755 02467000
*                DO;                                               0756 02468000
*                                                                  0756 02469000
*                LCETYPLN = CTGFLNG(1);                            0757 02470000
         ST    @15,LCETYPLN                                        0757 02471000
*                LCETYPPT = CTGFLPT(1);                            0758 02472000
*                                                                  0758 02473000
         ST    @06,LCETYPPT                                        0758 02474000
*                END;                                              0759 02475000
*                                                                  0759 02476000
*            END;                                                  0760 02477000
*                                                                  0760 02478000
@RF00755 DS    0H                                                  0761 02479000
*        /************************************************************/ 02480000
*        /*                                                          */ 02481000
*        /* A NONEXISTANT OR NULL ENTRY TYPE INDICATES A LOCATE ERROR*/ 02482000
*        /*                                                          */ 02483000
*        /************************************************************/ 02484000
*                                                                  0761 02485000
*        IF LCETYPPT = NULLPTR                                     0761 02486000
*          THEN                                                    0761 02487000
@RF00753 L     @06,LCETYPPT                                        0761 02488000
         LTR   @06,@06                                             0761 02489000
         BNZ   @RF00761                                            0761 02490000
*            DO;                                                   0762 02491000
*                                                                  0762 02492000
*            ALSTID = LOCRTNER;                                    0763 02493000
         MVC   ALSTID(5),@CB01025                                  0763 02494000
*            RETURN;                                               0764 02495000
*                                                                  0764 02496000
         B     @EL00002                                            0764 02497000
*            END;                                                  0765 02498000
*                                                                  0765 02499000
*        /************************************************************/ 02500000
*        /*                                                          */ 02501000
*        /* INITIALIZE LOCTABLE CATACB FIELD                         */ 02502000
*        /*                                                          */ 02503000
*        /************************************************************/ 02504000
*                                                                  0766 02505000
*        IF CATACBPT = NULLPTR                                     0766 02506000
*          THEN                                                    0766 02507000
@RF00761 SLR   @06,@06                                             0766 02508000
         C     @06,CATACBPT                                        0766 02509000
         BNE   @RF00766                                            0766 02510000
*            DO;                                                   0767 02511000
*                                                                  0767 02512000
*            CTGFLPTR = ADDR(ALFPLACB);                            0768 02513000
         L     @01,ALPRMPTR                                        0768 02514000
         LA    @15,ALFPLACB(,@01)                                  0768 02515000
         ST    @15,CTGFLPTR                                        0768 02516000
*            IF CTGFLNG(1) ^= NULLPTR  /* DOES OCCURRENCE EXIST      */ 02517000
*              THEN                                                0769 02518000
         C     @06,CTGFLNG(,@15)                                   0769 02519000
         BE    @RF00769                                            0769 02520000
*                DO;                                               0770 02521000
*                                                                  0770 02522000
*                /*   IS OCCURRENCE NON-NULL                         */ 02523000
*                IF CTGFLPT(1) -> LCACBVAL ^= NULLMASK(1 : 4)      0771 02524000
*                  THEN                                            0771 02525000
         L     @06,CTGFLPT(,@15)                                   0771 02526000
         CLC   LCACBVAL(4,@06),NULLMASK                            0771 02527000
         BE    @RF00771                                            0771 02528000
*                    CATACBPT = CTGFLPT(1);                        0772 02529000
         ST    @06,CATACBPT                                        0772 02530000
*                END;                                              0773 02531000
@RF00771 DS    0H                                                  0774 02532000
*            END;                                                  0774 02533000
*                                                                  0774 02534000
@RF00769 DS    0H                                                  0775 02535000
*        /************************************************************/ 02536000
*        /*                                                  @Y30SSJH*/ 02537000
*        /* INITIALIZE LOCTABLE NAMEDS FIELD                 @Y30SSJH*/ 02538000
*        /*                                                  @Y30SSJH*/ 02539000
*        /************************************************************/ 02540000
*                                                                  0775 02541000
*        CTGFLPTR = ADDR(ALFPLNAM);                        /*@Y30SSJH*/ 02542000
*                                                                  0775 02543000
@RF00766 L     @06,ALPRMPTR                                        0775 02544000
         LA    @06,ALFPLNAM(,@06)                                  0775 02545000
         ST    @06,CTGFLPTR                                        0775 02546000
*        IF CTGFLNG(1) ^= NULLPTR                                  0776 02547000
*          THEN                                                    0776 02548000
         L     @15,CTGFLNG(,@06)                                   0776 02549000
         LTR   @15,@15                                             0776 02550000
         BZ    @RF00776                                            0776 02551000
*            IF CTGFLPT(1) -> LCNAMEDS(1,1:4) ^= NULLMASK(1:4)     0777 02552000
*              THEN                                                0777 02553000
         L     @06,CTGFLPT(,@06)                                   0777 02554000
         CLC   LCNAMEDS(4,@06),NULLMASK                            0777 02555000
         BE    @RF00777                                            0777 02556000
*                DO;                                       /*@Y30SSJH*/ 02557000
*                                                                  0778 02558000
*                LCNAMLN = CTGFLNG(1);                     /*@Y30SSJH*/ 02559000
         ST    @15,LCNAMLN                                         0779 02560000
*                LCNAMPT = CTGFLPT(1);                     /*@Y30SSJH*/ 02561000
*                                                                  0780 02562000
         ST    @06,LCNAMPT                                         0780 02563000
*                END;                                      /*@Y30SSJH*/ 02564000
*                                                                  0781 02565000
*        /************************************************************/ 02566000
*        /*                                                  @Y30SSJH*/ 02567000
*        /* A NON-EXISTANT OR NULL NAMEDS INDICATES A        @Y30SSJH*/ 02568000
*        /* LOCATE ERROR                                     @Y30SSJH*/ 02569000
*        /*                                                  @Y30SSJH*/ 02570000
*        /************************************************************/ 02571000
*        IF LCETYPVL ^= 'A'   &                            /*@Y30SSJH*/ 02572000
*           LCETYPVL ^= 'B'                                /*@Y30SSJH*/ 02573000
*          THEN                                                    0782 02574000
@RF00777 DS    0H                                                  0782 02575000
@RF00776 L     @06,LCETYPPT                                        0782 02576000
         CLI   LCETYPVL(@06),C'A'                                  0782 02577000
         BE    @RF00782                                            0782 02578000
         CLI   LCETYPVL(@06),C'B'                                  0782 02579000
         BE    @RF00782                                            0782 02580000
*            IF LCNAMPT = NULLPTR                                  0783 02581000
*              THEN                                                0783 02582000
         L     @06,LCNAMPT                                         0783 02583000
         LTR   @06,@06                                             0783 02584000
         BNZ   @RF00783                                            0783 02585000
*                DO;                                       /*@Y30SSJH*/ 02586000
*                                                                  0784 02587000
*                ALSTID = LOCRTNER;                        /*@Y30SSJH*/ 02588000
         MVC   ALSTID(5),@CB01025                                  0785 02589000
*                RETURN;                                   /*@Y30SSJH*/ 02590000
*                                                                  0786 02591000
         B     @EL00002                                            0786 02592000
*                END;                                      /*@Y30SSJH*/ 02593000
*                                                                  0787 02594000
*        /************************************************************/ 02595000
*        /*                                                  @Y30SSJH*/ 02596000
*        /* INITIALIZE LOCTABLE HURBADS FIELD                @Y30SSJH*/ 02597000
*        /*                                                  @Y30SSJH*/ 02598000
*        /************************************************************/ 02599000
*                                                                  0788 02600000
*        CTGFLPTR = ADDR(ALFPLRBA);                        /*@Y30SSJH*/ 02601000
*                                                                  0788 02602000
@RF00783 DS    0H                                                  0788 02603000
@RF00782 L     @06,ALPRMPTR                                        0788 02604000
         LA    @06,ALFPLRBA(,@06)                                  0788 02605000
         ST    @06,CTGFLPTR                                        0788 02606000
*        IF CTGFLNG(1) ^= NULLPTR                                  0789 02607000
*          THEN                                                    0789 02608000
         L     @15,CTGFLNG(,@06)                                   0789 02609000
         LTR   @15,@15                                             0789 02610000
         BZ    @RF00789                                            0789 02611000
*            IF CTGFLPT(1) -> LCHURBA ^= NULLMASK(1:4)             0790 02612000
*              THEN                                                0790 02613000
         L     @06,CTGFLPT(,@06)                                   0790 02614000
         CLC   LCHURBA(4,@06),NULLMASK                             0790 02615000
         BE    @RF00790                                            0790 02616000
*                DO;                                       /*@Y30SSJH*/ 02617000
*                                                                  0791 02618000
*                LCRBALN = CTGFLNG(1);                     /*@Y30SSJH*/ 02619000
         ST    @15,LCRBALN                                         0792 02620000
*                LCRBAPT = CTGFLPT(1);                     /*@Y30SSJH*/ 02621000
*                                                                  0793 02622000
         ST    @06,LCRBAPT                                         0793 02623000
*                END;                                      /*@Y30SSJH*/ 02624000
*                                                                  0794 02625000
*        /************************************************************/ 02626000
*        /*                                                  @Y30SSJH*/ 02627000
*        /* INITIALIZE LOCTABLE CATALOG RECOVERY VOLUME      @Y30SSJH*/ 02628000
*        /*                                                  @Y30SSJH*/ 02629000
*        /************************************************************/ 02630000
*                                                                  0795 02631000
*        CTGFLPTR = ADDR(ALFPLCRA);                        /*@Y30SSJH*/ 02632000
*                                                                  0795 02633000
@RF00790 DS    0H                                                  0795 02634000
@RF00789 L     @06,ALPRMPTR                                        0795 02635000
         LA    @06,ALFPLCRA(,@06)                                  0795 02636000
         ST    @06,CTGFLPTR                                        0795 02637000
*        IF CTGFLNG(1) ^= NULLPTR                                  0796 02638000
*          THEN                                                    0796 02639000
         SLR   @15,@15                                             0796 02640000
         L     @14,CTGFLNG(,@06)                                   0796 02641000
         CR    @14,@15                                             0796 02642000
         BE    @RF00796                                            0796 02643000
*            IF CTGFLPT(1) -> LCCRAVOL ^= NULLCRA     &            0797 02644000
*               CTGFLPT(1) ^= NULLPTR                              0797 02645000
*              THEN                                                0797 02646000
         L     @06,CTGFLPT(,@06)                                   0797 02647000
         CLC   LCCRAVOL(6,@06),NULLCRA                             0797 02648000
         BE    @RF00797                                            0797 02649000
         CR    @06,@15                                             0797 02650000
         BE    @RF00797                                            0797 02651000
*                DO;                                       /*@Y30SSJH*/ 02652000
*                                                                  0798 02653000
*                LCCRALN = CTGFLNG(1);                     /*@Y30SSJH*/ 02654000
         ST    @14,LCCRALN                                         0799 02655000
*                LCCRAPT = CTGFLPT(1);                     /*@Y30SSJH*/ 02656000
*                                                                  0800 02657000
         ST    @06,LCCRAPT                                         0800 02658000
*                END;                                      /*@Y30SSJH*/ 02659000
*                                                                  0801 02660000
*        /************************************************************/ 02661000
*        /*                                                          */ 02662000
*        /* INITIALIZE LOCTABLE PASSWALL FIELD                       */ 02663000
*        /*                                                          */ 02664000
*        /************************************************************/ 02665000
*                                                                  0802 02666000
*        CTGFLPTR = ADDR(ALFPLPSW);                                0802 02667000
@RF00797 DS    0H                                                  0802 02668000
@RF00796 L     @06,ALPRMPTR                                        0802 02669000
         LA    @06,ALFPLPSW(,@06)                                  0802 02670000
         ST    @06,CTGFLPTR                                        0802 02671000
*        IF CTGFLNG(1) ^= 0                                        0803 02672000
*          THEN                                                    0803 02673000
         SLR   @15,@15                                             0803 02674000
         L     @14,CTGFLNG(,@06)                                   0803 02675000
         CR    @14,@15                                             0803 02676000
         BE    @RF00803                                            0803 02677000
*            DO;                                                   0804 02678000
*                                                                  0804 02679000
*            /********************************************************/ 02680000
*            /*                                                      */ 02681000
*            /* HAVE THE PASSWORDS BEEN SUPPRESSED - IF SO THERE IS  */ 02682000
*            /* NOT SUFFICIENT AUTHORIZATION TO ALTER - TERMINATE    */ 02683000
*            /*                                                      */ 02684000
*            /********************************************************/ 02685000
*                                                                  0805 02686000
*            IF CTGFLNG(1) = 1   &                                 0805 02687000
*               CTGFLPT(1) = 0                                     0805 02688000
*              THEN                                                0805 02689000
         C     @14,@CF00220                                        0805 02690000
         BNE   @RF00805                                            0805 02691000
         C     @15,CTGFLPT(,@06)                                   0805 02692000
         BNE   @RF00805                                            0805 02693000
*                DO;                                               0806 02694000
*                                                                  0806 02695000
*                ALSTID = PSWDSUPR;                                0807 02696000
         MVC   ALSTID(5),@CB01045                                  0807 02697000
*                RETURN;                                           0808 02698000
*                                                                  0808 02699000
         B     @EL00002                                            0808 02700000
*                END;                                              0809 02701000
*                                                                  0809 02702000
*            /********************************************************/ 02703000
*            /*                                                      */ 02704000
*            /* IS OCCURRENCE NON-NULL                               */ 02705000
*            /*                                                      */ 02706000
*            /********************************************************/ 02707000
*                                                                  0810 02708000
*            IF CTGFLPT(1) -> LCMSTRPW ^= NULLMASK                 0810 02709000
*              THEN                                                0810 02710000
@RF00805 L     @06,CTGFLPTR                                        0810 02711000
         L     @15,CTGFLPT(,@06)                                   0810 02712000
         CLC   LCMSTRPW(8,@15),NULLMASK                            0810 02713000
         BE    @RF00810                                            0810 02714000
*                DO;                                               0811 02715000
*                                                                  0811 02716000
*                LCPSWLN = CTGFLNG(1);                             0812 02717000
         L     @06,CTGFLNG(,@06)                                   0812 02718000
         ST    @06,LCPSWLN                                         0812 02719000
*                LCPSWPT = CTGFLPT(1);                             0813 02720000
*                                                                  0813 02721000
         ST    @15,LCPSWPT                                         0813 02722000
*                END;                                              0814 02723000
*                                                                  0814 02724000
*            END;                                                  0815 02725000
*                                                                  0815 02726000
@RF00810 DS    0H                                                  0816 02727000
*        /************************************************************/ 02728000
*        /*                                                  @Y30SSJH*/ 02729000
*        /* INITIALIZE LOCTABLE DATASET ATTRIBUTES FIELD     @Y30SSJH*/ 02730000
*        /*                                                  @Y30SSJH*/ 02731000
*        /************************************************************/ 02732000
*                                                                  0816 02733000
*        CTGFLPTR = ADDR(ALFPLDAT);                        /*@Y30SSJH*/ 02734000
*                                                                  0816 02735000
@RF00803 L     @06,ALPRMPTR                                        0816 02736000
         LA    @06,ALFPLDAT(,@06)                                  0816 02737000
         ST    @06,CTGFLPTR                                        0816 02738000
*        IF CTGFLNG(1) ^= 0                                        0817 02739000
*          THEN                                                    0817 02740000
         L     @06,CTGFLNG(,@06)                                   0817 02741000
         LTR   @06,@06                                             0817 02742000
         BZ    @RF00817                                            0817 02743000
*            IF LCETYPVL = 'D' |                                   0818 02744000
*               LCETYPVL = 'I'                                     0818 02745000
*              THEN                                                0818 02746000
         L     @06,LCETYPPT                                        0818 02747000
         CLI   LCETYPVL(@06),C'D'                                  0818 02748000
         BE    @RT00818                                            0818 02749000
         CLI   LCETYPVL(@06),C'I'                                  0818 02750000
         BNE   @RF00818                                            0818 02751000
@RT00818 DS    0H                                                  0819 02752000
*                DO;                                       /*@Y30SSJH*/ 02753000
*                                                                  0819 02754000
*                IF CTGFLPT(1) -> LCDSATR ^= 'FFFF'X               0820 02755000
*                  THEN                                            0820 02756000
         L     @06,CTGFLPTR                                        0820 02757000
         L     @15,CTGFLPT(,@06)                                   0820 02758000
         CLC   LCDSATR(2,@15),@CB01457                             0820 02759000
         BE    @RF00820                                            0820 02760000
*                    DO;                                   /*@Y30SSJH*/ 02761000
*                                                                  0821 02762000
*                    LCDATRLN = CTGFLNG(1);                /*@Y30SSJH*/ 02763000
         L     @06,CTGFLNG(,@06)                                   0822 02764000
         ST    @06,LCDATRLN                                        0822 02765000
*                    LCDATRPT = CTGFLPT(1);                /*@Y30SSJH*/ 02766000
*                                                                  0823 02767000
         ST    @15,LCDATRPT                                        0823 02768000
*                    END;                                  /*@Y30SSJH*/ 02769000
*                                                                  0824 02770000
*                END;                                      /*@Y30SSJH*/ 02771000
*                                                                  0825 02772000
@RF00820 DS    0H                                                  0826 02773000
*        /************************************************************/ 02774000
*        /*                                                  @Y30SSJH*/ 02775000
*        /* INITIALIZE LOCTABLE AMDSB FIELD                  @Y30SSJH*/ 02776000
*        /*                                                  @Y30SSJH*/ 02777000
*        /************************************************************/ 02778000
*                                                                  0826 02779000
*        CTGFLPTR = ADDR(ALFPLAMD);                        /*@Y30SSJH*/ 02780000
*                                                                  0826 02781000
@RF00818 DS    0H                                                  0826 02782000
@RF00817 L     @06,ALPRMPTR                                        0826 02783000
         LA    @06,ALFPLAMD(,@06)                                  0826 02784000
         ST    @06,CTGFLPTR                                        0826 02785000
*        IF CTGFLNG(1) ^= 0                                        0827 02786000
*          THEN                                                    0827 02787000
         L     @15,CTGFLNG(,@06)                                   0827 02788000
         LTR   @15,@15                                             0827 02789000
         BZ    @RF00827                                            0827 02790000
*            DO;                                           /*@Y30SSJH*/ 02791000
*                                                                  0828 02792000
*            IF CTGFLPT(1) -> IDAAMDSB ^= NULLMASK         /*@Y30SSJH*/ 02793000
*              THEN                                                0829 02794000
         L     @06,CTGFLPT(,@06)                                   0829 02795000
         CLC   IDAAMDSB(8,@06),NULLMASK                            0829 02796000
         BE    @RF00829                                            0829 02797000
*                DO;                                       /*@Y30SSJH*/ 02798000
*                                                                  0830 02799000
*                LCAMDLN = CTGFLNG(1);                     /*@Y30SSJH*/ 02800000
         ST    @15,LCAMDLN                                         0831 02801000
*                LCAMDPT = CTGFLPT(1);                     /*@Y30SSJH*/ 02802000
*                                                                  0832 02803000
         ST    @06,LCAMDPT                                         0832 02804000
*                END;                                      /*@Y30SSJH*/ 02805000
*                                                                  0833 02806000
*            END;                                          /*@Y30SSJH*/ 02807000
*                                                                  0834 02808000
@RF00829 DS    0H                                                  0835 02809000
*        /************************************************************/ 02810000
*        /*                                                  @Y30SSJH*/ 02811000
*        /* INITIALIZE LOCATABLE RGATTR FIELD                @Y30SSJH*/ 02812000
*        /*                                                  @Y30SSJH*/ 02813000
*        /************************************************************/ 02814000
*                                                                  0835 02815000
*        CTGFLPTR = ADDR(ALFPLRGA);                        /*@Y30SSJH*/ 02816000
*                                                                  0835 02817000
@RF00827 L     @06,ALPRMPTR                                        0835 02818000
         LA    @06,ALFPLRGA(,@06)                                  0835 02819000
         ST    @06,CTGFLPTR                                        0835 02820000
*        IF CTGFLNG(1) ^= NULLPTR                                  0836 02821000
*          THEN                                                    0836 02822000
         L     @15,CTGFLNG(,@06)                                   0836 02823000
         LTR   @15,@15                                             0836 02824000
         BZ    @RF00836                                            0836 02825000
*            IF LCETYPVL = 'G'                                     0837 02826000
*              THEN                                                0837 02827000
         L     @01,LCETYPPT                                        0837 02828000
         CLI   LCETYPVL(@01),C'G'                                  0837 02829000
         BNE   @RF00837                                            0837 02830000
*                IF CTGFLPT(1) -> LCRGATTR ^= NULLMASK(1)          0838 02831000
*                  THEN                                            0838 02832000
         L     @06,CTGFLPT(,@06)                                   0838 02833000
         CLC   LCRGATTR(1,@06),NULLMASK                            0838 02834000
         BE    @RF00838                                            0838 02835000
*                    DO;                                   /*@Y30SSJH*/ 02836000
*                                                                  0839 02837000
*                    LCRATRLN = CTGFLNG(1);                /*@Y30SSJH*/ 02838000
         ST    @15,LCRATRLN                                        0840 02839000
*                    LCRATRPT = CTGFLPT(1);                /*@Y30SSJH*/ 02840000
*                                                                  0841 02841000
         ST    @06,LCRATRPT                                        0841 02842000
*                    END;                                  /*@Y30SSJH*/ 02843000
*                                                                  0842 02844000
*        /************************************************************/ 02845000
*        /*                                                  @Y30SSJH*/ 02846000
*        /* INITIALIZE LOCTABLE GDG ATTRIBUTES FIELD         @Y30SSJH*/ 02847000
*        /*                                                  @Y30SSJH*/ 02848000
*        /************************************************************/ 02849000
*                                                                  0843 02850000
*        CTGFLPTR = ADDR(ALFPLGDG);                        /*@Y30SSJH*/ 02851000
*                                                                  0843 02852000
@RF00838 DS    0H                                                  0843 02853000
@RF00837 DS    0H                                                  0843 02854000
@RF00836 L     @06,ALPRMPTR                                        0843 02855000
         LA    @06,ALFPLGDG(,@06)                                  0843 02856000
         ST    @06,CTGFLPTR                                        0843 02857000
*        IF CTGFLNG(1) ^= 0                                        0844 02858000
*          THEN                                                    0844 02859000
         L     @15,CTGFLNG(,@06)                                   0844 02860000
         LTR   @15,@15                                             0844 02861000
         BZ    @RF00844                                            0844 02862000
*            DO;                                           /*@Y30SSJH*/ 02863000
*                                                                  0845 02864000
*            IF CTGFLPT(1) -> LCGDGATR ^= 'FF'X                    0846 02865000
*              THEN                                                0846 02866000
         L     @06,CTGFLPT(,@06)                                   0846 02867000
         CLI   LCGDGATR(@06),X'FF'                                 0846 02868000
         BE    @RF00846                                            0846 02869000
*                DO;                                       /*@Y30SSJH*/ 02870000
*                                                                  0847 02871000
*                LCGATRLN = CTGFLNG(1);                    /*@YL026UA*/ 02872000
         ST    @15,LCGATRLN                                        0848 02873000
*                LCGATRPT = CTGFLPT(1);                    /*@YL026UA*/ 02874000
*                                                                  0849 02875000
         ST    @06,LCGATRPT                                        0849 02876000
*                END;                                      /*@YL026UA*/ 02877000
*                                                                  0850 02878000
*            END;                                          /*@YL026UA*/ 02879000
*                                                                  0851 02880000
*        /************************************************************/ 02881000
*        /*                                                          */ 02882000
*        /* LOCATPRC PROCESSING IS COMPLETE RETURN TO INVOKER        */ 02883000
*        /*                                                          */ 02884000
*        /************************************************************/ 02885000
*                                                                  0852 02886000
*        RETURN;                                                   0852 02887000
*                                                                  0852 02888000
         B     @EL00002                                            0852 02889000
*END LOCATPRC;                                                     0853 02890000
         B     @EL00002                                            0853 02891000
*/********************************************************************/ 02892000
*/*                                                                  */ 02893000
*/* PROCEDURE NAME - ALTERPRC (STAGE 4 PROCESSOR)            @Y30SSJH*/ 02894000
*/*                                                                  */ 02895000
*/* FUNCTION - ALTERPRC BUILDS THE VSAM CATALOG MANAGEMENT INTERFACE */ 02896000
*/*            FOR THE ALTER REQUEST. THE INTERFACE CONSISTS OF THE  */ 02897000
*/*            CPL-FVT-FPL COMPLEX.                                  */ 02898000
*/*                                                                  */ 02899000
*/*            LOCTABLE PROVIDES REFERENCE TO THOSE FIELDS WHICH     */ 02900000
*/*            MUST BE ALTERED IN THEIR ORIGINAL CONTEXT             */ 02901000
*/*                                                                  */ 02902000
*/*            THE CPL CONTAINS INFORMATION WHICH INDICATES TO       */ 02903000
*/*            VSAM CATALOG MANAGEMENT THE TYPE OF REQUEST, THE      */ 02904000
*/*            CATALOG AND PASSWORD INFORMATION AND IF SPECIFIED THE */ 02905000
*/*            NEW NAME OF THE CATALOG OBJECT                        */ 02906000
*/*                                                                  */ 02907000
*/*            THE FVT ORGANIZES THE REFERENCE TO THE FIELDS TO BE   */ 02908000
*/*            ALTERED, AND GIVES THE ADDRESS OF THE OBJECTS NAME    */ 02909000
*/*                                                                  */ 02910000
*/*            THE FPLS AND 'PSEUDO FIELDS' CONTAIN THE DATA         */ 02911000
*/*            NECESSARY TO ALTER THE FIELDS                         */ 02912000
*/*                                                                  */ 02913000
*/* INPUT -                                                          */ 02914000
*/*            ACATACB - CATALOG ACB ADDRESS                         */ 02915000
*/*                                                                  */ 02916000
*/* OUTPUT -                                                         */ 02917000
*/*            ALCTGPRM - THE CPL-FVT-FPL COMPLEX IS BUILT IN THIS   */ 02918000
*/*              AREA, WHICH IS INITIALIZED IN IDCAL01               */ 02919000
*/*            ALSTID   - THE GLOBAL INTERNAL STATUS COMMUNICATOR    */ 02920000
*/*              IS SET ON ERROR DETECTION:                          */ 02921000
*/*                ALSTID = NOSTORAG                                 */ 02922000
*/*                                                                  */ 02923000
*/********************************************************************/ 02924000
*                                                                  0854 02925000
*ALTERPRC:                                                         0854 02926000
*        PROCEDURE(ACATACB);                                       0854 02927000
ALTERPRC STM   @14,@12,@SA00003                                    0854 02928000
         MVC   @PC00003(4),0(@01)                                  0854 02929000
*        /************************************************************/ 02930000
*        /*                                                          */ 02931000
*        /* ARGUMENTS OF INVOCATION                                  */ 02932000
*        /*                                                          */ 02933000
*        /************************************************************/ 02934000
*        DCL                                                       0855 02935000
*          ACATACB;                    /* CATALOG ACB ADDRESS        */ 02936000
*                                                                  0855 02937000
*        /************************************************************/ 02938000
*        /*                                                          */ 02939000
*        /* VOLUME LIST FOR ADDING AND REMOVING VOLUMES              */ 02940000
*        /*                                                          */ 02941000
*        /************************************************************/ 02942000
*        DCL                                                       0856 02943000
*          1 ALVLIST BDY(WORD) BASED(CTGFVVLT),                    0856 02944000
*            2 ALVLSTLN  FIXED(15),    /*LENGTH OF VOLUME LIST       */ 02945000
*            2 *  (*)       CHAR(8),                               0856 02946000
*              3 ALVLSTCD  CHAR(1),    /* ADD/REMOVE VOL FLAG        */ 02947000
*              3 *         CHAR(1),                                0856 02948000
*              3 ALVOLUME  CHAR(6);    /* VOLUME SERIAL NUMBER       */ 02949000
*                                                                  0856 02950000
*        /************************************************************/ 02951000
*        /*                                                          */ 02952000
*        /* COUNT FIELD USED IN LOOP CONTROL FOR ADDING AND REMOVING */ 02953000
*        /* VOLUMES FROM THE VOLSER LIST                             */ 02954000
*        /*                                                          */ 02955000
*        /************************************************************/ 02956000
*        DCL                                                       0857 02957000
*          ADDCOUNT FIXED(15);                                     0857 02958000
*                                                                  0857 02959000
*        /************************************************************/ 02960000
*        /*                                                          */ 02961000
*        /* ARRAY FOR NULLIFYING PASSWORD VALUES                     */ 02962000
*        /*                                                          */ 02963000
*        /************************************************************/ 02964000
*                                                                  0858 02965000
*        DCL                                                       0858 02966000
*          NULLPSWD(4) CHAR(8) BASED(LCPSWPT);                     0858 02967000
*                                                                  0858 02968000
*        /************************************************************/ 02969000
*        /*                                                          */ 02970000
*        /* COMPUTATION AREA FOR LENGTH OF VOLUME LIST FOR ADD/REMOVE*/ 02971000
*        /* VOLUMES REQUEST.                                         */ 02972000
*        /*                                                          */ 02973000
*        /************************************************************/ 02974000
*                                                                  0859 02975000
*        DCL                                                       0859 02976000
*          ALVOLLEN FIXED(31);                                     0859 02977000
*                                                                  0859 02978000
*        /************************************************************/ 02979000
*        /*                                                          */ 02980000
*        /* DYNAMIC POINTER TO PASSWORDS, USED IN PASSWORD MIGRATION */ 02981000
*        /*                                                          */ 02982000
*        /************************************************************/ 02983000
*        DCL                                                       0860 02984000
*          NEWPSWPT PTR(31);                                       0860 02985000
*                                                                  0860 02986000
*        DCL                                                       0861 02987000
*          PCT100 FIXED(31) CONSTANT(100);                 /*@OZ05907*/ 02988000
*                                                                  0861 02989000
*        /************************************************************/ 02990000
*        /*                                                          */ 02991000
*        /* THIS SECTION DEFINES THOSE VALUES USED IN THE COMPUTATION*/ 02992000
*        /* REQUIRED TO ALTER THE EXPIRATION DATE                    */ 02993000
*        /* THE FINAL VALUE REFERENCED BY THE FPL RESIDES IN THE     */ 02994000
*        /* FIRST STRUCTURE                                          */ 02995000
*        /*                                                          */ 02996000
*        /************************************************************/ 02997000
*                                                                  0862 02998000
*        DCL                                                       0862 02999000
*          1 EXPIREDT  CHAR(8) BDY(DWORD),                         0862 03000000
*            2 *       CHAR(5),                                    0862 03001000
*            2 EXPIRE  CHAR(3),                                    0862 03002000
*              3 EXPIRYR FIXED(8) BDY(BYTE),                       0862 03003000
*              3 EXPIRDAY FIXED(15) BDY(BYTE);                     0862 03004000
*                                                                  0862 03005000
*        /************************************************************/ 03006000
*        /*                                                          */ 03007000
*        /* LOOP CONTROL FLAG FOR YEAR/DAY CALCULATION               */ 03008000
*        /*                                                          */ 03009000
*        /************************************************************/ 03010000
*                                                                  0863 03011000
*        DCL                                                       0863 03012000
*          DATELOOP CHAR(1);                                       0863 03013000
*                                                                  0863 03014000
*        /************************************************************/ 03015000
*        /*                                                          */ 03016000
*        /* AREA FOR RETURN OF UTIME DATE AND TIME                   */ 03017000
*        /*                                                          */ 03018000
*        /************************************************************/ 03019000
*                                                                  0864 03020000
*        DCL                                                       0864 03021000
*          1 XCURDATE CHAR(8) BDY(DWORD),                          0864 03022000
*            2 *       CHAR(1),                                    0864 03023000
*            2 XUTYEAR FIXED(8),                                   0864 03024000
*            2 XUTDAY  FIXED(15);                                  0864 03025000
*                                                                  0864 03026000
*        DCL                                                       0865 03027000
*          TIMEODAY CHAR(8) BDY(DWORD);                            0865 03028000
*                                                                  0865 03029000
*        /************************************************************/ 03030000
*        /*                                                          */ 03031000
*        /* DAY AND YEAR COMPUTATION WORKAREAS                       */ 03032000
*        /*                                                          */ 03033000
*        /************************************************************/ 03034000
*                                                                  0866 03035000
*        DCL                                                       0866 03036000
*          1 DAYTOTL  CHAR(8) BDY(DWORD),                          0866 03037000
*            2 *      CHAR(6),                                     0866 03038000
*            2 DAYTOTAL FIXED(15);                                 0866 03039000
*                                                                  0866 03040000
*        DCL                                                       0867 03041000
*          NOWYEAR FIXED(15),                                      0867 03042000
*          DAYPERYR FIXED(15);                                     0867 03043000
*                                                                  0867 03044000
*        /************************************************************/ 03045000
*        /*                                                          */ 03046000
*        /* VARIABLES USED TO MIGRATE PASSWORDS WHEN THE MASTER      */ 03047000
*        /* PASSWORD HAS BEEN NULLIFIED AND THERE IS STILL VALID     */ 03048000
*        /* PASSWORDS                                                */ 03049000
*        /*                                                          */ 03050000
*        /************************************************************/ 03051000
*                                                                  0868 03052000
*        DCL                                                       0868 03053000
*          MIGRLOOP  FIXED(15),                                    0868 03054000
*          MIGRFLAG  CHAR(1);                                      0868 03055000
*        /************************************************************/ 03056000
*        /*                                                          */ 03057000
*        /* ENTRY POINT TO ALTERPRC                                  */ 03058000
*        /*                                                          */ 03059000
*        /************************************************************/ 03060000
*                                                                  0869 03061000
*        OLDERID2 = NEWERID2;                                      0869 03062000
         L     @06,@PC00001                                        0869 03063000
         L     @06,GDTTR2(,@06)                                    0869 03064000
         MVC   @TS00001(95),NEWERID2(@06)                          0869 03065000
         MVC   OLDERID2(95,@06),@TS00001                           0869 03066000
*        NEWID2 = 'AL41';                                          0870 03067000
*                                                                  0870 03068000
         MVC   NEWID2(4,@06),@CC01492                              0870 03069000
*        /************************************************************/ 03070000
*        /*                                                          */ 03071000
*        /* INITIALIZE CPL FOR ALTER REQUEST                         */ 03072000
*        /*                                                          */ 03073000
*        /************************************************************/ 03074000
*                                                                  0871 03075000
*        CTGPLPTR = ADDR(ALCTGPL);      /* SET POINTER TO THE CPL    */ 03076000
         L     @06,ALPRMPTR                                        0871 03077000
         LA    @15,ALCTGPL(,@06)                                   0871 03078000
         ST    @15,CTGPLPTR                                        0871 03079000
*        ALCTGPL = ''B;                 /* SET CPL TO BINARY ZEROES  */ 03080000
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        0872 03081000
*        ALCTGFLD = ''B;                                   /*@Y30SSJH*/ 03082000
         XC    ALCTGFLD(40,@06),ALCTGFLD(@06)                      0873 03083000
*        ALCPLID = 'CPL';               /* CPL DUMP ID               */ 03084000
         MVI   ALCPLID+3(@06),C' '                                 0874 03085000
         MVC   ALCPLID+4(4,@06),ALCPLID+3(@06)                     0874 03086000
         MVC   ALCPLID(3,@06),@CC01442                             0874 03087000
*        CTGFUNC = CTGCMS;              /* INDICATE CMS FUNCTION     */ 03088000
         NI    CTGFUNC(@15),B'10011111'                            0875 03089000
         OI    CTGFUNC(@15),B'10000000'                            0875 03090000
*        CTGNAME = ON;                  /* ACCESS CATALOG BY NAME    */ 03091000
         OI    CTGNAME(@15),B'00000100'                            0876 03092000
*        CTGFVT = ADDR(ALCTGFVT);       /* SET FVT ADDR IN CPL       */ 03093000
         LA    @14,ALCTGFVT(,@06)                                  0877 03094000
         ST    @14,CTGFVT(,@15)                                    0877 03095000
*        CTGAM0 = ON;                   /* INDICATE VSAM REQUEST     */ 03096000
         OI    CTGAM0(@15),B'00000001'                             0878 03097000
*        CTGWKA = ADDR(ALWKAREA);       /* REFERENCE ALTER WORKAREA  */ 03098000
         LA    @14,ALWKAREA(,@06)                                  0879 03099000
         ST    @14,CTGWKA(,@15)                                    0879 03100000
*        CTGOPTNS = CTGALTER;           /* INDICATE ALTER REQUEST    */ 03101000
         NI    CTGOPTNS(@15),B'00010111'                           0880 03102000
         OI    CTGOPTNS(@15),B'00010000'                           0880 03103000
*        ALWKAREA = ''B;                                   /*@Y30SSJH*/ 03104000
*                                                                  0881 03105000
         XC    ALWKAREA(4,@06),ALWKAREA(@06)                       0881 03106000
*        /************************************************************/ 03107000
*        /*                                                          */ 03108000
*        /* INITIALIZE ORIGINAL ENTRY NAME IN FVT                    */ 03109000
*        /*                                                          */ 03110000
*        /************************************************************/ 03111000
*                                                                  0882 03112000
*        IF ((ADDR(KEY)) ^= NULLPTR   |                            0882 03113000
*            (ADDR(RECSZ)) ^= NULLPTR)                             0882 03114000
*          THEN                                                    0882 03115000
         SLR   @06,@06                                             0882 03116000
         L     @15,@PC00001+4                                      0882 03117000
         C     @06,FDTPTR+220(,@15)                                0882 03118000
         BNE   @RT00882                                            0882 03119000
         C     @06,FDTPTR+232(,@15)                                0882 03120000
         BE    @RF00882                                            0882 03121000
@RT00882 DS    0H                                                  0883 03122000
*            DO;                                           /*@Y30SSJH*/ 03123000
*                                                                  0883 03124000
*            CTGFVENT = ADDR(DATACI);                      /*@Y30SSJH*/ 03125000
         L     @06,CTGPLPTR                                        0884 03126000
         L     @01,CTGFVT(,@06)                                    0884 03127000
         LA    @00,DATACI                                          0884 03128000
         ST    @00,CTGFVENT(,@01)                                  0884 03129000
*            CTGNAME = OFF;                                /*@Y30SSJH*/ 03130000
*                                                                  0885 03131000
         NI    CTGNAME(@06),B'11111011'                            0885 03132000
*            END;                                          /*@Y30SSJH*/ 03133000
*          ELSE                                                    0887 03134000
*            CTGFVENT = ADDR(ENTVAL(ENT));                 /*@Y30SSJH*/ 03135000
*                                                                  0887 03136000
         B     @RC00882                                            0887 03137000
@RF00882 L     @06,CTGPLPTR                                        0887 03138000
         L     @06,CTGFVT(,@06)                                    0887 03139000
         L     @15,ENT                                             0887 03140000
         MH    @15,@CH00687                                        0887 03141000
         L     @01,GENWKPTR                                        0887 03142000
         AL    @01,@CF01685                                        0887 03143000
         LA    @15,ENTVAL-5(@15,@01)                               0887 03144000
         ST    @15,CTGFVENT(,@06)                                  0887 03145000
*        /************************************************************/ 03146000
*        /*                                                          */ 03147000
*        /* INITIALIZE CATALOG NAME OR ACB ADDRESS IN CATALOG        */ 03148000
*        /*                                                          */ 03149000
*        /************************************************************/ 03150000
*                                                                  0888 03151000
*        IF ACATACB ^= NULLPTR                                     0888 03152000
*          THEN                                                    0888 03153000
@RC00882 L     @06,@PC00003                                        0888 03154000
         L     @06,ACATACB(,@06)                                   0888 03155000
         LTR   @06,@06                                             0888 03156000
         BZ    @RF00888                                            0888 03157000
*            DO;                                                   0889 03158000
*                                                                  0889 03159000
*            CTGCNAME = OFF;                                       0890 03160000
         L     @15,CTGPLPTR                                        0890 03161000
         NI    CTGCNAME(@15),B'11111101'                           0890 03162000
*            CTGCAT = ACATACB;                                     0891 03163000
*                                                                  0891 03164000
         ST    @06,CTGCAT(,@15)                                    0891 03165000
*            END;                                                  0892 03166000
*                                                                  0892 03167000
*          ELSE                                                    0893 03168000
*            DO;                                                   0893 03169000
*                                                                  0893 03170000
         B     @RC00888                                            0893 03171000
@RF00888 DS    0H                                                  0894 03172000
*            CTGCNAME = ON;                                        0894 03173000
         L     @06,CTGPLPTR                                        0894 03174000
         OI    CTGCNAME(@06),B'00000010'                           0894 03175000
*            IF (ADDR(CATLG)) ^= NULLPTR                           0895 03176000
*              THEN                                                0895 03177000
         L     @15,@PC00001+4                                      0895 03178000
         L     @15,FDTPTR+8(,@15)                                  0895 03179000
         LTR   @15,@15                                             0895 03180000
         BZ    @RF00895                                            0895 03181000
*                CTGCAT = ADDR(CATLGVAL);                  /*@YL026UA*/ 03182000
         LA    @15,CATLGVAL(,@15)                                  0896 03183000
         ST    @15,CTGCAT(,@06)                                    0896 03184000
*              ELSE                                                0897 03185000
*                IF NTRYPOS ^= 0                                   0897 03186000
*                  THEN                                            0897 03187000
         B     @RC00895                                            0897 03188000
@RF00895 L     @06,@PC00001+4                                      0897 03189000
         L     @06,FDTPTR(,@06)                                    0897 03190000
         CLI   NTRYPOS(@06),0                                      0897 03191000
         BE    @RF00897                                            0897 03192000
*                    CTGCAT = ADDR(CATNAME);               /*@YL026UA*/ 03193000
*                                                                  0898 03194000
         LA    @06,CATNAME                                         0898 03195000
         L     @01,CTGPLPTR                                        0898 03196000
         ST    @06,CTGCAT(,@01)                                    0898 03197000
*            END;                                                  0899 03198000
@RF00897 DS    0H                                                  0899 03199000
@RC00895 DS    0H                                                  0900 03200000
*        /************************************************************/ 03201000
*        /*                                                          */ 03202000
*        /* INITIALIZE PASSWORD AUTHORIZATION IN CPL - THE CATALOG   */ 03203000
*        /* PASSWORD HAS PRIORITY OVER THE ENTRY PASSWORD            */ 03204000
*        /*                                                          */ 03205000
*        /************************************************************/ 03206000
*                                                                  0900 03207000
*        IF (ADDR(CATLG)) ^= NULLPTR                               0900 03208000
*          THEN                                                    0900 03209000
@RC00888 L     @06,@PC00001+4                                      0900 03210000
         L     @06,FDTPTR+8(,@06)                                  0900 03211000
         LTR   @06,@06                                             0900 03212000
         BZ    @RF00900                                            0900 03213000
*            IF CATLGPLN ^= 0          /* CATALOG PASSWORD           */ 03214000
*              THEN                                                0901 03215000
         CLI   CATLGPLN(@06),0                                     0901 03216000
         BE    @RF00901                                            0901 03217000
*                CTGPSWD = ADDR(CATLGPAS);                         0902 03218000
*                                                                  0902 03219000
         LA    @06,CATLGPAS(,@06)                                  0902 03220000
         L     @01,CTGPLPTR                                        0902 03221000
         ST    @06,CTGPSWD(,@01)                                   0902 03222000
*        IF CTGPSWD = NULLPTR                                      0903 03223000
*          THEN                                                    0903 03224000
@RF00901 DS    0H                                                  0903 03225000
@RF00900 L     @06,CTGPLPTR                                        0903 03226000
         L     @15,CTGPSWD(,@06)                                   0903 03227000
         LTR   @15,@15                                             0903 03228000
         BNZ   @RF00903                                            0903 03229000
*            IF NTRYPLN ^= 0           /* ENTRY PASSWORD     @YL026UA*/ 03230000
*              THEN                                                0904 03231000
         L     @15,@PC00001+4                                      0904 03232000
         L     @15,FDTPTR(,@15)                                    0904 03233000
         CLI   NTRYPLN(@15),0                                      0904 03234000
         BE    @RF00904                                            0904 03235000
*                CTGPSWD = ADDR(NTRYPAS);                  /*@YL026UA*/ 03236000
*                                                                  0905 03237000
         LA    @15,NTRYPAS(,@15)                                   0905 03238000
         ST    @15,CTGPSWD(,@06)                                   0905 03239000
*        /************************************************************/ 03240000
*        /*                                                  @Y30SSJH*/ 03241000
*        /* IF THE KEYS AND/OR RECORDSIZE PARAMETER HAS BEEN @Y30SSJH*/ 03242000
*        /* SPECIFIED AND A LOCATE HAS BEEN PERFORMED AT A   @Y30SSJH*/ 03243000
*        /* LEVEL HIGHER THAN DATA, SET BYPASS VERIFICATION  @Y30SSJH*/ 03244000
*        /* - EFFECTIVE IN DOS ONLY                          @Y30SSJH*/ 03245000
*        /*                                                  @Y30SSJH*/ 03246000
*        /************************************************************/ 03247000
*                                                                  0906 03248000
*        IF ((ADDR(KEY))   ^= NULLPTR |                            0906 03249000
*            (ADDR(RECSZ)) ^= NULLPTR )                            0906 03250000
*          THEN                                                    0906 03251000
@RF00904 DS    0H                                                  0906 03252000
@RF00903 SLR   @06,@06                                             0906 03253000
         L     @15,@PC00001+4                                      0906 03254000
         C     @06,FDTPTR+220(,@15)                                0906 03255000
         BNE   @RT00906                                            0906 03256000
         C     @06,FDTPTR+232(,@15)                                0906 03257000
         BE    @RF00906                                            0906 03258000
@RT00906 DS    0H                                                  0907 03259000
*            IF BYPASSSW = STOP                                    0907 03260000
*              THEN                                                0907 03261000
         CLI   BYPASSSW,X'0F'                                      0907 03262000
         BNE   @RF00907                                            0907 03263000
*                CTGBYPSS = ON;                            /*@Y30SSJH*/ 03264000
         L     @06,CTGPLPTR                                        0908 03265000
         OI    CTGBYPSS(@06),B'10000000'                           0908 03266000
*        /************************************************************/ 03267000
*        /*                                                          */ 03268000
*        /* BEGIN CONSTRUCTION OF ALTERATIONS                        */ 03269000
*        /*                                                          */ 03270000
*        /************************************************************/ 03271000
*                                                                  0909 03272000
*        /************************************************************/ 03273000
*        /*                                                          */ 03274000
*        /* INITIALIZE THE NEW ENTRY NAME OF THE OBJECT              */ 03275000
*        /*                                                          */ 03276000
*        /************************************************************/ 03277000
*                                                                  0909 03278000
*            IF ADDR(NEWNM) ^= NULLPTR                     /*@YL026UA*/ 03279000
*              THEN                                                0909 03280000
@RF00907 DS    0H                                                  0909 03281000
@RF00906 L     @06,@PC00001+4                                      0909 03282000
         L     @06,FDTPTR+16(,@06)                                 0909 03283000
         LTR   @06,@06                                             0909 03284000
         BZ    @RF00909                                            0909 03285000
*                CTGNEWNM = ADDR(NEWNAME);                 /*@YL026UA*/ 03286000
*                                                                  0910 03287000
         LA    @06,NEWNAME                                         0910 03288000
         L     @01,CTGPLPTR                                        0910 03289000
         ST    @06,CTGNEWNM(,@01)                                  0910 03290000
*        /************************************************************/ 03291000
*        /*                                                          */ 03292000
*        /* INITIALIZE FPLS WHICH COMMUNICATE ALTERATIONS            */ 03293000
*        /*                                                          */ 03294000
*        /************************************************************/ 03295000
*                                                                  0911 03296000
*        ALFPLLST(1:256) = ''B;                            /*@Y30SSJH*/ 03297000
@RF00909 L     @06,ALPRMPTR                                        0911 03298000
         XC    ALFPLLST(256,@06),ALFPLLST(@06)                     0911 03299000
*        ALFPLLST(257:LENGTH(ALFPLLST)) = ''B;             /*@Y30SSJH*/ 03300000
         XC    ALFPLLST+256(192,@06),ALFPLLST+256(@06)             0912 03301000
*        CTGFVPTR = ADDR(ALCTGFVT);                                0913 03302000
         LA    @15,ALCTGFVT(,@06)                                  0913 03303000
         ST    @15,CTGFVPTR                                        0913 03304000
*        ALFVTID = 'FVT';                                          0914 03305000
*                                                                  0914 03306000
         MVI   ALFVTID+3(@06),C' '                                 0914 03307000
         MVC   ALFVTID(3,@06),@CC01493                             0914 03308000
*        /************************************************************/ 03309000
*        /*                                                  @Y30SSJH*/ 03310000
*        /* ENTYPE IS SET IN FVT IF A LOCATE HAS BEEN        @Y30SSJH*/ 03311000
*        /* PERFORMED OR IF UPGRADE/UPDATE ATTRIBUTES HAVE   @Y30SSJH*/ 03312000
*        /* BEEN SPECIFIED                                   @Y30SSJH*/ 03313000
*        /*                                                  @Y30SSJH*/ 03314000
*        /************************************************************/ 03315000
*                                                                  0915 03316000
*        IF LCETYPPT ^= NULLPTR                                    0915 03317000
*          THEN                                                    0915 03318000
         L     @06,LCETYPPT                                        0915 03319000
         LTR   @06,@06                                             0915 03320000
         BZ    @RF00915                                            0915 03321000
*            CTGFVTYP = LCETYPVL;                          /*@Y30SSJH*/ 03322000
*                                                                  0916 03323000
         L     @01,CTGPLPTR                                        0916 03324000
         L     @01,CTGFVT(,@01)                                    0916 03325000
         MVC   CTGFVTYP(1,@01),LCETYPVL(@06)                       0916 03326000
*          ELSE                                                    0917 03327000
*            IF ((ADDR(UPG)) ^= NULLPTR |                          0917 03328000
*               (ADDR(NUPG)) ^= NULLPTR )                          0917 03329000
*              THEN                                                0917 03330000
         B     @RC00915                                            0917 03331000
@RF00915 SLR   @06,@06                                             0917 03332000
         L     @15,@PC00001+4                                      0917 03333000
         C     @06,FDTPTR+252(,@15)                                0917 03334000
         BNE   @RT00917                                            0917 03335000
         C     @06,FDTPTR+256(,@15)                                0917 03336000
         BE    @RF00917                                            0917 03337000
@RT00917 DS    0H                                                  0918 03338000
*                CTGFVTYP = 'G';                           /*@Y30SSJH*/ 03339000
*                                                                  0918 03340000
         L     @06,CTGPLPTR                                        0918 03341000
         L     @06,CTGFVT(,@06)                                    0918 03342000
         MVI   CTGFVTYP(@06),C'G'                                  0918 03343000
*              ELSE                                                0919 03344000
*                IF ((ADDR(UPD)) ^= NULLPTR |                      0919 03345000
*                   (ADDR(NUPD)) ^= NULLPTR )                      0919 03346000
*                  THEN                                            0919 03347000
         B     @RC00917                                            0919 03348000
@RF00917 SLR   @06,@06                                             0919 03349000
         L     @15,@PC00001+4                                      0919 03350000
         C     @06,FDTPTR+260(,@15)                                0919 03351000
         BNE   @RT00919                                            0919 03352000
         C     @06,FDTPTR+264(,@15)                                0919 03353000
         BE    @RF00919                                            0919 03354000
@RT00919 DS    0H                                                  0920 03355000
*                    CTGFVTYP = 'R';                       /*@Y30SSJH*/ 03356000
*                                                                  0920 03357000
         L     @06,CTGPLPTR                                        0920 03358000
         L     @06,CTGFVT(,@06)                                    0920 03359000
         MVI   CTGFVTYP(@06),C'R'                                  0920 03360000
*        /************************************************************/ 03361000
*        /*                                                          */ 03362000
*        /* INITIALIZE STATIC PORTIONS OF ALTER FPLS                 */ 03363000
*        /*                                                          */ 03364000
*        /************************************************************/ 03365000
*                                                                  0921 03366000
*        CTGFLPTR = ADDR(ALFPLTYP);                                0921 03367000
*                                                                  0921 03368000
@RF00919 DS    0H                                                  0921 03369000
@RC00917 DS    0H                                                  0921 03370000
@RC00915 L     @06,ALPRMPTR                                        0921 03371000
         LA    @06,ALFPLTYP(,@06)                                  0921 03372000
         ST    @06,CTGFLPTR                                        0921 03373000
*        DO N = 1 TO 15;                                   /*@Y30SSJH*/ 03374000
*                                                                  0922 03375000
         LA    @06,1                                               0922 03376000
         ST    @06,N                                               0922 03377000
@DL00922 DS    0H                                                  0923 03378000
*          CTGFL = ''B;                                    /*@Y30SSJH*/ 03379000
         L     @15,CTGFLPTR                                        0923 03380000
         XC    CTGFL(16,@15),CTGFL(@15)                            0923 03381000
*          CTGFLNG(1) = NULLPTR;                           /*@Y30SSJH*/ 03382000
         SLR   @14,@14                                             0924 03383000
         ST    @14,CTGFLNG(,@15)                                   0924 03384000
*          CTGFLPT(1) = NULLPTR;                           /*@Y30SSJH*/ 03385000
         ST    @14,CTGFLPT(,@15)                                   0925 03386000
*          CTGFLDNO = 1;                                           0926 03387000
         MVI   CTGFLDNO(@15),X'01'                                 0926 03388000
*          CTGFLDNM = ADDR(ALFLDNAM(N));                           0927 03389000
         LR    @14,@06                                             0927 03390000
         SLA   @14,3                                               0927 03391000
         LA    @14,ALFLDNAM-8(@14)                                 0927 03392000
         ST    @14,CTGFLDNM(,@15)                                  0927 03393000
*          CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL) + 12);             0928 03394000
*                                                                  0928 03395000
         AL    @15,@CF00678                                        0928 03396000
         ST    @15,CTGFLPTR                                        0928 03397000
*        END;                                                      0929 03398000
*                                                                  0929 03399000
         AL    @06,@CF00220                                        0929 03400000
         ST    @06,N                                               0929 03401000
         C     @06,@CF00229                                        0929 03402000
         BNH   @DL00922                                            0929 03403000
*        /************************************************************/ 03404000
*        /*                                                          */ 03405000
*        /*  INITIALIZE POINTER TO DNAME IN FVT                      */ 03406000
*        /*                                                          */ 03407000
*        /************************************************************/ 03408000
*        IF (ADDR(INDD)) ^= NULLPTR                                0930 03409000
*          THEN                                                    0930 03410000
         L     @06,@PC00001+4                                      0930 03411000
         L     @06,FDTPTR+20(,@06)                                 0930 03412000
         LTR   @06,@06                                             0930 03413000
         BZ    @RF00930                                            0930 03414000
*            CTGFVIND = ADDR(INDDVAL);                     /*@YL026UA*/ 03415000
*                                                                  0931 03416000
         L     @01,CTGPLPTR                                        0931 03417000
         L     @01,CTGFVT(,@01)                                    0931 03418000
         LA    @06,INDDVAL(,@06)                                   0931 03419000
         ST    @06,CTGFVIND(,@01)                                  0931 03420000
*        /************************************************************/ 03421000
*        /*                                                          */ 03422000
*        /* INITIALIZE FPLS FOR ALTERATIONS TO PROTECTION ATTRIBUTES */ 03423000
*        /*                                                          */ 03424000
*        /************************************************************/ 03425000
*        IF LCPSWPT = NULLPTR                                      0932 03426000
*          THEN                                                    0932 03427000
@RF00930 L     @06,LCPSWPT                                         0932 03428000
         LTR   @06,@06                                             0932 03429000
         BNZ   @RF00932                                            0932 03430000
*            DO;                                                   0933 03431000
*                                                                  0933 03432000
*            /********************************************************/ 03433000
*            /*                                                      */ 03434000
*            /* PASSWALL OCCURRENCE DID NOT OCCUR IN ORIGINAL OBJECT */ 03435000
*            /* GET SPACE FOR PASSWALL COMBINATION AND INITIALIZE    */ 03436000
*            /*                                                      */ 03437000
*            /********************************************************/ 03438000
*                                                                  0934 03439000
*            CALL IDCSAGP0(GDTTBL,                                 0934 03440000
*                   (LENGTH(LCPSWFXD) + 255),  /* LENGTH OF AREA     */ 03441000
*                   LCPSWPT,                                       0934 03442000
*                   ALGPID,                                        0934 03443000
*                   SETZERO);                                      0934 03444000
*                                                                  0934 03445000
         L     @06,@PC00001                                        0934 03446000
         ST    @06,@AL00001                                        0934 03447000
         LA    @15,307                                             0934 03448000
         ST    @15,@AFTEMPS                                        0934 03449000
         LA    @15,@AFTEMPS                                        0934 03450000
         ST    @15,@AL00001+4                                      0934 03451000
         LA    @15,LCPSWPT                                         0934 03452000
         ST    @15,@AL00001+8                                      0934 03453000
         LA    @15,ALGPID                                          0934 03454000
         ST    @15,@AL00001+12                                     0934 03455000
         LA    @15,SETZERO                                         0934 03456000
         ST    @15,@AL00001+16                                     0934 03457000
         MVI   @AL00001+16,X'80'                                   0934 03458000
         L     @15,GDTGPL(,@06)                                    0934 03459000
         LA    @01,@AL00001                                        0934 03460000
         BALR  @14,@15                                             0934 03461000
*            RESPECIFY RTNREG RSTD;                                0935 03462000
*            TESTRC = RTNREG;                                      0936 03463000
         STH   RTNREG,TESTRC                                       0936 03464000
*            RESPECIFY RTNREG UNRSTD;                              0937 03465000
*                                                                  0937 03466000
*            /********************************************************/ 03467000
*            /*                                                      */ 03468000
*            /* NO STORAGE AVAILABLE - TERMINAL ERROR                */ 03469000
*            /*                                                      */ 03470000
*            /********************************************************/ 03471000
*                                                                  0938 03472000
*            IF TESTRC ^= 0                                        0938 03473000
*              THEN                                                0938 03474000
         LH    @06,TESTRC                                          0938 03475000
         LTR   @06,@06                                             0938 03476000
         BZ    @RF00938                                            0938 03477000
*                DO;                                               0939 03478000
*                                                                  0939 03479000
*                ALSTID = NOSTORAG;                                0940 03480000
         MVC   ALSTID(5),@CB01039                                  0940 03481000
*                RETURN;                                           0941 03482000
*                                                                  0941 03483000
@EL00003 DS    0H                                                  0941 03484000
@EF00003 DS    0H                                                  0941 03485000
@ER00003 LM    @14,@12,@SA00003                                    0941 03486000
         BR    @14                                                 0941 03487000
*                END;                                              0942 03488000
*            /********************************************************/ 03489000
*            /*                                                      */ 03490000
*            /* INITIALIZE THE PASSWALL FIELD TO BINARY ONES         */ 03491000
*            /*                                                      */ 03492000
*            /********************************************************/ 03493000
*                                                                  0943 03494000
*            DO N = 1 TO (LENGTH(LCPSWFXD));                       0943 03495000
*                                                                  0943 03496000
@RF00938 LA    @06,1                                               0943 03497000
         ST    @06,N                                               0943 03498000
@DL00943 DS    0H                                                  0944 03499000
*              LCPSWFXD (N) = 'FF'X;                               0944 03500000
*                                                                  0944 03501000
         L     @01,LCPSWPT                                         0944 03502000
         ALR   @01,@06                                             0944 03503000
         BCTR  @01,0                                               0944 03504000
         MVI   LCPSWFXD(@01),X'FF'                                 0944 03505000
*            END;                                                  0945 03506000
*                                                                  0945 03507000
         AL    @06,@CF00220                                        0945 03508000
         ST    @06,N                                               0945 03509000
         C     @06,@CF00728                                        0945 03510000
         BNH   @DL00943                                            0945 03511000
*            /********************************************************/ 03512000
*            /*                                                      */ 03513000
*            /* INITIALIZE THE PASSWORD ATTEMPTS AND USAREC LENGTH   */ 03514000
*            /*                                                      */ 03515000
*            /********************************************************/ 03516000
*            LCPWDATP = 2;                                         0946 03517000
         L     @06,LCPSWPT                                         0946 03518000
         MVC   LCPWDATP(2,@06),@CH00155                            0946 03519000
*            LCARECLN = 0;             /* INIT USARLEN TO ZERO       */ 03520000
*                                                                  0947 03521000
         SLR   @15,@15                                             0947 03522000
         STH   @15,LCARECLN(,@06)                                  0947 03523000
*            END;                                                  0948 03524000
*                                                                  0948 03525000
*        /************************************************************/ 03526000
*        /*                                                          */ 03527000
*        /* NULLIFY THE PROTECTION ATTRIBUTES                        */ 03528000
*        /*                                                          */ 03529000
*        /************************************************************/ 03530000
*                                                                  0949 03531000
*        IF (ADDR(NMSTR)) ^= NULLPTR  |                            0949 03532000
*           (ADDR(NCNTV)) ^= NULLPTR  |                            0949 03533000
*           (ADDR(NUPDT)) ^= NULLPTR  |                            0949 03534000
*           (ADDR(NREAD)) ^= NULLPTR                               0949 03535000
*          THEN                                                    0949 03536000
@RF00932 SLR   @06,@06                                             0949 03537000
         L     @15,@PC00001+4                                      0949 03538000
         C     @06,FDTPTR+100(,@15)                                0949 03539000
         BNE   @RT00949                                            0949 03540000
         C     @06,FDTPTR+104(,@15)                                0949 03541000
         BNE   @RT00949                                            0949 03542000
         C     @06,FDTPTR+108(,@15)                                0949 03543000
         BNE   @RT00949                                            0949 03544000
         C     @06,FDTPTR+112(,@15)                                0949 03545000
         BE    @RF00949                                            0949 03546000
@RT00949 DS    0H                                                  0950 03547000
*            DO;                                                   0950 03548000
*                                                                  0950 03549000
*            CTGFVSTY = ADDR(ALFPLPSW);                            0951 03550000
*                                                                  0951 03551000
         L     @06,CTGPLPTR                                        0951 03552000
         L     @06,CTGFVT(,@06)                                    0951 03553000
         L     @01,ALPRMPTR                                        0951 03554000
         LA    @15,ALFPLPSW(,@01)                                  0951 03555000
         ST    @15,CTGFVSTY(,@06)                                  0951 03556000
*            /********************************************************/ 03557000
*            /*                                                      */ 03558000
*            /* NULLIFY THE MASTER PASSWORD                          */ 03559000
*            /*                                                      */ 03560000
*            /********************************************************/ 03561000
*                                                                  0952 03562000
*            IF (ADDR(NMSTR)) ^= NULLPTR                           0952 03563000
*              THEN                                                0952 03564000
         L     @06,@PC00001+4                                      0952 03565000
         L     @06,FDTPTR+100(,@06)                                0952 03566000
         LTR   @06,@06                                             0952 03567000
         BZ    @RF00952                                            0952 03568000
*                NULLPSWD(1) = NULLMASK;                           0953 03569000
*                                                                  0953 03570000
         L     @06,LCPSWPT                                         0953 03571000
         MVC   NULLPSWD(8,@06),NULLMASK                            0953 03572000
*            /********************************************************/ 03573000
*            /*                                                      */ 03574000
*            /* NULLIFY THE CONTROL INTERVAL PASSWORD                */ 03575000
*            /*                                                      */ 03576000
*            /********************************************************/ 03577000
*                                                                  0954 03578000
*            IF (ADDR(NCNTV)) ^= NULLPTR                           0954 03579000
*              THEN                                                0954 03580000
@RF00952 L     @06,@PC00001+4                                      0954 03581000
         L     @06,FDTPTR+104(,@06)                                0954 03582000
         LTR   @06,@06                                             0954 03583000
         BZ    @RF00954                                            0954 03584000
*                NULLPSWD(2) = NULLMASK;                           0955 03585000
*                                                                  0955 03586000
         L     @06,LCPSWPT                                         0955 03587000
         MVC   NULLPSWD+8(8,@06),NULLMASK                          0955 03588000
*            /********************************************************/ 03589000
*            /*                                                      */ 03590000
*            /* NULLIFY THE UPDATE PASSWORD                          */ 03591000
*            /*                                                      */ 03592000
*            /********************************************************/ 03593000
*                                                                  0956 03594000
*            IF (ADDR(NUPDT)) ^= NULLPTR                           0956 03595000
*              THEN                                                0956 03596000
@RF00954 L     @06,@PC00001+4                                      0956 03597000
         L     @06,FDTPTR+108(,@06)                                0956 03598000
         LTR   @06,@06                                             0956 03599000
         BZ    @RF00956                                            0956 03600000
*                NULLPSWD(3) = NULLMASK;                           0957 03601000
*                                                                  0957 03602000
         L     @06,LCPSWPT                                         0957 03603000
         MVC   NULLPSWD+16(8,@06),NULLMASK                         0957 03604000
*            /********************************************************/ 03605000
*            /*                                                      */ 03606000
*            /* NULLIFY THE READ PASSWORD                            */ 03607000
*            /*                                                      */ 03608000
*            /********************************************************/ 03609000
*                                                                  0958 03610000
*            IF (ADDR(NREAD)) ^= NULLPTR                           0958 03611000
*              THEN                                                0958 03612000
@RF00956 L     @06,@PC00001+4                                      0958 03613000
         L     @06,FDTPTR+112(,@06)                                0958 03614000
         LTR   @06,@06                                             0958 03615000
         BZ    @RF00958                                            0958 03616000
*                NULLPSWD(4) = NULLMASK;                           0959 03617000
*                                                                  0959 03618000
         L     @06,LCPSWPT                                         0959 03619000
         MVC   NULLPSWD+24(8,@06),NULLMASK                         0959 03620000
*            END;                                                  0960 03621000
@RF00958 DS    0H                                                  0961 03622000
*        /************************************************************/ 03623000
*        /*                                                          */ 03624000
*        /* NULLIFY THE PASSWORD PROMPTING CODENAME                  */ 03625000
*        /*                                                          */ 03626000
*        /************************************************************/ 03627000
*                                                                  0961 03628000
*        IF (ADDR(NCDNM)) ^= NULLPTR                               0961 03629000
*          THEN                                                    0961 03630000
@RF00949 L     @06,@PC00001+4                                      0961 03631000
         L     @06,FDTPTR+168(,@06)                                0961 03632000
         LTR   @06,@06                                             0961 03633000
         BZ    @RF00961                                            0961 03634000
*            DO;                                                   0962 03635000
*                                                                  0962 03636000
*            CTGFVSTY = ADDR(ALFPLPSW);                            0963 03637000
         L     @06,CTGPLPTR                                        0963 03638000
         L     @06,CTGFVT(,@06)                                    0963 03639000
         L     @01,ALPRMPTR                                        0963 03640000
         LA    @15,ALFPLPSW(,@01)                                  0963 03641000
         ST    @15,CTGFVSTY(,@06)                                  0963 03642000
*            LCPWPRMT = NULLMASK;                                  0964 03643000
*                                                                  0964 03644000
         L     @06,LCPSWPT                                         0964 03645000
         MVC   LCPWPRMT(8,@06),NULLMASK                            0964 03646000
*            END;                                                  0965 03647000
*                                                                  0965 03648000
*        /************************************************************/ 03649000
*        /*                                                          */ 03650000
*        /* NULLIFY THE PASSWORD AUTHORIZATION INFORMATION           */ 03651000
*        /*                                                          */ 03652000
*        /************************************************************/ 03653000
*                                                                  0966 03654000
*        IF (ADDR(NAUTH)) ^= NULLPTR                               0966 03655000
*          THEN                                                    0966 03656000
*                                                                  0966 03657000
@RF00961 SLR   @06,@06                                             0966 03658000
         L     @15,@PC00001+4                                      0966 03659000
         C     @06,FDTPTR+176(,@15)                                0966 03660000
         BE    @RF00966                                            0966 03661000
*            /********************************************************/ 03662000
*            /*                                                      */ 03663000
*            /* NULLIFY THE USER AUTHORIZATION MODULE NAME -         */ 03664000
*            /* THE USER AUTHORIZATION RECORD IS ALSO NULLIFIED      */ 03665000
*            /*                                                      */ 03666000
*            /********************************************************/ 03667000
*            IF(ADDR(NMDNM)) ^= NULLPTR                            0967 03668000
*              THEN                                                0967 03669000
         C     @06,FDTPTR+180(,@15)                                0967 03670000
         BE    @RF00967                                            0967 03671000
*                DO;                                               0968 03672000
*                                                                  0968 03673000
*                LCVRMDUL = NULLMASK;                              0969 03674000
         L     @15,LCPSWPT                                         0969 03675000
         MVC   LCVRMDUL(8,@15),NULLMASK                            0969 03676000
*                LCARECLN = 0;                                     0970 03677000
         STH   @06,LCARECLN(,@15)                                  0970 03678000
*                CTGFVSTY = ADDR(ALFPLPSW);                        0971 03679000
*                                                                  0971 03680000
         L     @06,CTGPLPTR                                        0971 03681000
         L     @06,CTGFVT(,@06)                                    0971 03682000
         L     @01,ALPRMPTR                                        0971 03683000
         LA    @15,ALFPLPSW(,@01)                                  0971 03684000
         ST    @15,CTGFVSTY(,@06)                                  0971 03685000
*                END;                                              0972 03686000
*                                                                  0972 03687000
*              /******************************************************/ 03688000
*              /*                                                    */ 03689000
*              /* NULLIFY THE USER AUTHORIZATION RECORD ONLY         */ 03690000
*              /*                                                    */ 03691000
*              /******************************************************/ 03692000
*              ELSE                                                0973 03693000
*                IF (ADDR(NSTRG)) ^= NULLPTR                       0973 03694000
*                  THEN                                            0973 03695000
         B     @RC00967                                            0973 03696000
@RF00967 SLR   @06,@06                                             0973 03697000
         L     @15,@PC00001+4                                      0973 03698000
         C     @06,FDTPTR+184(,@15)                                0973 03699000
         BE    @RF00973                                            0973 03700000
*                    DO;                                           0974 03701000
*                                                                  0974 03702000
*                    LCARECLN = 0;                                 0975 03703000
         L     @01,LCPSWPT                                         0975 03704000
         STH   @06,LCARECLN(,@01)                                  0975 03705000
*                    CTGFVSTY = ADDR(ALFPLPSW);                    0976 03706000
*                                                                  0976 03707000
         L     @06,CTGPLPTR                                        0976 03708000
         L     @06,CTGFVT(,@06)                                    0976 03709000
         L     @01,ALPRMPTR                                        0976 03710000
         LA    @15,ALFPLPSW(,@01)                                  0976 03711000
         ST    @15,CTGFVSTY(,@06)                                  0976 03712000
*                    END;                                          0977 03713000
*                                                                  0977 03714000
*        /************************************************************/ 03715000
*        /*                                                          */ 03716000
*        /* ALTER THE MASTER PASSWORD                                */ 03717000
*        /*                                                          */ 03718000
*        /************************************************************/ 03719000
*                                                                  0978 03720000
*        IF (ADDR(MASTR)) ^= NULLPTR                               0978 03721000
*          THEN                                                    0978 03722000
@RF00973 DS    0H                                                  0978 03723000
@RC00967 DS    0H                                                  0978 03724000
@RF00966 L     @06,@PC00001+4                                      0978 03725000
         L     @06,FDTPTR+28(,@06)                                 0978 03726000
         LTR   @06,@06                                             0978 03727000
         BZ    @RF00978                                            0978 03728000
*            DO;                                                   0979 03729000
*                                                                  0979 03730000
*            LCMSTRPW = MASTRVAL;                                  0980 03731000
         L     @01,LCPSWPT                                         0980 03732000
         MVC   LCMSTRPW(8,@01),MASTRVAL(@06)                       0980 03733000
*            CTGFVSTY = ADDR(ALFPLPSW);                            0981 03734000
*                                                                  0981 03735000
         L     @06,CTGPLPTR                                        0981 03736000
         L     @06,CTGFVT(,@06)                                    0981 03737000
         L     @01,ALPRMPTR                                        0981 03738000
         LA    @15,ALFPLPSW(,@01)                                  0981 03739000
         ST    @15,CTGFVSTY(,@06)                                  0981 03740000
*            END;                                                  0982 03741000
*                                                                  0982 03742000
*        /************************************************************/ 03743000
*        /*                                                          */ 03744000
*        /* ALTER THE CONTROL INTERVAL PASSWORD                      */ 03745000
*        /*                                                          */ 03746000
*        /************************************************************/ 03747000
*                                                                  0983 03748000
*        IF (ADDR(CNTVL)) ^= NULLPTR                               0983 03749000
*          THEN                                                    0983 03750000
@RF00978 L     @06,@PC00001+4                                      0983 03751000
         L     @06,FDTPTR+32(,@06)                                 0983 03752000
         LTR   @06,@06                                             0983 03753000
         BZ    @RF00983                                            0983 03754000
*            DO;                                                   0984 03755000
*                                                                  0984 03756000
*            LCCINTPW = CNTVLVAL;                                  0985 03757000
         L     @01,LCPSWPT                                         0985 03758000
         MVC   LCCINTPW(8,@01),CNTVLVAL(@06)                       0985 03759000
*            CTGFVSTY = ADDR(ALFPLPSW);                            0986 03760000
*                                                                  0986 03761000
         L     @06,CTGPLPTR                                        0986 03762000
         L     @06,CTGFVT(,@06)                                    0986 03763000
         L     @01,ALPRMPTR                                        0986 03764000
         LA    @15,ALFPLPSW(,@01)                                  0986 03765000
         ST    @15,CTGFVSTY(,@06)                                  0986 03766000
*            END;                                                  0987 03767000
*                                                                  0987 03768000
*        /************************************************************/ 03769000
*        /*                                                          */ 03770000
*        /* ALTER THE UPDATE PASSWORD                                */ 03771000
*        /*                                                          */ 03772000
*        /************************************************************/ 03773000
*                                                                  0988 03774000
*        IF (ADDR(UPDAT)) ^= NULLPTR                               0988 03775000
*          THEN                                                    0988 03776000
@RF00983 L     @06,@PC00001+4                                      0988 03777000
         L     @06,FDTPTR+36(,@06)                                 0988 03778000
         LTR   @06,@06                                             0988 03779000
         BZ    @RF00988                                            0988 03780000
*            DO;                                                   0989 03781000
*                                                                  0989 03782000
*            LCUPDTPW = UPDATVAL;                                  0990 03783000
         L     @01,LCPSWPT                                         0990 03784000
         MVC   LCUPDTPW(8,@01),UPDATVAL(@06)                       0990 03785000
*            CTGFVSTY = ADDR(ALFPLPSW);                            0991 03786000
*                                                                  0991 03787000
         L     @06,CTGPLPTR                                        0991 03788000
         L     @06,CTGFVT(,@06)                                    0991 03789000
         L     @01,ALPRMPTR                                        0991 03790000
         LA    @15,ALFPLPSW(,@01)                                  0991 03791000
         ST    @15,CTGFVSTY(,@06)                                  0991 03792000
*            END;                                                  0992 03793000
*                                                                  0992 03794000
*        /************************************************************/ 03795000
*        /*                                                          */ 03796000
*        /* ALTER THE READ PASSWORD                                  */ 03797000
*        /*                                                          */ 03798000
*        /************************************************************/ 03799000
*                                                                  0993 03800000
*        IF (ADDR(READ)) ^= NULLPTR                                0993 03801000
*          THEN                                                    0993 03802000
@RF00988 L     @06,@PC00001+4                                      0993 03803000
         L     @06,FDTPTR+40(,@06)                                 0993 03804000
         LTR   @06,@06                                             0993 03805000
         BZ    @RF00993                                            0993 03806000
*            DO;                                                   0994 03807000
*                                                                  0994 03808000
*            LCREADPW = READVAL;                                   0995 03809000
         L     @01,LCPSWPT                                         0995 03810000
         MVC   LCREADPW(8,@01),READVAL(@06)                        0995 03811000
*            CTGFVSTY = ADDR(ALFPLPSW);                            0996 03812000
*                                                                  0996 03813000
         L     @06,CTGPLPTR                                        0996 03814000
         L     @06,CTGFVT(,@06)                                    0996 03815000
         L     @01,ALPRMPTR                                        0996 03816000
         LA    @15,ALFPLPSW(,@01)                                  0996 03817000
         ST    @15,CTGFVSTY(,@06)                                  0996 03818000
*            END;                                                  0997 03819000
*                                                                  0997 03820000
*        /************************************************************/ 03821000
*        /*                                                          */ 03822000
*        /* ALTER THE PASSWORD PROMPTING NAME                        */ 03823000
*        /*                                                          */ 03824000
*        /************************************************************/ 03825000
*                                                                  0998 03826000
*        IF (ADDR(CODNM)) ^= NULLPTR                               0998 03827000
*          THEN                                                    0998 03828000
@RF00993 L     @06,@PC00001+4                                      0998 03829000
         L     @06,FDTPTR+44(,@06)                                 0998 03830000
         LTR   @06,@06                                             0998 03831000
         BZ    @RF00998                                            0998 03832000
*            DO;                                                   0999 03833000
*                                                                  0999 03834000
*            LCPWPRMT = CODNMVAL;                                  1000 03835000
         L     @01,LCPSWPT                                         1000 03836000
         MVC   LCPWPRMT(8,@01),CODNMVAL(@06)                       1000 03837000
*            CTGFVSTY = ADDR(ALFPLPSW);                            1001 03838000
*                                                                  1001 03839000
         L     @06,CTGPLPTR                                        1001 03840000
         L     @06,CTGFVT(,@06)                                    1001 03841000
         L     @01,ALPRMPTR                                        1001 03842000
         LA    @15,ALFPLPSW(,@01)                                  1001 03843000
         ST    @15,CTGFVSTY(,@06)                                  1001 03844000
*            END;                                                  1002 03845000
*                                                                  1002 03846000
*        /************************************************************/ 03847000
*        /*                                                          */ 03848000
*        /* ALTER THE PASSWORD PROMPTING ATTEMPTS                    */ 03849000
*        /*                                                          */ 03850000
*        /************************************************************/ 03851000
*                                                                  1003 03852000
*        IF (ADDR(ATTP)) ^= NULLPTR                                1003 03853000
*          THEN                                                    1003 03854000
@RF00998 L     @06,@PC00001+4                                      1003 03855000
         L     @06,FDTPTR+48(,@06)                                 1003 03856000
         LTR   @06,@06                                             1003 03857000
         BZ    @RF01003                                            1003 03858000
*            DO;                                                   1004 03859000
*                                                                  1004 03860000
*            LCPWDATP = ATTPVAL;                                   1005 03861000
         L     @06,ATTPVAL(,@06)                                   1005 03862000
         L     @01,LCPSWPT                                         1005 03863000
         STH   @06,LCPWDATP(,@01)                                  1005 03864000
*            CTGFVSTY = ADDR(ALFPLPSW);                            1006 03865000
*                                                                  1006 03866000
         L     @06,CTGPLPTR                                        1006 03867000
         L     @06,CTGFVT(,@06)                                    1006 03868000
         L     @01,ALPRMPTR                                        1006 03869000
         LA    @15,ALFPLPSW(,@01)                                  1006 03870000
         ST    @15,CTGFVSTY(,@06)                                  1006 03871000
*            END;                                                  1007 03872000
*                                                                  1007 03873000
*        /************************************************************/ 03874000
*        /*                                                          */ 03875000
*        /* ALTER THE USER VERIFICATION MODULE NAME                  */ 03876000
*        /*                                                          */ 03877000
*        /************************************************************/ 03878000
*                                                                  1008 03879000
*        IF (ADDR(USVR)) ^= NULLPTR                                1008 03880000
*          THEN                                                    1008 03881000
@RF01003 L     @06,@PC00001+4                                      1008 03882000
         L     @06,FDTPTR+56(,@06)                                 1008 03883000
         LTR   @06,@06                                             1008 03884000
         BZ    @RF01008                                            1008 03885000
*            DO;                                                   1009 03886000
*                                                                  1009 03887000
*            LCVRMDUL = USVRVAL;                                   1010 03888000
         L     @01,LCPSWPT                                         1010 03889000
         MVC   LCVRMDUL(8,@01),USVRVAL(@06)                        1010 03890000
*            CTGFVSTY = ADDR(ALFPLPSW);                            1011 03891000
*                                                                  1011 03892000
         L     @06,CTGPLPTR                                        1011 03893000
         L     @06,CTGFVT(,@06)                                    1011 03894000
         L     @01,ALPRMPTR                                        1011 03895000
         LA    @15,ALFPLPSW(,@01)                                  1011 03896000
         ST    @15,CTGFVSTY(,@06)                                  1011 03897000
*            END;                                                  1012 03898000
*                                                                  1012 03899000
*        /************************************************************/ 03900000
*        /*                                                          */ 03901000
*        /* ALTER THE USER AUTHORIZATION RECORD                      */ 03902000
*        /*                                                          */ 03903000
*        /************************************************************/ 03904000
*                                                                  1013 03905000
*        IF (ADDR(USAR)) ^= NULLPTR                                1013 03906000
*          THEN                                                    1013 03907000
@RF01008 L     @06,@PC00001+4                                      1013 03908000
         L     @06,FDTPTR+60(,@06)                                 1013 03909000
         LTR   @06,@06                                             1013 03910000
         BZ    @RF01013                                            1013 03911000
*            DO;                                                   1014 03912000
*                                                                  1014 03913000
*            /********************************************************/ 03914000
*            /*                                                      */ 03915000
*            /* GET NEW PASSWALL AREA IF NEW AUTH RECORD IS          */ 03916000
*            /* GREATER THAN THE OLD                                 */ 03917000
*            /*                                                      */ 03918000
*            /********************************************************/ 03919000
*                                                                  1015 03920000
*            IF USARLEN > LCARECLN                                 1015 03921000
*              THEN                                                1015 03922000
         SLR   @15,@15                                             1015 03923000
         IC    @15,USARLEN(,@06)                                   1015 03924000
         L     @06,LCPSWPT                                         1015 03925000
         CH    @15,LCARECLN(,@06)                                  1015 03926000
         BNH   @RF01015                                            1015 03927000
*                DO;                                               1016 03928000
*                                                                  1016 03929000
*                CALL IDCSAGP0(GDTTBL,                             1017 03930000
*                       (LENGTH(LCPSWFXD) + 255), /* GPOOL LENGTH    */ 03931000
*                       NEWPSWPT,             /* ADDRESS OF PASSWALL */ 03932000
*                       ALGPID,               /* GETPOOL ID          */ 03933000
*                       SETZERO);             /* SET AREA TO ZERO    */ 03934000
*                                                                  1017 03935000
         L     @06,@PC00001                                        1017 03936000
         ST    @06,@AL00001                                        1017 03937000
         LA    @15,307                                             1017 03938000
         ST    @15,@AFTEMPS                                        1017 03939000
         LA    @15,@AFTEMPS                                        1017 03940000
         ST    @15,@AL00001+4                                      1017 03941000
         LA    @15,NEWPSWPT                                        1017 03942000
         ST    @15,@AL00001+8                                      1017 03943000
         LA    @15,ALGPID                                          1017 03944000
         ST    @15,@AL00001+12                                     1017 03945000
         LA    @15,SETZERO                                         1017 03946000
         ST    @15,@AL00001+16                                     1017 03947000
         MVI   @AL00001+16,X'80'                                   1017 03948000
         L     @15,GDTGPL(,@06)                                    1017 03949000
         LA    @01,@AL00001                                        1017 03950000
         BALR  @14,@15                                             1017 03951000
*                RESPECIFY RTNREG RSTD;                            1018 03952000
*                TESTRC = RTNREG;                                  1019 03953000
         STH   RTNREG,TESTRC                                       1019 03954000
*                RESPECIFY RTNREG UNRSTD;                          1020 03955000
*                IF TESTRC ^= 0                                    1021 03956000
*                  THEN                                            1021 03957000
         LH    @06,TESTRC                                          1021 03958000
         LTR   @06,@06                                             1021 03959000
         BZ    @RF01021                                            1021 03960000
*                    DO;                                           1022 03961000
*                                                                  1022 03962000
*                    ALSTID = NOSTORAG;                            1023 03963000
         MVC   ALSTID(5),@CB01039                                  1023 03964000
*                    RETURN;                                       1024 03965000
*                                                                  1024 03966000
         B     @EL00003                                            1024 03967000
*                    END;                                          1025 03968000
*                                                                  1025 03969000
*                /****************************************************/ 03970000
*                /*                                                  */ 03971000
*                /* MOVE FIXED LENGTH PORTION TO NEW AREA            */ 03972000
*                /*                                                  */ 03973000
*                /****************************************************/ 03974000
*                                                                  1026 03975000
*                NEWPSWPT -> LCPSWFXD = LCPSWFXD;                  1026 03976000
@RF01021 L     @06,NEWPSWPT                                        1026 03977000
         L     @01,LCPSWPT                                         1026 03978000
         MVC   LCPSWFXD(52,@06),LCPSWFXD(@01)                      1026 03979000
*                LCPSWPT = NEWPSWPT;                               1027 03980000
*                                                                  1027 03981000
         ST    @06,LCPSWPT                                         1027 03982000
*                END;                                              1028 03983000
*                                                                  1028 03984000
*            /********************************************************/ 03985000
*            /*                                                      */ 03986000
*            /* MOVE AUTHORIZATION RECORD TO PASSWALL FIELD          */ 03987000
*            /*                                                      */ 03988000
*            /********************************************************/ 03989000
*                                                                  1029 03990000
*            LCARECLN = USARLEN;                                   1029 03991000
@RF01015 L     @06,LCPSWPT                                         1029 03992000
         L     @15,@PC00001+4                                      1029 03993000
         L     @15,FDTPTR+60(,@15)                                 1029 03994000
         SLR   @14,@14                                             1029 03995000
         IC    @14,USARLEN(,@15)                                   1029 03996000
         STH   @14,LCARECLN(,@06)                                  1029 03997000
*            LCUAREC(1:LCARECLN) = USARVAL(1:LCARECLN);            1030 03998000
         BCTR  @14,0                                               1030 03999000
         EX    @14,@SM01709                                        1030 04000000
*            CTGFVSTY = ADDR(ALFPLPSW);                            1031 04001000
*                                                                  1031 04002000
         L     @06,CTGPLPTR                                        1031 04003000
         L     @06,CTGFVT(,@06)                                    1031 04004000
         L     @01,ALPRMPTR                                        1031 04005000
         LA    @15,ALFPLPSW(,@01)                                  1031 04006000
         ST    @15,CTGFVSTY(,@06)                                  1031 04007000
*            END;                                                  1032 04008000
*                                                                  1032 04009000
*                                                                  1032 04010000
*        /************************************************************/ 04011000
*        /*                                                          */ 04012000
*        /* BUILD THE PASSWALL FPL IF CHANGES HAVE BEEN MADE -       */ 04013000
*        /* THE INITIALIZATION OF CTGFVSTY INDICATES CHANGE          */ 04014000
*        /* AND MIGRATE 1ST NON-NULL PASSWORD IF THE MASTER HAS      */ 04015000
*        /* BEEN NULLIFIED                                           */ 04016000
*        /*                                                          */ 04017000
*        /************************************************************/ 04018000
*                                                                  1033 04019000
*        IF CTGFVSTY ^= NULLPTR                                    1033 04020000
*          THEN                                                    1033 04021000
@RF01013 SLR   @06,@06                                             1033 04022000
         L     @01,CTGPLPTR                                        1033 04023000
         L     @01,CTGFVT(,@01)                                    1033 04024000
         C     @06,CTGFVSTY(,@01)                                  1033 04025000
         BE    @RF01033                                            1033 04026000
*            DO;                                                   1034 04027000
*                                                                  1034 04028000
*            /********************************************************/ 04029000
*            /*                                                      */ 04030000
*            /* IF THE MASTER HAS BEEN NULLIFIED AND THERE ARE       */ 04031000
*            /* VALID PASSWORDS SPECIFIED - WE MUST MIGRATE THE      */ 04032000
*            /* THE FIRST NON-NULL PASSWORD VALUE IN THE HIERAR-     */ 04033000
*            /* CHY UP TO THE MASTER LEVEL AND THRU THE INTER-       */ 04034000
*            /* VENING LEVELS                                        */ 04035000
*            /*                                                      */ 04036000
*            /********************************************************/ 04037000
*                                                                  1035 04038000
*            MIGRLOOP = 0;                                         1035 04039000
         STH   @06,MIGRLOOP                                        1035 04040000
*            MIGRFLAG = GO;                                        1036 04041000
*                                                                  1036 04042000
         MVI   MIGRFLAG,X'00'                                      1036 04043000
*            IF LCMSTRPW = NULLMASK                                1037 04044000
*              THEN                                                1037 04045000
         L     @06,LCPSWPT                                         1037 04046000
         CLC   LCMSTRPW(8,@06),NULLMASK                            1037 04047000
         BNE   @RF01037                                            1037 04048000
*                DO N = 2 TO 4                                     1038 04049000
*                WHILE MIGRFLAG = GO;                              1038 04050000
*                                                                  1038 04051000
         LA    @06,2                                               1038 04052000
         ST    @06,N                                               1038 04053000
@DL01038 CLI   MIGRFLAG,X'00'                                      1038 04054000
         BNE   @DC01038                                            1038 04055000
*                  IF NULLPSWD(N) ^= NULLMASK                      1039 04056000
*                    THEN                                          1039 04057000
         LR    @15,@06                                             1039 04058000
         SLA   @15,3                                               1039 04059000
         L     @01,LCPSWPT                                         1039 04060000
         ALR   @01,@15                                             1039 04061000
         AL    @01,@CF01711                                        1039 04062000
         CLC   NULLPSWD(8,@01),NULLMASK                            1039 04063000
         BE    @RF01039                                            1039 04064000
*                      DO;                                         1040 04065000
*                                                                  1040 04066000
*                      MIGRFLAG = STOP;                            1041 04067000
         MVI   MIGRFLAG,X'0F'                                      1041 04068000
*                      MIGRLOOP = N;                               1042 04069000
*                                                                  1042 04070000
         STH   @06,MIGRLOOP                                        1042 04071000
*                      END;                                        1043 04072000
*                                                                  1043 04073000
*                END;                                              1044 04074000
*                                                                  1044 04075000
@RF01039 LA    @06,1                                               1044 04076000
         AL    @06,N                                               1044 04077000
         ST    @06,N                                               1044 04078000
         C     @06,@CF00044                                        1044 04079000
         BNH   @DL01038                                            1044 04080000
@DC01038 DS    0H                                                  1045 04081000
*            /********************************************************/ 04082000
*            /*                                                      */ 04083000
*            /* IF THE ABOVE LOOP HAS DETECTED A NEED FOR            */ 04084000
*            /* MIGRATION - PERFORM THE MIGRATION USING THE          */ 04085000
*            /* VALUES FROM THAT LOOP                                */ 04086000
*            /*                                                      */ 04087000
*            /********************************************************/ 04088000
*            IF MIGRLOOP ^= 0                                      1045 04089000
*              THEN                                                1045 04090000
@RF01037 LH    @06,MIGRLOOP                                        1045 04091000
         LTR   @06,@06                                             1045 04092000
         BZ    @RF01045                                            1045 04093000
*                DO N = MIGRLOOP TO 2 BY -1;                       1046 04094000
*                                                                  1046 04095000
         ST    @06,N                                               1046 04096000
         B     @DE01046                                            1046 04097000
@DL01046 DS    0H                                                  1047 04098000
*                  NULLPSWD(N-1) = NULLPSWD(N);                    1047 04099000
*                                                                  1047 04100000
         L     @15,LCPSWPT                                         1047 04101000
         LR    @14,@06                                             1047 04102000
         SLA   @14,3                                               1047 04103000
         ST    @14,@TF00001                                        1047 04104000
         ALR   @14,@15                                             1047 04105000
         AL    @14,@CF01712                                        1047 04106000
         AL    @15,@TF00001                                        1047 04107000
         AL    @15,@CF01711                                        1047 04108000
         MVC   NULLPSWD(8,@14),NULLPSWD(@15)                       1047 04109000
*                END;                                              1048 04110000
*                                                                  1048 04111000
         BCTR  @06,0                                               1048 04112000
         ST    @06,N                                               1048 04113000
@DE01046 C     @06,@CF00155                                        1048 04114000
         BNL   @DL01046                                            1048 04115000
*            /********************************************************/ 04116000
*            /*                                                      */ 04117000
*            /* ALTERATIONS HAVE OCCURRED - NOW IF THEIR NATURE HAS  */ 04118000
*            /* BEEN TO NULLIFY THE 4 PASSWORD LEVELS - THE ENTIRE   */ 04119000
*            /* PASSWALL OCCURRENCE IS NULLIFIED AND PASSED IN THIS  */ 04120000
*            /* FORM TO VSAM CATALOG MANAGEMENT                      */ 04121000
*            /*                                                      */ 04122000
*            /********************************************************/ 04123000
*                                                                  1049 04124000
*            IF NULLPSWD(1) = NULLMASK                             1049 04125000
*              THEN                                                1049 04126000
@RF01045 L     @06,LCPSWPT                                         1049 04127000
         CLC   NULLPSWD(8,@06),NULLMASK                            1049 04128000
         BNE   @RF01049                                            1049 04129000
*                DO;                                               1050 04130000
*                                                                  1050 04131000
*                CTGFLPTR = ADDR(ALFPLPSW);                        1051 04132000
         L     @15,ALPRMPTR                                        1051 04133000
         LA    @14,ALFPLPSW(,@15)                                  1051 04134000
         ST    @14,CTGFLPTR                                        1051 04135000
*                CTGFLNG(1) = LENGTH(LCPSWFXD);                    1052 04136000
         MVC   CTGFLNG(4,@14),@CF00728                             1052 04137000
*                CTGFLPT(1) = LCPSWPT;                             1053 04138000
         ST    @06,CTGFLPT(,@14)                                   1053 04139000
*                ALPSW = 'PSWD';                                   1054 04140000
         MVC   ALPSW(4,@15),@CC01448                               1054 04141000
*                LCPWPRMT = NULLMASK;                              1055 04142000
         MVC   LCPWPRMT(8,@06),NULLMASK                            1055 04143000
*                LCPWDATP = 0;                                     1056 04144000
         SLR   @15,@15                                             1056 04145000
         STH   @15,LCPWDATP(,@06)                                  1056 04146000
*                LCVRMDUL = NULLMASK;                              1057 04147000
         MVC   LCVRMDUL(8,@06),NULLMASK                            1057 04148000
*                LCARECLN = 0;                                     1058 04149000
*                                                                  1058 04150000
         STH   @15,LCARECLN(,@06)                                  1058 04151000
*                END;                                              1059 04152000
*                                                                  1059 04153000
*              /******************************************************/ 04154000
*              /*                                                    */ 04155000
*              /* WE HAVE A VALID PASSWALL OCCURRENCE DONT NULLIFY   */ 04156000
*              /*                                                    */ 04157000
*              /******************************************************/ 04158000
*              ELSE                                                1060 04159000
*                DO;                                               1060 04160000
*                                                                  1060 04161000
         B     @RC01049                                            1060 04162000
@RF01049 DS    0H                                                  1061 04163000
*                CTGFLPTR = ADDR(ALFPLPSW);                        1061 04164000
         L     @06,ALPRMPTR                                        1061 04165000
         LA    @15,ALFPLPSW(,@06)                                  1061 04166000
         ST    @15,CTGFLPTR                                        1061 04167000
*                ALPSW = 'PSWD';                                   1062 04168000
         MVC   ALPSW(4,@06),@CC01448                               1062 04169000
*                CTGFLNG(1) = (LENGTH(LCPSWFXD) + LCARECLN);       1063 04170000
         L     @06,LCPSWPT                                         1063 04171000
         LA    @14,52                                              1063 04172000
         AH    @14,LCARECLN(,@06)                                  1063 04173000
         ST    @14,CTGFLNG(,@15)                                   1063 04174000
*                CTGFLPT(1) = LCPSWPT;                             1064 04175000
*                                                                  1064 04176000
         ST    @06,CTGFLPT(,@15)                                   1064 04177000
*                END;                                              1065 04178000
*                                                                  1065 04179000
*            CTGFLPTR = ADDR(ALFPLPSW);                            1066 04180000
@RC01049 L     @06,ALPRMPTR                                        1066 04181000
         LA    @15,ALFPLPSW(,@06)                                  1066 04182000
         ST    @15,CTGFLPTR                                        1066 04183000
*            ALPSW = 'PSWD';                                       1067 04184000
         MVC   ALPSW(4,@06),@CC01448                               1067 04185000
*            CTGFLNG(1) = (LENGTH(LCPSWFXD)) + LCARECLN;           1068 04186000
         L     @06,LCPSWPT                                         1068 04187000
         LA    @14,52                                              1068 04188000
         AH    @14,LCARECLN(,@06)                                  1068 04189000
         ST    @14,CTGFLNG(,@15)                                   1068 04190000
*            CTGFLPT(1) = LCPSWPT;                                 1069 04191000
*                                                                  1069 04192000
         ST    @06,CTGFLPT(,@15)                                   1069 04193000
*            END;                                                  1070 04194000
*                                                                  1070 04195000
*        /************************************************************/ 04196000
*        /*                                                          */ 04197000
*        /* NULLIFY THE DATA SET EXPIRATION DATE                     */ 04198000
*        /*                                                          */ 04199000
*        /************************************************************/ 04200000
*                                                                  1071 04201000
*        IF (ADDR(NRETN)) ^= NULLPTR                               1071 04202000
*          THEN                                                    1071 04203000
@RF01033 L     @06,@PC00001+4                                      1071 04204000
         L     @06,FDTPTR+172(,@06)                                1071 04205000
         LTR   @06,@06                                             1071 04206000
         BZ    @RF01071                                            1071 04207000
*            DO;                                                   1072 04208000
*                                                                  1072 04209000
*            CTGFVEXP = ADDR(ALFPLEXP);                            1073 04210000
         L     @06,CTGPLPTR                                        1073 04211000
         L     @06,CTGFVT(,@06)                                    1073 04212000
         L     @01,ALPRMPTR                                        1073 04213000
         LA    @15,ALFPLEXP(,@01)                                  1073 04214000
         ST    @15,CTGFVEXP(,@06)                                  1073 04215000
*            EXPIRE = '00000F'X;                                   1074 04216000
*                                                                  1074 04217000
         MVC   EXPIRE(3),@CB01495                                  1074 04218000
*            END;                                                  1075 04219000
*                                                                  1075 04220000
*        /************************************************************/ 04221000
*        /*                                                          */ 04222000
*        /* ALTER THE DATA SET EXPIRATION DATE                       */ 04223000
*        /*                                                          */ 04224000
*        /************************************************************/ 04225000
*                                                                  1076 04226000
*        IF (ADDR(TO)) ^= NULLPTR                                  1076 04227000
*          THEN                                                    1076 04228000
@RF01071 L     @06,@PC00001+4                                      1076 04229000
         L     @06,FDTPTR+68(,@06)                                 1076 04230000
         LTR   @06,@06                                             1076 04231000
         BZ    @RF01076                                            1076 04232000
*            DO;                                                   1077 04233000
*                                                                  1077 04234000
*            RFY (REG5,REG6) RESTRICTED;                           1078 04235000
*            REG6 = TOVAL;                                         1079 04236000
         ST    @06,@TF00001                                        1079 04237000
         L     @04,@TF00001                                        1079 04238000
         L     REG6,TOVAL(,@04)                                    1079 04239000
*            REG5 = ADDR(EXPIREDT);                                1080 04240000
*                                                                  1080 04241000
         LA    REG5,EXPIREDT                                       1080 04242000
*            GENERATE(CVD REG6,0(0,REG5));                         1081 04243000
*                                                                  1081 04244000
         CVD REG6,0(0,REG5)                                             04245000
*            RFY (REG5,REG6) UNRESTRICTED;                         1082 04246000
*            CTGFVEXP = ADDR(ALFPLEXP);                            1083 04247000
*                                                                  1083 04248000
         L     @06,CTGPLPTR                                        1083 04249000
         L     @06,CTGFVT(,@06)                                    1083 04250000
         L     @01,ALPRMPTR                                        1083 04251000
         LA    @15,ALFPLEXP(,@01)                                  1083 04252000
         ST    @15,CTGFVEXP(,@06)                                  1083 04253000
*            END;                                                  1084 04254000
*                                                                  1084 04255000
*          /**********************************************************/ 04256000
*          /*                                                        */ 04257000
*          /* COMPUTE THE EXPIRATION DATE VIA THE USER SUPPLIED INCR-*/ 04258000
*          /* EMENT - THIS VALUE IS ADDED TO THE CURRENT DATE AS     */ 04259000
*          /* SUPPLIED BY THE UTIME MACRO. THEYRDYLOOP ADJUSTS FOR   */ 04260000
*          /* BOTH LEAP AND NONLEAP YEARS                            */ 04261000
*          /*                                                        */ 04262000
*          /**********************************************************/ 04263000
*                                                                  1085 04264000
*          ELSE                                                    1085 04265000
*            IF (ADDR(FOR)) ^= NULLPTR                             1085 04266000
*              THEN                                                1085 04267000
         B     @RC01076                                            1085 04268000
@RF01076 L     @06,@PC00001+4                                      1085 04269000
         L     @06,FDTPTR+72(,@06)                                 1085 04270000
         LTR   @06,@06                                             1085 04271000
         BZ    @RF01085                                            1085 04272000
*FORLOOP:        DO;                                               1086 04273000
*                                                                  1086 04274000
FORLOOP  DS    0H                                                  1087 04275000
*                CTGFVEXP = ADDR(ALFPLEXP);                        1087 04276000
*                                                                  1087 04277000
         L     @06,CTGPLPTR                                        1087 04278000
         L     @06,CTGFVT(,@06)                                    1087 04279000
         L     @01,ALPRMPTR                                        1087 04280000
         LA    @15,ALFPLEXP(,@01)                                  1087 04281000
         ST    @15,CTGFVEXP(,@06)                                  1087 04282000
*                /****************************************************/ 04283000
*                /*                                                  */ 04284000
*                /* WHEN THE INCREMENT IS GREATER THAN FIVE YEARS    */ 04285000
*                /* FROM THE CURRENT DATE THE MAXIMUM EXPIRATION     */ 04286000
*                /* DATE IS USED                                     */ 04287000
*                /*                                                  */ 04288000
*                /****************************************************/ 04289000
*                                                                  1088 04290000
*                IF FORVAL >= MAXEXPDT                             1088 04291000
*                  THEN                                            1088 04292000
         L     @06,@PC00001+4                                      1088 04293000
         L     @06,FDTPTR+72(,@06)                                 1088 04294000
         L     @06,FORVAL(,@06)                                    1088 04295000
         C     @06,@CF01115                                        1088 04296000
         BL    @RF01088                                            1088 04297000
*                    EXPIRE = '99999F'X;                           1089 04298000
*                                                                  1089 04299000
         MVC   EXPIRE(3),@CB01498                                  1089 04300000
*                  /**************************************************/ 04301000
*                  /*                                                */ 04302000
*                  /* THE INCREMENT IS NOT WITHIN THE MAXIMUM RANGE  */ 04303000
*                  /* COMPUTE THE ACTUAL DATE                        */ 04304000
*                  /*                                                */ 04305000
*                  /**************************************************/ 04306000
*                                                                  1090 04307000
*                  ELSE                                            1090 04308000
*DAYFORLP:           DO;                                           1090 04309000
*                                                                  1090 04310000
         B     @RC01088                                            1090 04311000
@RF01088 DS    0H                                                  1090 04312000
DAYFORLP DS    0H                                                  1091 04313000
*                    DATELOOP = GO;                                1091 04314000
*                                                                  1091 04315000
         MVI   DATELOOP,X'00'                                      1091 04316000
*                    /************************************************/ 04317000
*                    /*                                              */ 04318000
*                    /* INVOKE UTIME MACRO TO GET CURRENT DATE       */ 04319000
*                    /*                                              */ 04320000
*                    /************************************************/ 04321000
*                                                                  1092 04322000
*                    CALL IDCSATI0 (GDTTBL,TIMEODAY,XCURDATE);     1092 04323000
*                                                                  1092 04324000
         L     @06,@PC00001                                        1092 04325000
         ST    @06,@AL00001                                        1092 04326000
         LA    @15,TIMEODAY                                        1092 04327000
         ST    @15,@AL00001+4                                      1092 04328000
         LA    @15,XCURDATE                                        1092 04329000
         ST    @15,@AL00001+8                                      1092 04330000
         MVI   @AL00001+8,X'80'                                    1092 04331000
         L     @15,GDTTIM(,@06)                                    1092 04332000
         LA    @01,@AL00001                                        1092 04333000
         BALR  @14,@15                                             1092 04334000
*                    RFY (REG5,REG6) RESTRICTED;           /*@Y30SSJH*/ 04335000
*                    DAYTOTL = ''B;                                1094 04336000
         XC    DAYTOTL(8),DAYTOTL                                  1094 04337000
*                    DAYTOTAL = XUTDAY;                            1095 04338000
         LH    @04,XUTDAY                                          1095 04339000
         STH   @04,DAYTOTAL                                        1095 04340000
*                    GEN(CVB  5,DAYTOTL);                          1096 04341000
         CVB  5,DAYTOTL                                                 04342000
*                    REG5 = REG5 + FORVAL;                         1097 04343000
         L     @04,@PC00001+4                                      1097 04344000
         L     @04,FDTPTR+72(,@04)                                 1097 04345000
         AL    REG5,FORVAL(,@04)                                   1097 04346000
*                    NOWYEAR = XUTYEAR;                            1098 04347000
*                                                                  1098 04348000
         SLR   @04,@04                                             1098 04349000
         IC    @04,XUTYEAR                                         1098 04350000
         STH   @04,NOWYEAR                                         1098 04351000
*                    /************************************************/ 04352000
*                    /*                                              */ 04353000
*                    /* LOOP THRU THE DAYTOTALS 1 YEAR AT A TIME -   */ 04354000
*                    /* BUMPING THE YEAR AS WE GO                    */ 04355000
*                    /*                                              */ 04356000
*                    /************************************************/ 04357000
*                                                                  1099 04358000
*YRDYLOOP:           DO N = 1 TO 6                                 1099 04359000
*                       WHILE DATELOOP = GO;                       1099 04360000
*                                                                  1099 04361000
YRDYLOOP LA    @04,1                                               1099 04362000
         ST    @04,N                                               1099 04363000
@DL01099 CLI   DATELOOP,X'00'                                      1099 04364000
         BNE   @DC01099                                            1099 04365000
*                      IF  (NOWYEAR  // 4) = 0                     1100 04366000
*                        THEN                                      1100 04367000
         LH    @00,NOWYEAR                                         1100 04368000
         SRDA  @00,32                                              1100 04369000
         D     @00,@CF00044                                        1100 04370000
         LTR   @00,@00                                             1100 04371000
         BNZ   @RF01100                                            1100 04372000
*                          DAYPERYR = NOLEAPYR;                    1101 04373000
*                                                                  1101 04374000
         MVC   DAYPERYR(2),@CH01113                                1101 04375000
*                        ELSE                                      1102 04376000
*                          DAYPERYR = NOLEAPYR;                    1102 04377000
*                                                                  1102 04378000
         B     @RC01100                                            1102 04379000
@RF01100 MVC   DAYPERYR(2),@CH01113                                1102 04380000
*                      IF (REG5 - DAYPERYR) > 0                    1103 04381000
*                        THEN                                      1103 04382000
@RC01100 LH    @04,DAYPERYR                                        1103 04383000
         LR    @15,REG5                                            1103 04384000
         SLR   @15,@04                                             1103 04385000
         LTR   @15,@15                                             1103 04386000
         BNP   @RF01103                                            1103 04387000
*                          DO;                                     1104 04388000
*                                                                  1104 04389000
*                          REG5 = REG5 - DAYPERYR;                 1105 04390000
         SLR   REG5,@04                                            1105 04391000
*                          NOWYEAR = NOWYEAR + 1;                  1106 04392000
*                                                                  1106 04393000
         LH    @04,NOWYEAR                                         1106 04394000
         LA    @04,1(,@04)                                         1106 04395000
         STH   @04,NOWYEAR                                         1106 04396000
*                          END;                                    1107 04397000
*                                                                  1107 04398000
*                        ELSE                                      1108 04399000
*                          DATELOOP = STOP;                        1108 04400000
*                                                                  1108 04401000
         B     @RC01103                                            1108 04402000
@RF01103 MVI   DATELOOP,X'0F'                                      1108 04403000
*                    END YRDYLOOP;                                 1109 04404000
*                                                                  1109 04405000
@RC01103 LA    @04,1                                               1109 04406000
         AL    @04,N                                               1109 04407000
         ST    @04,N                                               1109 04408000
         C     @04,@CF00158                                        1109 04409000
         BNH   @DL01099                                            1109 04410000
@DC01099 DS    0H                                                  1110 04411000
*                    EXPIRYR = NOWYEAR;                            1110 04412000
         LH    @04,NOWYEAR                                         1110 04413000
         STC   @04,EXPIRYR                                         1110 04414000
*                    GEN(CVD 5,DAYTOTL);                           1111 04415000
         CVD 5,DAYTOTL                                                  04416000
*                    EXPIRDAY = DAYTOTAL;                          1112 04417000
         LH    @04,DAYTOTAL                                        1112 04418000
         STH   @04,EXPIRDAY                                        1112 04419000
*                    RFY (REG5,REG6) UNRESTRICTED;                 1113 04420000
*                                                                  1113 04421000
*                    END DAYFORLP;                                 1114 04422000
*                                                                  1114 04423000
*                END FORLOOP;                                      1115 04424000
*                                                                  1115 04425000
@RC01088 DS    0H                                                  1116 04426000
*        /************************************************************/ 04427000
*        /*                                                          */ 04428000
*        /* A NEW EXPIRATION DATE HAS BEEN COMPUTED BUILD THE FPL    */ 04429000
*        /*                                                          */ 04430000
*        /************************************************************/ 04431000
*                                                                  1116 04432000
*        IF CTGFVEXP ^= NULLPTR                                    1116 04433000
*          THEN                                                    1116 04434000
@RF01085 DS    0H                                                  1116 04435000
@RC01076 L     @06,CTGPLPTR                                        1116 04436000
         L     @06,CTGFVT(,@06)                                    1116 04437000
         L     @06,CTGFVEXP(,@06)                                  1116 04438000
         LTR   @06,@06                                             1116 04439000
         BZ    @RF01116                                            1116 04440000
*            DO;                                                   1117 04441000
*                                                                  1117 04442000
*            CTGFLPTR = CTGFVEXP;                                  1118 04443000
         ST    @06,CTGFLPTR                                        1118 04444000
*            CTGFLNG(1) = 3;                                       1119 04445000
         MVC   CTGFLNG(4,@06),@CF00164                             1119 04446000
*            CTGFLPT(1) = ADDR(EXPIRE);                            1120 04447000
*                                                                  1120 04448000
         LA    @15,EXPIRE                                          1120 04449000
         ST    @15,CTGFLPT(,@06)                                   1120 04450000
*            END;                                                  1121 04451000
*                                                                  1121 04452000
*        /************************************************************/ 04453000
*        /*                                                          */ 04454000
*        /* ALTER OR NULLIFY THE OWNER ID                            */ 04455000
*        /*                                                          */ 04456000
*        /************************************************************/ 04457000
*                                                                  1122 04458000
*        IF (ADDR(OWNER)) ^= NULLPTR   |                           1122 04459000
*           (ADDR(NOWNR)) ^= NULLPTR                               1122 04460000
*          THEN                                                    1122 04461000
@RF01116 SLR   @06,@06                                             1122 04462000
         L     @15,@PC00001+4                                      1122 04463000
         C     @06,FDTPTR+76(,@15)                                 1122 04464000
         BNE   @RT01122                                            1122 04465000
         C     @06,FDTPTR+164(,@15)                                1122 04466000
         BE    @RF01122                                            1122 04467000
@RT01122 DS    0H                                                  1123 04468000
*            DO;                                                   1123 04469000
*                                                                  1123 04470000
*            CTGFLPTR = ADDR(ALFPLOWN);                            1124 04471000
         L     @06,ALPRMPTR                                        1124 04472000
         LA    @15,ALFPLOWN(,@06)                                  1124 04473000
         ST    @15,CTGFLPTR                                        1124 04474000
*            ALOWN = 'OWNR';                                       1125 04475000
         MVC   ALOWN(4,@06),@CC01503                               1125 04476000
*            CTGFLNG(1) = 8;                                       1126 04477000
         MVC   CTGFLNG(4,@15),@CF00039                             1126 04478000
*            CTGFVOWN = CTGFLPTR;                                  1127 04479000
*                                                                  1127 04480000
         L     @06,CTGPLPTR                                        1127 04481000
         L     @06,CTGFVT(,@06)                                    1127 04482000
         ST    @15,CTGFVOWN(,@06)                                  1127 04483000
*            /********************************************************/ 04484000
*            /*                                                      */ 04485000
*            /* SET FPL POINTER TO NULLVALUE OR NEW OWNER ID         */ 04486000
*            /*                                                      */ 04487000
*            /********************************************************/ 04488000
*                                                                  1128 04489000
*            IF (ADDR(NOWNR)) ^= NULLPTR                           1128 04490000
*              THEN                                                1128 04491000
         L     @06,@PC00001+4                                      1128 04492000
         L     @06,FDTPTR+164(,@06)                                1128 04493000
         LTR   @06,@06                                             1128 04494000
         BZ    @RF01128                                            1128 04495000
*                CTGFLPT(1) = ADDR(NULLMASK);                      1129 04496000
*                                                                  1129 04497000
         LA    @06,NULLMASK                                        1129 04498000
         ST    @06,CTGFLPT(,@15)                                   1129 04499000
*            IF (ADDR(OWNER)) ^= NULLPTR                           1130 04500000
*              THEN                                                1130 04501000
@RF01128 L     @06,@PC00001+4                                      1130 04502000
         L     @06,FDTPTR+76(,@06)                                 1130 04503000
         LTR   @06,@06                                             1130 04504000
         BZ    @RF01130                                            1130 04505000
*                CTGFLPT(1) = ADDR(OWNERVAL);                      1131 04506000
*                                                                  1131 04507000
         LA    @06,OWNERVAL(,@06)                                  1131 04508000
         L     @01,CTGFLPTR                                        1131 04509000
         ST    @06,CTGFLPT(,@01)                                   1131 04510000
*            END;                                                  1132 04511000
*                                                                  1132 04512000
@RF01130 DS    0H                                                  1133 04513000
*        /************************************************************/ 04514000
*        /*                                                  @Y30SSJH*/ 04515000
*        /* ALTER OR NULLIFY THE EXCEPTIONEXIT NAME          @Y30SSJH*/ 04516000
*        /*                                                  @Y30SSJH*/ 04517000
*        /************************************************************/ 04518000
*                                                                  1133 04519000
*        IF (ADDR(EEXT))  ^= NULLPTR |                             1133 04520000
*           (ADDR(NEEXT)) ^= NULLPTR                               1133 04521000
*          THEN                                                    1133 04522000
@RF01122 SLR   @06,@06                                             1133 04523000
         L     @15,@PC00001+4                                      1133 04524000
         C     @06,FDTPTR+216(,@15)                                1133 04525000
         BNE   @RT01133                                            1133 04526000
         C     @06,FDTPTR+268(,@15)                                1133 04527000
         BE    @RF01133                                            1133 04528000
@RT01133 DS    0H                                                  1134 04529000
*            DO;                                           /*@Y30SSJH*/ 04530000
*                                                                  1134 04531000
*            CTGFLPTR = ADDR(ALFPLEEX);                    /*@Y30SSJH*/ 04532000
         L     @06,ALPRMPTR                                        1135 04533000
         LA    @15,ALFPLEEX(,@06)                                  1135 04534000
         ST    @15,CTGFLPTR                                        1135 04535000
*            ALEEX = 'EEXT';                               /*@Y30SSJH*/ 04536000
         MVC   ALEEX(4,@06),@CC01504                               1136 04537000
*            CTGFLNG(1) = 8;                               /*@Y30SSJH*/ 04538000
         MVC   CTGFLNG(4,@15),@CF00039                             1137 04539000
*            CTGFVEXT = CTGFLPTR;                          /*@Y30SSJH*/ 04540000
*                                                                  1138 04541000
         L     @06,CTGPLPTR                                        1138 04542000
         L     @06,CTGFVT(,@06)                                    1138 04543000
         ST    @15,CTGFVEXT(,@06)                                  1138 04544000
*            /********************************************************/ 04545000
*            /*                                              @Y30SSJH*/ 04546000
*            /* SET FPL POINTER TO NULL VALUE OR NEW         @Y30SSJH*/ 04547000
*            /* EXCEPTIONEXIT NAME                           @Y30SSJH*/ 04548000
*            /*                                              @Y30SSJH*/ 04549000
*            /********************************************************/ 04550000
*                                                                  1139 04551000
*            IF (ADDR(NEEXT)) ^= NULLPTR                           1139 04552000
*              THEN                                                1139 04553000
         L     @06,@PC00001+4                                      1139 04554000
         L     @06,FDTPTR+268(,@06)                                1139 04555000
         LTR   @06,@06                                             1139 04556000
         BZ    @RF01139                                            1139 04557000
*                CTGFLPT(1) = ADDR(NULLMASK);              /*@Y30SSJH*/ 04558000
*                                                                  1140 04559000
         LA    @06,NULLMASK                                        1140 04560000
         ST    @06,CTGFLPT(,@15)                                   1140 04561000
*            IF (ADDR(EEXT)) ^= NULLPTR                            1141 04562000
*              THEN                                                1141 04563000
@RF01139 L     @06,@PC00001+4                                      1141 04564000
         L     @06,FDTPTR+216(,@06)                                1141 04565000
         LTR   @06,@06                                             1141 04566000
         BZ    @RF01141                                            1141 04567000
*                CTGFLPT(1) = ADDR(EEXTVAL);               /*@Y30SSJH*/ 04568000
*                                                                  1142 04569000
         LA    @06,EEXTVAL(,@06)                                   1142 04570000
         L     @01,CTGFLPTR                                        1142 04571000
         ST    @06,CTGFLPT(,@01)                                   1142 04572000
*            END;                                          /*@Y30SSJH*/ 04573000
@RF01141 DS    0H                                                  1144 04574000
*        /************************************************************/ 04575000
*        /*                                                          */ 04576000
*        /* ALTER THE DATA SET ATTRIBUTES                            */ 04577000
*        /*                                                          */ 04578000
*        /************************************************************/ 04579000
*                                                                  1144 04580000
*        IF LCDATRPT ^= NULLPTR                                    1144 04581000
*          THEN                                                    1144 04582000
@RF01133 L     @06,LCDATRPT                                        1144 04583000
         SLR   @15,@15                                             1144 04584000
         CR    @06,@15                                             1144 04585000
         BE    @RF01144                                            1144 04586000
*            DO;                                                   1145 04587000
*                                                                  1145 04588000
*            IF (ADDR(ERASE)) ^= NULLPTR    /* ERASE OPTION          */ 04589000
*              THEN                                                1146 04590000
         L     @14,@PC00001+4                                      1146 04591000
         C     @15,FDTPTR+80(,@14)                                 1146 04592000
         BE    @RF01146                                            1146 04593000
*                DO;                                               1147 04594000
*                                                                  1147 04595000
*                CTGFVATR = ADDR(ALFPLDAT);                        1148 04596000
         L     @01,CTGPLPTR                                        1148 04597000
         L     @01,CTGFVT(,@01)                                    1148 04598000
         L     @15,ALPRMPTR                                        1148 04599000
         LA    @00,ALFPLDAT(,@15)                                  1148 04600000
         ST    @00,CTGFVATR(,@01)                                  1148 04601000
*                LCERASE = ON;                                     1149 04602000
*                                                                  1149 04603000
         OI    LCERASE(@06),B'00010000'                            1149 04604000
*                END;                                              1150 04605000
*                                                                  1150 04606000
*              ELSE                                                1151 04607000
*                IF (ADDR(NERAS)) ^= NULLPTR /* NOREASE OPTION       */ 04608000
*                  THEN                                            1151 04609000
         B     @RC01146                                            1151 04610000
@RF01146 L     @06,@PC00001+4                                      1151 04611000
         L     @06,FDTPTR+84(,@06)                                 1151 04612000
         LTR   @06,@06                                             1151 04613000
         BZ    @RF01151                                            1151 04614000
*                    DO;                                           1152 04615000
*                                                                  1152 04616000
*                    CTGFVATR = ADDR(ALFPLDAT);                    1153 04617000
         L     @06,CTGPLPTR                                        1153 04618000
         L     @06,CTGFVT(,@06)                                    1153 04619000
         L     @01,ALPRMPTR                                        1153 04620000
         LA    @15,ALFPLDAT(,@01)                                  1153 04621000
         ST    @15,CTGFVATR(,@06)                                  1153 04622000
*                    LCERASE = OFF;                                1154 04623000
*                                                                  1154 04624000
         L     @06,LCDATRPT                                        1154 04625000
         NI    LCERASE(@06),B'11101111'                            1154 04626000
*                    END;                                          1155 04627000
*                                                                  1155 04628000
*            /********************************************************/ 04629000
*            /*                                                      */ 04630000
*            /* ALTER THE SHARE OPTIONS                              */ 04631000
*            /*                                                      */ 04632000
*            /********************************************************/ 04633000
*            IF (ADDR(SHAR1)) ^= NULLPTR                           1156 04634000
*              THEN                                                1156 04635000
@RF01151 DS    0H                                                  1156 04636000
@RC01146 L     @06,@PC00001+4                                      1156 04637000
         L     @06,FDTPTR+188(,@06)                                1156 04638000
         LTR   @06,@06                                             1156 04639000
         BZ    @RF01156                                            1156 04640000
*ALTSHARE:       DO;                                               1157 04641000
*                                                                  1157 04642000
ALTSHARE DS    0H                                                  1158 04643000
*                CTGFVATR = ADDR(ALFPLDAT);                        1158 04644000
*                                                                  1158 04645000
         L     @06,CTGPLPTR                                        1158 04646000
         L     @06,CTGFVT(,@06)                                    1158 04647000
         L     @01,ALPRMPTR                                        1158 04648000
         LA    @15,ALFPLDAT(,@01)                                  1158 04649000
         ST    @15,CTGFVATR(,@06)                                  1158 04650000
*                /****************************************************/ 04651000
*                /*                                                  */ 04652000
*                /* ALTER CROSS REGION SHARE OPTIONS                 */ 04653000
*                /*                                                  */ 04654000
*                /****************************************************/ 04655000
*                IF SHAR1VAL = 1                                   1159 04656000
*                  THEN                                            1159 04657000
         L     @06,@PC00001+4                                      1159 04658000
         L     @06,FDTPTR+188(,@06)                                1159 04659000
         CLC   SHAR1VAL(4,@06),@CF00220                            1159 04660000
         BNE   @RF01159                                            1159 04661000
*                    SHAROPT1 = SHROPT1;                           1160 04662000
*                                                                  1160 04663000
         L     @06,LCDATRPT                                        1160 04664000
         NI    SHAROPT1(@06),B'00111111'                           1160 04665000
*                  ELSE                                            1161 04666000
*                    IF SHAR1VAL = 2                               1161 04667000
*                      THEN                                        1161 04668000
         B     @RC01159                                            1161 04669000
@RF01159 L     @06,@PC00001+4                                      1161 04670000
         L     @06,FDTPTR+188(,@06)                                1161 04671000
         CLC   SHAR1VAL(4,@06),@CF00155                            1161 04672000
         BNE   @RF01161                                            1161 04673000
*                        SHAROPT1 = SHROPT2;                       1162 04674000
*                                                                  1162 04675000
         L     @06,LCDATRPT                                        1162 04676000
         NI    SHAROPT1(@06),B'01111111'                           1162 04677000
         OI    SHAROPT1(@06),B'01000000'                           1162 04678000
*                      ELSE                                        1163 04679000
*                        IF SHAR1VAL = 3                           1163 04680000
*                          THEN                                    1163 04681000
         B     @RC01161                                            1163 04682000
@RF01161 L     @06,@PC00001+4                                      1163 04683000
         L     @06,FDTPTR+188(,@06)                                1163 04684000
         CLC   SHAR1VAL(4,@06),@CF00164                            1163 04685000
         BNE   @RF01163                                            1163 04686000
*                            SHAROPT1 = SHROPT3;                   1164 04687000
*                                                                  1164 04688000
         L     @06,LCDATRPT                                        1164 04689000
         NI    SHAROPT1(@06),B'10111111'                           1164 04690000
         OI    SHAROPT1(@06),B'10000000'                           1164 04691000
*                          ELSE                                    1165 04692000
*                            IF SHAR1VAL = 4                       1165 04693000
*                            THEN                                  1165 04694000
         B     @RC01163                                            1165 04695000
@RF01163 L     @06,@PC00001+4                                      1165 04696000
         L     @06,FDTPTR+188(,@06)                                1165 04697000
         CLC   SHAR1VAL(4,@06),@CF00044                            1165 04698000
         BNE   @RF01165                                            1165 04699000
*                            SHAROPT1 = SHROPT4;                   1166 04700000
*                                                                  1166 04701000
         L     @06,LCDATRPT                                        1166 04702000
         OI    SHAROPT1(@06),B'11000000'                           1166 04703000
*                            ELSE;                                 1167 04704000
*                                                                  1167 04705000
@RF01165 DS    0H                                                  1168 04706000
*                /****************************************************/ 04707000
*                /*                                                  */ 04708000
*                /* ALTER THE CROSS SYSTEM SHARE OPTIONS             */ 04709000
*                /*                                                  */ 04710000
*                /****************************************************/ 04711000
*                IF (ADDR(SHAR2)) ^= NULLPTR                       1168 04712000
*                  THEN                                            1168 04713000
@RC01163 DS    0H                                                  1168 04714000
@RC01161 DS    0H                                                  1168 04715000
@RC01159 L     @06,@PC00001+4                                      1168 04716000
         L     @06,FDTPTR+192(,@06)                                1168 04717000
         LTR   @06,@06                                             1168 04718000
         BZ    @RF01168                                            1168 04719000
*                    DO;                                           1169 04720000
*                                                                  1169 04721000
*                    IF SHAR2VAL = 3                               1170 04722000
*                      THEN                                        1170 04723000
         CLC   SHAR2VAL(4,@06),@CF00164                            1170 04724000
         BNE   @RF01170                                            1170 04725000
*                        SHAROPT2 = SHROPT3;                       1171 04726000
*                                                                  1171 04727000
         L     @06,LCDATRPT                                        1171 04728000
         NI    SHAROPT2(@06),B'11101111'                           1171 04729000
         OI    SHAROPT2(@06),B'00100000'                           1171 04730000
*                      ELSE                                        1172 04731000
*                        IF SHAR2VAL = 4                           1172 04732000
*                          THEN                                    1172 04733000
         B     @RC01170                                            1172 04734000
@RF01170 L     @06,@PC00001+4                                      1172 04735000
         L     @06,FDTPTR+192(,@06)                                1172 04736000
         CLC   SHAR2VAL(4,@06),@CF00044                            1172 04737000
         BNE   @RF01172                                            1172 04738000
*                            SHAROPT2 = SHROPT4;                   1173 04739000
*                                                                  1173 04740000
         L     @06,LCDATRPT                                        1173 04741000
         OI    SHAROPT2(@06),B'00110000'                           1173 04742000
*                          ELSE;                                   1174 04743000
*                                                                  1174 04744000
@RF01172 DS    0H                                                  1175 04745000
*                    END;                                          1175 04746000
*                                                                  1175 04747000
@RC01170 DS    0H                                                  1176 04748000
*                END ALTSHARE;                                     1176 04749000
*                                                                  1176 04750000
@RF01168 DS    0H                                                  1177 04751000
*            IF (ADDR(UNHIB)) ^= NULLPTR                           1177 04752000
*              THEN                                                1177 04753000
@RF01156 L     @06,@PC00001+4                                      1177 04754000
         L     @06,FDTPTR+160(,@06)                                1177 04755000
         LTR   @06,@06                                             1177 04756000
         BZ    @RF01177                                            1177 04757000
*                DO;                                               1178 04758000
*                                                                  1178 04759000
*                CTGFVATR = ADDR(ALFPLDAT);                        1179 04760000
         L     @06,CTGPLPTR                                        1179 04761000
         L     @06,CTGFVT(,@06)                                    1179 04762000
         L     @01,ALPRMPTR                                        1179 04763000
         LA    @15,ALFPLDAT(,@01)                                  1179 04764000
         ST    @15,CTGFVATR(,@06)                                  1179 04765000
*                LCINHIB = OFF;                                    1180 04766000
*                                                                  1180 04767000
         L     @06,LCDATRPT                                        1180 04768000
         NI    LCINHIB(@06),B'11111011'                            1180 04769000
*                END;                                              1181 04770000
*                                                                  1181 04771000
*              ELSE                                                1182 04772000
*                IF (ADDR(INHIB)) ^= NULLPTR                       1182 04773000
*                  THEN                                            1182 04774000
         B     @RC01177                                            1182 04775000
@RF01177 L     @06,@PC00001+4                                      1182 04776000
         L     @06,FDTPTR+156(,@06)                                1182 04777000
         LTR   @06,@06                                             1182 04778000
         BZ    @RF01182                                            1182 04779000
*                    DO;                                           1183 04780000
*                                                                  1183 04781000
*                    CTGFVATR = ADDR(ALFPLDAT);                    1184 04782000
         L     @06,CTGPLPTR                                        1184 04783000
         L     @06,CTGFVT(,@06)                                    1184 04784000
         L     @01,ALPRMPTR                                        1184 04785000
         LA    @15,ALFPLDAT(,@01)                                  1184 04786000
         ST    @15,CTGFVATR(,@06)                                  1184 04787000
*                    LCINHIB  = ON;                                1185 04788000
*                                                                  1185 04789000
         L     @06,LCDATRPT                                        1185 04790000
         OI    LCINHIB(@06),B'00000100'                            1185 04791000
*                    END;                                          1186 04792000
*            /********************************************************/ 04793000
*            /*                                                      */ 04794000
*            /* BUILD THE DSATTR FPL IN ALTERATIONS HAVE BEEN MADE   */ 04795000
*            /* THE INITIALIZATION OF CTGFVATR INDICATES CHANGES     */ 04796000
*            /*                                                      */ 04797000
*            /********************************************************/ 04798000
*                                                                  1187 04799000
*            IF CTGFVATR ^= NULLPTR                                1187 04800000
*              THEN                                                1187 04801000
@RF01182 DS    0H                                                  1187 04802000
@RC01177 L     @06,CTGPLPTR                                        1187 04803000
         L     @06,CTGFVT(,@06)                                    1187 04804000
         L     @06,CTGFVATR(,@06)                                  1187 04805000
         LTR   @06,@06                                             1187 04806000
         BZ    @RF01187                                            1187 04807000
*                DO;                                               1188 04808000
*                                                                  1188 04809000
*                CTGFLPTR = ADDR(ALFPLDAT);                        1189 04810000
         L     @06,ALPRMPTR                                        1189 04811000
         LA    @15,ALFPLDAT(,@06)                                  1189 04812000
         ST    @15,CTGFLPTR                                        1189 04813000
*                ALDAT = 'DSAT';                           /*@Y30SSJH*/ 04814000
         MVC   ALDAT(4,@06),@CC01449                               1190 04815000
*                CTGFLNG(1) = 2;                                   1191 04816000
         MVC   CTGFLNG(4,@15),@CF00155                             1191 04817000
*                CTGFLPT(1) = LCDATRPT;                            1192 04818000
*                                                                  1192 04819000
         L     @06,LCDATRPT                                        1192 04820000
         ST    @06,CTGFLPT(,@15)                                   1192 04821000
*                END;                                              1193 04822000
*                                                                  1193 04823000
*            END;                                                  1194 04824000
*                                                                  1194 04825000
@RF01187 DS    0H                                                  1195 04826000
*        /************************************************************/ 04827000
*        /*                                                  @Y30SSJH*/ 04828000
*        /* ALTER THE RG ATTRIBUTES                          @Y30SSJH*/ 04829000
*        /*                                                  @Y30SSJH*/ 04830000
*        /************************************************************/ 04831000
*                                                                  1195 04832000
*        ALRGATTR = ''B;                                   /*@Y30SSJH*/ 04833000
*                                                                  1195 04834000
@RF01144 XC    ALRGATTR(2),ALRGATTR                                1195 04835000
*        IF LCRATRPT ^= NULLPTR                                    1196 04836000
*          THEN                                                    1196 04837000
         L     @06,LCRATRPT                                        1196 04838000
         LTR   @06,@06                                             1196 04839000
         BZ    @RF01196                                            1196 04840000
*            ALRGATTR(1) = LCRGATTR;                       /*@Y30SSJH*/ 04841000
*                                                                  1197 04842000
         MVC   ALRGATTR(1),LCRGATTR(@06)                           1197 04843000
*        IF (ADDR(UPG))  ^= NULLPTR |                              1198 04844000
*           (ADDR(NUPG)) ^= NULLPTR |                              1198 04845000
*           (ADDR(UPD))  ^= NULLPTR |                              1198 04846000
*           (ADDR(NUPD)) ^= NULLPTR                                1198 04847000
*          THEN                                                    1198 04848000
@RF01196 SLR   @06,@06                                             1198 04849000
         L     @15,@PC00001+4                                      1198 04850000
         C     @06,FDTPTR+252(,@15)                                1198 04851000
         BNE   @RT01198                                            1198 04852000
         C     @06,FDTPTR+256(,@15)                                1198 04853000
         BNE   @RT01198                                            1198 04854000
         C     @06,FDTPTR+260(,@15)                                1198 04855000
         BNE   @RT01198                                            1198 04856000
         C     @06,FDTPTR+264(,@15)                                1198 04857000
         BE    @RF01198                                            1198 04858000
@RT01198 DS    0H                                                  1199 04859000
*            DO;                                           /*@Y30SSJH*/ 04860000
*                                                                  1199 04861000
*            CTGFVUPG = ADDR(ALFPLRGA);                    /*@Y30SSJH*/ 04862000
         L     @06,CTGPLPTR                                        1200 04863000
         L     @06,CTGFVT(,@06)                                    1200 04864000
         L     @01,ALPRMPTR                                        1200 04865000
         LA    @15,ALFPLRGA(,@01)                                  1200 04866000
         ST    @15,CTGFVUPG(,@06)                                  1200 04867000
*            ALUPSPEC = ON;                                /*@Y30SSJH*/ 04868000
*                                                                  1201 04869000
         OI    ALUPSPEC,B'10000000'                                1201 04870000
*            IF (ADDR(UPG)) ^= NULLPTR |                           1202 04871000
*               (ADDR(UPD)) ^= NULLPTR                             1202 04872000
*              THEN                                                1202 04873000
         SLR   @06,@06                                             1202 04874000
         L     @15,@PC00001+4                                      1202 04875000
         C     @06,FDTPTR+252(,@15)                                1202 04876000
         BNE   @RT01202                                            1202 04877000
         C     @06,FDTPTR+260(,@15)                                1202 04878000
         BE    @RF01202                                            1202 04879000
@RT01202 DS    0H                                                  1203 04880000
*                ALUPGUPD = ON;                            /*@Y30SSJH*/ 04881000
*                                                                  1203 04882000
         OI    ALUPGUPD,B'10000000'                                1203 04883000
*              ELSE                                                1204 04884000
*                ALUPGUPD = OFF;                           /*@Y30SSJH*/ 04885000
*                                                                  1204 04886000
         B     @RC01202                                            1204 04887000
@RF01202 NI    ALUPGUPD,B'01111111'                                1204 04888000
*              /******************************************************/ 04889000
*              /*                                            @Y30SSJH*/ 04890000
*              /* BUILD THE RGATTR FPL                       @Y30SSJH*/ 04891000
*              /*                                            @Y30SSJH*/ 04892000
*              /******************************************************/ 04893000
*                                                                  1205 04894000
*              CTGFLPTR = ADDR(ALFPLRGA);                  /*@Y30SSJH*/ 04895000
@RC01202 L     @06,ALPRMPTR                                        1205 04896000
         LA    @15,ALFPLRGA(,@06)                                  1205 04897000
         ST    @15,CTGFLPTR                                        1205 04898000
*              ALRGA = 'RGAT';                             /*@Y30SSJH*/ 04899000
         MVC   ALRGA(4,@06),@CC01452                               1206 04900000
*              CTGFLNG(1) = 2;                             /*@Y30SSJH*/ 04901000
         MVC   CTGFLNG(4,@15),@CF00155                             1207 04902000
*              CTGFLPT(1) = ADDR(ALRGATTR);                /*@Y30SSJH*/ 04903000
*                                                                  1208 04904000
         LA    @06,ALRGATTR                                        1208 04905000
         ST    @06,CTGFLPT(,@15)                                   1208 04906000
*              END;                                        /*@Y30SSJH*/ 04907000
*        /************************************************************/ 04908000
*        /*                                                  @Y30SSJH*/ 04909000
*        /* ALTER THE GDG ATTRIBUTES                         @Y30SSJH*/ 04910000
*        /*                                                  @Y30SSJH*/ 04911000
*        /************************************************************/ 04912000
*                                                                  1210 04913000
*        IF LCGATRPT ^= NULLPTR                                    1210 04914000
*          THEN                                                    1210 04915000
@RF01198 L     @06,LCGATRPT                                        1210 04916000
         SLR   @15,@15                                             1210 04917000
         CR    @06,@15                                             1210 04918000
         BE    @RF01210                                            1210 04919000
*            DO;                                           /*@Y30SSJH*/ 04920000
*                                                                  1211 04921000
*            IF (ADDR(GDGEM)) ^= NULLPTR    /* EMPTY OPTION  @Y30SSJH*/ 04922000
*              THEN                                                1212 04923000
         L     @14,@PC00001+4                                      1212 04924000
         C     @15,FDTPTR+196(,@14)                                1212 04925000
         BE    @RF01212                                            1212 04926000
*                DO;                                       /*@Y30SSJH*/ 04927000
*                                                                  1213 04928000
*                CTGFVGAT = LCGATRPT;                        /*YM6404*/ 04929000
         L     @01,CTGPLPTR                                        1214 04930000
         L     @01,CTGFVT(,@01)                                    1214 04931000
         ST    @06,CTGFVGAT(,@01)                                  1214 04932000
*                LCEMPTY = ON;                             /*@Y30SSJH*/ 04933000
*                                                                  1215 04934000
         OI    LCEMPTY(@06),B'10000000'                            1215 04935000
*                END;                                      /*@Y30SSJH*/ 04936000
*                                                                  1216 04937000
*              ELSE                                                1217 04938000
*                IF (ADDR(GDGNE)) ^= NULLPTR /* NOEMPTY OPTION       */ 04939000
*                  THEN                                            1217 04940000
         B     @RC01212                                            1217 04941000
@RF01212 L     @06,@PC00001+4                                      1217 04942000
         L     @06,FDTPTR+200(,@06)                                1217 04943000
         LTR   @06,@06                                             1217 04944000
         BZ    @RF01217                                            1217 04945000
*                    DO;                                   /*@Y30SSJH*/ 04946000
*                                                                  1218 04947000
*                    CTGFVGAT = LCGATRPT;                    /*YM6404*/ 04948000
         L     @06,LCGATRPT                                        1219 04949000
         L     @01,CTGPLPTR                                        1219 04950000
         L     @01,CTGFVT(,@01)                                    1219 04951000
         ST    @06,CTGFVGAT(,@01)                                  1219 04952000
*                    LCEMPTY = OFF;                        /*@Y30SSJH*/ 04953000
*                                                                  1220 04954000
         NI    LCEMPTY(@06),B'01111111'                            1220 04955000
*                    END;                                  /*@Y30SSJH*/ 04956000
*                                                                  1221 04957000
*            IF (ADDR(GDGNS)) ^= NULLPTR                           1222 04958000
*              THEN                                                1222 04959000
@RF01217 DS    0H                                                  1222 04960000
@RC01212 L     @06,@PC00001+4                                      1222 04961000
         L     @06,FDTPTR+208(,@06)                                1222 04962000
         LTR   @06,@06                                             1222 04963000
         BZ    @RF01222                                            1222 04964000
*                DO;                                       /*@YL026UA*/ 04965000
*                                                                  1223 04966000
*                CTGFVGAT = LCGATRPT;                        /*YM6404*/ 04967000
         L     @06,LCGATRPT                                        1224 04968000
         L     @01,CTGPLPTR                                        1224 04969000
         L     @01,CTGFVT(,@01)                                    1224 04970000
         ST    @06,CTGFVGAT(,@01)                                  1224 04971000
*                LCSCRTCH = OFF;                           /*@YL026UA*/ 04972000
*                                                                  1225 04973000
         NI    LCSCRTCH(@06),B'10111111'                           1225 04974000
*                END;                                      /*@YL026UA*/ 04975000
*                                                                  1226 04976000
*              ELSE                                                1227 04977000
*                IF (ADDR(GDGSC)) ^= NULLPTR                       1227 04978000
*                  THEN                                            1227 04979000
         B     @RC01222                                            1227 04980000
@RF01222 L     @06,@PC00001+4                                      1227 04981000
         L     @06,FDTPTR+204(,@06)                                1227 04982000
         LTR   @06,@06                                             1227 04983000
         BZ    @RF01227                                            1227 04984000
*                    DO;                                   /*@YL026UA*/ 04985000
*                                                                  1228 04986000
*                    CTGFVGAT = LCGATRPT;                    /*YM6404*/ 04987000
         L     @06,LCGATRPT                                        1229 04988000
         L     @01,CTGPLPTR                                        1229 04989000
         L     @01,CTGFVT(,@01)                                    1229 04990000
         ST    @06,CTGFVGAT(,@01)                                  1229 04991000
*                    LCSCRTCH  = ON;                       /*@YL026UA*/ 04992000
*                                                                  1230 04993000
         OI    LCSCRTCH(@06),B'01000000'                           1230 04994000
*                    END;                                  /*@YL026UA*/ 04995000
*                                                                  1231 04996000
*            END;                                          /*@YL026UA*/ 04997000
@RF01227 DS    0H                                                  1232 04998000
@RC01222 DS    0H                                                  1233 04999000
*        /************************************************************/ 05000000
*        /*                                                          */ 05001000
*        /* ALTER THE AMDSBCAT FIELD AS SPECIFIED                    */ 05002000
*        /*                                                          */ 05003000
*        /************************************************************/ 05004000
*                                                                  1233 05005000
*        IF LCAMDPT ^= NULLPTR                                     1233 05006000
*          THEN                                                    1233 05007000
@RF01210 L     @06,LCAMDPT                                         1233 05008000
         SLR   @15,@15                                             1233 05009000
         CR    @06,@15                                             1233 05010000
         BE    @RF01233                                            1233 05011000
*            DO;                                                   1234 05012000
*                                                                  1234 05013000
*            RFY IDAAMDSB BASED(LCAMDPT);                          1235 05014000
*                                                                  1235 05015000
*            /********************************************************/ 05016000
*            /*                                              @Y30LSJH*/ 05017000
*            /* ALTER THE SS/1 ATTRIBUTES                    @Y30LSJH*/ 05018000
*            /*                                              @Y30LSJH*/ 05019000
*            /********************************************************/ 05020000
*                                                                  1236 05021000
*            IF (ADDR(STAGE)) ^= NULLPTR                           1236 05022000
*              THEN                                                1236 05023000
         L     @14,@PC00001+4                                      1236 05024000
         C     @15,FDTPTR+272(,@14)                                1236 05025000
         BE    @RF01236                                            1236 05026000
*                DO;                                       /*@Y30LSJH*/ 05027000
*                                                                  1237 05028000
*                AMDFAULT = OFF;                           /*@Y30LSJH*/ 05029000
*                AMDBIND  = OFF;                           /*@Y30LSJH*/ 05030000
         NI    AMDFAULT(@06),B'10011111'                           1239 05031000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/ 05032000
*                                                                  1240 05033000
         L     @06,CTGPLPTR                                        1240 05034000
         L     @06,CTGFVT(,@06)                                    1240 05035000
         L     @01,ALPRMPTR                                        1240 05036000
         LA    @15,ALFPLAMD(,@01)                                  1240 05037000
         ST    @15,CTGFVAMD(,@06)                                  1240 05038000
*                END;                                      /*@Y30LSJH*/ 05039000
*                                                                  1241 05040000
*            IF (ADDR(BIND)) ^= NULLPTR                            1242 05041000
*              THEN                                                1242 05042000
@RF01236 L     @06,@PC00001+4                                      1242 05043000
         L     @06,FDTPTR+276(,@06)                                1242 05044000
         LTR   @06,@06                                             1242 05045000
         BZ    @RF01242                                            1242 05046000
*                DO;                                       /*@Y30LSJH*/ 05047000
*                                                                  1243 05048000
*                AMDFAULT = OFF;                           /*@Y30LSJH*/ 05049000
*                AMDBIND = ON;                             /*@Y30LSJH*/ 05050000
         L     @06,LCAMDPT                                         1245 05051000
         OI    AMDBIND(@06),B'00100000'                            1245 05052000
         NI    AMDFAULT(@06),B'10111111'                           1245 05053000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/ 05054000
*                                                                  1246 05055000
         L     @06,CTGPLPTR                                        1246 05056000
         L     @06,CTGFVT(,@06)                                    1246 05057000
         L     @01,ALPRMPTR                                        1246 05058000
         LA    @15,ALFPLAMD(,@01)                                  1246 05059000
         ST    @15,CTGFVAMD(,@06)                                  1246 05060000
*                END;                                      /*@Y30LSJH*/ 05061000
*                                                                  1247 05062000
*            IF (ADDR(CYLF)) ^= NULLPTR                            1248 05063000
*              THEN                                                1248 05064000
@RF01242 L     @06,@PC00001+4                                      1248 05065000
         L     @06,FDTPTR+280(,@06)                                1248 05066000
         LTR   @06,@06                                             1248 05067000
         BZ    @RF01248                                            1248 05068000
*                DO;                                       /*@Y30LSJH*/ 05069000
*                                                                  1249 05070000
*                AMDFAULT = ON;                            /*@Y30LSJH*/ 05071000
*                AMDBIND = OFF;                            /*@Y30LSJH*/ 05072000
         L     @06,LCAMDPT                                         1251 05073000
         OI    AMDFAULT(@06),B'01000000'                           1251 05074000
         NI    AMDBIND(@06),B'11011111'                            1251 05075000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/ 05076000
*                                                                  1252 05077000
         L     @06,CTGPLPTR                                        1252 05078000
         L     @06,CTGFVT(,@06)                                    1252 05079000
         L     @01,ALPRMPTR                                        1252 05080000
         LA    @15,ALFPLAMD(,@01)                                  1252 05081000
         ST    @15,CTGFVAMD(,@06)                                  1252 05082000
*                END;                                      /*@Y30LSJH*/ 05083000
*                                                                  1253 05084000
*            IF (ADDR(NSTGW)) ^= NULLPTR                           1254 05085000
*              THEN                                                1254 05086000
@RF01248 L     @06,@PC00001+4                                      1254 05087000
         L     @06,FDTPTR+284(,@06)                                1254 05088000
         LTR   @06,@06                                             1254 05089000
         BZ    @RF01254                                            1254 05090000
*                DO;                                       /*@Y30LSJH*/ 05091000
*                                                                  1255 05092000
*                AMDWAIT = OFF;                            /*@Y30LSJH*/ 05093000
         L     @06,LCAMDPT                                         1256 05094000
         NI    AMDWAIT(@06),B'11101111'                            1256 05095000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/ 05096000
*                                                                  1257 05097000
         L     @06,CTGPLPTR                                        1257 05098000
         L     @06,CTGFVT(,@06)                                    1257 05099000
         L     @01,ALPRMPTR                                        1257 05100000
         LA    @15,ALFPLAMD(,@01)                                  1257 05101000
         ST    @15,CTGFVAMD(,@06)                                  1257 05102000
*                END;                                      /*@Y30LSJH*/ 05103000
*                                                                  1258 05104000
*            IF (ADDR(STGW)) ^= NULLPTR                            1259 05105000
*              THEN                                                1259 05106000
@RF01254 L     @06,@PC00001+4                                      1259 05107000
         L     @06,FDTPTR+288(,@06)                                1259 05108000
         LTR   @06,@06                                             1259 05109000
         BZ    @RF01259                                            1259 05110000
*                DO;                                       /*@Y30LSJH*/ 05111000
*                                                                  1260 05112000
*                AMDWAIT = ON;                             /*@Y30LSJH*/ 05113000
         L     @06,LCAMDPT                                         1261 05114000
         OI    AMDWAIT(@06),B'00010000'                            1261 05115000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/ 05116000
*                                                                  1262 05117000
         L     @06,CTGPLPTR                                        1262 05118000
         L     @06,CTGFVT(,@06)                                    1262 05119000
         L     @01,ALPRMPTR                                        1262 05120000
         LA    @15,ALFPLAMD(,@01)                                  1262 05121000
         ST    @15,CTGFVAMD(,@06)                                  1262 05122000
*                END;                                      /*@Y30LSJH*/ 05123000
*                                                                  1263 05124000
*            /********************************************************/ 05125000
*            /*                                                      */ 05126000
*            /* ALTER CI AND CA FREESPACE PERCENTAGES                */ 05127000
*            /*                                                      */ 05128000
*            /********************************************************/ 05129000
*                                                                  1264 05130000
*            IF (ADDR(FSPCI)) ^= NULLPTR                           1264 05131000
*              THEN                                                1264 05132000
@RF01259 SLR   @06,@06                                             1264 05133000
         L     @15,@PC00001+4                                      1264 05134000
         L     @14,FDTPTR+124(,@15)                                1264 05135000
         CR    @14,@06                                             1264 05136000
         BE    @RF01264                                            1264 05137000
*                DO;                                               1265 05138000
*                                                                  1265 05139000
*                CTGFVAMD = ADDR(ALFPLAMD);                        1266 05140000
         L     @01,CTGPLPTR                                        1266 05141000
         L     @01,CTGFVT(,@01)                                    1266 05142000
         L     @05,ALPRMPTR                                        1266 05143000
         LA    @00,ALFPLAMD(,@05)                                  1266 05144000
         ST    @00,CTGFVAMD(,@01)                                  1266 05145000
*                AMDPCTCI = FSPCIVAL;                              1267 05146000
         L     @05,LCAMDPT                                         1267 05147000
         L     @04,FSPCIVAL(,@14)                                  1267 05148000
         STC   @04,AMDPCTCI(,@05)                                  1267 05149000
*                AMDFSCI = (AMDCINV * AMDPCTCI) / PCT100;  /*@OZ05907*/ 05150000
*                                                                  1268 05151000
         LA    @14,100                                             1268 05152000
         LR    @01,@04                                             1268 05153000
         M     @00,AMDCINV(,@05)                                   1268 05154000
         DR    @00,@14                                             1268 05155000
         ST    @01,AMDFSCI(,@05)                                   1268 05156000
*                IF (ADDR(FSPCA)) ^= NULLPTR                       1269 05157000
*                  THEN                                            1269 05158000
         L     @15,FDTPTR+128(,@15)                                1269 05159000
         CR    @15,@06                                             1269 05160000
         BE    @RF01269                                            1269 05161000
*                    DO;                                           1270 05162000
*                      AMDPCTCA = FSPCAVAL;                        1271 05163000
         L     @06,FSPCAVAL(,@15)                                  1271 05164000
         STC   @06,AMDPCTCA(,@05)                                  1271 05165000
*                      AMDFSCA = (AMDPCTCA * AMDCIPCA) / PCT100;   1272 05166000
         LR    @01,@06                                             1272 05167000
         LH    @06,AMDCIPCA(,@05)                                  1272 05168000
         MR    @00,@06                                             1272 05169000
         DR    @00,@14                                             1272 05170000
         STH   @01,AMDFSCA(,@05)                                   1272 05171000
*                    END;                                  /*@OZ05907*/ 05172000
*                END;                                              1274 05173000
*                                                                  1274 05174000
@RF01269 DS    0H                                                  1275 05175000
*            /********************************************************/ 05176000
*            /*                                                      */ 05177000
*            /* ALTER THE WRITECHECK/NOWRITECHECK OPTION             */ 05178000
*            /*                                                      */ 05179000
*            /********************************************************/ 05180000
*                                                                  1275 05181000
*            IF (ADDR(WRTCK)) ^= NULLPTR                           1275 05182000
*              THEN                                                1275 05183000
@RF01264 L     @06,@PC00001+4                                      1275 05184000
         L     @06,FDTPTR+132(,@06)                                1275 05185000
         LTR   @06,@06                                             1275 05186000
         BZ    @RF01275                                            1275 05187000
*                DO;                                               1276 05188000
*                                                                  1276 05189000
*                CTGFVAMD = ADDR(ALFPLAMD);                        1277 05190000
         L     @06,CTGPLPTR                                        1277 05191000
         L     @06,CTGFVT(,@06)                                    1277 05192000
         L     @01,ALPRMPTR                                        1277 05193000
         LA    @15,ALFPLAMD(,@01)                                  1277 05194000
         ST    @15,CTGFVAMD(,@06)                                  1277 05195000
*                AMDWCK = ON;                                      1278 05196000
*                                                                  1278 05197000
         L     @06,LCAMDPT                                         1278 05198000
         OI    AMDWCK(@06),B'01000000'                             1278 05199000
*                END;                                              1279 05200000
*                                                                  1279 05201000
*              ELSE                                                1280 05202000
*                IF(ADDR(NWTCK)) ^= NULLPTR                        1280 05203000
*                  THEN                                            1280 05204000
         B     @RC01275                                            1280 05205000
@RF01275 L     @06,@PC00001+4                                      1280 05206000
         L     @06,FDTPTR+136(,@06)                                1280 05207000
         LTR   @06,@06                                             1280 05208000
         BZ    @RF01280                                            1280 05209000
*                    DO;                                           1281 05210000
*                                                                  1281 05211000
*                    CTGFVAMD = ADDR(ALFPLAMD);                    1282 05212000
         L     @06,CTGPLPTR                                        1282 05213000
         L     @06,CTGFVT(,@06)                                    1282 05214000
         L     @01,ALPRMPTR                                        1282 05215000
         LA    @15,ALFPLAMD(,@01)                                  1282 05216000
         ST    @15,CTGFVAMD(,@06)                                  1282 05217000
*                    AMDWCK = OFF;                                 1283 05218000
*                                                                  1283 05219000
         L     @06,LCAMDPT                                         1283 05220000
         NI    AMDWCK(@06),B'10111111'                             1283 05221000
*                    END;                                          1284 05222000
*                                                                  1284 05223000
*            /********************************************************/ 05224000
*            /*                                              @Y30SSJH*/ 05225000
*            /* ALTER THE UNIQUEKEY/NONUNIQUEKEY OPTION      @Y30SSJH*/ 05226000
*            /*                                              @Y30SSJH*/ 05227000
*            /********************************************************/ 05228000
*                                                                  1285 05229000
*            IF (ADDR(UNQK)) ^= NULLPTR                            1285 05230000
*              THEN                                                1285 05231000
@RF01280 DS    0H                                                  1285 05232000
@RC01275 L     @06,@PC00001+4                                      1285 05233000
         L     @06,FDTPTR+244(,@06)                                1285 05234000
         LTR   @06,@06                                             1285 05235000
         BZ    @RF01285                                            1285 05236000
*                DO;                                       /*@Y30SSJH*/ 05237000
*                                                                  1286 05238000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30SSJH*/ 05239000
         L     @06,CTGPLPTR                                        1287 05240000
         L     @06,CTGFVT(,@06)                                    1287 05241000
         L     @01,ALPRMPTR                                        1287 05242000
         LA    @15,ALFPLAMD(,@01)                                  1287 05243000
         ST    @15,CTGFVAMD(,@06)                                  1287 05244000
*                AMDUNQ = OFF;                             /*@Y30SSJH*/ 05245000
*                                                                  1288 05246000
         L     @06,LCAMDPT                                         1288 05247000
         NI    AMDUNQ(@06),B'01111111'                             1288 05248000
*                END;                                      /*@Y30SSJH*/ 05249000
*                                                                  1289 05250000
*              ELSE                                                1290 05251000
*                IF (ADDR(NUNQK)) ^= NULLPTR                       1290 05252000
*                  THEN                                            1290 05253000
         B     @RC01285                                            1290 05254000
@RF01285 L     @06,@PC00001+4                                      1290 05255000
         L     @06,FDTPTR+248(,@06)                                1290 05256000
         LTR   @06,@06                                             1290 05257000
         BZ    @RF01290                                            1290 05258000
*                    DO;                                   /*@Y30SSJH*/ 05259000
*                                                                  1291 05260000
*                    CTGFVAMD = ADDR(ALFPLAMD);            /*@Y30SSJH*/ 05261000
         L     @06,CTGPLPTR                                        1292 05262000
         L     @06,CTGFVT(,@06)                                    1292 05263000
         L     @01,ALPRMPTR                                        1292 05264000
         LA    @15,ALFPLAMD(,@01)                                  1292 05265000
         ST    @15,CTGFVAMD(,@06)                                  1292 05266000
*                    AMDUNQ = ON;                          /*@Y30SSJH*/ 05267000
*                                                                  1293 05268000
         L     @06,LCAMDPT                                         1293 05269000
         OI    AMDUNQ(@06),B'10000000'                             1293 05270000
*                    END;                                  /*@Y30SSJH*/ 05271000
*                                                                  1294 05272000
*            /********************************************************/ 05273000
*            /*                                              @Y30SSJH*/ 05274000
*            /* ALTER THE KEY POSITION AND LENGTH            @Y30SSJH*/ 05275000
*            /*                                              @Y30SSJH*/ 05276000
*            /********************************************************/ 05277000
*                                                                  1295 05278000
*            IF (ADDR(KEY)) ^= NULLPTR   &                         1295 05279000
*                KEYRECRC = 0                                      1295 05280000
*              THEN                                                1295 05281000
@RF01290 DS    0H                                                  1295 05282000
@RC01285 SLR   @06,@06                                             1295 05283000
         L     @15,@PC00001+4                                      1295 05284000
         C     @06,FDTPTR+220(,@15)                                1295 05285000
         BE    @RF01295                                            1295 05286000
         C     @06,KEYRECRC                                        1295 05287000
         BNE   @RF01295                                            1295 05288000
*                DO;                                       /*@Y30SSJH*/ 05289000
*                                                                  1296 05290000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30SSJH*/ 05291000
         L     @06,CTGPLPTR                                        1297 05292000
         L     @06,CTGFVT(,@06)                                    1297 05293000
         L     @01,ALPRMPTR                                        1297 05294000
         LA    @14,ALFPLAMD(,@01)                                  1297 05295000
         ST    @14,CTGFVAMD(,@06)                                  1297 05296000
*                IF CKTYPE ^= 'G'                                  1298 05297000
*                  THEN                                            1298 05298000
         CLI   CKTYPE,C'G'                                         1298 05299000
         BE    @RF01298                                            1298 05300000
*                    DO;                                   /*@Y30SSJH*/ 05301000
*                                                                  1299 05302000
*                    AMDRKP = KEYPSVAL;                    /*@Y30SSJH*/ 05303000
         L     @06,FDTPTR+228(,@15)                                1300 05304000
         L     @06,KEYPSVAL(,@06)                                  1300 05305000
         L     @01,LCAMDPT                                         1300 05306000
         STH   @06,AMDRKP(,@01)                                    1300 05307000
*                    IXAMDPT -> AMDRKP = KEYPSVAL;         /*@Y30SSJH*/ 05308000
*                                                                  1301 05309000
         L     @01,IXAMDPT                                         1301 05310000
         STH   @06,AMDRKP(,@01)                                    1301 05311000
*                    END;                                  /*@Y30SSJH*/ 05312000
*                  ELSE                                            1303 05313000
*                    DO;                                   /*@Y30SSJH*/ 05314000
*                                                                  1303 05315000
         B     @RC01298                                            1303 05316000
@RF01298 DS    0H                                                  1304 05317000
*                    AMDAXRKP = KEYPSVAL;                  /*@Y30SSJH*/ 05318000
         L     @06,@PC00001+4                                      1304 05319000
         L     @06,FDTPTR+228(,@06)                                1304 05320000
         L     @06,KEYPSVAL(,@06)                                  1304 05321000
         L     @01,LCAMDPT                                         1304 05322000
         STH   @06,AMDAXRKP(,@01)                                  1304 05323000
*                    IXAMDPT -> AMDAXRKP = KEYPSVAL;       /*@Y30SSJH*/ 05324000
*                                                                  1305 05325000
         L     @01,IXAMDPT                                         1305 05326000
         STH   @06,AMDAXRKP(,@01)                                  1305 05327000
*                    END;                                  /*@Y30SSJH*/ 05328000
*                                                                  1306 05329000
*                AMDKEYLN = KEYLNVAL;                      /*@Y30SSJH*/ 05330000
@RC01298 L     @06,@PC00001+4                                      1307 05331000
         L     @06,FDTPTR+224(,@06)                                1307 05332000
         L     @06,KEYLNVAL(,@06)                                  1307 05333000
         L     @01,LCAMDPT                                         1307 05334000
         STH   @06,AMDKEYLN(,@01)                                  1307 05335000
*                IXAMDPT -> AMDKEYLN = KEYLNVAL;           /*@Y30SSJH*/ 05336000
*                                                                  1308 05337000
         L     @01,IXAMDPT                                         1308 05338000
         STH   @06,AMDKEYLN(,@01)                                  1308 05339000
*                END;                                      /*@Y30SSJH*/ 05340000
*                                                                  1309 05341000
*            /********************************************************/ 05342000
*            /*                                              @Y30SSJH*/ 05343000
*            /* ALTER THE MAXIMUM RECORDSIZE VALUE           @Y30SSJH*/ 05344000
*            /*                                              @Y30SSJH*/ 05345000
*            /********************************************************/ 05346000
*                                                                  1310 05347000
*            IF (ADDR(RECSZ)) ^= NULLPTR  &                        1310 05348000
*                KEYRECRC = 0                                      1310 05349000
*              THEN                                                1310 05350000
@RF01295 SLR   @06,@06                                             1310 05351000
         L     @15,@PC00001+4                                      1310 05352000
         C     @06,FDTPTR+232(,@15)                                1310 05353000
         BE    @RF01310                                            1310 05354000
         C     @06,KEYRECRC                                        1310 05355000
         BNE   @RF01310                                            1310 05356000
*                DO;                                       /*@Y30SSJH*/ 05357000
*                                                                  1311 05358000
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30SSJH*/ 05359000
         L     @06,CTGPLPTR                                        1312 05360000
         L     @06,CTGFVT(,@06)                                    1312 05361000
         L     @01,ALPRMPTR                                        1312 05362000
         LA    @14,ALFPLAMD(,@01)                                  1312 05363000
         ST    @14,CTGFVAMD(,@06)                                  1312 05364000
*                AMDLRECL = MRECVAL;                       /*@Y30SSJH*/ 05365000
*                                                                  1313 05366000
         L     @06,FDTPTR+240(,@15)                                1313 05367000
         L     @06,MRECVAL(,@06)                                   1313 05368000
         L     @01,LCAMDPT                                         1313 05369000
         ST    @06,AMDLRECL(,@01)                                  1313 05370000
*                END;                                      /*@Y30SSJH*/ 05371000
*                                                                  1314 05372000
*            /********************************************************/ 05373000
*            /*                                                      */ 05374000
*            /* BUILD THE AMDSBCAT FPL IF ALTERATIONS HAVE BEEN MADE */ 05375000
*            /* INITIALIZATION OF CTGFVAMD INDICATES CHANGES         */ 05376000
*            /*                                                      */ 05377000
*            /********************************************************/ 05378000
*                                                                  1315 05379000
*            IF CTGFVAMD ^= NULLPTR                                1315 05380000
*              THEN                                                1315 05381000
@RF01310 L     @06,CTGPLPTR                                        1315 05382000
         L     @06,CTGFVT(,@06)                                    1315 05383000
         L     @06,CTGFVAMD(,@06)                                  1315 05384000
         LTR   @06,@06                                             1315 05385000
         BZ    @RF01315                                            1315 05386000
*                DO;                                               1316 05387000
*                                                                  1316 05388000
*                CTGFLPTR = ADDR(ALFPLAMD);                        1317 05389000
         L     @06,ALPRMPTR                                        1317 05390000
         LA    @15,ALFPLAMD(,@06)                                  1317 05391000
         ST    @15,CTGFLPTR                                        1317 05392000
*                ALAMD = 'AMDB';                                   1318 05393000
         MVC   ALAMD(4,@06),@CC01450                               1318 05394000
*                CTGFLNG(1) = LCAMDLN;                             1319 05395000
         L     @06,LCAMDLN                                         1319 05396000
         ST    @06,CTGFLNG(,@15)                                   1319 05397000
*                CTGFLPT(1) = LCAMDPT;                             1320 05398000
*                                                                  1320 05399000
         L     @06,LCAMDPT                                         1320 05400000
         ST    @06,CTGFLPT(,@15)                                   1320 05401000
*                END;                                              1321 05402000
*                                                                  1321 05403000
*            END;                                                  1322 05404000
@RF01315 DS    0H                                                  1323 05405000
*        /************************************************************/ 05406000
*        /*                                                  @Y30SSJH*/ 05407000
*        /* ALTER THE AVERAGE RECORD SIZE                    @Y30SSJH*/ 05408000
*        /*                                                  @Y30SSJH*/ 05409000
*        /************************************************************/ 05410000
*                                                                  1323 05411000
*        IF LCAMDPT ^= NULLPTR        &                            1323 05412000
*           (ADDR(RECSZ)) ^= NULLPTR  &                            1323 05413000
*           KEYRECRC = 0                                           1323 05414000
*          THEN                                                    1323 05415000
@RF01233 SLR   @06,@06                                             1323 05416000
         C     @06,LCAMDPT                                         1323 05417000
         BE    @RF01323                                            1323 05418000
         L     @15,@PC00001+4                                      1323 05419000
         C     @06,FDTPTR+232(,@15)                                1323 05420000
         BE    @RF01323                                            1323 05421000
         C     @06,KEYRECRC                                        1323 05422000
         BNE   @RF01323                                            1323 05423000
*            DO;                                           /*@Y30SSJH*/ 05424000
*                                                                  1324 05425000
*            CTGFLPTR = ADDR(ALFPLLRC);                    /*@Y30SSJH*/ 05426000
         L     @06,ALPRMPTR                                        1325 05427000
         LA    @14,ALFPLLRC(,@06)                                  1325 05428000
         ST    @14,CTGFLPTR                                        1325 05429000
*            ALLRC = 'LREC';                               /*@Y30SSJH*/ 05430000
         MVC   ALLRC(4,@06),@CC01508                               1326 05431000
*            CTGFLNG(1) = 4;                               /*@Y30SSJH*/ 05432000
         MVC   CTGFLNG(4,@14),@CF00044                             1327 05433000
*            CTGFVLRS = CTGFLPTR;                          /*@Y30SSJH*/ 05434000
         L     @06,CTGPLPTR                                        1328 05435000
         L     @06,CTGFVT(,@06)                                    1328 05436000
         ST    @14,CTGFVLRS(,@06)                                  1328 05437000
*            CTGFLPT(1) = ADDR(ARECVAL);                   /*@Y30SSJH*/ 05438000
*                                                                  1329 05439000
         L     @06,FDTPTR+236(,@15)                                1329 05440000
         ST    @06,CTGFLPT(,@14)                                   1329 05441000
*            END;                                          /*@Y30SSJH*/ 05442000
*                                                                  1330 05443000
*        /************************************************************/ 05444000
*        /*                                                          */ 05445000
*        /* ALTER THE OBJECTS BUFFERSIZE                             */ 05446000
*        /*                                                          */ 05447000
*        /************************************************************/ 05448000
*                                                                  1331 05449000
*        IF (ADDR(BUFSZ)) ^= NULLPTR                               1331 05450000
*          THEN                                                    1331 05451000
@RF01323 L     @06,@PC00001+4                                      1331 05452000
         L     @06,FDTPTR+140(,@06)                                1331 05453000
         LTR   @06,@06                                             1331 05454000
         BZ    @RF01331                                            1331 05455000
*            DO;                                                   1332 05456000
*                                                                  1332 05457000
*            CTGFVBUF = ADDR(ALFPLBUF);                            1333 05458000
         L     @01,CTGPLPTR                                        1333 05459000
         L     @01,CTGFVT(,@01)                                    1333 05460000
         L     @15,ALPRMPTR                                        1333 05461000
         LA    @14,ALFPLBUF(,@15)                                  1333 05462000
         ST    @14,CTGFVBUF(,@01)                                  1333 05463000
*            CTGFLPTR = ADDR(ALFPLBUF);                            1334 05464000
         ST    @14,CTGFLPTR                                        1334 05465000
*            ALBUF = 'BUFS';                                       1335 05466000
         MVC   ALBUF(4,@15),@CC01509                               1335 05467000
*            CTGFLNG(1) = 4;                                       1336 05468000
         MVC   CTGFLNG(4,@14),@CF00044                             1336 05469000
*            CTGFLPT(1) = ADDR(BUFSZVAL);                          1337 05470000
*                                                                  1337 05471000
         ST    @06,CTGFLPT(,@14)                                   1337 05472000
*            END;                                                  1338 05473000
*                                                                  1338 05474000
*        /************************************************************/ 05475000
*        /*                                                          */ 05476000
*        /* SPECIFY THE VOLUMES TO BE ADDED OR REMOVED FROM THE      */ 05477000
*        /* OBJECTS VOLUME LIST                                      */ 05478000
*        /*                                                          */ 05479000
*        /************************************************************/ 05480000
*                                                                  1339 05481000
*        IF (ADDR(ADDVL)) ^= NULLPTR  |                            1339 05482000
*          (ADDR(REMVL)) ^= NULLPTR                                1339 05483000
*          THEN                                                    1339 05484000
@RF01331 SLR   @06,@06                                             1339 05485000
         L     @15,@PC00001+4                                      1339 05486000
         C     @06,FDTPTR+144(,@15)                                1339 05487000
         BNE   @RT01339                                            1339 05488000
         C     @06,FDTPTR+148(,@15)                                1339 05489000
         BE    @RF01339                                            1339 05490000
@RT01339 DS    0H                                                  1340 05491000
*            DO;                                                   1340 05492000
*                                                                  1340 05493000
*            ADDCOUNT = 0;                                         1341 05494000
         SLR   @06,@06                                             1341 05495000
         STH   @06,ADDCOUNT                                        1341 05496000
*            ALVOLLEN = 0;                                         1342 05497000
*                                                                  1342 05498000
         ST    @06,ALVOLLEN                                        1342 05499000
*            /********************************************************/ 05500000
*            /*                                                      */ 05501000
*            /* GET SPACE FOR THE VOLUME LIST                        */ 05502000
*            /* FOR BOTH ADDVOLUMES AND REMOVEVOLUMES                */ 05503000
*            /*                                                      */ 05504000
*            /********************************************************/ 05505000
*                                                                  1343 05506000
*            IF (ADDR(ADDVL)) ^= NULLPTR                           1343 05507000
*              THEN                                                1343 05508000
         L     @15,@PC00001+4                                      1343 05509000
         L     @15,FDTPTR+144(,@15)                                1343 05510000
         CR    @15,@06                                             1343 05511000
         BE    @RF01343                                            1343 05512000
*                DO;                                               1344 05513000
*                                                                  1344 05514000
*                ALVOLLEN = ADDVLCNT;                              1345 05515000
         LH    @06,ADDVLCNT(,@15)                                  1345 05516000
         ST    @06,ALVOLLEN                                        1345 05517000
*                CTGFVAVL = ON;                                    1346 05518000
*                                                                  1346 05519000
         L     @06,CTGPLPTR                                        1346 05520000
         L     @06,CTGFVT(,@06)                                    1346 05521000
         OI    CTGFVAVL(@06),B'10000000'                           1346 05522000
*                END;                                              1347 05523000
*                                                                  1347 05524000
*            IF (ADDR(REMVL)) ^= NULLPTR                           1348 05525000
*              THEN                                                1348 05526000
@RF01343 L     @06,@PC00001+4                                      1348 05527000
         L     @06,FDTPTR+148(,@06)                                1348 05528000
         LTR   @06,@06                                             1348 05529000
         BZ    @RF01348                                            1348 05530000
*                DO;                                               1349 05531000
*                                                                  1349 05532000
*                ALVOLLEN = ALVOLLEN + REMVLCNT;                   1350 05533000
         LH    @06,REMVLCNT(,@06)                                  1350 05534000
         AL    @06,ALVOLLEN                                        1350 05535000
         ST    @06,ALVOLLEN                                        1350 05536000
*                CTGFVRVL = ON;                                    1351 05537000
*                                                                  1351 05538000
         L     @06,CTGPLPTR                                        1351 05539000
         L     @06,CTGFVT(,@06)                                    1351 05540000
         OI    CTGFVRVL(@06),B'01000000'                           1351 05541000
*                END;                                              1352 05542000
*                                                                  1352 05543000
*            CALL IDCSAGP0(GDTTBL,                                 1353 05544000
*                   ((ALVOLLEN * 8) + 2),   /*LENGTH OF VOLUME LIST  */ 05545000
*                   CTGFVVLT,               /* POINTER TO VOLUME LIST*/ 05546000
*                   ALGPID,                 /* UGPOOL ID FOR VOL LIST*/ 05547000
*                   SETZERO);               /* SET AREA TO ZERO      */ 05548000
*                                                                  1353 05549000
@RF01348 L     @06,@PC00001                                        1353 05550000
         ST    @06,@AL00001                                        1353 05551000
         L     @15,ALVOLLEN                                        1353 05552000
         SLA   @15,3                                               1353 05553000
         AL    @15,@CF00155                                        1353 05554000
         ST    @15,@AFTEMPS                                        1353 05555000
         LA    @15,@AFTEMPS                                        1353 05556000
         ST    @15,@AL00001+4                                      1353 05557000
         L     @01,CTGPLPTR                                        1353 05558000
         L     @01,CTGFVT(,@01)                                    1353 05559000
         LA    @15,CTGFVVLT(,@01)                                  1353 05560000
         ST    @15,@AL00001+8                                      1353 05561000
         LA    @15,ALGPID                                          1353 05562000
         ST    @15,@AL00001+12                                     1353 05563000
         LA    @15,SETZERO                                         1353 05564000
         ST    @15,@AL00001+16                                     1353 05565000
         MVI   @AL00001+16,X'80'                                   1353 05566000
         L     @15,GDTGPL(,@06)                                    1353 05567000
         LA    @01,@AL00001                                        1353 05568000
         BALR  @14,@15                                             1353 05569000
*            RESPECIFY RTNREG RSTD;                                1354 05570000
*            TESTRC = RTNREG;                                      1355 05571000
         STH   RTNREG,TESTRC                                       1355 05572000
*            RESPECIFY RTNREG UNRSTD;                              1356 05573000
*            IF TESTRC ^= 0                                        1357 05574000
*              THEN                                                1357 05575000
         LH    @06,TESTRC                                          1357 05576000
         LTR   @06,@06                                             1357 05577000
         BZ    @RF01357                                            1357 05578000
*                DO;                                               1358 05579000
*                                                                  1358 05580000
*                ALSTID = NOSTORAG;                                1359 05581000
         MVC   ALSTID(5),@CB01039                                  1359 05582000
*                RETURN;                                           1360 05583000
*                                                                  1360 05584000
         B     @EL00003                                            1360 05585000
*                END;                                              1361 05586000
*                                                                  1361 05587000
*            ALVLSTLN = (ALVOLLEN * 8 );                           1362 05588000
*                                                                  1362 05589000
@RF01357 L     @06,CTGPLPTR                                        1362 05590000
         L     @06,CTGFVT(,@06)                                    1362 05591000
         L     @06,CTGFVVLT(,@06)                                  1362 05592000
         L     @15,ALVOLLEN                                        1362 05593000
         SLA   @15,3                                               1362 05594000
         STH   @15,ALVLSTLN(,@06)                                  1362 05595000
*            /********************************************************/ 05596000
*            /*                                                      */ 05597000
*            /* PLACE VOLUMES TO BE ADDED ON THE VOLUME LIST         */ 05598000
*            /*                                                      */ 05599000
*            /********************************************************/ 05600000
*                                                                  1363 05601000
*            IF (ADDR(ADDVL)) ^= NULLPTR                           1363 05602000
*              THEN                                                1363 05603000
         L     @06,@PC00001+4                                      1363 05604000
         L     @06,FDTPTR+144(,@06)                                1363 05605000
         LTR   @06,@06                                             1363 05606000
         BZ    @RF01363                                            1363 05607000
*                DO;                                               1364 05608000
*                                                                  1364 05609000
*                ADDCOUNT = ADDVLCNT;                              1365 05610000
*                                                                  1365 05611000
         LH    @06,ADDVLCNT(,@06)                                  1365 05612000
         STH   @06,ADDCOUNT                                        1365 05613000
*                DO N = 1 TO ADDVLCNT;                             1366 05614000
*                                                                  1366 05615000
         LA    @06,1                                               1366 05616000
         B     @DE01366                                            1366 05617000
@DL01366 DS    0H                                                  1367 05618000
*                  ALVOLUME(N) = ADDVLVAL(N);                      1367 05619000
*                                                                  1367 05620000
         LR    @15,@06                                             1367 05621000
         SLA   @15,3                                               1367 05622000
         L     @01,CTGPLPTR                                        1367 05623000
         L     @01,CTGFVT(,@01)                                    1367 05624000
         L     @01,CTGFVVLT(,@01)                                  1367 05625000
         ALR   @01,@15                                             1367 05626000
         AL    @01,@CF01717                                        1367 05627000
         L     @14,@PC00001+4                                      1367 05628000
         L     @14,FDTPTR+144(,@14)                                1367 05629000
         ALR   @14,@15                                             1367 05630000
         AL    @14,@CF01718                                        1367 05631000
         MVC   ALVOLUME-4(6,@01),ADDVLVAL-3(@14)                   1367 05632000
*                END;                                              1368 05633000
*                                                                  1368 05634000
         AL    @06,@CF00220                                        1368 05635000
@DE01366 ST    @06,N                                               1368 05636000
         L     @15,@PC00001+4                                      1368 05637000
         L     @01,FDTPTR+144(,@15)                                1368 05638000
         CH    @06,ADDVLCNT(,@01)                                  1368 05639000
         BNH   @DL01366                                            1368 05640000
*                END;                                              1369 05641000
*                                                                  1369 05642000
*            /********************************************************/ 05643000
*            /*                                                      */ 05644000
*            /* PLACE VOLUMES TO BE REMOVED ON THE VOLUME LIST       */ 05645000
*            /* REMOVED VOLUMES ARE PRECEEDED BY BINARY ONES IN      */ 05646000
*            /* ALVLSTCD                                             */ 05647000
*            /*                                                      */ 05648000
*            /********************************************************/ 05649000
*                                                                  1370 05650000
*            J = 0;                                                1370 05651000
*                                                                  1370 05652000
@RF01363 SLR   @06,@06                                             1370 05653000
         STH   @06,J                                               1370 05654000
*            IF (ADDR(REMVL)) ^= NULLPTR                           1371 05655000
*              THEN                                                1371 05656000
         L     @15,@PC00001+4                                      1371 05657000
         C     @06,FDTPTR+148(,@15)                                1371 05658000
         BE    @RF01371                                            1371 05659000
*                DO N = (ADDCOUNT + 1) TO (ADDCOUNT + REMVLCNT);   1372 05660000
*                                                                  1372 05661000
         LA    @06,1                                               1372 05662000
         AH    @06,ADDCOUNT                                        1372 05663000
         B     @DE01372                                            1372 05664000
@DL01372 DS    0H                                                  1373 05665000
*                J= J+1;                                           1373 05666000
         LA    @15,1                                               1373 05667000
         AH    @15,J                                               1373 05668000
         STH   @15,J                                               1373 05669000
*                ALVLSTCD(N) = 'FF'X;                              1374 05670000
         LR    @14,@06                                             1374 05671000
         SLA   @14,3                                               1374 05672000
         L     @01,CTGPLPTR                                        1374 05673000
         L     @01,CTGFVT(,@01)                                    1374 05674000
         L     @05,CTGFVVLT(,@01)                                  1374 05675000
         ST    @14,@TF00001                                        1374 05676000
         ALR   @14,@05                                             1374 05677000
         AL    @14,@CF01719                                        1374 05678000
         MVI   ALVLSTCD-2(@14),X'FF'                               1374 05679000
*                ALVOLUME(N) = REMVLVAL(J);                        1375 05680000
*                                                                  1375 05681000
         AL    @05,@TF00001                                        1375 05682000
         AL    @05,@CF01717                                        1375 05683000
         SLA   @15,3                                               1375 05684000
         L     @14,@PC00001+4                                      1375 05685000
         L     @01,FDTPTR+148(,@14)                                1375 05686000
         ALR   @01,@15                                             1375 05687000
         AL    @01,@CF01718                                        1375 05688000
         MVC   ALVOLUME-4(6,@05),REMVLVAL-3(@01)                   1375 05689000
*                END;                                              1376 05690000
*                                                                  1376 05691000
         AL    @06,@CF00220                                        1376 05692000
@DE01372 ST    @06,N                                               1376 05693000
         L     @15,@PC00001+4                                      1376 05694000
         L     @01,FDTPTR+148(,@15)                                1376 05695000
         LH    @00,ADDCOUNT                                        1376 05696000
         AH    @00,REMVLCNT(,@01)                                  1376 05697000
         CR    @06,@00                                             1376 05698000
         BNH   @DL01372                                            1376 05699000
*            /********************************************************/ 05700000
*            /*                                              @Y30SSJH*/ 05701000
*            /* ALLOCATE ALL VOLUMES AND THE CATALOG RECOVERY VOLUME */ 05702000
*            /* IF THE COMPONENT IS IN A RECOVERABLE CATALOG.        */ 05703000
*            /*                                              @Y30SSJH*/ 05704000
*            /********************************************************/ 05705000
*                                                                  1377 05706000
*            IF CTGFVIND = NULLPTR     &                           1377 05707000
*               LCCRALN ^= NULLPTR                                 1377 05708000
*              THEN                                                1377 05709000
@RF01371 SLR   @06,@06                                             1377 05710000
         L     @01,CTGPLPTR                                        1377 05711000
         L     @15,CTGFVT(,@01)                                    1377 05712000
         C     @06,CTGFVIND(,@15)                                  1377 05713000
         BNE   @RF01377                                            1377 05714000
         C     @06,LCCRALN                                         1377 05715000
         BE    @RF01377                                            1377 05716000
*                CALL DALCPROC ('A',                               1378 05717000
*                  CTGFVVLT,                                       1378 05718000
*                  CTGFVIND,                                       1378 05719000
*                  DALCINDX);                              /*@Y30SSJH*/ 05720000
*                                                                  1378 05721000
         LA    @06,@CC00859                                        1378 05722000
         ST    @06,@AL00001                                        1378 05723000
         LA    @06,CTGFVVLT(,@15)                                  1378 05724000
         ST    @06,@AL00001+4                                      1378 05725000
         LA    @06,CTGFVIND(,@15)                                  1378 05726000
         ST    @06,@AL00001+8                                      1378 05727000
         LA    @06,DALCINDX                                        1378 05728000
         ST    @06,@AL00001+12                                     1378 05729000
         LA    @01,@AL00001                                        1378 05730000
         BAL   @14,DALCPROC                                        1378 05731000
*            END;                                                  1379 05732000
*        /************************************************************/ 05733000
*        /*                                                          */ 05734000
*        /* ALTERPRC PROCESSING IS COMPLETE - RETURN TO INVOKER      */ 05735000
*        /*                                                          */ 05736000
*        /************************************************************/ 05737000
*                                                                  1380 05738000
*        RETURN;                                                   1380 05739000
*                                                                  1380 05740000
         B     @EL00003                                            1380 05741000
*END ALTERPRC;                                                     1381 05742000
         B     @EL00003                                            1381 05743000
*        /************************************************************/ 05744000
*        /*                                                  @YL026UA*/ 05745000
*        /*  PROCEDURE NAME - MEMRENAM                       @YL026UA*/ 05746000
*        /*                                                  @YL026UA*/ 05747000
*        /*  FUNCTION - INVOKE THE USTOW MACRO TO RENAME THE @YL026UA*/ 05748000
*        /*  SPECIFIED MEMBER IN THE DIRECTORY OF THE        @YL026UA*/ 05749000
*        /*  PDS AND ISSUE APPROPRIATE ALTER MESSAGES.       @YL026UA*/ 05750000
*        /*                                                  @YL026UA*/ 05751000
*        /*  INPUT - NONE                                    @YL026UA*/ 05752000
*        /*                                                  @YL026UA*/ 05753000
*        /*  OUTPUT - IF AN ERROR IS FOUND, THE RETURN CODE IS SET   */ 05754000
*        /*                                                  @YL026UA*/ 05755000
*        /************************************************************/ 05756000
*                                                                  1382 05757000
*MEMRENAM: PROCEDURE;                                      /*@YL026UA*/ 05758000
*                                                                  1382 05759000
MEMRENAM STM   @14,@12,@SA00004                                    1382 05760000
*        /************************************************************/ 05761000
*        /*                                                  @YL026UA*/ 05762000
*        /*  LOCAL DECLARATIONS                              @YL026UA*/ 05763000
*        /*                                                  @YL026UA*/ 05764000
*        /************************************************************/ 05765000
*                                                                  1383 05766000
*        DCL RENAMMEM CHAR(1) STATIC INIT('R'); /*USTOW RENAME CODE  */ 05767000
*        DCL PDSIOCS PTR(31);                /*PDS IOCS PTR  @YL026UA*/ 05768000
*        DCL OPNDSVAL CHAR(44) BASED;        /*OPENED PDS    @YL026UA*/ 05769000
*        DCL PDSLIST BIT(LENGTH(OPNAGL)) BDY(WORD); /*STORAGE FOR    */ 05770000
*                                      /*THE PDS OPNAGL      @YL026UA*/ 05771000
*                                                                  1387 05772000
*        OLDERID2 = NEWERID2;                                      1387 05773000
         L     @06,@PC00001                                        1387 05774000
         L     @06,GDTTR2(,@06)                                    1387 05775000
         MVC   @TS00001(95),NEWERID2(@06)                          1387 05776000
         MVC   OLDERID2(95,@06),@TS00001                           1387 05777000
*        NEWID2 = 'ALMR';                                  /*@YL026UA*/ 05778000
         MVC   NEWID2(4,@06),@CC01517                              1388 05779000
*        SETRC = 0;                                        /*@YL026UA*/ 05780000
         SLR   @06,@06                                             1389 05781000
         STH   @06,SETRC                                           1389 05782000
*        ALSTID = MEMALTNM;                                /*@YL026UA*/ 05783000
*                                                                  1390 05784000
         MVC   ALSTID(5),@CB01055                                  1390 05785000
*        /************************************************************/ 05786000
*        /*                                                  @YL026UA*/ 05787000
*        /*  IF A MEMBER WAS SPECIFIED WITH A GENERIC NAME   @YL026UA*/ 05788000
*        /*  THEN ISSUE BOTH AN ERROR MESSAGE TO THAT        @YL026UA*/ 05789000
*        /*  AFFECT AND A MEMBER NOT RENAMED MESSAGE         @YL026UA*/ 05790000
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/ 05791000
*        /*                                                  @YL026UA*/ 05792000
*        /************************************************************/ 05793000
*                                                                  1391 05794000
*        IF NTRYPOS ^= 0                                           1391 05795000
*          THEN                                                    1391 05796000
         L     @06,@PC00001+4                                      1391 05797000
         L     @06,FDTPTR(,@06)                                    1391 05798000
         CLI   NTRYPOS(@06),0                                      1391 05799000
         BE    @RF01391                                            1391 05800000
*            ALSTID = GENERMEM;                            /*@YL026UA*/ 05801000
         MVC   ALSTID(5),@CB01067                                  1392 05802000
*          ELSE                                                    1393 05803000
*                                                                  1393 05804000
*        /************************************************************/ 05805000
*        /*                                                  @YL026UA*/ 05806000
*        /*  IF A MEMBER WAS SPECIFIED WITH A PDS NAME       @YL026UA*/ 05807000
*        /*  THAT DOES NOT MATCH THE NEWNAME SPECIFIED - ISSUE AN    */ 05808000
*        /*  ERROR MESSAGE AND MEMBER NOT RENAMED MESSAGE    @YL026UA*/ 05809000
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/ 05810000
*        /*                                                  @YL026UA*/ 05811000
*        /************************************************************/ 05812000
*                                                                  1393 05813000
*            IF ENTRYVAL ^= NEWNAME                                1393 05814000
*              THEN                                                1393 05815000
         B     @RC01391                                            1393 05816000
@RF01391 CLC   ENTRYVAL(44),NEWNAME                                1393 05817000
         BE    @RF01393                                            1393 05818000
*                ALSTID = NSAMEPDS;                        /*@YL026UA*/ 05819000
*                                                                  1394 05820000
         MVC   ALSTID(5),@CB01073                                  1394 05821000
*        /************************************************************/ 05822000
*        /*                                                  @YL026UA*/ 05823000
*        /*  OPEN THE PDS FOR UPDATE AND DYNAMICALLY ALLOCATE IT     */ 05824000
*        /*  VIA THE UOPEN MACRO IF IT WERE NOT ALREADY      @YL026UA*/ 05825000
*        /*  ALLOCATED VIA JCL                               @YL026UA*/ 05826000
*        /*                                                  @YL026UA*/ 05827000
*        /************************************************************/ 05828000
*                                                                  1395 05829000
*        IF ALSTID = MEMALTNM                                      1395 05830000
*          THEN                                                    1395 05831000
@RF01393 DS    0H                                                  1395 05832000
@RC01391 CLC   ALSTID(5),@CB01055                                  1395 05833000
         BNE   @RF01395                                            1395 05834000
*           DO;                                            /*@YL026UA*/ 05835000
*        OPNPTR = ADDR(PDSLIST);                           /*@YL026UA*/ 05836000
         LA    @06,PDSLIST                                         1397 05837000
         ST    @06,OPNPTR                                          1397 05838000
*        PDSLIST = ''B;                                    /*@YL026UA*/ 05839000
         XC    PDSLIST(48),PDSLIST                                 1398 05840000
*        OPNOPTOT = ON;                                    /*@YL026UA*/ 05841000
*        OPNOPTBK = ON;                                    /*@YL026UA*/ 05842000
         OI    OPNOPTOT(@06),B'01010000'                           1400 05843000
*        OPNDSOPO = ON;                                    /*@YL026UA*/ 05844000
         OI    OPNDSOPO(@06),B'00010000'                           1401 05845000
*        OPNIOC = ADDR(PDSIOCS);                           /*@YL026UA*/ 05846000
         LA    @15,PDSIOCS                                         1402 05847000
         ST    @15,OPNIOC(,@06)                                    1402 05848000
*        IF ADDR(INDD) ^= NULLPTR                                  1403 05849000
*          THEN                                                    1403 05850000
         L     @15,@PC00001+4                                      1403 05851000
         L     @15,FDTPTR+20(,@15)                                 1403 05852000
         LTR   @15,@15                                             1403 05853000
         BZ    @RF01403                                            1403 05854000
*            OPNDDN = ADDR(INDDVAL);                       /*@YL026UA*/ 05855000
         LA    @15,INDDVAL(,@15)                                   1404 05856000
         ST    @15,OPNDDN(,@06)                                    1404 05857000
*          ELSE                                                    1405 05858000
*            DO;                                           /*@YL026UA*/ 05859000
         B     @RC01403                                            1405 05860000
@RF01403 DS    0H                                                  1406 05861000
*              OPNDSN = ADDR(ENTRYVAL);                    /*@YL026UA*/ 05862000
         L     @06,OPNPTR                                          1406 05863000
         LA    @15,ENTRYVAL                                        1406 05864000
         ST    @15,OPNDSN(,@06)                                    1406 05865000
*              IF NTRYPLN ^= 0                                     1407 05866000
*                THEN                                              1407 05867000
         L     @15,@PC00001+4                                      1407 05868000
         L     @15,FDTPTR(,@15)                                    1407 05869000
         CLI   NTRYPLN(@15),0                                      1407 05870000
         BE    @RF01407                                            1407 05871000
*                  OPNPWA = ADDR(NTRYPAS);                 /*@YL026UA*/ 05872000
         LA    @15,NTRYPAS(,@15)                                   1408 05873000
         ST    @15,OPNPWA(,@06)                                    1408 05874000
*            END;                                          /*@YL026UA*/ 05875000
@RF01407 DS    0H                                                  1410 05876000
*        CALL IDCIOOP0(GDTTBL,OPNAGL);                     /*@YL026UA*/ 05877000
@RC01403 L     @06,@PC00001                                        1410 05878000
         ST    @06,@AL00001                                        1410 05879000
         L     @01,OPNPTR                                          1410 05880000
         ST    @01,@AL00001+4                                      1410 05881000
         MVI   @AL00001+4,X'80'                                    1410 05882000
         L     @15,GDTOPN(,@06)                                    1410 05883000
         LA    @01,@AL00001                                        1410 05884000
         BALR  @14,@15                                             1410 05885000
*        RESPECIFY RTNREG RSTD;                                    1411 05886000
*        TESTRC = RTNREG;                                          1412 05887000
         STH   RTNREG,TESTRC                                       1412 05888000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UA*/ 05889000
*        IF TESTRC ^= 0                                    /*@YL026UA*/ 05890000
*          THEN                                            /*@YL026UA*/ 05891000
         LH    @06,TESTRC                                          1414 05892000
         LTR   @06,@06                                             1414 05893000
         BZ    @RF01414                                            1414 05894000
*            ALSTID = NOMEMALT;                            /*@YL026UA*/ 05895000
         MVC   ALSTID(5),@CB01052                                  1415 05896000
*           END;                                           /*@YL026UA*/ 05897000
*                                                                  1416 05898000
@RF01414 DS    0H                                                  1417 05899000
*        /************************************************************/ 05900000
*        /*                                                  @YL026UA*/ 05901000
*        /*  IF THE OPEN WAS SUCCESSFUL - RENAME THE MEMBER  @YL026UA*/ 05902000
*        /*  FROM ITS DIRECTORY VIA THE USTOW MACRO          @YL026UA*/ 05903000
*        /*                                                  @YL026UA*/ 05904000
*        /************************************************************/ 05905000
*                                                                  1417 05906000
*        IF TESTRC = 0 & ALSTID = MEMALTNM                         1417 05907000
*          THEN                                                    1417 05908000
@RF01395 LH    @06,TESTRC                                          1417 05909000
         LTR   @06,@06                                             1417 05910000
         BNZ   @RF01417                                            1417 05911000
         CLC   ALSTID(5),@CB01055                                  1417 05912000
         BNE   @RF01417                                            1417 05913000
*            DO;                                           /*@YL026UA*/ 05914000
*        /************************************************************/ 05915000
*        /*                                                  @YL026UA*/ 05916000
*        /*  IF A MEMBER WAS SPECIFIED WITH A PDS NAME       @YL026UA*/ 05917000
*        /*  THAT DOES NOT MATCH THE OPENED PDS - ISSUE AN   @YL026UA*/ 05918000
*        /*  ERROR MESSAGE AND MEMBER NOT RENAMED MESSAGE    @YL026UA*/ 05919000
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/ 05920000
*        /*                                                  @YL026UA*/ 05921000
*        /************************************************************/ 05922000
*                                                                  1419 05923000
*        IF ENTRYVAL ^= PDSIOCS -> IOCDSN -> OPNDSVAL              1419 05924000
*          THEN                                                    1419 05925000
         L     @06,PDSIOCS                                         1419 05926000
         L     @06,IOCDSN(,@06)                                    1419 05927000
         CLC   ENTRYVAL(44),OPNDSVAL(@06)                          1419 05928000
         BE    @RF01419                                            1419 05929000
*            ALSTID = NSAMEPDS;                            /*@YL026UA*/ 05930000
         MVC   ALSTID(5),@CB01073                                  1420 05931000
*          ELSE                                                    1421 05932000
*            DO;                                           /*@YL026UA*/ 05933000
         B     @RC01419                                            1421 05934000
@RF01419 DS    0H                                                  1422 05935000
*              PDSIOCS -> IOCMEM = ADDR(NTRYMEM);          /*@YL026UA*/ 05936000
         L     @06,PDSIOCS                                         1422 05937000
         L     @15,@PC00001+4                                      1422 05938000
         L     @01,FDTPTR(,@15)                                    1422 05939000
         LA    @14,NTRYMEM(,@01)                                   1422 05940000
         ST    @14,IOCMEM(,@06)                                    1422 05941000
*              PDSIOCS -> IOCNWM = ADDR(NEWNMMEM);         /*@YL026UA*/ 05942000
         L     @01,FDTPTR+16(,@15)                                 1423 05943000
         LA    @15,NEWNMMEM(,@01)                                  1423 05944000
         ST    @15,IOCNWM(,@06)                                    1423 05945000
*              CALL IDCIOST0(GDTTBL,PDSIOCS,RENAMMEM);     /*@YL026UA*/ 05946000
         L     @06,@PC00001                                        1424 05947000
         ST    @06,@AL00001                                        1424 05948000
         LA    @15,PDSIOCS                                         1424 05949000
         ST    @15,@AL00001+4                                      1424 05950000
         LA    @15,RENAMMEM                                        1424 05951000
         ST    @15,@AL00001+8                                      1424 05952000
         MVI   @AL00001+8,X'80'                                    1424 05953000
         L     @15,GDTSTW(,@06)                                    1424 05954000
         LA    @01,@AL00001                                        1424 05955000
         BALR  @14,@15                                             1424 05956000
*              RESPECIFY RTNREG RSTD;                              1425 05957000
*              TESTRC = RTNREG;                                    1426 05958000
         STH   RTNREG,TESTRC                                       1426 05959000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UA*/ 05960000
*                                                                  1427 05961000
*        /************************************************************/ 05962000
*        /*                                                  @YL026UA*/ 05963000
*        /*  IF THE RENAME WAS SUCCESSFUL - ISSUE A MESSAGE  @YL026UA*/ 05964000
*        /*  INDICATING THE MEMBER WAS RENAMED               @YL026UA*/ 05965000
*        /*                                                  @YL026UA*/ 05966000
*        /************************************************************/ 05967000
*                                                                  1428 05968000
*              IF TESTRC ^= 0                                      1428 05969000
*                THEN                                              1428 05970000
         LH    @06,TESTRC                                          1428 05971000
         LTR   @06,@06                                             1428 05972000
         BZ    @RF01428                                            1428 05973000
*                  ALSTID = NOMEMALT;                      /*@YL026UA*/ 05974000
*                                                                  1429 05975000
         MVC   ALSTID(5),@CB01052                                  1429 05976000
*        /************************************************************/ 05977000
*        /*                                                  @YL026UA*/ 05978000
*        /*  CLOSE THE DATA SET IF IT WAS SUCCESSFULLY OPENED@YL026UA*/ 05979000
*        /*                                                  @YL026UA*/ 05980000
*        /************************************************************/ 05981000
*                                                                  1430 05982000
*              CALL IDCIOCL0(GDTTBL,PDSIOCS);              /*@YL026UA*/ 05983000
@RF01428 L     @06,@PC00001                                        1430 05984000
         ST    @06,@AL00001                                        1430 05985000
         LA    @15,PDSIOCS                                         1430 05986000
         ST    @15,@AL00001+4                                      1430 05987000
         MVI   @AL00001+4,X'80'                                    1430 05988000
         L     @15,GDTCLS(,@06)                                    1430 05989000
         LA    @01,@AL00001                                        1430 05990000
         BALR  @14,@15                                             1430 05991000
*              RESPECIFY RTNREG RSTD;                              1431 05992000
*              TESTRC = RTNREG;                                    1432 05993000
         STH   RTNREG,TESTRC                                       1432 05994000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UA*/ 05995000
*              SETRC = MAX(SETRC,TESTRC);                  /*@YL026UA*/ 05996000
         LH    @06,TESTRC                                          1434 05997000
         LH    @15,SETRC                                           1434 05998000
         CR    @15,@06                                             1434 05999000
         BNL   *+6                                                      06000000
         LR    @15,@06                                             1434 06001000
         STH   @15,SETRC                                           1434 06002000
*            END;                                          /*@YL026UA*/ 06003000
*          END;                                            /*@YL026UA*/ 06004000
*                                                                  1436 06005000
@RC01419 DS    0H                                                  1437 06006000
*        /************************************************************/ 06007000
*        /*                                                  @YL026UA*/ 06008000
*        /*  IF THE MEMBER WAS NOT SUCCESSFULLY DELETED      @YL026UA*/ 06009000
*        /*  ISSUE A PRIMARY MSG FOR EXPLANATION IF ONE      @YL026UA*/ 06010000
*        /*  HAS NOT PREVIOUSLY BEEN ISSUED AND              @YL026UA*/ 06011000
*        /*  ISSUE THE SECONDARY MEMBER NOT DELETED MESSAGE  @YL026UA*/ 06012000
*        /*  AND RETURN WITH A CODE OF 8                     @YL026UA*/ 06013000
*        /*                                                  @YL026UA*/ 06014000
*        /************************************************************/ 06015000
*                                                                  1437 06016000
*        IF ALSTID = GENERMEM | ALSTID = NSAMEPDS                  1437 06017000
*          THEN                                                    1437 06018000
@RF01417 CLC   ALSTID(5),@CB01067                                  1437 06019000
         BE    @RT01437                                            1437 06020000
         CLC   ALSTID(5),@CB01073                                  1437 06021000
         BNE   @RF01437                                            1437 06022000
@RT01437 DS    0H                                                  1438 06023000
*            DO;                                           /*@YL026UA*/ 06024000
*              DARGLIST = ''B;                             /*@YL026UA*/ 06025000
         L     @06,DDSTRU                                          1439 06026000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      1439 06027000
*              DARGSMOD = ALMODID;                         /*@YL026UA*/ 06028000
         MVC   DARGSMOD(3,@06),ALMODID                             1440 06029000
*              DARGSENT = ALSTD;                           /*@YL026UA*/ 06030000
*                                                                  1441 06031000
         IC    @15,ALSTD                                           1441 06032000
         STC   @15,DARGSENT(,@06)                                  1441 06033000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UA*/ 06034000
*                                                                  1442 06035000
         L     @06,@PC00001                                        1442 06036000
         ST    @06,@AL00001                                        1442 06037000
         LA    @15,@CF00117                                        1442 06038000
         ST    @15,@AL00001+4                                      1442 06039000
         LA    @15,DDSTRU                                          1442 06040000
         ST    @15,@AL00001+8                                      1442 06041000
         MVI   @AL00001+8,X'80'                                    1442 06042000
         L     @15,GDTPRT(,@06)                                    1442 06043000
         LA    @01,@AL00001                                        1442 06044000
         BALR  @14,@15                                             1442 06045000
*              ALSTID = NOMEMALT;                          /*@YL026UA*/ 06046000
         MVC   ALSTID(5),@CB01052                                  1443 06047000
*            END;                                          /*@YL026UA*/ 06048000
*          IF ALSTID ^= MEMALTNM                                   1445 06049000
*            THEN                                                  1445 06050000
@RF01437 CLC   ALSTID(5),@CB01055                                  1445 06051000
         BE    @RF01445                                            1445 06052000
*              SETRC = LASTCC08;                           /*@YL026UA*/ 06053000
         MVC   SETRC(2),@CH00039                                   1446 06054000
*          DARGLIST = ''B;                                 /*@YL026UA*/ 06055000
@RF01445 L     @06,DDSTRU                                          1447 06056000
         XC    DARGLIST(20,@06),DARGLIST(@06)                      1447 06057000
*          DARGSMOD = ALMODID;                             /*@YL026UA*/ 06058000
         MVC   DARGSMOD(3,@06),ALMODID                             1448 06059000
*          DARGSENT = ALSTD;                               /*@YL026UA*/ 06060000
         IC    @15,ALSTD                                           1449 06061000
         STC   @15,DARGSENT(,@06)                                  1449 06062000
*          DARGDBP = ADDR(NTRYMEM);                        /*@YL026UA*/ 06063000
         L     @15,@PC00001+4                                      1450 06064000
         L     @15,FDTPTR(,@15)                                    1450 06065000
         LA    @14,NTRYMEM(,@15)                                   1450 06066000
         ST    @14,DARGDBP(,@06)                                   1450 06067000
*          DARGILP = NTRYMLN;                              /*@YL026UA*/ 06068000
*                                                                  1451 06069000
         SLR   @14,@14                                             1451 06070000
         IC    @14,NTRYMLN(,@15)                                   1451 06071000
         STH   @14,DARGILP(,@06)                                   1451 06072000
*          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);           /*@YL026UA*/ 06073000
*                                                                  1452 06074000
         L     @06,@PC00001                                        1452 06075000
         ST    @06,@AL00001                                        1452 06076000
         LA    @15,@CF00117                                        1452 06077000
         ST    @15,@AL00001+4                                      1452 06078000
         LA    @15,DDSTRU                                          1452 06079000
         ST    @15,@AL00001+8                                      1452 06080000
         MVI   @AL00001+8,X'80'                                    1452 06081000
         L     @15,GDTPRT(,@06)                                    1452 06082000
         LA    @01,@AL00001                                        1452 06083000
         BALR  @14,@15                                             1452 06084000
*          ALSTID = NORMAL;                                /*@YL026UA*/ 06085000
         MVC   ALSTID(5),@CB01034                                  1453 06086000
*        RETURN CODE (SETRC);                              /*@YL026UA*/ 06087000
         LH    @15,SETRC                                           1454 06088000
         L     @14,@SA00004                                        1454 06089000
         LM    @00,@12,@SA00004+8                                  1454 06090000
         BR    @14                                                 1454 06091000
*END MEMRENAM;                                             /*@YL026UA*/ 06092000
*/********************************************************************/ 06093000
*/*                                                          @Y30SSJH*/ 06094000
*/* PROCEDURE NAME - CHECKPRC (STAGE 3 PROCESSOR)            @Y30SSJH*/ 06095000
*/*                                                          @Y30SSJH*/ 06096000
*/* FUNCTION - PERFORMS SPECIAL VERIFICATION IF ANY OF THE   @Y30SSJH*/ 06097000
*/*            FOLLOWING PARAMETERS HAVE BEEN SPECIFIED:     @Y30SSJH*/ 06098000
*/*                                                          @Y30SSJH*/ 06099000
*/*            UPGRADE - LOCATES THE AIX DATA HIGH-USED RBA  @Y30SSJH*/ 06100000
*/*                      AND VERIFIES THAT IT IS ZERO        @Y30SSJH*/ 06101000
*/*                                                          @Y30SSJH*/ 06102000
*/*            UNIQUEKEY - VERIFIES THAT THE HIGH-USED RBA   @Y30SSJH*/ 06103000
*/*                        OF THE AIX DATA OBJECT BEING      @Y30SSJH*/ 06104000
*/*                        ALTERED IS ZERO                   @Y30SSJH*/ 06105000
*/*                                                          @Y30SSJH*/ 06106000
*/*            KEYS AND/OR                                   @Y30SSJH*/ 06107000
*/*             RECORDSIZE - LOCATES THE DATA AND INDEX (IF  @Y30SSJH*/ 06108000
*/*                          KSDS) AMDSB AND HIGH-USED RBA   @Y30SSJH*/ 06109000
*/*                          OF THE ENTRY NAMED IN THE       @Y30SSJH*/ 06110000
*/*                          ALTER COMMAND AND VERIFIES      @Y30SSJH*/ 06111000
*/*                          THAT THE DATA SET IS EMPTY AND  @Y30SSJH*/ 06112000
*/*                          THAT THE NEW VALUES DO NOT      @Y30SSJH*/ 06113000
*/*                          CONFLICT WITH PREVIOUSLY        @Y30SSJH*/ 06114000
*/*                          DEFINED VALUES                  @Y30SSJH*/ 06115000
*/*                                                          @Y30SSJH*/ 06116000
*/*            CHECKPRC INTERFACES WITH LOCATPRC TO PERFORM  @Y30SSJH*/ 06117000
*/*            THE SECONDARY LOCATES REQUIRED IN VERIFICA-   @Y30SSJH*/ 06118000
*/*            TION OF KEYS AND/OR RECORDSIZE.  IN SPECIFY-  @Y30SSJH*/ 06119000
*/*            ING KEYS AND/OR RECORDSIZE, THE ENTRY NAME    @Y30SSJH*/ 06120000
*/*            MAY BE THAT OF A PATH, AIX, CLUSTER OR DATA   @Y30SSJH*/ 06121000
*/*            OBJECT.  IF EITHER OF THESE PARAMETERS ARE    @Y30SSJH*/ 06122000
*/*            SPECIFIED, ALL PARAMETERS SPECIFIED APPLY TO  @Y30SSJH*/ 06123000
*/*            THE DATA OBJECT LOCATED ON THE SECONDARY      @Y30SSJH*/ 06124000
*/*            LOCATE.                                       @Y30SSJH*/ 06125000
*/*                                                          @Y30SSJH*/ 06126000
*/* INPUT - THE FDTTBL IN IDCAL01 IS REFERENCED.             @Y30SSJH*/ 06127000
*/*         THE LOCTABLE BUILT BY LOCATPRC IS REFERENCED.    @Y30SSJH*/ 06128000
*/*                                                          @Y30SSJH*/ 06129000
*/* OUTPUT -                                                 @Y30SSJH*/ 06130000
*/*          ALSTID - THE GLOBAL STATUS COMMUNICATOR IS SET  @Y30SSJH*/ 06131000
*/*                   ON ERROR DETECTION:                    @Y30SSJH*/ 06132000
*/*                                                          @Y30SSJH*/ 06133000
*/*                   INVAIXER - INVALID AIX PARAMETERS      @Y30SSJH*/ 06134000
*/*                   UNQUPGER - UNIQUEKEY/UPGRADE SPECIFIED @Y30SSJH*/ 06135000
*/*                              FOR NON-EMPTY AIX           @Y30SSJH*/ 06136000
*/*                                                          @Y30SSJH*/ 06137000
*/********************************************************************/ 06138000
*                                                                  1456 06139000
*CHECKPRC:                                                         1456 06140000
*        PROCEDURE;                                        /*@Y30SSJH*/ 06141000
CHECKPRC STM   @14,@12,@SA00005                                    1456 06142000
*        /************************************************************/ 06143000
*        /*                                                  @Y30SSJH*/ 06144000
*        /* WORKAREA FOR RETURN OF HURBADS IF UPGRADE        @Y30SSJH*/ 06145000
*        /* SPECIFIED                                        @Y30SSJH*/ 06146000
*        /*                                                  @Y30SSJH*/ 06147000
*        /************************************************************/ 06148000
*                                                                  1457 06149000
*        DCL                                                       1457 06150000
*          1 HURBAWKA BDY(WORD),                                   1457 06151000
*            2 HURTOTLN FIXED(15),                                 1457 06152000
*            2 HURRETLN FIXED(15),                                 1457 06153000
*            2 HURBADS  FIXED(31);                         /*@Y30SSJH*/ 06154000
*                                                                  1457 06155000
*        /************************************************************/ 06156000
*        /*                                                  @Y30SSJH*/ 06157000
*        /* WORKAREA FOR RETURN OF NAME ASSOCIATIONS. A      @Y30SSJH*/ 06158000
*        /* MAXIMUM OF FIVE CAN BE RETURNED.                 @Y30SSJH*/ 06159000
*        /*                                                  @Y30SSJH*/ 06160000
*        /************************************************************/ 06161000
*                                                                  1458 06162000
*        DCL                                                       1458 06163000
*          1 ASSOCWKA  BDY(WORD),                                  1458 06164000
*            2 ASSTOTLN  FIXED(15),                                1458 06165000
*            2 ASSRETLN  FIXED(15),                                1458 06166000
*            2 * CHAR(28);                                 /*@Y30SSJH*/ 06167000
*                                                                  1458 06168000
*        /************************************************************/ 06169000
*        /*                                                  @Y30SSJH*/ 06170000
*        /* WORKAREA FOR RETURN OF AMDSB IF KEYS/RECORDSIZE  @Y30SSJH*/ 06171000
*        /* SPECIFIED FOR AN INDEXED DATA SET                @Y30SSJH*/ 06172000
*        /*                                                  @Y30SSJH*/ 06173000
*        /************************************************************/ 06174000
*                                                                  1459 06175000
*        DCL                                                       1459 06176000
*          1 AMDSBWKA  BDY(WORD),                                  1459 06177000
*            2 AMDTOTLN  FIXED(15),                                1459 06178000
*            2 AMDRETLN  FIXED(15),                                1459 06179000
*            2 *         CHAR(LENGTH(IDAAMDSB)),           /*@Y30SSJH*/ 06180000
*            2 *         CHAR(40);                         /*@Y30SSJH*/ 06181000
*                                                                  1459 06182000
*        /************************************************************/ 06183000
*        /*                                                  @Y30SSJH*/ 06184000
*        /* VARIABLES USED IN CALCULATING THE SQUARE ROOT    @Y30SSJH*/ 06185000
*        /*                                                  @Y30SSJH*/ 06186000
*        /************************************************************/ 06187000
*                                                                  1460 06188000
*        DCL                                                       1460 06189000
*          SQRTINC FIXED(31),                                      1460 06190000
*          SQRTVALU FIXED(31),        /* SQUARE ROOT VALUE   @Y30SSJH*/ 06191000
*          SQRTSW   BIT(1);            /* LOOP SWITCH        @Y30SSJH*/ 06192000
*                                                                  1460 06193000
*        /************************************************************/ 06194000
*        /*                                                  @Y30SSJH*/ 06195000
*        /* VARIABLES USED IN INDEX VALIDITY CHECKING        @Y30SSJH*/ 06196000
*        /*                                                  @Y30SSJH*/ 06197000
*        /************************************************************/ 06198000
*                                                                  1461 06199000
*        DCL                                                       1461 06200000
*          XVAL     FIXED(31),                                     1461 06201000
*          YVAL     FIXED(31),                                     1461 06202000
*          MAXVALU  FIXED(31),         /* MAXIMUM OF XVAL AND      1461 06203000
*                                         YVAL               @Y30SSJH*/ 06204000
*          KYPOSIT  FIXED(31),        /* KEY POSITION        @Y30SSJH*/ 06205000
*          PASSWORD CHAR(8) INIT('PASSWORD');              /*@Y30SSJH*/ 06206000
*                                                                  1461 06207000
*                                                                  1461 06208000
*        /************************************************************/ 06209000
*        /*                                                  @Y30SSJH*/ 06210000
*        /* ENTRY POINT TO CHECKPRC                          @Y30SSJH*/ 06211000
*        /*                                                  @Y30SSJH*/ 06212000
*        /************************************************************/ 06213000
*                                                                  1462 06214000
*        OLDERID2 = NEWERID2;                                      1462 06215000
         L     @06,@PC00001                                        1462 06216000
         L     @06,GDTTR2(,@06)                                    1462 06217000
         MVC   @TS00001(95),NEWERID2(@06)                          1462 06218000
         MVC   OLDERID2(95,@06),@TS00001                           1462 06219000
*        NEWID2 = 'AL51';                                  /*@Y30SSJH*/ 06220000
*                                                                  1463 06221000
         MVC   NEWID2(4,@06),@CC01543                              1463 06222000
*        /************************************************************/ 06223000
*        /*                                                  @Y30SSJH*/ 06224000
*        /* VERIFICATION OF THE UPGRADE PARAMETER            @Y30SSJH*/ 06225000
*        /*                                                  @Y30SSJH*/ 06226000
*        /************************************************************/ 06227000
*                                                                  1464 06228000
*        IF (ADDR(UPG)) ^= NULLPTR                                 1464 06229000
*          THEN                                                    1464 06230000
         L     @06,@PC00001+4                                      1464 06231000
         L     @06,FDTPTR+252(,@06)                                1464 06232000
         LTR   @06,@06                                             1464 06233000
         BZ    @RF01464                                            1464 06234000
*UPGLOOP:    DO;                                           /*@Y30SSJH*/ 06235000
*                                                                  1465 06236000
UPGLOOP  DS    0H                                                  1466 06237000
*            /********************************************************/ 06238000
*            /*                                              @Y30SSJH*/ 06239000
*            /* VERIFY THAT THE OBJECT LOCATED ON THE        @Y30SSJH*/ 06240000
*            /* PRIMARY (FIRST) LOCATE IS A 'G'              @Y30SSJH*/ 06241000
*            /*                                              @Y30SSJH*/ 06242000
*            /********************************************************/ 06243000
*                                                                  1466 06244000
*            IF LCETYPVL ^= 'G'                                    1466 06245000
*              THEN                                                1466 06246000
         L     @06,LCETYPPT                                        1466 06247000
         CLI   LCETYPVL(@06),C'G'                                  1466 06248000
         BE    @RF01466                                            1466 06249000
*                DO;                                       /*@Y30SSJH*/ 06250000
*                                                                  1467 06251000
*                ALSTID = INVAIXER;                        /*@Y30SSJH*/ 06252000
         MVC   ALSTID(5),@CB01028                                  1468 06253000
*                RETURN;                                   /*@Y30SSJH*/ 06254000
*                                                                  1469 06255000
@EL00005 DS    0H                                                  1469 06256000
@EF00005 DS    0H                                                  1469 06257000
@ER00005 LM    @14,@12,@SA00005                                    1469 06258000
         BR    @14                                                 1469 06259000
*                END;                                      /*@Y30SSJH*/ 06260000
*                                                                  1470 06261000
*            /********************************************************/ 06262000
*            /*                                              @Y30SSJH*/ 06263000
*            /* INSURE THAT A VALID RGATTR FIELD WAS         @Y30SSJH*/ 06264000
*            /* RETURNED ON THE PRIMARY LOCATE               @Y30SSJH*/ 06265000
*            /*                                              @Y30SSJH*/ 06266000
*            /********************************************************/ 06267000
*                                                                  1471 06268000
*            IF LCRATRPT = NULLPTR                                 1471 06269000
*              THEN                                                1471 06270000
@RF01466 L     @06,LCRATRPT                                        1471 06271000
         LTR   @06,@06                                             1471 06272000
         BNZ   @RF01471                                            1471 06273000
*                DO;                                       /*@Y30SSJH*/ 06274000
*                                                                  1472 06275000
*                ALSTID = LOCRTNER;                        /*@Y30SSJH*/ 06276000
         MVC   ALSTID(5),@CB01025                                  1473 06277000
*                RETURN;                                   /*@Y30SSJH*/ 06278000
*                                                                  1474 06279000
         B     @EL00005                                            1474 06280000
*                END;                                      /*@Y30SSJH*/ 06281000
*                                                                  1475 06282000
*              ELSE                                                1476 06283000
*UPGVERF:        DO;                                       /*@Y30SSJH*/ 06284000
*                                                                  1476 06285000
@RF01471 DS    0H                                                  1476 06286000
UPGVERF  DS    0H                                                  1477 06287000
*                /****************************************************/ 06288000
*                /*                                          @Y30SSJH*/ 06289000
*                /* ENSURE THAT A VALID ASSOCIATION WAS      @Y30SSJH*/ 06290000
*                /* RETURNED BY THE PRIMARY LOCATE           @Y30SSJH*/ 06291000
*                /*                                          @Y30SSJH*/ 06292000
*                /****************************************************/ 06293000
*                                                                  1477 06294000
*                IF LCNAMID(1) ^= 'D'                              1477 06295000
*                  THEN                                            1477 06296000
         L     @06,LCNAMPT                                         1477 06297000
         CLI   LCNAMID(@06),C'D'                                   1477 06298000
         BE    @RF01477                                            1477 06299000
*                    DO;                                   /*@Y30SSJH*/ 06300000
*                                                                  1478 06301000
*                    ALSTID = LOCRTNER;                    /*@Y30SSJH*/ 06302000
         MVC   ALSTID(5),@CB01025                                  1479 06303000
*                    RETURN;                               /*@Y30SSJH*/ 06304000
*                                                                  1480 06305000
         B     @EL00005                                            1480 06306000
*                    END;                                  /*@Y30SSJH*/ 06307000
*                                                                  1481 06308000
*                /****************************************************/ 06309000
*                /*                                          @Y30SSJH*/ 06310000
*                /* INITIALIZE THE CPL TO LOCATE THE HIGH-   @Y30SSJH*/ 06311000
*                /* USED RBA OF THE AIX DATA OBJECT          @Y30SSJH*/ 06312000
*                /*                                          @Y30SSJH*/ 06313000
*                /****************************************************/ 06314000
*                                                                  1482 06315000
*                CTGPLPTR = ADDR(ALCTGPL);                 /*@Y30SSJH*/ 06316000
@RF01477 L     @06,ALPRMPTR                                        1482 06317000
         LA    @15,ALCTGPL(,@06)                                   1482 06318000
         ST    @15,CTGPLPTR                                        1482 06319000
*                ALCTGPL = ''B;                            /*@Y30SSJH*/ 06320000
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        1483 06321000
*                CTGENT  = ADDR(LCNAMCI(1));               /*@Y30SSJH*/ 06322000
         L     @06,LCNAMPT                                         1484 06323000
         LA    @06,LCNAMCI(,@06)                                   1484 06324000
         ST    @06,CTGENT(,@15)                                    1484 06325000
*                CTGCNAME = ON;                            /*@Y30SSJH*/ 06326000
         OI    CTGCNAME(@15),B'00000010'                           1485 06327000
*                CTGFUNC  = CTGLOC;                        /*@Y30SSJH*/ 06328000
         NI    CTGFUNC(@15),B'00111111'                            1486 06329000
         OI    CTGFUNC(@15),B'00100000'                            1486 06330000
*                CTGNUM   = ON;                            /*@Y30SSJH*/ 06331000
*                CTGAM0   = ON;                            /*@Y30SSJH*/ 06332000
*                                                                  1488 06333000
         OI    CTGNUM(@15),B'00000011'                             1488 06334000
*                HURBAWKA = ''B;                           /*@Y30SSJH*/ 06335000
         XC    HURBAWKA(8),HURBAWKA                                1489 06336000
*                CTGWKA = ADDR(HURBAWKA);                  /*@Y30SSJH*/ 06337000
         LA    @06,HURBAWKA                                        1490 06338000
         ST    @06,CTGWKA(,@15)                                    1490 06339000
*                HURTOTLN = 8;                             /*@Y30SSJH*/ 06340000
*                                                                  1491 06341000
         MVC   HURTOTLN(2),@CH00039                                1491 06342000
*                /****************************************************/ 06343000
*                /*                                          @Y30SSJH*/ 06344000
*                /* SET THE CPL TO REFERENCE THE CATALOG IN  @Y30SSJH*/ 06345000
*                /* WHICH THE ENTRY RESIDES                  @Y30SSJH*/ 06346000
*                /*                                          @Y30SSJH*/ 06347000
*                /****************************************************/ 06348000
*                                                                  1492 06349000
*                IF CATACBPT ^= NULLPTR                            1492 06350000
*                  THEN                                            1492 06351000
         L     @06,CATACBPT                                        1492 06352000
         LTR   @06,@06                                             1492 06353000
         BZ    @RF01492                                            1492 06354000
*                    DO;                         /* CATALOG OPENED IN   06355000
*                                                   IDCAL01  @Y30SSJH*/ 06356000
*                                                                  1493 06357000
*                    CTGCNAME = OFF;                       /*@Y30SSJH*/ 06358000
         NI    CTGCNAME(@15),B'11111101'                           1494 06359000
*                    CTGCAT   = CATACBPT;                  /*@Y30SSJH*/ 06360000
*                                                                  1495 06361000
         ST    @06,CTGCAT(,@15)                                    1495 06362000
*                    END;                                  /*@Y30SSJH*/ 06363000
*                                                                  1496 06364000
*                  ELSE                                            1497 06365000
*                    IF (ADDR(CATLG)) ^= NULLPTR                   1497 06366000
*                      THEN                                        1497 06367000
         B     @RC01492                                            1497 06368000
@RF01492 L     @06,@PC00001+4                                      1497 06369000
         L     @06,FDTPTR+8(,@06)                                  1497 06370000
         LTR   @06,@06                                             1497 06371000
         BZ    @RF01497                                            1497 06372000
*                        CTGCAT = ADDR(CATLGVAL); /* CATALOG SPECI-     06373000
*                                                    FIED BUT NOT  1498 06374000
*                                                    OPENED  @Y30SSJH*/ 06375000
*                                                                  1498 06376000
         LA    @06,CATLGVAL(,@06)                                  1498 06377000
         L     @01,CTGPLPTR                                        1498 06378000
         ST    @06,CTGCAT(,@01)                                    1498 06379000
*                /****************************************************/ 06380000
*                /*                                          @Y30SSJH*/ 06381000
*                /* INITIALIZE THE PASSWORD ADDRESS - THE    @Y30SSJH*/ 06382000
*                /* CATALOG PASSWORD HAS THE HIGHEST         @Y30SSJH*/ 06383000
*                /* PRIORITY                                 @Y30SSJH*/ 06384000
*                /*                                          @Y30SSJH*/ 06385000
*                /****************************************************/ 06386000
*                                                                  1499 06387000
*                IF (ADDR(CATLG)) ^= NULLPTR                       1499 06388000
*                  THEN                                            1499 06389000
@RF01497 DS    0H                                                  1499 06390000
@RC01492 L     @06,@PC00001+4                                      1499 06391000
         L     @06,FDTPTR+8(,@06)                                  1499 06392000
         LTR   @06,@06                                             1499 06393000
         BZ    @RF01499                                            1499 06394000
*                    IF CATLGPLN ^= 0                              1500 06395000
*                      THEN                                        1500 06396000
         CLI   CATLGPLN(@06),0                                     1500 06397000
         BE    @RF01500                                            1500 06398000
*                        CTGPSWD = ADDR(CATLGPAS);         /*@Y30SSJH*/ 06399000
*                                                                  1501 06400000
         LA    @06,CATLGPAS(,@06)                                  1501 06401000
         L     @01,CTGPLPTR                                        1501 06402000
         ST    @06,CTGPSWD(,@01)                                   1501 06403000
*                IF CTGPSWD = NULLPTR                              1502 06404000
*                  THEN                                            1502 06405000
@RF01500 DS    0H                                                  1502 06406000
@RF01499 L     @06,CTGPLPTR                                        1502 06407000
         L     @15,CTGPSWD(,@06)                                   1502 06408000
         LTR   @15,@15                                             1502 06409000
         BNZ   @RF01502                                            1502 06410000
*                    IF NTRYPLN ^= 0                               1503 06411000
*                      THEN                                        1503 06412000
         L     @15,@PC00001+4                                      1503 06413000
         L     @15,FDTPTR(,@15)                                    1503 06414000
         CLI   NTRYPLN(@15),0                                      1503 06415000
         BE    @RF01503                                            1503 06416000
*                        CTGPSWD = ADDR(NTRYPAS);          /*@Y30SSJH*/ 06417000
*                                                                  1504 06418000
         LA    @15,NTRYPAS(,@15)                                   1504 06419000
         ST    @15,CTGPSWD(,@06)                                   1504 06420000
*                /****************************************************/ 06421000
*                /*                                          @Y30SSJH*/ 06422000
*                /* INITIALIZE THE FPL AND REFERENCE IT IN   @Y30SSJH*/ 06423000
*                /* THE CPL                                  @Y30SSJH*/ 06424000
*                /*                                          @Y30SSJH*/ 06425000
*                /****************************************************/ 06426000
*                                                                  1505 06427000
*                CTGNOFLD = 1;                             /*@Y30SSJH*/ 06428000
@RF01503 DS    0H                                                  1505 06429000
@RF01502 L     @06,CTGPLPTR                                        1505 06430000
         MVI   CTGNOFLD(@06),X'01'                                 1505 06431000
*                CTGFLPTR = ADDR(ALFPLRBA);                /*@Y30SSJH*/ 06432000
         L     @15,ALPRMPTR                                        1506 06433000
         LA    @14,ALFPLRBA(,@15)                                  1506 06434000
         ST    @14,CTGFLPTR                                        1506 06435000
*                ALFPLRBA = ''B;                           /*@Y30SSJH*/ 06436000
         XC    ALFPLRBA(16,@15),ALFPLRBA(@15)                      1507 06437000
*                CTGFLNG(1) = NULLPTR;                     /*@Y30SSJH*/ 06438000
         SLR   @15,@15                                             1508 06439000
         ST    @15,CTGFLNG(,@14)                                   1508 06440000
*                CTGFLPT(1) = NULLPTR;                     /*@Y30SSJH*/ 06441000
         ST    @15,CTGFLPT(,@14)                                   1509 06442000
*                CTGFIELD(1) = CTGFLPTR;                   /*@Y30SSJH*/ 06443000
*                                                                  1510 06444000
         ST    @14,CTGFIELD(,@06)                                  1510 06445000
*                CTGFLDNO = 1;                             /*@Y30SSJH*/ 06446000
         MVI   CTGFLDNO(@14),X'01'                                 1511 06447000
*                CTGFLDNM = ADDR(ALFLDNAM(4));             /*@Y30SSJH*/ 06448000
*                                                                  1512 06449000
         LA    @06,ALFLDNAM+24                                     1512 06450000
         ST    @06,CTGFLDNM(,@14)                                  1512 06451000
*                /****************************************************/ 06452000
*                /*                                          @Y30SSJH*/ 06453000
*                /* ISSUE THE CATALOG LOCATE REQUEST         @Y30SSJH*/ 06454000
*                /*                                          @Y30SSJH*/ 06455000
*                /****************************************************/ 06456000
*                                                                  1513 06457000
*                CALL IDCSACA0 (GDTTBL,CTGPLPTR);          /*@Y30SSJH*/ 06458000
*                                                                  1513 06459000
         L     @06,@PC00001                                        1513 06460000
         ST    @06,@AL00001                                        1513 06461000
         LA    @15,CTGPLPTR                                        1513 06462000
         ST    @15,@AL00001+4                                      1513 06463000
         L     @15,GDTCAT(,@06)                                    1513 06464000
         LA    @01,@AL00001                                        1513 06465000
         BALR  @14,@15                                             1513 06466000
*                RESPECIFY (RTNREG) RSTD;                  /*@Y30SSJH*/ 06467000
*                CTGRTNCC = RTNREG;                        /*@Y30SSJH*/ 06468000
         ST    RTNREG,CTGRTNCC                                     1515 06469000
*                RESPECIFY (RTNREG) UNRSTD;                /*@Y30SSJH*/ 06470000
*                                                                  1516 06471000
*                IF GDTDBG = NULLPTR                               1517 06472000
*                  THEN;                                           1517 06473000
         L     @06,@PC00001                                        1517 06474000
         L     @06,GDTDBG(,@06)                                    1517 06475000
         LTR   @06,@06                                             1517 06476000
         BZ    @RT01517                                            1517 06477000
*                  ELSE                                            1519 06478000
*                    CALL IDCDB010 (GDTTBL,'AL51');                1519 06479000
         L     @06,@PC00001                                        1519 06480000
         ST    @06,@AL00001                                        1519 06481000
         LA    @15,@CC01543                                        1519 06482000
         ST    @15,@AL00001+4                                      1519 06483000
         MVI   @AL00001+4,X'80'                                    1519 06484000
         L     @15,GDTDBG(,@06)                                    1519 06485000
         LA    @01,@AL00001                                        1519 06486000
         BALR  @14,@15                                             1519 06487000
*                                                          /*@Y30SSJH*/ 06488000
*                                                                  1520 06489000
*                IF CTGRTNCC ^= 0                                  1520 06490000
*                  THEN                                            1520 06491000
@RT01517 L     @06,CTGRTNCC                                        1520 06492000
         LTR   @06,@06                                             1520 06493000
         BZ    @RF01520                                            1520 06494000
*                    DO;                                   /*@Y30SSJH*/ 06495000
*                                                                  1521 06496000
*                    ALSTID = CATERROR;                    /*@Y30SSJH*/ 06497000
         MVC   ALSTID(5),@CB01016                                  1522 06498000
*                    RETURN;                               /*@Y30SSJH*/ 06499000
*                                                                  1523 06500000
         B     @EL00005                                            1523 06501000
*                    END;                                  /*@Y30SSJH*/ 06502000
*                                                                  1524 06503000
*                /****************************************************/ 06504000
*                /*                                          @Y30SSJH*/ 06505000
*                /* CHECK THE HIGH-USED RBA OF THE AIX DATA  @Y30SSJH*/ 06506000
*                /* OBJECT - IF IT IS NON-ZERO, RETURN WITH  @Y30SSJH*/ 06507000
*                /* ERROR INDICATED                          @Y30SSJH*/ 06508000
*                /*                                          @Y30SSJH*/ 06509000
*                /****************************************************/ 06510000
*                                                                  1525 06511000
*                IF CTGFLNG(1) = NULLPTR |                         1525 06512000
*                   HURBADS ^= NULLPTR                             1525 06513000
*                  THEN                                            1525 06514000
@RF01520 SLR   @06,@06                                             1525 06515000
         L     @01,CTGFLPTR                                        1525 06516000
         C     @06,CTGFLNG(,@01)                                   1525 06517000
         BE    @RT01525                                            1525 06518000
         C     @06,HURBADS                                         1525 06519000
         BE    @RF01525                                            1525 06520000
@RT01525 DS    0H                                                  1526 06521000
*                    DO;                                   /*@Y30SSJH*/ 06522000
*                                                                  1526 06523000
*                    ALSTID = UNQUPGER;                    /*@Y30SSJH*/ 06524000
         MVC   ALSTID(5),@CB01031                                  1527 06525000
*                    RETURN;                               /*@Y30SSJH*/ 06526000
*                                                                  1528 06527000
         B     @EL00005                                            1528 06528000
*                    END;                                  /*@Y30SSJH*/ 06529000
*                                                                  1529 06530000
*                END UPGVERF;                              /*@Y30SSJH*/ 06531000
*                                                                  1530 06532000
@RF01525 DS    0H                                                  1531 06533000
*            END UPGLOOP;                                  /*@Y30SSJH*/ 06534000
*        /************************************************************/ 06535000
*        /*                                                  @Y30SSJH*/ 06536000
*        /* VERIFICATION OF KEYS AND RECORDSIZE PARAMETERS   @Y30SSJH*/ 06537000
*        /*                                                  @Y30SSJH*/ 06538000
*        /************************************************************/ 06539000
*                                                                  1532 06540000
*        IF (ADDR(KEY)) ^= NULLPTR   |                             1532 06541000
*           (ADDR(RECSZ)) ^= NULLPTR                               1532 06542000
*          THEN                                                    1532 06543000
@RF01464 SLR   @06,@06                                             1532 06544000
         L     @15,@PC00001+4                                      1532 06545000
         C     @06,FDTPTR+220(,@15)                                1532 06546000
         BNE   @RT01532                                            1532 06547000
         C     @06,FDTPTR+232(,@15)                                1532 06548000
         BE    @RF01532                                            1532 06549000
@RT01532 DS    0H                                                  1533 06550000
*KEYRECLP:   DO;                                           /*@Y30SSJH*/ 06551000
*                                                                  1533 06552000
KEYRECLP DS    0H                                                  1534 06553000
*            /********************************************************/ 06554000
*            /*                                              @Y30SSJH*/ 06555000
*            /* VERIFY KEYS/RECORDSIZE SPECIFIED FOR VALID   @Y30SSJH*/ 06556000
*            /* OBJECT                                       @Y30SSJH*/ 06557000
*            /*                                              @Y30SSJH*/ 06558000
*            /********************************************************/ 06559000
*                                                                  1534 06560000
*            IF LCETYPVL ^= 'R' &                                  1534 06561000
*               LCETYPVL ^= 'G' &                                  1534 06562000
*               LCETYPVL ^= 'C' &                                  1534 06563000
*               LCETYPVL ^= 'D'                                    1534 06564000
*              THEN                                                1534 06565000
         L     @06,LCETYPPT                                        1534 06566000
         CLI   LCETYPVL(@06),C'R'                                  1534 06567000
         BE    @RF01534                                            1534 06568000
         CLI   LCETYPVL(@06),C'G'                                  1534 06569000
         BE    @RF01534                                            1534 06570000
         CLI   LCETYPVL(@06),C'C'                                  1534 06571000
         BE    @RF01534                                            1534 06572000
         CLI   LCETYPVL(@06),C'D'                                  1534 06573000
         BE    @RF01534                                            1534 06574000
*                DO;                                       /*@Y30SSJH*/ 06575000
*                                                                  1535 06576000
*                KEYRECRC = 12;                            /*@Y30SSJH*/ 06577000
         MVC   KEYRECRC(4),@CF00035                                1536 06578000
*                ALSTID = INVKYREC;                        /*@Y30SSJH*/ 06579000
         MVC   ALSTID(5),@CB01076                                  1537 06580000
*                RETURN;                                   /*@Y30SSJH*/ 06581000
*                                                                  1538 06582000
         B     @EL00005                                            1538 06583000
*                END;                                      /*@Y30SSJH*/ 06584000
*                                                                  1539 06585000
*            /********************************************************/ 06586000
*            /*                                              @Y30SSJH*/ 06587000
*            /* PRIMARY LOCATE WAS FOR A CLUSTER OBJECT.     @Y30SSJH*/ 06588000
*            /* STORE ASSOCIATIONS AND ENTRY TYPE FOR FUTURE @Y30SSJH*/ 06589000
*            /* REFERENCE.                                   @Y30SSJH*/ 06590000
*            /*                                              @Y30SSJH*/ 06591000
*            /********************************************************/ 06592000
*                                                                  1540 06593000
*            CKTYPE = LCETYPVL;                            /*@Y30SSJH*/ 06594000
@RF01534 L     @06,LCETYPPT                                        1540 06595000
         MVC   CKTYPE(1),LCETYPVL(@06)                             1540 06596000
*            BYPASSSW = STOP;                              /*@Y30SSJH*/ 06597000
         MVI   BYPASSSW,X'0F'                                      1541 06598000
*            IF CKTYPE = 'C'                                       1542 06599000
*              THEN                                                1542 06600000
         CLI   CKTYPE,C'C'                                         1542 06601000
         BNE   @RF01542                                            1542 06602000
*                DO;                                       /*@Y30SSJH*/ 06603000
*                                                                  1543 06604000
*                DATACI = LCNAMCI(1);                      /*@Y30SSJH*/ 06605000
         L     @06,LCNAMPT                                         1544 06606000
         MVC   DATACI(3),LCNAMCI(@06)                              1544 06607000
*                IF LCNAMLN    >= 8   &                            1545 06608000
*                   LCNAMID(2) = 'I'                               1545 06609000
*                  THEN                                            1545 06610000
         L     @15,LCNAMLN                                         1545 06611000
         C     @15,@CF00039                                        1545 06612000
         BL    @RF01545                                            1545 06613000
         CLI   LCNAMID+4(@06),C'I'                                 1545 06614000
         BNE   @RF01545                                            1545 06615000
*                    INDEXCI = LCNAMCI(2);                 /*@Y30SSJH*/ 06616000
*                                                                  1546 06617000
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1546 06618000
*                END;                                      /*@Y30SSJH*/ 06619000
*                                                                  1547 06620000
*              /******************************************************/ 06621000
*              /*                                            @Y30SSJH*/ 06622000
*              /* THE PRIMARY LOCATE WAS FOR A               @Y30SSJH*/ 06623000
*              /* PATH  OBJECT. STORE ASSOCIATIONS FOR       @Y30SSJH*/ 06624000
*              /* FUTURE REFERENCE.                          @Y30SSJH*/ 06625000
*              /*                                            @Y30SSJH*/ 06626000
*              /******************************************************/ 06627000
*                                                                  1548 06628000
*              ELSE                                                1548 06629000
*                IF CKTYPE = 'R'                                   1548 06630000
*                  THEN                                            1548 06631000
         B     @RC01542                                            1548 06632000
@RF01542 CLI   CKTYPE,C'R'                                         1548 06633000
         BNE   @RF01548                                            1548 06634000
*                    DO;                                   /*@Y30SSJH*/ 06635000
*                                                                  1549 06636000
*                    IF LCNAMID(1) = 'G'                           1550 06637000
*                      THEN                                        1550 06638000
         L     @06,LCNAMPT                                         1550 06639000
         CLI   LCNAMID(@06),C'G'                                   1550 06640000
         BNE   @RF01550                                            1550 06641000
*                        DO;                               /*@Y30SSJH*/ 06642000
*                                                                  1551 06643000
*                        DATACI = LCNAMCI(2);              /*@Y30SSJH*/ 06644000
         MVC   DATACI(3),LCNAMCI+4(@06)                            1552 06645000
*                        INDEXCI = LCNAMCI(3);             /*@Y30SSJH*/ 06646000
         MVC   INDEXCI(3),LCNAMCI+8(@06)                           1553 06647000
*                        BDATACI = LCNAMCI(4);             /*@Y30SSJH*/ 06648000
         MVC   BDATACI(3),LCNAMCI+12(@06)                          1554 06649000
*                        CKTYPE = 'G';                     /*@Y30SSJH*/ 06650000
*                                                                  1555 06651000
         MVI   CKTYPE,C'G'                                         1555 06652000
*                        END;                              /*@Y30SSJH*/ 06653000
*                      ELSE                                        1557 06654000
*                        DO;                               /*@Y30SSJH*/ 06655000
*                                                                  1557 06656000
         B     @RC01550                                            1557 06657000
@RF01550 DS    0H                                                  1558 06658000
*                        DATACI = LCNAMCI(2);              /*@Y30SSJH*/ 06659000
         L     @06,LCNAMPT                                         1558 06660000
         MVC   DATACI(3),LCNAMCI+4(@06)                            1558 06661000
*                        IF LCNAMLN >= 12  &                       1559 06662000
*                           LCNAMID(3) = 'I'                       1559 06663000
*                          THEN                                    1559 06664000
         L     @15,LCNAMLN                                         1559 06665000
         C     @15,@CF00035                                        1559 06666000
         BL    @RF01559                                            1559 06667000
         CLI   LCNAMID+8(@06),C'I'                                 1559 06668000
         BNE   @RF01559                                            1559 06669000
*                            INDEXCI = LCNAMCI(3);         /*@Y30SSJH*/ 06670000
         MVC   INDEXCI(3),LCNAMCI+8(@06)                           1560 06671000
*                        CKTYPE = 'C';                     /*@Y30SSJH*/ 06672000
*                                                                  1561 06673000
@RF01559 MVI   CKTYPE,C'C'                                         1561 06674000
*                        END;                              /*@Y30SSJH*/ 06675000
*                    END;                                  /*@Y30SSJH*/ 06676000
*                                                                  1563 06677000
*                  /**************************************************/ 06678000
*                  /*                                        @Y30SSJH*/ 06679000
*                  /* THE PRIMARY LOCATE WAS FOR AN ALTERNATE        */ 06680000
*                  /* INDEX OBJECT. STORE ASSOCIATIONS       @Y30SSJH*/ 06681000
*                  /* FOR FUTURE REFERENCE.                  @Y30SSJH*/ 06682000
*                  /*                                        @Y30SSJH*/ 06683000
*                  /**************************************************/ 06684000
*                                                                  1564 06685000
*                  ELSE                                            1564 06686000
*                    IF CKTYPE = 'G'                               1564 06687000
*                      THEN                                        1564 06688000
         B     @RC01548                                            1564 06689000
@RF01548 CLI   CKTYPE,C'G'                                         1564 06690000
         BNE   @RF01564                                            1564 06691000
*                        DO;                               /*@Y30SSJH*/ 06692000
*                                                                  1565 06693000
*                        DATACI = LCNAMCI(1);              /*@Y30SSJH*/ 06694000
         L     @06,LCNAMPT                                         1566 06695000
         MVC   DATACI(3),LCNAMCI(@06)                              1566 06696000
*                        INDEXCI = LCNAMCI(2);             /*@Y30SSJH*/ 06697000
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1567 06698000
*                        BCLUSCI = LCNAMCI(3);             /*@Y30SSJH*/ 06699000
*                                                                  1568 06700000
         MVC   BCLUSCI(3),LCNAMCI+8(@06)                           1568 06701000
*                        END;                              /*@Y30SSJH*/ 06702000
*                                                                  1570 06703000
*                      /**********************************************/ 06704000
*                      /*                                    @Y30SSJH*/ 06705000
*                      /* PRIMARY LOCATE WAS FOR A DATA OBJECT.      */ 06706000
*                      /* ENSURE DATA OBJECT ASSOCIATED WITH A       */ 06707000
*                      /* AIX OR CLUSTER.                    @Y30SSJH*/ 06708000
*                      /*                                    @Y30SSJH*/ 06709000
*                      /**********************************************/ 06710000
*                                                                  1570 06711000
*                      ELSE                                        1570 06712000
*                        DO;                               /*@Y30SSJH*/ 06713000
*                                                                  1570 06714000
         B     @RC01564                                            1570 06715000
@RF01564 DS    0H                                                  1571 06716000
*                        CKTYPE = LCNAMID(1);              /*@Y30SSJH*/ 06717000
         L     @06,LCNAMPT                                         1571 06718000
         MVC   CKTYPE(1),LCNAMID(@06)                              1571 06719000
*                        IF CKTYPE ^= 'C'   &                      1572 06720000
*                           CKTYPE ^= 'G'                          1572 06721000
*                          THEN                                    1572 06722000
         CLI   CKTYPE,C'C'                                         1572 06723000
         BE    @RF01572                                            1572 06724000
         CLI   CKTYPE,C'G'                                         1572 06725000
         BE    @RF01572                                            1572 06726000
*                            DO;                           /*@Y30SSJH*/ 06727000
*                            KEYRECRC = 12;                /*@Y30SSJH*/ 06728000
         MVC   KEYRECRC(4),@CF00035                                1574 06729000
*                            ALSTID = INVKYREC;            /*@Y30SSJH*/ 06730000
         MVC   ALSTID(5),@CB01076                                  1575 06731000
*                            RETURN;                       /*@Y30SSJH*/ 06732000
         B     @EL00005                                            1576 06733000
*                            END;                          /*@Y30SSJH*/ 06734000
*                                                                  1577 06735000
*                        END;                              /*@Y30SSJH*/ 06736000
@RF01572 DS    0H                                                  1579 06737000
*            /********************************************************/ 06738000
*            /*                                              @Y30SSJH*/ 06739000
*            /* CALL LOCATPRC TO LOCATE DATA OBJECT TO BE    @Y30SSJH*/ 06740000
*            /* ALTERED                                      @Y30SSJH*/ 06741000
*            /*                                              @Y30SSJH*/ 06742000
*            /********************************************************/ 06743000
*                                                                  1579 06744000
*            IF LCETYPVL ^= 'D'                                    1579 06745000
*              THEN                                                1579 06746000
@RC01564 DS    0H                                                  1579 06747000
@RC01548 DS    0H                                                  1579 06748000
@RC01542 L     @06,LCETYPPT                                        1579 06749000
         CLI   LCETYPVL(@06),C'D'                                  1579 06750000
         BE    @RF01579                                            1579 06751000
*                DO;                                       /*@Y30SSJH*/ 06752000
*                                                                  1580 06753000
*                LOCTABLE = ''B;                           /*@Y30SSJH*/ 06754000
         XC    LOCTABLE(80),LOCTABLE                               1581 06755000
*                CALL LOCATPRC;                            /*@Y30SSJH*/ 06756000
         BAL   @14,LOCATPRC                                        1582 06757000
*                IF ALSTID ^= NORMAL                               1583 06758000
*                  THEN                                            1583 06759000
         CLC   ALSTID(5),@CB01034                                  1583 06760000
         BE    @RF01583                                            1583 06761000
*                    DO;                                   /*@Y30SSJH*/ 06762000
*                                                                  1584 06763000
*                    KEYRECRC = 12;                        /*@Y30SSJH*/ 06764000
         MVC   KEYRECRC(4),@CF00035                                1585 06765000
*                    RETURN;                               /*@Y30SSJH*/ 06766000
*                                                                  1586 06767000
         B     @EL00005                                            1586 06768000
*                    END;                                  /*@Y30SSJH*/ 06769000
*                                                                  1587 06770000
*                END;                                      /*@Y30SSJH*/ 06771000
*                                                                  1588 06772000
*              /******************************************************/ 06773000
*              /*                                            @Y30SSJH*/ 06774000
*              /* DATA OBJECT TO BE ALTERED HAS ALREADY BEEN @Y30SSJH*/ 06775000
*              /* LOCATED. LOCATE C OR G ASSOCIATION FOR     @Y30SSJH*/ 06776000
*              /* OBJECT.                                    @Y30SSJH*/ 06777000
*              /*                                            @Y30SSJH*/ 06778000
*              /******************************************************/ 06779000
*                                                                  1589 06780000
*              ELSE                                                1589 06781000
*DATALOOP:       DO;                                       /*@Y30SSJH*/ 06782000
*                                                                  1589 06783000
         B     @RC01579                                            1589 06784000
@RF01579 DS    0H                                                  1589 06785000
DATALOOP DS    0H                                                  1590 06786000
*                CTGPLPTR = ADDR(ALCTGPL);                 /*@Y30SSJH*/ 06787000
         L     @06,ALPRMPTR                                        1590 06788000
         LA    @15,ALCTGPL(,@06)                                   1590 06789000
         ST    @15,CTGPLPTR                                        1590 06790000
*                ALCTGPL = ''B;                            /*@Y30SSJH*/ 06791000
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        1591 06792000
*                CTGENT = ADDR(LCNAMCI(1));                /*@Y30SSJH*/ 06793000
         L     @06,LCNAMPT                                         1592 06794000
         LA    @06,LCNAMCI(,@06)                                   1592 06795000
         ST    @06,CTGENT(,@15)                                    1592 06796000
*                CTGCNAME = ON;                            /*@Y30SSJH*/ 06797000
         OI    CTGCNAME(@15),B'00000010'                           1593 06798000
*                CTGFUNC = CTGLOC;                         /*@Y30SSJH*/ 06799000
         NI    CTGFUNC(@15),B'00111111'                            1594 06800000
         OI    CTGFUNC(@15),B'00100000'                            1594 06801000
*                CTGNUM = ON;                              /*@Y30SSJH*/ 06802000
*                CTGAM0 = ON;                              /*@Y30SSJH*/ 06803000
         OI    CTGNUM(@15),B'00000011'                             1596 06804000
*                CTGBYPSS = ON;                            /*@Y30SSJH*/ 06805000
         OI    CTGBYPSS(@15),B'10000000'                           1597 06806000
*                ASSOCWKA = ''B;                           /*@Y30SSJH*/ 06807000
         XC    ASSOCWKA(32),ASSOCWKA                               1598 06808000
*                CTGWKA = ADDR(ASSOCWKA);                  /*@Y30SSJH*/ 06809000
         LA    @06,ASSOCWKA                                        1599 06810000
         ST    @06,CTGWKA(,@15)                                    1599 06811000
*                ASSTOTLN = LENGTH(ASSOCWKA);              /*@Y30SSJH*/ 06812000
*                                                                  1600 06813000
         MVC   ASSTOTLN(2),@CH00222                                1600 06814000
*                /****************************************************/ 06815000
*                /*                                          @Y30SSJH*/ 06816000
*                /* SET THE CPL TO REFERENCE THE CATALOG IN  @Y30SSJH*/ 06817000
*                /* WHICH THE ENTRY RESIDES.                 @Y30SSJH*/ 06818000
*                /*                                          @Y30SSJH*/ 06819000
*                /****************************************************/ 06820000
*                                                                  1601 06821000
*                IF CATACBPT ^= NULLPTR                            1601 06822000
*                  THEN                                            1601 06823000
         L     @06,CATACBPT                                        1601 06824000
         LTR   @06,@06                                             1601 06825000
         BZ    @RF01601                                            1601 06826000
*                    DO;                                   /*@Y30SSJH*/ 06827000
*                                                                  1602 06828000
*                    CTGCNAME = OFF;                       /*@Y30SSJH*/ 06829000
         NI    CTGCNAME(@15),B'11111101'                           1603 06830000
*                    CTGCAT = CATACBPT;                    /*@Y30SSJH*/ 06831000
*                                                                  1604 06832000
         ST    @06,CTGCAT(,@15)                                    1604 06833000
*                    END;                                  /*@Y30SSJH*/ 06834000
*                  ELSE                                            1606 06835000
*                    IF (ADDR(CATLG)) ^= NULLPTR                   1606 06836000
*                      THEN                                        1606 06837000
         B     @RC01601                                            1606 06838000
@RF01601 L     @06,@PC00001+4                                      1606 06839000
         L     @06,FDTPTR+8(,@06)                                  1606 06840000
         LTR   @06,@06                                             1606 06841000
         BZ    @RF01606                                            1606 06842000
*                        CTGCAT = ADDR(CATLGVAL);          /*@Y30SSJH*/ 06843000
*                                                                  1607 06844000
         LA    @06,CATLGVAL(,@06)                                  1607 06845000
         L     @01,CTGPLPTR                                        1607 06846000
         ST    @06,CTGCAT(,@01)                                    1607 06847000
*                /****************************************************/ 06848000
*                /*                                          @Y30SSJH*/ 06849000
*                /* INITIALIZE THE PASSWORD ADDRESS          @Y30SSJH*/ 06850000
*                /*                                          @Y30SSJH*/ 06851000
*                /****************************************************/ 06852000
*                                                                  1608 06853000
*                IF (ADDR(CATLG)) ^= NULLPTR                       1608 06854000
*                  THEN                                            1608 06855000
@RF01606 DS    0H                                                  1608 06856000
@RC01601 L     @06,@PC00001+4                                      1608 06857000
         L     @06,FDTPTR+8(,@06)                                  1608 06858000
         LTR   @06,@06                                             1608 06859000
         BZ    @RF01608                                            1608 06860000
*                    IF CATLGPLN ^= 0                              1609 06861000
*                      THEN                                        1609 06862000
         CLI   CATLGPLN(@06),0                                     1609 06863000
         BE    @RF01609                                            1609 06864000
*                        CTGPSWD = ADDR(CATLGPAS);         /*@Y30SSJH*/ 06865000
         LA    @06,CATLGPAS(,@06)                                  1610 06866000
         L     @01,CTGPLPTR                                        1610 06867000
         ST    @06,CTGPSWD(,@01)                                   1610 06868000
*                IF CTGPSWD = NULLPTR                              1611 06869000
*                  THEN                                            1611 06870000
@RF01609 DS    0H                                                  1611 06871000
@RF01608 L     @06,CTGPLPTR                                        1611 06872000
         L     @15,CTGPSWD(,@06)                                   1611 06873000
         LTR   @15,@15                                             1611 06874000
         BNZ   @RF01611                                            1611 06875000
*                    IF NTRYPLN ^= 0                               1612 06876000
*                      THEN                                        1612 06877000
         L     @15,@PC00001+4                                      1612 06878000
         L     @15,FDTPTR(,@15)                                    1612 06879000
         CLI   NTRYPLN(@15),0                                      1612 06880000
         BE    @RF01612                                            1612 06881000
*                        CTGPSWD = ADDR(NTRYPAS);          /*@Y30SSJH*/ 06882000
*                                                                  1613 06883000
         LA    @15,NTRYPAS(,@15)                                   1613 06884000
         ST    @15,CTGPSWD(,@06)                                   1613 06885000
*                /****************************************************/ 06886000
*                /*                                          @Y30SSJH*/ 06887000
*                /* INITIALIZE THE FPL AND REFERENCE IT IN   @Y30SSJH*/ 06888000
*                /* THE CPL                                  @Y30SSJH*/ 06889000
*                /*                                          @Y30SSJH*/ 06890000
*                /****************************************************/ 06891000
*                                                                  1614 06892000
*                CTGNOFLD = 1;                             /*@Y30SSJH*/ 06893000
@RF01612 DS    0H                                                  1614 06894000
@RF01611 L     @06,CTGPLPTR                                        1614 06895000
         MVI   CTGNOFLD(@06),X'01'                                 1614 06896000
*                CTGFLPTR = ADDR(ALFPLNAM);                /*@Y30SSJH*/ 06897000
         L     @15,ALPRMPTR                                        1615 06898000
         LA    @14,ALFPLNAM(,@15)                                  1615 06899000
         ST    @14,CTGFLPTR                                        1615 06900000
*                ALFPLNAM = ''B;                           /*@Y30SSJH*/ 06901000
         XC    ALFPLNAM(16,@15),ALFPLNAM(@15)                      1616 06902000
*                CTGFLNG(1) = NULLPTR;                     /*@Y30SSJH*/ 06903000
         SLR   @05,@05                                             1617 06904000
         ST    @05,CTGFLNG(,@14)                                   1617 06905000
*                CTGFLPT(1) = NULLPTR;                     /*@Y30SSJH*/ 06906000
         ST    @05,CTGFLPT(,@14)                                   1618 06907000
*                CTGFIELD(1) = CTGFLPTR;                   /*@Y30SSJH*/ 06908000
         ST    @14,CTGFIELD(,@06)                                  1619 06909000
*                CTGFLDNO = 1;                             /*@Y30SSJH*/ 06910000
         MVI   CTGFLDNO(@14),X'01'                                 1620 06911000
*                CTGFLDNM = ADDR(ALFLDNAM(3));             /*@Y30SSJH*/ 06912000
*                                                                  1621 06913000
         LA    @06,ALFLDNAM+16                                     1621 06914000
         ST    @06,CTGFLDNM(,@14)                                  1621 06915000
*                /****************************************************/ 06916000
*                /*                                          @Y30SSJH*/ 06917000
*                /* INITIALIZE NAMEDS TEST FPL AND REFERENCE @Y30SSJH*/ 06918000
*                /* IT IN THE NAMEDS FPL - THIS LIMITS THE   @Y30SSJH*/ 06919000
*                /* NUMBER OF ASSOCIATIONS RETURNED TO FIVE. @Y30SSJH*/ 06920000
*                /*                                          @Y30SSJH*/ 06921000
*                /****************************************************/ 06922000
*                                                                  1622 06923000
*                CTGFLPTR = ADDR(ALFPLTST);                /*@Y30SSJH*/ 06924000
         LA    @06,ALFPLTST(,@15)                                  1622 06925000
         ST    @06,CTGFLPTR                                        1622 06926000
*                ALFPLTST = ''B;                           /*@Y30SSJH*/ 06927000
         XC    ALFPLTST(16,@15),ALFPLTST(@15)                      1623 06928000
*                CTGFLDNO = 1;                             /*@Y30SSJH*/ 06929000
         MVI   CTGFLDNO(@06),X'01'                                 1624 06930000
*                CTGFLDCD = CTGFLDLE;                      /*@Y30SSJH*/ 06931000
         MVI   CTGFLDCD(@06),X'C0'                                 1625 06932000
*                CTGFLDNM = ADDR(ALFLDNAM(16));            /*@Y30SSJH*/ 06933000
         LA    @14,ALFLDNAM+120                                    1626 06934000
         ST    @14,CTGFLDNM(,@06)                                  1626 06935000
*                CTGFLNG(1) = 2;                           /*@Y30SSJH*/ 06936000
         MVC   CTGFLNG(4,@06),@CF00155                             1627 06937000
*                CTGFLPT(1) = ADDR(NAMEMASK);              /*@Y30SSJH*/ 06938000
         LA    @14,NAMEMASK                                        1628 06939000
         ST    @14,CTGFLPT(,@06)                                   1628 06940000
*                CTGFLPTR = ADDR(ALFPLNAM);                /*@Y30SSJH*/ 06941000
         LA    @06,ALFPLNAM(,@15)                                  1629 06942000
         ST    @06,CTGFLPTR                                        1629 06943000
*                CTGFLCHN = ADDR(ALFPLTST);                /*@Y30SSJH*/ 06944000
*                                                                  1630 06945000
         LA    @15,ALFPLTST(,@15)                                  1630 06946000
         ST    @15,CTGFLCHN(,@06)                                  1630 06947000
*                /****************************************************/ 06948000
*                /*                                          @Y30SSJH*/ 06949000
*                /* ISSUE CATALOG LOCATE REQUEST             @Y30SSJH*/ 06950000
*                /*                                          @Y30SSJH*/ 06951000
*                /****************************************************/ 06952000
*                                                                  1631 06953000
*                CALL IDCSACA0 (GDTTBL,CTGPLPTR);          /*@Y30SSJH*/ 06954000
*                                                                  1631 06955000
         L     @06,@PC00001                                        1631 06956000
         ST    @06,@AL00001                                        1631 06957000
         LA    @15,CTGPLPTR                                        1631 06958000
         ST    @15,@AL00001+4                                      1631 06959000
         L     @15,GDTCAT(,@06)                                    1631 06960000
         LA    @01,@AL00001                                        1631 06961000
         BALR  @14,@15                                             1631 06962000
*                RESPECIFY (RTNREG) RSTD;                  /*@Y30SSJH*/ 06963000
*                CTGRTNCC = RTNREG;                        /*@Y30SSJH*/ 06964000
         ST    RTNREG,CTGRTNCC                                     1633 06965000
*                RESPECIFY (RTNREG) UNRSTD;                /*@Y30SSJH*/ 06966000
*                                                                  1634 06967000
*                IF GDTDBG = NULLPTR                               1635 06968000
*                  THEN;                                           1635 06969000
         L     @06,@PC00001                                        1635 06970000
         L     @06,GDTDBG(,@06)                                    1635 06971000
         LTR   @06,@06                                             1635 06972000
         BZ    @RT01635                                            1635 06973000
*                  ELSE                                            1637 06974000
*                    CALL IDCDB010 (GDTTBL,'AL52');                1637 06975000
         L     @06,@PC00001                                        1637 06976000
         ST    @06,@AL00001                                        1637 06977000
         LA    @15,@CC01552                                        1637 06978000
         ST    @15,@AL00001+4                                      1637 06979000
         MVI   @AL00001+4,X'80'                                    1637 06980000
         L     @15,GDTDBG(,@06)                                    1637 06981000
         LA    @01,@AL00001                                        1637 06982000
         BALR  @14,@15                                             1637 06983000
*                                                          /*@Y30SSJH*/ 06984000
*                                                                  1638 06985000
*                IF CTGRTNCC ^= 0                                  1638 06986000
*                  THEN                                            1638 06987000
@RT01635 L     @06,CTGRTNCC                                        1638 06988000
         LTR   @06,@06                                             1638 06989000
         BZ    @RF01638                                            1638 06990000
*                    DO;                                   /*@Y30SSJH*/ 06991000
*                                                                  1639 06992000
*                    KEYRECRC = 12;                        /*@Y30SSJH*/ 06993000
         MVC   KEYRECRC(4),@CF00035                                1640 06994000
*                    ALSTID = CATERROR;                    /*@Y30SSJH*/ 06995000
         MVC   ALSTID(5),@CB01016                                  1641 06996000
*                    RETURN;                               /*@Y30SSJH*/ 06997000
*                                                                  1642 06998000
         B     @EL00005                                            1642 06999000
*                    END;                                  /*@Y30SSJH*/ 07000000
*                                                                  1643 07001000
*                /****************************************************/ 07002000
*                /*                                          @Y30SSJH*/ 07003000
*                /* SAVE THE ASSOCIATIONS                    @Y30SSJH*/ 07004000
*                /*                                          @Y30SSJH*/ 07005000
*                /****************************************************/ 07006000
*                                                                  1644 07007000
*                CTGFLPTR = ADDR(ALFPLNAM);                /*@Y30SSJH*/ 07008000
@RF01638 L     @06,ALPRMPTR                                        1644 07009000
         LA    @06,ALFPLNAM(,@06)                                  1644 07010000
         ST    @06,CTGFLPTR                                        1644 07011000
*                IF CTGFLNG(1) = NULLPTR        |                  1645 07012000
*                   CTGFLPT(1) -> LCNAMEDS(1,1:4) = NULLMASK(1:4)  1645 07013000
*                  THEN                                            1645 07014000
         L     @15,CTGFLNG(,@06)                                   1645 07015000
         LTR   @15,@15                                             1645 07016000
         BZ    @RT01645                                            1645 07017000
         L     @06,CTGFLPT(,@06)                                   1645 07018000
         CLC   LCNAMEDS(4,@06),NULLMASK                            1645 07019000
         BNE   @RF01645                                            1645 07020000
@RT01645 DS    0H                                                  1646 07021000
*                    DO;                                   /*@Y30SSJH*/ 07022000
*                                                                  1646 07023000
*                    KEYRECRC = 12;                        /*@Y30SSJH*/ 07024000
         MVC   KEYRECRC(4),@CF00035                                1647 07025000
*                    ALSTID = LOCRTNER;                    /*@Y30SSJH*/ 07026000
         MVC   ALSTID(5),@CB01025                                  1648 07027000
*                    RETURN;                               /*@Y30SSJH*/ 07028000
*                                                                  1649 07029000
         B     @EL00005                                            1649 07030000
*                    END;                                  /*@Y30SSJH*/ 07031000
*                                                                  1650 07032000
*                DATACI = CTGFLPT(1) -> LCNAMCI(1);        /*@Y30SSJH*/ 07033000
@RF01645 L     @06,CTGFLPTR                                        1651 07034000
         L     @06,CTGFLPT(,@06)                                   1651 07035000
         MVC   DATACI(3),LCNAMCI(@06)                              1651 07036000
*                /****************************************************/ 07037000
*                /*                                          @Y30SSJH*/ 07038000
*                /* THIS SECONDARY LOCATE WAS FOR A 'G'      @Y30SSJH*/ 07039000
*                /* OBJECT. SAVE ITS ASSOCIATIONS FOR FUTURE @Y30SSJH*/ 07040000
*                /* USE.                                     @Y30SSJH*/ 07041000
*                /*                                          @Y30SSJH*/ 07042000
*                /****************************************************/ 07043000
*                                                                  1652 07044000
*                IF CKTYPE = 'G'                                   1652 07045000
*                  THEN                                            1652 07046000
         CLI   CKTYPE,C'G'                                         1652 07047000
         BNE   @RF01652                                            1652 07048000
*                    DO;                                   /*@Y30SSJH*/ 07049000
*                                                                  1653 07050000
*                    INDEXCI = CTGFLPT(1) -> LCNAMCI(2);   /*@Y30SSJH*/ 07051000
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1654 07052000
*                    BCLUSCI = CTGFLPT(1) -> LCNAMCI(3);   /*@Y30SSJH*/ 07053000
*                                                                  1655 07054000
         MVC   BCLUSCI(3),LCNAMCI+8(@06)                           1655 07055000
*                    END;                                  /*@Y30SSJH*/ 07056000
*                                                                  1656 07057000
*                  /**************************************************/ 07058000
*                  /*                                        @Y30SSJH*/ 07059000
*                  /* THIS SECONDARY LOCATE WAS FOR 'C'      @Y30SSJH*/ 07060000
*                  /* OBJECT .SAVE ITS ASSOCIATIONS FOR      @Y30SSJH*/ 07061000
*                  /* FUTURE USE.                            @Y30SSJH*/ 07062000
*                  /*                                        @Y30SSJH*/ 07063000
*                  /**************************************************/ 07064000
*                                                                  1657 07065000
*                  ELSE                                            1657 07066000
*                    DO;                                   /*@Y30SSJH*/ 07067000
*                                                                  1657 07068000
         B     @RC01652                                            1657 07069000
@RF01652 DS    0H                                                  1658 07070000
*                    IF CTGFLNG(1) >= 8  &                         1658 07071000
*                       CTGFLPT(1) -> LCNAMID(2) = 'I'             1658 07072000
*                      THEN                                        1658 07073000
         L     @06,CTGFLPTR                                        1658 07074000
         L     @15,CTGFLNG(,@06)                                   1658 07075000
         C     @15,@CF00039                                        1658 07076000
         BL    @RF01658                                            1658 07077000
         L     @06,CTGFLPT(,@06)                                   1658 07078000
         CLI   LCNAMID+4(@06),C'I'                                 1658 07079000
         BNE   @RF01658                                            1658 07080000
*                        INDEXCI = CTGFLPT(1) -> LCNAMCI(2);       1659 07081000
*                                                                  1659 07082000
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1659 07083000
*                    END;                                  /*@Y30SSJH*/ 07084000
@RF01658 DS    0H                                                  1661 07085000
*                END DATALOOP;                             /*@Y30SSJH*/ 07086000
*                                                                  1661 07087000
@RC01652 DS    0H                                                  1662 07088000
*            /********************************************************/ 07089000
*            /*                                              @Y30SSJH*/ 07090000
*            /* KEYS/RECORDSIZE PARAMETERS VALID ONLY FOR AN @Y30SSJH*/ 07091000
*            /* EMPTY DATA SET                               @Y30SSJH*/ 07092000
*            /*                                              @Y30SSJH*/ 07093000
*            /********************************************************/ 07094000
*                                                                  1662 07095000
*            IF LCRBAPT = NULLPTR  |                               1662 07096000
*               LCHURBA ^= 0                                       1662 07097000
*              THEN                                                1662 07098000
@RC01579 L     @06,LCRBAPT                                         1662 07099000
         SLR   @15,@15                                             1662 07100000
         CR    @06,@15                                             1662 07101000
         BE    @RT01662                                            1662 07102000
         ICM   @14,15,LCHURBA(@06)                                 1662 07103000
         CLR   @15,@14                                             1662 07104000
         BE    @RF01662                                            1662 07105000
@RT01662 DS    0H                                                  1663 07106000
*                DO;                                       /*@Y30SSJH*/ 07107000
*                                                                  1663 07108000
*                KEYRECRC = 12;                            /*@Y30SSJH*/ 07109000
         MVC   KEYRECRC(4),@CF00035                                1664 07110000
*                ALSTID = KEYRECER;                        /*@Y30SSJH*/ 07111000
         MVC   ALSTID(5),@CB01079                                  1665 07112000
*                RETURN;                                   /*@Y30SSJH*/ 07113000
*                                                                  1666 07114000
         B     @EL00005                                            1666 07115000
*                END;                                      /*@Y30SSJH*/ 07116000
*                                                                  1667 07117000
*            /********************************************************/ 07118000
*            /*                                              @Y30SSJH*/ 07119000
*            /* AVERAGE AND MAXIMUM RECORDSIZES MUST BE      @Y30SSJH*/ 07120000
*            /* EQUAL FOR A RELATIVE RECORD DATA SET         @Y30SSJH*/ 07121000
*            /*                                              @Y30SSJH*/ 07122000
*            /********************************************************/ 07123000
*                                                                  1668 07124000
*            IF (ADDR(RECSZ)) ^= NULLPTR  &                        1668 07125000
*               LCAMDPT -> AMDRRDS = ON                            1668 07126000
*              THEN                                                1668 07127000
@RF01662 L     @06,@PC00001+4                                      1668 07128000
         L     @15,FDTPTR+232(,@06)                                1668 07129000
         LTR   @15,@15                                             1668 07130000
         BZ    @RF01668                                            1668 07131000
         L     @01,LCAMDPT                                         1668 07132000
         TM    AMDRRDS(@01),B'00000010'                            1668 07133000
         BNO   @RF01668                                            1668 07134000
*                IF ARECVAL ^= MRECVAL                             1669 07135000
*                  THEN                                            1669 07136000
         L     @01,FDTPTR+236(,@06)                                1669 07137000
         L     @06,FDTPTR+240(,@06)                                1669 07138000
         CLC   ARECVAL(4,@01),MRECVAL(@06)                         1669 07139000
         BE    @RF01669                                            1669 07140000
*                    DO;                                   /*@Y30SSJH*/ 07141000
*                                                                  1670 07142000
*                    KEYRECRC = 12;                        /*@Y30SSJH*/ 07143000
         MVC   KEYRECRC(4),@CF00035                                1671 07144000
*                    ALSTID = RRDSERR;                     /*@Y30SSJH*/ 07145000
         MVC   ALSTID(5),@CB01082                                  1672 07146000
*                    RETURN;                               /*@Y30SSJH*/ 07147000
*                                                                  1673 07148000
         B     @EL00005                                            1673 07149000
*                    END;                                  /*@Y30SSJH*/ 07150000
*                                                                  1674 07151000
*            /********************************************************/ 07152000
*            /*                                              @Y30SSJH*/ 07153000
*            /* DETERMINE WHETHER OR NOT THE DATA SET IS     @Y30SSJH*/ 07154000
*            /* SPANNED AND SET THE DATA RECORD HEADER SIZE  @Y30SSJH*/ 07155000
*            /*                                              @Y30SSJH*/ 07156000
*            /********************************************************/ 07157000
*                                                                  1675 07158000
*            RFY IDAAMDSB BASED(LCAMDPT);                  /*@Y30SSJH*/ 07159000
*                                                                  1675 07160000
@RF01669 DS    0H                                                  1675 07161000
@RF01668 DS    0H                                                  1676 07162000
*            DRHS = NSPDRHS;                               /*@Y30SSJH*/ 07163000
         LA    @06,7                                               1676 07164000
         STH   @06,DRHS                                            1676 07165000
*            IF AMDSPAN = ON                                       1677 07166000
*              THEN                                                1677 07167000
         L     @15,LCAMDPT                                         1677 07168000
         TM    AMDSPAN(@15),B'00000001'                            1677 07169000
         BNO   @RF01677                                            1677 07170000
*                IF (ADDR(RECSZ)) ^= NULLPTR                       1678 07171000
*                  THEN                                            1678 07172000
         L     @14,@PC00001+4                                      1678 07173000
         L     @05,FDTPTR+232(,@14)                                1678 07174000
         LTR   @05,@05                                             1678 07175000
         BZ    @RF01678                                            1678 07176000
*                    DO;                                   /*@Y30SSJH*/ 07177000
*                                                                  1679 07178000
*                    IF (MRECVAL + NSPDRHS) > AMDCINV              1680 07179000
*                      THEN                                        1680 07180000
         L     @01,FDTPTR+240(,@14)                                1680 07181000
         AL    @06,MRECVAL(,@01)                                   1680 07182000
         C     @06,AMDCINV(,@15)                                   1680 07183000
         BNH   @RF01680                                            1680 07184000
*                        DRHS = SPDRHS;                    /*@Y30SSJH*/ 07185000
         MVC   DRHS(2),@CH00037                                    1681 07186000
*                      ELSE                                        1682 07187000
*                        DRHS = NSPDRHS;                   /*@Y30SSJH*/ 07188000
*                                                                  1682 07189000
         B     @RC01680                                            1682 07190000
@RF01680 MVC   DRHS(2),@CH00467                                    1682 07191000
*                    END;                                  /*@Y30SSJH*/ 07192000
*              ELSE                                                1684 07193000
*                IF (AMDLRECL + NSPDRHS) > AMDCINV                 1684 07194000
*                  THEN                                            1684 07195000
         B     @RC01678                                            1684 07196000
@RF01678 L     @06,LCAMDPT                                         1684 07197000
         LA    @15,7                                               1684 07198000
         AL    @15,AMDLRECL(,@06)                                  1684 07199000
         C     @15,AMDCINV(,@06)                                   1684 07200000
         BNH   @RF01684                                            1684 07201000
*                    DRHS = SPDRHS;                        /*@Y30SSJH*/ 07202000
         MVC   DRHS(2),@CH00037                                    1685 07203000
*                  ELSE                                            1686 07204000
*                    DRHS = NSPDRHS;                       /*@Y30SSJH*/ 07205000
*                                                                  1686 07206000
         B     @RC01684                                            1686 07207000
@RF01684 MVC   DRHS(2),@CH00467                                    1686 07208000
*            /********************************************************/ 07209000
*            /*                                              @Y30SSJH*/ 07210000
*            /* ENSURE NEW MAXIMUM RECORDSIZE IS VALID       @Y30SSJH*/ 07211000
*            /*                                              @Y30SSJH*/ 07212000
*             /******************************************************** 07213000
*                                                                  1687 07214000
*            IF (ADDR(RECSZ)) ^= NULLPTR                           1687 07215000
*               THEN                                               1687 07216000
@RC01684 DS    0H                                                  1687 07217000
@RC01678 DS    0H                                                  1687 07218000
@RF01677 L     @06,@PC00001+4                                      1687 07219000
         L     @06,FDTPTR+232(,@06)                                1687 07220000
         LTR   @06,@06                                             1687 07221000
         BZ    @RF01687                                            1687 07222000
*RECLOOP:         DO;                                      /*@Y30SSJH*/ 07223000
*                                                                  1688 07224000
RECLOOP  DS    0H                                                  1689 07225000
*                IF MRECVAL > AMDCIPCA * (AMDCINV - DRHS)          1689 07226000
*                   THEN                                           1689 07227000
         L     @06,@PC00001+4                                      1689 07228000
         L     @06,FDTPTR+240(,@06)                                1689 07229000
         L     @15,LCAMDPT                                         1689 07230000
         L     @14,AMDCINV(,@15)                                   1689 07231000
         SH    @14,DRHS                                            1689 07232000
         MH    @14,AMDCIPCA(,@15)                                  1689 07233000
         C     @14,MRECVAL(,@06)                                   1689 07234000
         BNL   @RF01689                                            1689 07235000
*                     DO;                                  /*@Y30SSJH*/ 07236000
*                                                                  1690 07237000
*                    KEYRECRC = 12;                        /*@Y30SSJH*/ 07238000
         MVC   KEYRECRC(4),@CF00035                                1691 07239000
*                    ALSTID = CINVERR;                     /*@Y30SSJH*/ 07240000
         MVC   ALSTID(5),@CB01086                                  1692 07241000
*                    RETURN;                               /*@Y30SSJH*/ 07242000
*                                                                  1693 07243000
         B     @EL00005                                            1693 07244000
*                    END;                                  /*@Y30SSJH*/ 07245000
*                                                                  1695 07246000
*                /****************************************************/ 07247000
*                /*                                          @Y30SSJH*/ 07248000
*                /* ENSURE PREVIOUS RECORDSIZE VALUES ARE    @Y30SSJH*/ 07249000
*                /* NOT EQUAL TO NEW VALUES                  @Y30SSJH*/ 07250000
*                /*                                          @Y30SSJH*/ 07251000
*                /****************************************************/ 07252000
*                                                                  1695 07253000
*                IF MRECVAL = AMDLRECL                             1695 07254000
*                   THEN                                           1695 07255000
@RF01689 L     @06,@PC00001+4                                      1695 07256000
         L     @06,FDTPTR+240(,@06)                                1695 07257000
         L     @15,LCAMDPT                                         1695 07258000
         L     @14,AMDLRECL(,@15)                                  1695 07259000
         C     @14,MRECVAL(,@06)                                   1695 07260000
         BNE   @RF01695                                            1695 07261000
*                     DO;                                  /*@Y30SSJH*/ 07262000
*                                                                  1696 07263000
*                     IF AMDSPAN = ON                              1697 07264000
*                       THEN                                       1697 07265000
         TM    AMDSPAN(@15),B'00000001'                            1697 07266000
         BNO   @RF01697                                            1697 07267000
*                         IF AMDLRECL = SPMDEF                     1698 07268000
*                           THEN                                   1698 07269000
         C     @14,@CF01135                                        1698 07270000
         BNE   @RF01698                                            1698 07271000
*                             KEYRECRC = 4;                /*@Y30SSJH*/ 07272000
         MVC   KEYRECRC(4),@CF00044                                1699 07273000
*                           ELSE                                   1700 07274000
*                             KEYRECRC = 5;                /*@Y30SSJH*/ 07275000
         B     @RC01698                                            1700 07276000
@RF01698 MVC   KEYRECRC(4),@CF00287                                1700 07277000
*                       ELSE                                       1701 07278000
*                         IF AMDLRECL = NSPDEF                     1701 07279000
*                           THEN                                   1701 07280000
         B     @RC01697                                            1701 07281000
@RF01697 L     @06,LCAMDPT                                         1701 07282000
         CLC   AMDLRECL(4,@06),@CF01137                            1701 07283000
         BNE   @RF01701                                            1701 07284000
*                             KEYRECRC = 4;                /*@Y30SSJH*/ 07285000
         MVC   KEYRECRC(4),@CF00044                                1702 07286000
*                           ELSE                                   1703 07287000
*                             KEYRECRC = 5;                /*@Y30SSJH*/ 07288000
*                                                                  1703 07289000
         B     @RC01701                                            1703 07290000
@RF01701 MVC   KEYRECRC(4),@CF00287                                1703 07291000
*                     END;                                 /*@Y30SSJH*/ 07292000
*                                                                  1704 07293000
@RC01701 DS    0H                                                  1704 07294000
@RC01697 DS    0H                                                  1705 07295000
*                /****************************************************/ 07296000
*                /*                                          @Y30SSJH*/ 07297000
*                /* IN ORDER FOR ALTER TO BE VALID ,PREVIOUS @Y30SSJH*/ 07298000
*                /* RECORDSIZE VALUES MUST BE DEFAULT VALUES @Y30SSJH*/ 07299000
*                /*                                          @Y30SSJH*/ 07300000
*                /****************************************************/ 07301000
*                                                                  1705 07302000
*                IF KEYRECRC = 0                                   1705 07303000
*                  THEN                                            1705 07304000
@RF01695 L     @06,KEYRECRC                                        1705 07305000
         LTR   @06,@06                                             1705 07306000
         BNZ   @RF01705                                            1705 07307000
*                    DO;                                   /*@Y30SSJH*/ 07308000
*                                                                  1706 07309000
*                    IF AMDSPAN = OFF                              1707 07310000
*                      THEN                                        1707 07311000
         L     @06,LCAMDPT                                         1707 07312000
         TM    AMDSPAN(@06),B'00000001'                            1707 07313000
         BNZ   @RF01707                                            1707 07314000
*                        IF AMDLRECL = NSPDEF                      1708 07315000
*                          THEN ;                          /*@Y30SSJH*/ 07316000
         CLC   AMDLRECL(4,@06),@CF01137                            1708 07317000
         BE    @RT01708                                            1708 07318000
*                          ELSE                                    1710 07319000
*                            DO;                           /*@Y30SSJH*/ 07320000
*                                                                  1710 07321000
*                            KEYRECRC = 8;                 /*@Y30SSJH*/ 07322000
         MVC   KEYRECRC(4),@CF00039                                1711 07323000
*                            ALSTID = NEWVALER;            /*@Y30SSJH*/ 07324000
         MVC   ALSTID(5),@CB01092                                  1712 07325000
*                            RETURN;                       /*@Y30SSJH*/ 07326000
*                                                                  1713 07327000
         B     @EL00005                                            1713 07328000
*                            END;                          /*@Y30SSJH*/ 07329000
*                      ELSE                                        1715 07330000
*                        IF AMDLRECL = SPMDEF                      1715 07331000
*                          THEN  ;                         /*@Y30SSJH*/ 07332000
         B     @RC01707                                            1715 07333000
@RF01707 L     @06,LCAMDPT                                         1715 07334000
         CLC   AMDLRECL(4,@06),@CF01135                            1715 07335000
         BE    @RT01715                                            1715 07336000
*                          ELSE                                    1717 07337000
*                            DO;                           /*@Y30SSJH*/ 07338000
*                                                                  1717 07339000
*                            KEYRECRC = 8;                 /*@Y30SSJH*/ 07340000
         MVC   KEYRECRC(4),@CF00039                                1718 07341000
*                            ALSTID = NEWVALER;            /*@Y30SSJH*/ 07342000
         MVC   ALSTID(5),@CB01092                                  1719 07343000
*                            RETURN;                       /*@Y30SSJH*/ 07344000
*                                                                  1720 07345000
         B     @EL00005                                            1720 07346000
*                            END;                          /*@Y30SSJH*/ 07347000
*                                                                  1721 07348000
*                      END;                                /*@Y30SSJH*/ 07349000
@RT01715 DS    0H                                                  1722 07350000
@RC01707 DS    0H                                                  1723 07351000
*                END RECLOOP;                              /*@Y30SSJH*/ 07352000
*                                                                  1723 07353000
@RF01705 DS    0H                                                  1724 07354000
*          /**********************************************************/ 07355000
*          /*                                                @Y30SSJH*/ 07356000
*          /* THIS ENDS PROCESSING FOR A NONINDEXED CLUSTER  @Y30SSJH*/ 07357000
*          /*                                                @Y30SSJH*/ 07358000
*          /**********************************************************/ 07359000
*                                                                  1724 07360000
*                                                                  1724 07361000
*          /**********************************************************/ 07362000
*          /*                                                @Y30SSJH*/ 07363000
*          /* LOCATE THE ASSOCIATED INDEX AMDSB FOR MORE     @Y30SSJH*/ 07364000
*          /* VALIDITY CHECKING                              @Y30SSJH*/ 07365000
*          /*                                                @Y30SSJH*/ 07366000
*          /**********************************************************/ 07367000
*                                                                  1724 07368000
*          IF INDEXCI ^= INITVALU                                  1724 07369000
*            THEN                                                  1724 07370000
@RF01687 CLC   INDEXCI(3),INITVALU                                 1724 07371000
         BE    @RF01724                                            1724 07372000
*INDXLOOP:     DO;                                         /*@Y30SSJH*/ 07373000
*                                                                  1725 07374000
INDXLOOP DS    0H                                                  1726 07375000
*              /******************************************************/ 07376000
*              /*                                            @Y30SSJH*/ 07377000
*              /* INITIALIZE THE CPL                         @Y30SSJH*/ 07378000
*              /*                                            @Y30SSJH*/ 07379000
*              /******************************************************/ 07380000
*                                                                  1726 07381000
*              CTGPLPTR = ADDR(ALCTGPL);                   /*@Y30SSJH*/ 07382000
         L     @06,ALPRMPTR                                        1726 07383000
         LA    @15,ALCTGPL(,@06)                                   1726 07384000
         ST    @15,CTGPLPTR                                        1726 07385000
*              ALCTGPL = ''B;                              /*@Y30SSJH*/ 07386000
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        1727 07387000
*              CTGENT = ADDR(INDEXCI);                     /*@Y30SSJH*/ 07388000
         LA    @06,INDEXCI                                         1728 07389000
         ST    @06,CTGENT(,@15)                                    1728 07390000
*              CTGCNAME = ON;                              /*@Y30SSJH*/ 07391000
         OI    CTGCNAME(@15),B'00000010'                           1729 07392000
*              CTGFUNC = CTGLOC;                           /*@Y30SSJH*/ 07393000
         NI    CTGFUNC(@15),B'00111111'                            1730 07394000
         OI    CTGFUNC(@15),B'00100000'                            1730 07395000
*              CTGNUM = ON;                                /*@Y30SSJH*/ 07396000
*              CTGAM0 = ON;                                /*@Y30SSJH*/ 07397000
         OI    CTGNUM(@15),B'00000011'                             1732 07398000
*              CTGBYPSS = ON;                              /*@Y30SSJH*/ 07399000
*                                                                  1733 07400000
         OI    CTGBYPSS(@15),B'10000000'                           1733 07401000
*              AMDSBWKA = ''B;                             /*@Y30SSJH*/ 07402000
         XC    AMDSBWKA(140),AMDSBWKA                              1734 07403000
*              CTGWKA = ADDR(AMDSBWKA);                    /*@Y30SSJH*/ 07404000
         LA    @06,AMDSBWKA                                        1735 07405000
         ST    @06,CTGWKA(,@15)                                    1735 07406000
*              AMDTOTLN = LENGTH(AMDSBWKA);                /*@Y30SSJH*/ 07407000
*                                                                  1736 07408000
         MVC   AMDTOTLN(2),@CH01673                                1736 07409000
*              /******************************************************/ 07410000
*              /*                                            @Y30SSJH*/ 07411000
*              /* SET THE CPL TO REFERENCE THE CATALOG IN    @Y30SSJH*/ 07412000
*              /* WHICH THE ENTRY RESIDES                    @Y30SSJH*/ 07413000
*              /*                                            @Y30SSJH*/ 07414000
*              /******************************************************/ 07415000
*                                                                  1737 07416000
*              IF CATACBPT ^= NULLPTR                              1737 07417000
*                THEN                                              1737 07418000
         L     @06,CATACBPT                                        1737 07419000
         LTR   @06,@06                                             1737 07420000
         BZ    @RF01737                                            1737 07421000
*                  DO;                                     /*@Y30SSJH*/ 07422000
*                                                                  1738 07423000
*                  CTGCNAME = OFF;                         /*@Y30SSJH*/ 07424000
         NI    CTGCNAME(@15),B'11111101'                           1739 07425000
*                  CTGCAT = CATACBPT;                      /*@Y30SSJH*/ 07426000
*                                                                  1740 07427000
         ST    @06,CTGCAT(,@15)                                    1740 07428000
*                  END;                                    /*@Y30SSJH*/ 07429000
*                ELSE                                              1742 07430000
*                  IF (ADDR(CATLG)) ^= NULLPTR                     1742 07431000
*                    THEN                                          1742 07432000
         B     @RC01737                                            1742 07433000
@RF01737 L     @06,@PC00001+4                                      1742 07434000
         L     @06,FDTPTR+8(,@06)                                  1742 07435000
         LTR   @06,@06                                             1742 07436000
         BZ    @RF01742                                            1742 07437000
*                      CTGCAT = ADDR(CATLGVAL);            /*@Y30SSJH*/ 07438000
         LA    @06,CATLGVAL(,@06)                                  1743 07439000
         L     @01,CTGPLPTR                                        1743 07440000
         ST    @06,CTGCAT(,@01)                                    1743 07441000
*                                                                  1744 07442000
*              /******************************************************/ 07443000
*              /*                                            @Y30SSJH*/ 07444000
*              /* INITIALIZE THE PASSWORD ADDRESS            @Y30SSJH*/ 07445000
*              /*                                            @Y30SSJH*/ 07446000
*              /******************************************************/ 07447000
*                                                                  1744 07448000
*              IF (ADDR(CATLG)) ^= NULLPTR                         1744 07449000
*                THEN                                              1744 07450000
@RF01742 DS    0H                                                  1744 07451000
@RC01737 L     @06,@PC00001+4                                      1744 07452000
         L     @06,FDTPTR+8(,@06)                                  1744 07453000
         LTR   @06,@06                                             1744 07454000
         BZ    @RF01744                                            1744 07455000
*                  IF CATLGPLN ^= 0                                1745 07456000
*                    THEN                                          1745 07457000
         CLI   CATLGPLN(@06),0                                     1745 07458000
         BE    @RF01745                                            1745 07459000
*                      CTGPSWD = ADDR(CATLGPAS);           /*@Y30SSJH*/ 07460000
         LA    @06,CATLGPAS(,@06)                                  1746 07461000
         L     @01,CTGPLPTR                                        1746 07462000
         ST    @06,CTGPSWD(,@01)                                   1746 07463000
*              IF CTGPSWD = NULLPTR                                1747 07464000
*                THEN                                              1747 07465000
@RF01745 DS    0H                                                  1747 07466000
@RF01744 L     @06,CTGPLPTR                                        1747 07467000
         L     @15,CTGPSWD(,@06)                                   1747 07468000
         LTR   @15,@15                                             1747 07469000
         BNZ   @RF01747                                            1747 07470000
*                  IF NTRYPLN ^= 0                                 1748 07471000
*                    THEN                                          1748 07472000
         L     @15,@PC00001+4                                      1748 07473000
         L     @15,FDTPTR(,@15)                                    1748 07474000
         CLI   NTRYPLN(@15),0                                      1748 07475000
         BE    @RF01748                                            1748 07476000
*                      CTGPSWD = ADDR(NTRYPAS);            /*@Y30SSJH*/ 07477000
*                                                                  1749 07478000
         LA    @15,NTRYPAS(,@15)                                   1749 07479000
         ST    @15,CTGPSWD(,@06)                                   1749 07480000
*              /******************************************************/ 07481000
*              /*                                            @Y30SSJH*/ 07482000
*              /* INITIALIZE THE FPL AND REFERENCE IT IN THE @Y30SSJH*/ 07483000
*              /* CPL                                        @Y30SSJH*/ 07484000
*              /*                                            @Y30SSJH*/ 07485000
*              /******************************************************/ 07486000
*                                                                  1750 07487000
*              CTGNOFLD = 1;                               /*@Y30SSJH*/ 07488000
@RF01748 DS    0H                                                  1750 07489000
@RF01747 L     @06,CTGPLPTR                                        1750 07490000
         MVI   CTGNOFLD(@06),X'01'                                 1750 07491000
*              CTGFLPTR = ADDR(ALFPLAMD);                  /*@Y30SSJH*/ 07492000
         L     @15,ALPRMPTR                                        1751 07493000
         LA    @14,ALFPLAMD(,@15)                                  1751 07494000
         ST    @14,CTGFLPTR                                        1751 07495000
*              ALFPLAMD = ''B;                             /*@Y30SSJH*/ 07496000
         XC    ALFPLAMD(16,@15),ALFPLAMD(@15)                      1752 07497000
*              CTGFLNG(1) = NULLPTR;                       /*@Y30SSJH*/ 07498000
         SLR   @05,@05                                             1753 07499000
         ST    @05,CTGFLNG(,@14)                                   1753 07500000
*              CTGFLPT(1) = NULLPTR;                       /*@Y30SSJH*/ 07501000
         ST    @05,CTGFLPT(,@14)                                   1754 07502000
*              CTGFIELD(1) = CTGFLPTR;                     /*@Y30SSJH*/ 07503000
*                                                                  1755 07504000
         ST    @14,CTGFIELD(,@06)                                  1755 07505000
*              CTGFLDNO = 1;                               /*@Y30SSJH*/ 07506000
         MVI   CTGFLDNO(@14),X'01'                                 1756 07507000
*              CTGFLDNM = ADDR(ALFLDNAM(8));               /*@Y30SSJH*/ 07508000
*                                                                  1757 07509000
         LA    @04,ALFLDNAM+56                                     1757 07510000
         ST    @04,CTGFLDNM(,@14)                                  1757 07511000
*              /******************************************************/ 07512000
*              /*                                            @Y30SSJH*/ 07513000
*              /* IF KEYS IS SPECIFIED, VERIFY THAT THERE IS @Y30SSJH*/ 07514000
*              /* SUFFICIENT PASSWORD AUTHORIZATION TO ALTER @Y30SSJH*/ 07515000
*              /* ASSOCIATED INDEX. THIS IS DONE BY LOCATING @Y30SSJH*/ 07516000
*              /* THE PASSWORDS OF THE INDEX WHICH REQUIRES  @Y30SSJH*/ 07517000
*              /* THE CLUSTER/INDEX MASTER PASSWORD.         @Y30SSJH*/ 07518000
*              /*                                            @Y30SSJH*/ 07519000
*              /******************************************************/ 07520000
*              IF (ADDR(KEY)) ^= NULLPTR                           1758 07521000
*                THEN                                              1758 07522000
         L     @04,@PC00001+4                                      1758 07523000
         C     @05,FDTPTR+220(,@04)                                1758 07524000
         BE    @RF01758                                            1758 07525000
*                  DO;                                     /*@Y30SSJH*/ 07526000
*                                                                  1759 07527000
*                  CTGNOFLD = 2;                           /*@Y30SSJH*/ 07528000
         MVI   CTGNOFLD(@06),X'02'                                 1760 07529000
*                  CTGFLPTR = ADDR(ALFPLPSW);              /*@Y30SSJH*/ 07530000
         LA    @14,ALFPLPSW(,@15)                                  1761 07531000
         ST    @14,CTGFLPTR                                        1761 07532000
*                  ALFPLPSW = ''B;                         /*@Y30SSJH*/ 07533000
         XC    ALFPLPSW(16,@15),ALFPLPSW(@15)                      1762 07534000
*                  CTGFLNG(1) = NULLPTR;                   /*@Y30SSJH*/ 07535000
         ST    @05,CTGFLNG(,@14)                                   1763 07536000
*                  CTGFLPT(1) = NULLPTR;                   /*@Y30SSJH*/ 07537000
         ST    @05,CTGFLPT(,@14)                                   1764 07538000
*                  CTGFIELD(2) = CTGFLPTR;                 /*@Y30SSJH*/ 07539000
         ST    @14,CTGFIELD+4(,@06)                                1765 07540000
*                  CTGFLDNO = 1;                           /*@Y30SSJH*/ 07541000
         MVI   CTGFLDNO(@14),X'01'                                 1766 07542000
*                  CTGFLDNM = ADDR(PASSWORD);              /*@Y30SSJH*/ 07543000
         LA    @06,PASSWORD                                        1767 07544000
         ST    @06,CTGFLDNM(,@14)                                  1767 07545000
*                                                                  1768 07546000
*              /******************************************************/ 07547000
*              /*                                            @Y30SSJH*/ 07548000
*              /* ISSUE THE CATALOG LOCATE REQUEST           @Y30SSJH*/ 07549000
*              /*                                            @Y30SSJH*/ 07550000
*              /******************************************************/ 07551000
*                                                                  1768 07552000
*              CALL IDCSACA0(GDTTBL,CTGPLPTR);             /*@Y30SSJH*/ 07553000
*                                                                  1768 07554000
         L     @06,@PC00001                                        1768 07555000
         ST    @06,@AL00001                                        1768 07556000
         LA    @15,CTGPLPTR                                        1768 07557000
         ST    @15,@AL00001+4                                      1768 07558000
         L     @15,GDTCAT(,@06)                                    1768 07559000
         LA    @01,@AL00001                                        1768 07560000
         BALR  @14,@15                                             1768 07561000
*              RESPECIFY (RTNREG) RSTD;                    /*@Y30SSJH*/ 07562000
*              CTGRTNCC = RTNREG;                          /*@Y30SSJH*/ 07563000
         ST    RTNREG,CTGRTNCC                                     1770 07564000
*              RESPECIFY (RTNREG) UNRSTD;                  /*@Y30SSJH*/ 07565000
*                                                                  1771 07566000
*              IF GDTDBG = NULLPTR                                 1772 07567000
*                THEN;                                             1772 07568000
         L     @06,@PC00001                                        1772 07569000
         L     @06,GDTDBG(,@06)                                    1772 07570000
         LTR   @06,@06                                             1772 07571000
         BZ    @RT01772                                            1772 07572000
*                ELSE                                              1774 07573000
*                  CALL IDCDB010 (GDTTBL,'AL53');                  1774 07574000
         L     @06,@PC00001                                        1774 07575000
         ST    @06,@AL00001                                        1774 07576000
         LA    @15,@CC01558                                        1774 07577000
         ST    @15,@AL00001+4                                      1774 07578000
         MVI   @AL00001+4,X'80'                                    1774 07579000
         L     @15,GDTDBG(,@06)                                    1774 07580000
         LA    @01,@AL00001                                        1774 07581000
         BALR  @14,@15                                             1774 07582000
*                                                          /*@Y30SSJH*/ 07583000
*                                                                  1775 07584000
*              IF CTGRTNCC ^= 0                                    1775 07585000
*                THEN                                              1775 07586000
@RT01772 L     @06,CTGRTNCC                                        1775 07587000
         LTR   @06,@06                                             1775 07588000
         BZ    @RF01775                                            1775 07589000
*                  DO;                                     /*@Y30SSJH*/ 07590000
*                                                                  1776 07591000
*                  KEYRECRC =12;                           /*@Y30SSJH*/ 07592000
         MVC   KEYRECRC(4),@CF00035                                1777 07593000
*                  ALSTID = CATERROR;                      /*@Y30SSJH*/ 07594000
         MVC   ALSTID(5),@CB01016                                  1778 07595000
*                  RETURN;                                 /*@Y30SSJH*/ 07596000
         B     @EL00005                                            1779 07597000
*                  END;                                    /*@Y30SSJH*/ 07598000
*                                                                  1780 07599000
*              /******************************************************/ 07600000
*              /*                                            @Y30SSJH*/ 07601000
*              /* IF THE KEYS PARAMETER HAS BEEN SPECIFIED,  @Y30SSJH*/ 07602000
*              /* VERIFY THAT PASSWORDS WERE SUCCESSFULLY    @Y30SSJH*/ 07603000
*              /* LOCATED.                                   @Y30SSJH*/ 07604000
*              /*                                            @Y30SSJH*/ 07605000
*              /******************************************************/ 07606000
*                                                                  1781 07607000
*              IF (ADDR(KEY)) ^= NULLPTR                           1781 07608000
*                THEN                                              1781 07609000
@RF01775 SLR   @06,@06                                             1781 07610000
         L     @15,@PC00001+4                                      1781 07611000
         C     @06,FDTPTR+220(,@15)                                1781 07612000
         BE    @RF01781                                            1781 07613000
*                  DO;                                     /*@Y30SSJH*/ 07614000
*                                                                  1782 07615000
*                  CTGFIELD(2) = NULLPTR;                  /*@Y30SSJH*/ 07616000
         L     @15,CTGPLPTR                                        1783 07617000
         ST    @06,CTGFIELD+4(,@15)                                1783 07618000
*                  CTGNOFLD = 1;                           /*@Y30SSJH*/ 07619000
         MVI   CTGNOFLD(@15),X'01'                                 1784 07620000
*                  CTGFLPTR = ADDR(ALFPLPSW);              /*@Y30SSJH*/ 07621000
         L     @01,ALPRMPTR                                        1785 07622000
         LA    @15,ALFPLPSW(,@01)                                  1785 07623000
         ST    @15,CTGFLPTR                                        1785 07624000
*                  IF CTGFLNG(1) = 1   &                           1786 07625000
*                     CTGFLPT(1) = 0                               1786 07626000
*                    THEN                                          1786 07627000
         CLC   CTGFLNG(4,@15),@CF00220                             1786 07628000
         BNE   @RF01786                                            1786 07629000
         C     @06,CTGFLPT(,@15)                                   1786 07630000
         BNE   @RF01786                                            1786 07631000
*                      DO;                                 /*@Y30SSJH*/ 07632000
*                                                                  1787 07633000
*                      ALSTID = PSWDERR;                   /*@Y30SSJH*/ 07634000
         MVC   ALSTID(5),@CB01048                                  1788 07635000
*                      KEYRECRC = 12;                      /*@Y30SSJH*/ 07636000
         MVC   KEYRECRC(4),@CF00035                                1789 07637000
*                      RETURN;                             /*@Y30SSJH*/ 07638000
*                                                                  1790 07639000
         B     @EL00005                                            1790 07640000
*                      END;                                /*@Y30SSJH*/ 07641000
*                                                                  1791 07642000
*                  END;                                    /*@Y30SSJH*/ 07643000
@RF01786 DS    0H                                                  1793 07644000
*                                                                  1793 07645000
*              /******************************************************/ 07646000
*              /*                                            @Y30SSJH*/ 07647000
*              /* ENSURE THAT THE AMDSB WAS SUCCESSFULLY     @Y30SSJH*/ 07648000
*              /* LOCATED                                    @Y30SSJH*/ 07649000
*              /*                                            @Y30SSJH*/ 07650000
*              /******************************************************/ 07651000
*                                                                  1793 07652000
*              CTGFLPTR = ADDR(ALFPLAMD);                  /*@Y30SSJH*/ 07653000
@RF01781 L     @06,ALPRMPTR                                        1793 07654000
         LA    @06,ALFPLAMD(,@06)                                  1793 07655000
         ST    @06,CTGFLPTR                                        1793 07656000
*              IF CTGFLNG(1) = NULLPTR  |                          1794 07657000
*                 CTGFLPT(1) -> IDAAMDSB = NULLMASK                1794 07658000
*                THEN                                              1794 07659000
         L     @15,CTGFLNG(,@06)                                   1794 07660000
         LTR   @15,@15                                             1794 07661000
         BZ    @RT01794                                            1794 07662000
         L     @06,CTGFLPT(,@06)                                   1794 07663000
         CLC   IDAAMDSB(8,@06),NULLMASK                            1794 07664000
         BNE   @RF01794                                            1794 07665000
@RT01794 DS    0H                                                  1795 07666000
*                  DO;                                     /*@Y30SSJH*/ 07667000
*                                                                  1795 07668000
*                  KEYRECRC =12;                           /*@Y30SSJH*/ 07669000
         MVC   KEYRECRC(4),@CF00035                                1796 07670000
*                  ALSTID = LOCRTNER;                      /*@Y30SSJH*/ 07671000
         MVC   ALSTID(5),@CB01025                                  1797 07672000
*                  RETURN;                                 /*@Y30SSJH*/ 07673000
*                                                                  1798 07674000
         B     @EL00005                                            1798 07675000
*                  END;                                    /*@Y30SSJH*/ 07676000
*                                                                  1799 07677000
*                /****************************************************/ 07678000
*                /*                                          @Y30SSJH*/ 07679000
*                /* SAVE THE ADDRESS AND LENGTH OF THE INDEX @Y30SSJH*/ 07680000
*                /* AMDSB FOR FUTURE REFERENCE               @Y30SSJH*/ 07681000
*                /*                                          @Y30SSJH*/ 07682000
*                /****************************************************/ 07683000
*                ELSE                                              1800 07684000
*                  DO;                                     /*@Y30SSJH*/ 07685000
*                                                                  1800 07686000
@RF01794 DS    0H                                                  1801 07687000
*                  IXAMDPT = CTGFLPT(1);                   /*@Y30SSJH*/ 07688000
         L     @06,CTGFLPTR                                        1801 07689000
         L     @15,CTGFLPT(,@06)                                   1801 07690000
         ST    @15,IXAMDPT                                         1801 07691000
*                  IXAMDLEN = CTGFLNG(1);                  /*@Y30SSJH*/ 07692000
*                                                                  1802 07693000
         L     @06,CTGFLNG(,@06)                                   1802 07694000
         ST    @06,IXAMDLEN                                        1802 07695000
*                  END;                                    /*@Y30SSJH*/ 07696000
*                                                                  1804 07697000
*              /******************************************************/ 07698000
*              /*                                            @Y30SSJH*/ 07699000
*              /* DETERMINE KEY VALUES FOR VALIDITY CHECKING @Y30SSJH*/ 07700000
*              /*                                            @Y30SSJH*/ 07701000
*              /******************************************************/ 07702000
*                                                                  1804 07703000
*              IF (ADDR(KEY)) ^= NULLPTR                           1804 07704000
*                THEN                                              1804 07705000
         L     @06,@PC00001+4                                      1804 07706000
         L     @15,FDTPTR+220(,@06)                                1804 07707000
         LTR   @15,@15                                             1804 07708000
         BZ    @RF01804                                            1804 07709000
*                  DO;                                     /*@Y30SSJH*/ 07710000
*                                                                  1805 07711000
*                  KEYPVALU = KEYPSVAL;                    /*@Y30SSJH*/ 07712000
         L     @01,FDTPTR+228(,@06)                                1806 07713000
         L     @15,KEYPSVAL(,@01)                                  1806 07714000
         ST    @15,KEYPVALU                                        1806 07715000
*                  KEYLVALU = KEYLNVAL;                    /*@Y30SSJH*/ 07716000
*                                                                  1807 07717000
         L     @06,FDTPTR+224(,@06)                                1807 07718000
         L     @06,KEYLNVAL(,@06)                                  1807 07719000
         ST    @06,KEYLVALU                                        1807 07720000
*                  END;                                    /*@Y30SSJH*/ 07721000
*                ELSE                                              1809 07722000
*                  DO;                                     /*@Y30SSJH*/ 07723000
*                                                                  1809 07724000
         B     @RC01804                                            1809 07725000
@RF01804 DS    0H                                                  1810 07726000
*                  KEYPVALU = AMDRKP;                      /*@Y30SSJH*/ 07727000
         L     @06,LCAMDPT                                         1810 07728000
         LH    @15,AMDRKP(,@06)                                    1810 07729000
         ST    @15,KEYPVALU                                        1810 07730000
*                  KEYLVALU = AMDKEYLN;                    /*@Y30SSJH*/ 07731000
*                                                                  1811 07732000
         LH    @06,AMDKEYLN(,@06)                                  1811 07733000
         ST    @06,KEYLVALU                                        1811 07734000
*                  END;                                    /*@Y30SSJH*/ 07735000
*                                                                  1812 07736000
*              /******************************************************/ 07737000
*              /*                                            @Y30SSJH*/ 07738000
*              /* DETERMINE RECORDSIZE VALUE FOR VALIDITY    @Y30SSJH*/ 07739000
*              /* CHECKING                                   @Y30SSJH*/ 07740000
*              /*                                            @Y30SSJH*/ 07741000
*              /******************************************************/ 07742000
*                                                                  1813 07743000
*              IF (ADDR(RECSZ)) ^= NULLPTR                         1813 07744000
*                THEN                                              1813 07745000
@RC01804 L     @06,@PC00001+4                                      1813 07746000
         L     @15,FDTPTR+232(,@06)                                1813 07747000
         LTR   @15,@15                                             1813 07748000
         BZ    @RF01813                                            1813 07749000
*                  MAXRECSZ = MRECVAL;                     /*@Y30SSJH*/ 07750000
         L     @06,FDTPTR+240(,@06)                                1814 07751000
         L     @06,MRECVAL(,@06)                                   1814 07752000
         ST    @06,MAXRECSZ                                        1814 07753000
*                ELSE                                              1815 07754000
*                  MAXRECSZ = AMDLRECL;                    /*@Y30SSJH*/ 07755000
*                                                                  1815 07756000
         B     @RC01813                                            1815 07757000
@RF01813 L     @06,LCAMDPT                                         1815 07758000
         L     @06,AMDLRECL(,@06)                                  1815 07759000
         ST    @06,MAXRECSZ                                        1815 07760000
*              /******************************************************/ 07761000
*              /*                                            @Y30SSJH*/ 07762000
*              /* ENSURE NEW KEY AND RECORDSIZE VALUES ARE   @Y30SSJH*/ 07763000
*              /* COMPATIBLE WITH MAXIMUM RECORDSIZE         @Y30SSJH*/ 07764000
*              /*                                            @Y30SSJH*/ 07765000
*              /******************************************************/ 07766000
*                                                                  1816 07767000
*              IF (KEYPVALU + KEYLVALU) > MAXRECSZ                 1816 07768000
*                THEN                                              1816 07769000
@RC01813 L     @06,KEYPVALU                                        1816 07770000
         AL    @06,KEYLVALU                                        1816 07771000
         C     @06,MAXRECSZ                                        1816 07772000
         BNH   @RF01816                                            1816 07773000
*                  DO;                                     /*@Y30SSJH*/ 07774000
*                                                                  1817 07775000
*                  KEYRECRC = 12;                          /*@Y30SSJH*/ 07776000
         MVC   KEYRECRC(4),@CF00035                                1818 07777000
*                  ALSTID = KEYVALER;                      /*@Y30SSJH*/ 07778000
         MVC   ALSTID(5),@CB01095                                  1819 07779000
*                  RETURN;                                 /*@Y30SSJH*/ 07780000
*                                                                  1820 07781000
         B     @EL00005                                            1820 07782000
*                  END;                                    /*@Y30SSJH*/ 07783000
*                                                                  1821 07784000
*              /******************************************************/ 07785000
*              /*                                            @Y30SSJH*/ 07786000
*              /* ENSURE NEW VALUES ALLOW THE KEY TO BE      @Y30SSJH*/ 07787000
*              /* CONTAINED IN A CONTROL INTERVAL            @Y30SSJH*/ 07788000
*              /*                                            @Y30SSJH*/ 07789000
*              /******************************************************/ 07790000
*                                                                  1822 07791000
*              IF AMDCINV < (KEYPVALU + KEYLVALU + DRHS)           1822 07792000
*                THEN                                              1822 07793000
@RF01816 L     @06,KEYPVALU                                        1822 07794000
         AL    @06,KEYLVALU                                        1822 07795000
         AH    @06,DRHS                                            1822 07796000
         L     @01,LCAMDPT                                         1822 07797000
         C     @06,AMDCINV(,@01)                                   1822 07798000
         BNH   @RF01822                                            1822 07799000
*                  DO;                                     /*@Y30SSJH*/ 07800000
*                                                                  1823 07801000
*                  KEYRECRC = 12;                          /*@Y30SSJH*/ 07802000
         MVC   KEYRECRC(4),@CF00035                                1824 07803000
*                  ALSTID = CINVERR;                       /*@Y30SSJH*/ 07804000
         MVC   ALSTID(5),@CB01086                                  1825 07805000
*                  RETURN;                                 /*@Y30SSJH*/ 07806000
*                                                                  1826 07807000
         B     @EL00005                                            1826 07808000
*                  END;                                    /*@Y30SSJH*/ 07809000
*                                                                  1827 07810000
*              /******************************************************/ 07811000
*              /*                                            @Y30SSJH*/ 07812000
*              /* ENSURE THAT THERE NO CONTROL INTERVAL SIZE @Y30SSJH*/ 07813000
*              /* CONFLICTS                                  @Y30SSJH*/ 07814000
*              /*                                            @Y30SSJH*/ 07815000
*              /******************************************************/ 07816000
*                                                                  1828 07817000
*              XVAL = IRHS + (2 * (KEYLVALU + 2)) + (3 * AMDCIPCA) 1828 07818000
*                          + DRHS;                         /*@Y30SSJH*/ 07819000
@RF01822 LA    @06,2                                               1828 07820000
         AL    @06,KEYLVALU                                        1828 07821000
         ALR   @06,@06                                             1828 07822000
         AL    @06,@CF00311                                        1828 07823000
         L     @01,LCAMDPT                                         1828 07824000
         LH    @15,AMDCIPCA(,@01)                                  1828 07825000
         MH    @15,@CH00164                                        1828 07826000
         ALR   @06,@15                                             1828 07827000
         AH    @06,DRHS                                            1828 07828000
         ST    @06,XVAL                                            1828 07829000
*              SQRTSW = ON;                                /*@Y30SSJH*/ 07830000
*                                                                  1829 07831000
         OI    SQRTSW,B'10000000'                                  1829 07832000
*              /******************************************************/ 07833000
*              /*                                            @Y30SSJH*/ 07834000
*              /* CALCULATE THE SQUARE ROOT OF THE NUMBER OF @Y30SSJH*/ 07835000
*              /* THE NUMBER OF CI'S PER CA                  @Y30SSJH*/ 07836000
*              /*                                            @Y30SSJH*/ 07837000
*              /******************************************************/ 07838000
*                                                                  1830 07839000
*              DO SQRTINC = 1 BY 1 WHILE SQRTSW = ON;      /*@Y30SSJH*/ 07840000
         LA    @06,1                                               1830 07841000
         ST    @06,SQRTINC                                         1830 07842000
         B     @DE01830                                            1830 07843000
@DL01830 DS    0H                                                  1831 07844000
*                IF AMDCIPCA / (SQRTINC * SQRTINC) = 0             1831 07845000
*                  THEN                                            1831 07846000
         L     @06,SQRTINC                                         1831 07847000
         LR    @01,@06                                             1831 07848000
         MR    @00,@06                                             1831 07849000
         L     @15,LCAMDPT                                         1831 07850000
         LH    @02,AMDCIPCA(,@15)                                  1831 07851000
         SRDA  @02,32                                              1831 07852000
         DR    @02,@01                                             1831 07853000
         LTR   @03,@03                                             1831 07854000
         BNZ   @RF01831                                            1831 07855000
*                    DO;                                   /*@Y30SSJH*/ 07856000
*                                                                  1832 07857000
*                    SQRTVALU = SQRTINC - 1;               /*@Y30SSJH*/ 07858000
         BCTR  @06,0                                               1833 07859000
         ST    @06,SQRTVALU                                        1833 07860000
*                    SQRTSW = OFF;                         /*@Y30SSJH*/ 07861000
*                                                                  1834 07862000
         NI    SQRTSW,B'01111111'                                  1834 07863000
*                    END;                                  /*@Y30SSJH*/ 07864000
*                  ELSE ;                                  /*@Y30SSJH*/ 07865000
@RF01831 DS    0H                                                  1837 07866000
*              END;                                        /*@Y30SSJH*/ 07867000
*                                                                  1837 07868000
         LA    @06,1                                               1837 07869000
         AL    @06,SQRTINC                                         1837 07870000
         ST    @06,SQRTINC                                         1837 07871000
@DE01830 TM    SQRTSW,B'10000000'                                  1837 07872000
         BO    @DL01830                                            1837 07873000
*              YVAL = IRHS + (8 * AMDCIPCA) + (2 * SQRTVALU) + DRHS;    07874000
         L     @06,LCAMDPT                                         1838 07875000
         LH    @06,AMDCIPCA(,@06)                                  1838 07876000
         SLA   @06,3                                               1838 07877000
         AL    @06,@CF00311                                        1838 07878000
         L     @15,SQRTVALU                                        1838 07879000
         ALR   @15,@15                                             1838 07880000
         ALR   @06,@15                                             1838 07881000
         AH    @06,DRHS                                            1838 07882000
         ST    @06,YVAL                                            1838 07883000
*              MAXVALU = MAX(XVAL,YVAL);                   /*@Y30SSJH*/ 07884000
         L     @15,XVAL                                            1839 07885000
         CR    @15,@06                                             1839 07886000
         BNL   *+6                                                      07887000
         LR    @15,@06                                             1839 07888000
         ST    @15,MAXVALU                                         1839 07889000
*              IF CTGFLPT(1) -> AMDCINV < MAXVALU                  1840 07890000
*                THEN                                              1840 07891000
         L     @06,CTGFLPTR                                        1840 07892000
         L     @06,CTGFLPT(,@06)                                   1840 07893000
         C     @15,AMDCINV(,@06)                                   1840 07894000
         BNH   @RF01840                                            1840 07895000
*                  DO;                                     /*@Y30SSJH*/ 07896000
*                                                                  1841 07897000
*                  KEYRECRC = 12;                          /*@Y30SSJH*/ 07898000
         MVC   KEYRECRC(4),@CF00035                                1842 07899000
*                  ALSTID = CINVERR;                       /*@Y30SSJH*/ 07900000
         MVC   ALSTID(5),@CB01086                                  1843 07901000
*                  RETURN;                                 /*@Y30SSJH*/ 07902000
*                                                                  1844 07903000
         B     @EL00005                                            1844 07904000
*                  END;                                    /*@Y30SSJH*/ 07905000
*             END INDXLOOP;                                /*@Y30SSJH*/ 07906000
@RF01840 DS    0H                                                  1847 07907000
@RF01758 DS    0H                                                  1848 07908000
*            /********************************************************/ 07909000
*            /*                                              @Y30SSJH*/ 07910000
*            /* THIS ENDS PROCESSING FOR INDEXED CLUSTERS    @Y30SSJH*/ 07911000
*            /*                                              @Y30SSJH*/ 07912000
*            /********************************************************/ 07913000
*                                                                  1848 07914000
*                                                                  1848 07915000
*           /*********************************************************/ 07916000
*           /*                                               @Y30SSJH*/ 07917000
*           /* IF KEYS SPECIFIED FOR DATA OBJECT OF AN       @Y30SSJH*/ 07918000
*           /* ALTERNATE INDEX, MORE VALIDITY CHECKING IS    @Y30SSJH*/ 07919000
*           /* NEEDED                                        @Y30SSJH*/ 07920000
*           /*                                               @Y30SSJH*/ 07921000
*           /*********************************************************/ 07922000
*                                                                  1848 07923000
*           IF CKTYPE = 'G'   &                                    1848 07924000
*              (ADDR(KEY)) ^= NULLPTR  &                           1848 07925000
*              KEYRECRC = 0                                        1848 07926000
*             THEN                                                 1848 07927000
@RF01724 CLI   CKTYPE,C'G'                                         1848 07928000
         BNE   @RF01848                                            1848 07929000
         SLR   @06,@06                                             1848 07930000
         L     @15,@PC00001+4                                      1848 07931000
         C     @06,FDTPTR+220(,@15)                                1848 07932000
         BE    @RF01848                                            1848 07933000
         C     @06,KEYRECRC                                        1848 07934000
         BNE   @RF01848                                            1848 07935000
*AIXKEYLP:      DO;                                        /*@Y30SSJH*/ 07936000
*                                                                  1849 07937000
AIXKEYLP DS    0H                                                  1850 07938000
*               IF BDATACI ^= INITVALU                             1850 07939000
*                 THEN                                             1850 07940000
         CLC   BDATACI(3),INITVALU                                 1850 07941000
         BE    @RF01850                                            1850 07942000
*                   DO;                                    /*@Y30SSJH*/ 07943000
*                                                                  1851 07944000
*                   CTGENT = ADDR(BDATACI);                /*@Y30SSJH*/ 07945000
         LA    @06,BDATACI                                         1852 07946000
         L     @01,CTGPLPTR                                        1852 07947000
         ST    @06,CTGENT(,@01)                                    1852 07948000
*                   AMDSBWKA = ''B;                        /*@Y30SSJH*/ 07949000
         XC    AMDSBWKA(140),AMDSBWKA                              1853 07950000
*                   AMDTOTLN = LENGTH(AMDSBWKA);           /*@Y30SSJH*/ 07951000
         MVC   AMDTOTLN(2),@CH01673                                1854 07952000
*                   CTGFLNG(1) = NULLPTR;                  /*@Y30SSJH*/ 07953000
         SLR   @06,@06                                             1855 07954000
         L     @15,CTGFLPTR                                        1855 07955000
         ST    @06,CTGFLNG(,@15)                                   1855 07956000
*                   CTGFLPT(1) = NULLPTR;                  /*@Y30SSJH*/ 07957000
*                                                                  1856 07958000
         ST    @06,CTGFLPT(,@15)                                   1856 07959000
*                   /*************************************************/ 07960000
*                   /*                                       @Y30SSJH*/ 07961000
*                   /* ISSUE THE CATALOG LOCATE REQUEST      @Y30SSJH*/ 07962000
*                   /*                                       @Y30SSJH*/ 07963000
*                   /*************************************************/ 07964000
*                                                                  1857 07965000
*                   CALL IDCSACA0 (GDTTBL,CTGPLPTR);       /*@Y30SSJH*/ 07966000
*                                                                  1857 07967000
         L     @06,@PC00001                                        1857 07968000
         ST    @06,@AL00001                                        1857 07969000
         LA    @15,CTGPLPTR                                        1857 07970000
         ST    @15,@AL00001+4                                      1857 07971000
         L     @15,GDTCAT(,@06)                                    1857 07972000
         LA    @01,@AL00001                                        1857 07973000
         BALR  @14,@15                                             1857 07974000
*                   RESPECIFY (RTNREG) RSTD;               /*@Y30SSJH*/ 07975000
*                   CTGRTNCC = RTNREG;                     /*@Y30SSJH*/ 07976000
         ST    RTNREG,CTGRTNCC                                     1859 07977000
*                   RESPECIFY (RTNREG) UNRSTD;             /*@Y30SSJH*/ 07978000
*                                                                  1860 07979000
*                   IF GDTDBG = NULLPTR                            1861 07980000
*                     THEN;                                        1861 07981000
         L     @06,@PC00001                                        1861 07982000
         L     @06,GDTDBG(,@06)                                    1861 07983000
         LTR   @06,@06                                             1861 07984000
         BZ    @RT01861                                            1861 07985000
*                     ELSE                                         1863 07986000
*                       CALL IDCDB010 (GDTTBL,'AL54');             1863 07987000
         L     @06,@PC00001                                        1863 07988000
         ST    @06,@AL00001                                        1863 07989000
         LA    @15,@CC01561                                        1863 07990000
         ST    @15,@AL00001+4                                      1863 07991000
         MVI   @AL00001+4,X'80'                                    1863 07992000
         L     @15,GDTDBG(,@06)                                    1863 07993000
         LA    @01,@AL00001                                        1863 07994000
         BALR  @14,@15                                             1863 07995000
*                                                          /*@Y30SSJH*/ 07996000
*                                                                  1864 07997000
*                   IF CTGRTNCC ^= 0                               1864 07998000
*                     THEN                                         1864 07999000
@RT01861 L     @06,CTGRTNCC                                        1864 08000000
         LTR   @06,@06                                             1864 08001000
         BZ    @RF01864                                            1864 08002000
*                       DO;                                /*@Y30SSJH*/ 08003000
*                                                                  1865 08004000
*                       KEYRECRC = 12;                     /*@Y30SSJH*/ 08005000
         MVC   KEYRECRC(4),@CF00035                                1866 08006000
*                       ALSTID = CATERROR;                 /*@Y30SSJH*/ 08007000
         MVC   ALSTID(5),@CB01016                                  1867 08008000
*                       RETURN;                            /*@Y30SSJH*/ 08009000
*                                                                  1868 08010000
         B     @EL00005                                            1868 08011000
*                       END;                               /*@Y30SSJH*/ 08012000
*                                                                  1870 08013000
*                   /*************************************************/ 08014000
*                   /*                                       @Y30SSJH*/ 08015000
*                   /* ENSURE THAT THE AMDSB WAS SUCCESSFULLY        */ 08016000
*                   /* LOCATED                               @Y30SSJH*/ 08017000
*                   /*                                       @Y30SSJH*/ 08018000
*                   /*************************************************/ 08019000
*                                                                  1870 08020000
*                   IF CTGFLNG(1) = NULLPTR  |                     1870 08021000
*                      CTGFLPT(1) -> IDAAMDSB = NULLMASK           1870 08022000
*                     THEN                                         1870 08023000
@RF01864 L     @06,CTGFLPTR                                        1870 08024000
         L     @15,CTGFLNG(,@06)                                   1870 08025000
         LTR   @15,@15                                             1870 08026000
         BZ    @RT01870                                            1870 08027000
         L     @06,CTGFLPT(,@06)                                   1870 08028000
         CLC   IDAAMDSB(8,@06),NULLMASK                            1870 08029000
         BNE   @RF01870                                            1870 08030000
@RT01870 DS    0H                                                  1871 08031000
*                       DO;                                /*@Y30SSJH*/ 08032000
*                                                                  1871 08033000
*                       KEYRECRC = 12;                     /*@Y30SSJH*/ 08034000
         MVC   KEYRECRC(4),@CF00035                                1872 08035000
*                       ALSTID = LOCRTNER;                 /*@Y30SSJH*/ 08036000
         MVC   ALSTID(5),@CB01025                                  1873 08037000
*                       RETURN;                            /*@Y30SSJH*/ 08038000
*                                                                  1874 08039000
         B     @EL00005                                            1874 08040000
*                       END;                               /*@Y30SSJH*/ 08041000
*                   END;                                   /*@Y30SSJH*/ 08042000
*                 /***************************************************/ 08043000
*                 /*                                         @Y30SSJH*/ 08044000
*                 /* THE BASE CLUSTER MUST BE LOCATED IN     @Y30SSJH*/ 08045000
*                 /* ORDER TO RETRIEVE ITS DATA ASSOCIATION  @Y30SSJH*/ 08046000
*                 /*                                         @Y30SSJH*/ 08047000
*                 /***************************************************/ 08048000
*                                                                  1877 08049000
*                 ELSE                                             1877 08050000
*                   IF BCLUSCI = INITVALU                          1877 08051000
*                     THEN                                         1877 08052000
         B     @RC01850                                            1877 08053000
@RF01850 CLC   BCLUSCI(3),INITVALU                                 1877 08054000
         BNE   @RF01877                                            1877 08055000
*                       DO;                                /*@Y30SSJH*/ 08056000
*                                                                  1878 08057000
*                       KEYRECRC = 12;                     /*@Y30SSJH*/ 08058000
         MVC   KEYRECRC(4),@CF00035                                1879 08059000
*                       ALSTID = LOCRTNER;                 /*@Y30SSJH*/ 08060000
         MVC   ALSTID(5),@CB01025                                  1880 08061000
*                       RETURN;                            /*@Y30SSJH*/ 08062000
*                                                                  1881 08063000
         B     @EL00005                                            1881 08064000
*                       END;                               /*@Y30SSJH*/ 08065000
*                    ELSE                                          1883 08066000
*                      DO;                                 /*@Y30SSJH*/ 08067000
*                                                                  1883 08068000
@RF01877 DS    0H                                                  1884 08069000
*                      /**********************************************/ 08070000
*                      /*                                    @Y30SSJH*/ 08071000
*                      /*  RESET THE CPL AND FPL             @Y30SSJH*/ 08072000
*                      /*                                    @Y30SSJH*/ 08073000
*                      /**********************************************/ 08074000
*                                                                  1884 08075000
*                      CTGENT = ADDR(BCLUSCI);             /*@Y30SSJH*/ 08076000
         L     @06,CTGPLPTR                                        1884 08077000
         LA    @15,BCLUSCI                                         1884 08078000
         ST    @15,CTGENT(,@06)                                    1884 08079000
*                      CTGBYPSS = ON;                      /*@Y30SSJH*/ 08080000
         OI    CTGBYPSS(@06),B'10000000'                           1885 08081000
*                      ASSOCWKA = ''B;                     /*@Y30SSJH*/ 08082000
         XC    ASSOCWKA(32),ASSOCWKA                               1886 08083000
*                      CTGWKA = ADDR(ASSOCWKA);            /*@Y30SSJH*/ 08084000
         LA    @15,ASSOCWKA                                        1887 08085000
         ST    @15,CTGWKA(,@06)                                    1887 08086000
*                      ASSTOTLN = LENGTH(ASSOCWKA);        /*@Y30SSJH*/ 08087000
*                                                                  1888 08088000
         MVC   ASSTOTLN(2),@CH00222                                1888 08089000
*                      CTGFLPTR = ADDR(ALFPLNAM);          /*@Y30SSJH*/ 08090000
         L     @15,ALPRMPTR                                        1889 08091000
         LA    @14,ALFPLNAM(,@15)                                  1889 08092000
         ST    @14,CTGFLPTR                                        1889 08093000
*                      ALFPLNAM = ''B;                     /*@Y30SSJH*/ 08094000
         XC    ALFPLNAM(16,@15),ALFPLNAM(@15)                      1890 08095000
*                      CTGFLNG(1) = NULLPTR;               /*@Y30SSJH*/ 08096000
         SLR   @05,@05                                             1891 08097000
         ST    @05,CTGFLNG(,@14)                                   1891 08098000
*                      CTGFLPT(1) = NULLPTR;               /*@Y30SSJH*/ 08099000
         ST    @05,CTGFLPT(,@14)                                   1892 08100000
*                      CTGFIELD(1) = CTGFLPTR;             /*@Y30SSJH*/ 08101000
         ST    @14,CTGFIELD(,@06)                                  1893 08102000
*                      CTGFLDNO = 1;                       /*@Y30SSJH*/ 08103000
         MVI   CTGFLDNO(@14),X'01'                                 1894 08104000
*                      CTGFLDNM = ADDR(ALFLDNAM(3));       /*@Y30SSJH*/ 08105000
*                                                                  1895 08106000
         LA    @06,ALFLDNAM+16                                     1895 08107000
         ST    @06,CTGFLDNM(,@14)                                  1895 08108000
*                      /**********************************************/ 08109000
*                      /*                                    @Y30SSJH*/ 08110000
*                      /*INITIALIZE NAMEDS TEST FPL AND      @Y30SSJH*/ 08111000
*                      /* REFERENCE IT IN THE NAMEDS FPL - THIS      */ 08112000
*                      /* LIMITS THE NUMBER THE NUMBER OF    @Y30SSJH*/ 08113000
*                      /* ASSOCIATIONS RETURNED TO FIVE      @Y30SSJH*/ 08114000
*                      /*                                    @Y30SSJH*/ 08115000
*                      /**********************************************/ 08116000
*                                                                  1896 08117000
*                      CTGFLPTR = ADDR(ALFPLTST);          /*@Y30SSJH*/ 08118000
         LA    @06,ALFPLTST(,@15)                                  1896 08119000
         ST    @06,CTGFLPTR                                        1896 08120000
*                      ALFPLTST = ''B;                     /*@Y30SSJH*/ 08121000
         XC    ALFPLTST(16,@15),ALFPLTST(@15)                      1897 08122000
*                      CTGFLDNO = 1;                       /*@Y30SSJH*/ 08123000
         MVI   CTGFLDNO(@06),X'01'                                 1898 08124000
*                      CTGFLDCD = CTGFLDLE;                /*@Y30SSJH*/ 08125000
         MVI   CTGFLDCD(@06),X'C0'                                 1899 08126000
*                      CTGFLDNM = ADDR(ALFLDNAM(16));      /*@Y30SSJH*/ 08127000
         LA    @14,ALFLDNAM+120                                    1900 08128000
         ST    @14,CTGFLDNM(,@06)                                  1900 08129000
*                      CTGFLNG(1) = 2;                     /*@Y30SSJH*/ 08130000
         MVC   CTGFLNG(4,@06),@CF00155                             1901 08131000
*                      CTGFLPT(1) = ADDR(NAMEMASK);        /*@Y30SSJH*/ 08132000
         LA    @14,NAMEMASK                                        1902 08133000
         ST    @14,CTGFLPT(,@06)                                   1902 08134000
*                      CTGFLPTR = ADDR(ALFPLNAM);          /*@Y30SSJH*/ 08135000
         LA    @06,ALFPLNAM(,@15)                                  1903 08136000
         ST    @06,CTGFLPTR                                        1903 08137000
*                      CTGFLCHN = ADDR(ALFPLTST);          /*@Y30SSJH*/ 08138000
*                                                                  1904 08139000
         LA    @15,ALFPLTST(,@15)                                  1904 08140000
         ST    @15,CTGFLCHN(,@06)                                  1904 08141000
*                      /**********************************************/ 08142000
*                      /*                                    @Y30SSJH*/ 08143000
*                      /* ISSUE THE CATALOG LOCATE REQUEST   @Y30SSJH*/ 08144000
*                      /*                                    @Y30SSJH*/ 08145000
*                      /**********************************************/ 08146000
*                                                                  1905 08147000
*                      CALL IDCSACA0 (GDTTBL,CTGPLPTR);    /*@Y30SSJH*/ 08148000
*                                                                  1905 08149000
         L     @06,@PC00001                                        1905 08150000
         ST    @06,@AL00001                                        1905 08151000
         LA    @15,CTGPLPTR                                        1905 08152000
         ST    @15,@AL00001+4                                      1905 08153000
         L     @15,GDTCAT(,@06)                                    1905 08154000
         LA    @01,@AL00001                                        1905 08155000
         BALR  @14,@15                                             1905 08156000
*                      RESPECIFY (RTNREG) RSTD;            /*@Y30SSJH*/ 08157000
*                      CTGRTNCC = RTNREG;                  /*@Y30SSJH*/ 08158000
         ST    RTNREG,CTGRTNCC                                     1907 08159000
*                      RESPECIFY (RTNREG) UNRSTD;          /*@Y30SSJH*/ 08160000
*                                                                  1908 08161000
*                      IF GDTDBG = NULLPTR                         1909 08162000
*                        THEN;                                     1909 08163000
         L     @06,@PC00001                                        1909 08164000
         L     @06,GDTDBG(,@06)                                    1909 08165000
         LTR   @06,@06                                             1909 08166000
         BZ    @RT01909                                            1909 08167000
*                        ELSE                                      1911 08168000
*                          CALL IDCDB010(GDTTBL,'AL55');           1911 08169000
         L     @06,@PC00001                                        1911 08170000
         ST    @06,@AL00001                                        1911 08171000
         LA    @15,@CC01562                                        1911 08172000
         ST    @15,@AL00001+4                                      1911 08173000
         MVI   @AL00001+4,X'80'                                    1911 08174000
         L     @15,GDTDBG(,@06)                                    1911 08175000
         LA    @01,@AL00001                                        1911 08176000
         BALR  @14,@15                                             1911 08177000
*                                                          /*@Y30SSJH*/ 08178000
*                                                                  1912 08179000
*                      IF CTGRTNCC ^= 0                            1912 08180000
*                        THEN                                      1912 08181000
@RT01909 L     @06,CTGRTNCC                                        1912 08182000
         LTR   @06,@06                                             1912 08183000
         BZ    @RF01912                                            1912 08184000
*                          DO;                             /*@Y30SSJH*/ 08185000
*                                                                  1913 08186000
*                          KEYRECRC = 12;                  /*@Y30SSJH*/ 08187000
         MVC   KEYRECRC(4),@CF00035                                1914 08188000
*                          ALSTID = CATERROR;              /*@Y30SSJH*/ 08189000
         MVC   ALSTID(5),@CB01016                                  1915 08190000
*                          RETURN;                         /*@Y30SSJH*/ 08191000
*                                                                  1916 08192000
         B     @EL00005                                            1916 08193000
*                          END;                            /*@Y30SSJH*/ 08194000
*                                                                  1917 08195000
*                      /**********************************************/ 08196000
*                      /*                                    @Y30SSJH*/ 08197000
*                      /* PICK UP DATA ASSOCIATION           @Y30SSJH*/ 08198000
*                      /*                                    @Y30SSJH*/ 08199000
*                      /**********************************************/ 08200000
*                                                                  1918 08201000
*                      CTGFLPTR = ADDR(ALFPLNAM);          /*@Y30SSJH*/ 08202000
@RF01912 L     @06,ALPRMPTR                                        1918 08203000
         LA    @06,ALFPLNAM(,@06)                                  1918 08204000
         ST    @06,CTGFLPTR                                        1918 08205000
*                      IF CTGFLNG(1) ^= NULLPTR  &                 1919 08206000
*                         CTGFLPT(1) -> LCNAMEDS(1,1:4) ^=         1919 08207000
*                            NULLMASK(1:4)  &                      1919 08208000
*                         CTGFLPT(1) -> LCNAMID(1) = 'D'           1919 08209000
*                        THEN                                      1919 08210000
         L     @15,CTGFLNG(,@06)                                   1919 08211000
         LTR   @15,@15                                             1919 08212000
         BZ    @RF01919                                            1919 08213000
         L     @06,CTGFLPT(,@06)                                   1919 08214000
         CLC   LCNAMEDS(4,@06),NULLMASK                            1919 08215000
         BE    @RF01919                                            1919 08216000
         CLI   LCNAMID(@06),C'D'                                   1919 08217000
         BNE   @RF01919                                            1919 08218000
*                          BDATACI = CTGFLPT(1) -> LCNAMCI(1);     1920 08219000
         MVC   BDATACI(3),LCNAMCI(@06)                             1920 08220000
*                        ELSE                                      1921 08221000
*                          DO;                             /*@Y30SSJH*/ 08222000
*                                                                  1921 08223000
         B     @RC01919                                            1921 08224000
@RF01919 DS    0H                                                  1922 08225000
*                          KEYRECRC = 12;                  /*@Y30SSJH*/ 08226000
         MVC   KEYRECRC(4),@CF00035                                1922 08227000
*                          ALSTID = LOCRTNER;              /*@Y30SSJH*/ 08228000
         MVC   ALSTID(5),@CB01025                                  1923 08229000
*                          RETURN;                         /*@Y30SSJH*/ 08230000
*                                                                  1924 08231000
         B     @EL00005                                            1924 08232000
*                          END;                            /*@Y30SSJH*/ 08233000
*                                                                  1925 08234000
*                      /**********************************************/ 08235000
*                      /*                                    @Y30SSJH*/ 08236000
*                      /* RESET CPL AND FPL TO LOCATE AMDSB  @Y30SSJH*/ 08237000
*                      /* OF DATA OBJECT                     @Y30SSJH*/ 08238000
*                      /*                                    @Y30SSJH*/ 08239000
*                      /**********************************************/ 08240000
*                                                                  1926 08241000
*                      CTGENT = ADDR(BDATACI);             /*@Y30SSJH*/ 08242000
@RC01919 L     @06,CTGPLPTR                                        1926 08243000
         LA    @15,BDATACI                                         1926 08244000
         ST    @15,CTGENT(,@06)                                    1926 08245000
*                      CTGWKA = ADDR(AMDSBWKA);            /*@Y30SSJH*/ 08246000
         LA    @15,AMDSBWKA                                        1927 08247000
         ST    @15,CTGWKA(,@06)                                    1927 08248000
*                      AMDSBWKA = ''B;                     /*@Y30SSJH*/ 08249000
         XC    AMDSBWKA(140),AMDSBWKA                              1928 08250000
*                      AMDTOTLN = LENGTH(AMDSBWKA);        /*@Y30SSJH*/ 08251000
         MVC   AMDTOTLN(2),@CH01673                                1929 08252000
*                      CTGFLPTR = ADDR(ALFPLAMD);          /*@Y30SSJH*/ 08253000
         L     @15,ALPRMPTR                                        1930 08254000
         LA    @14,ALFPLAMD(,@15)                                  1930 08255000
         ST    @14,CTGFLPTR                                        1930 08256000
*                      ALFPLAMD = ''B;                     /*@Y30SSJH*/ 08257000
         XC    ALFPLAMD(16,@15),ALFPLAMD(@15)                      1931 08258000
*                      CTGFLNG(1) = NULLPTR;               /*@Y30SSJH*/ 08259000
         SLR   @15,@15                                             1932 08260000
         ST    @15,CTGFLNG(,@14)                                   1932 08261000
*                      CTGFLPT(1) = NULLPTR;               /*@Y30SSJH*/ 08262000
         ST    @15,CTGFLPT(,@14)                                   1933 08263000
*                      CTGFIELD(1) = CTGFLPTR;             /*@Y30SSJH*/ 08264000
         ST    @14,CTGFIELD(,@06)                                  1934 08265000
*                      CTGFLDNO = 1;                       /*@Y30SSJH*/ 08266000
         MVI   CTGFLDNO(@14),X'01'                                 1935 08267000
*                      CTGFLDNM = ADDR(ALFLDNAM(8));       /*@Y30SSJH*/ 08268000
*                                                                  1936 08269000
         LA    @06,ALFLDNAM+56                                     1936 08270000
         ST    @06,CTGFLDNM(,@14)                                  1936 08271000
*                      /**********************************************/ 08272000
*                      /*                                    @Y30SSJH*/ 08273000
*                      /* ISSUE THE CATALOG LOCATE REQUEST   @Y30SSJH*/ 08274000
*                      /*                                    @Y30SSJH*/ 08275000
*                      /**********************************************/ 08276000
*                      CALL IDCSACA0(GDTTBL,CTGPLPTR);     /*@Y30SSJH*/ 08277000
*                                                                  1937 08278000
         L     @06,@PC00001                                        1937 08279000
         ST    @06,@AL00001                                        1937 08280000
         LA    @15,CTGPLPTR                                        1937 08281000
         ST    @15,@AL00001+4                                      1937 08282000
         L     @15,GDTCAT(,@06)                                    1937 08283000
         LA    @01,@AL00001                                        1937 08284000
         BALR  @14,@15                                             1937 08285000
*                      RESPECIFY (RTNREG) RSTD;            /*@Y30SSJH*/ 08286000
*                      CTGRTNCC = RTNREG;                  /*@Y30SSJH*/ 08287000
         ST    RTNREG,CTGRTNCC                                     1939 08288000
*                      RESPECIFY (RTNREG) UNRSTD;          /*@Y30SSJH*/ 08289000
*                                                                  1940 08290000
*                      IF GDTDBG = NULLPTR                         1941 08291000
*                        THEN;                                     1941 08292000
         L     @06,@PC00001                                        1941 08293000
         L     @06,GDTDBG(,@06)                                    1941 08294000
         LTR   @06,@06                                             1941 08295000
         BZ    @RT01941                                            1941 08296000
*                        ELSE                                      1943 08297000
*                          CALL IDCDB010 (GDTTBL,'AL56');          1943 08298000
         L     @06,@PC00001                                        1943 08299000
         ST    @06,@AL00001                                        1943 08300000
         LA    @15,@CC01563                                        1943 08301000
         ST    @15,@AL00001+4                                      1943 08302000
         MVI   @AL00001+4,X'80'                                    1943 08303000
         L     @15,GDTDBG(,@06)                                    1943 08304000
         LA    @01,@AL00001                                        1943 08305000
         BALR  @14,@15                                             1943 08306000
*                                                          /*@Y30SSJH*/ 08307000
*                      IF CTGRTNCC ^= 0                            1944 08308000
*                        THEN                                      1944 08309000
@RT01941 L     @06,CTGRTNCC                                        1944 08310000
         LTR   @06,@06                                             1944 08311000
         BZ    @RF01944                                            1944 08312000
*                          DO;                             /*@Y30SSJH*/ 08313000
*                                                                  1945 08314000
*                          KEYRECRC = 12;                  /*@Y30SSJH*/ 08315000
         MVC   KEYRECRC(4),@CF00035                                1946 08316000
*                          ALSTID = CATERROR;              /*@Y30SSJH*/ 08317000
         MVC   ALSTID(5),@CB01016                                  1947 08318000
*                          RETURN;                         /*@Y30SSJH*/ 08319000
*                                                                  1948 08320000
         B     @EL00005                                            1948 08321000
*                          END;                            /*@Y30SSJH*/ 08322000
*                                                                  1949 08323000
*                      /**********************************************/ 08324000
*                      /*                                    @Y30SSJH*/ 08325000
*                      /* ENSURE THAT THE AMDSB WAS SUCCESSFULLY     */ 08326000
*                      /* LOCATED                            @Y30SSJH*/ 08327000
*                      /*                                    @Y30SSJH*/ 08328000
*                      /**********************************************/ 08329000
*                                                                  1950 08330000
*                      IF CTGFLNG(1) = NULLPTR  |                  1950 08331000
*                         CTGFLPT(1) -> IDAAMDSB = NULLMASK        1950 08332000
*                        THEN                                      1950 08333000
@RF01944 L     @06,CTGFLPTR                                        1950 08334000
         L     @15,CTGFLNG(,@06)                                   1950 08335000
         LTR   @15,@15                                             1950 08336000
         BZ    @RT01950                                            1950 08337000
         L     @06,CTGFLPT(,@06)                                   1950 08338000
         CLC   IDAAMDSB(8,@06),NULLMASK                            1950 08339000
         BNE   @RF01950                                            1950 08340000
@RT01950 DS    0H                                                  1951 08341000
*                          DO;                             /*@Y30SSJH*/ 08342000
*                                                                  1951 08343000
*                          KEYRECRC = 12;                  /*@Y30SSJH*/ 08344000
         MVC   KEYRECRC(4),@CF00035                                1952 08345000
*                          ALSTID = LOCRTNER;              /*@Y30SSJH*/ 08346000
         MVC   ALSTID(5),@CB01025                                  1953 08347000
*                          RETURN;                         /*@Y30SSJH*/ 08348000
*                                                                  1954 08349000
         B     @EL00005                                            1954 08350000
*                          END;                            /*@Y30SSJH*/ 08351000
*                      END;                                /*@Y30SSJH*/ 08352000
*                                                                  1956 08353000
@RF01950 DS    0H                                                  1957 08354000
*              /******************************************************/ 08355000
*              /*                                            @Y30SSJH*/ 08356000
*              /* ENSURE NEW KEY VALUES FOR THE ALTERNATE INDEX      */ 08357000
*              /* DO NOT CONFLICT WITH THE BASE CLUSTER'S    @Y30SSJH*/ 08358000
*              /* RECORDSIZE OR CONTROL INTERVAL SIZE        @Y30SSJH*/ 08359000
*              /*                                            @Y30SSJH*/ 08360000
*              /******************************************************/ 08361000
*                                                                  1957 08362000
*              IF KEYPSVAL + KEYLNVAL > CTGFLPT(1) -> AMDLRECL     1957 08363000
*                THEN                                              1957 08364000
@RC01850 L     @06,@PC00001+4                                      1957 08365000
         L     @01,FDTPTR+228(,@06)                                1957 08366000
         L     @06,FDTPTR+224(,@06)                                1957 08367000
         L     @15,KEYPSVAL(,@01)                                  1957 08368000
         AL    @15,KEYLNVAL(,@06)                                  1957 08369000
         L     @06,CTGFLPTR                                        1957 08370000
         L     @06,CTGFLPT(,@06)                                   1957 08371000
         C     @15,AMDLRECL(,@06)                                  1957 08372000
         BNH   @RF01957                                            1957 08373000
*                  DO;                                     /*@Y30SSJH*/ 08374000
*                                                                  1958 08375000
*                  KEYRECRC = 12;                          /*@Y30SSJH*/ 08376000
         MVC   KEYRECRC(4),@CF00035                                1959 08377000
*                  ALSTID = AIXCLSER;                      /*@Y30SSJH*/ 08378000
         MVC   ALSTID(5),@CB01089                                  1960 08379000
*                  RETURN;                                 /*@Y30SSJH*/ 08380000
*                                                                  1961 08381000
         B     @EL00005                                            1961 08382000
*                  END;                                    /*@Y30SSJH*/ 08383000
*                                                                  1962 08384000
*              IF CTGFLPT(1) -> AMDSPAN = ON                       1963 08385000
*                THEN                                              1963 08386000
@RF01957 L     @06,CTGFLPTR                                        1963 08387000
         L     @06,CTGFLPT(,@06)                                   1963 08388000
         TM    AMDSPAN(@06),B'00000001'                            1963 08389000
         BNO   @RF01963                                            1963 08390000
*                  IF KEYPSVAL + KEYLNVAL > CTGFLPT(1) -> AMDCINV  1964 08391000
*                                         - SPDRHS                 1964 08392000
*                    THEN                                          1964 08393000
         L     @15,@PC00001+4                                      1964 08394000
         L     @01,FDTPTR+228(,@15)                                1964 08395000
         L     @15,FDTPTR+224(,@15)                                1964 08396000
         L     @14,KEYPSVAL(,@01)                                  1964 08397000
         AL    @14,KEYLNVAL(,@15)                                  1964 08398000
         L     @06,AMDCINV(,@06)                                   1964 08399000
         SL    @06,@CF00037                                        1964 08400000
         CR    @14,@06                                             1964 08401000
         BNH   @RF01964                                            1964 08402000
*                      DO;                                 /*@Y30SSJH*/ 08403000
*                                                                  1965 08404000
*                      KEYRECRC = 12;                      /*@Y30SSJH*/ 08405000
         MVC   KEYRECRC(4),@CF00035                                1966 08406000
*                      ALSTID = AIXCLSER;                  /*@Y30SSJH*/ 08407000
         MVC   ALSTID(5),@CB01089                                  1967 08408000
*                      RETURN;                             /*@Y30SSJH*/ 08409000
*                                                                  1968 08410000
         B     @EL00005                                            1968 08411000
*                      END;                                /*@Y30SSJH*/ 08412000
*                                                                  1969 08413000
*              END AIXKEYLP;                               /*@Y30SSJH*/ 08414000
*                                                                  1970 08415000
@RF01964 DS    0H                                                  1970 08416000
@RF01963 DS    0H                                                  1971 08417000
*                                                                  1971 08418000
*          IF (ADDR(KEY)) ^= NULLPTR    &                          1971 08419000
*             KEYRECRC = 0                                         1971 08420000
*            THEN                                                  1971 08421000
@RF01848 SLR   @06,@06                                             1971 08422000
         L     @15,@PC00001+4                                      1971 08423000
         C     @06,FDTPTR+220(,@15)                                1971 08424000
         BE    @RF01971                                            1971 08425000
         C     @06,KEYRECRC                                        1971 08426000
         BNE   @RF01971                                            1971 08427000
*              DO;                                         /*@Y30SSJH*/ 08428000
*                                                                  1972 08429000
*              /******************************************************/ 08430000
*              /*                                            @Y30SSJH*/ 08431000
*              /* DETERMINE OLD KEY POSITION                 @Y30SSJH*/ 08432000
*              /*                                            @Y30SSJH*/ 08433000
*              /******************************************************/ 08434000
*                                                                  1973 08435000
*              IF CKTYPE = 'G'                                     1973 08436000
*                THEN                                              1973 08437000
         CLI   CKTYPE,C'G'                                         1973 08438000
         BNE   @RF01973                                            1973 08439000
*                  KYPOSIT = AMDAXRKP;                     /*@Y30SSJH*/ 08440000
         L     @06,LCAMDPT                                         1974 08441000
         LH    @06,AMDAXRKP(,@06)                                  1974 08442000
         ST    @06,KYPOSIT                                         1974 08443000
*                ELSE                                              1975 08444000
*                  KYPOSIT = AMDRKP;                       /*@Y30SSJH*/ 08445000
*                                                                  1975 08446000
         B     @RC01973                                            1975 08447000
@RF01973 L     @06,LCAMDPT                                         1975 08448000
         LH    @06,AMDRKP(,@06)                                    1975 08449000
         ST    @06,KYPOSIT                                         1975 08450000
*              /******************************************************/ 08451000
*              /*                                            @Y30SSJH*/ 08452000
*              /* ENSURE PREVIOUS KEY VALUES ARE NOT         @Y30SSJH*/ 08453000
*              /* EQUAL TO NEW VALUES                        @Y30SSJH*/ 08454000
*              /*                                            @Y30SSJH*/ 08455000
*              /******************************************** @Y30SSJH*/ 08456000
*                                                                  1976 08457000
*              IF KYPOSIT = KEYPSVAL  &                            1976 08458000
*                 AMDKEYLN = KEYLNVAL                              1976 08459000
*                THEN                                              1976 08460000
@RC01973 L     @06,KYPOSIT                                         1976 08461000
         L     @15,@PC00001+4                                      1976 08462000
         L     @01,FDTPTR+228(,@15)                                1976 08463000
         C     @06,KEYPSVAL(,@01)                                  1976 08464000
         BNE   @RF01976                                            1976 08465000
         L     @01,LCAMDPT                                         1976 08466000
         LH    @14,AMDKEYLN(,@01)                                  1976 08467000
         L     @15,FDTPTR+224(,@15)                                1976 08468000
         C     @14,KEYLNVAL(,@15)                                  1976 08469000
         BNE   @RF01976                                            1976 08470000
*                  DO;                                     /*@Y30SSJH*/ 08471000
*                                                                  1977 08472000
*                  IF KYPOSIT = KEYPSDEF   &                       1978 08473000
*                     AMDKEYLN = KEYLNDEF                          1978 08474000
*                    THEN                                          1978 08475000
         LTR   @06,@06                                             1978 08476000
         BNZ   @RF01978                                            1978 08477000
         C     @14,@CF00756                                        1978 08478000
         BNE   @RF01978                                            1978 08479000
*                      KEYRECRC = 4;                       /*@Y30SSJH*/ 08480000
         MVC   KEYRECRC(4),@CF00044                                1979 08481000
*                    ELSE                                          1980 08482000
*                      KEYRECRC = 5;                       /*@Y30SSJH*/ 08483000
*                                                                  1980 08484000
         B     @RC01978                                            1980 08485000
@RF01978 MVC   KEYRECRC(4),@CF00287                                1980 08486000
*                  END;                                    /*@Y30SSJH*/ 08487000
*                ELSE                                              1982 08488000
*                  IF KYPOSIT = KEYPSDEF  &                        1982 08489000
*                     AMDKEYLN = KEYLNDEF                          1982 08490000
*                    THEN                                          1982 08491000
         B     @RC01976                                            1982 08492000
@RF01976 L     @06,KYPOSIT                                         1982 08493000
         LTR   @06,@06                                             1982 08494000
         BNZ   @RF01982                                            1982 08495000
         L     @06,LCAMDPT                                         1982 08496000
         CLC   AMDKEYLN(2,@06),@CH00756                            1982 08497000
         BE    @RT01982                                            1982 08498000
*                      ;                                   /*@Y30SSJH*/ 08499000
*                    ELSE                                          1984 08500000
*                      DO;                                 /*@Y30SSJH*/ 08501000
*                                                                  1984 08502000
@RF01982 DS    0H                                                  1985 08503000
*                      KEYRECRC = 8;                       /*@Y30SSJH*/ 08504000
         MVC   KEYRECRC(4),@CF00039                                1985 08505000
*                      ALSTID = NEWVALER;                  /*@Y30SSJH*/ 08506000
         MVC   ALSTID(5),@CB01092                                  1986 08507000
*                      RETURN;                             /*@Y30SSJH*/ 08508000
*                                                                  1987 08509000
         B     @EL00005                                            1987 08510000
*                      END;                                /*@Y30SSJH*/ 08511000
*               END;                                       /*@Y30SSJH*/ 08512000
@RT01982 DS    0H                                                  1989 08513000
@RC01976 DS    0H                                                  1990 08514000
*          END KEYRECLP;                                   /*@Y30SSJH*/ 08515000
@RF01971 DS    0H                                                  1991 08516000
*        /************************************************************/ 08517000
*        /*                                                  @Y30SSJH*/ 08518000
*        /* VERIFICATION OF THE UNIQUEKEY PARAMETER -        @Y30SSJH*/ 08519000
*        /* VERIFICATION TAKES PLACE AGAINST THE DATA OBJECT @Y30SSJH*/ 08520000
*        /* LOCATED ON EITHER THE PRIMARY LOCATE OR, IF KEYS @Y30SSJH*/ 08521000
*        /* AND/OR RECORDSIZE WAS SPECIFIED, THE SECONDARY   @Y30SSJH*/ 08522000
*        /* LOCATE PERFORMED DURING THE VERIFICATION OF      @Y30SSJH*/ 08523000
*        /* THOSE PARAMETERS                                 @Y30SSJH*/ 08524000
*        /*                                                  @Y30SSJH*/ 08525000
*        /************************************************************/ 08526000
*                                                                  1991 08527000
*        IF (ADDR(UNQK)) ^= NULLPTR                                1991 08528000
*          THEN                                                    1991 08529000
@RF01532 L     @06,@PC00001+4                                      1991 08530000
         L     @06,FDTPTR+244(,@06)                                1991 08531000
         LTR   @06,@06                                             1991 08532000
         BZ    @RF01991                                            1991 08533000
*UNQKLOOP:   DO;                                           /*@Y30SSJH*/ 08534000
*                                                                  1992 08535000
UNQKLOOP DS    0H                                                  1993 08536000
*            /********************************************************/ 08537000
*            /*                                              @Y30SSJH*/ 08538000
*            /* VERIFY THAT THE DATA OBJECT IS OF AN AIX     @Y30SSJH*/ 08539000
*            /*                                              @Y30SSJH*/ 08540000
*            /********************************************************/ 08541000
*                                                                  1993 08542000
*            IF LCNAMID(1) ^= 'G'                                  1993 08543000
*              THEN                                                1993 08544000
         L     @06,LCNAMPT                                         1993 08545000
         CLI   LCNAMID(@06),C'G'                                   1993 08546000
         BE    @RF01993                                            1993 08547000
*                DO;                                       /*@Y30SSJH*/ 08548000
*                                                                  1994 08549000
*                ALSTID = INVAIXER;                        /*@Y30SSJH*/ 08550000
         MVC   ALSTID(5),@CB01028                                  1995 08551000
*                RETURN;                                   /*@Y30SSJH*/ 08552000
*                                                                  1996 08553000
         B     @EL00005                                            1996 08554000
*                END;                                      /*@Y30SSJH*/ 08555000
*                                                                  1997 08556000
*            /********************************************************/ 08557000
*            /*                                              @Y30SSJH*/ 08558000
*            /* IF THE ATTRIBUTE WAS PREVIOUSLY NONUNIQUEKEY @Y30SSJH*/ 08559000
*            /* PROCEED WITH VERIFICATION                    @Y30SSJH*/ 08560000
*            /*                                              @Y30SSJH*/ 08561000
*            /********************************************************/ 08562000
*                                                                  1998 08563000
*            IF AMDUNQ = ON                                        1998 08564000
*              THEN                                                1998 08565000
@RF01993 L     @06,LCAMDPT                                         1998 08566000
         TM    AMDUNQ(@06),B'10000000'                             1998 08567000
         BNO   @RF01998                                            1998 08568000
*UNQKVERF:       DO;                                       /*@Y30SSJH*/ 08569000
*                                                                  1999 08570000
UNQKVERF DS    0H                                                  2000 08571000
*                /****************************************************/ 08572000
*                /*                                          @Y30SSJH*/ 08573000
*                /* VERIFY THAT THE HIGH-USED RBA OF THIS    @Y30SSJH*/ 08574000
*                /* DATA OBJECT IS ZERO                      @Y30SSJH*/ 08575000
*                /*                                          @Y30SSJH*/ 08576000
*                /****************************************************/ 08577000
*                                                                  2000 08578000
*                IF LCRBAPT = NULLPTR |                            2000 08579000
*                   LCHURBA ^= '00000000'X                         2000 08580000
*                  THEN                                            2000 08581000
         L     @06,LCRBAPT                                         2000 08582000
         LTR   @06,@06                                             2000 08583000
         BZ    @RT02000                                            2000 08584000
         CLC   LCHURBA(4,@06),@CB01568                             2000 08585000
         BE    @RF02000                                            2000 08586000
@RT02000 DS    0H                                                  2001 08587000
*                    DO;                                   /*@Y30SSJH*/ 08588000
*                                                                  2001 08589000
*                    ALSTID = UNQUPGER;                    /*@Y30SSJH*/ 08590000
         MVC   ALSTID(5),@CB01031                                  2002 08591000
*                    RETURN;                               /*@Y30SSJH*/ 08592000
*                                                                  2003 08593000
         B     @EL00005                                            2003 08594000
*                    END;                                  /*@Y30SSJH*/ 08595000
*                                                                  2004 08596000
*                END UNQKVERF;                             /*@Y30SSJH*/ 08597000
*                                                                  2005 08598000
*            END UNQKLOOP;                                 /*@Y30SSJH*/ 08599000
*                                                                  2006 08600000
*        /************************************************************/ 08601000
*        /*                                                  @Y30SSJH*/ 08602000
*        /* CHECKPRC PROCESSING IS COMPLETE - RETURN         @Y30SSJH*/ 08603000
*        /* TO INVOKER                                       @Y30SSJH*/ 08604000
*        /*                                                  @Y30SSJH*/ 08605000
*        /************************************************************/ 08606000
*                                                                  2007 08607000
*        RETURN;                                           /*@Y30SSJH*/ 08608000
*                                                                  2007 08609000
         B     @EL00005                                            2007 08610000
*END CHECKPRC;                                             /*@Y30SSJH*/ 08611000
         B     @EL00005                                            2008 08612000
*/********************************************************************/ 08613000
*/*                                                          @Y30SSJH*/ 08614000
*/* PROCEDURE NAME - INDEXPRC                                @Y30SSJH*/ 08615000
*/*                                                          @Y30SSJH*/ 08616000
*/* FUNCTION - INDEXPRC IS NEW FOR RELEASE 2 OF VSAM. ITS    @Y30SSJH*/ 08617000
*/*            PURPOSE IS TO ALTER THE INDEX AMDSB KEY       @Y30SSJH*/ 08618000
*/*            VALUES. THE CORRESPONDING DATA                @Y30SSJH*/ 08619000
*/*            AMDSB IS ALTERED IN AL01.                     @Y30SSJH*/ 08620000
*/*                                                          @Y30SSJH*/ 08621000
*/*            THIS PROCEDURE IS INVOKED ONLY IF             @Y30SSJH*/ 08622000
*/*            KEYS IS SPECIFIED FOR A KEY                   @Y30SSJH*/ 08623000
*/*            SEQUENCED CLUSTER OR AN ALTERNATE INDEX.      @Y30SSJH*/ 08624000
*/*                                                          @Y30SSJH*/ 08625000
*/*            THE CPL-FVT-FPL COMPLEX IS CONSTRUCTED TO     @Y30SSJH*/ 08626000
*/*            COMMUNICATE THE ALTER REQUEST.                @Y30SSJH*/ 08627000
*/*                                                          @Y30SSJH*/ 08628000
*/* INPUT -                                                  @Y30SSJH*/ 08629000
*/*         INDEXPRC USES THE INDEX CONTROL INTERVAL NUMBER  @Y30SSJH*/ 08630000
*/*         (INDEXCI),AND THE INDEX AMDSB LOCATED IN         @Y30SSJH*/ 08631000
*/*         CHECKPRC (IXAMDSB).                              @Y30SSJH*/ 08632000
*/*                                                          @Y30SSJH*/ 08633000
*/* OUTPUT -                                                 @Y30SSJH*/ 08634000
*/*          ALSTID - THE GLOBAL INTERNAL STATUS COMMUNICATOR        */ 08635000
*/*          IS SET ON ERROR DETECTION.                      @Y30SSJH*/ 08636000
*/*          CREATION OF THE CATALOG PARAMETER LIST TO       @Y30SSJH*/ 08637000
*/*          COMMUNICATE THE ALTER REQUEST.                  @Y30SSJH*/ 08638000
*/*                                                          @Y30SSJH*/ 08639000
*/********************************************************************/ 08640000
*                                                                  2009 08641000
*INDEXPRC:                                                         2009 08642000
*        PROCEDURE;                                        /*@Y30SSJH*/ 08643000
INDEXPRC STM   @14,@12,@SA00006                                    2009 08644000
*                                                                  2010 08645000
*        /************************************************************/ 08646000
*        /*                                                  @Y30SSJH*/ 08647000
*        /* CPL-FVT-FPL COMPLEX USED IN INDEX ALTER          @Y30SSJH*/ 08648000
*        /*                                                  @Y30SSJH*/ 08649000
*        /************************************************************/ 08650000
*                                                                  2010 08651000
*        DCL                                                       2010 08652000
*          1 IXCTGPRM   BASED(IXPRMPTR),                           2010 08653000
*            2 IXCPLID  CHAR(8),                                   2010 08654000
*            2 IXCTGPL  CHAR(LENGTH(CTGPL) + 32),                  2010 08655000
*            2 IXFVTID  CHAR(4),                                   2010 08656000
*            2 IXCTGFVT CHAR(LENGTH(CTGFV) + 8),           /*@Y30SSJH*/ 08657000
*            2 IXAMD    CHAR(4),                                   2010 08658000
*            2 IXFPLAMD CHAR(LENGTH(CTGFL) + 8),                   2010 08659000
*                                                                  2010 08660000
*            2 IXWKAREA CHAR(4);                           /*@Y30SSJH*/ 08661000
*                                                                  2010 08662000
*        DCL                                                       2011 08663000
*          IXPRMPTR PTR(31);                               /*@Y30SSJH*/ 08664000
*        /************************************************************/ 08665000
*        /*                                                  @Y30SSJH*/ 08666000
*        /* ENTRY POINT TO INDEXPRC                          @Y30SSJH*/ 08667000
*        /*                                                  @Y30SSJH*/ 08668000
*        /************************************************************/ 08669000
*                                                                  2012 08670000
*        OLDERID2 = NEWERID2;                                      2012 08671000
         L     @06,@PC00001                                        2012 08672000
         L     @15,GDTTR2(,@06)                                    2012 08673000
         MVC   @TS00001(95),NEWERID2(@15)                          2012 08674000
         MVC   OLDERID2(95,@15),@TS00001                           2012 08675000
*        NEWID2 = 'AL61';                                  /*@Y30SSJH*/ 08676000
*                                                                  2013 08677000
         MVC   NEWID2(4,@15),@CC01581                              2013 08678000
*        /************************************************************/ 08679000
*        /*                                                  @Y30SSJH*/ 08680000
*        /* GET DYNAMIC STORAGE FOR THE PARAMETER LISTS WHICH        */ 08681000
*        /* COMPRISE THE CPL-FVT-FPL COMPLEX                 @Y30SSJH*/ 08682000
*        /*                                                  @Y30SSJH*/ 08683000
*        /************************************************************/ 08684000
*                                                                  2014 08685000
*        CALL IDCSAGP0(GDTTBL,                                     2014 08686000
*               (LENGTH(IXCTGPRM)),    /* LENGTH OF STORAGE REQUEST  */ 08687000
*               IXPRMPTR,              /* ADDRESS OF DYNAMIC STORAGE */ 08688000
*               ALGPID,                /* UGPOOL ID          @Y30SSJH*/ 08689000
*                SETZERO);             /* SET AREA TO ZERO   @Y30SSJH*/ 08690000
*                                                                  2014 08691000
         ST    @06,@AL00001                                        2014 08692000
         LA    @15,204                                             2014 08693000
         ST    @15,@AFTEMPS+4                                      2014 08694000
         LA    @15,@AFTEMPS+4                                      2014 08695000
         ST    @15,@AL00001+4                                      2014 08696000
         LA    @15,IXPRMPTR                                        2014 08697000
         ST    @15,@AL00001+8                                      2014 08698000
         LA    @15,ALGPID                                          2014 08699000
         ST    @15,@AL00001+12                                     2014 08700000
         LA    @15,SETZERO                                         2014 08701000
         ST    @15,@AL00001+16                                     2014 08702000
         MVI   @AL00001+16,X'80'                                   2014 08703000
         L     @15,GDTGPL(,@06)                                    2014 08704000
         LA    @01,@AL00001                                        2014 08705000
         BALR  @14,@15                                             2014 08706000
*        RESPECIFY RTNREG RSTD;                                    2015 08707000
*        TESTRC = RTNREG;                                          2016 08708000
         STH   RTNREG,TESTRC                                       2016 08709000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSJH*/ 08710000
*                                                                  2017 08711000
*        /************************************************************/ 08712000
*        /*                                                  @Y30SSJH*/ 08713000
*        /* STORAGE NOT AVAILABLE - TERMINAL ERROR           @Y30SSJH*/ 08714000
*        /*                                                  @Y30SSJH*/ 08715000
*        /************************************************************/ 08716000
*                                                                  2018 08717000
*        IF TESTRC ^= 0                                            2018 08718000
*          THEN                                                    2018 08719000
         LH    @06,TESTRC                                          2018 08720000
         LTR   @06,@06                                             2018 08721000
         BZ    @RF02018                                            2018 08722000
*            ALSTID = NOSTORAG;                            /*@Y30SSJH*/ 08723000
*                                                                  2019 08724000
         MVC   ALSTID(5),@CB01039                                  2019 08725000
*        /************************************************************/ 08726000
*        /*                                                  @Y30SSJH*/ 08727000
*        /* PRELIMINARY INITIALIZATION                       @Y30SSJH*/ 08728000
*        /*                                                  @Y30SSJH*/ 08729000
*        /************************************************************/ 08730000
*                                                                  2020 08731000
*        IXCPLID = 'IXCPL';                                /*@Y30SSJH*/ 08732000
@RF02018 L     @06,IXPRMPTR                                        2020 08733000
         MVI   IXCPLID+5(@06),C' '                                 2020 08734000
         MVC   IXCPLID+6(2,@06),IXCPLID+5(@06)                     2020 08735000
         MVC   IXCPLID(5,@06),@CC01582                             2020 08736000
*        IXFVTID = 'IFVT';                                 /*@Y30SSJH*/ 08737000
         MVC   IXFVTID(4,@06),@CC01583                             2021 08738000
*        IXAMD = 'AMDB';                                   /*@Y30SSJH*/ 08739000
         MVC   IXAMD(4,@06),@CC01450                               2022 08740000
*        CPLSAVE = IXPRMPTR + 8;                           /*@Y30SSJH*/ 08741000
*                                                                  2023 08742000
         LA    @15,8                                               2023 08743000
         ALR   @15,@06                                             2023 08744000
         ST    @15,CPLSAVE                                         2023 08745000
*        RFY CTGPL BASED(CPLSAVE);                         /*@Y30SSJH*/ 08746000
*        CTGFLPTR = ADDR(IXFPLAMD);                        /*@Y30SSJH*/ 08747000
*                                                                  2025 08748000
         LA    @14,IXFPLAMD(,@06)                                  2025 08749000
         ST    @14,CTGFLPTR                                        2025 08750000
*        /************************************************************/ 08751000
*        /*                                                  @Y30SSJH*/ 08752000
*        /* INITIALIZE CPL FOR ALTER REQUEST                 @Y30SSJH*/ 08753000
*        /*                                                  @Y30SSJH*/ 08754000
*        /************************************************************/ 08755000
*                                                                  2026 08756000
*        CTGFUNC = CTGCMS;                                 /*@Y30SSJH*/ 08757000
         NI    CTGFUNC(@15),B'10011111'                            2026 08758000
         OI    CTGFUNC(@15),B'10000000'                            2026 08759000
*        CTGFVT = ADDR(IXCTGFVT);                          /*@Y30SSJH*/ 08760000
         LA    @14,IXCTGFVT(,@06)                                  2027 08761000
         ST    @14,CTGFVT(,@15)                                    2027 08762000
*        CTGBYPSS = ON;                                    /*@Y30SSJH*/ 08763000
         OI    CTGBYPSS(@15),B'10000000'                           2028 08764000
*        CTGAM0 = ON;                                      /*@Y30SSJH*/ 08765000
         OI    CTGAM0(@15),B'00000001'                             2029 08766000
*        CTGWKA = ADDR(IXWKAREA);                          /*@Y30SSJH*/ 08767000
         LA    @06,IXWKAREA(,@06)                                  2030 08768000
         ST    @06,CTGWKA(,@15)                                    2030 08769000
*        CTGOPTNS = CTGALTER;                              /*@Y30SSJH*/ 08770000
         NI    CTGOPTNS(@15),B'00010111'                           2031 08771000
         OI    CTGOPTNS(@15),B'00010000'                           2031 08772000
*        CTGCNAME = ON;                                    /*@Y30SSJH*/ 08773000
         OI    CTGCNAME(@15),B'00000010'                           2032 08774000
*        /************************************************************/ 08775000
*        /*                                                  @Y30SSJH*/ 08776000
*        /* SET CPL REFERENCE TO CATALOG IN WHICH ENTRY RESIDES      */ 08777000
*        /*                                                  @Y30SSJH*/ 08778000
*        /************************************************************/ 08779000
*                                                                  2033 08780000
*        IF CATACBPT ^= NULLPTR                                    2033 08781000
*          THEN                                                    2033 08782000
         L     @06,CATACBPT                                        2033 08783000
         LTR   @06,@06                                             2033 08784000
         BZ    @RF02033                                            2033 08785000
*            DO;                                           /*@Y30SSJH*/ 08786000
*                                                                  2034 08787000
*            CTGCNAME = OFF;            /* INDICATE CATLG ACB GIVEN  */ 08788000
         NI    CTGCNAME(@15),B'11111101'                           2035 08789000
*            CTGCAT = CATACBPT;         /* ACB ADDRESS OF CATALOG    */ 08790000
*                                                                  2036 08791000
         ST    @06,CTGCAT(,@15)                                    2036 08792000
*            END;                                          /*@Y30SSJH*/ 08793000
*                                                                  2037 08794000
*          /**********************************************************/ 08795000
*          /*                                                @Y30SSJH*/ 08796000
*          /* CATLG ACB ADDRESS NOT SPECIFIED - SET PTR TO CATLG NAME*/ 08797000
*          /* IF A CATALOG NAME NOR ACB IS NOT PROVIDED THE CATALOG  */ 08798000
*          /* SEARCH FOLLOWS THE STEPCAT|JOBCAT, MASTERCATALOG HIER- */ 08799000
*          /* ARCHY.                                         @Y30SSJH*/ 08800000
*          /*                                                @Y30SSJH*/ 08801000
*          /**********************************************************/ 08802000
*                                                                  2038 08803000
*          ELSE                                                    2038 08804000
*            IF (ADDR(CATLG)) ^= NULLPTR                           2038 08805000
*              THEN                                                2038 08806000
         B     @RC02033                                            2038 08807000
@RF02033 L     @06,@PC00001+4                                      2038 08808000
         L     @06,FDTPTR+8(,@06)                                  2038 08809000
         LTR   @06,@06                                             2038 08810000
         BZ    @RF02038                                            2038 08811000
*                CTGCAT = ADDR(CATLGVAL);                  /*@Y30SSJH*/ 08812000
*                                                                  2039 08813000
         LA    @06,CATLGVAL(,@06)                                  2039 08814000
         L     @01,CPLSAVE                                         2039 08815000
         ST    @06,CTGCAT(,@01)                                    2039 08816000
*        /************************************************************/ 08817000
*        /*                                                  @Y30SSJH*/ 08818000
*        /* INITIALIZE THE PASSWORD ADDRESS - EITHER CATLG OR ENTRY  */ 08819000
*        /* PASSWORD. THE CATALOG PASSWORD HAS THE HIGHEST PRIORITY  */ 08820000
*        /*                                                  @Y30SSJH*/ 08821000
*        /************************************************************/ 08822000
*                                                                  2040 08823000
*        IF (ADDR(CATLG)) ^= NULLPTR                               2040 08824000
*          THEN                                                    2040 08825000
@RF02038 DS    0H                                                  2040 08826000
@RC02033 L     @06,@PC00001+4                                      2040 08827000
         L     @06,FDTPTR+8(,@06)                                  2040 08828000
         LTR   @06,@06                                             2040 08829000
         BZ    @RF02040                                            2040 08830000
*            IF CATLGPLN ^= 0                                      2041 08831000
*              THEN                                                2041 08832000
         CLI   CATLGPLN(@06),0                                     2041 08833000
         BE    @RF02041                                            2041 08834000
*                CTGPSWD = ADDR(CATLGPAS);  /* CATALOG PASSWORD      */ 08835000
*                                                                  2042 08836000
         LA    @06,CATLGPAS(,@06)                                  2042 08837000
         L     @01,CPLSAVE                                         2042 08838000
         ST    @06,CTGPSWD(,@01)                                   2042 08839000
*        IF CTGPSWD = NULLPTR                                      2043 08840000
*          THEN                                                    2043 08841000
@RF02041 DS    0H                                                  2043 08842000
@RF02040 L     @06,CPLSAVE                                         2043 08843000
         L     @15,CTGPSWD(,@06)                                   2043 08844000
         LTR   @15,@15                                             2043 08845000
         BNZ   @RF02043                                            2043 08846000
*            IF NTRYPLN ^= 0                                       2044 08847000
*              THEN                                                2044 08848000
         L     @15,@PC00001+4                                      2044 08849000
         L     @15,FDTPTR(,@15)                                    2044 08850000
         CLI   NTRYPLN(@15),0                                      2044 08851000
         BE    @RF02044                                            2044 08852000
*                CTGPSWD = ADDR(NTRYPAS);   /* ENTRY PASSWORD        */ 08853000
         LA    @15,NTRYPAS(,@15)                                   2045 08854000
         ST    @15,CTGPSWD(,@06)                                   2045 08855000
*                                                                  2046 08856000
*        /************************************************************/ 08857000
*        /*                                                  @Y30SSJH*/ 08858000
*        /* INITIALIZE INDEX CI NUMBER IN FVT                @Y30SSJH*/ 08859000
*        /*                                                  @Y30SSJH*/ 08860000
*        /************************************************************/ 08861000
*                                                                  2046 08862000
*        CTGFVENT = ADDR(INDEXCI);                         /*@Y30SSJH*/ 08863000
*                                                                  2046 08864000
@RF02044 DS    0H                                                  2046 08865000
@RF02043 L     @06,CPLSAVE                                         2046 08866000
         L     @06,CTGFVT(,@06)                                    2046 08867000
         LA    @15,INDEXCI                                         2046 08868000
         ST    @15,CTGFVENT(,@06)                                  2046 08869000
*         /***********************************************************/ 08870000
*         /*                                                 @Y30SSJH*/ 08871000
*         /* INITIALIZE POINTER TO DNAME IN FVT              @Y30SSJH*/ 08872000
*         /*                                                 @Y30SSJH*/ 08873000
*         /***********************************************************/ 08874000
*                                                                  2047 08875000
*         IF CTGPLPTR -> CTGFVT -> CTGFVIND ^= NULLPTR             2047 08876000
*           THEN                                                   2047 08877000
         L     @01,CTGPLPTR                                        2047 08878000
         L     @01,CTGFVT(,@01)                                    2047 08879000
         L     @15,CTGFVIND(,@01)                                  2047 08880000
         LTR   @15,@15                                             2047 08881000
         BZ    @RF02047                                            2047 08882000
*             CTGFVIND = CTGPLPTR -> CTGFVT -> CTGFVIND;   /*@Y30SSJH*/ 08883000
*                                                                  2048 08884000
         ST    @15,CTGFVIND(,@06)                                  2048 08885000
*        /************************************************************/ 08886000
*        /*                                                  @Y30SSJH*/ 08887000
*        /* INITIALIZE AMDSB FPL TO COMMUNICATE ALTERATION   @Y30SSJH*/ 08888000
*        /*                                                  @Y30SSJH*/ 08889000
*        /************************************************************/ 08890000
*                                                                  2049 08891000
*        CTGFLNG(1) = IXAMDLEN;                            /*@Y30SSJH*/ 08892000
@RF02047 L     @06,CTGFLPTR                                        2049 08893000
         L     @15,IXAMDLEN                                        2049 08894000
         ST    @15,CTGFLNG(,@06)                                   2049 08895000
*        CTGFLPT(1) = IXAMDPT;                             /*@Y30SSJH*/ 08896000
         L     @15,IXAMDPT                                         2050 08897000
         ST    @15,CTGFLPT(,@06)                                   2050 08898000
*        CTGFLDNO = 1;                                     /*@Y30SSJH*/ 08899000
         MVI   CTGFLDNO(@06),X'01'                                 2051 08900000
*        CTGFLDNM = ADDR(ALFLDNAM(8));                     /*@Y30SSJH*/ 08901000
*                                                                  2052 08902000
         LA    @15,ALFLDNAM+56                                     2052 08903000
         ST    @15,CTGFLDNM(,@06)                                  2052 08904000
*        CTGFVAMD = ADDR(IXFPLAMD);                        /*@Y30SSJH*/ 08905000
         L     @06,CPLSAVE                                         2053 08906000
         L     @06,CTGFVT(,@06)                                    2053 08907000
         L     @01,IXPRMPTR                                        2053 08908000
         LA    @15,IXFPLAMD(,@01)                                  2053 08909000
         ST    @15,CTGFVAMD(,@06)                                  2053 08910000
*        CTGFVTYP = 'I';                                   /*@Y30SSJH*/ 08911000
*                                                                  2054 08912000
         MVI   CTGFVTYP(@06),C'I'                                  2054 08913000
*        RETURN;                                           /*@Y30SSJH*/ 08914000
@EL00006 DS    0H                                                  2055 08915000
@EF00006 DS    0H                                                  2055 08916000
@ER00006 LM    @14,@12,@SA00006                                    2055 08917000
         BR    @14                                                 2055 08918000
*END INDEXPRC;                                             /*@Y30SSJH*/ 08919000
*/********************************************************************/ 08920000
*/*                                                          @OZ05940*/ 08921000
*/* PROCEDURE NAME - PARAMCHK                                @OZ05940*/ 08922000
*/*                                                          @OZ05940*/ 08923000
*/* FUNCTION - TO DETERMINE WHETHER THE PARAMETERS SPECIFIED @OZ05940*/ 08924000
*/*            ON THE ALTER COMMAND ARE CONSISTENT WITH THE  @OZ05940*/ 08925000
*/*            TYPE OF THE ENTRY NAME. BECAUSE THE ENTRY     @OZ05940*/ 08926000
*/*            TYPE MUST BE KNOWN, A PRIOR CALL TO LOCATPRC  @OZ05940*/ 08927000
*/*            IS ASSUMED.                                   @OZ05940*/ 08928000
*/*                                                          @OZ05940*/ 08929000
*/* INPUT -                                                  @OZ05940*/ 08930000
*/*           . ALSTID - GLOBAL INTERNAL STATUS COMMUNICATOR @OZ05940*/ 08931000
*/*           . (SEE ARGUMENT OF INVOCATION BELOW)           @OZ05940*/ 08932000
*/*                                                          @OZ05940*/ 08933000
*/* OUTPUT -                                                 @OZ05940*/ 08934000
*/*           . ALSTID - STATUS INDICATOR, SET ON ERROR      @OZ05940*/ 08935000
*/*           . PARMINDX - INDEX IN  PARAMETER TABLE OF PARAMETER    */ 08936000
*/*               IN ERROR                                   @OZ05940*/ 08937000
*/*                                                          @OZ05940*/ 08938000
*/********************************************************************/ 08939000
*PARAMCHK:                                                         2057 08940000
*        PROCEDURE (ETYPE);                                /*@OZ05940*/ 08941000
*                                                                  2057 08942000
PARAMCHK STM   @14,@12,12(@13)                                     2057 08943000
         MVC   @PC00007(4),0(@01)                                  2057 08944000
*        /************************************************************/ 08945000
*        /*                                                  @OZ05940*/ 08946000
*        /* ARGUMENT OF INVOCATION                           @OZ05940*/ 08947000
*        /*                                                  @OZ05940*/ 08948000
*        /************************************************************/ 08949000
*        DCL                                                       2058 08950000
*          ETYPE CHAR(1);               /* TYPE OF OBJECT BEING    2058 08951000
*                                           ALTERED          @OZ05940*/ 08952000
*        /************************************************************/ 08953000
*        /*                                                  @OZ05940*/ 08954000
*        /* ENTRY POINT TO PARAMCHK                          @OZ05940*/ 08955000
*        /*                                                  @OZ05940*/ 08956000
*        /************************************************************/ 08957000
*                                                                  2059 08958000
*        PARMINDX = 0;                                     /*@Z40WSJH*/ 08959000
*                                                                  2059 08960000
         SLR   @06,@06                                             2059 08961000
         STH   @06,PARMINDX                                        2059 08962000
*        /************************************************************/ 08963000
*        /*                                                  @OZ05940*/ 08964000
*        /* TEST FOR DATA ONLY PARAMETERS SPECIFIED INCORRECTLY.     */ 08965000
*        /* DATA PARAMETERS THAT CAN BE CHECKED HERE ARE     @OZ05940*/ 08966000
*        /* ERASE, NOERASE, FREESPACE AND NONUNIQUEKEY.      @OZ05940*/ 08967000
*        /*                                                  @OZ05940*/ 08968000
*        /************************************************************/ 08969000
*                                                                  2060 08970000
*        IF ETYPE ^= CTGTDATA                                      2060 08971000
*          THEN                                                    2060 08972000
         L     @15,@PC00007                                        2060 08973000
         CLI   ETYPE(@15),C'D'                                     2060 08974000
         BE    @RF02060                                            2060 08975000
*            DO;                                           /*@OZ05940*/ 08976000
*                                                                  2061 08977000
*            IF (ADDR(ERASE)) ^= NULLPTR                           2062 08978000
*              THEN                                                2062 08979000
         L     @15,@PC00001+4                                      2062 08980000
         C     @06,FDTPTR+80(,@15)                                 2062 08981000
         BE    @RF02062                                            2062 08982000
*                PARMINDX = 11;                            /*@OZ05940*/ 08983000
         MVC   PARMINDX(2),@CH00036                                2063 08984000
*              ELSE                                                2064 08985000
*                IF (ADDR(NERAS)) ^= NULLPTR                       2064 08986000
*                  THEN                                            2064 08987000
         B     @RC02062                                            2064 08988000
@RF02062 L     @06,@PC00001+4                                      2064 08989000
         L     @06,FDTPTR+84(,@06)                                 2064 08990000
         LTR   @06,@06                                             2064 08991000
         BZ    @RF02064                                            2064 08992000
*                    PARMINDX = 12;                        /*@OZ05940*/ 08993000
         MVC   PARMINDX(2),@CH00035                                2065 08994000
*                  ELSE                                            2066 08995000
*                    IF (ADDR(FSPAC)) ^= NULLPTR                   2066 08996000
*                      THEN                                        2066 08997000
         B     @RC02064                                            2066 08998000
@RF02064 L     @06,@PC00001+4                                      2066 08999000
         L     @06,FDTPTR+120(,@06)                                2066 09000000
         LTR   @06,@06                                             2066 09001000
         BZ    @RF02066                                            2066 09002000
*                        PARMINDX= 8;                      /*@OZ05940*/ 09003000
         MVC   PARMINDX(2),@CH00039                                2067 09004000
*                      ELSE                                        2068 09005000
*                        IF (ADDR(NUNQK)) ^= NULLPTR               2068 09006000
*                          THEN                                    2068 09007000
         B     @RC02066                                            2068 09008000
@RF02066 L     @06,@PC00001+4                                      2068 09009000
         L     @06,FDTPTR+248(,@06)                                2068 09010000
         LTR   @06,@06                                             2068 09011000
         BZ    @RF02068                                            2068 09012000
*                            PARMINDX = 10;                /*@OZ05940*/ 09013000
*                                                                  2069 09014000
         MVC   PARMINDX(2),@CH00037                                2069 09015000
*            END;                                          /*@OZ05940*/ 09016000
*                                                                  2070 09017000
@RF02068 DS    0H                                                  2070 09018000
@RC02066 DS    0H                                                  2070 09019000
@RC02064 DS    0H                                                  2070 09020000
@RC02062 DS    0H                                                  2071 09021000
*        /************************************************************/ 09022000
*        /*                                                  @OZ05940*/ 09023000
*        /* TEST FOR DATA OR INDEX PARAMETERS SPECIFIED INCORRECTLY. */ 09024000
*        /* DATA/INDEX PARAMETERS THAT CAN BE CHECKED HERE   @OZ05940*/ 09025000
*        /* ARE STAGE, BIND, CYLINDERFAULT, DESTAGEWAIT,     @OZ05940*/ 09026000
*        /* NODESTAGEWAIT, WRITECHECK, NOWRITECHECK,         @OZ05940*/ 09027000
*        /* SHAREOPTIONS, INHIBIT AND UNINHIBIT.             @OZ05940*/ 09028000
*        /*                                                  @OZ05940*/ 09029000
*        /************************************************************/ 09030000
*                                                                  2071 09031000
*        IF ETYPE ^= CTGTDATA    &                                 2071 09032000
*           ETYPE ^= CTGTINDX    &                                 2071 09033000
*           PARMINDX = NULLPTR                                     2071 09034000
*          THEN                                                    2071 09035000
@RF02060 L     @06,@PC00007                                        2071 09036000
         CLI   ETYPE(@06),C'D'                                     2071 09037000
         BE    @RF02071                                            2071 09038000
         CLI   ETYPE(@06),C'I'                                     2071 09039000
         BE    @RF02071                                            2071 09040000
         SLR   @06,@06                                             2071 09041000
         CH    @06,PARMINDX                                        2071 09042000
         BNE   @RF02071                                            2071 09043000
*            DO;                                           /*@OZ05940*/ 09044000
*                                                                  2072 09045000
*            IF (ADDR(STAGE)) ^= NULLPTR                           2073 09046000
*              THEN                                                2073 09047000
         L     @15,@PC00001+4                                      2073 09048000
         C     @06,FDTPTR+272(,@15)                                2073 09049000
         BE    @RF02073                                            2073 09050000
*                PARMINDX = 1;                             /*@OZ05940*/ 09051000
         MVC   PARMINDX(2),@CH00220                                2074 09052000
*              ELSE                                                2075 09053000
*                IF (ADDR(BIND)) ^= NULLPTR                        2075 09054000
*                  THEN                                            2075 09055000
         B     @RC02073                                            2075 09056000
@RF02073 L     @06,@PC00001+4                                      2075 09057000
         L     @06,FDTPTR+276(,@06)                                2075 09058000
         LTR   @06,@06                                             2075 09059000
         BZ    @RF02075                                            2075 09060000
*                    PARMINDX = 2;                         /*@OZ05940*/ 09061000
         MVC   PARMINDX(2),@CH00155                                2076 09062000
*                  ELSE                                            2077 09063000
*                    IF (ADDR(CYLF)) ^= NULLPTR                    2077 09064000
*                      THEN                                        2077 09065000
         B     @RC02075                                            2077 09066000
@RF02075 L     @06,@PC00001+4                                      2077 09067000
         L     @06,FDTPTR+280(,@06)                                2077 09068000
         LTR   @06,@06                                             2077 09069000
         BZ    @RF02077                                            2077 09070000
*                        PARMINDX = 3;                     /*@OZ05940*/ 09071000
         MVC   PARMINDX(2),@CH00164                                2078 09072000
*                      ELSE                                        2079 09073000
*                        IF (ADDR(STGW)) ^= NULLPTR                2079 09074000
*                          THEN                                    2079 09075000
         B     @RC02077                                            2079 09076000
@RF02077 L     @06,@PC00001+4                                      2079 09077000
         L     @06,FDTPTR+288(,@06)                                2079 09078000
         LTR   @06,@06                                             2079 09079000
         BZ    @RF02079                                            2079 09080000
*                            PARMINDX = 4;                 /*@OZ05940*/ 09081000
         MVC   PARMINDX(2),@CH00044                                2080 09082000
*                          ELSE                                    2081 09083000
*                            IF (ADDR(NSTGW)) ^= NULLPTR           2081 09084000
*                              THEN                                2081 09085000
         B     @RC02079                                            2081 09086000
@RF02079 L     @06,@PC00001+4                                      2081 09087000
         L     @06,FDTPTR+284(,@06)                                2081 09088000
         LTR   @06,@06                                             2081 09089000
         BZ    @RF02081                                            2081 09090000
*                                PARMINDX = 5;             /*@OZ05940*/ 09091000
         MVC   PARMINDX(2),@CH00287                                2082 09092000
*                              ELSE                                2083 09093000
*                                IF (ADDR(WRTCK)) ^= NULLPTR       2083 09094000
*                                  THEN                            2083 09095000
         B     @RC02081                                            2083 09096000
@RF02081 L     @06,@PC00001+4                                      2083 09097000
         L     @06,FDTPTR+132(,@06)                                2083 09098000
         LTR   @06,@06                                             2083 09099000
         BZ    @RF02083                                            2083 09100000
*                                    PARMINDX = 6;         /*@OZ05940*/ 09101000
         MVC   PARMINDX(2),@CH00158                                2084 09102000
*                                  ELSE                            2085 09103000
*                                    IF (ADDR(NWTCK)) ^= NULLPTR   2085 09104000
*                                      THEN                        2085 09105000
         B     @RC02083                                            2085 09106000
@RF02083 L     @06,@PC00001+4                                      2085 09107000
         L     @06,FDTPTR+136(,@06)                                2085 09108000
         LTR   @06,@06                                             2085 09109000
         BZ    @RF02085                                            2085 09110000
*                                        PARMINDX =7;      /*@OZ05940*/ 09111000
*                                                                  2086 09112000
         MVC   PARMINDX(2),@CH00467                                2086 09113000
*            IF (ADDR(SHARE)) ^= NULLPTR                           2087 09114000
*              THEN                                                2087 09115000
@RF02085 DS    0H                                                  2087 09116000
@RC02083 DS    0H                                                  2087 09117000
@RC02081 DS    0H                                                  2087 09118000
@RC02079 DS    0H                                                  2087 09119000
@RC02077 DS    0H                                                  2087 09120000
@RC02075 DS    0H                                                  2087 09121000
@RC02073 L     @06,@PC00001+4                                      2087 09122000
         L     @06,FDTPTR+88(,@06)                                 2087 09123000
         LTR   @06,@06                                             2087 09124000
         BZ    @RF02087                                            2087 09125000
*                PARMINDX = 13;                            /*@OZ05940*/ 09126000
         MVC   PARMINDX(2),@CH00638                                2088 09127000
*              ELSE                                                2089 09128000
*                IF (ADDR(INHIB)) ^= NULLPTR                       2089 09129000
*                  THEN                                            2089 09130000
         B     @RC02087                                            2089 09131000
@RF02087 L     @06,@PC00001+4                                      2089 09132000
         L     @06,FDTPTR+156(,@06)                                2089 09133000
         LTR   @06,@06                                             2089 09134000
         BZ    @RF02089                                            2089 09135000
*                    PARMINDX = 14;                        /*@OZ05940*/ 09136000
         MVC   PARMINDX(2),@CH00641                                2090 09137000
*                  ELSE                                            2091 09138000
*                    IF (ADDR(UNHIB)) ^= NULLPTR                   2091 09139000
*                      THEN                                        2091 09140000
         B     @RC02089                                            2091 09141000
@RF02089 L     @06,@PC00001+4                                      2091 09142000
         L     @06,FDTPTR+160(,@06)                                2091 09143000
         LTR   @06,@06                                             2091 09144000
         BZ    @RF02091                                            2091 09145000
*                        PARMINDX = 15;                    /*@OZ05940*/ 09146000
*                                                                  2092 09147000
         MVC   PARMINDX(2),@CH00229                                2092 09148000
*            END;                                          /*@OZ05940*/ 09149000
@RF02091 DS    0H                                                  2093 09150000
@RC02089 DS    0H                                                  2093 09151000
@RC02087 DS    0H                                                  2094 09152000
*        /************************************************************/ 09153000
*        /*                                                  @OZ05940*/ 09154000
*        /* TEST FOR GDG PARAMETERS SPECIFIED INCORRECTLY.   @OZ05940*/ 09155000
*        /* GDG PARAMETERS THAT CAN BE CHECKED HERE ARE      @OZ05940*/ 09156000
*        /* EMPTY, NOEMPTY, SCRATCH AND NOSCRATCH.           @OZ05940*/ 09157000
*        /*                                                  @OZ05940*/ 09158000
*        /************************************************************/ 09159000
*                                                                  2094 09160000
*        IF ETYPE ^= CTGTGBS     &                                 2094 09161000
*           PARMINDX = NULLPTR                                     2094 09162000
*          THEN                                                    2094 09163000
@RF02071 L     @06,@PC00007                                        2094 09164000
         CLI   ETYPE(@06),C'B'                                     2094 09165000
         BE    @RF02094                                            2094 09166000
         SLR   @06,@06                                             2094 09167000
         CH    @06,PARMINDX                                        2094 09168000
         BNE   @RF02094                                            2094 09169000
*            DO;                                           /*@OZ05940*/ 09170000
*                                                                  2095 09171000
*            IF (ADDR(GDGEM)) ^= NULLPTR                           2096 09172000
*              THEN                                                2096 09173000
         L     @15,@PC00001+4                                      2096 09174000
         C     @06,FDTPTR+196(,@15)                                2096 09175000
         BE    @RF02096                                            2096 09176000
*                PARMINDX = 16;                            /*@OZ05940*/ 09177000
         MVC   PARMINDX(2),@CH00477                                2097 09178000
*              ELSE                                                2098 09179000
*                IF (ADDR(GDGNE)) ^= NULLPTR                       2098 09180000
*                  THEN                                            2098 09181000
         B     @RC02096                                            2098 09182000
@RF02096 L     @06,@PC00001+4                                      2098 09183000
         L     @06,FDTPTR+200(,@06)                                2098 09184000
         LTR   @06,@06                                             2098 09185000
         BZ    @RF02098                                            2098 09186000
*                    PARMINDX = 17;                        /*@OZ05940*/ 09187000
         MVC   PARMINDX(2),@CH01590                                2099 09188000
*                  ELSE                                            2100 09189000
*                    IF (ADDR(GDGSC)) ^= NULLPTR                   2100 09190000
*                      THEN                                        2100 09191000
         B     @RC02098                                            2100 09192000
@RF02098 L     @06,@PC00001+4                                      2100 09193000
         L     @06,FDTPTR+204(,@06)                                2100 09194000
         LTR   @06,@06                                             2100 09195000
         BZ    @RF02100                                            2100 09196000
*                        PARMINDX = 18;                    /*@OZ05940*/ 09197000
         MVC   PARMINDX(2),@CH00650                                2101 09198000
*                      ELSE                                        2102 09199000
*                        IF (ADDR(GDGNS)) ^= NULLPTR               2102 09200000
*                          THEN                                    2102 09201000
         B     @RC02100                                            2102 09202000
@RF02100 L     @06,@PC00001+4                                      2102 09203000
         L     @06,FDTPTR+208(,@06)                                2102 09204000
         LTR   @06,@06                                             2102 09205000
         BZ    @RF02102                                            2102 09206000
*                            PARMINDX = 19;                /*@OZ05940*/ 09207000
*                                                                  2103 09208000
         MVC   PARMINDX(2),@CH00653                                2103 09209000
*            END;                                          /*@OZ05940*/ 09210000
*                                                                  2104 09211000
@RF02102 DS    0H                                                  2104 09212000
@RC02100 DS    0H                                                  2104 09213000
@RC02098 DS    0H                                                  2104 09214000
@RC02096 DS    0H                                                  2105 09215000
*        /************************************************************/ 09216000
*        /*                                                  @OZ05940*/ 09217000
*        /* AN ERROR COMBINATION HAS BEEN DETECTED. SET      @OZ05940*/ 09218000
*        /* ALSTID TO INDICATE THE APPROPRIATE ERROR MESSAGE.        */ 09219000
*        /*                                                  @OZ05940*/ 09220000
*        /************************************************************/ 09221000
*                                                                  2105 09222000
*        IF PARMINDX ^= NULLPTR                                    2105 09223000
*          THEN                                                    2105 09224000
@RF02094 LH    @06,PARMINDX                                        2105 09225000
         LTR   @06,@06                                             2105 09226000
         BZ    @RF02105                                            2105 09227000
*            ALSTID = BADPARM;                             /*@OZ05940*/ 09228000
*                                                                  2106 09229000
         MVC   ALSTID(5),@CB01098                                  2106 09230000
*        /************************************************************/ 09231000
*        /*                                                  @OZ05940*/ 09232000
*        /* RETURN TO INVOKER                                @OZ05940*/ 09233000
*        /*                                                  @OZ05940*/ 09234000
*        /************************************************************/ 09235000
*                                                                  2107 09236000
*        RETURN;                                           /*@OZ05940*/ 09237000
*                                                                  2107 09238000
@EL00007 DS    0H                                                  2107 09239000
@EF00007 DS    0H                                                  2107 09240000
@ER00007 LM    @14,@12,12(@13)                                     2107 09241000
         BR    @14                                                 2107 09242000
*END PARAMCHK;                                             /*@OZ05940*/ 09243000
         B     @EL00007                                            2108 09244000
*/********************************************************************/ 09245000
*/*                                                          @Y30SSJH*/ 09246000
*/* PROCEDURE NAME - DALCPROC (SERVICE ROUTINE)              @Y30SSJH*/ 09247000
*/*                                                          @Y30SSJH*/ 09248000
*/* FUNCTION - DALCPROC PERFORMS THE NECESSARY PROCESSING    @Y30SSJH*/ 09249000
*/*          TO INVOKE THE AMS UALLOC ROUTINE WHICH PERFORMS @Y30SSJH*/ 09250000
*/*          DYNAMIC ALLOCATION AND THE AMS UDEALLOC ROUTINE @Y30SSJH*/ 09251000
*/*          WHICH PERFORMS DEALLOCATION.                    @Y30SSJH*/ 09252000
*/*                                                          @Y30SSJH*/ 09253000
*/*          AN ALLOCATION REQUEST IS RECOGNIZED BY AN 'A'   @Y30SSJH*/ 09254000
*/*          SETTING OF REQTYPE. DALCPROC BUILDS THE ALLAGL  @Y30SSJH*/ 09255000
*/*          WHICH IS PASSED TO THE AMS SYSTEM ADAPTER VIA   @Y30SSJH*/ 09256000
*/*          THE UALLOC MACRO. THE ALLAGL REFERENCES THE     @Y30SSJH*/ 09257000
*/*          LIST OF VOLUMES TO BE MOUNTED. THE ADDRESS OF   @Y30SSJH*/ 09258000
*/*          THE DD STATEMENT BUILT IS PLACED IN THE FVT     @Y30SSJH*/ 09259000
*/*          FIELD AS REFERENCED BY DALDNMPT.                @Y30SSJH*/ 09260000
*/*                                                          @Y30SSJH*/ 09261000
*/*          A DEALLOCATION REQUEST IS RECOGNIZED BY A 'D'   @Y30SSJH*/ 09262000
*/*          SETTING OF REQTYPE. DALCPROC PASSES THE ALLAGL  @Y30SSJH*/ 09263000
*/*          USED IN ALLOCATION TO THE SYSTEM ADAPTER VIA    @Y30SSJH*/ 09264000
*/*          THE UDEALLOC MACRO. A LIST OF POINTERS TO       @Y30SSJH*/ 09265000
*/*          ALLAGLS IS ESTABLISHED WHEN ALLOCATING THE      @Y30SSJH*/ 09266000
*/*          VOLUMES.                                        @Y30SSJH*/ 09267000
*/*                                                          @Y30SSJH*/ 09268000
*/* INPUT -                                                  @Y30SSJH*/ 09269000
*/*          . DEFSTID - GLOBAL INTERNAL STATUS COMMUNICATOR @Y30SSJH*/ 09270000
*/*          . (SEE ARGUMENTS OF INVOCATION, BELOW)          @Y30SSJH*/ 09271000
*/*                                                          @Y30SSJH*/ 09272000
*/* OUTPUT -                                                 @Y30SSJH*/ 09273000
*/*          .DEFSTID - STATUS INDICATOR, SET ON ERROR       @Y30SSJH*/ 09274000
*/*          . DALDNMPT - ADDRESS OF DDNAME ALLOCATED        @Y30SSJH*/ 09275000
*/*            DALINDEX - INDEX TO ALLAGLS, BUMPED EACH TIME @Y30SSJH*/ 09276000
*/*            AN ALLOCATION REQUEST IS MADE.                @Y30SSJH*/ 09277000
*/********************************************************************* 09278000
*                                                                  2109 09279000
*DALCPROC:                                                         2109 09280000
*        PROCEDURE (REQTYPE,DALVLPTR,DALDNMPT,DALINDEX);   /*@Y30SSJH*/ 09281000
*                                                                  2109 09282000
DALCPROC STM   @14,@12,@SA00008                                    2109 09283000
         MVC   @PC00008(16),0(@01)                                 2109 09284000
*        /************************************************************/ 09285000
*        /*                                                  @Y30SSJH*/ 09286000
*        /* ARGUMENTS OF INVOCATION                          @Y30SSJH*/ 09287000
*        /*                                                  @Y30SSJH*/ 09288000
*        /************************************************************/ 09289000
*        DCL                                                       2110 09290000
*          REQTYPE CHAR(1),            /* TYPE OF REQUEST    @Y30SSJH*/ 09291000
*          DALVLPTR,                   /* ADDR OF DNAME      @Y30SSJH*/ 09292000
*          DALDNMPT,                   /* ADDR OF DNAME      @Y30SSJH*/ 09293000
*          DALINDEX;                   /* INDEX OF ALLAGLS   @Y30SSJH*/ 09294000
*                                                                  2110 09295000
*        /************************************************************/ 09296000
*        /*                                                  @Y30SSJH*/ 09297000
*        /* UNIT DESCRIPTOR LIST REFERENCED BY ALLAGL        @Y30SSJH*/ 09298000
*        /*                                                  @Y30SSJH*/ 09299000
*        /************************************************************/ 09300000
*        DCL                                                       2111 09301000
*          1 DALCUNIT STATIC LOCAL,                                2111 09302000
*            2 DL#UNIT   FIXED(15) INIT(2),                        2111 09303000
*            2 DUNITLN1  FIXED(15) INIT(8),                /*@Y30SSJH*/ 09304000
*            2 DLUNIT1   CHAR(8)   INIT('SYSALLDA'),       /*@Y30SSJH*/ 09305000
*            2 DUNITLN2  FIXED(15) INIT(8),                /*@Y30SSJH*/ 09306000
*            2 DLUNIT2   CHAR(8)   INIT('SYSALLDA');       /*@Y30SSJH*/ 09307000
*                                                                  2111 09308000
*        /************************************************************/ 09309000
*        /*                                                  @Y30SSJH*/ 09310000
*        /* MAPPING STRUCTURE FOR VOLUME LIST TO BE DYNAMICALLY      */ 09311000
*        /* ALLOCATED, THIS LIST IS RECONSTRUCTED IN A FORM  @Y30SSJH*/ 09312000
*        /* COMPATIBLE TO DYNAMIC ALLOCATION IN A NEW AREA   @Y30SSJH*/ 09313000
*        /*                                                  @Y30SSJH*/ 09314000
*        /************************************************************/ 09315000
*                                                                  2112 09316000
*        DCL                                                       2112 09317000
*          1 FVTVLIST BASED(DALVLPTR),                             2112 09318000
*            2 FVTVLEN FIXED(15),                                  2112 09319000
*            2 * (*),                                              2112 09320000
*              3 *       FIXED(15),                                2112 09321000
*              3 FVTVSER CHAR(6);                          /*@Y30SSJH*/ 09322000
*                                                                  2112 09323000
*        /************************************************************/ 09324000
*        /*                                                  @Y30SSJH*/ 09325000
*        /* MAPPING STRUCTURE FOR VOLUME LIST CONSTRUCTED IN DALCPROC*/ 09326000
*        /* AND PASSED TO DYNAMIC ALLOCATION VIA THE ALLAGL PARAMETER*/ 09327000
*        /* LIST                                             @Y30SSJH*/ 09328000
*        /*                                                  @Y30SSJH*/ 09329000
*        /************************************************************/ 09330000
*                                                                  2113 09331000
*        DCL                                                       2113 09332000
*          1 ALCVLIST BASED(ALLVLP),                               2113 09333000
*            2 ALC#ENT FIXED(15),                                  2113 09334000
*            2 * (*),                                              2113 09335000
*              3 ALCVLEN FIXED(15),                                2113 09336000
*              3 ALCVSER CHAR(6);                          /*@Y30SSJH*/ 09337000
*                                                                  2113 09338000
*        /************************************************************/ 09339000
*        /*                                                  @Y30SSJH*/ 09340000
*        /* POINTER TO ALLAGL PARAMETERLIST                  @Y30SSJH*/ 09341000
*        /*                                                  @Y30SSJH*/ 09342000
*        /************************************************************/ 09343000
*        DCL                                                       2114 09344000
*          DALGLPTR  PTR(31);                              /*@Y30SSJH*/ 09345000
*                                                                  2114 09346000
*        /************************************************************/ 09347000
*        /*                                                  @Y30SSJH*/ 09348000
*        /* ENTRY POINT TO DALCPROC                          @Y30SSJH*/ 09349000
*        /*                                                  @Y30SSJH*/ 09350000
*        /************************************************************/ 09351000
*                                                                  2115 09352000
*        OLDERID2 = NEWERID2;                                      2115 09353000
         L     @06,@PC00001                                        2115 09354000
         L     @06,GDTTR2(,@06)                                    2115 09355000
         MVC   @TS00001(95),NEWERID2(@06)                          2115 09356000
         MVC   OLDERID2(95,@06),@TS00001                           2115 09357000
*        NEWID2 = 'AL71';                                  /*@Y30SSJH*/ 09358000
*                                                                  2116 09359000
         MVC   NEWID2(4,@06),@CC01620                              2116 09360000
*        /************************************************************/ 09361000
*        /*                                                  @Y30SSJH*/ 09362000
*        /* CHECK REQUEST TYPE FOR ALLOCATION OR DEALLOCATION        */ 09363000
*        /*                                                  @Y30SSJH*/ 09364000
*        /************************************************************/ 09365000
*                                                                  2117 09366000
*        IF REQTYPE = 'A'                                          2117 09367000
*          THEN                                                    2117 09368000
         L     @06,@PC00008                                        2117 09369000
         CLI   REQTYPE(@06),C'A'                                   2117 09370000
         BNE   @RF02117                                            2117 09371000
*DALOOP0:    DO;                                           /*@Y30SSJH*/ 09372000
*                                                                  2118 09373000
DALOOP0  DS    0H                                                  2119 09374000
*            /********************************************************/ 09375000
*            /*                                              @Y30SSJH*/ 09376000
*            /* THIS IS AN ALLOCATION REQUEST - GET SPACE FOR THE    */ 09377000
*            /* VOLUME LIST TO BE BUILT AND PASSED TO THE AMS        */ 09378000
*            /* SYSTEM ADAPTER VIA THE ALLAGL PARAMETERLIST  @Y30SSJH*/ 09379000
*            /*                                              @Y30SSJH*/ 09380000
*            /********************************************************/ 09381000
*                                                                  2119 09382000
*            CALL IDCSAGP0 (GDTTBL,                                2119 09383000
*              ((FVTVLEN + 16) + (LENGTH(ALLAGL) +4 )),            2119 09384000
*              DALGLPTR,                                           2119 09385000
*              ALGPID,                                             2119 09386000
*              SETZERO);                                   /*@Y30SSJH*/ 09387000
*                                                                  2119 09388000
         L     @06,@PC00001                                        2119 09389000
         ST    @06,@AL00001                                        2119 09390000
         L     @15,@PC00008+4                                      2119 09391000
         L     @01,DALVLPTR(,@15)                                  2119 09392000
         LA    @00,51                                              2119 09393000
         AH    @00,FVTVLEN(,@01)                                   2119 09394000
         ST    @00,@AFTEMPS+8                                      2119 09395000
         LA    @15,@AFTEMPS+8                                      2119 09396000
         ST    @15,@AL00001+4                                      2119 09397000
         LA    @15,DALGLPTR                                        2119 09398000
         ST    @15,@AL00001+8                                      2119 09399000
         LA    @15,ALGPID                                          2119 09400000
         ST    @15,@AL00001+12                                     2119 09401000
         LA    @15,SETZERO                                         2119 09402000
         ST    @15,@AL00001+16                                     2119 09403000
         MVI   @AL00001+16,X'80'                                   2119 09404000
         L     @15,GDTGPL(,@06)                                    2119 09405000
         LA    @01,@AL00001                                        2119 09406000
         BALR  @14,@15                                             2119 09407000
*            RESPECIFY RTNREG RSTD;                                2120 09408000
*            TESTRC = RTNREG;                                      2121 09409000
         STH   RTNREG,TESTRC                                       2121 09410000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/ 09411000
*            IF TESTRC ^= 0                                        2123 09412000
*              THEN                                                2123 09413000
         LH    @06,TESTRC                                          2123 09414000
         LTR   @06,@06                                             2123 09415000
         BZ    @RF02123                                            2123 09416000
*                DO;                                       /*@Y30SSJH*/ 09417000
*                                                                  2124 09418000
*                ALSTID = NOSTORAG;                        /*@Y30SSJH*/ 09419000
         MVC   ALSTID(5),@CB01039                                  2125 09420000
*                RETURN;                                   /*@Y30SSJH*/ 09421000
*                                                                  2126 09422000
@EL00008 DS    0H                                                  2126 09423000
@EF00008 DS    0H                                                  2126 09424000
@ER00008 LM    @14,@12,@SA00008                                    2126 09425000
         BR    @14                                                 2126 09426000
*                END;                                      /*@Y30SSJH*/ 09427000
*                                                                  2127 09428000
*            /********************************************************/ 09429000
*            /*                                              @Y30SSJH*/ 09430000
*            /* SET ADDRESSABILITY TO ALLAGL AND INITIALIZE ALLVLP   */ 09431000
*            /*                                              @Y30SSJH*/ 09432000
*            /********************************************************/ 09433000
*                                                                  2128 09434000
*            RFY ALLAGL BASED(DALGLPTR);                   /*@Y30SSJH*/ 09435000
@RF02123 DS    0H                                                  2129 09436000
*            ALLVLP = DALGLPTR + (LENGTH(ALLAGL) +4);      /*@Y30SSJH*/ 09437000
*                                                                  2129 09438000
         L     @06,DALGLPTR                                        2129 09439000
         LA    @15,35                                              2129 09440000
         ALR   @15,@06                                             2129 09441000
         ST    @15,ALLVLP(,@06)                                    2129 09442000
*            /********************************************************/ 09443000
*            /*                                              @Y30SSJH*/ 09444000
*            /* COMPUTE THE NUMBER OF ENTRIES IN THE UALLOC VOLUME   */ 09445000
*            /* LIST                                         @Y30SSJH*/ 09446000
*            /********************************************************/ 09447000
*                                                                  2130 09448000
*            ALC#ENT = (FVTVLEN / 8) + 1;                  /*@Y30SSJH*/ 09449000
*                                                                  2130 09450000
         LA    @06,1                                               2130 09451000
         L     @14,@PC00008+4                                      2130 09452000
         L     @01,DALVLPTR(,@14)                                  2130 09453000
         LH    @00,FVTVLEN(,@01)                                   2130 09454000
         SRDA  @00,32                                              2130 09455000
         D     @00,@CF00039                                        2130 09456000
         ALR   @01,@06                                             2130 09457000
         STH   @01,ALC#ENT(,@15)                                   2130 09458000
*            /********************************************************/ 09459000
*            /*                                              @Y30SSJH*/ 09460000
*            /* CHECK FOR UNREASONABLE VALUE IN ALC#ENT TO PREVENT   */ 09461000
*            /* ALLOPING PROBLEM IN DALOOP1                  @Y30SSJH*/ 09462000
*            /*                                              @Y30SSJH*/ 09463000
*            /********************************************************/ 09464000
*            IF ALC#ENT  < 1  |                                    2131 09465000
*               ALC#ENT  > 255                                     2131 09466000
*              THEN                                                2131 09467000
         CR    @01,@06                                             2131 09468000
         BL    @RT02131                                            2131 09469000
         C     @01,@CF00648                                        2131 09470000
         BNH   @RF02131                                            2131 09471000
@RT02131 DS    0H                                                  2132 09472000
*                DO;                                       /*@Y30SSJH*/ 09473000
*                                                                  2132 09474000
*                ALSTID = NOENTALT;                        /*@Y30SSJH*/ 09475000
         MVC   ALSTID(5),@CB01058                                  2133 09476000
*                RETURN;                                   /*@Y30SSJH*/ 09477000
*                                                                  2134 09478000
         B     @EL00008                                            2134 09479000
*                END;                                      /*@Y30SSJH*/ 09480000
*                                                                  2135 09481000
*            /********************************************************/ 09482000
*            /*                                              @Y30SSJH*/ 09483000
*            /* PUT THE CATALOG RECOVERY VOLUME IN THE LIST OF       */ 09484000
*            /* VOLUMES TO BE DYNAMICALLY ALLOCATED.         @Y30SSJH*/ 09485000
*            /*                                              @Y30SSJH*/ 09486000
*            /********************************************************/ 09487000
*                                                                  2136 09488000
*            DO J = 1 TO 6                                         2136 09489000
*              WHILE LCCRAVOL(J) ^= ' ';                   /*@Y30SSJH*/ 09490000
@RF02131 LA    @06,1                                               2136 09491000
         STH   @06,J                                               2136 09492000
@DL02136 L     @01,LCCRAPT                                         2136 09493000
         ALR   @01,@06                                             2136 09494000
         BCTR  @01,0                                               2136 09495000
         CLI   LCCRAVOL(@01),C' '                                  2136 09496000
         BE    @DC02136                                            2136 09497000
*            END;                                          /*@Y30SSJH*/ 09498000
*                                                                  2137 09499000
         AL    @06,@CF00220                                        2137 09500000
         STH   @06,J                                               2137 09501000
         C     @06,@CF00158                                        2137 09502000
         BNH   @DL02136                                            2137 09503000
@DC02136 DS    0H                                                  2138 09504000
*            ALCVLEN(1) = (J-1);                           /*@Y30SSJH*/ 09505000
         L     @06,DALGLPTR                                        2138 09506000
         L     @06,ALLVLP(,@06)                                    2138 09507000
         LH    @15,J                                               2138 09508000
         BCTR  @15,0                                               2138 09509000
         STH   @15,ALCVLEN(,@06)                                   2138 09510000
*            ALCVSER(1) = LCCRAVOL;                        /*@Y30SSJH*/ 09511000
*                                                                  2139 09512000
         L     @01,LCCRAPT                                         2139 09513000
         MVC   ALCVSER(6,@06),LCCRAVOL(@01)                        2139 09514000
*            /********************************************************/ 09515000
*            /*                                              @Y30SSJH*/ 09516000
*            /* LOOP THRU THE LIST OF VOLUMES REFERENCED BY DALVLPTR */ 09517000
*            /* MOVING EACH VOLSER INTO THE LIST PASSED VIA THE      */ 09518000
*            /* ALLAGL AND COMPUTE THE LENGTH OF THE NON-BLANK       */ 09519000
*            /* PORTION OF THE VOLSER, THIS LENGTH PRECEEDES EACH    */ 09520000
*            /* VOLSER IN THE ALLAGL VOLUME LIST             @Y30SSJH*/ 09521000
*            /*                                              @Y30SSJH*/ 09522000
*            /********************************************************/ 09523000
*                                                                  2140 09524000
*DALOOP1:    DO N = 1 TO (ALC#ENT - 1);                    /*@Y30SSJH*/ 09525000
*                                                                  2140 09526000
DALOOP1  LA    @06,1                                               2140 09527000
         B     @DE02140                                            2140 09528000
@DL02140 DS    0H                                                  2141 09529000
*              DO J = 1 TO 6                                       2141 09530000
*                WHILE FVTVSER (N,J) ^= ' ';               /*@Y30SSJH*/ 09531000
         LA    @06,1                                               2141 09532000
         STH   @06,J                                               2141 09533000
@DL02141 L     @15,N                                               2141 09534000
         SLA   @15,3                                               2141 09535000
         ALR   @15,@06                                             2141 09536000
         L     @14,@PC00008+4                                      2141 09537000
         L     @01,DALVLPTR(,@14)                                  2141 09538000
         ALR   @01,@15                                             2141 09539000
         AL    @01,@CF01718                                        2141 09540000
         CLI   FVTVSER-4(@01),C' '                                 2141 09541000
         BE    @DC02141                                            2141 09542000
*              END;                                        /*@Y30SSJH*/ 09543000
*                                                                  2142 09544000
         AL    @06,@CF00220                                        2142 09545000
         STH   @06,J                                               2142 09546000
         C     @06,@CF00158                                        2142 09547000
         BNH   @DL02141                                            2142 09548000
@DC02141 DS    0H                                                  2143 09549000
*              /******************************************************/ 09550000
*              /*                                            @Y30SSJH*/ 09551000
*              /* ON EXIT FROM ABOVE LOOP J HAS THE LENGTH OF THE    */ 09552000
*              /* NONBLANK PORTION OF THE VOLSER + 1         @Y30SSJH*/ 09553000
*              /*                                            @Y30SSJH*/ 09554000
*              /******************************************************/ 09555000
*                                                                  2143 09556000
*              ALCVLEN(N + 1) = (J - 1);                   /*@Y30SSJH*/ 09557000
         L     @06,N                                               2143 09558000
         LR    @15,@06                                             2143 09559000
         SLA   @15,3                                               2143 09560000
         L     @01,DALGLPTR                                        2143 09561000
         L     @14,ALLVLP(,@01)                                    2143 09562000
         LH    @05,J                                               2143 09563000
         BCTR  @05,0                                               2143 09564000
         STH   @05,ALCVLEN(@15,@14)                                2143 09565000
*              ALCVSER(N + 1) = FVTVSER(N);                /*@Y30SSJH*/ 09566000
*                                                                  2144 09567000
         ALR   @14,@15                                             2144 09568000
         L     @05,@PC00008+4                                      2144 09569000
         L     @01,DALVLPTR(,@05)                                  2144 09570000
         ALR   @01,@15                                             2144 09571000
         AL    @01,@CF01717                                        2144 09572000
         MVC   ALCVSER(6,@14),FVTVSER-4(@01)                       2144 09573000
*            END DALOOP1;                                  /*@Y30SSJH*/ 09574000
*                                                                  2145 09575000
         AL    @06,@CF00220                                        2145 09576000
@DE02140 ST    @06,N                                               2145 09577000
         L     @01,DALGLPTR                                        2145 09578000
         L     @01,ALLVLP(,@01)                                    2145 09579000
         LH    @15,ALC#ENT(,@01)                                   2145 09580000
         BCTR  @15,0                                               2145 09581000
         CR    @06,@15                                             2145 09582000
         BNH   @DL02140                                            2145 09583000
*            /********************************************************/ 09584000
*            /*                                              @Y30SSJH*/ 09585000
*            /* INITIALIZE REMAINING ALLAGL FIELDS           @Y30SSJH*/ 09586000
*            /*                                              @Y30SSJH*/ 09587000
*            /********************************************************/ 09588000
*                                                                  2146 09589000
*            ALLULP = ADDR(DALCUNIT);                      /*@Y30SSJH*/ 09590000
         L     @06,DALGLPTR                                        2146 09591000
         LA    @15,DALCUNIT                                        2146 09592000
         ST    @15,ALLULP(,@06)                                    2146 09593000
*            ALLOPTVL = ON;                                /*@Y30SSJH*/ 09594000
*                                                                  2147 09595000
         OI    ALLOPTVL(@06),B'10000000'                           2147 09596000
*            /********************************************************/ 09597000
*            /*                                              @Y30SSJH*/ 09598000
*            /*  INVOKE DYNAMIC ALLOCATION VIA AMS UALLOC MACRO      */ 09599000
*            /*                                              @Y30SSJH*/ 09600000
*            /********************************************************/ 09601000
*                                                                  2148 09602000
*            CALL IDCSAAL0 (GDTTBL,ALLAGL);                /*@Y30SSJH*/ 09603000
*                                                                  2148 09604000
         L     @15,@PC00001                                        2148 09605000
         ST    @15,@AL00001                                        2148 09606000
         ST    @06,@AL00001+4                                      2148 09607000
         MVI   @AL00001+4,X'80'                                    2148 09608000
         L     @15,GDTALC(,@15)                                    2148 09609000
         LA    @01,@AL00001                                        2148 09610000
         BALR  @14,@15                                             2148 09611000
*            RESPECIFY RTNREG RSTD;                                2149 09612000
*            TESTRC = RTNREG;                                      2150 09613000
         STH   RTNREG,TESTRC                                       2150 09614000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/ 09615000
*            IF TESTRC = 4                                         2152 09616000
*              THEN                                                2152 09617000
         LH    @06,TESTRC                                          2152 09618000
         C     @06,@CF00044                                        2152 09619000
         BNE   @RF02152                                            2152 09620000
*                DO;                                       /*@Y30SSJH*/ 09621000
*                                                                  2153 09622000
*                ALSTID = NOENTALT;                        /*@Y30SSJH*/ 09623000
         MVC   ALSTID(5),@CB01058                                  2154 09624000
*                RETURN;                                   /*@Y30SSJH*/ 09625000
*                                                                  2155 09626000
         B     @EL00008                                            2155 09627000
*                END;                                      /*@Y30SSJH*/ 09628000
*            /********************************************************/ 09629000
*            /*                                              @Y30SSJH*/ 09630000
*            /* MAINTAIN A LIST OF POINTERS TO ALLAGLS - THERE IS A  */ 09631000
*            /* POSSIBILITY OF TWO ALLAGLS                   @Y30SSJH*/ 09632000
*            /*                                              @Y30SSJH*/ 09633000
*            /********************************************************/ 09634000
*                                                                  2157 09635000
*            DALINDEX = DALINDEX + 1;                      /*@Y30SSJH*/ 09636000
@RF02152 L     @06,@PC00008+12                                     2157 09637000
         LA    @15,1                                               2157 09638000
         AL    @15,DALINDEX(,@06)                                  2157 09639000
         ST    @15,DALINDEX(,@06)                                  2157 09640000
*            ALSAVPTR(DALINDEX) = DALGLPTR;                /*@Y30SSJH*/ 09641000
*                                                                  2158 09642000
         L     @06,DALGLPTR                                        2158 09643000
         SLA   @15,2                                               2158 09644000
         ST    @06,ALSAVPTR-4(@15)                                 2158 09645000
*            /********************************************************/ 09646000
*            /*                                              @Y30SSJH*/ 09647000
*            /* SET POINTER TO DDNAME BUILT BY UALLOC        @Y30SSJH*/ 09648000
*            /*                                              @Y30SSJH*/ 09649000
*            /********************************************************/ 09650000
*                                                                  2159 09651000
*            DALDNMPT = ADDR(ALLDDN);                      /*@Y30SSJH*/ 09652000
*                                                                  2159 09653000
         L     @15,@PC00008+8                                      2159 09654000
         LA    @06,ALLDDN(,@06)                                    2159 09655000
         ST    @06,DALDNMPT(,@15)                                  2159 09656000
*            END DALOOP0;                                  /*@Y30SSJH*/ 09657000
*                                                                  2160 09658000
*          /**********************************************************/ 09659000
*          /* THIS IS A DEALLOCATE REQUEST                   @Y30SSJH*/ 09660000
*          /**********************************************************/ 09661000
*          ELSE                                                    2161 09662000
*            DO;                                           /*@OZ17504*/ 09663000
         B     @RC02117                                            2161 09664000
@RF02117 DS    0H                                                  2162 09665000
*              DO N = 1 TO DALINDEX;                       /*@Y30SSJH*/ 09666000
*                                                                  2162 09667000
         LA    @06,1                                               2162 09668000
         B     @DE02162                                            2162 09669000
@DL02162 DS    0H                                                  2163 09670000
*                RFY ALLAGL BASED(ALSAVPTR(N));              /*YM5040*/ 09671000
*                                                                  2163 09672000
*                CALL IDCSADL0 (GDTTBL,ALLAGL);            /*@Y30SSJH*/ 09673000
*                                                                  2164 09674000
         L     @15,@PC00001                                        2164 09675000
         ST    @15,@AL00001                                        2164 09676000
         SLA   @06,2                                               2164 09677000
         L     @06,ALSAVPTR-4(@06)                                 2164 09678000
         ST    @06,@AL00001+4                                      2164 09679000
         MVI   @AL00001+4,X'80'                                    2164 09680000
         L     @15,GDTDLC(,@15)                                    2164 09681000
         LA    @01,@AL00001                                        2164 09682000
         BALR  @14,@15                                             2164 09683000
*                RESPECIFY RTNREG RSTD;                            2165 09684000
*                TESTRC = RTNREG;                                  2166 09685000
         STH   RTNREG,TESTRC                                       2166 09686000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSJH*/ 09687000
*                                                                  2167 09688000
*              END;                                        /*@Y30SSJH*/ 09689000
*                                                                  2168 09690000
         LA    @06,1                                               2168 09691000
         AL    @06,N                                               2168 09692000
@DE02162 ST    @06,N                                               2168 09693000
         L     @15,@PC00008+12                                     2168 09694000
         C     @06,DALINDEX(,@15)                                  2168 09695000
         BNH   @DL02162                                            2168 09696000
*              DALINDEX = 0;                               /*@OZ17504*/ 09697000
         L     @06,@PC00008+12                                     2169 09698000
         SLR   @15,@15                                             2169 09699000
         ST    @15,DALINDEX(,@06)                                  2169 09700000
*            END;                                          /*@OZ17504*/ 09701000
*                                                                  2170 09702000
*        RETURN;                                           /*@Y30SSJH*/ 09703000
         B     @EL00008                                            2171 09704000
*END DALCPROC;                                             /*@Y30SSJH*/ 09705000
         B     @EL00008                                            2172 09706000
*END IDCAL01                                               /*@Y30SSJH*/ 09707000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 09708000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 09709000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 09710000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 09711000
*/*%INCLUDE SYSLIB  (IDCCSAL )                                        * 09712000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 09713000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 09714000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 09715000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 09716000
*;                                                                 2173 09717000
@DATA    DS    0H                                                       09718000
@CH00467 DC    H'7'                                                     09719000
@CH00036 DC    H'11'                                                    09720000
@CH00638 DC    H'13'                                                    09721000
@CH00641 DC    H'14'                                                    09722000
@CH00477 DC    H'16'                                                    09723000
@CH01590 DC    H'17'                                                    09724000
@CH00650 DC    H'18'                                                    09725000
@CH00653 DC    H'19'                                                    09726000
@CH00662 DC    H'22'                                                    09727000
@CH00222 DC    H'32'                                                    09728000
@CH00687 DC    H'45'                                                    09729000
@CH01673 DC    H'140'                                                   09730000
@CH01113 DC    H'365'                                                   09731000
@SM01681 MVC   0(0,@01),0(@15)                                          09732000
@SM01686 MVC   NEWNAME(0),NEWNMVAL(@06)                                 09733000
@SM01688 MVC   0(0,@04),ENTVAL-5(@02)                                   09734000
@SM01690 MVC   0(0,@02),NEWNMVAL(@14)                                   09735000
@SM01692 MVC   0(0,@02),ENTVAL-5(@14)                                   09736000
@SM01694 MVC   0(0,@01),NEWNMVAL(@04)                                   09737000
@SM01709 MVC   LCUAREC(0,@06),USARVAL(@15)                              09738000
         DS    0F                                                       09739000
@AL00647 DC    A(ALGPID)               LIST WITH   2 ARGUMENT(S)        09740000
         DC    AL1(X'80')                                               09741000
         DC    AL3(ALL)                                                 09742000
@DATD    DSECT                                                          09743000
         DS    0F                                                       09744000
@SA00001 DS    18F                                                      09745000
@PC00001 DS    3F                                                       09746000
@SA00004 DS    15F                                                      09747000
@SA00002 DS    15F                                                      09748000
@SA00005 DS    15F                                                      09749000
@PC00007 DS    1F                                                       09750000
@SA00003 DS    15F                                                      09751000
@PC00003 DS    1F                                                       09752000
@SA00006 DS    15F                                                      09753000
@SA00008 DS    15F                                                      09754000
@PC00008 DS    4F                                                       09755000
@AL00001 DS    5A                                                       09756000
@TF00001 DS    F                                                        09757000
@AFTEMPS DS    4F                                                       09758000
IDCAL01  CSECT                                                          09759000
         DS    0F                                                       09760000
@CF00117 DC    F'0'                                                     09761000
@CF00220 DC    F'1'                                                     09762000
@CH00220 EQU   @CF00220+2                                               09763000
@CF00155 DC    F'2'                                                     09764000
@CH00155 EQU   @CF00155+2                                               09765000
@CF00164 DC    F'3'                                                     09766000
@CH00164 EQU   @CF00164+2                                               09767000
@CF00044 DC    F'4'                                                     09768000
@CH00044 EQU   @CF00044+2                                               09769000
@CF00287 DC    F'5'                                                     09770000
@CH00287 EQU   @CF00287+2                                               09771000
@CF00158 DC    F'6'                                                     09772000
@CH00158 EQU   @CF00158+2                                               09773000
@CF00039 DC    F'8'                                                     09774000
@CH00039 EQU   @CF00039+2                                               09775000
@CF00037 DC    F'10'                                                    09776000
@CH00037 EQU   @CF00037+2                                               09777000
@CF00035 DC    F'12'                                                    09778000
@CH00035 EQU   @CF00035+2                                               09779000
@CF00229 DC    F'15'                                                    09780000
@CH00229 EQU   @CF00229+2                                               09781000
@CF00311 DC    F'24'                                                    09782000
@CF00678 DC    F'28'                                                    09783000
@CF00720 DC    F'40'                                                    09784000
@CF00684 DC    F'43'                                                    09785000
@CF00594 DC    F'44'                                                    09786000
@CH00594 EQU   @CF00594+2                                               09787000
@CF00724 DC    F'50'                                                    09788000
@CF00728 DC    F'52'                                                    09789000
@CF00756 DC    F'64'                                                    09790000
@CH00756 EQU   @CF00756+2                                               09791000
@CF00770 DC    F'72'                                                    09792000
@CF01422 DC    F'76'                                                    09793000
@CF01423 DC    F'136'                                                   09794000
@CF01421 DC    F'240'                                                   09795000
@CF00648 DC    F'255'                                                   09796000
@CF01117 DC    F'512'                                                   09797000
@CF01115 DC    F'1830'                                                  09798000
@CF01137 DC    F'4089'                                                  09799000
@CF01135 DC    F'32600'                                                 09800000
@CF01684 DC    F'-41'                                                   09801000
@CF01685 DC    F'-40'                                                   09802000
@CF01712 DC    F'-16'                                                   09803000
@CF01711 DC    F'-8'                                                    09804000
@CF01719 DC    F'-6'                                                    09805000
@CF01718 DC    F'-5'                                                    09806000
@CF01717 DC    F'-4'                                                    09807000
@DATD    DSECT                                                          09808000
         DS    0D                                                       09809000
LISTSCAN DS    A                                                        09810000
IOCSPTR  DS    A                                                        09811000
OPNPTR   DS    A                                                        09812000
DDSTRU   DS    A                                                        09813000
FSADDR   DS    A                                                        09814000
ERCNVADR DS    A                                                        09815000
DMPINDEX DS    A                                                        09816000
CTGPLPTR DS    A                                                        09817000
CTGFLPTR DS    A                                                        09818000
DSBCATPT DS    A                                                        09819000
CTGFVPTR DS    A                                                        09820000
ALPRMPTR DS    A                                                        09821000
CATACBPT DS    A                                                        09822000
DALCINDX DS    F                                                        09823000
N        DS    F                                                        09824000
I        DS    F                                                        09825000
ENT      DS    F                                                        09826000
ALLPTR   DS    A                                                        09827000
CIRPTR   DS    A                                                        09828000
GENWKPTR DS    A                                                        09829000
GENCNT   DS    F                                                        09830000
KEYRECRC DS    F                                                        09831000
KEYPVALU DS    F                                                        09832000
KEYLVALU DS    F                                                        09833000
MAXRECSZ DS    F                                                        09834000
CPLSAVE  DS    A                                                        09835000
IXAMDPT  DS    A                                                        09836000
IXAMDLEN DS    F                                                        09837000
LWKALEN  DS    F                                                        09838000
ALVOLLEN DS    F                                                        09839000
NEWPSWPT DS    A                                                        09840000
PDSIOCS  DS    A                                                        09841000
SQRTINC  DS    F                                                        09842000
SQRTVALU DS    F                                                        09843000
XVAL     DS    F                                                        09844000
YVAL     DS    F                                                        09845000
MAXVALU  DS    F                                                        09846000
KYPOSIT  DS    F                                                        09847000
IXPRMPTR DS    A                                                        09848000
DALGLPTR DS    A                                                        09849000
LISTPTR  DS    A                                                        09850000
SETRC    DS    H                                                        09851000
TESTRC   DS    H                                                        09852000
PARMINDX DS    H                                                        09853000
J        DS    H                                                        09854000
DRHS     DS    H                                                        09855000
ADDCOUNT DS    H                                                        09856000
NOWYEAR  DS    H                                                        09857000
DAYPERYR DS    H                                                        09858000
MIGRLOOP DS    H                                                        09859000
CYCLECNT DS    FL1                                                      09860000
LISTLN   DS    FL1                                                      09861000
@TS00001 DS    CL95                                                     09862000
DEFINED  DS    BL1                                                      09863000
NEWNAME  DS    CL44                                                     09864000
@NM00054 DS    CL14                                                     09865000
         ORG   @NM00054                                                 09866000
ALSTIDLB DS    CL9                                                      09867000
ALSTID   DS    CL5                                                      09868000
         ORG   ALSTID                                                   09869000
ALMODID  DS    CL3                                                      09870000
ALSTCOND DS    AL1                                                      09871000
ALSTD    DS    AL1                                                      09872000
         ORG   @NM00054+14                                              09873000
         DS    CL2                                                      09874000
@NM00055 DS    CL12                                                     09875000
         ORG   @NM00055                                                 09876000
CATRTNID DS    CL8                                                      09877000
CTGRTNCC DS    FL4                                                      09878000
         ORG   @NM00055+12                                              09879000
LOCTABLE DS    CL80                                                     09880000
         ORG   LOCTABLE                                                 09881000
LCETYPLN DS    FL4                                                      09882000
LCETYPPT DS    AL4                                                      09883000
LCACBLN  DS    FL4                                                      09884000
LCACBPT  DS    AL4                                                      09885000
LCNAMLN  DS    FL4                                                      09886000
LCNAMPT  DS    AL4                                                      09887000
LCRBALN  DS    FL4                                                      09888000
LCRBAPT  DS    AL4                                                      09889000
LCCRALN  DS    FL4                                                      09890000
LCCRAPT  DS    AL4                                                      09891000
LCPSWLN  DS    FL4                                                      09892000
LCPSWPT  DS    AL4                                                      09893000
LCDATRLN DS    FL4                                                      09894000
LCDATRPT DS    AL4                                                      09895000
LCAMDLN  DS    FL4                                                      09896000
LCAMDPT  DS    AL4                                                      09897000
LCRATRLN DS    FL4                                                      09898000
LCRATRPT DS    AL4                                                      09899000
LCGATRLN DS    FL4                                                      09900000
LCGATRPT DS    AL4                                                      09901000
         ORG   LOCTABLE+80                                              09902000
ALRGATTR DS    CL2                                                      09903000
         ORG   ALRGATTR                                                 09904000
ALRGPARM DS    BL1                                                      09905000
         ORG   ALRGPARM                                                 09906000
ALUPGUPD DS    BL1                                                      09907000
@NM00077 EQU   ALRGPARM+0                                               09908000
         ORG   ALRGATTR+1                                               09909000
ALRGSPEC DS    BL1                                                      09910000
         ORG   ALRGSPEC                                                 09911000
ALUPSPEC DS    BL1                                                      09912000
@NM00078 EQU   ALRGSPEC+0                                               09913000
         ORG   ALRGATTR+2                                               09914000
ALOPNAGL DS    BL48                                                     09915000
         DS    CL2                                                      09916000
DARGAREA DS    CL60                                                     09917000
ALGLSAVE DS    CL20                                                     09918000
         ORG   ALGLSAVE                                                 09919000
ALSAVPTR DS    0A                                                       09920000
         ORG   ALGLSAVE+20                                              09921000
ALERRTBL DS    CL32                                                     09922000
ALLLIST  DS    CL31                                                     09923000
RENEWCPL DS    CL28                                                     09924000
CIRLIST  DS    CL32                                                     09925000
CATNAME  DS    CL44                                                     09926000
         DS    CL1                                                      09927000
ENTRIES  DS    CL49                                                     09928000
         ORG   ENTRIES                                                  09929000
ENTRYLEN DS    FL2                                                      09930000
@NM00080 DS    CL2                                                      09931000
ATYPE    DS    CL1                                                      09932000
ENTRYVAL DS    CL44                                                     09933000
         ORG   ENTRIES+49                                               09934000
         DS    CL3                                                      09935000
QUALLIST DS    CL12                                                     09936000
         ORG   QUALLIST                                                 09937000
QUALADDR DS    AL4                                                      09938000
QUALCAT  DS    AL4                                                      09939000
QUALPAS  DS    AL4                                                      09940000
         ORG   QUALLIST+12                                              09941000
BYPASSSW DS    BL1                                                      09942000
DATACI   DS    CL3                                                      09943000
INDEXCI  DS    CL3                                                      09944000
BDATACI  DS    CL3                                                      09945000
BCLUSCI  DS    CL3                                                      09946000
CKTYPE   DS    CL1                                                      09947000
CYCLEFLG DS    CL1                                                      09948000
         DS    CL5                                                      09949000
EXPIREDT DS    CL8                                                      09950000
         ORG   EXPIREDT                                                 09951000
@NM00084 DS    CL5                                                      09952000
EXPIRE   DS    CL3                                                      09953000
         ORG   EXPIRE                                                   09954000
EXPIRYR  DS    FL1                                                      09955000
EXPIRDAY DS    FL2                                                      09956000
         ORG   EXPIREDT+8                                               09957000
DATELOOP DS    CL1                                                      09958000
         DS    CL7                                                      09959000
XCURDATE DS    CL8                                                      09960000
         ORG   XCURDATE                                                 09961000
@NM00085 DS    CL1                                                      09962000
XUTYEAR  DS    FL1                                                      09963000
XUTDAY   DS    FL2                                                      09964000
         ORG   XCURDATE+8                                               09965000
TIMEODAY DS    CL8                                                      09966000
DAYTOTL  DS    CL8                                                      09967000
         ORG   DAYTOTL                                                  09968000
@NM00086 DS    CL6                                                      09969000
DAYTOTAL DS    FL2                                                      09970000
         ORG   DAYTOTL+8                                                09971000
MIGRFLAG DS    CL1                                                      09972000
         DS    CL3                                                      09973000
PDSLIST  DS    BL48                                                     09974000
HURBAWKA DS    CL8                                                      09975000
         ORG   HURBAWKA                                                 09976000
HURTOTLN DS    FL2                                                      09977000
HURRETLN DS    FL2                                                      09978000
HURBADS  DS    FL4                                                      09979000
         ORG   HURBAWKA+8                                               09980000
ASSOCWKA DS    CL32                                                     09981000
         ORG   ASSOCWKA                                                 09982000
ASSTOTLN DS    FL2                                                      09983000
ASSRETLN DS    FL2                                                      09984000
@NM00087 DS    CL28                                                     09985000
         ORG   ASSOCWKA+32                                              09986000
AMDSBWKA DS    CL140                                                    09987000
         ORG   AMDSBWKA                                                 09988000
AMDTOTLN DS    FL2                                                      09989000
AMDRETLN DS    FL2                                                      09990000
@NM00088 DS    CL96                                                     09991000
@NM00089 DS    CL40                                                     09992000
         ORG   AMDSBWKA+140                                             09993000
SQRTSW   DS    BL1                                                      09994000
NEWNAMLN DS    CL44                                                     09995000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09996000
@ENDDATD EQU   *                                                        09997000
IDCAL01  CSECT                                                          09998000
         DS    0F                                                       09999000
@SIZDATD DC    AL1(0)                                                   10000000
         DC    AL3(@ENDDATD-@DATD)                                      10001000
         DS    0D                                                       10002000
NAMEMASK DC    H'5'                                                     10003000
@CC01394 DC    C'HERE I AM'                                             10004000
@CC01396 DC    C'CATLGRTN'                                              10005000
@CC01582 DC    C'IXCPL'                                                 10006000
@CC00205 DC    C'NAME'                                                  10007000
@CC01147 DC    C'AL01'                                                  10008000
@CC01425 DC    C'AL04'                                                  10009000
@CC01430 DC    C'AL02'                                                  10010000
@CC01441 DC    C'AL31'                                                  10011000
@CC01444 DC    C'TYPE'                                                  10012000
@CC01448 DC    C'PSWD'                                                  10013000
@CC01449 DC    C'DSAT'                                                  10014000
@CC01450 DC    C'AMDB'                                                  10015000
@CC01452 DC    C'RGAT'                                                  10016000
@CC01453 DC    C'TEST'                                                  10017000
@CC01456 DC    C'AL03'                                                  10018000
@CC01492 DC    C'AL41'                                                  10019000
@CC01503 DC    C'OWNR'                                                  10020000
@CC01504 DC    C'EEXT'                                                  10021000
@CC01508 DC    C'LREC'                                                  10022000
@CC01509 DC    C'BUFS'                                                  10023000
@CC01517 DC    C'ALMR'                                                  10024000
@CC01543 DC    C'AL51'                                                  10025000
@CC01552 DC    C'AL52'                                                  10026000
@CC01558 DC    C'AL53'                                                  10027000
@CC01561 DC    C'AL54'                                                  10028000
@CC01562 DC    C'AL55'                                                  10029000
@CC01563 DC    C'AL56'                                                  10030000
@CC01581 DC    C'AL61'                                                  10031000
@CC01583 DC    C'IFVT'                                                  10032000
@CC01620 DC    C'AL71'                                                  10033000
@CC01426 EQU   @CC01147                                                 10034000
@CC01442 DC    C'CPL'                                                   10035000
@CC01445 DC    C'ACB'                                                   10036000
@CC01446 DC    C'RBA'                                                   10037000
@CC01447 DC    C'CRA'                                                   10038000
@CC01451 DC    C'GDG'                                                   10039000
@CC01493 DC    C'FVT'                                                   10040000
@CC00855 EQU   @CC01449                                                 10041000
@CC00859 EQU   @CC01147                                                 10042000
@CB01016 DC    X'E4E5F00807'                                            10043000
@CB01025 DC    X'C1D3F00803'                                            10044000
@CB01028 DC    X'C1D3F00C0C'                                            10045000
@CB01031 DC    X'C1D3F00C0D'                                            10046000
@CB01034 DC    X'E4E5F00001'                                            10047000
@CB01039 DC    X'E4E5F00C04'                                            10048000
@CB01042 DC    X'E4E5F00C03'                                            10049000
@CB01045 DC    X'C1D3F00C04'                                            10050000
@CB01048 DC    X'C1D3F00C17'                                            10051000
@CB01052 DC    X'C1D3F0080A'                                            10052000
@CB01055 DC    X'C1D3F0080B'                                            10053000
@CB01058 DC    X'C1D3F00808'                                            10054000
@CB01061 DC    X'C1D3F00007'                                            10055000
@CB01064 DC    X'C1D3F00C05'                                            10056000
@CB01067 DC    X'C1D3F00C09'                                            10057000
@CB01070 DC    X'C1D3F00C02'                                            10058000
@CB01073 DC    X'C1D3F00C06'                                            10059000
@CB01076 DC    X'C1D3F00C16'                                            10060000
@CB01079 DC    X'C1D3F00C0E'                                            10061000
@CB01082 DC    X'C1D3F00C11'                                            10062000
@CB01086 DC    X'C1D3F00C0F'                                            10063000
@CB01089 DC    X'C1D3F00C10'                                            10064000
@CB01092 DC    X'C1D3F00C14'                                            10065000
@CB01095 DC    X'C1D3F00C15'                                            10066000
@CB01098 DC    X'C1D3F00C18'                                            10067000
@CB01568 DC    X'00000000'                                              10068000
@CB01495 DC    X'00000F'                                                10069000
@CB01498 DC    X'99999F'                                                10070000
@CB01457 DC    X'FFFF'                                                  10071000
ALL      DC    CL3'ALL'                                                 10072000
FORMAT   DC    CL4'FORM'                                                10073000
HSECOND  DC    CL4'HSEC'                                                10074000
CLOCK    DC    CL4'KLOK'                                                10075000
SETZERO  DC    CL4'ZERO'                                                10076000
SETBLANK DC    CL4'BLNK'                                                10077000
NOSET    DC    CL4'NSET'                                                10078000
OVERRIDE DC    CL4'OVRD'                                                10079000
ACQUIRE  DC    CL8'ACQUIRE '                                            10080000
RELINQ   DC    CL8'RELINQ  '                                            10081000
MOUNT    DC    CL8'MOUNT   '                                            10082000
DEMOUNT  DC    CL8'DEMOUNT '                                            10083000
DEFINE   DC    CL8'DEFINE  '                                            10084000
MOVE     DC    CL8'MOVE    '                                            10085000
TRACEQ   DC    CL8'TRACEQ  '                                            10086000
COPYTABL DC    CL8'COPYTABL'                                            10087000
COPYCRTG DC    CL8'COPYCRTG'                                            10088000
COPYVOL  DC    CL8'COPYVOL '                                            10089000
VVIC     DC    CL8'VVIC    '                                            10090000
TUNE     DC    CL8'TUNE    '                                            10091000
NAMES    DC    CL4'NAME'                                                10092000
UNIT     DC    CL4'UNIT'                                                10093000
SHR      DC    CL4'SHR '                                                10094000
EXCL     DC    CL4'EXCL'                                                10095000
NOWAIT   DC    CL4'NWAI'                                                10096000
WAIT     DC    CL4'WAIT'                                                10097000
NULLMASK DC    X'FFFFFFFFFFFFFFFF'                                      10098000
INITVALU DC    X'FFFFFF'                                                10099000
NULLCRA  DC    X'000000000000'                                          10100000
MODID    DC    CL4'AL01'                                                10101000
FIXAREA  DS    CL512                                                    10102000
         ORG   FIXAREA                                                  10103000
@NM00050 DS    CL256                                                    10104000
         ORG   @NM00050                                                 10105000
@NM00051 DC    256X'00'                                                 10106000
         ORG   FIXAREA+256                                              10107000
@NM00052 DS    CL256                                                    10108000
         ORG   @NM00052                                                 10109000
@NM00053 DC    256X'00'                                                 10110000
         ORG   FIXAREA+512                                              10111000
ALGPID   DC    CL4'AL00'                                                10112000
ALGPID2  DC    CL4'AL77'                                                10113000
RENAMMEM DC    CL1'R'                                                   10114000
PASSWORD DC    CL8'PASSWORD'                                            10115000
DALCUNIT DS    CL22                                                     10116000
         ORG   DALCUNIT                                                 10117000
DL#UNIT  DC    H'2'                                                     10118000
DUNITLN1 DC    H'8'                                                     10119000
DLUNIT1  DC    CL8'SYSALLDA'                                            10120000
DUNITLN2 DC    H'8'                                                     10121000
DLUNIT2  DC    CL8'SYSALLDA'                                            10122000
         ORG   DALCUNIT+22                                              10123000
ALFLDNAM DC    CL8'ENTYPE'                                              10124000
         DC    CL8'CATACB'                                              10125000
         DC    CL8'NAMEDS'                                              10126000
         DC    CL8'HURBADS'                                             10127000
         DC    CL8'CRAVOL'                                              10128000
         DC    CL8'PASSWALL'                                            10129000
         DC    CL8'DSATTR'                                              10130000
         DC    CL8'AMDSBCAT'                                            10131000
         DC    CL8'RGATTR'                                              10132000
         DC    CL8'GDGATTR'                                             10133000
         DC    CL8'DSETEXDT'                                            10134000
         DC    CL8'OWNERID'                                             10135000
         DC    CL8'BUFSIZE'                                             10136000
         DC    CL8'EXCPEXIT'                                            10137000
         DC    CL8'LRECL'                                               10138000
         DC    CL8'CNTREPNO'                                            10139000
PARMTAB  DC    CL13'STAGE'                                              10140000
         DC    CL13'BIND'                                               10141000
         DC    CL13'CYLINDERFAULT'                                      10142000
         DC    CL13'DESTAGEWAIT'                                        10143000
         DC    CL13'NODESTAGEWAIT'                                      10144000
         DC    CL13'WRITECHECK'                                         10145000
         DC    CL13'NOWRITECHECK'                                       10146000
         DC    CL13'FREESPACE'                                          10147000
         DC    CL13'UNIQUEKEY'                                          10148000
         DC    CL13'NONUNIQUEKEY'                                       10149000
         DC    CL13'ERASE'                                              10150000
         DC    CL13'NOERASE'                                            10151000
         DC    CL13'SHAREOPTIONS'                                       10152000
         DC    CL13'INHIBIT'                                            10153000
         DC    CL13'UNINHIBIT'                                          10154000
         DC    CL13'EMPTY'                                              10155000
         DC    CL13'NOEMPTY'                                            10156000
         DC    CL13'SCRATCH'                                            10157000
         DC    CL13'NOSCRATCH'                                          10158000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       10159000
@01      EQU   01                                                       10160000
@02      EQU   02                                                       10161000
@03      EQU   03                                                       10162000
@04      EQU   04                                                       10163000
@05      EQU   05                                                       10164000
@06      EQU   06                                                       10165000
@07      EQU   07                                                       10166000
@08      EQU   08                                                       10167000
@09      EQU   09                                                       10168000
@10      EQU   10                                                       10169000
@11      EQU   11                                                       10170000
@12      EQU   12                                                       10171000
@13      EQU   13                                                       10172000
@14      EQU   14                                                       10173000
@15      EQU   15                                                       10174000
RTNREG   EQU   @15                                                      10175000
REG5     EQU   @05                                                      10176000
REG6     EQU   @06                                                      10177000
REG0     EQU   @00                                                      10178000
REG1     EQU   @01                                                      10179000
REG10    EQU   @10                                                      10180000
REG11    EQU   @11                                                      10181000
REG12    EQU   @12                                                      10182000
REG13    EQU   @13                                                      10183000
REG14    EQU   @14                                                      10184000
REG15    EQU   @15                                                      10185000
REG2     EQU   @02                                                      10186000
REG3     EQU   @03                                                      10187000
REG4     EQU   @04                                                      10188000
REG7     EQU   @07                                                      10189000
REG8     EQU   @08                                                      10190000
REG9     EQU   @09                                                      10191000
IDCSAEP0 EQU   0                                                        10192000
IDCSAGP0 EQU   0                                                        10193000
IDCSAFP0 EQU   0                                                        10194000
IDCSATI0 EQU   0                                                        10195000
IDCSACA0 EQU   0                                                        10196000
IDCSACR0 EQU   0                                                        10197000
IDCSAAL0 EQU   0                                                        10198000
IDCSADL0 EQU   0                                                        10199000
IDCSAQL0 EQU   0                                                        10200000
TRACE1   EQU   0                                                        10201000
OLDERID1 EQU   TRACE1                                                   10202000
TRACE2   EQU   0                                                        10203000
OLDERID2 EQU   TRACE2                                                   10204000
NEWID2   EQU   TRACE2+95                                                10205000
NEWERID2 EQU   5                                                        10206000
CIRAGL   EQU   0                                                        10207000
CIRTYPE  EQU   CIRAGL                                                   10208000
CIRTYP1Q EQU   CIRTYPE                                                  10209000
CIRHLN   EQU   CIRAGL+4                                                 10210000
CIRTLN   EQU   CIRAGL+6                                                 10211000
CIRHDR   EQU   CIRAGL+8                                                 10212000
CIRTLR   EQU   CIRAGL+12                                                10213000
CIRWKP   EQU   CIRAGL+16                                                10214000
CIRCAT   EQU   CIRAGL+20                                                10215000
CIRPWD   EQU   CIRAGL+24                                                10216000
CIRPID   EQU   CIRAGL+28                                                10217000
ALLAGL   EQU   0                                                        10218000
ALLDSN   EQU   ALLAGL                                                   10219000
ALLDDN   EQU   ALLAGL+4                                                 10220000
ALLULP   EQU   ALLAGL+12                                                10221000
ALLVLP   EQU   ALLAGL+16                                                10222000
ALLPWD   EQU   ALLAGL+20                                                10223000
ALLSTS   EQU   ALLAGL+24                                                10224000
ALLSTSOD EQU   ALLSTS                                                   10225000
ALLDSP   EQU   ALLAGL+25                                                10226000
ALLDSPKP EQU   ALLDSP                                                   10227000
ALLORG   EQU   ALLAGL+26                                                10228000
ALLOPT   EQU   ALLAGL+28                                                10229000
ALLOPTVL EQU   ALLOPT                                                   10230000
ALLOPTDS EQU   ALLOPT                                                   10231000
UNITABL  EQU   0                                                        10232000
UNITADR  EQU   UNITABL+4                                                10233000
@NM00010 EQU   UNITADR                                                  10234000
UNITSTAT EQU   UNITABL+6                                                10235000
IDCIOOP0 EQU   0                                                        10236000
IDCIOCL0 EQU   0                                                        10237000
IDCIOST0 EQU   0                                                        10238000
IOCSTR   EQU   0                                                        10239000
IOCDSO   EQU   IOCSTR+16                                                10240000
IOCRFM   EQU   IOCSTR+17                                                10241000
IOCMAC   EQU   IOCSTR+18                                                10242000
IOCMAC2  EQU   IOCSTR+19                                                10243000
IOCCHP   EQU   IOCSTR+20                                                10244000
IOCMSG   EQU   IOCSTR+21                                                10245000
IOCDSN   EQU   IOCSTR+32                                                10246000
IOCRBA   EQU   IOCSTR+40                                                10247000
IOCTTR   EQU   IOCRBA                                                   10248000
IOCMEM   EQU   IOCSTR+44                                                10249000
IOCNWM   EQU   IOCSTR+48                                                10250000
OPNAGL   EQU   0                                                        10251000
OPNOPT   EQU   OPNAGL                                                   10252000
OPNOPTOT EQU   OPNOPT                                                   10253000
OPNOPTBK EQU   OPNOPT                                                   10254000
OPNRFM   EQU   OPNAGL+1                                                 10255000
OPNTYP   EQU   OPNAGL+2                                                 10256000
OPNMOD   EQU   OPNAGL+3                                                 10257000
OPNIOC   EQU   OPNAGL+4                                                 10258000
OPNDDN   EQU   OPNAGL+8                                                 10259000
OPNPWA   EQU   OPNAGL+12                                                10260000
OPNDSN   EQU   OPNAGL+16                                                10261000
OPNDEV   EQU   OPNAGL+24                                                10262000
OPNDSO   EQU   OPNAGL+41                                                10263000
OPNDSOPO EQU   OPNDSO                                                   10264000
OPNOPT2  EQU   OPNAGL+42                                                10265000
IOINFOPT EQU   0                                                        10266000
UVOLLIST EQU   0                                                        10267000
UVOLENT  EQU   UVOLLIST+2                                               10268000
AMSTP011 EQU   0                                                        10269000
IDCTPER0 EQU   0                                                        10270000
DARGLIST EQU   0                                                        10271000
DARGDBP  EQU   DARGLIST                                                 10272000
DARGSTID EQU   DARGLIST+8                                               10273000
DARGSMOD EQU   DARGSTID                                                 10274000
DARGSENT EQU   DARGSTID+3                                               10275000
DARGILP  EQU   DARGLIST+12                                              10276000
DARGCNT  EQU   DARGLIST+14                                              10277000
DARGFLGS EQU   DARGLIST+19                                              10278000
DARGARY  EQU   DARGLIST+20                                              10279000
DARGINS  EQU   DARGARY                                                  10280000
DARGINL  EQU   DARGARY+2                                                10281000
DARGPCT  EQU   DARGINL                                                  10282000
FMTLIST  EQU   0                                                        10283000
FMTFLGS  EQU   FMTLIST                                                  10284000
FMTSPF   EQU   FMTLIST+2                                                10285000
FMTRFNO  EQU   FMTSPF                                                   10286000
FMTILEN  EQU   FMTRFNO                                                  10287000
FMTIOFF  EQU   FMTLIST+4                                                10288000
FMTTRBC  EQU   FMTIOFF                                                  10289000
FMTSTO   EQU   FMTTRBC                                                  10290000
FMTOCOL  EQU   FMTLIST+6                                                10291000
FMTCNVF  EQU   FMTLIST+10                                               10292000
ERCNVTAB EQU   0                                                        10293000
ERTYPE   EQU   ERCNVTAB                                                 10294000
ERCATLG  EQU   ERTYPE                                                   10295000
EROPER   EQU   ERCNVTAB+1                                               10296000
ERCATLC  EQU   EROPER                                                   10297000
ERCATAL  EQU   EROPER                                                   10298000
EROSOPER EQU   ERCNVTAB+2                                               10299000
ERDSNM   EQU   ERCNVTAB+12                                              10300000
ERCATRC  EQU   ERCNVTAB+16                                              10301000
ERCPLPT  EQU   ERCNVTAB+20                                              10302000
IDCDB010 EQU   0                                                        10303000
DMPITM   EQU   0                                                        10304000
DMPARY   EQU   0                                                        10305000
NTRY     EQU   0                                                        10306000
NTRYPLN  EQU   NTRY                                                     10307000
NTRYPAS  EQU   NTRY+1                                                   10308000
NTRYPOS  EQU   NTRY+9                                                   10309000
NTRYFLG  EQU   NTRY+10                                                  10310000
NTRYFUQ  EQU   NTRYFLG                                                  10311000
NTRYMLN  EQU   NTRY+11                                                  10312000
NTRYMEM  EQU   NTRY+12                                                  10313000
NTRYLEN  EQU   NTRY+20                                                  10314000
NTRYVAL  EQU   NTRY+21                                                  10315000
CATLG    EQU   0                                                        10316000
CATLGPLN EQU   CATLG                                                    10317000
CATLGPAS EQU   CATLG+1                                                  10318000
CATLGFLG EQU   CATLG+10                                                 10319000
CATLGLEN EQU   CATLG+20                                                 10320000
CATLGVAL EQU   CATLG+21                                                 10321000
CATDN    EQU   0                                                        10322000
NEWNM    EQU   0                                                        10323000
NEWNMPOS EQU   NEWNM+9                                                  10324000
NEWNMFLG EQU   NEWNM+10                                                 10325000
NEWNMFUQ EQU   NEWNMFLG                                                 10326000
NEWNMMEM EQU   NEWNM+12                                                 10327000
NEWNMLEN EQU   NEWNM+20                                                 10328000
NEWNMVAL EQU   NEWNM+21                                                 10329000
INDD     EQU   0                                                        10330000
INDDVAL  EQU   INDD+1                                                   10331000
MASTR    EQU   0                                                        10332000
MASTRVAL EQU   MASTR+1                                                  10333000
CNTVL    EQU   0                                                        10334000
CNTVLVAL EQU   CNTVL+1                                                  10335000
UPDAT    EQU   0                                                        10336000
UPDATVAL EQU   UPDAT+1                                                  10337000
READ     EQU   0                                                        10338000
READVAL  EQU   READ+1                                                   10339000
CODNM    EQU   0                                                        10340000
CODNMVAL EQU   CODNM+1                                                  10341000
ATTP     EQU   0                                                        10342000
ATTPVAL  EQU   ATTP                                                     10343000
AUTH     EQU   0                                                        10344000
USVR     EQU   0                                                        10345000
USVRVAL  EQU   USVR+1                                                   10346000
USAR     EQU   0                                                        10347000
USARLEN  EQU   USAR                                                     10348000
USARVAL  EQU   USAR+1                                                   10349000
TO       EQU   0                                                        10350000
TOVAL    EQU   TO                                                       10351000
FOR      EQU   0                                                        10352000
FORVAL   EQU   FOR                                                      10353000
OWNER    EQU   0                                                        10354000
OWNERVAL EQU   OWNER+1                                                  10355000
ERASE    EQU   0                                                        10356000
NERAS    EQU   0                                                        10357000
SHARE    EQU   0                                                        10358000
SHAR1    EQU   0                                                        10359000
SHAR1VAL EQU   SHAR1                                                    10360000
SHAR2    EQU   0                                                        10361000
SHAR2VAL EQU   SHAR2                                                    10362000
NMSTR    EQU   0                                                        10363000
NCNTV    EQU   0                                                        10364000
NUPDT    EQU   0                                                        10365000
NREAD    EQU   0                                                        10366000
NOWNR    EQU   0                                                        10367000
NCDNM    EQU   0                                                        10368000
NRETN    EQU   0                                                        10369000
NAUTH    EQU   0                                                        10370000
NMDNM    EQU   0                                                        10371000
NSTRG    EQU   0                                                        10372000
NEEXT    EQU   0                                                        10373000
FSPAC    EQU   0                                                        10374000
FSPCI    EQU   0                                                        10375000
FSPCIVAL EQU   FSPCI                                                    10376000
FSPCA    EQU   0                                                        10377000
FSPCAVAL EQU   FSPCA                                                    10378000
WRTCK    EQU   0                                                        10379000
NWTCK    EQU   0                                                        10380000
BUFSZ    EQU   0                                                        10381000
BUFSZVAL EQU   BUFSZ                                                    10382000
ADDVL    EQU   0                                                        10383000
ADDVLCNT EQU   ADDVL                                                    10384000
@NM00037 EQU   ADDVL+2                                                  10385000
ADDVLVAL EQU   @NM00037+1                                               10386000
REMVL    EQU   0                                                        10387000
REMVLCNT EQU   REMVL                                                    10388000
@NM00038 EQU   REMVL+2                                                  10389000
REMVLVAL EQU   @NM00038+1                                               10390000
INHIB    EQU   0                                                        10391000
UNHIB    EQU   0                                                        10392000
GDGEM    EQU   0                                                        10393000
GDGNE    EQU   0                                                        10394000
GDGSC    EQU   0                                                        10395000
GDGNS    EQU   0                                                        10396000
EEXT     EQU   0                                                        10397000
EEXTVAL  EQU   EEXT+1                                                   10398000
KEY      EQU   0                                                        10399000
KEYLN    EQU   0                                                        10400000
KEYLNVAL EQU   KEYLN                                                    10401000
KEYPS    EQU   0                                                        10402000
KEYPSVAL EQU   KEYPS                                                    10403000
RECSZ    EQU   0                                                        10404000
AREC     EQU   0                                                        10405000
ARECVAL  EQU   AREC                                                     10406000
MREC     EQU   0                                                        10407000
MRECVAL  EQU   MREC                                                     10408000
UNQK     EQU   0                                                        10409000
NUNQK    EQU   0                                                        10410000
UPG      EQU   0                                                        10411000
NUPG     EQU   0                                                        10412000
UPD      EQU   0                                                        10413000
NUPD     EQU   0                                                        10414000
STAGE    EQU   0                                                        10415000
BIND     EQU   0                                                        10416000
CYLF     EQU   0                                                        10417000
NSTGW    EQU   0                                                        10418000
STGW     EQU   0                                                        10419000
CTGPL    EQU   0                                                        10420000
CTGOPTN1 EQU   CTGPL                                                    10421000
CTGBYPSS EQU   CTGOPTN1                                                 10422000
CTGMAST  EQU   CTGOPTN1                                                 10423000
CTGNAME  EQU   CTGOPTN1                                                 10424000
CTGCNAME EQU   CTGOPTN1                                                 10425000
CTGOPTN2 EQU   CTGPL+1                                                  10426000
CTGEXT   EQU   CTGOPTN2                                                 10427000
CTGERASE EQU   CTGOPTN2                                                 10428000
CTGSMF   EQU   CTGERASE                                                 10429000
CTGREL   EQU   CTGSMF                                                   10430000
CTGPURG  EQU   CTGOPTN2                                                 10431000
CTGVMNT  EQU   CTGPURG                                                  10432000
CTGOPTN3 EQU   CTGPL+2                                                  10433000
CTGFUNC  EQU   CTGOPTN3                                                 10434000
CTGNUM   EQU   CTGOPTN3                                                 10435000
CTGAM0   EQU   CTGOPTN3                                                 10436000
CTGOPTN4 EQU   CTGPL+3                                                  10437000
CTGENT   EQU   CTGPL+4                                                  10438000
CTGFVT   EQU   CTGENT                                                   10439000
CTGCAT   EQU   CTGPL+8                                                  10440000
CTGWKA   EQU   CTGPL+12                                                 10441000
CTGDSORG EQU   CTGPL+16                                                 10442000
CTGOPTNS EQU   CTGDSORG                                                 10443000
CTGNOFLD EQU   CTGPL+19                                                 10444000
CTGDDNM  EQU   CTGPL+20                                                 10445000
CTGNEWNM EQU   CTGDDNM                                                  10446000
CTGFBFLG EQU   CTGNEWNM+2                                               10447000
CTGJSCB  EQU   CTGPL+24                                                 10448000
CTGPSWD  EQU   CTGJSCB                                                  10449000
CTGFIELD EQU   CTGPL+28                                                 10450000
CTGFL    EQU   0                                                        10451000
CTGFLDNO EQU   CTGFL                                                    10452000
CTGFLDCD EQU   CTGFL+1                                                  10453000
CTGFLDRE EQU   CTGFL+3                                                  10454000
CTGFLDNM EQU   CTGFL+8                                                  10455000
CTGFLCHN EQU   CTGFL+12                                                 10456000
CTGFLDAT EQU   CTGFL+16                                                 10457000
CTGFLNG  EQU   CTGFLDAT                                                 10458000
CTGFLPT  EQU   CTGFLDAT+4                                               10459000
IDAAMDSB EQU   0                                                        10460000
AMDATTR  EQU   IDAAMDSB+1                                               10461000
AMDWCK   EQU   AMDATTR                                                  10462000
AMDRRDS  EQU   AMDATTR                                                  10463000
AMDSPAN  EQU   AMDATTR                                                  10464000
AMDNEST  EQU   IDAAMDSB+4                                               10465000
AMDAXRKP EQU   AMDNEST                                                  10466000
AMDRKP   EQU   IDAAMDSB+6                                               10467000
AMDKEYLN EQU   IDAAMDSB+8                                               10468000
AMDPCTCA EQU   IDAAMDSB+10                                              10469000
AMDPCTCI EQU   IDAAMDSB+11                                              10470000
AMDCIPCA EQU   IDAAMDSB+12                                              10471000
AMDFSCA  EQU   IDAAMDSB+14                                              10472000
AMDFSCI  EQU   IDAAMDSB+16                                              10473000
AMDCINV  EQU   IDAAMDSB+20                                              10474000
AMDLRECL EQU   IDAAMDSB+24                                              10475000
AMDHLRBA EQU   IDAAMDSB+28                                              10476000
AMDSSRBA EQU   IDAAMDSB+32                                              10477000
AMDATTR3 EQU   IDAAMDSB+40                                              10478000
AMDUNQ   EQU   AMDATTR3                                                 10479000
AMDFAULT EQU   AMDATTR3                                                 10480000
AMDBIND  EQU   AMDATTR3                                                 10481000
AMDWAIT  EQU   AMDATTR3                                                 10482000
AMDSTAT  EQU   IDAAMDSB+48                                              10483000
CTGFV    EQU   0                                                        10484000
CTGFVTYP EQU   CTGFV                                                    10485000
CTGFVPRO EQU   CTGFV+1                                                  10486000
CTGFVAVL EQU   CTGFVPRO                                                 10487000
CTGFVRVL EQU   CTGFVPRO                                                 10488000
CTGFVIND EQU   CTGFV+16                                                 10489000
CTGFVENT EQU   CTGFV+20                                                 10490000
CTGFVSTY EQU   CTGFV+24                                                 10491000
CTGFVOWN EQU   CTGFV+28                                                 10492000
CTGFVEXP EQU   CTGFV+32                                                 10493000
CTGFVVLT EQU   CTGFV+40                                                 10494000
CTGFVSPC EQU   CTGFV+52                                                 10495000
CTGFVAMD EQU   CTGFV+56                                                 10496000
CTGFVATR EQU   CTGFV+60                                                 10497000
CTGFVBUF EQU   CTGFV+64                                                 10498000
CTGFVLRS EQU   CTGFV+68                                                 10499000
CTGFVLMT EQU   CTGFV+72                                                 10500000
CTGFVEXT EQU   CTGFVLMT                                                 10501000
CTGFVGAT EQU   CTGFV+76                                                 10502000
CTGFVUPG EQU   CTGFVGAT                                                 10503000
NULLPARM EQU   0                                                        10504000
ALCTGPRM EQU   0                                                        10505000
ALCPLID  EQU   ALCTGPRM                                                 10506000
ALCTGPL  EQU   ALCTGPRM+8                                               10507000
ALCTGFLD EQU   ALCTGPRM+36                                              10508000
ALFVTID  EQU   ALCTGPRM+76                                              10509000
ALCTGFVT EQU   ALCTGPRM+80                                              10510000
ALFPLLST EQU   ALCTGPRM+180                                             10511000
ALTYP    EQU   ALFPLLST                                                 10512000
ALFPLTYP EQU   ALFPLLST+4                                               10513000
ALACB    EQU   ALFPLLST+28                                              10514000
ALFPLACB EQU   ALFPLLST+32                                              10515000
ALNAM    EQU   ALFPLLST+56                                              10516000
ALFPLNAM EQU   ALFPLLST+60                                              10517000
ALRBA    EQU   ALFPLLST+84                                              10518000
ALFPLRBA EQU   ALFPLLST+88                                              10519000
ALCRA    EQU   ALFPLLST+112                                             10520000
ALFPLCRA EQU   ALFPLLST+116                                             10521000
ALPSW    EQU   ALFPLLST+140                                             10522000
ALFPLPSW EQU   ALFPLLST+144                                             10523000
ALDAT    EQU   ALFPLLST+168                                             10524000
ALFPLDAT EQU   ALFPLLST+172                                             10525000
ALAMD    EQU   ALFPLLST+196                                             10526000
ALFPLAMD EQU   ALFPLLST+200                                             10527000
ALRGA    EQU   ALFPLLST+224                                             10528000
ALFPLRGA EQU   ALFPLLST+228                                             10529000
ALGDG    EQU   ALFPLLST+252                                             10530000
ALFPLGDG EQU   ALFPLLST+256                                             10531000
ALFPLEXP EQU   ALFPLLST+284                                             10532000
ALOWN    EQU   ALFPLLST+308                                             10533000
ALFPLOWN EQU   ALFPLLST+312                                             10534000
ALBUF    EQU   ALFPLLST+336                                             10535000
ALFPLBUF EQU   ALFPLLST+340                                             10536000
ALEEX    EQU   ALFPLLST+364                                             10537000
ALFPLEEX EQU   ALFPLLST+368                                             10538000
ALLRC    EQU   ALFPLLST+392                                             10539000
ALFPLLRC EQU   ALFPLLST+396                                             10540000
ALNAMTST EQU   ALFPLLST+420                                             10541000
ALFPLTST EQU   ALFPLLST+424                                             10542000
ALWKAREA EQU   ALCTGPRM+628                                             10543000
LCETYPVL EQU   0                                                        10544000
LCACBVAL EQU   0                                                        10545000
LCNAMEDS EQU   0                                                        10546000
LCNAMID  EQU   LCNAMEDS                                                 10547000
LCNAMCI  EQU   LCNAMEDS+1                                               10548000
LCHURBA  EQU   0                                                        10549000
LCCRAVOL EQU   0                                                        10550000
LCPSWALL EQU   0                                                        10551000
LCPSWFXD EQU   LCPSWALL                                                 10552000
LCMSTRPW EQU   LCPSWFXD                                                 10553000
LCCINTPW EQU   LCPSWFXD+8                                               10554000
LCUPDTPW EQU   LCPSWFXD+16                                              10555000
LCREADPW EQU   LCPSWFXD+24                                              10556000
LCPWPRMT EQU   LCPSWFXD+32                                              10557000
LCPWATTP EQU   LCPSWFXD+40                                              10558000
LCPWDATP EQU   LCPWATTP                                                 10559000
LCVRMDUL EQU   LCPSWFXD+42                                              10560000
LCARECLN EQU   LCPSWFXD+50                                              10561000
LCUAREC  EQU   LCPSWALL+52                                              10562000
LCDSATR  EQU   0                                                        10563000
@NM00073 EQU   LCDSATR                                                  10564000
LCERASE  EQU   @NM00073                                                 10565000
LCINHIB  EQU   @NM00073                                                 10566000
@NM00074 EQU   LCDSATR+1                                                10567000
SHAROPT1 EQU   @NM00074                                                 10568000
SHAROPT2 EQU   @NM00074                                                 10569000
LCRGATTR EQU   0                                                        10570000
@NM00075 EQU   LCRGATTR                                                 10571000
LCGDGATR EQU   0                                                        10572000
LCEMPTY  EQU   LCGDGATR                                                 10573000
LCSCRTCH EQU   LCGDGATR                                                 10574000
VLISTLEN EQU   0                                                        10575000
GENLIST  EQU   0                                                        10576000
GENNUM   EQU   GENLIST                                                  10577000
GENENTRY EQU   GENLIST+4                                                10578000
ENTTYP   EQU   GENENTRY                                                 10579000
ENTVAL   EQU   GENENTRY+1                                               10580000
LOCATWKA EQU   0                                                        10581000
MYLENGTH EQU   LOCATWKA                                                 10582000
REQDLEN  EQU   LOCATWKA+2                                               10583000
ALVLIST  EQU   0                                                        10584000
ALVLSTLN EQU   ALVLIST                                                  10585000
@NM00082 EQU   ALVLIST+2                                                10586000
ALVLSTCD EQU   @NM00082                                                 10587000
ALVOLUME EQU   @NM00082+2                                               10588000
NULLPSWD EQU   0                                                        10589000
OPNDSVAL EQU   0                                                        10590000
IXCTGPRM EQU   0                                                        10591000
IXCPLID  EQU   IXCTGPRM                                                 10592000
IXFVTID  EQU   IXCTGPRM+68                                              10593000
IXCTGFVT EQU   IXCTGPRM+72                                              10594000
IXAMD    EQU   IXCTGPRM+172                                             10595000
IXFPLAMD EQU   IXCTGPRM+176                                             10596000
IXWKAREA EQU   IXCTGPRM+200                                             10597000
FVTVLIST EQU   0                                                        10598000
FVTVLEN  EQU   FVTVLIST                                                 10599000
@NM00090 EQU   FVTVLIST+2                                               10600000
FVTVSER  EQU   @NM00090+2                                               10601000
ALCVLIST EQU   0                                                        10602000
ALC#ENT  EQU   ALCVLIST                                                 10603000
@NM00092 EQU   ALCVLIST+2                                               10604000
ALCVLEN  EQU   @NM00092                                                 10605000
ALCVSER  EQU   @NM00092+2                                               10606000
AMSTP041 EQU   0                                                        10607000
AMSTP042 EQU   0                                                        10608000
AMSTP043 EQU   0                                                        10609000
AMSTP044 EQU   0                                                        10610000
CAT      EQU   0                                                        10611000
DMPTRM   EQU   0                                                        10612000
DSNAME   EQU   0                                                        10613000
IDCIOCO0 EQU   0                                                        10614000
IDCIOGT0 EQU   0                                                        10615000
IDCIOIT0 EQU   0                                                        10616000
IDCIOPO0 EQU   0                                                        10617000
IDCIOPT0 EQU   0                                                        10618000
IDCIOSI0 EQU   0                                                        10619000
IDCIOTM0 EQU   0                                                        10620000
IDCIOVY0 EQU   0                                                        10621000
IDCIO050 EQU   0                                                        10622000
IDCSACL0 EQU   0                                                        10623000
IDCSADE0 EQU   0                                                        10624000
IDCSADQ0 EQU   0                                                        10625000
IDCSAFS0 EQU   0                                                        10626000
IDCSAGS0 EQU   0                                                        10627000
IDCSAID0 EQU   0                                                        10628000
IDCSALC0 EQU   0                                                        10629000
IDCSALD0 EQU   0                                                        10630000
IDCSALK0 EQU   0                                                        10631000
IDCSANQ0 EQU   0                                                        10632000
IDCSAPR0 EQU   0                                                        10633000
IDCSAPT0 EQU   0                                                        10634000
IDCSARC0 EQU   0                                                        10635000
IDCSARV0 EQU   0                                                        10636000
IDCSASC0 EQU   0                                                        10637000
IDCSASI0 EQU   0                                                        10638000
IDCSASN0 EQU   0                                                        10639000
IDCSASS0 EQU   0                                                        10640000
IDCSAST0 EQU   0                                                        10641000
IDCSAUC0 EQU   0                                                        10642000
IDCSAWO0 EQU   0                                                        10643000
IDCSA060 EQU   0                                                        10644000
IDCST010 EQU   0                                                        10645000
LISTTEST EQU   0                                                        10646000
NEWERID1 EQU   5                                                        10647000
NULLF    EQU   0                                                        10648000
GDTTBL   EQU   0                                                        10649000
GDTTR1   EQU   GDTTBL+8                                                 10650000
GDTTR2   EQU   GDTTBL+12                                                10651000
GDTDBG   EQU   GDTTBL+40                                                10652000
GDTSTC   EQU   GDTTBL+44                                                10653000
GDTPRT   EQU   GDTTBL+48                                                10654000
GDTESS   EQU   GDTTBL+52                                                10655000
GDTESA   EQU   GDTTBL+56                                                10656000
GDTRST   EQU   GDTTBL+60                                                10657000
GDTRES   EQU   GDTTBL+64                                                10658000
GDTCAL   EQU   GDTTBL+68                                                10659000
GDTGSP   EQU   GDTTBL+72                                                10660000
GDTFSP   EQU   GDTTBL+76                                                10661000
GDTGPL   EQU   GDTTBL+80                                                10662000
GDTFPL   EQU   GDTTBL+84                                                10663000
GDTLOD   EQU   GDTTBL+88                                                10664000
GDTDEL   EQU   GDTTBL+92                                                10665000
GDTPRL   EQU   GDTTBL+96                                                10666000
GDTEPL   EQU   GDTTBL+100                                               10667000
GDTTIM   EQU   GDTTBL+104                                               10668000
GDTIIO   EQU   GDTTBL+108                                               10669000
GDTTIO   EQU   GDTTBL+112                                               10670000
GDTOPN   EQU   GDTTBL+124                                               10671000
GDTCLS   EQU   GDTTBL+128                                               10672000
GDTGET   EQU   GDTTBL+132                                               10673000
GDTPUT   EQU   GDTTBL+136                                               10674000
GDTPOS   EQU   GDTTBL+140                                               10675000
GDTCPY   EQU   GDTTBL+144                                               10676000
GDTCAT   EQU   GDTTBL+148                                               10677000
GDTSNP   EQU   GDTTBL+164                                               10678000
GDTVFY   EQU   GDTTBL+172                                               10679000
GDTECT   EQU   GDTTBL+188                                               10680000
GDTUID   EQU   GDTTBL+192                                               10681000
GDTPMT   EQU   GDTTBL+196                                               10682000
GDTCIR   EQU   GDTTBL+200                                               10683000
GDTLNK   EQU   GDTTBL+204                                               10684000
GDTALC   EQU   GDTTBL+208                                               10685000
GDTDLC   EQU   GDTTBL+212                                               10686000
GDTQAL   EQU   GDTTBL+216                                               10687000
GDTSTW   EQU   GDTTBL+220                                               10688000
GDTSSC   EQU   GDTTBL+224                                               10689000
GDTENQ   EQU   GDTTBL+228                                               10690000
GDTRSV   EQU   GDTTBL+232                                               10691000
GDTDEQ   EQU   GDTTBL+236                                               10692000
GDTSFO   EQU   GDTTBL+240                                               10693000
GDTWTO   EQU   GDTTBL+244                                               10694000
GDTSCR   EQU   GDTTBL+248                                               10695000
GDTUNT   EQU   GDTTBL+252                                               10696000
GDTRCT   EQU   GDTTBL+256                                               10697000
GDTIFO   EQU   GDTTBL+260                                               10698000
GDTEXP   EQU   GDTTBL+264                                               10699000
GDTSTA   EQU   GDTTBL+268                                               10700000
GDTERR   EQU   GDTTBL+272                                               10701000
GDTUNC   EQU   GDTTBL+276                                               10702000
GDTLOC   EQU   GDTTBL+280                                               10703000
FDTTBL   EQU   0                                                        10704000
FDTPTR   EQU   FDTTBL+8                                                 10705000
LASTCC   EQU   0                                                        10706000
ACATACB  EQU   0                                                        10707000
ETYPE    EQU   0                                                        10708000
REQTYPE  EQU   0                                                        10709000
DALVLPTR EQU   0                                                        10710000
DALDNMPT EQU   0                                                        10711000
DALINDEX EQU   0                                                        10712000
@NM00044 EQU   CTGDDNM                                                  10713000
CTGPROB  EQU   @NM00044                                                 10714000
CTGREASN EQU   CTGPROB+2                                                10715000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    10716000
CTGREAS2 EQU   CTGREASN+1                                               10717000
CTGREAS1 EQU   CTGREASN                                                 10718000
CTGMODID EQU   CTGPROB                                                  10719000
FDTVERB  EQU   FDTTBL                                                   10720000
GDTPSB   EQU   GDTTBL+184                                               10721000
GDTUPT   EQU   GDTTBL+180                                               10722000
GDTCMB   EQU   GDTTBL+176                                               10723000
GDTSPR   EQU   GDTTBL+168                                               10724000
@NM00001 EQU   GDTTBL+160                                               10725000
GDTABH   EQU   GDTTBL+156                                               10726000
GDTABT   EQU   GDTTBL+152                                               10727000
GDTTOH   EQU   GDTTBL+120                                               10728000
GDTRIP   EQU   GDTTBL+116                                               10729000
GDTIOH   EQU   GDTTBL+36                                                10730000
GDTSAH   EQU   GDTTBL+32                                                10731000
GDTTPH   EQU   GDTTBL+28                                                10732000
GDTRIH   EQU   GDTTBL+24                                                10733000
GDTSTH   EQU   GDTTBL+20                                                10734000
GDTDBH   EQU   GDTTBL+16                                                10735000
GDTPRM   EQU   GDTTBL+4                                                 10736000
GDTHDR   EQU   GDTTBL                                                   10737000
@NM00091 EQU   @NM00090                                                 10738000
IXCTGPL  EQU   IXCTGPRM+8                                               10739000
@NM00083 EQU   @NM00082+1                                               10740000
@NM00081 EQU   LOCATWKA+4                                               10741000
@NM00079 EQU   LCGDGATR                                                 10742000
@NM00076 EQU   @NM00075                                                 10743000
LCUPGUPD EQU   @NM00075                                                 10744000
LCRVBL   EQU   @NM00073                                                 10745000
LCRUS    EQU   @NM00073                                                 10746000
LCUNIQ   EQU   @NM00073                                                 10747000
LCSPEED  EQU   @NM00073                                                 10748000
@NM00072 EQU   ALFPLLST+440                                             10749000
@NM00071 EQU   ALFPLLST+412                                             10750000
@NM00070 EQU   ALFPLLST+384                                             10751000
@NM00069 EQU   ALFPLLST+356                                             10752000
@NM00068 EQU   ALFPLLST+328                                             10753000
@NM00067 EQU   ALFPLLST+300                                             10754000
ALEXP    EQU   ALFPLLST+280                                             10755000
@NM00066 EQU   ALFPLLST+272                                             10756000
@NM00065 EQU   ALFPLLST+244                                             10757000
@NM00064 EQU   ALFPLLST+216                                             10758000
@NM00063 EQU   ALFPLLST+188                                             10759000
@NM00062 EQU   ALFPLLST+160                                             10760000
@NM00061 EQU   ALFPLLST+132                                             10761000
@NM00060 EQU   ALFPLLST+104                                             10762000
@NM00059 EQU   ALFPLLST+76                                              10763000
@NM00058 EQU   ALFPLLST+48                                              10764000
@NM00057 EQU   ALFPLLST+20                                              10765000
@NM00056 EQU   ALCTGPRM+172                                             10766000
CTGFVWKA EQU   CTGFV+88                                                 10767000
CTGFVPWD EQU   CTGFV+84                                                 10768000
CTGFVNAM EQU   CTGFV+80                                                 10769000
CTGFVFSN EQU   CTGFVAMD                                                 10770000
CTGFVTTR EQU   CTGFVSPC                                                 10771000
CTGFVDVT EQU   CTGFV+48                                                 10772000
CTGFVRNG EQU   CTGFV+44                                                 10773000
CTGFVCRE EQU   CTGFV+36                                                 10774000
CTGFVVCH EQU   CTGFV+12                                                 10775000
CTGFVICH EQU   CTGFV+8                                                  10776000
CTGFVDCH EQU   CTGFV+4                                                  10777000
@NM00049 EQU   CTGFV+3                                                  10778000
CTGFVELM EQU   CTGFV+2                                                  10779000
@NM00048 EQU   CTGFVPRO                                                 10780000
CTGFVDRC EQU   CTGFVPRO                                                 10781000
CTGFVNDC EQU   CTGFVPRO                                                 10782000
AMDEXCP  EQU   AMDSTAT+44                                               10783000
AMDNCAS  EQU   AMDSTAT+40                                               10784000
AMDNCIS  EQU   AMDSTAT+36                                               10785000
AMDASPA  EQU   AMDSTAT+32                                               10786000
AMDRETR  EQU   AMDSTAT+28                                               10787000
AMDUPR   EQU   AMDSTAT+24                                               10788000
AMDIREC  EQU   AMDSTAT+20                                               10789000
AMDDELR  EQU   AMDSTAT+16                                               10790000
AMDNLR   EQU   AMDSTAT+12                                               10791000
AMDNEXT  EQU   AMDSTAT+10                                               10792000
AMDNIL   EQU   AMDSTAT+8                                                10793000
AMDSTSP  EQU   AMDSTAT                                                  10794000
@NM00047 EQU   IDAAMDSB+41                                              10795000
@NM00046 EQU   AMDATTR3                                                 10796000
AMDLM    EQU   AMDATTR3                                                 10797000
AMDPARDB EQU   IDAAMDSB+36                                              10798000
AMDMAXRR EQU   AMDSSRBA                                                 10799000
AMDNSLOT EQU   AMDHLRBA                                                 10800000
AMDLEN   EQU   IDAAMDSB+2                                               10801000
AMDRANGE EQU   AMDATTR                                                  10802000
AMDORDER EQU   AMDATTR                                                  10803000
AMDREPL  EQU   AMDATTR                                                  10804000
AMDSDT   EQU   AMDATTR                                                  10805000
AMDDST   EQU   AMDATTR                                                  10806000
AMDSBID  EQU   IDAAMDSB                                                 10807000
CTGFLDWA EQU   CTGFL+4                                                  10808000
CTGFLDTS EQU   CTGFLDRE                                                 10809000
@NM00045 EQU   CTGFLDRE                                                 10810000
CTGFLDGC EQU   CTGFL+2                                                  10811000
@NM00043 EQU   CTGFBFLG                                                 10812000
CTGNGDSN EQU   CTGFBFLG                                                 10813000
CTGGDGB  EQU   CTGFBFLG                                                 10814000
CTGKEEP  EQU   CTGFBFLG                                                 10815000
CTGPAR   EQU   CTGFBFLG                                                 10816000
CTGFDBK  EQU   CTGNEWNM                                                 10817000
CTGTYPE  EQU   CTGPL+18                                                 10818000
@NM00042 EQU   CTGDSORG                                                 10819000
CTGCVOL  EQU   CTGCAT                                                   10820000
@NM00041 EQU   CTGOPTN4                                                 10821000
CTGTIOT  EQU   CTGOPTN4                                                 10822000
CTGBYPMT EQU   CTGOPTN4                                                 10823000
CTGCOIN  EQU   CTGOPTN4                                                 10824000
@NM00040 EQU   CTGOPTN4                                                 10825000
CTGDOCAT EQU   CTGOPTN4                                                 10826000
CTGLBASE EQU   CTGOPTN4                                                 10827000
CTGSRH   EQU   CTGOPTN3                                                 10828000
CTGGDGL  EQU   CTGOPTN3                                                 10829000
CTGSUPLT EQU   CTGOPTN3                                                 10830000
@NM00039 EQU   CTGOPTN2                                                 10831000
CTGSCR   EQU   CTGOPTN2                                                 10832000
CTGOVRID EQU   CTGOPTN2                                                 10833000
CTGDISC  EQU   CTGOPTN2                                                 10834000
CTGGTNXT EQU   CTGOPTN2                                                 10835000
CTGRCATN EQU   CTGVMNT                                                  10836000
CTGGTALL EQU   CTGREL                                                   10837000
CTGNSVS  EQU   CTGEXT                                                   10838000
CTGGENLD EQU   CTGOPTN1                                                 10839000
CTGREAD  EQU   CTGOPTN1                                                 10840000
CTGUPD   EQU   CTGOPTN1                                                 10841000
CTGCI    EQU   CTGOPTN1                                                 10842000
EEXTLEN  EQU   EEXT                                                     10843000
REMVLLEN EQU   @NM00038                                                 10844000
ADDVLLEN EQU   @NM00037                                                 10845000
OWNERLEN EQU   OWNER                                                    10846000
USVRLEN  EQU   USVR                                                     10847000
CODNMLEN EQU   CODNM                                                    10848000
READLEN  EQU   READ                                                     10849000
UPDATLEN EQU   UPDAT                                                    10850000
CNTVLLEN EQU   CNTVL                                                    10851000
MASTRLEN EQU   MASTR                                                    10852000
INDDLEN  EQU   INDD                                                     10853000
NEWNMMLN EQU   NEWNM+11                                                 10854000
NEWNMPAS EQU   NEWNM+1                                                  10855000
NEWNMPLN EQU   NEWNM                                                    10856000
CATDNVAL EQU   CATDN+1                                                  10857000
CATDNLEN EQU   CATDN                                                    10858000
CATLGMEM EQU   CATLG+12                                                 10859000
CATLGMLN EQU   CATLG+11                                                 10860000
CATLGFUQ EQU   CATLGFLG                                                 10861000
CATLGPOS EQU   CATLG+9                                                  10862000
@NM00036 EQU   DMPARY+15                                                10863000
DMPARYTP EQU   DMPARY+14                                                10864000
DMPARYEX EQU   DMPARY+12                                                10865000
DMPARYIC EQU   DMPARY+10                                                10866000
DMPARYSZ EQU   DMPARY+8                                                 10867000
DMPARYNM EQU   DMPARY                                                   10868000
@NM00035 EQU   DMPITM+15                                                10869000
DMPITMTP EQU   DMPITM+14                                                10870000
DMPITMLN EQU   DMPITM+12                                                10871000
DMPITMPT EQU   DMPITM+8                                                 10872000
DMPITMNM EQU   DMPITM                                                   10873000
@NM00034 EQU   ERCNVTAB+24                                              10874000
@NM00033 EQU   ERCNVTAB+4                                               10875000
@NM00032 EQU   ERCNVTAB+3                                               10876000
@NM00031 EQU   EROSOPER                                                 10877000
EROSUCDX EQU   EROSOPER                                                 10878000
EROSCATL EQU   EROSOPER                                                 10879000
@NM00030 EQU   EROPER                                                   10880000
ERCATDL  EQU   EROPER                                                   10881000
ERCATDE  EQU   EROPER                                                   10882000
@NM00029 EQU   ERTYPE                                                   10883000
EROSCAT  EQU   ERTYPE                                                   10884000
@NM00028 EQU   FMTCNVF+1                                                10885000
FMTAR    EQU   FMTCNVF+1                                                10886000
FMTBS    EQU   FMTCNVF+1                                                10887000
FMTSS    EQU   FMTCNVF+1                                                10888000
FMTAL    EQU   FMTCNVF+1                                                10889000
FMTZS    EQU   FMTCNVF+1                                                10890000
@NM00027 EQU   FMTCNVF                                                  10891000
FMTPU    EQU   FMTCNVF                                                  10892000
FMTBD    EQU   FMTCNVF                                                  10893000
FMTBHD   EQU   FMTCNVF                                                  10894000
FMTBHA   EQU   FMTCNVF                                                  10895000
FMTBH    EQU   FMTCNVF                                                  10896000
FMTOLEN  EQU   FMTLIST+8                                                10897000
FMTRIO   EQU   FMTOCOL                                                  10898000
FMTSPT   EQU   FMTSTO                                                   10899000
FMTSTL   EQU   FMTILEN                                                  10900000
@NM00026 EQU   FMTFLGS+1                                                10901000
FMTHDF   EQU   FMTFLGS                                                  10902000
FMTDFF   EQU   FMTFLGS                                                  10903000
FMTSTF   EQU   FMTFLGS                                                  10904000
FMTREPF  EQU   FMTFLGS                                                  10905000
FMTBDF   EQU   FMTFLGS                                                  10906000
FMTIDF   EQU   FMTFLGS                                                  10907000
FMTSCF   EQU   FMTFLGS                                                  10908000
FMTEOLF  EQU   FMTFLGS                                                  10909000
DARGDTM  EQU   DARGARY+4                                                10910000
DARGREP  EQU   DARGINS                                                  10911000
@NM00025 EQU   DARGFLGS                                                 10912000
DARGFULL EQU   DARGFLGS                                                 10913000
DARGIND  EQU   DARGLIST+18                                              10914000
DARGRETL EQU   DARGLIST+16                                              10915000
DARGRETP EQU   DARGLIST+4                                               10916000
UVOLVOL  EQU   UVOLENT+4                                                10917000
UVOLDEV  EQU   UVOLENT                                                  10918000
UVOLCNT  EQU   UVOLLIST                                                 10919000
@NM00024 EQU   IOINFOPT                                                 10920000
IOINFTMS EQU   IOINFOPT                                                 10921000
IOINFSUP EQU   IOINFOPT                                                 10922000
IOINFDSN EQU   IOINFOPT                                                 10923000
IOINFVOL EQU   IOINFOPT                                                 10924000
IOINFDVT EQU   IOINFOPT                                                 10925000
OPNVOL   EQU   OPNAGL+44                                                10926000
@NM00023 EQU   OPNAGL+43                                                10927000
@NM00022 EQU   OPNOPT2                                                  10928000
OPNOPTJM EQU   OPNOPT2                                                  10929000
OPNOPTNM EQU   OPNOPT2                                                  10930000
OPNOPTAS EQU   OPNOPT2                                                  10931000
@NM00021 EQU   OPNDSO                                                   10932000
OPNDSOIS EQU   OPNDSO                                                   10933000
OPNDSOPS EQU   OPNDSO                                                   10934000
OPNDSOAM EQU   OPNDSO                                                   10935000
OPNKYL   EQU   OPNAGL+40                                                10936000
OPNBLK   EQU   OPNAGL+36                                                10937000
OPNREC   EQU   OPNAGL+32                                                10938000
OPNDEVIX EQU   OPNDEV+4                                                 10939000
OPNDEVDT EQU   OPNDEV                                                   10940000
OPNCBP   EQU   OPNAGL+20                                                10941000
OPNMODRP EQU   OPNMOD                                                   10942000
OPNMODUB EQU   OPNMOD                                                   10943000
OPNMODRS EQU   OPNMOD                                                   10944000
OPNMODAX EQU   OPNMOD                                                   10945000
OPNMODRR EQU   OPNMOD                                                   10946000
OPNMODRC EQU   OPNMOD                                                   10947000
OPNMODAC EQU   OPNMOD                                                   10948000
OPNMODPD EQU   OPNMOD                                                   10949000
@NM00020 EQU   OPNTYP                                                   10950000
OPNTYPRV EQU   OPNTYP                                                   10951000
OPNTYPEX EQU   OPNTYP                                                   10952000
OPNTYPRA EQU   OPNTYP                                                   10953000
OPNTYPXM EQU   OPNTYP                                                   10954000
OPNTYPCI EQU   OPNTYP                                                   10955000
OPNTYPSO EQU   OPNTYP                                                   10956000
OPNTYPSI EQU   OPNTYP                                                   10957000
@NM00019 EQU   OPNRFM                                                   10958000
OPNRFMBK EQU   OPNRFM                                                   10959000
OPNRFMSF EQU   OPNRFM                                                   10960000
OPNRFMUN EQU   OPNRFM                                                   10961000
OPNRFMVR EQU   OPNRFM                                                   10962000
OPNRFMFX EQU   OPNRFM                                                   10963000
OPNOPTSK EQU   OPNOPT                                                   10964000
OPNOPTDR EQU   OPNOPT                                                   10965000
OPNOPTCR EQU   OPNOPT                                                   10966000
OPNOPTKS EQU   OPNOPT                                                   10967000
OPNOPTUP EQU   OPNOPT                                                   10968000
OPNOPTIN EQU   OPNOPT                                                   10969000
IOCEXT   EQU   IOCSTR+64                                                10970000
IOCREL   EQU   IOCSTR+60                                                10971000
IOCWORK  EQU   IOCSTR+56                                                10972000
IOCRRN   EQU   IOCSTR+52                                                10973000
IOCPNM   EQU   IOCNWM+2                                                 10974000
IOCPTL   EQU   IOCNWM                                                   10975000
IOCKYA   EQU   IOCMEM                                                   10976000
IOCVRC   EQU   IOCTTR                                                   10977000
IOCCBP   EQU   IOCSTR+36                                                10978000
IOCHURBA EQU   IOCSTR+28                                                10979000
IOCVOLSR EQU   IOCSTR+22                                                10980000
@NM00018 EQU   IOCMSG                                                   10981000
IOCMSGAE EQU   IOCMSG                                                   10982000
IOCMSGCE EQU   IOCMSG                                                   10983000
IOCMSGOE EQU   IOCMSG                                                   10984000
IOCMSGOP EQU   IOCMSG                                                   10985000
@NM00017 EQU   IOCMSG                                                   10986000
IOCCHPSY EQU   IOCCHP                                                   10987000
IOCCHPAS EQU   IOCCHP                                                   10988000
IOCCHPBK EQU   IOCCHP                                                   10989000
IOCCHPCR EQU   IOCCHP                                                   10990000
IOCCHPKS EQU   IOCCHP                                                   10991000
IOCCHPSK EQU   IOCCHP                                                   10992000
IOCCHPDR EQU   IOCCHP                                                   10993000
IOCCHPSQ EQU   IOCCHP                                                   10994000
@NM00016 EQU   IOCMAC2                                                  10995000
IOCMACPA EQU   IOCMAC2                                                  10996000
@NM00015 EQU   IOCMAC2                                                  10997000
IOCMACCP EQU   IOCMAC2                                                  10998000
IOCMACRR EQU   IOCMAC2                                                  10999000
IOCMACAS EQU   IOCMAC2                                                  11000000
IOCMACSK EQU   IOCMAC2                                                  11001000
@NM00014 EQU   IOCMAC                                                   11002000
IOCMACCC EQU   IOCMAC                                                   11003000
IOCMACDR EQU   IOCMAC                                                   11004000
IOCMACBK EQU   IOCMAC                                                   11005000
IOCMACCR EQU   IOCMAC                                                   11006000
IOCMACUP EQU   IOCMAC                                                   11007000
IOCMACOT EQU   IOCMAC                                                   11008000
IOCMACIN EQU   IOCMAC                                                   11009000
@NM00013 EQU   IOCRFM                                                   11010000
IOCRFMBK EQU   IOCRFM                                                   11011000
IOCRFMSF EQU   IOCRFM                                                   11012000
IOCRFMUN EQU   IOCRFM                                                   11013000
IOCRFMVR EQU   IOCRFM                                                   11014000
IOCRFMFX EQU   IOCRFM                                                   11015000
@NM00012 EQU   IOCDSO                                                   11016000
IOCDSOPO EQU   IOCDSO                                                   11017000
IOCDSOIS EQU   IOCDSO                                                   11018000
IOCDSOPS EQU   IOCDSO                                                   11019000
IOCDSOAM EQU   IOCDSO                                                   11020000
IOCRKP   EQU   IOCSTR+13                                                11021000
IOCKYL   EQU   IOCSTR+12                                                11022000
IOCTRN   EQU   IOCSTR+8                                                 11023000
IOCDLN   EQU   IOCSTR+4                                                 11024000
IOCDAD   EQU   IOCSTR                                                   11025000
UNITVTOC EQU   UNITABL+7                                                11026000
@NM00011 EQU   UNITSTAT                                                 11027000
UNITUSHR EQU   UNITSTAT                                                 11028000
UNITXSHR EQU   UNITSTAT                                                 11029000
UNITISHR EQU   UNITSTAT                                                 11030000
UNITUA   EQU   @NM00010+1                                               11031000
UNITCHA  EQU   @NM00010                                                 11032000
UNITUCB  EQU   UNITABL                                                  11033000
ALLUNCNT EQU   ALLAGL+30                                                11034000
ALLVLCNT EQU   ALLAGL+29                                                11035000
@NM00009 EQU   ALLOPT                                                   11036000
ALLOPTUN EQU   ALLOPT                                                   11037000
ALLOPTPV EQU   ALLOPT                                                   11038000
@NM00008 EQU   ALLORG+1                                                 11039000
ALLORGVS EQU   ALLORG+1                                                 11040000
@NM00007 EQU   ALLORG+1                                                 11041000
ALLORGGS EQU   ALLORG+1                                                 11042000
ALLORGUN EQU   ALLORG                                                   11043000
ALLORGPO EQU   ALLORG                                                   11044000
ALLORGMQ EQU   ALLORG                                                   11045000
ALLORGCQ EQU   ALLORG                                                   11046000
ALLORGCX EQU   ALLORG                                                   11047000
ALLORGDA EQU   ALLORG                                                   11048000
ALLORGPS EQU   ALLORG                                                   11049000
ALLORGIS EQU   ALLORG                                                   11050000
ALLDSPUN EQU   ALLDSP                                                   11051000
ALLDSPCG EQU   ALLDSP                                                   11052000
ALLDSPDE EQU   ALLDSP                                                   11053000
@NM00006 EQU   ALLDSP                                                   11054000
ALLSTSMD EQU   ALLSTS                                                   11055000
ALLSTSNW EQU   ALLSTS                                                   11056000
ALLSTSSR EQU   ALLSTS                                                   11057000
@NM00005 EQU   ALLSTS                                                   11058000
@NM00004 EQU   CIRAGL+1                                                 11059000
@NM00003 EQU   CIRTYPE                                                  11060000
CIRTYPAQ EQU   CIRTYPE                                                  11061000
NEWID1   EQU   TRACE1+95                                                11062000
CALLID   EQU   OLDERID1+90                                              11063000
@NM00002 EQU   OLDERID1                                                 11064000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      11065000
@RC00428 EQU   @RC00402                                                 11066000
@RC00503 EQU   @RC00488                                                 11067000
@RF00844 EQU   @EL00002                                                 11068000
@RF00846 EQU   @EL00002                                                 11069000
@RF01339 EQU   @EL00003                                                 11070000
@RF01377 EQU   @EL00003                                                 11071000
@RF01545 EQU   @RC01542                                                 11072000
@RC01550 EQU   @RC01548                                                 11073000
@RF01583 EQU   @RC01579                                                 11074000
@RC01680 EQU   @RC01678                                                 11075000
@RC01698 EQU   @RC01697                                                 11076000
@RT01708 EQU   @RC01707                                                 11077000
@RF01870 EQU   @RC01850                                                 11078000
@RC01978 EQU   @RC01976                                                 11079000
@RF01991 EQU   @EL00005                                                 11080000
@RF01998 EQU   @EL00005                                                 11081000
@RF02000 EQU   @EL00005                                                 11082000
@RF02105 EQU   @EL00007                                                 11083000
@RC02117 EQU   @EL00008                                                 11084000
@PB00008 EQU   @EL00001                                                 11085000
@PB00007 EQU   @PB00008                                                 11086000
@PB00006 EQU   @PB00007                                                 11087000
@PB00005 EQU   @PB00006                                                 11088000
@PB00004 EQU   @PB00005                                                 11089000
@PB00003 EQU   @PB00004                                                 11090000
@PB00002 EQU   @PB00003                                                 11091000
@ENDDATA EQU   *                                                        11092000
         END   IDCAL01,(C'PLS1034',0701,77271)                          11093000
