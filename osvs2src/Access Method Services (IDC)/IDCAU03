         TITLE '********** IDCAU03: AUDITMSS - CHECK AND READ LABEL ****00001000
               ******** '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCAU03  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCAU03   76.356'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(20),0(@01)                                 0002 00037000
*                                                                  0400 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* THIS IS THE MAIN ROUTINE FOR IDCAU03.                 @Z40LB25*/ 00041000
*   /*                                                               */ 00042000
*   /*****************************************************************/ 00043000
*                                                                  0400 00044000
*   IF GDTDBG=NULLPTR THEN                                         0400 00045000
         L     @15,@PC00001                                        0400 00046000
         L     @15,GDTDBG(,@15)                                    0400 00047000
         LTR   @15,@15                                             0400 00048000
         BZ    @RT00400                                            0400 00049000
*     ;                                                            0401 00050000
*   ELSE                                                           0402 00051000
*     CALL IDCDB010(GDTTBL,'AUCA'); /*                       @Z40LB25*/ 00052000
         L     @15,@PC00001                                        0402 00053000
         ST    @15,@AL00001                                        0402 00054000
         LA    @14,@CC01538                                        0402 00055000
         ST    @14,@AL00001+4                                      0402 00056000
         MVI   @AL00001+4,X'80'                                    0402 00057000
         L     @15,GDTDBG(,@15)                                    0402 00058000
         LA    @01,@AL00001                                        0402 00059000
         BALR  @14,@15                                             0402 00060000
*   OLDERID2=NEWERID2;                                             0403 00061000
@RT00400 L     @02,@PC00001                                        0403 00062000
         L     @15,GDTTR2(,@02)                                    0403 00063000
         MVC   @TS00001(95),NEWERID2(@15)                          0403 00064000
         MVC   OLDERID2(95,@15),@TS00001                           0403 00065000
*   NEWID2='AUCA';                  /*                       @Z40LB25*/ 00066000
*                                                                  0404 00067000
         MVC   NEWID2(4,@15),@CC01538                              0404 00068000
*   /*****************************************************************/ 00069000
*   /*                                                               */ 00070000
*   /* INITIALIZE LISTS AND POINTERS.                        @Z40LB25*/ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                                  0405 00074000
*   REASONCD=0;                     /*                       @Z40LB25*/ 00075000
         SLR   @15,@15                                             0405 00076000
         ST    @15,REASONCD                                        0405 00077000
*   FLAGS=''B;                      /* INIT WORK FLAGS       @Z40LB25*/ 00078000
         XC    FLAGS(3),FLAGS                                      0406 00079000
*   DDSTRU=ADDR(PRINTAB);           /* PRINT MESSAGES        @Z40LB25*/ 00080000
         LA    @14,PRINTAB                                         0407 00081000
         ST    @14,DDSTRU                                          0407 00082000
*   LASTCOND=LASTCC00;              /* NULL COND CODE        @Z40LB25*/ 00083000
         STH   @15,LASTCOND                                        0408 00084000
*   RDCKPTR=ADDR(QURYAREA);         /* ICBQUERY LIST AREA    @Z40LB25*/ 00085000
         LA    @15,QURYAREA                                        0409 00086000
         ST    @15,RDCKPTR                                         0409 00087000
*   QURYAREA=''B;                   /* ZERO PARM LIST        @Z40LB25*/ 00088000
*                                                                  0410 00089000
         XC    QURYAREA(44),QURYAREA                               0410 00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* CALCULATE THE SIZE OF STORAGE NECESSARY.              @Z40LB25*/ 00093000
*   /*                                                               */ 00094000
*   /*****************************************************************/ 00095000
*                                                                  0411 00096000
*   CORESIZE=(BLKSIZE*BLKNUM)*WRKTABNM;/*                    @Z40LB25*/ 00097000
*                                                                  0411 00098000
         MVC   CORESIZE(4),@CF01638                                0411 00099000
*   /*****************************************************************/ 00100000
*   /*                                                               */ 00101000
*   /* GET ZEROED STORAGE FOR THE WORKAREA.                  @Z40LB25*/ 00102000
*   /*                                                               */ 00103000
*   /*****************************************************************/ 00104000
*                                                                  0412 00105000
*   CALL IDCSAGS0(GDTTBL,CORESIZE,WRKMAPTR,SETZERO);/*       @Z40LB25*/ 00106000
         ST    @02,@AL00001                                        0412 00107000
         LA    @15,CORESIZE                                        0412 00108000
         ST    @15,@AL00001+4                                      0412 00109000
         LA    @15,WRKMAPTR                                        0412 00110000
         ST    @15,@AL00001+8                                      0412 00111000
         LA    @15,SETZERO                                         0412 00112000
         ST    @15,@AL00001+12                                     0412 00113000
         MVI   @AL00001+12,X'80'                                   0412 00114000
         L     @15,GDTGSP(,@02)                                    0412 00115000
         LA    @01,@AL00001                                        0412 00116000
         BALR  @14,@15                                             0412 00117000
*   RESPECIFY                                                      0413 00118000
*     RTNREG RSTD;                                                 0413 00119000
*   TESTRC=RTNREG;                                                 0414 00120000
         LR    TESTRC,RTNREG                                       0414 00121000
*   RESPECIFY                                                      0415 00122000
*     RTNREG UNRSTD;                /*                       @Z40LB25*/ 00123000
*                                                                  0415 00124000
*   /*****************************************************************/ 00125000
*   /*                                                               */ 00126000
*   /* IF STORAGE GOTTEN, SET UP ADDRESSING TO WORK AREAS    @Z40LB25*/ 00127000
*   /*                                                               */ 00128000
*   /*****************************************************************/ 00129000
*                                                                  0416 00130000
*   IF TESTRC=0 THEN                                               0416 00131000
         LTR   TESTRC,TESTRC                                       0416 00132000
         BNZ   @RF00416                                            0416 00133000
*     DO;                           /*                       @Z40LB25*/ 00134000
*       GOTCORE=ON;                 /*                       @Z40LB25*/ 00135000
         OI    GOTCORE,B'10000000'                                 0418 00136000
*       XYZ1PTR=WRKMAPTR+CORESIZE/3;/*                       @Z40LB25*/ 00137000
         L     @05,WRKMAPTR                                        0419 00138000
         L     @15,CORESIZE                                        0419 00139000
         LA    @14,3                                               0419 00140000
         LR    @00,@15                                             0419 00141000
         SRDA  @00,32                                              0419 00142000
         DR    @00,@14                                             0419 00143000
         ALR   @01,@05                                             0419 00144000
         ST    @01,XYZ1PTR                                         0419 00145000
*       XYZ2PTR=WRKMAPTR+(CORESIZE*2)/3;/*                   @Z40LB25*/ 00146000
*                                                                  0420 00147000
         ST    @14,@TF00001                                        0420 00148000
         M     @14,@CF00158                                        0420 00149000
         D     @14,@TF00001                                        0420 00150000
         ALR   @05,@15                                             0420 00151000
         ST    @05,XYZ2PTR                                         0420 00152000
*       /*************************************************************/ 00153000
*       /*                                                           */ 00154000
*       /* SET UP A LOOP TO FIND THE LOWEST X VALUE FOR THIS @Z40LB25*/ 00155000
*       /* MODEL. THIS IS DONE BY STARTING WITH THE HEADER BLOCK     */ 00156000
*       /* ADDRESS FOR THE MSF BEING REPORTED ON AND THROUGH SCANNING*/ 00157000
*       /* THE CUBE ADDRESSES UNTIL A 'FF' IS FOUND.         @Z40LB25*/ 00158000
*       /*                                                           */ 00159000
*       /*************************************************************/ 00160000
*                                                                  0421 00161000
*       I=1;                        /*                       @Z40LB25*/ 00162000
         LA    I,1                                                 0421 00163000
*       DO WHILE LOXFOUND=OFF;      /*                       @Z40LB25*/ 00164000
         B     @DE00422                                            0422 00165000
@DL00422 DS    0H                                                  0423 00166000
*         IF CUBEADDR(I)=LASTCUBE THEN                             0423 00167000
         L     @05,@PC00001+8                                      0423 00168000
         L     @05,BLKPTR(,@05)                                    0423 00169000
         ALR   @05,I                                               0423 00170000
         CLC   CUBEADDR-1(1,@05),LASTCUBE                          0423 00171000
         BNE   @RF00423                                            0423 00172000
*           LOXFOUND=ON;            /*                       @Z40LB25*/ 00173000
         OI    LOXFOUND,B'01000000'                                0424 00174000
*         I=I+1;                    /*                       @Z40LB25*/ 00175000
@RF00423 AL    I,@CF00224                                          0425 00176000
*       END;                        /*                       @Z40LB25*/ 00177000
*                                                                  0426 00178000
@DE00422 TM    LOXFOUND,B'01000000'                                0426 00179000
         BZ    @DL00422                                            0426 00180000
*       /*************************************************************/ 00181000
*       /*                                                           */ 00182000
*       /* THE END OF THE CUBE ADDRESSES IN THE HEADER BLOCK HAS BEEN*/ 00183000
*       /* FOUND. NEXT THE LOW 'X' IS CALCULATED BY THE FOLLOWING    */ 00184000
*       /* FORMULA:                                          @Z40LB25*/ 00185000
*       /*                                                           */ 00186000
*       /*************************************************************/ 00187000
*                                                                  0427 00188000
*                                                                  0427 00189000
*       /*************************************************************/ 00190000
*       /*                                                           */ 00191000
*       /* X = MAX HIGHEST RELATIVE X - NUMBER OF CUBE PTRS / NUMBER */ 00192000
*       /* OF CUBE PTRS PER CHUNK * RANGE OF X PER CHUNK - 2.        */ 00193000
*       /*                                                   @Z40LB25*/ 00194000
*       /*                                                           */ 00195000
*       /*************************************************************/ 00196000
*                                                                  0427 00197000
*                                                                  0427 00198000
*       /*************************************************************/ 00199000
*       /*                                                           */ 00200000
*       /* THE MINUS 2 ACCOUNTS FOR THE FACT THAT THE        @Z40LB25*/ 00201000
*       /* LAST CHUNK IS ONLY HALF FULL.                     @Z40LB25*/ 00202000
*       /* THE + 150 ACCOUNTS FOR THE XRANGES OF             @Z40LB25*/ 00203000
*       /* 150 TO 247.                                       @Z40LB25*/ 00204000
*       /*                                                           */ 00205000
*       /*************************************************************/ 00206000
*                                                                  0427 00207000
*       MSFLOWX=MAXX-(((I/CUBES)*CUBERANG)-2)+XSTART;/*      @Z40LB25*/ 00208000
*                                                                  0427 00209000
         LR    @00,I                                               0427 00210000
         SRDA  @00,32                                              0427 00211000
         D     @00,@CF00663                                        0427 00212000
         SLA   @01,2                                               0427 00213000
         LCR   @01,@01                                             0427 00214000
         AL    @01,@CF00158                                        0427 00215000
         AL    @01,@CF01241                                        0427 00216000
         AL    @01,@CF01256                                        0427 00217000
         ST    @01,MSFLOWX                                         0427 00218000
*       /*************************************************************/ 00219000
*       /*                                                           */ 00220000
*       /* ALLOW ALL THE RESERVED CELLS TO BE PROCESSED      @Z40LB25*/ 00221000
*       /*                                                           */ 00222000
*       /*************************************************************/ 00223000
*                                                                  0428 00224000
*       DO I=1 TO 2;                /*                       @Z40LB25*/ 00225000
         LA    I,1                                                 0428 00226000
@DL00428 DS    0H                                                  0429 00227000
*         IF I=1 THEN                                              0429 00228000
         C     I,@CF00224                                          0429 00229000
         BNE   @RF00429                                            0429 00230000
*           DO;                     /*                       @Z40LB25*/ 00231000
*             CHUNKPTR=ADDR(ORIGCUBE(1));/* ORIG CELL MAP    @Z40LB25*/ 00232000
         L     @05,@PC00001+8                                      0431 00233000
         L     @05,BLKPTR(,@05)                                    0431 00234000
         LA    @15,ORIGCUBE(,@05)                                  0431 00235000
         ST    @15,CHUNKPTR                                        0431 00236000
*             CELLPTR=ADDR(ORIGMAP(1));/*                    @Z40LB25*/ 00237000
         LA    @05,ORIGMAP(,@05)                                   0432 00238000
         ST    @05,CELLPTR                                         0432 00239000
*           END;                    /*                       @Z40LB25*/ 00240000
*         ELSE                                                     0434 00241000
*           DO;                     /*                       @Z40LB25*/ 00242000
         B     @RC00429                                            0434 00243000
@RF00429 DS    0H                                                  0435 00244000
*             CHUNKPTR=ADDR(CELLCUBE(1));/* CURRENT CELL MAP @Z40LB25*/ 00245000
         L     @05,@PC00001+8                                      0435 00246000
         L     @05,BLKPTR(,@05)                                    0435 00247000
         LA    @15,CELLCUBE(,@05)                                  0435 00248000
         ST    @15,CHUNKPTR                                        0435 00249000
*             CELLPTR=ADDR(CELLMAP(1));/*                    @Z40LB25*/ 00250000
         LA    @05,CELLMAP(,@05)                                   0436 00251000
         ST    @05,CELLPTR                                         0436 00252000
*           END;                    /*                       @Z40LB25*/ 00253000
*         Z=0;                      /*                       @Z40LB25*/ 00254000
@RC00429 SLR   @05,@05                                             0438 00255000
         STH   @05,Z                                               0438 00256000
*         Y=0;                      /*                       @Z40LB25*/ 00257000
         ST    @05,Y                                               0439 00258000
*         X=MSFLOWX;                /* MSF LOW X             @Z40LB25*/ 00259000
*                                                                  0440 00260000
         L     @05,MSFLOWX                                         0440 00261000
         STH   @05,X                                               0440 00262000
*         /***********************************************************/ 00263000
*         /*                                                         */ 00264000
*         /* SET X=150 OR 178 OR 206 OR 234, Y=0, Z=0        @Z40LB25*/ 00265000
*         /* IN THE ORIGINAL AND CURRENT CELL MAPS ON        @Z40LB25*/ 00266000
*         /*                                                         */ 00267000
*         /***********************************************************/ 00268000
*                                                                  0441 00269000
*         CALL LOCTOBIT;            /*                       @Z40LB25*/ 00270000
         BAL   @14,LOCTOBIT                                        0441 00271000
*         IF I=1 THEN                                              0442 00272000
         C     I,@CF00224                                          0442 00273000
         BNE   @RF00442                                            0442 00274000
*           DO;                     /*                       @Z40LB25*/ 00275000
*             CHUNKPTR=ADDR(ORIGCUBE(1));/* ORIG CELL MAP    @Z40LB25*/ 00276000
         L     @05,@PC00001+8                                      0444 00277000
         L     @05,BLKPTR(,@05)                                    0444 00278000
         LA    @15,ORIGCUBE(,@05)                                  0444 00279000
         ST    @15,CHUNKPTR                                        0444 00280000
*             CELLPTR=ADDR(ORIGMAP(1));/*                    @Z40LB25*/ 00281000
         LA    @05,ORIGMAP(,@05)                                   0445 00282000
         ST    @05,CELLPTR                                         0445 00283000
*           END;                    /*                       @Z40LB25*/ 00284000
*         ELSE                                                     0447 00285000
*           DO;                     /*                       @Z40LB25*/ 00286000
         B     @RC00442                                            0447 00287000
@RF00442 DS    0H                                                  0448 00288000
*             CHUNKPTR=ADDR(CELLCUBE(1));/* CURRENT CELL MAP @Z40LB25*/ 00289000
         L     @05,@PC00001+8                                      0448 00290000
         L     @05,BLKPTR(,@05)                                    0448 00291000
         LA    @15,CELLCUBE(,@05)                                  0448 00292000
         ST    @15,CHUNKPTR                                        0448 00293000
*             CELLPTR=ADDR(CELLMAP(1));/*                    @Z40LB25*/ 00294000
         LA    @05,CELLMAP(,@05)                                   0449 00295000
         ST    @05,CELLPTR                                         0449 00296000
*           END;                    /*                       @Z40LB25*/ 00297000
*         Z=0;                      /*                       @Z40LB25*/ 00298000
@RC00442 SLR   @05,@05                                             0451 00299000
         STH   @05,Z                                               0451 00300000
*         Y=0;                      /*                       @Z40LB25*/ 00301000
         ST    @05,Y                                               0452 00302000
*         X=247;                    /* 247                   @Z40LB25*/ 00303000
*                                                                  0453 00304000
         MVC   X(2),@CH01541                                       0453 00305000
*         /***********************************************************/ 00306000
*         /*                                                         */ 00307000
*         /* SET X=247, Y=0, Z=0 IN ORIGINAL CELL MAP        @Z40LB25*/ 00308000
*         /* AND CURRENT CELL MAP ON                         @Z40LB25*/ 00309000
*         /*                                                         */ 00310000
*         /***********************************************************/ 00311000
*                                                                  0454 00312000
*         CALL LOCTOBIT;            /*                       @Z40LB25*/ 00313000
         BAL   @14,LOCTOBIT                                        0454 00314000
*         IF I=1 THEN                                              0455 00315000
         C     I,@CF00224                                          0455 00316000
         BNE   @RF00455                                            0455 00317000
*           DO;                     /*                       @Z40LB25*/ 00318000
*             CHUNKPTR=ADDR(ORIGCUBE);/* ORIG CELL MAP       @Z40LB25*/ 00319000
         L     @05,@PC00001+8                                      0457 00320000
         L     @05,BLKPTR(,@05)                                    0457 00321000
         LA    @15,ORIGCUBE(,@05)                                  0457 00322000
         ST    @15,CHUNKPTR                                        0457 00323000
*             CELLPTR=ADDR(ORIGMAP);/*                       @Z40LB25*/ 00324000
         LA    @05,ORIGMAP(,@05)                                   0458 00325000
         ST    @05,CELLPTR                                         0458 00326000
*           END;                    /*                       @Z40LB25*/ 00327000
*         ELSE                                                     0460 00328000
*           DO;                     /*                       @Z40LB25*/ 00329000
         B     @RC00455                                            0460 00330000
@RF00455 DS    0H                                                  0461 00331000
*             CHUNKPTR=ADDR(CELLCUBE(1));/* CURRENT CELL MAP @Z40LB25*/ 00332000
         L     @05,@PC00001+8                                      0461 00333000
         L     @05,BLKPTR(,@05)                                    0461 00334000
         LA    @15,CELLCUBE(,@05)                                  0461 00335000
         ST    @15,CHUNKPTR                                        0461 00336000
*             CELLPTR=ADDR(CELLMAP(1));/*                    @Z40LB25*/ 00337000
         LA    @05,CELLMAP(,@05)                                   0462 00338000
         ST    @05,CELLPTR                                         0462 00339000
*           END;                    /*                       @Z40LB25*/ 00340000
*         Z=0;                      /*                       @Z40LB25*/ 00341000
@RC00455 SLR   @05,@05                                             0464 00342000
         STH   @05,Z                                               0464 00343000
*         Y=7;                      /* CHANGE Y FROM 8 TO 7  @ZA16129*/ 00344000
         MVC   Y(4),@CF00663                                       0465 00345000
*         X=247;                    /* 247                   @Z40LB25*/ 00346000
*                                                                  0466 00347000
         MVC   X(2),@CH01541                                       0466 00348000
*         /***********************************************************/ 00349000
*         /*                                                         */ 00350000
*         /* SET X=247, Y=7, Z=0 IN ORIGINAL CELL MAP        @ZA16129*/ 00351000
*         /* AND CURRENT CELL MAP ON                         @Z40LB25*/ 00352000
*         /*                                                         */ 00353000
*         /***********************************************************/ 00354000
*                                                                  0467 00355000
*         CALL LOCTOBIT;            /*                       @Z40LB25*/ 00356000
         BAL   @14,LOCTOBIT                                        0467 00357000
*       END;                        /*                       @Z40LB25*/ 00358000
*                                                                  0468 00359000
         AL    I,@CF00224                                          0468 00360000
         C     I,@CF00158                                          0468 00361000
         BNH   @DL00428                                            0468 00362000
*       /*************************************************************/ 00363000
*       /*                                                           */ 00364000
*       /* CREATE THE WORK MAP                               @Z40LB25*/ 00365000
*       /*                                                           */ 00366000
*       /*************************************************************/ 00367000
*                                                                  0469 00368000
*       CALL INITMAP;               /*                       @Z40LB25*/ 00369000
*                                                                  0469 00370000
         BAL   @14,INITMAP                                         0469 00371000
*       /*************************************************************/ 00372000
*       /*                                                           */ 00373000
*       /* SET USER REQUESTED LOCATIONS INTO WORKMAP         @Z40LB25*/ 00374000
*       /*                                                           */ 00375000
*       /*************************************************************/ 00376000
*                                                                  0470 00377000
*       CALL LIMITS;                /*                       @Z40LB25*/ 00378000
         BAL   @14,LIMITS                                          0470 00379000
*       LASTCOND=LIMITSRC;          /*                       @Z40LB25*/ 00380000
*                                                                  0471 00381000
         LH    @15,LIMITSRC                                        0471 00382000
         STH   @15,LASTCOND                                        0471 00383000
*       /*************************************************************/ 00384000
*       /*                                                           */ 00385000
*       /* CHECK IF THE USER SPECIFIED ONLY CELLS WHICH      @Z40LB25*/ 00386000
*       /* ARE IN RESERVED AREAS. (WORKMAP WILL CONTAIN      @Z40LB25*/ 00387000
*       /* ALL ZEROS.)                                       @Z40LB25*/ 00388000
*       /*                                                           */ 00389000
*       /*************************************************************/ 00390000
*                                                                  0472 00391000
*       IF ADDR(CELL)^=NULLPTR&LASTCOND=LASTCC00 THEN              0472 00392000
         SLR   @14,@14                                             0472 00393000
         L     @07,@PC00001+4                                      0472 00394000
         C     @14,FDTPTR+40(,@07)                                 0472 00395000
         BE    @RF00472                                            0472 00396000
         CR    @15,@14                                             0472 00397000
         BNE   @RF00472                                            0472 00398000
*         DO;                       /*                       @Z40LB25*/ 00399000
*           DO I=1 TO BLKNUM WHILE CELFOUND=OFF;/*           @Z40LB25*/ 00400000
         LA    I,1                                                 0474 00401000
@DL00474 TM    CELFOUND,B'00000010'                                0474 00402000
         BNZ   @DC00474                                            0474 00403000
*             DO II=1 TO LENGTH(WRKCUBE) WHILE CELFOUND=OFF;/*     0475 00404000
*                                                            @Z40LB25*/ 00405000
         LA    II,1                                                0475 00406000
@DL00475 TM    CELFOUND,B'00000010'                                0475 00407000
         BNZ   @DC00475                                            0475 00408000
*               IF WRKCUBE(I,II)^=CELLSET THEN                     0476 00409000
         LR    @05,I                                               0476 00410000
         MH    @05,@CH01230                                        0476 00411000
         ALR   @05,II                                              0476 00412000
         L     @02,WRKMAPTR                                        0476 00413000
         ALR   @02,@05                                             0476 00414000
         AL    @02,@CF01670                                        0476 00415000
         CLC   WRKCUBE-8(1,@02),CELLSET                            0476 00416000
         BE    @RF00476                                            0476 00417000
*                 CELFOUND=ON;      /*                       @Z40LB25*/ 00418000
         OI    CELFOUND,B'00000010'                                0477 00419000
*             END;                  /*                       @Z40LB25*/ 00420000
@RF00476 AL    II,@CF00224                                         0478 00421000
         C     II,@CF01398                                         0478 00422000
         BNH   @DL00475                                            0478 00423000
@DC00475 DS    0H                                                  0479 00424000
*           END;                    /*                       @Z40LB25*/ 00425000
         AL    I,@CF00224                                          0479 00426000
         C     I,@CF00047                                          0479 00427000
         BNH   @DL00474                                            0479 00428000
@DC00474 DS    0H                                                  0480 00429000
*           IF CELFOUND=OFF THEN                                   0480 00430000
*                                                                  0480 00431000
         TM    CELFOUND,B'00000010'                                0480 00432000
         BNZ   @RF00480                                            0480 00433000
*             /*******************************************************/ 00434000
*             /*                                                     */ 00435000
*             /* ISSUE MSG IDC31142I                         @Z40LB25*/ 00436000
*             /* NO VALID CELLS SPECIFIED                    @Z40LB25*/ 00437000
*             /*                                                     */ 00438000
*             /*******************************************************/ 00439000
*                                                                  0481 00440000
*             DO;                   /*                       @Z40LB25*/ 00441000
*               LASTCOND=LASTCC12;  /*                       @Z40LB25*/ 00442000
         MVC   LASTCOND(2),@CH00571                                0482 00443000
*               PRINTAB=''B;        /*                       @Z40LB25*/ 00444000
         XC    PRINTAB(164),PRINTAB                                0483 00445000
*               DARGSMOD=AUDMSG;    /*                       @Z40LB25*/ 00446000
         L     @15,DDSTRU                                          0484 00447000
         MVC   DARGSMOD(3,@15),@CC01440                            0484 00448000
*               DARGSENT=MG21142C;  /*                       @Z40LB25*/ 00449000
         MVI   DARGSENT(@15),X'07'                                 0485 00450000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB25*/ 00451000
         L     @15,@PC00001                                        0486 00452000
         ST    @15,@AL00001                                        0486 00453000
         LA    @14,@CF00120                                        0486 00454000
         ST    @14,@AL00001+4                                      0486 00455000
         LA    @14,DDSTRU                                          0486 00456000
         ST    @14,@AL00001+8                                      0486 00457000
         MVI   @AL00001+8,X'80'                                    0486 00458000
         L     @15,GDTPRT(,@15)                                    0486 00459000
         LA    @01,@AL00001                                        0486 00460000
         BALR  @14,@15                                             0486 00461000
*             END;                  /*                       @Z40LB25*/ 00462000
*         END;                      /*                       @Z40LB25*/ 00463000
*                                                                  0488 00464000
@RF00480 DS    0H                                                  0489 00465000
*       /*************************************************************/ 00466000
*       /*                                                           */ 00467000
*       /* ZERO XYZ1 WORK AREAS. USED BY PROCXRNG.           @Z40LB25*/ 00468000
*       /*                                                           */ 00469000
*       /*************************************************************/ 00470000
*                                                                  0489 00471000
*       IF LASTCOND^=LASTCC12&ADDR(XRNG)^=NULLPTR THEN             0489 00472000
@RF00472 CLC   LASTCOND(2),@CH00571                                0489 00473000
         BE    @RF00489                                            0489 00474000
         L     @15,@PC00001+4                                      0489 00475000
         L     @15,FDTPTR+28(,@15)                                 0489 00476000
         LTR   @15,@15                                             0489 00477000
         BZ    @RF00489                                            0489 00478000
*         DO;                       /*                       @Z40LB25*/ 00479000
*           DO I=1 TO BLKNUM;       /*                       @Z40LB25*/ 00480000
         LA    I,1                                                 0491 00481000
@DL00491 DS    0H                                                  0492 00482000
*             DO II=1 TO LENGTH(XYZ1CUBE);/*                 @Z40LB25*/ 00483000
         LA    II,1                                                0492 00484000
@DL00492 DS    0H                                                  0493 00485000
*               XYZ1CUBE(I,II)=XYZ1CUBE(I,II)&&XYZ1CUBE(I,II);/*   0493 00486000
*                                                            @Z40LB25*/ 00487000
         LR    @05,I                                               0493 00488000
         MH    @05,@CH01230                                        0493 00489000
         ALR   @05,II                                              0493 00490000
         L     @02,XYZ1PTR                                         0493 00491000
         ALR   @02,@05                                             0493 00492000
         AL    @02,@CF01670                                        0493 00493000
         XC    XYZ1CUBE-8(1,@02),XYZ1CUBE-8(@02)                   0493 00494000
*             END;                  /*                       @Z40LB25*/ 00495000
         AL    II,@CF00224                                         0494 00496000
         C     II,@CF01398                                         0494 00497000
         BNH   @DL00492                                            0494 00498000
*           END;                    /*                       @Z40LB25*/ 00499000
         AL    I,@CF00224                                          0495 00500000
         C     I,@CF00047                                          0495 00501000
         BNH   @DL00491                                            0495 00502000
*         END;                      /*                       @Z40LB25*/ 00503000
*                                                                  0496 00504000
*       /*************************************************************/ 00505000
*       /*                                                           */ 00506000
*       /* CHECK FOR CHECK REPORT, BASED ON THE INPUT        @Z40LB25*/ 00507000
*       /* MSF CELL MAPS                                     @Z40LB25*/ 00508000
*       /*                                                           */ 00509000
*       /*************************************************************/ 00510000
*                                                                  0497 00511000
*       IF ADDR(CHK)^=NULLPTR&LASTCOND^=LASTCC12 THEN              0497 00512000
@RF00489 SLR   @15,@15                                             0497 00513000
         L     @14,@PC00001+4                                      0497 00514000
         C     @15,FDTPTR+4(,@14)                                  0497 00515000
         BE    @RF00497                                            0497 00516000
         CLC   LASTCOND(2),@CH00571                                0497 00517000
         BE    @RF00497                                            0497 00518000
*         DO;                       /*                       @Z40LB25*/ 00519000
*           HDCKPTR=ADDR(HDSETCK);  /*                       @Z40LB25   00520000
*                                      PRT CHECK PARM LST    @Z40LB25*/ 00521000
         LA    @14,HDSETCK                                         0499 00522000
         ST    @14,HDCKPTR                                         0499 00523000
*           HDSETCK=''B;            /* ZERO CK FLAGS         @Z40LB25*/ 00524000
         XC    HDSETCK(4),HDSETCK                                  0500 00525000
*           HDRDPTR=NULLPTR;        /*                       @Z40LB25*/ 00526000
*                                                                  0501 00527000
         ST    @15,HDRDPTR                                         0501 00528000
*           /*********************************************************/ 00529000
*           /*                                                       */ 00530000
*           /* CHECK REPORT                                  @Z40LB25*/ 00531000
*           /*                                                       */ 00532000
*           /*********************************************************/ 00533000
*                                                                  0502 00534000
*           CALL CHECKLIB;          /*                       @Z40LB25*/ 00535000
*                                                                  0502 00536000
         BAL   @14,CHECKLIB                                        0502 00537000
*           /*********************************************************/ 00538000
*           /*                                                       */ 00539000
*           /* NO CHECK REPORT PRINTED BECAUSE NO            @Z40LB25*/ 00540000
*           /* DISCREPANCIES WERE FOUND                      @Z40LB25*/ 00541000
*           /*                                                       */ 00542000
*           /*********************************************************/ 00543000
*                                                                  0503 00544000
*           IF XYZ1PRTD=OFF&XYZ2PRTD=OFF&RLBLPRTD=OFF&CHECKRC=LASTCC00  00545000
*             THEN                                                 0503 00546000
         TM    XYZ1PRTD,B'00000011'                                0503 00547000
         BNZ   @RF00503                                            0503 00548000
         TM    RLBLPRTD,B'10000000'                                0503 00549000
         BNZ   @RF00503                                            0503 00550000
         LH    @15,CHECKRC                                         0503 00551000
         LTR   @15,@15                                             0503 00552000
         BNZ   @RF00503                                            0503 00553000
*             DO;                   /*                       @Z40LB25*/ 00554000
*               PRINTAB=''B;        /*                       @Z40LB25*/ 00555000
         XC    PRINTAB(164),PRINTAB                                0505 00556000
*               DARGSMOD=AUDMSG;    /*                       @Z40LB25*/ 00557000
         L     @15,DDSTRU                                          0506 00558000
         MVC   DARGSMOD(3,@15),@CC01440                            0506 00559000
*               DARGSENT=MG31146I;  /*                       @Z40LB25*/ 00560000
         MVI   DARGSENT(@15),X'2E'                                 0507 00561000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB25*/ 00562000
         L     @15,@PC00001                                        0508 00563000
         ST    @15,@AL00001                                        0508 00564000
         LA    @14,@CF00120                                        0508 00565000
         ST    @14,@AL00001+4                                      0508 00566000
         LA    @14,DDSTRU                                          0508 00567000
         ST    @14,@AL00001+8                                      0508 00568000
         MVI   @AL00001+8,X'80'                                    0508 00569000
         L     @15,GDTPRT(,@15)                                    0508 00570000
         LA    @01,@AL00001                                        0508 00571000
         BALR  @14,@15                                             0508 00572000
*             END;                  /*                       @Z40LB25*/ 00573000
*                                                                  0509 00574000
*           /*********************************************************/ 00575000
*           /*                                                       */ 00576000
*           /* RETURN THE HIGHEST CONDITION CODE             @VS41112*/ 00577000
*           /*                                                       */ 00578000
*           /*********************************************************/ 00579000
*                                                                  0510 00580000
*           IF CHECKRC>LASTCOND THEN                               0510 00581000
@RF00503 LH    @15,CHECKRC                                         0510 00582000
         CH    @15,LASTCOND                                        0510 00583000
         BNH   @RF00510                                            0510 00584000
*             LASTCOND=CHECKRC;     /*                       @Z40LB25*/ 00585000
         STH   @15,LASTCOND                                        0511 00586000
*         END;                      /*                       @Z40LB25*/ 00587000
*       ELSE                                                       0513 00588000
*                                                                  0513 00589000
*         /***********************************************************/ 00590000
*         /*                                                         */ 00591000
*         /* CHECK FOR READ LABEL REPORT                     @Z40LB25*/ 00592000
*         /*                                                         */ 00593000
*         /***********************************************************/ 00594000
*                                                                  0513 00595000
*         IF ADDR(RDLBL)^=NULLPTR&LASTCOND^=LASTCC12 THEN          0513 00596000
         B     @RC00497                                            0513 00597000
@RF00497 SLR   @15,@15                                             0513 00598000
         L     @14,@PC00001+4                                      0513 00599000
         C     @15,FDTPTR+8(,@14)                                  0513 00600000
         BE    @RF00513                                            0513 00601000
         CLC   LASTCOND(2),@CH00571                                0513 00602000
         BE    @RF00513                                            0513 00603000
*           DO;                     /*                       @Z40LB25*/ 00604000
*             HDRDPTR=ADDR(HDSETRD);/*                       @Z40LB25   00605000
*                                      PRT READ PARM LST     @Z40LB25*/ 00606000
         LA    @14,HDSETRD                                         0515 00607000
         ST    @14,HDRDPTR                                         0515 00608000
*             HDSETRD=''B;          /*                       @Z40LB25   00609000
*                                      ZERO READ FLAGS       @Z40LB25*/ 00610000
         XC    HDSETRD(8),HDSETRD                                  0516 00611000
*             HDCKPTR=NULLPTR;      /*                       @Z40LB25*/ 00612000
*                                                                  0517 00613000
         ST    @15,HDCKPTR                                         0517 00614000
*             /*******************************************************/ 00615000
*             /*                                                     */ 00616000
*             /* READ LABEL REPORT                           @Z40LB25*/ 00617000
*             /*                                                     */ 00618000
*             /*******************************************************/ 00619000
*                                                                  0518 00620000
*             CALL READLBL;         /*                       @Z40LB25*/ 00621000
*                                                                  0518 00622000
         BAL   @14,READLBL                                         0518 00623000
*             /*******************************************************/ 00624000
*             /*                                                     */ 00625000
*             /* NO READLABEL REPORT PRINTED BECAUSE NO      @Z40LB25*/ 00626000
*             /* DISCREPANCIES WERE FOUND                    @Z40LB25*/ 00627000
*             /*                                                     */ 00628000
*             /*******************************************************/ 00629000
*                                                                  0519 00630000
*             IF XYZ1PRTD=OFF&XYZ2PRTD=OFF&RLBLPRTD=OFF&READRC=LASTCC00 00631000
*               THEN                                               0519 00632000
         TM    XYZ1PRTD,B'00000011'                                0519 00633000
         BNZ   @RF00519                                            0519 00634000
         TM    RLBLPRTD,B'10000000'                                0519 00635000
         BNZ   @RF00519                                            0519 00636000
         LH    @15,READRC                                          0519 00637000
         LTR   @15,@15                                             0519 00638000
         BNZ   @RF00519                                            0519 00639000
*               DO;                 /*                       @Z40LB25*/ 00640000
*                 PRINTAB=''B;      /*                       @Z40LB25*/ 00641000
         XC    PRINTAB(164),PRINTAB                                0521 00642000
*                 DARGSMOD=AUDMSG;  /*                       @Z40LB25*/ 00643000
         L     @15,DDSTRU                                          0522 00644000
         MVC   DARGSMOD(3,@15),@CC01440                            0522 00645000
*                 DARGSENT=MG31146I;/*                       @Z40LB25*/ 00646000
         MVI   DARGSENT(@15),X'2E'                                 0523 00647000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Z40LB25*/ 00648000
         L     @15,@PC00001                                        0524 00649000
         ST    @15,@AL00001                                        0524 00650000
         LA    @14,@CF00120                                        0524 00651000
         ST    @14,@AL00001+4                                      0524 00652000
         LA    @14,DDSTRU                                          0524 00653000
         ST    @14,@AL00001+8                                      0524 00654000
         MVI   @AL00001+8,X'80'                                    0524 00655000
         L     @15,GDTPRT(,@15)                                    0524 00656000
         LA    @01,@AL00001                                        0524 00657000
         BALR  @14,@15                                             0524 00658000
*               END;                /*                       @Z40LB25*/ 00659000
*                                                                  0525 00660000
*             /*******************************************************/ 00661000
*             /*                                                     */ 00662000
*             /* RETURN THE HIGHEST CONDITION CODE           @VS41112*/ 00663000
*             /*                                                     */ 00664000
*             /*******************************************************/ 00665000
*                                                                  0526 00666000
*             IF READRC>LASTCOND THEN                              0526 00667000
@RF00519 LH    @15,READRC                                          0526 00668000
         CH    @15,LASTCOND                                        0526 00669000
         BNH   @RF00526                                            0526 00670000
*               LASTCOND=READRC;    /*                       @Z40LB25*/ 00671000
         STH   @15,LASTCOND                                        0527 00672000
*           END;                    /*                       @Z40LB25*/ 00673000
*                                                                  0528 00674000
@RF00526 DS    0H                                                  0529 00675000
*       /*************************************************************/ 00676000
*       /*                                                           */ 00677000
*       /* CHECK IF A REPORT WAS PRINTED SO                  @Z40LB25*/ 00678000
*       /* SUBTITLES AND HEADERS CAN BE CLEARED.             @Z40LB25*/ 00679000
*       /*                                                           */ 00680000
*       /*************************************************************/ 00681000
*                                                                  0529 00682000
*       IF XYZ1PRTD=ON|XYZ2PRTD=ON|RLBLPRTD=ON THEN                0529 00683000
@RF00513 DS    0H                                                  0529 00684000
@RC00497 TM    XYZ1PRTD,B'00000011'                                0529 00685000
         BNZ   @RT00529                                            0529 00686000
         TM    RLBLPRTD,B'10000000'                                0529 00687000
         BNO   @RF00529                                            0529 00688000
@RT00529 DS    0H                                                  0530 00689000
*         CALL AMSTP044(GDTTBL,PRINTME);/*                   @Z40LB25*/ 00690000
         L     @15,@PC00001                                        0530 00691000
         ST    @15,@AL00001                                        0530 00692000
         L     @14,@PC00001+12                                     0530 00693000
         ST    @14,@AL00001+4                                      0530 00694000
         MVI   @AL00001+4,X'80'                                    0530 00695000
         L     @15,GDTRES(,@15)                                    0530 00696000
         LA    @01,@AL00001                                        0530 00697000
         BALR  @14,@15                                             0530 00698000
*     END;                          /*                       @Z40LB25*/ 00699000
*                                                                  0531 00700000
*   /*****************************************************************/ 00701000
*   /*                                                               */ 00702000
*   /* STORAGE IS NOT AVAILABLE                              @Z40LB25*/ 00703000
*   /*                                                               */ 00704000
*   /*****************************************************************/ 00705000
*                                                                  0532 00706000
*   ELSE                                                           0532 00707000
*     DO;                           /*                       @Z40LB25*/ 00708000
         B     @RC00416                                            0532 00709000
@RF00416 DS    0H                                                  0533 00710000
*       PRINTAB=''B;                /*                       @Z40LB25*/ 00711000
         XC    PRINTAB(164),PRINTAB                                0533 00712000
*       DARGSMOD=UNIVMSG;           /*                       @Z40LB25*/ 00713000
         L     @15,DDSTRU                                          0534 00714000
         MVC   DARGSMOD(3,@15),@CC01438                            0534 00715000
*       DARGSENT=MSG3004I;          /*                       @Z40LB25*/ 00716000
         MVI   DARGSENT(@15),X'04'                                 0535 00717000
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Z40LB25*/ 00718000
         L     @15,@PC00001                                        0536 00719000
         ST    @15,@AL00001                                        0536 00720000
         L     @14,@PC00001+12                                     0536 00721000
         ST    @14,@AL00001+4                                      0536 00722000
         LA    @14,DDSTRU                                          0536 00723000
         ST    @14,@AL00001+8                                      0536 00724000
         MVI   @AL00001+8,X'80'                                    0536 00725000
         L     @15,GDTPRT(,@15)                                    0536 00726000
         LA    @01,@AL00001                                        0536 00727000
         BALR  @14,@15                                             0536 00728000
*       LASTCOND=LASTCC12;          /*                       @Z40LB25*/ 00729000
         MVC   LASTCOND(2),@CH00571                                0537 00730000
*     END;                          /*                       @Z40LB25*/ 00731000
*                                                                  0538 00732000
*   /*****************************************************************/ 00733000
*   /*                                                               */ 00734000
*   /* IF STORAGE GOTTEN, FREE IT                            @Z40LB25*/ 00735000
*   /*                                                               */ 00736000
*   /*****************************************************************/ 00737000
*                                                                  0539 00738000
*   IF GOTCORE=ON THEN              /*                       @Z40LB25*/ 00739000
@RC00416 TM    GOTCORE,B'10000000'                                 0539 00740000
         BNO   @RF00539                                            0539 00741000
*     CALL IDCSAFS0(GDTTBL,WRKMAPTR);/*                      @Z40LB25*/ 00742000
*                                                                  0540 00743000
         L     @15,@PC00001                                        0540 00744000
         ST    @15,@AL00001                                        0540 00745000
         LA    @14,WRKMAPTR                                        0540 00746000
         ST    @14,@AL00001+4                                      0540 00747000
         L     @15,GDTFSP(,@15)                                    0540 00748000
         LA    @01,@AL00001                                        0540 00749000
         BALR  @14,@15                                             0540 00750000
*   /*****************************************************************/ 00751000
*   /*                                                               */ 00752000
*   /* SET UP FOR A FULL REGION DUMP AND RETURN              @Z40LB25*/ 00753000
*   /* TO IDCAU01                                            @Z40LB25*/ 00754000
*   /*                                                               */ 00755000
*   /*****************************************************************/ 00756000
*                                                                  0541 00757000
*   IF GDTDBG=NULLPTR THEN                                         0541 00758000
@RF00539 L     @15,@PC00001                                        0541 00759000
         L     @15,GDTDBG(,@15)                                    0541 00760000
         LTR   @15,@15                                             0541 00761000
         BZ    @RT00541                                            0541 00762000
*     ;                                                            0542 00763000
*   ELSE                                                           0543 00764000
*     CALL IDCDB010(GDTTBL,'AUCZ'); /*                       @Z40LB25*/ 00765000
         L     @15,@PC00001                                        0543 00766000
         ST    @15,@AL00001                                        0543 00767000
         LA    @14,@CC01546                                        0543 00768000
         ST    @14,@AL00001+4                                      0543 00769000
         MVI   @AL00001+4,X'80'                                    0543 00770000
         L     @15,GDTDBG(,@15)                                    0543 00771000
         LA    @01,@AL00001                                        0543 00772000
         BALR  @14,@15                                             0543 00773000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0544 00774000
*                                                                  0544 00775000
@RT00541 L     @15,@PC00001                                        0544 00776000
         ST    @15,@AL00001                                        0544 00777000
         LA    @14,MODID                                           0544 00778000
         ST    @14,@AL00001+4                                      0544 00779000
         LA    @14,LASTCOND                                        0544 00780000
         ST    @14,@AL00001+8                                      0544 00781000
         MVI   @AL00001+8,X'80'                                    0544 00782000
         L     @15,GDTEPL(,@15)                                    0544 00783000
         LA    @01,@AL00001                                        0544 00784000
         BALR  @14,@15                                             0544 00785000
*   /*****************************************************************/ 00786000
*   /*                                                               */ 00787000
*   /*                                                       @Z40LB25*/ 00788000
*   /*                                                               */ 00789000
*   /*****************************************************************/ 00790000
*                                                                  0545 00791000
*                                                                  0545 00792000
*   /*****************************************************************/ 00793000
*   /*                                                               */ 00794000
*   /* PROCEDURE NAME - INITMAP                              @Z40LB25*/ 00795000
*   /*                                                       @Z40LB25*/ 00796000
*   /* FUNCTION - FOR THE FOLLOWING PARAMETERS OF CHECK -    @Z40LB25*/ 00797000
*   /* XRANGE AND ALL, OR CELL AND ALL, OR CELL              @Z40LB25*/ 00798000
*   /* AND FULL, OR CELL WITH EMPTY, AND FOR THE CELL        @Z40LB25*/ 00799000
*   /* PARAMETER OF READLABEL, THE ORIGINAL CELL MAP         @Z40LB25*/ 00800000
*   /* IS PLACED INTO WORKMAP. ON BITS                       @Z40LB25*/ 00801000
*   /* WILL INDICATE EMPTY AND FULL CELLS, AND OFF BITS      @Z40LB25*/ 00802000
*   /* WILL INDICATE MSF ACCESS AREAS, DRDS, ETC.            @Z40LB25*/ 00803000
*   /*                                                       @Z40LB25*/ 00804000
*   /* FOR READLABEL AND XRANGE, OR CHECK WITH FULL OR       @Z40LB25*/ 00805000
*   /* EMPTY, THE CURRENT MSF CELL MAP IS PLACED INTO        @Z40LB25*/ 00806000
*   /* WORKMAP. ON BITS WILL INDICATE                        @Z40LB25*/ 00807000
*   /* EMPTY CELLS AND OFF BITS WILL INDICATE                @Z40LB25*/ 00808000
*   /* FULL CELLS, MSF ACCESS AREAS, DRDS, ETC.              @Z40LB25*/ 00809000
*   /*                                                       @Z40LB25*/ 00810000
*   /* FOR CHECK WITH XRANGE AND FULL OR READLABEL           @Z40LB25*/ 00811000
*   /* WITH XRANGE THE MSC CELL MAP IS COPIED                @Z40LB25*/ 00812000
*   /* CELL INTO WORKMAP, THE BIT SETTINGS                   @Z40LB25*/ 00813000
*   /* IN WORKMAP ARE REVERSED, AND THE ORIGINAL             @Z40LB25*/ 00814000
*   /* MAP IS 'ANDED' WITH THE CONTENTS OF WORKMAP.          @Z40LB25*/ 00815000
*   /* ON BITS IN WORKMAP WILL INDICATE FULL CELLS.          @Z40LB25*/ 00816000
*   /* OFF BITS WILL INDICATE EMPTY CELLS, MSF ACCESS        @Z40LB25*/ 00817000
*   /* AREAS, DRDS, ETC.                                     @Z40LB25*/ 00818000
*   /*                                                       @Z40LB25*/ 00819000
*   /* INPUT -                                               @Z40LB25*/ 00820000
*   /* MSC CURRENT CELL MAP                                  @Z40LB25*/ 00821000
*   /* MSC ORIGINAL CELL MAP                                 @Z40LB25*/ 00822000
*   /* FDT                                                   @Z40LB25*/ 00823000
*   /* WORKMAP                                               @Z40LB25*/ 00824000
*   /*                                                       @Z40LB25*/ 00825000
*   /* OUTPUT -                                              @Z40LB25*/ 00826000
*   /* WORKMAP                                               @Z40LB25*/ 00827000
*   /*                                                               */ 00828000
*   /*****************************************************************/ 00829000
*                                                                  0545 00830000
*INITMAP:                                                          0545 00831000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 00832000
*                                                                  0545 00833000
@EL00001 L     @13,4(,@13)                                         0545 00834000
@EF00001 L     @00,@SIZDATD                                        0545 00835000
         LR    @01,@08                                             0545 00836000
         FREEMAIN R,LV=(0),A=(1)                                        00837000
@ER00001 LM    @14,@12,12(@13)                                     0545 00838000
         BR    @14                                                 0545 00839000
INITMAP  ST    @14,12(,@13)                                        0545 00840000
*   /*****************************************************************/ 00841000
*   /*                                                               */ 00842000
*   /* PROCESS THE FOLLOWING CHECK PARAMETERS - XRANGE       @Z40LB25*/ 00843000
*   /* AND ALL, CELL AND ALL, CELL AND EMPTY, OR CELL        @Z40LB25*/ 00844000
*   /* AND FULL. FOR READ, PROCESS THE CELL PARAMETER -      @Z40LB25*/ 00845000
*   /* (THIS WILL ALLOW THE READ REGARDLESS OF THE CELL      @Z40LB25*/ 00846000
*   /* BEING EMPTY OR FULL.                                  @Z40LB25*/ 00847000
*   /*                                                               */ 00848000
*   /*****************************************************************/ 00849000
*                                                                  0546 00850000
*   IF(ADDR(XRNG)^=NULLPTR&ADDR(CHALL)^=NULLPTR)|(ADDR(CELL)^=NULLPTR&( 00851000
*       ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR|ADDR(FULL)^=NULLPTR)) 00852000
*       |(ADDR(RDLBL)^=NULLPTR&ADDR(CELL)^=NULLPTR) THEN           0546 00853000
         SLR   @15,@15                                             0546 00854000
         L     @14,@PC00001+4                                      0546 00855000
         C     @15,FDTPTR+28(,@14)                                 0546 00856000
         BE    @GL00011                                            0546 00857000
         C     @15,FDTPTR+20(,@14)                                 0546 00858000
         BNE   @RT00546                                            0546 00859000
@GL00011 SLR   @15,@15                                             0546 00860000
         L     @14,@PC00001+4                                      0546 00861000
         C     @15,FDTPTR+40(,@14)                                 0546 00862000
         BE    @GL00010                                            0546 00863000
         C     @15,FDTPTR+20(,@14)                                 0546 00864000
         BNE   @RT00546                                            0546 00865000
         C     @15,FDTPTR+16(,@14)                                 0546 00866000
         BNE   @RT00546                                            0546 00867000
         C     @15,FDTPTR+12(,@14)                                 0546 00868000
         BNE   @RT00546                                            0546 00869000
@GL00010 SLR   @15,@15                                             0546 00870000
         L     @14,@PC00001+4                                      0546 00871000
         C     @15,FDTPTR+8(,@14)                                  0546 00872000
         BE    @RF00546                                            0546 00873000
         C     @15,FDTPTR+40(,@14)                                 0546 00874000
         BE    @RF00546                                            0546 00875000
@RT00546 DS    0H                                                  0547 00876000
*     DO;                           /*                       @Z40LB25*/ 00877000
*                                                                  0547 00878000
*       /*************************************************************/ 00879000
*       /*                                                           */ 00880000
*       /* PLACE THE ORIGINAL CELL MAP INTO WORKMAP          @Z40LB25*/ 00881000
*       /*                                                           */ 00882000
*       /*************************************************************/ 00883000
*                                                                  0548 00884000
*       DO I=1 TO BLKNUM;           /*                       @Z40LB25*/ 00885000
         LA    I,1                                                 0548 00886000
@DL00548 DS    0H                                                  0549 00887000
*         WRKCUBE(I)=ORIGCUBE(I);   /*                       @Z40LB25*/ 00888000
         LR    @05,I                                               0549 00889000
         MH    @05,@CH01230                                        0549 00890000
         L     @01,WRKMAPTR                                        0549 00891000
         ALR   @01,@05                                             0549 00892000
         AL    @01,@CF01672                                        0549 00893000
         L     @15,@PC00001+8                                      0549 00894000
         L     @15,BLKPTR(,@15)                                    0549 00895000
         ALR   @15,@05                                             0549 00896000
         MVC   WRKCUBE-8(256,@01),ORIGCUBE-264(@15)                0549 00897000
*       END;                        /*                       @Z40LB25*/ 00898000
         AL    I,@CF00224                                          0550 00899000
         C     I,@CF00047                                          0550 00900000
         BNH   @DL00548                                            0550 00901000
*       RETURN;                     /*                       @Z40LB25*/ 00902000
@EL00002 DS    0H                                                  0551 00903000
@EF00002 DS    0H                                                  0551 00904000
@ER00002 L     @14,12(,@13)                                        0551 00905000
         BR    @14                                                 0551 00906000
*     END;                          /*                       @Z40LB25*/ 00907000
*                                                                  0552 00908000
*   /*****************************************************************/ 00909000
*   /*                                                               */ 00910000
*   /* PLACE THE CURRENT MSF CELL MAP INTO WORKMAP           @Z40LB25*/ 00911000
*   /*                                                               */ 00912000
*   /*****************************************************************/ 00913000
*                                                                  0553 00914000
*   DO I=1 TO BLKNUM;               /* COPY MSC CELL MAP     @Z40LB25*/ 00915000
@RF00546 LA    I,1                                                 0553 00916000
@DL00553 DS    0H                                                  0554 00917000
*     WRKCUBE(I)=CELLCUBE(I);       /*                       @Z40LB25*/ 00918000
         LR    @05,I                                               0554 00919000
         MH    @05,@CH01230                                        0554 00920000
         L     @01,WRKMAPTR                                        0554 00921000
         ALR   @01,@05                                             0554 00922000
         AL    @01,@CF01672                                        0554 00923000
         L     @15,@PC00001+8                                      0554 00924000
         L     @15,BLKPTR(,@15)                                    0554 00925000
         ALR   @15,@05                                             0554 00926000
         MVC   WRKCUBE-8(256,@01),CELLCUBE-264(@15)                0554 00927000
*   END;                            /*                       @Z40LB25*/ 00928000
*                                                                  0555 00929000
         AL    I,@CF00224                                          0555 00930000
         C     I,@CF00047                                          0555 00931000
         BNH   @DL00553                                            0555 00932000
*   /*****************************************************************/ 00933000
*   /*                                                               */ 00934000
*   /* EMPTY AND XRANGE PARAMETERS OF CHECK?                 @Z40LB25*/ 00935000
*   /*                                                               */ 00936000
*   /*****************************************************************/ 00937000
*                                                                  0556 00938000
*   IF ADDR(XRNG)^=NULLPTR&ADDR(EMPTY)^=NULLPTR THEN               0556 00939000
         SLR   @15,@15                                             0556 00940000
         L     @14,@PC00001+4                                      0556 00941000
         C     @15,FDTPTR+28(,@14)                                 0556 00942000
         BE    @RF00556                                            0556 00943000
         C     @15,FDTPTR+16(,@14)                                 0556 00944000
         BNE   @RT00556                                            0556 00945000
*     RETURN;                       /*                       @Z40LB25*/ 00946000
*                                                                  0557 00947000
*   /*****************************************************************/ 00948000
*   /*                                                               */ 00949000
*   /* REVERSE THE BITS IN THE CURRENT CELL MAP.             @Z40LB25*/ 00950000
*   /* 1 BITS INDICATE FULL CELLS, FANS, DRDS, ETC.          @Z40LB25*/ 00951000
*   /* 0 BITS INDICATE AVAILABLE CELLS.                      @Z40LB25*/ 00952000
*   /*                                                               */ 00953000
*   /*****************************************************************/ 00954000
*                                                                  0558 00955000
*   DO I=1 TO BLKNUM;               /* 4 BLOCKS LOOP         @Z40LB25*/ 00956000
@RF00556 LA    I,1                                                 0558 00957000
@DL00558 DS    0H                                                  0559 00958000
*     DO II=1 TO LENGTH(WRKCUBE);   /* 1 BLOCK LOOP          @Z40LB25*/ 00959000
         LA    II,1                                                0559 00960000
@DL00559 DS    0H                                                  0560 00961000
*       WRKCUBE(I,II)=WRKCUBE(I,II)&&FLIPBITS;/*             @Z40LB25   00962000
*                                      REVERSE BITS          @Z40LB25*/ 00963000
         LR    @05,I                                               0560 00964000
         MH    @05,@CH01230                                        0560 00965000
         ALR   @05,II                                              0560 00966000
         L     @02,WRKMAPTR                                        0560 00967000
         ALR   @02,@05                                             0560 00968000
         AL    @02,@CF01670                                        0560 00969000
         XI    WRKCUBE-8(@02),X'FF'                                0560 00970000
*     END;                          /*                       @Z40LB25*/ 00971000
         AL    II,@CF00224                                         0561 00972000
         C     II,@CF01398                                         0561 00973000
         BNH   @DL00559                                            0561 00974000
*   END;                            /*                       @Z40LB25*/ 00975000
*                                                                  0562 00976000
         AL    I,@CF00224                                          0562 00977000
         C     I,@CF00047                                          0562 00978000
         BNH   @DL00558                                            0562 00979000
*   /*****************************************************************/ 00980000
*   /*                                                               */ 00981000
*   /* SET THE FULL CELL BITS ON FOR THE FULL                @Z40LB25*/ 00982000
*   /* PARAMETER OF CHECK AND READLABEL WITH XRANGE.         @Z40LB25*/ 00983000
*   /* ON BITS REPRESENT FULL CELLS.                         @Z40LB25*/ 00984000
*   /*                                                               */ 00985000
*   /*****************************************************************/ 00986000
*                                                                  0563 00987000
*   DO I=1 TO BLKNUM;               /*                       @Z40LB25*/ 00988000
         LA    I,1                                                 0563 00989000
@DL00563 DS    0H                                                  0564 00990000
*     WRKCUBE(I)=WRKCUBE(I)&ORIGCUBE(I);/*                   @Z40LB25*/ 00991000
         LR    @05,I                                               0564 00992000
         MH    @05,@CH01230                                        0564 00993000
         L     @01,WRKMAPTR                                        0564 00994000
         ALR   @01,@05                                             0564 00995000
         AL    @01,@CF01672                                        0564 00996000
         L     @15,@PC00001+8                                      0564 00997000
         L     @15,BLKPTR(,@15)                                    0564 00998000
         ALR   @15,@05                                             0564 00999000
         NC    WRKCUBE-8(256,@01),ORIGCUBE-264(@15)                0564 01000000
*   END;                            /*                       @Z40LB25*/ 01001000
         AL    I,@CF00224                                          0565 01002000
         C     I,@CF00047                                          0565 01003000
         BNH   @DL00563                                            0565 01004000
*   RETURN;                         /*                       @Z40LB25*/ 01005000
         B     @EL00002                                            0566 01006000
*   END INITMAP;                    /*                       @Z40LB25*/ 01007000
         B     @EL00002                                            0567 01008000
*                                                                  0568 01009000
*   /*****************************************************************/ 01010000
*   /*                                                               */ 01011000
*   /* PROCEDURE NAME - LIMITS                               @Z40LB25*/ 01012000
*   /*                                                       @Z40LB25*/ 01013000
*   /* FUNCTION - SET ANY ON BITS IN THE WORKMAP WHICH       @Z40LB25*/ 01014000
*   /* ARE OUTSIDE OF THE PHYSICAL MSF SIZE OFF.             @Z40LB25*/ 01015000
*   /* CALLS PROCXRNG TO PROCESS A REQUEST INVOLVING         @Z40LB25*/ 01016000
*   /* X RANGE(S) OR CALLS PROCCELL TO PROCESS A             @Z40LB25*/ 01017000
*   /* REQUEST INVOLVING CELL(S).                            @Z40LB25*/ 01018000
*   /*                                                       @Z40LB25*/ 01019000
*   /* INPUT -                                               @Z40LB25*/ 01020000
*   /* GDT                                                   @Z40LB25*/ 01021000
*   /* FDT                                                   @Z40LB25*/ 01022000
*   /* WORKMAP                                               @Z40LB25*/ 01023000
*   /* XYZ1                                                  @Z40LB25*/ 01024000
*   /*                                                       @Z40LB25*/ 01025000
*   /* OUTPUT -                                              @Z40LB25*/ 01026000
*   /* WORKMAP                                               @Z40LB25*/ 01027000
*   /* LIMITSRC                                              @Z40LB25*/ 01028000
*   /*                                                               */ 01029000
*   /*****************************************************************/ 01030000
*                                                                  0568 01031000
*LIMITS:                                                           0568 01032000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 01033000
LIMITS   ST    @14,@SA00003                                        0568 01034000
*   LIMITSRC=LASTCC00;              /* ZERO RETURN CODE      @Z40LB25*/ 01035000
         SLR   @15,@15                                             0569 01036000
         STH   @15,LIMITSRC                                        0569 01037000
*   TERMINAT=ON;                    /* ASSUME NO VALID RANGE @Z40LB25   01038000
*                                      OR CELL               @Z40LB25*/ 01039000
*                                                                  0570 01040000
         OI    TERMINAT,B'00100000'                                0570 01041000
*   /*****************************************************************/ 01042000
*   /*                                                               */ 01043000
*   /* CHECK FOR A USER SPECIFIED CELL(S)                    @Z40LB25*/ 01044000
*   /*                                                               */ 01045000
*   /*****************************************************************/ 01046000
*                                                                  0571 01047000
*   IF ADDR(CELL)^=NULLPTR THEN                                    0571 01048000
*                                                                  0571 01049000
         L     @14,@PC00001+4                                      0571 01050000
         C     @15,FDTPTR+40(,@14)                                 0571 01051000
         BE    @RF00571                                            0571 01052000
*     /***************************************************************/ 01053000
*     /*                                                             */ 01054000
*     /* PROCESS THE INPUT CELL(S)                           @Z40LB25*/ 01055000
*     /*                                                             */ 01056000
*     /***************************************************************/ 01057000
*                                                                  0572 01058000
*     CALL PROCCELL;                /*                       @Z40LB25*/ 01059000
*                                                                  0572 01060000
         BAL   @14,PROCCELL                                        0572 01061000
*   /*****************************************************************/ 01062000
*   /*                                                               */ 01063000
*   /* CHECK FOR A USER SPECIFIED XRANGE(S)                  @Z40LB25*/ 01064000
*   /*                                                               */ 01065000
*   /*****************************************************************/ 01066000
*                                                                  0573 01067000
*   IF ADDR(XRNG)^=NULLPTR THEN                                    0573 01068000
@RF00571 L     @15,@PC00001+4                                      0573 01069000
         L     @15,FDTPTR+28(,@15)                                 0573 01070000
         LTR   @15,@15                                             0573 01071000
         BZ    @RF00573                                            0573 01072000
*     DO;                           /*                       @Z40LB25*/ 01073000
*                                                                  0574 01074000
*       /*************************************************************/ 01075000
*       /*                                                           */ 01076000
*       /* ZERO THE PORTION OF WORKMAP WHICH IS NOT APPLICABLE       */ 01077000
*       /*                                                   @Z40LB25*/ 01078000
*       /* TO THIS SIZE MSF.                                 @Z40LB25*/ 01079000
*       /*                                                           */ 01080000
*       /*************************************************************/ 01081000
*                                                                  0575 01082000
*       CELLPTR=ADDR(WRKBLK(1));    /* CELL BLOCK PTR        @Z40LB25*/ 01083000
         L     @01,WRKMAPTR                                        0575 01084000
         ST    @01,CELLPTR                                         0575 01085000
*       X=XSTART;                   /* 150                   @Z40LB25*/ 01086000
*                                                                  0576 01087000
         MVC   X(2),@CH01256                                       0576 01088000
*       /*************************************************************/ 01089000
*       /*                                                           */ 01090000
*       /* SCAN THE FIRST THREE BLOCKS ONLY, BECAUSE MUST HAVE       */ 01091000
*       /*                                                   @Z40LB25*/ 01092000
*       /* AT LEAST X RANGE 234 TO 247 WHICH INCLUDES THE    @Z40LB25*/ 01093000
*       /* ENTIRE LAST BLOCK (MODEL 1)                       @Z40LB25*/ 01094000
*       /*                                                           */ 01095000
*       /*************************************************************/ 01096000
*                                                                  0577 01097000
*       DO BLKINDEX=1 TO BLKNUM-1 WHILE LIMITLOX=OFF;/*      @Z40LB25*/ 01098000
         LA    BLKINDEX,1                                          0577 01099000
@DL00577 TM    LIMITLOX,B'00100000'                                0577 01100000
         BNZ   @DC00577                                            0577 01101000
*         CHUNKPTR=ADDR(WRKCUBE(BLKINDEX));/*                @Z40LB25*/ 01102000
*                                                                  0578 01103000
         LR    @06,BLKINDEX                                        0578 01104000
         MH    @06,@CH01230                                        0578 01105000
         L     @01,WRKMAPTR                                        0578 01106000
         AL    @01,@CF01672                                        0578 01107000
         LA    @06,WRKCUBE-8(@06,@01)                              0578 01108000
         ST    @06,CHUNKPTR                                        0578 01109000
*         /***********************************************************/ 01110000
*         /*                                                         */ 01111000
*         /* BLOCKS 1 - 3                                    @Z40LB25*/ 01112000
*         /* SCAN THE CHUNKS OF EACH OF THE BLOCKS           @Z40LB25*/ 01113000
*         /*                                                         */ 01114000
*         /***********************************************************/ 01115000
*                                                                  0579 01116000
*         DO CHKINDEX=1 TO CHUNKNUM WHILE LIMITLOX=OFF;/*    @Z40LB25*/ 01117000
         LA    @06,1                                               0579 01118000
         STH   @06,CHKINDEX                                        0579 01119000
@DL00579 TM    LIMITLOX,B'00100000'                                0579 01120000
         BNZ   @DC00579                                            0579 01121000
*           CUBEPTR=CHUNKPTR;       /*                       @Z40LB25*/ 01122000
         L     CUBEPTR,CHUNKPTR                                    0580 01123000
*           IF X=>MSFLOWX-XSTART THEN                              0581 01124000
         L     @06,MSFLOWX                                         0581 01125000
         SL    @06,@CF01256                                        0581 01126000
         CH    @06,X                                               0581 01127000
         BH    @RF00581                                            0581 01128000
*             LIMITLOX=ON;          /*                       @Z40LB25*/ 01129000
*                                                                  0582 01130000
         OI    LIMITLOX,B'00100000'                                0582 01131000
*           /*********************************************************/ 01132000
*           /*                                                       */ 01133000
*           /* SCAN THE CUBES PER CHUNK                      @Z40LB25*/ 01134000
*           /*                                                       */ 01135000
*           /*********************************************************/ 01136000
*                                                                  0583 01137000
*           DO CUBINDEX=1 TO CUBENUM WHILE LIMITLOX=OFF;/*   @Z40LB25*/ 01138000
*                                                                  0583 01139000
@RF00581 LA    @06,1                                               0583 01140000
         STH   @06,CUBINDEX                                        0583 01141000
@DL00583 TM    LIMITLOX,B'00100000'                                0583 01142000
         BNZ   @DC00583                                            0583 01143000
*             /*******************************************************/ 01144000
*             /*                                                     */ 01145000
*             /* SCAN EACH BIT PER BYTE                      @Z40LB25*/ 01146000
*             /*                                                     */ 01147000
*             /*******************************************************/ 01148000
*                                                                  0584 01149000
*             DO BYTINDEX=1 TO BYTENUM WHILE LIMITLOX=OFF;/* @Z40LB25*/ 01150000
         LA    BYTINDEX,1                                          0584 01151000
@DL00584 TM    LIMITLOX,B'00100000'                                0584 01152000
         BNZ   @DC00584                                            0584 01153000
*               TEMPX=''B;          /*                       @Z40LB25*/ 01154000
         SLR   TEMPX,TEMPX                                         0585 01155000
*               IF X+TEMPX<MSFLOWX THEN/*                    @Z40LB25*/ 01156000
         LR    @06,TEMPX                                           0586 01157000
         AH    @06,X                                               0586 01158000
         C     @06,MSFLOWX                                         0586 01159000
         BNL   @RF00586                                            0586 01160000
*                 DO;               /*                       @Z40LB25*/ 01161000
*                   X0Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01162000
*                   X0Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01163000
         LR    @06,CUBEPTR                                         0589 01164000
         ALR   @06,BYTINDEX                                        0589 01165000
         AL    @06,@CF01674                                        0589 01166000
         NI    X0Z0(@06),B'00111111'                               0589 01167000
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/ 01168000
         AL    TEMPX,@CF00224                                      0590 01169000
*                 END;              /*                       @Z40LB25*/ 01170000
*               ELSE                                               0592 01171000
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/ 01172000
         B     @RC00586                                            0592 01173000
@RF00586 AL    TEMPX,@CF00224                                      0592 01174000
*               IF X+TEMPX<MSFLOWX THEN                            0593 01175000
@RC00586 LR    @06,TEMPX                                           0593 01176000
         AH    @06,X                                               0593 01177000
         C     @06,MSFLOWX                                         0593 01178000
         BNL   @RF00593                                            0593 01179000
*                 DO;               /*                       @Z40LB25*/ 01180000
*                   X1Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01181000
*                   X1Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01182000
         LR    @06,CUBEPTR                                         0596 01183000
         ALR   @06,BYTINDEX                                        0596 01184000
         AL    @06,@CF01674                                        0596 01185000
         NI    X1Z0(@06),B'11001111'                               0596 01186000
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/ 01187000
         AL    TEMPX,@CF00224                                      0597 01188000
*                 END;              /*                       @Z40LB25*/ 01189000
*               ELSE                                               0599 01190000
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/ 01191000
         B     @RC00593                                            0599 01192000
@RF00593 AL    TEMPX,@CF00224                                      0599 01193000
*               IF X+TEMPX<MSFLOWX THEN                            0600 01194000
@RC00593 LR    @06,TEMPX                                           0600 01195000
         AH    @06,X                                               0600 01196000
         C     @06,MSFLOWX                                         0600 01197000
         BNL   @RF00600                                            0600 01198000
*                 DO;               /*                       @Z40LB25*/ 01199000
*                   X2Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01200000
*                   X2Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01201000
         LR    @06,CUBEPTR                                         0603 01202000
         ALR   @06,BYTINDEX                                        0603 01203000
         AL    @06,@CF01674                                        0603 01204000
         NI    X2Z0(@06),B'11110011'                               0603 01205000
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/ 01206000
         AL    TEMPX,@CF00224                                      0604 01207000
*                 END;              /*                       @Z40LB25*/ 01208000
*               ELSE                                               0606 01209000
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/ 01210000
         B     @RC00600                                            0606 01211000
@RF00600 AL    TEMPX,@CF00224                                      0606 01212000
*               IF X+TEMPX<MSFLOWX THEN                            0607 01213000
@RC00600 LR    @06,TEMPX                                           0607 01214000
         AH    @06,X                                               0607 01215000
         C     @06,MSFLOWX                                         0607 01216000
         BNL   @RF00607                                            0607 01217000
*                 DO;               /*                       @Z40LB25*/ 01218000
*                   X3Z0(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01219000
*                   X3Z1(BYTINDEX)=OFF;/*                    @Z40LB25*/ 01220000
         LR    @06,CUBEPTR                                         0610 01221000
         ALR   @06,BYTINDEX                                        0610 01222000
         AL    @06,@CF01674                                        0610 01223000
         NI    X3Z0(@06),B'11111100'                               0610 01224000
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/ 01225000
         AL    TEMPX,@CF00224                                      0611 01226000
*                 END;              /*                       @Z40LB25*/ 01227000
*               ELSE                                               0613 01228000
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/ 01229000
         B     @RC00607                                            0613 01230000
@RF00607 AL    TEMPX,@CF00224                                      0613 01231000
*             END;                  /*                       @Z40LB25*/ 01232000
@RC00607 AL    BYTINDEX,@CF00224                                   0614 01233000
         C     BYTINDEX,@CF00047                                   0614 01234000
         BNH   @DL00584                                            0614 01235000
@DC00584 DS    0H                                                  0615 01236000
*             CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                @Z40LB25*/ 01237000
         AL    CUBEPTR,@CF00047                                    0615 01238000
*           END;                    /*                       @Z40LB25*/ 01239000
         LA    @06,1                                               0616 01240000
         AH    @06,CUBINDEX                                        0616 01241000
         STH   @06,CUBINDEX                                        0616 01242000
         C     @06,@CF00663                                        0616 01243000
         BNH   @DL00583                                            0616 01244000
@DC00583 DS    0H                                                  0617 01245000
*           CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*               @Z40LB25*/ 01246000
         LA    @06,32                                              0617 01247000
         AL    @06,CHUNKPTR                                        0617 01248000
         ST    @06,CHUNKPTR                                        0617 01249000
*           X=X+4;                  /*                       @Z40LB25*/ 01250000
         LA    @06,4                                               0618 01251000
         AH    @06,X                                               0618 01252000
         STH   @06,X                                               0618 01253000
*         END;                      /*                       @Z40LB25*/ 01254000
         LA    @06,1                                               0619 01255000
         AH    @06,CHKINDEX                                        0619 01256000
         STH   @06,CHKINDEX                                        0619 01257000
         C     @06,@CF00184                                        0619 01258000
         BNH   @DL00579                                            0619 01259000
@DC00579 DS    0H                                                  0620 01260000
*         CELLPTR=CELLPTR+BLKSIZE;  /*                       @Z40LB25*/ 01261000
         LA    @06,264                                             0620 01262000
         AL    @06,CELLPTR                                         0620 01263000
         ST    @06,CELLPTR                                         0620 01264000
*       END;                        /*                       @Z40LB25*/ 01265000
*                                                                  0621 01266000
         AL    BLKINDEX,@CF00224                                   0621 01267000
         C     BLKINDEX,@CF00167                                   0621 01268000
         BNH   @DL00577                                            0621 01269000
@DC00577 DS    0H                                                  0622 01270000
*       /*************************************************************/ 01271000
*       /*                                                           */ 01272000
*       /* PROCESS THE INPUT X RANGE(S)                      @Z40LB25*/ 01273000
*       /*                                                           */ 01274000
*       /*************************************************************/ 01275000
*                                                                  0622 01276000
*       CALL PROCXRNG;              /*                       @Z40LB25*/ 01277000
         BAL   @14,PROCXRNG                                        0622 01278000
*     END;                          /*                       @Z40LB25*/ 01279000
*   RETURN;                         /*                       @Z40LB25*/ 01280000
@EL00003 DS    0H                                                  0624 01281000
@EF00003 DS    0H                                                  0624 01282000
@ER00003 L     @14,@SA00003                                        0624 01283000
         BR    @14                                                 0624 01284000
*   END LIMITS;                     /*                       @Z40LB25*/ 01285000
         B     @EL00003                                            0625 01286000
*                                                                  0626 01287000
*   /*****************************************************************/ 01288000
*   /*                                                               */ 01289000
*   /* PROCEDURE NAME - PROCXRNG                             @Z40LB25*/ 01290000
*   /*                                                       @Z40LB25*/ 01291000
*   /* FUNCTION - INTERROGATE THE USER SPECIFIED XRANGE(S).  @Z40LB25*/ 01292000
*   /* IF ALL OR ANY OF THEM ARE INVALID (NOT WITHIN         @Z40LB25*/ 01293000
*   /* THE MSF) PRINT THE APPROPRIATE MESSAGE AND IF         @Z40LB25*/ 01294000
*   /* NECESSARY TERMINATE THE REQUEST. SET THE              @Z40LB25*/ 01295000
*   /* CORRESPONDING BIT(S) IN WORKMAP ON FOR THE USERS      @Z40LB25*/ 01296000
*   /* REQUESTED XRANGE(S).                                  @Z40LB25*/ 01297000
*   /*                                                       @Z40LB25*/ 01298000
*   /* INPUT -                                               @Z40LB25*/ 01299000
*   /* GDT                                                   @Z40LB25*/ 01300000
*   /* FDT                                                   @Z40LB25*/ 01301000
*   /* WORKMAP                                               @Z40LB25*/ 01302000
*   /*                                                       @Z40LB25*/ 01303000
*   /* OUTPUT -                                              @Z40LB25*/ 01304000
*   /* WORKMAP                                               @Z40LB25*/ 01305000
*   /* LIMITSRC                                              @Z40LB25*/ 01306000
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/ 01307000
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/ 01308000
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/ 01309000
*   /* IDC21144I - STID 6                                    @Z40LB25*/ 01310000
*   /* IDC21142I - STID 8                                    @Z40LB25*/ 01311000
*   /* IDC21141I - STID 10                                   @Z40LB25*/ 01312000
*   /*                                                               */ 01313000
*   /*****************************************************************/ 01314000
*                                                                  0626 01315000
*PROCXRNG:                                                         0626 01316000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 01317000
PROCXRNG ST    @14,@SA00004                                        0626 01318000
*   DO I=1 TO XRNGCNT;              /*                       @Z40LB25*/ 01319000
*                                                                  0627 01320000
         LA    I,1                                                 0627 01321000
         B     @DE00627                                            0627 01322000
@DL00627 DS    0H                                                  0628 01323000
*     /***************************************************************/ 01324000
*     /*                                                             */ 01325000
*     /* GET THE RANGES                                      @Z40LB25*/ 01326000
*     /*                                                             */ 01327000
*     /***************************************************************/ 01328000
*                                                                  0628 01329000
*     VALLOWX=LOWXPTR(I)->LOWXVAL;  /* SAVE LOW X            @Z40LB25*/ 01330000
*                                                                  0628 01331000
         LR    @05,I                                               0628 01332000
         SLA   @05,2                                               0628 01333000
         L     @15,@PC00001+4                                      0628 01334000
         L     @01,FDTPTR+32(,@15)                                 0628 01335000
         AL    @01,@CF01675                                        0628 01336000
         L     @01,LOWXPTR(@05,@01)                                0628 01337000
         L     @14,LOWXVAL(,@01)                                   0628 01338000
         STH   @14,VALLOWX                                         0628 01339000
*     /***************************************************************/ 01340000
*     /*                                                             */ 01341000
*     /* CHECK FOR NO HIGH X SPECIFIED                       @Z40LB25*/ 01342000
*     /*                                                             */ 01343000
*     /***************************************************************/ 01344000
*                                                                  0629 01345000
*     IF HIGHXPTR(I)=NULLPTR THEN   /* ANY HI X?             @Z40LB25*/ 01346000
         L     @01,FDTPTR+36(,@15)                                 0629 01347000
         AL    @01,@CF01675                                        0629 01348000
         L     @05,HIGHXPTR(@05,@01)                               0629 01349000
         LTR   @05,@05                                             0629 01350000
         BNZ   @RF00629                                            0629 01351000
*       VALHIGHX=VALLOWX;           /* SINGLE X RANGE        @Z40LB25*/ 01352000
         STH   @14,VALHIGHX                                        0630 01353000
*     ELSE                          /* GET HIGH X            @Z40LB25*/ 01354000
*       VALHIGHX=HIGHXPTR(I)->HIGHXVAL;/*                    @Z40LB25*/ 01355000
*                                                                  0631 01356000
         B     @RC00629                                            0631 01357000
@RF00629 LR    @05,I                                               0631 01358000
         SLA   @05,2                                               0631 01359000
         L     @15,@PC00001+4                                      0631 01360000
         L     @01,FDTPTR+36(,@15)                                 0631 01361000
         AL    @01,@CF01675                                        0631 01362000
         L     @05,HIGHXPTR(@05,@01)                               0631 01363000
         L     @05,HIGHXVAL(,@05)                                  0631 01364000
         STH   @05,VALHIGHX                                        0631 01365000
*     /***************************************************************/ 01366000
*     /*                                                             */ 01367000
*     /* INSURE LOWX AND HIGHX OF RANGE IS WITHIN THE MSF    @Z40LB25*/ 01368000
*     /*                                                             */ 01369000
*     /***************************************************************/ 01370000
*                                                                  0632 01371000
*     IF VALLOWX<MSFLOWX&VALHIGHX<MSFLOWX THEN                     0632 01372000
@RC00629 L     @05,MSFLOWX                                         0632 01373000
         CH    @05,VALLOWX                                         0632 01374000
         BNH   @RF00632                                            0632 01375000
         CH    @05,VALHIGHX                                        0632 01376000
         BNH   @RF00632                                            0632 01377000
*       DO;                         /*                       @Z40LB25*/ 01378000
*                                                                  0633 01379000
*         /***********************************************************/ 01380000
*         /*                                                         */ 01381000
*         /* ISSUE MESSAGE IDC21141I                         @Z40LB25*/ 01382000
*         /* INDICATE THE XRANGE NOT PROCESSED               @Z40LB25*/ 01383000
*         /*                                                         */ 01384000
*         /***********************************************************/ 01385000
*                                                                  0634 01386000
*         PRINTAB=''B;              /*                       @Z40LB25*/ 01387000
         XC    PRINTAB(164),PRINTAB                                0634 01388000
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/ 01389000
         L     @05,DDSTRU                                          0635 01390000
         MVC   DARGSMOD(3,@05),@CC01440                            0635 01391000
*         DARGSENT=MG21141R;        /*                       @Z40LB25*/ 01392000
         MVI   DARGSENT(@05),X'0A'                                 0636 01393000
*         DARGCNT=3;                /*                       @Z40LB25*/ 01394000
         LA    @15,3                                               0637 01395000
         STH   @15,DARGCNT(,@05)                                   0637 01396000
*         DARGINS(1)=1;             /*                       @Z40LB25*/ 01397000
         MVC   DARGINS(2,@05),@CH00224                             0638 01398000
*         DARGINL(1)=LENGTH(VALLOWX);/*                      @Z40LB25*/ 01399000
         LA    @14,2                                               0639 01400000
         STH   @14,DARGINL(,@05)                                   0639 01401000
*         DARGDTM(1)=ADDR(VALLOWX); /*                       @Z40LB25*/ 01402000
         LA    @07,VALLOWX                                         0640 01403000
         ST    @07,DARGDTM(,@05)                                   0640 01404000
*         DARGINS(2)=2;             /*                       @Z40LB25*/ 01405000
         STH   @14,DARGINS+8(,@05)                                 0641 01406000
*         DARGINL(2)=LENGTH(VALHIGHX);/*                     @Z40LB25*/ 01407000
         STH   @14,DARGINL+8(,@05)                                 0642 01408000
*         DARGDTM(2)=ADDR(VALHIGHX);/*                       @Z40LB25*/ 01409000
         LA    @14,VALHIGHX                                        0643 01410000
         ST    @14,DARGDTM+8(,@05)                                 0643 01411000
*         DARGINS(3)=3;             /*                       @Z40LB25*/ 01412000
         STH   @15,DARGINS+16(,@05)                                0644 01413000
*         DARGINL(3)=LENGTH(MSFVAL);/*                       @Z40LB25*/ 01414000
         MVC   DARGINL+16(2,@05),@CH00047                          0645 01415000
*         DARGDTM(3)=ADDR(MSFVAL);  /*                       @Z40LB25*/ 01416000
         L     @15,@PC00001+4                                      0646 01417000
         L     @15,FDTPTR+24(,@15)                                 0646 01418000
         ST    @15,DARGDTM+16(,@05)                                0646 01419000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/ 01420000
         L     @05,@PC00001                                        0647 01421000
         ST    @05,@AL00001                                        0647 01422000
         LA    @15,@CF00120                                        0647 01423000
         ST    @15,@AL00001+4                                      0647 01424000
         LA    @15,DDSTRU                                          0647 01425000
         ST    @15,@AL00001+8                                      0647 01426000
         MVI   @AL00001+8,X'80'                                    0647 01427000
         L     @15,GDTPRT(,@05)                                    0647 01428000
         LA    @01,@AL00001                                        0647 01429000
         BALR  @14,@15                                             0647 01430000
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/ 01431000
         MVC   LIMITSRC(2),@CH00184                                0648 01432000
*       END;                        /*                       @Z40LB25*/ 01433000
*                                                                  0649 01434000
*     /***************************************************************/ 01435000
*     /*                                                             */ 01436000
*     /* INSURE LOWX IS LESS THAN HIGHX                      @Z40LB25*/ 01437000
*     /*                                                             */ 01438000
*     /***************************************************************/ 01439000
*                                                                  0650 01440000
*     IF VALLOWX>VALHIGHX THEN                                     0650 01441000
@RF00632 LH    @05,VALLOWX                                         0650 01442000
         CH    @05,VALHIGHX                                        0650 01443000
         BNH   @RF00650                                            0650 01444000
*       DO;                         /*                       @Z40LB25*/ 01445000
*                                                                  0651 01446000
*         /***********************************************************/ 01447000
*         /*                                                         */ 01448000
*         /* ISSUE MESSAGE IDC21144I                         @Z40LB25*/ 01449000
*         /* INPUT LOW X IS GREATER THAN THE INPUT HIGH X    @Z40LB25*/ 01450000
*         /*                                                         */ 01451000
*         /***********************************************************/ 01452000
*                                                                  0652 01453000
*         PRINTAB=''B;              /*                       @Z40LB25*/ 01454000
         XC    PRINTAB(164),PRINTAB                                0652 01455000
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/ 01456000
         L     @05,DDSTRU                                          0653 01457000
         MVC   DARGSMOD(3,@05),@CC01440                            0653 01458000
*         DARGSENT=MG21144R;        /*                       @Z40LB25*/ 01459000
         MVI   DARGSENT(@05),X'06'                                 0654 01460000
*         DARGCNT=2;                /*                       @Z40LB25*/ 01461000
         LA    @15,2                                               0655 01462000
         STH   @15,DARGCNT(,@05)                                   0655 01463000
*         DARGINS(1)=1;             /*                       @Z40LB25*/ 01464000
         MVC   DARGINS(2,@05),@CH00224                             0656 01465000
*         DARGINL(1)=LENGTH(VALLOWX);/*                      @Z40LB25*/ 01466000
         STH   @15,DARGINL(,@05)                                   0657 01467000
*         DARGDTM(1)=ADDR(VALLOWX); /*                       @Z40LB25*/ 01468000
         LA    @14,VALLOWX                                         0658 01469000
         ST    @14,DARGDTM(,@05)                                   0658 01470000
*         DARGINS(2)=2;             /*                       @Z40LB25*/ 01471000
         STH   @15,DARGINS+8(,@05)                                 0659 01472000
*         DARGINL(2)=LENGTH(VALHIGHX);/*                     @Z40LB25*/ 01473000
         STH   @15,DARGINL+8(,@05)                                 0660 01474000
*         DARGDTM(2)=ADDR(VALHIGHX);/*                       @Z40LB25*/ 01475000
         LA    @15,VALHIGHX                                        0661 01476000
         ST    @15,DARGDTM+8(,@05)                                 0661 01477000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/ 01478000
         L     @05,@PC00001                                        0662 01479000
         ST    @05,@AL00001                                        0662 01480000
         LA    @15,@CF00120                                        0662 01481000
         ST    @15,@AL00001+4                                      0662 01482000
         LA    @15,DDSTRU                                          0662 01483000
         ST    @15,@AL00001+8                                      0662 01484000
         MVI   @AL00001+8,X'80'                                    0662 01485000
         L     @15,GDTPRT(,@05)                                    0662 01486000
         LA    @01,@AL00001                                        0662 01487000
         BALR  @14,@15                                             0662 01488000
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/ 01489000
         MVC   LIMITSRC(2),@CH00184                                0663 01490000
*       END;                        /*                       @Z40LB25*/ 01491000
*                                                                  0664 01492000
*     /***************************************************************/ 01493000
*     /*                                                             */ 01494000
*     /* INSURE LOWX IS NOT LESS THAN THE LOWX ALLOWED       @Z40LB25*/ 01495000
*     /* FOR THIS MSF IF A HIGHX WAS SPECIFIED               @Z40LB25*/ 01496000
*     /*                                                             */ 01497000
*     /***************************************************************/ 01498000
*                                                                  0665 01499000
*     IF VALLOWX<MSFLOWX&VALLOWX^=VALHIGHX&VALHIGHX>=MSFLOWX THEN  0665 01500000
@RF00650 LH    @05,VALLOWX                                         0665 01501000
         L     @15,MSFLOWX                                         0665 01502000
         CR    @05,@15                                             0665 01503000
         BNL   @RF00665                                            0665 01504000
         LH    @14,VALHIGHX                                        0665 01505000
         CR    @05,@14                                             0665 01506000
         BE    @RF00665                                            0665 01507000
         CR    @14,@15                                             0665 01508000
         BL    @RF00665                                            0665 01509000
*       DO;                         /*                       @Z40LB25*/ 01510000
*                                                                  0666 01511000
*         /***********************************************************/ 01512000
*         /*                                                         */ 01513000
*         /* ISSUE MESSAGE IDC21141I                         @Z40LB25*/ 01514000
*         /* X RANGE BETWEEN THE INPUT LOW X AND THE MSF LOW @Z40LB25*/ 01515000
*         /* IS NOT PROCESSED                                @Z40LB25*/ 01516000
*         /*                                                         */ 01517000
*         /***********************************************************/ 01518000
*                                                                  0667 01519000
*         PRINTAB=''B;              /*                       @Z40LB25*/ 01520000
         XC    PRINTAB(164),PRINTAB                                0667 01521000
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/ 01522000
         L     @05,DDSTRU                                          0668 01523000
         MVC   DARGSMOD(3,@05),@CC01440                            0668 01524000
*         DARGSENT=MG21141R;        /*                       @Z40LB25*/ 01525000
         MVI   DARGSENT(@05),X'0A'                                 0669 01526000
*         DARGCNT=3;                /*                       @Z40LB25*/ 01527000
         LA    @14,3                                               0670 01528000
         STH   @14,DARGCNT(,@05)                                   0670 01529000
*         DARGINS(1)=1;             /*                       @Z40LB25*/ 01530000
         MVC   DARGINS(2,@05),@CH00224                             0671 01531000
*         DARGINL(1)=LENGTH(VALLOWX);/*                      @Z40LB25*/ 01532000
         LA    @07,2                                               0672 01533000
         STH   @07,DARGINL(,@05)                                   0672 01534000
*         DARGDTM(1)=ADDR(VALLOWX); /*                       @Z40LB25*/ 01535000
         LA    @06,VALLOWX                                         0673 01536000
         ST    @06,DARGDTM(,@05)                                   0673 01537000
*         DARGINS(2)=2;             /*                       @Z40LB25*/ 01538000
         STH   @07,DARGINS+8(,@05)                                 0674 01539000
*         HIBADX=MSFLOWX-1;         /*                       @Z40LB25*/ 01540000
         BCTR  @15,0                                               0675 01541000
         ST    @15,HIBADX                                          0675 01542000
*         DARGINL(2)=LENGTH(HIBADX);/*                       @Z40LB25*/ 01543000
         LA    @15,4                                               0676 01544000
         STH   @15,DARGINL+8(,@05)                                 0676 01545000
*         DARGDTM(2)=ADDR(HIBADX);  /*                       @Z40LB25*/ 01546000
         LA    @07,HIBADX                                          0677 01547000
         ST    @07,DARGDTM+8(,@05)                                 0677 01548000
*         DARGINS(3)=3;             /*                       @Z40LB25*/ 01549000
         STH   @14,DARGINS+16(,@05)                                0678 01550000
*         DARGINL(3)=LENGTH(MSFVAL);/*                       @Z40LB25*/ 01551000
         STH   @15,DARGINL+16(,@05)                                0679 01552000
*         DARGDTM(3)=ADDR(MSFVAL);  /*                       @Z40LB25*/ 01553000
         L     @15,@PC00001+4                                      0680 01554000
         L     @15,FDTPTR+24(,@15)                                 0680 01555000
         ST    @15,DARGDTM+16(,@05)                                0680 01556000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/ 01557000
         L     @05,@PC00001                                        0681 01558000
         ST    @05,@AL00001                                        0681 01559000
         LA    @15,@CF00120                                        0681 01560000
         ST    @15,@AL00001+4                                      0681 01561000
         LA    @15,DDSTRU                                          0681 01562000
         ST    @15,@AL00001+8                                      0681 01563000
         MVI   @AL00001+8,X'80'                                    0681 01564000
         L     @15,GDTPRT(,@05)                                    0681 01565000
         LA    @01,@AL00001                                        0681 01566000
         BALR  @14,@15                                             0681 01567000
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/ 01568000
         MVC   LIMITSRC(2),@CH00184                                0682 01569000
*         VALLOWX=MSFLOWX;          /* RESET INPUT LOW X     @Z40LB25*/ 01570000
         L     @05,MSFLOWX                                         0683 01571000
         STH   @05,VALLOWX                                         0683 01572000
*       END;                        /*                       @Z40LB25*/ 01573000
*                                                                  0684 01574000
*     /***************************************************************/ 01575000
*     /*                                                             */ 01576000
*     /* CHECK IF AN X RANGE IS TO BE PROCESSED              @Z40LB25*/ 01577000
*     /*                                                             */ 01578000
*     /***************************************************************/ 01579000
*                                                                  0685 01580000
*     IF(VALLOWX=<VALHIGHX)&((VALLOWX=>MSFLOWX)&(VALHIGHX=>MSFLOWX))    01581000
*       THEN                                                       0685 01582000
@RF00665 LH    @05,VALLOWX                                         0685 01583000
         LH    @15,VALHIGHX                                        0685 01584000
         CR    @05,@15                                             0685 01585000
         BH    @RF00685                                            0685 01586000
         L     @14,MSFLOWX                                         0685 01587000
         CR    @05,@14                                             0685 01588000
         BL    @RF00685                                            0685 01589000
         CR    @15,@14                                             0685 01590000
         BL    @RF00685                                            0685 01591000
*       DO;                         /*                       @Z40LB25*/ 01592000
*         PROCHIX=OFF;              /*                       @Z40LB25*/ 01593000
         NI    PROCHIX,B'11101111'                                 0687 01594000
*         TERMINAT=OFF;             /* DON'T PRINT IDC21142I @Z40LB25*/ 01595000
         NI    TERMINAT,B'11011111'                                0688 01596000
*         X=XSTART;                 /* 1ST X (150)           @Z40LB25*/ 01597000
         MVC   X(2),@CH01256                                       0689 01598000
*         CELLPTR=ADDR(XYZ1BLK(1)); /* CELL BLOCK PTR        @Z40LB25*/ 01599000
*                                                                  0690 01600000
         L     @05,XYZ1PTR                                         0690 01601000
         ST    @05,CELLPTR                                         0690 01602000
*         /***********************************************************/ 01603000
*         /*                                                         */ 01604000
*         /* SET BITS IN XYZ1 ON WHICH ARE WITH              @Z40LB25*/ 01605000
*         /* IN THE X RANGE                                  @Z40LB25*/ 01606000
*         /*                                                         */ 01607000
*         /***********************************************************/ 01608000
*                                                                  0691 01609000
*         DO BLKINDEX=1 TO BLKNUM WHILE PROCHIX=OFF;/*       @Z40LB25*/ 01610000
         LA    BLKINDEX,1                                          0691 01611000
@DL00691 TM    PROCHIX,B'00010000'                                 0691 01612000
         BNZ   @DC00691                                            0691 01613000
*           CHUNKPTR=ADDR(XYZ1CUBE(BLKINDEX));/*             @Z40LB25*/ 01614000
*                                                                  0692 01615000
         LR    @06,BLKINDEX                                        0692 01616000
         MH    @06,@CH01230                                        0692 01617000
         L     @05,XYZ1PTR                                         0692 01618000
         AL    @05,@CF01672                                        0692 01619000
         LA    @06,XYZ1CUBE-8(@06,@05)                             0692 01620000
         ST    @06,CHUNKPTR                                        0692 01621000
*           /*********************************************************/ 01622000
*           /*                                                       */ 01623000
*           /* BLOCKS 1 - 4                                  @Z40LB25*/ 01624000
*           /* SCAN THE CHUNKS OF EACH OF THE BLOCKS         @Z40LB25*/ 01625000
*           /*                                                       */ 01626000
*           /*********************************************************/ 01627000
*                                                                  0693 01628000
*           DO CHKINDEX=1 TO CHUNKNUM WHILE PROCHIX=OFF;/*   @Z40LB25*/ 01629000
         LA    @06,1                                               0693 01630000
         STH   @06,CHKINDEX                                        0693 01631000
@DL00693 TM    PROCHIX,B'00010000'                                 0693 01632000
         BNZ   @DC00693                                            0693 01633000
*             CUBEPTR=CHUNKPTR;     /*                       @Z40LB25*/ 01634000
         L     CUBEPTR,CHUNKPTR                                    0694 01635000
*             IF X>VALHIGHX THEN                                   0695 01636000
         LH    @06,X                                               0695 01637000
         CH    @06,VALHIGHX                                        0695 01638000
         BNH   @RF00695                                            0695 01639000
*               PROCHIX=ON;         /*                       @Z40LB25*/ 01640000
*                                                                  0696 01641000
         OI    PROCHIX,B'00010000'                                 0696 01642000
*             /*******************************************************/ 01643000
*             /*                                                     */ 01644000
*             /* SCAN THE CUBES PER CHUNK                    @Z40LB25*/ 01645000
*             /*                                                     */ 01646000
*             /*******************************************************/ 01647000
*                                                                  0697 01648000
*             DO CUBINDEX=1 TO CUBENUM WHILE PROCHIX=OFF;/*  @Z40LB25*/ 01649000
*                                                                  0697 01650000
@RF00695 LA    @06,1                                               0697 01651000
         STH   @06,CUBINDEX                                        0697 01652000
@DL00697 TM    PROCHIX,B'00010000'                                 0697 01653000
         BNZ   @DC00697                                            0697 01654000
*               /*****************************************************/ 01655000
*               /*                                                   */ 01656000
*               /* SCAN EACH BIT PER BYTE                    @Z40LB25*/ 01657000
*               /*                                                   */ 01658000
*               /*****************************************************/ 01659000
*                                                                  0698 01660000
*               DO BYTINDEX=1 TO BYTENUM WHILE PROCHIX=OFF;/*      0698 01661000
*                                                            @Z40LB25*/ 01662000
         LA    BYTINDEX,1                                          0698 01663000
@DL00698 TM    PROCHIX,B'00010000'                                 0698 01664000
         BNZ   @DC00698                                            0698 01665000
*                 TEMPX=''B;        /*                       @Z40LB25*/ 01666000
         SLR   TEMPX,TEMPX                                         0699 01667000
*                 IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN       0700 01668000
         LR    @06,TEMPX                                           0700 01669000
         AH    @06,X                                               0700 01670000
         CH    @06,VALLOWX                                         0700 01671000
         BL    @RF00700                                            0700 01672000
         CH    @06,VALHIGHX                                        0700 01673000
         BH    @RF00700                                            0700 01674000
*                   DO;             /*                       @Z40LB25*/ 01675000
*                     X0Z0(BYTINDEX)=ON;/*                   @Z40LB25*/ 01676000
*                     X0Z1(BYTINDEX)=ON;/*                   @Z40LB25*/ 01677000
         LR    @06,CUBEPTR                                         0703 01678000
         ALR   @06,BYTINDEX                                        0703 01679000
         AL    @06,@CF01674                                        0703 01680000
         OI    X0Z0(@06),B'11000000'                               0703 01681000
*                     TEMPX=TEMPX+1;/*                       @Z40LB25*/ 01682000
         AL    TEMPX,@CF00224                                      0704 01683000
*                   END;            /*                       @Z40LB25*/ 01684000
*                 ELSE                                             0706 01685000
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/ 01686000
         B     @RC00700                                            0706 01687000
@RF00700 AL    TEMPX,@CF00224                                      0706 01688000
*                 IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN       0707 01689000
@RC00700 LR    @06,TEMPX                                           0707 01690000
         AH    @06,X                                               0707 01691000
         CH    @06,VALLOWX                                         0707 01692000
         BL    @RF00707                                            0707 01693000
         CH    @06,VALHIGHX                                        0707 01694000
         BH    @RF00707                                            0707 01695000
*                   DO;             /*                       @Z40LB25*/ 01696000
*                     X1Z0(BYTINDEX)=ON;/*                   @Z40LB25*/ 01697000
*                     X1Z1(BYTINDEX)=ON;/*                   @Z40LB25*/ 01698000
         LR    @06,CUBEPTR                                         0710 01699000
         ALR   @06,BYTINDEX                                        0710 01700000
         AL    @06,@CF01674                                        0710 01701000
         OI    X1Z0(@06),B'00110000'                               0710 01702000
*                     TEMPX=TEMPX+1;/*                       @Z40LB25*/ 01703000
         AL    TEMPX,@CF00224                                      0711 01704000
*                   END;            /*                       @Z40LB25*/ 01705000
*                 ELSE                                             0713 01706000
*                   TEMPX=TEMPX+1;  /*                       @Z40LB25*/ 01707000
*                                                                  0713 01708000
         B     @RC00707                                            0713 01709000
@RF00707 AL    TEMPX,@CF00224                                      0713 01710000
*                 /***************************************************/ 01711000
*                 /*                                                 */ 01712000
*                 /* CHECK FOR THE LAST BLOCK                @Z40LB25*/ 01713000
*                 /*                                                 */ 01714000
*                 /***************************************************/ 01715000
*                                                                  0714 01716000
*                 IF BLKINDEX^=BLKNUM THEN/* LAST BLOCK      @Z40LB25*/ 01717000
@RC00707 C     BLKINDEX,@CF00047                                   0714 01718000
         BE    @RF00714                                            0714 01719000
*                   DO;             /*                       @Z40LB25*/ 01720000
*                     IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN   0716 01721000
         LR    @06,TEMPX                                           0716 01722000
         AH    @06,X                                               0716 01723000
         CH    @06,VALLOWX                                         0716 01724000
         BL    @RF00716                                            0716 01725000
         CH    @06,VALHIGHX                                        0716 01726000
         BH    @RF00716                                            0716 01727000
*                       DO;         /*                       @Z40LB25*/ 01728000
*                         X2Z0(BYTINDEX)=ON;/*               @Z40LB25*/ 01729000
*                         X2Z1(BYTINDEX)=ON;/*               @Z40LB25*/ 01730000
         LR    @06,CUBEPTR                                         0719 01731000
         ALR   @06,BYTINDEX                                        0719 01732000
         AL    @06,@CF01674                                        0719 01733000
         OI    X2Z0(@06),B'00001100'                               0719 01734000
*                         TEMPX=TEMPX+1;/*                   @Z40LB25*/ 01735000
         AL    TEMPX,@CF00224                                      0720 01736000
*                       END;        /*                       @Z40LB25*/ 01737000
*                     ELSE                                         0722 01738000
*                       TEMPX=TEMPX+1;/*                     @Z40LB25*/ 01739000
         B     @RC00716                                            0722 01740000
@RF00716 AL    TEMPX,@CF00224                                      0722 01741000
*                     IF X+TEMPX>=VALLOWX&X+TEMPX<=VALHIGHX THEN   0723 01742000
@RC00716 LR    @06,TEMPX                                           0723 01743000
         AH    @06,X                                               0723 01744000
         CH    @06,VALLOWX                                         0723 01745000
         BL    @RF00723                                            0723 01746000
         CH    @06,VALHIGHX                                        0723 01747000
         BH    @RF00723                                            0723 01748000
*                       DO;         /*                       @Z40LB25*/ 01749000
*                         X3Z0(BYTINDEX)=ON;/*               @Z40LB25*/ 01750000
*                         X3Z1(BYTINDEX)=ON;/*               @Z40LB25*/ 01751000
         LR    @06,CUBEPTR                                         0726 01752000
         ALR   @06,BYTINDEX                                        0726 01753000
         AL    @06,@CF01674                                        0726 01754000
         OI    X3Z0(@06),B'00000011'                               0726 01755000
*                         TEMPX=TEMPX+1;/*                   @Z40LB25*/ 01756000
         AL    TEMPX,@CF00224                                      0727 01757000
*                       END;        /*                       @Z40LB25*/ 01758000
*                   END;            /*                       @Z40LB25*/ 01759000
@RF00723 DS    0H                                                  0730 01760000
*               END;                /*                       @Z40LB25*/ 01761000
@RF00714 AL    BYTINDEX,@CF00224                                   0730 01762000
         C     BYTINDEX,@CF00047                                   0730 01763000
         BNH   @DL00698                                            0730 01764000
@DC00698 DS    0H                                                  0731 01765000
*               CUBEPTR=CUBEPTR+LENGTH(CUBE);/*              @Z40LB25*/ 01766000
         AL    CUBEPTR,@CF00047                                    0731 01767000
*             END;                  /*                       @Z40LB25*/ 01768000
*                                                                  0732 01769000
         LA    @06,1                                               0732 01770000
         AH    @06,CUBINDEX                                        0732 01771000
         STH   @06,CUBINDEX                                        0732 01772000
         C     @06,@CF00663                                        0732 01773000
         BNH   @DL00697                                            0732 01774000
@DC00697 DS    0H                                                  0733 01775000
*             /*******************************************************/ 01776000
*             /*                                                     */ 01777000
*             /* IF AT THE LAST BLOCK, IT WILL CONTAIN       @Z40LB25*/ 01778000
*             /* ONLY ONE CHUNK                              @Z40LB25*/ 01779000
*             /*                                                     */ 01780000
*             /*******************************************************/ 01781000
*                                                                  0733 01782000
*             IF BLKINDEX=BLKNUM THEN                              0733 01783000
         C     BLKINDEX,@CF00047                                   0733 01784000
         BNE   @RF00733                                            0733 01785000
*               CHKINDEX=CHUNKNUM;  /*                       @Z40LB25*/ 01786000
         MVC   CHKINDEX(2),@CH00184                                0734 01787000
*             CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*             @Z40LB25*/ 01788000
@RF00733 LA    @06,32                                              0735 01789000
         AL    @06,CHUNKPTR                                        0735 01790000
         ST    @06,CHUNKPTR                                        0735 01791000
*             X=X+4;                /*                       @Z40LB25*/ 01792000
         LA    @06,4                                               0736 01793000
         AH    @06,X                                               0736 01794000
         STH   @06,X                                               0736 01795000
*           END;                    /*                       @Z40LB25*/ 01796000
         LA    @06,1                                               0737 01797000
         AH    @06,CHKINDEX                                        0737 01798000
         STH   @06,CHKINDEX                                        0737 01799000
         C     @06,@CF00184                                        0737 01800000
         BNH   @DL00693                                            0737 01801000
@DC00693 DS    0H                                                  0738 01802000
*           CELLPTR=CELLPTR+BLKSIZE;/*                       @Z40LB25*/ 01803000
         LA    @06,264                                             0738 01804000
         AL    @06,CELLPTR                                         0738 01805000
         ST    @06,CELLPTR                                         0738 01806000
*         END;                      /*                       @Z40LB25*/ 01807000
         AL    BLKINDEX,@CF00224                                   0739 01808000
         C     BLKINDEX,@CF00047                                   0739 01809000
         BNH   @DL00691                                            0739 01810000
@DC00691 DS    0H                                                  0740 01811000
*       END;                        /*                       @Z40LB25*/ 01812000
*   END;                            /*                       @Z40LB25*/ 01813000
*                                                                  0741 01814000
@RF00685 AL    I,@CF00224                                          0741 01815000
@DE00627 L     @05,@PC00001+4                                      0741 01816000
         LA    @05,FDTPTR+28(,@05)                                 0741 01817000
         C     I,XRNGCNT(,@05)                                     0741 01818000
         BNH   @DL00627                                            0741 01819000
*   /*****************************************************************/ 01820000
*   /*                                                               */ 01821000
*   /* ZERO ALL AREAS OUTSIDE OF THE X RANGE(S)              @Z40LB25*/ 01822000
*   /* IN WORKMAP                                            @Z40LB25*/ 01823000
*   /*                                                               */ 01824000
*   /*****************************************************************/ 01825000
*                                                                  0742 01826000
*   IF TERMINAT=OFF THEN                                           0742 01827000
         TM    TERMINAT,B'00100000'                                0742 01828000
         BNZ   @RF00742                                            0742 01829000
*     DO I=1 TO BLKNUM;             /*                       @Z40LB25*/ 01830000
         LA    I,1                                                 0743 01831000
@DL00743 DS    0H                                                  0744 01832000
*       DO II=1 TO LENGTH(WRKCUBE); /*                       @Z40LB25*/ 01833000
         LA    II,1                                                0744 01834000
@DL00744 DS    0H                                                  0745 01835000
*         WRKCUBE(I,II)=WRKCUBE(I,II)&XYZ1CUBE(I,II);/*      @Z40LB25*/ 01836000
         LR    @05,I                                               0745 01837000
         MH    @05,@CH01230                                        0745 01838000
         ALR   @05,II                                              0745 01839000
         L     @02,WRKMAPTR                                        0745 01840000
         ALR   @02,@05                                             0745 01841000
         AL    @02,@CF01670                                        0745 01842000
         L     @01,XYZ1PTR                                         0745 01843000
         ALR   @01,@05                                             0745 01844000
         AL    @01,@CF01670                                        0745 01845000
         NC    WRKCUBE-8(1,@02),XYZ1CUBE-8(@01)                    0745 01846000
*       END;                        /*                       @Z40LB25*/ 01847000
         AL    II,@CF00224                                         0746 01848000
         C     II,@CF01398                                         0746 01849000
         BNH   @DL00744                                            0746 01850000
*     END;                          /*                       @Z40LB25*/ 01851000
         AL    I,@CF00224                                          0747 01852000
         C     I,@CF00047                                          0747 01853000
         BNH   @DL00743                                            0747 01854000
*   ELSE                                                           0748 01855000
*                                                                  0748 01856000
*     /***************************************************************/ 01857000
*     /*                                                             */ 01858000
*     /* ISSUE MSG IDC31142I                                 @Z40LB25*/ 01859000
*     /* NO VALID XRANGES SPECIFIED                          @Z40LB25*/ 01860000
*     /*                                                             */ 01861000
*     /***************************************************************/ 01862000
*                                                                  0748 01863000
*     DO;                           /*                       @Z40LB25*/ 01864000
         B     @RC00742                                            0748 01865000
@RF00742 DS    0H                                                  0749 01866000
*       LIMITSRC=LASTCC12;          /*                       @Z40LB25*/ 01867000
         MVC   LIMITSRC(2),@CH00571                                0749 01868000
*       PRINTAB=''B;                /*                       @Z40LB25*/ 01869000
         XC    PRINTAB(164),PRINTAB                                0750 01870000
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/ 01871000
         L     @15,DDSTRU                                          0751 01872000
         MVC   DARGSMOD(3,@15),@CC01440                            0751 01873000
*       DARGSENT=MG21142R;          /*                       @Z40LB25*/ 01874000
         MVI   DARGSENT(@15),X'08'                                 0752 01875000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/ 01876000
         L     @15,@PC00001                                        0753 01877000
         ST    @15,@AL00001                                        0753 01878000
         LA    @14,@CF00120                                        0753 01879000
         ST    @14,@AL00001+4                                      0753 01880000
         LA    @14,DDSTRU                                          0753 01881000
         ST    @14,@AL00001+8                                      0753 01882000
         MVI   @AL00001+8,X'80'                                    0753 01883000
         L     @15,GDTPRT(,@15)                                    0753 01884000
         LA    @01,@AL00001                                        0753 01885000
         BALR  @14,@15                                             0753 01886000
*     END;                          /*                       @Z40LB25*/ 01887000
*   RETURN;                         /*                       @Z40LB25*/ 01888000
@EL00004 DS    0H                                                  0755 01889000
@EF00004 DS    0H                                                  0755 01890000
@ER00004 L     @14,@SA00004                                        0755 01891000
         BR    @14                                                 0755 01892000
*   END PROCXRNG;                   /*                       @Z40LB25*/ 01893000
         B     @EL00004                                            0756 01894000
*                                                                  0757 01895000
*   /*****************************************************************/ 01896000
*   /*                                                               */ 01897000
*   /* PROCEDURE NAME - PROCCELL                             @Z40LB25*/ 01898000
*   /*                                                       @Z40LB25*/ 01899000
*   /* FUNCTION - INTERROGATE THE USER SPECIFIED CELL(S)     @Z40LB25*/ 01900000
*   /* IF ALL OR ANY OF THEM ARE INVALID (NOT WITHIN         @Z40LB25*/ 01901000
*   /* THE MSF) PRINT THE APPROPRIATE MESSAGE AND IF         @Z40LB25*/ 01902000
*   /* NECESSARY TERMINATE THE REQUEST. SET THE              @Z40LB25*/ 01903000
*   /* CORRESPONDING BIT(S) IN WORKMAP ON FOR THE USERS      @Z40LB25*/ 01904000
*   /* REQUESTED CELL(S).                                    @Z40LB25*/ 01905000
*   /*                                                       @Z40LB25*/ 01906000
*   /* INPUT -                                               @Z40LB25*/ 01907000
*   /* GDT                                                   @Z40LB25*/ 01908000
*   /* FDT                                                   @Z40LB25*/ 01909000
*   /* WORKMAP                                               @Z40LB25*/ 01910000
*   /*                                                       @Z40LB25*/ 01911000
*   /* OUTPUT -                                              @Z40LB25*/ 01912000
*   /* WORKMAP                                               @Z40LB25*/ 01913000
*   /* LIMITSRC                                              @Z40LB25*/ 01914000
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/ 01915000
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/ 01916000
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/ 01917000
*   /* IDC21142I - STID 7                                    @Z40LB25*/ 01918000
*   /* IDC21141I - STID 9                                    @Z40LB25*/ 01919000
*   /*                                                               */ 01920000
*   /*****************************************************************/ 01921000
*                                                                  0757 01922000
*PROCCELL:                                                         0757 01923000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 01924000
*                                                                  0757 01925000
PROCCELL ST    @14,@SA00005                                        0757 01926000
*   /*****************************************************************/ 01927000
*   /*                                                               */ 01928000
*   /* FLIP THE BITS IN WORKMAP                              @Z40LB25*/ 01929000
*   /*                                                               */ 01930000
*   /*****************************************************************/ 01931000
*                                                                  0758 01932000
*   DO I=1 TO BLKNUM;               /* 4 BLOCKS LOOP         @Z40LB25*/ 01933000
         LA    I,1                                                 0758 01934000
@DL00758 DS    0H                                                  0759 01935000
*     DO II=1 TO LENGTH(WRKCUBE);   /* 1 BLOCK LOOP          @Z40LB25*/ 01936000
         LA    II,1                                                0759 01937000
@DL00759 DS    0H                                                  0760 01938000
*       WRKCUBE(I,II)=WRKCUBE(I,II)&&FLIPBITS;/*             @Z40LB25   01939000
*                                      REVERSE BITS          @Z40LB25*/ 01940000
         LR    @05,I                                               0760 01941000
         MH    @05,@CH01230                                        0760 01942000
         ALR   @05,II                                              0760 01943000
         L     @02,WRKMAPTR                                        0760 01944000
         ALR   @02,@05                                             0760 01945000
         AL    @02,@CF01670                                        0760 01946000
         XI    WRKCUBE-8(@02),X'FF'                                0760 01947000
*     END;                          /*                       @Z40LB25*/ 01948000
         AL    II,@CF00224                                         0761 01949000
         C     II,@CF01398                                         0761 01950000
         BNH   @DL00759                                            0761 01951000
*   END;                            /*                       @Z40LB25*/ 01952000
*                                                                  0762 01953000
         AL    I,@CF00224                                          0762 01954000
         C     I,@CF00047                                          0762 01955000
         BNH   @DL00758                                            0762 01956000
*   /*****************************************************************/ 01957000
*   /*                                                               */ 01958000
*   /* CHECK THE USER SUPPLIED X Y Z(S)                      @Z40LB25*/ 01959000
*   /*                                                               */ 01960000
*   /*****************************************************************/ 01961000
*                                                                  0763 01962000
*   DO I=1 TO CELLCNT;              /*                       @Z40LB25*/ 01963000
*                                                                  0763 01964000
         LA    I,1                                                 0763 01965000
         B     @DE00763                                            0763 01966000
@DL00763 DS    0H                                                  0764 01967000
*     /***************************************************************/ 01968000
*     /*                                                             */ 01969000
*     /* GET THE X Y Z OF THE CELL                           @Z40LB25*/ 01970000
*     /*                                                             */ 01971000
*     /***************************************************************/ 01972000
*                                                                  0764 01973000
*     X=CELLXPTR(I)->CELLXVAL;      /* USER X                @Z40LB25*/ 01974000
         LR    @05,I                                               0764 01975000
         SLA   @05,2                                               0764 01976000
         L     @15,@PC00001+4                                      0764 01977000
         L     @01,FDTPTR+44(,@15)                                 0764 01978000
         AL    @01,@CF01675                                        0764 01979000
         L     @01,CELLXPTR(@05,@01)                               0764 01980000
         L     @14,CELLXVAL(,@01)                                  0764 01981000
         STH   @14,X                                               0764 01982000
*     Y=CELLYPTR(I)->CELLYVAL;      /* USER Y                @Z40LB25*/ 01983000
         L     @01,FDTPTR+48(,@15)                                 0765 01984000
         AL    @01,@CF01675                                        0765 01985000
         L     @01,CELLYPTR(@05,@01)                               0765 01986000
         L     @07,CELLYVAL(,@01)                                  0765 01987000
         ST    @07,Y                                               0765 01988000
*     Z=CELLZPTR(I)->CELLZVAL;      /* USER Z                @Z40LB25*/ 01989000
*                                                                  0766 01990000
         L     @01,FDTPTR+52(,@15)                                 0766 01991000
         AL    @01,@CF01675                                        0766 01992000
         L     @05,CELLZPTR(@05,@01)                               0766 01993000
         L     @05,CELLZVAL(,@05)                                  0766 01994000
         STH   @05,Z                                               0766 01995000
*     /***************************************************************/ 01996000
*     /*                                                             */ 01997000
*     /* INSURE X VALUE OF INPUT X Y Z IS WITHIN THE MSF     @Z40LB25*/ 01998000
*     /*                                                             */ 01999000
*     /***************************************************************/ 02000000
*                                                                  0767 02001000
*     IF X<MSFLOWX THEN                                            0767 02002000
         C     @14,MSFLOWX                                         0767 02003000
         BNL   @RF00767                                            0767 02004000
*       DO;                         /*                       @Z40LB25*/ 02005000
*                                                                  0768 02006000
*         /***********************************************************/ 02007000
*         /*                                                         */ 02008000
*         /* ISSUE MESSAGE IDC21141I                         @Z40LB25*/ 02009000
*         /* INDICATE THE CELL NOT PROCESSED                 @Z40LB25*/ 02010000
*         /* BECAUSE IT IS LESS THAN THE LOW MSF X           @Z40LB25*/ 02011000
*         /*                                                         */ 02012000
*         /***********************************************************/ 02013000
*                                                                  0769 02014000
*         PRINTAB=''B;              /*                       @Z40LB25*/ 02015000
         XC    PRINTAB(164),PRINTAB                                0769 02016000
*         DARGSMOD=AUDMSG;          /*                       @Z40LB25*/ 02017000
         L     @05,DDSTRU                                          0770 02018000
         MVC   DARGSMOD(3,@05),@CC01440                            0770 02019000
*         DARGSENT=MG21141C;        /*                       @Z40LB25*/ 02020000
         MVI   DARGSENT(@05),X'09'                                 0771 02021000
*         DARGCNT=4;                /*                       @Z40LB25*/ 02022000
         LA    @14,4                                               0772 02023000
         STH   @14,DARGCNT(,@05)                                   0772 02024000
*         DARGINS(1)=1;             /*                       @Z40LB25*/ 02025000
         MVC   DARGINS(2,@05),@CH00224                             0773 02026000
*         DARGINL(1)=LENGTH(X);     /*                       @Z40LB25*/ 02027000
         LA    @07,2                                               0774 02028000
         STH   @07,DARGINL(,@05)                                   0774 02029000
*         DARGDTM(1)=ADDR(X);       /*                       @Z40LB25*/ 02030000
         LA    @06,X                                               0775 02031000
         ST    @06,DARGDTM(,@05)                                   0775 02032000
*         DARGINS(2)=2;             /*                       @Z40LB25*/ 02033000
         STH   @07,DARGINS+8(,@05)                                 0776 02034000
*         DARGINL(2)=LENGTH(Y);     /*                       @Z40LB25*/ 02035000
         STH   @14,DARGINL+8(,@05)                                 0777 02036000
*         DARGDTM(2)=ADDR(Y);       /*                       @Z40LB25*/ 02037000
         LA    @06,Y                                               0778 02038000
         ST    @06,DARGDTM+8(,@05)                                 0778 02039000
*         DARGINS(3)=3;             /*                       @Z40LB25*/ 02040000
         MVC   DARGINS+16(2,@05),@CH00167                          0779 02041000
*         DARGINL(3)=LENGTH(Z);     /*                       @Z40LB25*/ 02042000
         STH   @07,DARGINL+16(,@05)                                0780 02043000
*         DARGDTM(3)=ADDR(Z);       /*                       @Z40LB25*/ 02044000
         LA    @07,Z                                               0781 02045000
         ST    @07,DARGDTM+16(,@05)                                0781 02046000
*         DARGINS(4)=4;             /*                       @Z40LB25*/ 02047000
         STH   @14,DARGINS+24(,@05)                                0782 02048000
*         DARGINL(4)=LENGTH(MSFVAL);/*                       @Z40LB25*/ 02049000
         STH   @14,DARGINL+24(,@05)                                0783 02050000
*         DARGDTM(4)=ADDR(MSFVAL);  /*                       @Z40LB25*/ 02051000
         L     @15,FDTPTR+24(,@15)                                 0784 02052000
         ST    @15,DARGDTM+24(,@05)                                0784 02053000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB25*/ 02054000
         L     @05,@PC00001                                        0785 02055000
         ST    @05,@AL00001                                        0785 02056000
         LA    @15,@CF00120                                        0785 02057000
         ST    @15,@AL00001+4                                      0785 02058000
         LA    @15,DDSTRU                                          0785 02059000
         ST    @15,@AL00001+8                                      0785 02060000
         MVI   @AL00001+8,X'80'                                    0785 02061000
         L     @15,GDTPRT(,@05)                                    0785 02062000
         LA    @01,@AL00001                                        0785 02063000
         BALR  @14,@15                                             0785 02064000
*         LIMITSRC=LASTCC08;        /*                       @Z40LB25*/ 02065000
         MVC   LIMITSRC(2),@CH00184                                0786 02066000
*       END;                        /*                       @Z40LB25*/ 02067000
*                                                                  0787 02068000
*     /***************************************************************/ 02069000
*     /*                                                             */ 02070000
*     /* CHECK IF THERE ARE CELLS TO BE PROCESSED            @Z40LB25*/ 02071000
*     /*                                                             */ 02072000
*     /***************************************************************/ 02073000
*                                                                  0788 02074000
*     IF X=>MSFLOWX THEN                                           0788 02075000
@RF00767 LH    @05,X                                               0788 02076000
         C     @05,MSFLOWX                                         0788 02077000
         BL    @RF00788                                            0788 02078000
*       DO;                         /*                       @Z40LB25*/ 02079000
*         TERMINAT=OFF;             /*                       @Z40LB25*/ 02080000
         NI    TERMINAT,B'11011111'                                0790 02081000
*         CHUNKPTR=ADDR(WRKCUBE(1));/* WORKMAP               @Z40LB25*/ 02082000
         L     @05,WRKMAPTR                                        0791 02083000
         LA    @15,WRKCUBE(,@05)                                   0791 02084000
         ST    @15,CHUNKPTR                                        0791 02085000
*         CELLPTR=ADDR(WRKBLK(1));  /*                       @Z40LB25*/ 02086000
*                                                                  0792 02087000
         ST    @05,CELLPTR                                         0792 02088000
*         /***********************************************************/ 02089000
*         /*                                                         */ 02090000
*         /* CONVERT THE XYZ LOCATION TO AN ON BIT IN WORKMAP        */ 02091000
*         /*                                                 @Z40LB25*/ 02092000
*         /*                                                         */ 02093000
*         /***********************************************************/ 02094000
*                                                                  0793 02095000
*         CALL LOCTOBIT;            /*                       @Z40LB25*/ 02096000
         BAL   @14,LOCTOBIT                                        0793 02097000
*       END;                        /*                       @Z40LB25*/ 02098000
*   END;                            /*                       @Z40LB25*/ 02099000
*                                                                  0795 02100000
@RF00788 AL    I,@CF00224                                          0795 02101000
@DE00763 L     @05,@PC00001+4                                      0795 02102000
         LA    @05,FDTPTR+40(,@05)                                 0795 02103000
         C     I,CELLCNT(,@05)                                     0795 02104000
         BNH   @DL00763                                            0795 02105000
*   /*****************************************************************/ 02106000
*   /*                                                               */ 02107000
*   /* ZERO ALL CELLS OTHER THAN THE USER X Y Z(S)           @Z40LB25*/ 02108000
*   /* IN WORKMAP                                            @Z40LB25*/ 02109000
*   /*                                                               */ 02110000
*   /*****************************************************************/ 02111000
*                                                                  0796 02112000
*   IF TERMINAT=OFF THEN                                           0796 02113000
         TM    TERMINAT,B'00100000'                                0796 02114000
         BNZ   @RF00796                                            0796 02115000
*     DO I=1 TO BLKNUM;             /*                       @Z40LB25*/ 02116000
         LA    I,1                                                 0797 02117000
@DL00797 DS    0H                                                  0798 02118000
*       DO II=1 TO LENGTH(WRKCUBE); /*                       @Z40LB25*/ 02119000
         LA    II,1                                                0798 02120000
@DL00798 DS    0H                                                  0799 02121000
*         WRKCUBE(I,II)=WRKCUBE(I,II)&ORIGCUBE(I,II);/*      @Z40LB25*/ 02122000
         LR    @05,I                                               0799 02123000
         MH    @05,@CH01230                                        0799 02124000
         ALR   @05,II                                              0799 02125000
         L     @02,WRKMAPTR                                        0799 02126000
         ALR   @02,@05                                             0799 02127000
         AL    @02,@CF01670                                        0799 02128000
         L     @15,@PC00001+8                                      0799 02129000
         L     @01,BLKPTR(,@15)                                    0799 02130000
         ALR   @01,@05                                             0799 02131000
         NC    WRKCUBE-8(1,@02),ORIGCUBE-265(@01)                  0799 02132000
*       END;                        /*                       @Z40LB25*/ 02133000
         AL    II,@CF00224                                         0800 02134000
         C     II,@CF01398                                         0800 02135000
         BNH   @DL00798                                            0800 02136000
*     END;                          /*                       @Z40LB25*/ 02137000
         AL    I,@CF00224                                          0801 02138000
         C     I,@CF00047                                          0801 02139000
         BNH   @DL00797                                            0801 02140000
*   ELSE                                                           0802 02141000
*                                                                  0802 02142000
*     /***************************************************************/ 02143000
*     /*                                                             */ 02144000
*     /* ISSUE MSG IDC31142I                                 @Z40LB25*/ 02145000
*     /* NO VALID CELLS SPECIFIED                            @Z40LB25*/ 02146000
*     /*                                                             */ 02147000
*     /***************************************************************/ 02148000
*                                                                  0802 02149000
*     DO;                           /*                       @Z40LB25*/ 02150000
         B     @RC00796                                            0802 02151000
@RF00796 DS    0H                                                  0803 02152000
*       LIMITSRC=LASTCC12;          /*                       @Z40LB25*/ 02153000
         MVC   LIMITSRC(2),@CH00571                                0803 02154000
*       PRINTAB=''B;                /*                       @Z40LB25*/ 02155000
         XC    PRINTAB(164),PRINTAB                                0804 02156000
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/ 02157000
         L     @15,DDSTRU                                          0805 02158000
         MVC   DARGSMOD(3,@15),@CC01440                            0805 02159000
*       DARGSENT=MG21142C;          /*                       @Z40LB25*/ 02160000
         MVI   DARGSENT(@15),X'07'                                 0806 02161000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/ 02162000
         L     @15,@PC00001                                        0807 02163000
         ST    @15,@AL00001                                        0807 02164000
         LA    @14,@CF00120                                        0807 02165000
         ST    @14,@AL00001+4                                      0807 02166000
         LA    @14,DDSTRU                                          0807 02167000
         ST    @14,@AL00001+8                                      0807 02168000
         MVI   @AL00001+8,X'80'                                    0807 02169000
         L     @15,GDTPRT(,@15)                                    0807 02170000
         LA    @01,@AL00001                                        0807 02171000
         BALR  @14,@15                                             0807 02172000
*     END;                          /*                       @Z40LB25*/ 02173000
*   RETURN;                         /*                       @Z40LB25*/ 02174000
@EL00005 DS    0H                                                  0809 02175000
@EF00005 DS    0H                                                  0809 02176000
@ER00005 L     @14,@SA00005                                        0809 02177000
         BR    @14                                                 0809 02178000
*   END PROCCELL;                   /*                       @Z40LB25*/ 02179000
         B     @EL00005                                            0810 02180000
*                                                                  0811 02181000
*   /*****************************************************************/ 02182000
*   /*                                                               */ 02183000
*   /* PROCEDURE NAME - CHECKLIB                             @Z40LB25*/ 02184000
*   /*                                                       @Z40LB25*/ 02185000
*   /* FUNCTION - THIS IS THE CONTROL PROCEDURE              @Z40LB25*/ 02186000
*   /* FOR GATHERING THE RESULTS OF THE MSC CHECK            @Z40LB25*/ 02187000
*   /* CELL AND PRINTING THE AUDITMSS CHECK REPORT.          @Z40LB25*/ 02188000
*   /*                                                       @Z40LB25*/ 02189000
*   /* INPUT -                                               @Z40LB25*/ 02190000
*   /* GDT                                                   @Z40LB25*/ 02191000
*   /* FDT                                                   @Z40LB25*/ 02192000
*   /* WORKMAP                                               @Z40LB25*/ 02193000
*   /*                                                       @Z40LB25*/ 02194000
*   /* OUTPUT -                                              @Z40LB25*/ 02195000
*   /* CHECKRC                                               @Z40LB25*/ 02196000
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/ 02197000
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/ 02198000
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/ 02199000
*   /* IDC21143I - STID 4                                    @Z40LB25*/ 02200000
*   /* IDC21145I - STID 44                                   @Z40LB25*/ 02201000
*   /*                                                               */ 02202000
*   /*****************************************************************/ 02203000
*                                                                  0811 02204000
*CHECKLIB:                                                         0811 02205000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 02206000
CHECKLIB ST    @14,@SA00006                                        0811 02207000
*   CHECKRC=LASTCC00;               /* ZERO RETURN CODE      @Z40LB25*/ 02208000
*                                                                  0812 02209000
         SLR   @15,@15                                             0812 02210000
         STH   @15,CHECKRC                                         0812 02211000
*   /*****************************************************************/ 02212000
*   /*                                                               */ 02213000
*   /* CHECK THE USER SPECIFIED CELLS                        @Z40LB25*/ 02214000
*   /*                                                               */ 02215000
*   /*****************************************************************/ 02216000
*                                                                  0813 02217000
*   CALL CKCELL;                    /*                       @Z40LB25*/ 02218000
*                                                                  0813 02219000
         BAL   @14,CKCELL                                          0813 02220000
*   /*****************************************************************/ 02221000
*   /*                                                               */ 02222000
*   /* PRINT THE CHECK REPORT SUBTITLE                       @Z40LB25*/ 02223000
*   /*                                                               */ 02224000
*   /*****************************************************************/ 02225000
*                                                                  0814 02226000
*   IF CHECKRC^=LASTCC12&(PRTXYZ1=ON|PRTXYZ2=ON) THEN              0814 02227000
         CLC   CHECKRC(2),@CH00571                                 0814 02228000
         BE    @RF00814                                            0814 02229000
         TM    PRTXYZ1,B'01100000'                                 0814 02230000
         BZ    @RF00814                                            0814 02231000
*     DO;                           /*                       @Z40LB25*/ 02232000
*                                                                  0815 02233000
*       /*************************************************************/ 02234000
*       /*                                                           */ 02235000
*       /* SELECT THE CORRECT SUBTITLE                       @Z40LB25*/ 02236000
*       /*                                                           */ 02237000
*       /*************************************************************/ 02238000
*                                                                  0816 02239000
*       IF ADDR(CHALL)^=NULLPTR THEN                               0816 02240000
         L     @15,@PC00001+4                                      0816 02241000
         L     @15,FDTPTR+20(,@15)                                 0816 02242000
         LTR   @15,@15                                             0816 02243000
         BZ    @RF00816                                            0816 02244000
*         HDCKID11=ON;              /*                       @Z40LB25*/ 02245000
         OI    HDCKID11,B'10000000'                                0817 02246000
*       IF ADDR(FULL)^=NULLPTR THEN                                0818 02247000
@RF00816 L     @15,@PC00001+4                                      0818 02248000
         L     @15,FDTPTR+12(,@15)                                 0818 02249000
         LTR   @15,@15                                             0818 02250000
         BZ    @RF00818                                            0818 02251000
*         HDCKID12=ON;              /*                       @Z40LB25*/ 02252000
         OI    HDCKID12,B'01000000'                                0819 02253000
*       IF ADDR(EMPTY)^=NULLPTR THEN                               0820 02254000
@RF00818 L     @15,@PC00001+4                                      0820 02255000
         L     @15,FDTPTR+16(,@15)                                 0820 02256000
         LTR   @15,@15                                             0820 02257000
         BZ    @RF00820                                            0820 02258000
*         HDCKID13=ON;              /*                       @Z40LB25*/ 02259000
         OI    HDCKID13,B'00100000'                                0821 02260000
*       CALL HEADSET;               /*                       @Z40LB25*/ 02261000
*                                                                  0822 02262000
@RF00820 BAL   @14,HEADSET                                         0822 02263000
*       /*************************************************************/ 02264000
*       /*                                                           */ 02265000
*       /* PRINT THE CHECK REPORT                            @Z40LB25*/ 02266000
*       /*                                                           */ 02267000
*       /*************************************************************/ 02268000
*                                                                  0823 02269000
*       CALL PRINTXYZ;              /*                       @Z40LB25*/ 02270000
         BAL   @14,PRINTXYZ                                        0823 02271000
*     END;                          /*                       @Z40LB25*/ 02272000
*                                                                  0824 02273000
*   /*****************************************************************/ 02274000
*   /*                                                               */ 02275000
*   /* CHECK IF AN ERROR HAS OCCURRED                        @Z40LB25*/ 02276000
*   /*                                                               */ 02277000
*   /*****************************************************************/ 02278000
*                                                                  0825 02279000
*   IF CHECKRC^=LASTCC00 THEN                                      0825 02280000
@RF00814 LH    @15,CHECKRC                                         0825 02281000
         LTR   @15,@15                                             0825 02282000
         BZ    @RF00825                                            0825 02283000
*     DO;                           /*                       @Z40LB25*/ 02284000
*       PRINTAB=''B;                /*                       @Z40LB25*/ 02285000
         XC    PRINTAB(164),PRINTAB                                0827 02286000
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/ 02287000
*                                                                  0828 02288000
         L     @14,DDSTRU                                          0828 02289000
         MVC   DARGSMOD(3,@14),@CC01440                            0828 02290000
*       /*************************************************************/ 02291000
*       /*                                                           */ 02292000
*       /* MSG IDC21147I                                     @Z40LB25*/ 02293000
*       /* CHECK FOR AN INCOMPLETE REPORT                    @Z40LB25*/ 02294000
*       /*                                                           */ 02295000
*       /*************************************************************/ 02296000
*                                                                  0829 02297000
*       IF CHECKRC=LASTCC08&(XYZ1PRTD=ON|XYZ2PRTD=ON) THEN         0829 02298000
         C     @15,@CF00184                                        0829 02299000
         BNE   @RF00829                                            0829 02300000
         TM    XYZ1PRTD,B'00000011'                                0829 02301000
         BZ    @RF00829                                            0829 02302000
*         DARGSENT=MG21147C;        /*                       @Z40LB25*/ 02303000
*                                                                  0830 02304000
         MVI   DARGSENT(@14),X'04'                                 0830 02305000
*       /*************************************************************/ 02306000
*       /*                                                           */ 02307000
*       /* MSG IDC31148I                                     @Z40LB25*/ 02308000
*       /* NO REPORT PRODUCED                                @Z40LB25*/ 02309000
*       /*                                                           */ 02310000
*       /*************************************************************/ 02311000
*                                                                  0831 02312000
*       ELSE                                                       0831 02313000
*         DO;                       /*                       @Z40LB25*/ 02314000
         B     @RC00829                                            0831 02315000
@RF00829 DS    0H                                                  0832 02316000
*           DARGSENT=MG31148C;      /*                       @Z40LB25*/ 02317000
         L     @01,DDSTRU                                          0832 02318000
         MVI   DARGSENT(@01),X'2C'                                 0832 02319000
*           CHECKRC=LASTCC12;       /*                       @Z40LB25*/ 02320000
         MVC   CHECKRC(2),@CH00571                                 0833 02321000
*         END;                      /*                       @Z40LB25*/ 02322000
*       DARGCNT=2;                  /*                       @Z40LB25*/ 02323000
@RC00829 LA    @15,2                                               0835 02324000
         L     @14,DDSTRU                                          0835 02325000
         STH   @15,DARGCNT(,@14)                                   0835 02326000
*       DARGINS(1)=1;               /*                       @Z40LB25*/ 02327000
         LA    @07,1                                               0836 02328000
         STH   @07,DARGINS(,@14)                                   0836 02329000
*       X=QUXADDR;                  /*                       @Z40LB25*/ 02330000
         L     @01,RDCKPTR                                         0837 02331000
         SLR   @00,@00                                             0837 02332000
         IC    @00,QUXADDR(,@01)                                   0837 02333000
         STH   @00,X                                               0837 02334000
*       DARGINL(1)=LENGTH(X);       /*                       @Z40LB25*/ 02335000
         STH   @15,DARGINL(,@14)                                   0838 02336000
*       DARGDTM(1)=ADDR(X);         /*                       @Z40LB25*/ 02337000
         LA    @06,X                                               0839 02338000
         ST    @06,DARGDTM(,@14)                                   0839 02339000
*       DARGINS(2)=2;               /*                       @Z40LB25*/ 02340000
         STH   @15,DARGINS+8(,@14)                                 0840 02341000
*       IF X=246 THEN                                              0841 02342000
         C     @00,@CF01567                                        0841 02343000
         BNE   @RF00841                                            0841 02344000
*         X1=X+1;                   /* 247                   @Z40LB25*/ 02345000
         ALR   @00,@07                                             0842 02346000
         STH   @00,X1                                              0842 02347000
*       ELSE                                                       0843 02348000
*         X1=X+4;                   /*                       @Z40LB25*/ 02349000
         B     @RC00841                                            0843 02350000
@RF00841 LA    @15,4                                               0843 02351000
         AH    @15,X                                               0843 02352000
         STH   @15,X1                                              0843 02353000
*       DARGINL(2)=LENGTH(X1);      /*                       @Z40LB25*/ 02354000
@RC00841 L     @15,DDSTRU                                          0844 02355000
         MVC   DARGINL+8(2,@15),@CH00158                           0844 02356000
*       DARGDTM(2)=ADDR(X1);        /*                       @Z40LB25*/ 02357000
         LA    @14,X1                                              0845 02358000
         ST    @14,DARGDTM+8(,@15)                                 0845 02359000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/ 02360000
         L     @15,@PC00001                                        0846 02361000
         ST    @15,@AL00001                                        0846 02362000
         LA    @14,@CF00120                                        0846 02363000
         ST    @14,@AL00001+4                                      0846 02364000
         LA    @14,DDSTRU                                          0846 02365000
         ST    @14,@AL00001+8                                      0846 02366000
         MVI   @AL00001+8,X'80'                                    0846 02367000
         L     @15,GDTPRT(,@15)                                    0846 02368000
         LA    @01,@AL00001                                        0846 02369000
         BALR  @14,@15                                             0846 02370000
*     END;                          /*                       @Z40LB25*/ 02371000
*   RETURN;                         /*                       @Z40LB25*/ 02372000
@EL00006 DS    0H                                                  0848 02373000
@EF00006 DS    0H                                                  0848 02374000
@ER00006 L     @14,@SA00006                                        0848 02375000
         BR    @14                                                 0848 02376000
*   END CHECKLIB;                   /*                       @Z40LB25*/ 02377000
         B     @EL00006                                            0849 02378000
*                                                                  0850 02379000
*   /*****************************************************************/ 02380000
*   /*                                                               */ 02381000
*   /* PROCEDURE NAME - READLBL                              @Z40LB25*/ 02382000
*   /*                                                       @Z40LB25*/ 02383000
*   /* FUNCTION - THIS IS THE CONTROL PROCEDURE              @Z40LB25*/ 02384000
*   /* FOR GATHERING THE RESULTS OF THE MSC READ LABEL       @Z40LB25*/ 02385000
*   /* AND PRINTING THE AUDITMSS READ LABEL REPORT.          @Z40LB25*/ 02386000
*   /*                                                       @Z40LB25*/ 02387000
*   /* INPUT -                                               @Z40LB25*/ 02388000
*   /* GDT                                                   @Z40LB25*/ 02389000
*   /* FDT                                                   @Z40LB25*/ 02390000
*   /* WORKMAP                                               @Z40LB25*/ 02391000
*   /*                                                       @Z40LB25*/ 02392000
*   /* OUTPUT -                                              @Z40LB25*/ 02393000
*   /* READRC                                                @Z40LB25*/ 02394000
*   /* 12 - NO REPORT TO BE PRINTED                          @Z40LB25*/ 02395000
*   /* 8 - PARTIAL REPORT TO BE PRINTED                      @Z40LB25*/ 02396000
*   /* THE FOLLOWING MESSAGES -                              @Z40LB25*/ 02397000
*   /* IDC21143I - STID 5                                    @Z40LB25*/ 02398000
*   /* IDC21145I - STID 45                                   @Z40LB25*/ 02399000
*   /*                                                               */ 02400000
*   /*****************************************************************/ 02401000
*                                                                  0850 02402000
*READLBL:                                                          0850 02403000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 02404000
READLBL  ST    @14,@SA00007                                        0850 02405000
*   READRC=LASTCC00;                /* ZERO RETURN CODE      @Z40LB25*/ 02406000
*                                                                  0851 02407000
         SLR   @15,@15                                             0851 02408000
         STH   @15,READRC                                          0851 02409000
*   /*****************************************************************/ 02410000
*   /*                                                               */ 02411000
*   /* READ THE USER SPECIFIED CARTRIDGES AND PRINT THE      @Z40LB25*/ 02412000
*   /* THE FIRST PART OF THE READ LABEL REPORT               @Z40LB25*/ 02413000
*   /*                                                               */ 02414000
*   /*****************************************************************/ 02415000
*                                                                  0852 02416000
*   CALL READ;                      /*                       @Z40LB25*/ 02417000
*                                                                  0852 02418000
         BAL   @14,READ                                            0852 02419000
*   /*****************************************************************/ 02420000
*   /*                                                               */ 02421000
*   /* PRINT THE LAST TWO PARTS OF THE READ LABEL REPORT     @Z40LB25*/ 02422000
*   /*                                                               */ 02423000
*   /*****************************************************************/ 02424000
*                                                                  0853 02425000
*   IF READRC^=LASTCC12&(PRTXYZ1=ON|PRTXYZ2=ON) THEN               0853 02426000
         CLC   READRC(2),@CH00571                                  0853 02427000
         BE    @RF00853                                            0853 02428000
         TM    PRTXYZ1,B'01100000'                                 0853 02429000
         BZ    @RF00853                                            0853 02430000
*     CALL PRINTXYZ;                /*                       @Z40LB25*/ 02431000
*                                                                  0854 02432000
         BAL   @14,PRINTXYZ                                        0854 02433000
*   /*****************************************************************/ 02434000
*   /*                                                               */ 02435000
*   /* CHECK IF AN ERROR HAS OCCURRED                        @Z40LB25*/ 02436000
*   /*                                                               */ 02437000
*   /*****************************************************************/ 02438000
*                                                                  0855 02439000
*   IF READRC^=LASTCC00 THEN                                       0855 02440000
@RF00853 LH    @15,READRC                                          0855 02441000
         LTR   @15,@15                                             0855 02442000
         BZ    @RF00855                                            0855 02443000
*     DO;                           /*                       @Z40LB25*/ 02444000
*       PRINTAB=''B;                /*                       @Z40LB25*/ 02445000
         XC    PRINTAB(164),PRINTAB                                0857 02446000
*       DARGSMOD=AUDMSG;            /*                       @Z40LB25*/ 02447000
*                                                                  0858 02448000
         L     @01,DDSTRU                                          0858 02449000
         MVC   DARGSMOD(3,@01),@CC01440                            0858 02450000
*       /*************************************************************/ 02451000
*       /*                                                           */ 02452000
*       /* MSG IDC21143I                                     @Z40LB25*/ 02453000
*       /* CHECK FOR AN INCOMPLETE REPORT                    @Z40LB25*/ 02454000
*       /*                                                           */ 02455000
*       /*************************************************************/ 02456000
*                                                                  0859 02457000
*       IF READRC=LASTCC08&(XYZ1PRTD=ON|XYZ2PRTD=ON|RLBLPRTD=ON) THEN   02458000
         C     @15,@CF00184                                        0859 02459000
         BNE   @RF00859                                            0859 02460000
         TM    XYZ1PRTD,B'00000011'                                0859 02461000
         BNZ   @RT00859                                            0859 02462000
         TM    RLBLPRTD,B'10000000'                                0859 02463000
         BNO   @RF00859                                            0859 02464000
@RT00859 DS    0H                                                  0860 02465000
*         DARGSENT=MG21143R;        /*                       @Z40LB25*/ 02466000
*                                                                  0860 02467000
         L     @01,DDSTRU                                          0860 02468000
         MVI   DARGSENT(@01),X'05'                                 0860 02469000
*       /*************************************************************/ 02470000
*       /*                                                           */ 02471000
*       /* MSG IDC31145I                                     @Z40LB25*/ 02472000
*       /* NO REPORT PRODUCED                                @Z40LB25*/ 02473000
*       /*                                                           */ 02474000
*       /*************************************************************/ 02475000
*                                                                  0861 02476000
*       ELSE                                                       0861 02477000
*         DO;                       /*                       @Z40LB25*/ 02478000
         B     @RC00859                                            0861 02479000
@RF00859 DS    0H                                                  0862 02480000
*           DARGSENT=MG31145R;      /*                       @Z40LB25*/ 02481000
         L     @01,DDSTRU                                          0862 02482000
         MVI   DARGSENT(@01),X'2D'                                 0862 02483000
*           READRC=LASTCC12;        /*                       @Z40LB25*/ 02484000
         MVC   READRC(2),@CH00571                                  0863 02485000
*         END;                      /*                       @Z40LB25*/ 02486000
*       DARGCNT=1;                  /*                       @Z40LB25*/ 02487000
@RC00859 LA    @15,1                                               0865 02488000
         L     @14,DDSTRU                                          0865 02489000
         STH   @15,DARGCNT(,@14)                                   0865 02490000
*       DARGINS(1)=1;               /*                       @Z40LB25*/ 02491000
         STH   @15,DARGINS(,@14)                                   0866 02492000
*       X=READX;                    /*                       @Z40LB25*/ 02493000
         L     @01,RDCKPTR                                         0867 02494000
         SLR   @00,@00                                             0867 02495000
         IC    @00,READX(,@01)                                     0867 02496000
         STH   @00,X                                               0867 02497000
*       DARGINL(1)=LENGTH(X);       /*                       @Z40LB25*/ 02498000
         MVC   DARGINL(2,@14),@CH00158                             0868 02499000
*       DARGDTM(1)=ADDR(X);         /*                       @Z40LB25*/ 02500000
         LA    @15,X                                               0869 02501000
         ST    @15,DARGDTM(,@14)                                   0869 02502000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB25*/ 02503000
         L     @15,@PC00001                                        0870 02504000
         ST    @15,@AL00001                                        0870 02505000
         LA    @14,@CF00120                                        0870 02506000
         ST    @14,@AL00001+4                                      0870 02507000
         LA    @14,DDSTRU                                          0870 02508000
         ST    @14,@AL00001+8                                      0870 02509000
         MVI   @AL00001+8,X'80'                                    0870 02510000
         L     @15,GDTPRT(,@15)                                    0870 02511000
         LA    @01,@AL00001                                        0870 02512000
         BALR  @14,@15                                             0870 02513000
*     END;                          /*                       @Z40LB25*/ 02514000
*   RETURN;                         /*                       @Z40LB25*/ 02515000
@EL00007 DS    0H                                                  0872 02516000
@EF00007 DS    0H                                                  0872 02517000
@ER00007 L     @14,@SA00007                                        0872 02518000
         BR    @14                                                 0872 02519000
*   END READLBL;                    /*                       @Z40LB25*/ 02520000
         B     @EL00007                                            0873 02521000
*                                                                  0874 02522000
*   /*****************************************************************/ 02523000
*   /*                                                               */ 02524000
*   /* PROCEDURE NAME - LOCTOBIT                             @Z40LB25*/ 02525000
*   /*                                                       @Z40LB25*/ 02526000
*   /* FUNCTION - THIS PROCEDURE TAKES AN X Y Z              @Z40LB25*/ 02527000
*   /* LOCATION AND SETS ITS CORRESPONDING BIT IN            @Z40LB25*/ 02528000
*   /* EITHER XYZ1 OR XYZ2 OR WORKMAP WORK AREA              @Z40LB25*/ 02529000
*   /* OR ORIGINAL CELL MAP ON.                              @Z40LB25*/ 02530000
*   /*                                                       @Z40LB25*/ 02531000
*   /* INPUT -                                               @Z40LB25*/ 02532000
*   /* CHUNKPTR - XYZ1, XYZ2, WORKMAP, ORIGMAP               @Z40LB25*/ 02533000
*   /* CELLPTR - CELL BLOCK                                  @Z40LB25*/ 02534000
*   /* X - 150 T0 247                                        @Z40LB25*/ 02535000
*   /* Y - 0 TO 27                                           @Z40LB25*/ 02536000
*   /* Z - 0 OR 1                                            @Z40LB25*/ 02537000
*   /*                                                       @Z40LB25*/ 02538000
*   /* OUTPUT -                                              @Z40LB25*/ 02539000
*   /* XYZ1 OR XYZ2 OR ORIGINAL CELL MAP OR                  @Z40LB25*/ 02540000
*   /* WORKMAP                                               @Z40LB25*/ 02541000
*   /*                                                               */ 02542000
*   /*****************************************************************/ 02543000
*                                                                  0874 02544000
*LOCTOBIT:                                                         0874 02545000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 02546000
LOCTOBIT ST    @14,12(,@13)                                        0874 02547000
*   SETBIT=OFF;                     /*                       @Z40LB25*/ 02548000
         NI    SETBIT,B'11101111'                                  0875 02549000
*   TEMPX=XSTART;                   /* 150                   @Z40LB25*/ 02550000
         LA    TEMPX,150                                           0876 02551000
*   TEMPY=''B;                      /*                       @Z40LB25*/ 02552000
         SLR   @07,@07                                             0877 02553000
         STH   @07,TEMPY                                           0877 02554000
*   XINDEX=''B;                     /*                       @Z40LB25*/ 02555000
         LR    XINDEX,@07                                          0878 02556000
*   DO BLKINDEX=1 TO BLKNUM WHILE SETBIT=OFF;/* BLOCKS 1 - 4 @Z40LB25*/ 02557000
*                                                                  0879 02558000
         LA    BLKINDEX,1                                          0879 02559000
@DL00879 TM    SETBIT,B'00010000'                                  0879 02560000
         BNZ   @DC00879                                            0879 02561000
*     /***************************************************************/ 02562000
*     /*                                                             */ 02563000
*     /* SCAN THE CHUNKS OF EACH OF THE BLOCKS               @Z40LB25*/ 02564000
*     /*                                                             */ 02565000
*     /***************************************************************/ 02566000
*                                                                  0880 02567000
*     DO CHKINDEX=1 TO CHUNKNUM WHILE SETBIT=OFF;/*          @Z40LB25*/ 02568000
         LA    @15,1                                               0880 02569000
         STH   @15,CHKINDEX                                        0880 02570000
@DL00880 TM    SETBIT,B'00010000'                                  0880 02571000
         BNZ   @DC00880                                            0880 02572000
*       CUBEPTR=CHUNKPTR;           /*                       @Z40LB25*/ 02573000
*                                                                  0881 02574000
         L     CUBEPTR,CHUNKPTR                                    0881 02575000
*       /*************************************************************/ 02576000
*       /*                                                           */ 02577000
*       /* SCAN THE CUBES PER CHUNK                          @Z40LB25*/ 02578000
*       /*                                                           */ 02579000
*       /*************************************************************/ 02580000
*                                                                  0882 02581000
*       DO CUBINDEX=1 TO CUBENUM WHILE SETBIT=OFF;/*         @Z40LB25*/ 02582000
*                                                                  0882 02583000
         LA    @03,1                                               0882 02584000
         STH   @03,CUBINDEX                                        0882 02585000
@DL00882 TM    SETBIT,B'00010000'                                  0882 02586000
         BNZ   @DC00882                                            0882 02587000
*         /***********************************************************/ 02588000
*         /*                                                         */ 02589000
*         /* SCAN EACH BYTE FOR THE CORRECT XYZ              @Z40LB25*/ 02590000
*         /*                                                         */ 02591000
*         /***********************************************************/ 02592000
*                                                                  0883 02593000
*         DO BYTINDEX=1 TO BYTENUM WHILE SETBIT=OFF;/*       @Z40LB25*/ 02594000
*                                                                  0883 02595000
         LA    BYTINDEX,1                                          0883 02596000
@DL00883 TM    SETBIT,B'00010000'                                  0883 02597000
         BNZ   @DC00883                                            0883 02598000
*           /*********************************************************/ 02599000
*           /*                                                       */ 02600000
*           /* SCAN FOR EACH X (2 BITS)                      @Z40LB25*/ 02601000
*           /*                                                       */ 02602000
*           /*********************************************************/ 02603000
*                                                                  0884 02604000
*           DO TWOBITX=1 TO 4 WHILE SETBIT=OFF;/*            @Z40LB25*/ 02605000
         LA    @15,1                                               0884 02606000
         STH   @15,TWOBITX                                         0884 02607000
@DL00884 TM    SETBIT,B'00010000'                                  0884 02608000
         BNZ   @DC00884                                            0884 02609000
*             IF TEMPX+XINDEX=X&TEMPY=Y THEN                       0885 02610000
         LR    @15,TEMPX                                           0885 02611000
         ALR   @15,XINDEX                                          0885 02612000
         CH    @15,X                                               0885 02613000
         BNE   @RF00885                                            0885 02614000
         LH    @15,TEMPY                                           0885 02615000
         C     @15,Y                                               0885 02616000
         BNE   @RF00885                                            0885 02617000
*               DO;                 /*                       @Z40LB25*/ 02618000
*                 SETBIT=ON;        /*                       @Z40LB25*/ 02619000
         OI    SETBIT,B'00010000'                                  0887 02620000
*                 IF XINDEX=0&Z=0 THEN                             0888 02621000
         SLR   @15,@15                                             0888 02622000
         CR    XINDEX,@15                                          0888 02623000
         BNE   @RF00888                                            0888 02624000
         CH    @15,Z                                               0888 02625000
         BNE   @RF00888                                            0888 02626000
*                   X0Z0(BYTINDEX)=ON;/*                     @Z40LB25*/ 02627000
         LR    @01,CUBEPTR                                         0889 02628000
         ALR   @01,BYTINDEX                                        0889 02629000
         AL    @01,@CF01674                                        0889 02630000
         OI    X0Z0(@01),B'10000000'                               0889 02631000
*                 IF XINDEX=0&Z=1 THEN                             0890 02632000
@RF00888 LTR   XINDEX,XINDEX                                       0890 02633000
         BNZ   @RF00890                                            0890 02634000
         CLC   Z(2),@CH00224                                       0890 02635000
         BNE   @RF00890                                            0890 02636000
*                   X0Z1(BYTINDEX)=ON;/*                     @Z40LB25*/ 02637000
         LR    @01,CUBEPTR                                         0891 02638000
         ALR   @01,BYTINDEX                                        0891 02639000
         AL    @01,@CF01674                                        0891 02640000
         OI    X0Z1(@01),B'01000000'                               0891 02641000
*                 IF XINDEX=1&Z=0 THEN                             0892 02642000
@RF00890 C     XINDEX,@CF00224                                     0892 02643000
         BNE   @RF00892                                            0892 02644000
         LH    @15,Z                                               0892 02645000
         LTR   @15,@15                                             0892 02646000
         BNZ   @RF00892                                            0892 02647000
*                   X1Z0(BYTINDEX)=ON;/*                     @Z40LB25*/ 02648000
         LR    @01,CUBEPTR                                         0893 02649000
         ALR   @01,BYTINDEX                                        0893 02650000
         AL    @01,@CF01674                                        0893 02651000
         OI    X1Z0(@01),B'00100000'                               0893 02652000
*                 IF XINDEX=1&Z=1 THEN                             0894 02653000
@RF00892 LA    @15,1                                               0894 02654000
         CR    XINDEX,@15                                          0894 02655000
         BNE   @RF00894                                            0894 02656000
         CH    @15,Z                                               0894 02657000
         BNE   @RF00894                                            0894 02658000
*                   X1Z1(BYTINDEX)=ON;/*                     @Z40LB25*/ 02659000
*                                                                  0895 02660000
         LR    @01,CUBEPTR                                         0895 02661000
         ALR   @01,BYTINDEX                                        0895 02662000
         AL    @01,@CF01674                                        0895 02663000
         OI    X1Z1(@01),B'00010000'                               0895 02664000
*                 /***************************************************/ 02665000
*                 /*                                                 */ 02666000
*                 /* CHECK FOR LAST BLOCK                    @Z40LB25*/ 02667000
*                 /*                                                 */ 02668000
*                 /***************************************************/ 02669000
*                                                                  0896 02670000
*                 IF BLKINDEX^=BLKNUM THEN                         0896 02671000
@RF00894 C     BLKINDEX,@CF00047                                   0896 02672000
         BE    @RF00896                                            0896 02673000
*                   DO;             /*                       @Z40LB25*/ 02674000
*                     IF XINDEX=2&Z=0 THEN                         0898 02675000
         C     XINDEX,@CF00158                                     0898 02676000
         BNE   @RF00898                                            0898 02677000
         LH    @15,Z                                               0898 02678000
         LTR   @15,@15                                             0898 02679000
         BNZ   @RF00898                                            0898 02680000
*                       X2Z0(BYTINDEX)=ON;/*                 @Z40LB25*/ 02681000
         LR    @01,CUBEPTR                                         0899 02682000
         ALR   @01,BYTINDEX                                        0899 02683000
         AL    @01,@CF01674                                        0899 02684000
         OI    X2Z0(@01),B'00001000'                               0899 02685000
*                     IF XINDEX=2&Z=1 THEN                         0900 02686000
@RF00898 C     XINDEX,@CF00158                                     0900 02687000
         BNE   @RF00900                                            0900 02688000
         CLC   Z(2),@CH00224                                       0900 02689000
         BNE   @RF00900                                            0900 02690000
*                       X2Z1(BYTINDEX)=ON;/*                 @Z40LB25*/ 02691000
         LR    @01,CUBEPTR                                         0901 02692000
         ALR   @01,BYTINDEX                                        0901 02693000
         AL    @01,@CF01674                                        0901 02694000
         OI    X2Z1(@01),B'00000100'                               0901 02695000
*                     IF XINDEX=3&Z=0 THEN                         0902 02696000
@RF00900 C     XINDEX,@CF00167                                     0902 02697000
         BNE   @RF00902                                            0902 02698000
         LH    @15,Z                                               0902 02699000
         LTR   @15,@15                                             0902 02700000
         BNZ   @RF00902                                            0902 02701000
*                       X3Z0(BYTINDEX)=ON;/*                 @Z40LB25*/ 02702000
         LR    @01,CUBEPTR                                         0903 02703000
         ALR   @01,BYTINDEX                                        0903 02704000
         AL    @01,@CF01674                                        0903 02705000
         OI    X3Z0(@01),B'00000010'                               0903 02706000
*                     IF XINDEX=3&Z=1 THEN                         0904 02707000
@RF00902 C     XINDEX,@CF00167                                     0904 02708000
         BNE   @RF00904                                            0904 02709000
         CLC   Z(2),@CH00224                                       0904 02710000
         BNE   @RF00904                                            0904 02711000
*                       X3Z1(BYTINDEX)=ON;/*                 @Z40LB25*/ 02712000
         LR    @01,CUBEPTR                                         0905 02713000
         ALR   @01,BYTINDEX                                        0905 02714000
         AL    @01,@CF01674                                        0905 02715000
         OI    X3Z1(@01),B'00000001'                               0905 02716000
*                   END;            /*                       @Z40LB25*/ 02717000
*               END;                /*                       @Z40LB25*/ 02718000
*             ELSE                                                 0908 02719000
*               XINDEX=XINDEX+1;    /*                       @Z40LB25*/ 02720000
         B     @RC00885                                            0908 02721000
@RF00885 AL    XINDEX,@CF00224                                     0908 02722000
*           END;                    /*                       @Z40LB25*/ 02723000
@RC00885 LA    @15,1                                               0909 02724000
         AH    @15,TWOBITX                                         0909 02725000
         STH   @15,TWOBITX                                         0909 02726000
         C     @15,@CF00047                                        0909 02727000
         BNH   @DL00884                                            0909 02728000
@DC00884 DS    0H                                                  0910 02729000
*           XINDEX=''B;             /*                       @Z40LB25*/ 02730000
         SLR   XINDEX,XINDEX                                       0910 02731000
*           TEMPY=TEMPY+1;          /*                       @Z40LB25*/ 02732000
         LA    @15,1                                               0911 02733000
         AH    @15,TEMPY                                           0911 02734000
         STH   @15,TEMPY                                           0911 02735000
*         END;                      /*                       @Z40LB25*/ 02736000
         AL    BYTINDEX,@CF00224                                   0912 02737000
         C     BYTINDEX,@CF00047                                   0912 02738000
         BNH   @DL00883                                            0912 02739000
@DC00883 DS    0H                                                  0913 02740000
*         XINDEX=''B;               /*                       @Z40LB25*/ 02741000
         SLR   XINDEX,XINDEX                                       0913 02742000
*         CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                    @Z40LB25*/ 02743000
         AL    CUBEPTR,@CF00047                                    0914 02744000
*       END;                        /*                       @Z40LB25*/ 02745000
*                                                                  0915 02746000
         LA    @03,1                                               0915 02747000
         AH    @03,CUBINDEX                                        0915 02748000
         STH   @03,CUBINDEX                                        0915 02749000
         C     @03,@CF00663                                        0915 02750000
         BNH   @DL00882                                            0915 02751000
@DC00882 DS    0H                                                  0916 02752000
*       /*************************************************************/ 02753000
*       /*                                                           */ 02754000
*       /* IF AT THE LAST BLOCK, IT WILL CONTAIN             @Z40LB25*/ 02755000
*       /* ONLY ONE CHUNK                                    @Z40LB25*/ 02756000
*       /*                                                           */ 02757000
*       /*************************************************************/ 02758000
*                                                                  0916 02759000
*       IF BLKINDEX=BLKNUM THEN                                    0916 02760000
         C     BLKINDEX,@CF00047                                   0916 02761000
         BNE   @RF00916                                            0916 02762000
*         CHKINDEX=CHUNKNUM;        /*                       @Z40LB25*/ 02763000
         MVC   CHKINDEX(2),@CH00184                                0917 02764000
*       CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*                   @Z40LB25*/ 02765000
@RF00916 LA    @15,32                                              0918 02766000
         AL    @15,CHUNKPTR                                        0918 02767000
         ST    @15,CHUNKPTR                                        0918 02768000
*       TEMPY=''B;                  /*                       @Z40LB25*/ 02769000
         SLR   @15,@15                                             0919 02770000
         STH   @15,TEMPY                                           0919 02771000
*       TEMPX=TEMPX+4;              /*                       @Z40LB25*/ 02772000
         AL    TEMPX,@CF00047                                      0920 02773000
*       XINDEX=''B;                 /*                       @Z40LB25*/ 02774000
         LR    XINDEX,@15                                          0921 02775000
*     END;                          /*                       @Z40LB25*/ 02776000
         LA    @15,1                                               0922 02777000
         AH    @15,CHKINDEX                                        0922 02778000
         STH   @15,CHKINDEX                                        0922 02779000
         C     @15,@CF00184                                        0922 02780000
         BNH   @DL00880                                            0922 02781000
@DC00880 DS    0H                                                  0923 02782000
*     CELLPTR=CELLPTR+BLKSIZE;      /*                       @Z40LB25*/ 02783000
         LA    @15,264                                             0923 02784000
         AL    @15,CELLPTR                                         0923 02785000
         ST    @15,CELLPTR                                         0923 02786000
*     CHUNKPTR=CHUNKPTR+8;          /* SKIP CONTROL INFO     @Z40LB25*/ 02787000
*                                                                  0924 02788000
         LA    @15,8                                               0924 02789000
         AL    @15,CHUNKPTR                                        0924 02790000
         ST    @15,CHUNKPTR                                        0924 02791000
*     /***************************************************************/ 02792000
*     /*                                                             */ 02793000
*     /* OF NEXT BLOCK                                       @Z40LB25*/ 02794000
*     /*                                                             */ 02795000
*     /***************************************************************/ 02796000
*                                                                  0925 02797000
*   END;                            /*                       @Z40LB25*/ 02798000
         AL    BLKINDEX,@CF00224                                   0925 02799000
         C     BLKINDEX,@CF00047                                   0925 02800000
         BNH   @DL00879                                            0925 02801000
@DC00879 DS    0H                                                  0926 02802000
*   RETURN;                         /*                       @Z40LB25*/ 02803000
@EL00008 DS    0H                                                  0926 02804000
@EF00008 DS    0H                                                  0926 02805000
@ER00008 L     @14,12(,@13)                                        0926 02806000
         BR    @14                                                 0926 02807000
*   END LOCTOBIT;                   /*                       @Z40LB25*/ 02808000
*                                                                  0928 02809000
*   /*****************************************************************/ 02810000
*   /*                                                               */ 02811000
*   /* PROCEDURE NAME - CKCELL                               @Z40LB25*/ 02812000
*   /*                                                       @Z40LB25*/ 02813000
*   /* FUNCTION - BUILDS THE PARAMETER LIST FOR THE          @Z40LB25*/ 02814000
*   /* EXECUTION OF ICBQUERY (QCEL) USING WORKMAP.           @Z40LB25*/ 02815000
*   /* PROCESSES ANY HARDWARE ERRORS.                        @Z40LB25*/ 02816000
*   /*                                                       @Z40LB25*/ 02817000
*   /* INPUT -                                               @Z40LB25*/ 02818000
*   /* WORKMAP                                               @Z40LB25*/ 02819000
*   /*                                                       @Z40LB25*/ 02820000
*   /* OUTPUT -                                              @Z40LB25*/ 02821000
*   /* CHECKRC                                               @Z40LB25*/ 02822000
*   /* 12 - FAIL ON FIRST CALL TO USSC                       @Z40LB25*/ 02823000
*   /* 8 - FAIL ON OTHER THAN FIRST USSC CALL                @Z40LB25*/ 02824000
*   /* DIAGBUF (CELLPARM)                                    @Z40LB25*/ 02825000
*   /*                                                               */ 02826000
*   /*****************************************************************/ 02827000
*                                                                  0928 02828000
*CKCELL:                                                           0928 02829000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 02830000
*                                                                  0928 02831000
CKCELL   ST    @14,@SA00009                                        0928 02832000
*   /*****************************************************************/ 02833000
*   /*                                                               */ 02834000
*   /* SET UP THE IBCQUERY (QCEL) PARM LIST                  @Z40LB25*/ 02835000
*   /* MSFVAL IS SET TO ZERO WHEN RDCKLIST IS ZEROED.        @Z40LB25*/ 02836000
*   /*                                                               */ 02837000
*   /*****************************************************************/ 02838000
*                                                                  0929 02839000
*   IF MSFVAL=MSF1 THEN             /* SET MSF NUM           @Z40LB25*/ 02840000
         L     @15,@PC00001+4                                      0929 02841000
         L     @01,FDTPTR+24(,@15)                                 0929 02842000
         L     @15,MSFVAL(,@01)                                    0929 02843000
         SLR   @14,@14                                             0929 02844000
         IC    @14,MSF1                                            0929 02845000
         CR    @15,@14                                             0929 02846000
         BNE   @RF00929                                            0929 02847000
*     QULIB=ONEMSF;                 /*                       @Z40LB25*/ 02848000
         L     @01,RDCKPTR                                         0930 02849000
         MVC   QULIB(1,@01),ONEMSF                                 0930 02850000
*   IF MSFVAL=MSF2 THEN             /* SET MSF NUM           @Z40LB25*/ 02851000
@RF00929 L     @15,@PC00001+4                                      0931 02852000
         L     @01,FDTPTR+24(,@15)                                 0931 02853000
         L     @15,MSFVAL(,@01)                                    0931 02854000
         SLR   @14,@14                                             0931 02855000
         IC    @14,MSF2                                            0931 02856000
         CR    @15,@14                                             0931 02857000
         BNE   @RF00931                                            0931 02858000
*     QULIB=TWOMSF;                 /*                       @Z40LB25*/ 02859000
         L     @01,RDCKPTR                                         0932 02860000
         MVC   QULIB(1,@01),TWOMSF                                 0932 02861000
*   IF MSFVAL=MSF3 THEN             /* SET MSF NUM           @Z40LB25*/ 02862000
@RF00931 L     @15,@PC00001+4                                      0933 02863000
         L     @01,FDTPTR+24(,@15)                                 0933 02864000
         L     @15,MSFVAL(,@01)                                    0933 02865000
         SLR   @14,@14                                             0933 02866000
         IC    @14,MSF3                                            0933 02867000
         CR    @15,@14                                             0933 02868000
         BNE   @RF00933                                            0933 02869000
*     QULIB=THREEMSF;               /*                       @Z40LB25*/ 02870000
         L     @01,RDCKPTR                                         0934 02871000
         MVC   QULIB(1,@01),THREEMSF                               0934 02872000
*   QUPTR=ADDR(DIAGBUF);            /* RETURN AREA           @Z40LB25*/ 02873000
@RF00933 L     @02,@PC00001+8                                      0935 02874000
         L     @02,BLKPTR(,@02)                                    0935 02875000
         LA    @15,DIAGBUF(,@02)                                   0935 02876000
         L     @14,RDCKPTR                                         0935 02877000
         ST    @15,QUPTR(,@14)                                     0935 02878000
*   X2=XSTART;                      /* 150                   @Z40LB25*/ 02879000
         MVC   X2(2),@CH01256                                      0936 02880000
*   YY2=ONEYMASK;                   /*                       @Z40LB25*/ 02881000
         L     YY2,ONEYMASK                                        0937 02882000
*   CELLPTR2=ADDR(WRKBLK(1));       /* CELL BLOCK PTR        @Z40LB25*/ 02883000
         L     @01,WRKMAPTR                                        0938 02884000
         ST    @01,CELLPTR2                                        0938 02885000
*   CURCLPTR=ADDR(CELLMAP(1));      /* CELL MAP BLOCK        @Z40LB25*/ 02886000
*                                                                  0939 02887000
         LA    @02,CELLMAP(,@02)                                   0939 02888000
         ST    @02,CURCLPTR                                        0939 02889000
*   /*****************************************************************/ 02890000
*   /*                                                               */ 02891000
*   /* SCAN THE FOUR BLOCKS                                  @Z40LB25*/ 02892000
*   /*                                                               */ 02893000
*   /*****************************************************************/ 02894000
*                                                                  0940 02895000
*   DO BLKINDX2=1 TO BLKNUM;        /*                       @Z40LB25*/ 02896000
         LA    @02,1                                               0940 02897000
         STH   @02,BLKINDX2                                        0940 02898000
@DL00940 DS    0H                                                  0941 02899000
*     CHUNKPT2=ADDR(WRKCUBE(BLKINDX2));/*                    @Z40LB25*/ 02900000
         MH    @02,@CH01230                                        0941 02901000
         L     @01,WRKMAPTR                                        0941 02902000
         AL    @01,@CF01672                                        0941 02903000
         LA    @15,WRKCUBE-8(@02,@01)                              0941 02904000
         ST    @15,CHUNKPT2                                        0941 02905000
*     CURCKPTR=ADDR(CELLCUBE(BLKINDX2));/*                   @Z40LB25*/ 02906000
*                                                                  0942 02907000
         L     @15,@PC00001+8                                      0942 02908000
         L     @01,BLKPTR(,@15)                                    0942 02909000
         LA    @02,CELLCUBE-264(@02,@01)                           0942 02910000
         ST    @02,CURCKPTR                                        0942 02911000
*     /***************************************************************/ 02912000
*     /*                                                             */ 02913000
*     /* SCAN THE CHUNKS OF EACH OF THE BLOCKS               @Z40LB25*/ 02914000
*     /*                                                             */ 02915000
*     /***************************************************************/ 02916000
*                                                                  0943 02917000
*     DO CHKINDX2=1 TO CHUNKNUM;    /*                       @Z40LB25*/ 02918000
         LA    @02,1                                               0943 02919000
         STH   @02,CHKINDX2                                        0943 02920000
@DL00943 DS    0H                                                  0944 02921000
*       CUBEPTR2=CHUNKPT2;          /*                       @Z40LB25*/ 02922000
         L     CUBEPTR2,CHUNKPT2                                   0944 02923000
*       CURCBPTR=CURCKPTR;          /*                       @Z40LB25*/ 02924000
*                                                                  0945 02925000
         L     CURCBPTR,CURCKPTR                                   0945 02926000
*       /*************************************************************/ 02927000
*       /*                                                           */ 02928000
*       /* SCAN THE CUBES PER CHUNK                          @Z40LB25*/ 02929000
*       /*                                                           */ 02930000
*       /*************************************************************/ 02931000
*                                                                  0946 02932000
*       DO CUBINDX2=1 TO CUBENUM;   /*                       @Z40LB25*/ 02933000
*                                                                  0946 02934000
         LA    CUBINDX2,1                                          0946 02935000
@DL00946 DS    0H                                                  0947 02936000
*         /***********************************************************/ 02937000
*         /*                                                         */ 02938000
*         /* SCAN EACH BIT PER BYTE                          @Z40LB25*/ 02939000
*         /*                                                         */ 02940000
*         /***********************************************************/ 02941000
*                                                                  0947 02942000
*         DO BYTINDX2=1 TO BYTENUM; /*                       @Z40LB25*/ 02943000
         LA    BYTINDX2,1                                          0947 02944000
@DL00947 DS    0H                                                  0948 02945000
*           TEMPX2=''B;             /*                       @Z40LB25*/ 02946000
*                                                                  0948 02947000
         SLR   TEMPX2,TEMPX2                                       0948 02948000
*           /*********************************************************/ 02949000
*           /*                                                       */ 02950000
*           /* IF NOT ALREADY DONE, SET THE X VALUE          @Z40LB25*/ 02951000
*           /* THE PARAMETER LIST                            @Z40LB25*/ 02952000
*           /*                                                       */ 02953000
*           /*********************************************************/ 02954000
*                                                                  0949 02955000
*           IF SETX=OFF THEN                                       0949 02956000
         TM    SETX,B'10000000'                                    0949 02957000
         BNZ   @RF00949                                            0949 02958000
*             DO;                   /*                       @Z40LB25*/ 02959000
*               QUXADDR=X2;         /* START X               @Z40LB25*/ 02960000
         L     @01,RDCKPTR                                         0951 02961000
         MVC   QUXADDR(1,@01),X2+1                                 0951 02962000
*               SETX=ON;            /*                       @Z40LB25*/ 02963000
         OI    SETX,B'10000000'                                    0952 02964000
*             END;                  /*                       @Z40LB25*/ 02965000
*                                                                  0953 02966000
*           /*********************************************************/ 02967000
*           /*                                                       */ 02968000
*           /* SET THE CELLS TO BE CHECKED INTO QCPARM.      @Z40LB25*/ 02969000
*           /* FOR EMPTY REMOVE BITS THAT CURRENT CELL MAP   @Z40LB25*/ 02970000
*           /* INDICATES AS FULL. FOR FULL REMOVE BITS       @Z40LB25*/ 02971000
*           /* THAT CURRENT CELL MAP INDICATES AS EMPTY.     @Z40LB25*/ 02972000
*           /* NO CHANGE FOR ALL.                            @Z40LB25*/ 02973000
*           /*                                                       */ 02974000
*           /*********************************************************/ 02975000
*                                                                  0954 02976000
*                                                                  0954 02977000
*           /*********************************************************/ 02978000
*           /*                                                       */ 02979000
*           /* CHECK FOR X                                   @Z40LB25*/ 02980000
*           /*                                                       */ 02981000
*           /*********************************************************/ 02982000
*                                                                  0954 02983000
*           IF X2+TEMPX2=>MSFLOWX THEN                             0954 02984000
@RF00949 LR    @15,TEMPX2                                          0954 02985000
         AH    @15,X2                                              0954 02986000
         C     @15,MSFLOWX                                         0954 02987000
         BL    @RF00954                                            0954 02988000
*             DO;                   /*                       @Z40LB25*/ 02989000
*               IF X0Z02(BYTINDX2)=ON THEN                         0956 02990000
         LR    @01,CUBEPTR2                                        0956 02991000
         ALR   @01,BYTINDX2                                        0956 02992000
         AL    @01,@CF01674                                        0956 02993000
         TM    X0Z02(@01),B'10000000'                              0956 02994000
         BNO   @RF00956                                            0956 02995000
*                 IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&CURX0Z0( 02996000
*                     BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&CURX0Z0(BYTINDX2 02997000
*                     )=OFF THEN                                   0957 02998000
         SLR   @15,@15                                             0957 02999000
         L     @14,@PC00001+4                                      0957 03000000
         C     @15,FDTPTR+20(,@14)                                 0957 03001000
         BNE   @RT00957                                            0957 03002000
         C     @15,FDTPTR+16(,@14)                                 0957 03003000
         BE    @GL00041                                            0957 03004000
         LR    @01,CURCBPTR                                        0957 03005000
         ALR   @01,BYTINDX2                                        0957 03006000
         AL    @01,@CF01674                                        0957 03007000
         TM    CURX0Z0(@01),B'10000000'                            0957 03008000
         BO    @RT00957                                            0957 03009000
@GL00041 L     @15,@PC00001+4                                      0957 03010000
         L     @15,FDTPTR+12(,@15)                                 0957 03011000
         LTR   @15,@15                                             0957 03012000
         BZ    @RF00957                                            0957 03013000
         LR    @01,CURCBPTR                                        0957 03014000
         ALR   @01,BYTINDX2                                        0957 03015000
         AL    @01,@CF01674                                        0957 03016000
         TM    CURX0Z0(@01),B'10000000'                            0957 03017000
         BNZ   @RF00957                                            0957 03018000
@RT00957 DS    0H                                                  0958 03019000
*                   DO;             /*                       @Z40LB25*/ 03020000
*                     YSQC(1)=YSQC(1)|YY2;/*                 @Z40LB25*/ 03021000
         L     @15,RDCKPTR                                         0959 03022000
         ICM   @14,15,YSQC(@15)                                    0959 03023000
         OR    @14,YY2                                             0959 03024000
         STCM  @14,15,YSQC(@15)                                    0959 03025000
*                     CHECKFLG=ON;  /*                       @Z40LB25*/ 03026000
         OI    CHECKFLG,B'00000010'                                0960 03027000
*                   END;            /*                       @Z40LB25*/ 03028000
*               IF X0Z12(BYTINDX2)=ON THEN                         0962 03029000
@RF00957 DS    0H                                                  0962 03030000
@RF00956 LR    @01,CUBEPTR2                                        0962 03031000
         ALR   @01,BYTINDX2                                        0962 03032000
         AL    @01,@CF01674                                        0962 03033000
         TM    X0Z12(@01),B'01000000'                              0962 03034000
         BNO   @RF00962                                            0962 03035000
*                 IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&CURX0Z1( 03036000
*                     BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&CURX0Z1(BYTINDX2 03037000
*                     )=OFF THEN                                   0963 03038000
         SLR   @15,@15                                             0963 03039000
         L     @14,@PC00001+4                                      0963 03040000
         C     @15,FDTPTR+20(,@14)                                 0963 03041000
         BNE   @RT00963                                            0963 03042000
         C     @15,FDTPTR+16(,@14)                                 0963 03043000
         BE    @GL00045                                            0963 03044000
         LR    @01,CURCBPTR                                        0963 03045000
         ALR   @01,BYTINDX2                                        0963 03046000
         AL    @01,@CF01674                                        0963 03047000
         TM    CURX0Z1(@01),B'01000000'                            0963 03048000
         BO    @RT00963                                            0963 03049000
@GL00045 L     @15,@PC00001+4                                      0963 03050000
         L     @15,FDTPTR+12(,@15)                                 0963 03051000
         LTR   @15,@15                                             0963 03052000
         BZ    @RF00963                                            0963 03053000
         LR    @01,CURCBPTR                                        0963 03054000
         ALR   @01,BYTINDX2                                        0963 03055000
         AL    @01,@CF01674                                        0963 03056000
         TM    CURX0Z1(@01),B'01000000'                            0963 03057000
         BNZ   @RF00963                                            0963 03058000
@RT00963 DS    0H                                                  0964 03059000
*                   DO;             /*                       @Z40LB25*/ 03060000
*                     YSQC(2)=YSQC(2)|YY2;/*                 @Z40LB25*/ 03061000
         L     @15,RDCKPTR                                         0965 03062000
         ICM   @14,15,YSQC+4(@15)                                  0965 03063000
         OR    @14,YY2                                             0965 03064000
         STCM  @14,15,YSQC+4(@15)                                  0965 03065000
*                     CHECKFLG=ON;  /*                       @Z40LB25*/ 03066000
         OI    CHECKFLG,B'00000010'                                0966 03067000
*                   END;            /*                       @Z40LB25*/ 03068000
*             END;                  /*                       @Z40LB25*/ 03069000
@RF00963 DS    0H                                                  0968 03070000
@RF00962 DS    0H                                                  0969 03071000
*           TEMPX2=TEMPX2+1;        /*                       @Z40LB25*/ 03072000
*                                                                  0969 03073000
@RF00954 AL    TEMPX2,@CF00224                                     0969 03074000
*           /*********************************************************/ 03075000
*           /*                                                       */ 03076000
*           /* CHECK FOR X+1                                 @Z40LB25*/ 03077000
*           /*                                                       */ 03078000
*           /*********************************************************/ 03079000
*                                                                  0970 03080000
*           IF X2+TEMPX2=>MSFLOWX THEN                             0970 03081000
         LR    @15,TEMPX2                                          0970 03082000
         AH    @15,X2                                              0970 03083000
         C     @15,MSFLOWX                                         0970 03084000
         BL    @RF00970                                            0970 03085000
*             DO;                   /*                       @Z40LB25*/ 03086000
*               IF X1Z02(BYTINDX2)=ON THEN                         0972 03087000
         LR    @01,CUBEPTR2                                        0972 03088000
         ALR   @01,BYTINDX2                                        0972 03089000
         AL    @01,@CF01674                                        0972 03090000
         TM    X1Z02(@01),B'00100000'                              0972 03091000
         BNO   @RF00972                                            0972 03092000
*                 IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&CURX1Z0( 03093000
*                     BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&CURX1Z0(BYTINDX2 03094000
*                     )=OFF THEN                                   0973 03095000
         SLR   @15,@15                                             0973 03096000
         L     @14,@PC00001+4                                      0973 03097000
         C     @15,FDTPTR+20(,@14)                                 0973 03098000
         BNE   @RT00973                                            0973 03099000
         C     @15,FDTPTR+16(,@14)                                 0973 03100000
         BE    @GL00049                                            0973 03101000
         LR    @01,CURCBPTR                                        0973 03102000
         ALR   @01,BYTINDX2                                        0973 03103000
         AL    @01,@CF01674                                        0973 03104000
         TM    CURX1Z0(@01),B'00100000'                            0973 03105000
         BO    @RT00973                                            0973 03106000
@GL00049 L     @15,@PC00001+4                                      0973 03107000
         L     @15,FDTPTR+12(,@15)                                 0973 03108000
         LTR   @15,@15                                             0973 03109000
         BZ    @RF00973                                            0973 03110000
         LR    @01,CURCBPTR                                        0973 03111000
         ALR   @01,BYTINDX2                                        0973 03112000
         AL    @01,@CF01674                                        0973 03113000
         TM    CURX1Z0(@01),B'00100000'                            0973 03114000
         BNZ   @RF00973                                            0973 03115000
@RT00973 DS    0H                                                  0974 03116000
*                   DO;             /*                       @Z40LB25*/ 03117000
*                     YSQC(3)=YSQC(3)|YY2;/*                 @Z40LB25*/ 03118000
         L     @15,RDCKPTR                                         0975 03119000
         ICM   @14,15,YSQC+8(@15)                                  0975 03120000
         OR    @14,YY2                                             0975 03121000
         STCM  @14,15,YSQC+8(@15)                                  0975 03122000
*                     CHECKFLG=ON;  /*                       @Z40LB25*/ 03123000
         OI    CHECKFLG,B'00000010'                                0976 03124000
*                   END;            /*                       @Z40LB25*/ 03125000
*               IF X1Z12(BYTINDX2)=ON THEN                         0978 03126000
@RF00973 DS    0H                                                  0978 03127000
@RF00972 LR    @01,CUBEPTR2                                        0978 03128000
         ALR   @01,BYTINDX2                                        0978 03129000
         AL    @01,@CF01674                                        0978 03130000
         TM    X1Z12(@01),B'00010000'                              0978 03131000
         BNO   @RF00978                                            0978 03132000
*                 IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&CURX1Z1( 03133000
*                     BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&CURX1Z1(BYTINDX2 03134000
*                     )=OFF THEN                                   0979 03135000
         SLR   @15,@15                                             0979 03136000
         L     @14,@PC00001+4                                      0979 03137000
         C     @15,FDTPTR+20(,@14)                                 0979 03138000
         BNE   @RT00979                                            0979 03139000
         C     @15,FDTPTR+16(,@14)                                 0979 03140000
         BE    @GL00053                                            0979 03141000
         LR    @01,CURCBPTR                                        0979 03142000
         ALR   @01,BYTINDX2                                        0979 03143000
         AL    @01,@CF01674                                        0979 03144000
         TM    CURX1Z1(@01),B'00010000'                            0979 03145000
         BO    @RT00979                                            0979 03146000
@GL00053 L     @15,@PC00001+4                                      0979 03147000
         L     @15,FDTPTR+12(,@15)                                 0979 03148000
         LTR   @15,@15                                             0979 03149000
         BZ    @RF00979                                            0979 03150000
         LR    @01,CURCBPTR                                        0979 03151000
         ALR   @01,BYTINDX2                                        0979 03152000
         AL    @01,@CF01674                                        0979 03153000
         TM    CURX1Z1(@01),B'00010000'                            0979 03154000
         BNZ   @RF00979                                            0979 03155000
@RT00979 DS    0H                                                  0980 03156000
*                   DO;             /*                       @Z40LB25*/ 03157000
*                     YSQC(4)=YSQC(4)|YY2;/*                 @Z40LB25*/ 03158000
         L     @15,RDCKPTR                                         0981 03159000
         ICM   @14,15,YSQC+12(@15)                                 0981 03160000
         OR    @14,YY2                                             0981 03161000
         STCM  @14,15,YSQC+12(@15)                                 0981 03162000
*                     CHECKFLG=ON;  /*                       @Z40LB25*/ 03163000
         OI    CHECKFLG,B'00000010'                                0982 03164000
*                   END;            /*                       @Z40LB25*/ 03165000
*             END;                  /*                       @Z40LB25*/ 03166000
@RF00979 DS    0H                                                  0984 03167000
@RF00978 DS    0H                                                  0985 03168000
*           TEMPX2=TEMPX2+1;        /*                       @Z40LB25*/ 03169000
*                                                                  0985 03170000
@RF00970 AL    TEMPX2,@CF00224                                     0985 03171000
*           /*********************************************************/ 03172000
*           /*                                                       */ 03173000
*           /* CHECK FOR THE LAST BLOCK                      @Z40LB25*/ 03174000
*           /*                                                       */ 03175000
*           /*********************************************************/ 03176000
*                                                                  0986 03177000
*           IF BLKINDX2^=BLKNUM THEN                               0986 03178000
         CLC   BLKINDX2(2),@CH00047                                0986 03179000
         BE    @RF00986                                            0986 03180000
*             DO;                   /*                       @Z40LB25*/ 03181000
*                                                                  0987 03182000
*               /*****************************************************/ 03183000
*               /*                                                   */ 03184000
*               /* CHECK FOR X+2                             @Z40LB25*/ 03185000
*               /*                                                   */ 03186000
*               /*****************************************************/ 03187000
*                                                                  0988 03188000
*               IF X2+TEMPX2=>MSFLOWX THEN                         0988 03189000
         LR    @15,TEMPX2                                          0988 03190000
         AH    @15,X2                                              0988 03191000
         C     @15,MSFLOWX                                         0988 03192000
         BL    @RF00988                                            0988 03193000
*                 DO;               /*                       @Z40LB25*/ 03194000
*                   IF X2Z02(BYTINDX2)=ON THEN                     0990 03195000
         LR    @01,CUBEPTR2                                        0990 03196000
         ALR   @01,BYTINDX2                                        0990 03197000
         AL    @01,@CF01674                                        0990 03198000
         TM    X2Z02(@01),B'00001000'                              0990 03199000
         BNO   @RF00990                                            0990 03200000
*                     IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&     03201000
*                         CURX2Z0(BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&     03202000
*                         CURX2Z0(BYTINDX2)=OFF THEN               0991 03203000
         SLR   @15,@15                                             0991 03204000
         L     @14,@PC00001+4                                      0991 03205000
         C     @15,FDTPTR+20(,@14)                                 0991 03206000
         BNE   @RT00991                                            0991 03207000
         C     @15,FDTPTR+16(,@14)                                 0991 03208000
         BE    @GL00057                                            0991 03209000
         LR    @01,CURCBPTR                                        0991 03210000
         ALR   @01,BYTINDX2                                        0991 03211000
         AL    @01,@CF01674                                        0991 03212000
         TM    CURX2Z0(@01),B'00001000'                            0991 03213000
         BO    @RT00991                                            0991 03214000
@GL00057 L     @15,@PC00001+4                                      0991 03215000
         L     @15,FDTPTR+12(,@15)                                 0991 03216000
         LTR   @15,@15                                             0991 03217000
         BZ    @RF00991                                            0991 03218000
         LR    @01,CURCBPTR                                        0991 03219000
         ALR   @01,BYTINDX2                                        0991 03220000
         AL    @01,@CF01674                                        0991 03221000
         TM    CURX2Z0(@01),B'00001000'                            0991 03222000
         BNZ   @RF00991                                            0991 03223000
@RT00991 DS    0H                                                  0992 03224000
*                       DO;         /*                       @Z40LB25*/ 03225000
*                         YSQC(5)=YSQC(5)|YY2;/*             @Z40LB25*/ 03226000
         L     @15,RDCKPTR                                         0993 03227000
         ICM   @14,15,YSQC+16(@15)                                 0993 03228000
         OR    @14,YY2                                             0993 03229000
         STCM  @14,15,YSQC+16(@15)                                 0993 03230000
*                         CHECKFLG=ON;/*                     @Z40LB25*/ 03231000
         OI    CHECKFLG,B'00000010'                                0994 03232000
*                       END;        /*                       @Z40LB25*/ 03233000
*                   IF X2Z12(BYTINDX2)=ON THEN                     0996 03234000
@RF00991 DS    0H                                                  0996 03235000
@RF00990 LR    @01,CUBEPTR2                                        0996 03236000
         ALR   @01,BYTINDX2                                        0996 03237000
         AL    @01,@CF01674                                        0996 03238000
         TM    X2Z12(@01),B'00000100'                              0996 03239000
         BNO   @RF00996                                            0996 03240000
*                     IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&     03241000
*                         CURX2Z1(BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&     03242000
*                         CURX2Z1(BYTINDX2)=OFF THEN               0997 03243000
         SLR   @15,@15                                             0997 03244000
         L     @14,@PC00001+4                                      0997 03245000
         C     @15,FDTPTR+20(,@14)                                 0997 03246000
         BNE   @RT00997                                            0997 03247000
         C     @15,FDTPTR+16(,@14)                                 0997 03248000
         BE    @GL00061                                            0997 03249000
         LR    @01,CURCBPTR                                        0997 03250000
         ALR   @01,BYTINDX2                                        0997 03251000
         AL    @01,@CF01674                                        0997 03252000
         TM    CURX2Z1(@01),B'00000100'                            0997 03253000
         BO    @RT00997                                            0997 03254000
@GL00061 L     @15,@PC00001+4                                      0997 03255000
         L     @15,FDTPTR+12(,@15)                                 0997 03256000
         LTR   @15,@15                                             0997 03257000
         BZ    @RF00997                                            0997 03258000
         LR    @01,CURCBPTR                                        0997 03259000
         ALR   @01,BYTINDX2                                        0997 03260000
         AL    @01,@CF01674                                        0997 03261000
         TM    CURX2Z1(@01),B'00000100'                            0997 03262000
         BNZ   @RF00997                                            0997 03263000
@RT00997 DS    0H                                                  0998 03264000
*                       DO;         /*                       @Z40LB25*/ 03265000
*                         YSQC(6)=YSQC(6)|YY2;/*             @Z40LB25*/ 03266000
         L     @15,RDCKPTR                                         0999 03267000
         ICM   @14,15,YSQC+20(@15)                                 0999 03268000
         OR    @14,YY2                                             0999 03269000
         STCM  @14,15,YSQC+20(@15)                                 0999 03270000
*                         CHECKFLG=ON;/*                     @Z40LB25*/ 03271000
         OI    CHECKFLG,B'00000010'                                1000 03272000
*                       END;        /*                       @Z40LB25*/ 03273000
*                 END;              /*                       @Z40LB25*/ 03274000
@RF00997 DS    0H                                                  1002 03275000
@RF00996 DS    0H                                                  1003 03276000
*               TEMPX2=TEMPX2+1;    /*                       @Z40LB25*/ 03277000
*                                                                  1003 03278000
@RF00988 AL    TEMPX2,@CF00224                                     1003 03279000
*               /*****************************************************/ 03280000
*               /*                                                   */ 03281000
*               /* CHECK FOR X+3                             @Z40LB25*/ 03282000
*               /*                                                   */ 03283000
*               /*****************************************************/ 03284000
*                                                                  1004 03285000
*               IF X2+TEMPX2=>MSFLOWX THEN                         1004 03286000
         LR    @15,TEMPX2                                          1004 03287000
         AH    @15,X2                                              1004 03288000
         C     @15,MSFLOWX                                         1004 03289000
         BL    @RF01004                                            1004 03290000
*                 DO;               /*                       @Z40LB25*/ 03291000
*                   IF X3Z02(BYTINDX2)=ON THEN                     1006 03292000
         LR    @05,CUBEPTR2                                        1006 03293000
         ALR   @05,BYTINDX2                                        1006 03294000
         AL    @05,@CF01674                                        1006 03295000
         TM    X3Z02(@05),B'00000010'                              1006 03296000
         BNO   @RF01006                                            1006 03297000
*                     IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&     03298000
*                         CURX3Z0(BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&     03299000
*                         CURX3Z0(BYTINDX2)=OFF THEN               1007 03300000
         SLR   @05,@05                                             1007 03301000
         L     @15,@PC00001+4                                      1007 03302000
         C     @05,FDTPTR+20(,@15)                                 1007 03303000
         BNE   @RT01007                                            1007 03304000
         C     @05,FDTPTR+16(,@15)                                 1007 03305000
         BE    @GL00065                                            1007 03306000
         LR    @05,CURCBPTR                                        1007 03307000
         ALR   @05,BYTINDX2                                        1007 03308000
         AL    @05,@CF01674                                        1007 03309000
         TM    CURX3Z0(@05),B'00000010'                            1007 03310000
         BO    @RT01007                                            1007 03311000
@GL00065 L     @05,@PC00001+4                                      1007 03312000
         L     @05,FDTPTR+12(,@05)                                 1007 03313000
         LTR   @05,@05                                             1007 03314000
         BZ    @RF01007                                            1007 03315000
         LR    @05,CURCBPTR                                        1007 03316000
         ALR   @05,BYTINDX2                                        1007 03317000
         AL    @05,@CF01674                                        1007 03318000
         TM    CURX3Z0(@05),B'00000010'                            1007 03319000
         BNZ   @RF01007                                            1007 03320000
@RT01007 DS    0H                                                  1008 03321000
*                       DO;         /*                       @Z40LB25*/ 03322000
*                         YSQC(7)=YSQC(7)|YY2;/*             @Z40LB25*/ 03323000
         L     @05,RDCKPTR                                         1009 03324000
         ICM   @15,15,YSQC+24(@05)                                 1009 03325000
         OR    @15,YY2                                             1009 03326000
         STCM  @15,15,YSQC+24(@05)                                 1009 03327000
*                         CHECKFLG=ON;/*                     @Z40LB25*/ 03328000
         OI    CHECKFLG,B'00000010'                                1010 03329000
*                       END;        /*                       @Z40LB25*/ 03330000
*                   IF X3Z12(BYTINDX2)=ON THEN                     1012 03331000
@RF01007 DS    0H                                                  1012 03332000
@RF01006 LR    @05,CUBEPTR2                                        1012 03333000
         ALR   @05,BYTINDX2                                        1012 03334000
         AL    @05,@CF01674                                        1012 03335000
         TM    X3Z12(@05),B'00000001'                              1012 03336000
         BNO   @RF01012                                            1012 03337000
*                     IF ADDR(CHALL)^=NULLPTR|ADDR(EMPTY)^=NULLPTR&     03338000
*                         CURX3Z1(BYTINDX2)=ON|ADDR(FULL)^=NULLPTR&     03339000
*                         CURX3Z1(BYTINDX2)=OFF THEN               1013 03340000
         SLR   @05,@05                                             1013 03341000
         L     @15,@PC00001+4                                      1013 03342000
         C     @05,FDTPTR+20(,@15)                                 1013 03343000
         BNE   @RT01013                                            1013 03344000
         C     @05,FDTPTR+16(,@15)                                 1013 03345000
         BE    @GL00069                                            1013 03346000
         LR    @05,CURCBPTR                                        1013 03347000
         ALR   @05,BYTINDX2                                        1013 03348000
         AL    @05,@CF01674                                        1013 03349000
         TM    CURX3Z1(@05),B'00000001'                            1013 03350000
         BO    @RT01013                                            1013 03351000
@GL00069 L     @05,@PC00001+4                                      1013 03352000
         L     @05,FDTPTR+12(,@05)                                 1013 03353000
         LTR   @05,@05                                             1013 03354000
         BZ    @RF01013                                            1013 03355000
         LR    @05,CURCBPTR                                        1013 03356000
         ALR   @05,BYTINDX2                                        1013 03357000
         AL    @05,@CF01674                                        1013 03358000
         TM    CURX3Z1(@05),B'00000001'                            1013 03359000
         BNZ   @RF01013                                            1013 03360000
@RT01013 DS    0H                                                  1014 03361000
*                       DO;         /*                       @Z40LB25*/ 03362000
*                         YSQC(8)=YSQC(8)|YY2;/*             @Z40LB25*/ 03363000
         L     @05,RDCKPTR                                         1015 03364000
         ICM   @15,15,YSQC+28(@05)                                 1015 03365000
         OR    @15,YY2                                             1015 03366000
         STCM  @15,15,YSQC+28(@05)                                 1015 03367000
*                         CHECKFLG=ON;/*                     @Z40LB25*/ 03368000
         OI    CHECKFLG,B'00000010'                                1016 03369000
*                       END;        /*                       @Z40LB25*/ 03370000
*                 END;              /*                       @Z40LB25*/ 03371000
@RF01013 DS    0H                                                  1018 03372000
@RF01012 DS    0H                                                  1019 03373000
*             END;                  /*                       @Z40LB25*/ 03374000
@RF01004 DS    0H                                                  1020 03375000
*           YY2=YY2/2;              /* SHIFT 1 BIT RIGHT     @Z40LB25*/ 03376000
@RF00986 SRL   YY2,1                                               1020 03377000
*         END;                      /*                       @Z40LB25*/ 03378000
         AL    BYTINDX2,@CF00224                                   1021 03379000
         C     BYTINDX2,@CF00047                                   1021 03380000
         BNH   @DL00947                                            1021 03381000
*         CUBEPTR2=CUBEPTR2+LENGTH(CUBE2);/*                 @Z40LB25*/ 03382000
         LA    @05,4                                               1022 03383000
         ALR   CUBEPTR2,@05                                        1022 03384000
*         CURCBPTR=CURCBPTR+LENGTH(CURCUBE);/*               @Z40LB25*/ 03385000
         ALR   CURCBPTR,@05                                        1023 03386000
*       END;                        /*                       @Z40LB25*/ 03387000
*                                                                  1024 03388000
         AL    CUBINDX2,@CF00224                                   1024 03389000
         C     CUBINDX2,@CF00663                                   1024 03390000
         BNH   @DL00946                                            1024 03391000
*       /*************************************************************/ 03392000
*       /*                                                           */ 03393000
*       /* CHECK IF READY TO EXECUTE QCEL                    @Z40LB25*/ 03394000
*       /*                                                           */ 03395000
*       /*************************************************************/ 03396000
*                                                                  1025 03397000
*       IF SETX=ON&CHECKFLG=ON THEN                                1025 03398000
         TM    SETX,B'10000000'                                    1025 03399000
         BNO   @RF01025                                            1025 03400000
         TM    CHECKFLG,B'00000010'                                1025 03401000
         BNO   @RF01025                                            1025 03402000
*         DO;                       /*                       @Z40LB25*/ 03403000
*           SETX=OFF;               /* ALLOW SET OF NXT X    @Z40LB25*/ 03404000
*                                                                  1027 03405000
         NI    SETX,B'01111111'                                    1027 03406000
*           /*********************************************************/ 03407000
*           /*                                                       */ 03408000
*           /* REVERSE THE BITS OF EVERY OTHER WORD IN CMAP  @Z40LB25*/ 03409000
*           /* STARTING WITH THE SECOND WORD. THEY ARE 0 - 27        */ 03410000
*           /*                                               @Z40LB25*/ 03411000
*           /* AND SHOULD BE 27 - 0.                         @Z40LB25*/ 03412000
*           /*                                                       */ 03413000
*           /*********************************************************/ 03414000
*                                                                  1028 03415000
*           RESPECIFY                                              1028 03416000
*            (REG6,                                                1028 03417000
*             REG7) RSTD;           /*                       @Z40LB25*/ 03418000
*           DO I=2 TO 8 BY 2;       /*                       @Z40LB25*/ 03419000
         LA    I,2                                                 1029 03420000
@DL01029 DS    0H                                                  1030 03421000
*             REVRBIT=REVRMASK;     /*                       @Z40LB25*/ 03422000
         L     REVRBIT,REVRMASK                                    1030 03423000
*             REVRESLT=''B;         /*                       @Z40LB25*/ 03424000
         SLR   REVRESLT,REVRESLT                                   1031 03425000
*             REG7=YSQC(I);         /*                       @Z40LB25*/ 03426000
         LR    @03,I                                               1032 03427000
         SLA   @03,2                                               1032 03428000
         L     @01,RDCKPTR                                         1032 03429000
         ALR   @01,@03                                             1032 03430000
         ICM   REG7,15,YSQC-4(@01)                                 1032 03431000
*             DO WHILE REVRBIT^=0;  /*                       @Z40LB25*/ 03432000
         B     @DE01033                                            1033 03433000
@DL01033 DS    0H                                                  1034 03434000
*               REG6=NULLPTR;       /*                       @Z40LB25*/ 03435000
         SLR   REG6,REG6                                           1034 03436000
*               SLDL(REG6,1);       /*                       @Z40LB25*/ 03437000
         SLDL  REG6,1                                              1035 03438000
*               IF REG6=1 THEN                                     1036 03439000
         C     REG6,@CF00224                                       1036 03440000
         BNE   @RF01036                                            1036 03441000
*                 REVRESLT=REVRESLT|REVRBIT;/*               @Z40LB25*/ 03442000
         OR    REVRESLT,REVRBIT                                    1037 03443000
*               REVRBIT=REVRBIT*2;  /* SHIFT 1 BIT           @Z40LB25*/ 03444000
@RF01036 ALR   REVRBIT,REVRBIT                                     1038 03445000
*             END;                  /*                       @Z40LB25*/ 03446000
@DE01033 LTR   REVRBIT,REVRBIT                                     1039 03447000
         BNZ   @DL01033                                            1039 03448000
*             YSQC(I)=REVRESLT;     /*                       @Z40LB25*/ 03449000
         LR    @15,I                                               1040 03450000
         SLA   @15,2                                               1040 03451000
         L     @01,RDCKPTR                                         1040 03452000
         ALR   @01,@15                                             1040 03453000
         STCM  REVRESLT,15,YSQC-4(@01)                             1040 03454000
*           END;                    /*                       @Z40LB25*/ 03455000
         AL    I,@CF00158                                          1041 03456000
         C     I,@CF00184                                          1041 03457000
         BNH   @DL01029                                            1041 03458000
*           RESPECIFY                                              1042 03459000
*            (REG6,                                                1042 03460000
*             REG7) UNRSTD;         /*                       @Z40LB25*/ 03461000
*                                                                  1042 03462000
*           /*********************************************************/ 03463000
*           /*                                                       */ 03464000
*           /* DUMP THE ICBQUERY (QCEL) PARM LIST            @Z40LB25*/ 03465000
*           /*                                                       */ 03466000
*           /*********************************************************/ 03467000
*                                                                  1043 03468000
*           IF GDTDBG=NULLPTR THEN                                 1043 03469000
         L     @15,@PC00001                                        1043 03470000
         L     @15,GDTDBG(,@15)                                    1043 03471000
         LTR   @15,@15                                             1043 03472000
         BZ    @RT01043                                            1043 03473000
*             ;                                                    1044 03474000
*           ELSE                                                   1045 03475000
*             DO;                                                  1045 03476000
*               DMPINDEX=ADDR(DMPSTG);/*                     @Z40LB25*/ 03477000
         LA    DMPINDEX,DMPSTG                                     1046 03478000
*               DMPITMNM='QURYAREA';                               1047 03479000
         MVC   DMPITMNM(8,DMPINDEX),@CC01579                       1047 03480000
*               DMPITMPT=ADDR(QURYAREA);                           1048 03481000
         LA    @03,QURYAREA                                        1048 03482000
         ST    @03,DMPITMPT(,DMPINDEX)                             1048 03483000
*               DMPITMLN=LENGTH(QURYAREA);                         1049 03484000
         MVC   DMPITMLN(2,DMPINDEX),@CH00813                       1049 03485000
*               DMPITMTP='H';                                      1050 03486000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1050 03487000
*               DMPINDEX=DMPINDEX+DMPELEMT;/*                @Z40LB25*/ 03488000
         AL    DMPINDEX,@CF00479                                   1051 03489000
*               DMPTRM=DMPTRMVL;                                   1052 03490000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1052 03491000
*             END;                  /*                       @Z40LB25*/ 03492000
*           IF GDTDBG=NULLPTR THEN                                 1054 03493000
@RT01043 L     @15,@PC00001                                        1054 03494000
         L     @15,GDTDBG(,@15)                                    1054 03495000
         LTR   @15,@15                                             1054 03496000
         BZ    @RT01054                                            1054 03497000
*             ;                                                    1055 03498000
*           ELSE                                                   1056 03499000
*             CALL IDCDB010(GDTTBL,'AUCB',ADDR(DMPSTG));/*   @Z40LB25*/ 03500000
*                                                                  1056 03501000
         L     @15,@PC00001                                        1056 03502000
         ST    @15,@AL00001                                        1056 03503000
         LA    @14,@CC01581                                        1056 03504000
         ST    @14,@AL00001+4                                      1056 03505000
         LA    @14,DMPSTG                                          1056 03506000
         ST    @14,@AFTEMPS                                        1056 03507000
         LA    @14,@AFTEMPS                                        1056 03508000
         ST    @14,@AL00001+8                                      1056 03509000
         MVI   @AL00001+8,X'80'                                    1056 03510000
         L     @15,GDTDBG(,@15)                                    1056 03511000
         LA    @01,@AL00001                                        1056 03512000
         BALR  @14,@15                                             1056 03513000
*           /*********************************************************/ 03514000
*           /*                                                       */ 03515000
*           /* ISSUE USSC TO EXEC QCEL                       @Z40LB25*/ 03516000
*           /*                                                       */ 03517000
*           /*********************************************************/ 03518000
*                                                                  1057 03519000
*           CALL IDCSASS0(GDTTBL,AUDITCEL,RDCKPTR,REASONCD);/*     1057 03520000
*                                                            @Z40LB25*/ 03521000
@RT01054 L     @02,@PC00001                                        1057 03522000
         ST    @02,@AL00001                                        1057 03523000
         LA    @15,AUDITCEL                                        1057 03524000
         ST    @15,@AL00001+4                                      1057 03525000
         LA    @15,RDCKPTR                                         1057 03526000
         ST    @15,@AL00001+8                                      1057 03527000
         LA    @15,REASONCD                                        1057 03528000
         ST    @15,@AL00001+12                                     1057 03529000
         MVI   @AL00001+12,X'80'                                   1057 03530000
         L     @15,GDTSSC(,@02)                                    1057 03531000
         LA    @01,@AL00001                                        1057 03532000
         BALR  @14,@15                                             1057 03533000
*           RESPECIFY                                              1058 03534000
*             RTNREG RSTD;                                         1058 03535000
*           TESTRC=RTNREG;                                         1059 03536000
         LR    TESTRC,RTNREG                                       1059 03537000
*           RESPECIFY                                              1060 03538000
*             RTNREG UNRSTD;        /*                       @Z40LB25*/ 03539000
*                                                                  1060 03540000
*           /*********************************************************/ 03541000
*           /*                                                       */ 03542000
*           /* TEST FOR HARDWARE ERROR                       @Z40LB25*/ 03543000
*           /*                                                       */ 03544000
*           /*********************************************************/ 03545000
*                                                                  1061 03546000
*           IF TESTRC=4 THEN                                       1061 03547000
         C     TESTRC,@CF00047                                     1061 03548000
         BNE   @RF01061                                            1061 03549000
*             CALL SSCMSG(REASONCD);/*                       @Z40LB25*/ 03550000
*                                                                  1062 03551000
         LA    @02,REASONCD                                        1062 03552000
         ST    @02,@AL00001                                        1062 03553000
         LA    @01,@AL00001                                        1062 03554000
         BAL   @14,SSCMSG                                          1062 03555000
*           /*********************************************************/ 03556000
*           /*                                                       */ 03557000
*           /* IF ERROR SET CONDITION CODE AND END           @Z40LB25*/ 03558000
*           /*                                                       */ 03559000
*           /*********************************************************/ 03560000
*                                                                  1063 03561000
*           IF TESTRC=4 THEN                                       1063 03562000
@RF01061 C     TESTRC,@CF00047                                     1063 03563000
         BNE   @RF01063                                            1063 03564000
*             DO;                   /*                       @Z40LB25*/ 03565000
*               IF FRSTUSSC=OFF THEN                               1065 03566000
         TM    FRSTUSSC,B'00000001'                                1065 03567000
         BNZ   @RF01065                                            1065 03568000
*                 CHECKRC=LASTCC12; /*                       @Z40LB25*/ 03569000
         MVC   CHECKRC(2),@CH00571                                 1066 03570000
*               ELSE                                               1067 03571000
*                 CHECKRC=LASTCC08; /*                       @Z40LB25*/ 03572000
         B     @RC01065                                            1067 03573000
@RF01065 MVC   CHECKRC(2),@CH00184                                 1067 03574000
*               RETURN;             /*                       @Z40LB25*/ 03575000
@EL00009 DS    0H                                                  1068 03576000
@EF00009 DS    0H                                                  1068 03577000
@ER00009 L     @14,@SA00009                                        1068 03578000
         BR    @14                                                 1068 03579000
*             END;                  /*                       @Z40LB25*/ 03580000
*                                                                  1069 03581000
*           /*********************************************************/ 03582000
*           /*                                                       */ 03583000
*           /* USSC CALLED ONCE SUCCESSFULLY                 @Z40LB25*/ 03584000
*           /*                                                       */ 03585000
*           /*********************************************************/ 03586000
*                                                                  1070 03587000
*           FRSTUSSC=ON;            /*                       @Z40LB25*/ 03588000
*                                                                  1070 03589000
@RF01063 OI    FRSTUSSC,B'00000001'                                1070 03590000
*           /*********************************************************/ 03591000
*           /*                                                       */ 03592000
*           /* COMPARE RETURNED CELL STATUS                  @Z40LB25*/ 03593000
*           /* WITH THE CURRENT MSC CELL MAP                 @Z40LB25*/ 03594000
*           /*                                                       */ 03595000
*           /*********************************************************/ 03596000
*                                                                  1071 03597000
*           CALL CHKXYZ12;          /*                       @Z40LB25*/ 03598000
         BAL   @14,CHKXYZ12                                        1071 03599000
*           QCPARM=''B;             /* ZERO CHECK XYZS       @Z40LB25*/ 03600000
         L     @01,RDCKPTR                                         1072 03601000
         XC    QCPARM(32,@01),QCPARM(@01)                          1072 03602000
*         END;                      /*                       @Z40LB25*/ 03603000
*                                                                  1073 03604000
*       /*************************************************************/ 03605000
*       /*                                                           */ 03606000
*       /* IF AT THE LAST BLOCK, IT WILL CONTAIN             @Z40LB25*/ 03607000
*       /* ONLY ONE CHUNK                                    @Z40LB25*/ 03608000
*       /*                                                           */ 03609000
*       /*************************************************************/ 03610000
*                                                                  1074 03611000
*       IF BLKINDX2=BLKNUM THEN                                    1074 03612000
@RF01025 CLC   BLKINDX2(2),@CH00047                                1074 03613000
         BNE   @RF01074                                            1074 03614000
*         CHKINDX2=CHUNKNUM;        /*                       @Z40LB25*/ 03615000
         MVC   CHKINDX2(2),@CH00184                                1075 03616000
*       CHUNKPT2=CHUNKPT2+LENGTH(CHUNK2);/*                  @Z40LB25*/ 03617000
@RF01074 LA    @02,32                                              1076 03618000
         L     @15,CHUNKPT2                                        1076 03619000
         ALR   @15,@02                                             1076 03620000
         ST    @15,CHUNKPT2                                        1076 03621000
*       CURCKPTR=CURCKPTR+LENGTH(CURCK);/*                   @Z40LB25*/ 03622000
         AL    @02,CURCKPTR                                        1077 03623000
         ST    @02,CURCKPTR                                        1077 03624000
*       X2=X2+4;                    /*                       @Z40LB25*/ 03625000
         LA    @02,4                                               1078 03626000
         AH    @02,X2                                              1078 03627000
         STH   @02,X2                                              1078 03628000
*       YY2=ONEYMASK;               /*                       @Z40LB25*/ 03629000
         L     YY2,ONEYMASK                                        1079 03630000
*       CHECKFLG=OFF;               /*                       @Z40LB25*/ 03631000
         NI    CHECKFLG,B'11111101'                                1080 03632000
*       SETX=OFF;                   /*                       @Z40LB25*/ 03633000
         NI    SETX,B'01111111'                                    1081 03634000
*     END;                          /*                       @Z40LB25*/ 03635000
         LA    @02,1                                               1082 03636000
         AH    @02,CHKINDX2                                        1082 03637000
         STH   @02,CHKINDX2                                        1082 03638000
         C     @02,@CF00184                                        1082 03639000
         BNH   @DL00943                                            1082 03640000
*     CELLPTR2=CELLPTR2+BLKSIZE;    /*                       @Z40LB25*/ 03641000
         LA    @02,264                                             1083 03642000
         L     @15,CELLPTR2                                        1083 03643000
         ALR   @15,@02                                             1083 03644000
         ST    @15,CELLPTR2                                        1083 03645000
*     CURCLPTR=CURCLPTR+BLKSIZE;    /*                       @Z40LB25*/ 03646000
         AL    @02,CURCLPTR                                        1084 03647000
         ST    @02,CURCLPTR                                        1084 03648000
*   END;                            /*                       @Z40LB25*/ 03649000
         LA    @02,1                                               1085 03650000
         AH    @02,BLKINDX2                                        1085 03651000
         STH   @02,BLKINDX2                                        1085 03652000
         C     @02,@CF00047                                        1085 03653000
         BNH   @DL00940                                            1085 03654000
*   RETURN;                         /*                       @Z40LB25*/ 03655000
         B     @EL00009                                            1086 03656000
*   END CKCELL;                     /*                       @Z40LB25*/ 03657000
         B     @EL00009                                            1087 03658000
*                                                                  1088 03659000
*   /*****************************************************************/ 03660000
*   /*                                                               */ 03661000
*   /* PROCEDURE NAME - CHKXYZ12                             @Z40LB25*/ 03662000
*   /*                                                       @Z40LB25*/ 03663000
*   /* FUNCTION - COMPARES THE CELL STATUS RETURNED BY       @Z40LB25*/ 03664000
*   /* QCEL WITH WHAT THE MSC CURRENT CELL MAP INDICATES.    @Z40LB25*/ 03665000
*   /* IF A DESCREPANCY IS FOUND ITS XYZ IS CALCULATED       @Z40LB25*/ 03666000
*   /* AND THE REPORT TABLE, XYZ1 OR XYZ2, IS UPDATED.       @Z40LB25*/ 03667000
*   /*                                                       @Z40LB25*/ 03668000
*   /* INPUT -                                               @Z40LB25*/ 03669000
*   /* DIAGBUF (CELLPARM)                                    @Z40LB25*/ 03670000
*   /*                                                       @Z40LB25*/ 03671000
*   /* OUTPUT -                                              @Z40LB25*/ 03672000
*   /* CHUNKPTR                                              @Z40LB25*/ 03673000
*   /* CELLPTR                                               @Z40LB25*/ 03674000
*   /* X                                                     @Z40LB25*/ 03675000
*   /* Y                                                     @Z40LB25*/ 03676000
*   /* Z                                                     @Z40LB25*/ 03677000
*   /*                                                               */ 03678000
*   /*****************************************************************/ 03679000
*                                                                  1088 03680000
*CHKXYZ12:                                                         1088 03681000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 03682000
*                                                                  1088 03683000
CHKXYZ12 ST    @14,@SA00010                                        1088 03684000
*   /*****************************************************************/ 03685000
*   /*                                                               */ 03686000
*   /* REVERSE THE BITS IN EVERY OTHER WORD OF QCPARM        @Z40LB25*/ 03687000
*   /* AND RECDBUF STARTING WITH THE SECOND WORD.            @Z40LB25*/ 03688000
*   /* THEY ARE 27 - 0 AND SHOULD BE 0 - 27.                 @Z40LB25*/ 03689000
*   /* CQPARM IS THE INPUT TO ICBQUERY QCEL AND              @Z40LB25*/ 03690000
*   /* RECDBUF IS THE OUTPUT FROM QCEL.                      @Z40LB25*/ 03691000
*   /*                                                               */ 03692000
*   /*****************************************************************/ 03693000
*                                                                  1089 03694000
*   RESPECIFY                                                      1089 03695000
*    (REG6,                                                        1089 03696000
*     REG7) RSTD;                   /*                       @Z40LB25*/ 03697000
*                                                                  1089 03698000
*   /*****************************************************************/ 03699000
*   /*                                                               */ 03700000
*   /* EIGHT WORD PARM LISTS                                 @Z40LB25*/ 03701000
*   /*                                                               */ 03702000
*   /*****************************************************************/ 03703000
*                                                                  1090 03704000
*   DO I=2 TO 8 BY 2;               /*                       @Z40LB25*/ 03705000
*                                                                  1090 03706000
         LA    I,2                                                 1090 03707000
@DL01090 DS    0H                                                  1091 03708000
*     /***************************************************************/ 03709000
*     /*                                                             */ 03710000
*     /* 1 = INPUT TO QCEL AND 2 = OUTPUT FROM QCEL          @Z40LB25*/ 03711000
*     /*                                                             */ 03712000
*     /***************************************************************/ 03713000
*                                                                  1091 03714000
*     DO II=1 TO 2;                 /*                       @Z40LB25*/ 03715000
         LA    II,1                                                1091 03716000
@DL01091 DS    0H                                                  1092 03717000
*       IF II=1 THEN                /* CQPARM                @Z40LB25*/ 03718000
         C     II,@CF00224                                         1092 03719000
         BNE   @RF01092                                            1092 03720000
*         REG7=YSQC(I);             /* INPUT                 @Z40LB25*/ 03721000
         LR    @05,I                                               1093 03722000
         SLA   @05,2                                               1093 03723000
         L     @02,RDCKPTR                                         1093 03724000
         ALR   @02,@05                                             1093 03725000
         ICM   REG7,15,YSQC-4(@02)                                 1093 03726000
*       ELSE                        /* RECDBUF               @Z40LB25*/ 03727000
*         REG7=CKYS(I);             /* OUTPUT                @Z40LB25*/ 03728000
         B     @RC01092                                            1094 03729000
@RF01092 LR    @05,I                                               1094 03730000
         SLA   @05,2                                               1094 03731000
         L     @02,@PC00001+8                                      1094 03732000
         L     @02,BLKPTR(,@02)                                    1094 03733000
         ALR   @02,@05                                             1094 03734000
         ICM   REG7,15,CKYS-4(@02)                                 1094 03735000
*       REVRBIT=REVRMASK;           /*                       @Z40LB25*/ 03736000
@RC01092 L     REVRBIT,REVRMASK                                    1095 03737000
*       REVRESLT=''B;               /*                       @Z40LB25*/ 03738000
         SLR   REVRESLT,REVRESLT                                   1096 03739000
*       DO WHILE REVRBIT^=0;        /*                       @Z40LB25*/ 03740000
         B     @DE01097                                            1097 03741000
@DL01097 DS    0H                                                  1098 03742000
*         REG6=NULLPTR;             /*                       @Z40LB25*/ 03743000
         SLR   REG6,REG6                                           1098 03744000
*         SLDL(REG6,1);             /*                       @Z40LB25*/ 03745000
         SLDL  REG6,1                                              1099 03746000
*         IF REG6=1 THEN                                           1100 03747000
         C     REG6,@CF00224                                       1100 03748000
         BNE   @RF01100                                            1100 03749000
*           REVRESLT=REVRESLT|REVRBIT;/*                     @Z40LB25*/ 03750000
         OR    REVRESLT,REVRBIT                                    1101 03751000
*         REVRBIT=REVRBIT*2;        /* SHIFT 1 BIT           @Z40LB25*/ 03752000
@RF01100 ALR   REVRBIT,REVRBIT                                     1102 03753000
*       END;                        /*                       @Z40LB25*/ 03754000
@DE01097 LTR   REVRBIT,REVRBIT                                     1103 03755000
         BNZ   @DL01097                                            1103 03756000
*       IF II=1 THEN                /* CQPARM                @Z40LB25*/ 03757000
         C     II,@CF00224                                         1104 03758000
         BNE   @RF01104                                            1104 03759000
*         YSQC(I)=REVRESLT;         /*                       @Z40LB25*/ 03760000
         LR    @02,I                                               1105 03761000
         SLA   @02,2                                               1105 03762000
         L     @01,RDCKPTR                                         1105 03763000
         ALR   @01,@02                                             1105 03764000
         STCM  REVRESLT,15,YSQC-4(@01)                             1105 03765000
*       ELSE                        /* RECDBUF               @Z40LB25*/ 03766000
*         CKYS(I)=REVRESLT;         /*                       @Z40LB25*/ 03767000
         B     @RC01104                                            1106 03768000
@RF01104 LR    @02,I                                               1106 03769000
         SLA   @02,2                                               1106 03770000
         L     @15,@PC00001+8                                      1106 03771000
         L     @01,BLKPTR(,@15)                                    1106 03772000
         ALR   @01,@02                                             1106 03773000
         STCM  REVRESLT,15,CKYS-4(@01)                             1106 03774000
*     END;                          /*                       @Z40LB25*/ 03775000
@RC01104 AL    II,@CF00224                                         1107 03776000
         C     II,@CF00158                                         1107 03777000
         BNH   @DL01091                                            1107 03778000
*   END;                            /*                       @Z40LB25*/ 03779000
         AL    I,@CF00158                                          1108 03780000
         C     I,@CF00184                                          1108 03781000
         BNH   @DL01090                                            1108 03782000
*   RESPECIFY                                                      1109 03783000
*    (REG6,                                                        1109 03784000
*     REG7) UNRSTD;                 /*                       @Z40LB25*/ 03785000
*                                                                  1109 03786000
*   /*****************************************************************/ 03787000
*   /*                                                               */ 03788000
*   /* BUILD TEMPQCEL TO REFLECT DISCREPANCIES BETWEEN       @Z40LB25*/ 03789000
*   /* THE QCEL RETURNED INFO AND THE MSC CURRENT CELL MAP   @Z40LB25*/ 03790000
*   /*                                                               */ 03791000
*   /*****************************************************************/ 03792000
*                                                                  1110 03793000
*   IF ADDR(FULL)^=NULLPTR THEN     /* CHECK FOR FULL        @Z40LB25*/ 03794000
         L     @15,@PC00001+4                                      1110 03795000
         L     @15,FDTPTR+12(,@15)                                 1110 03796000
         LTR   @15,@15                                             1110 03797000
         BZ    @RF01110                                            1110 03798000
*     DO I=1 TO 8;                  /*                       @Z40LB25*/ 03799000
         LA    I,1                                                 1111 03800000
@DL01111 DS    0H                                                  1112 03801000
*       TEMPQCEL(I)=CKYS(I)&YSQC(I);/*                       @Z40LB25*/ 03802000
         LR    @05,I                                               1112 03803000
         SLA   @05,2                                               1112 03804000
         LA    @01,TEMPQCEL-4(@05)                                 1112 03805000
         L     @15,@PC00001+8                                      1112 03806000
         L     @15,BLKPTR(,@15)                                    1112 03807000
         ALR   @15,@05                                             1112 03808000
         MVC   0(4,@01),CKYS-4(@15)                                1112 03809000
         L     @15,RDCKPTR                                         1112 03810000
         ALR   @15,@05                                             1112 03811000
         NC    0(4,@01),YSQC-4(@15)                                1112 03812000
*     END;                          /*                       @Z40LB25*/ 03813000
         AL    I,@CF00224                                          1113 03814000
         C     I,@CF00184                                          1113 03815000
         BNH   @DL01111                                            1113 03816000
*   IF ADDR(EMPTY)^=NULLPTR THEN    /* CHECK FOR EMPTY       @Z40LB25*/ 03817000
@RF01110 L     @15,@PC00001+4                                      1114 03818000
         L     @15,FDTPTR+16(,@15)                                 1114 03819000
         LTR   @15,@15                                             1114 03820000
         BZ    @RF01114                                            1114 03821000
*     DO I=1 TO 8;                  /*                       @Z40LB25*/ 03822000
         LA    I,1                                                 1115 03823000
@DL01115 DS    0H                                                  1116 03824000
*       TEMPQCEL(I)=CKYS(I)&&YSQC(I);/*                      @Z40LB25*/ 03825000
         LR    @05,I                                               1116 03826000
         SLA   @05,2                                               1116 03827000
         LA    @01,TEMPQCEL-4(@05)                                 1116 03828000
         L     @15,@PC00001+8                                      1116 03829000
         L     @15,BLKPTR(,@15)                                    1116 03830000
         ALR   @15,@05                                             1116 03831000
         MVC   0(4,@01),CKYS-4(@15)                                1116 03832000
         L     @15,RDCKPTR                                         1116 03833000
         ALR   @15,@05                                             1116 03834000
         XC    0(4,@01),YSQC-4(@15)                                1116 03835000
*     END;                          /*                       @Z40LB25*/ 03836000
         AL    I,@CF00224                                          1117 03837000
         C     I,@CF00184                                          1117 03838000
         BNH   @DL01115                                            1117 03839000
*   IF ADDR(CHALL)^=NULLPTR THEN    /* CHECK FOR ALL         @Z40LB25*/ 03840000
@RF01114 L     @15,@PC00001+4                                      1118 03841000
         L     @15,FDTPTR+20(,@15)                                 1118 03842000
         LTR   @15,@15                                             1118 03843000
         BZ    @RF01118                                            1118 03844000
*     DO I=1 TO 8;                  /*                       @Z40LB25*/ 03845000
         LA    I,1                                                 1119 03846000
@DL01119 DS    0H                                                  1120 03847000
*       TEMPQCEL(I)=YSQC(I);        /*                       @Z40LB25*/ 03848000
         LR    @05,I                                               1120 03849000
         SLA   @05,2                                               1120 03850000
         LA    @01,TEMPQCEL-4(@05)                                 1120 03851000
         L     @15,RDCKPTR                                         1120 03852000
         ALR   @15,@05                                             1120 03853000
         MVC   0(4,@01),YSQC-4(@15)                                1120 03854000
*     END;                          /*                       @Z40LB25*/ 03855000
*                                                                  1121 03856000
         AL    I,@CF00224                                          1121 03857000
         C     I,@CF00184                                          1121 03858000
         BNH   @DL01119                                            1121 03859000
*   /*****************************************************************/ 03860000
*   /*                                                               */ 03861000
*   /* COMPARE QCEL OUTPUT (CKYS) WITH THE CONTENTS          @Z40LB25*/ 03862000
*   /* OF TEMPQCEL. AN ON BIT IN CKYS WHICH HAS              @Z40LB25*/ 03863000
*   /* A CORRESPONDING ON BIT IN TEMPQCEL MEANS              @Z40LB25*/ 03864000
*   /* THE XYZ OF THE BIT IN TEMPQCEL WILL                   @Z40LB25*/ 03865000
*   /* BE DETERMINED AND THE BIT IN XYZ1 WORK                @Z40LB25*/ 03866000
*   /* AREA WHICH CORRESPONDS TO THE XYZ IS SET ON.          @Z40LB25*/ 03867000
*   /* AN OFF BIT IN CKYS WHICH HAS A CORRESPONDING          @Z40LB25*/ 03868000
*   /* ON BIT IN TEMPQCEL MEANS THE XYZ OF THE ON BIT        @Z40LB25*/ 03869000
*   /* IN TEMPQCEL WILL BE DETERMINED AND THE BIT            @Z40LB25*/ 03870000
*   /* IN XYZ2 WORK AREA WHICH CORRESPONDS TO THE            @Z40LB25*/ 03871000
*   /* XYZ IS SET ON.                                        @Z40LB25*/ 03872000
*   /*                                                               */ 03873000
*   /*****************************************************************/ 03874000
*                                                                  1122 03875000
*   X1=QUXADDR;                     /* SET X                 @Z40LB25*/ 03876000
*                                                                  1122 03877000
@RF01118 L     @01,RDCKPTR                                         1122 03878000
         SLR   @00,@00                                             1122 03879000
         IC    @00,QUXADDR(,@01)                                   1122 03880000
         STH   @00,X1                                              1122 03881000
*   /*****************************************************************/ 03882000
*   /*                                                               */ 03883000
*   /* SCAN THE X WORDS                                      @Z40LB25*/ 03884000
*   /*                                                               */ 03885000
*   /*****************************************************************/ 03886000
*                                                                  1123 03887000
*   DO XWRDINDX=1 TO 8;             /*                       @Z40LB25*/ 03888000
         LA    @15,1                                               1123 03889000
         STH   @15,XWRDINDX                                        1123 03890000
@DL01123 DS    0H                                                  1124 03891000
*     Y1=0;                         /*                       @Z40LB25*/ 03892000
         SLR   @14,@14                                             1124 03893000
         STH   @14,Y1                                              1124 03894000
*     IF(XWRDINDX=1|XWRDINDX=3|XWRDINDX=5|XWRDINDX=7) THEN         1125 03895000
         C     @15,@CF00224                                        1125 03896000
         BE    @RT01125                                            1125 03897000
         C     @15,@CF00167                                        1125 03898000
         BE    @RT01125                                            1125 03899000
         C     @15,@CF00291                                        1125 03900000
         BE    @RT01125                                            1125 03901000
         C     @15,@CF00663                                        1125 03902000
         BNE   @RF01125                                            1125 03903000
@RT01125 DS    0H                                                  1126 03904000
*       Z=0;                        /*                       @Z40LB25*/ 03905000
         SLR   @15,@15                                             1126 03906000
         STH   @15,Z                                               1126 03907000
*     ELSE                                                         1127 03908000
*       Z=1;                        /*                       @Z40LB25*/ 03909000
         B     @RC01125                                            1127 03910000
@RF01125 MVC   Z(2),@CH00224                                       1127 03911000
*     IF(XWRDINDX=3|XWRDINDX=5|XWRDINDX=7) THEN                    1128 03912000
@RC01125 LH    @15,XWRDINDX                                        1128 03913000
         C     @15,@CF00167                                        1128 03914000
         BE    @RT01128                                            1128 03915000
         C     @15,@CF00291                                        1128 03916000
         BE    @RT01128                                            1128 03917000
         C     @15,@CF00663                                        1128 03918000
         BNE   @RF01128                                            1128 03919000
@RT01128 DS    0H                                                  1129 03920000
*       X1=X1+1;                    /*                       @Z40LB25*/ 03921000
*                                                                  1129 03922000
         LA    @15,1                                               1129 03923000
         AH    @15,X1                                              1129 03924000
         STH   @15,X1                                              1129 03925000
*     /***************************************************************/ 03926000
*     /*                                                             */ 03927000
*     /* SCAN EACH BYTE OF THE X WORD                        @Z40LB25*/ 03928000
*     /*                                                             */ 03929000
*     /***************************************************************/ 03930000
*                                                                  1130 03931000
*     DO BYTEINDX=1 TO 4;           /*                       @Z40LB25*/ 03932000
@RF01128 LA    @15,1                                               1130 03933000
         STH   @15,BYTEINDX                                        1130 03934000
@DL01130 DS    0H                                                  1131 03935000
*       BITMASK=ONEBIT;             /*                       @Z40LB25*/ 03936000
*                                                                  1131 03937000
         MVC   BITMASK(1),ONEBIT                                   1131 03938000
*       /*************************************************************/ 03939000
*       /*                                                           */ 03940000
*       /* SCAN THE BITS OF EACH BYTE FOR A Y BIT            @Z40LB25*/ 03941000
*       /*                                                           */ 03942000
*       /*************************************************************/ 03943000
*                                                                  1132 03944000
*       DO YBITINDX=1 TO 8;         /*                       @Z40LB25*/ 03945000
*                                                                  1132 03946000
         LA    @15,1                                               1132 03947000
         STH   @15,YBITINDX                                        1132 03948000
@DL01132 DS    0H                                                  1133 03949000
*         /***********************************************************/ 03950000
*         /*                                                         */ 03951000
*         /* CHECK IF TEMPQCEL HAS AN XYZ FOR XYZ1           @Z40LB25*/ 03952000
*         /* WORK AREA                                       @Z40LB25*/ 03953000
*         /* FOR FULL - CELLS FOUND VACANT MSC INDICATES     @Z40LB25*/ 03954000
*         /* OCCUPIED                                        @Z40LB25*/ 03955000
*         /* FOR ALL - CELLS FOUND VACANT                    @Z40LB25*/ 03956000
*         /*                                                         */ 03957000
*         /***********************************************************/ 03958000
*                                                                  1133 03959000
*         IF(CKYS(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)=BITMASK&(   1133 03960000
*             TEMPQCEL(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)=BITMASK     03961000
*           THEN                                                   1133 03962000
         SLR   @15,@15                                             1133 03963000
         IC    @15,BITMASK                                         1133 03964000
         LH    @14,XWRDINDX                                        1133 03965000
         SLA   @14,2                                               1133 03966000
         AH    @14,BYTEINDX                                        1133 03967000
         L     @07,@PC00001+8                                      1133 03968000
         L     @01,BLKPTR(,@07)                                    1133 03969000
         SLR   @00,@00                                             1133 03970000
         IC    @00,CKYS-5(@14,@01)                                 1133 03971000
         NR    @00,@15                                             1133 03972000
         CR    @00,@15                                             1133 03973000
         BNE   @RF01133                                            1133 03974000
         SLR   @07,@07                                             1133 03975000
         IC    @07,TEMPQCEL-5(@14)                                 1133 03976000
         NR    @07,@15                                             1133 03977000
         CR    @07,@15                                             1133 03978000
         BNE   @RF01133                                            1133 03979000
*           DO;                     /*                       @Z40LB25*/ 03980000
*             CHUNKPTR=ADDR(XYZ1CUBE(1));/*                  @Z40LB25*/ 03981000
         L     @15,XYZ1PTR                                         1135 03982000
         LA    @14,XYZ1CUBE(,@15)                                  1135 03983000
         ST    @14,CHUNKPTR                                        1135 03984000
*             CELLPTR=ADDR(XYZ1BLK(1));/*                    @Z40LB25*/ 03985000
         ST    @15,CELLPTR                                         1136 03986000
*             X=X1;                 /*                       @Z40LB25*/ 03987000
         LH    @15,X1                                              1137 03988000
         STH   @15,X                                               1137 03989000
*             Y=Y1;                 /*                       @Z40LB25*/ 03990000
*                                                                  1138 03991000
         LH    @15,Y1                                              1138 03992000
         ST    @15,Y                                               1138 03993000
*             /*******************************************************/ 03994000
*             /*                                                     */ 03995000
*             /* CONVERT THE LOCATION TO AN ON BIT IN XYZ1   @Z40LB25*/ 03996000
*             /*                                                     */ 03997000
*             /*******************************************************/ 03998000
*                                                                  1139 03999000
*             CALL LOCTOBIT;        /*                       @Z40LB25*/ 04000000
         BAL   @14,LOCTOBIT                                        1139 04001000
*             PRTXYZ1=ON;           /*                       @Z40LB25*/ 04002000
         OI    PRTXYZ1,B'01000000'                                 1140 04003000
*           END;                    /*                       @Z40LB25*/ 04004000
*                                                                  1141 04005000
*         /***********************************************************/ 04006000
*         /*                                                         */ 04007000
*         /* CHECK IF TEMPQCEL HAS AN XYZ FOR XYZ2           @Z40LB25*/ 04008000
*         /* WORK AREA                                       @Z40LB25*/ 04009000
*         /* FOR EMPTY - CELLS FOUND OCCUPIED MSC INDICATES  @Z40LB25*/ 04010000
*         /* VACANT                                          @Z40LB25*/ 04011000
*         /* FOR ALL - CELLS FOUND OCCUPIED                  @Z40LB25*/ 04012000
*         /*                                                         */ 04013000
*         /***********************************************************/ 04014000
*                                                                  1142 04015000
*         IF(CKYS(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)^=BITMASK&(  1142 04016000
*             TEMPQCEL(XWRDINDX,BYTEINDX:BYTEINDX)&BITMASK)=BITMASK     04017000
*           THEN                                                   1142 04018000
@RF01133 SLR   @15,@15                                             1142 04019000
         IC    @15,BITMASK                                         1142 04020000
         LH    @14,XWRDINDX                                        1142 04021000
         SLA   @14,2                                               1142 04022000
         AH    @14,BYTEINDX                                        1142 04023000
         L     @07,@PC00001+8                                      1142 04024000
         L     @01,BLKPTR(,@07)                                    1142 04025000
         SLR   @00,@00                                             1142 04026000
         IC    @00,CKYS-5(@14,@01)                                 1142 04027000
         NR    @00,@15                                             1142 04028000
         CR    @00,@15                                             1142 04029000
         BE    @RF01142                                            1142 04030000
         SLR   @07,@07                                             1142 04031000
         IC    @07,TEMPQCEL-5(@14)                                 1142 04032000
         NR    @07,@15                                             1142 04033000
         CR    @07,@15                                             1142 04034000
         BNE   @RF01142                                            1142 04035000
*           DO;                     /*                       @Z40LB25*/ 04036000
*             CHUNKPTR=ADDR(XYZ2CUBE(1));/*                  @Z40LB25*/ 04037000
         L     @15,XYZ2PTR                                         1144 04038000
         LA    @14,XYZ2CUBE(,@15)                                  1144 04039000
         ST    @14,CHUNKPTR                                        1144 04040000
*             CELLPTR=ADDR(XYZ2BLK(1));/*                    @Z40LB25*/ 04041000
         ST    @15,CELLPTR                                         1145 04042000
*             X=X1;                 /*                       @Z40LB25*/ 04043000
         LH    @15,X1                                              1146 04044000
         STH   @15,X                                               1146 04045000
*             Y=Y1;                 /*                       @Z40LB25*/ 04046000
*                                                                  1147 04047000
         LH    @15,Y1                                              1147 04048000
         ST    @15,Y                                               1147 04049000
*             /*******************************************************/ 04050000
*             /*                                                     */ 04051000
*             /* CONVERT THE LOCATION TO AN ON BIT IN XYZ2   @Z40LB25*/ 04052000
*             /*                                                     */ 04053000
*             /*******************************************************/ 04054000
*                                                                  1148 04055000
*             CALL LOCTOBIT;        /*                       @Z40LB25*/ 04056000
         BAL   @14,LOCTOBIT                                        1148 04057000
*             PRTXYZ2=ON;           /*                       @Z40LB25*/ 04058000
         OI    PRTXYZ2,B'00100000'                                 1149 04059000
*           END;                    /*                       @Z40LB25*/ 04060000
*         SRL(BITMASK,1);           /*                       @Z40LB25*/ 04061000
@RF01142 SLR   @15,@15                                             1151 04062000
         IC    @15,BITMASK                                         1151 04063000
         SRL   @15,1                                               1151 04064000
         STC   @15,BITMASK                                         1151 04065000
*         Y1=Y1+1;                  /*                       @Z40LB25*/ 04066000
*                                                                  1152 04067000
         LA    @15,1                                               1152 04068000
         AH    @15,Y1                                              1152 04069000
         STH   @15,Y1                                              1152 04070000
*         /***********************************************************/ 04071000
*         /*                                                         */ 04072000
*         /* CHECK FOR Y=28, LAST Y IN THE X WORD            @Z40LB25*/ 04073000
*         /*                                                         */ 04074000
*         /***********************************************************/ 04075000
*                                                                  1153 04076000
*         IF Y1=YMAX THEN                                          1153 04077000
         C     @15,@CF01239                                        1153 04078000
         BNE   @RF01153                                            1153 04079000
*           YBITINDX=8;             /* END THIS X WORD       @Z40LB25*/ 04080000
         MVC   YBITINDX(2),@CH00184                                1154 04081000
*       END;                        /*                       @Z40LB25*/ 04082000
@RF01153 LA    @15,1                                               1155 04083000
         AH    @15,YBITINDX                                        1155 04084000
         STH   @15,YBITINDX                                        1155 04085000
         C     @15,@CF00184                                        1155 04086000
         BNH   @DL01132                                            1155 04087000
*     END;                          /*                       @Z40LB25*/ 04088000
         LA    @15,1                                               1156 04089000
         AH    @15,BYTEINDX                                        1156 04090000
         STH   @15,BYTEINDX                                        1156 04091000
         C     @15,@CF00047                                        1156 04092000
         BNH   @DL01130                                            1156 04093000
*   END;                            /*                       @Z40LB25*/ 04094000
*                                                                  1157 04095000
         LA    @15,1                                               1157 04096000
         AH    @15,XWRDINDX                                        1157 04097000
         STH   @15,XWRDINDX                                        1157 04098000
         C     @15,@CF00184                                        1157 04099000
         BNH   @DL01123                                            1157 04100000
*   /*****************************************************************/ 04101000
*   /*                                                               */ 04102000
*   /* CHECK FOR ALL. COMPARE RESULTS OF QCEL WITH           @Z40LB25*/ 04103000
*   /* THE CURRENT CELL MAP                                  @Z40LB25*/ 04104000
*   /*                                                               */ 04105000
*   /*****************************************************************/ 04106000
*                                                                  1158 04107000
*   IF ADDR(CHALL)^=NULLPTR THEN                                   1158 04108000
         L     @15,@PC00001+4                                      1158 04109000
         L     @15,FDTPTR+20(,@15)                                 1158 04110000
         LTR   @15,@15                                             1158 04111000
         BZ    @RF01158                                            1158 04112000
*     DO;                           /*                       @Z40LB25*/ 04113000
*       PRTXYZ1=OFF;                /*                       @Z40LB25*/ 04114000
*       PRTXYZ2=OFF;                /*                       @Z40LB25*/ 04115000
         NI    PRTXYZ1,B'10011111'                                 1161 04116000
*       DO I=1 TO 2;                /*                       @Z40LB25*/ 04117000
         LA    I,1                                                 1162 04118000
@DL01162 DS    0H                                                  1163 04119000
*         IF I=1 THEN               /* XYZ1 WORK AREA        @Z40LB25*/ 04120000
         C     I,@CF00224                                          1163 04121000
         BNE   @RF01163                                            1163 04122000
*           DO;                     /*                       @Z40LB25*/ 04123000
*                                                                  1164 04124000
*             /*******************************************************/ 04125000
*             /*                                                     */ 04126000
*             /* SET UP FOR CELLS FOUND                      @Z40LB25*/ 04127000
*             /* VACANT (MSC TABLES INDICATE OCCUPIED)       @Z40LB25*/ 04128000
*             /*                                                     */ 04129000
*             /*******************************************************/ 04130000
*                                                                  1165 04131000
*             CHUNKPTR=ADDR(XYZ1CUBE(1));/*                  @Z40LB25*/ 04132000
         L     @05,XYZ1PTR                                         1165 04133000
         LA    @15,XYZ1CUBE(,@05)                                  1165 04134000
         ST    @15,CHUNKPTR                                        1165 04135000
*             CELLPTR=ADDR(XYZ1BLK(1));/*                    @Z40LB25*/ 04136000
         ST    @05,CELLPTR                                         1166 04137000
*           END;                    /*                       @Z40LB25*/ 04138000
*         ELSE                                                     1168 04139000
*           DO;                     /*                       @Z40LB25*/ 04140000
*                                                                  1168 04141000
         B     @RC01163                                            1168 04142000
@RF01163 DS    0H                                                  1169 04143000
*             /*******************************************************/ 04144000
*             /*                                                     */ 04145000
*             /* SET UP FOR CELLS FOUND                      @Z40LB25*/ 04146000
*             /* OCCUPIED (MSC TABLES INDICATE VACANT)       @Z40LB25*/ 04147000
*             /*                                                     */ 04148000
*             /*******************************************************/ 04149000
*                                                                  1169 04150000
*             CHUNKPTR=ADDR(XYZ2CUBE(1));/*                  @Z40LB25*/ 04151000
         L     @05,XYZ2PTR                                         1169 04152000
         LA    @15,XYZ2CUBE(,@05)                                  1169 04153000
         ST    @15,CHUNKPTR                                        1169 04154000
*             CELLPTR=ADDR(XYZ2BLK(1));/*                    @Z40LB25*/ 04155000
         ST    @05,CELLPTR                                         1170 04156000
*           END;                    /*                       @Z40LB25*/ 04157000
*         CURCKPTR=ADDR(CELLCUBE(1));/*                      @Z40LB25*/ 04158000
@RC01163 L     @05,@PC00001+8                                      1172 04159000
         L     @05,BLKPTR(,@05)                                    1172 04160000
         LA    @15,CELLCUBE(,@05)                                  1172 04161000
         ST    @15,CURCKPTR                                        1172 04162000
*         CURCLPTR=ADDR(CELLMAP(1));/*                       @Z40LB25*/ 04163000
         LA    @05,CELLMAP(,@05)                                   1173 04164000
         ST    @05,CURCLPTR                                        1173 04165000
*         X=XSTART;                 /* 150                   @Z40LB25*/ 04166000
*                                                                  1174 04167000
         MVC   X(2),@CH01256                                       1174 04168000
*         /***********************************************************/ 04169000
*         /*                                                         */ 04170000
*         /* SCAN THE FOUR BLOCKS                            @Z40LB25*/ 04171000
*         /*                                                         */ 04172000
*         /***********************************************************/ 04173000
*                                                                  1175 04174000
*         DO BLKINDEX=1 TO BLKNUM;  /*                       @Z40LB25*/ 04175000
*                                                                  1175 04176000
         LA    BLKINDEX,1                                          1175 04177000
@DL01175 DS    0H                                                  1176 04178000
*           /*********************************************************/ 04179000
*           /*                                                       */ 04180000
*           /* SCAN THE CHUNKS OF EACH OF THE BLOCKS         @Z40LB25*/ 04181000
*           /*                                                       */ 04182000
*           /*********************************************************/ 04183000
*                                                                  1176 04184000
*           DO CHKINDEX=1 TO CHUNKNUM;/*                     @Z40LB25*/ 04185000
         LA    @06,1                                               1176 04186000
         STH   @06,CHKINDEX                                        1176 04187000
@DL01176 DS    0H                                                  1177 04188000
*             CUBEPTR=CHUNKPTR;     /*                       @Z40LB25*/ 04189000
         L     CUBEPTR,CHUNKPTR                                    1177 04190000
*             CURCBPTR=CURCKPTR;    /*                       @Z40LB25*/ 04191000
*                                                                  1178 04192000
         L     CURCBPTR,CURCKPTR                                   1178 04193000
*             /*******************************************************/ 04194000
*             /*                                                     */ 04195000
*             /* SCAN THE CUBES PER CHUNK                    @Z40LB25*/ 04196000
*             /*                                                     */ 04197000
*             /*******************************************************/ 04198000
*                                                                  1179 04199000
*             DO CUBINDEX=1 TO CUBENUM;/*                    @Z40LB25*/ 04200000
*                                                                  1179 04201000
         LA    @05,1                                               1179 04202000
         STH   @05,CUBINDEX                                        1179 04203000
@DL01179 DS    0H                                                  1180 04204000
*               /*****************************************************/ 04205000
*               /*                                                   */ 04206000
*               /* SCAN EACH BIT PER BYTE                    @Z40LB25*/ 04207000
*               /*                                                   */ 04208000
*               /*****************************************************/ 04209000
*                                                                  1180 04210000
*               DO BYTINDEX=1 TO BYTENUM;/*                  @Z40LB25*/ 04211000
         LA    BYTINDEX,1                                          1180 04212000
@DL01180 DS    0H                                                  1181 04213000
*                 TEMPX=''B;        /*                       @Z40LB25*/ 04214000
*                                                                  1181 04215000
         SLR   TEMPX,TEMPX                                         1181 04216000
*                 /***************************************************/ 04217000
*                 /*                                                 */ 04218000
*                 /* CHECK X                                 @Z40LB25*/ 04219000
*                 /*                                                 */ 04220000
*                 /***************************************************/ 04221000
*                                                                  1182 04222000
*                 IF X+TEMPX=>MSFLOWX THEN                         1182 04223000
         LR    @15,TEMPX                                           1182 04224000
         AH    @15,X                                               1182 04225000
         C     @15,MSFLOWX                                         1182 04226000
         BL    @RF01182                                            1182 04227000
*                   DO;             /*                       @Z40LB25*/ 04228000
*                     IF I=1 THEN                                  1184 04229000
         C     I,@CF00224                                          1184 04230000
         BNE   @RF01184                                            1184 04231000
*                       DO;         /*                       @Z40LB25*/ 04232000
*                         IF X0Z0(BYTINDEX)=ON THEN                1186 04233000
         LR    @01,CUBEPTR                                         1186 04234000
         ALR   @01,BYTINDEX                                        1186 04235000
         AL    @01,@CF01674                                        1186 04236000
         TM    X0Z0(@01),B'10000000'                               1186 04237000
         BNO   @RF01186                                            1186 04238000
*                           IF CURX0Z0(BYTINDEX)=ON THEN           1187 04239000
         LR    @01,CURCBPTR                                        1187 04240000
         ALR   @01,BYTINDEX                                        1187 04241000
         AL    @01,@CF01674                                        1187 04242000
         TM    CURX0Z0(@01),B'10000000'                            1187 04243000
         BNO   @RF01187                                            1187 04244000
*                             X0Z0(BYTINDEX)=OFF;/*          @Z40LB25*/ 04245000
         LR    @01,CUBEPTR                                         1188 04246000
         ALR   @01,BYTINDEX                                        1188 04247000
         AL    @01,@CF01674                                        1188 04248000
         NI    X0Z0(@01),B'01111111'                               1188 04249000
*                           ELSE                                   1189 04250000
*                             PRTXYZ1=ON;/*                  @Z40LB25*/ 04251000
         B     @RC01187                                            1189 04252000
@RF01187 OI    PRTXYZ1,B'01000000'                                 1189 04253000
*                         IF X0Z1(BYTINDEX)=ON THEN                1190 04254000
@RC01187 DS    0H                                                  1190 04255000
@RF01186 LR    @01,CUBEPTR                                         1190 04256000
         ALR   @01,BYTINDEX                                        1190 04257000
         AL    @01,@CF01674                                        1190 04258000
         TM    X0Z1(@01),B'01000000'                               1190 04259000
         BNO   @RF01190                                            1190 04260000
*                           IF CURX0Z1(BYTINDEX)=ON THEN           1191 04261000
         LR    @01,CURCBPTR                                        1191 04262000
         ALR   @01,BYTINDEX                                        1191 04263000
         AL    @01,@CF01674                                        1191 04264000
         TM    CURX0Z1(@01),B'01000000'                            1191 04265000
         BNO   @RF01191                                            1191 04266000
*                             X0Z1(BYTINDEX)=OFF;/*          @Z40LB25*/ 04267000
         LR    @01,CUBEPTR                                         1192 04268000
         ALR   @01,BYTINDEX                                        1192 04269000
         AL    @01,@CF01674                                        1192 04270000
         NI    X0Z1(@01),B'10111111'                               1192 04271000
*                           ELSE                                   1193 04272000
*                             PRTXYZ1=ON;/*                  @Z40LB25*/ 04273000
         B     @RC01191                                            1193 04274000
@RF01191 OI    PRTXYZ1,B'01000000'                                 1193 04275000
*                       END;        /*                       @Z40LB25*/ 04276000
*                     ELSE                                         1195 04277000
*                       DO;         /*                       @Z40LB25*/ 04278000
         B     @RC01184                                            1195 04279000
@RF01184 DS    0H                                                  1196 04280000
*                         IF X0Z0(BYTINDEX)=ON THEN                1196 04281000
         LR    @01,CUBEPTR                                         1196 04282000
         ALR   @01,BYTINDEX                                        1196 04283000
         AL    @01,@CF01674                                        1196 04284000
         TM    X0Z0(@01),B'10000000'                               1196 04285000
         BNO   @RF01196                                            1196 04286000
*                           IF CURX0Z0(BYTINDEX)=OFF THEN          1197 04287000
         LR    @01,CURCBPTR                                        1197 04288000
         ALR   @01,BYTINDEX                                        1197 04289000
         AL    @01,@CF01674                                        1197 04290000
         TM    CURX0Z0(@01),B'10000000'                            1197 04291000
         BNZ   @RF01197                                            1197 04292000
*                             X0Z0(BYTINDEX)=OFF;/*          @Z40LB25*/ 04293000
         LR    @01,CUBEPTR                                         1198 04294000
         ALR   @01,BYTINDEX                                        1198 04295000
         AL    @01,@CF01674                                        1198 04296000
         NI    X0Z0(@01),B'01111111'                               1198 04297000
*                           ELSE                                   1199 04298000
*                             PRTXYZ2=ON;/*                  @Z40LB25*/ 04299000
         B     @RC01197                                            1199 04300000
@RF01197 OI    PRTXYZ2,B'00100000'                                 1199 04301000
*                         IF X0Z1(BYTINDEX)=ON THEN                1200 04302000
@RC01197 DS    0H                                                  1200 04303000
@RF01196 LR    @01,CUBEPTR                                         1200 04304000
         ALR   @01,BYTINDEX                                        1200 04305000
         AL    @01,@CF01674                                        1200 04306000
         TM    X0Z1(@01),B'01000000'                               1200 04307000
         BNO   @RF01200                                            1200 04308000
*                           IF CURX0Z1(BYTINDEX)=OFF THEN          1201 04309000
         LR    @01,CURCBPTR                                        1201 04310000
         ALR   @01,BYTINDEX                                        1201 04311000
         AL    @01,@CF01674                                        1201 04312000
         TM    CURX0Z1(@01),B'01000000'                            1201 04313000
         BNZ   @RF01201                                            1201 04314000
*                             X0Z1(BYTINDEX)=OFF;/*          @Z40LB25*/ 04315000
         LR    @01,CUBEPTR                                         1202 04316000
         ALR   @01,BYTINDEX                                        1202 04317000
         AL    @01,@CF01674                                        1202 04318000
         NI    X0Z1(@01),B'10111111'                               1202 04319000
*                           ELSE                                   1203 04320000
*                             PRTXYZ2=ON;/*                  @Z40LB25*/ 04321000
         B     @RC01201                                            1203 04322000
@RF01201 OI    PRTXYZ2,B'00100000'                                 1203 04323000
*                       END;        /*                       @Z40LB25*/ 04324000
@RC01201 DS    0H                                                  1204 04325000
@RF01200 DS    0H                                                  1205 04326000
*                   END;            /*                       @Z40LB25*/ 04327000
@RC01184 DS    0H                                                  1206 04328000
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/ 04329000
*                                                                  1206 04330000
@RF01182 LA    @15,1                                               1206 04331000
         ALR   TEMPX,@15                                           1206 04332000
*                 /***************************************************/ 04333000
*                 /*                                                 */ 04334000
*                 /* CHECK X+1                               @Z40LB25*/ 04335000
*                 /*                                                 */ 04336000
*                 /***************************************************/ 04337000
*                                                                  1207 04338000
*                 IF X+TEMPX=>MSFLOWX THEN                         1207 04339000
         LR    @14,TEMPX                                           1207 04340000
         AH    @14,X                                               1207 04341000
         C     @14,MSFLOWX                                         1207 04342000
         BL    @RF01207                                            1207 04343000
*                   DO;             /*                       @Z40LB25*/ 04344000
*                     IF I=1 THEN                                  1209 04345000
         CR    I,@15                                               1209 04346000
         BNE   @RF01209                                            1209 04347000
*                       DO;         /*                       @Z40LB25*/ 04348000
*                         IF X1Z0(BYTINDEX)=ON THEN                1211 04349000
         LR    @01,CUBEPTR                                         1211 04350000
         ALR   @01,BYTINDEX                                        1211 04351000
         AL    @01,@CF01674                                        1211 04352000
         TM    X1Z0(@01),B'00100000'                               1211 04353000
         BNO   @RF01211                                            1211 04354000
*                           IF CURX1Z0(BYTINDEX)=ON THEN           1212 04355000
         LR    @01,CURCBPTR                                        1212 04356000
         ALR   @01,BYTINDEX                                        1212 04357000
         AL    @01,@CF01674                                        1212 04358000
         TM    CURX1Z0(@01),B'00100000'                            1212 04359000
         BNO   @RF01212                                            1212 04360000
*                             X1Z0(BYTINDEX)=OFF;/*          @Z40LB25*/ 04361000
         LR    @01,CUBEPTR                                         1213 04362000
         ALR   @01,BYTINDEX                                        1213 04363000
         AL    @01,@CF01674                                        1213 04364000
         NI    X1Z0(@01),B'11011111'                               1213 04365000
*                           ELSE                                   1214 04366000
*                             PRTXYZ1=ON;/*                  @Z40LB25*/ 04367000
         B     @RC01212                                            1214 04368000
@RF01212 OI    PRTXYZ1,B'01000000'                                 1214 04369000
*                         IF X1Z1(BYTINDEX)=ON THEN                1215 04370000
@RC01212 DS    0H                                                  1215 04371000
@RF01211 LR    @01,CUBEPTR                                         1215 04372000
         ALR   @01,BYTINDEX                                        1215 04373000
         AL    @01,@CF01674                                        1215 04374000
         TM    X1Z1(@01),B'00010000'                               1215 04375000
         BNO   @RF01215                                            1215 04376000
*                           IF CURX1Z1(BYTINDEX)=ON THEN           1216 04377000
         LR    @01,CURCBPTR                                        1216 04378000
         ALR   @01,BYTINDEX                                        1216 04379000
         AL    @01,@CF01674                                        1216 04380000
         TM    CURX1Z1(@01),B'00010000'                            1216 04381000
         BNO   @RF01216                                            1216 04382000
*                             X1Z1(BYTINDEX)=OFF;/*          @Z40LB25*/ 04383000
         LR    @01,CUBEPTR                                         1217 04384000
         ALR   @01,BYTINDEX                                        1217 04385000
         AL    @01,@CF01674                                        1217 04386000
         NI    X1Z1(@01),B'11101111'                               1217 04387000
*                           ELSE                                   1218 04388000
*                             PRTXYZ1=ON;/*                  @Z40LB25*/ 04389000
         B     @RC01216                                            1218 04390000
@RF01216 OI    PRTXYZ1,B'01000000'                                 1218 04391000
*                       END;        /*                       @Z40LB25*/ 04392000
*                     ELSE                                         1220 04393000
*                       DO;         /*                       @Z40LB25*/ 04394000
         B     @RC01209                                            1220 04395000
@RF01209 DS    0H                                                  1221 04396000
*                         IF X1Z0(BYTINDEX)=ON THEN                1221 04397000
         LR    @01,CUBEPTR                                         1221 04398000
         ALR   @01,BYTINDEX                                        1221 04399000
         AL    @01,@CF01674                                        1221 04400000
         TM    X1Z0(@01),B'00100000'                               1221 04401000
         BNO   @RF01221                                            1221 04402000
*                           IF CURX1Z0(BYTINDEX)=OFF THEN          1222 04403000
         LR    @01,CURCBPTR                                        1222 04404000
         ALR   @01,BYTINDEX                                        1222 04405000
         AL    @01,@CF01674                                        1222 04406000
         TM    CURX1Z0(@01),B'00100000'                            1222 04407000
         BNZ   @RF01222                                            1222 04408000
*                             X1Z0(BYTINDEX)=OFF;/*          @Z40LB25*/ 04409000
         LR    @01,CUBEPTR                                         1223 04410000
         ALR   @01,BYTINDEX                                        1223 04411000
         AL    @01,@CF01674                                        1223 04412000
         NI    X1Z0(@01),B'11011111'                               1223 04413000
*                           ELSE                                   1224 04414000
*                             PRTXYZ2=ON;/*                  @Z40LB25*/ 04415000
         B     @RC01222                                            1224 04416000
@RF01222 OI    PRTXYZ2,B'00100000'                                 1224 04417000
*                         IF X1Z1(BYTINDEX)=ON THEN                1225 04418000
@RC01222 DS    0H                                                  1225 04419000
@RF01221 LR    @01,CUBEPTR                                         1225 04420000
         ALR   @01,BYTINDEX                                        1225 04421000
         AL    @01,@CF01674                                        1225 04422000
         TM    X1Z1(@01),B'00010000'                               1225 04423000
         BNO   @RF01225                                            1225 04424000
*                           IF CURX1Z1(BYTINDEX)=OFF THEN          1226 04425000
         LR    @01,CURCBPTR                                        1226 04426000
         ALR   @01,BYTINDEX                                        1226 04427000
         AL    @01,@CF01674                                        1226 04428000
         TM    CURX1Z1(@01),B'00010000'                            1226 04429000
         BNZ   @RF01226                                            1226 04430000
*                             X1Z1(BYTINDEX)=OFF;/*          @Z40LB25*/ 04431000
         LR    @01,CUBEPTR                                         1227 04432000
         ALR   @01,BYTINDEX                                        1227 04433000
         AL    @01,@CF01674                                        1227 04434000
         NI    X1Z1(@01),B'11101111'                               1227 04435000
*                           ELSE                                   1228 04436000
*                             PRTXYZ2=ON;/*                  @Z40LB25*/ 04437000
         B     @RC01226                                            1228 04438000
@RF01226 OI    PRTXYZ2,B'00100000'                                 1228 04439000
*                       END;        /*                       @Z40LB25*/ 04440000
@RC01226 DS    0H                                                  1229 04441000
@RF01225 DS    0H                                                  1230 04442000
*                   END;            /*                       @Z40LB25*/ 04443000
@RC01209 DS    0H                                                  1231 04444000
*                 TEMPX=TEMPX+1;    /*                       @Z40LB25*/ 04445000
*                                                                  1231 04446000
@RF01207 LA    @15,1                                               1231 04447000
         ALR   TEMPX,@15                                           1231 04448000
*                 /***************************************************/ 04449000
*                 /*                                                 */ 04450000
*                 /* CHECK FOR THE LAST BLOCK                @Z40LB25*/ 04451000
*                 /*                                                 */ 04452000
*                 /***************************************************/ 04453000
*                                                                  1232 04454000
*                 IF BLKINDEX^=BLKNUM THEN                         1232 04455000
         C     BLKINDEX,@CF00047                                   1232 04456000
         BE    @RF01232                                            1232 04457000
*                   DO;             /*                       @Z40LB25*/ 04458000
*                                                                  1233 04459000
*                     /***********************************************/ 04460000
*                     /*                                             */ 04461000
*                     /* CHECK X+2                           @Z40LB25*/ 04462000
*                     /*                                             */ 04463000
*                     /***********************************************/ 04464000
*                                                                  1234 04465000
*                     IF X+TEMPX=>MSFLOWX THEN                     1234 04466000
         LR    @14,TEMPX                                           1234 04467000
         AH    @14,X                                               1234 04468000
         C     @14,MSFLOWX                                         1234 04469000
         BL    @RF01234                                            1234 04470000
*                       DO;         /*                       @Z40LB25*/ 04471000
*                         IF I=1 THEN                              1236 04472000
         CR    I,@15                                               1236 04473000
         BNE   @RF01236                                            1236 04474000
*                           DO;     /*                       @Z40LB25*/ 04475000
*                             IF X2Z0(BYTINDEX)=ON THEN            1238 04476000
         LR    @01,CUBEPTR                                         1238 04477000
         ALR   @01,BYTINDEX                                        1238 04478000
         AL    @01,@CF01674                                        1238 04479000
         TM    X2Z0(@01),B'00001000'                               1238 04480000
         BNO   @RF01238                                            1238 04481000
*                               IF CURX2Z0(BYTINDEX)=ON THEN       1239 04482000
         LR    @01,CURCBPTR                                        1239 04483000
         ALR   @01,BYTINDEX                                        1239 04484000
         AL    @01,@CF01674                                        1239 04485000
         TM    CURX2Z0(@01),B'00001000'                            1239 04486000
         BNO   @RF01239                                            1239 04487000
*                                 X2Z0(BYTINDEX)=OFF;/*      @Z40LB25*/ 04488000
         LR    @01,CUBEPTR                                         1240 04489000
         ALR   @01,BYTINDEX                                        1240 04490000
         AL    @01,@CF01674                                        1240 04491000
         NI    X2Z0(@01),B'11110111'                               1240 04492000
*                               ELSE                               1241 04493000
*                                 PRTXYZ1=ON;/*              @Z40LB25*/ 04494000
         B     @RC01239                                            1241 04495000
@RF01239 OI    PRTXYZ1,B'01000000'                                 1241 04496000
*                             IF X2Z1(BYTINDEX)=ON THEN            1242 04497000
@RC01239 DS    0H                                                  1242 04498000
@RF01238 LR    @01,CUBEPTR                                         1242 04499000
         ALR   @01,BYTINDEX                                        1242 04500000
         AL    @01,@CF01674                                        1242 04501000
         TM    X2Z1(@01),B'00000100'                               1242 04502000
         BNO   @RF01242                                            1242 04503000
*                               IF CURX2Z1(BYTINDEX)=ON THEN       1243 04504000
         LR    @01,CURCBPTR                                        1243 04505000
         ALR   @01,BYTINDEX                                        1243 04506000
         AL    @01,@CF01674                                        1243 04507000
         TM    CURX2Z1(@01),B'00000100'                            1243 04508000
         BNO   @RF01243                                            1243 04509000
*                                 X2Z1(BYTINDEX)=OFF;/*      @Z40LB25*/ 04510000
         LR    @01,CUBEPTR                                         1244 04511000
         ALR   @01,BYTINDEX                                        1244 04512000
         AL    @01,@CF01674                                        1244 04513000
         NI    X2Z1(@01),B'11111011'                               1244 04514000
*                               ELSE                               1245 04515000
*                                 PRTXYZ1=ON;/*              @Z40LB25*/ 04516000
         B     @RC01243                                            1245 04517000
@RF01243 OI    PRTXYZ1,B'01000000'                                 1245 04518000
*                           END;    /*                       @Z40LB25*/ 04519000
*                         ELSE                                     1247 04520000
*                           DO;     /*                       @Z40LB25*/ 04521000
         B     @RC01236                                            1247 04522000
@RF01236 DS    0H                                                  1248 04523000
*                             IF X2Z0(BYTINDEX)=ON THEN            1248 04524000
         LR    @01,CUBEPTR                                         1248 04525000
         ALR   @01,BYTINDEX                                        1248 04526000
         AL    @01,@CF01674                                        1248 04527000
         TM    X2Z0(@01),B'00001000'                               1248 04528000
         BNO   @RF01248                                            1248 04529000
*                               IF CURX2Z0(BYTINDEX)=OFF THEN      1249 04530000
         LR    @01,CURCBPTR                                        1249 04531000
         ALR   @01,BYTINDEX                                        1249 04532000
         AL    @01,@CF01674                                        1249 04533000
         TM    CURX2Z0(@01),B'00001000'                            1249 04534000
         BNZ   @RF01249                                            1249 04535000
*                                 X2Z0(BYTINDEX)=OFF;/*      @Z40LB25*/ 04536000
         LR    @01,CUBEPTR                                         1250 04537000
         ALR   @01,BYTINDEX                                        1250 04538000
         AL    @01,@CF01674                                        1250 04539000
         NI    X2Z0(@01),B'11110111'                               1250 04540000
*                               ELSE                               1251 04541000
*                                 PRTXYZ2=ON;/*              @Z40LB25*/ 04542000
         B     @RC01249                                            1251 04543000
@RF01249 OI    PRTXYZ2,B'00100000'                                 1251 04544000
*                             IF X2Z1(BYTINDEX)=ON THEN            1252 04545000
@RC01249 DS    0H                                                  1252 04546000
@RF01248 LR    @01,CUBEPTR                                         1252 04547000
         ALR   @01,BYTINDEX                                        1252 04548000
         AL    @01,@CF01674                                        1252 04549000
         TM    X2Z1(@01),B'00000100'                               1252 04550000
         BNO   @RF01252                                            1252 04551000
*                               IF CURX2Z1(BYTINDEX)=OFF THEN      1253 04552000
         LR    @01,CURCBPTR                                        1253 04553000
         ALR   @01,BYTINDEX                                        1253 04554000
         AL    @01,@CF01674                                        1253 04555000
         TM    CURX2Z1(@01),B'00000100'                            1253 04556000
         BNZ   @RF01253                                            1253 04557000
*                                 X2Z1(BYTINDEX)=OFF;/*      @Z40LB25*/ 04558000
         LR    @01,CUBEPTR                                         1254 04559000
         ALR   @01,BYTINDEX                                        1254 04560000
         AL    @01,@CF01674                                        1254 04561000
         NI    X2Z1(@01),B'11111011'                               1254 04562000
*                               ELSE                               1255 04563000
*                                 PRTXYZ2=ON;/*              @Z40LB25*/ 04564000
         B     @RC01253                                            1255 04565000
@RF01253 OI    PRTXYZ2,B'00100000'                                 1255 04566000
*                           END;    /*                       @Z40LB25*/ 04567000
@RC01253 DS    0H                                                  1256 04568000
@RF01252 DS    0H                                                  1257 04569000
*                       END;        /*                       @Z40LB25*/ 04570000
@RC01236 DS    0H                                                  1258 04571000
*                     TEMPX=TEMPX+1;/*                       @Z40LB25*/ 04572000
*                                                                  1258 04573000
@RF01234 LA    @15,1                                               1258 04574000
         ALR   TEMPX,@15                                           1258 04575000
*                     /***********************************************/ 04576000
*                     /*                                             */ 04577000
*                     /* CHECK X+3                           @Z40LB25*/ 04578000
*                     /*                                             */ 04579000
*                     /***********************************************/ 04580000
*                                                                  1259 04581000
*                     IF X+TEMPX=>MSFLOWX THEN                     1259 04582000
         LR    @14,TEMPX                                           1259 04583000
         AH    @14,X                                               1259 04584000
         C     @14,MSFLOWX                                         1259 04585000
         BL    @RF01259                                            1259 04586000
*                       DO;         /*                       @Z40LB25*/ 04587000
*                         IF I=1 THEN                              1261 04588000
         CR    I,@15                                               1261 04589000
         BNE   @RF01261                                            1261 04590000
*                           DO;     /*                       @Z40LB25*/ 04591000
*                             IF X3Z0(BYTINDEX)=ON THEN            1263 04592000
         LR    @05,CUBEPTR                                         1263 04593000
         ALR   @05,BYTINDEX                                        1263 04594000
         AL    @05,@CF01674                                        1263 04595000
         TM    X3Z0(@05),B'00000010'                               1263 04596000
         BNO   @RF01263                                            1263 04597000
*                               IF CURX3Z0(BYTINDEX)=ON THEN       1264 04598000
         LR    @05,CURCBPTR                                        1264 04599000
         ALR   @05,BYTINDEX                                        1264 04600000
         AL    @05,@CF01674                                        1264 04601000
         TM    CURX3Z0(@05),B'00000010'                            1264 04602000
         BNO   @RF01264                                            1264 04603000
*                                 X3Z0(BYTINDEX)=OFF;/*      @Z40LB25*/ 04604000
         LR    @05,CUBEPTR                                         1265 04605000
         ALR   @05,BYTINDEX                                        1265 04606000
         AL    @05,@CF01674                                        1265 04607000
         NI    X3Z0(@05),B'11111101'                               1265 04608000
*                               ELSE                               1266 04609000
*                                 PRTXYZ1=ON;/*              @Z40LB25*/ 04610000
         B     @RC01264                                            1266 04611000
@RF01264 OI    PRTXYZ1,B'01000000'                                 1266 04612000
*                             IF X3Z1(BYTINDEX)=ON THEN            1267 04613000
@RC01264 DS    0H                                                  1267 04614000
@RF01263 LR    @05,CUBEPTR                                         1267 04615000
         ALR   @05,BYTINDEX                                        1267 04616000
         AL    @05,@CF01674                                        1267 04617000
         TM    X3Z1(@05),B'00000001'                               1267 04618000
         BNO   @RF01267                                            1267 04619000
*                               IF CURX3Z1(BYTINDEX)=ON THEN       1268 04620000
         LR    @05,CURCBPTR                                        1268 04621000
         ALR   @05,BYTINDEX                                        1268 04622000
         AL    @05,@CF01674                                        1268 04623000
         TM    CURX3Z1(@05),B'00000001'                            1268 04624000
         BNO   @RF01268                                            1268 04625000
*                                 X3Z1(BYTINDEX)=OFF;/*      @Z40LB25*/ 04626000
         LR    @05,CUBEPTR                                         1269 04627000
         ALR   @05,BYTINDEX                                        1269 04628000
         AL    @05,@CF01674                                        1269 04629000
         NI    X3Z1(@05),B'11111110'                               1269 04630000
*                               ELSE                               1270 04631000
*                                 PRTXYZ1=ON;/*              @Z40LB25*/ 04632000
         B     @RC01268                                            1270 04633000
@RF01268 OI    PRTXYZ1,B'01000000'                                 1270 04634000
*                           END;    /*                       @Z40LB25*/ 04635000
*                         ELSE                                     1272 04636000
*                           DO;     /*                       @Z40LB25*/ 04637000
         B     @RC01261                                            1272 04638000
@RF01261 DS    0H                                                  1273 04639000
*                             IF X3Z0(BYTINDEX)=ON THEN            1273 04640000
         LR    @05,CUBEPTR                                         1273 04641000
         ALR   @05,BYTINDEX                                        1273 04642000
         AL    @05,@CF01674                                        1273 04643000
         TM    X3Z0(@05),B'00000010'                               1273 04644000
         BNO   @RF01273                                            1273 04645000
*                               IF CURX3Z0(BYTINDEX)=OFF THEN      1274 04646000
         LR    @05,CURCBPTR                                        1274 04647000
         ALR   @05,BYTINDEX                                        1274 04648000
         AL    @05,@CF01674                                        1274 04649000
         TM    CURX3Z0(@05),B'00000010'                            1274 04650000
         BNZ   @RF01274                                            1274 04651000
*                                 X3Z0(BYTINDEX)=OFF;/*      @Z40LB25*/ 04652000
         LR    @05,CUBEPTR                                         1275 04653000
         ALR   @05,BYTINDEX                                        1275 04654000
         AL    @05,@CF01674                                        1275 04655000
         NI    X3Z0(@05),B'11111101'                               1275 04656000
*                               ELSE                               1276 04657000
*                                 PRTXYZ2=ON;/*              @Z40LB25*/ 04658000
         B     @RC01274                                            1276 04659000
@RF01274 OI    PRTXYZ2,B'00100000'                                 1276 04660000
*                             IF X3Z1(BYTINDEX)=ON THEN            1277 04661000
@RC01274 DS    0H                                                  1277 04662000
@RF01273 LR    @05,CUBEPTR                                         1277 04663000
         ALR   @05,BYTINDEX                                        1277 04664000
         AL    @05,@CF01674                                        1277 04665000
         TM    X3Z1(@05),B'00000001'                               1277 04666000
         BNO   @RF01277                                            1277 04667000
*                               IF CURX3Z1(BYTINDEX)=OFF THEN      1278 04668000
         LR    @05,CURCBPTR                                        1278 04669000
         ALR   @05,BYTINDEX                                        1278 04670000
         AL    @05,@CF01674                                        1278 04671000
         TM    CURX3Z1(@05),B'00000001'                            1278 04672000
         BNZ   @RF01278                                            1278 04673000
*                                 X3Z1(BYTINDEX)=OFF;/*      @Z40LB25*/ 04674000
         LR    @05,CUBEPTR                                         1279 04675000
         ALR   @05,BYTINDEX                                        1279 04676000
         AL    @05,@CF01674                                        1279 04677000
         NI    X3Z1(@05),B'11111110'                               1279 04678000
*                               ELSE                               1280 04679000
*                                 PRTXYZ2=ON;/*              @Z40LB25*/ 04680000
         B     @RC01278                                            1280 04681000
@RF01278 OI    PRTXYZ2,B'00100000'                                 1280 04682000
*                           END;    /*                       @Z40LB25*/ 04683000
@RC01278 DS    0H                                                  1281 04684000
@RF01277 DS    0H                                                  1282 04685000
*                       END;        /*                       @Z40LB25*/ 04686000
@RC01261 DS    0H                                                  1283 04687000
*                   END;            /*                       @Z40LB25*/ 04688000
@RF01259 DS    0H                                                  1284 04689000
*               END;                /*                       @Z40LB25*/ 04690000
@RF01232 AL    BYTINDEX,@CF00224                                   1284 04691000
         C     BYTINDEX,@CF00047                                   1284 04692000
         BNH   @DL01180                                            1284 04693000
*               CUBEPTR=CUBEPTR+LENGTH(CUBE);/*              @Z40LB25*/ 04694000
         LA    @05,4                                               1285 04695000
         ALR   CUBEPTR,@05                                         1285 04696000
*               CURCBPTR=CURCBPTR+LENGTH(CURCUBE);/*         @Z40LB25*/ 04697000
         ALR   CURCBPTR,@05                                        1286 04698000
*             END;                  /*                       @Z40LB25*/ 04699000
*                                                                  1287 04700000
         LA    @05,1                                               1287 04701000
         AH    @05,CUBINDEX                                        1287 04702000
         STH   @05,CUBINDEX                                        1287 04703000
         C     @05,@CF00663                                        1287 04704000
         BNH   @DL01179                                            1287 04705000
*             /*******************************************************/ 04706000
*             /*                                                     */ 04707000
*             /* CHECK FOR THE LAST BLOCK                    @Z40LB25*/ 04708000
*             /*                                                     */ 04709000
*             /*******************************************************/ 04710000
*                                                                  1288 04711000
*             IF BLKINDEX=BLKNUM THEN                              1288 04712000
         C     BLKINDEX,@CF00047                                   1288 04713000
         BNE   @RF01288                                            1288 04714000
*               CHKINDEX=CHUNKNUM;  /*                       @Z40LB25*/ 04715000
         MVC   CHKINDEX(2),@CH00184                                1289 04716000
*             CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*             @Z40LB25*/ 04717000
@RF01288 LA    @06,32                                              1290 04718000
         L     @05,CHUNKPTR                                        1290 04719000
         ALR   @05,@06                                             1290 04720000
         ST    @05,CHUNKPTR                                        1290 04721000
*             CURCKPTR=CURCKPTR+LENGTH(CURCK);/*             @Z40LB25*/ 04722000
         AL    @06,CURCKPTR                                        1291 04723000
         ST    @06,CURCKPTR                                        1291 04724000
*             X=X+4;                /*                       @Z40LB25*/ 04725000
         LA    @06,4                                               1292 04726000
         AH    @06,X                                               1292 04727000
         STH   @06,X                                               1292 04728000
*           END;                    /*                       @Z40LB25*/ 04729000
         LA    @06,1                                               1293 04730000
         AH    @06,CHKINDEX                                        1293 04731000
         STH   @06,CHKINDEX                                        1293 04732000
         C     @06,@CF00184                                        1293 04733000
         BNH   @DL01176                                            1293 04734000
*           CELLPTR=CELLPTR+BLKSIZE;/*                       @Z40LB25*/ 04735000
         LA    @06,264                                             1294 04736000
         L     @05,CELLPTR                                         1294 04737000
         ALR   @05,@06                                             1294 04738000
         ST    @05,CELLPTR                                         1294 04739000
*           CURCLPTR=CURCLPTR+BLKSIZE;/*                     @Z40LB25*/ 04740000
         AL    @06,CURCLPTR                                        1295 04741000
         ST    @06,CURCLPTR                                        1295 04742000
*           CHUNKPTR=CHUNKPTR+8;    /*                       @Z40LB25*/ 04743000
         LA    @06,8                                               1296 04744000
         L     @05,CHUNKPTR                                        1296 04745000
         ALR   @05,@06                                             1296 04746000
         ST    @05,CHUNKPTR                                        1296 04747000
*           CURCKPTR=CURCKPTR+8;    /*                       @Z40LB25*/ 04748000
         AL    @06,CURCKPTR                                        1297 04749000
         ST    @06,CURCKPTR                                        1297 04750000
*         END;                      /*                       @Z40LB25*/ 04751000
         AL    BLKINDEX,@CF00224                                   1298 04752000
         C     BLKINDEX,@CF00047                                   1298 04753000
         BNH   @DL01175                                            1298 04754000
*       END;                        /*                       @Z40LB25*/ 04755000
         AL    I,@CF00224                                          1299 04756000
         C     I,@CF00158                                          1299 04757000
         BNH   @DL01162                                            1299 04758000
*     END;                          /*                       @Z40LB25*/ 04759000
*   RETURN;                         /*                       @Z40LB25*/ 04760000
@EL00010 DS    0H                                                  1301 04761000
@EF00010 DS    0H                                                  1301 04762000
@ER00010 L     @14,@SA00010                                        1301 04763000
         BR    @14                                                 1301 04764000
*   END CHKXYZ12;                   /*                       @Z40LB25*/ 04765000
         B     @EL00010                                            1302 04766000
*                                                                  1303 04767000
*   /*****************************************************************/ 04768000
*   /*                                                               */ 04769000
*   /* PROCEDURE NAME - BITTOLOC                             @Z40LB25*/ 04770000
*   /*                                                       @Z40LB25*/ 04771000
*   /* FUNCTION - SEARCH THE WORKMAP OR XYZ1 OR XYZ2         @Z40LB25*/ 04772000
*   /* WORKAREA FOR AN ON BIT. WHEN ONE IS FOUND             @Z40LB25*/ 04773000
*   /* TRANSLATE ITS POSITION TO AN X Y Z AND THEN SET       @Z40LB25*/ 04774000
*   /* THE BIT OFF. WHEN THE END OF THE TABLE IS REACHED     @Z40LB25*/ 04775000
*   /* SET A FLAG TO INFORM THE CALLER.                      @Z40LB25*/ 04776000
*   /* XS ARE RETURNED IN ASSENING ORDER. WITHIN             @Z40LB25*/ 04777000
*   /* EACH X, THEIR YS ARE ALSO RETURNED IN                 @Z40LB25*/ 04778000
*   /* ASSENDING ORDER. FOR EACH Y, Z0 IS RETURNED           @Z40LB25*/ 04779000
*   /* BEFORE Z1.                                            @Z40LB25*/ 04780000
*   /*                                                       @Z40LB25*/ 04781000
*   /* INPUT -                                               @Z40LB25*/ 04782000
*   /* CHUNKPTR - XYZ1, XYZ2, WORKMAP                        @Z40LB25*/ 04783000
*   /* CELLPTR - CELL BLOCK                                  @Z40LB25*/ 04784000
*   /*                                                       @Z40LB25*/ 04785000
*   /* OUTPUT -                                              @Z40LB25*/ 04786000
*   /* TABLEND                                               @Z40LB25*/ 04787000
*   /* X                                                     @Z40LB25*/ 04788000
*   /* Y                                                     @Z40LB25*/ 04789000
*   /* Z                                                     @Z40LB25*/ 04790000
*   /*                                                               */ 04791000
*   /*****************************************************************/ 04792000
*                                                                  1303 04793000
*BITTOLOC:                                                         1303 04794000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 04795000
*                                                                  1303 04796000
BITTOLOC ST    @14,12(,@13)                                        1303 04797000
*   /*****************************************************************/ 04798000
*   /*                                                               */ 04799000
*   /* HOUSEKEEP                                             @Z40LB25*/ 04800000
*   /*                                                               */ 04801000
*   /*****************************************************************/ 04802000
*                                                                  1304 04803000
*   X=XSTART;                       /* START X LOC 150       @Z40LB25*/ 04804000
         MVC   X(2),@CH01256                                       1304 04805000
*   Z=0;                            /* START Z LOC           @Z40LB25*/ 04806000
*                                                                  1305 04807000
         SLR   @05,@05                                             1305 04808000
         STH   @05,Z                                               1305 04809000
*   /*****************************************************************/ 04810000
*   /*                                                               */ 04811000
*   /* SEARCH FOR AN ON BIT                                  @Z40LB25*/ 04812000
*   /*                                                               */ 04813000
*   /*****************************************************************/ 04814000
*                                                                  1306 04815000
*   DO BLKINDEX=1 TO BLKNUM;        /*                       @Z40LB25*/ 04816000
*                                                                  1306 04817000
         LA    BLKINDEX,1                                          1306 04818000
@DL01306 DS    0H                                                  1307 04819000
*     /***************************************************************/ 04820000
*     /*                                                             */ 04821000
*     /* SCAN THE CHUNKS OF EACH OF THE BLOCKS               @Z40LB25*/ 04822000
*     /*                                                             */ 04823000
*     /***************************************************************/ 04824000
*                                                                  1307 04825000
*     DO CHKINDEX=1 TO CHUNKNUM;    /*                       @Z40LB25*/ 04826000
*                                                                  1307 04827000
         LA    @06,1                                               1307 04828000
         STH   @06,CHKINDEX                                        1307 04829000
@DL01307 DS    0H                                                  1308 04830000
*       /*************************************************************/ 04831000
*       /*                                                           */ 04832000
*       /* SCAN THE XS IN ASCENDING ORDER                    @VS41108*/ 04833000
*       /*                                                           */ 04834000
*       /*************************************************************/ 04835000
*                                                                  1308 04836000
*       DO XINDEX=1 TO 4;           /*                       @VS41108*/ 04837000
         LA    XINDEX,1                                            1308 04838000
@DL01308 DS    0H                                                  1309 04839000
*         CUBEPTR=CHUNKPTR;         /*                       @VS41108*/ 04840000
         L     CUBEPTR,CHUNKPTR                                    1309 04841000
*         Y=''B;                    /* START Y               @VS41108*/ 04842000
*                                                                  1310 04843000
         SLR   @05,@05                                             1310 04844000
         ST    @05,Y                                               1310 04845000
*         /***********************************************************/ 04846000
*         /*                                                         */ 04847000
*         /* SCAN THE CUBES PER CHUNK                        @VS41108*/ 04848000
*         /*                                                         */ 04849000
*         /***********************************************************/ 04850000
*                                                                  1311 04851000
*         DO CUBINDEX=1 TO CUBENUM; /*                       @VS41108*/ 04852000
         LA    @05,1                                               1311 04853000
         STH   @05,CUBINDEX                                        1311 04854000
@DL01311 DS    0H                                                  1312 04855000
*           TEMPX=''B;              /*                       @VS41108*/ 04856000
*                                                                  1312 04857000
         SLR   TEMPX,TEMPX                                         1312 04858000
*           /*********************************************************/ 04859000
*           /*                                                       */ 04860000
*           /* CHECK X                                       @VS41108*/ 04861000
*           /*                                                       */ 04862000
*           /*********************************************************/ 04863000
*                                                                  1313 04864000
*           IF XINDEX=1&X+TEMPX=>MSFLOWX THEN                      1313 04865000
         C     XINDEX,@CF00224                                     1313 04866000
         BNE   @RF01313                                            1313 04867000
         LR    @15,TEMPX                                           1313 04868000
         AH    @15,X                                               1313 04869000
         C     @15,MSFLOWX                                         1313 04870000
         BL    @RF01313                                            1313 04871000
*             DO;                   /*                       @VS41108*/ 04872000
*                                                                  1314 04873000
*               /*****************************************************/ 04874000
*               /*                                                   */ 04875000
*               /* X ALREADY SET BY X=XSTART OR X=X+4        @VS41108*/ 04876000
*               /*                                                   */ 04877000
*               /*****************************************************/ 04878000
*                                                                  1315 04879000
*               IF X0Z0(1)=ON THEN                                 1315 04880000
         TM    X0Z0(CUBEPTR),B'10000000'                           1315 04881000
         BNO   @RF01315                                            1315 04882000
*                 DO;               /*                       @VS41108*/ 04883000
*                   X0Z0(1)=OFF;    /*                       @VS41108*/ 04884000
         NI    X0Z0(CUBEPTR),B'01111111'                           1317 04885000
*                   RETURN;         /*                       @VS41108*/ 04886000
@EL00011 DS    0H                                                  1318 04887000
@EF00011 DS    0H                                                  1318 04888000
@ER00011 L     @14,12(,@13)                                        1318 04889000
         BR    @14                                                 1318 04890000
*                 END;              /*                       @VS41108*/ 04891000
*               IF X0Z1(1)=ON THEN                                 1320 04892000
@RF01315 TM    X0Z1(CUBEPTR),B'01000000'                           1320 04893000
         BNO   @RF01320                                            1320 04894000
*                 DO;               /*                       @VS41108*/ 04895000
*                   Z=1;            /*                       @VS41108*/ 04896000
         MVC   Z(2),@CH00224                                       1322 04897000
*                   X0Z1(1)=OFF;    /*                       @VS41108*/ 04898000
         NI    X0Z1(CUBEPTR),B'10111111'                           1323 04899000
*                   RETURN;         /*                       @VS41108*/ 04900000
         B     @EL00011                                            1324 04901000
*                 END;              /*                       @VS41108*/ 04902000
*               Y=Y+1;              /*                       @VS41108*/ 04903000
@RF01320 LA    @15,1                                               1326 04904000
         AL    @15,Y                                               1326 04905000
         ST    @15,Y                                               1326 04906000
*               IF X0Z0(2)=ON THEN                                 1327 04907000
         TM    X0Z0+1(CUBEPTR),B'10000000'                         1327 04908000
         BNO   @RF01327                                            1327 04909000
*                 DO;               /*                       @VS41108*/ 04910000
*                   X0Z0(2)=OFF;    /*                       @VS41108*/ 04911000
         NI    X0Z0+1(CUBEPTR),B'01111111'                         1329 04912000
*                   RETURN;         /*                       @VS41108*/ 04913000
         B     @EL00011                                            1330 04914000
*                 END;              /*                       @VS41108*/ 04915000
*               IF X0Z1(2)=ON THEN                                 1332 04916000
@RF01327 TM    X0Z1+1(CUBEPTR),B'01000000'                         1332 04917000
         BNO   @RF01332                                            1332 04918000
*                 DO;               /*                       @VS41108*/ 04919000
*                   Z=1;            /*                       @VS41108*/ 04920000
         MVC   Z(2),@CH00224                                       1334 04921000
*                   X0Z1(2)=OFF;    /*                       @VS41108*/ 04922000
         NI    X0Z1+1(CUBEPTR),B'10111111'                         1335 04923000
*                   RETURN;         /*                       @VS41108*/ 04924000
         B     @EL00011                                            1336 04925000
*                 END;              /*                       @VS41108*/ 04926000
*               Y=Y+1;              /*                       @VS41108*/ 04927000
@RF01332 LA    @15,1                                               1338 04928000
         AL    @15,Y                                               1338 04929000
         ST    @15,Y                                               1338 04930000
*               IF X0Z0(3)=ON THEN                                 1339 04931000
         TM    X0Z0+2(CUBEPTR),B'10000000'                         1339 04932000
         BNO   @RF01339                                            1339 04933000
*                 DO;               /*                       @VS41108*/ 04934000
*                   X0Z0(3)=OFF;    /*                       @VS41108*/ 04935000
         NI    X0Z0+2(CUBEPTR),B'01111111'                         1341 04936000
*                   RETURN;         /*                       @VS41108*/ 04937000
         B     @EL00011                                            1342 04938000
*                 END;              /*                       @VS41108*/ 04939000
*               IF X0Z1(3)=ON THEN                                 1344 04940000
@RF01339 TM    X0Z1+2(CUBEPTR),B'01000000'                         1344 04941000
         BNO   @RF01344                                            1344 04942000
*                 DO;               /*                       @VS41108*/ 04943000
*                   Z=1;            /*                       @VS41108*/ 04944000
         MVC   Z(2),@CH00224                                       1346 04945000
*                   X0Z1(3)=OFF;    /*                       @VS41108*/ 04946000
         NI    X0Z1+2(CUBEPTR),B'10111111'                         1347 04947000
*                   RETURN;         /*                       @VS41108*/ 04948000
         B     @EL00011                                            1348 04949000
*                 END;              /*                       @VS41108*/ 04950000
*               Y=Y+1;              /*                       @VS41108*/ 04951000
@RF01344 LA    @15,1                                               1350 04952000
         AL    @15,Y                                               1350 04953000
         ST    @15,Y                                               1350 04954000
*               IF X0Z0(4)=ON THEN                                 1351 04955000
         TM    X0Z0+3(CUBEPTR),B'10000000'                         1351 04956000
         BNO   @RF01351                                            1351 04957000
*                 DO;               /*                       @VS41108*/ 04958000
*                   X0Z0(4)=OFF;    /*                       @VS41108*/ 04959000
         NI    X0Z0+3(CUBEPTR),B'01111111'                         1353 04960000
*                   RETURN;         /*                       @VS41108*/ 04961000
         B     @EL00011                                            1354 04962000
*                 END;              /*                       @VS41108*/ 04963000
*               IF X0Z1(4)=ON THEN                                 1356 04964000
@RF01351 TM    X0Z1+3(CUBEPTR),B'01000000'                         1356 04965000
         BNO   @RF01356                                            1356 04966000
*                 DO;               /*                       @VS41108*/ 04967000
*                   Z=1;            /*                       @VS41108*/ 04968000
         MVC   Z(2),@CH00224                                       1358 04969000
*                   X0Z1(4)=OFF;    /*                       @VS41108*/ 04970000
         NI    X0Z1+3(CUBEPTR),B'10111111'                         1359 04971000
*                   RETURN;         /*                       @VS41108*/ 04972000
         B     @EL00011                                            1360 04973000
*                 END;              /*                       @VS41108*/ 04974000
*               Y=Y+1;              /*                       @VS41108*/ 04975000
@RF01356 LA    @15,1                                               1362 04976000
         AL    @15,Y                                               1362 04977000
         ST    @15,Y                                               1362 04978000
*             END;                  /*                       @VS41108*/ 04979000
*                                                                  1363 04980000
*           /*********************************************************/ 04981000
*           /*                                                       */ 04982000
*           /* CHECK X+1                                     @VS41108*/ 04983000
*           /*                                                       */ 04984000
*           /*********************************************************/ 04985000
*                                                                  1364 04986000
*           TEMPX=TEMPX+1;          /*                       @VS41108*/ 04987000
@RF01313 LA    @15,1                                               1364 04988000
         ALR   TEMPX,@15                                           1364 04989000
*           IF XINDEX=2&X+TEMPX=>MSFLOWX THEN                      1365 04990000
         C     XINDEX,@CF00158                                     1365 04991000
         BNE   @RF01365                                            1365 04992000
         LH    @14,X                                               1365 04993000
         LR    @01,TEMPX                                           1365 04994000
         ALR   @01,@14                                             1365 04995000
         C     @01,MSFLOWX                                         1365 04996000
         BL    @RF01365                                            1365 04997000
*             DO;                   /*                       @VS41108*/ 04998000
*               IF X1Z0(1)=ON THEN                                 1367 04999000
         TM    X1Z0(CUBEPTR),B'00100000'                           1367 05000000
         BNO   @RF01367                                            1367 05001000
*                 DO;               /*                       @VS41108*/ 05002000
*                   X1Z0(1)=OFF;    /*                       @VS41108*/ 05003000
         NI    X1Z0(CUBEPTR),B'11011111'                           1369 05004000
*                   X=X+1;          /*                       @VS41108*/ 05005000
         ALR   @14,@15                                             1370 05006000
         STH   @14,X                                               1370 05007000
*                   RETURN;         /*                       @VS41108*/ 05008000
         B     @EL00011                                            1371 05009000
*                 END;              /*                       @VS41108*/ 05010000
*               IF X1Z1(1)=ON THEN                                 1373 05011000
@RF01367 TM    X1Z1(CUBEPTR),B'00010000'                           1373 05012000
         BNO   @RF01373                                            1373 05013000
*                 DO;               /*                       @VS41108*/ 05014000
*                   Z=1;            /*                       @VS41108*/ 05015000
         LA    @05,1                                               1375 05016000
         STH   @05,Z                                               1375 05017000
*                   X1Z1(1)=OFF;    /*                       @VS41108*/ 05018000
         NI    X1Z1(CUBEPTR),B'11101111'                           1376 05019000
*                   X=X+1;          /*                       @VS41108*/ 05020000
         AH    @05,X                                               1377 05021000
         STH   @05,X                                               1377 05022000
*                   RETURN;         /*                       @VS41108*/ 05023000
         B     @EL00011                                            1378 05024000
*                 END;              /*                       @VS41108*/ 05025000
*               Y=Y+1;              /*                       @VS41108*/ 05026000
@RF01373 LA    @15,1                                               1380 05027000
         L     @14,Y                                               1380 05028000
         ALR   @14,@15                                             1380 05029000
         ST    @14,Y                                               1380 05030000
*               IF X1Z0(2)=ON THEN                                 1381 05031000
         TM    X1Z0+1(CUBEPTR),B'00100000'                         1381 05032000
         BNO   @RF01381                                            1381 05033000
*                 DO;               /*                       @VS41108*/ 05034000
*                   X1Z0(2)=OFF;    /*                       @VS41108*/ 05035000
         NI    X1Z0+1(CUBEPTR),B'11011111'                         1383 05036000
*                   X=X+1;          /*                       @VS41108*/ 05037000
         AH    @15,X                                               1384 05038000
         STH   @15,X                                               1384 05039000
*                   RETURN;         /*                       @VS41108*/ 05040000
         B     @EL00011                                            1385 05041000
*                 END;              /*                       @VS41108*/ 05042000
*               IF X1Z1(2)=ON THEN                                 1387 05043000
@RF01381 TM    X1Z1+1(CUBEPTR),B'00010000'                         1387 05044000
         BNO   @RF01387                                            1387 05045000
*                 DO;               /*                       @VS41108*/ 05046000
*                   Z=1;            /*                       @VS41108*/ 05047000
         LA    @05,1                                               1389 05048000
         STH   @05,Z                                               1389 05049000
*                   X1Z1(2)=OFF;    /*                       @VS41108*/ 05050000
         NI    X1Z1+1(CUBEPTR),B'11101111'                         1390 05051000
*                   X=X+1;          /*                       @VS41108*/ 05052000
         AH    @05,X                                               1391 05053000
         STH   @05,X                                               1391 05054000
*                   RETURN;         /*                       @VS41108*/ 05055000
         B     @EL00011                                            1392 05056000
*                 END;              /*                       @VS41108*/ 05057000
*               Y=Y+1;              /*                       @VS41108*/ 05058000
@RF01387 LA    @15,1                                               1394 05059000
         L     @14,Y                                               1394 05060000
         ALR   @14,@15                                             1394 05061000
         ST    @14,Y                                               1394 05062000
*               IF X1Z0(3)=ON THEN                                 1395 05063000
         TM    X1Z0+2(CUBEPTR),B'00100000'                         1395 05064000
         BNO   @RF01395                                            1395 05065000
*                 DO;               /*                       @VS41108*/ 05066000
*                   X1Z0(3)=OFF;    /*                       @VS41108*/ 05067000
         NI    X1Z0+2(CUBEPTR),B'11011111'                         1397 05068000
*                   X=X+1;          /*                       @VS41108*/ 05069000
         AH    @15,X                                               1398 05070000
         STH   @15,X                                               1398 05071000
*                   RETURN;         /*                       @VS41108*/ 05072000
         B     @EL00011                                            1399 05073000
*                 END;              /*                       @VS41108*/ 05074000
*               IF X1Z1(3)=ON THEN                                 1401 05075000
@RF01395 TM    X1Z1+2(CUBEPTR),B'00010000'                         1401 05076000
         BNO   @RF01401                                            1401 05077000
*                 DO;               /*                       @VS41108*/ 05078000
*                   Z=1;            /*                       @VS41108*/ 05079000
         LA    @05,1                                               1403 05080000
         STH   @05,Z                                               1403 05081000
*                   X1Z1(3)=OFF;    /*                       @VS41108*/ 05082000
         NI    X1Z1+2(CUBEPTR),B'11101111'                         1404 05083000
*                   X=X+1;          /*                       @VS41108*/ 05084000
         AH    @05,X                                               1405 05085000
         STH   @05,X                                               1405 05086000
*                   RETURN;         /*                       @VS41108*/ 05087000
         B     @EL00011                                            1406 05088000
*                 END;              /*                       @VS41108*/ 05089000
*               Y=Y+1;              /*                       @VS41108*/ 05090000
@RF01401 LA    @15,1                                               1408 05091000
         L     @14,Y                                               1408 05092000
         ALR   @14,@15                                             1408 05093000
         ST    @14,Y                                               1408 05094000
*               IF X1Z0(4)=ON THEN                                 1409 05095000
         TM    X1Z0+3(CUBEPTR),B'00100000'                         1409 05096000
         BNO   @RF01409                                            1409 05097000
*                 DO;               /*                       @VS41108*/ 05098000
*                   X1Z0(4)=OFF;    /*                       @VS41108*/ 05099000
         NI    X1Z0+3(CUBEPTR),B'11011111'                         1411 05100000
*                   X=X+1;          /*                       @VS41108*/ 05101000
         AH    @15,X                                               1412 05102000
         STH   @15,X                                               1412 05103000
*                   RETURN;         /*                       @VS41108*/ 05104000
         B     @EL00011                                            1413 05105000
*                 END;              /*                       @VS41108*/ 05106000
*               IF X1Z1(4)=ON THEN                                 1415 05107000
@RF01409 TM    X1Z1+3(CUBEPTR),B'00010000'                         1415 05108000
         BNO   @RF01415                                            1415 05109000
*                 DO;               /*                       @VS41108*/ 05110000
*                   Z=1;            /*                       @VS41108*/ 05111000
         LA    @05,1                                               1417 05112000
         STH   @05,Z                                               1417 05113000
*                   X1Z1(4)=OFF;    /*                       @VS41108*/ 05114000
         NI    X1Z1+3(CUBEPTR),B'11101111'                         1418 05115000
*                   X=X+1;          /*                       @VS41108*/ 05116000
         AH    @05,X                                               1419 05117000
         STH   @05,X                                               1419 05118000
*                   RETURN;         /*                       @VS41108*/ 05119000
         B     @EL00011                                            1420 05120000
*                 END;              /*                       @VS41108*/ 05121000
*               Y=Y+1;              /*                       @VS41108*/ 05122000
@RF01415 LA    @15,1                                               1422 05123000
         AL    @15,Y                                               1422 05124000
         ST    @15,Y                                               1422 05125000
*             END;                  /*                       @VS41108*/ 05126000
*                                                                  1423 05127000
*           /*********************************************************/ 05128000
*           /*                                                       */ 05129000
*           /* CHECK FOR THE LAST BLOCK                      @VS41108*/ 05130000
*           /*                                                       */ 05131000
*           /*********************************************************/ 05132000
*                                                                  1424 05133000
*           IF BLKINDEX^=BLKNUM THEN                               1424 05134000
@RF01365 C     BLKINDEX,@CF00047                                   1424 05135000
         BE    @RF01424                                            1424 05136000
*             DO;                   /*                       @VS41108*/ 05137000
*                                                                  1425 05138000
*               /*****************************************************/ 05139000
*               /*                                                   */ 05140000
*               /* CHECK X+2                                 @VS41108*/ 05141000
*               /*                                                   */ 05142000
*               /*****************************************************/ 05143000
*                                                                  1426 05144000
*               TEMPX=TEMPX+1;      /*                       @VS41108*/ 05145000
         AL    TEMPX,@CF00224                                      1426 05146000
*               IF XINDEX=3&X+TEMPX=>MSFLOWX THEN                  1427 05147000
         C     XINDEX,@CF00167                                     1427 05148000
         BNE   @RF01427                                            1427 05149000
         LH    @15,X                                               1427 05150000
         LR    @14,TEMPX                                           1427 05151000
         ALR   @14,@15                                             1427 05152000
         C     @14,MSFLOWX                                         1427 05153000
         BL    @RF01427                                            1427 05154000
*                 DO;               /*                       @VS41108*/ 05155000
*                   IF X2Z0(1)=ON THEN                             1429 05156000
         TM    X2Z0(CUBEPTR),B'00001000'                           1429 05157000
         BNO   @RF01429                                            1429 05158000
*                     DO;           /*                       @VS41108*/ 05159000
*                       X2Z0(1)=OFF;/*                       @VS41108*/ 05160000
         NI    X2Z0(CUBEPTR),B'11110111'                           1431 05161000
*                       X=X+2;      /*                       @VS41108*/ 05162000
         AL    @15,@CF00158                                        1432 05163000
         STH   @15,X                                               1432 05164000
*                       RETURN;     /*                       @VS41108*/ 05165000
         B     @EL00011                                            1433 05166000
*                     END;          /*                       @VS41108*/ 05167000
*                   IF X2Z1(1)=ON THEN                             1435 05168000
@RF01429 TM    X2Z1(CUBEPTR),B'00000100'                           1435 05169000
         BNO   @RF01435                                            1435 05170000
*                     DO;           /*                       @VS41108*/ 05171000
*                       Z=1;        /*                       @VS41108*/ 05172000
         MVC   Z(2),@CH00224                                       1437 05173000
*                       X2Z1(1)=OFF;/*                       @VS41108*/ 05174000
         NI    X2Z1(CUBEPTR),B'11111011'                           1438 05175000
*                       X=X+2;      /*                       @VS41108*/ 05176000
         LA    @05,2                                               1439 05177000
         AH    @05,X                                               1439 05178000
         STH   @05,X                                               1439 05179000
*                       RETURN;     /*                       @VS41108*/ 05180000
         B     @EL00011                                            1440 05181000
*                     END;          /*                       @VS41108*/ 05182000
*                   Y=Y+1;          /*                       @VS41108*/ 05183000
@RF01435 LA    @15,1                                               1442 05184000
         AL    @15,Y                                               1442 05185000
         ST    @15,Y                                               1442 05186000
*                   IF X2Z0(2)=ON THEN                             1443 05187000
         TM    X2Z0+1(CUBEPTR),B'00001000'                         1443 05188000
         BNO   @RF01443                                            1443 05189000
*                     DO;           /*                       @VS41108*/ 05190000
*                       X2Z0(2)=OFF;/*                       @VS41108*/ 05191000
         NI    X2Z0+1(CUBEPTR),B'11110111'                         1445 05192000
*                       X=X+2;      /*                       @VS41108*/ 05193000
         LA    @05,2                                               1446 05194000
         AH    @05,X                                               1446 05195000
         STH   @05,X                                               1446 05196000
*                       RETURN;     /*                       @VS41108*/ 05197000
         B     @EL00011                                            1447 05198000
*                     END;          /*                       @VS41108*/ 05199000
*                   IF X2Z1(2)=ON THEN                             1449 05200000
@RF01443 TM    X2Z1+1(CUBEPTR),B'00000100'                         1449 05201000
         BNO   @RF01449                                            1449 05202000
*                     DO;           /*                       @VS41108*/ 05203000
*                       Z=1;        /*                       @VS41108*/ 05204000
         MVC   Z(2),@CH00224                                       1451 05205000
*                       X2Z1(2)=OFF;/*                       @VS41108*/ 05206000
         NI    X2Z1+1(CUBEPTR),B'11111011'                         1452 05207000
*                       X=X+2;      /*                       @VS41108*/ 05208000
         LA    @05,2                                               1453 05209000
         AH    @05,X                                               1453 05210000
         STH   @05,X                                               1453 05211000
*                       RETURN;     /*                       @VS41108*/ 05212000
         B     @EL00011                                            1454 05213000
*                     END;          /*                       @VS41108*/ 05214000
*                   Y=Y+1;          /*                       @VS41108*/ 05215000
@RF01449 LA    @15,1                                               1456 05216000
         AL    @15,Y                                               1456 05217000
         ST    @15,Y                                               1456 05218000
*                   IF X2Z0(3)=ON THEN                             1457 05219000
         TM    X2Z0+2(CUBEPTR),B'00001000'                         1457 05220000
         BNO   @RF01457                                            1457 05221000
*                     DO;           /*                       @VS41108*/ 05222000
*                       X2Z0(3)=OFF;/*                       @VS41108*/ 05223000
         NI    X2Z0+2(CUBEPTR),B'11110111'                         1459 05224000
*                       X=X+2;      /*                       @VS41108*/ 05225000
         LA    @05,2                                               1460 05226000
         AH    @05,X                                               1460 05227000
         STH   @05,X                                               1460 05228000
*                       RETURN;     /*                       @VS41108*/ 05229000
         B     @EL00011                                            1461 05230000
*                     END;          /*                       @VS41108*/ 05231000
*                   IF X2Z1(3)=ON THEN                             1463 05232000
@RF01457 TM    X2Z1+2(CUBEPTR),B'00000100'                         1463 05233000
         BNO   @RF01463                                            1463 05234000
*                     DO;           /*                       @VS41108*/ 05235000
*                       Z=1;        /*                       @VS41108*/ 05236000
         MVC   Z(2),@CH00224                                       1465 05237000
*                       X2Z1(3)=OFF;/*                       @VS41108*/ 05238000
         NI    X2Z1+2(CUBEPTR),B'11111011'                         1466 05239000
*                       X=X+2;      /*                       @VS41108*/ 05240000
         LA    @05,2                                               1467 05241000
         AH    @05,X                                               1467 05242000
         STH   @05,X                                               1467 05243000
*                       RETURN;     /*                       @VS41108*/ 05244000
         B     @EL00011                                            1468 05245000
*                     END;          /*                       @VS41108*/ 05246000
*                   Y=Y+1;          /*                       @VS41108*/ 05247000
@RF01463 LA    @15,1                                               1470 05248000
         AL    @15,Y                                               1470 05249000
         ST    @15,Y                                               1470 05250000
*                   IF X2Z0(4)=ON THEN                             1471 05251000
         TM    X2Z0+3(CUBEPTR),B'00001000'                         1471 05252000
         BNO   @RF01471                                            1471 05253000
*                     DO;           /*                       @VS41108*/ 05254000
*                       X2Z0(4)=OFF;/*                       @VS41108*/ 05255000
         NI    X2Z0+3(CUBEPTR),B'11110111'                         1473 05256000
*                       X=X+2;      /*                       @VS41108*/ 05257000
         LA    @05,2                                               1474 05258000
         AH    @05,X                                               1474 05259000
         STH   @05,X                                               1474 05260000
*                       RETURN;     /*                       @VS41108*/ 05261000
         B     @EL00011                                            1475 05262000
*                     END;          /*                       @VS41108*/ 05263000
*                   IF X2Z1(4)=ON THEN                             1477 05264000
@RF01471 TM    X2Z1+3(CUBEPTR),B'00000100'                         1477 05265000
         BNO   @RF01477                                            1477 05266000
*                     DO;           /*                       @VS41108*/ 05267000
*                       Z=1;        /*                       @VS41108*/ 05268000
         MVC   Z(2),@CH00224                                       1479 05269000
*                       X2Z1(4)=OFF;/*                       @VS41108*/ 05270000
         NI    X2Z1+3(CUBEPTR),B'11111011'                         1480 05271000
*                       X=X+2;      /*                       @VS41108*/ 05272000
         LA    @05,2                                               1481 05273000
         AH    @05,X                                               1481 05274000
         STH   @05,X                                               1481 05275000
*                       RETURN;     /*                       @VS41108*/ 05276000
         B     @EL00011                                            1482 05277000
*                     END;          /*                       @VS41108*/ 05278000
*                   Y=Y+1;          /*                       @VS41108*/ 05279000
@RF01477 LA    @15,1                                               1484 05280000
         AL    @15,Y                                               1484 05281000
         ST    @15,Y                                               1484 05282000
*                 END;              /*                       @VS41108*/ 05283000
*                                                                  1485 05284000
*               /*****************************************************/ 05285000
*               /*                                                   */ 05286000
*               /* CHECK X+3                                 @VS41108*/ 05287000
*               /*                                                   */ 05288000
*               /*****************************************************/ 05289000
*                                                                  1486 05290000
*               TEMPX=TEMPX+1;      /*                       @VS41108*/ 05291000
@RF01427 AL    TEMPX,@CF00224                                      1486 05292000
*               IF XINDEX=4&X+TEMPX=>MSFLOWX THEN                  1487 05293000
         C     XINDEX,@CF00047                                     1487 05294000
         BNE   @RF01487                                            1487 05295000
         LH    @15,X                                               1487 05296000
         LR    @14,TEMPX                                           1487 05297000
         ALR   @14,@15                                             1487 05298000
         C     @14,MSFLOWX                                         1487 05299000
         BL    @RF01487                                            1487 05300000
*                 DO;               /*                       @VS41108*/ 05301000
*                   IF X3Z0(1)=ON THEN                             1489 05302000
         TM    X3Z0(CUBEPTR),B'00000010'                           1489 05303000
         BNO   @RF01489                                            1489 05304000
*                     DO;           /*                       @VS41108*/ 05305000
*                       X3Z0(1)=OFF;/*                       @VS41108*/ 05306000
         NI    X3Z0(CUBEPTR),B'11111101'                           1491 05307000
*                       X=X+3;      /*                       @VS41108*/ 05308000
         AL    @15,@CF00167                                        1492 05309000
         STH   @15,X                                               1492 05310000
*                       RETURN;     /*                       @VS41108*/ 05311000
         B     @EL00011                                            1493 05312000
*                     END;          /*                       @VS41108*/ 05313000
*                   IF X3Z1(1)=ON THEN                             1495 05314000
@RF01489 TM    X3Z1(CUBEPTR),B'00000001'                           1495 05315000
         BNO   @RF01495                                            1495 05316000
*                     DO;           /*                       @VS41108*/ 05317000
*                       Z=1;        /*                       @VS41108*/ 05318000
         MVC   Z(2),@CH00224                                       1497 05319000
*                       X3Z1(1)=OFF;/*                       @VS41108*/ 05320000
         NI    X3Z1(CUBEPTR),B'11111110'                           1498 05321000
*                       X=X+3;      /*                       @VS41108*/ 05322000
         LA    @05,3                                               1499 05323000
         AH    @05,X                                               1499 05324000
         STH   @05,X                                               1499 05325000
*                       RETURN;     /*                       @VS41108*/ 05326000
         B     @EL00011                                            1500 05327000
*                     END;          /*                       @VS41108*/ 05328000
*                   Y=Y+1;          /*                       @VS41108*/ 05329000
@RF01495 LA    @05,1                                               1502 05330000
         AL    @05,Y                                               1502 05331000
         ST    @05,Y                                               1502 05332000
*                   IF X3Z0(2)=ON THEN                             1503 05333000
         TM    X3Z0+1(CUBEPTR),B'00000010'                         1503 05334000
         BNO   @RF01503                                            1503 05335000
*                     DO;           /*                       @VS41108*/ 05336000
*                       X3Z0(2)=OFF;/*                       @VS41108*/ 05337000
         NI    X3Z0+1(CUBEPTR),B'11111101'                         1505 05338000
*                       X=X+3;      /*                       @VS41108*/ 05339000
         LA    @05,3                                               1506 05340000
         AH    @05,X                                               1506 05341000
         STH   @05,X                                               1506 05342000
*                       RETURN;     /*                       @VS41108*/ 05343000
         B     @EL00011                                            1507 05344000
*                     END;          /*                       @VS41108*/ 05345000
*                   IF X3Z1(2)=ON THEN                             1509 05346000
@RF01503 TM    X3Z1+1(CUBEPTR),B'00000001'                         1509 05347000
         BNO   @RF01509                                            1509 05348000
*                     DO;           /*                       @VS41108*/ 05349000
*                       Z=1;        /*                       @VS41108*/ 05350000
         MVC   Z(2),@CH00224                                       1511 05351000
*                       X3Z1(2)=OFF;/*                       @VS41108*/ 05352000
         NI    X3Z1+1(CUBEPTR),B'11111110'                         1512 05353000
*                       X=X+3;      /*                       @VS41108*/ 05354000
         LA    @05,3                                               1513 05355000
         AH    @05,X                                               1513 05356000
         STH   @05,X                                               1513 05357000
*                       RETURN;     /*                       @VS41108*/ 05358000
         B     @EL00011                                            1514 05359000
*                     END;          /*                       @VS41108*/ 05360000
*                   Y=Y+1;          /*                       @VS41108*/ 05361000
@RF01509 LA    @05,1                                               1516 05362000
         AL    @05,Y                                               1516 05363000
         ST    @05,Y                                               1516 05364000
*                   IF X3Z0(3)=ON THEN                             1517 05365000
         TM    X3Z0+2(CUBEPTR),B'00000010'                         1517 05366000
         BNO   @RF01517                                            1517 05367000
*                     DO;           /*                       @VS41108*/ 05368000
*                       X3Z0(3)=OFF;/*                       @VS41108*/ 05369000
         NI    X3Z0+2(CUBEPTR),B'11111101'                         1519 05370000
*                       X=X+3;      /*                       @VS41108*/ 05371000
         LA    @05,3                                               1520 05372000
         AH    @05,X                                               1520 05373000
         STH   @05,X                                               1520 05374000
*                       RETURN;     /*                       @VS41108*/ 05375000
         B     @EL00011                                            1521 05376000
*                     END;          /*                       @VS41108*/ 05377000
*                   IF X3Z1(3)=ON THEN                             1523 05378000
@RF01517 TM    X3Z1+2(CUBEPTR),B'00000001'                         1523 05379000
         BNO   @RF01523                                            1523 05380000
*                     DO;           /*                       @VS41108*/ 05381000
*                       Z=1;        /*                       @VS41108*/ 05382000
         MVC   Z(2),@CH00224                                       1525 05383000
*                       X3Z1(3)=OFF;/*                       @VS41108*/ 05384000
         NI    X3Z1+2(CUBEPTR),B'11111110'                         1526 05385000
*                       X=X+3;      /*                       @VS41108*/ 05386000
         LA    @05,3                                               1527 05387000
         AH    @05,X                                               1527 05388000
         STH   @05,X                                               1527 05389000
*                       RETURN;     /*                       @VS41108*/ 05390000
         B     @EL00011                                            1528 05391000
*                     END;          /*                       @VS41108*/ 05392000
*                   Y=Y+1;          /*                       @VS41108*/ 05393000
@RF01523 LA    @05,1                                               1530 05394000
         AL    @05,Y                                               1530 05395000
         ST    @05,Y                                               1530 05396000
*                   IF X3Z0(4)=ON THEN                             1531 05397000
         TM    X3Z0+3(CUBEPTR),B'00000010'                         1531 05398000
         BNO   @RF01531                                            1531 05399000
*                     DO;           /*                       @VS41108*/ 05400000
*                       X3Z0(4)=OFF;/*                       @VS41108*/ 05401000
         NI    X3Z0+3(CUBEPTR),B'11111101'                         1533 05402000
*                       X=X+3;      /*                       @VS41108*/ 05403000
         LA    @05,3                                               1534 05404000
         AH    @05,X                                               1534 05405000
         STH   @05,X                                               1534 05406000
*                       RETURN;     /*                       @VS41108*/ 05407000
         B     @EL00011                                            1535 05408000
*                     END;          /*                       @VS41108*/ 05409000
*                   IF X3Z1(4)=ON THEN                             1537 05410000
@RF01531 TM    X3Z1+3(CUBEPTR),B'00000001'                         1537 05411000
         BNO   @RF01537                                            1537 05412000
*                     DO;           /*                       @VS41108*/ 05413000
*                       Z=1;        /*                       @VS41108*/ 05414000
         MVC   Z(2),@CH00224                                       1539 05415000
*                       X3Z1(4)=OFF;/*                       @VS41108*/ 05416000
         NI    X3Z1+3(CUBEPTR),B'11111110'                         1540 05417000
*                       X=X+3;      /*                       @VS41108*/ 05418000
         LA    @05,3                                               1541 05419000
         AH    @05,X                                               1541 05420000
         STH   @05,X                                               1541 05421000
*                       RETURN;     /*                       @VS41108*/ 05422000
         B     @EL00011                                            1542 05423000
*                     END;          /*                       @VS41108*/ 05424000
*                   Y=Y+1;          /*                       @VS41108*/ 05425000
@RF01537 LA    @05,1                                               1544 05426000
         AL    @05,Y                                               1544 05427000
         ST    @05,Y                                               1544 05428000
*                 END;              /*                       @VS41108*/ 05429000
*             END;                  /*                       @VS41108*/ 05430000
@RF01487 DS    0H                                                  1547 05431000
*           CUBEPTR=CUBEPTR+LENGTH(CUBE);/*                  @Z40LB25*/ 05432000
@RF01424 AL    CUBEPTR,@CF00047                                    1547 05433000
*         END;                      /*                       @Z40LB25*/ 05434000
         LA    @05,1                                               1548 05435000
         AH    @05,CUBINDEX                                        1548 05436000
         STH   @05,CUBINDEX                                        1548 05437000
         C     @05,@CF00663                                        1548 05438000
         BNH   @DL01311                                            1548 05439000
*       END;                        /*                       @Z40LB25*/ 05440000
*                                                                  1549 05441000
         AL    XINDEX,@CF00224                                     1549 05442000
         C     XINDEX,@CF00047                                     1549 05443000
         BNH   @DL01308                                            1549 05444000
*       /*************************************************************/ 05445000
*       /*                                                           */ 05446000
*       /* CHECK FOR LAST BLOCK                              @Z40LB25*/ 05447000
*       /*                                                           */ 05448000
*       /*************************************************************/ 05449000
*                                                                  1550 05450000
*       IF BLKINDEX=BLKNUM THEN                                    1550 05451000
         C     BLKINDEX,@CF00047                                   1550 05452000
         BNE   @RF01550                                            1550 05453000
*         CHKINDEX=CHUNKNUM;        /*                       @Z40LB25*/ 05454000
         MVC   CHKINDEX(2),@CH00184                                1551 05455000
*       CHUNKPTR=CHUNKPTR+LENGTH(CHUNK);/*                   @Z40LB25*/ 05456000
@RF01550 LA    @06,32                                              1552 05457000
         AL    @06,CHUNKPTR                                        1552 05458000
         ST    @06,CHUNKPTR                                        1552 05459000
*       X=X+4;                      /*                       @Z40LB25*/ 05460000
         LA    @06,4                                               1553 05461000
         AH    @06,X                                               1553 05462000
         STH   @06,X                                               1553 05463000
*     END;                          /*                       @Z40LB25*/ 05464000
         LA    @06,1                                               1554 05465000
         AH    @06,CHKINDEX                                        1554 05466000
         STH   @06,CHKINDEX                                        1554 05467000
         C     @06,@CF00184                                        1554 05468000
         BNH   @DL01307                                            1554 05469000
*     CELLPTR=CELLPTR+BLKSIZE;      /*                       @Z40LB25*/ 05470000
         LA    @06,264                                             1555 05471000
         AL    @06,CELLPTR                                         1555 05472000
         ST    @06,CELLPTR                                         1555 05473000
*     CHUNKPTR=CHUNKPTR+8;          /* SKIP CONTROL INFO     @Z40LB25   05474000
*                                      OF NEXT BLOCK         @Z40LB25*/ 05475000
         LA    @06,8                                               1556 05476000
         AL    @06,CHUNKPTR                                        1556 05477000
         ST    @06,CHUNKPTR                                        1556 05478000
*   END;                            /*                       @Z40LB25*/ 05479000
*                                                                  1557 05480000
         AL    BLKINDEX,@CF00224                                   1557 05481000
         C     BLKINDEX,@CF00047                                   1557 05482000
         BNH   @DL01306                                            1557 05483000
*   /*****************************************************************/ 05484000
*   /*                                                               */ 05485000
*   /* CHECK FOR END OF XYZ1, XYZ2, OR WORKMAP               @Z40LB25*/ 05486000
*   /*                                                               */ 05487000
*   /*****************************************************************/ 05488000
*                                                                  1558 05489000
*   TABLEND=ON;                     /*                       @Z40LB25*/ 05490000
         OI    TABLEND,B'00010000'                                 1558 05491000
*   RETURN;                         /*                       @Z40LB25*/ 05492000
         B     @EL00011                                            1559 05493000
*   END BITTOLOC;                   /*                       @Z40LB25*/ 05494000
*                                                                  1561 05495000
*   /*****************************************************************/ 05496000
*   /*                                                               */ 05497000
*   /* PROCEDURE NAME - PRINTXYZ                             @Z40LB25*/ 05498000
*   /*                                                       @Z40LB25*/ 05499000
*   /* FUNCTION - CONTROLS THE PRINTING HEADING FOR THE      @Z40LB25*/ 05500000
*   /* CHECK AND READ LABEL REPORTS PLUS THE PRINTING        @Z40LB25*/ 05501000
*   /* OF THE APPROPRIATE XYZ LOCATIONS FROM XYZ1 OR         @Z40LB25*/ 05502000
*   /* OR XYZ2 WORK AREAS.                                   @Z40LB25*/ 05503000
*   /*                                                       @Z40LB25*/ 05504000
*   /* INPUT -                                               @Z40LB25*/ 05505000
*   /* XYZ1                                                  @Z40LB25*/ 05506000
*   /* XYZ2                                                  @Z40LB25*/ 05507000
*   /* PRTXYZ1                                               @Z40LB25*/ 05508000
*   /* PRTXYZ2                                               @Z40LB25*/ 05509000
*   /* TABLEND                                               @Z40LB25*/ 05510000
*   /*                                                       @Z40LB25*/ 05511000
*   /* OUTPUT -                                              @Z40LB25*/ 05512000
*   /* CHECK REPORT HEADERS -                                @Z40LB25*/ 05513000
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/ 05514000
*   /* OCCUPIED)                                             @Z40LB25*/ 05515000
*   /* CELLS FOUND OCCUPIED (MSC TABLES INDICATE             @Z40LB25*/ 05516000
*   /* VACANT)                                               @Z40LB25*/ 05517000
*   /* READ LABEL REPORT HEADERS -                           @Z40LB25*/ 05518000
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/ 05519000
*   /* OCCUPIED)                                             @Z40LB25*/ 05520000
*   /* VACANT CELLS                                          @Z40LB25*/ 05521000
*   /* CARTRIDGES NOT ACCESSED                               @Z40LB25*/ 05522000
*   /*                                                               */ 05523000
*   /*****************************************************************/ 05524000
*                                                                  1561 05525000
*PRINTXYZ:                                                         1561 05526000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 05527000
*                                                                  1561 05528000
PRINTXYZ ST    @14,@SA00012                                        1561 05529000
*   /*****************************************************************/ 05530000
*   /*                                                               */ 05531000
*   /* PRINT THE CORRECT HEADER FOR XYZ1 INPUT TO            @Z40LB25*/ 05532000
*   /* TO EITHER THE CHECK OR READ LABEL REPORT              @Z40LB25*/ 05533000
*   /*                                                               */ 05534000
*   /*****************************************************************/ 05535000
*                                                                  1562 05536000
*   TABLEND=OFF;                    /* NOT AT TABLE END      @Z40LB25*/ 05537000
         NI    TABLEND,B'11101111'                                 1562 05538000
*   IF PRTXYZ1=ON THEN                                             1563 05539000
         TM    PRTXYZ1,B'01000000'                                 1563 05540000
         BNO   @RF01563                                            1563 05541000
*     DO;                           /*                       @Z40LB25*/ 05542000
*       XYZ1PRTD=ON;                /* XYZ1 PRINTED          @Z40LB25*/ 05543000
*                                                                  1565 05544000
         OI    XYZ1PRTD,B'00000010'                                1565 05545000
*       /*************************************************************/ 05546000
*       /*                                                           */ 05547000
*       /* CHECK REPORT?                                     @Z40LB25*/ 05548000
*       /*                                                           */ 05549000
*       /*************************************************************/ 05550000
*                                                                  1566 05551000
*       IF ADDR(CHK)^=NULLPTR THEN                                 1566 05552000
         L     @15,@PC00001+4                                      1566 05553000
         L     @15,FDTPTR+4(,@15)                                  1566 05554000
         LTR   @15,@15                                             1566 05555000
         BZ    @RF01566                                            1566 05556000
*         DO;                       /*                       @Z40LB25*/ 05557000
*                                                                  1567 05558000
*           /*********************************************************/ 05559000
*           /*                                                       */ 05560000
*           /* PRINT HEADERS -                               @Z40LB25*/ 05561000
*           /* CELLS FOUND VACANT (MSC TABLES INDICATE OCCUPIED      */ 05562000
*           /*                                               @Z40LB25*/ 05563000
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/ 05564000
*           /*                                                       */ 05565000
*           /*********************************************************/ 05566000
*                                                                  1568 05567000
*           HDCKID14=ON;            /*                       @Z40LB25*/ 05568000
         OI    HDCKID14,B'10000000'                                1568 05569000
*           CALL HEADSET;           /*                       @Z40LB25*/ 05570000
*                                                                  1569 05571000
         BAL   @14,HEADSET                                         1569 05572000
*           /*********************************************************/ 05573000
*           /*                                                       */ 05574000
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/ 05575000
*           /*                                                       */ 05576000
*           /*********************************************************/ 05577000
*                                                                  1570 05578000
*           CALL FMTXYZRP;          /*                       @Z40LB25*/ 05579000
         BAL   @14,FMTXYZRP                                        1570 05580000
*         END;                      /*                       @Z40LB25*/ 05581000
*                                                                  1571 05582000
*       /*************************************************************/ 05583000
*       /*                                                           */ 05584000
*       /* READ LABEL REPORT?                                @Z40LB25*/ 05585000
*       /*                                                           */ 05586000
*       /*************************************************************/ 05587000
*                                                                  1572 05588000
*       IF ADDR(RDLBL)^=NULLPTR THEN                               1572 05589000
@RF01566 SLR   @15,@15                                             1572 05590000
         L     @14,@PC00001+4                                      1572 05591000
         C     @15,FDTPTR+8(,@14)                                  1572 05592000
         BE    @RF01572                                            1572 05593000
*         DO;                       /*                       @Z40LB25*/ 05594000
*                                                                  1573 05595000
*           /*********************************************************/ 05596000
*           /*                                                       */ 05597000
*           /* PRINT HEADERS -                               @Z40LB25*/ 05598000
*           /* CELLS FOUND VACANT (MSC TABLES INDICATE OCCUPIED      */ 05599000
*           /*                                               @Z40LB25*/ 05600000
*           /* VACANT CELLS                                  @Z40LB25*/ 05601000
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/ 05602000
*           /*                                                       */ 05603000
*           /*********************************************************/ 05604000
*                                                                  1574 05605000
*           IF ADDR(CELL)^=NULLPTR THEN                            1574 05606000
         C     @15,FDTPTR+40(,@14)                                 1574 05607000
         BE    @RF01574                                            1574 05608000
*             HDRDID16=ON;          /*                       @Z40LB25*/ 05609000
         OI    HDRDID16,B'10000000'                                1575 05610000
*           IF ADDR(XRNG)^=NULLPTR THEN                            1576 05611000
@RF01574 L     @15,@PC00001+4                                      1576 05612000
         L     @15,FDTPTR+28(,@15)                                 1576 05613000
         LTR   @15,@15                                             1576 05614000
         BZ    @RF01576                                            1576 05615000
*             HDRDID14=ON;          /*                       @Z40LB25*/ 05616000
         OI    HDRDID14,B'10000000'                                1577 05617000
*           CALL HEADSET;           /*                       @Z40LB25*/ 05618000
*                                                                  1578 05619000
@RF01576 BAL   @14,HEADSET                                         1578 05620000
*           /*********************************************************/ 05621000
*           /*                                                       */ 05622000
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/ 05623000
*           /*                                                       */ 05624000
*           /*********************************************************/ 05625000
*                                                                  1579 05626000
*           CALL FMTXYZRP;          /*                       @Z40LB25*/ 05627000
         BAL   @14,FMTXYZRP                                        1579 05628000
*         END;                      /*                       @Z40LB25*/ 05629000
*                                                                  1580 05630000
*       /*************************************************************/ 05631000
*       /*                                                           */ 05632000
*       /* END OF THIS TABLE REACHED, RESET FOR NEXT TABLE   @Z40LB25*/ 05633000
*       /*                                                           */ 05634000
*       /*************************************************************/ 05635000
*                                                                  1581 05636000
*       TABLEND=OFF;                /*                       @Z40LB25*/ 05637000
@RF01572 NI    TABLEND,B'11101111'                                 1581 05638000
*     END;                          /*                       @Z40LB25*/ 05639000
*                                                                  1582 05640000
*   /*****************************************************************/ 05641000
*   /*                                                               */ 05642000
*   /* PRINT THE CORRECT HEADER FOR XYZ2 INPUT TO            @Z40LB25*/ 05643000
*   /* TO EITHER THE CHECK OR READ LABEL REPORT              @Z40LB25*/ 05644000
*   /*                                                               */ 05645000
*   /*****************************************************************/ 05646000
*                                                                  1583 05647000
*   IF PRTXYZ2=ON THEN                                             1583 05648000
@RF01563 TM    PRTXYZ2,B'00100000'                                 1583 05649000
         BNO   @RF01583                                            1583 05650000
*     DO;                           /*                       @Z40LB25*/ 05651000
*       XYZ2PRTD=ON;                /* XYZ2 PRINTED          @Z40LB25*/ 05652000
*                                                                  1585 05653000
         OI    XYZ2PRTD,B'00000001'                                1585 05654000
*       /*************************************************************/ 05655000
*       /*                                                           */ 05656000
*       /* CHECK REPORT?                                     @Z40LB25*/ 05657000
*       /*                                                           */ 05658000
*       /*************************************************************/ 05659000
*                                                                  1586 05660000
*       IF ADDR(CHK)^=NULLPTR THEN                                 1586 05661000
         L     @15,@PC00001+4                                      1586 05662000
         L     @15,FDTPTR+4(,@15)                                  1586 05663000
         LTR   @15,@15                                             1586 05664000
         BZ    @RF01586                                            1586 05665000
*         DO;                       /*                       @Z40LB25*/ 05666000
*                                                                  1587 05667000
*           /*********************************************************/ 05668000
*           /*                                                       */ 05669000
*           /* PRINT HEADERS -                               @Z40LB25*/ 05670000
*           /* CELLS FOUND OCCUPIED (MSC TABLES INDICATE VACANT)     */ 05671000
*           /*                                               @Z40LB25*/ 05672000
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/ 05673000
*           /*                                                       */ 05674000
*           /*********************************************************/ 05675000
*                                                                  1588 05676000
*           HDCKID15=ON;            /*                       @Z40LB25*/ 05677000
         OI    HDCKID15,B'10000000'                                1588 05678000
*           CALL HEADSET;           /*                       @Z40LB25*/ 05679000
*                                                                  1589 05680000
         BAL   @14,HEADSET                                         1589 05681000
*           /*********************************************************/ 05682000
*           /*                                                       */ 05683000
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/ 05684000
*           /*                                                       */ 05685000
*           /*********************************************************/ 05686000
*                                                                  1590 05687000
*           CALL FMTXYZRP;          /*                       @Z40LB25*/ 05688000
         BAL   @14,FMTXYZRP                                        1590 05689000
*         END;                      /*                       @Z40LB25*/ 05690000
*                                                                  1591 05691000
*       /*************************************************************/ 05692000
*       /*                                                           */ 05693000
*       /* READ LABEL REPORT?                                @Z40LB25*/ 05694000
*       /*                                                           */ 05695000
*       /*************************************************************/ 05696000
*                                                                  1592 05697000
*       IF ADDR(RDLBL)^=NULLPTR THEN                               1592 05698000
@RF01586 L     @15,@PC00001+4                                      1592 05699000
         L     @15,FDTPTR+8(,@15)                                  1592 05700000
         LTR   @15,@15                                             1592 05701000
         BZ    @RF01592                                            1592 05702000
*         DO;                       /*                       @Z40LB25*/ 05703000
*                                                                  1593 05704000
*           /*********************************************************/ 05705000
*           /*                                                       */ 05706000
*           /* PRINT HEADERS                                 @Z40LB25*/ 05707000
*           /* CARTRIDGES NOT ACCESSED                       @Z40LB25*/ 05708000
*           /* X Y Z X Y Z X Y Z.... ETC.                    @Z40LB25*/ 05709000
*           /*                                                       */ 05710000
*           /*********************************************************/ 05711000
*                                                                  1594 05712000
*           HDRDID37=ON;            /*                       @Z40LB25*/ 05713000
         OI    HDRDID37,B'10000000'                                1594 05714000
*           CALL HEADSET;           /*                       @Z40LB25*/ 05715000
*                                                                  1595 05716000
         BAL   @14,HEADSET                                         1595 05717000
*           /*********************************************************/ 05718000
*           /*                                                       */ 05719000
*           /* PRINT XYZ LOCATIONS                           @Z40LB25*/ 05720000
*           /*                                                       */ 05721000
*           /*********************************************************/ 05722000
*                                                                  1596 05723000
*           CALL FMTXYZRP;          /*                       @Z40LB25*/ 05724000
         BAL   @14,FMTXYZRP                                        1596 05725000
*         END;                      /*                       @Z40LB25*/ 05726000
*                                                                  1597 05727000
*       /*************************************************************/ 05728000
*       /*                                                           */ 05729000
*       /* END OF THIS TABLE REACHED, RESET FOR NEXT TABLE   @Z40LB25*/ 05730000
*       /*                                                           */ 05731000
*       /*************************************************************/ 05732000
*                                                                  1598 05733000
*       TABLEND=OFF;                /*                       @Z40LB25*/ 05734000
@RF01592 NI    TABLEND,B'11101111'                                 1598 05735000
*     END;                          /*                       @Z40LB25*/ 05736000
*   RETURN;                         /*                       @Z40LB25*/ 05737000
@EL00012 DS    0H                                                  1600 05738000
@EF00012 DS    0H                                                  1600 05739000
@ER00012 L     @14,@SA00012                                        1600 05740000
         BR    @14                                                 1600 05741000
*   END PRINTXYZ;                   /*                       @Z40LB25*/ 05742000
         B     @EL00012                                            1601 05743000
*                                                                  1602 05744000
*   /*****************************************************************/ 05745000
*   /*                                                               */ 05746000
*   /* PROCEDURE NAME - FMTXYZRP                             @Z40LB25*/ 05747000
*   /*                                                       @Z40LB25*/ 05748000
*   /* FUNCTION - HAS XYZ1 AND/OR XYZ2 WORK AREA(S) SCAN-    @Z40LB25*/ 05749000
*   /* NED FOR AN ON BIT. WHEN SIX ON BITS HAVE BEEN         @Z40LB25*/ 05750000
*   /* TRANSLATED INTO XYZ LOCATIONS OR THE END              @Z40LB25*/ 05751000
*   /* OF THE XYZ1 OR XYZ2 WORK AREA IS REACHED, THEN        @Z40LB25*/ 05752000
*   /* THE TRANSLATED LOCATIONS ARE PRINTED. XYZ1            @Z40LB25*/ 05753000
*   /* WORK AREA IS USED FOR CELLS FOUND VACANT (MSC         @Z40LB25*/ 05754000
*   /* INDICATES OCCUPIED) FOR EITHER THE CHECK OR           @Z40LB25*/ 05755000
*   /* READ LABEL REPORT. ALSO, FOR THE READ LABEL           @Z40LB25*/ 05756000
*   /* REPORT XYZ1 IS USED FOR VACANT CELLS. XYZ2            @Z40LB25*/ 05757000
*   /* WORK AREA IS USED FOR CELLS FOUND OCCUPIED            @Z40LB25*/ 05758000
*   /* (MSC INDICATES VACANT) FOR THE CHECK REPORT AND       @Z40LB25*/ 05759000
*   /* CARTRIDGES NOT ACCESSED FOR THE READ LABEL            @Z40LB25*/ 05760000
*   /* REPORT.                                               @Z40LB25*/ 05761000
*   /*                                                       @Z40LB25*/ 05762000
*   /* INPUT -                                               @Z40LB25*/ 05763000
*   /* XYZ1                                                  @Z40LB25*/ 05764000
*   /* XYZ2                                                  @Z40LB25*/ 05765000
*   /* PRTXYZ1                                               @Z40LB25*/ 05766000
*   /* PRTXYZ2                                               @Z40LB25*/ 05767000
*   /*                                                       @Z40LB25*/ 05768000
*   /* OUTPUT -                                              @Z40LB25*/ 05769000
*   /* PRTXYZ1                                               @Z40LB25*/ 05770000
*   /* PRTXYZ2                                               @Z40LB25*/ 05771000
*   /* CHUNKPTR                                              @Z40LB25*/ 05772000
*   /* CELLPTR                                               @Z40LB25*/ 05773000
*   /* TABLEND                                               @Z40LB25*/ 05774000
*   /* CHECK REPORT XYZ LOCATIONS FOR -                      @Z40LB25*/ 05775000
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/ 05776000
*   /* OCCUPIED)                                             @Z40LB25*/ 05777000
*   /* CELLS FOUND OCCUPIED (MSC TABLES INDICATE             @Z40LB25*/ 05778000
*   /* VACANT)                                               @Z40LB25*/ 05779000
*   /* READ LABEL REPORT XYZ LOCATIONS FOR -                 @Z40LB25*/ 05780000
*   /* CELLS FOUND VACANT (MSC TABLES INDICATE               @Z40LB25*/ 05781000
*   /* OCCUPIED) OR VACANT CELLS                             @Z40LB25*/ 05782000
*   /* CARTRIDGES NOT ACCESSED                               @Z40LB25*/ 05783000
*   /*                                                               */ 05784000
*   /*****************************************************************/ 05785000
*                                                                  1602 05786000
*FMTXYZRP:                                                         1602 05787000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 05788000
*                                                                  1602 05789000
FMTXYZRP ST    @14,@SA00013                                        1602 05790000
*   /*****************************************************************/ 05791000
*   /*                                                               */ 05792000
*   /* DETERMINE THE CORRECT WORK AREA                       @Z40LB25*/ 05793000
*   /*                                                               */ 05794000
*   /*****************************************************************/ 05795000
*                                                                  1603 05796000
*   IF PRTXYZ1=ON THEN              /* XYZ1?                 @Z40LB25*/ 05797000
         TM    PRTXYZ1,B'01000000'                                 1603 05798000
         BNO   @RF01603                                            1603 05799000
*     DO;                           /*                       @Z40LB25*/ 05800000
*       PRTXYZ1=OFF;                /*                       @Z40LB25*/ 05801000
         NI    PRTXYZ1,B'10111111'                                 1605 05802000
*       XYZ1PTRS=ON;                /* SET XYZ1 PTRS         @Z40LB25*/ 05803000
*       XYZ2PTRS=OFF;               /*                       @Z40LB25*/ 05804000
         OI    XYZ1PTRS,B'00001000'                                1607 05805000
         NI    XYZ2PTRS,B'11111011'                                1607 05806000
*     END;                          /*                       @Z40LB25*/ 05807000
*   ELSE                                                           1609 05808000
*     IF PRTXYZ2=ON THEN            /* XYZ2?                 @Z40LB25*/ 05809000
         B     @RC01603                                            1609 05810000
@RF01603 TM    PRTXYZ2,B'00100000'                                 1609 05811000
         BNO   @RF01609                                            1609 05812000
*       DO;                         /*                       @Z40LB25*/ 05813000
*         PRTXYZ2=OFF;              /*                       @Z40LB25*/ 05814000
         NI    PRTXYZ2,B'11011111'                                 1611 05815000
*         XYZ2PTRS=ON;              /* SET XYZ2 PTRS         @Z40LB25*/ 05816000
*         XYZ1PTRS=OFF;             /*                       @Z40LB25*/ 05817000
         OI    XYZ2PTRS,B'00000100'                                1613 05818000
         NI    XYZ1PTRS,B'11110111'                                1613 05819000
*       END;                        /*                       @Z40LB25*/ 05820000
*                                                                  1614 05821000
*   /*****************************************************************/ 05822000
*   /*                                                               */ 05823000
*   /* PRINT THE LOCATIONS                                   @Z40LB25*/ 05824000
*   /*                                                               */ 05825000
*   /*****************************************************************/ 05826000
*                                                                  1615 05827000
*   DO WHILE TABLEND=OFF;           /*                       @Z40LB25*/ 05828000
@RF01609 DS    0H                                                  1615 05829000
@RC01603 B     @DE01615                                            1615 05830000
@DL01615 DS    0H                                                  1616 05831000
*     PRINTAB=''B;                  /*                       @Z40LB25*/ 05832000
         XC    PRINTAB(164),PRINTAB                                1616 05833000
*     DARGSMOD=AUDMSG;              /*                       @Z40LB25*/ 05834000
         L     @02,DDSTRU                                          1617 05835000
         MVC   DARGSMOD(3,@02),@CC01440                            1617 05836000
*     DARGSENT=XYZLOCS;             /*                       @Z40LB25*/ 05837000
         MVI   DARGSENT(@02),X'2F'                                 1618 05838000
*     II=1;                         /*                       @Z40LB25*/ 05839000
         LA    @15,1                                               1619 05840000
         LR    II,@15                                              1619 05841000
*     DO I=1 TO 6 WHILE TABLEND=OFF;/* PRT UP TO 6 XYZS      @Z40LB25*/ 05842000
*                                                                  1620 05843000
         LR    I,@15                                               1620 05844000
@DL01620 TM    TABLEND,B'00010000'                                 1620 05845000
         BNZ   @DC01620                                            1620 05846000
*       /*************************************************************/ 05847000
*       /*                                                           */ 05848000
*       /* CHECK TO SET XYZ1 POINTERS                        @Z40LB25*/ 05849000
*       /*                                                           */ 05850000
*       /*************************************************************/ 05851000
*                                                                  1621 05852000
*       IF XYZ1PTRS=ON THEN                                        1621 05853000
         TM    XYZ1PTRS,B'00001000'                                1621 05854000
         BNO   @RF01621                                            1621 05855000
*         DO;                       /*                       @Z40LB25*/ 05856000
*           CHUNKPTR=ADDR(XYZ1CUBE(1));/*                    @Z40LB25*/ 05857000
         L     @05,XYZ1PTR                                         1623 05858000
         LA    @02,XYZ1CUBE(,@05)                                  1623 05859000
         ST    @02,CHUNKPTR                                        1623 05860000
*           CELLPTR=ADDR(XYZ1BLK(1));/*                      @Z40LB25*/ 05861000
         ST    @05,CELLPTR                                         1624 05862000
*         END;                      /*                       @Z40LB25*/ 05863000
*                                                                  1625 05864000
*       /*************************************************************/ 05865000
*       /*                                                           */ 05866000
*       /* CHECK TO SET XYZ2 POINTERS                        @Z40LB25*/ 05867000
*       /*                                                           */ 05868000
*       /*************************************************************/ 05869000
*                                                                  1626 05870000
*       IF XYZ2PTRS=ON THEN                                        1626 05871000
@RF01621 TM    XYZ2PTRS,B'00000100'                                1626 05872000
         BNO   @RF01626                                            1626 05873000
*         DO;                       /*                       @Z40LB25*/ 05874000
*           CHUNKPTR=ADDR(XYZ2CUBE(1));/*                    @Z40LB25*/ 05875000
         L     @05,XYZ2PTR                                         1628 05876000
         LA    @02,XYZ2CUBE(,@05)                                  1628 05877000
         ST    @02,CHUNKPTR                                        1628 05878000
*           CELLPTR=ADDR(XYZ2BLK(1));/*                      @Z40LB25*/ 05879000
         ST    @05,CELLPTR                                         1629 05880000
*         END;                      /*                       @Z40LB25*/ 05881000
*                                                                  1630 05882000
*       /*************************************************************/ 05883000
*       /*                                                           */ 05884000
*       /* CONVERT AN ON BIT IN EITHER XYZ1 OR               @Z40LB25*/ 05885000
*       /* XYZ2 TO AN XYZ LOCATION                           @Z40LB25*/ 05886000
*       /*                                                           */ 05887000
*       /*************************************************************/ 05888000
*                                                                  1631 05889000
*       CALL BITTOLOC;              /*                       @Z40LB25*/ 05890000
*                                                                  1631 05891000
@RF01626 BAL   @14,BITTOLOC                                        1631 05892000
*       /*************************************************************/ 05893000
*       /*                                                           */ 05894000
*       /* CHECK FOR TABLE END WITH NOTHING TO PRINT         @Z40LB25*/ 05895000
*       /*                                                           */ 05896000
*       /*************************************************************/ 05897000
*                                                                  1632 05898000
*       IF TABLEND=ON&I=1 THEN                                     1632 05899000
         TM    TABLEND,B'00010000'                                 1632 05900000
         BNO   @RF01632                                            1632 05901000
         C     I,@CF00224                                          1632 05902000
         BE    @RT01632                                            1632 05903000
*         RETURN;                   /*                       @Z40LB25*/ 05904000
*                                                                  1633 05905000
*       /*************************************************************/ 05906000
*       /*                                                           */ 05907000
*       /* CHECK FOR TABLE END                               @Z40LB25*/ 05908000
*       /*                                                           */ 05909000
*       /*************************************************************/ 05910000
*                                                                  1634 05911000
*       IF TABLEND=OFF THEN                                        1634 05912000
@RF01632 TM    TABLEND,B'00010000'                                 1634 05913000
         BNZ   @RF01634                                            1634 05914000
*         DO;                       /*                       @Z40LB25*/ 05915000
*                                                                  1635 05916000
*           /*********************************************************/ 05917000
*           /*                                                       */ 05918000
*           /* SET THE ARGUMENT COUNT                        @Z40LB25*/ 05919000
*           /*                                                       */ 05920000
*           /*********************************************************/ 05921000
*                                                                  1636 05922000
*           DARGCNT=I*3;            /*                       @Z40LB25*/ 05923000
*                                                                  1636 05924000
         L     @05,DDSTRU                                          1636 05925000
         LA    @02,3                                               1636 05926000
         LR    @01,I                                               1636 05927000
         MR    @00,@02                                             1636 05928000
         STH   @01,DARGCNT(,@05)                                   1636 05929000
*           /*********************************************************/ 05930000
*           /*                                                       */ 05931000
*           /* SET X                                         @Z40LB25*/ 05932000
*           /*                                                       */ 05933000
*           /*********************************************************/ 05934000
*                                                                  1637 05935000
*           DARGINS(II)=II;         /*                       @Z40LB25*/ 05936000
         LR    @15,II                                              1637 05937000
         SLA   @15,3                                               1637 05938000
         STH   II,DARGINS-8(@15,@05)                               1637 05939000
*           PRTX(I)=X;              /* RELATIVE X            @Z40LB25*/ 05940000
         LR    @14,I                                               1638 05941000
         SLA   @14,3                                               1638 05942000
         LH    @07,X                                               1638 05943000
         LA    @06,PRTX-8(@14)                                     1638 05944000
         STCM  @07,3,0(@06)                                        1638 05945000
*           DARGINL(II)=LENGTH(PRTX(I));/*                   @Z40LB25*/ 05946000
         LA    @07,2                                               1639 05947000
         STH   @07,DARGINL-8(@15,@05)                              1639 05948000
*           DARGDTM(II)=ADDR(PRTX(I));/*                     @Z40LB25*/ 05949000
*                                                                  1640 05950000
         LA    @06,PRTX-8(@14)                                     1640 05951000
         ST    @06,DARGDTM-8(@15,@05)                              1640 05952000
*           /*********************************************************/ 05953000
*           /*                                                       */ 05954000
*           /* SET Y                                         @Z40LB25*/ 05955000
*           /*                                                       */ 05956000
*           /*********************************************************/ 05957000
*                                                                  1641 05958000
*           DARGINS(II+1)=II+1;     /*                       @Z40LB25*/ 05959000
         LA    @06,1                                               1641 05960000
         ALR   @06,II                                              1641 05961000
         STH   @06,DARGINS(@15,@05)                                1641 05962000
*           PRTY(I)=Y;              /* Y LOCATION            @Z40LB25*/ 05963000
         L     @06,Y                                               1642 05964000
         LA    @01,PRTY-8(@14)                                     1642 05965000
         STCM  @06,15,0(@01)                                       1642 05966000
*           DARGINL(II+1)=LENGTH(PRTY(I));/*                 @Z40LB25*/ 05967000
         LA    @06,4                                               1643 05968000
         STH   @06,DARGINL(@15,@05)                                1643 05969000
*           DARGDTM(II+1)=ADDR(PRTY(I));/*                   @Z40LB25*/ 05970000
*                                                                  1644 05971000
         LA    @06,PRTY-8(@14)                                     1644 05972000
         ST    @06,DARGDTM(@15,@05)                                1644 05973000
*           /*********************************************************/ 05974000
*           /*                                                       */ 05975000
*           /* SET Z                                         @Z40LB25*/ 05976000
*           /*                                                       */ 05977000
*           /*********************************************************/ 05978000
*                                                                  1645 05979000
*           DARGINS(II+2)=II+2;     /*                       @Z40LB25*/ 05980000
         LR    @06,II                                              1645 05981000
         ALR   @06,@07                                             1645 05982000
         STH   @06,DARGINS+8(@15,@05)                              1645 05983000
*           PRTZ(I)=Z;              /* Z LOCATION            @Z40LB25*/ 05984000
         LH    @06,Z                                               1646 05985000
         LA    @01,PRTZ-8(@14)                                     1646 05986000
         STCM  @06,3,0(@01)                                        1646 05987000
*           DARGINL(II+2)=LENGTH(PRTZ(I));/*                 @Z40LB25*/ 05988000
         STH   @07,DARGINL+8(@15,@05)                              1647 05989000
*           DARGDTM(II+2)=ADDR(PRTZ(I));/*                   @Z40LB25*/ 05990000
         LA    @14,PRTZ-8(@14)                                     1648 05991000
         ST    @14,DARGDTM+8(@15,@05)                              1648 05992000
*           II=II+3;                /* NEXT ARG NUMBER       @Z40LB25*/ 05993000
         ALR   II,@02                                              1649 05994000
*         END;                      /*                       @Z40LB25*/ 05995000
*     END;                          /*                       @Z40LB25*/ 05996000
@RF01634 AL    I,@CF00224                                          1651 05997000
         C     I,@CF00161                                          1651 05998000
         BNH   @DL01620                                            1651 05999000
@DC01620 DS    0H                                                  1652 06000000
*     CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                @Z40LB25*/ 06001000
         L     @15,@PC00001                                        1652 06002000
         ST    @15,@AL00001                                        1652 06003000
         L     @14,@PC00001+12                                     1652 06004000
         ST    @14,@AL00001+4                                      1652 06005000
         LA    @14,DDSTRU                                          1652 06006000
         ST    @14,@AL00001+8                                      1652 06007000
         MVI   @AL00001+8,X'80'                                    1652 06008000
         L     @15,GDTPRT(,@15)                                    1652 06009000
         LA    @01,@AL00001                                        1652 06010000
         BALR  @14,@15                                             1652 06011000
*   END;                            /*                       @Z40LB25*/ 06012000
@DE01615 TM    TABLEND,B'00010000'                                 1653 06013000
         BZ    @DL01615                                            1653 06014000
*   RETURN;                         /*                       @Z40LB25*/ 06015000
@EL00013 DS    0H                                                  1654 06016000
@EF00013 DS    0H                                                  1654 06017000
@ER00013 L     @14,@SA00013                                        1654 06018000
         BR    @14                                                 1654 06019000
*   END FMTXYZRP;                   /*                       @Z40LB25*/ 06020000
         B     @EL00013                                            1655 06021000
*                                                                  1656 06022000
*   /*****************************************************************/ 06023000
*   /*                                                               */ 06024000
*   /* PROCEDURE NAME - READ                                 @Z40LB22*/ 06025000
*   /*                                                       @Z40LB22*/ 06026000
*   /* FUNCTION - IT IS CALLED BY READLBL TO                 @Z40LB25*/ 06027000
*   /* HAVE PRINTED A LINE OF DATA FOR OCCUPIED CELLS        @Z40LB22*/ 06028000
*   /* OF THE READLABEL REPORT. THIS IS ACCOMPLISHED BY      @Z40LB22*/ 06029000
*   /* THE BITTOLOC ROUTINE INTERROGATING WORKMAP IN A       @Z40LB22*/ 06030000
*   /* SEARCH FOR ANY ON BITS. IF THERE ARE NO ON BITS       @Z40LB22*/ 06031000
*   /* FOUND, THE READ PROCEDURE RETURNS TO READLBL.         @Z40LB22*/ 06032000
*   /* HOWEVER, IF AN ON BIT IS FOUND THEN PROCESSING        @Z40LB22*/ 06033000
*   /* CONTINUES IN THE FOLLOWING MANNER -                   @Z40LB22*/ 06034000
*   /*                                                       @Z40LB22*/ 06035000
*   /* A PARAMETER LIST IS BUILT IN PREPARATION TO           @Z40LB22*/ 06036000
*   /* INVOKE THE MSSC MACRO ICBQUERY. IF A VALID            @Z40LB22*/ 06037000
*   /* ERROR OCCURS, THEN THE CONDITION CODE                 @Z40LB22*/ 06038000
*   /* IS INTERROGATED AND SAVED, AND THE LOOP               @Z40LB22*/ 06039000
*   /* CONTINUES. IF THE CONDITION CODE IS NOT OF            @Z40LB22*/ 06040000
*   /* THE TYPE THE READ PROCEDURE EXPECTS, A CALL           @Z40LB22*/ 06041000
*   /* IS MADE TO THE AMS MACRO SSCMSG.                      @Z40LB22*/ 06042000
*   /*                                                       @Z40LB22*/ 06043000
*   /* HOWEVER, IF THERE ARE NO ERRORS A CALL IS             @Z40LB22*/ 06044000
*   /* MADE TO THE ROUTINE PRINTRDL TO FORMAT AND            @Z40LB22*/ 06045000
*   /* PRINT THE LABEL, AND THE LOOP CONTINUES.              @Z40LB22*/ 06046000
*   /*                                                       @Z40LB22*/ 06047000
*   /* THIS IS AN INFINITE LOOP AND THE ONLY WAY             @Z40LB22*/ 06048000
*   /* TO GET OUT OF IT IS TO SEARCH EVERY BIT IN            @Z40LB22*/ 06049000
*   /* WORKMAP AND REACH THE END OF SAME, OR HAVE            @Z40LB22*/ 06050000
*   /* A RETURN CODE OF 8 (PARTIAL REPORT TO BE              @Z40LB22*/ 06051000
*   /* PRINTED) OR A RETURN CODE OF 12 (NO REPORT            @Z40LB22*/ 06052000
*   /* TO BE PRINTED). IN EITHER CASE A RETURN               @Z40LB22*/ 06053000
*   /* IS MADE TO THE CALLER (READLBL).                      @Z40LB22*/ 06054000
*   /*                                                       @Z40LB22*/ 06055000
*   /* INPUT -                                               @Z40LB22*/ 06056000
*   /* GDTTBL                                                @Z40LB22*/ 06057000
*   /* FDTTBL                                                @Z40LB22*/ 06058000
*   /* WORKMAP                                               @Z40LB22*/ 06059000
*   /*                                                       @Z40LB22*/ 06060000
*   /* OUTPUT -                                              @Z40LB22*/ 06061000
*   /* READRC                                                @Z40LB22*/ 06062000
*   /* 12 - FAIL ON FIRST CALL TO USSC                       @Z40LB25*/ 06063000
*   /* 8 - FAIL ON OTHER THAN FIRST USSC CALL                @Z40LB25*/ 06064000
*   /* DIAGBUF (CARTLAB)                                     @Z40LB22*/ 06065000
*   /*                                                               */ 06066000
*   /*****************************************************************/ 06067000
*                                                                  1656 06068000
*READ:                                                             1656 06069000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB22*/ 06070000
*                                                                  1656 06071000
READ     ST    @14,@SA00014                                        1656 06072000
*   /*****************************************************************/ 06073000
*   /*                                                               */ 06074000
*   /* INITIALIZATIONS FOR READ                              @Z40LB22*/ 06075000
*   /*                                                               */ 06076000
*   /*****************************************************************/ 06077000
*                                                                  1657 06078000
*   READL=''B;                      /* MSF 0                 @Z40LB25*/ 06079000
         L     @15,RDCKPTR                                         1657 06080000
         NI    READL(@15),B'00111111'                              1657 06081000
*   IF MSFVAL=1 THEN                                               1658 06082000
         L     @14,@PC00001+4                                      1658 06083000
         L     @01,FDTPTR+24(,@14)                                 1658 06084000
         CLC   MSFVAL(4,@01),@CF00224                              1658 06085000
         BNE   @RF01658                                            1658 06086000
*     READL2=ON;                    /* MSF 1                 @Z40LB25*/ 06087000
         OI    READL2(@15),B'01000000'                             1659 06088000
*   IF MSFVAL=2 THEN                                               1660 06089000
@RF01658 L     @15,@PC00001+4                                      1660 06090000
         L     @01,FDTPTR+24(,@15)                                 1660 06091000
         CLC   MSFVAL(4,@01),@CF00158                              1660 06092000
         BNE   @RF01660                                            1660 06093000
*     READL1=ON;                    /*                       @Z40LB25*/ 06094000
         L     @01,RDCKPTR                                         1661 06095000
         OI    READL1(@01),B'10000000'                             1661 06096000
*   IF MSFVAL=3 THEN                                               1662 06097000
@RF01660 L     @15,@PC00001+4                                      1662 06098000
         L     @01,FDTPTR+24(,@15)                                 1662 06099000
         CLC   MSFVAL(4,@01),@CF00167                              1662 06100000
         BNE   @RF01662                                            1662 06101000
*     DO;                           /*                       @Z40LB25*/ 06102000
*       READL1=ON;                  /*                       @Z40LB25*/ 06103000
*       READL2=ON;                  /*                       @Z40LB25*/ 06104000
         L     @01,RDCKPTR                                         1665 06105000
         OI    READL1(@01),B'11000000'                             1665 06106000
*     END;                          /*                       @Z40LB25*/ 06107000
*                                                                  1666 06108000
*   /*****************************************************************/ 06109000
*   /*                                                               */ 06110000
*   /* FOR ICBQUERY (QCEL)                                   @Z40LB25*/ 06111000
*   /*                                                               */ 06112000
*   /*****************************************************************/ 06113000
*                                                                  1667 06114000
*   QUPTR=ADDR(DIAGBUF);            /* ADDR OF RETURN BUF    @Z40LB22*/ 06115000
@RF01662 L     @15,@PC00001+8                                      1667 06116000
         L     @01,BLKPTR(,@15)                                    1667 06117000
         LA    @15,DIAGBUF(,@01)                                   1667 06118000
         L     @14,RDCKPTR                                         1667 06119000
         ST    @15,QUPTR(,@14)                                     1667 06120000
*   TERMINAT=OFF;                   /* LAST BIT IN WORK MAP  @Z40LB22*/ 06121000
         NI    TERMINAT,B'11011111'                                1668 06122000
*                                                                  1669 06123000
*   /*****************************************************************/ 06124000
*   /*                                                               */ 06125000
*   /* PERFORM LOOP IN THE WORK MAP TO FIND ALL (IF ANY)     @Z40LB22*/ 06126000
*   /* PRINTABLE X Y Z LOCATIONS                             @Z40LB22*/ 06127000
*   /*                                                               */ 06128000
*   /*****************************************************************/ 06129000
*                                                                  1669 06130000
*   DO WHILE TERMINAT=OFF;          /* LOOP CONTROL          @Z40LB22*/ 06131000
         B     @DE01669                                            1669 06132000
@DL01669 DS    0H                                                  1670 06133000
*     CHUNKPTR=ADDR(WRKCUBE(1));    /* ADDR OF WORK AREA     @Z40LB22*/ 06134000
         L     @15,WRKMAPTR                                        1670 06135000
         LA    @14,WRKCUBE(,@15)                                   1670 06136000
         ST    @14,CHUNKPTR                                        1670 06137000
*     CELLPTR=ADDR(WRKBLK(1));      /* CELL BLOCK PTR        @Z40LB25*/ 06138000
*                                                                  1671 06139000
         ST    @15,CELLPTR                                         1671 06140000
*     /***************************************************************/ 06141000
*     /*                                                             */ 06142000
*     /* FIND AN XYZ LOCATION                                @Z40LB25*/ 06143000
*     /*                                                             */ 06144000
*     /***************************************************************/ 06145000
*                                                                  1672 06146000
*     CALL BITTOLOC;                /* SEARCH WORK MAP       @Z40LB22*/ 06147000
         BAL   @14,BITTOLOC                                        1672 06148000
*     IF TABLEND=ON THEN            /* END OF WORK MAP       @Z40LB22*/ 06149000
         TM    TABLEND,B'00010000'                                 1673 06150000
         BO    @RT01673                                            1673 06151000
*       RETURN;                     /*                       @Z40LB25*/ 06152000
*                                                                  1674 06153000
*     /***************************************************************/ 06154000
*     /*                                                             */ 06155000
*     /* CHANGE ANY ON BIT LOCATION TO A PRINTABLE XYZ LOC.  @Z40LB22*/ 06156000
*     /*                                                             */ 06157000
*     /***************************************************************/ 06158000
*                                                                  1675 06159000
*     IF Z=0 THEN                   /* Z LOCATION            @Z40LB25*/ 06160000
         LH    @15,Z                                               1675 06161000
         LTR   @15,@15                                             1675 06162000
         BNZ   @RF01675                                            1675 06163000
*       READZ=OFF;                  /* Z 0                   @Z40LB25*/ 06164000
         L     @01,RDCKPTR                                         1676 06165000
         NI    READZ(@01),B'11011111'                              1676 06166000
*     ELSE                                                         1677 06167000
*       READZ=ON;                   /* Z 1                   @Z40LB25*/ 06168000
         B     @RC01675                                            1677 06169000
@RF01675 L     @01,RDCKPTR                                         1677 06170000
         OI    READZ(@01),B'00100000'                              1677 06171000
*     READLZYX(1)=READLZYX(1)&YMASK;/* CLEAR Y LOC           @Z40LB25*/ 06172000
@RC01675 L     @15,RDCKPTR                                         1678 06173000
         NC    READLZYX(1,@15),YMASK                               1678 06174000
*     READLZYX(1)=READLZYX(1)|YCHAR;/* Y LOCATION            @Z40LB22*/ 06175000
         OC    READLZYX(1,@15),YCHAR                               1679 06176000
*     READX=X;                      /* X LOCATION            @Z40LB22*/ 06177000
*                                                                  1680 06178000
         MVC   READX(1,@15),X+1                                    1680 06179000
*     /***************************************************************/ 06180000
*     /*                                                             */ 06181000
*     /* DUMP THE ICBQUERY (QCEL) PARM LIST                  @Z40LB25*/ 06182000
*     /*                                                             */ 06183000
*     /***************************************************************/ 06184000
*                                                                  1681 06185000
*     IF GDTDBG=NULLPTR THEN                                       1681 06186000
         L     @15,@PC00001                                        1681 06187000
         L     @15,GDTDBG(,@15)                                    1681 06188000
         LTR   @15,@15                                             1681 06189000
         BZ    @RT01681                                            1681 06190000
*       ;                                                          1682 06191000
*     ELSE                                                         1683 06192000
*       DO;                                                        1683 06193000
*         DMPINDEX=ADDR(DMPSTG);    /*                       @Z40LB25*/ 06194000
         LA    DMPINDEX,DMPSTG                                     1684 06195000
*         DMPITMNM='QURYAREA';                                     1685 06196000
         MVC   DMPITMNM(8,DMPINDEX),@CC01579                       1685 06197000
*         DMPITMPT=ADDR(QURYAREA);                                 1686 06198000
         LA    @03,QURYAREA                                        1686 06199000
         ST    @03,DMPITMPT(,DMPINDEX)                             1686 06200000
*         DMPITMLN=LENGTH(QURYAREA);                               1687 06201000
         MVC   DMPITMLN(2,DMPINDEX),@CH00813                       1687 06202000
*         DMPITMTP='H';                                            1688 06203000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1688 06204000
*         DMPINDEX=DMPINDEX+DMPELEMT;/*                      @Z40LB25*/ 06205000
         AL    DMPINDEX,@CF00479                                   1689 06206000
*         DMPTRM=DMPTRMVL;                                         1690 06207000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1690 06208000
*       END;                        /*                       @Z40LB25*/ 06209000
*     IF GDTDBG=NULLPTR THEN                                       1692 06210000
@RT01681 L     @15,@PC00001                                        1692 06211000
         L     @15,GDTDBG(,@15)                                    1692 06212000
         LTR   @15,@15                                             1692 06213000
         BZ    @RT01692                                            1692 06214000
*       ;                                                          1693 06215000
*     ELSE                                                         1694 06216000
*       CALL IDCDB010(GDTTBL,'AUCC',ADDR(DMPSTG));/*         @Z40LB25*/ 06217000
*                                                                  1694 06218000
         L     @15,@PC00001                                        1694 06219000
         ST    @15,@AL00001                                        1694 06220000
         LA    @14,@CC01602                                        1694 06221000
         ST    @14,@AL00001+4                                      1694 06222000
         LA    @14,DMPSTG                                          1694 06223000
         ST    @14,@AFTEMPS+4                                      1694 06224000
         LA    @14,@AFTEMPS+4                                      1694 06225000
         ST    @14,@AL00001+8                                      1694 06226000
         MVI   @AL00001+8,X'80'                                    1694 06227000
         L     @15,GDTDBG(,@15)                                    1694 06228000
         LA    @01,@AL00001                                        1694 06229000
         BALR  @14,@15                                             1694 06230000
*     /***************************************************************/ 06231000
*     /*                                                             */ 06232000
*     /* INVOKE THE EXECUTE FORM OF THE ICBQUERY MACRO       @Z40LB22*/ 06233000
*     /* WITH TYPE = QLAB                                    @Z40LB22*/ 06234000
*     /*                                                             */ 06235000
*     /***************************************************************/ 06236000
*                                                                  1695 06237000
*     CALL IDCSASS0(GDTTBL,RDCARTLB,RDCKPTR,REASONCD);/*     @Z40LB22*/ 06238000
@RT01692 L     @02,@PC00001                                        1695 06239000
         ST    @02,@AL00001                                        1695 06240000
         LA    @15,RDCARTLB                                        1695 06241000
         ST    @15,@AL00001+4                                      1695 06242000
         LA    @15,RDCKPTR                                         1695 06243000
         ST    @15,@AL00001+8                                      1695 06244000
         LA    @15,REASONCD                                        1695 06245000
         ST    @15,@AL00001+12                                     1695 06246000
         MVI   @AL00001+12,X'80'                                   1695 06247000
         L     @15,GDTSSC(,@02)                                    1695 06248000
         LA    @01,@AL00001                                        1695 06249000
         BALR  @14,@15                                             1695 06250000
*     RESPECIFY                                                    1696 06251000
*       RTNREG RSTD;                                               1696 06252000
*     TESTRC=RTNREG;                                               1697 06253000
         LR    TESTRC,RTNREG                                       1697 06254000
*     RESPECIFY                                                    1698 06255000
*       RTNREG UNRSTD;              /*                       @Z40LB22*/ 06256000
*     IF TESTRC=0 THEN                                             1699 06257000
         LTR   TESTRC,TESTRC                                       1699 06258000
         BNZ   @RF01699                                            1699 06259000
*       DO;                         /* ARE THERE ANY ERRORS? @Z40LB22*/ 06260000
*                                                                  1700 06261000
*         /***********************************************************/ 06262000
*         /*                                                         */ 06263000
*         /* PRINT THE CARTRIDGE LABEL                       @Z40LB25*/ 06264000
*         /*                                                         */ 06265000
*         /***********************************************************/ 06266000
*                                                                  1701 06267000
*         CALL PRINTRDL;            /* FORMAT AND PRINT LABEL      1701 06268000
*                                                            @Z40LB22*/ 06269000
         BAL   @14,PRINTRDL                                        1701 06270000
*         FRSTUSSC=ON;              /* QLAB EXECUTED ONCE    @Z40LB22*/ 06271000
         OI    FRSTUSSC,B'00000001'                                1702 06272000
*         LABELRD=ON;               /* LABEL WAS READ        @Z40LB25   06273000
*                                      PUT TO LABEL D.S.     @Z40LB25*/ 06274000
         OI    LABELRD,B'01000000'                                 1703 06275000
*       END;                        /*                       @Z40LB22*/ 06276000
*                                                                  1704 06277000
*     /***************************************************************/ 06278000
*     /*                                                             */ 06279000
*     /* CHECK FOR REASON CODE HEX 55 FROM THE MSC           @Z40LB25*/ 06280000
*     /*                                                             */ 06281000
*     /***************************************************************/ 06282000
*                                                                  1705 06283000
*     IF REASONCD=VACTCELL THEN                                    1705 06284000
@RF01699 L     @02,REASONCD                                        1705 06285000
         SLR   @15,@15                                             1705 06286000
         IC    @15,VACTCELL                                        1705 06287000
         CR    @02,@15                                             1705 06288000
         BNE   @RF01705                                            1705 06289000
*       DO;                         /* VACANT CELL?          @Z40LB22*/ 06290000
*         CHUNKPTR=ADDR(XYZ1CUBE(1));/* AN ERROR FOR XZY1    @Z40LB22*/ 06291000
         L     @15,XYZ1PTR                                         1707 06292000
         LA    @14,XYZ1CUBE(,@15)                                  1707 06293000
         ST    @14,CHUNKPTR                                        1707 06294000
*         CELLPTR=ADDR(XYZ1BLK(1)); /*                       @Z40LB25*/ 06295000
*                                                                  1708 06296000
         ST    @15,CELLPTR                                         1708 06297000
*         /***********************************************************/ 06298000
*         /*                                                         */ 06299000
*         /* CONVERT THE LOCATION TO AN ON BIT IN XYZ1       @Z40LB25*/ 06300000
*         /*                                                         */ 06301000
*         /***********************************************************/ 06302000
*                                                                  1709 06303000
*         CALL LOCTOBIT;            /* PUT THE RESULTS INTO  @Z40LB22   06304000
*                                      A WORK AREA           @Z40LB22*/ 06305000
         BAL   @14,LOCTOBIT                                        1709 06306000
*         TESTRC=0;                 /* RESET THE REASON CODE @Z40LB22*/ 06307000
         SLR   @15,@15                                             1710 06308000
         LR    TESTRC,@15                                          1710 06309000
*         REASONCD=0;               /*                       @Z40LB25*/ 06310000
         ST    @15,REASONCD                                        1711 06311000
*         PRTXYZ1=ON;               /* RESET THE XYZ1 FLAG   @Z40LB22*/ 06312000
*                                                                  1712 06313000
         OI    PRTXYZ1,B'01000000'                                 1712 06314000
*         /***********************************************************/ 06315000
*         /*                                                         */ 06316000
*         /* CHECK IF SUBTITLE TO BE PRINTED                 @Z40LB25*/ 06317000
*         /*                                                         */ 06318000
*         /***********************************************************/ 06319000
*                                                                  1713 06320000
*         IF RDTITLE=OFF THEN                                      1713 06321000
         TM    RDTITLE,B'00001000'                                 1713 06322000
         BNZ   @RF01713                                            1713 06323000
*           DO;                     /*                       @Z40LB25*/ 06324000
*             IF ADDR(NLIST)^=NULLPTR THEN                         1715 06325000
         L     @02,@PC00001+4                                      1715 06326000
         C     @15,FDTPTR+68(,@02)                                 1715 06327000
         BE    @RF01715                                            1715 06328000
*               DO;                 /*                       @Z40LB25*/ 06329000
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1717 06330000
         C     @15,FDTPTR+28(,@02)                                 1717 06331000
         BE    @RF01717                                            1717 06332000
*                   HDRDID17=ON;    /*                       @Z40LB25*/ 06333000
         OI    HDRDID17,B'10000000'                                1718 06334000
*                 IF ADDR(CELL)^=NULLPTR THEN                      1719 06335000
@RF01717 L     @02,@PC00001+4                                      1719 06336000
         L     @02,FDTPTR+40(,@02)                                 1719 06337000
         LTR   @02,@02                                             1719 06338000
         BZ    @RF01719                                            1719 06339000
*                   HDRDID19=ON;    /*                       @Z40LB25*/ 06340000
         OI    HDRDID19,B'00100000'                                1720 06341000
*               END;                /*                       @Z40LB25*/ 06342000
@RF01719 DS    0H                                                  1722 06343000
*             IF ADDR(LIST)^=NULLPTR THEN                          1722 06344000
@RF01715 SLR   @02,@02                                             1722 06345000
         L     @15,@PC00001+4                                      1722 06346000
         C     @02,FDTPTR+64(,@15)                                 1722 06347000
         BE    @RF01722                                            1722 06348000
*               DO;                 /*                       @Z40LB25*/ 06349000
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1724 06350000
         C     @02,FDTPTR+28(,@15)                                 1724 06351000
         BE    @RF01724                                            1724 06352000
*                   HDRDID18=ON;    /*                       @Z40LB25*/ 06353000
         OI    HDRDID18,B'01000000'                                1725 06354000
*                 IF ADDR(CELL)^=NULLPTR THEN                      1726 06355000
@RF01724 L     @02,@PC00001+4                                      1726 06356000
         L     @02,FDTPTR+40(,@02)                                 1726 06357000
         LTR   @02,@02                                             1726 06358000
         BZ    @RF01726                                            1726 06359000
*                   HDRDID35=ON;    /*                       @Z40LB25*/ 06360000
         OI    HDRDID35,B'00010000'                                1727 06361000
*               END;                /*                       @Z40LB25*/ 06362000
@RF01726 DS    0H                                                  1729 06363000
*             RDTITLE=ON;           /*                       @Z40LB25*/ 06364000
@RF01722 OI    RDTITLE,B'00001000'                                 1729 06365000
*           END;                    /*                       @Z40LB25*/ 06366000
*         FRSTUSSC=ON;              /* QLAB EXECUTED ONCE    @Z40LB22*/ 06367000
@RF01713 OI    FRSTUSSC,B'00000001'                                1731 06368000
*       END;                        /*                       @Z40LB22*/ 06369000
*                                                                  1732 06370000
*     /***************************************************************/ 06371000
*     /*                                                             */ 06372000
*     /* CHECK FOR REASON CODE HEX 5E FROM THE MSC           @Z40LB25*/ 06373000
*     /*                                                             */ 06374000
*     /***************************************************************/ 06375000
*                                                                  1733 06376000
*     IF REASONCD=NOACCRT THEN                                     1733 06377000
@RF01705 L     @02,REASONCD                                        1733 06378000
         SLR   @15,@15                                             1733 06379000
         IC    @15,NOACCRT                                         1733 06380000
         CR    @02,@15                                             1733 06381000
         BNE   @RF01733                                            1733 06382000
*       DO;                         /* CART NOT ACCESSED?    @Z40LB22*/ 06383000
*         CHUNKPTR=ADDR(XYZ2CUBE(1));/* AN ERROR FOR XZY2    @Z40LB22*/ 06384000
         L     @15,XYZ2PTR                                         1735 06385000
         LA    @14,XYZ2CUBE(,@15)                                  1735 06386000
         ST    @14,CHUNKPTR                                        1735 06387000
*         CELLPTR=ADDR(XYZ2BLK(1)); /*                       @Z40LB25*/ 06388000
*                                                                  1736 06389000
         ST    @15,CELLPTR                                         1736 06390000
*         /***********************************************************/ 06391000
*         /*                                                         */ 06392000
*         /* CONVERT THE LOCATION TO AN ON BIT IN XYZ2       @Z40LB25*/ 06393000
*         /*                                                         */ 06394000
*         /***********************************************************/ 06395000
*                                                                  1737 06396000
*         CALL LOCTOBIT;            /* PUT THE RESULTS INTO  @Z40LB22   06397000
*                                      A WORK AREA           @Z40LB22*/ 06398000
         BAL   @14,LOCTOBIT                                        1737 06399000
*         TESTRC=0;                 /* RESET THE REASON CODE @Z40LB22*/ 06400000
         SLR   @15,@15                                             1738 06401000
         LR    TESTRC,@15                                          1738 06402000
*         REASONCD=0;               /*                       @Z40LB25*/ 06403000
         ST    @15,REASONCD                                        1739 06404000
*         PRTXYZ2=ON;               /* RESET THE XYZ2 FLAG   @Z40LB22*/ 06405000
*                                                                  1740 06406000
         OI    PRTXYZ2,B'00100000'                                 1740 06407000
*         /***********************************************************/ 06408000
*         /*                                                         */ 06409000
*         /* CHECK IF SUBTITLE TO BE PRINTED                 @Z40LB25*/ 06410000
*         /*                                                         */ 06411000
*         /***********************************************************/ 06412000
*                                                                  1741 06413000
*         IF RDTITLE=OFF THEN                                      1741 06414000
         TM    RDTITLE,B'00001000'                                 1741 06415000
         BNZ   @RF01741                                            1741 06416000
*           DO;                     /*                       @Z40LB25*/ 06417000
*             IF ADDR(NLIST)^=NULLPTR THEN                         1743 06418000
         L     @02,@PC00001+4                                      1743 06419000
         C     @15,FDTPTR+68(,@02)                                 1743 06420000
         BE    @RF01743                                            1743 06421000
*               DO;                 /*                       @Z40LB25*/ 06422000
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1745 06423000
         C     @15,FDTPTR+28(,@02)                                 1745 06424000
         BE    @RF01745                                            1745 06425000
*                   HDRDID17=ON;    /*                       @Z40LB25*/ 06426000
         OI    HDRDID17,B'10000000'                                1746 06427000
*                 IF ADDR(CELL)^=NULLPTR THEN                      1747 06428000
@RF01745 L     @02,@PC00001+4                                      1747 06429000
         L     @02,FDTPTR+40(,@02)                                 1747 06430000
         LTR   @02,@02                                             1747 06431000
         BZ    @RF01747                                            1747 06432000
*                   HDRDID19=ON;    /*                       @Z40LB25*/ 06433000
         OI    HDRDID19,B'00100000'                                1748 06434000
*               END;                /*                       @Z40LB25*/ 06435000
@RF01747 DS    0H                                                  1750 06436000
*             IF ADDR(LIST)^=NULLPTR THEN                          1750 06437000
@RF01743 SLR   @02,@02                                             1750 06438000
         L     @15,@PC00001+4                                      1750 06439000
         C     @02,FDTPTR+64(,@15)                                 1750 06440000
         BE    @RF01750                                            1750 06441000
*               DO;                 /*                       @Z40LB25*/ 06442000
*                 IF ADDR(XRNG)^=NULLPTR THEN                      1752 06443000
         C     @02,FDTPTR+28(,@15)                                 1752 06444000
         BE    @RF01752                                            1752 06445000
*                   HDRDID18=ON;    /*                       @Z40LB25*/ 06446000
         OI    HDRDID18,B'01000000'                                1753 06447000
*                 IF ADDR(CELL)^=NULLPTR THEN                      1754 06448000
@RF01752 L     @02,@PC00001+4                                      1754 06449000
         L     @02,FDTPTR+40(,@02)                                 1754 06450000
         LTR   @02,@02                                             1754 06451000
         BZ    @RF01754                                            1754 06452000
*                   HDRDID35=ON;    /*                       @Z40LB25*/ 06453000
         OI    HDRDID35,B'00010000'                                1755 06454000
*               END;                /*                       @Z40LB25*/ 06455000
@RF01754 DS    0H                                                  1757 06456000
*             RDTITLE=ON;           /*                       @Z40LB25*/ 06457000
@RF01750 OI    RDTITLE,B'00001000'                                 1757 06458000
*           END;                    /*                       @Z40LB25*/ 06459000
*         FRSTUSSC=ON;              /* QLAB EXECUTED ONCE    @Z40LB25*/ 06460000
@RF01741 OI    FRSTUSSC,B'00000001'                                1759 06461000
*       END;                        /*                       @Z40LB22*/ 06462000
*                                                                  1760 06463000
*     /***************************************************************/ 06464000
*     /*                                                             */ 06465000
*     /* IF ERRORS ARE NOT FOR XYZ1 OR XYZ2 WORKAREAS,       @Z40LB22*/ 06466000
*     /* THEN CALL SSCMSG AND PASS THE REASON CODE           @Z40LB22*/ 06467000
*     /*                                                             */ 06468000
*     /***************************************************************/ 06469000
*                                                                  1761 06470000
*     IF TESTRC=4 THEN                                             1761 06471000
@RF01733 C     TESTRC,@CF00047                                     1761 06472000
         BNE   @RF01761                                            1761 06473000
*       CALL SSCMSG(REASONCD);      /* A REAL HDWR ERROR     @Z40LB22*/ 06474000
         LA    @02,REASONCD                                        1762 06475000
         ST    @02,@AL00001                                        1762 06476000
         LA    @01,@AL00001                                        1762 06477000
         BAL   @14,SSCMSG                                          1762 06478000
*     IF TESTRC=4 THEN                                             1763 06479000
@RF01761 C     TESTRC,@CF00047                                     1763 06480000
         BNE   @RF01763                                            1763 06481000
*       DO;                         /* CHECK FOR OTHER ERRORS      1764 06482000
*                                                            @Z40LB22*/ 06483000
*         IF FRSTUSSC=OFF THEN                                     1765 06484000
         TM    FRSTUSSC,B'00000001'                                1765 06485000
         BNZ   @RF01765                                            1765 06486000
*           READRC=LASTCC12;        /* NO REPORTS TO BE PRINTED    1766 06487000
*                                                            @Z40LB22*/ 06488000
         MVC   READRC(2),@CH00571                                  1766 06489000
*         ELSE                                                     1767 06490000
*           READRC=LASTCC08;        /* SOME REPORTS TO BE    @Z40LB22   06491000
*                                      PRINTED               @Z40LB22*/ 06492000
         B     @RC01765                                            1767 06493000
@RF01765 MVC   READRC(2),@CH00184                                  1767 06494000
*         RETURN;                   /*                       @Z40LB25*/ 06495000
@EL00014 DS    0H                                                  1768 06496000
@EF00014 DS    0H                                                  1768 06497000
@ER00014 L     @14,@SA00014                                        1768 06498000
         BR    @14                                                 1768 06499000
*       END;                        /*                       @Z40LB22*/ 06500000
*                                                                  1769 06501000
*     /***************************************************************/ 06502000
*     /*                                                             */ 06503000
*     /* CHECK FOR A LABEL DATA SET                          @Z40LB25*/ 06504000
*     /*                                                             */ 06505000
*     /***************************************************************/ 06506000
*                                                                  1770 06507000
*     IF LABDSPTR^=NULLPTR&LABELRD=ON THEN                         1770 06508000
@RF01763 L     @15,@PC00001+16                                     1770 06509000
         L     @14,LABDSPTR(,@15)                                  1770 06510000
         LTR   @14,@14                                             1770 06511000
         BZ    @RF01770                                            1770 06512000
         TM    LABELRD,B'01000000'                                 1770 06513000
         BNO   @RF01770                                            1770 06514000
*       DO;                         /*                       @Z40LB22*/ 06515000
*         IOCSPTR=LABDSPTR;         /* LABEL DATA SET        @Z40LB25*/ 06516000
         LR    IOCSPTR,@14                                         1772 06517000
*         IOCDAD=ADDR(RECDBUF);     /* ADDR OF RECORD BUFFER @Z40LB22*/ 06518000
         L     @14,@PC00001+8                                      1773 06519000
         L     @01,BLKPTR(,@14)                                    1773 06520000
         LA    @14,RECDBUF(,@01)                                   1773 06521000
         ST    @14,IOCDAD(,IOCSPTR)                                1773 06522000
*         IOCDLN=LENGTH(RECDBUF);   /* LENGTH OF BUFFER      @Z40LB22*/ 06523000
*                                                                  1774 06524000
         MVC   IOCDLN(4,IOCSPTR),@CF01398                          1774 06525000
*         /***********************************************************/ 06526000
*         /*                                                         */ 06527000
*         /* ISSUE THE AMS UPUT MACRO TO PRINT THE LABEL     @Z40LB25*/ 06528000
*         /*                                                         */ 06529000
*         /***********************************************************/ 06530000
*                                                                  1775 06531000
*         CALL IDCIOPT0(GDTTBL,LABDSPTR);/*                  @Z40LB22*/ 06532000
         L     @02,@PC00001                                        1775 06533000
         ST    @02,@AL00001                                        1775 06534000
         ST    @15,@AL00001+4                                      1775 06535000
         MVI   @AL00001+4,X'80'                                    1775 06536000
         L     @15,GDTPUT(,@02)                                    1775 06537000
         LA    @01,@AL00001                                        1775 06538000
         BALR  @14,@15                                             1775 06539000
*         RESPECIFY                                                1776 06540000
*           RTNREG RSTD;                                           1776 06541000
*         TESTRC=RTNREG;                                           1777 06542000
         LR    TESTRC,RTNREG                                       1777 06543000
*         RESPECIFY                                                1778 06544000
*           RTNREG UNRSTD;          /*                       @Z40LB22*/ 06545000
*                                                                  1778 06546000
*         /***********************************************************/ 06547000
*         /*                                                         */ 06548000
*         /* CHECK THE RETURN CODE, IF A NON-ZERO, THEN ZERO @Z40LB22*/ 06549000
*         /* THE LABEL DATA SET POINTER AND RETURN           @Z40LB22*/ 06550000
*         /*                                                         */ 06551000
*         /***********************************************************/ 06552000
*                                                                  1779 06553000
*         IF TESTRC^=0 THEN                                        1779 06554000
         SLR   @02,@02                                             1779 06555000
         CR    TESTRC,@02                                          1779 06556000
         BE    @RF01779                                            1779 06557000
*           LABDSPTR=NULLPTR;       /*                       @Z40LB22*/ 06558000
         L     @03,@PC00001+16                                     1780 06559000
         ST    @02,LABDSPTR(,@03)                                  1780 06560000
*         LABELRD=OFF;              /* OFF FOR NEXT RD       @Z40LB25*/ 06561000
@RF01779 NI    LABELRD,B'10111111'                                 1781 06562000
*       END;                        /*                       @Z40LB22*/ 06563000
*   END;                            /*                       @Z40LB22*/ 06564000
@RF01770 DS    0H                                                  1783 06565000
@DE01669 TM    TERMINAT,B'00100000'                                1783 06566000
         BZ    @DL01669                                            1783 06567000
*   END READ;                       /*                       @Z40LB22*/ 06568000
         B     @EL00014                                            1784 06569000
*                                                                  1785 06570000
*   /*****************************************************************/ 06571000
*   /*                                                               */ 06572000
*   /* PROCEDURE NAME - PRINTRDL                             @Z40LB25*/ 06573000
*   /*                                                       @Z40LB25*/ 06574000
*   /* FUNCTION - HAS THE SUBTITLE AND HEADER PRINTED FOR    @Z40LB25*/ 06575000
*   /* THE CARTRIDGE LABEL INFORMATION PART OF THE           @Z40LB25*/ 06576000
*   /* READ LABEL REPORT. DEPENDING ON WHETHER LIST OR       @Z40LB25*/ 06577000
*   /* NOLIST IS SPECIFIED, THE APPROPRIATE LABEL            @Z40LB25*/ 06578000
*   /* INFORMATION IS PRINTED.                               @Z40LB25*/ 06579000
*   /*                                                       @Z40LB25*/ 06580000
*   /* INPUT -                                               @Z40LB25*/ 06581000
*   /* GDT                                                   @Z40LB25*/ 06582000
*   /* FDT                                                   @Z40LB25*/ 06583000
*   /* RECDBUF (CARTLAB)                                     @Z40LB25*/ 06584000
*   /* X                                                     @Z40LB25*/ 06585000
*   /* Y                                                     @Z40LB25*/ 06586000
*   /* Z                                                     @Z40LB25*/ 06587000
*   /* MSFVAL                                                @Z40LB25*/ 06588000
*   /*                                                       @Z40LB25*/ 06589000
*   /* OUTPUT -                                              @Z40LB25*/ 06590000
*   /* A READ LABEL REPORT SUBTITLE                          @Z40LB25*/ 06591000
*   /* READ LABEL REPORT HEADERS                             @Z40LB25*/ 06592000
*   /*                                                               */ 06593000
*   /*****************************************************************/ 06594000
*                                                                  1785 06595000
*PRINTRDL:                                                         1785 06596000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 06597000
*                                                                  1785 06598000
PRINTRDL ST    @14,@SA00015                                        1785 06599000
*   /*****************************************************************/ 06600000
*   /*                                                               */ 06601000
*   /* SET UP CTOC INFORMATION FOR PRINTING                  @Z40LB25*/ 06602000
*   /*                                                               */ 06603000
*   /*****************************************************************/ 06604000
*                                                                  1786 06605000
*   LABELL=0;                       /* MSF 0                 @Z40LB25*/ 06606000
         MVI   LABELL,X'00'                                        1786 06607000
*   IF CARL1=OFF&CARL2=ON THEN                                     1787 06608000
         L     @02,@PC00001+8                                      1787 06609000
         L     @02,BLKPTR(,@02)                                    1787 06610000
         TM    CARL2(@02),B'01000000'                              1787 06611000
         BNO   @RF01787                                            1787 06612000
         TM    CARL1(@02),B'10000000'                              1787 06613000
         BNZ   @RF01787                                            1787 06614000
*     LABELL=1;                     /* MSF 1                 @Z40LB25*/ 06615000
         MVI   LABELL,X'01'                                        1788 06616000
*   IF CARL1=ON&CARL2=OFF THEN                                     1789 06617000
@RF01787 L     @02,@PC00001+8                                      1789 06618000
         L     @02,BLKPTR(,@02)                                    1789 06619000
         TM    CARL1(@02),B'10000000'                              1789 06620000
         BNO   @RF01789                                            1789 06621000
         TM    CARL2(@02),B'01000000'                              1789 06622000
         BNZ   @RF01789                                            1789 06623000
*     LABELL=2;                     /*                       @Z40LB25*/ 06624000
         MVI   LABELL,X'02'                                        1790 06625000
*   IF CARL1=ON&CARL2=ON THEN                                      1791 06626000
@RF01789 L     @02,@PC00001+8                                      1791 06627000
         L     @02,BLKPTR(,@02)                                    1791 06628000
         TM    CARL1(@02),B'11000000'                              1791 06629000
         BNO   @RF01791                                            1791 06630000
*     LABELL=3;                     /*                       @Z40LB25*/ 06631000
         MVI   LABELL,X'03'                                        1792 06632000
*   LABELZ=0;                       /* Z LOC = 0             @Z40LB25*/ 06633000
@RF01791 MVI   LABELZ,X'00'                                        1793 06634000
*   IF CARADDRZ=ON THEN                                            1794 06635000
         L     @02,@PC00001+8                                      1794 06636000
         L     @02,BLKPTR(,@02)                                    1794 06637000
         TM    CARADDRZ(@02),B'00100000'                           1794 06638000
         BNO   @RF01794                                            1794 06639000
*     LABELZ=1;                     /* Z LOC = 1             @Z40LB25*/ 06640000
         MVI   LABELZ,X'01'                                        1795 06641000
*   LABELY=ANDY&CARADDR(1:8);       /* Y LOC                 @Z40LB25*/ 06642000
@RF01794 L     @02,@PC00001+8                                      1796 06643000
         L     @02,BLKPTR(,@02)                                    1796 06644000
         SLR   @15,@15                                             1796 06645000
         IC    @15,ANDY                                            1796 06646000
         SLR   @14,@14                                             1796 06647000
         IC    @14,CARADDR(,@02)                                   1796 06648000
         NR    @15,@14                                             1796 06649000
         STC   @15,LABELY                                          1796 06650000
*   LABELX=CARADDRX;                /* X LOC                 @Z40LB25*/ 06651000
*                                                                  1797 06652000
         SLR   @14,@14                                             1797 06653000
         IC    @14,CARADDRX(,@02)                                  1797 06654000
         STC   @14,LABELX                                          1797 06655000
*   /*****************************************************************/ 06656000
*   /*                                                               */ 06657000
*   /* CHECK FOR NOLIST WITH A DESCREPANCY                   @Z40LB25*/ 06658000
*   /*                                                               */ 06659000
*   /*****************************************************************/ 06660000
*                                                                  1798 06661000
*   IF ADDR(NLIST)^=NULLPTR&(LABELL^=MSFVAL|LABELZ^=Z|LABELY^=Y|LABELX  06662000
*       ^=X) THEN                                                  1798 06663000
         L     @02,@PC00001+4                                      1798 06664000
         L     @07,FDTPTR+68(,@02)                                 1798 06665000
         LTR   @07,@07                                             1798 06666000
         BZ    @RF01798                                            1798 06667000
         L     @02,FDTPTR+24(,@02)                                 1798 06668000
         SLR   @07,@07                                             1798 06669000
         IC    @07,LABELL                                          1798 06670000
         C     @07,MSFVAL(,@02)                                    1798 06671000
         BNE   @RT01798                                            1798 06672000
         SLR   @02,@02                                             1798 06673000
         IC    @02,LABELZ                                          1798 06674000
         CH    @02,Z                                               1798 06675000
         BNE   @RT01798                                            1798 06676000
         C     @15,Y                                               1798 06677000
         BNE   @RT01798                                            1798 06678000
         CH    @14,X                                               1798 06679000
         BE    @RF01798                                            1798 06680000
@RT01798 DS    0H                                                  1799 06681000
*     DO;                           /*                       @Z40LB25*/ 06682000
*                                                                  1799 06683000
*       /*************************************************************/ 06684000
*       /*                                                           */ 06685000
*       /* NEED TO PRINT SUBTITLE AND HEADERS?               @Z40LB25*/ 06686000
*       /*                                                           */ 06687000
*       /*************************************************************/ 06688000
*                                                                  1800 06689000
*       IF RDTITLE=OFF THEN                                        1800 06690000
         TM    RDTITLE,B'00001000'                                 1800 06691000
         BNZ   @RF01800                                            1800 06692000
*         DO;                       /*                       @Z40LB25*/ 06693000
*           IF ADDR(XRNG)^=NULLPTR THEN                            1802 06694000
         L     @02,@PC00001+4                                      1802 06695000
         L     @02,FDTPTR+28(,@02)                                 1802 06696000
         LTR   @02,@02                                             1802 06697000
         BZ    @RF01802                                            1802 06698000
*             HDRDID17=ON;          /*                       @Z40LB25*/ 06699000
         OI    HDRDID17,B'10000000'                                1803 06700000
*           IF ADDR(CELL)^=NULLPTR THEN                            1804 06701000
@RF01802 L     @02,@PC00001+4                                      1804 06702000
         L     @02,FDTPTR+40(,@02)                                 1804 06703000
         LTR   @02,@02                                             1804 06704000
         BZ    @RF01804                                            1804 06705000
*             HDRDID19=ON;          /*                       @Z40LB25*/ 06706000
*                                                                  1805 06707000
         OI    HDRDID19,B'00100000'                                1805 06708000
*           /*********************************************************/ 06709000
*           /*                                                       */ 06710000
*           /* PRINT THE SUBTITLE                            @Z40LB25*/ 06711000
*           /*                                                       */ 06712000
*           /*********************************************************/ 06713000
*                                                                  1806 06714000
*           CALL HEADSET;           /*                       @Z40LB25*/ 06715000
@RF01804 BAL   @14,HEADSET                                         1806 06716000
*           RDTITLE=ON;             /*                       @Z40LB25*/ 06717000
         OI    RDTITLE,B'00001000'                                 1807 06718000
*         END;                      /*                       @Z40LB25*/ 06719000
*                                                                  1808 06720000
*       /*************************************************************/ 06721000
*       /*                                                           */ 06722000
*       /* CHECK IF HEADERS TO BE PRINTED                    @Z40LB25*/ 06723000
*       /*                                                           */ 06724000
*       /*************************************************************/ 06725000
*                                                                  1809 06726000
*       IF RDHEAD=OFF THEN                                         1809 06727000
@RF01800 TM    RDHEAD,B'00000100'                                  1809 06728000
         BNZ   @RF01809                                            1809 06729000
*         DO;                       /*                       @Z40LB25*/ 06730000
*           HDRDID38=ON;            /*                       @Z40LB25*/ 06731000
*                                                                  1811 06732000
         OI    HDRDID38,B'10000000'                                1811 06733000
*           /*********************************************************/ 06734000
*           /*                                                       */ 06735000
*           /* PRINT HEADERS                                 @Z40LB25*/ 06736000
*           /*                                                       */ 06737000
*           /*********************************************************/ 06738000
*                                                                  1812 06739000
*           CALL HEADSET;           /*                       @Z40LB25*/ 06740000
         BAL   @14,HEADSET                                         1812 06741000
*           RDHEAD=ON;              /*                       @Z40LB25*/ 06742000
         OI    RDHEAD,B'00000100'                                  1813 06743000
*           RLBLPRTD=ON;            /* LABEL WAS PRINTED     @Z40LB25*/ 06744000
         OI    RLBLPRTD,B'10000000'                                1814 06745000
*         END;                      /*                       @Z40LB25*/ 06746000
*                                                                  1815 06747000
*       /*************************************************************/ 06748000
*       /*                                                           */ 06749000
*       /* PRINT THE LABEL                                   @Z40LB25*/ 06750000
*       /*                                                           */ 06751000
*       /*************************************************************/ 06752000
*                                                                  1816 06753000
*       CALL PRTLABEL;              /*                       @Z40LB25*/ 06754000
@RF01809 BAL   @14,PRTLABEL                                        1816 06755000
*     END;                          /*                       @Z40LB25*/ 06756000
*                                                                  1817 06757000
*   /*****************************************************************/ 06758000
*   /*                                                               */ 06759000
*   /* CHECK FOR LIST                                        @Z40LB25*/ 06760000
*   /*                                                               */ 06761000
*   /*****************************************************************/ 06762000
*                                                                  1818 06763000
*   IF ADDR(LIST)^=NULLPTR THEN                                    1818 06764000
@RF01798 SLR   @02,@02                                             1818 06765000
         L     @15,@PC00001+4                                      1818 06766000
         C     @02,FDTPTR+64(,@15)                                 1818 06767000
         BE    @RF01818                                            1818 06768000
*     DO;                           /*                       @Z40LB25*/ 06769000
*                                                                  1819 06770000
*       /*************************************************************/ 06771000
*       /*                                                           */ 06772000
*       /* NEED TO PRINT SUBTITLE AND HEADERS?               @Z40LB25*/ 06773000
*       /*                                                           */ 06774000
*       /*************************************************************/ 06775000
*                                                                  1820 06776000
*       IF RDTITLE=OFF THEN                                        1820 06777000
         TM    RDTITLE,B'00001000'                                 1820 06778000
         BNZ   @RF01820                                            1820 06779000
*         DO;                       /*                       @Z40LB25*/ 06780000
*           IF ADDR(XRNG)^=NULLPTR THEN                            1822 06781000
         C     @02,FDTPTR+28(,@15)                                 1822 06782000
         BE    @RF01822                                            1822 06783000
*             HDRDID18=ON;          /*                       @Z40LB25*/ 06784000
         OI    HDRDID18,B'01000000'                                1823 06785000
*           IF ADDR(CELL)^=NULLPTR THEN                            1824 06786000
@RF01822 L     @02,@PC00001+4                                      1824 06787000
         L     @02,FDTPTR+40(,@02)                                 1824 06788000
         LTR   @02,@02                                             1824 06789000
         BZ    @RF01824                                            1824 06790000
*             HDRDID35=ON;          /*                       @Z40LB25*/ 06791000
*                                                                  1825 06792000
         OI    HDRDID35,B'00010000'                                1825 06793000
*           /*********************************************************/ 06794000
*           /*                                                       */ 06795000
*           /* PRINT THE SUBTITLE                            @Z40LB25*/ 06796000
*           /*                                                       */ 06797000
*           /*********************************************************/ 06798000
*                                                                  1826 06799000
*           CALL HEADSET;           /*                       @Z40LB25*/ 06800000
@RF01824 BAL   @14,HEADSET                                         1826 06801000
*           RDTITLE=ON;             /*                       @Z40LB25*/ 06802000
         OI    RDTITLE,B'00001000'                                 1827 06803000
*         END;                      /*                       @Z40LB25*/ 06804000
*                                                                  1828 06805000
*       /*************************************************************/ 06806000
*       /*                                                           */ 06807000
*       /* CHECK IF HEADERS TO BE PRINTED                    @Z40LB25*/ 06808000
*       /*                                                           */ 06809000
*       /*************************************************************/ 06810000
*                                                                  1829 06811000
*       IF RDHEAD=OFF THEN                                         1829 06812000
@RF01820 TM    RDHEAD,B'00000100'                                  1829 06813000
         BNZ   @RF01829                                            1829 06814000
*         DO;                       /*                       @Z40LB25*/ 06815000
*           HDRDID39=ON;            /*                       @Z40LB25*/ 06816000
*                                                                  1831 06817000
         OI    HDRDID39,B'10000000'                                1831 06818000
*           /*********************************************************/ 06819000
*           /*                                                       */ 06820000
*           /* PRINT HEADERS                                 @Z40LB25*/ 06821000
*           /*                                                       */ 06822000
*           /*********************************************************/ 06823000
*                                                                  1832 06824000
*           CALL HEADSET;           /*                       @Z40LB25*/ 06825000
         BAL   @14,HEADSET                                         1832 06826000
*           RDHEAD=ON;              /*                       @Z40LB25*/ 06827000
         OI    RDHEAD,B'00000100'                                  1833 06828000
*           RLBLPRTD=ON;            /* LABEL WAS PRINTED     @Z40LB25*/ 06829000
         OI    RLBLPRTD,B'10000000'                                1834 06830000
*         END;                      /*                       @Z40LB25*/ 06831000
*                                                                  1835 06832000
*       /*************************************************************/ 06833000
*       /*                                                           */ 06834000
*       /* PRINT THE LABEL                                   @Z40LB25*/ 06835000
*       /*                                                           */ 06836000
*       /*************************************************************/ 06837000
*                                                                  1836 06838000
*       CALL PRTLABEL;              /*                       @Z40LB25*/ 06839000
@RF01829 BAL   @14,PRTLABEL                                        1836 06840000
*     END;                          /*                       @Z40LB25*/ 06841000
*   RETURN;                         /*                       @Z40LB25*/ 06842000
@EL00015 DS    0H                                                  1838 06843000
@EF00015 DS    0H                                                  1838 06844000
@ER00015 L     @14,@SA00015                                        1838 06845000
         BR    @14                                                 1838 06846000
*   END PRINTRDL;                   /*                       @Z40LB25*/ 06847000
         B     @EL00015                                            1839 06848000
*                                                                  1840 06849000
*   /*****************************************************************/ 06850000
*   /*                                                               */ 06851000
*   /* PROCEDURE NAME - PRTLABEL                             @Z40LB25*/ 06852000
*   /*                                                       @Z40LB25*/ 06853000
*   /* FUNCTION - FORMATS AND PRINTS THE CARTRIDGE LABEL     @Z40LB25*/ 06854000
*   /* FOR OCCUPIED CELLS OR CARTRIDGE LABELS                @Z40LB25*/ 06855000
*   /* CONTAINING INCORRECT CELL LOCATIONS.                  @Z40LB25*/ 06856000
*   /*                                                       @Z40LB25*/ 06857000
*   /* INPUT -                                               @Z40LB25*/ 06858000
*   /* GDT                                                   @Z40LB25*/ 06859000
*   /* FDT                                                   @Z40LB25*/ 06860000
*   /* RECDBUF (CARTLAB)                                     @Z40LB25*/ 06861000
*   /* X                                                     @Z40LB25*/ 06862000
*   /* Y                                                     @Z40LB25*/ 06863000
*   /* Z                                                     @Z40LB25*/ 06864000
*   /*                                                       @Z40LB25*/ 06865000
*   /* OUTPUT -                                              @Z40LB25*/ 06866000
*   /* A READ LABEL REPORT ENTRY FOR SECTION -               @Z40LB25*/ 06867000
*   /* OCCUPIED CELLS OR                                     @Z40LB25*/ 06868000
*   /* CARTRIDGE LABELS CONTAINING INCORRECT                 @Z40LB25*/ 06869000
*   /* CELL LOCATIONS                                        @Z40LB25*/ 06870000
*   /*                                                               */ 06871000
*   /*****************************************************************/ 06872000
*                                                                  1840 06873000
*PRTLABEL:                                                         1840 06874000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB25*/ 06875000
PRTLABEL ST    @14,@SA00016                                        1840 06876000
*   PRINTAB=''B;                    /*                       @Z40LB25*/ 06877000
         XC    PRINTAB(164),PRINTAB                                1841 06878000
*   DARGCNT=13;                     /*                       @Z40LB25*/ 06879000
         L     @02,DDSTRU                                          1842 06880000
         MVC   DARGCNT(2,@02),@CH01099                             1842 06881000
*   DARGSMOD=AUDMSG;                /*                       @Z40LB25*/ 06882000
         MVC   DARGSMOD(3,@02),@CC01440                            1843 06883000
*   DARGSENT=LABELS;                /*                       @Z40LB25*/ 06884000
*                                                                  1844 06885000
         MVI   DARGSENT(@02),X'30'                                 1844 06886000
*   /*****************************************************************/ 06887000
*   /*                                                               */ 06888000
*   /* USER REQUESTED X                                      @Z40LB25*/ 06889000
*   /*                                                               */ 06890000
*   /*****************************************************************/ 06891000
*                                                                  1845 06892000
*   DARGINS(1)=1;                   /*                       @Z40LB25*/ 06893000
         LA    @15,1                                               1845 06894000
         STH   @15,DARGINS(,@02)                                   1845 06895000
*   DARGINL(1)=LENGTH(X);           /*                       @Z40LB25*/ 06896000
         LA    @14,2                                               1846 06897000
         STH   @14,DARGINL(,@02)                                   1846 06898000
*   DARGDTM(1)=ADDR(X);             /*                       @Z40LB25*/ 06899000
*                                                                  1847 06900000
         LA    @07,X                                               1847 06901000
         ST    @07,DARGDTM(,@02)                                   1847 06902000
*   /*****************************************************************/ 06903000
*   /*                                                               */ 06904000
*   /* USER REQUESTED Y                                      @Z40LB25*/ 06905000
*   /*                                                               */ 06906000
*   /*****************************************************************/ 06907000
*                                                                  1848 06908000
*   DARGINS(2)=2;                   /*                       @Z40LB25*/ 06909000
         STH   @14,DARGINS+8(,@02)                                 1848 06910000
*   DARGINL(2)=LENGTH(Y);           /*                       @Z40LB25*/ 06911000
         LA    @07,4                                               1849 06912000
         STH   @07,DARGINL+8(,@02)                                 1849 06913000
*   DARGDTM(2)=ADDR(Y);             /*                       @Z40LB25*/ 06914000
*                                                                  1850 06915000
         LA    @06,Y                                               1850 06916000
         ST    @06,DARGDTM+8(,@02)                                 1850 06917000
*   /*****************************************************************/ 06918000
*   /*                                                               */ 06919000
*   /* USER REQUESTED Z                                      @Z40LB25*/ 06920000
*   /*                                                               */ 06921000
*   /*****************************************************************/ 06922000
*                                                                  1851 06923000
*   DARGINS(3)=3;                   /*                       @Z40LB25*/ 06924000
         MVC   DARGINS+16(2,@02),@CH00167                          1851 06925000
*   DARGINL(3)=LENGTH(Z);           /*                       @Z40LB25*/ 06926000
         STH   @14,DARGINL+16(,@02)                                1852 06927000
*   DARGDTM(3)=ADDR(Z);             /*                       @Z40LB25*/ 06928000
*                                                                  1853 06929000
         LA    @14,Z                                               1853 06930000
         ST    @14,DARGDTM+16(,@02)                                1853 06931000
*   /*****************************************************************/ 06932000
*   /*                                                               */ 06933000
*   /* MISMATCH?                                             @Z40LB25*/ 06934000
*   /*                                                               */ 06935000
*   /*****************************************************************/ 06936000
*                                                                  1854 06937000
*   DARGINS(4)=4;                   /*                       @Z40LB25*/ 06938000
         STH   @07,DARGINS+24(,@02)                                1854 06939000
*   DARGINL(4)=LENGTH(ASTERIC);     /*                       @Z40LB25*/ 06940000
         STH   @15,DARGINL+24(,@02)                                1855 06941000
*   IF ADDR(LIST)^=NULLPTR&(LABELL^=MSFVAL|LABELZ^=Z|LABELY^=Y|LABELX^= 06942000
*       X) THEN                                                    1856 06943000
         L     @02,@PC00001+4                                      1856 06944000
         L     @15,FDTPTR+64(,@02)                                 1856 06945000
         LTR   @15,@15                                             1856 06946000
         BZ    @RF01856                                            1856 06947000
         L     @02,FDTPTR+24(,@02)                                 1856 06948000
         SLR   @15,@15                                             1856 06949000
         IC    @15,LABELL                                          1856 06950000
         C     @15,MSFVAL(,@02)                                    1856 06951000
         BNE   @RT01856                                            1856 06952000
         SLR   @02,@02                                             1856 06953000
         IC    @02,LABELZ                                          1856 06954000
         CH    @02,Z                                               1856 06955000
         BNE   @RT01856                                            1856 06956000
         SLR   @02,@02                                             1856 06957000
         IC    @02,LABELY                                          1856 06958000
         C     @02,Y                                               1856 06959000
         BNE   @RT01856                                            1856 06960000
         SLR   @02,@02                                             1856 06961000
         IC    @02,LABELX                                          1856 06962000
         CH    @02,X                                               1856 06963000
         BE    @RF01856                                            1856 06964000
@RT01856 DS    0H                                                  1857 06965000
*     DARGDTM(4)=ADDR(ASTERIC);     /*                       @Z40LB25*/ 06966000
         LA    @02,ASTERIC                                         1857 06967000
         L     @01,DDSTRU                                          1857 06968000
         ST    @02,DARGDTM+24(,@01)                                1857 06969000
*   ELSE                                                           1858 06970000
*     DARGDTM(4)=ADDR(BLANK);       /*                       @Z40LB25*/ 06971000
*                                                                  1858 06972000
         B     @RC01856                                            1858 06973000
@RF01856 LA    @02,BLANK                                           1858 06974000
         L     @01,DDSTRU                                          1858 06975000
         ST    @02,DARGDTM+24(,@01)                                1858 06976000
*   /*****************************************************************/ 06977000
*   /*                                                               */ 06978000
*   /* CTOC X                                                @Z40LB25*/ 06979000
*   /*                                                               */ 06980000
*   /*****************************************************************/ 06981000
*                                                                  1859 06982000
*   DARGINS(5)=5;                   /*                       @Z40LB25*/ 06983000
@RC01856 L     @02,DDSTRU                                          1859 06984000
         MVC   DARGINS+32(2,@02),@CH00291                          1859 06985000
*   DARGINL(5)=LENGTH(LABELX);      /*                       @Z40LB25*/ 06986000
         LA    @15,1                                               1860 06987000
         STH   @15,DARGINL+32(,@02)                                1860 06988000
*   DARGDTM(5)=ADDR(LABELX);        /*                       @Z40LB25*/ 06989000
*                                                                  1861 06990000
         LA    @14,LABELX                                          1861 06991000
         ST    @14,DARGDTM+32(,@02)                                1861 06992000
*   /*****************************************************************/ 06993000
*   /*                                                               */ 06994000
*   /* CTOC Y                                                @Z40LB25*/ 06995000
*   /*                                                               */ 06996000
*   /*****************************************************************/ 06997000
*                                                                  1862 06998000
*   DARGINS(6)=6;                   /*                       @Z40LB25*/ 06999000
         MVC   DARGINS+40(2,@02),@CH00161                          1862 07000000
*   DARGINL(6)=LENGTH(LABELY);      /*                       @Z40LB25*/ 07001000
         STH   @15,DARGINL+40(,@02)                                1863 07002000
*   DARGDTM(6)=ADDR(LABELY);        /*                       @Z40LB25*/ 07003000
*                                                                  1864 07004000
         LA    @14,LABELY                                          1864 07005000
         ST    @14,DARGDTM+40(,@02)                                1864 07006000
*   /*****************************************************************/ 07007000
*   /*                                                               */ 07008000
*   /* CTOC Z                                                @Z40LB25*/ 07009000
*   /*                                                               */ 07010000
*   /*****************************************************************/ 07011000
*                                                                  1865 07012000
*   DARGINS(7)=7;                   /*                       @Z40LB25*/ 07013000
         MVC   DARGINS+48(2,@02),@CH00663                          1865 07014000
*   DARGINL(7)=LENGTH(LABELZ);      /*                       @Z40LB25*/ 07015000
         STH   @15,DARGINL+48(,@02)                                1866 07016000
*   DARGDTM(7)=ADDR(LABELZ);        /*                       @Z40LB25*/ 07017000
*                                                                  1867 07018000
         LA    @14,LABELZ                                          1867 07019000
         ST    @14,DARGDTM+48(,@02)                                1867 07020000
*   /*****************************************************************/ 07021000
*   /*                                                               */ 07022000
*   /* CTOC MSF                                              @Z40LB25*/ 07023000
*   /*                                                               */ 07024000
*   /*****************************************************************/ 07025000
*                                                                  1868 07026000
*   DARGINS(8)=8;                   /*                       @Z40LB25*/ 07027000
         MVC   DARGINS+56(2,@02),@CH00184                          1868 07028000
*   DARGINL(8)=LENGTH(LABELL);      /*                       @Z40LB25*/ 07029000
         STH   @15,DARGINL+56(,@02)                                1869 07030000
*   DARGDTM(8)=ADDR(LABELL);        /*                       @Z40LB25*/ 07031000
*                                                                  1870 07032000
         LA    @15,LABELL                                          1870 07033000
         ST    @15,DARGDTM+56(,@02)                                1870 07034000
*   /*****************************************************************/ 07035000
*   /*                                                               */ 07036000
*   /* CTOC CSN1                                             @Z40LB25*/ 07037000
*   /*                                                               */ 07038000
*   /*****************************************************************/ 07039000
*                                                                  1871 07040000
*   DARGINS(9)=9;                   /*                       @Z40LB25*/ 07041000
         MVC   DARGINS+64(2,@02),@CH01086                          1871 07042000
*   DARGINL(9)=LENGTH(CARCSN1);     /*                       @Z40LB25*/ 07043000
         LA    @15,12                                              1872 07044000
         STH   @15,DARGINL+64(,@02)                                1872 07045000
*   DARGDTM(9)=ADDR(CARCSN1);       /*                       @Z40LB25*/ 07046000
*                                                                  1873 07047000
         L     @14,@PC00001+8                                      1873 07048000
         L     @14,BLKPTR(,@14)                                    1873 07049000
         LA    @07,CARCSN1(,@14)                                   1873 07050000
         ST    @07,DARGDTM+64(,@02)                                1873 07051000
*   /*****************************************************************/ 07052000
*   /*                                                               */ 07053000
*   /* CTOC CSN2, IF VALID                                   @Z40LB25*/ 07054000
*   /*                                                               */ 07055000
*   /*****************************************************************/ 07056000
*                                                                  1874 07057000
*   DARGINS(10)=10;                 /*                       @Z40LB25*/ 07058000
         MVC   DARGINS+72(2,@02),@CH00449                          1874 07059000
*   DARGINL(10)=LENGTH(CARCSN2);    /*                       @Z40LB25*/ 07060000
         STH   @15,DARGINL+72(,@02)                                1875 07061000
*   IF CARSEQ='2'|CARTSCRC=ON|CARTCE=ON THEN                       1876 07062000
         CLI   CARSEQ(@14),C'2'                                    1876 07063000
         BE    @RT01876                                            1876 07064000
         TM    CARTSCRC(@14),B'10001000'                           1876 07065000
         BZ    @RF01876                                            1876 07066000
@RT01876 DS    0H                                                  1877 07067000
*     DARGDTM(10)=ADDR(BLANK12);    /*                       @Z40LB25*/ 07068000
         LA    @02,BLANK12                                         1877 07069000
         L     @01,DDSTRU                                          1877 07070000
         ST    @02,DARGDTM+72(,@01)                                1877 07071000
*   ELSE                                                           1878 07072000
*     DARGDTM(10)=ADDR(CARCSN2);    /*                       @Z40LB25*/ 07073000
*                                                                  1878 07074000
         B     @RC01876                                            1878 07075000
@RF01876 L     @02,@PC00001+8                                      1878 07076000
         L     @02,BLKPTR(,@02)                                    1878 07077000
         LA    @02,CARCSN2(,@02)                                   1878 07078000
         L     @01,DDSTRU                                          1878 07079000
         ST    @02,DARGDTM+72(,@01)                                1878 07080000
*   /*****************************************************************/ 07081000
*   /*                                                               */ 07082000
*   /* CTOC SEQUENCE NUMBER                                  @Z40LB25*/ 07083000
*   /*                                                               */ 07084000
*   /*****************************************************************/ 07085000
*                                                                  1879 07086000
*   DARGINS(11)=11;                 /*                       @Z40LB25*/ 07087000
@RC01876 L     @02,DDSTRU                                          1879 07088000
         MVC   DARGINS+80(2,@02),@CH01093                          1879 07089000
*   DARGINL(11)=LENGTH(CARSEQ);     /*                       @Z40LB25*/ 07090000
         MVC   DARGINL+80(2,@02),@CH00224                          1880 07091000
*   IF CARTSCRC=ON|CARTCE=ON THEN                                  1881 07092000
         L     @15,@PC00001+8                                      1881 07093000
         L     @01,BLKPTR(,@15)                                    1881 07094000
         TM    CARTSCRC(@01),B'10001000'                           1881 07095000
         BZ    @RF01881                                            1881 07096000
*     DARGDTM(11)=ADDR(BLANK);      /*                       @Z40LB25*/ 07097000
         LA    @15,BLANK                                           1882 07098000
         ST    @15,DARGDTM+80(,@02)                                1882 07099000
*   ELSE                                                           1883 07100000
*     DARGDTM(11)=ADDR(CARSEQ);     /*                       @Z40LB25*/ 07101000
*                                                                  1883 07102000
         B     @RC01881                                            1883 07103000
@RF01881 L     @02,@PC00001+8                                      1883 07104000
         L     @02,BLKPTR(,@02)                                    1883 07105000
         LA    @02,CARSEQ(,@02)                                    1883 07106000
         L     @01,DDSTRU                                          1883 07107000
         ST    @02,DARGDTM+80(,@01)                                1883 07108000
*   /*****************************************************************/ 07109000
*   /*                                                               */ 07110000
*   /* CTOC VOLID, IF VALID                                  @Z40LB25*/ 07111000
*   /*                                                               */ 07112000
*   /*****************************************************************/ 07113000
*                                                                  1884 07114000
*   DARGINS(12)=12;                 /*                       @Z40LB25*/ 07115000
@RC01881 L     @02,DDSTRU                                          1884 07116000
         MVC   DARGINS+88(2,@02),@CH00571                          1884 07117000
*   DARGINL(12)=LENGTH(CARVOLID);   /*                       @Z40LB25*/ 07118000
         MVC   DARGINL+88(2,@02),@CH00161                          1885 07119000
*   IF CARTSCRC=ON THEN                                            1886 07120000
         L     @15,@PC00001+8                                      1886 07121000
         L     @01,BLKPTR(,@15)                                    1886 07122000
         TM    CARTSCRC(@01),B'00001000'                           1886 07123000
         BNO   @RF01886                                            1886 07124000
*     DARGDTM(12)=ADDR(BLANK6);     /*                       @Z40LB25*/ 07125000
         LA    @15,BLANK6                                          1887 07126000
         ST    @15,DARGDTM+88(,@02)                                1887 07127000
*   ELSE                                                           1888 07128000
*     DARGDTM(12)=ADDR(CARVOLID);   /*                       @Z40LB25*/ 07129000
*                                                                  1888 07130000
         B     @RC01886                                            1888 07131000
@RF01886 L     @02,@PC00001+8                                      1888 07132000
         L     @02,BLKPTR(,@02)                                    1888 07133000
         LA    @02,CARVOLID(,@02)                                  1888 07134000
         L     @01,DDSTRU                                          1888 07135000
         ST    @02,DARGDTM+88(,@01)                                1888 07136000
*   /*****************************************************************/ 07137000
*   /*                                                               */ 07138000
*   /* CTOC VOLUME TYPE, IF NECESSARY                        @Z40LB25*/ 07139000
*   /*                                                               */ 07140000
*   /*****************************************************************/ 07141000
*                                                                  1889 07142000
*   DARGINS(13)=13;                 /*                       @Z40LB25*/ 07143000
@RC01886 L     @02,DDSTRU                                          1889 07144000
         MVC   DARGINS+96(2,@02),@CH01099                          1889 07145000
*   DARGINL(13)=LENGTH(SCRCART);    /*                       @Z40LB25*/ 07146000
         MVC   DARGINL+96(2,@02),@CH00047                          1890 07147000
*   DARGDTM(13)=ADDR(BLANK4);       /*                       @Z40LB25*/ 07148000
         LA    @15,BLANK4                                          1891 07149000
         ST    @15,DARGDTM+96(,@02)                                1891 07150000
*   IF CARTSCRC=ON THEN                                            1892 07151000
         L     @15,@PC00001+8                                      1892 07152000
         L     @01,BLKPTR(,@15)                                    1892 07153000
         TM    CARTSCRC(@01),B'00001000'                           1892 07154000
         BNO   @RF01892                                            1892 07155000
*     DARGDTM(13)=ADDR(SCRCART);    /*                       @Z40LB25*/ 07156000
         LA    @15,SCRCART                                         1893 07157000
         ST    @15,DARGDTM+96(,@02)                                1893 07158000
*   IF CARTCE=ON THEN                                              1894 07159000
@RF01892 L     @02,@PC00001+8                                      1894 07160000
         L     @02,BLKPTR(,@02)                                    1894 07161000
         TM    CARTCE(@02),B'10000000'                             1894 07162000
         BNO   @RF01894                                            1894 07163000
*     DARGDTM(13)=ADDR(CECART);     /*                       @Z40LB25*/ 07164000
*                                                                  1895 07165000
         LA    @02,CECART                                          1895 07166000
         L     @01,DDSTRU                                          1895 07167000
         ST    @02,DARGDTM+96(,@01)                                1895 07168000
*   /*****************************************************************/ 07169000
*   /*                                                               */ 07170000
*   /* PRINT THE LABEL INFORMATION                           @Z40LB25*/ 07171000
*   /*                                                               */ 07172000
*   /*****************************************************************/ 07173000
*                                                                  1896 07174000
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Z40LB25*/ 07175000
@RF01894 L     @02,@PC00001                                        1896 07176000
         ST    @02,@AL00001                                        1896 07177000
         L     @15,@PC00001+12                                     1896 07178000
         ST    @15,@AL00001+4                                      1896 07179000
         LA    @15,DDSTRU                                          1896 07180000
         ST    @15,@AL00001+8                                      1896 07181000
         MVI   @AL00001+8,X'80'                                    1896 07182000
         L     @15,GDTPRT(,@02)                                    1896 07183000
         LA    @01,@AL00001                                        1896 07184000
         BALR  @14,@15                                             1896 07185000
*   RETURN;                         /*                       @Z40LB25*/ 07186000
@EL00016 DS    0H                                                  1897 07187000
@EF00016 DS    0H                                                  1897 07188000
@ER00016 L     @14,@SA00016                                        1897 07189000
         BR    @14                                                 1897 07190000
*   END PRTLABEL;                   /*                       @Z40LB25*/ 07191000
*                                                                  1899 07192000
*   /*****************************************************************/ 07193000
*   /*                                                               */ 07194000
*   /* PROCEDURE NAME - HEADSET                              @Z40LB22*/ 07195000
*   /*                                                       @Z40LB22*/ 07196000
*   /* FUNCTION - THIS ROUTINE ESTABLISHES THE SUB-          @Z40LB22*/ 07197000
*   /* TITLE AND HEADER LINES REQUIRED                       @Z40LB22*/ 07198000
*   /* FOR THE CHECK OR READ LABEL REPORT                    @Z40LB22*/ 07199000
*   /*                                                       @Z40LB22*/ 07200000
*   /* INPUT - A PARAMETER LIST, IDENTIFING THE              @Z40LB22*/ 07201000
*   /* TYPE OF REPORT DESIRED AND THE SUB-                   @Z40LB22*/ 07202000
*   /* TITLE AND HEADER LINES REQUIRED.                      @Z40LB22*/ 07203000
*   /*                                                       @Z40LB22*/ 07204000
*   /* NOTE 1. TO GET A CHECK REPORT, HDCKPTR (A             @Z40LB22*/ 07205000
*   /* POINTER) MUST BE INITIALIZED                          @Z40LB22*/ 07206000
*   /* (HDCKPTR=ADDR(HDSETCK)).                              @Z40LB22*/ 07207000
*   /*                                                       @Z40LB22*/ 07208000
*   /* NOTE 2. TO GET A READ LABEL REPORT,                   @Z40LB22*/ 07209000
*   /* HDRDPTR (A POINTER) MUST BE                           @Z40LB22*/ 07210000
*   /* INITIALIZED (HDRDPTR=ADDR                             @Z40LB22*/ 07211000
*   /* (HDSETRD)).                                           @Z40LB22*/ 07212000
*   /*                                                       @Z40LB22*/ 07213000
*   /* OUTPUT - A HEXADECIMAL PRINT OF STATIC TEXT           @Z40LB22*/ 07214000
*   /* MESSAGES IDENTIFIED BY THE INPUT                      @Z40LB22*/ 07215000
*   /* PARAMETER LIST.                                       @Z40LB22*/ 07216000
*   /*                                                       @Z40LB22*/ 07217000
*   /* NOTE 1. THE APPLICABLE STIDS LOCATED IN               @Z40LB22*/ 07218000
*   /* IDCTSAU0 ARE AS FOLLOWS -                             @Z40LB22*/ 07219000
*   /*                                                       @Z40LB22*/ 07220000
*   /* A. FOR THE CHECK REPORT -                             @Z40LB22*/ 07221000
*   /* TXT11, TXT12, TXT13, TXT14, TXT15                     @Z40LB22*/ 07222000
*   /*                                                       @Z40LB22*/ 07223000
*   /* B. FOR THE READLABEL REPORT -                         @Z40LB22*/ 07224000
*   /* TXT16, TXT17, TXT18, TXT19, TXT35                     @Z40LB22*/ 07225000
*   /* TXT36, TXT37, TXT38, TXT39                            @Z40LB22*/ 07226000
*   /*                                                               */ 07227000
*   /*****************************************************************/ 07228000
*                                                                  1899 07229000
*HEADSET:                                                          1899 07230000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB22*/ 07231000
*                                                                  1899 07232000
HEADSET  ST    @14,@SA00017                                        1899 07233000
*   /*****************************************************************/ 07234000
*   /*                                                               */ 07235000
*   /* TEST FOR THE CALLER SPECIFIED READ LABEL REPORT       @Z40LB22*/ 07236000
*   /*                                                               */ 07237000
*   /*****************************************************************/ 07238000
*                                                                  1900 07239000
*   IF HDRDPTR^=NULLPTR THEN                                       1900 07240000
         L     @02,HDRDPTR                                         1900 07241000
         LTR   @02,@02                                             1900 07242000
         BZ    @RF01900                                            1900 07243000
*     DO;                           /*                       @Z40LB22*/ 07244000
*       IF HDSRDSTL^=STMASK THEN    /* CHECK FOR SUBTITLE    @Z40LB22*/ 07245000
         CLI   HDSRDSTL,X'00'                                      1902 07246000
         BE    @RF01902                                            1902 07247000
*         DO;                       /*                       @Z40LB22*/ 07248000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/ 07249000
         XC    PRINTAB(164),PRINTAB                                1904 07250000
*           PCARG=''B;              /*                       @Z40LB25*/ 07251000
         XC    PCARG(33),PCARG                                     1905 07252000
*           SUBTITBF=' ';           /*                       @Z40LB25*/ 07253000
         MVI   SUBTITBF+1,C' '                                     1906 07254000
         MVC   SUBTITBF+2(119),SUBTITBF+1                          1906 07255000
         MVI   SUBTITBF,C' '                                       1906 07256000
*           DARGRETP=ADDR(SUBTITBF);/*                       @Z40LB25*/ 07257000
         L     @02,DDSTRU                                          1907 07258000
         LA    @15,SUBTITBF                                        1907 07259000
         ST    @15,DARGRETP(,@02)                                  1907 07260000
*           DARGRETL=LENGTH(SUBTITBF);/*                     @Z40LB25*/ 07261000
         MVC   DARGRETL(2,@02),@CH01335                            1908 07262000
*           IF HDRDID17=ON THEN     /* STID17 REQUESTED?     @Z40LB22*/ 07263000
         TM    HDRDID17,B'10000000'                                1909 07264000
         BNO   @RF01909                                            1909 07265000
*             DARGSENT=AUDRDS17;    /* YES, MOVE IT IN       @Z40LB22*/ 07266000
         MVI   DARGSENT(@02),X'11'                                 1910 07267000
*           IF HDRDID18=ON THEN     /* STID18 REQUESTED?     @Z40LB22*/ 07268000
@RF01909 TM    HDRDID18,B'01000000'                                1911 07269000
         BNO   @RF01911                                            1911 07270000
*             DARGSENT=AUDRDS18;    /* YES, MOVE IT IN       @Z40LB22*/ 07271000
         L     @02,DDSTRU                                          1912 07272000
         MVI   DARGSENT(@02),X'12'                                 1912 07273000
*           IF HDRDID19=ON THEN     /* STID19 REQUESTED?     @Z40LB22*/ 07274000
@RF01911 TM    HDRDID19,B'00100000'                                1913 07275000
         BNO   @RF01913                                            1913 07276000
*             DARGSENT=AUDRDS19;    /* YES, MOVE IT IN       @Z40LB22*/ 07277000
         L     @02,DDSTRU                                          1914 07278000
         MVI   DARGSENT(@02),X'13'                                 1914 07279000
*           IF HDRDID35=ON THEN     /* STID35 REQUESTED?     @Z40LB22*/ 07280000
@RF01913 TM    HDRDID35,B'00010000'                                1915 07281000
         BNO   @RF01915                                            1915 07282000
*             DARGSENT=AUDRDS35;    /* YES, MOVE IT IN       @Z40LB22*/ 07283000
         L     @02,DDSTRU                                          1916 07284000
         MVI   DARGSENT(@02),X'23'                                 1916 07285000
*           DARGSMOD=AUDMSG;        /* SET TEXT MOD          @Z40LB22*/ 07286000
@RF01915 L     @02,DDSTRU                                          1917 07287000
         MVC   DARGSMOD(3,@02),@CC01440                            1917 07288000
*           DARGCNT=1;              /* SET 1 INSERT          @Z40LB22*/ 07289000
         LA    @15,1                                               1918 07290000
         STH   @15,DARGCNT(,@02)                                   1918 07291000
*           DARGINS(1)=1;           /* SET INSERT NO.        @Z40LB22*/ 07292000
         STH   @15,DARGINS(,@02)                                   1919 07293000
*           DARGINL(1)=LENGTH(MSFVAL);/*                     @Z40LB22   07294000
*                                      SET INSERT SIZE       @Z40LB22*/ 07295000
         MVC   DARGINL(2,@02),@CH00047                             1920 07296000
*           DARGDTM(1)=ADDR(MSFVAL);/* INSERT ADDR           @Z40LB22*/ 07297000
*                                                                  1921 07298000
         L     @15,@PC00001+4                                      1921 07299000
         L     @15,FDTPTR+24(,@15)                                 1921 07300000
         ST    @15,DARGDTM(,@02)                                   1921 07301000
*           /*********************************************************/ 07302000
*           /*                                                       */ 07303000
*           /* GET THE SUBTITLE                              @Z40LB25*/ 07304000
*           /*                                                       */ 07305000
*           /*********************************************************/ 07306000
*                                                                  1922 07307000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB22*/ 07308000
         L     @02,@PC00001                                        1922 07309000
         ST    @02,@AL00001                                        1922 07310000
         LA    @15,@CF00120                                        1922 07311000
         ST    @15,@AL00001+4                                      1922 07312000
         LA    @15,DDSTRU                                          1922 07313000
         ST    @15,@AL00001+8                                      1922 07314000
         MVI   @AL00001+8,X'80'                                    1922 07315000
         L     @15,GDTPRT(,@02)                                    1922 07316000
         LA    @01,@AL00001                                        1922 07317000
         BALR  @14,@15                                             1922 07318000
*           PCSTLC=1;               /*                       @Z40LB25*/ 07319000
         MVC   PCSTLC(2),@CH00224                                  1923 07320000
*           PCSTLP=ADDR(SUBTITBF);  /*                       @Z40LB25*/ 07321000
*                                                                  1924 07322000
         LA    @02,SUBTITBF                                        1924 07323000
         ST    @02,PCSTLP                                          1924 07324000
*           /*********************************************************/ 07325000
*           /*                                                       */ 07326000
*           /* PRINT THE SUBTITLE                            @Z40LB25*/ 07327000
*           /*                                                       */ 07328000
*           /*********************************************************/ 07329000
*                                                                  1925 07330000
*           CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*           @Z40LB25*/ 07331000
         L     @02,@PC00001                                        1925 07332000
         ST    @02,@AL00001                                        1925 07333000
         L     @15,@PC00001+12                                     1925 07334000
         ST    @15,@AL00001+4                                      1925 07335000
         LA    @15,PCARG                                           1925 07336000
         ST    @15,@AL00001+8                                      1925 07337000
         L     @15,GDTESA(,@02)                                    1925 07338000
         LA    @01,@AL00001                                        1925 07339000
         BALR  @14,@15                                             1925 07340000
*         END;                      /* END OF SUBTITLE SEARCH      1926 07341000
*                                                            @Z40LB22*/ 07342000
*                                                                  1927 07343000
*       /*************************************************************/ 07344000
*       /*                                                           */ 07345000
*       /* BEGIN SEARCH FOR THE HEADER                       @Z40LB22*/ 07346000
*       /*                                                           */ 07347000
*       /*************************************************************/ 07348000
*                                                                  1927 07349000
*       IF HDSHDRE^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/ 07350000
@RF01902 CLI   HDSHDRE,X'00'                                       1927 07351000
         BE    @RF01927                                            1927 07352000
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/ 07353000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/ 07354000
         XC    PRINTAB(164),PRINTAB                                1929 07355000
*           IF HDRDID38=ON THEN     /* STID38 REQUIRED?      @Z40LB22*/ 07356000
         TM    HDRDID38,B'10000000'                                1930 07357000
         BNO   @RF01930                                            1930 07358000
*             DARGSENT=AUDRDH38;    /* YES, MOVE IT IN       @Z40LB22*/ 07359000
         L     @02,DDSTRU                                          1931 07360000
         MVI   DARGSENT(@02),X'26'                                 1931 07361000
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/ 07362000
@RF01930 L     @02,DDSTRU                                          1932 07363000
         MVC   DARGSMOD(3,@02),@CC01440                            1932 07364000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/ 07365000
         L     @02,@PC00001                                        1933 07366000
         ST    @02,@AL00001                                        1933 07367000
         L     @15,@PC00001+12                                     1933 07368000
         ST    @15,@AL00001+4                                      1933 07369000
         LA    @15,DDSTRU                                          1933 07370000
         ST    @15,@AL00001+8                                      1933 07371000
         MVI   @AL00001+8,X'80'                                    1933 07372000
         L     @15,GDTPRT(,@02)                                    1933 07373000
         LA    @01,@AL00001                                        1933 07374000
         BALR  @14,@15                                             1933 07375000
*         END;                      /*                       @Z40LB22*/ 07376000
*       IF HDSHDRF^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/ 07377000
@RF01927 CLI   HDSHDRF,X'00'                                       1935 07378000
         BE    @RF01935                                            1935 07379000
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/ 07380000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/ 07381000
         XC    PRINTAB(164),PRINTAB                                1937 07382000
*           IF HDRDID16=ON THEN     /* STID16 REQUIRED?      @Z40LB22*/ 07383000
         TM    HDRDID16,B'10000000'                                1938 07384000
         BNO   @RF01938                                            1938 07385000
*             DARGSENT=AUDRDH16;    /* YES, MOVE IT IN       @Z40LB22*/ 07386000
         L     @02,DDSTRU                                          1939 07387000
         MVI   DARGSENT(@02),X'10'                                 1939 07388000
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/ 07389000
@RF01938 L     @02,DDSTRU                                          1940 07390000
         MVC   DARGSMOD(3,@02),@CC01440                            1940 07391000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/ 07392000
         L     @02,@PC00001                                        1941 07393000
         ST    @02,@AL00001                                        1941 07394000
         L     @15,@PC00001+12                                     1941 07395000
         ST    @15,@AL00001+4                                      1941 07396000
         LA    @15,DDSTRU                                          1941 07397000
         ST    @15,@AL00001+8                                      1941 07398000
         MVI   @AL00001+8,X'80'                                    1941 07399000
         L     @15,GDTPRT(,@02)                                    1941 07400000
         LA    @01,@AL00001                                        1941 07401000
         BALR  @14,@15                                             1941 07402000
*         END;                      /*                       @Z40LB22*/ 07403000
*       IF HDSHDRG^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/ 07404000
@RF01935 CLI   HDSHDRG,X'00'                                       1943 07405000
         BE    @RF01943                                            1943 07406000
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/ 07407000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/ 07408000
         XC    PRINTAB(164),PRINTAB                                1945 07409000
*           IF HDRDID39=ON THEN     /* STID39 REQUIRED?      @Z40LB22*/ 07410000
         TM    HDRDID39,B'10000000'                                1946 07411000
         BNO   @RF01946                                            1946 07412000
*             DARGSENT=AUDRDH39;    /* YES, MOVE IT IN       @Z40LB22*/ 07413000
         L     @02,DDSTRU                                          1947 07414000
         MVI   DARGSENT(@02),X'27'                                 1947 07415000
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/ 07416000
@RF01946 L     @02,DDSTRU                                          1948 07417000
         MVC   DARGSMOD(3,@02),@CC01440                            1948 07418000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/ 07419000
         L     @02,@PC00001                                        1949 07420000
         ST    @02,@AL00001                                        1949 07421000
         L     @15,@PC00001+12                                     1949 07422000
         ST    @15,@AL00001+4                                      1949 07423000
         LA    @15,DDSTRU                                          1949 07424000
         ST    @15,@AL00001+8                                      1949 07425000
         MVI   @AL00001+8,X'80'                                    1949 07426000
         L     @15,GDTPRT(,@02)                                    1949 07427000
         LA    @01,@AL00001                                        1949 07428000
         BALR  @14,@15                                             1949 07429000
*         END;                      /*                       @Z40LB22*/ 07430000
*       IF HDSHDRH^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/ 07431000
@RF01943 CLI   HDSHDRH,X'00'                                       1951 07432000
         BE    @RF01951                                            1951 07433000
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/ 07434000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/ 07435000
         XC    PRINTAB(164),PRINTAB                                1953 07436000
*           IF HDRDID14=ON THEN     /* STID14 REQUIRED?      @Z40LB22*/ 07437000
         TM    HDRDID14,B'10000000'                                1954 07438000
         BNO   @RF01954                                            1954 07439000
*             DARGSENT=AUDRDH14;    /* YES, MOVE IT IN       @Z40LB22*/ 07440000
         L     @02,DDSTRU                                          1955 07441000
         MVI   DARGSENT(@02),X'0E'                                 1955 07442000
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/ 07443000
@RF01954 L     @02,DDSTRU                                          1956 07444000
         MVC   DARGSMOD(3,@02),@CC01440                            1956 07445000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/ 07446000
         L     @02,@PC00001                                        1957 07447000
         ST    @02,@AL00001                                        1957 07448000
         L     @15,@PC00001+12                                     1957 07449000
         ST    @15,@AL00001+4                                      1957 07450000
         LA    @15,DDSTRU                                          1957 07451000
         ST    @15,@AL00001+8                                      1957 07452000
         MVI   @AL00001+8,X'80'                                    1957 07453000
         L     @15,GDTPRT(,@02)                                    1957 07454000
         LA    @01,@AL00001                                        1957 07455000
         BALR  @14,@15                                             1957 07456000
*         END;                      /*                       @Z40LB22*/ 07457000
*       IF HDSHDRI^=HDMASK THEN     /* IS HEADER REQUIRED    @Z40LB22*/ 07458000
@RF01951 CLI   HDSHDRI,X'00'                                       1959 07459000
         BE    @RF01959                                            1959 07460000
*         DO;                       /* YES,SEARCH FOR IT     @Z40LB22*/ 07461000
*           PRINTAB=''B;            /* CLEAR ARG LIST        @Z40LB22*/ 07462000
         XC    PRINTAB(164),PRINTAB                                1961 07463000
*           IF HDRDID37=ON THEN     /* STID37 REQUIRED?      @Z40LB22*/ 07464000
         TM    HDRDID37,B'10000000'                                1962 07465000
         BNO   @RF01962                                            1962 07466000
*             DARGSENT=AUDRDH37;    /* YES, MOVE IT IN       @Z40LB22*/ 07467000
         L     @02,DDSTRU                                          1963 07468000
         MVI   DARGSENT(@02),X'25'                                 1963 07469000
*           DARGSMOD=AUDMSG;        /* SET MOD ID            @Z40LB22*/ 07470000
@RF01962 L     @02,DDSTRU                                          1964 07471000
         MVC   DARGSMOD(3,@02),@CC01440                            1964 07472000
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Z40LB22*/ 07473000
         L     @02,@PC00001                                        1965 07474000
         ST    @02,@AL00001                                        1965 07475000
         L     @15,@PC00001+12                                     1965 07476000
         ST    @15,@AL00001+4                                      1965 07477000
         LA    @15,DDSTRU                                          1965 07478000
         ST    @15,@AL00001+8                                      1965 07479000
         MVI   @AL00001+8,X'80'                                    1965 07480000
         L     @15,GDTPRT(,@02)                                    1965 07481000
         LA    @01,@AL00001                                        1965 07482000
         BALR  @14,@15                                             1965 07483000
*         END;                      /*                       @Z40LB22*/ 07484000
*       HDSETRD=''B;                /* CLEAR READ PARM LIST  @Z40LB22*/ 07485000
@RF01959 XC    HDSETRD(8),HDSETRD                                  1967 07486000
*     END;                          /* END OF SUBTITLE SEARCH      1968 07487000
*                                                            @Z40LB22*/ 07488000
*   ELSE                                                           1969 07489000
*                                                                  1969 07490000
*     /***************************************************************/ 07491000
*     /*                                                             */ 07492000
*     /* CHECK FOR CHECK REPORT REQUEST                      @Z40LB22*/ 07493000
*     /*                                                             */ 07494000
*     /***************************************************************/ 07495000
*                                                                  1969 07496000
*     IF HDCKPTR^=NULLPTR THEN      /*                       @Z40LB22*/ 07497000
         B     @RC01900                                            1969 07498000
@RF01900 L     @02,HDCKPTR                                         1969 07499000
         LTR   @02,@02                                             1969 07500000
         BZ    @RF01969                                            1969 07501000
*       DO;                         /*                       @Z40LB22*/ 07502000
*         IF HDSCKSTL^=STMASK THEN  /* CHECK FOR SUBTITLE    @Z40LB22*/ 07503000
         CLI   HDSCKSTL,X'00'                                      1971 07504000
         BE    @RF01971                                            1971 07505000
*           DO;                     /*                       @Z40LB22*/ 07506000
*             PRINTAB=''B;          /* CLEAR ARG LIST        @Z40LB22*/ 07507000
         XC    PRINTAB(164),PRINTAB                                1973 07508000
*             PCARG=''B;            /*                       @Z40LB25*/ 07509000
         XC    PCARG(33),PCARG                                     1974 07510000
*             SUBTITBF=' ';         /*                       @Z40LB25*/ 07511000
         MVI   SUBTITBF+1,C' '                                     1975 07512000
         MVC   SUBTITBF+2(119),SUBTITBF+1                          1975 07513000
         MVI   SUBTITBF,C' '                                       1975 07514000
*             DARGRETP=ADDR(SUBTITBF);/*                     @Z40LB25*/ 07515000
         L     @02,DDSTRU                                          1976 07516000
         LA    @15,SUBTITBF                                        1976 07517000
         ST    @15,DARGRETP(,@02)                                  1976 07518000
*             DARGRETL=LENGTH(SUBTITBF);/*                   @Z40LB25*/ 07519000
         MVC   DARGRETL(2,@02),@CH01335                            1977 07520000
*             IF HDCKID11=ON THEN   /* STID11 REQUESTED?     @Z40LB22*/ 07521000
         TM    HDCKID11,B'10000000'                                1978 07522000
         BNO   @RF01978                                            1978 07523000
*               DARGSENT=AUDCKS11;  /* YES, MOVE IT IN       @Z40LB22*/ 07524000
         MVI   DARGSENT(@02),X'0B'                                 1979 07525000
*             IF HDCKID12=ON THEN   /* STID12 REQUESTED?     @Z40LB22*/ 07526000
@RF01978 TM    HDCKID12,B'01000000'                                1980 07527000
         BNO   @RF01980                                            1980 07528000
*               DARGSENT=AUDCKS12;  /* YES, MOVE IT IN       @Z40LB22*/ 07529000
         L     @02,DDSTRU                                          1981 07530000
         MVI   DARGSENT(@02),X'0C'                                 1981 07531000
*             IF HDCKID13=ON THEN   /* STID13 REQUESTED?     @Z40LB22*/ 07532000
@RF01980 TM    HDCKID13,B'00100000'                                1982 07533000
         BNO   @RF01982                                            1982 07534000
*               DARGSENT=AUDCKS13;  /* YES, MOVE IT IN       @Z40LB22*/ 07535000
         L     @02,DDSTRU                                          1983 07536000
         MVI   DARGSENT(@02),X'0D'                                 1983 07537000
*             DARGSMOD=AUDMSG;      /* SET TEXT MOD          @Z40LB22*/ 07538000
@RF01982 L     @02,DDSTRU                                          1984 07539000
         MVC   DARGSMOD(3,@02),@CC01440                            1984 07540000
*             DARGCNT=1;            /* SET 1 INSERT          @Z40LB22*/ 07541000
         LA    @15,1                                               1985 07542000
         STH   @15,DARGCNT(,@02)                                   1985 07543000
*             DARGINS(1)=1;         /* SET INSERT NO.        @Z40LB22*/ 07544000
         STH   @15,DARGINS(,@02)                                   1986 07545000
*             DARGINL(1)=LENGTH(MSFVAL);/*                   @Z40LB22   07546000
*                                      SET INSERT SIZE       @Z40LB22*/ 07547000
         MVC   DARGINL(2,@02),@CH00047                             1987 07548000
*             DARGDTM(1)=ADDR(MSFVAL);/* INSERT ADDR         @Z40LB22*/ 07549000
*                                                                  1988 07550000
         L     @15,@PC00001+4                                      1988 07551000
         L     @15,FDTPTR+24(,@15)                                 1988 07552000
         ST    @15,DARGDTM(,@02)                                   1988 07553000
*             /*******************************************************/ 07554000
*             /*                                                     */ 07555000
*             /* GET THE SUBTITLE                            @Z40LB25*/ 07556000
*             /*                                                     */ 07557000
*             /*******************************************************/ 07558000
*                                                                  1989 07559000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB22*/ 07560000
         L     @02,@PC00001                                        1989 07561000
         ST    @02,@AL00001                                        1989 07562000
         LA    @15,@CF00120                                        1989 07563000
         ST    @15,@AL00001+4                                      1989 07564000
         LA    @15,DDSTRU                                          1989 07565000
         ST    @15,@AL00001+8                                      1989 07566000
         MVI   @AL00001+8,X'80'                                    1989 07567000
         L     @15,GDTPRT(,@02)                                    1989 07568000
         LA    @01,@AL00001                                        1989 07569000
         BALR  @14,@15                                             1989 07570000
*             PCSTLC=1;             /*                       @Z40LB25*/ 07571000
         MVC   PCSTLC(2),@CH00224                                  1990 07572000
*             PCSTLP=ADDR(SUBTITBF);/*                       @Z40LB25*/ 07573000
*                                                                  1991 07574000
         LA    @02,SUBTITBF                                        1991 07575000
         ST    @02,PCSTLP                                          1991 07576000
*             /*******************************************************/ 07577000
*             /*                                                     */ 07578000
*             /* PRINT THE SUBTITLE                          @Z40LB25*/ 07579000
*             /*                                                     */ 07580000
*             /*******************************************************/ 07581000
*                                                                  1992 07582000
*             CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*         @Z40LB25*/ 07583000
         L     @02,@PC00001                                        1992 07584000
         ST    @02,@AL00001                                        1992 07585000
         L     @15,@PC00001+12                                     1992 07586000
         ST    @15,@AL00001+4                                      1992 07587000
         LA    @15,PCARG                                           1992 07588000
         ST    @15,@AL00001+8                                      1992 07589000
         L     @15,GDTESA(,@02)                                    1992 07590000
         LA    @01,@AL00001                                        1992 07591000
         BALR  @14,@15                                             1992 07592000
*           END;                    /* END OF SUBTITLE SEARCH      1993 07593000
*                                                            @Z40LB22*/ 07594000
*                                                                  1994 07595000
*         /***********************************************************/ 07596000
*         /*                                                         */ 07597000
*         /* BEGIN SEARCH FOR THE HEADER                     @Z40LB22*/ 07598000
*         /*                                                         */ 07599000
*         /***********************************************************/ 07600000
*                                                                  1994 07601000
*         IF HDSHDRA^=HDMASK THEN   /* IS HEADER REQUIRED    @Z40LB22*/ 07602000
@RF01971 CLI   HDSHDRA,X'00'                                       1994 07603000
         BE    @RF01994                                            1994 07604000
*           DO;                     /*                       @Z40LB22*/ 07605000
*             PRINTAB=''B;          /* CLEAR ARG LIST        @Z40LB22*/ 07606000
         XC    PRINTAB(164),PRINTAB                                1996 07607000
*             IF HDCKID14=ON THEN   /* STID14 REQUIRED?      @Z40LB22*/ 07608000
         TM    HDCKID14,B'10000000'                                1997 07609000
         BNO   @RF01997                                            1997 07610000
*               DARGSENT=AUDCKH14;  /* YES, MOVE IT IN       @Z40LB22*/ 07611000
         L     @02,DDSTRU                                          1998 07612000
         MVI   DARGSENT(@02),X'0E'                                 1998 07613000
*             DARGSMOD=AUDMSG;      /* SET MOD ID            @Z40LB22*/ 07614000
@RF01997 L     @02,DDSTRU                                          1999 07615000
         MVC   DARGSMOD(3,@02),@CC01440                            1999 07616000
*             CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*        @Z40LB22*/ 07617000
         L     @02,@PC00001                                        2000 07618000
         ST    @02,@AL00001                                        2000 07619000
         L     @15,@PC00001+12                                     2000 07620000
         ST    @15,@AL00001+4                                      2000 07621000
         LA    @15,DDSTRU                                          2000 07622000
         ST    @15,@AL00001+8                                      2000 07623000
         MVI   @AL00001+8,X'80'                                    2000 07624000
         L     @15,GDTPRT(,@02)                                    2000 07625000
         LA    @01,@AL00001                                        2000 07626000
         BALR  @14,@15                                             2000 07627000
*           END;                    /* END OF HEADER SEARCH  @Z40LB22*/ 07628000
*         IF HDSHDRB^=HDMASK THEN   /* IS HEADER REQUIRED    @Z40LB22*/ 07629000
@RF01994 CLI   HDSHDRB,X'00'                                       2002 07630000
         BE    @RF02002                                            2002 07631000
*           DO;                     /*                       @Z40LB22*/ 07632000
*             PRINTAB=''B;          /* CLEAR ARG LIST        @Z40LB22*/ 07633000
         XC    PRINTAB(164),PRINTAB                                2004 07634000
*             IF HDCKID15=ON THEN   /* STID15 REQUIRED?      @Z40LB22*/ 07635000
         TM    HDCKID15,B'10000000'                                2005 07636000
         BNO   @RF02005                                            2005 07637000
*               DARGSENT=AUDCKH15;  /* YES, MOVE IT IN       @Z40LB22*/ 07638000
         L     @02,DDSTRU                                          2006 07639000
         MVI   DARGSENT(@02),X'0F'                                 2006 07640000
*             DARGSMOD=AUDMSG;      /* SET MOD ID            @Z40LB22*/ 07641000
@RF02005 L     @02,DDSTRU                                          2007 07642000
         MVC   DARGSMOD(3,@02),@CC01440                            2007 07643000
*             CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*        @Z40LB22*/ 07644000
         L     @02,@PC00001                                        2008 07645000
         ST    @02,@AL00001                                        2008 07646000
         L     @15,@PC00001+12                                     2008 07647000
         ST    @15,@AL00001+4                                      2008 07648000
         LA    @15,DDSTRU                                          2008 07649000
         ST    @15,@AL00001+8                                      2008 07650000
         MVI   @AL00001+8,X'80'                                    2008 07651000
         L     @15,GDTPRT(,@02)                                    2008 07652000
         LA    @01,@AL00001                                        2008 07653000
         BALR  @14,@15                                             2008 07654000
*           END;                    /* END OF HEADER SEARCH  @Z40LB22*/ 07655000
*         HDSETCK=''B;              /* CLEAR CHECK PARM LIST @Z40LB22*/ 07656000
@RF02002 XC    HDSETCK(4),HDSETCK                                  2010 07657000
*       END;                        /* END OF SUBTITLE SEARCH      2011 07658000
*                                                            @Z40LB22*/ 07659000
*   RETURN;                         /*                       @Z40LB22*/ 07660000
@EL00017 DS    0H                                                  2012 07661000
@EF00017 DS    0H                                                  2012 07662000
@ER00017 L     @14,@SA00017                                        2012 07663000
         BR    @14                                                 2012 07664000
*   END HEADSET;                    /*                       @Z40LB22*/ 07665000
         B     @EL00017                                            2013 07666000
*                                                                  2014 07667000
*/***********************************************************@Y30LB39*/ 07668000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07669000
*/*                                                          @Y30LB39*/ 07670000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07671000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07672000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07673000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07674000
*/*                                                          @Y30LB39*/ 07675000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07676000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07677000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07678000
*/*                                                          @Y30LB39*/ 07679000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07680000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07681000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07682000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07683000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07684000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07685000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07686000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07687000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07688000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07689000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07690000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07691000
*/*                                                          @Y30LB39*/ 07692000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07693000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07694000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07695000
*/*                                                          @Y30LB39*/ 07696000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07697000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07698000
*/*                                                          @Y30LB39*/ 07699000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07700000
*/*                                                          @Y30LB39*/ 07701000
*/***********************************************************@Y30LB39*/ 07702000
*                                                                  2014 07703000
*                                   /*                       @Y30LB39*/ 07704000
*SSCMSG:                                                           2014 07705000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07706000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07707000
*                                                            @Y30LB39*/ 07708000
SSCMSG   STM   @14,@12,@SA00018                                    2014 07709000
         MVC   @PC00018(8),0(@01)                                  2014 07710000
*                                   /*                       @Y30LB39*/ 07711000
*                                                                  2015 07712000
*   /*****************************************************************/ 07713000
*   /*                                                               */ 07714000
*   /*                                                       @Y30LB39*/ 07715000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07716000
*   /*                                                       @Y30LB39*/ 07717000
*   /*                                                               */ 07718000
*   /*****************************************************************/ 07719000
*                                                                  2015 07720000
*                                   /*                       @Y30LB39   07721000
*                                                            @Y30LB39*/ 07722000
*                                                                  2015 07723000
*   /*****************************************************************/ 07724000
*   /*                                                               */ 07725000
*   /*                                                       @Y30LB39*/ 07726000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07727000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07728000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07729000
*   /*                                                       @Y30LB39*/ 07730000
*   /*                                                               */ 07731000
*   /*****************************************************************/ 07732000
*                                                                  2015 07733000
*                                   /*                       @Y30LB39*/ 07734000
*   DCL                                                            2015 07735000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07736000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07737000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07738000
*   DCL                                                            2016 07739000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07740000
*                                                            @Y30LB39   07741000
*                                                            @Y30LB39*/ 07742000
*                                                                  2016 07743000
*   /*****************************************************************/ 07744000
*   /*                                                               */ 07745000
*   /*                                                       @Y30LB39*/ 07746000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07747000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07748000
*   /*                                                       @Y30LB39*/ 07749000
*   /*                                                               */ 07750000
*   /*****************************************************************/ 07751000
*                                                                  2017 07752000
*                                   /*                       @Y30LB39*/ 07753000
*   DCL                                                            2017 07754000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07755000
*   DCL                                                            2018 07756000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07757000
*                                                            @Y30LB39*/ 07758000
*                                                                  2018 07759000
*   /*****************************************************************/ 07760000
*   /*                                                               */ 07761000
*   /*                                                       @Y30LB39*/ 07762000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07763000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07764000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07765000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07766000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07767000
*   /*                                                       @Y30LB39*/ 07768000
*   /*                                                               */ 07769000
*   /*****************************************************************/ 07770000
*                                                                  2019 07771000
*                                   /*                       @Y30LB39*/ 07772000
*   DECLARE                                                        2019 07773000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07774000
*                                                            @Y30LB39*/ 07775000
*                                                                  2019 07776000
*   /*****************************************************************/ 07777000
*   /*                                                               */ 07778000
*   /*                                                       @Y30LB39*/ 07779000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07780000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07781000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07782000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07783000
*   /*                                                       @Y30LB39*/ 07784000
*   /*                                                               */ 07785000
*   /*****************************************************************/ 07786000
*                                                                  2020 07787000
*                                   /*                       @Y30LB39*/ 07788000
*   DECLARE                                                        2020 07789000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07790000
*                                                            @Y30LB39*/ 07791000
*                                                                  2020 07792000
*   /*****************************************************************/ 07793000
*   /*                                                               */ 07794000
*   /*                                                       @Y30LB39*/ 07795000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07796000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07797000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07798000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07799000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07800000
*   /*                                                       @Y30LB39*/ 07801000
*   /*                                                               */ 07802000
*   /*****************************************************************/ 07803000
*                                                                  2021 07804000
*                                   /*                       @Y30LB39*/ 07805000
*   DECLARE                                                        2021 07806000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07807000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07808000
*                                                            @Y30LB39*/ 07809000
*                                                                  2021 07810000
*   /*****************************************************************/ 07811000
*   /*                                                               */ 07812000
*   /*                                                       @Y30LB39*/ 07813000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07814000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07815000
*   /*                                                       @Y30LB39*/ 07816000
*   /*                                                               */ 07817000
*   /*****************************************************************/ 07818000
*                                                                  2022 07819000
*                                   /*                       @Y30LB39*/ 07820000
*   DECLARE                                                        2022 07821000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07822000
*                                                            @Y30LB39*/ 07823000
*                                                                  2022 07824000
*   /*****************************************************************/ 07825000
*   /*                                                               */ 07826000
*   /*                                                       @Y30LB39*/ 07827000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07828000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07829000
*   /*                                                       @Y30LB39*/ 07830000
*   /*                                                               */ 07831000
*   /*****************************************************************/ 07832000
*                                                                  2023 07833000
*                                   /*                       @Y30LB39*/ 07834000
*   DECLARE                                                        2023 07835000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07836000
*                                                            @Y30LB39*/ 07837000
*                                   /*                       @Y30LB39*/ 07838000
*                                                                  2024 07839000
*   /*****************************************************************/ 07840000
*   /*                                                               */ 07841000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07842000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07843000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07844000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07845000
*   /*                                                       @Y30LB39*/ 07846000
*   /*                                                               */ 07847000
*   /*****************************************************************/ 07848000
*                                                                  2024 07849000
*                                   /*                       @Y30LB39*/ 07850000
*   OLDERID2=NEWERID2;                                             2024 07851000
         L     @15,@PC00001                                        2024 07852000
         L     @14,GDTTR2(,@15)                                    2024 07853000
         MVC   @TS00001(95),NEWERID2(@14)                          2024 07854000
         MVC   OLDERID2(95,@14),@TS00001                           2024 07855000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07856000
*                                                            @Y30LB39*/ 07857000
*                                                                  2025 07858000
         MVC   NEWID2(4,@14),@CC01636                              2025 07859000
*   /*****************************************************************/ 07860000
*   /*                                                               */ 07861000
*   /*                                                       @Y30LB39*/ 07862000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 07863000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 07864000
*   /*                                                       @Y30LB39*/ 07865000
*   /*                                                               */ 07866000
*   /*****************************************************************/ 07867000
*                                                                  2026 07868000
*                                   /*                       @Y30LB39*/ 07869000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   07870000
*                                                            @Y30LB39*/ 07871000
*                                                                  2026 07872000
         LA    @14,SSDRGLT                                         2026 07873000
         ST    @14,SSDLPTR                                         2026 07874000
*   /*****************************************************************/ 07875000
*   /*                                                               */ 07876000
*   /*                                                       @Y30LB39*/ 07877000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 07878000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 07879000
*   /*                                                       @Y30LB39*/ 07880000
*   /*                                                               */ 07881000
*   /*****************************************************************/ 07882000
*                                                                  2027 07883000
*                                   /*                       @Y30LB39*/ 07884000
*   IF SSRCODE>0 THEN                                              2027 07885000
         L     @07,@PC00018                                        2027 07886000
         L     @07,SSRCODE(,@07)                                   2027 07887000
         LTR   @07,@07                                             2027 07888000
         BNP   @RF02027                                            2027 07889000
*     DO;                           /*                       @Y30LB39   07890000
*                                                            @Y30LB39*/ 07891000
*                                                                  2028 07892000
*       /*************************************************************/ 07893000
*       /*                                                           */ 07894000
*       /*                                                   @Y30LB39*/ 07895000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 07896000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 07897000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 07898000
*       /* CODES.                                            @Y30LB39*/ 07899000
*       /*                                                   @Y30LB39*/ 07900000
*       /*                                                           */ 07901000
*       /*************************************************************/ 07902000
*                                                                  2029 07903000
*                                   /*                       @Y30LB39*/ 07904000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07905000
         XC    SSDRGLT(20),SSDRGLT                                 2029 07906000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 07907000
         LA    @03,SSINXLST                                        2030 07908000
         ST    @03,DARGRETP(,@14)                                  2030 07909000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 07910000
         MVC   DARGSMOD(3,@14),SSMODSS0                            2031 07911000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 07912000
         MVI   DARGSENT(@14),X'01'                                 2032 07913000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   07914000
*                                                            @Y30LB39*/ 07915000
*                                                                  2033 07916000
         MVC   DARGRETL(2,@14),@CH01649                            2033 07917000
*       /*************************************************************/ 07918000
*       /*                                                           */ 07919000
*       /*                                                   @Y30LB39*/ 07920000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 07921000
*       /* ARRAY.                                            @Y30LB39*/ 07922000
*       /*                                                   @Y30LB39*/ 07923000
*       /*                                                           */ 07924000
*       /*************************************************************/ 07925000
*                                                                  2034 07926000
*                                   /*                       @Y30LB39*/ 07927000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   07928000
*                                                            @Y30LB39*/ 07929000
*                                                                  2034 07930000
         ST    @15,@AL00001                                        2034 07931000
         LA    @03,@CF00120                                        2034 07932000
         ST    @03,@AL00001+4                                      2034 07933000
         LA    @03,SSDLPTR                                         2034 07934000
         ST    @03,@AL00001+8                                      2034 07935000
         MVI   @AL00001+8,X'80'                                    2034 07936000
         L     @15,GDTPRT(,@15)                                    2034 07937000
         LA    @01,@AL00001                                        2034 07938000
         BALR  @14,@15                                             2034 07939000
*       /*************************************************************/ 07940000
*       /*                                                           */ 07941000
*       /*                                                   @Y30LB39*/ 07942000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 07943000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 07944000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 07945000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 07946000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 07947000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 07948000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 07949000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 07950000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 07951000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 07952000
*       /* REASON CODE.                                      @Y30LB39*/ 07953000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 07954000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 07955000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 07956000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 07957000
*       /*                                                   @Y30LB39*/ 07958000
*       /*                                                           */ 07959000
*       /*************************************************************/ 07960000
*                                                                  2035 07961000
*                                   /*                       @Y30LB39*/ 07962000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 07963000
         LA    ENTRYNUM,1                                          2035 07964000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   2036 07965000
@DL02036 DS    0H                                                  2037 07966000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 07967000
         AL    ENTRYNUM,@CF00224                                   2037 07968000
*       END;                        /*                       @Y30LB39   07969000
*                                                            @Y30LB39*/ 07970000
*                                                                  2038 07971000
@DE02036 L     @03,@PC00018                                        2038 07972000
         LR    @15,ENTRYNUM                                        2038 07973000
         ALR   @15,@15                                             2038 07974000
         LH    @15,SSARRAY-2(@15)                                  2038 07975000
         CH    @15,SSRHALF(,@03)                                   2038 07976000
         BE    @DC02036                                            2038 07977000
         SLR   @14,@14                                             2038 07978000
         CR    @15,@14                                             2038 07979000
         BNE   @DL02036                                            2038 07980000
@DC02036 DS    0H                                                  2039 07981000
*       /*************************************************************/ 07982000
*       /*                                                           */ 07983000
*       /*                                                   @Y30LB39*/ 07984000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 07985000
*       /*                                                   @Y30LB39*/ 07986000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 07987000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 07988000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 07989000
*       /* CODE OR                                           @Y30LB39*/ 07990000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 07991000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 07992000
*       /*                                                   @Y30LB39*/ 07993000
*       /*                                                           */ 07994000
*       /*************************************************************/ 07995000
*                                                                  2039 07996000
*                                   /*                       @Y30LB39*/ 07997000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 07998000
         XC    SSDRGLT(20),SSDRGLT                                 2039 07999000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 08000000
         L     @07,SSDLPTR                                         2040 08001000
         MVC   DARGSMOD(3,@07),SSMODSS0                            2040 08002000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 08003000
         STC   ENTRYNUM,DARGSENT(,@07)                             2041 08004000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 08005000
         CR    @15,@14                                             2042 08006000
         BNE   @RF02042                                            2042 08007000
*         DO;                       /*                       @Y30LB39*/ 08008000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 08009000
         ST    @03,DARGDBP(,@07)                                   2044 08010000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 08011000
         MVC   DARGILP(2,@07),@CH00047                             2045 08012000
*         END;                      /*                       @Y30LB39*/ 08013000
*     END;                          /*                       @Y30LB39*/ 08014000
*                                   /*                       @Y30LB39*/ 08015000
*                                                                  2048 08016000
*   /*****************************************************************/ 08017000
*   /*                                                               */ 08018000
*   /*                                                       @Y30LB39*/ 08019000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 08020000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 08021000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 08022000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 08023000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 08024000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 08025000
*   /* POST CODE.                                            @Y30LB39*/ 08026000
*   /*                                                       @Y30LB39*/ 08027000
*   /*                                                               */ 08028000
*   /*****************************************************************/ 08029000
*                                                                  2048 08030000
*                                   /*                       @Y30LB39*/ 08031000
*   ELSE                            /*                       @Y30LB39*/ 08032000
*     DO;                           /*                       @Y30LB39*/ 08033000
         B     @RC02027                                            2048 08034000
@RF02027 DS    0H                                                  2049 08035000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08036000
         XC    SSDRGLT(20),SSDRGLT                                 2049 08037000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 08038000
         L     @15,SSDLPTR                                         2050 08039000
         MVC   DARGSMOD(3,@15),SSMODCM0                            2050 08040000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 08041000
         MVC   DARGSENT(1,@15),SSMSGNUM                            2051 08042000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 08043000
         L     @14,@PC00018+4                                      2052 08044000
         ST    @14,DARGDBP(,@15)                                   2052 08045000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 08046000
         MVC   DARGILP(2,@15),@CH00224                             2053 08047000
*     END;                          /*                       @Y30LB39   08048000
*                                                            @Y30LB39*/ 08049000
*                                                                  2054 08050000
*   /*****************************************************************/ 08051000
*   /*                                                               */ 08052000
*   /*                                                       @Y30LB39*/ 08053000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 08054000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 08055000
*   /*                                                       @Y30LB39*/ 08056000
*   /*                                                               */ 08057000
*   /*****************************************************************/ 08058000
*                                                                  2055 08059000
*                                   /*                       @Y30LB39*/ 08060000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   08061000
*                                                            @Y30LB39*/ 08062000
*                                                                  2055 08063000
@RC02027 L     @15,@PC00001                                        2055 08064000
         ST    @15,@AL00001                                        2055 08065000
         LA    @14,@CF00120                                        2055 08066000
         ST    @14,@AL00001+4                                      2055 08067000
         LA    @14,SSDLPTR                                         2055 08068000
         ST    @14,@AL00001+8                                      2055 08069000
         MVI   @AL00001+8,X'80'                                    2055 08070000
         L     @15,GDTPRT(,@15)                                    2055 08071000
         LA    @01,@AL00001                                        2055 08072000
         BALR  @14,@15                                             2055 08073000
*   /*****************************************************************/ 08074000
*   /*                                                               */ 08075000
*   /*                                                       @Y30LB39*/ 08076000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 08077000
*   /*                                                       @Y30LB39*/ 08078000
*   /*                                                               */ 08079000
*   /*****************************************************************/ 08080000
*                                                                  2056 08081000
*                                   /*                       @Y30LB39   08082000
*                                                            @Y30LB39*/ 08083000
*   RETURN CODE(0);                 /*                       @Y30LB39   08084000
*                                                            @Y30LB39*/ 08085000
         SLR   @15,@15                                             2056 08086000
         L     @14,@SA00018                                        2056 08087000
         LM    @00,@12,@SA00018+8                                  2056 08088000
         BR    @14                                                 2056 08089000
*   END SSCMSG;                     /*                       @Y30LB39*/ 08090000
*   END IDCAU03                     /*                       @Z40LB25*/ 08091000
*                                                                  2058 08092000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 08093000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 08094000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 08095000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 08096000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 08097000
*/*%INCLUDE SYSLIB  (IDCCSAU )                                       */ 08098000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 08099000
*                                                                  2058 08100000
*       ;                                                          2058 08101000
@DATA    DS    0H                                                       08102000
@CH01086 DC    H'9'                                                     08103000
@CH00449 DC    H'10'                                                    08104000
@CH01093 DC    H'11'                                                    08105000
@CH00571 DC    H'12'                                                    08106000
@CH01099 DC    H'13'                                                    08107000
@CH00813 DC    H'44'                                                    08108000
@CH01649 DC    H'120'                                                   08109000
@CH01335 DC    H'121'                                                   08110000
@CH01541 DC    H'247'                                                   08111000
@CH01230 DC    H'264'                                                   08112000
@DATD    DSECT                                                          08113000
         DS    0F                                                       08114000
@SA00001 DS    18F                                                      08115000
@PC00001 DS    5F                                                       08116000
@SA00003 DS    1F                                                       08117000
@SA00006 DS    1F                                                       08118000
@SA00007 DS    1F                                                       08119000
@SA00005 DS    1F                                                       08120000
@SA00004 DS    1F                                                       08121000
@SA00009 DS    1F                                                       08122000
@SA00017 DS    1F                                                       08123000
@SA00012 DS    1F                                                       08124000
@SA00014 DS    1F                                                       08125000
@SA00018 DS    15F                                                      08126000
@PC00018 DS    2F                                                       08127000
@SA00010 DS    1F                                                       08128000
@SA00013 DS    1F                                                       08129000
@SA00015 DS    1F                                                       08130000
@SA00016 DS    1F                                                       08131000
@AL00001 DS    4A                                                       08132000
@TF00001 DS    F                                                        08133000
@AFTEMPS DS    2F                                                       08134000
IDCAU03  CSECT                                                          08135000
         DS    0F                                                       08136000
@CF00120 DC    F'0'                                                     08137000
@CF00224 DC    F'1'                                                     08138000
@CH00224 EQU   @CF00224+2                                               08139000
@CF00158 DC    F'2'                                                     08140000
@CH00158 EQU   @CF00158+2                                               08141000
@CF00167 DC    F'3'                                                     08142000
@CH00167 EQU   @CF00167+2                                               08143000
@CF00047 DC    F'4'                                                     08144000
@CH00047 EQU   @CF00047+2                                               08145000
@CF00291 DC    F'5'                                                     08146000
@CH00291 EQU   @CF00291+2                                               08147000
@CF00161 DC    F'6'                                                     08148000
@CH00161 EQU   @CF00161+2                                               08149000
@CF00663 DC    F'7'                                                     08150000
@CH00663 EQU   @CF00663+2                                               08151000
@CF00184 DC    F'8'                                                     08152000
@CH00184 EQU   @CF00184+2                                               08153000
@CF00479 DC    F'16'                                                    08154000
@CF01239 DC    F'28'                                                    08155000
@CF01241 DC    F'98'                                                    08156000
@CF01256 DC    F'150'                                                   08157000
@CH01256 EQU   @CF01256+2                                               08158000
@CF01567 DC    F'246'                                                   08159000
@CF01398 DC    F'256'                                                   08160000
@CF01638 DC    F'3168'                                                  08161000
@CF01670 DC    F'-257'                                                  08162000
@CF01672 DC    F'-256'                                                  08163000
@CF01675 DC    F'-4'                                                    08164000
@CF01674 DC    F'-1'                                                    08165000
@DATD    DSECT                                                          08166000
         DS    0D                                                       08167000
LISTSCAN DS    A                                                        08168000
OPNPTR   DS    A                                                        08169000
DDSTRU   DS    A                                                        08170000
FSADDR   DS    A                                                        08171000
ERCNVADR DS    A                                                        08172000
CCMSGPTR DS    A                                                        08173000
CMMSGPTR DS    A                                                        08174000
CTMSGPTR DS    A                                                        08175000
ELEMENT  DS    F                                                        08176000
RDCKPTR  DS    A                                                        08177000
MSFLOWX  DS    F                                                        08178000
HIBADX   DS    F                                                        08179000
Y        DS    FL4                                                      08180000
         ORG   Y                                                        08181000
@NM00092 DS    CL4                                                      08182000
         ORG   @NM00092                                                 08183000
@NM00093 DS    CL3                                                      08184000
YCHAR    DS    CL1                                                      08185000
         ORG   Y+4                                                      08186000
CORESIZE DS    F                                                        08187000
REASONCD DS    F                                                        08188000
HDRDPTR  DS    A                                                        08189000
HDCKPTR  DS    A                                                        08190000
WRKMAPTR DS    A                                                        08191000
XYZ1PTR  DS    A                                                        08192000
XYZ2PTR  DS    A                                                        08193000
CELLPTR  DS    A                                                        08194000
CELLPTR2 DS    A                                                        08195000
CHUNKPTR DS    A                                                        08196000
CHUNKPT2 DS    A                                                        08197000
CURCKPTR DS    A                                                        08198000
CURCLPTR DS    A                                                        08199000
SSDLPTR  DS    A                                                        08200000
LISTPTR  DS    A                                                        08201000
X        DS    H                                                        08202000
X1       DS    H                                                        08203000
X2       DS    H                                                        08204000
Y1       DS    H                                                        08205000
Z        DS    H                                                        08206000
BLKINDX2 DS    H                                                        08207000
CHKINDEX DS    H                                                        08208000
CHKINDX2 DS    H                                                        08209000
CUBINDEX DS    H                                                        08210000
BYTEINDX DS    H                                                        08211000
TWOBITX  DS    H                                                        08212000
LASTCOND DS    H                                                        08213000
LIMITSRC DS    H                                                        08214000
CHECKRC  DS    H                                                        08215000
READRC   DS    H                                                        08216000
XWRDINDX DS    H                                                        08217000
YBITINDX DS    H                                                        08218000
TEMPY    DS    H                                                        08219000
VALHIGHX DS    H                                                        08220000
VALLOWX  DS    H                                                        08221000
SETRC    DS    H                                                        08222000
LABELL   DS    FL1                                                      08223000
LABELX   DS    FL1                                                      08224000
LABELY   DS    FL1                                                      08225000
LABELZ   DS    FL1                                                      08226000
BITMASK  DS    FL1                                                      08227000
LISTLN   DS    FL1                                                      08228000
@TS00001 DS    CL95                                                     08229000
         DS    CL1                                                      08230000
QURYAREA DS    CL44                                                     08231000
PRINTAB  DS    CL164                                                    08232000
SUBTITBF DS    CL121                                                    08233000
         DS    CL3                                                      08234000
PCARG    DS    CL33                                                     08235000
         ORG   PCARG                                                    08236000
PCMTLP   DS    AL4                                                      08237000
PCSTLP   DS    AL4                                                      08238000
PCFLP    DS    AL4                                                      08239000
PCPCP    DS    AL4                                                      08240000
PCPNL    DS    FL2                                                      08241000
PCPTL    DS    FL2                                                      08242000
PCPDL    DS    FL2                                                      08243000
PCMTLC   DS    FL2                                                      08244000
PCSTLC   DS    FL2                                                      08245000
PCFLC    DS    FL2                                                      08246000
PCLW     DS    FL2                                                      08247000
PCPD     DS    FL2                                                      08248000
PCDSC    DS    AL1                                                      08249000
         ORG   PCARG+33                                                 08250000
FLAGS    DS    BL3                                                      08251000
         ORG   FLAGS                                                    08252000
GOTCORE  DS    BL1                                                      08253000
LOXFOUND EQU   FLAGS+0                                                  08254000
TERMINAT EQU   FLAGS+0                                                  08255000
SETBIT   EQU   FLAGS+0                                                  08256000
XYZ1RPT  EQU   FLAGS+0                                                  08257000
XYZ2RPT  EQU   FLAGS+0                                                  08258000
CHECKFLG EQU   FLAGS+0                                                  08259000
FRSTUSSC EQU   FLAGS+0                                                  08260000
SETX     DS    BL1                                                      08261000
PRTXYZ1  EQU   FLAGS+1                                                  08262000
PRTXYZ2  EQU   FLAGS+1                                                  08263000
TABLEND  EQU   FLAGS+1                                                  08264000
RDTITLE  EQU   FLAGS+1                                                  08265000
RDHEAD   EQU   FLAGS+1                                                  08266000
XYZ1PRTD EQU   FLAGS+1                                                  08267000
XYZ2PRTD EQU   FLAGS+1                                                  08268000
RLBLPRTD DS    BL1                                                      08269000
LABELRD  EQU   FLAGS+2                                                  08270000
LIMITLOX EQU   FLAGS+2                                                  08271000
PROCHIX  EQU   FLAGS+2                                                  08272000
XYZ1PTRS EQU   FLAGS+2                                                  08273000
XYZ2PTRS EQU   FLAGS+2                                                  08274000
CELFOUND EQU   FLAGS+2                                                  08275000
@NM00095 EQU   FLAGS+2                                                  08276000
         ORG   FLAGS+3                                                  08277000
DMPSTG   DS    CL17                                                     08278000
HDSETCK  DS    CL4                                                      08279000
         ORG   HDSETCK                                                  08280000
HDSCKSTL DS    CL1                                                      08281000
         ORG   HDSCKSTL                                                 08282000
HDCKID11 DS    BL1                                                      08283000
HDCKID12 EQU   HDSCKSTL+0                                               08284000
HDCKID13 EQU   HDSCKSTL+0                                               08285000
@NM00105 EQU   HDSCKSTL+0                                               08286000
         ORG   HDSETCK+1                                                08287000
HDSHDRA  DS    CL1                                                      08288000
         ORG   HDSHDRA                                                  08289000
HDCKID14 DS    BL1                                                      08290000
@NM00106 EQU   HDSHDRA+0                                                08291000
         ORG   HDSETCK+2                                                08292000
HDSHDRB  DS    CL1                                                      08293000
         ORG   HDSHDRB                                                  08294000
HDCKID15 DS    BL1                                                      08295000
@NM00107 EQU   HDSHDRB+0                                                08296000
         ORG   HDSETCK+3                                                08297000
HDCKRES1 DS    CL1                                                      08298000
         ORG   HDSETCK+4                                                08299000
HDSETRD  DS    CL8                                                      08300000
         ORG   HDSETRD                                                  08301000
HDSRDSTL DS    CL1                                                      08302000
         ORG   HDSRDSTL                                                 08303000
HDRDID17 DS    BL1                                                      08304000
HDRDID18 EQU   HDSRDSTL+0                                               08305000
HDRDID19 EQU   HDSRDSTL+0                                               08306000
HDRDID35 EQU   HDSRDSTL+0                                               08307000
@NM00108 EQU   HDSRDSTL+0                                               08308000
         ORG   HDSETRD+1                                                08309000
HDSHDRE  DS    CL1                                                      08310000
         ORG   HDSHDRE                                                  08311000
HDRDID38 DS    BL1                                                      08312000
@NM00109 EQU   HDSHDRE+0                                                08313000
         ORG   HDSETRD+2                                                08314000
HDSHDRF  DS    CL1                                                      08315000
         ORG   HDSHDRF                                                  08316000
HDRDID16 DS    BL1                                                      08317000
@NM00110 EQU   HDSHDRF+0                                                08318000
         ORG   HDSETRD+3                                                08319000
HDSHDRG  DS    CL1                                                      08320000
         ORG   HDSHDRG                                                  08321000
HDRDID39 DS    BL1                                                      08322000
@NM00111 EQU   HDSHDRG+0                                                08323000
         ORG   HDSETRD+4                                                08324000
HDSHDRH  DS    CL1                                                      08325000
         ORG   HDSHDRH                                                  08326000
HDRDID14 DS    BL1                                                      08327000
@NM00112 EQU   HDSHDRH+0                                                08328000
         ORG   HDSETRD+5                                                08329000
HDSHDRI  DS    CL1                                                      08330000
         ORG   HDSHDRI                                                  08331000
HDRDID37 DS    BL1                                                      08332000
@NM00113 EQU   HDSHDRI+0                                                08333000
         ORG   HDSETRD+6                                                08334000
HDRDRES1 DS    CL2                                                      08335000
         ORG   HDSETRD+8                                                08336000
SSDRGLT  DS    CL20                                                     08337000
         DS    CL3                                                      08338000
SSINXLST DS    CL120                                                    08339000
         ORG   SSINXLST                                                 08340000
SSARRAY  DS    60H                                                      08341000
         ORG   SSINXLST+120                                             08342000
PRTXYZS  DS    CL8                                                      08343000
         ORG   PRTXYZS+0                                                08344000
PRTX     DS    CL2                                                      08345000
PRTY     DS    CL4                                                      08346000
PRTZ     DS    CL2                                                      08347000
         ORG   PRTXYZS+48                                               08348000
TEMPQCEL DS    8CL4                                                     08349000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08350000
@ENDDATD EQU   *                                                        08351000
IDCAU03  CSECT                                                          08352000
         DS    0F                                                       08353000
@SIZDATD DC    AL1(0)                                                   08354000
         DC    AL3(@ENDDATD-@DATD)                                      08355000
         DS    0D                                                       08356000
ONEYMASK DC    XL4'80000000'                                            08357000
REVRMASK DC    XL4'00000010'                                            08358000
ONEBIT   DC    XL1'80'                                                  08359000
SSMSGNUM DC    AL1(56)                                                  08360000
@CC01579 DC    C'QURYAREA'                                              08361000
@CC01538 DC    C'AUCA'                                                  08362000
@CC01546 DC    C'AUCZ'                                                  08363000
@CC01581 DC    C'AUCB'                                                  08364000
@CC01602 DC    C'AUCC'                                                  08365000
@CC01636 DC    C'SSAA'                                                  08366000
@CC01438 DC    C'UV0'                                                   08367000
@CC01440 DC    C'AU0'                                                   08368000
ALL      DC    CL3'ALL'                                                 08369000
FORMAT   DC    CL4'FORM'                                                08370000
HSECOND  DC    CL4'HSEC'                                                08371000
CLOCK    DC    CL4'KLOK'                                                08372000
SETZERO  DC    CL4'ZERO'                                                08373000
SETBLANK DC    CL4'BLNK'                                                08374000
NOSET    DC    CL4'NSET'                                                08375000
OVERRIDE DC    CL4'OVRD'                                                08376000
ACQUIRE  DC    CL8'ACQUIRE '                                            08377000
RELINQ   DC    CL8'RELINQ  '                                            08378000
MOUNT    DC    CL8'MOUNT   '                                            08379000
DEMOUNT  DC    CL8'DEMOUNT '                                            08380000
DEFINE   DC    CL8'DEFINE  '                                            08381000
MOVE     DC    CL8'MOVE    '                                            08382000
TRACEQ   DC    CL8'TRACEQ  '                                            08383000
COPYTABL DC    CL8'COPYTABL'                                            08384000
COPYCRTG DC    CL8'COPYCRTG'                                            08385000
COPYVOL  DC    CL8'COPYVOL '                                            08386000
VVIC     DC    CL8'VVIC    '                                            08387000
TUNE     DC    CL8'TUNE    '                                            08388000
NAMES    DC    CL4'NAME'                                                08389000
UNIT     DC    CL4'UNIT'                                                08390000
SHR      DC    CL4'SHR '                                                08391000
EXCL     DC    CL4'EXCL'                                                08392000
NOWAIT   DC    CL4'NWAI'                                                08393000
WAIT     DC    CL4'WAIT'                                                08394000
SECCHECK DC    CL8'SECCHECK'                                            08395000
SCRVTOC  DC    CL8'SCRVTOC '                                            08396000
GETVTOC  DC    CL8'GETVTOC '                                            08397000
PUTVTOC  DC    CL8'PUTVTOC '                                            08398000
RECATLG  DC    CL8'RECATLG '                                            08399000
INITVOL  DC    CL8'INITVOL '                                            08400000
CHECK    DC    CL8'CHECK   '                                            08401000
POSTUCB  DC    CL8'POSTUCB '                                            08402000
GET      DC    CL8'GET     '                                            08403000
PUT      DC    CL8'PUT     '                                            08404000
CLOSE    DC    CL8'CLOSE   '                                            08405000
OPEN     DC    CL8'OPEN    '                                            08406000
RVOPENR  DC    CL8'OPENR   '                                            08407000
RVRDCNT  DC    CL8'READCNT '                                            08408000
RVREADKD DC    CL8'READKD  '                                            08409000
RVSPACCR DC    CL8'SPACCR  '                                            08410000
RVFWRITE DC    CL8'FWRITE  '                                            08411000
RVWRITER DC    CL8'WRITEREC'                                            08412000
PUTLABEL DC    CL8'PUTLABEL'                                            08413000
GETLABEL DC    CL8'GETLABEL'                                            08414000
CANCEL   DC    CL8'CANCEL  '                                            08415000
SET      DC    CL8'SET     '                                            08416000
SELECTX  DC    CL8'SELECTX '                                            08417000
CHANGEX  DC    CL8'CHANGEX '                                            08418000
SELECTDD DC    CL8'SELECTDD'                                            08419000
SELECTDS DC    CL8'SELECTDS'                                            08420000
TBLREST  DC    CL8'TBLREST '                                            08421000
NULLIFYC DC    CL8'NULLIFYC'                                            08422000
RDMSC    DC    CL8'RDMSC   '                                            08423000
RDMSCTBL DC    CL8'RDMSCTBL'                                            08424000
RDCARTLB DC    CL8'RDCARTLB'                                            08425000
AUDITCEL DC    CL8'AUDITCEL'                                            08426000
RDSTGAD  DC    CL8'RDSTGAD '                                            08427000
ANDY     DC    X'1F'                                                    08428000
LASTCUBE DC    X'FF'                                                    08429000
CELLSET  DC    X'00'                                                    08430000
MSF1     DC    X'F1'                                                    08431000
ONEMSF   DC    X'01'                                                    08432000
MSF2     DC    X'F2'                                                    08433000
TWOMSF   DC    X'10'                                                    08434000
MSF3     DC    X'F3'                                                    08435000
THREEMSF DC    X'11'                                                    08436000
VACTCELL DC    X'55'                                                    08437000
NOACCRT  DC    X'5E'                                                    08438000
YMASK    DC    X'E0'                                                    08439000
BLANK12  DC    CL12'            '                                       08440000
BLANK6   DC    CL6'      '                                              08441000
BLANK    DC    CL1' '                                                   08442000
ASTERIC  DC    CL1'*'                                                   08443000
BLANK4   DC    CL4'    '                                                08444000
SCRCART  DC    CL4'SCRC'                                                08445000
CECART   DC    CL4'CE  '                                                08446000
         DS    CL1                                                      08447000
FIXAREA  DS    CL550                                                    08448000
         ORG   FIXAREA                                                  08449000
@NM00094 DC    550X'00'                                                 08450000
         ORG   FIXAREA+550                                              08451000
MODID    DC    CL4'AU02'                                                08452000
SSMODSS0 DC    CL3'SS0'                                                 08453000
SSMODCM0 DC    CL3'CM0'                                                 08454000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08455000
@01      EQU   01                                                       08456000
@02      EQU   02                                                       08457000
@03      EQU   03                                                       08458000
@04      EQU   04                                                       08459000
@05      EQU   05                                                       08460000
@06      EQU   06                                                       08461000
@07      EQU   07                                                       08462000
@08      EQU   08                                                       08463000
@09      EQU   09                                                       08464000
@10      EQU   10                                                       08465000
@11      EQU   11                                                       08466000
@12      EQU   12                                                       08467000
@13      EQU   13                                                       08468000
@14      EQU   14                                                       08469000
@15      EQU   15                                                       08470000
ENTRYNUM EQU   @02                                                      08471000
CURCBPTR EQU   @06                                                      08472000
CUBEPTR2 EQU   @04                                                      08473000
CUBEPTR  EQU   @02                                                      08474000
REVRESLT EQU   @05                                                      08475000
REVRBIT  EQU   @02                                                      08476000
XINDEX   EQU   @06                                                      08477000
TEMPX2   EQU   @05                                                      08478000
TEMPX    EQU   @05                                                      08479000
II       EQU   @03                                                      08480000
I        EQU   @04                                                      08481000
BYTINDX2 EQU   @02                                                      08482000
BYTINDEX EQU   @03                                                      08483000
CUBINDX2 EQU   @07                                                      08484000
BLKINDEX EQU   @07                                                      08485000
YY2      EQU   @03                                                      08486000
DMPINDEX EQU   @02                                                      08487000
IOCSPTR  EQU   @02                                                      08488000
TESTRC   EQU   @03                                                      08489000
REG12    EQU   @12                                                      08490000
REG11    EQU   @11                                                      08491000
REG10    EQU   @10                                                      08492000
REG9     EQU   @09                                                      08493000
RTNREG   EQU   @15                                                      08494000
REG6     EQU   @06                                                      08495000
REG7     EQU   @07                                                      08496000
REG14    EQU   @14                                                      08497000
QUERR1   EQU   @01                                                      08498000
REG0     EQU   @00                                                      08499000
REG1     EQU   @01                                                      08500000
REG13    EQU   @13                                                      08501000
REG15    EQU   @15                                                      08502000
REG2     EQU   @02                                                      08503000
REG3     EQU   @03                                                      08504000
REG4     EQU   @04                                                      08505000
REG5     EQU   @05                                                      08506000
REG8     EQU   @08                                                      08507000
IDCSAEP0 EQU   0                                                        08508000
IDCSAGS0 EQU   0                                                        08509000
IDCSAFS0 EQU   0                                                        08510000
IDCSASS0 EQU   0                                                        08511000
TRACE1   EQU   0                                                        08512000
OLDERID1 EQU   TRACE1                                                   08513000
TRACE2   EQU   0                                                        08514000
OLDERID2 EQU   TRACE2                                                   08515000
NEWID2   EQU   TRACE2+95                                                08516000
NEWERID2 EQU   5                                                        08517000
CIRAGL   EQU   0                                                        08518000
CIRTYPE  EQU   CIRAGL                                                   08519000
ALLAGL   EQU   0                                                        08520000
ALLSTS   EQU   ALLAGL+24                                                08521000
ALLDSP   EQU   ALLAGL+25                                                08522000
ALLORG   EQU   ALLAGL+26                                                08523000
ALLOPT   EQU   ALLAGL+28                                                08524000
UNITABL  EQU   0                                                        08525000
UNITADR  EQU   UNITABL+4                                                08526000
@NM00010 EQU   UNITADR                                                  08527000
UNITSTAT EQU   UNITABL+6                                                08528000
IDCIOPT0 EQU   0                                                        08529000
IOCSTR   EQU   0                                                        08530000
IOCDAD   EQU   IOCSTR                                                   08531000
IOCDLN   EQU   IOCSTR+4                                                 08532000
IOCDSO   EQU   IOCSTR+16                                                08533000
IOCRFM   EQU   IOCSTR+17                                                08534000
IOCMAC   EQU   IOCSTR+18                                                08535000
IOCMAC2  EQU   IOCSTR+19                                                08536000
IOCCHP   EQU   IOCSTR+20                                                08537000
IOCMSG   EQU   IOCSTR+21                                                08538000
IOCRBA   EQU   IOCSTR+40                                                08539000
IOCTTR   EQU   IOCRBA                                                   08540000
IOCMEM   EQU   IOCSTR+44                                                08541000
IOCNWM   EQU   IOCSTR+48                                                08542000
OPNAGL   EQU   0                                                        08543000
OPNOPT   EQU   OPNAGL                                                   08544000
OPNRFM   EQU   OPNAGL+1                                                 08545000
OPNTYP   EQU   OPNAGL+2                                                 08546000
OPNMOD   EQU   OPNAGL+3                                                 08547000
OPNDEV   EQU   OPNAGL+24                                                08548000
OPNDSO   EQU   OPNAGL+41                                                08549000
OPNOPT2  EQU   OPNAGL+42                                                08550000
IOINFOPT EQU   0                                                        08551000
UVOLLIST EQU   0                                                        08552000
UVOLENT  EQU   UVOLLIST+2                                               08553000
AMSTP011 EQU   0                                                        08554000
AMSTP042 EQU   0                                                        08555000
AMSTP044 EQU   0                                                        08556000
DARGLIST EQU   0                                                        08557000
DARGDBP  EQU   DARGLIST                                                 08558000
DARGRETP EQU   DARGLIST+4                                               08559000
DARGSTID EQU   DARGLIST+8                                               08560000
DARGSMOD EQU   DARGSTID                                                 08561000
DARGSENT EQU   DARGSTID+3                                               08562000
DARGILP  EQU   DARGLIST+12                                              08563000
DARGCNT  EQU   DARGLIST+14                                              08564000
DARGRETL EQU   DARGLIST+16                                              08565000
DARGARY  EQU   DARGLIST+20                                              08566000
DARGINS  EQU   DARGARY                                                  08567000
DARGINL  EQU   DARGARY+2                                                08568000
DARGDTM  EQU   DARGARY+4                                                08569000
FMTLIST  EQU   0                                                        08570000
FMTFLGS  EQU   FMTLIST                                                  08571000
FMTSPF   EQU   FMTLIST+2                                                08572000
FMTRFNO  EQU   FMTSPF                                                   08573000
FMTILEN  EQU   FMTRFNO                                                  08574000
FMTIOFF  EQU   FMTLIST+4                                                08575000
FMTTRBC  EQU   FMTIOFF                                                  08576000
FMTSTO   EQU   FMTTRBC                                                  08577000
FMTOCOL  EQU   FMTLIST+6                                                08578000
FMTCNVF  EQU   FMTLIST+10                                               08579000
ERCNVTAB EQU   0                                                        08580000
ERTYPE   EQU   ERCNVTAB                                                 08581000
EROPER   EQU   ERCNVTAB+1                                               08582000
EROSOPER EQU   ERCNVTAB+2                                               08583000
IDCDB010 EQU   0                                                        08584000
DMPITM   EQU   0                                                        08585000
DMPITMNM EQU   DMPITM                                                   08586000
DMPITMPT EQU   DMPITM+8                                                 08587000
DMPITMLN EQU   DMPITM+12                                                08588000
DMPITMTP EQU   DMPITM+14                                                08589000
DMPARY   EQU   0                                                        08590000
DMPTRM   EQU   0                                                        08591000
CCMSG    EQU   0                                                        08592000
CMMSG    EQU   0                                                        08593000
CMVOLFLG EQU   CMMSG+6                                                  08594000
CTMSG    EQU   0                                                        08595000
CTARRAY  EQU   CTMSG+4                                                  08596000
MDAGL    EQU   0                                                        08597000
MDFLAGS  EQU   MDAGL+30                                                 08598000
MDVTOC   EQU   MDAGL+32                                                 08599000
PUAGL    EQU   0                                                        08600000
CKAGL    EQU   0                                                        08601000
CKFLAGS  EQU   CKAGL+28                                                 08602000
EXCLAGL  EQU   0                                                        08603000
EXCLFLAG EQU   EXCLAGL+22                                               08604000
EXOARG   EQU   0                                                        08605000
EXOPT    EQU   EXOARG+32                                                08606000
EXFLG    EQU   EXOARG+33                                                08607000
EXGARG   EQU   0                                                        08608000
EXWRARG  EQU   0                                                        08609000
EXRWCHR  EQU   EXWRARG+26                                               08610000
EXSPACE  EQU   EXWRARG+36                                               08611000
EXPARG   EQU   0                                                        08612000
EXPDATA  EQU   EXPARG+12                                                08613000
EXPDATAB EQU   0                                                        08614000
EXPARRAY EQU   EXPDATAB+4                                               08615000
VS2AGL   EQU   0                                                        08616000
VSLABOPT EQU   VS2AGL+28                                                08617000
VS2MSG   EQU   VS2AGL+35                                                08618000
VS2RESOP EQU   VS2AGL+36                                                08619000
VS1AGL   EQU   0                                                        08620000
VSSECOPT EQU   VS1AGL+68                                                08621000
VSVTOPT  EQU   VS1AGL+69                                                08622000
VSCATOPT EQU   VS1AGL+70                                                08623000
VSRETURN EQU   VS1AGL+71                                                08624000
VSMSG    EQU   VS1AGL+72                                                08625000
VSRESOPT EQU   VS1AGL+73                                                08626000
RCTAGL   EQU   0                                                        08627000
RCTOPT   EQU   RCTAGL+8                                                 08628000
STAEPARM EQU   0                                                        08629000
STARCVY  EQU   STAEPARM+52                                              08630000
STARETRY EQU   STAEPARM+53                                              08631000
VOLLABEL EQU   0                                                        08632000
SV82LIST EQU   0                                                        08633000
@NM00072 EQU   SV82LIST+4                                               08634000
SV82DCBP EQU   @NM00072                                                 08635000
@NM00073 EQU   SV82LIST+12                                              08636000
SV82WRKP EQU   @NM00073                                                 08637000
SRTAGL   EQU   0                                                        08638000
LCTINFO  EQU   0                                                        08639000
LCTFLAGS EQU   LCTINFO+32                                               08640000
UCTAGL   EQU   0                                                        08641000
UCTFLAGS EQU   UCTAGL+68                                                08642000
SELAGL   EQU   0                                                        08643000
SELFLAGS EQU   SELAGL+22                                                08644000
DATESAGL EQU   0                                                        08645000
DATESOPT EQU   DATESAGL+20                                              08646000
VS3AGL   EQU   0                                                        08647000
VS3FLAGS EQU   VS3AGL+58                                                08648000
VSDVTOC  EQU   0                                                        08649000
VSDSTAT  EQU   0                                                        08650000
VSDSFLG1 EQU   VSDSTAT+16                                               08651000
VSDFLG2  EQU   VSDSTAT+17                                               08652000
VSDSCR   EQU   0                                                        08653000
VSDSCRFL EQU   VSDSCR+4                                                 08654000
VSDUSAGE EQU   0                                                        08655000
VSDDORG  EQU   VSDUSAGE+9                                               08656000
VSDALLOC EQU   VSDUSAGE+10                                              08657000
VSDUSEF  EQU   VSDUSAGE+11                                              08658000
VSDDSORG EQU   VSDUSAGE+16                                              08659000
VSDBLOCK EQU   0                                                        08660000
VSDSPACE EQU   VSDBLOCK+12                                              08661000
VSDARRAY EQU   VSDBLOCK+16                                              08662000
VSDVARY  EQU   VSDARRAY+48                                              08663000
CHK      EQU   0                                                        08664000
RDLBL    EQU   0                                                        08665000
FULL     EQU   0                                                        08666000
EMPTY    EQU   0                                                        08667000
CHALL    EQU   0                                                        08668000
MSF      EQU   0                                                        08669000
MSFVAL   EQU   MSF                                                      08670000
XRNG     EQU   0                                                        08671000
XRNGCNT  EQU   0                                                        08672000
LOWXPTR  EQU   0                                                        08673000
LOWX     EQU   0                                                        08674000
LOWXVAL  EQU   LOWX                                                     08675000
HIGHXPTR EQU   0                                                        08676000
HIGHX    EQU   0                                                        08677000
HIGHXVAL EQU   HIGHX                                                    08678000
CELL     EQU   0                                                        08679000
CELLCNT  EQU   0                                                        08680000
CELLXPTR EQU   0                                                        08681000
CELLX    EQU   0                                                        08682000
CELLXVAL EQU   CELLX                                                    08683000
CELLYPTR EQU   0                                                        08684000
CELLY    EQU   0                                                        08685000
CELLYVAL EQU   CELLY                                                    08686000
CELLZPTR EQU   0                                                        08687000
CELLZ    EQU   0                                                        08688000
CELLZVAL EQU   CELLZ                                                    08689000
OFILE    EQU   0                                                        08690000
ODS      EQU   0                                                        08691000
ODSFLG   EQU   ODS+10                                                   08692000
LIST     EQU   0                                                        08693000
NLIST    EQU   0                                                        08694000
LFILE    EQU   0                                                        08695000
LDS      EQU   0                                                        08696000
LDSFLG   EQU   LDS+10                                                   08697000
RDCKLIST EQU   0                                                        08698000
QUCODE   EQU   RDCKLIST+6                                               08699000
QULIB    EQU   QUCODE                                                   08700000
QUSECT   EQU   RDCKLIST+7                                               08701000
QUXADDR  EQU   QUSECT                                                   08702000
QUFLAG   EQU   QUXADDR                                                  08703000
QUPARM   EQU   RDCKLIST+8                                               08704000
QUPTR    EQU   RDCKLIST+40                                              08705000
BLKBUF   EQU   0                                                        08706000
HDRBLK   EQU   BLKBUF                                                   08707000
CUBEADDR EQU   HDRBLK+30                                                08708000
CELLMAP  EQU   BLKBUF+264                                               08709000
CELLCUBE EQU   CELLMAP+8                                                08710000
ORIGMAP  EQU   BLKBUF+1320                                              08711000
ORIGCUBE EQU   ORIGMAP+8                                                08712000
DIAGBUF  EQU   BLKBUF+2376                                              08713000
RECDBUF  EQU   DIAGBUF+256                                              08714000
WORKMAP  EQU   0                                                        08715000
WRKBLK   EQU   WORKMAP                                                  08716000
WRKCUBE  EQU   WRKBLK+8                                                 08717000
XYZ1     EQU   0                                                        08718000
XYZ1BLK  EQU   XYZ1                                                     08719000
XYZ1CUBE EQU   XYZ1BLK+8                                                08720000
XYZ2     EQU   0                                                        08721000
XYZ2BLK  EQU   XYZ2                                                     08722000
XYZ2CUBE EQU   XYZ2BLK+8                                                08723000
CHUNK    EQU   0                                                        08724000
CUBE     EQU   0                                                        08725000
CUBEBYTE EQU   0                                                        08726000
X0Z0     EQU   CUBEBYTE                                                 08727000
X0Z1     EQU   CUBEBYTE                                                 08728000
X1Z0     EQU   CUBEBYTE                                                 08729000
X1Z1     EQU   CUBEBYTE                                                 08730000
X2Z0     EQU   CUBEBYTE                                                 08731000
X2Z1     EQU   CUBEBYTE                                                 08732000
X3Z0     EQU   CUBEBYTE                                                 08733000
X3Z1     EQU   CUBEBYTE                                                 08734000
CURCK    EQU   0                                                        08735000
CURCUBE  EQU   0                                                        08736000
CURCBYTE EQU   0                                                        08737000
CURX0Z0  EQU   CURCBYTE                                                 08738000
CURX0Z1  EQU   CURCBYTE                                                 08739000
CURX1Z0  EQU   CURCBYTE                                                 08740000
CURX1Z1  EQU   CURCBYTE                                                 08741000
CURX2Z0  EQU   CURCBYTE                                                 08742000
CURX2Z1  EQU   CURCBYTE                                                 08743000
CURX3Z0  EQU   CURCBYTE                                                 08744000
CURX3Z1  EQU   CURCBYTE                                                 08745000
CHUNK2   EQU   0                                                        08746000
CUBE2    EQU   0                                                        08747000
CUBEBYT2 EQU   0                                                        08748000
X0Z02    EQU   CUBEBYT2                                                 08749000
X0Z12    EQU   CUBEBYT2                                                 08750000
X1Z02    EQU   CUBEBYT2                                                 08751000
X1Z12    EQU   CUBEBYT2                                                 08752000
X2Z02    EQU   CUBEBYT2                                                 08753000
X2Z12    EQU   CUBEBYT2                                                 08754000
X3Z02    EQU   CUBEBYT2                                                 08755000
X3Z12    EQU   CUBEBYT2                                                 08756000
AMSTP041 EQU   0                                                        08757000
AMSTP043 EQU   0                                                        08758000
IDCIOCL0 EQU   0                                                        08759000
IDCIOCO0 EQU   0                                                        08760000
IDCIOGT0 EQU   0                                                        08761000
IDCIOIT0 EQU   0                                                        08762000
IDCIOOP0 EQU   0                                                        08763000
IDCIOPO0 EQU   0                                                        08764000
IDCIOSI0 EQU   0                                                        08765000
IDCIOST0 EQU   0                                                        08766000
IDCIOTM0 EQU   0                                                        08767000
IDCIOVY0 EQU   0                                                        08768000
IDCIO050 EQU   0                                                        08769000
IDCSAAL0 EQU   0                                                        08770000
IDCSACA0 EQU   0                                                        08771000
IDCSACL0 EQU   0                                                        08772000
IDCSACR0 EQU   0                                                        08773000
IDCSADE0 EQU   0                                                        08774000
IDCSADL0 EQU   0                                                        08775000
IDCSADQ0 EQU   0                                                        08776000
IDCSAFP0 EQU   0                                                        08777000
IDCSAGP0 EQU   0                                                        08778000
IDCSAID0 EQU   0                                                        08779000
IDCSALC0 EQU   0                                                        08780000
IDCSALD0 EQU   0                                                        08781000
IDCSALK0 EQU   0                                                        08782000
IDCSANQ0 EQU   0                                                        08783000
IDCSAPR0 EQU   0                                                        08784000
IDCSAPT0 EQU   0                                                        08785000
IDCSAQL0 EQU   0                                                        08786000
IDCSARC0 EQU   0                                                        08787000
IDCSARV0 EQU   0                                                        08788000
IDCSASC0 EQU   0                                                        08789000
IDCSASI0 EQU   0                                                        08790000
IDCSASN0 EQU   0                                                        08791000
IDCSAST0 EQU   0                                                        08792000
IDCSATI0 EQU   0                                                        08793000
IDCSAUC0 EQU   0                                                        08794000
IDCSAWO0 EQU   0                                                        08795000
IDCSA060 EQU   0                                                        08796000
IDCST010 EQU   0                                                        08797000
IDCTPER0 EQU   0                                                        08798000
LISTTEST EQU   0                                                        08799000
MAP      EQU   0                                                        08800000
NEWERID1 EQU   5                                                        08801000
GDTTBL   EQU   0                                                        08802000
GDTTR1   EQU   GDTTBL+8                                                 08803000
GDTTR2   EQU   GDTTBL+12                                                08804000
GDTDBG   EQU   GDTTBL+40                                                08805000
GDTSTC   EQU   GDTTBL+44                                                08806000
GDTPRT   EQU   GDTTBL+48                                                08807000
GDTESS   EQU   GDTTBL+52                                                08808000
GDTESA   EQU   GDTTBL+56                                                08809000
GDTRST   EQU   GDTTBL+60                                                08810000
GDTRES   EQU   GDTTBL+64                                                08811000
GDTCAL   EQU   GDTTBL+68                                                08812000
GDTGSP   EQU   GDTTBL+72                                                08813000
GDTFSP   EQU   GDTTBL+76                                                08814000
GDTGPL   EQU   GDTTBL+80                                                08815000
GDTFPL   EQU   GDTTBL+84                                                08816000
GDTLOD   EQU   GDTTBL+88                                                08817000
GDTDEL   EQU   GDTTBL+92                                                08818000
GDTPRL   EQU   GDTTBL+96                                                08819000
GDTEPL   EQU   GDTTBL+100                                               08820000
GDTTIM   EQU   GDTTBL+104                                               08821000
GDTIIO   EQU   GDTTBL+108                                               08822000
GDTTIO   EQU   GDTTBL+112                                               08823000
GDTOPN   EQU   GDTTBL+124                                               08824000
GDTCLS   EQU   GDTTBL+128                                               08825000
GDTGET   EQU   GDTTBL+132                                               08826000
GDTPUT   EQU   GDTTBL+136                                               08827000
GDTPOS   EQU   GDTTBL+140                                               08828000
GDTCPY   EQU   GDTTBL+144                                               08829000
GDTCAT   EQU   GDTTBL+148                                               08830000
GDTSNP   EQU   GDTTBL+164                                               08831000
GDTVFY   EQU   GDTTBL+172                                               08832000
GDTUID   EQU   GDTTBL+192                                               08833000
GDTPMT   EQU   GDTTBL+196                                               08834000
GDTCIR   EQU   GDTTBL+200                                               08835000
GDTLNK   EQU   GDTTBL+204                                               08836000
GDTALC   EQU   GDTTBL+208                                               08837000
GDTDLC   EQU   GDTTBL+212                                               08838000
GDTQAL   EQU   GDTTBL+216                                               08839000
GDTSTW   EQU   GDTTBL+220                                               08840000
GDTSSC   EQU   GDTTBL+224                                               08841000
GDTENQ   EQU   GDTTBL+228                                               08842000
GDTRSV   EQU   GDTTBL+232                                               08843000
GDTDEQ   EQU   GDTTBL+236                                               08844000
GDTSFO   EQU   GDTTBL+240                                               08845000
GDTWTO   EQU   GDTTBL+244                                               08846000
GDTSCR   EQU   GDTTBL+248                                               08847000
GDTUNT   EQU   GDTTBL+252                                               08848000
GDTRCT   EQU   GDTTBL+256                                               08849000
GDTIFO   EQU   GDTTBL+260                                               08850000
GDTEXP   EQU   GDTTBL+264                                               08851000
GDTSTA   EQU   GDTTBL+268                                               08852000
GDTERR   EQU   GDTTBL+272                                               08853000
GDTUNC   EQU   GDTTBL+276                                               08854000
GDTLOC   EQU   GDTTBL+280                                               08855000
FDTTBL   EQU   0                                                        08856000
FDTPTR   EQU   FDTTBL+8                                                 08857000
BLKPTR   EQU   0                                                        08858000
PRINTME  EQU   0                                                        08859000
LABDSPTR EQU   0                                                        08860000
SSRCODE  EQU   0                                                        08861000
SSRHALF  EQU   SSRCODE+2                                                08862000
SSECBCD  EQU   0                                                        08863000
QWPARM   EQU   QUPARM                                                   08864000
QWRES1   EQU   QWPARM                                                   08865000
QWFLAG   EQU   QWPARM+2                                                 08866000
QTPARM   EQU   QUPARM                                                   08867000
QTID     EQU   QTPARM                                                   08868000
QLPARM   EQU   QUPARM                                                   08869000
QLZYX    EQU   QLPARM                                                   08870000
QCPARM   EQU   QUPARM                                                   08871000
PARMQU   EQU   QUPARM                                                   08872000
YSQC     EQU   PARMQU                                                   08873000
READLZYX EQU   QLZYX                                                    08874000
READL    EQU   READLZYX                                                 08875000
READL1   EQU   READL                                                    08876000
READL2   EQU   READL                                                    08877000
READZ    EQU   READLZYX                                                 08878000
READX    EQU   READLZYX+1                                               08879000
CELLPARM EQU   DIAGBUF                                                  08880000
CKYS     EQU   CELLPARM                                                 08881000
CARTLAB  EQU   RECDBUF                                                  08882000
CARVOLID EQU   CARTLAB+4                                                08883000
CARADDR  EQU   CARTLAB+88                                               08884000
CARADDRL EQU   CARADDR                                                  08885000
CARL1    EQU   CARADDRL                                                 08886000
CARL2    EQU   CARADDRL                                                 08887000
CARADDRZ EQU   CARADDR                                                  08888000
CARADDRX EQU   CARADDR+1                                                08889000
CARTYPE  EQU   CARTLAB+92                                               08890000
CARTCE   EQU   CARTYPE                                                  08891000
CARTSCRC EQU   CARTYPE                                                  08892000
CARSEQ   EQU   CARTLAB+95                                               08893000
CARCSN1  EQU   CARTLAB+224                                              08894000
CARCSN2  EQU   CARTLAB+236                                              08895000
*                                      START UNREFERENCED COMPONENTS    08896000
CARES5   EQU   CARTLAB+248                                              08897000
CARES4   EQU   CARTLAB+96                                               08898000
CARES3   EQU   CARTLAB+93                                               08899000
CARTRESB EQU   CARTYPE                                                  08900000
CARTRESA EQU   CARTYPE                                                  08901000
CARES2   EQU   CARTLAB+90                                               08902000
CARADDRY EQU   CARADDR                                                  08903000
CARES1   EQU   CARTLAB+10                                               08904000
CARVOL   EQU   CARTLAB                                                  08905000
@NM00101 EQU   CELLPARM+32                                              08906000
READY    EQU   READLZYX                                                 08907000
QCMAD3Z1 EQU   QCPARM+28                                                08908000
QCMAD3Z0 EQU   QCPARM+24                                                08909000
QCMAD2Z1 EQU   QCPARM+20                                                08910000
QCMAD2Z0 EQU   QCPARM+16                                                08911000
QCMAD1Z1 EQU   QCPARM+12                                                08912000
QCMAD1Z0 EQU   QCPARM+8                                                 08913000
QCMAD0Z1 EQU   QCPARM+4                                                 08914000
QCMAD0Z0 EQU   QCPARM                                                   08915000
QLRES    EQU   QLPARM+2                                                 08916000
QTRES    EQU   QTPARM+24                                                08917000
QTDASCHR EQU   QTPARM+20                                                08918000
QTDATA   EQU   QTPARM+2                                                 08919000
QTFLAG   EQU   QTPARM+1                                                 08920000
QTTABID  EQU   QTID                                                     08921000
QWRES2   EQU   QWPARM+3                                                 08922000
@NM00091 EQU   QWFLAG                                                   08923000
QWMEM    EQU   QWFLAG                                                   08924000
QWSSID   EQU   QWRES1                                                   08925000
@NM00114 EQU   SSRCODE                                                  08926000
FDTVERB  EQU   FDTTBL                                                   08927000
GDTECT   EQU   GDTTBL+188                                               08928000
GDTPSB   EQU   GDTTBL+184                                               08929000
GDTUPT   EQU   GDTTBL+180                                               08930000
GDTCMB   EQU   GDTTBL+176                                               08931000
GDTSPR   EQU   GDTTBL+168                                               08932000
@NM00001 EQU   GDTTBL+160                                               08933000
GDTABH   EQU   GDTTBL+156                                               08934000
GDTABT   EQU   GDTTBL+152                                               08935000
GDTTOH   EQU   GDTTBL+120                                               08936000
GDTRIP   EQU   GDTTBL+116                                               08937000
GDTIOH   EQU   GDTTBL+36                                                08938000
GDTSAH   EQU   GDTTBL+32                                                08939000
GDTTPH   EQU   GDTTBL+28                                                08940000
GDTRIH   EQU   GDTTBL+24                                                08941000
GDTSTH   EQU   GDTTBL+20                                                08942000
GDTDBH   EQU   GDTTBL+16                                                08943000
GDTPRM   EQU   GDTTBL+4                                                 08944000
GDTHDR   EQU   GDTTBL                                                   08945000
@NM00104 EQU   XYZ2BLK                                                  08946000
@NM00103 EQU   XYZ1BLK                                                  08947000
@NM00102 EQU   WRKBLK                                                   08948000
@NM00100 EQU   DIAGBUF+248                                              08949000
@NM00099 EQU   DIAGBUF                                                  08950000
@NM00098 EQU   ORIGMAP                                                  08951000
@NM00097 EQU   CELLMAP                                                  08952000
BITMAP   EQU   HDRBLK+8                                                 08953000
@NM00096 EQU   HDRBLK                                                   08954000
QURES1   EQU   QUFLAG                                                   08955000
QURES    EQU   RDCKLIST+5                                               08956000
QUORD    EQU   RDCKLIST+4                                               08957000
QULEN    EQU   RDCKLIST                                                 08958000
LDSVAL   EQU   LDS+21                                                   08959000
LDSLEN   EQU   LDS+20                                                   08960000
LDSMEM   EQU   LDS+12                                                   08961000
LDSMLN   EQU   LDS+11                                                   08962000
LDSFUQ   EQU   LDSFLG                                                   08963000
LDSPOS   EQU   LDS+9                                                    08964000
LDSPAS   EQU   LDS+1                                                    08965000
LDSPLN   EQU   LDS                                                      08966000
LFILEVAL EQU   LFILE+1                                                  08967000
LFILELEN EQU   LFILE                                                    08968000
ODSVAL   EQU   ODS+21                                                   08969000
ODSLEN   EQU   ODS+20                                                   08970000
ODSMEM   EQU   ODS+12                                                   08971000
ODSMLN   EQU   ODS+11                                                   08972000
ODSFUQ   EQU   ODSFLG                                                   08973000
ODSPOS   EQU   ODS+9                                                    08974000
ODSPAS   EQU   ODS+1                                                    08975000
ODSPLN   EQU   ODS                                                      08976000
OFILEVAL EQU   OFILE+1                                                  08977000
OFILELEN EQU   OFILE                                                    08978000
VSDDSN   EQU   VSDARRAY+4                                               08979000
VSDVOLCT EQU   VSDARRAY                                                 08980000
VSDFMT0  EQU   VSDBLOCK+8                                               08981000
VSDVTOCS EQU   VSDBLOCK+4                                               08982000
VSDELEM  EQU   VSDBLOCK                                                 08983000
VSDFREE  EQU   VSDUSAGE+24                                              08984000
VSDALLC  EQU   VSDUSAGE+19                                              08985000
VSDDSOR3 EQU   VSDDSORG+2                                               08986000
@NM00090 EQU   VSDDSORG                                                 08987000
VSDSCAL  EQU   VSDUSAGE+12                                              08988000
@NM00089 EQU   VSDUSEF                                                  08989000
VSDCALFR EQU   VSDUSEF                                                  08990000
@NM00088 EQU   VSDALLOC                                                 08991000
VSDABSTR EQU   VSDALLOC                                                 08992000
VSDABLK  EQU   VSDALLOC                                                 08993000
VSDATRK  EQU   VSDALLOC                                                 08994000
VSDACYL  EQU   VSDALLOC                                                 08995000
@NM00087 EQU   VSDDORG                                                  08996000
VSDOU    EQU   VSDDORG                                                  08997000
VSDOIS   EQU   VSDDORG                                                  08998000
VSDODA   EQU   VSDDORG                                                  08999000
VSDOUN   EQU   VSDDORG                                                  09000000
VSDOPS   EQU   VSDDORG                                                  09001000
VSDOPO   EQU   VSDDORG                                                  09002000
VSDEXTS  EQU   VSDUSAGE+8                                               09003000
VSDSECAL EQU   VSDUSAGE+4                                               09004000
VSDFTRK  EQU   VSDUSAGE+2                                               09005000
VSDTRKS  EQU   VSDUSAGE                                                 09006000
@NM00086 EQU   VSDSCR+5                                                 09007000
@NM00085 EQU   VSDSCRFL                                                 09008000
VSDVSAM  EQU   VSDSCRFL                                                 09009000
VSDCATLC EQU   VSDSCRFL                                                 09010000
VSDACBPT EQU   VSDSCR                                                   09011000
VSDPRTC  EQU   VSDSTAT+25                                               09012000
VSDCAT   EQU   VSDSTAT+22                                               09013000
VSDEXP   EQU   VSDSTAT+20                                               09014000
VSDCRE   EQU   VSDSTAT+18                                               09015000
@NM00084 EQU   VSDFLG2                                                  09016000
VSDERROR EQU   VSDFLG2                                                  09017000
VSDPROT  EQU   VSDFLG2                                                  09018000
VSDPWW   EQU   VSDFLG2                                                  09019000
VSDPWR   EQU   VSDFLG2                                                  09020000
@NM00083 EQU   VSDSFLG1                                                 09021000
VSDCVSAM EQU   VSDSFLG1                                                 09022000
VSDCATLG EQU   VSDSFLG1                                                 09023000
VSDVSAME EQU   VSDSFLG1                                                 09024000
VSDVSAMC EQU   VSDSFLG1                                                 09025000
VSDVTOCE EQU   VSDSFLG1                                                 09026000
VSDVTOCC EQU   VSDSFLG1                                                 09027000
VSDOWNER EQU   VSDSTAT+8                                                09028000
VSDEXPIR EQU   VSDSTAT+4                                                09029000
VSDCREAT EQU   VSDSTAT                                                  09030000
VSDFRCCL EQU   VSDVTOC+21                                               09031000
@NM00082 EQU   VSDVTOC+20                                               09032000
VSDFREXT EQU   VSDVTOC+16                                               09033000
@NM00081 EQU   VSDVTOC+15                                               09034000
VSDFRTRK EQU   VSDVTOC+11                                               09035000
@NM00080 EQU   VSDVTOC+10                                               09036000
VSDFRCYL EQU   VSDVTOC+6                                                09037000
@NM00079 EQU   VSDVTOC                                                  09038000
@NM00078 EQU   VS3FLAGS                                                 09039000
VS3SYSNM EQU   VS3FLAGS                                                 09040000
VS3UNCAT EQU   VS3FLAGS                                                 09041000
VS3SCR   EQU   VS3FLAGS                                                 09042000
VS3USAGE EQU   VS3FLAGS                                                 09043000
VS3STAT  EQU   VS3FLAGS                                                 09044000
VS3DD    EQU   VS3AGL+50                                                09045000
VS3VOL   EQU   VS3AGL+44                                                09046000
VS3POOL  EQU   VS3AGL+40                                                09047000
VS3DEV   EQU   VS3AGL+36                                                09048000
VS3UCBP  EQU   VS3AGL+32                                                09049000
VS3CREAT EQU   VS3AGL+28                                                09050000
VS3EXPIR EQU   VS3AGL+24                                                09051000
VS3AST   EQU   VS3AGL+22                                                09052000
VS3LEVLN EQU   VS3AGL+20                                                09053000
VS3LEVP  EQU   VS3AGL+16                                                09054000
VS3EXDSP EQU   VS3AGL+12                                                09055000
VS3LISTP EQU   VS3AGL+8                                                 09056000
VS3HEAD  EQU   VS3AGL                                                   09057000
@NM00077 EQU   DATESOPT                                                 09058000
DATDAYOP EQU   DATESOPT                                                 09059000
DATDTEOP EQU   DATESOPT                                                 09060000
DATSUB   EQU   DATESOPT                                                 09061000
DATADD   EQU   DATESOPT                                                 09062000
DATRETRN EQU   DATESAGL+16                                              09063000
DATDAYS  EQU   DATESAGL+12                                              09064000
DATDATE  EQU   DATESAGL+8                                               09065000
DATHEAD  EQU   DATESAGL                                                 09066000
@NM00076 EQU   SELFLAGS                                                 09067000
SELVOL   EQU   SELAGL+16                                                09068000
SELDDNP  EQU   SELAGL+12                                                09069000
SELUCBP  EQU   SELAGL+8                                                 09070000
SELHEAD  EQU   SELAGL                                                   09071000
@NM00075 EQU   UCTFLAGS                                                 09072000
UCTVSCAT EQU   UCTFLAGS                                                 09073000
UCTDD    EQU   UCTAGL+60                                                09074000
UCTVOLP  EQU   UCTAGL+56                                                09075000
UCTACBP  EQU   UCTAGL+52                                                09076000
UCTDSN   EQU   UCTAGL+8                                                 09077000
UCTHEAD  EQU   UCTAGL                                                   09078000
@NM00074 EQU   LCTFLAGS                                                 09079000
LCTVSCAT EQU   LCTFLAGS                                                 09080000
LCTOWNER EQU   LCTINFO+24                                               09081000
LCTEXPIR EQU   LCTINFO+20                                               09082000
LCTCREAT EQU   LCTINFO+16                                               09083000
LCTACBP  EQU   LCTINFO+12                                               09084000
LCTMULVC EQU   LCTINFO+8                                                09085000
LCTHEAD  EQU   LCTINFO                                                  09086000
SRTWORKP EQU   SRTAGL+28                                                09087000
SRTFLDLN EQU   SRTAGL+24                                                09088000
SRTPOSIT EQU   SRTAGL+20                                                09089000
SRTLEN   EQU   SRTAGL+16                                                09090000
SRTNUM   EQU   SRTAGL+12                                                09091000
SRTADDR  EQU   SRTAGL+8                                                 09092000
SRTHEAD  EQU   SRTAGL                                                   09093000
SV82DEBP EQU   SV82WRKP                                                 09094000
SV82TTRP EQU   SV82LIST+8                                               09095000
SV82VOLP EQU   SV82DCBP                                                 09096000
SV82UCBP EQU   SV82LIST+1                                               09097000
SV82CODE EQU   SV82LIST                                                 09098000
VOLRESV3 EQU   VOLLABEL+55                                              09099000
VOLOWNER EQU   VOLLABEL+45                                              09100000
VOLRESV1 EQU   VOLLABEL+20                                              09101000
VOLVTOC  EQU   VOLLABEL+15                                              09102000
VOLSECTY EQU   VOLLABEL+14                                              09103000
VOLSERNO EQU   VOLLABEL+8                                               09104000
VOLNO    EQU   VOLLABEL+7                                               09105000
VOLLABI  EQU   VOLLABEL+4                                               09106000
VOLKEY   EQU   VOLLABEL                                                 09107000
STAVTTR  EQU   STAEPARM+54                                              09108000
@NM00071 EQU   STARETRY                                                 09109000
STAVTOC  EQU   STARETRY                                                 09110000
STAOFF   EQU   STARETRY                                                 09111000
STAIO05  EQU   STARETRY                                                 09112000
@NM00070 EQU   STARCVY                                                  09113000
STACLEAR EQU   STARCVY                                                  09114000
STAVPOST EQU   STARCVY                                                  09115000
STAVENQ  EQU   STARCVY                                                  09116000
STAVDMNT EQU   STARCVY                                                  09117000
STAVMNT  EQU   STARCVY                                                  09118000
STATCB   EQU   STAEPARM+48                                              09119000
STARTADD EQU   STAEPARM+44                                              09120000
STAEXSAV EQU   STAEPARM+40                                              09121000
STARTSAV EQU   STAEPARM+36                                              09122000
STARTTR  EQU   STAEPARM+32                                              09123000
@NM00069 EQU   STAEPARM+30                                              09124000
STARVOL  EQU   STAEPARM+24                                              09125000
STARUCB  EQU   STAEPARM+20                                              09126000
@NM00068 EQU   STAEPARM+18                                              09127000
STAVVOL  EQU   STAEPARM+12                                              09128000
STAVUCB  EQU   STAEPARM+8                                               09129000
STAHEAD  EQU   STAEPARM                                                 09130000
RCTDSET  EQU   RCTAGL+32                                                09131000
RCTNVOL  EQU   RCTAGL+26                                                09132000
RCTOVOL  EQU   RCTAGL+20                                                09133000
RCTNDEV  EQU   RCTAGL+16                                                09134000
RCTODEV  EQU   RCTAGL+12                                                09135000
@NM00067 EQU   RCTAGL+10                                                09136000
@NM00066 EQU   RCTOPT                                                   09137000
RCTVOL   EQU   RCTOPT                                                   09138000
RCTDEV   EQU   RCTOPT                                                   09139000
RCTHEAD  EQU   RCTAGL                                                   09140000
@NM00065 EQU   VSRESOPT                                                 09141000
VSREAL   EQU   VSRESOPT                                                 09142000
VSRES    EQU   VSRESOPT                                                 09143000
@NM00064 EQU   VSMSG                                                    09144000
VSTOV    EQU   VSMSG                                                    09145000
VSFROMV  EQU   VSMSG                                                    09146000
@NM00063 EQU   VSRETURN                                                 09147000
VSUCAT   EQU   VSRETURN                                                 09148000
VSVSAM   EQU   VSRETURN                                                 09149000
@NM00062 EQU   VSCATOPT                                                 09150000
VSLIST   EQU   VSCATOPT                                                 09151000
VSSERIAL EQU   VSCATOPT                                                 09152000
VSDEVICE EQU   VSCATOPT                                                 09153000
@NM00061 EQU   VSVTOPT                                                  09154000
VSVSFLAG EQU   VSVTOPT                                                  09155000
VSALTTRK EQU   VSVTOPT                                                  09156000
VSTIME   EQU   VSVTOPT                                                  09157000
VSUCMAST EQU   VSSECOPT                                                 09158000
VSOPCAT  EQU   VSSECOPT                                                 09159000
VSUCTEST EQU   VSSECOPT                                                 09160000
VSWRITE  EQU   VSSECOPT                                                 09161000
VSREAD   EQU   VSSECOPT                                                 09162000
VSNONONV EQU   VSSECOPT                                                 09163000
VSMASTER EQU   VSSECOPT                                                 09164000
VSNOVSAM EQU   VSSECOPT                                                 09165000
VSODEVP  EQU   VS1AGL+64                                                09166000
VSOSERP  EQU   VS1AGL+60                                                09167000
VSDEVP   EQU   VS1AGL+56                                                09168000
VSSERP   EQU   VS1AGL+52                                                09169000
VSPFILEP EQU   VS1AGL+48                                                09170000
VSPSWDP  EQU   VS1AGL+44                                                09171000
VSCATDDP EQU   VS1AGL+40                                                09172000
VSACBP   EQU   VS1AGL+36                                                09173000
VSCATP   EQU   VS1AGL+32                                                09174000
VSNXTATP EQU   VS1AGL+28                                                09175000
VSNUMATP EQU   VS1AGL+24                                                09176000
VSIOP    EQU   VS1AGL+20                                                09177000
VSFILEP  EQU   VS1AGL+16                                                09178000
VSVOLP   EQU   VS1AGL+12                                                09179000
VSUCBP   EQU   VS1AGL+8                                                 09180000
VSHEAD   EQU   VS1AGL                                                   09181000
VSVTOCPT EQU   VS2AGL+48                                                09182000
@NM00060 EQU   VS2AGL+45                                                09183000
VSDDNAME EQU   VS2AGL+37                                                09184000
@NM00059 EQU   VS2RESOP                                                 09185000
VS2REAL  EQU   VS2RESOP                                                 09186000
VS2RES   EQU   VS2RESOP                                                 09187000
@NM00058 EQU   VS2MSG                                                   09188000
VS2TOV   EQU   VS2MSG                                                   09189000
VSVOLUME EQU   VS2AGL+29                                                09190000
@NM00057 EQU   VSLABOPT                                                 09191000
VSNOVTOC EQU   VSLABOPT                                                 09192000
VSVOLSER EQU   VSLABOPT                                                 09193000
VSOWNER  EQU   VSLABOPT                                                 09194000
VSIOBKPT EQU   VS2AGL+24                                                09195000
VSVOLPTR EQU   VS2AGL+20                                                09196000
VSOWNPTR EQU   VS2AGL+16                                                09197000
VSVTOCSZ EQU   VS2AGL+12                                                09198000
VSUCBPTR EQU   VS2AGL+8                                                 09199000
VS2HEAD  EQU   VS2AGL                                                   09200000
EXPDATAL EQU   EXPARRAY+6                                               09201000
@NM00056 EQU   EXPARRAY+5                                               09202000
EXPKEYLN EQU   EXPARRAY+4                                               09203000
EXPDATAP EQU   EXPARRAY                                                 09204000
EXPRECNO EQU   EXPDATAB                                                 09205000
EXPCCHHR EQU   EXPARG+16                                                09206000
EXPCTLBK EQU   EXPARG+8                                                 09207000
EXPHEAD  EQU   EXPARG                                                   09208000
EXRWFUN  EQU   EXWRARG+46                                               09209000
@NM00055 EQU   EXSPACE+8                                                09210000
@NM00054 EQU   EXSPACE+6                                                09211000
@NM00053 EQU   EXSPACE+4                                                09212000
@NM00052 EQU   EXSPACE+1                                                09213000
@NM00051 EQU   EXSPACE                                                  09214000
EXRWKDLN EQU   EXWRARG+32                                               09215000
@NM00050 EQU   EXWRARG+31                                               09216000
EXRECNUM EQU   EXRWCHR+4                                                09217000
EXHH     EQU   EXRWCHR+2                                                09218000
EXCC     EQU   EXRWCHR                                                  09219000
EXCCWCNT EQU   EXWRARG+24                                               09220000
EXLOCPTR EQU   EXWRARG+20                                               09221000
EXRWDARE EQU   EXWRARG+16                                               09222000
EXRWIOAR EQU   EXWRARG+12                                               09223000
EXRWCTBL EQU   EXWRARG+8                                                09224000
EXRWRES  EQU   EXWRARG                                                  09225000
EXGDATAL EQU   EXGARG+30                                                09226000
@NM00049 EQU   EXGARG+29                                                09227000
EXGKEYLN EQU   EXGARG+28                                                09228000
EXGDATAP EQU   EXGARG+24                                                09229000
EXGRECNO EQU   EXGARG+20                                                09230000
EXGCCHH2 EQU   EXGARG+16                                                09231000
EXGCCHH1 EQU   EXGARG+12                                                09232000
EXGCTLBK EQU   EXGARG+8                                                 09233000
EXGHEAD  EQU   EXGARG                                                   09234000
EXOVTH   EQU   EXFLG                                                    09235000
EXORVT   EQU   EXFLG                                                    09236000
EXORDS   EQU   EXFLG                                                    09237000
EXOSPK   EQU   EXFLG                                                    09238000
EXORVS   EQU   EXFLG                                                    09239000
@NM00048 EQU   EXFLG                                                    09240000
EXOREAD  EQU   EXFLG                                                    09241000
@NM00047 EQU   EXOPT                                                    09242000
EXOREP   EQU   EXOPT                                                    09243000
EXOVTOC  EQU   EXOPT                                                    09244000
EXONEW   EQU   EXOPT                                                    09245000
EXOPASS  EQU   EXOPT                                                    09246000
EXOLAB   EQU   EXOPT                                                    09247000
EXOTAB   EQU   EXOPT                                                    09248000
EXOCTLBK EQU   EXOARG+28                                                09249000
EXOEXT   EQU   EXOARG+24                                                09250000
EXOUCB   EQU   EXOARG+20                                                09251000
EXOVSN   EQU   EXOARG+16                                                09252000
EXODSN   EQU   EXOARG+12                                                09253000
EXODDN   EQU   EXOARG+8                                                 09254000
EXOHEAD  EQU   EXOARG                                                   09255000
@NM00046 EQU   EXCLFLAG                                                 09256000
EXCLMNT  EQU   EXCLFLAG                                                 09257000
EXCLVOL  EQU   EXCLAGL+16                                               09258000
EXCLDDP  EQU   EXCLAGL+12                                               09259000
EXCLUCBP EQU   EXCLAGL+8                                                09260000
EXCLHEAD EQU   EXCLAGL                                                  09261000
@NM00045 EQU   CKFLAGS                                                  09262000
CKDMTABL EQU   CKFLAGS                                                  09263000
CKRETTYP EQU   CKFLAGS                                                  09264000
CKTESTVT EQU   CKFLAGS                                                  09265000
CKLABELP EQU   CKAGL+24                                                 09266000
CKDATYPE EQU   CKAGL+20                                                 09267000
CKDDNAME EQU   CKAGL+12                                                 09268000
CKUCBPTR EQU   CKAGL+8                                                  09269000
CKHEAD   EQU   CKAGL                                                    09270000
PULABELP EQU   PUAGL+16                                                 09271000
PUTTRPTR EQU   PUAGL+12                                                 09272000
PUUCBPTR EQU   PUAGL+8                                                  09273000
PUHEAD   EQU   PUAGL                                                    09274000
MDR      EQU   MDVTOC+4                                                 09275000
MDHH     EQU   MDVTOC+2                                                 09276000
MDCC     EQU   MDVTOC                                                   09277000
@NM00044 EQU   MDAGL+31                                                 09278000
MDVTOCTR EQU   MDFLAGS                                                  09279000
MDFORCE  EQU   MDFLAGS                                                  09280000
MDDEQ    EQU   MDFLAGS                                                  09281000
MDENQ    EQU   MDFLAGS                                                  09282000
MDWAIT   EQU   MDFLAGS                                                  09283000
MDPOST   EQU   MDFLAGS                                                  09284000
MDCLEAR  EQU   MDFLAGS                                                  09285000
MDNEWVOL EQU   MDFLAGS                                                  09286000
MDLABEL  EQU   MDAGL+24                                                 09287000
MDPUAGL  EQU   MDAGL+20                                                 09288000
MDDDNAME EQU   MDAGL+12                                                 09289000
MDUCBPTR EQU   MDAGL+8                                                  09290000
MDHEAD   EQU   MDAGL                                                    09291000
CTTBLRR  EQU   CTARRAY+3                                                09292000
CTTBLHH  EQU   CTARRAY+2                                                09293000
CTTBLCC  EQU   CTARRAY+1                                                09294000
CTTBLID  EQU   CTARRAY                                                  09295000
CTREALH  EQU   CTMSG+3                                                  09296000
CTREALCC EQU   CTMSG+1                                                  09297000
@NM00043 EQU   CTMSG                                                    09298000
CMCSN2   EQU   CMMSG+28                                                 09299000
CMCSN1   EQU   CMMSG+16                                                 09300000
CMNUMCRT EQU   CMMSG+15                                                 09301000
@NM00042 EQU   CMMSG+14                                                 09302000
CMNEWVOL EQU   CMMSG+8                                                  09303000
@NM00041 EQU   CMMSG+7                                                  09304000
@NM00040 EQU   CMVOLFLG                                                 09305000
CMRONLY  EQU   CMVOLFLG                                                 09306000
CMBIND   EQU   CMVOLFLG                                                 09307000
CMSCRCRT EQU   CMVOLFLG                                                 09308000
CMEXCL   EQU   CMVOLFLG                                                 09309000
CMDERAS  EQU   CMVOLFLG                                                 09310000
CMSCRVOL EQU   CMVOLFLG                                                 09311000
CMCECART EQU   CMVOLFLG                                                 09312000
CMOLDVOL EQU   CMMSG                                                    09313000
CCOLDCSN EQU   CCMSG+24                                                 09314000
CCNEWCSN EQU   CCMSG+12                                                 09315000
@NM00039 EQU   CCMSG+10                                                 09316000
CCVOL    EQU   CCMSG+4                                                  09317000
@NM00038 EQU   CCMSG+2                                                  09318000
CCEJCODE EQU   CCMSG+1                                                  09319000
CCPSTCDE EQU   CCMSG                                                    09320000
@NM00037 EQU   DMPARY+15                                                09321000
DMPARYTP EQU   DMPARY+14                                                09322000
DMPARYEX EQU   DMPARY+12                                                09323000
DMPARYIC EQU   DMPARY+10                                                09324000
DMPARYSZ EQU   DMPARY+8                                                 09325000
DMPARYNM EQU   DMPARY                                                   09326000
@NM00036 EQU   DMPITM+15                                                09327000
@NM00035 EQU   ERCNVTAB+24                                              09328000
ERCPLPT  EQU   ERCNVTAB+20                                              09329000
ERCATRC  EQU   ERCNVTAB+16                                              09330000
ERDSNM   EQU   ERCNVTAB+12                                              09331000
@NM00034 EQU   ERCNVTAB+4                                               09332000
@NM00033 EQU   ERCNVTAB+3                                               09333000
@NM00032 EQU   EROSOPER                                                 09334000
EROSUCDX EQU   EROSOPER                                                 09335000
EROSCATL EQU   EROSOPER                                                 09336000
@NM00031 EQU   EROPER                                                   09337000
ERCATAL  EQU   EROPER                                                   09338000
ERCATDL  EQU   EROPER                                                   09339000
ERCATDE  EQU   EROPER                                                   09340000
ERCATLC  EQU   EROPER                                                   09341000
@NM00030 EQU   ERTYPE                                                   09342000
EROSCAT  EQU   ERTYPE                                                   09343000
ERCATLG  EQU   ERTYPE                                                   09344000
@NM00029 EQU   FMTCNVF+1                                                09345000
FMTAR    EQU   FMTCNVF+1                                                09346000
FMTBS    EQU   FMTCNVF+1                                                09347000
FMTSS    EQU   FMTCNVF+1                                                09348000
FMTAL    EQU   FMTCNVF+1                                                09349000
FMTZS    EQU   FMTCNVF+1                                                09350000
@NM00028 EQU   FMTCNVF                                                  09351000
FMTPU    EQU   FMTCNVF                                                  09352000
FMTBD    EQU   FMTCNVF                                                  09353000
FMTBHD   EQU   FMTCNVF                                                  09354000
FMTBHA   EQU   FMTCNVF                                                  09355000
FMTBH    EQU   FMTCNVF                                                  09356000
FMTOLEN  EQU   FMTLIST+8                                                09357000
FMTRIO   EQU   FMTOCOL                                                  09358000
FMTSPT   EQU   FMTSTO                                                   09359000
FMTSTL   EQU   FMTILEN                                                  09360000
@NM00027 EQU   FMTFLGS+1                                                09361000
FMTHDF   EQU   FMTFLGS                                                  09362000
FMTDFF   EQU   FMTFLGS                                                  09363000
FMTSTF   EQU   FMTFLGS                                                  09364000
FMTREPF  EQU   FMTFLGS                                                  09365000
FMTBDF   EQU   FMTFLGS                                                  09366000
FMTIDF   EQU   FMTFLGS                                                  09367000
FMTSCF   EQU   FMTFLGS                                                  09368000
FMTEOLF  EQU   FMTFLGS                                                  09369000
DARGPCT  EQU   DARGINL                                                  09370000
DARGREP  EQU   DARGINS                                                  09371000
@NM00026 EQU   DARGLIST+19                                              09372000
DARGIND  EQU   DARGLIST+18                                              09373000
UVOLVOL  EQU   UVOLENT+4                                                09374000
UVOLDEV  EQU   UVOLENT                                                  09375000
UVOLCNT  EQU   UVOLLIST                                                 09376000
@NM00025 EQU   IOINFOPT                                                 09377000
IOINFTMS EQU   IOINFOPT                                                 09378000
IOINFSUP EQU   IOINFOPT                                                 09379000
IOINFDSN EQU   IOINFOPT                                                 09380000
IOINFVOL EQU   IOINFOPT                                                 09381000
IOINFDVT EQU   IOINFOPT                                                 09382000
OPNVOL   EQU   OPNAGL+44                                                09383000
@NM00024 EQU   OPNAGL+43                                                09384000
@NM00023 EQU   OPNOPT2                                                  09385000
OPNOPTJM EQU   OPNOPT2                                                  09386000
@NM00022 EQU   OPNOPT2                                                  09387000
OPNOPTAS EQU   OPNOPT2                                                  09388000
@NM00021 EQU   OPNDSO                                                   09389000
OPNDSOPO EQU   OPNDSO                                                   09390000
OPNDSOIS EQU   OPNDSO                                                   09391000
OPNDSOPS EQU   OPNDSO                                                   09392000
OPNDSOAM EQU   OPNDSO                                                   09393000
OPNKYL   EQU   OPNAGL+40                                                09394000
OPNBLK   EQU   OPNAGL+36                                                09395000
OPNREC   EQU   OPNAGL+32                                                09396000
OPNDEVIX EQU   OPNDEV+4                                                 09397000
OPNDEVDT EQU   OPNDEV                                                   09398000
OPNCBP   EQU   OPNAGL+20                                                09399000
OPNDSN   EQU   OPNAGL+16                                                09400000
OPNPWA   EQU   OPNAGL+12                                                09401000
OPNDDN   EQU   OPNAGL+8                                                 09402000
OPNIOC   EQU   OPNAGL+4                                                 09403000
OPNMODRP EQU   OPNMOD                                                   09404000
OPNMODUB EQU   OPNMOD                                                   09405000
OPNMODRS EQU   OPNMOD                                                   09406000
OPNMODAX EQU   OPNMOD                                                   09407000
OPNMODRR EQU   OPNMOD                                                   09408000
OPNMODRC EQU   OPNMOD                                                   09409000
OPNMODAC EQU   OPNMOD                                                   09410000
OPNMODPD EQU   OPNMOD                                                   09411000
@NM00020 EQU   OPNTYP                                                   09412000
OPNTYPRV EQU   OPNTYP                                                   09413000
OPNTYPEX EQU   OPNTYP                                                   09414000
OPNTYPRA EQU   OPNTYP                                                   09415000
OPNTYPXM EQU   OPNTYP                                                   09416000
OPNTYPCI EQU   OPNTYP                                                   09417000
OPNTYPSO EQU   OPNTYP                                                   09418000
OPNTYPSI EQU   OPNTYP                                                   09419000
@NM00019 EQU   OPNRFM                                                   09420000
OPNRFMBK EQU   OPNRFM                                                   09421000
OPNRFMSF EQU   OPNRFM                                                   09422000
OPNRFMUN EQU   OPNRFM                                                   09423000
OPNRFMVR EQU   OPNRFM                                                   09424000
OPNRFMFX EQU   OPNRFM                                                   09425000
OPNOPTSK EQU   OPNOPT                                                   09426000
OPNOPTDR EQU   OPNOPT                                                   09427000
OPNOPTCR EQU   OPNOPT                                                   09428000
OPNOPTKS EQU   OPNOPT                                                   09429000
OPNOPTBK EQU   OPNOPT                                                   09430000
OPNOPTUP EQU   OPNOPT                                                   09431000
OPNOPTOT EQU   OPNOPT                                                   09432000
OPNOPTIN EQU   OPNOPT                                                   09433000
IOCEXT   EQU   IOCSTR+64                                                09434000
IOCREL   EQU   IOCSTR+60                                                09435000
IOCWORK  EQU   IOCSTR+56                                                09436000
IOCRRN   EQU   IOCSTR+52                                                09437000
IOCPNM   EQU   IOCNWM+2                                                 09438000
IOCPTL   EQU   IOCNWM                                                   09439000
IOCKYA   EQU   IOCMEM                                                   09440000
IOCVRC   EQU   IOCTTR                                                   09441000
IOCCBP   EQU   IOCSTR+36                                                09442000
IOCDSN   EQU   IOCSTR+32                                                09443000
IOCHURBA EQU   IOCSTR+28                                                09444000
IOCVOLSR EQU   IOCSTR+22                                                09445000
@NM00018 EQU   IOCMSG                                                   09446000
IOCMSGAE EQU   IOCMSG                                                   09447000
IOCMSGCE EQU   IOCMSG                                                   09448000
IOCMSGOE EQU   IOCMSG                                                   09449000
IOCMSGOP EQU   IOCMSG                                                   09450000
@NM00017 EQU   IOCMSG                                                   09451000
IOCCHPSY EQU   IOCCHP                                                   09452000
IOCCHPAS EQU   IOCCHP                                                   09453000
IOCCHPBK EQU   IOCCHP                                                   09454000
IOCCHPCR EQU   IOCCHP                                                   09455000
IOCCHPKS EQU   IOCCHP                                                   09456000
IOCCHPSK EQU   IOCCHP                                                   09457000
IOCCHPDR EQU   IOCCHP                                                   09458000
IOCCHPSQ EQU   IOCCHP                                                   09459000
@NM00016 EQU   IOCMAC2                                                  09460000
IOCMACPA EQU   IOCMAC2                                                  09461000
@NM00015 EQU   IOCMAC2                                                  09462000
IOCMACCP EQU   IOCMAC2                                                  09463000
IOCMACRR EQU   IOCMAC2                                                  09464000
IOCMACAS EQU   IOCMAC2                                                  09465000
IOCMACSK EQU   IOCMAC2                                                  09466000
@NM00014 EQU   IOCMAC                                                   09467000
IOCMACCC EQU   IOCMAC                                                   09468000
IOCMACDR EQU   IOCMAC                                                   09469000
IOCMACBK EQU   IOCMAC                                                   09470000
IOCMACCR EQU   IOCMAC                                                   09471000
IOCMACUP EQU   IOCMAC                                                   09472000
IOCMACOT EQU   IOCMAC                                                   09473000
IOCMACIN EQU   IOCMAC                                                   09474000
@NM00013 EQU   IOCRFM                                                   09475000
IOCRFMBK EQU   IOCRFM                                                   09476000
IOCRFMSF EQU   IOCRFM                                                   09477000
IOCRFMUN EQU   IOCRFM                                                   09478000
IOCRFMVR EQU   IOCRFM                                                   09479000
IOCRFMFX EQU   IOCRFM                                                   09480000
@NM00012 EQU   IOCDSO                                                   09481000
IOCDSOPO EQU   IOCDSO                                                   09482000
IOCDSOIS EQU   IOCDSO                                                   09483000
IOCDSOPS EQU   IOCDSO                                                   09484000
IOCDSOAM EQU   IOCDSO                                                   09485000
IOCRKP   EQU   IOCSTR+13                                                09486000
IOCKYL   EQU   IOCSTR+12                                                09487000
IOCTRN   EQU   IOCSTR+8                                                 09488000
UNITVTOC EQU   UNITABL+7                                                09489000
@NM00011 EQU   UNITSTAT                                                 09490000
UNITUSHR EQU   UNITSTAT                                                 09491000
UNITXSHR EQU   UNITSTAT                                                 09492000
UNITISHR EQU   UNITSTAT                                                 09493000
UNITUA   EQU   @NM00010+1                                               09494000
UNITCHA  EQU   @NM00010                                                 09495000
UNITUCB  EQU   UNITABL                                                  09496000
ALLUNCNT EQU   ALLAGL+30                                                09497000
ALLVLCNT EQU   ALLAGL+29                                                09498000
@NM00009 EQU   ALLOPT                                                   09499000
ALLOPTUN EQU   ALLOPT                                                   09500000
ALLOPTPV EQU   ALLOPT                                                   09501000
ALLOPTDS EQU   ALLOPT                                                   09502000
ALLOPTVL EQU   ALLOPT                                                   09503000
@NM00008 EQU   ALLORG+1                                                 09504000
ALLORGVS EQU   ALLORG+1                                                 09505000
@NM00007 EQU   ALLORG+1                                                 09506000
ALLORGGS EQU   ALLORG+1                                                 09507000
ALLORGUN EQU   ALLORG                                                   09508000
ALLORGPO EQU   ALLORG                                                   09509000
ALLORGMQ EQU   ALLORG                                                   09510000
ALLORGCQ EQU   ALLORG                                                   09511000
ALLORGCX EQU   ALLORG                                                   09512000
ALLORGDA EQU   ALLORG                                                   09513000
ALLORGPS EQU   ALLORG                                                   09514000
ALLORGIS EQU   ALLORG                                                   09515000
ALLDSPUN EQU   ALLDSP                                                   09516000
ALLDSPCG EQU   ALLDSP                                                   09517000
ALLDSPDE EQU   ALLDSP                                                   09518000
ALLDSPKP EQU   ALLDSP                                                   09519000
@NM00006 EQU   ALLDSP                                                   09520000
ALLSTSOD EQU   ALLSTS                                                   09521000
ALLSTSMD EQU   ALLSTS                                                   09522000
ALLSTSNW EQU   ALLSTS                                                   09523000
ALLSTSSR EQU   ALLSTS                                                   09524000
@NM00005 EQU   ALLSTS                                                   09525000
ALLPWD   EQU   ALLAGL+20                                                09526000
ALLVLP   EQU   ALLAGL+16                                                09527000
ALLULP   EQU   ALLAGL+12                                                09528000
ALLDDN   EQU   ALLAGL+4                                                 09529000
ALLDSN   EQU   ALLAGL                                                   09530000
CIRPID   EQU   CIRAGL+28                                                09531000
CIRPWD   EQU   CIRAGL+24                                                09532000
CIRCAT   EQU   CIRAGL+20                                                09533000
CIRWKP   EQU   CIRAGL+16                                                09534000
CIRTLR   EQU   CIRAGL+12                                                09535000
CIRHDR   EQU   CIRAGL+8                                                 09536000
CIRTLN   EQU   CIRAGL+6                                                 09537000
CIRHLN   EQU   CIRAGL+4                                                 09538000
@NM00004 EQU   CIRAGL+1                                                 09539000
@NM00003 EQU   CIRTYPE                                                  09540000
CIRTYPAQ EQU   CIRTYPE                                                  09541000
CIRTYP1Q EQU   CIRTYPE                                                  09542000
NEWID1   EQU   TRACE1+95                                                09543000
CALLID   EQU   OLDERID1+90                                              09544000
@NM00002 EQU   OLDERID1                                                 09545000
*                                      END UNREFERENCED COMPONENTS      09546000
@RF00510 EQU   @RC00497                                                 09547000
@RF00529 EQU   @RC00416                                                 09548000
@RT00556 EQU   @EL00002                                                 09549000
@RF00573 EQU   @EL00003                                                 09550000
@RC00742 EQU   @EL00004                                                 09551000
@RC00796 EQU   @EL00005                                                 09552000
@RF00825 EQU   @EL00006                                                 09553000
@RF00855 EQU   @EL00007                                                 09554000
@RF00896 EQU   @RC00885                                                 09555000
@RF00904 EQU   @RC00885                                                 09556000
@RC01065 EQU   @EL00009                                                 09557000
@RC01191 EQU   @RC01184                                                 09558000
@RF01190 EQU   @RC01184                                                 09559000
@RC01216 EQU   @RC01209                                                 09560000
@RF01215 EQU   @RC01209                                                 09561000
@RC01243 EQU   @RC01236                                                 09562000
@RF01242 EQU   @RC01236                                                 09563000
@RC01268 EQU   @RC01261                                                 09564000
@RF01267 EQU   @RC01261                                                 09565000
@RF01158 EQU   @EL00010                                                 09566000
@RF01583 EQU   @EL00012                                                 09567000
@RT01632 EQU   @EL00013                                                 09568000
@RT01673 EQU   @EL00014                                                 09569000
@RC01765 EQU   @EL00014                                                 09570000
@RF01818 EQU   @EL00015                                                 09571000
@RF01969 EQU   @EL00017                                                 09572000
@RC01900 EQU   @EL00017                                                 09573000
@RF02042 EQU   @RC02027                                                 09574000
@PB00018 EQU   @EL00001                                                 09575000
@PB00017 EQU   @PB00018                                                 09576000
@PB00016 EQU   @PB00017                                                 09577000
@PB00015 EQU   @PB00016                                                 09578000
@PB00014 EQU   @PB00015                                                 09579000
@PB00013 EQU   @PB00014                                                 09580000
@PB00012 EQU   @PB00013                                                 09581000
@PB00011 EQU   @PB00012                                                 09582000
@PB00010 EQU   @PB00011                                                 09583000
@PB00009 EQU   @PB00010                                                 09584000
@PB00008 EQU   @PB00009                                                 09585000
@PB00007 EQU   @PB00008                                                 09586000
@PB00006 EQU   @PB00007                                                 09587000
@PB00005 EQU   @PB00006                                                 09588000
@PB00004 EQU   @PB00005                                                 09589000
@PB00003 EQU   @PB00004                                                 09590000
@PB00002 EQU   @PB00003                                                 09591000
@ENDDATA EQU   *                                                        09592000
         END   IDCAU03,(C'PLS1655',0603,76356)                          09593000
