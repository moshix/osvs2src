         TITLE '*************** IDCAV01: ADDV FUNCTION SUPPORT ROUTINE *00001000
                ********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCAV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCAV01   77.067'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @08,0                                               0002 00021000
@PSTART  LA    @09,4095(,@08)                                      0002 00022000
         LA    @10,4095(,@09)                                      0002 00023000
         LA    @12,4095(,@10)                                      0002 00024000
         USING @PSTART,@08                                         0002 00025000
         USING @PSTART+4095,@09                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @11,@01                                             0002 00031000
         USING @DATD,@11                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @11,8(,@13)                                         0002 00035000
         LR    @13,@11                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*   OLDERID2=NEWERID2;                                             0327 00038000
         L     @15,@PC00001                                        0327 00039000
         L     @14,GDTTR2(,@15)                                    0327 00040000
         MVC   @TS00001(95),NEWERID2(@14)                          0327 00041000
         MVC   OLDERID2(95,@14),@TS00001                           0327 00042000
*   NEWID2='AV01';                  /*                       #Y30LB31*/ 00043000
*                                                                  0328 00044000
         MVC   NEWID2(4,@14),@CC01587                              0328 00045000
*   /*****************************************************************/ 00046000
*   /*                                                               */ 00047000
*   /* TAKE A FULL REGION DUMP UPON ENTRY TO MODULE          #Y30LB31*/ 00048000
*   /*                                                               */ 00049000
*   /*****************************************************************/ 00050000
*                                                                  0329 00051000
*   IF GDTDBG=NULLPTR THEN                                         0329 00052000
         L     @15,GDTDBG(,@15)                                    0329 00053000
         LTR   @15,@15                                             0329 00054000
         BZ    @RT00329                                            0329 00055000
*     ;                                                            0330 00056000
*   ELSE                                                           0331 00057000
*     CALL IDCDB010(GDTTBL,'AVBG'); /*                       #Y30LB31*/ 00058000
*                                                                  0331 00059000
         L     @15,@PC00001                                        0331 00060000
         ST    @15,@AL00001                                        0331 00061000
         LA    @14,@CC01764                                        0331 00062000
         ST    @14,@AL00001+4                                      0331 00063000
         MVI   @AL00001+4,X'80'                                    0331 00064000
         L     @15,GDTDBG(,@15)                                    0331 00065000
         LA    @01,@AL00001                                        0331 00066000
         BALR  @14,@15                                             0331 00067000
*   /*****************************************************************/ 00068000
*   /*                                                               */ 00069000
*   /* SETUP ADDRESSABILITY TO THE ARGUMENT LISTS            #Y30LB31*/ 00070000
*   /* CONSTRUCTED BY ADDV. IF APPROPRIATE, ZERO OUT THESE LISTS AND */ 00071000
*   /* INITIALIZE THE HEADERS USED FOR DEBUGGING.            #Y30LB31*/ 00072000
*   /*                                                               */ 00073000
*   /*****************************************************************/ 00074000
*                                                                  0332 00075000
*   ADDVTBL=''B;                    /* ZERO INTERNAL TABLE   #Y30LB31*/ 00076000
@RT00329 XC    ADDVTBL(59),ADDVTBL                                 0332 00077000
*   ADDVHDR='ADDVTBL';              /* SET ADDV TABLE ID     #Y30LB31*/ 00078000
         MVI   ADDVHDR+7,C' '                                      0333 00079000
         MVC   ADDVHDR(7),@CC01766                                 0333 00080000
*   MSVIVOL#=VOLVAL;                /*                       #Y30LB31*/ 00081000
         L     @03,@PC00001+4                                      0334 00082000
         L     @03,FDTPTR(,@03)                                    0334 00083000
         MVC   MSVIVOL#(6),VOLVAL(@03)                             0334 00084000
*   DDSTRU=ADDR(PRINTTBL);          /* PRINT ARGUMENT LIST   #Y30LB31*/ 00085000
         LA    @15,PRINTTBL                                        0335 00086000
         ST    @15,DDSTRU                                          0335 00087000
*   PRINTTBL=''B;                   /* ZERO PRINT ARG LIST   #Y30LB31*/ 00088000
         XC    PRINTTBL(28),PRINTTBL                               0336 00089000
*   PRINTHDR='DARGLIST';            /* PRINT ARG LIST ID     #Y30LB31*/ 00090000
         MVC   PRINTHDR(8),@CC01767                                0337 00091000
*   VOLBUF=''B;                     /* ZERO OUT BUFFER       @Y30LB31*/ 00092000
         XC    VOLBUF(232),VOLBUF                                  0338 00093000
*   VOLHDR='VOLREC';                /* VOL REC BUFFER ID     @Y30LB31*/ 00094000
         MVI   VOLHDR+6,C' '                                       0339 00095000
         MVI   VOLHDR+7,C' '                                       0339 00096000
         MVC   VOLHDR(6),@CC01768                                  0339 00097000
*   BASEVPTR=ADDR(VOLREC);          /* BASE VOL REC FORMAT   @Y30LB31*/ 00098000
         LA    @15,VOLREC                                          0340 00099000
         LR    BASEVPTR,@15                                        0340 00100000
*   COPYVPTR=ADDR(VOLREC);          /* COPY VOL REC FORMAT   @Y30LB31*/ 00101000
         ST    @15,COPYVPTR                                        0341 00102000
*   DUPVPTR=ADDR(VOLREC);           /* DUPLICATE REC FORMAT  @Y30LB31*/ 00103000
         LR    DUPVPTR,@15                                         0342 00104000
*   BCDVPTR=ADDR(VOLREC);           /* COMMON REC FIELDS MAP @Y30LB31*/ 00105000
         LR    BCDVPTR,@15                                         0343 00106000
*   TEMPBUFF=''B;                   /* ZERO TEMPBUFF         @ZDR2054*/ 00107000
         XC    TEMPBUFF(232),TEMPBUFF                              0344 00108000
*   TEMPHDR='REPVOL';               /* REPLACE VOLUME        @ZDR2054*/ 00109000
         MVI   TEMPHDR+6,C' '                                      0345 00110000
         MVI   TEMPHDR+7,C' '                                      0345 00111000
         MVC   TEMPHDR(6),@CC01769                                 0345 00112000
*   TEMPPTR=ADDR(TEMPBUF);          /* TEMP COPY VOL BUF     @ZDR2054*/ 00113000
         LA    TEMPPTR,TEMPBUF                                     0346 00114000
*   GRPBUF=''B;                     /* ZERO OUT GROUP BUFFER @Y30LB31*/ 00115000
         XC    GRPBUF(172),GRPBUF                                  0347 00116000
*   GRPHDR='GROUPREC';              /* GROUP REC BUFFER ID   @Y30LB31*/ 00117000
         MVC   GRPHDR(8),@CC01770                                  0348 00118000
*   GROUPPTR=ADDR(GRPREC);          /* GROUP REC FORMATTER   @Y30LB31*/ 00119000
         LA    @02,GRPREC                                          0349 00120000
         ST    @02,GROUPPTR                                        0349 00121000
*   AV01DEFV=''B;                   /* ZERO DEF TBL + EXTS   #Y30LB31*/ 00122000
         XC    AV01DEFV(212),AV01DEFV                              0350 00123000
*   AVDEFVID='DEFLIST';             /* DEFINE TBL IDENTIFIER #Y30LB31*/ 00124000
         MVI   AVDEFVID+7,C' '                                     0351 00125000
         MVC   AVDEFVID(7),@CC01771                                0351 00126000
*   DEFVPTR=ADDR(AVDEFV);           /* MSSC DEFINE ARG LIST  @Y30LB31*/ 00127000
         LA    @02,AVDEFV                                          0352 00128000
         ST    @02,DEFVPTR                                         0352 00129000
*   AVDVEID='DEFVE';                /* DEF TBL EXTENSIONS ID @Y30LB31*/ 00130000
         MVI   AVDVEID+5,C' '                                      0353 00131000
         MVC   AVDVEID+6(2),AVDVEID+5                              0353 00132000
         MVC   AVDVEID(5),@CC01772                                 0353 00133000
*   DEFVEPTR=ADDR(AVDEFVE);         /* MSVC DEFINE ARG LIST  @Y30LB31*/ 00134000
         LA    @02,AVDEFVE                                         0354 00135000
         ST    @02,DEFVEPTR                                        0354 00136000
*   AVALLAGL=''B;                   /* ZERO OUT ALLAGL       #Y30LB31*/ 00137000
         XC    AVALLAGL(39),AVALLAGL                               0355 00138000
*   AVALLID='ALLAGL';               /* ARG LIST IDENTIFIER   @Y30LB31*/ 00139000
         MVI   AVALLID+6,C' '                                      0356 00140000
         MVI   AVALLID+7,C' '                                      0356 00141000
         MVC   AVALLID(6),@CC01773                                 0356 00142000
*   RESPECIFY                                                      0357 00143000
*     ALLAGL BASED(ADDR(AVALLTBL)); /*                       #Y30LB31*/ 00144000
*   AVMDAGL=''B;                    /* ZERO OUT MDAGL        #Y30LB31*/ 00145000
         XC    AVMDAGL(37),AVMDAGL                                 0358 00146000
*   RESPECIFY                                                      0359 00147000
*     MDAGL BASED(ADDR(AVMDAGL));   /*                       @Y30LB31*/ 00148000
*   AVVS1AGL=''B;                   /*                       #Y30LB31*/ 00149000
         XC    AVVS1AGL(74),AVVS1AGL                               0360 00150000
*   RESPECIFY                                                      0361 00151000
*     VS1AGL BASED(ADDR(AVVS1AGL)); /*                       #Y30LB31*/ 00152000
*   RFY                                                            0362 00153000
*     EXCLAGL BASED(ADDR(AVEXCLST));/*                       @YD00175*/ 00154000
*                                                                  0363 00155000
*   /*****************************************************************/ 00156000
*   /*                                                               */ 00157000
*   /* ENQUEUE ON THE VOLUME SERIAL NO. TO INSURE THE VOLUME #Y30LB31*/ 00158000
*   /* RECORD IS NOT UPDATED DURING ADDV PROCESSING.         #Y30LB31*/ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0363 00162000
*   RNMLEN=LENGTH(RNAME);           /*                       #Y30LB31*/ 00163000
         MVI   RNMLEN,X'16'                                        0363 00164000
*   RNMTRAIL=ENQUEUE;               /*                       @ZA05119*/ 00165000
         MVC   RNMTRAIL(16),ENQUEUE                                0364 00166000
*   RNMSERNO=VOLVAL;                /*                       #Y30LB31*/ 00167000
         MVC   RNMSERNO(6),VOLVAL(@03)                             0365 00168000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MAJORNM,MINORNM);/*       #Y30LB31*/ 00169000
*                                                                  0366 00170000
         MVC   @AL00001+4(12),@AL00366                             0366 00171000
         L     @15,@PC00001                                        0366 00172000
         ST    @15,@AL00001                                        0366 00173000
         LA    @14,MINORNM                                         0366 00174000
         ST    @14,@AL00001+16                                     0366 00175000
         MVI   @AL00001+16,X'80'                                   0366 00176000
         L     @15,GDTENQ(,@15)                                    0366 00177000
         LA    @01,@AL00001                                        0366 00178000
         BALR  @14,@15                                             0366 00179000
*   /*****************************************************************/ 00180000
*   /*                                                               */ 00181000
*   /* CHECK OUT THE VOLUME TO BE ACTIVATED.                 #Y30LB31*/ 00182000
*   /*                                                               */ 00183000
*   /*****************************************************************/ 00184000
*                                                                  0367 00185000
*   CALL SETUPRTN;                  /*                       #Y30LB31*/ 00186000
         BAL   @14,SETUPRTN                                        0367 00187000
*   RESPECIFY                                                      0368 00188000
*     RTNREG RSTD;                                                 0368 00189000
*   TESTRC=RTNREG;                                                 0369 00190000
         LR    TESTRC,RTNREG                                       0369 00191000
*   RESPECIFY                                                      0370 00192000
*     RTNREG UNRSTD;                /*                       #Y30LB31*/ 00193000
*   IF TESTRC^=0 THEN               /*                       #Y30LB31*/ 00194000
         LTR   TESTRC,TESTRC                                       0371 00195000
         BZ    @RF00371                                            0371 00196000
*     LASTCOND=LASTCC12;            /*                       #Y30LB31*/ 00197000
*                                                                  0372 00198000
         L     @02,@PC00001+8                                      0372 00199000
         MVC   LASTCOND(2,@02),@CH00606                            0372 00200000
*   /*****************************************************************/ 00201000
*   /*                                                               */ 00202000
*   /* PROCEED WITH ACTIVATE REQUEST IF NO CONFLICTS EXIST.  @Y30LB31*/ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                                  0373 00206000
*   IF LASTCOND=0 THEN              /*                       #Y30LB31*/ 00207000
@RF00371 SLR   @02,@02                                             0373 00208000
         L     @15,@PC00001+8                                      0373 00209000
         CH    @02,LASTCOND(,@15)                                  0373 00210000
         BNE   @RF00373                                            0373 00211000
*     IF BCDBASE=ON|ADDR(RVOL)^=NULLPTR THEN/*               @ZDR2054*/ 00212000
*                                                                  0374 00213000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0374 00214000
         BO    @RT00374                                            0374 00215000
         L     @15,@PC00001+4                                      0374 00216000
         C     @02,FDTPTR+36(,@15)                                 0374 00217000
         BE    @RF00374                                            0374 00218000
@RT00374 DS    0H                                                  0375 00219000
*       /*************************************************************/ 00220000
*       /*                                                           */ 00221000
*       /* ACTIVATE A UNIQUE BASE VOLUME                     @ZDR2054*/ 00222000
*       /* OR REPLACE A BASE WITH A COPY VOLUME.             @ZDR2054*/ 00223000
*       /*                                                           */ 00224000
*       /*************************************************************/ 00225000
*                                                                  0375 00226000
*       DO;                         /*                       #Y30LB31*/ 00227000
*         CALL UNIQVRTN;            /*                       #Y30LB31*/ 00228000
         BAL   @14,UNIQVRTN                                        0376 00229000
*         RESPECIFY                                                0377 00230000
*           RTNREG RSTD;                                           0377 00231000
*         TESTRC=RTNREG;                                           0378 00232000
         LR    TESTRC,RTNREG                                       0378 00233000
*         RESPECIFY                                                0379 00234000
*           RTNREG UNRSTD;          /*                       #Y30LB31*/ 00235000
*         LASTCOND=MAX(LASTCOND,TESTRC);/*                   #Y30LB31*/ 00236000
         L     @02,@PC00001+8                                      0380 00237000
         LH    @15,LASTCOND(,@02)                                  0380 00238000
         CR    @15,TESTRC                                          0380 00239000
         BNL   *+6                                                      00240000
         LR    @15,TESTRC                                          0380 00241000
         STH   @15,LASTCOND(,@02)                                  0380 00242000
*       END;                        /*                       #Y30LB31*/ 00243000
*                                                                  0381 00244000
*   /*****************************************************************/ 00245000
*   /*                                                               */ 00246000
*   /* ACTIVATE A COPY OR DUPLICATE VOLUME.                  #Y30LB31*/ 00247000
*   /*                                                               */ 00248000
*   /*****************************************************************/ 00249000
*                                                                  0382 00250000
*     ELSE                          /*                               */ 00251000
*       DO;                                                        0382 00252000
         B     @RC00374                                            0382 00253000
@RF00374 DS    0H                                                  0383 00254000
*         CALL DUPVRTN;                                            0383 00255000
         BAL   @14,DUPVRTN                                         0383 00256000
*         RESPECIFY                                                0384 00257000
*           RTNREG RSTD;                                           0384 00258000
*         TESTRC=RTNREG;                                           0385 00259000
         LR    TESTRC,RTNREG                                       0385 00260000
*         RESPECIFY                                                0386 00261000
*           RTNREG UNRSTD;                                         0386 00262000
*         LASTCOND=MAX(LASTCOND,TESTRC);                           0387 00263000
         L     @02,@PC00001+8                                      0387 00264000
         LH    @15,LASTCOND(,@02)                                  0387 00265000
         CR    @15,TESTRC                                          0387 00266000
         BNL   *+6                                                      00267000
         LR    @15,TESTRC                                          0387 00268000
         STH   @15,LASTCOND(,@02)                                  0387 00269000
*       END;                                                       0388 00270000
*                                                                  0388 00271000
*   /*****************************************************************/ 00272000
*   /*                                                               */ 00273000
*   /* IF A UNIT WAS DYNAMICALLY ALLOCATED DURING            #Y30LB31*/ 00274000
*   /* PROCESSING, DEALLOCATE IT.                            #Y30LB31*/ 00275000
*   /*                                                               */ 00276000
*   /*****************************************************************/ 00277000
*                                                                  0389 00278000
*   IF ALLOCFLG=ON THEN             /*                       #Y30LB31*/ 00279000
@RC00374 DS    0H                                                  0389 00280000
@RF00373 TM    ALLOCFLG,B'00000100'                                0389 00281000
         BNO   @RF00389                                            0389 00282000
*     DO;                           /*                       #Y30LB31*/ 00283000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      #Y30LB31*/ 00284000
         L     @02,@PC00001                                        0391 00285000
         ST    @02,@AL00001                                        0391 00286000
         LA    @15,AVALLTBL                                        0391 00287000
         ST    @15,@AL00001+4                                      0391 00288000
         MVI   @AL00001+4,X'80'                                    0391 00289000
         L     @15,GDTDLC(,@02)                                    0391 00290000
         LA    @01,@AL00001                                        0391 00291000
         BALR  @14,@15                                             0391 00292000
*       RESPECIFY                                                  0392 00293000
*         RTNREG RSTD;                                             0392 00294000
*       TESTRC=RTNREG;                                             0393 00295000
         LR    TESTRC,RTNREG                                       0393 00296000
*       RESPECIFY                                                  0394 00297000
*         RTNREG UNRSTD;            /*                       #Y30LB31*/ 00298000
*                                                                  0394 00299000
*       /*************************************************************/ 00300000
*       /*                                                           */ 00301000
*       /* UPDATE THE FINAL CONDITION CODE ONLY IF UDEALLOC  #Y30LB31*/ 00302000
*       /* RETURN CODE IS HIGHER. IF UDEALLOC FAILED, ITS RET CODE   */ 00303000
*       /*                                                   #Y30LB31*/ 00304000
*       /* IS 4.                                             #Y30LB31*/ 00305000
*       /*                                                           */ 00306000
*       /*************************************************************/ 00307000
*                                                                  0395 00308000
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     #Y30LB31*/ 00309000
         L     @02,@PC00001+8                                      0395 00310000
         LH    @15,LASTCOND(,@02)                                  0395 00311000
         CR    @15,TESTRC                                          0395 00312000
         BNL   *+6                                                      00313000
         LR    @15,TESTRC                                          0395 00314000
         STH   @15,LASTCOND(,@02)                                  0395 00315000
*     END;                          /*                       #Y30LB31*/ 00316000
*                                                                  0396 00317000
*   /*****************************************************************/ 00318000
*   /*                                                               */ 00319000
*   /* IF A MINOR ERROR OCCURRED DURING PROCESSING BUT THE   #Y30LB31*/ 00320000
*   /* VOLUME WAS SUCESSFULLY ACTIVATED AND RELABELED, INSURE THE    */ 00321000
*   /*                                                       #Y30LB31*/ 00322000
*   /* FINAL CONDITION CODE IS AT LEAST 4.                   #Y30LB31*/ 00323000
*   /*                                                               */ 00324000
*   /*****************************************************************/ 00325000
*                                                                  0397 00326000
*   IF CC04FLG=ON THEN              /*                       #Y30LB31*/ 00327000
@RF00389 TM    CC04FLG,B'10000000'                                 0397 00328000
         BNO   @RF00397                                            0397 00329000
*     LASTCOND=MAX(LASTCOND,LASTCC04);/*                     #Y30LB31*/ 00330000
*                                                                  0398 00331000
         L     @15,@PC00001+8                                      0398 00332000
         LH    @14,LASTCOND(,@15)                                  0398 00333000
         LA    @07,4                                               0398 00334000
         CR    @14,@07                                             0398 00335000
         BNL   *+6                                                      00336000
         LR    @14,@07                                             0398 00337000
         STH   @14,LASTCOND(,@15)                                  0398 00338000
*   /*****************************************************************/ 00339000
*   /*                                                               */ 00340000
*   /* RELEASE THE ENQUEUE ESTABLISHED AT THE START OF THE   @Y30LB31*/ 00341000
*   /* PROGRAM.                                              #Y30LB31*/ 00342000
*   /*                                                               */ 00343000
*   /*****************************************************************/ 00344000
*                                                                  0399 00345000
*   RNMSERNO=VOLVAL;                /*                       #Y30LB31*/ 00346000
@RF00397 L     @15,@PC00001+4                                      0399 00347000
         L     @01,FDTPTR(,@15)                                    0399 00348000
         MVC   RNMSERNO(6),VOLVAL(@01)                             0399 00349000
*   RNMTRAIL=ENQUEUE;               /*                       @ZA05119*/ 00350000
         MVC   RNMTRAIL(16),ENQUEUE                                0400 00351000
*   CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*                 #Y30LB31*/ 00352000
*                                                                  0401 00353000
         L     @15,@PC00001                                        0401 00354000
         ST    @15,@AL00001                                        0401 00355000
         LA    @14,@CC01635                                        0401 00356000
         ST    @14,@AL00001+4                                      0401 00357000
         LA    @14,MINORNM                                         0401 00358000
         ST    @14,@AL00001+8                                      0401 00359000
         MVI   @AL00001+8,X'80'                                    0401 00360000
         L     @15,GDTDEQ(,@15)                                    0401 00361000
         LA    @01,@AL00001                                        0401 00362000
         BALR  @14,@15                                             0401 00363000
*   /*****************************************************************/ 00364000
*   /*                                                               */ 00365000
*   /* ISSUE APPROPRIATE EOJ MESSAGE                         @Y30LB31*/ 00366000
*   /*                                                               */ 00367000
*   /*****************************************************************/ 00368000
*                                                                  0402 00369000
*   PRINTTBL=''B;                   /*                       @Y30LB31*/ 00370000
         XC    PRINTTBL(28),PRINTTBL                               0402 00371000
*   DARGSMOD=UNIVMSGS;              /*                       @Y30LB31*/ 00372000
         L     @15,DDSTRU                                          0403 00373000
         MVC   DARGSMOD(3,@15),@CC01732                            0403 00374000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB31*/ 00375000
         L     @14,@PC00001+8                                      0404 00376000
         ST    @14,DARGDBP(,@15)                                   0404 00377000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB31*/ 00378000
         MVC   DARGILP(2,@15),@CH00156                             0405 00379000
*   IF LASTCOND>LASTCC08 THEN       /*                       @Y30LB31*/ 00380000
         LH    @14,LASTCOND(,@14)                                  0406 00381000
         C     @14,@CF00182                                        0406 00382000
         BNH   @RF00406                                            0406 00383000
*     DARGSENT=MSG3003I;            /*                       @Y30LB31*/ 00384000
         MVI   DARGSENT(@15),X'03'                                 0407 00385000
*   ELSE                            /*                       @Y30LB31*/ 00386000
*     DARGSENT=MSG0001I;            /*                       @Y30LB31*/ 00387000
         B     @RC00406                                            0408 00388000
@RF00406 L     @01,DDSTRU                                          0408 00389000
         MVI   DARGSENT(@01),X'01'                                 0408 00390000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB31*/ 00391000
@RC00406 L     @15,@PC00001                                        0409 00392000
         ST    @15,@AL00001                                        0409 00393000
         LA    @14,@CF00117                                        0409 00394000
         ST    @14,@AL00001+4                                      0409 00395000
         LA    @14,DDSTRU                                          0409 00396000
         ST    @14,@AL00001+8                                      0409 00397000
         MVI   @AL00001+8,X'80'                                    0409 00398000
         L     @15,GDTPRT(,@15)                                    0409 00399000
         LA    @01,@AL00001                                        0409 00400000
         BALR  @14,@15                                             0409 00401000
*                                                                  0410 00402000
*   /*****************************************************************/ 00403000
*   /*                                                               */ 00404000
*   /* TAKE A FULL REGION DUMP UPON EXIT FROM MODULE.        @Y30LB31*/ 00405000
*   /*                                                               */ 00406000
*   /*****************************************************************/ 00407000
*                                                                  0410 00408000
*   IF GDTDBG=NULLPTR THEN                                         0410 00409000
         L     @15,@PC00001                                        0410 00410000
         L     @15,GDTDBG(,@15)                                    0410 00411000
         LTR   @15,@15                                             0410 00412000
         BZ    @RT00410                                            0410 00413000
*     ;                                                            0411 00414000
*   ELSE                                                           0412 00415000
*     CALL IDCDB010(GDTTBL,'AVND'); /*                       @Y30LB31*/ 00416000
*                                                                  0412 00417000
         L     @15,@PC00001                                        0412 00418000
         ST    @15,@AL00001                                        0412 00419000
         LA    @14,@CC01785                                        0412 00420000
         ST    @14,@AL00001+4                                      0412 00421000
         MVI   @AL00001+4,X'80'                                    0412 00422000
         L     @15,GDTDBG(,@15)                                    0412 00423000
         LA    @01,@AL00001                                        0412 00424000
         BALR  @14,@15                                             0412 00425000
*   /*****************************************************************/ 00426000
*   /*                                                               */ 00427000
*   /* RETURN TO THE AMS EXECUTIVE, PASSING THE FINAL COND   @Y30LB31*/ 00428000
*   /* CODE FROM ADDV.                                       @Y30LB31*/ 00429000
*   /*                                                               */ 00430000
*   /*****************************************************************/ 00431000
*                                                                  0413 00432000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0413 00433000
*                                                                  0413 00434000
@RT00410 L     @15,@PC00001                                        0413 00435000
         ST    @15,@AL00001                                        0413 00436000
         LA    @14,MODID                                           0413 00437000
         ST    @14,@AL00001+4                                      0413 00438000
         L     @14,@PC00001+8                                      0413 00439000
         ST    @14,@AL00001+8                                      0413 00440000
         MVI   @AL00001+8,X'80'                                    0413 00441000
         L     @15,GDTEPL(,@15)                                    0413 00442000
         LA    @01,@AL00001                                        0413 00443000
         BALR  @14,@15                                             0413 00444000
*   /*****************************************************************/ 00445000
*   /*                                                               */ 00446000
*   /*                                                       @Y30LB31*/ 00447000
*   /*                                                               */ 00448000
*   /*****************************************************************/ 00449000
*                                                                  0414 00450000
*                                                                  0414 00451000
*/********************************************************** @Y30LB31*/ 00452000
*/*                                                          @Y30LB31*/ 00453000
*/* PROCEDURE NAME - SETUPRTN                                @Y30LB31*/ 00454000
*/*                                                          @Y30LB31*/ 00455000
*/* FUNCTION - DIRECTS THE CHECKOUT OF USER SPECIFICATIONS   @Y30LB31*/ 00456000
*/*            FROM THE COMMAND STATEMENT AGAINST THE        @Y30LB31*/ 00457000
*/*            PRESENT STATUS OF THE VOL BEING ACTIVATED.    @Y30LB31*/ 00458000
*/*            CALLS VTYPERTN TO DETERMINE WHETHER A BASE,   @Y30LB31*/ 00459000
*/*            COPY, OR DUPLICATE VOLUME IS BEING ACTIVATD.  @Y30LB31*/ 00460000
*/*            CALLS RWCKRTN TO CHECK FOR A READONLY OR      @Y30LB31*/ 00461000
*/*            READWRITE CONFLICT IF THE VOLUME SERIAL NO.   @Y30LB31*/ 00462000
*/*            IS TO BE CHANGED.  CALLS ALLOCRTN TO CHECK    @Y30LB31*/ 00463000
*/*            OUT THE UNIT REQUIREMENTS.  MSG IDC3092I   @Y30LB31   */ 00464000
*/*            IS ISSUED IF FILE PARM IS REQUIRED.           @Y30LB31*/ 00465000
*/*                                                          @Y30LB31*/ 00466000
*/* INPUT - FDTTBL, PRINTTBL FOR MESSAGES                    @Y30LB31*/ 00467000
*/*                                                          @Y30LB31*/ 00468000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL VOLUME    @Y30LB31*/ 00469000
*/*          CHECKOUT.                                       @Y30LB31*/ 00470000
*/*          RETURN CODE OF 4 IF CHECKOUT FAILED AND VOLUME  @Y30LB31*/ 00471000
*/*          CANNOT BE ACTIVATED.                            @Y30LB31*/ 00472000
*/*                                                          @Y30LB31*/ 00473000
*/********************************************************** @Y30LB31*/ 00474000
*                                                                  0414 00475000
*SETUPRTN:                                                         0414 00476000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 00477000
*                                                                  0414 00478000
@EL00001 L     @13,4(,@13)                                         0414 00479000
@EF00001 L     @00,@SIZDATD                                        0414 00480000
         LR    @01,@11                                             0414 00481000
         FREEMAIN R,LV=(0),A=(1)                                        00482000
@ER00001 LM    @14,@12,12(@13)                                     0414 00483000
         BR    @14                                                 0414 00484000
SETUPRTN DS    0H                                                  0415 00485000
*   /*****************************************************************/ 00486000
*   /*                                                               */ 00487000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 00488000
*   /*                                                               */ 00489000
*   /*****************************************************************/ 00490000
*                                                                  0415 00491000
*   DCL                                                            0415 00492000
*     SETUPRC FIXED(15);            /*                       @Y30LB31*/ 00493000
*                                                                  0415 00494000
*   /*****************************************************************/ 00495000
*   /*                                                               */ 00496000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 00497000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 00498000
*   /*                                                               */ 00499000
*   /*****************************************************************/ 00500000
*                                                                  0416 00501000
*   RESPECIFY                                                      0416 00502000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 00503000
*   RETADDR1=REG14;                 /*                       @Y30LB31*/ 00504000
         ST    REG14,RETADDR1                                      0417 00505000
*   RESPECIFY                                                      0418 00506000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 00507000
*   OLDERID2=NEWERID2;                                             0419 00508000
         L     @15,@PC00001                                        0419 00509000
         L     @15,GDTTR2(,@15)                                    0419 00510000
         MVC   @TS00001(95),NEWERID2(@15)                          0419 00511000
         MVC   OLDERID2(95,@15),@TS00001                           0419 00512000
*   NEWID2='AVUP';                  /*                       @Y30LB31*/ 00513000
*                                                                  0420 00514000
         MVC   NEWID2(4,@15),@CC01790                              0420 00515000
*   /*****************************************************************/ 00516000
*   /*                                                               */ 00517000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN     @Y30LB31*/ 00518000
*   /* THIS PROCEDURE.                                       @Y30LB31*/ 00519000
*   /*                                                               */ 00520000
*   /*****************************************************************/ 00521000
*                                                                  0421 00522000
*   SETUPRC=LASTCC00;               /*                       @Y30LB31*/ 00523000
*                                                                  0421 00524000
         SLR   @15,@15                                             0421 00525000
         STH   @15,SETUPRC                                         0421 00526000
*   /*****************************************************************/ 00527000
*   /*                                                               */ 00528000
*   /* CALL VTYPERTN TO DETERMINE THE TYPE OF VOLUME BEING   @Y30LB31*/ 00529000
*   /* ACTIVATED AND WHETHER IT CAN BE ACTIVATED.            @Y30LB31*/ 00530000
*   /*                                                               */ 00531000
*   /*****************************************************************/ 00532000
*                                                                  0422 00533000
*   CALL VTYPERTN;                  /*                       @Y30LB31*/ 00534000
         BAL   @14,VTYPERTN                                        0422 00535000
*   RESPECIFY                                                      0423 00536000
*     RTNREG RSTD;                                                 0423 00537000
*   TESTRC=RTNREG;                                                 0424 00538000
         LR    TESTRC,RTNREG                                       0424 00539000
*   RESPECIFY                                                      0425 00540000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 00541000
*                                                                  0425 00542000
*   /*****************************************************************/ 00543000
*   /*                                                               */ 00544000
*   /* TEST RETURN CODE FROM VTYPERTN. IF THE VOLUME CHECK   @Y30LB31*/ 00545000
*   /* OUT FAILED, UPDATE THE CONDITION AND EXIT FROM THIS PROC.     */ 00546000
*   /*                                                       @Y30LB31*/ 00547000
*   /*                                                               */ 00548000
*   /*****************************************************************/ 00549000
*                                                                  0426 00550000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 00551000
         LTR   TESTRC,TESTRC                                       0426 00552000
         BZ    @RF00426                                            0426 00553000
*     SETUPRC=4;                    /*                       @Y30LB31*/ 00554000
*                                                                  0427 00555000
         MVC   SETUPRC(2),@CH00043                                 0427 00556000
*   /*****************************************************************/ 00557000
*   /*                                                               */ 00558000
*   /* NEXT, CHECK FOR A READONLY - READWRITE CONFLICT IF    @Y30LB31*/ 00559000
*   /* THE VOLUME SERIAL NO. IS TO BE CHANGED.               @Y30LB31*/ 00560000
*   /*                                                               */ 00561000
*   /*****************************************************************/ 00562000
*                                                                  0428 00563000
*   ELSE                            /*                       @Y30LB31*/ 00564000
*     DO;                           /*                       @Y30LB31*/ 00565000
         B     @RC00426                                            0428 00566000
@RF00426 DS    0H                                                  0429 00567000
*       IF ADDR(NSER)^=NULLPTR THEN /*                       @Y30LB31*/ 00568000
         L     @15,@PC00001+4                                      0429 00569000
         L     @15,FDTPTR+20(,@15)                                 0429 00570000
         LTR   @15,@15                                             0429 00571000
         BZ    @RF00429                                            0429 00572000
*         DO;                       /*                       @Y30LB31*/ 00573000
*           CALL RWCKRTN;           /*                       @Y30LB31*/ 00574000
         BAL   @14,RWCKRTN                                         0431 00575000
*           RESPECIFY                                              0432 00576000
*             RTNREG RSTD;                                         0432 00577000
*           TESTRC=RTNREG;                                         0433 00578000
         LR    TESTRC,RTNREG                                       0433 00579000
*           RESPECIFY                                              0434 00580000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 00581000
*                                                                  0434 00582000
*           /*********************************************************/ 00583000
*           /*                                                       */ 00584000
*           /* TEST RETURN CODE FROM RWCKRTN. IF THE VOLUME  @Y30LB31*/ 00585000
*           /* ATTRIBUTE CHECKOUT FAILED, UPDATE THE CONDITION CODE  */ 00586000
*           /* BUT CONTINUE CHECKING FOR ERRORS.             @Y30LB31*/ 00587000
*           /*                                                       */ 00588000
*           /*********************************************************/ 00589000
*                                                                  0435 00590000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 00591000
         LTR   TESTRC,TESTRC                                       0435 00592000
         BZ    @RF00435                                            0435 00593000
*             SETUPRC=4;            /*                       @Y30LB31*/ 00594000
         MVC   SETUPRC(2),@CH00043                                 0436 00595000
*         END;                      /*                       @Y30LB31*/ 00596000
*                                                                  0437 00597000
@RF00435 DS    0H                                                  0438 00598000
*       /*************************************************************/ 00599000
*       /*                                                           */ 00600000
*       /* FINALLY, CHECK OUT THE UNIT REQUIREMENTS NEEDED FOR       */ 00601000
*       /*                                                   @Y30LB31*/ 00602000
*       /* THIS ACTIVATE REQUEST. IF FILE IS NOT SPECIFIED, 1) A UNIT*/ 00603000
*       /* CAN BE DYNAMICALLY ALLOCATED IF A BASE VOLUME IS BEING    */ 00604000
*       /* ACTIVATED AND RELABELED OR IF THE VOLUME IS A GENERAL-USE */ 00605000
*       /* VOLUME FOR A GROUP OTHER THAN SYSGROUP AND HAS DOWN LEVEL */ 00606000
*       /* SPACE, AND IN EITHER CASE THE VOLUME IS NOT CURRENTLY     */ 00607000
*       /* FLAGGED DUE TO A PREVIOUS RENAME FAILURE, 2) A UNIT IS NOT*/ 00608000
*       /* REQUIRED IF A BASE VOLUME WITHOUT A DOWN LEVEL SPACE      */ 00609000
*       /* PROBLEM IS ONLY BEING ACTIVATED, OTHERWISE, 3) A UNIT IS  */ 00610000
*       /* REQUIRED WITH DEFERRED MOUNT BECAUSE THE BASE, COPY, OR   */ 00611000
*       /* DUPLICATE WILL HAVE A SERIAL MISMATCH AT THE TIME THE     */ 00612000
*       /* VOLUME IS MOUNTED TO UPDATE THE VOLUME LABEL, 4) A UNIT IS*/ 00613000
*       /* NOT REQUIRED FOR ACTIVATING A COPY VOLUME WITHOUT         */ 00614000
*       /* PERFORMING A RENAME. ISSUE AN ERROR MESSAGE IF FILE IS NOT*/ 00615000
*       /* SPECIFIED BUT A UNIT IS REQUIRED.                 @G24LB23*/ 00616000
*       /*                                                           */ 00617000
*       /*************************************************************/ 00618000
*                                                                  0438 00619000
*       IF ADDR(FILE)=NULLPTR THEN  /*                       #Y30LB31*/ 00620000
@RF00429 L     @15,@PC00001+4                                      0438 00621000
         L     @15,FDTPTR+28(,@15)                                 0438 00622000
         LTR   @15,@15                                             0438 00623000
         BNZ   @RF00438                                            0438 00624000
*         IF(BCDBASE=ON&BCDVSMIS=OFF)|ADDR(RVOL)^=NULLPTR THEN     0439 00625000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0439 00626000
         BNO   @GL00002                                            0439 00627000
         TM    BCDVSMIS(BCDVPTR),B'00100000'                       0439 00628000
         BZ    @RT00439                                            0439 00629000
@GL00002 L     @15,@PC00001+4                                      0439 00630000
         L     @15,FDTPTR+36(,@15)                                 0439 00631000
         LTR   @15,@15                                             0439 00632000
         BNZ   @RT00439                                            0439 00633000
*           ;                       /*                       @G24LB23*/ 00634000
*         ELSE                      /*                       #Y30LB31*/ 00635000
*           DO;                     /*                       #Y30LB31*/ 00636000
*             SETUPRC=4;            /*                       #Y30LB31*/ 00637000
         MVC   SETUPRC(2),@CH00043                                 0442 00638000
*             PRINTTBL=''B;         /*                       #Y30LB31*/ 00639000
         XC    PRINTTBL(28),PRINTTBL                               0443 00640000
*             DARGSMOD=COMMSGS;     /*                       #Y30LB31*/ 00641000
         L     @15,DDSTRU                                          0444 00642000
         MVC   DARGSMOD(3,@15),@CC01697                            0444 00643000
*             DARGSENT=MSG3092I;    /* STID=CM014            #Y30LB31*/ 00644000
         MVI   DARGSENT(@15),X'0E'                                 0445 00645000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        #Y30LB31*/ 00646000
         L     @15,@PC00001                                        0446 00647000
         ST    @15,@AL00001                                        0446 00648000
         LA    @14,@CF00117                                        0446 00649000
         ST    @14,@AL00001+4                                      0446 00650000
         LA    @14,DDSTRU                                          0446 00651000
         ST    @14,@AL00001+8                                      0446 00652000
         MVI   @AL00001+8,X'80'                                    0446 00653000
         L     @15,GDTPRT(,@15)                                    0446 00654000
         LA    @01,@AL00001                                        0446 00655000
         BALR  @14,@15                                             0446 00656000
*           END;                    /*                       #Y30LB31*/ 00657000
*                                                                  0447 00658000
*       /*************************************************************/ 00659000
*       /*                                                           */ 00660000
*       /* IF A BASE VOLUME IS BEING ACTIVATED AND A NEW SERIAL      */ 00661000
*       /*                                                   #Y30LB31*/ 00662000
*       /* NO. IS NOT REQUESTED, AND EITHER THE DOWN LEVEL SPACE FLAG*/ 00663000
*       /* IS OFF OR ELSE THE VOLUME IS NOT A GENERAL-USE VOLUME     */ 00664000
*       /* BELONGING TO A GROUP OTHER THAN SYSGROUP, DISREGARD THE   */ 00665000
*       /* FILE SPECIFICATION. OTHERWISE, CHECK OUT THE UNIT         */ 00666000
*       /* ALLOCATED VIA THE FILE PARM BECAUSE VOLUME MOUNTS WILL BE */ 00667000
*       /* REQUIRED.                                         @G24LB23*/ 00668000
*       /*                                                           */ 00669000
*       /*************************************************************/ 00670000
*                                                                  0448 00671000
*       ELSE                        /*                       #Y30LB31*/ 00672000
*         IF BCDBASE=ON&BCDVSMIS=OFF&ADDR(NSER)=NULLPTR&/*   @G24LB23*/ 00673000
*             (BASDLSF=OFF|BASGENUS=OFF|(BASGENUS=ON&/*      @G24LB23*/ 00674000
*             BASGROUP=SYSGROUP))   /*                       @G24LB23*/ 00675000
*           THEN                                                   0448 00676000
         B     @RC00438                                            0448 00677000
@RF00438 TM    BCDBASE(BCDVPTR),B'00100000'                        0448 00678000
         BNO   @RF00448                                            0448 00679000
         TM    BCDVSMIS(BCDVPTR),B'00100000'                       0448 00680000
         BNZ   @RF00448                                            0448 00681000
         L     @15,@PC00001+4                                      0448 00682000
         L     @15,FDTPTR+20(,@15)                                 0448 00683000
         LTR   @15,@15                                             0448 00684000
         BNZ   @RF00448                                            0448 00685000
         TM    BASDLSF(BASEVPTR),B'10010000'                       0448 00686000
         BNO   @RT00448                                            0448 00687000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0448 00688000
         BNO   @RF00448                                            0448 00689000
         CLC   BASGROUP(8,BASEVPTR),@CC01670                       0448 00690000
         BE    @RT00448                                            0448 00691000
*           ;                       /* UNIT IS NOT REQUIRED  #Y30LB31*/ 00692000
*         ELSE                      /*                       #Y30LB31*/ 00693000
*           DO;                     /*                       #Y30LB31*/ 00694000
@RF00448 DS    0H                                                  0451 00695000
*             CALL ALLOCRTN;        /*                       #Y30LB31*/ 00696000
         BAL   @14,ALLOCRTN                                        0451 00697000
*             RESPECIFY                                            0452 00698000
*               RTNREG RSTD;                                       0452 00699000
*             TESTRC=RTNREG;                                       0453 00700000
         LR    TESTRC,RTNREG                                       0453 00701000
*             RESPECIFY                                            0454 00702000
*               RTNREG UNRSTD;      /*                       #Y30LB31*/ 00703000
*             IF TESTRC^=0 THEN     /*                       #Y30LB31*/ 00704000
         LTR   TESTRC,TESTRC                                       0455 00705000
         BZ    @RF00455                                            0455 00706000
*               SETUPRC=4;          /*                       #Y30LB31*/ 00707000
         MVC   SETUPRC(2),@CH00043                                 0456 00708000
*           END;                    /*                       #Y30LB31*/ 00709000
*                                                                  0457 00710000
@RF00455 DS    0H                                                  0458 00711000
*       /*************************************************************/ 00712000
*       /*                                                           */ 00713000
*       /* CLOSE DO GROUP THAT CHECKED FOR READWRITE AND UNIT        */ 00714000
*       /*                                                   #Y30LB31*/ 00715000
*       /* REQUIREMENTS.                                     #Y30LB31*/ 00716000
*       /*                                                           */ 00717000
*       /*************************************************************/ 00718000
*                                                                  0458 00719000
*     END;                          /*                       #Y30LB31*/ 00720000
*                                                                  0458 00721000
@RT00448 DS    0H                                                  0458 00722000
@RC00438 DS    0H                                                  0459 00723000
*   /*****************************************************************/ 00724000
*   /*                                                               */ 00725000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER  #Y30LB31*/ 00726000
*   /* AND EXIT FROM SETUPRTN, PASSING THE CONDITION CODE IN REG 15. */ 00727000
*   /*                                                       #Y30LB31*/ 00728000
*   /*                                                               */ 00729000
*   /*****************************************************************/ 00730000
*                                                                  0459 00731000
*   RESPECIFY                                                      0459 00732000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 00733000
@RC00426 DS    0H                                                  0460 00734000
*   REG14=RETADDR1;                 /*                       #Y30LB31*/ 00735000
         L     REG14,RETADDR1                                      0460 00736000
*   RESPECIFY                                                      0461 00737000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 00738000
*   RETURN CODE(SETUPRC);           /*                       #Y30LB31*/ 00739000
         LH    @15,SETUPRC                                         0462 00740000
@EL00002 DS    0H                                                  0462 00741000
@EF00002 DS    0H                                                  0462 00742000
@ER00002 BR    @14                                                 0462 00743000
*   END SETUPRTN;                   /*                       #Y30LB31*/ 00744000
*                                                                  0464 00745000
*/****************************************************************** */ 00746000
*/*                                                          #Y30LB31*/ 00747000
*/* PROCEDURE NAME - VTYPERTN                                #Y30LB31*/ 00748000
*/*                                                          #Y30LB31*/ 00749000
*/* FUNCTION - DETERMINES FROM THE COMMAND STATEMENT PARMS   #Y30LB31*/ 00750000
*/*            THE TYPE OF VOLUME TO BE ACTIVATED.  CALLS    #Y30LB31*/ 00751000
*/*            CKCSNLEN TO VERIFY THE CARTRIDGE SERIAL NO.   #Y30LB31*/ 00752000
*/*            LENGTH IF CART IS SPECIFIED.                  #Y30LB31*/ 00753000
*/*            CALLS RVVIRTN TO READ THE APPROPRIATE         #Y30LB31*/ 00754000
*/*            RECORDS.  CALLS VOLCKRTN TO CHECK FOR         #Y30LB31*/ 00755000
*/*            CONFLICTS WHICH PROHIBIT THE ACTIVATE.        #Y30LB31*/ 00756000
*/*            MESSAGES, IDC3089I AND IDC3072I, ARE ISSUED.  #Y30LB31*/ 00757000
*/*                                                          #Y30LB31*/ 00758000
*/* INPUT - FDTTBL, ADDVTBL, PRINTTBL FOR MESSAGES, BASEV    #Y30LB31*/ 00759000
*/*         AND GROUP FOR THE BASE AND GROUP RECORDS.        #Y30LB31*/ 00760000
*/*                                                          @Y30LB31*/ 00761000
*/* OUTPUT - RETURN CODE OF 4 INDICATES                      @Y30LB31*/ 00762000
*/*          (1) RECORD NOT RETRIEVED FROM INVENTORY,        @Y30LB31*/ 00763000
*/*          (2) POSSIBLE DUPLICATE AND BASE VOL MIX-UP.    @Y30LB31 */ 00764000
*/*          (3) READWRITE SPECIFIED BUT GROUP IS READONLY.  @Y30LB31*/ 00765000
*/*          (4) CSN LENGTH INVALID.  NO RECORD READ.       @Y30LB31 */ 00766000
*/*          RETURN CODE OF 0 INDICATES SUCCESSFUL VOLUME    @Y30LB31*/ 00767000
*/*          DETERMINATION FOR ACTIVATE REQUESTS.            @Y30LB31*/ 00768000
*/*                                                          @Y30LB31*/ 00769000
*/****************************************************************** */ 00770000
*                                                                  0464 00771000
*VTYPERTN:                                                         0464 00772000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 00773000
*                                                                  0464 00774000
VTYPERTN DS    0H                                                  0465 00775000
*   /*****************************************************************/ 00776000
*   /*                                                               */ 00777000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 00778000
*   /*                                                               */ 00779000
*   /*****************************************************************/ 00780000
*                                                                  0465 00781000
*   DCL                                                            0465 00782000
*     VTYPERC FIXED(15);            /*                       @Y30LB31*/ 00783000
*                                                                  0465 00784000
*   /*****************************************************************/ 00785000
*   /*                                                               */ 00786000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS      @Y30LB31*/ 00787000
*   /* NO SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.       @Y30LB31*/ 00788000
*   /*                                                               */ 00789000
*   /*****************************************************************/ 00790000
*                                                                  0466 00791000
*   RESPECIFY                                                      0466 00792000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 00793000
*   RETADDR2=REG14;                 /*                       #Y30LB31*/ 00794000
         ST    REG14,RETADDR2                                      0467 00795000
*   RESPECIFY                                                      0468 00796000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 00797000
*   OLDERID2=NEWERID2;                                             0469 00798000
         L     @04,@PC00001                                        0469 00799000
         L     @04,GDTTR2(,@04)                                    0469 00800000
         MVC   @TS00001(95),NEWERID2(@04)                          0469 00801000
         MVC   OLDERID2(95,@04),@TS00001                           0469 00802000
*   NEWID2='AVVT';                  /*                       @Y30LB31*/ 00803000
*                                                                  0470 00804000
         MVC   NEWID2(4,@04),@CC01798                              0470 00805000
*   /*****************************************************************/ 00806000
*   /*                                                               */ 00807000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED            @Y30LB31*/ 00808000
*   /* WITHIN THIS PROCEDURE.                                @Y30LB31*/ 00809000
*   /*                                                               */ 00810000
*   /*****************************************************************/ 00811000
*                                                                  0471 00812000
*   VTYPERC=LASTCC00;               /*                       @Y30LB31*/ 00813000
         SLR   @15,@15                                             0471 00814000
         LR    VTYPERC,@15                                         0471 00815000
*                                                                  0472 00816000
*   /*****************************************************************/ 00817000
*   /*                                                               */ 00818000
*   /* IF A COPY VOLUME IS TO BE ACTIVATED,                  @ZDR2054*/ 00819000
*   /* WITHOUT BEING RENAMED TO REPLACE A BASE VOLUME,       @ZDR2054*/ 00820000
*   /* THEN ITS BASE VOLUME MUST BE READ FOR CHECKING        @ZDR2054*/ 00821000
*   /* OF CONDITIONS WHICH WILL PREVENT THE ACTIVATE.        @ZDR2054*/ 00822000
*   /*                                                               */ 00823000
*   /*****************************************************************/ 00824000
*                                                                  0472 00825000
*   IF ADDR(RVOL)^=NULLPTR THEN     /*                       @ZDR2054*/ 00826000
         L     @04,@PC00001+4                                      0472 00827000
         C     @15,FDTPTR+36(,@04)                                 0472 00828000
         BE    @RF00472                                            0472 00829000
*     DO;                           /*                       @ZDR2054*/ 00830000
*       RECTYPE=BASE;               /*                       @ZDR2054*/ 00831000
         MVC   RECTYPE(4),@CC01660                                 0474 00832000
*       CALL RVVIRTN;               /*                       @ZDR2054*/ 00833000
         BAL   @14,RVVIRTN                                         0475 00834000
*       RESPECIFY                                                  0476 00835000
*         RTNREG RSTD;                                             0476 00836000
*       TESTRC=RTNREG;                                             0477 00837000
         LR    TESTRC,RTNREG                                       0477 00838000
*       RESPECIFY                                                  0478 00839000
*         RTNREG UNRSTD;            /*                       @ZDR2054*/ 00840000
*       IF TESTRC^=0 THEN                                          0479 00841000
         LTR   TESTRC,TESTRC                                       0479 00842000
         BZ    @RF00479                                            0479 00843000
*         VTYPERC=4;                /*                       @ZDR2054*/ 00844000
         LA    VTYPERC,4                                           0480 00845000
*     END;                          /*                       @ZDR2054*/ 00846000
*                                                                  0481 00847000
@RF00479 DS    0H                                                  0482 00848000
*   /*****************************************************************/ 00849000
*   /*                                                               */ 00850000
*   /* SET APPROPRIATE RECORD TYPE TO BE RETRIEVED FROM      @Y30LB31*/ 00851000
*   /* THE INVENTORY                                         @Y30LB31*/ 00852000
*   /*                                                               */ 00853000
*   /*****************************************************************/ 00854000
*                                                                  0482 00855000
*   IF ADDR(CDATE)^=NULLPTR THEN    /*                       @Y30LB31*/ 00856000
@RF00472 L     @04,@PC00001+4                                      0482 00857000
         L     @04,FDTPTR+4(,@04)                                  0482 00858000
         LTR   @04,@04                                             0482 00859000
         BZ    @RF00482                                            0482 00860000
*     RECTYPE=COPY;                 /* SPECIFIC COPY RECORD  @Y30LB31*/ 00861000
         MVC   RECTYPE(4),@CC01664                                 0483 00862000
*   ELSE                            /*                       @Y30LB31*/ 00863000
*     IF ADDR(CART)^=NULLPTR THEN   /*                       @Y30LB31*/ 00864000
         B     @RC00482                                            0484 00865000
@RF00482 L     @04,@PC00001+4                                      0484 00866000
         L     @04,FDTPTR+16(,@04)                                 0484 00867000
         LTR   @04,@04                                             0484 00868000
         BZ    @RF00484                                            0484 00869000
*       DO;                         /*                       @Y30LB31*/ 00870000
*         RECTYPE=UNKN;             /* UNKNOWN RECORD TYPE   @Y30LB31*/ 00871000
*                                                                  0486 00872000
         MVC   RECTYPE(4),@CC01662                                 0486 00873000
*         /***********************************************************/ 00874000
*         /*                                                         */ 00875000
*         /* MOVE THE CARTRIDGE SERIAL NO. TO A WORKAREA     @Y30LB31*/ 00876000
*         /* AND CALL CKCSNLEN TO VALIDATE THE CSN LENGTH AND TO     */ 00877000
*         /* ADJUST IT FROM 11 TO 12 BYTES IF NECESSARY.     @Y30LB31*/ 00878000
*         /*                                                         */ 00879000
*         /***********************************************************/ 00880000
*                                                                  0487 00881000
*         CSNWKA=CARTVAL;           /*                       @Y30LB31*/ 00882000
         MVC   CSNWKA(12),CARTVAL(@04)                             0487 00883000
*         CALL CKCSNLEN(CSNWKA,CARTLEN);/*                   @Y30LB31*/ 00884000
         LA    @15,CSNWKA                                          0488 00885000
         ST    @15,@AL00001                                        0488 00886000
         ST    @04,@AL00001+4                                      0488 00887000
         LA    @01,@AL00001                                        0488 00888000
         BAL   @14,CKCSNLEN                                        0488 00889000
*         RESPECIFY                                                0489 00890000
*           RTNREG RSTD;                                           0489 00891000
*         TESTRC=RTNREG;                                           0490 00892000
         LR    TESTRC,RTNREG                                       0490 00893000
*         RESPECIFY                                                0491 00894000
*           RTNREG UNRSTD;          /*                       @Y30LB31*/ 00895000
*                                                                  0491 00896000
*         /***********************************************************/ 00897000
*         /*                                                         */ 00898000
*         /* TEST THE RETURN CODE FROM CKCSNLEN. IF THE CSN  @Y30LB31*/ 00899000
*         /* LENGTH IS INVALID, UPDATE THE COND CODE AND EXIT FROM   */ 00900000
*         /* THIS PROC.                                      @Y30LB31*/ 00901000
*         /*                                                         */ 00902000
*         /***********************************************************/ 00903000
*                                                                  0492 00904000
*         IF TESTRC^=0 THEN         /*                       @Y30LB31*/ 00905000
         LTR   TESTRC,TESTRC                                       0492 00906000
         BZ    @RF00492                                            0492 00907000
*           VTYPERC=4;              /*                       @Y30LB31*/ 00908000
         LA    VTYPERC,4                                           0493 00909000
*       END;                        /*                       @Y30LB31*/ 00910000
*     ELSE                          /*                       @Y30LB31*/ 00911000
*       RECTYPE=DUP;                /* DUPLICATE VOLUME REC  @Y30LB31*/ 00912000
         B     @RC00484                                            0495 00913000
@RF00484 MVC   RECTYPE(4),@CC01656                                 0495 00914000
*                                                                  0496 00915000
*   /*****************************************************************/ 00916000
*   /*                                                               */ 00917000
*   /* RETRIEVE THE DESIGNATED RECORD FROM INVENTORY.        @Y30LB31*/ 00918000
*   /*                                                               */ 00919000
*   /*****************************************************************/ 00920000
*                                                                  0496 00921000
*   IF VTYPERC=0 THEN               /*                       @Y30LB31*/ 00922000
@RC00484 DS    0H                                                  0496 00923000
@RC00482 LTR   VTYPERC,VTYPERC                                     0496 00924000
         BNZ   @RF00496                                            0496 00925000
*     DO;                           /*                       @Y30LB31*/ 00926000
*       CALL RVVIRTN;               /*                       @Y30LB31*/ 00927000
         BAL   @14,RVVIRTN                                         0498 00928000
*       RESPECIFY                                                  0499 00929000
*         RTNREG RSTD;                                             0499 00930000
*       TESTRC=RTNREG;                                             0500 00931000
         LR    TESTRC,RTNREG                                       0500 00932000
*       RESPECIFY                                                  0501 00933000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 00934000
*                                                                  0501 00935000
*       /*************************************************************/ 00936000
*       /*                                                           */ 00937000
*       /* TEST THE RETURN CODE FROM RVVIRTN. IF THE READ    @Y30LB31*/ 00938000
*       /* FAILED, UPDATE THE CONDITION CODE AND EXIT FROM VTYPERTN. */ 00939000
*       /*                                                   @Y30LB31*/ 00940000
*       /*                                                           */ 00941000
*       /*************************************************************/ 00942000
*                                                                  0502 00943000
*       IF TESTRC=4 THEN            /*                       @Y30LB31*/ 00944000
         LA    @04,4                                               0502 00945000
         CR    TESTRC,@04                                          0502 00946000
         BNE   @RF00502                                            0502 00947000
*         VTYPERC=4;                /*                       @Y30LB31*/ 00948000
*                                                                  0503 00949000
         LR    VTYPERC,@04                                         0503 00950000
*       /*************************************************************/ 00951000
*       /*                                                           */ 00952000
*       /* IF A DUPLICATE RECORD WAS RETRIEVED WHEN A        @Y30LB31*/ 00953000
*       /* PARTICULAR CARTRIDGE SERIAL NO. WAS NOT SPECIFIED, ADDV   */ 00954000
*       /* CANNOT DETERMINE WHETHER THE BASE VOLUME OR THIS DUPLICATE*/ 00955000
*       /* WITH THE SAME VOLUME SERIAL NO. IS TO BE ACTIVATED. OUTPUT*/ 00956000
*       /* MESSAGE IDC3089I AND EXIT FROM VTYPERTN.          @Y30LB31*/ 00957000
*       /*                                                           */ 00958000
*       /*************************************************************/ 00959000
*                                                                  0504 00960000
*       ELSE                        /*                       @Y30LB31*/ 00961000
*         IF RECTYPE=DUP THEN       /*                       @Y30LB31*/ 00962000
         B     @RC00502                                            0504 00963000
@RF00502 CLC   RECTYPE(4),@CC01656                                 0504 00964000
         BNE   @RF00504                                            0504 00965000
*           IF TESTRC^=LASTCC08 THEN/*                       @Y30LB31*/ 00966000
         C     TESTRC,@CF00182                                     0505 00967000
         BE    @RF00505                                            0505 00968000
*             DO;                   /*                       @Y30LB31*/ 00969000
*               VTYPERC=4;          /*                       @Y30LB31*/ 00970000
         LA    VTYPERC,4                                           0507 00971000
*               PRINTTBL=''B;       /*                       @Y30LB31*/ 00972000
         XC    PRINTTBL(28),PRINTTBL                               0508 00973000
*               DARGSMOD=COMMSGS;   /*                       @Y30LB31*/ 00974000
         L     @04,DDSTRU                                          0509 00975000
         MVC   DARGSMOD(3,@04),@CC01697                            0509 00976000
*               DARGSENT=MSG3089I;  /* STID = CM017          @Y30LB31*/ 00977000
         MVI   DARGSENT(@04),X'11'                                 0510 00978000
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB31*/ 00979000
         L     @15,@PC00001+4                                      0511 00980000
         L     @15,FDTPTR(,@15)                                    0511 00981000
         LA    @14,VOLVAL(,@15)                                    0511 00982000
         ST    @14,DARGDBP(,@04)                                   0511 00983000
*               DARGILP=VOLLEN;     /*                       @Y30LB31*/ 00984000
         SLR   @14,@14                                             0512 00985000
         IC    @14,VOLLEN(,@15)                                    0512 00986000
         STH   @14,DARGILP(,@04)                                   0512 00987000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB31*/ 00988000
         L     @04,@PC00001                                        0513 00989000
         ST    @04,@AL00001                                        0513 00990000
         LA    @15,@CF00117                                        0513 00991000
         ST    @15,@AL00001+4                                      0513 00992000
         LA    @15,DDSTRU                                          0513 00993000
         ST    @15,@AL00001+8                                      0513 00994000
         MVI   @AL00001+8,X'80'                                    0513 00995000
         L     @15,GDTPRT(,@04)                                    0513 00996000
         LA    @01,@AL00001                                        0513 00997000
         BALR  @14,@15                                             0513 00998000
*             END;                  /*                       @Y30LB31*/ 00999000
*                                                                  0514 01000000
*       /*************************************************************/ 01001000
*       /*                                                           */ 01002000
*       /* SINCE A DUPLICATE                                 @Y30LB31*/ 01003000
*       /* RECORD WAS NOT FOUND, ADDV CAN ACTIVATE THE BASE VOL.     */ 01004000
*       /* RETRIEVE THE BASE VOLUME RECORD.                  @Y30LB31*/ 01005000
*       /*                                                           */ 01006000
*       /*************************************************************/ 01007000
*                                                                  0515 01008000
*           ELSE                    /*                       @Y30LB31*/ 01009000
*             DO;                   /*                       @Y30LB31*/ 01010000
         B     @RC00505                                            0515 01011000
@RF00505 DS    0H                                                  0516 01012000
*               RECTYPE=BASE;       /*                       @Y30LB31*/ 01013000
         MVC   RECTYPE(4),@CC01660                                 0516 01014000
*               CALL RVVIRTN;       /*                       @Y30LB31*/ 01015000
         BAL   @14,RVVIRTN                                         0517 01016000
*               RESPECIFY                                          0518 01017000
*                 RTNREG RSTD;                                     0518 01018000
*               TESTRC=RTNREG;                                     0519 01019000
         LR    TESTRC,RTNREG                                       0519 01020000
*               RESPECIFY                                          0520 01021000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 01022000
*                                                                  0520 01023000
*               /*****************************************************/ 01024000
*               /*                                                   */ 01025000
*               /* TEST THE RETURN CODE FROM RVVIRTN. IF     @Y30LB31*/ 01026000
*               /* THE BASE RECORD COULD NOT BE RETRIEVED, UPDATE THE*/ 01027000
*               /* COND CODE AND EXIT FROM VTYPERTN.         @Y30LB31*/ 01028000
*               /*                                                   */ 01029000
*               /*****************************************************/ 01030000
*                                                                  0521 01031000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 01032000
         LTR   TESTRC,TESTRC                                       0521 01033000
         BZ    @RF00521                                            0521 01034000
*                 VTYPERC=4;        /*                       @Y30LB31*/ 01035000
         LA    VTYPERC,4                                           0522 01036000
*             END;                  /*                       @Y30LB31*/ 01037000
*                                                                  0523 01038000
@RF00521 DS    0H                                                  0524 01039000
*       /*************************************************************/ 01040000
*       /*                                                           */ 01041000
*       /* CLOSE DO GROUP THAT READS A VOLUME RECORD.        @Y30LB31*/ 01042000
*       /*                                                           */ 01043000
*       /*************************************************************/ 01044000
*                                                                  0524 01045000
*     END;                          /*                       @Y30LB31*/ 01046000
@RC00505 DS    0H                                                  0524 01047000
@RF00504 DS    0H                                                  0524 01048000
@RC00502 DS    0H                                                  0525 01049000
*                                                                  0525 01050000
*   /*****************************************************************/ 01051000
*   /*                                                               */ 01052000
*   /* IF THE RECORD FOR THE VOLUME BEING ACTIVATED WAS      @Y30LB31*/ 01053000
*   /* RETRIEVED, CHECK THE VOLUME RECORD FOR CONDITIONS WHICH WILL  */ 01054000
*   /* PREVENT THE ACTIVATE.                                 @Y30LB31*/ 01055000
*   /*                                                               */ 01056000
*   /*****************************************************************/ 01057000
*                                                                  0525 01058000
*   IF VTYPERC=0 THEN               /*                       @Y30LB31*/ 01059000
@RF00496 LTR   VTYPERC,VTYPERC                                     0525 01060000
         BNZ   @RF00525                                            0525 01061000
*     DO;                           /*                       @Y30LB31*/ 01062000
*       CALL VOLCKRTN;              /*                       @Y30LB31*/ 01063000
         BAL   @14,VOLCKRTN                                        0527 01064000
*       RESPECIFY                                                  0528 01065000
*         RTNREG RSTD;                                             0528 01066000
*       TESTRC=RTNREG;                                             0529 01067000
         LR    TESTRC,RTNREG                                       0529 01068000
*       RESPECIFY                                                  0530 01069000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 01070000
*                                                                  0530 01071000
*       /*************************************************************/ 01072000
*       /*                                                           */ 01073000
*       /* TEST RETURN CODE FROM VOLCKRTN. IF THE VOL        @Y30LB31*/ 01074000
*       /* CHECK OUT FAILED, THE VOL CANNOT BE ACTIVATED. UPDATE THE */ 01075000
*       /*                                                   @Y30LB31*/ 01076000
*       /* COND CODE AND EXIT FROM VTYPERTN.                 @Y30LB31*/ 01077000
*       /*                                                           */ 01078000
*       /*************************************************************/ 01079000
*                                                                  0531 01080000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 01081000
         LTR   TESTRC,TESTRC                                       0531 01082000
         BZ    @RF00531                                            0531 01083000
*         VTYPERC=4;                /*                       @Y30LB31*/ 01084000
*                                                                  0532 01085000
         LA    VTYPERC,4                                           0532 01086000
*       /*************************************************************/ 01087000
*       /*                                                           */ 01088000
*       /* IF A GENERAL-USE BASE VOLUME IS BEING             @ZDR2054*/ 01089000
*       /* ACTIVATED OR IS BEING REPLACED WITH A COPY        @ZDR2054*/ 01090000
*       /* RETRIEVE THE GROUP RECORD FOR THIS BASE VOLUME    @ZDR2054*/ 01091000
*       /*                                                           */ 01092000
*       /*************************************************************/ 01093000
*                                                                  0533 01094000
*       ELSE                        /*                       @Y30LB31*/ 01095000
*         IF BCDBASE=ON|ADDR(RVOL)^=NULLPTR THEN/*           @ZDR2054*/ 01096000
         B     @RC00531                                            0533 01097000
@RF00531 TM    BCDBASE(BCDVPTR),B'00100000'                        0533 01098000
         BO    @RT00533                                            0533 01099000
         L     @04,@PC00001+4                                      0533 01100000
         L     @04,FDTPTR+36(,@04)                                 0533 01101000
         LTR   @04,@04                                             0533 01102000
         BZ    @RF00533                                            0533 01103000
@RT00533 DS    0H                                                  0534 01104000
*           IF BASGENUS=ON|COPGENUS=ON/*                     @ZDR2054*/ 01105000
*             THEN                                                 0534 01106000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0534 01107000
         BO    @RT00534                                            0534 01108000
         L     @04,COPYVPTR                                        0534 01109000
         TM    COPGENUS(@04),B'00100000'                           0534 01110000
         BNO   @RF00534                                            0534 01111000
@RT00534 DS    0H                                                  0535 01112000
*             DO;                   /*                       @Y30LB31*/ 01113000
*               RECTYPE=GRP;        /*                       @Y30LB31*/ 01114000
         MVC   RECTYPE(4),@CC01658                                 0536 01115000
*               CALL RVVIRTN;       /*                       @Y30LB31*/ 01116000
         BAL   @14,RVVIRTN                                         0537 01117000
*               RESPECIFY                                          0538 01118000
*                 RTNREG RSTD;                                     0538 01119000
*               TESTRC=RTNREG;                                     0539 01120000
         LR    TESTRC,RTNREG                                       0539 01121000
*               RESPECIFY                                          0540 01122000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 01123000
*                                                                  0540 01124000
*               /*****************************************************/ 01125000
*               /*                                                   */ 01126000
*               /* TEST THE RETURN CODE FROM RVVIRTN.        @Y30LB31*/ 01127000
*               /* IF THE GROUP RECORD COULD NOT BE READ, UPDATE THE */ 01128000
*               /* CONDITION CODE AND EXIT FROM VTYPERTN.    @Y30LB31*/ 01129000
*               /*                                                   */ 01130000
*               /*****************************************************/ 01131000
*                                                                  0541 01132000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 01133000
         LTR   TESTRC,TESTRC                                       0541 01134000
         BZ    @RF00541                                            0541 01135000
*                 VTYPERC=4;        /*                       @Y30LB31*/ 01136000
*                                                                  0542 01137000
         LA    VTYPERC,4                                           0542 01138000
*               /*****************************************************/ 01139000
*               /*                                                   */ 01140000
*               /* AN ERROR EXISTS IF READWRITE IS SPECIFIED @Y30LB31*/ 01141000
*               /* BUT GROUP IS READONLY. UPDATE CONDITION CODE.     */ 01142000
*               /* OUTPUT MESSAGE IDC3072I AND EXIT FROM VTYPERTN.   */ 01143000
*               /*                                           @Y30LB31*/ 01144000
*               /*                                                   */ 01145000
*               /*****************************************************/ 01146000
*                                                                  0543 01147000
*               ELSE                /*                       @Y30LB31*/ 01148000
*                 IF GRORONLY=ON THEN/*                      @Y30LB31*/ 01149000
         B     @RC00541                                            0543 01150000
@RF00541 L     @04,GROUPPTR                                        0543 01151000
         TM    GRORONLY(@04),B'00010000'                           0543 01152000
         BNO   @RF00543                                            0543 01153000
*                   IF ADDR(RWOPT)^=NULLPTR THEN/*           @Y30LB31*/ 01154000
         L     @04,@PC00001+4                                      0544 01155000
         L     @04,FDTPTR+24(,@04)                                 0544 01156000
         LTR   @04,@04                                             0544 01157000
         BZ    @RF00544                                            0544 01158000
*                     DO;           /*                       @Y30LB31*/ 01159000
*                       VTYPERC=4;  /*                       @Y30LB31*/ 01160000
         LA    VTYPERC,4                                           0546 01161000
*                       PRINTTBL=''B;/*                      @Y30LB31*/ 01162000
         XC    PRINTTBL(28),PRINTTBL                               0547 01163000
*                       DARGSMOD=COMMSGS;/*                  @Y30LB31*/ 01164000
         L     @04,DDSTRU                                          0548 01165000
         MVC   DARGSMOD(3,@04),@CC01697                            0548 01166000
*                       DARGSENT=MSG3072I;/* STID=CM034      @Y30LB31*/ 01167000
         MVI   DARGSENT(@04),X'22'                                 0549 01168000
*                       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    0550 01169000
*                                                            @Y30LB31*/ 01170000
         L     @04,@PC00001                                        0550 01171000
         ST    @04,@AL00001                                        0550 01172000
         LA    @15,@CF00117                                        0550 01173000
         ST    @15,@AL00001+4                                      0550 01174000
         LA    @15,DDSTRU                                          0550 01175000
         ST    @15,@AL00001+8                                      0550 01176000
         MVI   @AL00001+8,X'80'                                    0550 01177000
         L     @15,GDTPRT(,@04)                                    0550 01178000
         LA    @01,@AL00001                                        0550 01179000
         BALR  @14,@15                                             0550 01180000
*                     END;          /*                       @Y30LB31*/ 01181000
*                                                                  0551 01182000
*               /*****************************************************/ 01183000
*               /*                                                   */ 01184000
*               /* CLOSE DO GROUP WHICH READS AND CHECKS OUT @Y30LB31*/ 01185000
*               /* THE GROUP RECORD.                         @Y30LB31*/ 01186000
*               /*                                                   */ 01187000
*               /*****************************************************/ 01188000
*                                                                  0552 01189000
*             END;                  /*                       @Y30LB31*/ 01190000
*                                                                  0552 01191000
@RF00544 DS    0H                                                  0552 01192000
@RF00543 DS    0H                                                  0552 01193000
@RC00541 DS    0H                                                  0553 01194000
*       /*************************************************************/ 01195000
*       /*                                                           */ 01196000
*       /* CLOSE THE DO GROUP WHICH CALLS VOLCKRTN.          @Y30LB31*/ 01197000
*       /*                                                           */ 01198000
*       /*************************************************************/ 01199000
*                                                                  0553 01200000
*     END;                          /*                       @Y30LB31*/ 01201000
*                                                                  0553 01202000
@RF00534 DS    0H                                                  0553 01203000
@RF00533 DS    0H                                                  0553 01204000
@RC00531 DS    0H                                                  0554 01205000
*   /*****************************************************************/ 01206000
*   /*                                                               */ 01207000
*   /* RESTORE REG 14 TO RETURN ADDRESS OF INVOKER.          @Y30LB31*/ 01208000
*   /*                                                               */ 01209000
*   /*****************************************************************/ 01210000
*                                                                  0554 01211000
*   RESPECIFY                                                      0554 01212000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 01213000
@RF00525 DS    0H                                                  0555 01214000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 01215000
         L     REG14,RETADDR2                                      0555 01216000
*   RESPECIFY                                                      0556 01217000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 01218000
*                                                                  0556 01219000
*   /*****************************************************************/ 01220000
*   /*                                                               */ 01221000
*   /* RETURN TO CALLER WITH THE CONDITION CODE SETTING      @Y30LB31*/ 01222000
*   /*                                                               */ 01223000
*   /*****************************************************************/ 01224000
*                                                                  0557 01225000
*   RETURN CODE(VTYPERC);           /*                       @Y30LB31*/ 01226000
         LR    @15,VTYPERC                                         0557 01227000
@EL00003 DS    0H                                                  0557 01228000
@EF00003 DS    0H                                                  0557 01229000
@ER00003 BR    @14                                                 0557 01230000
*   END VTYPERTN;                   /*                       @Y30LB31*/ 01231000
*                                                                  0559 01232000
*/********************************************************** @Y30LB31*/ 01233000
*/*                                                          @Y30LB31*/ 01234000
*/* PROCEDURE NAME - RVVIRTN                                 @Y30LB31*/ 01235000
*/*                                                          @Y30LB31*/ 01236000
*/* FUNCTION - READS A BASE, COPY, DUPLICATE, OR GROUP       @Y30LB31*/ 01237000
*/*            RECORD.  IF CARTRIDGE SERIAL NO. IS THE ONLY  @Y30LB31*/ 01238000
*/*            IDENTIFICATION, RVVIRTN READS A RECORD OF     @Y30LB31*/ 01239000
*/*            UNKNOWN TYPE.  CALLS SSCMSG TO OUTPUT ANY     @Y30LB31*/ 01240000
*/*            MSSC ERROR MESSAGES.  MESSAGES, IDC3081I,     @Y30LB31*/ 01241000
*/*            IDC2080I, AND IDC2079I, MAY BE ISSUED.        @Y30LB31*/ 01242000
*/*                                                          @Y30LB31*/ 01243000
*/* INPUT - FDTTBL, ADDVTBL, VOLUME RECORD BUFFER,           @Y30LB31*/ 01244000
*/*         GROUP BUFFER, AND PRINTTBL FOR MESSAGES.         @Y30LB31*/ 01245000
*/*                                                          @Y30LB31*/ 01246000
*/* OUTPUT - RETURN CODE OF 4 IF READ FAILED.                @Y30LB31*/ 01247000
*/*          RETURN CODE OF 8 IF NO DUPLICATE RECORD FOUND.  @Y30LB31*/ 01248000
*/*          RETURN CODE OF 0 INDICATES SUCCESSFUL READ AND  @Y30LB31*/ 01249000
*/*          BUFFER CONTAINS A BASE, COPY, DUPLICATE OR      @Y30LB31*/ 01250000
*/*          GROUP RECORD.                                   @Y30LB31*/ 01251000
*/*                                                          @Y30LB31*/ 01252000
*/********************************************************** @Y30LB31*/ 01253000
*                                                                  0559 01254000
*RVVIRTN:                                                          0559 01255000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 01256000
*                                                                  0559 01257000
RVVIRTN  DS    0H                                                  0560 01258000
*   /*****************************************************************/ 01259000
*   /*                                                               */ 01260000
*   /* LOCAL DECLARATIONS                                    @Y30LB31*/ 01261000
*   /*                                                               */ 01262000
*   /*****************************************************************/ 01263000
*                                                                  0560 01264000
*   DCL                                                            0560 01265000
*     RVRTNRC FIXED(15);            /* INTERNAL CONDITION CODE     0560 01266000
*                                                            @Y30LB31*/ 01267000
*   DCL                                                            0561 01268000
*     RCNOREC BIT(32)               /* RECORD NOT FOUND COND @Y30LB31*/ 01269000
*         CONSTANT('00000208'X);    /*                       @Y30LB31*/ 01270000
*   DCL                                                            0562 01271000
*     CDATEWKA CHAR(4);             /* PACKED DECIMAL WKA    @Y30LB31*/ 01272000
*   DCL                                                            0563 01273000
*     SEQ#DFLT FIXED(31) CONSTANT(1);/* SEQ NO. DEFAULT      @Y30LB31*/ 01274000
*                                                                  0563 01275000
*   /*****************************************************************/ 01276000
*   /*                                                               */ 01277000
*   /* SETUP STORAGE AREA TO BUILD MSVC RVVI PARM            @Y30LB31*/ 01278000
*   /* LIST TO READ A RECORD FROM MSVI.                      @Y30LB31*/ 01279000
*   /*                                                               */ 01280000
*   /*****************************************************************/ 01281000
*                                                                  0564 01282000
*   DCL                                                            0564 01283000
*     1 AV01RVVI BDY(WORD),         /*                       @Y30LB31*/ 01284000
*      2 AVRVVIID CHAR(8),          /* RVVI ARG LIST ID      @Y30LB31*/ 01285000
*      2 AVRVVI CHAR(LENGTH(RVVI)) BDY(WORD);/*              @Y30LB31*/ 01286000
*                                                                  0564 01287000
*   /*****************************************************************/ 01288000
*   /*                                                               */ 01289000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 01290000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 01291000
*   /*                                                               */ 01292000
*   /*****************************************************************/ 01293000
*                                                                  0565 01294000
*   RESPECIFY                                                      0565 01295000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 01296000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 01297000
         ST    REG14,RETADDR3                                      0566 01298000
*   RESPECIFY                                                      0567 01299000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 01300000
*   OLDERID2=NEWERID2;                                             0568 01301000
         L     @15,@PC00001                                        0568 01302000
         L     @15,GDTTR2(,@15)                                    0568 01303000
         MVC   @TS00001(95),NEWERID2(@15)                          0568 01304000
         MVC   OLDERID2(95,@15),@TS00001                           0568 01305000
*   NEWID2='AVRV';                  /*                       @Y30LB31*/ 01306000
*                                                                  0569 01307000
         MVC   NEWID2(4,@15),@CC01813                              0569 01308000
*   /*****************************************************************/ 01309000
*   /*                                                               */ 01310000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN     @Y30LB31*/ 01311000
*   /* THIS PROCEDURE.                                       @Y30LB31*/ 01312000
*   /*                                                               */ 01313000
*   /*****************************************************************/ 01314000
*                                                                  0570 01315000
*   RVRTNRC=LASTCC00;               /*                       @Y30LB31*/ 01316000
*                                                                  0570 01317000
         SLR   @15,@15                                             0570 01318000
         LR    RVRTNRC,@15                                         0570 01319000
*   /*****************************************************************/ 01320000
*   /*                                                               */ 01321000
*   /* INITIALIZE MSVC READ PARM LIST. INITIALIZE THE RVVI   @Y30LB31*/ 01322000
*   /* FIELDS COMMON TO ALL READ REQUESTS.                   @Y30LB31*/ 01323000
*   /*                                                               */ 01324000
*   /*****************************************************************/ 01325000
*                                                                  0571 01326000
*   AVRVVIID='RVVI';                /*                       @Y30LB31*/ 01327000
         MVI   AVRVVIID+4,C' '                                     0571 01328000
         MVC   AVRVVIID+5(3),AVRVVIID+4                            0571 01329000
         MVC   AVRVVIID(4),@CC01814                                0571 01330000
*   RVVIPTR=ADDR(AVRVVI);           /*                       @Y30LB31*/ 01331000
         LA    @14,AVRVVI                                          0572 01332000
         ST    @14,RVVIPTR                                         0572 01333000
*   RVVI=''B;                       /*                       @Y30LB31*/ 01334000
         XC    RVVI(68,@14),RVVI(@14)                              0573 01335000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB31*/ 01336000
         LH    @03,RVVLEN                                          0574 01337000
         ST    @03,RVVLNGTH(,@14)                                  0574 01338000
*   RVVCODE=RVVOP;                  /*                       @Y30LB31*/ 01339000
         MVI   RVVCODE(@14),X'87'                                  0575 01340000
*   RVVRDR=ON;                      /*                       @Y30LB31*/ 01341000
*                                                                  0576 01342000
         OI    RVVRDR(@14),B'10000000'                             0576 01343000
*   /*****************************************************************/ 01344000
*   /*                                                               */ 01345000
*   /* SET THE VOLUME SERIAL NO. AND BUFFER FIELDS IN THE    @Y30LB31*/ 01346000
*   /* PARM LIST IF A VOLUME RECORD IS BEING READ.           @Y30LB31*/ 01347000
*   /*                                                               */ 01348000
*   /*****************************************************************/ 01349000
*                                                                  0577 01350000
*   IF RECTYPE^=GRP THEN            /*                       @Y30LB31*/ 01351000
         CLC   RECTYPE(4),@CC01658                                 0577 01352000
         BE    @RF00577                                            0577 01353000
*     DO;                           /*                       @Y30LB31*/ 01354000
*       RVVOLUME=VOLVAL;            /*                       @Y30LB31*/ 01355000
         L     @03,@PC00001+4                                      0579 01356000
         L     @01,FDTPTR(,@03)                                    0579 01357000
         MVC   RVVOLUME(6,@14),VOLVAL(@01)                         0579 01358000
*       RVVSVOL=ON;                 /*                       @Y30LB31*/ 01359000
         OI    RVVSVOL(@14),B'00000001'                            0580 01360000
*       IF ADDR(RVOL)^=NULLPTR&RECTYPE=BASE THEN/*           @ZDR2054*/ 01361000
         C     @15,FDTPTR+36(,@03)                                 0581 01362000
         BE    @RF00581                                            0581 01363000
         CLC   RECTYPE(4),@CC01660                                 0581 01364000
         BNE   @RF00581                                            0581 01365000
*         DO;                       /*                       @ZDR2054*/ 01366000
*           BASEVPTR=ADDR(TEMPBUF); /*                       @ZA17143*/ 01367000
         LA    @15,TEMPBUF                                         0583 01368000
         LR    BASEVPTR,@15                                        0583 01369000
*           RVVRTBUF=ADDR(TEMPBUF); /*                       @ZDR2054*/ 01370000
         ST    @15,RVVRTBUF(,@14)                                  0584 01371000
*           RVVBUFLN=LENGTH(TEMPBUF);/*                      @ZDR2054*/ 01372000
         MVC   RVVBUFLN(2,@14),@CH01996                            0585 01373000
*         END;                      /*                       @ZDR2054*/ 01374000
*       ELSE                        /*                       @ZDR2054*/ 01375000
*         DO;                       /*                       @ZDR2054*/ 01376000
         B     @RC00581                                            0587 01377000
@RF00581 DS    0H                                                  0588 01378000
*           RVVRTBUF=ADDR(VOLREC);  /*                       @Y30LB31*/ 01379000
         L     @15,RVVIPTR                                         0588 01380000
         LA    @14,VOLREC                                          0588 01381000
         ST    @14,RVVRTBUF(,@15)                                  0588 01382000
*           RVVBUFLN=LENGTH(VOLREC);/*                       @Y30LB31*/ 01383000
         MVC   RVVBUFLN(2,@15),@CH01996                            0589 01384000
*         END;                      /*                       @ZDR2054*/ 01385000
*     END;                          /*                       @Y30LB31*/ 01386000
*                                                                  0591 01387000
@RC00581 DS    0H                                                  0592 01388000
*   /*****************************************************************/ 01389000
*   /*                                                               */ 01390000
*   /* INITIALIZE THE FOLLOWING FIELD TO READ A BASE         @Y30LB31*/ 01391000
*   /* VOLUME RECORD.                                        @Y30LB31*/ 01392000
*   /*                                                               */ 01393000
*   /*****************************************************************/ 01394000
*                                                                  0592 01395000
*   IF RECTYPE=BASE THEN            /*                       @Y30LB31*/ 01396000
@RF00577 CLC   RECTYPE(4),@CC01660                                 0592 01397000
         BNE   @RF00592                                            0592 01398000
*     RVVBVRCD=ON;                  /*                       @Y30LB31*/ 01399000
*                                                                  0593 01400000
         L     @01,RVVIPTR                                         0593 01401000
         OI    RVVBVRCD(@01),B'10000000'                           0593 01402000
*   /*****************************************************************/ 01403000
*   /*                                                               */ 01404000
*   /* INITIALIZE THE FOLLOWING FIELDS TO READ A SPECIFIC    @Y30LB31*/ 01405000
*   /* COPY VOLUME RECORD.                                   @Y30LB31*/ 01406000
*   /*                                                               */ 01407000
*   /*****************************************************************/ 01408000
*                                                                  0594 01409000
*   ELSE                            /*                       @Y30LB31*/ 01410000
*     IF RECTYPE=COPY THEN          /*                       @Y30LB31*/ 01411000
         B     @RC00592                                            0594 01412000
@RF00592 CLC   RECTYPE(4),@CC01664                                 0594 01413000
         BNE   @RF00594                                            0594 01414000
*       DO;                         /*                       @Y30LB31*/ 01415000
*         RVVCPYRC=ON;              /*                       @Y30LB31*/ 01416000
         L     @15,RVVIPTR                                         0596 01417000
         OI    RVVCPYRC(@15),B'00100000'                           0596 01418000
*         CVD(DATEVAL,CDATEWKA);    /*                       @Y30LB31*/ 01419000
         L     @14,@PC00001+4                                      0597 01420000
         L     @01,FDTPTR+8(,@14)                                  0597 01421000
         L     @03,DATEVAL(,@01)                                   0597 01422000
         CVD   @03,@TS00001                                        0597 01423000
         MVC   CDATEWKA(4),@TS00001+4                              0597 01424000
*         RVVCDATE=CDATEWKA;        /*                       @Y30LB31*/ 01425000
         MVC   RVVCDATE(4,@15),CDATEWKA                            0598 01426000
*         RVVSDTE=ON;               /*                       @Y30LB31*/ 01427000
         OI    RVVSDTE(@15),B'00100000'                            0599 01428000
*         IF ADDR(SEQ#)^=NULLPTR THEN/*                      @Y30LB31*/ 01429000
         L     @14,FDTPTR+12(,@14)                                 0600 01430000
         LTR   @14,@14                                             0600 01431000
         BZ    @RF00600                                            0600 01432000
*           DO;                     /*                       @Y30LB31*/ 01433000
*             RVVRDSEQ=SEQ#VAL;     /*                       @Y30LB31*/ 01434000
         MVC   RVVRDSEQ(1,@15),SEQ#VAL+3(@14)                      0602 01435000
*             RVVSSEQ=ON;           /*                       @Y30LB31*/ 01436000
         OI    RVVSSEQ(@15),B'00010000'                            0603 01437000
*           END;                    /*                       @Y30LB31*/ 01438000
*       END;                        /*                       @Y30LB31*/ 01439000
*                                                                  0605 01440000
*   /*****************************************************************/ 01441000
*   /*                                                               */ 01442000
*   /* INITIALIZE THE FOLLOWING FIELD TO READ A              @Y30LB31*/ 01443000
*   /* DUPLICATE VOLUME RECORD.                              @Y30LB31*/ 01444000
*   /*                                                               */ 01445000
*   /*****************************************************************/ 01446000
*                                                                  0606 01447000
*     ELSE                          /*                       @Y30LB31*/ 01448000
*       IF RECTYPE=DUP THEN         /*                       @Y30LB31*/ 01449000
         B     @RC00594                                            0606 01450000
@RF00594 CLC   RECTYPE(4),@CC01656                                 0606 01451000
         BNE   @RF00606                                            0606 01452000
*         RVVDUPRC=ON;              /*                       @Y30LB31*/ 01453000
*                                                                  0607 01454000
         L     @01,RVVIPTR                                         0607 01455000
         OI    RVVDUPRC(@01),B'00010000'                           0607 01456000
*   /*****************************************************************/ 01457000
*   /*                                                               */ 01458000
*   /* INTIIALIZE THE FOLLOWING FIELDS TO READ A RECORD      @Y30LB31*/ 01459000
*   /* OF UNKNOWN TYPE SINCE THE CARTRIDGE SERIAL NO. IS PROVIDED    */ 01460000
*   /*                                                       @Y30LB31*/ 01461000
*   /*                                                               */ 01462000
*   /*****************************************************************/ 01463000
*                                                                  0608 01464000
*       ELSE                        /*                       @Y30LB31*/ 01465000
*         IF RECTYPE=UNKN THEN      /*                       @Y30LB31*/ 01466000
         B     @RC00606                                            0608 01467000
@RF00606 CLC   RECTYPE(4),@CC01662                                 0608 01468000
         BNE   @RF00608                                            0608 01469000
*           DO;                     /*                       @Y30LB31*/ 01470000
*             RVVRUNKN=ON;          /*                       @Y30LB31*/ 01471000
         L     @15,RVVIPTR                                         0610 01472000
         OI    RVVRUNKN(@15),B'00001000'                           0610 01473000
*             RVVRDCSN=CSNWKA;      /*                       @Y30LB31*/ 01474000
         MVC   RVVRDCSN(12,@15),CSNWKA                             0611 01475000
*             RVVSCSN=ON;           /*                       @Y30LB31*/ 01476000
         OI    RVVSCSN(@15),B'00001000'                            0612 01477000
*           END;                    /*                       @Y30LB31*/ 01478000
*                                                                  0613 01479000
*   /*****************************************************************/ 01480000
*   /*                                                               */ 01481000
*   /* INITIALIZE THE FOLLOWING FIELDS TO READ A             @Y30LB31*/ 01482000
*   /* GROUP RECORD.                                         @Y30LB31*/ 01483000
*   /*                                                               */ 01484000
*   /*****************************************************************/ 01485000
*                                                                  0614 01486000
*         ELSE                      /*                       @Y30LB31*/ 01487000
*           DO;                     /*                       @Y30LB31*/ 01488000
         B     @RC00608                                            0614 01489000
@RF00608 DS    0H                                                  0615 01490000
*             RVVGRPRC=ON;          /*                       @Y30LB31*/ 01491000
         L     @15,RVVIPTR                                         0615 01492000
         OI    RVVGRPRC(@15),B'01000000'                           0615 01493000
*             RVVGROUP=BASGROUP;    /*                       @Y30LB31*/ 01494000
         MVC   RVVGROUP(8,@15),BASGROUP(BASEVPTR)                  0616 01495000
*             RVVSGRP=ON;           /*                       @Y30LB31*/ 01496000
         OI    RVVSGRP(@15),B'10000000'                            0617 01497000
*             RVVRTBUF=ADDR(GRPREC);/*                       @Y30LB31*/ 01498000
         LA    @14,GRPREC                                          0618 01499000
         ST    @14,RVVRTBUF(,@15)                                  0618 01500000
*             RVVBUFLN=LENGTH(GRPREC);/*                     @Y30LB31*/ 01501000
         MVC   RVVBUFLN(2,@15),@CH01997                            0619 01502000
*           END;                    /*                       @Y30LB31*/ 01503000
*                                                                  0621 01504000
*   /*****************************************************************/ 01505000
*   /*                                                               */ 01506000
*   /* TAKE A SYMBOLIC DUMP OF THE RVVI PARM LIST            @Y30LB31*/ 01507000
*   /* BEFORE THE READ.                                      @Y30LB31*/ 01508000
*   /*                                                               */ 01509000
*   /*****************************************************************/ 01510000
*                                                                  0621 01511000
*   IF GDTDBG=NULLPTR THEN                                         0621 01512000
@RC00608 DS    0H                                                  0621 01513000
@RC00606 DS    0H                                                  0621 01514000
@RC00594 DS    0H                                                  0621 01515000
@RC00592 L     @15,@PC00001                                        0621 01516000
         L     @15,GDTDBG(,@15)                                    0621 01517000
         LTR   @15,@15                                             0621 01518000
         BZ    @RT00621                                            0621 01519000
*     ;                                                            0622 01520000
*   ELSE                                                           0623 01521000
*     DO;                                                          0623 01522000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 01523000
         LA    DMPINDEX,AVDMPLST                                   0624 01524000
*       DMPITMNM='AV01RVVI';                                       0625 01525000
         MVC   DMPITMNM(8,DMPINDEX),@CC01816                       0625 01526000
*       DMPITMPT=ADDR(AV01RVVI);                                   0626 01527000
         LA    @03,AV01RVVI                                        0626 01528000
         ST    @03,DMPITMPT(,DMPINDEX)                             0626 01529000
*       DMPITMLN=LENGTH(AV01RVVI);                                 0627 01530000
         MVC   DMPITMLN(2,DMPINDEX),@CH01998                       0627 01531000
*       DMPITMTP='H';                                              0628 01532000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0628 01533000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0629 01534000
*                                                                  0629 01535000
         LA    @03,16                                              0629 01536000
         ALR   DMPINDEX,@03                                        0629 01537000
*       /*************************************************************/ 01538000
*       /*                                                           */ 01539000
*       /*                                                   @Y30LB31*/ 01540000
*       /*                                                           */ 01541000
*       /*************************************************************/ 01542000
*                                                                  0630 01543000
*       DMPITMNM='ADDVTBL';                                        0630 01544000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0630 01545000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       0630 01546000
*       DMPITMPT=ADDR(ADDVTBL);                                    0631 01547000
         LA    @15,ADDVTBL                                         0631 01548000
         ST    @15,DMPITMPT(,DMPINDEX)                             0631 01549000
*       DMPITMLN=LENGTH(ADDVTBL);                                  0632 01550000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       0632 01551000
*       DMPITMTP='H';                                              0633 01552000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0633 01553000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 01554000
         ALR   DMPINDEX,@03                                        0634 01555000
*       DMPTRM=DMPTRMVL;                                           0635 01556000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0635 01557000
*     END;                          /*                       @Y30LB31*/ 01558000
*   IF GDTDBG=NULLPTR THEN                                         0637 01559000
@RT00621 L     @15,@PC00001                                        0637 01560000
         L     @15,GDTDBG(,@15)                                    0637 01561000
         LTR   @15,@15                                             0637 01562000
         BZ    @RT00637                                            0637 01563000
*     ;                                                            0638 01564000
*   ELSE                                                           0639 01565000
*     CALL IDCDB010(GDTTBL,'AVRD',ADDR(AVDMPLST));/*         @Y30LB31*/ 01566000
*                                                                  0639 01567000
         L     @15,@PC00001                                        0639 01568000
         ST    @15,@AL00001                                        0639 01569000
         LA    @14,@CC01818                                        0639 01570000
         ST    @14,@AL00001+4                                      0639 01571000
         LA    @14,AVDMPLST                                        0639 01572000
         ST    @14,@AFTEMPS                                        0639 01573000
         LA    @14,@AFTEMPS                                        0639 01574000
         ST    @14,@AL00001+8                                      0639 01575000
         MVI   @AL00001+8,X'80'                                    0639 01576000
         L     @15,GDTDBG(,@15)                                    0639 01577000
         LA    @01,@AL00001                                        0639 01578000
         BALR  @14,@15                                             0639 01579000
*   /*****************************************************************/ 01580000
*   /*                                                               */ 01581000
*   /* READ THE RECORD SPECIFIED IN THE RVVI PARM LIST.      @Y30LB31*/ 01582000
*   /*                                                               */ 01583000
*   /*****************************************************************/ 01584000
*                                                                  0640 01585000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASON);/*             @Y30LB31*/ 01586000
@RT00637 L     @02,@PC00001                                        0640 01587000
         ST    @02,@AL00001                                        0640 01588000
         LA    @15,VVIC                                            0640 01589000
         ST    @15,@AL00001+4                                      0640 01590000
         LA    @15,RVVIPTR                                         0640 01591000
         ST    @15,@AL00001+8                                      0640 01592000
         LA    @15,REASON                                          0640 01593000
         ST    @15,@AL00001+12                                     0640 01594000
         MVI   @AL00001+12,X'80'                                   0640 01595000
         L     @15,GDTSSC(,@02)                                    0640 01596000
         LA    @01,@AL00001                                        0640 01597000
         BALR  @14,@15                                             0640 01598000
*   RESPECIFY                                                      0641 01599000
*     RTNREG RSTD;                                                 0641 01600000
*   TESTRC=RTNREG;                                                 0642 01601000
         LR    TESTRC,RTNREG                                       0642 01602000
*   RESPECIFY                                                      0643 01603000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 01604000
*                                                                  0644 01605000
*   /*****************************************************************/ 01606000
*   /*                                                               */ 01607000
*   /* TEST RETURN CODE FROM READ ATTEMPT. IF READ FAILED    @Y30LB31*/ 01608000
*   /* BECAUSE NO DUPLICATE FOUND, THIS IS A SPECIAL CASE TO VERIFY  */ 01609000
*   /* THAT ONLY ONE VOLUME EXISTS WITH THE GIVEN SERIAL NO. @Y30LB31*/ 01610000
*   /*                                                               */ 01611000
*   /*****************************************************************/ 01612000
*                                                                  0644 01613000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 01614000
         LTR   TESTRC,TESTRC                                       0644 01615000
         BZ    @RF00644                                            0644 01616000
*     IF RECTYPE=DUP&REASON=RCNOREC THEN/*                   @Y30LB31*/ 01617000
         CLC   RECTYPE(4),@CC01656                                 0645 01618000
         BNE   @RF00645                                            0645 01619000
         CLC   REASON(4),@CF01807                                  0645 01620000
         BNE   @RF00645                                            0645 01621000
*       RVRTNRC=LASTCC08;           /*                       @Y30LB31*/ 01622000
*                                                                  0646 01623000
         LA    RVRTNRC,8                                           0646 01624000
*   /*****************************************************************/ 01625000
*   /*                                                               */ 01626000
*   /* THE READ FAILED. PRINT A MESSAGE WITH THE MSIC        @Y30LB31*/ 01627000
*   /* REASON CODE. THEN PRINT AN ACCOMPANYING SECONDARY MSG TO      */ 01628000
*   /* IDENTIFY THE RECORD TYPE THAT COULD NOT BE RETRIEVED. MESSAGE */ 01629000
*   /* IDC3081I, IDC2080I, OR IDC2079I IS O/P.               @Y30LB31*/ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                                  0647 01633000
*     ELSE                          /*                       @Y30LB31*/ 01634000
*       DO;                         /*                       @Y30LB31*/ 01635000
         B     @RC00645                                            0647 01636000
@RF00645 DS    0H                                                  0648 01637000
*         RVRTNRC=4;                /*                       @Y30LB31*/ 01638000
         LA    RVRTNRC,4                                           0648 01639000
*         CALL SSCMSG(REASON);      /* PRINT MSVC MSG        @Y30LB31*/ 01640000
         LA    @15,REASON                                          0649 01641000
         ST    @15,@AL00001                                        0649 01642000
         LA    @01,@AL00001                                        0649 01643000
         BAL   @14,SSCMSG                                          0649 01644000
*         PRINTTBL=''B;             /*                       @Y30LB31*/ 01645000
         XC    PRINTTBL(28),PRINTTBL                               0650 01646000
*         DARGSMOD=COMMSGS;         /*                       @Y30LB31*/ 01647000
         L     @15,DDSTRU                                          0651 01648000
         MVC   DARGSMOD(3,@15),@CC01697                            0651 01649000
*         IF RECTYPE=COPY THEN      /*                       @Y30LB31*/ 01650000
         CLC   RECTYPE(4),@CC01664                                 0652 01651000
         BNE   @RF00652                                            0652 01652000
*           DO;                     /*                       @Y30LB31*/ 01653000
*             DARGSENT=MSG3081I;    /* STID = CM025          @Y30LB31*/ 01654000
         MVI   DARGSENT(@15),X'19'                                 0654 01655000
*             DARGDBP=ADDR(CDATEWKA);/*                      @Y30LB31*/ 01656000
         LA    @14,CDATEWKA                                        0655 01657000
         ST    @14,DARGDBP(,@15)                                   0655 01658000
*             DARGILP=LENGTH(CDATEWKA);/*                    @Y30LB31*/ 01659000
         LA    @14,4                                               0656 01660000
         STH   @14,DARGILP(,@15)                                   0656 01661000
*             DARGCNT=1;            /*                       @Y30LB31*/ 01662000
         LA    @03,1                                               0657 01663000
         STH   @03,DARGCNT(,@15)                                   0657 01664000
*             DARGINS(1)=1;         /*                       @Y30LB31*/ 01665000
         STH   @03,DARGINS(,@15)                                   0658 01666000
*             IF ADDR(SEQ#)^=NULLPTR THEN/*                  @Y30LB31*/ 01667000
         L     @03,@PC00001+4                                      0659 01668000
         L     @03,FDTPTR+12(,@03)                                 0659 01669000
         LTR   @03,@03                                             0659 01670000
         BZ    @RF00659                                            0659 01671000
*               DO;                 /*                       @Y30LB31*/ 01672000
*                 DARGDTM(1)=ADDR(SEQ#VAL);/*                @Y30LB31*/ 01673000
         ST    @03,DARGDTM(,@15)                                   0661 01674000
*                 DARGINL(1)=LENGTH(SEQ#VAL);/*              @Y30LB31*/ 01675000
         STH   @14,DARGINL(,@15)                                   0662 01676000
*               END;                /*                       @Y30LB31*/ 01677000
*             ELSE                  /*                       @Y30LB31*/ 01678000
*               DO;                 /*                       @Y30LB31*/ 01679000
         B     @RC00659                                            0664 01680000
@RF00659 DS    0H                                                  0665 01681000
*                 DARGDTM(1)=ADDR(SEQ#DFLT);/*               @Y30LB31*/ 01682000
         L     @15,DDSTRU                                          0665 01683000
         LA    @14,@CF00222                                        0665 01684000
         ST    @14,DARGDTM(,@15)                                   0665 01685000
*                 DARGINL(1)=LENGTH(SEQ#DFLT);/*             @Y30LB31*/ 01686000
         MVC   DARGINL(2,@15),@CH00043                             0666 01687000
*               END;                /*                       @Y30LB31*/ 01688000
*           END;                    /*                       @Y30LB31*/ 01689000
*         ELSE                      /*                       @Y30LB31*/ 01690000
*           IF RECTYPE=DUP THEN                                    0669 01691000
         B     @RC00652                                            0669 01692000
@RF00652 CLC   RECTYPE(4),@CC01656                                 0669 01693000
         BE    @RT00669                                            0669 01694000
*             ;                     /* NO MSG ISSUED         @Y30LB31*/ 01695000
*           ELSE                    /*                       @Y30LB31*/ 01696000
*             IF RECTYPE=GRP THEN   /*                       @Y30LB31*/ 01697000
         CLC   RECTYPE(4),@CC01658                                 0671 01698000
         BNE   @RF00671                                            0671 01699000
*               DO;                 /*                       @Y30LB31*/ 01700000
*                 DARGSENT=MSG2079I;/* STID = CM027          @Y30LB31*/ 01701000
         L     @15,DDSTRU                                          0673 01702000
         MVI   DARGSENT(@15),X'1B'                                 0673 01703000
*                 DARGDBP=ADDR(BASGROUP);/*                  @Y30LB31*/ 01704000
         LA    @14,BASGROUP(,BASEVPTR)                             0674 01705000
         ST    @14,DARGDBP(,@15)                                   0674 01706000
*                 DARGILP=LENGTH(BASGROUP);/*                @Y30LB31*/ 01707000
         MVC   DARGILP(2,@15),@CH00182                             0675 01708000
*               END;                /*                       @Y30LB31*/ 01709000
*             ELSE                  /*                       @Y30LB31*/ 01710000
*               DO;                 /*                       @Y30LB31*/ 01711000
         B     @RC00671                                            0677 01712000
@RF00671 DS    0H                                                  0678 01713000
*                 DARGSENT=MSG2080I;/* STID = CM026          @Y30LB31*/ 01714000
         L     @15,DDSTRU                                          0678 01715000
         MVI   DARGSENT(@15),X'1A'                                 0678 01716000
*                 DARGDBP=ADDR(VOLVAL);/*                    @Y30LB31*/ 01717000
         L     @14,@PC00001+4                                      0679 01718000
         L     @14,FDTPTR(,@14)                                    0679 01719000
         LA    @03,VOLVAL(,@14)                                    0679 01720000
         ST    @03,DARGDBP(,@15)                                   0679 01721000
*                 DARGILP=VOLLEN;   /*                       @Y30LB31*/ 01722000
         SLR   @03,@03                                             0680 01723000
         IC    @03,VOLLEN(,@14)                                    0680 01724000
         STH   @03,DARGILP(,@15)                                   0680 01725000
*               END;                /*                       @Y30LB31*/ 01726000
*                                                                  0681 01727000
*         /***********************************************************/ 01728000
*         /*                                                         */ 01729000
*         /* PRINT SECONDARY MSG, IF REQUIRED.               @Y30LB31*/ 01730000
*         /*                                                         */ 01731000
*         /***********************************************************/ 01732000
*                                                                  0682 01733000
*         IF DARGSENT^=NOENT# THEN  /*                       @Y30LB31*/ 01734000
@RC00671 DS    0H                                                  0682 01735000
@RT00669 DS    0H                                                  0682 01736000
@RC00652 L     @01,DDSTRU                                          0682 01737000
         CLI   DARGSENT(@01),0                                     0682 01738000
         BE    @RF00682                                            0682 01739000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 01740000
*                                                                  0683 01741000
         L     @15,@PC00001                                        0683 01742000
         ST    @15,@AL00001                                        0683 01743000
         LA    @14,@CF00117                                        0683 01744000
         ST    @14,@AL00001+4                                      0683 01745000
         LA    @14,DDSTRU                                          0683 01746000
         ST    @14,@AL00001+8                                      0683 01747000
         MVI   @AL00001+8,X'80'                                    0683 01748000
         L     @15,GDTPRT(,@15)                                    0683 01749000
         LA    @01,@AL00001                                        0683 01750000
         BALR  @14,@15                                             0683 01751000
*         /***********************************************************/ 01752000
*         /*                                                         */ 01753000
*         /* CLOSE DO GROUP THAT HANDLES READ FAILURE.       @Y30LB31*/ 01754000
*         /*                                                         */ 01755000
*         /***********************************************************/ 01756000
*                                                                  0684 01757000
*       END;                        /*                       @Y30LB31*/ 01758000
*                                                                  0684 01759000
@RF00682 DS    0H                                                  0685 01760000
*   /*****************************************************************/ 01761000
*   /*                                                               */ 01762000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF CALLER,     @Y30LB31*/ 01763000
*   /* VTYPERTN. EXIT FROM RVVIRTN PASSING CONDITION CODE IN REG 15. */ 01764000
*   /*                                                       @Y30LB31*/ 01765000
*   /*                                                               */ 01766000
*   /*****************************************************************/ 01767000
*                                                                  0685 01768000
*   RESPECIFY                                                      0685 01769000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 01770000
@RC00645 DS    0H                                                  0685 01771000
@RF00644 DS    0H                                                  0686 01772000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 01773000
         L     REG14,RETADDR3                                      0686 01774000
*   RESPECIFY                                                      0687 01775000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 01776000
*   RETURN CODE(RVRTNRC);           /*                       @Y30LB31*/ 01777000
         LR    @15,RVRTNRC                                         0688 01778000
@EL00004 DS    0H                                                  0688 01779000
@EF00004 DS    0H                                                  0688 01780000
@ER00004 BR    @14                                                 0688 01781000
*   END RVVIRTN;                    /*                       @Y30LB31*/ 01782000
*                                                                  0690 01783000
*/********************************************************** @Y30LB31*/ 01784000
*/*                                                          @Y30LB31*/ 01785000
*/* PROCEDURE NAME - VOLCKRTN                                @Y30LB31*/ 01786000
*/*                                                          @Y30LB31*/ 01787000
*/* FUNCTION - CHECKS THE VOLUME RECORD FOR CONFLICTS THAT   @Y30LB31*/ 01788000
*/*            PROHIBIT ACTIVATING THE VOLUME.  ISSUES       @Y30LB31*/ 01789000
*/*            MESSAGES IDC3720I, IDC3067I, IDC3097I,        @Y30LB31*/ 01790000
*/*            IDC3096I, IDC3095I, IDC3721I AND IDC2764I     @ZDR2054*/ 01791000
*/*            FOR THE PARTICULAR ERROR THAT EXISTS.         @ZDR2054*/ 01792000
*/*                                                          @Y30LB31*/ 01793000
*/* INPUT - FDTTBL, BCDV (COMMON RECORD FORMAT), COPYV,      @Y30LB31*/ 01794000
*/*         PRINTTBL, BASEV                                  @Y30LB31*/ 01795000
*/*                                                          @Y30LB31*/ 01796000
*/* OUTPUT - RET CODE OF 0 INDICATES SUCCESSFUL CHECKOUT.  @Y30LB31  */ 01797000
*/*          RETURN CODE OF 4 INDICATES A CONFLICT EXISTS.   @Y30LB31*/ 01798000
*/*          VOLUME CANNOT BE ACTIVATED.  APPROPRIATE MSGS   @Y30LB31*/ 01799000
*/*          WERE ISSUED.                                    @Y30LB31*/ 01800000
*/*                                                          @Y30LB31*/ 01801000
*/********************************************************** @Y30LB31*/ 01802000
*                                                                  0690 01803000
*VOLCKRTN:                                                         0690 01804000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 01805000
*                                                                  0690 01806000
VOLCKRTN DS    0H                                                  0691 01807000
*   /*****************************************************************/ 01808000
*   /*                                                               */ 01809000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 01810000
*   /*                                                               */ 01811000
*   /*****************************************************************/ 01812000
*                                                                  0691 01813000
*   DCL                                                            0691 01814000
*     VOLCKRC FIXED(15);            /*                       @Y30LB31*/ 01815000
*                                                                  0691 01816000
*   /*****************************************************************/ 01817000
*   /*                                                               */ 01818000
*   /* SAVE CALLERS RETURN ADDR SINCE THERE IS NO SAVE       @Y30LB31*/ 01819000
*   /* AREA. REG 14 WILL BE RESTORED UPON EXIT FROM THIS PROC.       */ 01820000
*   /*                                                       @Y30LB31*/ 01821000
*   /*                                                               */ 01822000
*   /*****************************************************************/ 01823000
*                                                                  0692 01824000
*   RESPECIFY                                                      0692 01825000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 01826000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 01827000
         ST    REG14,RETADDR3                                      0693 01828000
*   RESPECIFY                                                      0694 01829000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 01830000
*   OLDERID2=NEWERID2;                                             0695 01831000
         L     @15,@PC00001                                        0695 01832000
         L     @14,GDTTR2(,@15)                                    0695 01833000
         MVC   @TS00001(95),NEWERID2(@14)                          0695 01834000
         MVC   OLDERID2(95,@14),@TS00001                           0695 01835000
*   NEWID2='AVVO';                  /*                       @Y30LB31*/ 01836000
*                                                                  0696 01837000
         MVC   NEWID2(4,@14),@CC01824                              0696 01838000
*   /*****************************************************************/ 01839000
*   /*                                                               */ 01840000
*   /* INITIALIZE TO ZERO THE COND CODE SET BY THIS PROC.    @Y30LB31*/ 01841000
*   /*                                                               */ 01842000
*   /*****************************************************************/ 01843000
*                                                                  0697 01844000
*   VOLCKRC=LASTCC00;               /*                       @Y30LB31*/ 01845000
*                                                                  0697 01846000
         SLR   VOLCKRC,VOLCKRC                                     0697 01847000
*   /*****************************************************************/ 01848000
*   /*                                                               */ 01849000
*   /* ISSUE AN ERROR MESSAGE AND EXIT FROM THIS PROCEDURE   @Y30LB31*/ 01850000
*   /* IF THE VOLUME TO BE ACTIVATED                         @Y30LB31*/ 01851000
*   /* IS A BASE VOLUME THAT IS ALREADY ACTIVE. THE ACTIVE   @Y30LB31*/ 01852000
*   /* STATUS OF OTHER VOLUME TYPES IS NOT CHECKED SINCE IT IS       */ 01853000
*   /*                                                       @Y30LB31*/ 01854000
*   /* NOT MAINTAINED IN THE MSVI BECAUSE BY DEFINITION THESE VOL    */ 01855000
*   /*                                                       @Y30LB31*/ 01856000
*   /* TYPES ARE ALWAYS INACTIVE.                            @Y30LB31*/ 01857000
*   /*                                                               */ 01858000
*   /*****************************************************************/ 01859000
*                                                                  0698 01860000
*   IF BCDBASE=ON&BASINAC=OFF THEN  /*                       @Y30LB31*/ 01861000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0698 01862000
         BNO   @RF00698                                            0698 01863000
         TM    BASINAC(BASEVPTR),B'00000100'                       0698 01864000
         BNZ   @RF00698                                            0698 01865000
*     DO;                           /*                       @Y30LB31*/ 01866000
*       VOLCKRC=4;                  /*                       @Y30LB31*/ 01867000
         LA    VOLCKRC,4                                           0700 01868000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 01869000
         XC    PRINTTBL(28),PRINTTBL                               0701 01870000
*       DARGSMOD=ADDVMSGS;          /*                       @Y30LB31*/ 01871000
         L     @14,DDSTRU                                          0702 01872000
         MVC   DARGSMOD(3,@14),@CC01687                            0702 01873000
*       DARGSENT=MSG3721I;          /* STID=AV02             @Y30LB31*/ 01874000
         MVI   DARGSENT(@14),X'02'                                 0703 01875000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB31*/ 01876000
         L     @03,@PC00001+4                                      0704 01877000
         L     @03,FDTPTR(,@03)                                    0704 01878000
         LA    @02,VOLVAL(,@03)                                    0704 01879000
         ST    @02,DARGDBP(,@14)                                   0704 01880000
*       DARGILP=VOLLEN;             /*                       @Y30LB31*/ 01881000
         SLR   @02,@02                                             0705 01882000
         IC    @02,VOLLEN(,@03)                                    0705 01883000
         STH   @02,DARGILP(,@14)                                   0705 01884000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 01885000
         ST    @15,@AL00001                                        0706 01886000
         LA    @14,@CF00117                                        0706 01887000
         ST    @14,@AL00001+4                                      0706 01888000
         LA    @14,DDSTRU                                          0706 01889000
         ST    @14,@AL00001+8                                      0706 01890000
         MVI   @AL00001+8,X'80'                                    0706 01891000
         L     @15,GDTPRT(,@15)                                    0706 01892000
         LA    @01,@AL00001                                        0706 01893000
         BALR  @14,@15                                             0706 01894000
*     END;                          /*                       @Y30LB31*/ 01895000
*   ELSE                            /*                       @Y30LB31*/ 01896000
*     DO;                           /*                       @Y30LB31*/ 01897000
*                                                                  0708 01898000
         B     @RC00698                                            0708 01899000
@RF00698 DS    0H                                                  0709 01900000
*       /*************************************************************/ 01901000
*       /*                                                           */ 01902000
*       /* ISSUE AN ERROR MSG IF A COPY IS TO BE ACTIVATED THAT      */ 01903000
*       /*                                                   @Y30LB31*/ 01904000
*       /* IS OWNED BY VSAM, BUT DOES NOT REPLACE A BASE VOLUME,     */ 01905000
*       /*                                                   @ZDR2054*/ 01906000
*       /* THEN EXIT FROM THIS PROC.                         @ZDR2054*/ 01907000
*       /*                                                           */ 01908000
*       /*************************************************************/ 01909000
*                                                                  0709 01910000
*       IF BCDCOPY=ON&COPVSAM=ON&ADDR(RVOL)=NULLPTR THEN/*   @ZDR2054*/ 01911000
         TM    BCDCOPY(BCDVPTR),B'00010000'                        0709 01912000
         BNO   @RF00709                                            0709 01913000
         L     @01,COPYVPTR                                        0709 01914000
         TM    COPVSAM(@01),B'01000000'                            0709 01915000
         BNO   @RF00709                                            0709 01916000
         L     @15,@PC00001+4                                      0709 01917000
         L     @14,FDTPTR+36(,@15)                                 0709 01918000
         LTR   @14,@14                                             0709 01919000
         BNZ   @RF00709                                            0709 01920000
*         DO;                       /*                       @Y30LB31*/ 01921000
*           VOLCKRC=4;              /*                       @Y30LB31*/ 01922000
         LA    VOLCKRC,4                                           0711 01923000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 01924000
         XC    PRINTTBL(28),PRINTTBL                               0712 01925000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 01926000
         L     @14,DDSTRU                                          0713 01927000
         MVC   DARGSMOD(3,@14),@CC01697                            0713 01928000
*           DARGSENT=MSG3067I;      /* STID=CM041            @Y30LB31*/ 01929000
         MVI   DARGSENT(@14),X'29'                                 0714 01930000
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB31*/ 01931000
         L     @15,FDTPTR(,@15)                                    0715 01932000
         LA    @03,VOLVAL(,@15)                                    0715 01933000
         ST    @03,DARGDBP(,@14)                                   0715 01934000
*           DARGILP=VOLLEN;         /*                       @Y30LB31*/ 01935000
         SLR   @03,@03                                             0716 01936000
         IC    @03,VOLLEN(,@15)                                    0716 01937000
         STH   @03,DARGILP(,@14)                                   0716 01938000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 01939000
         L     @15,@PC00001                                        0717 01940000
         ST    @15,@AL00001                                        0717 01941000
         LA    @14,@CF00117                                        0717 01942000
         ST    @14,@AL00001+4                                      0717 01943000
         LA    @14,DDSTRU                                          0717 01944000
         ST    @14,@AL00001+8                                      0717 01945000
         MVI   @AL00001+8,X'80'                                    0717 01946000
         L     @15,GDTPRT(,@15)                                    0717 01947000
         LA    @01,@AL00001                                        0717 01948000
         BALR  @14,@15                                             0717 01949000
*         END;                      /*                       @Y30LB31*/ 01950000
*       ELSE                        /*                       @Y30LB31*/ 01951000
*         DO;                       /*                       @Y30LB31*/ 01952000
*                                                                  0719 01953000
         B     @RC00709                                            0719 01954000
@RF00709 DS    0H                                                  0720 01955000
*           /*********************************************************/ 01956000
*           /*                                                       */ 01957000
*           /* ISSUE AN ERROR MSG IF A DUPLICATE IS TO BE    @ZDR2054*/ 01958000
*           /* ACTIVATED BUT A NEW VOL SERIAL NO. WAS NOT SPECIFIED. */ 01959000
*           /*                                               @ZDR2054*/ 01960000
*           /* ISSUE AN ERROR MSG IF A COPY IS TO BE ACTIVATED,      */ 01961000
*           /*                                               @ZDR2054*/ 01962000
*           /* BUT NEITHER NEW SERIAL NUMBER OR REPLACE A BASE       */ 01963000
*           /*                                               @ZDR2054*/ 01964000
*           /* VOLUME WAS SPECIFIED.                         @ZDR2054*/ 01965000
*           /*                                                       */ 01966000
*           /*********************************************************/ 01967000
*                                                                  0720 01968000
*           IF(BCDDUP=ON&ADDR(NSER)=NULLPTR)|/*              @ZDR2054*/ 01969000
*               (BCDCOPY=ON&(ADDR(NSER)=NULLPTR&ADDR(RVOL)=NULLPTR))    01970000
*             THEN                                                 0720 01971000
         TM    BCDDUP(BCDVPTR),B'00000100'                         0720 01972000
         BNO   @GL00016                                            0720 01973000
         L     @15,@PC00001+4                                      0720 01974000
         L     @15,FDTPTR+20(,@15)                                 0720 01975000
         LTR   @15,@15                                             0720 01976000
         BZ    @RT00720                                            0720 01977000
@GL00016 TM    BCDCOPY(BCDVPTR),B'00010000'                        0720 01978000
         BNO   @RF00720                                            0720 01979000
         SLR   @15,@15                                             0720 01980000
         L     @14,@PC00001+4                                      0720 01981000
         C     @15,FDTPTR+20(,@14)                                 0720 01982000
         BNE   @RF00720                                            0720 01983000
         C     @15,FDTPTR+36(,@14)                                 0720 01984000
         BNE   @RF00720                                            0720 01985000
@RT00720 DS    0H                                                  0721 01986000
*             DO;                   /*                       @Y30LB31*/ 01987000
*               VOLCKRC=4;          /*                       @Y30LB31*/ 01988000
         LA    VOLCKRC,4                                           0722 01989000
*               PRINTTBL=''B;       /*                       @Y30LB31*/ 01990000
         XC    PRINTTBL(28),PRINTTBL                               0723 01991000
*               DARGSMOD=ADDVMSGS;  /*                       @Y30LB31*/ 01992000
         L     @15,DDSTRU                                          0724 01993000
         MVC   DARGSMOD(3,@15),@CC01687                            0724 01994000
*               DARGSENT=MSG3720I;  /* STID=AV01             @Y30LB31*/ 01995000
         MVI   DARGSENT(@15),X'01'                                 0725 01996000
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB31*/ 01997000
         L     @14,@PC00001+4                                      0726 01998000
         L     @14,FDTPTR(,@14)                                    0726 01999000
         LA    @03,VOLVAL(,@14)                                    0726 02000000
         ST    @03,DARGDBP(,@15)                                   0726 02001000
*               DARGILP=VOLLEN;     /*                       @Y30LB31*/ 02002000
         SLR   @03,@03                                             0727 02003000
         IC    @03,VOLLEN(,@14)                                    0727 02004000
         STH   @03,DARGILP(,@15)                                   0727 02005000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB31*/ 02006000
         L     @15,@PC00001                                        0728 02007000
         ST    @15,@AL00001                                        0728 02008000
         LA    @14,@CF00117                                        0728 02009000
         ST    @14,@AL00001+4                                      0728 02010000
         LA    @14,DDSTRU                                          0728 02011000
         ST    @14,@AL00001+8                                      0728 02012000
         MVI   @AL00001+8,X'80'                                    0728 02013000
         L     @15,GDTPRT(,@15)                                    0728 02014000
         LA    @01,@AL00001                                        0728 02015000
         BALR  @14,@15                                             0728 02016000
*             END;                  /*                       @Y30LB31*/ 02017000
*                                                                  0729 02018000
*           /*********************************************************/ 02019000
*           /*                                                       */ 02020000
*           /* CHECK FOR ACTIVATE OF A COPY VOLUME           @ZDR2054*/ 02021000
*           /* THAT REPLACES A BASE VOLUME.                  @ZDR2054*/ 02022000
*           /*                                                       */ 02023000
*           /*********************************************************/ 02024000
*                                                                  0730 02025000
*           IF ADDR(RVOL)^=NULLPTR THEN                            0730 02026000
@RF00720 SLR   @15,@15                                             0730 02027000
         L     @14,@PC00001+4                                      0730 02028000
         C     @15,FDTPTR+36(,@14)                                 0730 02029000
         BE    @RF00730                                            0730 02030000
*             DO;                   /*                       @ZDR2054*/ 02031000
*                                                                  0731 02032000
*               /*****************************************************/ 02033000
*               /*                                                   */ 02034000
*               /* CHECK FOR CARTRIDGES REASSIGNED.          @ZDR2054*/ 02035000
*               /*                                                   */ 02036000
*               /*****************************************************/ 02037000
*                                                                  0732 02038000
*               IF BASREASS=OFF THEN/*                       @ZA17143*/ 02039000
         TM    BASREASS(BASEVPTR),B'00100000'                      0732 02040000
         BNZ   @RF00732                                            0732 02041000
*                 DO;               /* NOT REASS             @ZDR2054*/ 02042000
*                                                                  0733 02043000
*                   /*************************************************/ 02044000
*                   /*                                               */ 02045000
*                   /* CHECK FOR CARTRIDGES NOT IN THE MSF.  @ZDR2054*/ 02046000
*                   /*                                               */ 02047000
*                   /*************************************************/ 02048000
*                                                                  0734 02049000
*                   IF BASLIB1=NULLIB&/*                     @ZA17143*/ 02050000
*                       BASLIB2=NULLIB THEN/*                @ZA17143*/ 02051000
         CLI   BASLIB1(BASEVPTR),255                               0734 02052000
         BNE   @RF00734                                            0734 02053000
         CLI   BASLIB2(BASEVPTR),255                               0734 02054000
         BNE   @RF00734                                            0734 02055000
*                     DO;           /*                       @ZDR2054*/ 02056000
*                                                                  0735 02057000
*                       /*********************************************/ 02058000
*                       /*                                           */ 02059000
*                       /* INITIALIZE THE DEFLIST FOR RENAME OF THE  */ 02060000
*                       /*                                   @ZDR2054*/ 02061000
*                       /* BASE VOLUME TO ITSELF.            @ZDR2054*/ 02062000
*                       /*                                           */ 02063000
*                       /*********************************************/ 02064000
*                                                                  0736 02065000
*                       AVDEFV=''B; /*                       @ZDR2054*/ 02066000
         XC    AVDEFV(132),AVDEFV                                  0736 02067000
*                       DEFVRNTR=ON;/*                       @ZDR2054*/ 02068000
         L     @14,DEFVPTR                                         0737 02069000
         OI    DEFVRNTR(@14),B'00000100'                           0737 02070000
*                       DEFVVFLG=NOCHANGE;/*                 @ZDR2054*/ 02071000
         MVI   DEFVVFLG(@14),X'FF'                                 0738 02072000
*                       DEFVOLD=BASSERNO;/*                  @ZA17143*/ 02073000
         MVC   DEFVOLD(6,@14),BASSERNO(BASEVPTR)                   0739 02074000
*                       DEFVNVOL=BASSERNO;/*                 @ZA17143*/ 02075000
         MVC   DEFVNVOL(6,@14),BASSERNO(BASEVPTR)                  0740 02076000
*                       DEFVCSN1=BASCSN1;/*                  @ZA17143*/ 02077000
*                                                                  0741 02078000
         MVC   DEFVCSN1(12,@14),BASCSN1(BASEVPTR)                  0741 02079000
*                       /*********************************************/ 02080000
*                       /*                                           */ 02081000
*                       /* INSURE CARTRIDGES NOT ENTERED WHILE       */ 02082000
*                       /*                                   @ZDR2054*/ 02083000
*                       /* MSVC WAS DISABLED.                @ZDR2054*/ 02084000
*                       /*                                           */ 02085000
*                       /*********************************************/ 02086000
*                                                                  0742 02087000
*                                                                  0742 02088000
*                       /*********************************************/ 02089000
*                       /*                                           */ 02090000
*                       /* DUMP OF INITIALIZED PARM LIST FOR MSVC    */ 02091000
*                       /* DEFINE MACRO                      @ZDR2054*/ 02092000
*                       /*                                           */ 02093000
*                       /*********************************************/ 02094000
*                                                                  0742 02095000
*                       IF GDTDBG=NULLPTR THEN                     0742 02096000
         L     @14,@PC00001                                        0742 02097000
         C     @15,GDTDBG(,@14)                                    0742 02098000
         BE    @RT00742                                            0742 02099000
*                         ;                                        0743 02100000
*                       ELSE                                       0744 02101000
*                         DO;                                      0744 02102000
*                           DMPINDEX=ADDR(AVDMPLST);/*       @ZDR2054*/ 02103000
         LA    DMPINDEX,AVDMPLST                                   0745 02104000
*                           DMPITMNM='AV01DEFV';                   0746 02105000
         MVC   DMPITMNM(8,DMPINDEX),@CC01826                       0746 02106000
*                           DMPITMPT=ADDR(AV01DEFV);               0747 02107000
         LA    @03,AV01DEFV                                        0747 02108000
         ST    @03,DMPITMPT(,DMPINDEX)                             0747 02109000
*                           DMPITMLN=LENGTH(AV01DEFV);             0748 02110000
         MVC   DMPITMLN(2,DMPINDEX),@CH02000                       0748 02111000
*                           DMPITMTP='H';                          0749 02112000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0749 02113000
*                           DMPINDEX=DMPINDEX+DMPELEMT;            0750 02114000
*                                                                  0750 02115000
         LA    @03,16                                              0750 02116000
         ALR   DMPINDEX,@03                                        0750 02117000
*                           /*****************************************/ 02118000
*                           /*                                       */ 02119000
*                           /*                               @ZDR2054*/ 02120000
*                           /*                                       */ 02121000
*                           /*****************************************/ 02122000
*                                                                  0751 02123000
*                           DMPITMNM='ADDVTBL';                    0751 02124000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0751 02125000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       0751 02126000
*                           DMPITMPT=ADDR(ADDVTBL);                0752 02127000
         LA    @15,ADDVTBL                                         0752 02128000
         ST    @15,DMPITMPT(,DMPINDEX)                             0752 02129000
*                           DMPITMLN=LENGTH(ADDVTBL);              0753 02130000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       0753 02131000
*                           DMPITMTP='H';                          0754 02132000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0754 02133000
*                           DMPINDEX=DMPINDEX+DMPELEMT;/*    @ZDR2054*/ 02134000
         ALR   DMPINDEX,@03                                        0755 02135000
*                           DMPTRM=DMPTRMVL;                       0756 02136000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0756 02137000
*                         END;      /*                       @ZDR2054*/ 02138000
*                       IF GDTDBG=NULLPTR THEN                     0758 02139000
@RT00742 L     @15,@PC00001                                        0758 02140000
         L     @15,GDTDBG(,@15)                                    0758 02141000
         LTR   @15,@15                                             0758 02142000
         BZ    @RT00758                                            0758 02143000
*                         ;                                        0759 02144000
*                       ELSE                                       0760 02145000
*                         CALL IDCDB010(GDTTBL,'AVRN',ADDR(AVDMPLST));  02146000
         L     @15,@PC00001                                        0760 02147000
         ST    @15,@AL00001                                        0760 02148000
         LA    @14,@CC01827                                        0760 02149000
         ST    @14,@AL00001+4                                      0760 02150000
         LA    @14,AVDMPLST                                        0760 02151000
         ST    @14,@AFTEMPS+4                                      0760 02152000
         LA    @14,@AFTEMPS+4                                      0760 02153000
         ST    @14,@AL00001+8                                      0760 02154000
         MVI   @AL00001+8,X'80'                                    0760 02155000
         L     @15,GDTDBG(,@15)                                    0760 02156000
         LA    @01,@AL00001                                        0760 02157000
         BALR  @14,@15                                             0760 02158000
*                                   /*                       @ZDR2054*/ 02159000
*                                                                  0761 02160000
*                       /*********************************************/ 02161000
*                       /*                                           */ 02162000
*                       /* ISSUE THE USSC MACRO TO INVOKE THE ICBDEFV*/ 02163000
*                       /* (DEFINE) MACRO TO PERFORM A RENAME OF THE */ 02164000
*                       /* VOLUME TO ITSELF TO TEST WHETHER THE      */ 02165000
*                       /* CARTRIDGES ARE IN THE LIBRARY.    @ZDR2054*/ 02166000
*                       /*                                           */ 02167000
*                       /*********************************************/ 02168000
*                                                                  0761 02169000
*                       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,     02170000
*                           ECBCODE);/*                      @ZDR2054*/ 02171000
@RT00758 L     @02,@PC00001                                        0761 02172000
         ST    @02,@AL00001                                        0761 02173000
         LA    @15,DEFINE                                          0761 02174000
         ST    @15,@AL00001+4                                      0761 02175000
         LA    @15,DEFVPTR                                         0761 02176000
         ST    @15,@AL00001+8                                      0761 02177000
         LA    @15,REASON                                          0761 02178000
         ST    @15,@AL00001+12                                     0761 02179000
         LA    @15,ECBCODE                                         0761 02180000
         ST    @15,@AL00001+16                                     0761 02181000
         MVI   @AL00001+16,X'80'                                   0761 02182000
         L     @15,GDTSSC(,@02)                                    0761 02183000
         LA    @01,@AL00001                                        0761 02184000
         BALR  @14,@15                                             0761 02185000
*                       RESPECIFY                                  0762 02186000
*                         RTNREG RSTD;                             0762 02187000
*                       TESTRC=RTNREG;                             0763 02188000
         LR    TESTRC,RTNREG                                       0763 02189000
*                       RESPECIFY                                  0764 02190000
*                         RTNREG UNRSTD;/*                   @ZDR2054*/ 02191000
*                                                                  0764 02192000
*                       /*********************************************/ 02193000
*                       /*                                           */ 02194000
*                       /* IF ANY CARTRIDGES WERE FOUND, THE MESSAGE:*/ 02195000
*                       /* CARTRIDGES STILL IN MASS STORAGE FACILITY */ 02196000
*                       /* IS WRITTEN AND THE RETURN CODE IS SET TO  */ 02197000
*                       /* 4.                                @ZDR2054*/ 02198000
*                       /*                                           */ 02199000
*                       /*********************************************/ 02200000
*                                                                  0765 02201000
*                       IF TESTRC=0|(TESTRC=4&REASON=NOCSN1)|/*    0765 02202000
*                                                            @ZDR2054*/ 02203000
*                           (TESTRC=4&REASON=NOCSN2) THEN/*  @ZDR2054*/ 02204000
         LTR   TESTRC,TESTRC                                       0765 02205000
         BZ    @RT00765                                            0765 02206000
         C     TESTRC,@CF00043                                     0765 02207000
         BNE   @GL00021                                            0765 02208000
         CLC   REASON(4),@CF01682                                  0765 02209000
         BE    @RT00765                                            0765 02210000
@GL00021 C     TESTRC,@CF00043                                     0765 02211000
         BNE   @RF00765                                            0765 02212000
         CLC   REASON(4),@CF01684                                  0765 02213000
         BNE   @RF00765                                            0765 02214000
@RT00765 DS    0H                                                  0766 02215000
*                         DO;       /*                       @ZDR2054*/ 02216000
*                           VOLCKRC=4;/*                     @ZDR2054*/ 02217000
         LA    VOLCKRC,4                                           0767 02218000
*                           PRINTTBL=''B;/*                  @ZDR2054*/ 02219000
         XC    PRINTTBL(28),PRINTTBL                               0768 02220000
*                           DARGSMOD=ADDVMSGS;/*             @ZDR2054*/ 02221000
         L     @15,DDSTRU                                          0769 02222000
         MVC   DARGSMOD(3,@15),@CC01687                            0769 02223000
*                           DARGSENT=MSG2764I;/* STID=AV08   @ZDR2054*/ 02224000
         MVI   DARGSENT(@15),X'08'                                 0770 02225000
*                           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*     02226000
*                                                            @ZDR2054*/ 02227000
         L     @15,@PC00001                                        0771 02228000
         ST    @15,@AL00001                                        0771 02229000
         LA    @14,@CF00117                                        0771 02230000
         ST    @14,@AL00001+4                                      0771 02231000
         LA    @14,DDSTRU                                          0771 02232000
         ST    @14,@AL00001+8                                      0771 02233000
         MVI   @AL00001+8,X'80'                                    0771 02234000
         L     @15,GDTPRT(,@15)                                    0771 02235000
         LA    @01,@AL00001                                        0771 02236000
         BALR  @14,@15                                             0771 02237000
*                         END;      /*                       @ZDR2054*/ 02238000
*                                                                  0772 02239000
*                       /*********************************************/ 02240000
*                       /*                                           */ 02241000
*                       /* IF DEFINE FAILED BECAUSE OF INSUFFICIENT  */ 02242000
*                       /* STORAGE, THE CONDITION CODE IS SET TO 4.  */ 02243000
*                       /*                                   @ZDR2054*/ 02244000
*                       /*                                           */ 02245000
*                       /*********************************************/ 02246000
*                                                                  0773 02247000
*                       ELSE        /*                       @ZDR2054*/ 02248000
*                         IF TESTRC=8 THEN/*                 @ZDR2054*/ 02249000
         B     @RC00765                                            0773 02250000
@RF00765 C     TESTRC,@CF00182                                     0773 02251000
         BNE   @RF00773                                            0773 02252000
*                           VOLCKRC=LASTCC04;/*              @ZDR2054*/ 02253000
*                                                                  0774 02254000
         LA    VOLCKRC,4                                           0774 02255000
*                       /*********************************************/ 02256000
*                       /*                                           */ 02257000
*                       /* CLOSE DO GROUP WHICH CHECKS CARTS NOT IN  */ 02258000
*                       /* MSF.                              @ZDR2054*/ 02259000
*                       /*                                           */ 02260000
*                       /*********************************************/ 02261000
*                                                                  0775 02262000
*                     END;          /*                       @ZDR2054*/ 02263000
*                                                                  0775 02264000
*                   /*************************************************/ 02265000
*                   /*                                               */ 02266000
*                   /* IF THE CARTRIDGES ARE IN THE MSF OR ARE       */ 02267000
*                   /*                                       @ZDR2054*/ 02268000
*                   /* NOT REASSIGNED ISSUE MESSAGE: UNABLE TO       */ 02269000
*                   /*                                       @ZDR2054*/ 02270000
*                   /* REPLACE THE BASE VOLUME. SET THE      @ZDR2054*/ 02271000
*                   /* RETURN CODE TO 4.                     @ZDR2054*/ 02272000
*                   /*                                               */ 02273000
*                   /*************************************************/ 02274000
*                                                                  0776 02275000
*                   ELSE                                           0776 02276000
*                     DO;           /*                       @ZDR2054*/ 02277000
         B     @RC00734                                            0776 02278000
@RF00734 DS    0H                                                  0777 02279000
*                       VOLCKRC=4;  /*                       @ZDR2054*/ 02280000
         LA    VOLCKRC,4                                           0777 02281000
*                       PRINTTBL=''B;/*                      @ZDR2054*/ 02282000
         XC    PRINTTBL(28),PRINTTBL                               0778 02283000
*                       DARGSMOD=ADDVMSGS;/*                 @ZDR2054*/ 02284000
         L     @15,DDSTRU                                          0779 02285000
         MVC   DARGSMOD(3,@15),@CC01687                            0779 02286000
*                       DARGSENT=MSG3726I;/* STID=AV07       @ZDR2054*/ 02287000
         MVI   DARGSENT(@15),X'07'                                 0780 02288000
*                       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    0781 02289000
*                                                            @ZDR2054*/ 02290000
         L     @15,@PC00001                                        0781 02291000
         ST    @15,@AL00001                                        0781 02292000
         LA    @14,@CF00117                                        0781 02293000
         ST    @14,@AL00001+4                                      0781 02294000
         LA    @14,DDSTRU                                          0781 02295000
         ST    @14,@AL00001+8                                      0781 02296000
         MVI   @AL00001+8,X'80'                                    0781 02297000
         L     @15,GDTPRT(,@15)                                    0781 02298000
         LA    @01,@AL00001                                        0781 02299000
         BALR  @14,@15                                             0781 02300000
*                     END;          /*                       @ZDR2054*/ 02301000
*                                                                  0782 02302000
*                   /*************************************************/ 02303000
*                   /*                                               */ 02304000
*                   /* CLOSE DO GROUP WHICH CHECKS FOR CARTS         */ 02305000
*                   /* REASSIGNED.                           @ZDR2054*/ 02306000
*                   /*                                               */ 02307000
*                   /*************************************************/ 02308000
*                                                                  0783 02309000
*                 END;              /*                       @ZDR2054*/ 02310000
*                                                                  0783 02311000
@RC00734 DS    0H                                                  0784 02312000
*               /*****************************************************/ 02313000
*               /*                                                   */ 02314000
*               /* CLOSE DO GROUP WHICH CHECKS FOR BASE      @ZDR2054*/ 02315000
*               /* VOLUME REPLACEMENT.                       @ZDR2054*/ 02316000
*               /*                                                   */ 02317000
*               /*****************************************************/ 02318000
*                                                                  0784 02319000
*             END;                  /*                       @ZDR2054*/ 02320000
*                                                                  0784 02321000
@RF00732 DS    0H                                                  0785 02322000
*           /*********************************************************/ 02323000
*           /*                                                       */ 02324000
*           /* ISSUE AN ERROR MSG IF THE VOLUME IS FLAGGED FOR       */ 02325000
*           /*                                               #Y30LB31*/ 02326000
*           /* RECOVERY REASONS AS UNUSABLE.                 #Y30LB31*/ 02327000
*           /*                                                       */ 02328000
*           /*********************************************************/ 02329000
*                                                                  0785 02330000
*           IF BCDSATIA^=ZEROES THEN/*                       @Y30LB31*/ 02331000
@RF00730 CLC   BCDSATIA(2,BCDVPTR),@CB01654                        0785 02332000
         BE    @RF00785                                            0785 02333000
*             DO;                   /*                       #Y30LB31*/ 02334000
*               PRINTTBL=''B;       /*                       #Y30LB31*/ 02335000
         XC    PRINTTBL(28),PRINTTBL                               0787 02336000
*               DARGSMOD=COMMSGS;   /*                       #Y30LB31*/ 02337000
         L     @15,DDSTRU                                          0788 02338000
         MVC   DARGSMOD(3,@15),@CC01697                            0788 02339000
*               DARGDBP=ADDR(VOLVAL);/*                      #Y30LB31*/ 02340000
         L     @14,@PC00001+4                                      0789 02341000
         L     @14,FDTPTR(,@14)                                    0789 02342000
         LA    @03,VOLVAL(,@14)                                    0789 02343000
         ST    @03,DARGDBP(,@15)                                   0789 02344000
*               DARGILP=VOLLEN;     /*                       #Y30LB31*/ 02345000
*                                                                  0790 02346000
         SLR   @03,@03                                             0790 02347000
         IC    @03,VOLLEN(,@14)                                    0790 02348000
         STH   @03,DARGILP(,@15)                                   0790 02349000
*               /*****************************************************/ 02350000
*               /*                                                   */ 02351000
*               /* ISSUE MSG IDC3097I IF THE VOLUME IS INCOMPLETELY  */ 02352000
*               /*                                           @Y30LB31*/ 02353000
*               /* CREATED.                                  @Y30LB31*/ 02354000
*               /*                                                   */ 02355000
*               /*****************************************************/ 02356000
*                                                                  0791 02357000
*               IF BCDIVCRE=ON THEN /*                       @Y30LB31*/ 02358000
         TM    BCDIVCRE(BCDVPTR),B'10000000'                       0791 02359000
         BNO   @RF00791                                            0791 02360000
*                 DO;               /*                       @Y30LB31*/ 02361000
*                   VOLCKRC=4;      /*                       @Y30LB31*/ 02362000
         LA    VOLCKRC,4                                           0793 02363000
*                   DARGSENT=MSG3097I;/* STID=CM03           @Y30LB31*/ 02364000
         MVI   DARGSENT(@15),X'03'                                 0794 02365000
*                 END;              /*                       @Y30LB31*/ 02366000
*                                                                  0795 02367000
*               /*****************************************************/ 02368000
*               /*                                                   */ 02369000
*               /* ISSUE MSG IDC3096I IF THE VOLUME IS AN    @Y30LB31*/ 02370000
*               /* INCOMPLETE COPY.                          @Y30LB31*/ 02371000
*               /*                                                   */ 02372000
*               /*****************************************************/ 02373000
*                                                                  0796 02374000
*               ELSE                /*                       @Y30LB31*/ 02375000
*                 IF BCDIVCPY=ON THEN/*                      @Y30LB31*/ 02376000
         B     @RC00791                                            0796 02377000
@RF00791 TM    BCDIVCPY(BCDVPTR),B'01000000'                       0796 02378000
         BNO   @RF00796                                            0796 02379000
*                   DO;             /*                       @Y30LB31*/ 02380000
*                     VOLCKRC=4;    /*                       @Y30LB31*/ 02381000
         LA    VOLCKRC,4                                           0798 02382000
*                     DARGSENT=MSG3096I;/* STID=CM06         @Y30LB31*/ 02383000
         L     @01,DDSTRU                                          0799 02384000
         MVI   DARGSENT(@01),X'06'                                 0799 02385000
*                   END;            /*                       @Y30LB31*/ 02386000
*                                                                  0800 02387000
*               /*****************************************************/ 02388000
*               /*                                                   */ 02389000
*               /* ISSUE MSG IDC3095I IF THE VOLUME HAS A SERIAL     */ 02390000
*               /*                                           @Y30LB31*/ 02391000
*               /* MISMATCH AND A NEW SERIAL WAS NOT SPECIFIED.      */ 02392000
*               /*                                           @Y30LB31*/ 02393000
*               /*                                                   */ 02394000
*               /*****************************************************/ 02395000
*                                                                  0801 02396000
*                 ELSE              /*                       @Y30LB31*/ 02397000
*                   IF BCDVSMIS=ON&ADDR(NSER)=NULLPTR THEN/* @Y30LB31*/ 02398000
         B     @RC00796                                            0801 02399000
@RF00796 TM    BCDVSMIS(BCDVPTR),B'00100000'                       0801 02400000
         BNO   @RF00801                                            0801 02401000
         L     @15,@PC00001+4                                      0801 02402000
         L     @15,FDTPTR+20(,@15)                                 0801 02403000
         LTR   @15,@15                                             0801 02404000
         BNZ   @RF00801                                            0801 02405000
*                     DO;           /*                       @Y30LB31*/ 02406000
*                       VOLCKRC=4;  /*                       @Y30LB31*/ 02407000
         LA    VOLCKRC,4                                           0803 02408000
*                       DARGSENT=MSG3095I;/* STID = CM09     @Y30LB31*/ 02409000
         L     @01,DDSTRU                                          0804 02410000
         MVI   DARGSENT(@01),X'09'                                 0804 02411000
*                     END;          /*                       @Y30LB31*/ 02412000
*                                                                  0805 02413000
*               /*****************************************************/ 02414000
*               /*                                                   */ 02415000
*               /* PRINT THE APPROPRIATE MESSAGE IF THE VOLUME IS    */ 02416000
*               /*                                           @Y30LB31*/ 02417000
*               /* FLAGGED FOR A CONDITION FROM WHICH ADDV CANNOT    */ 02418000
*               /* RECOVER.                                  @Y30LB31*/ 02419000
*               /*                                                   */ 02420000
*               /*****************************************************/ 02421000
*                                                                  0806 02422000
*               IF DARGSENT^=0 THEN /*                       @Y30LB31*/ 02423000
@RF00801 DS    0H                                                  0806 02424000
@RC00796 DS    0H                                                  0806 02425000
@RC00791 L     @01,DDSTRU                                          0806 02426000
         CLI   DARGSENT(@01),0                                     0806 02427000
         BE    @RF00806                                            0806 02428000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB31*/ 02429000
         L     @15,@PC00001                                        0807 02430000
         ST    @15,@AL00001                                        0807 02431000
         LA    @14,@CF00117                                        0807 02432000
         ST    @14,@AL00001+4                                      0807 02433000
         LA    @14,DDSTRU                                          0807 02434000
         ST    @14,@AL00001+8                                      0807 02435000
         MVI   @AL00001+8,X'80'                                    0807 02436000
         L     @15,GDTPRT(,@15)                                    0807 02437000
         LA    @01,@AL00001                                        0807 02438000
         BALR  @14,@15                                             0807 02439000
*             END;                  /*                       @Y30LB31*/ 02440000
@RF00806 DS    0H                                                  0809 02441000
*         END;                      /*                       @Y30LB31*/ 02442000
@RF00785 DS    0H                                                  0810 02443000
*     END;                          /*                       @Y30LB31*/ 02444000
*                                                                  0810 02445000
@RC00709 DS    0H                                                  0811 02446000
*   /*****************************************************************/ 02447000
*   /*                                                               */ 02448000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER  @Y30LB31*/ 02449000
*   /* AND EXIT FROM VOLCKRTN. PASS THE CONDITION CODE IN REG 15.    */ 02450000
*   /*                                                       @Y30LB31*/ 02451000
*   /*                                                               */ 02452000
*   /*****************************************************************/ 02453000
*                                                                  0811 02454000
*   RESPECIFY                                                      0811 02455000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 02456000
@RC00698 DS    0H                                                  0812 02457000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 02458000
         L     REG14,RETADDR3                                      0812 02459000
*   RESPECIFY                                                      0813 02460000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 02461000
*   RETURN CODE(VOLCKRC);           /*                       @Y30LB31*/ 02462000
         LR    @15,VOLCKRC                                         0814 02463000
@EL00005 DS    0H                                                  0814 02464000
@EF00005 DS    0H                                                  0814 02465000
@ER00005 BR    @14                                                 0814 02466000
*   END VOLCKRTN;                   /*                       @Y30LB31*/ 02467000
*                                                                  0816 02468000
*/********************************************************** @Y30LB31*/ 02469000
*/*                                                          @Y30LB31*/ 02470000
*/* PROCEDURE NAME - RWCKRTN                                 @Y30LB31*/ 02471000
*/*                                                          @Y30LB31*/ 02472000
*/* FUNCTION - CHECKS THE CURRENT VOLUME MOUNTING ATTR       @Y30LB31*/ 02473000
*/*            BUTES TO INSURE THERE IS NO READ ONLY         @Y30LB31*/ 02474000
*/*            CONFLICT WHICH PREVENTS THE VOLUME SERIAL     @Y30LB31*/ 02475000
*/*            NO. FROM BEING CHANGED.  CALLS RENAMRTN TO    @Y30LB31*/ 02476000
*/*            OBTAIN THE VOLUME ATTRIBUTES.  ISSUES MSG    @Y30LB31 */ 02477000
*/*            IDC3090I.                                     @Y30LB31*/ 02478000
*/*                                                          @Y30LB31*/ 02479000
*/* INPUT - FDTTBL, PRINTTBL FOR MESSAGES, CMMSG FOR MSSC    @Y30LB31*/ 02480000
*/*         MESSAGE WHICH CONTAINS VOLUME ATTRIBUTES,        @Y30LB31*/ 02481000
*/*         BASEV AND BCDV FOR VOLUME RECORD,             @Y30LB31   */ 02482000
*/*         GROUP RECORD.                                    @Y30LB31*/ 02483000
*/*                                                          @Y30LB31*/ 02484000
*/* OUTPUT- RETURN CODE OF 0 INDICATES ATTRIBUTE CHECKOUT    @Y30LB31*/ 02485000
*/*         SUCCESSFUL AND ATTRIBUTES RECORDED IN ADDVTBL.   @Y30LB31*/ 02486000
*/*         RETURN CODE OF 4 INDICATES -                     @Y30LB31*/ 02487000
*/*         (1) VOLUME ATTRIBUTES COULD NOT BE OBTAINED      @Y30LB31*/ 02488000
*/*         (2) READ WRITE REQUIRED BUT NOT SPECIFIED,       @Y30LB31*/ 02489000
*/*         (3) READ WRITE SPECIFIED BUT GROUP IS READ ONLY  @Y30LB31*/ 02490000
*/*                                                          @Y30LB31*/ 02491000
*/********************************************************** @Y30LB31*/ 02492000
*                                                                  0816 02493000
*RWCKRTN:                                                          0816 02494000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 02495000
*                                                                  0816 02496000
RWCKRTN  DS    0H                                                  0817 02497000
*   /*****************************************************************/ 02498000
*   /*                                                               */ 02499000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 02500000
*   /*                                                               */ 02501000
*   /*****************************************************************/ 02502000
*                                                                  0817 02503000
*   DCL                                                            0817 02504000
*     RWCKRC FIXED(15);             /*                       @Y30LB31*/ 02505000
*                                                                  0817 02506000
*   /*****************************************************************/ 02507000
*   /*                                                               */ 02508000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 02509000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 02510000
*   /*                                                               */ 02511000
*   /*****************************************************************/ 02512000
*                                                                  0818 02513000
*   RESPECIFY                                                      0818 02514000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 02515000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 02516000
         ST    REG14,RETADDR2                                      0819 02517000
*   RESPECIFY                                                      0820 02518000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 02519000
*   OLDERID2=NEWERID2;                                             0821 02520000
         L     @05,@PC00001                                        0821 02521000
         L     @05,GDTTR2(,@05)                                    0821 02522000
         MVC   @TS00001(95),NEWERID2(@05)                          0821 02523000
         MVC   OLDERID2(95,@05),@TS00001                           0821 02524000
*   NEWID2='AVRW';                  /*                       @Y30LB31*/ 02525000
*                                                                  0822 02526000
         MVC   NEWID2(4,@05),@CC01832                              0822 02527000
*   /*****************************************************************/ 02528000
*   /*                                                               */ 02529000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN     @Y30LB31*/ 02530000
*   /* THIS PROCEDURE.                                       @Y30LB31*/ 02531000
*   /*                                                               */ 02532000
*   /*****************************************************************/ 02533000
*                                                                  0823 02534000
*   RWCKRC=LASTCC00;                /*                       @Y30LB31*/ 02535000
*                                                                  0823 02536000
         SLR   RWCKRC,RWCKRC                                       0823 02537000
*   /*****************************************************************/ 02538000
*   /*                                                               */ 02539000
*   /* OBTAIN THE CURRENT VOLUME MOUNTING ATTRIBUTES FROM    @Y30LB31*/ 02540000
*   /* THE MSSC MSG THAT IS RETURNED FROM THE FOLLOWING      @Y30LB31*/ 02541000
*   /* RENAME REQUEST ISSUED BY RENAMRTN.                    @Y30LB31*/ 02542000
*   /*                                                               */ 02543000
*   /*****************************************************************/ 02544000
*                                                                  0824 02545000
*   MSGFLG=ON;                      /*                       @Y30LB31*/ 02546000
         OI    MSGFLG,B'00010000'                                  0824 02547000
*   RENAMTYP=DUMMY;                 /* IDENTIFY RENAME TYPE  @Y30LB31*/ 02548000
         MVC   RENAMTYP(8),@CC01672                                0825 02549000
*   CALL RENAMRTN;                  /*                       @Y30LB31*/ 02550000
         BAL   @14,RENAMRTN                                        0826 02551000
*   RESPECIFY                                                      0827 02552000
*     RTNREG RSTD;                                                 0827 02553000
*   TESTRC=RTNREG;                                                 0828 02554000
         LR    TESTRC,RTNREG                                       0828 02555000
*   RESPECIFY                                                      0829 02556000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 02557000
*                                                                  0829 02558000
*   /*****************************************************************/ 02559000
*   /*                                                               */ 02560000
*   /* TEST RETURN CODE FROM RENAMRTN. IF THE MSSC RENAME    @Y30LB31*/ 02561000
*   /* ORDER FAILED, THE ATTRIBUTES WERE NOT RETURNED. UPDATE THE    */ 02562000
*   /* CONDITION CODE. EXIT FROM THIS PROCEDURE.             @Y30LB31*/ 02563000
*   /*                                                               */ 02564000
*   /*****************************************************************/ 02565000
*                                                                  0830 02566000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 02567000
         LTR   TESTRC,TESTRC                                       0830 02568000
         BZ    @RF00830                                            0830 02569000
*     RWCKRC=4;                     /*                       @Y30LB31*/ 02570000
*                                                                  0831 02571000
         LA    RWCKRC,4                                            0831 02572000
*   /*****************************************************************/ 02573000
*   /*                                                               */ 02574000
*   /* THE VOLUMES ATTRIBUTES WERE SUCCESSFULLY OBTAINED.    @Y30LB31*/ 02575000
*   /* CHECK FOR A READONLY - READWRITE CONFLICT. AN ERROR EXISTS IF */ 02576000
*   /* (1) READWRITE WAS SPECIFIED FOR A READONLY GENERAL USE VOLUME */ 02577000
*   /* AND THE GROUP IS ALSO READONLY OR (2) READWRITE WAS NOT       */ 02578000
*   /* SPECIFIED FOR A VOLUME THAT IS READONLY AND IS A COPY OR      */ 02579000
*   /* DUPLICATE OR BASE THAT IS NOT A GENERAL USE VOLUME. MESSAGE   */ 02580000
*   /* IDC3090I IS PRINTED FOR THIS ERROR.                   @Y30LB31*/ 02581000
*   /*                                                               */ 02582000
*   /*****************************************************************/ 02583000
*                                                                  0832 02584000
*   ELSE                            /*                       @Y30LB31*/ 02585000
*     DO;                           /*                       @Y30LB31*/ 02586000
         B     @RC00830                                            0832 02587000
@RF00830 DS    0H                                                  0833 02588000
*       CMMSGPTR=ECBMSPTR+ECBLEN;   /*                       @Y30LB31*/ 02589000
         LA    CMMSGPTR,4                                          0833 02590000
         AL    CMMSGPTR,ECBMSPTR                                   0833 02591000
*       IF CMRONLY=ON THEN          /*                       @Y30LB31*/ 02592000
         TM    CMRONLY(CMMSGPTR),B'00000010'                       0834 02593000
         BNO   @RF00834                                            0834 02594000
*         IF(BCDBASE=ON&BASGENUS=ON&GRORONLY=ON)|/*          @Y30LB31*/ 02595000
*             ADDR(RWOPT)=NULLPTR&  /*                       @Y30LB31*/ 02596000
*             (BCDCOPY=ON|BCDDUP=ON|(BCDBASE=ON&/*           @Y30LB31*/ 02597000
*             BASGENUS=OFF)) THEN   /*                       @Y30LB31*/ 02598000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0835 02599000
         BNO   @GL00026                                            0835 02600000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0835 02601000
         BNO   @GL00026                                            0835 02602000
         L     @05,GROUPPTR                                        0835 02603000
         TM    GRORONLY(@05),B'00010000'                           0835 02604000
         BO    @RT00835                                            0835 02605000
@GL00026 L     @05,@PC00001+4                                      0835 02606000
         L     @05,FDTPTR+24(,@05)                                 0835 02607000
         LTR   @05,@05                                             0835 02608000
         BNZ   @RF00835                                            0835 02609000
         TM    BCDCOPY(BCDVPTR),B'00010100'                        0835 02610000
         BNZ   @RT00835                                            0835 02611000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0835 02612000
         BNO   @RF00835                                            0835 02613000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0835 02614000
         BNZ   @RF00835                                            0835 02615000
@RT00835 DS    0H                                                  0836 02616000
*           DO;                     /*                       @Y30LB31*/ 02617000
*             RWCKRC=4;             /*                       @Y30LB31*/ 02618000
         LA    RWCKRC,4                                            0837 02619000
*             PRINTTBL=''B;         /*                       @Y30LB31*/ 02620000
         XC    PRINTTBL(28),PRINTTBL                               0838 02621000
*             DARGSMOD=COMMSGS;     /*                       @Y30LB31*/ 02622000
         L     @05,DDSTRU                                          0839 02623000
         MVC   DARGSMOD(3,@05),@CC01697                            0839 02624000
*             DARGSENT=MSG3090I;    /* STID=CM016            @Y30LB31*/ 02625000
         MVI   DARGSENT(@05),X'10'                                 0840 02626000
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB31*/ 02627000
         L     @03,@PC00001+4                                      0841 02628000
         L     @03,FDTPTR(,@03)                                    0841 02629000
         LA    @15,VOLVAL(,@03)                                    0841 02630000
         ST    @15,DARGDBP(,@05)                                   0841 02631000
*             DARGILP=VOLLEN;       /*                       @Y30LB31*/ 02632000
         SLR   @15,@15                                             0842 02633000
         IC    @15,VOLLEN(,@03)                                    0842 02634000
         STH   @15,DARGILP(,@05)                                   0842 02635000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB31*/ 02636000
         L     @05,@PC00001                                        0843 02637000
         ST    @05,@AL00001                                        0843 02638000
         LA    @03,@CF00117                                        0843 02639000
         ST    @03,@AL00001+4                                      0843 02640000
         LA    @03,DDSTRU                                          0843 02641000
         ST    @03,@AL00001+8                                      0843 02642000
         MVI   @AL00001+8,X'80'                                    0843 02643000
         L     @15,GDTPRT(,@05)                                    0843 02644000
         LA    @01,@AL00001                                        0843 02645000
         BALR  @14,@15                                             0843 02646000
*           END;                    /*                       @Y30LB31*/ 02647000
*                                                                  0844 02648000
*       /*************************************************************/ 02649000
*       /*                                                           */ 02650000
*       /* SAVE THE CURRENT VOL ATTRIBUTES RETURNED IN THE MSSC      */ 02651000
*       /*                                                   @Y30LB31*/ 02652000
*       /* RENAME MESSAGE UNLESS A READONLY-READWRITE CONFLICT       */ 02653000
*       /* EXISTS. NOTE THAT IDCAV01 HAS SET THE DEFAULT ATTRIBUTE   */ 02654000
*       /* VALUES.                                           @Y30LB31*/ 02655000
*       /*                                                           */ 02656000
*       /*************************************************************/ 02657000
*                                                                  0845 02658000
*       IF RWCKRC=0 THEN            /*                       @Y30LB31*/ 02659000
@RF00835 DS    0H                                                  0845 02660000
@RF00834 LTR   RWCKRC,RWCKRC                                       0845 02661000
         BNZ   @RF00845                                            0845 02662000
*         DO;                       /*                       @Y30LB31*/ 02663000
*           IF CMDERAS=ON THEN      /*                       @Y30LB31*/ 02664000
         TM    CMDERAS(CMMSGPTR),B'00100000'                       0847 02665000
         BNO   @RF00847                                            0847 02666000
*             OLDDEFLG=ON;          /* DERAS=ON, NDERAS=OFF  @Y30LB31*/ 02667000
         OI    OLDDEFLG,B'01000000'                                0848 02668000
*           IF CMEXCL=ON THEN       /*                       @Y30LB31*/ 02669000
@RF00847 TM    CMEXCL(CMMSGPTR),B'00010000'                        0849 02670000
         BNO   @RF00849                                            0849 02671000
*             OLDEXFLG=ON;          /* EXCL=ON, SHARED=OFF   @Y30LB31*/ 02672000
         OI    OLDEXFLG,B'00100000'                                0850 02673000
*           IF CMBIND=ON THEN       /*                       @Y30LB31*/ 02674000
@RF00849 TM    CMBIND(CMMSGPTR),B'00000100'                        0851 02675000
         BNO   @RF00851                                            0851 02676000
*             OLDBIFLG=ON;          /* BIND=ON, NOBIND=OFF   @Y30LB31*/ 02677000
         OI    OLDBIFLG,B'10000000'                                0852 02678000
*           IF CMRONLY=ON THEN      /*                       @Y30LB31*/ 02679000
@RF00851 TM    CMRONLY(CMMSGPTR),B'00000010'                       0853 02680000
         BNO   @RF00853                                            0853 02681000
*             OLDROFLG=ON;          /* RONLY=ON, RW=OFF      @Y30LB31*/ 02682000
         OI    OLDROFLG,B'00010000'                                0854 02683000
*         END;                      /*                       @Y30LB31*/ 02684000
*                                                                  0855 02685000
@RF00853 DS    0H                                                  0856 02686000
*       /*************************************************************/ 02687000
*       /*                                                           */ 02688000
*       /* FREE THE MESSAGE STORAGE AREA.                    @Y30LB31*/ 02689000
*       /*                                                           */ 02690000
*       /*************************************************************/ 02691000
*                                                                  0856 02692000
*       CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*                    @Y30LB31*/ 02693000
@RF00845 L     @05,@PC00001                                        0856 02694000
         ST    @05,@AL00001                                        0856 02695000
         LA    @15,ECBMSPTR                                        0856 02696000
         ST    @15,@AL00001+4                                      0856 02697000
         L     @15,GDTFSP(,@05)                                    0856 02698000
         LA    @01,@AL00001                                        0856 02699000
         BALR  @14,@15                                             0856 02700000
*     END;                          /*                       @Y30LB31*/ 02701000
*                                                                  0857 02702000
*   /*****************************************************************/ 02703000
*   /*                                                               */ 02704000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF CALLER.     @Y30LB31*/ 02705000
*   /* EXIT FROM RWCKRTN. PASS CONDITION CODE IN REG 15.     @Y30LB31*/ 02706000
*   /*                                                               */ 02707000
*   /*****************************************************************/ 02708000
*                                                                  0858 02709000
*   RESPECIFY                                                      0858 02710000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 02711000
@RC00830 DS    0H                                                  0859 02712000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 02713000
         L     REG14,RETADDR2                                      0859 02714000
*   RESPECIFY                                                      0860 02715000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 02716000
*   RETURN CODE(RWCKRC);            /*                       @Y30LB31*/ 02717000
         LR    @15,RWCKRC                                          0861 02718000
@EL00006 DS    0H                                                  0861 02719000
@EF00006 DS    0H                                                  0861 02720000
@ER00006 BR    @14                                                 0861 02721000
*   END RWCKRTN;                    /*                       @Y30LB31*/ 02722000
*                                                                  0863 02723000
*/********************************************************** @Y30LB31*/ 02724000
*/*                                                          @Y30LB31*/ 02725000
*/*PROCEDURE NAME - RENAMRTN                                 @Y30LB31*/ 02726000
*/*                                                          @Y30LB31*/ 02727000
*/* FUNCTION - CHANGES THE VOLUME SERIAL NO. IN THE CART     @Y30LB31*/ 02728000
*/*            LABELS AND IN THE INVENTORY.  CALLS SSCMSG    @Y30LB31*/ 02729000
*/*            TO PRINT A MESSAGE WITH MSSC REASON CODE IF   @Y30LB31*/ 02730000
*/*            THE MSC RENAME ORDER FAILED.  NO OTHER MSGS   @Y30LB31*/ 02731000
*/*            ARE ISSUED.                                   @Y30LB31*/ 02732000
*/*                                                          @Y30LB31*/ 02733000
*/* INPUT - FDTTBL, ADDVTBL, DEFLIST, DEFVE, BCDV, CMMSG     @Y30LB31*/ 02734000
*/*                                                          @Y30LB31*/ 02735000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL RENAME    @Y30LB31*/ 02736000
*/*          AND ADDVTBL UPDATED.                            @Y30LB31*/ 02737000
*/*          RETURN CODE OF 4 INDICATES RENAME FAILED.       @Y30LB31*/ 02738000
*/*                                                          @Y30LB31*/ 02739000
*/********************************************************** @Y30LB31*/ 02740000
*                                                                  0863 02741000
*RENAMRTN:                                                         0863 02742000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 02743000
*                                                                  0863 02744000
RENAMRTN DS    0H                                                  0864 02745000
*   /*****************************************************************/ 02746000
*   /*                                                               */ 02747000
*   /* LOCAL DECLARATIONS.                                   @Y30LB31*/ 02748000
*   /*                                                               */ 02749000
*   /*****************************************************************/ 02750000
*                                                                  0864 02751000
*   DCL                                                            0864 02752000
*     RENAMRC FIXED(15);            /* LOCAL CONDITION CODE  @Y30LB31*/ 02753000
*   DCL                                                            0865 02754000
*     NOCHANGE BIT(8) CONSTANT('FF'X);/*                     @Y30LB31*/ 02755000
*                                                                  0865 02756000
*   /*****************************************************************/ 02757000
*   /*                                                               */ 02758000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 02759000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 02760000
*   /*                                                               */ 02761000
*   /*****************************************************************/ 02762000
*                                                                  0866 02763000
*   RESPECIFY                                                      0866 02764000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 02765000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 02766000
         ST    REG14,RETADDR3                                      0867 02767000
*   RESPECIFY                                                      0868 02768000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 02769000
*   OLDERID2=NEWERID2;                                             0869 02770000
         L     @15,@PC00001                                        0869 02771000
         L     @15,GDTTR2(,@15)                                    0869 02772000
         MVC   @TS00001(95),NEWERID2(@15)                          0869 02773000
         MVC   OLDERID2(95,@15),@TS00001                           0869 02774000
*   NEWID2='AVNM';                  /*                       @Y30LB31*/ 02775000
*                                                                  0870 02776000
         MVC   NEWID2(4,@15),@CC01838                              0870 02777000
*   /*****************************************************************/ 02778000
*   /*                                                               */ 02779000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN     @Y30LB31*/ 02780000
*   /* THIS PROCEDURE. ZERO THE PARM LISTS BEFORE INITIALIZING.      */ 02781000
*   /*                                                       @Y30LB31*/ 02782000
*   /*                                                               */ 02783000
*   /*****************************************************************/ 02784000
*                                                                  0871 02785000
*   RENAMRC=LASTCC00;               /*                       @Y30LB31*/ 02786000
         SLR   RENAMRC,RENAMRC                                     0871 02787000
*   DEFLIST=''B;                    /*                       @Y30LB31*/ 02788000
         L     @01,DEFVPTR                                         0872 02789000
         XC    DEFLIST(132,@01),DEFLIST(@01)                       0872 02790000
*   DEFVE=''B;                      /*                       @Y30LB31*/ 02791000
*                                                                  0873 02792000
         L     @01,DEFVEPTR                                        0873 02793000
         XC    DEFVE(64,@01),DEFVE(@01)                            0873 02794000
*   /*****************************************************************/ 02795000
*   /*                                                               */ 02796000
*   /* IF AN ACTIVE OR INACTIVE RENAME REQUEST IS SPECIFIED  @Y30LB31*/ 02797000
*   /* N ADDVTBL, INITIALIZE THE PARM LISTS AS FOLLOWS.      @Y30LB31*/ 02798000
*   /*                                                               */ 02799000
*   /*****************************************************************/ 02800000
*                                                                  0874 02801000
*   IF RENAMTYP=ACTIVE|RENAMTYP=INACTIVE THEN/*              @Y30LB31*/ 02802000
         CLC   RENAMTYP(8),@CC01666                                0874 02803000
         BE    @RT00874                                            0874 02804000
         CLC   RENAMTYP(8),@CC01668                                0874 02805000
         BNE   @RF00874                                            0874 02806000
@RT00874 DS    0H                                                  0875 02807000
*     DO;                           /*                       @Y30LB31*/ 02808000
*       IF RENAMTYP=ACTIVE THEN     /*                       @Y30LB31*/ 02809000
         CLC   RENAMTYP(8),@CC01666                                0876 02810000
         BNE   @RF00876                                            0876 02811000
*         DEFVRNM=ON;               /*                       @Y30LB31*/ 02812000
         L     @01,DEFVPTR                                         0877 02813000
         OI    DEFVRNM(@01),B'00100000'                            0877 02814000
*       ELSE                        /*                       @Y30LB31*/ 02815000
*         DO;                       /*                       @Y30LB31*/ 02816000
         B     @RC00876                                            0878 02817000
@RF00876 DS    0H                                                  0879 02818000
*           DEFVRNTR=ON;            /*                       @Y30LB31*/ 02819000
         L     @15,DEFVPTR                                         0879 02820000
         OI    DEFVRNTR(@15),B'00000100'                           0879 02821000
*           DEFVCSN1=BCDCSN1;       /*                       @Y30LB31*/ 02822000
         MVC   DEFVCSN1(12,@15),BCDCSN1(BCDVPTR)                   0880 02823000
*         END;                      /*                       @Y30LB31*/ 02824000
*       DEFVOLD=VOLVAL;             /*                       @Y30LB31*/ 02825000
@RC00876 L     @15,DEFVPTR                                         0882 02826000
         L     @14,@PC00001+4                                      0882 02827000
         L     @01,FDTPTR(,@14)                                    0882 02828000
         MVC   DEFVOLD(6,@15),VOLVAL(@01)                          0882 02829000
*       DEFVNVOL=NSERVAL;           /*                       @Y30LB31*/ 02830000
*                                                                  0883 02831000
         L     @01,FDTPTR+20(,@14)                                 0883 02832000
         MVC   DEFVNVOL(6,@15),NSERVAL(@01)                        0883 02833000
*       /*************************************************************/ 02834000
*       /*                                                           */ 02835000
*       /* UPDATE THE VOLUME ATTRIBUTES IN CONJUNCTION WITH  @Y30LB31*/ 02836000
*       /* THE RENAME REQUEST.                               @Y30LB31*/ 02837000
*       /*                                                           */ 02838000
*       /*************************************************************/ 02839000
*                                                                  0884 02840000
*       IF NEWVFFLG=ON&ONLYROSW=OFF THEN/*                   @Y30LB31*/ 02841000
         TM    NEWVFFLG,B'00001000'                                0884 02842000
         BNO   @RF00884                                            0884 02843000
         TM    ONLYROSW,B'10000000'                                0884 02844000
         BNZ   @RF00884                                            0884 02845000
*         DO;                       /*                       @Y30LB31*/ 02846000
*           IF NEWDEFLG=ON THEN     /*                       @Y30LB31*/ 02847000
         TM    NEWDEFLG,B'00000100'                                0886 02848000
         BNO   @RF00886                                            0886 02849000
*             DEFVSEC=ON;           /*                       @Y30LB31*/ 02850000
         OI    DEFVSEC(@15),B'00100000'                            0887 02851000
*           IF NEWEXFLG=ON THEN     /*                       @Y30LB31*/ 02852000
@RF00886 TM    NEWEXFLG,B'00000010'                                0888 02853000
         BNO   @RF00888                                            0888 02854000
*             DEFVEXCL=ON;          /*                       @Y30LB31*/ 02855000
         L     @01,DEFVPTR                                         0889 02856000
         OI    DEFVEXCL(@01),B'00010000'                           0889 02857000
*           IF NEWBIFLG=ON THEN     /*                       @Y30LB31*/ 02858000
@RF00888 TM    NEWBIFLG,B'00001000'                                0890 02859000
         BNO   @RF00890                                            0890 02860000
*             DEFVBIND=ON;          /*                       @Y30LB31*/ 02861000
*                                                                  0891 02862000
         L     @01,DEFVPTR                                         0891 02863000
         OI    DEFVBIND(@01),B'00000100'                           0891 02864000
*           /*********************************************************/ 02865000
*           /*                                                       */ 02866000
*           /* DO NOT SET READONLY IF VOLUME SERIAL NO. IS   @Y30LB31*/ 02867000
*           /* TO BE CHANGED UNTIL THE VOLUME LABEL IS UPDATED.      */ 02868000
*           /*                                               @Y30LB31*/ 02869000
*           /*                                                       */ 02870000
*           /*********************************************************/ 02871000
*                                                                  0892 02872000
*           IF NEWROFLG=ON THEN     /*                       @Y30LB31*/ 02873000
@RF00890 TM    NEWROFLG,B'00000001'                                0892 02874000
         BNO   @RF00892                                            0892 02875000
*             IF ADDR(NSER)=NULLPTR THEN/*                   @Y30LB31*/ 02876000
         L     @15,@PC00001+4                                      0893 02877000
         L     @15,FDTPTR+20(,@15)                                 0893 02878000
         LTR   @15,@15                                             0893 02879000
         BNZ   @RF00893                                            0893 02880000
*               DEFVWINH=ON;        /*                       @Y30LB31*/ 02881000
         L     @01,DEFVPTR                                         0894 02882000
         OI    DEFVWINH(@01),B'00000010'                           0894 02883000
*         END;                      /*                       @Y30LB31*/ 02884000
*                                                                  0895 02885000
*       /*************************************************************/ 02886000
*       /*                                                           */ 02887000
*       /* INDICATE NO CHANGE IF THE VOLUME ATTRIBUTES ARE   @Y30LB31*/ 02888000
*       /* NOT TO BE UPDATED.                                @Y30LB31*/ 02889000
*       /*                                                           */ 02890000
*       /*************************************************************/ 02891000
*                                                                  0896 02892000
*       ELSE                        /*                       @Y30LB31*/ 02893000
*         DEFVVFLG=NOCHANGE;        /*                       @Y30LB31*/ 02894000
*                                                                  0896 02895000
         B     @RC00884                                            0896 02896000
@RF00884 L     @01,DEFVPTR                                         0896 02897000
         MVI   DEFVVFLG(@01),X'FF'                                 0896 02898000
*       /*************************************************************/ 02899000
*       /*                                                           */ 02900000
*       /* ONLY IF THE VOLUME BEING ACTIVATED HAS NOT BEEN   @Y30LB31*/ 02901000
*       /* PREVIOUSLY FLAGGED FOR A SERIAL MISMATCH ARE THE MSVC     */ 02902000
*       /* EXTENSIONS TO DEFLIST TO BE INITIALIZED.          @Y30LB31*/ 02903000
*       /*                                                           */ 02904000
*       /*************************************************************/ 02905000
*                                                                  0897 02906000
*       IF BCDVSMIS=OFF THEN        /*                       @Y30LB31*/ 02907000
@RC00884 TM    BCDVSMIS(BCDVPTR),B'00100000'                       0897 02908000
         BNZ   @RF00897                                            0897 02909000
*         DO;                       /*                       @Y30LB31*/ 02910000
*           DEFVVEXT=DEFVEPTR;      /*                       @Y30LB31*/ 02911000
         L     @15,DEFVEPTR                                        0899 02912000
         L     @14,DEFVPTR                                         0899 02913000
         ST    @15,DEFVVEXT(,@14)                                  0899 02914000
*           DEFLNGTH=DEFLEN;        /*                       @Y30LB31*/ 02915000
         LH    @14,DEFLEN                                          0900 02916000
         ST    @14,DEFLNGTH(,@15)                                  0900 02917000
*           DEFSRCVY=ON;            /*                       @Y30LB31*/ 02918000
         OI    DEFSRCVY(@15),B'10000000'                           0901 02919000
*           DEFLAMIS=ON;            /*                       @Y30LB31*/ 02920000
         OI    DEFLAMIS(@15),B'00100000'                           0902 02921000
*           DEFLABEL=VOLVAL;        /* SAVE VOL LABEL        @Y30LB31*/ 02922000
         L     @14,@PC00001+4                                      0903 02923000
         L     @01,FDTPTR(,@14)                                    0903 02924000
         MVC   DEFLABEL(6,@15),VOLVAL(@01)                         0903 02925000
*           DEFPVLAB=ON;            /*                       @Y30LB31*/ 02926000
         OI    DEFPVLAB(@15),B'01000000'                           0904 02927000
*         END;                      /*                       @Y30LB31*/ 02928000
*     END;                          /*                       @Y30LB31*/ 02929000
*                                                                  0907 02930000
*   /*****************************************************************/ 02931000
*   /*                                                               */ 02932000
*   /* IF A DUMMY RENAME REQUEST IS SPECIFIED IN ADDVTBL,    @Y30LB31*/ 02933000
*   /* THE VOLUME IS RENAMED WITH ITS SAME SERIAL NUMBER. INIT THE   */ 02934000
*   /* PARM LIST AS FOLLOWS.                                 @Y30LB31*/ 02935000
*   /*                                                               */ 02936000
*   /*****************************************************************/ 02937000
*                                                                  0907 02938000
*   ELSE                            /*                       @Y30LB31*/ 02939000
*     IF RENAMTYP=DUMMY THEN        /*                       @Y30LB31*/ 02940000
         B     @RC00874                                            0907 02941000
@RF00874 CLC   RENAMTYP(8),@CC01672                                0907 02942000
         BNE   @RF00907                                            0907 02943000
*       DO;                         /*                       @Y30LB31*/ 02944000
*         DEFVRNTR=ON;              /*                       @Y30LB31*/ 02945000
         L     @15,DEFVPTR                                         0909 02946000
         OI    DEFVRNTR(@15),B'00000100'                           0909 02947000
*         DEFVCSN1=BCDCSN1;         /*                       @Y30LB31*/ 02948000
         MVC   DEFVCSN1(12,@15),BCDCSN1(BCDVPTR)                   0910 02949000
*         DEFVOLD=VOLVAL;           /*                       @Y30LB31*/ 02950000
         L     @14,@PC00001+4                                      0911 02951000
         L     @14,FDTPTR(,@14)                                    0911 02952000
         MVC   DEFVOLD(6,@15),VOLVAL(@14)                          0911 02953000
*         DEFVNVOL=VOLVAL;          /*                       @Y30LB31*/ 02954000
         MVC   DEFVNVOL(6,@15),VOLVAL(@14)                         0912 02955000
*         DEFVVFLG=NOCHANGE;        /*                       @Y30LB31*/ 02956000
         MVI   DEFVVFLG(@15),X'FF'                                 0913 02957000
*       END;                        /*                       @Y30LB31*/ 02958000
*                                                                  0914 02959000
*   /*****************************************************************/ 02960000
*   /*                                                               */ 02961000
*   /* IF A BACKOUT RENAME REQUEST IS SPECIFIED IN           @Y30LB31*/ 02962000
*   /* DDVTBL, THE ORIGINAL VOLUME SERIAL NO. IS RESTORED. NITIALIZE */ 02963000
*   /* THE PARM LISTS AS FOLLOWS.                            @Y30LB31*/ 02964000
*   /*                                                               */ 02965000
*   /*****************************************************************/ 02966000
*                                                                  0915 02967000
*     ELSE                          /*                       @Y30LB31*/ 02968000
*       DO;                         /*                       @Y30LB31*/ 02969000
         B     @RC00907                                            0915 02970000
@RF00907 DS    0H                                                  0916 02971000
*         DEFVRNM=ON;               /*                       @Y30LB31*/ 02972000
         L     @15,DEFVPTR                                         0916 02973000
         OI    DEFVRNM(@15),B'00100000'                            0916 02974000
*         DEFVOLD=NSERVAL;          /*                       @Y30LB31*/ 02975000
         L     @14,@PC00001+4                                      0917 02976000
         L     @01,FDTPTR+20(,@14)                                 0917 02977000
         MVC   DEFVOLD(6,@15),NSERVAL(@01)                         0917 02978000
*         DEFVNVOL=VOLVAL;          /*                       @Y30LB31*/ 02979000
*                                                                  0918 02980000
         L     @01,FDTPTR(,@14)                                    0918 02981000
         MVC   DEFVNVOL(6,@15),VOLVAL(@01)                         0918 02982000
*         /***********************************************************/ 02983000
*         /*                                                         */ 02984000
*         /* RESTORE THE ORIGINAL VOLUME ATTRIBUTES IF THEY  @Y30LB31*/ 02985000
*         /* WERE CHANGED.                                   @Y30LB31*/ 02986000
*         /*                                                         */ 02987000
*         /***********************************************************/ 02988000
*                                                                  0919 02989000
*         IF NEWVFFLG=ON THEN       /*                       @Y30LB31*/ 02990000
         TM    NEWVFFLG,B'00001000'                                0919 02991000
         BNO   @RF00919                                            0919 02992000
*           DO;                     /*                       @Y30LB31*/ 02993000
*             IF OLDDEFLG=ON THEN   /*                       @Y30LB31*/ 02994000
         TM    OLDDEFLG,B'01000000'                                0921 02995000
         BNO   @RF00921                                            0921 02996000
*               DEFVSEC=ON;         /*                       @Y30LB31*/ 02997000
         OI    DEFVSEC(@15),B'00100000'                            0922 02998000
*             IF OLDEXFLG=ON THEN   /*                       @Y30LB31*/ 02999000
@RF00921 TM    OLDEXFLG,B'00100000'                                0923 03000000
         BNO   @RF00923                                            0923 03001000
*               DEFVEXCL=ON;        /*                       @Y30LB31*/ 03002000
         L     @01,DEFVPTR                                         0924 03003000
         OI    DEFVEXCL(@01),B'00010000'                           0924 03004000
*             IF OLDBIFLG=ON THEN   /*                       @Y30LB31*/ 03005000
@RF00923 TM    OLDBIFLG,B'10000000'                                0925 03006000
         BNO   @RF00925                                            0925 03007000
*               DEFVBIND=ON;        /*                       @Y30LB31*/ 03008000
         L     @01,DEFVPTR                                         0926 03009000
         OI    DEFVBIND(@01),B'00000100'                           0926 03010000
*             IF OLDROFLG=ON THEN   /*                       @Y30LB31*/ 03011000
@RF00925 TM    OLDROFLG,B'00010000'                                0927 03012000
         BNO   @RF00927                                            0927 03013000
*               DEFVWINH=ON;        /*                       @Y30LB31*/ 03014000
         L     @01,DEFVPTR                                         0928 03015000
         OI    DEFVWINH(@01),B'00000010'                           0928 03016000
*           END;                    /*                       @Y30LB31*/ 03017000
*         ELSE                      /*                       @Y30LB31*/ 03018000
*           DEFVVFLG=NOCHANGE;      /*                       @Y30LB31*/ 03019000
         B     @RC00919                                            0930 03020000
@RF00919 L     @01,DEFVPTR                                         0930 03021000
         MVI   DEFVVFLG(@01),X'FF'                                 0930 03022000
*         DEFVVEXT=DEFVEPTR;        /*                       @Y30LB31*/ 03023000
@RC00919 L     @15,DEFVEPTR                                        0931 03024000
         L     @14,DEFVPTR                                         0931 03025000
         ST    @15,DEFVVEXT(,@14)                                  0931 03026000
*         DEFLNGTH=DEFLEN;          /*                       @Y30LB31*/ 03027000
         LH    @14,DEFLEN                                          0932 03028000
         ST    @14,DEFLNGTH(,@15)                                  0932 03029000
*         DEFDUP=ON;                /*                       @Y30LB31*/ 03030000
*                                                                  0933 03031000
         OI    DEFDUP(@15),B'00100000'                             0933 03032000
*         /***********************************************************/ 03033000
*         /*                                                         */ 03034000
*         /* CLEAR THE RECOVERY DATA FROM THE INVENTORY ONLY @Y30LB31*/ 03035000
*         /* IF SET INITIALLY BY THIS ADDV REQUEST.          @Y30LB31*/ 03036000
*         /*                                                         */ 03037000
*         /***********************************************************/ 03038000
*                                                                  0934 03039000
*         IF BCDVSMIS=OFF THEN      /*                       @Y30LB31*/ 03040000
         TM    BCDVSMIS(BCDVPTR),B'00100000'                       0934 03041000
         BNZ   @RF00934                                            0934 03042000
*           DO;                     /*                       @Y30LB31*/ 03043000
*             DEFCRCVY=ON;          /*                       @Y30LB31*/ 03044000
         OI    DEFCRCVY(@15),B'01000000'                           0936 03045000
*             DEFLAMIS=ON;          /*                       @Y30LB31*/ 03046000
         OI    DEFLAMIS(@15),B'00100000'                           0937 03047000
*             DEFLABEL=BLANKIT;     /*                       @Y30LB31*/ 03048000
         MVI   DEFLABEL+1(@15),C' '                                0938 03049000
         MVC   DEFLABEL+2(4,@15),DEFLABEL+1(@15)                   0938 03050000
         MVI   DEFLABEL(@15),C' '                                  0938 03051000
*             DEFPVLAB=ON;          /*                       @Y30LB31*/ 03052000
         OI    DEFPVLAB(@15),B'01000000'                           0939 03053000
*           END;                    /*                       @Y30LB31*/ 03054000
*       END;                        /*                       @Y30LB31*/ 03055000
@RF00934 DS    0H                                                  0942 03056000
*                                                                  0942 03057000
*   /*****************************************************************/ 03058000
*   /*                                                               */ 03059000
*   /* TAKE A SYMBOLIC DUMP OF THE DEFINE ORDER PARM LIST    @Y30LB31*/ 03060000
*   /* BEFORE THE RENAME REQUEST IS EXECUTED.                @Y30LB31*/ 03061000
*   /*                                                               */ 03062000
*   /*****************************************************************/ 03063000
*                                                                  0942 03064000
*   IF GDTDBG=NULLPTR THEN                                         0942 03065000
@RC00907 DS    0H                                                  0942 03066000
@RC00874 L     @15,@PC00001                                        0942 03067000
         L     @15,GDTDBG(,@15)                                    0942 03068000
         LTR   @15,@15                                             0942 03069000
         BZ    @RT00942                                            0942 03070000
*     ;                                                            0943 03071000
*   ELSE                                                           0944 03072000
*     DO;                                                          0944 03073000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 03074000
         LA    DMPINDEX,AVDMPLST                                   0945 03075000
*       DMPITMNM='AV01DEFV';                                       0946 03076000
         MVC   DMPITMNM(8,DMPINDEX),@CC01826                       0946 03077000
*       DMPITMPT=ADDR(AV01DEFV);                                   0947 03078000
         LA    @03,AV01DEFV                                        0947 03079000
         ST    @03,DMPITMPT(,DMPINDEX)                             0947 03080000
*       DMPITMLN=LENGTH(AV01DEFV);                                 0948 03081000
         MVC   DMPITMLN(2,DMPINDEX),@CH02000                       0948 03082000
*       DMPITMTP='H';                                              0949 03083000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0949 03084000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0950 03085000
*                                                                  0950 03086000
         LA    @03,16                                              0950 03087000
         ALR   DMPINDEX,@03                                        0950 03088000
*       /*************************************************************/ 03089000
*       /*                                                           */ 03090000
*       /*                                                   @Y30LB31*/ 03091000
*       /*                                                           */ 03092000
*       /*************************************************************/ 03093000
*                                                                  0951 03094000
*       DMPITMNM='ADDVTBL';                                        0951 03095000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0951 03096000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       0951 03097000
*       DMPITMPT=ADDR(ADDVTBL);                                    0952 03098000
         LA    @15,ADDVTBL                                         0952 03099000
         ST    @15,DMPITMPT(,DMPINDEX)                             0952 03100000
*       DMPITMLN=LENGTH(ADDVTBL);                                  0953 03101000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       0953 03102000
*       DMPITMTP='H';                                              0954 03103000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0954 03104000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 03105000
         ALR   DMPINDEX,@03                                        0955 03106000
*       DMPTRM=DMPTRMVL;                                           0956 03107000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0956 03108000
*     END;                          /*                       @Y30LB31*/ 03109000
*   IF GDTDBG=NULLPTR THEN                                         0958 03110000
@RT00942 L     @15,@PC00001                                        0958 03111000
         L     @15,GDTDBG(,@15)                                    0958 03112000
         LTR   @15,@15                                             0958 03113000
         BZ    @RT00958                                            0958 03114000
*     ;                                                            0959 03115000
*   ELSE                                                           0960 03116000
*     CALL IDCDB010(GDTTBL,'AVBN',ADDR(AVDMPLST));/*         @Y30LB31*/ 03117000
*                                                                  0960 03118000
         L     @15,@PC00001                                        0960 03119000
         ST    @15,@AL00001                                        0960 03120000
         LA    @14,@CC01839                                        0960 03121000
         ST    @14,@AL00001+4                                      0960 03122000
         LA    @14,AVDMPLST                                        0960 03123000
         ST    @14,@AFTEMPS+8                                      0960 03124000
         LA    @14,@AFTEMPS+8                                      0960 03125000
         ST    @14,@AL00001+8                                      0960 03126000
         MVI   @AL00001+8,X'80'                                    0960 03127000
         L     @15,GDTDBG(,@15)                                    0960 03128000
         LA    @01,@AL00001                                        0960 03129000
         BALR  @14,@15                                             0960 03130000
*   /*****************************************************************/ 03131000
*   /*                                                               */ 03132000
*   /* CHANGE THE VOLUME SERIAL NO. IN THE CART LABELS AND   @Y30LB31*/ 03133000
*   /* MSVI.                                                 @Y30LB31*/ 03134000
*   /*                                                               */ 03135000
*   /*****************************************************************/ 03136000
*                                                                  0961 03137000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBCODE,/*    @Y30LB31*/ 03138000
*       ECBMSPTR);                  /*                       @Y30LB31*/ 03139000
@RT00958 L     @02,@PC00001                                        0961 03140000
         ST    @02,@AL00001                                        0961 03141000
         LA    @15,DEFINE                                          0961 03142000
         ST    @15,@AL00001+4                                      0961 03143000
         LA    @15,DEFVPTR                                         0961 03144000
         ST    @15,@AL00001+8                                      0961 03145000
         LA    @15,REASON                                          0961 03146000
         ST    @15,@AL00001+12                                     0961 03147000
         LA    @15,ECBCODE                                         0961 03148000
         ST    @15,@AL00001+16                                     0961 03149000
         LA    @15,ECBMSPTR                                        0961 03150000
         ST    @15,@AL00001+20                                     0961 03151000
         MVI   @AL00001+20,X'80'                                   0961 03152000
         L     @15,GDTSSC(,@02)                                    0961 03153000
         LA    @01,@AL00001                                        0961 03154000
         BALR  @14,@15                                             0961 03155000
*   RESPECIFY                                                      0962 03156000
*     RTNREG RSTD;                                                 0962 03157000
*   TESTRC=RTNREG;                                                 0963 03158000
         LR    TESTRC,RTNREG                                       0963 03159000
*   RESPECIFY                                                      0964 03160000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 03161000
*                                                                  0965 03162000
*   /*****************************************************************/ 03163000
*   /*                                                               */ 03164000
*   /* TEST RETURN CODE FROM DSM DEFINE ORDER. TREAT A       @Y30LB31*/ 03165000
*   /* MSVI I/O ERROR AS A MINOR ERROR FOR THE DSM RENAME IS DONE.   */ 03166000
*   /*                                                       @Y30LB31*/ 03167000
*   /*                                                               */ 03168000
*   /*****************************************************************/ 03169000
*                                                                  0965 03170000
*   IF TESTRC=12 THEN               /*                       @Y30LB31*/ 03171000
         C     TESTRC,@CF00606                                     0965 03172000
         BNE   @RF00965                                            0965 03173000
*     DO;                           /*                       @Y30LB31*/ 03174000
*       TESTRC=0;                   /*                       @Y30LB31*/ 03175000
         SLR   TESTRC,TESTRC                                       0967 03176000
*       CC04FLG=ON;                 /*                       @Y30LB31*/ 03177000
         OI    CC04FLG,B'10000000'                                 0968 03178000
*     END;                          /*                       @Y30LB31*/ 03179000
*                                                                  0969 03180000
*   /*****************************************************************/ 03181000
*   /*                                                               */ 03182000
*   /* IF THE MSC RENAME FAILED, UPDATE THE COND CODE. PRINT @Y30LB31*/ 03183000
*   /* A MESSAGE WITH THE MSSC REASON CODE AND EXIT FROM THIS        */ 03184000
*   /* PROCEDURE.                                            @Y30LB31*/ 03185000
*   /*                                                               */ 03186000
*   /*****************************************************************/ 03187000
*                                                                  0970 03188000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 03189000
@RF00965 LTR   TESTRC,TESTRC                                       0970 03190000
         BZ    @RF00970                                            0970 03191000
*     DO;                           /*                       @Y30LB31*/ 03192000
*       RENAMRC=4;                  /*                       @Y30LB31*/ 03193000
         LA    @02,4                                               0972 03194000
         LR    RENAMRC,@02                                         0972 03195000
*       IF TESTRC=4 THEN            /*                       @Y30LB31*/ 03196000
         CR    TESTRC,@02                                          0973 03197000
         BNE   @RF00973                                            0973 03198000
*         CALL SSCMSG(REASON,ECBCODE);/*                     @Y30LB31*/ 03199000
         LA    @15,REASON                                          0974 03200000
         ST    @15,@AL00001                                        0974 03201000
         LA    @15,ECBCODE                                         0974 03202000
         ST    @15,@AL00001+4                                      0974 03203000
         LA    @01,@AL00001                                        0974 03204000
         BAL   @14,SSCMSG                                          0974 03205000
*     END;                          /*                       @Y30LB31*/ 03206000
*                                                                  0975 03207000
*   /*****************************************************************/ 03208000
*   /*                                                               */ 03209000
*   /* THE VOL SERIAL NO. WAS SUCCESSFULLY CHANGED IN THE    @Y30LB31*/ 03210000
*   /* CART LABELS AND MSVI. SAVE THE NEW IDENTIFICATION OF THE      */ 03211000
*   /*                                                       @Y30LB31*/ 03212000
*   /* VOLUME AND FREE THE MESSAGE STORAGE AREA IF THE CALLER OF     */ 03213000
*   /*                                                       @Y30LB31*/ 03214000
*   /* THIS PROCEDURE DOES NOT REQUIRE IT.                   @Y30LB31*/ 03215000
*   /*                                                               */ 03216000
*   /*****************************************************************/ 03217000
*                                                                  0976 03218000
*   ELSE                            /*                       @Y30LB31*/ 03219000
*     DO;                           /*                       @Y30LB31*/ 03220000
         B     @RC00970                                            0976 03221000
@RF00970 DS    0H                                                  0977 03222000
*       CMMSGPTR=ECBMSPTR+ECBLEN;   /*                       @Y30LB31*/ 03223000
         LA    CMMSGPTR,4                                          0977 03224000
         AL    CMMSGPTR,ECBMSPTR                                   0977 03225000
*       MSVIVOL#=CMNEWVOL;          /*                       @Y30LB31*/ 03226000
         MVC   MSVIVOL#(6),CMNEWVOL(CMMSGPTR)                      0978 03227000
*       IF MSGFLG=OFF THEN          /*                       @Y30LB31*/ 03228000
         TM    MSGFLG,B'00010000'                                  0979 03229000
         BNZ   @RF00979                                            0979 03230000
*         CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*                  @Y30LB31*/ 03231000
         L     @15,@PC00001                                        0980 03232000
         ST    @15,@AL00001                                        0980 03233000
         LA    @14,ECBMSPTR                                        0980 03234000
         ST    @14,@AL00001+4                                      0980 03235000
         L     @15,GDTFSP(,@15)                                    0980 03236000
         LA    @01,@AL00001                                        0980 03237000
         BALR  @14,@15                                             0980 03238000
*     END;                          /*                       @Y30LB31*/ 03239000
*                                                                  0981 03240000
@RF00979 DS    0H                                                  0982 03241000
*   /*****************************************************************/ 03242000
*   /*                                                               */ 03243000
*   /* RESTORE THE RETURN ADDRESS OF THE CALLER TO REG 14 AND RETURN */ 03244000
*   /* TO CALLER, PASSING THE CONDITION CODE IN REG 15.      @Y30LB31*/ 03245000
*   /*                                                               */ 03246000
*   /*****************************************************************/ 03247000
*                                                                  0982 03248000
*   RESPECIFY                                                      0982 03249000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 03250000
@RC00970 DS    0H                                                  0983 03251000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 03252000
         L     REG14,RETADDR3                                      0983 03253000
*   RESPECIFY                                                      0984 03254000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 03255000
*   RETURN CODE(RENAMRC);           /*                       @Y30LB31*/ 03256000
         LR    @15,RENAMRC                                         0985 03257000
@EL00007 DS    0H                                                  0985 03258000
@EF00007 DS    0H                                                  0985 03259000
@ER00007 BR    @14                                                 0985 03260000
*   END RENAMRTN;                   /*                       @Y30LB31*/ 03261000
*                                                                  0987 03262000
*/********************************************************** @Y30LB31*/ 03263000
*/*                                                          @Y30LB31*/ 03264000
*/* PROCEDURE NAME - ALLOCRTN                                @Y30LB31*/ 03265000
*/*                                                          @Y30LB31*/ 03266000
*/* FUNCTION - IF NO FILE PARAMETER IS SPECIFIED, EITHER     @YD00175*/ 03267000
*/*            SELECTS AN EXCLUSIVE UNIT FOR REUSE OR        @YD00175*/ 03268000
*/*            DYNAMICALLY ALLOCATES A UNIT. VERIFIES THAT   @YD00175*/ 03269000
*/*            THE UNIT FROM THE FILE PARAMETER IS VIRTUAL.  @YD00175*/ 03270000
*/*            OBTAINS EXCLUSIVE CONTROL OF THE UNIT         @YD00175*/ 03271000
*/*            NO MESSAGES ARE ISSUED BY THIS ROUTINE.       @Y30LB31*/ 03272000
*/*                                                          @Y30LB31*/ 03273000
*/* INPUT - FDTTBL                                           @Y30LB31*/ 03274000
*/*                                                          @Y30LB31*/ 03275000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL ALLOC-    @Y30LB31*/ 03276000
*/*          TION AND CHECK OUT AND UPDATED ADDVTBL.         @Y30LB31*/ 03277000
*/*          RETURN CODE OF 4 INDICATES DYNAMIC ALLOCATION   @Y30LB31*/ 03278000
*/*          FAILED OR UNIT NOT VIRTUAL OR EXCLUSIVELY       @Y30LB31*/ 03279000
*/*          ASSIGNED TO ADDV.                               @Y30LB31*/ 03280000
*/*                                                          @Y30LB31*/ 03281000
*/********************************************************** @Y30LB31*/ 03282000
*                                                                  0987 03283000
*ALLOCRTN:                                                         0987 03284000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 03285000
*                                                                  0987 03286000
ALLOCRTN DS    0H                                                  0988 03287000
*   /*****************************************************************/ 03288000
*   /*                                                               */ 03289000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 03290000
*   /*                                                               */ 03291000
*   /*****************************************************************/ 03292000
*                                                                  0988 03293000
*   DCL                                                            0988 03294000
*     ALLOCRC FIXED(15);            /*                       @Y30LB31*/ 03295000
*                                                                  0988 03296000
*   /*****************************************************************/ 03297000
*   /*                                                               */ 03298000
*   /* SETUP STORAGE AREA TO BUILD CKAGL FOR UNIT CHECKOUT.  @Y30LB31*/ 03299000
*   /*                                                               */ 03300000
*   /*****************************************************************/ 03301000
*                                                                  0989 03302000
*   DCL                                                            0989 03303000
*     AVCKAGL CHAR(LENGTH(CKAGL)) BDY(WORD);/*               @Y30LB31*/ 03304000
*                                                                  0989 03305000
*   /*****************************************************************/ 03306000
*   /*                                                               */ 03307000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 03308000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 03309000
*   /*                                                               */ 03310000
*   /*****************************************************************/ 03311000
*                                                                  0990 03312000
*   RESPECIFY                                                      0990 03313000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 03314000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 03315000
         ST    REG14,RETADDR3                                      0991 03316000
*   RESPECIFY                                                      0992 03317000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 03318000
*   OLDERID2=NEWERID2;                                             0993 03319000
         L     @15,@PC00001                                        0993 03320000
         L     @14,GDTTR2(,@15)                                    0993 03321000
         MVC   @TS00001(95),NEWERID2(@14)                          0993 03322000
         MVC   OLDERID2(95,@14),@TS00001                           0993 03323000
*   NEWID2='AVAL';                  /*                       @Y30LB31*/ 03324000
*                                                                  0994 03325000
         MVC   NEWID2(4,@14),@CC01845                              0994 03326000
*   /*****************************************************************/ 03327000
*   /*                                                               */ 03328000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS    @Y30LB31*/ 03329000
*   /* PROCEDURE.                                            @Y30LB31*/ 03330000
*   /*                                                               */ 03331000
*   /*****************************************************************/ 03332000
*                                                                  0995 03333000
*   ALLOCRC=LASTCC00;               /*                       @Y30LB31*/ 03334000
*                                                                  0995 03335000
         SLR   @14,@14                                             0995 03336000
         LR    ALLOCRC,@14                                         0995 03337000
*   /*****************************************************************/ 03338000
*   /*                                                               */ 03339000
*   /* IF THE FILE PARAMETER IS NOT SPECIFIED, LOOK FOR      @YD00175*/ 03340000
*   /* A FILE THAT WE CAN REUSE THAT IS ALREADY ALLOCATED    @YD00175*/ 03341000
*   /* FOR EXCLUSIVE CONTROL OF THE VOLUME                   @YD00175*/ 03342000
*   /*                                                               */ 03343000
*   /*****************************************************************/ 03344000
*                                                                  0996 03345000
*   IF ADDR(FILE)=NULLPTR THEN      /*                       @Y30LB31*/ 03346000
         L     @03,@PC00001+4                                      0996 03347000
         C     @14,FDTPTR+28(,@03)                                 0996 03348000
         BNE   @RF00996                                            0996 03349000
*     DO;                           /*                       @Y30LB31*/ 03350000
*       EXCLAGL=''B;                /*                       @YD00175*/ 03351000
         LA    @02,AVEXCLST                                        0998 03352000
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        0998 03353000
*       EXCLDDP=ADDR(AUNITDDN);     /*                       @YD00175*/ 03354000
         LA    @14,AUNITDDN                                        0999 03355000
         ST    @14,EXCLDDP(,@02)                                   0999 03356000
*       EXCLUCBP=ADDR(AUNITUCB);    /*                       @YD00175*/ 03357000
         LA    @14,AUNITUCB                                        1000 03358000
         ST    @14,EXCLUCBP(,@02)                                  1000 03359000
*       EXCLVOL=VOLVAL;             /*                       @YD00175*/ 03360000
*                                                                  1001 03361000
         L     @14,@PC00001+4                                      1001 03362000
         L     @01,FDTPTR(,@14)                                    1001 03363000
         MVC   EXCLVOL(6,@02),VOLVAL(@01)                          1001 03364000
*       /*************************************************************/ 03365000
*       /*                                                           */ 03366000
*       /* ISSUE UMSSUNIT TO SELECT EXCLUSIVE UNIT           @YD00175*/ 03367000
*       /*                                                           */ 03368000
*       /*************************************************************/ 03369000
*                                                                  1002 03370000
*       CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*             @YD00175*/ 03371000
         ST    @15,@AL00001                                        1002 03372000
         LA    @14,SELECTX                                         1002 03373000
         ST    @14,@AL00001+4                                      1002 03374000
         ST    @02,@AL00001+8                                      1002 03375000
         MVI   @AL00001+8,X'80'                                    1002 03376000
         L     @15,GDTUNT(,@15)                                    1002 03377000
         LA    @01,@AL00001                                        1002 03378000
         BALR  @14,@15                                             1002 03379000
*       RESPECIFY                                                  1003 03380000
*         RTNREG RSTD;                                             1003 03381000
*       TESTRC=RTNREG;                                             1004 03382000
         LR    TESTRC,RTNREG                                       1004 03383000
*       RESPECIFY                                                  1005 03384000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 03385000
*                                                                  1005 03386000
*       /*************************************************************/ 03387000
*       /*                                                           */ 03388000
*       /* IF THE RETURN CODE IS NOT ZERO, EXIT FROM PROC    @YD00175*/ 03389000
*       /*                                                           */ 03390000
*       /*************************************************************/ 03391000
*                                                                  1006 03392000
*       IF TESTRC>0 THEN                                           1006 03393000
         LTR   TESTRC,TESTRC                                       1006 03394000
         BNP   @RF01006                                            1006 03395000
*         ALLOCRC=LASTCC04;         /*                       @YD00175*/ 03396000
*                                                                  1007 03397000
         LA    ALLOCRC,4                                           1007 03398000
*       /*************************************************************/ 03399000
*       /*                                                           */ 03400000
*       /* BIT IF WE DID NOT GET A UCB FROM UMSSUNIT,        @YD00175*/ 03401000
*       /* DYMANICALLY ALLOCATE THE UNIT                     @YD00175*/ 03402000
*       /*                                                           */ 03403000
*       /*************************************************************/ 03404000
*                                                                  1008 03405000
*       ELSE                                                       1008 03406000
*         DO;                       /*                       @YD00175*/ 03407000
         B     @RC01006                                            1008 03408000
@RF01006 DS    0H                                                  1009 03409000
*           IF AUNITUCB=0 THEN                                     1009 03410000
         L     @15,AUNITUCB                                        1009 03411000
         LTR   @15,@15                                             1009 03412000
         BNZ   @RF01009                                            1009 03413000
*             DO;                   /*                       @YD00175*/ 03414000
*               ALLOPTVL=ON;        /*                       @Y30LB31*/ 03415000
         LA    @02,AVALLTBL                                        1011 03416000
         OI    ALLOPTVL(@02),B'10000000'                           1011 03417000
*               ALLVLCNT=1;         /*                       @YD00175*/ 03418000
         MVI   ALLVLCNT(@02),X'01'                                 1012 03419000
*               ALLUNCNT=1;         /*                       @Y30LB31*/ 03420000
         MVI   ALLUNCNT(@02),X'01'                                 1013 03421000
*               ALLOPTPV=ON;        /*                       @Y30LB31*/ 03422000
         OI    ALLOPTPV(@02),B'00100000'                           1014 03423000
*               ALLULP=ADDR(AVUNLST);/*                      @Y30LB31*/ 03424000
         LA    @15,AVUNLST                                         1015 03425000
         ST    @15,ALLULP(,@02)                                    1015 03426000
*               AVUNCNT=1;          /*                       @Y30LB31*/ 03427000
         LA    @15,1                                               1016 03428000
         STH   @15,AVUNCNT                                         1016 03429000
*               AVUNLEN=LENGTH(DEV3330V);/*                  @Y30LB31*/ 03430000
         MVC   AVUNLEN(2),@CH00298                                 1017 03431000
*               AVUNVAL=DEV3330V;   /*                       @Y30LB31*/ 03432000
         MVI   AVUNVAL+5,C' '                                      1018 03433000
         MVC   AVUNVAL+6(2),AVUNVAL+5                              1018 03434000
         MVC   AVUNVAL(5),@CC01616                                 1018 03435000
*               ALLVLP=ADDR(AVVOLLST);/*                     @Y30LB31*/ 03436000
         LA    @14,AVVOLLST                                        1019 03437000
         ST    @14,ALLVLP(,@02)                                    1019 03438000
*               SERCNT=1;           /*                       @Y30LB31*/ 03439000
         STH   @15,SERCNT                                          1020 03440000
*               SERLEN=VOLLEN;      /*                       @Y30LB31*/ 03441000
         L     @15,@PC00001+4                                      1021 03442000
         L     @15,FDTPTR(,@15)                                    1021 03443000
         SLR   @14,@14                                             1021 03444000
         IC    @14,VOLLEN(,@15)                                    1021 03445000
         STH   @14,SERLEN                                          1021 03446000
*               SERNO=VOLVAL;       /*                       @Y30LB31*/ 03447000
         MVC   SERNO(6),VOLVAL(@15)                                1022 03448000
*               CALL IDCSAAL0(GDTTBL,ALLAGL);/*              @Y30LB31*/ 03449000
         L     @15,@PC00001                                        1023 03450000
         ST    @15,@AL00001                                        1023 03451000
         ST    @02,@AL00001+4                                      1023 03452000
         MVI   @AL00001+4,X'80'                                    1023 03453000
         L     @15,GDTALC(,@15)                                    1023 03454000
         LA    @01,@AL00001                                        1023 03455000
         BALR  @14,@15                                             1023 03456000
*               RESPECIFY                                          1024 03457000
*                 RTNREG RSTD;                                     1024 03458000
*               TESTRC=RTNREG;                                     1025 03459000
         LR    TESTRC,RTNREG                                       1025 03460000
*               RESPECIFY                                          1026 03461000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 03462000
*                                                                  1026 03463000
*               /*****************************************************/ 03464000
*               /*                                                   */ 03465000
*               /* TEST RETURN CODE FROM DYNAMIC ALLOCATION REQUEST  */ 03466000
*               /*                                           @Y30LB31*/ 03467000
*               /* AND EXIT FROM THIS PROC IF DYNAMIC ALLOCATION     */ 03468000
*               /* FAILED.                                   @Y30LB31*/ 03469000
*               /*                                                   */ 03470000
*               /*****************************************************/ 03471000
*                                                                  1027 03472000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 03473000
         LTR   TESTRC,TESTRC                                       1027 03474000
         BZ    @RF01027                                            1027 03475000
*                 ALLOCRC=4;        /*                       @Y30LB31*/ 03476000
*                                                                  1028 03477000
         LA    ALLOCRC,4                                           1028 03478000
*               /*****************************************************/ 03479000
*               /*                                                   */ 03480000
*               /* SAVE THE DDNAME OF THE DYNAMICALLY ALLOCATED      */ 03481000
*               /*                                           @Y30LB31*/ 03482000
*               /* UNIT AND SET AN INDICATOR FOR UDEALLOC AT EOJ.    */ 03483000
*               /*                                           @Y30LB31*/ 03484000
*               /*                                                   */ 03485000
*               /*****************************************************/ 03486000
*                                                                  1029 03487000
*               ELSE                /*                       @Y30LB31*/ 03488000
*                 DO;               /*                       @Y30LB31*/ 03489000
         B     @RC01027                                            1029 03490000
@RF01027 DS    0H                                                  1030 03491000
*                   ALLOCFLG=ON;    /*                       @Y30LB31*/ 03492000
         OI    ALLOCFLG,B'00000100'                                1030 03493000
*                   AUNITDDN=ALLDDN;/*                       @Y30LB31*/ 03494000
         LA    @15,AVALLTBL                                        1031 03495000
         MVC   AUNITDDN(8),ALLDDN(@15)                             1031 03496000
*                 END;              /*                       @Y30LB31*/ 03497000
*                                                                  1032 03498000
*               /*****************************************************/ 03499000
*               /*                                                   */ 03500000
*               /* CLOSE DO GROUP FOR DYNAMIC ALLOCATION.    @Y30LB31*/ 03501000
*               /*                                                   */ 03502000
*               /*****************************************************/ 03503000
*                                                                  1033 03504000
*             END;                  /*                       @Y30LB31*/ 03505000
*         END;                      /*                       @YD00175*/ 03506000
*     END;                          /*                       @YD00175*/ 03507000
*                                                                  1035 03508000
*   /*****************************************************************/ 03509000
*   /*                                                               */ 03510000
*   /* DYNAMIC ALLOCATION IS NOT REQUIRED. SAVE THE DDNAME   @Y30LB31*/ 03511000
*   /* OF THE UNIT OBTAINED VIA THE FILE PARM.               @Y30LB31*/ 03512000
*   /*                                                               */ 03513000
*   /*****************************************************************/ 03514000
*                                                                  1036 03515000
*   ELSE                            /*                       @Y30LB31*/ 03516000
*     AUNITDDN=FILEVAL;             /*                       @Y30LB31*/ 03517000
         B     @RC00996                                            1036 03518000
@RF00996 L     @15,@PC00001+4                                      1036 03519000
         L     @01,FDTPTR+28(,@15)                                 1036 03520000
         MVC   AUNITDDN(8),FILEVAL(@01)                            1036 03521000
*                                                                  1037 03522000
*   /*****************************************************************/ 03523000
*   /*                                                               */ 03524000
*   /* SETUP CKAGL TO VERIFY THAT THE DEVICE IS              @Y30LB31*/ 03525000
*   /* VIRTUAL.                                              @YD00175*/ 03526000
*   /*                                                               */ 03527000
*   /*****************************************************************/ 03528000
*                                                                  1037 03529000
*   IF ALLOCRC=0&ADDR(FILE)=NULLPTR THEN                           1037 03530000
@RC00996 SLR   @15,@15                                             1037 03531000
         CR    ALLOCRC,@15                                         1037 03532000
         BNE   @RF01037                                            1037 03533000
         L     @14,@PC00001+4                                      1037 03534000
         C     @15,FDTPTR+28(,@14)                                 1037 03535000
         BNE   @RF01037                                            1037 03536000
*     DO;                           /*                       @YD00175*/ 03537000
*       RESPECIFY                                                  1039 03538000
*         CKAGL BASED(ADDR(AVCKAGL));/*                      @Y30LB31*/ 03539000
*       CKAGL=''B;                  /*                       @Y30LB31*/ 03540000
         LA    @14,AVCKAGL                                         1040 03541000
         XC    CKAGL(29,@14),CKAGL(@14)                            1040 03542000
*       CKTESTVT=ON;                /*                       @Y30LB31*/ 03543000
         OI    CKTESTVT(@14),B'10000000'                           1041 03544000
*       CKDDNAME=AUNITDDN;          /*                       @Y30LB31*/ 03545000
         MVC   CKDDNAME(8,@14),AUNITDDN                            1042 03546000
*       CKUCBPTR=ADDR(AUNITUCB);    /* RETURNED BY UMSSUNIT  @Y30LB31*/ 03547000
*                                                                  1043 03548000
         LA    @03,AUNITUCB                                        1043 03549000
         ST    @03,CKUCBPTR(,@14)                                  1043 03550000
*       /*************************************************************/ 03551000
*       /*                                                           */ 03552000
*       /* TAKE A SYMBOLIC DUMP OF CKAGL BEFORE CHECKING OUT @Y30LB31*/ 03553000
*       /* THE UNIT.                                         @Y30LB31*/ 03554000
*       /*                                                           */ 03555000
*       /*************************************************************/ 03556000
*                                                                  1044 03557000
*       IF GDTDBG=NULLPTR THEN                                     1044 03558000
         L     @14,@PC00001                                        1044 03559000
         C     @15,GDTDBG(,@14)                                    1044 03560000
         BE    @RT01044                                            1044 03561000
*         ;                                                        1045 03562000
*       ELSE                                                       1046 03563000
*         DO;                                                      1046 03564000
*           DMPINDEX=ADDR(AVDMPLST);/*                       @Y30LB31*/ 03565000
         LA    DMPINDEX,AVDMPLST                                   1047 03566000
*           DMPITMNM='AVCKAGL';                                    1048 03567000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1048 03568000
         MVC   DMPITMNM(7,DMPINDEX),@CC01848                       1048 03569000
*           DMPITMPT=ADDR(AVCKAGL);                                1049 03570000
         LA    @03,AVCKAGL                                         1049 03571000
         ST    @03,DMPITMPT(,DMPINDEX)                             1049 03572000
*           DMPITMLN=LENGTH(CKAGL);                                1050 03573000
         MVC   DMPITMLN(2,DMPINDEX),@CH00885                       1050 03574000
*           DMPITMTP='H';                                          1051 03575000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1051 03576000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            1052 03577000
*                                                                  1052 03578000
         LA    @03,16                                              1052 03579000
         ALR   DMPINDEX,@03                                        1052 03580000
*           /*********************************************************/ 03581000
*           /*                                                       */ 03582000
*           /*                                               @Y30LB31*/ 03583000
*           /*                                                       */ 03584000
*           /*********************************************************/ 03585000
*                                                                  1053 03586000
*           DMPITMNM='ADDVTBL';                                    1053 03587000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1053 03588000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1053 03589000
*           DMPITMPT=ADDR(ADDVTBL);                                1054 03590000
         LA    @15,ADDVTBL                                         1054 03591000
         ST    @15,DMPITMPT(,DMPINDEX)                             1054 03592000
*           DMPITMLN=LENGTH(ADDVTBL);                              1055 03593000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1055 03594000
*           DMPITMTP='H';                                          1056 03595000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1056 03596000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            1057 03597000
*                                                                  1057 03598000
         ALR   DMPINDEX,@03                                        1057 03599000
*           /*********************************************************/ 03600000
*           /*                                                       */ 03601000
*           /*                                               @Y30LB31*/ 03602000
*           /*                                                       */ 03603000
*           /*********************************************************/ 03604000
*                                                                  1058 03605000
*           DMPTRM=DMPTRMVL;                                       1058 03606000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1058 03607000
*         END;                      /*                       @Y30LB31*/ 03608000
*       IF GDTDBG=NULLPTR THEN                                     1060 03609000
@RT01044 L     @15,@PC00001                                        1060 03610000
         L     @15,GDTDBG(,@15)                                    1060 03611000
         LTR   @15,@15                                             1060 03612000
         BZ    @RT01060                                            1060 03613000
*         ;                                                        1061 03614000
*       ELSE                                                       1062 03615000
*         CALL IDCDB010(GDTTBL,'AVCK',ADDR(AVDMPLST));/*     @Y30LB31*/ 03616000
*                                                                  1062 03617000
         L     @15,@PC00001                                        1062 03618000
         ST    @15,@AL00001                                        1062 03619000
         LA    @14,@CC01849                                        1062 03620000
         ST    @14,@AL00001+4                                      1062 03621000
         LA    @14,AVDMPLST                                        1062 03622000
         ST    @14,@AFTEMPS+12                                     1062 03623000
         LA    @14,@AFTEMPS+12                                     1062 03624000
         ST    @14,@AL00001+8                                      1062 03625000
         MVI   @AL00001+8,X'80'                                    1062 03626000
         L     @15,GDTDBG(,@15)                                    1062 03627000
         LA    @01,@AL00001                                        1062 03628000
         BALR  @14,@15                                             1062 03629000
*       /*************************************************************/ 03630000
*       /*                                                           */ 03631000
*       /* PERFORM THE UNIT CHECK OUT.                       @Y30LB31*/ 03632000
*       /*                                                           */ 03633000
*       /*************************************************************/ 03634000
*                                                                  1063 03635000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB31*/ 03636000
@RT01060 L     @02,@PC00001                                        1063 03637000
         ST    @02,@AL00001                                        1063 03638000
         LA    @15,CHECK                                           1063 03639000
         ST    @15,@AL00001+4                                      1063 03640000
         LA    @15,AVCKAGL                                         1063 03641000
         ST    @15,@AL00001+8                                      1063 03642000
         MVI   @AL00001+8,X'80'                                    1063 03643000
         L     @15,GDTUNT(,@02)                                    1063 03644000
         LA    @01,@AL00001                                        1063 03645000
         BALR  @14,@15                                             1063 03646000
*       RESPECIFY                                                  1064 03647000
*         RTNREG RSTD;                                             1064 03648000
*       TESTRC=RTNREG;                                             1065 03649000
         LR    TESTRC,RTNREG                                       1065 03650000
*       RESPECIFY                                                  1066 03651000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 03652000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 03653000
         LTR   TESTRC,TESTRC                                       1067 03654000
         BZ    @RF01067                                            1067 03655000
*         ALLOCRC=4;                /*                       @Y30LB31*/ 03656000
         LA    ALLOCRC,4                                           1068 03657000
*     END;                          /*                       @Y30LB31*/ 03658000
*                                                                  1069 03659000
@RF01067 DS    0H                                                  1070 03660000
*   /*****************************************************************/ 03661000
*   /*                                                               */ 03662000
*   /* IF NO ERRORS, GET EXCLUSIVE USE OF VOLUME             @YD00175*/ 03663000
*   /*                                                               */ 03664000
*   /*****************************************************************/ 03665000
*                                                                  1070 03666000
*   IF ALLOCRC=0 THEN                                              1070 03667000
@RF01037 LTR   ALLOCRC,ALLOCRC                                     1070 03668000
         BNZ   @RF01070                                            1070 03669000
*     DO;                           /*                       @YD00175*/ 03670000
*       EXCLAGL=''B;                /*                       @YD00175*/ 03671000
         LA    @02,AVEXCLST                                        1072 03672000
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        1072 03673000
*       EXCLUCBP=ADDR(AUNITUCB);    /*                       @YD00175*/ 03674000
         LA    @15,AUNITUCB                                        1073 03675000
         ST    @15,EXCLUCBP(,@02)                                  1073 03676000
*       EXCLDDP=ADDR(AUNITDDN);     /*                       @YD00175*/ 03677000
*                                                                  1074 03678000
         LA    @15,AUNITDDN                                        1074 03679000
         ST    @15,EXCLDDP(,@02)                                   1074 03680000
*       /*************************************************************/ 03681000
*       /*                                                           */ 03682000
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/ 03683000
*       /*                                                           */ 03684000
*       /*************************************************************/ 03685000
*                                                                  1075 03686000
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/ 03687000
         L     @15,@PC00001                                        1075 03688000
         ST    @15,@AL00001                                        1075 03689000
         LA    @14,CHANGEX                                         1075 03690000
         ST    @14,@AL00001+4                                      1075 03691000
         ST    @02,@AL00001+8                                      1075 03692000
         MVI   @AL00001+8,X'80'                                    1075 03693000
         L     @15,GDTUNT(,@15)                                    1075 03694000
         LA    @01,@AL00001                                        1075 03695000
         BALR  @14,@15                                             1075 03696000
*       RESPECIFY                                                  1076 03697000
*         RTNREG RSTD;                                             1076 03698000
*       TESTRC=RTNREG;                                             1077 03699000
         LR    TESTRC,RTNREG                                       1077 03700000
*       RESPECIFY                                                  1078 03701000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 03702000
*       IF TESTRC>0 THEN                                           1079 03703000
         LTR   TESTRC,TESTRC                                       1079 03704000
         BNP   @RF01079                                            1079 03705000
*         ALLOCRC=LASTCC04;         /*                       @YD00175*/ 03706000
         LA    ALLOCRC,4                                           1080 03707000
*     END;                          /*                       @YD00175*/ 03708000
*                                                                  1081 03709000
@RF01079 DS    0H                                                  1082 03710000
*   /*****************************************************************/ 03711000
*   /*                                                               */ 03712000
*   /* RESTORE REG 14 WITH THE RETURN ADDR OF CALLER. EXIT   @Y30LB31*/ 03713000
*   /* FROM ALLOCRTN PASSING THE COND CODE IN REG 15.        @Y30LB31*/ 03714000
*   /*                                                               */ 03715000
*   /*****************************************************************/ 03716000
*                                                                  1082 03717000
*   RESPECIFY                                                      1082 03718000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 03719000
@RF01070 DS    0H                                                  1083 03720000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 03721000
         L     REG14,RETADDR3                                      1083 03722000
*   RESPECIFY                                                      1084 03723000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 03724000
*   RETURN CODE(ALLOCRC);           /*                       @Y30LB31*/ 03725000
         LR    @15,ALLOCRC                                         1085 03726000
@EL00008 DS    0H                                                  1085 03727000
@EF00008 DS    0H                                                  1085 03728000
@ER00008 BR    @14                                                 1085 03729000
*   END ALLOCRTN;                   /*                       @Y30LB31*/ 03730000
*                                                                  1087 03731000
*/********************************************************** @Y30LB31*/ 03732000
*/*                                                          @Y30LB31*/ 03733000
*/* PROCEDURE NAME - UNIQVRTN                                @Y30LB31*/ 03734000
*/*                                                          @Y30LB31*/ 03735000
*/* FUNCTION - DIRECTS THE ACTIVATE, VOLUME ATTRIBUTE UPDATE @Y30LB31*/ 03736000
*/*            AND OPTIONAL NEW SERIAL NO. UPDATE FOR A BASE @Y30LB31*/ 03737000
*/*            VOLUME.  DIRECTS REPLACING A BASE VOLUME WITH @ZDR2054*/ 03738000
*/*            A COPY VOLUME WITHOUT RENAMING THE COPY       @ZDR2054*/ 03739000
*/*            VOLUME.  CALLS ADDRTN FOR THE ACTIVATE AND    @ZDR2054*/ 03740000
*/*            VOL ATTR UPDATE.  IF NEWSERIAL IS SPECIFIED,  @ZDR2054*/ 03741000
*/*            CALLS SECCKRTN, CLABLRTN, AND VLABLRTN.       @Y30LB31*/ 03742000
*/*            ISSUES MESSAGES IDC0722I AND IDC0724I.        @Y30LB31*/ 03743000
*/*                                                          @Y30LB31*/ 03744000
*/* INPUT - FDTTBL, ADDVTBL, PRINTTBL FOR MSGS               @Y30LB31*/ 03745000
*/*                                                          @Y30LB31*/ 03746000
*/* OUTPUT - RETURN CODE OF 0 INDICATES VOLUME ACTIVATED     @Y30LB31*/ 03747000
*/*          AND RELABELED IF REQUESTED.                     @Y30LB31*/ 03748000
*/*          RETURN CODE OF 8 INDICATES VOLUME HAS BEEN      @Y30LB31*/ 03749000
*/*          ACTIVATED BUT ATTRIBUTES NOT UPDATED, OR        @Y30LB31*/ 03750000
*/*          THE NEW SERIAL NOT UPDATED IN THE CARTRIDGE     @Y30LB31*/ 03751000
*/*          OR VOLUME LABEL, OR THE MISMATCH RECOVERY FLAG  @Y30LB31*/ 03752000
*/*          NOT CLEARED FROM THE INVENTORY.                 @Y30LB31*/ 03753000
*/*          RETURN CODE OF 12 INDICATES VOLUME COULD NOT BE @Y30LB31*/ 03754000
*/*          ACTIVATED.                                      @Y30LB31*/ 03755000
*/*                                                          @Y30LB31*/ 03756000
*/********************************************************** @Y30LB31*/ 03757000
*                                                                  1087 03758000
*UNIQVRTN:                                                         1087 03759000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 03760000
*                                                                  1087 03761000
UNIQVRTN DS    0H                                                  1088 03762000
*   /*****************************************************************/ 03763000
*   /*                                                               */ 03764000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 03765000
*   /*                                                               */ 03766000
*   /*****************************************************************/ 03767000
*                                                                  1088 03768000
*   DCL                                                            1088 03769000
*     UNIQVRC FIXED(15);            /*                       @Y30LB31*/ 03770000
*                                                                  1088 03771000
*   /*****************************************************************/ 03772000
*   /*                                                               */ 03773000
*   /* SAVE CALLERS RETURN ADDRESS SINCE THERE IS NO FULL    @Y30LB31*/ 03774000
*   /* SAVEAREA AND AUTOMATIC SAVING OF REGISTERS.           @Y30LB31*/ 03775000
*   /*                                                               */ 03776000
*   /*****************************************************************/ 03777000
*                                                                  1089 03778000
*   RESPECIFY                                                      1089 03779000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 03780000
*   RETADDR1=REG14;                 /*                       @Y30LB31*/ 03781000
         ST    REG14,RETADDR1                                      1090 03782000
*   RESPECIFY                                                      1091 03783000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 03784000
*   OLDERID2=NEWERID2;                                             1092 03785000
         L     @02,@PC00001                                        1092 03786000
         L     @02,GDTTR2(,@02)                                    1092 03787000
         MVC   @TS00001(95),NEWERID2(@02)                          1092 03788000
         MVC   OLDERID2(95,@02),@TS00001                           1092 03789000
*   NEWID2='AVUQ';                  /*                       @Y30LB31*/ 03790000
*                                                                  1093 03791000
         MVC   NEWID2(4,@02),@CC01854                              1093 03792000
*   /*****************************************************************/ 03793000
*   /*                                                               */ 03794000
*   /* INITIALIZE TO ZERO THE CONDITION CODE SET BY THIS     @Y30LB31*/ 03795000
*   /* PROCEDURE.                                            @Y30LB31*/ 03796000
*   /*                                                               */ 03797000
*   /*****************************************************************/ 03798000
*                                                                  1094 03799000
*   UNIQVRC=LASTCC00;               /*                       @Y30LB31*/ 03800000
*                                                                  1094 03801000
         SLR   @02,@02                                             1094 03802000
         STH   @02,UNIQVRC                                         1094 03803000
*   /*****************************************************************/ 03804000
*   /*                                                               */ 03805000
*   /* ACTIVATE THE VOLUME AND IF NOT ALREADY OBTAINED BY    @Y30LB31*/ 03806000
*   /* SETUPRTN DETERMINE THE CURRENT ATTRIBUTES OF THE VOL FROM THE */ 03807000
*   /* MESSAGE DATA RETURNED FROM THE ACTIVATE OPERATION.    @Y30LB31*/ 03808000
*   /*                                                               */ 03809000
*   /*****************************************************************/ 03810000
*                                                                  1095 03811000
*   CALL ADDRTN;                    /*                       @Y30LB31*/ 03812000
         BAL   @14,ADDRTN                                          1095 03813000
*   RESPECIFY                                                      1096 03814000
*     RTNREG RSTD;                                                 1096 03815000
*   TESTRC=RTNREG;                                                 1097 03816000
         LR    TESTRC,RTNREG                                       1097 03817000
*   RESPECIFY                                                      1098 03818000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 03819000
*                                                                  1098 03820000
*   /*****************************************************************/ 03821000
*   /*                                                               */ 03822000
*   /* IF AN ERROR WAS ENCOUNTERED WHILE ACTIVATING THE VOL, @Y30LB31*/ 03823000
*   /* THE VOLUME PROCESSING IS DISCONTINUED.                @Y30LB31*/ 03824000
*   /*                                                               */ 03825000
*   /*****************************************************************/ 03826000
*                                                                  1099 03827000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 03828000
         LTR   TESTRC,TESTRC                                       1099 03829000
         BZ    @RF01099                                            1099 03830000
*     IF TESTRC=LASTCC08 THEN       /*                       @Y30LB31*/ 03831000
         LA    @02,8                                               1100 03832000
         CR    TESTRC,@02                                          1100 03833000
         BNE   @RF01100                                            1100 03834000
*       UNIQVRC=LASTCC08;           /* VOL IS ACTIVE         @Y30LB31*/ 03835000
         STH   @02,UNIQVRC                                         1101 03836000
*     ELSE                          /*                       @Y30LB31*/ 03837000
*       UNIQVRC=LASTCC12;           /* VOL IS NOT ACTIVE     @Y30LB31*/ 03838000
         B     @RC01100                                            1102 03839000
@RF01100 MVC   UNIQVRC(2),@CH00606                                 1102 03840000
*                                                                  1103 03841000
*   /*****************************************************************/ 03842000
*   /*                                                               */ 03843000
*   /* CONTINUE PROCESSING IF A NEW VOLUME SERIAL NO. IS     @Y30LB31*/ 03844000
*   /* SPECIFIED AND NO ERRORS HAVE BEEN ENCOUNTERED.        @Y30LB31*/ 03845000
*   /*                                                               */ 03846000
*   /*****************************************************************/ 03847000
*                                                                  1103 03848000
*   IF ADDR(NSER)^=NULLPTR&UNIQVRC=0 THEN/*                  @Y30LB31*/ 03849000
@RC01100 DS    0H                                                  1103 03850000
@RF01099 SLR   @15,@15                                             1103 03851000
         L     @14,@PC00001+4                                      1103 03852000
         C     @15,FDTPTR+20(,@14)                                 1103 03853000
         BE    @RF01103                                            1103 03854000
         CH    @15,UNIQVRC                                         1103 03855000
         BNE   @RF01103                                            1103 03856000
*     DO;                           /*                       @Y30LB31*/ 03857000
*                                                                  1104 03858000
*       /*************************************************************/ 03859000
*       /*                                                           */ 03860000
*       /* UNLESS THE ORIGINAL VOLUME SERIAL NO. IS BEING    @Y30LB31*/ 03861000
*       /* RESTORED, VERIFY THAT THE VOLUME IS NONVSAM AND PASSWORD  */ 03862000
*       /*                                                   @Y30LB31*/ 03863000
*       /* CHECK THE PROTECTED DATASETS.                     @Y30LB31*/ 03864000
*       /*                                                           */ 03865000
*       /*************************************************************/ 03866000
*                                                                  1105 03867000
*       IF BRECOVSW=OFF THEN        /*                       @Y30LB31*/ 03868000
         TM    BRECOVSW,B'00000001'                                1105 03869000
         BNZ   @RF01105                                            1105 03870000
*         DO;                       /*                       @Y30LB31*/ 03871000
*           CALL SECCKRTN;          /*                       @Y30LB31*/ 03872000
         BAL   @14,SECCKRTN                                        1107 03873000
*           RESPECIFY                                              1108 03874000
*             RTNREG RSTD;                                         1108 03875000
*           TESTRC=RTNREG;                                         1109 03876000
         LR    TESTRC,RTNREG                                       1109 03877000
*           RESPECIFY                                              1110 03878000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 03879000
*                                                                  1110 03880000
*           /*********************************************************/ 03881000
*           /*                                                       */ 03882000
*           /* EXIT FROM THIS PROCEDURE IF THE SECURITY CHECK        */ 03883000
*           /*                                               @Y30LB31*/ 03884000
*           /* FAILED. THE CONDITION CODE IS SET TO 8 BECAUSE THE    */ 03885000
*           /* VOLUME HAS BEEN ACTIVATED.                    @Y30LB31*/ 03886000
*           /*                                                       */ 03887000
*           /*********************************************************/ 03888000
*                                                                  1111 03889000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 03890000
         LTR   TESTRC,TESTRC                                       1111 03891000
         BZ    @RF01111                                            1111 03892000
*             UNIQVRC=LASTCC08;     /*                       @Y30LB31*/ 03893000
         MVC   UNIQVRC(2),@CH00182                                 1112 03894000
*         END;                      /*                       @Y30LB31*/ 03895000
*                                                                  1113 03896000
@RF01111 DS    0H                                                  1114 03897000
*       /*************************************************************/ 03898000
*       /*                                                           */ 03899000
*       /* UPDATE THE CARTRIDGE LABELS WITH THE NEW VOLUME   @Y30LB31*/ 03900000
*       /* SERIAL NO. THEN ACTIVATE THE VOLUME AGAIN SINCE THE CART  */ 03901000
*       /*                                                   @Y30LB31*/ 03902000
*       /* LABEL UPDATE ALSO DEACTIVATED THE VOLUME. CALL CLABLRTN TO*/ 03903000
*       /* DIRECT THESE OPERATIONS.                          @Y30LB31*/ 03904000
*       /*                                                           */ 03905000
*       /*************************************************************/ 03906000
*                                                                  1114 03907000
*       IF UNIQVRC=0 THEN           /*                       @Y30LB31*/ 03908000
@RF01105 LH    @15,UNIQVRC                                         1114 03909000
         LTR   @15,@15                                             1114 03910000
         BNZ   @RF01114                                            1114 03911000
*         DO;                       /*                       @Y30LB31*/ 03912000
*           CALL CLABLRTN;          /*                       @Y30LB31*/ 03913000
         BAL   @14,CLABLRTN                                        1116 03914000
*           RESPECIFY                                              1117 03915000
*             RTNREG RSTD;                                         1117 03916000
*           TESTRC=RTNREG;                                         1118 03917000
         LR    TESTRC,RTNREG                                       1118 03918000
*           RESPECIFY                                              1119 03919000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 03920000
*                                                                  1119 03921000
*           /*********************************************************/ 03922000
*           /*                                                       */ 03923000
*           /* TEST THE RETURN CODE FROM CLABLRTN. IF AN     @Y30LB31*/ 03924000
*           /* ERROR OCCURRED, SET THE CONDITION CODE ACCORDING TO   */ 03925000
*           /* THE                                           @Y30LB31*/ 03926000
*           /* ACTIVE OR INACTIVE STATUS OF THE VOL.         @Y30LB31*/ 03927000
*           /*                                                       */ 03928000
*           /*********************************************************/ 03929000
*                                                                  1120 03930000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 03931000
         LTR   TESTRC,TESTRC                                       1120 03932000
         BZ    @RF01120                                            1120 03933000
*             IF TESTRC=LASTCC04 THEN/*                      @Y30LB31*/ 03934000
*                                                                  1121 03935000
         C     TESTRC,@CF00043                                     1121 03936000
         BNE   @RF01121                                            1121 03937000
*               /*****************************************************/ 03938000
*               /*                                                   */ 03939000
*               /* IF THE PRELIMINARY ACTIVATE AND SECURITY  @Y30LB31*/ 03940000
*               /* CHECK WERE BYPASSED, THE VOLUME HAS NOT BEEN      */ 03941000
*               /* ACTIVATED.                                @Y30LB31*/ 03942000
*               /*                                                   */ 03943000
*               /*****************************************************/ 03944000
*                                                                  1122 03945000
*               IF BRECOVSW=ON THEN /*                       @Y30LB31*/ 03946000
         TM    BRECOVSW,B'00000001'                                1122 03947000
         BNO   @RF01122                                            1122 03948000
*                 UNIQVRC=LASTCC12; /*                       @Y30LB31*/ 03949000
*                                                                  1123 03950000
         MVC   UNIQVRC(2),@CH00606                                 1123 03951000
*           /*********************************************************/ 03952000
*           /*                                                       */ 03953000
*           /* ALTHOUGH THE CART LABEL UPDATE FAILED         @Y30LB31*/ 03954000
*           /* THE VOL THAT HAS BEEN ACTIVATED. ISSUE MESSAGE        */ 03955000
*           /* IDC0724I INDICATING THE VOLUME SERIAL NO. COULD NOT BE*/ 03956000
*           /* CHANGED.                                      @Y30LB31*/ 03957000
*           /*                                                       */ 03958000
*           /*********************************************************/ 03959000
*                                                                  1124 03960000
*               ELSE                /*                       @Y30LB31*/ 03961000
*                 DO;               /*                       @Y30LB31*/ 03962000
         B     @RC01122                                            1124 03963000
@RF01122 DS    0H                                                  1125 03964000
*                   UNIQVRC=LASTCC08;/*                      @Y30LB31*/ 03965000
         MVC   UNIQVRC(2),@CH00182                                 1125 03966000
*                   PRINTTBL=''B;   /*                       @Y30LB31*/ 03967000
         XC    PRINTTBL(28),PRINTTBL                               1126 03968000
*                   DARGSMOD=ADDVMSGS;/*                     @Y30LB31*/ 03969000
         L     @15,DDSTRU                                          1127 03970000
         MVC   DARGSMOD(3,@15),@CC01687                            1127 03971000
*                   DARGSENT=MSG0724I;/* STID=AV05           @Y30LB31*/ 03972000
         MVI   DARGSENT(@15),X'05'                                 1128 03973000
*                   DARGDBP=ADDR(MSVIVOL#);/*                @Y30LB31*/ 03974000
         LA    @14,MSVIVOL#                                        1129 03975000
         ST    @14,DARGDBP(,@15)                                   1129 03976000
*                   DARGILP=LENGTH(MSVIVOL#);/*              @Y30LB31*/ 03977000
         MVC   DARGILP(2,@15),@CH00159                             1130 03978000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB31*/ 03979000
         L     @15,@PC00001                                        1131 03980000
         ST    @15,@AL00001                                        1131 03981000
         LA    @14,@CF00117                                        1131 03982000
         ST    @14,@AL00001+4                                      1131 03983000
         LA    @14,DDSTRU                                          1131 03984000
         ST    @14,@AL00001+8                                      1131 03985000
         MVI   @AL00001+8,X'80'                                    1131 03986000
         L     @15,GDTPRT(,@15)                                    1131 03987000
         LA    @01,@AL00001                                        1131 03988000
         BALR  @14,@15                                             1131 03989000
*                 END;              /*                       @Y30LB31*/ 03990000
*                                                                  1132 03991000
*           /*********************************************************/ 03992000
*           /*                                                       */ 03993000
*           /* THE VOLUME COULD NOT BE ACTIVATED FOLLOWING   @Y30LB31*/ 03994000
*           /* THE CART LABEL UPDATE.                        @Y30LB31*/ 03995000
*           /*                                                       */ 03996000
*           /*********************************************************/ 03997000
*                                                                  1133 03998000
*             ELSE                  /*                       @Y30LB31*/ 03999000
*               UNIQVRC=LASTCC12;   /*                       @Y30LB31*/ 04000000
*                                                                  1133 04001000
         B     @RC01121                                            1133 04002000
@RF01121 MVC   UNIQVRC(2),@CH00606                                 1133 04003000
*           /*********************************************************/ 04004000
*           /*                                                       */ 04005000
*           /* FOLLOWING THE CART LABEL UPDATE PROCEED TO    @Y30LB31*/ 04006000
*           /* CHANGE THE VOLUME SERIAL NO. IN THE VOLUME LABEL &    */ 04007000
*           /* CLEAR                                         @Y30LB31*/ 04008000
*           /* THE SERIAL-MISMATCH FLAG FROM THE INVENTORY. ALSO SET */ 04009000
*           /*                                               @Y30LB31*/ 04010000
*           /* READONLY ATTRIBUTE IF NEC. CALL VLABLRTN TO DIRECT    */ 04011000
*           /* THESE                                         @Y30LB31*/ 04012000
*           /* OPERATIONS.                                   @Y30LB31*/ 04013000
*           /*                                                       */ 04014000
*           /*********************************************************/ 04015000
*                                                                  1134 04016000
*           ELSE                    /*                       @Y30LB31*/ 04017000
*             DO;                   /*                       @Y30LB31*/ 04018000
         B     @RC01120                                            1134 04019000
@RF01120 DS    0H                                                  1135 04020000
*               CALL VLABLRTN;      /*                       @Y30LB31*/ 04021000
         BAL   @14,VLABLRTN                                        1135 04022000
*               RESPECIFY                                          1136 04023000
*                 RTNREG RSTD;                                     1136 04024000
*               TESTRC=RTNREG;                                     1137 04025000
         LR    TESTRC,RTNREG                                       1137 04026000
*               RESPECIFY                                          1138 04027000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 04028000
*                                                                  1138 04029000
*               /*****************************************************/ 04030000
*               /*                                                   */ 04031000
*               /* SET THE COND CODE TO 8 IF THE VOL LABEL   @Y30LB31*/ 04032000
*               /* UPDATE FAILED BECAUSE THE VOL IS ACTIVE, ALTHOUGH */ 04033000
*               /* NOT FULLY RELABELED.                      @Y30LB31*/ 04034000
*               /*                                                   */ 04035000
*               /*****************************************************/ 04036000
*                                                                  1139 04037000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 04038000
         LTR   TESTRC,TESTRC                                       1139 04039000
         BZ    @RF01139                                            1139 04040000
*                 UNIQVRC=LASTCC08; /*                       @Y30LB31*/ 04041000
         MVC   UNIQVRC(2),@CH00182                                 1140 04042000
*             END;                  /*                       @Y30LB31*/ 04043000
*                                                                  1141 04044000
@RF01139 DS    0H                                                  1142 04045000
*           /*********************************************************/ 04046000
*           /*                                                       */ 04047000
*           /* CLOSE DO GROUP WHICH DIRECTED THE UPDATE OF   @Y30LB31*/ 04048000
*           /* BOTH CART AND VOL LABELS.                     @Y30LB31*/ 04049000
*           /*                                                       */ 04050000
*           /*********************************************************/ 04051000
*                                                                  1142 04052000
*         END;                      /*                       @Y30LB31*/ 04053000
*                                                                  1142 04054000
@RC01120 DS    0H                                                  1143 04055000
*       /*************************************************************/ 04056000
*       /*                                                           */ 04057000
*       /* CLOSE THE DO GROUP WHICH PROCESSED THE NEW VOLUME @Y30LB31*/ 04058000
*       /* SERIAL NO.                                        @Y30LB31*/ 04059000
*       /*                                                           */ 04060000
*       /*************************************************************/ 04061000
*                                                                  1143 04062000
*     END;                          /*                       @Y30LB31*/ 04063000
@RF01114 DS    0H                                                  1144 04064000
*                                                                  1144 04065000
*   /*****************************************************************/ 04066000
*   /*                                                               */ 04067000
*   /* ISSUE AN INFORMATIVE MESSAGE IF THE VOLUME HAS BEEN   @Y30LB31*/ 04068000
*   /* ACTIVATED ALTHOUGH ALL FUNCTION COULD NOT BE COMPLETED.       */ 04069000
*   /*                                                       @Y30LB31*/ 04070000
*   /*                                                               */ 04071000
*   /*****************************************************************/ 04072000
*                                                                  1144 04073000
*   IF(ADDR(NSER)=NULLPTR&UNIQVRC=0)|/*                      @Y30LB31*/ 04074000
*       UNIQVRC=LASTCC08 THEN       /*                       @Y30LB31*/ 04075000
@RF01103 SLR   @15,@15                                             1144 04076000
         L     @14,@PC00001+4                                      1144 04077000
         C     @15,FDTPTR+20(,@14)                                 1144 04078000
         BNE   @GL00036                                            1144 04079000
         CH    @15,UNIQVRC                                         1144 04080000
         BE    @RT01144                                            1144 04081000
@GL00036 CLC   UNIQVRC(2),@CH00182                                 1144 04082000
         BNE   @RF01144                                            1144 04083000
@RT01144 DS    0H                                                  1145 04084000
*     DO;                           /*                       @Y30LB31*/ 04085000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 04086000
         XC    PRINTTBL(28),PRINTTBL                               1146 04087000
*       DARGSMOD=ADDVMSGS;          /*                       @Y30LB31*/ 04088000
         L     @15,DDSTRU                                          1147 04089000
         MVC   DARGSMOD(3,@15),@CC01687                            1147 04090000
*       DARGSENT=MSG0722I;          /* STID = AV03           @Y30LB31*/ 04091000
         MVI   DARGSENT(@15),X'03'                                 1148 04092000
*       DARGDBP=ADDR(MSVIVOL#);     /*                       @Y30LB31*/ 04093000
         LA    @14,MSVIVOL#                                        1149 04094000
         ST    @14,DARGDBP(,@15)                                   1149 04095000
*       DARGILP=LENGTH(MSVIVOL#);   /*                       @Y30LB31*/ 04096000
         MVC   DARGILP(2,@15),@CH00159                             1150 04097000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 04098000
         L     @15,@PC00001                                        1151 04099000
         ST    @15,@AL00001                                        1151 04100000
         LA    @14,@CF00117                                        1151 04101000
         ST    @14,@AL00001+4                                      1151 04102000
         LA    @14,DDSTRU                                          1151 04103000
         ST    @14,@AL00001+8                                      1151 04104000
         MVI   @AL00001+8,X'80'                                    1151 04105000
         L     @15,GDTPRT(,@15)                                    1151 04106000
         LA    @01,@AL00001                                        1151 04107000
         BALR  @14,@15                                             1151 04108000
*     END;                          /*                       @Y30LB31*/ 04109000
*                                                                  1152 04110000
*   /*****************************************************************/ 04111000
*   /*                                                               */ 04112000
*   /* RESTORE REGISTER 14 WITH THE RETURN ADDRESS OF THE    @Y30LB31*/ 04113000
*   /* CALLER AND EXIT FROM UNIQVRTN. PASS THE CONDITION CODE IN     */ 04114000
*   /* REGISTER 15.                                          @Y30LB31*/ 04115000
*   /*                                                               */ 04116000
*   /*****************************************************************/ 04117000
*                                                                  1153 04118000
*   RESPECIFY                                                      1153 04119000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 04120000
@RF01144 DS    0H                                                  1154 04121000
*   REG14=RETADDR1;                 /*                       @Y30LB31*/ 04122000
         L     REG14,RETADDR1                                      1154 04123000
*   RESPECIFY                                                      1155 04124000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 04125000
*   RETURN CODE(UNIQVRC);           /*                       @Y30LB31*/ 04126000
         LH    @15,UNIQVRC                                         1156 04127000
@EL00009 DS    0H                                                  1156 04128000
@EF00009 DS    0H                                                  1156 04129000
@ER00009 BR    @14                                                 1156 04130000
*   END UNIQVRTN;                   /*                       @Y30LB31*/ 04131000
*                                                                  1158 04132000
*/********************************************************** @Y30LB31*/ 04133000
*/*                                                          @Y30LB31*/ 04134000
*/* PROCEDURE NAME - ADDRTN                                  @Y30LB31*/ 04135000
*/*                                                          @Y30LB31*/ 04136000
*/* FUNCTION -  CALLS ACTVRTN TO ACTIVATE THE VOLUME         @Y30LB31*/ 04137000
*/*            UNLESS THE ORIGINAL SERIAL NO. OF A BASE      @Y30LB31*/ 04138000
*/*            VOLUME IS BEING RESTORED.  THEN               @Y30LB31*/ 04139000
*/*             DETERMINES WHETHER THE VOLUME ATTRIBUTES     @Y30LB31*/ 04140000
*/*             MUST BE UPDATED AND CALLS NEWVFTN TO CHANGE  @Y30LB31*/ 04141000
*/*             THE ATTRIBUTES.  NO MESSAGES ARE ISSUED IN   @Y30LB31*/ 04142000
*/*             THIS PROCEDURE.                              @Y30LB31*/ 04143000
*/*                                                          @Y30LB31*/ 04144000
*/* INPUT - FDTTBL, ADDVTBL, BASEV, CMMSG, GROUP          @Y30LB31   */ 04145000
*/*                                                          @Y30LB31*/ 04146000
*/* OUTPUT -  RETURN CODE OF 0 INDICATES 1) VOLUME ACTIVATED @Y30LB31*/ 04147000
*/*           AND ATTRIBUTES UPDATED, IF REQUIRED.         @Y30LB31  */ 04148000
*/*          OR 2) IF THE ORIGINAL VOLUME SERIAL NO. IS      @Y30LB31*/ 04149000
*/*          BEING RESTORED, THE CURRENT VOL ATTRIBUTES      @Y30LB31*/ 04150000
*/*          WERE CHECKED FOR UPDATE.                       @Y30LB31 */ 04151000
*/*           RETURN CODE OF 4 INDICATES VOLUME COULD NOT BE @Y30LB31*/ 04152000
*/*           ACTIVATED.                                     @Y30LB31*/ 04153000
*/*           RETURN CODE OF 8 INDICATES VOLUME IS ACTIVE    @Y30LB31*/ 04154000
*/*           BUT ATTRIBUTES COULD NOT BE UPDATED.           @Y30LB31*/ 04155000
*/*                                                          @Y30LB31*/ 04156000
*/********************************************************** @Y30LB31*/ 04157000
*                                                                  1158 04158000
*ADDRTN:                                                           1158 04159000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 04160000
*                                                                  1158 04161000
ADDRTN   DS    0H                                                  1159 04162000
*   /*****************************************************************/ 04163000
*   /*                                                               */ 04164000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 04165000
*   /*                                                               */ 04166000
*   /*****************************************************************/ 04167000
*                                                                  1159 04168000
*   DCL                                                            1159 04169000
*     ADDRC FIXED(15);              /*                       @Y30LB31*/ 04170000
*                                                                  1159 04171000
*   /*****************************************************************/ 04172000
*   /*                                                               */ 04173000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 04174000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 04175000
*   /*                                                               */ 04176000
*   /*****************************************************************/ 04177000
*                                                                  1160 04178000
*   RESPECIFY                                                      1160 04179000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 04180000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 04181000
         ST    REG14,RETADDR2                                      1161 04182000
*   RESPECIFY                                                      1162 04183000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 04184000
*   OLDERID2=NEWERID2;                                             1163 04185000
         L     @05,@PC00001                                        1163 04186000
         L     @05,GDTTR2(,@05)                                    1163 04187000
         MVC   @TS00001(95),NEWERID2(@05)                          1163 04188000
         MVC   OLDERID2(95,@05),@TS00001                           1163 04189000
*   NEWID2='AVAD';                  /*                       @Y30LB31*/ 04190000
*                                                                  1164 04191000
         MVC   NEWID2(4,@05),@CC01863                              1164 04192000
*   /*****************************************************************/ 04193000
*   /*                                                               */ 04194000
*   /* ZERO THE CONDITION CODE USED IN THIS PROCEDURE.       @Y30LB31*/ 04195000
*   /*                                                               */ 04196000
*   /*****************************************************************/ 04197000
*                                                                  1165 04198000
*   ADDRC=LASTCC00;                 /*                       @Y30LB31*/ 04199000
*                                                                  1165 04200000
         SLR   @02,@02                                             1165 04201000
         LR    ADDRC,@02                                           1165 04202000
*   /*****************************************************************/ 04203000
*   /*                                                               */ 04204000
*   /* BYPASS THE ACTIVATE AND SECURITY CHECK                @Y30LB31*/ 04205000
*   /* IF THE ORIGINAL VOLUME SERIAL NO. IS BEING RESTORED. MERELY,  */ 04206000
*   /* DETERMINE WHETHER THE CURRENT VOLUME ATTRIBUTES MUST BE       */ 04207000
*   /* UPDATED.                                              @Y30LB31*/ 04208000
*   /*                                                               */ 04209000
*   /*****************************************************************/ 04210000
*                                                                  1166 04211000
*   IF ADDR(NSER)^=NULLPTR&BCDVSMIS=ON&/*                    @Y30LB31*/ 04212000
*       NSERVAL=BASRECOV THEN       /*                       @Y30LB31*/ 04213000
         L     @05,@PC00001+4                                      1166 04214000
         L     @05,FDTPTR+20(,@05)                                 1166 04215000
         CR    @05,@02                                             1166 04216000
         BE    @RF01166                                            1166 04217000
         TM    BCDVSMIS(BCDVPTR),B'00100000'                       1166 04218000
         BNO   @RF01166                                            1166 04219000
         CLC   NSERVAL(6,@05),BASRECOV(BASEVPTR)                   1166 04220000
         BNE   @RF01166                                            1166 04221000
*     BRECOVSW=ON;                  /*                       @Y30LB31*/ 04222000
         OI    BRECOVSW,B'00000001'                                1167 04223000
*   ELSE                            /*                       @Y30LB31*/ 04224000
*     DO;                           /*                       @Y30LB31*/ 04225000
*                                                                  1168 04226000
         B     @RC01166                                            1168 04227000
@RF01166 DS    0H                                                  1169 04228000
*       /*************************************************************/ 04229000
*       /*                                                           */ 04230000
*       /* ACTIVATE THE VOLUME AND IF THE VOLUME SERIAL NO IS        */ 04231000
*       /*                                                   @Y30LB31*/ 04232000
*       /* NOT BEING CHANGED, SAVE THE CURRENT VOLUME ATTRIBUTES AS  */ 04233000
*       /* IDENTIFIED IN THE ACTIVATE MESSAGE.               @Y30LB31*/ 04234000
*       /*                                                           */ 04235000
*       /*************************************************************/ 04236000
*                                                                  1169 04237000
*       IF ADDR(NSER)=NULLPTR THEN  /*                       @Y30LB31*/ 04238000
         L     @05,@PC00001+4                                      1169 04239000
         L     @05,FDTPTR+20(,@05)                                 1169 04240000
         LTR   @05,@05                                             1169 04241000
         BNZ   @RF01169                                            1169 04242000
*         MSGFLG=ON;                /*                       @Y30LB31*/ 04243000
         OI    MSGFLG,B'00010000'                                  1170 04244000
*       ELSE                        /*                       @Y30LB31*/ 04245000
*         MSGFLG=OFF;               /*                       @Y30LB31*/ 04246000
         B     @RC01169                                            1171 04247000
@RF01169 NI    MSGFLG,B'11101111'                                  1171 04248000
*       CALL ACTVRTN;               /*                       @Y30LB31*/ 04249000
@RC01169 BAL   @14,ACTVRTN                                         1172 04250000
*       RESPECIFY                                                  1173 04251000
*         RTNREG RSTD;                                             1173 04252000
*       TESTRC=RTNREG;                                             1174 04253000
         LR    TESTRC,RTNREG                                       1174 04254000
*       RESPECIFY                                                  1175 04255000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 04256000
*                                                                  1175 04257000
*       /*************************************************************/ 04258000
*       /*                                                           */ 04259000
*       /* TEST RETURN CODE FROM ACTVRTN. IF THE ACTIVATE    @Y30LB31*/ 04260000
*       /* FAILED, EXIT FROM THIS PROCEDURE WITH AN ERROR COND CODE. */ 04261000
*       /*                                                   @Y30LB31*/ 04262000
*       /*                                                           */ 04263000
*       /*************************************************************/ 04264000
*                                                                  1176 04265000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 04266000
         LTR   TESTRC,TESTRC                                       1176 04267000
         BZ    @RF01176                                            1176 04268000
*         ADDRC=4;                  /*                       @Y30LB31*/ 04269000
*                                                                  1177 04270000
         LA    ADDRC,4                                             1177 04271000
*       /*************************************************************/ 04272000
*       /*                                                           */ 04273000
*       /* THE VOLUME IS NOW ACTIVE. SAVE THE VOLUME ATTRIBUTES      */ 04274000
*       /*                                                   @Y30LB31*/ 04275000
*       /* FROM THE MSSC ACTIVATE MSG IF THE MSG WAS RETURNED. THEN  */ 04276000
*       /* RELEASE THE MESSAGE STOREAGE AREA. NOTE THAT IDCAV01 SET  */ 04277000
*       /* THE DEFAULT ATTRIBUTE VALUES.                     @Y30LB31*/ 04278000
*       /*                                                           */ 04279000
*       /*************************************************************/ 04280000
*                                                                  1178 04281000
*       ELSE                        /*                       @Y30LB31*/ 04282000
*         IF MSGFLG=ON THEN         /*                       @Y30LB31*/ 04283000
         B     @RC01176                                            1178 04284000
@RF01176 TM    MSGFLG,B'00010000'                                  1178 04285000
         BNO   @RF01178                                            1178 04286000
*           DO;                     /*                       @Y30LB31*/ 04287000
*             CMMSGPTR=ECBMSPTR+ECBLEN;/*                    @Y30LB31*/ 04288000
         LA    CMMSGPTR,4                                          1180 04289000
         AL    CMMSGPTR,ECBMSPTR                                   1180 04290000
*             IF CMDERAS=ON THEN    /*                       @Y30LB31*/ 04291000
         TM    CMDERAS(CMMSGPTR),B'00100000'                       1181 04292000
         BNO   @RF01181                                            1181 04293000
*               OLDDEFLG=ON;        /*                       @Y30LB31*/ 04294000
         OI    OLDDEFLG,B'01000000'                                1182 04295000
*             IF CMEXCL=ON THEN     /*                       @Y30LB31*/ 04296000
@RF01181 TM    CMEXCL(CMMSGPTR),B'00010000'                        1183 04297000
         BNO   @RF01183                                            1183 04298000
*               OLDEXFLG=ON;        /*                       @Y30LB31*/ 04299000
         OI    OLDEXFLG,B'00100000'                                1184 04300000
*             IF CMBIND=ON THEN     /*                       @Y30LB31*/ 04301000
@RF01183 TM    CMBIND(CMMSGPTR),B'00000100'                        1185 04302000
         BNO   @RF01185                                            1185 04303000
*               OLDBIFLG=ON;        /*                       @Y30LB31*/ 04304000
         OI    OLDBIFLG,B'10000000'                                1186 04305000
*             IF CMRONLY=ON THEN    /*                       @Y30LB31*/ 04306000
@RF01185 TM    CMRONLY(CMMSGPTR),B'00000010'                       1187 04307000
         BNO   @RF01187                                            1187 04308000
*               OLDROFLG=ON;        /*                       @Y30LB31*/ 04309000
         OI    OLDROFLG,B'00010000'                                1188 04310000
*             CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*              @Y30LB31*/ 04311000
@RF01187 L     @05,@PC00001                                        1189 04312000
         ST    @05,@AL00001                                        1189 04313000
         LA    @02,ECBMSPTR                                        1189 04314000
         ST    @02,@AL00001+4                                      1189 04315000
         L     @15,GDTFSP(,@05)                                    1189 04316000
         LA    @01,@AL00001                                        1189 04317000
         BALR  @14,@15                                             1189 04318000
*           END;                    /*                       @Y30LB31*/ 04319000
*                                                                  1190 04320000
*       /*************************************************************/ 04321000
*       /*                                                           */ 04322000
*       /* CLOSE DO GROUP WHICH DIRECTS THE VOLUME ACTIVATE. @Y30LB31*/ 04323000
*       /*                                                           */ 04324000
*       /*************************************************************/ 04325000
*                                                                  1191 04326000
*     END;                          /*                       @Y30LB31*/ 04327000
*                                                                  1191 04328000
@RF01178 DS    0H                                                  1191 04329000
@RC01176 DS    0H                                                  1192 04330000
*   /*****************************************************************/ 04331000
*   /*                                                               */ 04332000
*   /* IF THE BASE VOLUME BEING ACTIVATED IS GENERAL-USE     @G24LB23*/ 04333000
*   /* AND NEW SERIAL IS NOT SPECIFIED, THE VOLUME IS NOT GOING TO BE*/ 04334000
*   /* MOUNTED. THEREFORE CALL DLSPRTN TO DETERMINE IF VOLUME SHOULD */ 04335000
*   /* BE MOUNTED.                                           @G24LB23*/ 04336000
*   /*                                                               */ 04337000
*   /*****************************************************************/ 04338000
*                                                                  1192 04339000
*   IF ADDR(NSER)=NULLPTR&BASGENUS=ON&ADDRC=0 THEN/*         @G24LB23*/ 04340000
@RC01166 SLR   @05,@05                                             1192 04341000
         L     @02,@PC00001+4                                      1192 04342000
         C     @05,FDTPTR+20(,@02)                                 1192 04343000
         BNE   @RF01192                                            1192 04344000
         TM    BASGENUS(BASEVPTR),B'00010000'                      1192 04345000
         BNO   @RF01192                                            1192 04346000
         CR    ADDRC,@05                                           1192 04347000
         BNE   @RF01192                                            1192 04348000
*     DO;                           /*                       @G24LB23*/ 04349000
*       CALL DLSPRTN;               /*                       @G24LB23*/ 04350000
*                                                                  1194 04351000
         BAL   @14,DLSPRTN                                         1194 04352000
*       /*************************************************************/ 04353000
*       /*                                                           */ 04354000
*       /* TEST RETURN CODE. IF BAD RETURN, EXIT FROM THIS   @G24LB23*/ 04355000
*       /* PROCEDURE WITH AN ERROR COND CODE.                @G24LB23*/ 04356000
*       /*                                                           */ 04357000
*       /*************************************************************/ 04358000
*                                                                  1195 04359000
*       RESPECIFY                                                  1195 04360000
*         RTNREG RSTD;                                             1195 04361000
*       TESTRC=RTNREG;                                             1196 04362000
         LR    TESTRC,RTNREG                                       1196 04363000
*       RESPECIFY                                                  1197 04364000
*         RTNREG UNRSTD;            /*                       @G24LB23*/ 04365000
*       ADDRC=TESTRC;               /*                       @G24LB23*/ 04366000
         LR    ADDRC,TESTRC                                        1198 04367000
*     END;                          /*                       @G24LB23*/ 04368000
*                                                                  1200 04369000
*   /*****************************************************************/ 04370000
*   /*                                                               */ 04371000
*   /* DETERMINE WHETHER THE CURRENT VOLUME ATTRIBUTES MUST  #Y30LB31*/ 04372000
*   /* BE UPDATED TO AGREE WITH A GROUP OR TO BE CHANGED FROM        */ 04373000
*   /* READONLY BECAUSE READWRITE IS SPECIFIED.              #Y30LB31*/ 04374000
*   /*                                                               */ 04375000
*   /*****************************************************************/ 04376000
*                                                                  1200 04377000
*   IF ADDRC=0 THEN                 /*                       #Y30LB31*/ 04378000
@RF01192 LTR   ADDRC,ADDRC                                         1200 04379000
         BNZ   @RF01200                                            1200 04380000
*     IF BASGENUS=ON THEN           /*                       #Y30LB31*/ 04381000
         TM    BASGENUS(BASEVPTR),B'00010000'                      1201 04382000
         BNO   @RF01201                                            1201 04383000
*       DO;                         /*                       #Y30LB31*/ 04384000
*                                                                  1202 04385000
*         /***********************************************************/ 04386000
*         /*                                                         */ 04387000
*         /* UPDATE THE VOLUME BIND/NOBIND ATTRIBUTE TO      #Y30LB31*/ 04388000
*         /* AGREE WITH THE GROUP.                           @Y30LB31*/ 04389000
*         /*                                                         */ 04390000
*         /***********************************************************/ 04391000
*                                                                  1203 04392000
*         IF GROBIND=OFF&OLDBIFLG=OFF THEN/*                 @Y30LB31*/ 04393000
         L     @05,GROUPPTR                                        1203 04394000
         TM    GROBIND(@05),B'10000000'                            1203 04395000
         BNZ   @RF01203                                            1203 04396000
         TM    OLDBIFLG,B'10000000'                                1203 04397000
         BNZ   @RF01203                                            1203 04398000
*           NEWBIFLG=OFF;           /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04399000
         NI    NEWBIFLG,B'11110111'                                1204 04400000
*         ELSE                      /*                       @Y30LB31*/ 04401000
*           IF GROBIND=ON&OLDBIFLG=ON THEN/*                 @Y30LB31*/ 04402000
         B     @RC01203                                            1205 04403000
@RF01203 L     @05,GROUPPTR                                        1205 04404000
         TM    GROBIND(@05),B'10000000'                            1205 04405000
         BNO   @RF01205                                            1205 04406000
         TM    OLDBIFLG,B'10000000'                                1205 04407000
         BNO   @RF01205                                            1205 04408000
*             NEWBIFLG=ON;          /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04409000
         OI    NEWBIFLG,B'00001000'                                1206 04410000
*           ELSE                    /*                       @Y30LB31*/ 04411000
*             DO;                   /*                       @Y30LB31*/ 04412000
         B     @RC01205                                            1207 04413000
@RF01205 DS    0H                                                  1208 04414000
*               NEWVFFLG=ON;        /*                       @Y30LB31*/ 04415000
*               GRPMSFLG=ON;        /*                       @Y30LB31*/ 04416000
         OI    NEWVFFLG,B'00001010'                                1209 04417000
*               IF GROBIND=OFF THEN /*                       @Y30LB31*/ 04418000
         L     @05,GROUPPTR                                        1210 04419000
         TM    GROBIND(@05),B'10000000'                            1210 04420000
         BNZ   @RF01210                                            1210 04421000
*                 NEWBIFLG=OFF;     /* VOL ATTR CHANGED      @Y30LB31*/ 04422000
         NI    NEWBIFLG,B'11110111'                                1211 04423000
*               ELSE                /*                       @Y30LB31*/ 04424000
*                 NEWBIFLG=ON;      /* VOL ATTR CHANGED      @Y30LB31*/ 04425000
         B     @RC01210                                            1212 04426000
@RF01210 OI    NEWBIFLG,B'00001000'                                1212 04427000
*             END;                  /*                       @Y30LB31*/ 04428000
*                                                                  1213 04429000
@RC01210 DS    0H                                                  1214 04430000
*         /***********************************************************/ 04431000
*         /*                                                         */ 04432000
*         /* UPDATE THE VOLUME DASDERASE/NODASDERASE         @Y30LB31*/ 04433000
*         /* ATTRIBUTE TO AGREE WITH THE GROUP.              @Y30LB31*/ 04434000
*         /*                                                         */ 04435000
*         /***********************************************************/ 04436000
*                                                                  1214 04437000
*         IF GRODAERA=OFF&OLDDEFLG=OFF THEN/*                @Y30LB31*/ 04438000
@RC01205 DS    0H                                                  1214 04439000
@RC01203 L     @05,GROUPPTR                                        1214 04440000
         TM    GRODAERA(@05),B'00100000'                           1214 04441000
         BNZ   @RF01214                                            1214 04442000
         TM    OLDDEFLG,B'01000000'                                1214 04443000
         BNZ   @RF01214                                            1214 04444000
*           NEWDEFLG=OFF;           /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04445000
         NI    NEWDEFLG,B'11111011'                                1215 04446000
*         ELSE                      /*                       @Y30LB31*/ 04447000
*           IF GRODAERA=ON&OLDDEFLG=ON THEN/*                @Y30LB31*/ 04448000
         B     @RC01214                                            1216 04449000
@RF01214 L     @05,GROUPPTR                                        1216 04450000
         TM    GRODAERA(@05),B'00100000'                           1216 04451000
         BNO   @RF01216                                            1216 04452000
         TM    OLDDEFLG,B'01000000'                                1216 04453000
         BNO   @RF01216                                            1216 04454000
*             NEWDEFLG=ON;          /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04455000
         OI    NEWDEFLG,B'00000100'                                1217 04456000
*           ELSE                    /*                       @Y30LB31*/ 04457000
*             DO;                   /*                       @Y30LB31*/ 04458000
         B     @RC01216                                            1218 04459000
@RF01216 DS    0H                                                  1219 04460000
*               NEWVFFLG=ON;        /*                       @Y30LB31*/ 04461000
*               GRPMSFLG=ON;        /*                       @Y30LB31*/ 04462000
         OI    NEWVFFLG,B'00001010'                                1220 04463000
*               IF GRODAERA=OFF THEN/*                       @Y30LB31*/ 04464000
         L     @05,GROUPPTR                                        1221 04465000
         TM    GRODAERA(@05),B'00100000'                           1221 04466000
         BNZ   @RF01221                                            1221 04467000
*                 NEWDEFLG=OFF;     /* VOL ATTR CHANGED      @Y30LB31*/ 04468000
         NI    NEWDEFLG,B'11111011'                                1222 04469000
*               ELSE                /*                       @Y30LB31*/ 04470000
*                 NEWDEFLG=ON;      /* VOL ATTR CHANGED      @Y30LB31*/ 04471000
         B     @RC01221                                            1223 04472000
@RF01221 OI    NEWDEFLG,B'00000100'                                1223 04473000
*             END;                  /*                       @Y30LB31*/ 04474000
*                                                                  1224 04475000
@RC01221 DS    0H                                                  1225 04476000
*         /***********************************************************/ 04477000
*         /*                                                         */ 04478000
*         /* UPDATE THE VOLUME EXCLUSIVE/SHARED ATTRIBUTE TO @Y30LB31*/ 04479000
*         /* AGREE WITH THE GROUP.                           @Y30LB31*/ 04480000
*         /*                                                         */ 04481000
*         /***********************************************************/ 04482000
*                                                                  1225 04483000
*         IF GROEXCL=OFF&OLDEXFLG=OFF THEN/*                 @Y30LB31*/ 04484000
@RC01216 DS    0H                                                  1225 04485000
@RC01214 L     @05,GROUPPTR                                        1225 04486000
         TM    GROEXCL(@05),B'01000000'                            1225 04487000
         BNZ   @RF01225                                            1225 04488000
         TM    OLDEXFLG,B'00100000'                                1225 04489000
         BNZ   @RF01225                                            1225 04490000
*           NEWEXFLG=OFF;           /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04491000
         NI    NEWEXFLG,B'11111101'                                1226 04492000
*         ELSE                      /*                       @Y30LB31*/ 04493000
*           IF GROEXCL=ON&OLDEXFLG=ON THEN/*                 @Y30LB31*/ 04494000
         B     @RC01225                                            1227 04495000
@RF01225 L     @05,GROUPPTR                                        1227 04496000
         TM    GROEXCL(@05),B'01000000'                            1227 04497000
         BNO   @RF01227                                            1227 04498000
         TM    OLDEXFLG,B'00100000'                                1227 04499000
         BNO   @RF01227                                            1227 04500000
*             NEWEXFLG=ON;          /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04501000
         OI    NEWEXFLG,B'00000010'                                1228 04502000
*           ELSE                    /*                       @Y30LB31*/ 04503000
*             DO;                   /*                       @Y30LB31*/ 04504000
         B     @RC01227                                            1229 04505000
@RF01227 DS    0H                                                  1230 04506000
*               NEWVFFLG=ON;        /*                       @Y30LB31*/ 04507000
*               GRPMSFLG=ON;        /*                       @Y30LB31*/ 04508000
         OI    NEWVFFLG,B'00001010'                                1231 04509000
*               IF GROEXCL=OFF THEN /*                       @Y30LB31*/ 04510000
         L     @05,GROUPPTR                                        1232 04511000
         TM    GROEXCL(@05),B'01000000'                            1232 04512000
         BNZ   @RF01232                                            1232 04513000
*                 NEWEXFLG=OFF;     /* CHANGE VOL ATTR       @Y30LB31*/ 04514000
         NI    NEWEXFLG,B'11111101'                                1233 04515000
*               ELSE                /*                       @Y30LB31*/ 04516000
*                 NEWEXFLG=ON;      /* CHANGE VOL ATTR       @Y30LB31*/ 04517000
         B     @RC01232                                            1234 04518000
@RF01232 OI    NEWEXFLG,B'00000010'                                1234 04519000
*             END;                  /*                       @Y30LB31*/ 04520000
*                                                                  1235 04521000
@RC01232 DS    0H                                                  1236 04522000
*         /***********************************************************/ 04523000
*         /*                                                         */ 04524000
*         /* UPDATE THE VOLUME READONLY/READWRITE ATTRIBUTE  @Y30LB31*/ 04525000
*         /* TO AGREE WITH THE GROUP. NOTE. THESE ATTRIBUTES MUST BE */ 04526000
*         /* TESTED LAST BECAUSE SPECIAL SWITCHES DEPEND UPON WHETHER*/ 04527000
*         /* OR NOT VOLUME ATTRIBUTES OTHER THAN READONLY/READWRITE  */ 04528000
*         /* ARE ALSO BEING CHANGED.                         @Y30LB31*/ 04529000
*         /*                                                         */ 04530000
*         /***********************************************************/ 04531000
*                                                                  1236 04532000
*         IF GRORONLY=OFF&OLDROFLG=OFF THEN/*                @Y30LB31*/ 04533000
@RC01227 DS    0H                                                  1236 04534000
@RC01225 L     @05,GROUPPTR                                        1236 04535000
         TM    GRORONLY(@05),B'00010000'                           1236 04536000
         BNZ   @RF01236                                            1236 04537000
         TM    OLDROFLG,B'00010000'                                1236 04538000
         BNZ   @RF01236                                            1236 04539000
*           NEWROFLG=OFF;           /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04540000
         NI    NEWROFLG,B'11111110'                                1237 04541000
*         ELSE                      /*                       @Y30LB31*/ 04542000
*           IF GRORONLY=ON&OLDROFLG=ON THEN/*                @Y30LB31*/ 04543000
         B     @RC01236                                            1238 04544000
@RF01236 L     @05,GROUPPTR                                        1238 04545000
         TM    GRORONLY(@05),B'00010000'                           1238 04546000
         BNO   @RF01238                                            1238 04547000
         TM    OLDROFLG,B'00010000'                                1238 04548000
         BNO   @RF01238                                            1238 04549000
*             NEWROFLG=ON;          /* VOL ATTR NOT CHANGED  @Y30LB31*/ 04550000
         OI    NEWROFLG,B'00000001'                                1239 04551000
*           ELSE                    /*                       @Y30LB31*/ 04552000
*             DO;                   /*                       @Y30LB31*/ 04553000
*                                                                  1240 04554000
         B     @RC01238                                            1240 04555000
@RF01238 DS    0H                                                  1241 04556000
*               /*****************************************************/ 04557000
*               /*                                                   */ 04558000
*               /* SET A SWITCH TO INDICATE                  @Y30LB31*/ 04559000
*               /* MESSAGES IDC0073I OR IDC2725I ARE TO BE ISSUED IF */ 04560000
*               /* THE ATTRIBUTES ARE BEING CHANGED BY DEFAULT TO    */ 04561000
*               /* AGREE WITH THE GROUP. IF READWRITE HAS BEEN       */ 04562000
*               /* SPECIFIED BY THE USER AND IS THE ONLY ATTRIBUTE TO*/ 04563000
*               /* BE SET, THESE MESSAGES ARE NOT ISSUED.    @Y30LB31*/ 04564000
*               /*                                                   */ 04565000
*               /*****************************************************/ 04566000
*                                                                  1241 04567000
*               GRPMSFLG=ON;        /*                       @Y30LB31*/ 04568000
         OI    GRPMSFLG,B'00000010'                                1241 04569000
*               IF GRORONLY=OFF THEN/*                       @Y30LB31*/ 04570000
         L     @05,GROUPPTR                                        1242 04571000
         TM    GRORONLY(@05),B'00010000'                           1242 04572000
         BNZ   @RF01242                                            1242 04573000
*                 DO;               /*                       @Y30LB31*/ 04574000
*                   NEWROFLG=OFF;   /*                       @Y30LB31*/ 04575000
         NI    NEWROFLG,B'11111110'                                1244 04576000
*                   IF NEWVFFLG=OFF&ADDR(RWOPT)^=NULLPTR THEN/*    1245 04577000
*                                                            @Y30LB31*/ 04578000
         TM    NEWVFFLG,B'00001000'                                1245 04579000
         BNZ   @RF01245                                            1245 04580000
         L     @05,@PC00001+4                                      1245 04581000
         L     @05,FDTPTR+24(,@05)                                 1245 04582000
         LTR   @05,@05                                             1245 04583000
         BZ    @RF01245                                            1245 04584000
*                     GRPMSFLG=OFF; /*                       @Y30LB31*/ 04585000
         NI    GRPMSFLG,B'11111101'                                1246 04586000
*                 END;              /*                       @Y30LB31*/ 04587000
*               ELSE                /*                       @Y30LB31*/ 04588000
*                 DO;               /*                       @Y30LB31*/ 04589000
         B     @RC01242                                            1248 04590000
@RF01242 DS    0H                                                  1249 04591000
*                   NEWROFLG=ON;    /*                       @Y30LB31*/ 04592000
*                                                                  1249 04593000
         OI    NEWROFLG,B'00000001'                                1249 04594000
*                   /*************************************************/ 04595000
*                   /*                                               */ 04596000
*                   /* IF READONLY IS THE ONLY ATTRIBUTE BEING SET TO*/ 04597000
*                   /*                                       @Y30LB31*/ 04598000
*                   /* AGREE WITH THE GROUP, SET A SWITCH TO AVOID   */ 04599000
*                   /* ISSUING MESSAGE IDC0073I OR IDC2725I MORE THAN*/ 04600000
*                   /* ONCE DURING PROGRAM EXECUTION.        @Y30LB31*/ 04601000
*                   /*                                               */ 04602000
*                   /*************************************************/ 04603000
*                                                                  1250 04604000
*                   IF NEWVFFLG=OFF THEN/*                   @Y30LB31*/ 04605000
         TM    NEWVFFLG,B'00001000'                                1250 04606000
         BNZ   @RF01250                                            1250 04607000
*                     ONLYROSW=ON;  /*                       @Y30LB31*/ 04608000
         OI    ONLYROSW,B'10000000'                                1251 04609000
*                 END;              /*                       @Y30LB31*/ 04610000
*                                                                  1252 04611000
@RF01250 DS    0H                                                  1253 04612000
*               /*****************************************************/ 04613000
*               /*                                                   */ 04614000
*               /* THE SWITCH THAT INDICATES VOLUME ATTRIBUTES       */ 04615000
*               /*                                           @Y30LB31*/ 04616000
*               /* UST BE UPDATED IS NOT SET UNTIL ALL               */ 04617000
*               /* READONLY/READWRITE SPECIAL CHECKS HAVE BEEN MADE. */ 04618000
*               /*                                           @Y30LB31*/ 04619000
*               /*                                                   */ 04620000
*               /*****************************************************/ 04621000
*                                                                  1253 04622000
*               NEWVFFLG=ON;        /*                       @Y30LB31*/ 04623000
@RC01242 OI    NEWVFFLG,B'00001000'                                1253 04624000
*             END;                  /*                       @Y30LB31*/ 04625000
*                                                                  1254 04626000
*         /***********************************************************/ 04627000
*         /*                                                         */ 04628000
*         /* CLOSE DO GROUP WHICH CONTRASTED VOLUME AND GROUP        */ 04629000
*         /*                                                 @Y30LB31*/ 04630000
*         /* ATTRIBUTES.                                     @Y30LB31*/ 04631000
*         /*                                                         */ 04632000
*         /***********************************************************/ 04633000
*                                                                  1255 04634000
*       END;                        /*                       @Y30LB31*/ 04635000
*                                                                  1255 04636000
*   /*****************************************************************/ 04637000
*   /*                                                               */ 04638000
*   /* SINCE THE BASE VOLUME DOES NOT BELONG TO A GROUP,     @Y30LB31*/ 04639000
*   /* CHANGE THE VOLUME ATTRIBUTES ONLY IF READWRITE IS SPECIFIED   */ 04640000
*   /* AND THE VOLUME IS READONLY. THE OTHER ATTRIBUTES ARE NOT      */ 04641000
*   /* CHANGED. THE DEFAULT ATTRIBUTES WERE INITIALIZED TO OFF IN    */ 04642000
*   /* IDCAV01 PROC.                                         @Y30LB31*/ 04643000
*   /*                                                               */ 04644000
*   /*****************************************************************/ 04645000
*                                                                  1256 04646000
*     ELSE                          /*                       @Y30LB31*/ 04647000
*       IF ADDR(RWOPT)^=NULLPTR&OLDROFLG=ON THEN/*           @Y30LB31*/ 04648000
         B     @RC01201                                            1256 04649000
@RF01201 L     @05,@PC00001+4                                      1256 04650000
         L     @05,FDTPTR+24(,@05)                                 1256 04651000
         LTR   @05,@05                                             1256 04652000
         BZ    @RF01256                                            1256 04653000
         TM    OLDROFLG,B'00010000'                                1256 04654000
         BNO   @RF01256                                            1256 04655000
*         DO;                       /*                       @Y30LB31*/ 04656000
*           NEWVFFLG=ON;            /*                       @Y30LB31*/ 04657000
         OI    NEWVFFLG,B'00001000'                                1258 04658000
*           NEWROFLG=OFF;           /* READWRITE=OFF         @Y30LB31*/ 04659000
         NI    NEWROFLG,B'11111110'                                1259 04660000
*           IF OLDBIFLG=ON THEN     /*                       @Y30LB31*/ 04661000
         TM    OLDBIFLG,B'10000000'                                1260 04662000
         BNO   @RF01260                                            1260 04663000
*             NEWBIFLG=ON;          /*                       @Y30LB31*/ 04664000
         OI    NEWBIFLG,B'00001000'                                1261 04665000
*           IF OLDEXFLG=ON THEN     /*                       @Y30LB31*/ 04666000
@RF01260 TM    OLDEXFLG,B'00100000'                                1262 04667000
         BNO   @RF01262                                            1262 04668000
*             NEWEXFLG=ON;          /*                       @Y30LB31*/ 04669000
         OI    NEWEXFLG,B'00000010'                                1263 04670000
*           IF OLDDEFLG=ON THEN     /*                       @Y30LB31*/ 04671000
@RF01262 TM    OLDDEFLG,B'01000000'                                1264 04672000
         BNO   @RF01264                                            1264 04673000
*             NEWDEFLG=ON;          /*                       @Y30LB31*/ 04674000
         OI    NEWDEFLG,B'00000100'                                1265 04675000
*         END;                      /*                       @Y30LB31*/ 04676000
@RF01264 DS    0H                                                  1267 04677000
*                                                                  1267 04678000
*   /*****************************************************************/ 04679000
*   /*                                                               */ 04680000
*   /* UPDATE THE VOLUME ATTRIBUTES IF NECESSARY. IF THE     @Y30LB31*/ 04681000
*   /* VOLUME SERIAL NO. IS BEING CHANGED, DO NOT UPDATE THE ATTRI-  */ 04682000
*   /* BUTES AT THIS TIME BUT IN CONJUNCTION WITH THE SUBSEQUENT MSC */ 04683000
*   /* RENAME OPERATION.                                     @Y30LB31*/ 04684000
*   /*                                                               */ 04685000
*   /*****************************************************************/ 04686000
*                                                                  1267 04687000
*   IF ADDRC=0 THEN                 /*                       @Y30LB31*/ 04688000
@RF01256 DS    0H                                                  1267 04689000
@RC01201 DS    0H                                                  1267 04690000
@RF01200 SLR   @05,@05                                             1267 04691000
         CR    ADDRC,@05                                           1267 04692000
         BNE   @RF01267                                            1267 04693000
*     IF NEWVFFLG=ON&ADDR(NSER)=NULLPTR THEN/*               @Y30LB31*/ 04694000
         TM    NEWVFFLG,B'00001000'                                1268 04695000
         BNO   @RF01268                                            1268 04696000
         L     @15,@PC00001+4                                      1268 04697000
         C     @05,FDTPTR+20(,@15)                                 1268 04698000
         BNE   @RF01268                                            1268 04699000
*       DO;                         /*                       @Y30LB31*/ 04700000
*         CALL NEWVFRTN;            /*                       @Y30LB31*/ 04701000
         BAL   @14,NEWVFRTN                                        1270 04702000
*         RESPECIFY                                                1271 04703000
*           RTNREG RSTD;                                           1271 04704000
*         TESTRC=RTNREG;                                           1272 04705000
         LR    TESTRC,RTNREG                                       1272 04706000
*         RESPECIFY                                                1273 04707000
*           RTNREG UNRSTD;          /*                       @Y30LB31*/ 04708000
*                                                                  1273 04709000
*         /***********************************************************/ 04710000
*         /*                                                         */ 04711000
*         /* TEST THE RETURN CODE FROM NEWVFRTN. IF THE      @Y30LB31*/ 04712000
*         /* REQUEST FAILED TO UPDATE THE ATTRIBUTES, UPDATE THE COND*/ 04713000
*         /* CODE AND EXIT FROM THIS PROCEDURE.              @Y30LB31*/ 04714000
*         /*                                                         */ 04715000
*         /***********************************************************/ 04716000
*                                                                  1274 04717000
*         IF TESTRC^=0 THEN         /*                       @Y30LB31*/ 04718000
         LTR   TESTRC,TESTRC                                       1274 04719000
         BZ    @RF01274                                            1274 04720000
*           ADDRC=LASTCC08;         /*                       @Y30LB31*/ 04721000
         LA    ADDRC,8                                             1275 04722000
*       END;                        /*                       @Y30LB31*/ 04723000
*                                                                  1276 04724000
@RF01274 DS    0H                                                  1277 04725000
*   /*****************************************************************/ 04726000
*   /*                                                               */ 04727000
*   /* RESTORE THE RETURN ADDRESS OF THE CALLER IN REG 14    @Y30LB31*/ 04728000
*   /* AND RETURN TO CALLER, PASSING THE CONDITION CODE IN REG 15.   */ 04729000
*   /*                                                       @Y30LB31*/ 04730000
*   /*                                                               */ 04731000
*   /*****************************************************************/ 04732000
*                                                                  1277 04733000
*   RESPECIFY                                                      1277 04734000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 04735000
@RF01268 DS    0H                                                  1277 04736000
@RF01267 DS    0H                                                  1278 04737000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 04738000
         L     REG14,RETADDR2                                      1278 04739000
*   RESPECIFY                                                      1279 04740000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 04741000
*   RETURN CODE(ADDRC);             /*                       @Y30LB31*/ 04742000
         LR    @15,ADDRC                                           1280 04743000
@EL00010 DS    0H                                                  1280 04744000
@EF00010 DS    0H                                                  1280 04745000
@ER00010 BR    @14                                                 1280 04746000
*   END ADDRTN;                     /*                       @Y30LB31*/ 04747000
*                                                                  1282 04748000
*/********************************************************** @G24LB23*/ 04749000
*/*                                                          @G24LB23*/ 04750000
*/* PROCEDURE NAME - DLSPRTN                                 @G24LB23*/ 04751000
*/*                                                          @G24LB23*/ 04752000
*/* FUNCTION - CHECKS A VOLUME BEING ACTIVATED FOR A DOWN    @G24LB23*/ 04753000
*/*            LEVEL SPACE CONDITION.  IF THE VOLUME HAS DOWN@G24LB23*/ 04754000
*/*            LEVEL SPACE AND BELONGS TO A GROUP OTHER      @G24LB23*/ 04755000
*/*            THAN SYSGROUP, MAKES CERTAIN THAT EITHER      @G24LB23*/ 04756000
*/*            THE VOLUME GETS MOUNTED OR THAT AN ERROR      @G24LB23*/ 04757000
*/*            CONDITION IS NOTED.                           @G24LB23*/ 04758000
*/*                                                          @G24LB23*/ 04759000
*/* INPUT - FDTTBL, BASEV, ADDVTBL, MDAGL                    @G24LB23*/ 04760000
*/*                                                          @G24LB23*/ 04761000
*/* OUTPUT - RETURN CODE 0 INDICATES NOT A DOWN LEVEL        @G24LB23*/ 04762000
*/*          SPACE CONDITION OR ELSE THE VOLUME WAS          @G24LB23*/ 04763000
*/*          SUCCESSFULLY MOUNTED.                           @G24LB23*/ 04764000
*/*          RETURN CODE 8 INDICATES ATTEMPT TO MOUNT THE    @G24LB23*/ 04765000
*/*          VOLUME FAILED AND THE DEACTIVATE WHICH          @G24LB23*/ 04766000
*/*          FOLLOWED ALSO FAILED.                           @G24LB23*/ 04767000
*/*          RETURN CODE 12 INDICATES ATTEMPT TO MOUNT       @G24LB23*/ 04768000
*/*          THE VOLUME FAILED AND THE VOLUME HAS BEEN       @G24LB23*/ 04769000
*/*          DEACTIVATED.                                    @G24LB23*/ 04770000
*/*                                                          @G24LB23*/ 04771000
*/********************************************************** @G24LB23*/ 04772000
*                                                                  1282 04773000
*DLSPRTN:                                                          1282 04774000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @G24LB23*/ 04775000
*                                                                  1282 04776000
DLSPRTN  DS    0H                                                  1283 04777000
*   /*****************************************************************/ 04778000
*   /*                                                               */ 04779000
*   /* LOCAL CONDITION CODE                                  @G24LB23*/ 04780000
*   /*                                                               */ 04781000
*   /*****************************************************************/ 04782000
*                                                                  1283 04783000
*   DCL                                                            1283 04784000
*     DLSRC FIXED(15);              /*                       @G24LB23*/ 04785000
*                                                                  1283 04786000
*   /*****************************************************************/ 04787000
*   /*                                                               */ 04788000
*   /* RETURN ADDRESS                                        @G24LB23*/ 04789000
*   /*                                                               */ 04790000
*   /*****************************************************************/ 04791000
*                                                                  1284 04792000
*   DCL                                                            1284 04793000
*     DLSRET FIXED(31);             /*                       @G24LB23*/ 04794000
*                                                                  1284 04795000
*   /*****************************************************************/ 04796000
*   /*                                                               */ 04797000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS      @G24LB23*/ 04798000
*   /* NO SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.       @G24LB23*/ 04799000
*   /*                                                               */ 04800000
*   /*****************************************************************/ 04801000
*                                                                  1285 04802000
*   RESPECIFY                                                      1285 04803000
*     REG14 RSTD;                   /*                       @G24LB23*/ 04804000
*   DLSRET=REG14;                   /*                       @G24LB23*/ 04805000
         ST    REG14,DLSRET                                        1286 04806000
*   RESPECIFY                                                      1287 04807000
*     REG14 UNRSTD;                 /*                       @G24LB23*/ 04808000
*   OLDERID2=NEWERID2;                                             1288 04809000
         L     @04,@PC00001                                        1288 04810000
         L     @04,GDTTR2(,@04)                                    1288 04811000
         MVC   @TS00001(95),NEWERID2(@04)                          1288 04812000
         MVC   OLDERID2(95,@04),@TS00001                           1288 04813000
*   NEWID2='AVDL';                  /*                       @G24LB23*/ 04814000
*                                                                  1289 04815000
         MVC   NEWID2(4,@04),@CC01872                              1289 04816000
*   /*****************************************************************/ 04817000
*   /*                                                               */ 04818000
*   /* ZERO OUT THE CONDITION CODE USED WITHIN THIS          @G24LB23*/ 04819000
*   /* PROCEDURE                                             @G24LB23*/ 04820000
*   /*                                                               */ 04821000
*   /*****************************************************************/ 04822000
*                                                                  1290 04823000
*   DLSRC=LASTCC00;                 /*                       @G24LB23*/ 04824000
*                                                                  1290 04825000
         SLR   DLSRC,DLSRC                                         1290 04826000
*   /*****************************************************************/ 04827000
*   /*                                                               */ 04828000
*   /* IF THE DOWN LEVEL SPACE FLAG IS ON AND THE            @G24LB23*/ 04829000
*   /* VOLUME BELONGS TO A GROUP OTHER THAN SYSGROUP, MAKE SURE THE  */ 04830000
*   /* VOLUME GETS MOUNTED                                   @G24LB23*/ 04831000
*   /*                                                               */ 04832000
*   /*****************************************************************/ 04833000
*                                                                  1291 04834000
*   IF BASDLSF=ON&BASGROUP^=SYSGROUP/*                       @G24LB23*/ 04835000
*     THEN                          /*                       @G24LB23*/ 04836000
         TM    BASDLSF(BASEVPTR),B'10000000'                       1291 04837000
         BNO   @RF01291                                            1291 04838000
         CLC   BASGROUP(8,BASEVPTR),@CC01670                       1291 04839000
         BE    @RF01291                                            1291 04840000
*     DO;                           /*                       @G24LB23*/ 04841000
*                                                                  1292 04842000
*       /*************************************************************/ 04843000
*       /*                                                           */ 04844000
*       /* DYNAMICALLY ALLOCATE A UNIT IF THE UNIT           @G24LB23*/ 04845000
*       /* IS NOT ALREADY ALLOCATED                          @G24LB23*/ 04846000
*       /*                                                           */ 04847000
*       /*************************************************************/ 04848000
*                                                                  1293 04849000
*       IF AUNITDDN=NODDNAME THEN   /*                       @G24LB23*/ 04850000
         CLC   AUNITDDN(8),@CB01651                                1293 04851000
         BNE   @RF01293                                            1293 04852000
*         DO;                       /*                       @G24LB23*/ 04853000
*           CALL ALLOCRTN;          /*                       @G24LB23*/ 04854000
         BAL   @14,ALLOCRTN                                        1295 04855000
*           RESPECIFY                                              1296 04856000
*             RTNREG RSTD;                                         1296 04857000
*           TESTRC=RTNREG;                                         1297 04858000
         LR    TESTRC,RTNREG                                       1297 04859000
*           RESPECIFY                                              1298 04860000
*             RTNREG UNRSTD;        /*                       @G24LB23*/ 04861000
*         END;                      /*                       @G24LB23*/ 04862000
*                                                                  1299 04863000
*       /*************************************************************/ 04864000
*       /*                                                           */ 04865000
*       /* CALL AN AMS SYSTEM ADAPTER ROUTINE                @G24LB23*/ 04866000
*       /* TO MOUNT THE VOLUME                               @G24LB23*/ 04867000
*       /*                                                           */ 04868000
*       /*************************************************************/ 04869000
*                                                                  1300 04870000
*       IF TESTRC=0 THEN                                           1300 04871000
@RF01293 LTR   TESTRC,TESTRC                                       1300 04872000
         BNZ   @RF01300                                            1300 04873000
*         DO;                       /*                       @G24LB23*/ 04874000
*                                                                  1301 04875000
*           /*********************************************************/ 04876000
*           /*                                                       */ 04877000
*           /* INITIALIZE THE MOUNT-DEMOUNT ARGUMENT LIST    @G24LB23*/ 04878000
*           /*                                                       */ 04879000
*           /*********************************************************/ 04880000
*                                                                  1302 04881000
*           MDDDNAME=AUNITDDN;      /*                       @G24LB23*/ 04882000
         LA    @04,AVMDAGL                                         1302 04883000
         MVC   MDDDNAME(8,@04),AUNITDDN                            1302 04884000
*           MDUCBPTR=ADDR(AUNITUCB);/*                       @G24LB23*/ 04885000
         LA    @02,AUNITUCB                                        1303 04886000
         ST    @02,MDUCBPTR(,@04)                                  1303 04887000
*           MDLABEL=BASSERNO;       /*                       @G24LB23*/ 04888000
         MVC   MDLABEL(6,@04),BASSERNO(BASEVPTR)                   1304 04889000
*           AMDTYPE=MOUNT;          /*                       @G24LB23*/ 04890000
         MVC   AMDTYPE(8),MOUNT                                    1305 04891000
*           CALL IDCSA060(GDTTBL,AMDTYPE,MDAGL);/*           @G24LB23*/ 04892000
         L     @02,@PC00001                                        1306 04893000
         ST    @02,@AL00001                                        1306 04894000
         LA    @15,AMDTYPE                                         1306 04895000
         ST    @15,@AL00001+4                                      1306 04896000
         ST    @04,@AL00001+8                                      1306 04897000
         MVI   @AL00001+8,X'80'                                    1306 04898000
         L     @15,GDTUNT(,@02)                                    1306 04899000
         LA    @01,@AL00001                                        1306 04900000
         BALR  @14,@15                                             1306 04901000
*           RESPECIFY                                              1307 04902000
*             RTNREG RSTD;                                         1307 04903000
*           TESTRC=RTNREG;                                         1308 04904000
         LR    TESTRC,RTNREG                                       1308 04905000
*           RESPECIFY                                              1309 04906000
*             RTNREG UNRSTD;        /*                       @G24LB23*/ 04907000
*         END;                      /*                       @G24LB23*/ 04908000
*                                                                  1310 04909000
*       /*************************************************************/ 04910000
*       /*                                                           */ 04911000
*       /* IF VOLUME COULD NOT BE MOUNTED, DEACTIVATE        @G24LB23*/ 04912000
*       /* THE VOLUME                                        @G24LB23*/ 04913000
*       /*                                                           */ 04914000
*       /*************************************************************/ 04915000
*                                                                  1311 04916000
*       IF TESTRC^=0 THEN                                          1311 04917000
@RF01300 LTR   TESTRC,TESTRC                                       1311 04918000
         BZ    @RF01311                                            1311 04919000
*         DO;                       /*                       @G24LB23*/ 04920000
*           DEFLIST=''B;            /*                       @G24LB23*/ 04921000
         L     @02,DEFVPTR                                         1313 04922000
         XC    DEFLIST(132,@02),DEFLIST(@02)                       1313 04923000
*           DEFVDACT=ON;            /*                       @G24LB23*/ 04924000
         OI    DEFVDACT(@02),B'00000001'                           1314 04925000
*           DEFVOLD=BASSERNO;       /*                       @G24LB23*/ 04926000
         MVC   DEFVOLD(6,@02),BASSERNO(BASEVPTR)                   1315 04927000
*           CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBCODE,ECBMSPTR 04928000
*               );                  /*                       @G24LB23*/ 04929000
         L     @02,@PC00001                                        1316 04930000
         ST    @02,@AL00001                                        1316 04931000
         LA    @15,DEFINE                                          1316 04932000
         ST    @15,@AL00001+4                                      1316 04933000
         LA    @15,DEFVPTR                                         1316 04934000
         ST    @15,@AL00001+8                                      1316 04935000
         LA    @15,REASON                                          1316 04936000
         ST    @15,@AL00001+12                                     1316 04937000
         LA    @15,ECBCODE                                         1316 04938000
         ST    @15,@AL00001+16                                     1316 04939000
         LA    @15,ECBMSPTR                                        1316 04940000
         ST    @15,@AL00001+20                                     1316 04941000
         MVI   @AL00001+20,X'80'                                   1316 04942000
         L     @15,GDTSSC(,@02)                                    1316 04943000
         LA    @01,@AL00001                                        1316 04944000
         BALR  @14,@15                                             1316 04945000
*           RESPECIFY                                              1317 04946000
*             RTNREG RSTD;                                         1317 04947000
*           TESTRC=RTNREG;                                         1318 04948000
         LR    TESTRC,RTNREG                                       1318 04949000
*           RESPECIFY                                              1319 04950000
*             RTNREG UNRSTD;        /*                       @G24LB23*/ 04951000
*                                                                  1319 04952000
*           /*********************************************************/ 04953000
*           /*                                                       */ 04954000
*           /* PRINT MESSAGE IDC3114I                        @G24LB23*/ 04955000
*           /*                                                       */ 04956000
*           /*********************************************************/ 04957000
*                                                                  1320 04958000
*           PRINTTBL=''B;           /*                       @G24LB23*/ 04959000
         XC    PRINTTBL(28),PRINTTBL                               1320 04960000
*           DARGSMOD=COMMSGS;       /*                       @G24LB23*/ 04961000
         L     @02,DDSTRU                                          1321 04962000
         MVC   DARGSMOD(3,@02),@CC01697                            1321 04963000
*           DARGSENT=MSG3114I;      /*                       @G24LB23*/ 04964000
         MVI   DARGSENT(@02),X'46'                                 1322 04965000
*           DARGDBP=ADDR(BASSERNO); /*                       @G24LB23*/ 04966000
         LA    @15,BASSERNO(,BASEVPTR)                             1323 04967000
         ST    @15,DARGDBP(,@02)                                   1323 04968000
*           DARGILP=LENGTH(BASSERNO);/*                      @G24LB23*/ 04969000
         MVC   DARGILP(2,@02),@CH00159                             1324 04970000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @G24LB23*/ 04971000
*                                                                  1325 04972000
         L     @02,@PC00001                                        1325 04973000
         ST    @02,@AL00001                                        1325 04974000
         LA    @15,@CF00117                                        1325 04975000
         ST    @15,@AL00001+4                                      1325 04976000
         LA    @15,DDSTRU                                          1325 04977000
         ST    @15,@AL00001+8                                      1325 04978000
         MVI   @AL00001+8,X'80'                                    1325 04979000
         L     @15,GDTPRT(,@02)                                    1325 04980000
         LA    @01,@AL00001                                        1325 04981000
         BALR  @14,@15                                             1325 04982000
*           /*********************************************************/ 04983000
*           /*                                                       */ 04984000
*           /* IF DEACTIVATE FAILED, SET CONDITION CODE TO   @G24LB23*/ 04985000
*           /* 8 AND PRINT MESSAGE IDC0722I. ELSE PRINT MESSAGE      */ 04986000
*           /* IDC2075I AND SET CONDITION CODE TO 12         @G24LB23*/ 04987000
*           /*                                                       */ 04988000
*           /*********************************************************/ 04989000
*                                                                  1326 04990000
*           IF TESTRC^=0&TESTRC^=12 THEN                           1326 04991000
         LTR   TESTRC,TESTRC                                       1326 04992000
         BZ    @RF01326                                            1326 04993000
         C     TESTRC,@CF00606                                     1326 04994000
         BE    @RF01326                                            1326 04995000
*             DO;                   /*                       @G24LB23*/ 04996000
*               DLSRC=LASTCC08;     /*                       @G24LB23*/ 04997000
         LA    DLSRC,8                                             1328 04998000
*               DARGSMOD=ADDVMSGS;  /*                       @G24LB23*/ 04999000
         L     @04,DDSTRU                                          1329 05000000
         MVC   DARGSMOD(3,@04),@CC01687                            1329 05001000
*               DARGSENT=MSG0722I;  /*                       @G24LB23*/ 05002000
         MVI   DARGSENT(@04),X'03'                                 1330 05003000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @G24LB23*/ 05004000
         L     @04,@PC00001                                        1331 05005000
         ST    @04,@AL00001                                        1331 05006000
         LA    @15,@CF00117                                        1331 05007000
         ST    @15,@AL00001+4                                      1331 05008000
         LA    @15,DDSTRU                                          1331 05009000
         ST    @15,@AL00001+8                                      1331 05010000
         MVI   @AL00001+8,X'80'                                    1331 05011000
         L     @15,GDTPRT(,@04)                                    1331 05012000
         LA    @01,@AL00001                                        1331 05013000
         BALR  @14,@15                                             1331 05014000
*             END;                  /*                       @G24LB23*/ 05015000
*           ELSE                                                   1333 05016000
*             DO;                   /*                       @G24LB23*/ 05017000
         B     @RC01326                                            1333 05018000
@RF01326 DS    0H                                                  1334 05019000
*               DLSRC=LASTCC12;     /*                       @G24LB23*/ 05020000
         LA    DLSRC,12                                            1334 05021000
*               DARGSENT=MSG2075I;  /*                       @G24LB23*/ 05022000
         L     @04,DDSTRU                                          1335 05023000
         MVI   DARGSENT(@04),X'1F'                                 1335 05024000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @G24LB23*/ 05025000
         L     @04,@PC00001                                        1336 05026000
         ST    @04,@AL00001                                        1336 05027000
         LA    @15,@CF00117                                        1336 05028000
         ST    @15,@AL00001+4                                      1336 05029000
         LA    @15,DDSTRU                                          1336 05030000
         ST    @15,@AL00001+8                                      1336 05031000
         MVI   @AL00001+8,X'80'                                    1336 05032000
         L     @15,GDTPRT(,@04)                                    1336 05033000
         LA    @01,@AL00001                                        1336 05034000
         BALR  @14,@15                                             1336 05035000
*             END;                  /*                       @G24LB23*/ 05036000
*         END;                      /*                       @G24LB23*/ 05037000
*       ELSE                                                       1339 05038000
*         DO;                       /*                       @G24LB23*/ 05039000
*                                                                  1339 05040000
         B     @RC01311                                            1339 05041000
@RF01311 DS    0H                                                  1340 05042000
*           /*********************************************************/ 05043000
*           /*                                                       */ 05044000
*           /* DEMOUNT THE VOLUME                            @G24LB23*/ 05045000
*           /*                                                       */ 05046000
*           /*********************************************************/ 05047000
*                                                                  1340 05048000
*           MDWAIT=ON;              /*                       @G24LB23*/ 05049000
         LA    @04,AVMDAGL                                         1340 05050000
         OI    MDWAIT(@04),B'00010000'                             1340 05051000
*           AMDTYPE=DEMOUNT;        /*                       @G24LB23*/ 05052000
         MVC   AMDTYPE(8),DEMOUNT                                  1341 05053000
*           CALL IDCSA060(GDTTBL,AMDTYPE,MDAGL);/*           @G24LB23*/ 05054000
         L     @15,@PC00001                                        1342 05055000
         ST    @15,@AL00001                                        1342 05056000
         LA    @14,AMDTYPE                                         1342 05057000
         ST    @14,@AL00001+4                                      1342 05058000
         ST    @04,@AL00001+8                                      1342 05059000
         MVI   @AL00001+8,X'80'                                    1342 05060000
         L     @15,GDTUNT(,@15)                                    1342 05061000
         LA    @01,@AL00001                                        1342 05062000
         BALR  @14,@15                                             1342 05063000
*         END;                      /*                       @G24LB23*/ 05064000
*     END;                          /*                       @G24LB23*/ 05065000
*                                                                  1344 05066000
@RC01311 DS    0H                                                  1345 05067000
*   /*****************************************************************/ 05068000
*   /*                                                               */ 05069000
*   /* RESTORE THE RETURN ADDRESS                            @G24LB23*/ 05070000
*   /*                                                               */ 05071000
*   /*****************************************************************/ 05072000
*                                                                  1345 05073000
*   RESPECIFY                                                      1345 05074000
*     REG14 RSTD;                   /*                       @G24LB23*/ 05075000
@RF01291 DS    0H                                                  1346 05076000
*   REG14=DLSRET;                   /*                       @G24LB23*/ 05077000
         L     REG14,DLSRET                                        1346 05078000
*   RESPECIFY                                                      1347 05079000
*     REG14 UNRSTD;                 /*                       @G24LB23*/ 05080000
*   RETURN CODE(DLSRC);             /*                       @G24LB23*/ 05081000
         LR    @15,DLSRC                                           1348 05082000
@EL00011 DS    0H                                                  1348 05083000
@EF00011 DS    0H                                                  1348 05084000
@ER00011 BR    @14                                                 1348 05085000
*   END DLSPRTN;                    /*                       @G24LB23*/ 05086000
*                                                                  1350 05087000
*/********************************************************** #Y30LB31*/ 05088000
*/*                                                          #Y30LB31*/ 05089000
*/* PROCEDURE NAME - ACTVRTN                                 #Y30LB31*/ 05090000
*/*                                                          #Y30LB31*/ 05091000
*/* FUNCTION - MAKES THE INACTIVE VOLUME ACTIVE AND THUS     #Y30LB31*/ 05092000
*/*            AVAILABLE FOR MOUNTING.  BUILDS THE MSSC      #Y30LB31*/ 05093000
*/*            DEFINE PARM LIST FOR THE ACTIVATE REQUEST.    #Y30LB31*/ 05094000
*/*            CALLS SSCMSG TO PRINT A MESSAGE CONTAINING    #Y30LB31*/ 05095000
*/*            THE MSS  REASON CODE IF THE MSC DEFINE ORDER  #Y30LB31*/ 05096000
*/*            FAILED.  MSG IDC2075I IS ISSUED IF ACTIVATE   #Y30LB31*/ 05097000
*/*            FAILED.                                       #Y30LB31*/ 05098000
*/*                                                          #Y30LB31*/ 05099000
*/* INPUT -  ADDVTBL, BCDV, DARGLIST FOR MESSAGES.           #Y30LB31*/ 05100000
*/*                                                          #Y30LB31*/ 05101000
*/* OUTPUT - RETURN CODE OF 0 INDICATES ACTIVATE SUCCESSFUL  #Y30LB31*/ 05102000
*/*          AND CC04FLG MAY BE SET IF MSVC ENCOUNTERED AN   #Y30LB31*/ 05103000
*/*          I/O ERROR.                                      #Y30LB31*/ 05104000
*/*          RETURN CODE OF 4 INDICATES ACTIVATE FAILED.     #Y30LB31*/ 05105000
*/*                                                          #Y30LB31*/ 05106000
*/********************************************************** #Y30LB31*/ 05107000
*                                                                  1350 05108000
*ACTVRTN:                                                          1350 05109000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  #Y30LB31*/ 05110000
*                                                                  1350 05111000
ACTVRTN  DS    0H                                                  1351 05112000
*   /*****************************************************************/ 05113000
*   /*                                                               */ 05114000
*   /* LOCAL CONDITION CODE.                                 #Y30LB31*/ 05115000
*   /*                                                               */ 05116000
*   /*****************************************************************/ 05117000
*                                                                  1351 05118000
*   DCL                                                            1351 05119000
*     ACTVRC FIXED(15);             /*                       #Y30LB31*/ 05120000
*                                                                  1351 05121000
*   /*****************************************************************/ 05122000
*   /*                                                               */ 05123000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   #Y30LB31*/ 05124000
*   /* SAVEAREA. REG14 WILL BE RESTORED UPON EXIT.           #Y30LB31*/ 05125000
*   /*                                                               */ 05126000
*   /*****************************************************************/ 05127000
*                                                                  1352 05128000
*   RESPECIFY                                                      1352 05129000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 05130000
*   RETADDR3=REG14;                 /*                       #Y30LB31*/ 05131000
         ST    REG14,RETADDR3                                      1353 05132000
*   RESPECIFY                                                      1354 05133000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 05134000
*   OLDERID2=NEWERID2;                                             1355 05135000
         L     @15,@PC00001                                        1355 05136000
         L     @14,GDTTR2(,@15)                                    1355 05137000
         MVC   @TS00001(95),NEWERID2(@14)                          1355 05138000
         MVC   OLDERID2(95,@14),@TS00001                           1355 05139000
*   NEWID2='AVAC';                  /*                       @Y30LB31*/ 05140000
*                                                                  1356 05141000
         MVC   NEWID2(4,@14),@CC01877                              1356 05142000
*   /*****************************************************************/ 05143000
*   /*                                                               */ 05144000
*   /* ZERO OUT THE CONDITION CODE USED WITHIN THIS PROC.    @Y30LB31*/ 05145000
*   /*                                                               */ 05146000
*   /*****************************************************************/ 05147000
*                                                                  1357 05148000
*   ACTVRC=LASTCC00;                /*                       @Y30LB31*/ 05149000
*                                                                  1357 05150000
         SLR   @14,@14                                             1357 05151000
         LR    ACTVRC,@14                                          1357 05152000
*   /*****************************************************************/ 05153000
*   /*                                                               */ 05154000
*   /* INITIALIZE THE DEFINE PARM LIST AND ACTIVATE THE VOL  @Y30LB31*/ 05155000
*   /*                                                               */ 05156000
*   /*****************************************************************/ 05157000
*                                                                  1358 05158000
*   DEFLIST=''B;                    /*                       @Y30LB31*/ 05159000
         L     @03,DEFVPTR                                         1358 05160000
         XC    DEFLIST(132,@03),DEFLIST(@03)                       1358 05161000
*   DEFVE=''B;                      /*                       @Y30LB31*/ 05162000
         L     @01,DEFVEPTR                                        1359 05163000
         XC    DEFVE(64,@01),DEFVE(@01)                            1359 05164000
*   DEFVACT=ON;                     /*                       @Y30LB31*/ 05165000
         OI    DEFVACT(@03),B'00000010'                            1360 05166000
*   DEFVCSN1=BCDCSN1;               /*                       @Y30LB31*/ 05167000
*                                                                  1361 05168000
         MVC   DEFVCSN1(12,@03),BCDCSN1(BCDVPTR)                   1361 05169000
*   /*****************************************************************/ 05170000
*   /*                                                               */ 05171000
*   /* TAKE A SYMBOLIC DUMP OF THE DEFINE PARM LIST BEFORE   @Y30LB31*/ 05172000
*   /* THE ACTIVATE IS REQUESTED.                            @Y30LB31*/ 05173000
*   /*                                                               */ 05174000
*   /*****************************************************************/ 05175000
*                                                                  1362 05176000
*   IF GDTDBG=NULLPTR THEN                                         1362 05177000
         C     @14,GDTDBG(,@15)                                    1362 05178000
         BE    @RT01362                                            1362 05179000
*     ;                                                            1363 05180000
*   ELSE                                                           1364 05181000
*     DO;                                                          1364 05182000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 05183000
         LA    DMPINDEX,AVDMPLST                                   1365 05184000
*       DMPITMNM='AV01DEFV';                                       1366 05185000
         MVC   DMPITMNM(8,DMPINDEX),@CC01826                       1366 05186000
*       DMPITMPT=ADDR(AV01DEFV);                                   1367 05187000
         LA    @03,AV01DEFV                                        1367 05188000
         ST    @03,DMPITMPT(,DMPINDEX)                             1367 05189000
*       DMPITMLN=LENGTH(AV01DEFV);                                 1368 05190000
         MVC   DMPITMLN(2,DMPINDEX),@CH02000                       1368 05191000
*       DMPITMTP='H';                                              1369 05192000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1369 05193000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1370 05194000
*                                                                  1370 05195000
         LA    @03,16                                              1370 05196000
         ALR   DMPINDEX,@03                                        1370 05197000
*       /*************************************************************/ 05198000
*       /*                                                           */ 05199000
*       /*                                                   @Y30LB31*/ 05200000
*       /*                                                           */ 05201000
*       /*************************************************************/ 05202000
*                                                                  1371 05203000
*       DMPITMNM='ADDVTBL';                                        1371 05204000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1371 05205000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1371 05206000
*       DMPITMPT=ADDR(ADDVTBL);                                    1372 05207000
         LA    @15,ADDVTBL                                         1372 05208000
         ST    @15,DMPITMPT(,DMPINDEX)                             1372 05209000
*       DMPITMLN=LENGTH(ADDVTBL);                                  1373 05210000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1373 05211000
*       DMPITMTP='H';                                              1374 05212000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1374 05213000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 05214000
         ALR   DMPINDEX,@03                                        1375 05215000
*       DMPTRM=DMPTRMVL;                                           1376 05216000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1376 05217000
*     END;                          /*                       @Y30LB31*/ 05218000
*   IF GDTDBG=NULLPTR THEN                                         1378 05219000
@RT01362 L     @15,@PC00001                                        1378 05220000
         L     @15,GDTDBG(,@15)                                    1378 05221000
         LTR   @15,@15                                             1378 05222000
         BZ    @RT01378                                            1378 05223000
*     ;                                                            1379 05224000
*   ELSE                                                           1380 05225000
*     CALL IDCDB010(GDTTBL,'AVDF',ADDR(AVDMPLST));/*         @Y30LB31*/ 05226000
*                                                                  1380 05227000
         L     @15,@PC00001                                        1380 05228000
         ST    @15,@AL00001                                        1380 05229000
         LA    @14,@CC01878                                        1380 05230000
         ST    @14,@AL00001+4                                      1380 05231000
         LA    @14,AVDMPLST                                        1380 05232000
         ST    @14,@AFTEMPS+16                                     1380 05233000
         LA    @14,@AFTEMPS+16                                     1380 05234000
         ST    @14,@AL00001+8                                      1380 05235000
         MVI   @AL00001+8,X'80'                                    1380 05236000
         L     @15,GDTDBG(,@15)                                    1380 05237000
         LA    @01,@AL00001                                        1380 05238000
         BALR  @14,@15                                             1380 05239000
*   /*****************************************************************/ 05240000
*   /*                                                               */ 05241000
*   /* ACTIVATE THE VOLUME SPECIFIED IN THE DEFINE PARM LIST @Y30LB31*/ 05242000
*   /*                                                               */ 05243000
*   /*****************************************************************/ 05244000
*                                                                  1381 05245000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBCODE,ECBMSPTR);/*     05246000
*                                                            @Y30LB31*/ 05247000
@RT01378 L     @02,@PC00001                                        1381 05248000
         ST    @02,@AL00001                                        1381 05249000
         LA    @15,DEFINE                                          1381 05250000
         ST    @15,@AL00001+4                                      1381 05251000
         LA    @15,DEFVPTR                                         1381 05252000
         ST    @15,@AL00001+8                                      1381 05253000
         LA    @15,REASON                                          1381 05254000
         ST    @15,@AL00001+12                                     1381 05255000
         LA    @15,ECBCODE                                         1381 05256000
         ST    @15,@AL00001+16                                     1381 05257000
         LA    @15,ECBMSPTR                                        1381 05258000
         ST    @15,@AL00001+20                                     1381 05259000
         MVI   @AL00001+20,X'80'                                   1381 05260000
         L     @15,GDTSSC(,@02)                                    1381 05261000
         LA    @01,@AL00001                                        1381 05262000
         BALR  @14,@15                                             1381 05263000
*   RESPECIFY                                                      1382 05264000
*     RTNREG RSTD;                                                 1382 05265000
*   TESTRC=RTNREG;                                                 1383 05266000
         LR    TESTRC,RTNREG                                       1383 05267000
*   RESPECIFY                                                      1384 05268000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 05269000
*                                                                  1384 05270000
*   /*****************************************************************/ 05271000
*   /*                                                               */ 05272000
*   /* TEST RETURN CODE FROM MSC DEFINE ORDER. IF THE VOL    @Y30LB31*/ 05273000
*   /* WAS ACTIVATED BUT MSVC ENCOUNTERED AN I/O ERROR, TREAT THIS AS*/ 05274000
*   /* A MINOR ERROR REQUIRING AN EOJ CONDITION CODE OF AT LEAST 4.  */ 05275000
*   /*                                                       @Y30LB31*/ 05276000
*   /*                                                               */ 05277000
*   /*****************************************************************/ 05278000
*                                                                  1385 05279000
*   IF TESTRC=12 THEN               /*                       @Y30LB31*/ 05280000
         C     TESTRC,@CF00606                                     1385 05281000
         BNE   @RF01385                                            1385 05282000
*     DO;                           /*                       @Y30LB31*/ 05283000
*       TESTRC=0;                   /*                       @Y30LB31*/ 05284000
         SLR   TESTRC,TESTRC                                       1387 05285000
*       CC04FLG=ON;                 /*                       @Y30LB31*/ 05286000
         OI    CC04FLG,B'10000000'                                 1388 05287000
*     END;                          /*                       @Y30LB31*/ 05288000
*                                                                  1390 05289000
*   /*****************************************************************/ 05290000
*   /*                                                               */ 05291000
*   /* IF THE ACTIVATE FAILED, PRINT A MESSAGE WITH THE MSSC @Y30LB31*/ 05292000
*   /* REASON CODE AND SECONDARY MSG IDC2075I. EXIT FROM PROC.       */ 05293000
*   /*                                                       @Y30LB31*/ 05294000
*   /*                                                               */ 05295000
*   /*****************************************************************/ 05296000
*                                                                  1390 05297000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 05298000
@RF01385 LTR   TESTRC,TESTRC                                       1390 05299000
         BZ    @RF01390                                            1390 05300000
*     DO;                           /*                       @Y30LB31*/ 05301000
*       ACTVRC=4;                   /*                       @Y30LB31*/ 05302000
         LA    @02,4                                               1392 05303000
         LR    ACTVRC,@02                                          1392 05304000
*       IF TESTRC=4 THEN            /*                       @Y30LB31*/ 05305000
         CR    TESTRC,@02                                          1393 05306000
         BNE   @RF01393                                            1393 05307000
*         CALL SSCMSG(REASON,ECBCODE);/*                     @Y30LB31*/ 05308000
         LA    @15,REASON                                          1394 05309000
         ST    @15,@AL00001                                        1394 05310000
         LA    @15,ECBCODE                                         1394 05311000
         ST    @15,@AL00001+4                                      1394 05312000
         LA    @01,@AL00001                                        1394 05313000
         BAL   @14,SSCMSG                                          1394 05314000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 05315000
@RF01393 XC    PRINTTBL(28),PRINTTBL                               1395 05316000
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/ 05317000
         L     @15,DDSTRU                                          1396 05318000
         MVC   DARGSMOD(3,@15),@CC01697                            1396 05319000
*       DARGSENT=MSG2075I;          /* STID=CM031            @Y30LB31*/ 05320000
         MVI   DARGSENT(@15),X'1F'                                 1397 05321000
*       DARGDBP=ADDR(MSVIVOL#);     /*                       @Y30LB31*/ 05322000
         LA    @14,MSVIVOL#                                        1398 05323000
         ST    @14,DARGDBP(,@15)                                   1398 05324000
*       DARGILP=LENGTH(MSVIVOL#);   /*                       @Y30LB31*/ 05325000
         MVC   DARGILP(2,@15),@CH00159                             1399 05326000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 05327000
         L     @15,@PC00001                                        1400 05328000
         ST    @15,@AL00001                                        1400 05329000
         LA    @14,@CF00117                                        1400 05330000
         ST    @14,@AL00001+4                                      1400 05331000
         LA    @14,DDSTRU                                          1400 05332000
         ST    @14,@AL00001+8                                      1400 05333000
         MVI   @AL00001+8,X'80'                                    1400 05334000
         L     @15,GDTPRT(,@15)                                    1400 05335000
         LA    @01,@AL00001                                        1400 05336000
         BALR  @14,@15                                             1400 05337000
*     END;                          /*                       @Y30LB31*/ 05338000
*                                                                  1401 05339000
*   /*****************************************************************/ 05340000
*   /*                                                               */ 05341000
*   /* FREE THE MESSAGE STORAGE AREA IF THE CALLER OF THIS   @Y30LB31*/ 05342000
*   /* PROCEDURE DOES NOT REQUIRE THE MESSAGE TO BE SAVED.   @Y30LB31*/ 05343000
*   /*                                                               */ 05344000
*   /*****************************************************************/ 05345000
*                                                                  1402 05346000
*   ELSE                            /*                       @Y30LB31*/ 05347000
*     IF MSGFLG=OFF THEN            /*                       @Y30LB31*/ 05348000
         B     @RC01390                                            1402 05349000
@RF01390 TM    MSGFLG,B'00010000'                                  1402 05350000
         BNZ   @RF01402                                            1402 05351000
*       CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*                    @Y30LB31*/ 05352000
*                                                                  1403 05353000
         L     @15,@PC00001                                        1403 05354000
         ST    @15,@AL00001                                        1403 05355000
         LA    @14,ECBMSPTR                                        1403 05356000
         ST    @14,@AL00001+4                                      1403 05357000
         L     @15,GDTFSP(,@15)                                    1403 05358000
         LA    @01,@AL00001                                        1403 05359000
         BALR  @14,@15                                             1403 05360000
*   /*****************************************************************/ 05361000
*   /*                                                               */ 05362000
*   /* RESTORE THE RETURN ADDRESS OF THE CALLER TO REG 14 AND        */ 05363000
*   /*                                                       @Y30LB31*/ 05364000
*   /* RETURN TO CALLER, PASSING THE CONDITON CODE IN REG 15.        */ 05365000
*   /*                                                       @Y30LB31*/ 05366000
*   /*                                                               */ 05367000
*   /*****************************************************************/ 05368000
*                                                                  1404 05369000
*   RESPECIFY                                                      1404 05370000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 05371000
@RF01402 DS    0H                                                  1404 05372000
@RC01390 DS    0H                                                  1405 05373000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 05374000
         L     REG14,RETADDR3                                      1405 05375000
*   RESPECIFY                                                      1406 05376000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 05377000
*   RETURN CODE(ACTVRC);            /*                       @Y30LB31*/ 05378000
         LR    @15,ACTVRC                                          1407 05379000
@EL00012 DS    0H                                                  1407 05380000
@EF00012 DS    0H                                                  1407 05381000
@ER00012 BR    @14                                                 1407 05382000
*   END ACTVRTN;                    /*                       @Y30LB31*/ 05383000
*                                                                  1409 05384000
*/********************************************************** @Y30LB31*/ 05385000
*/*                                                          @Y30LB31*/ 05386000
*/* PROCEDURE NAME - NEWVFRTN                                @Y30LB31*/ 05387000
*/*                                                          @Y30LB31*/ 05388000
*/* FUNCTION - UPDATE THE VOLUME MOUNTING ATTRIBUTES (BIND/  @Y30LB31*/ 05389000
*/*            NOBIND, EXCLUSIVE/SHARED, DASDERASE/NDERAS,   @Y30LB31*/ 05390000
*/*            READONLY/READWRITE).  BUILDS THE DEFINE PARM  @Y30LB31*/ 05391000
*/*            LIST FOR THE CHANGE-VOLUME-FLAGS REQUEST.     @Y30LB31*/ 05392000
*/*            CALLS SSCMSG TO PRINT A MSG CONTAINING THE    @Y30LB31*/ 05393000
*/*            MSSC REASON CODE IF THE REQUEST FAILED. MSGS  @Y30LB31*/ 05394000
*/*            IDC2093I, IDC0073I, IDC0725I, AND BOTH        @Y30LB31*/ 05395000
*/*            VERSIONS OF IDC2091I ARE ISSUED BY THIS PROC. @Y30LB31*/ 05396000
*/*                                                          @Y30LB31*/ 05397000
*/* INPUT - FDTTBL, ADDVTBL, PRINTTBL FOR MESSAGES,          @Y30LB31*/ 05398000
*/*         DEFLIST AND DEFVE.                               @Y30LB31*/ 05399000
*/*                                                          @Y30LB31*/ 05400000
*/* OUTPUT - RETURN CODE OF 0 INDICATES ATTRIBUTES UPDATED   @Y30LB31*/ 05401000
*/*          AND CC04FLG MAY BE SET IN ADDVTBL IF MSVC HAD   @Y30LB31*/ 05402000
*/*          AN I/O ERROR.                                   @Y30LB31*/ 05403000
*/*          RETURN CODE OF 4 INDICATES ATTRIBUTES NOT       @Y30LB31*/ 05404000
*/*          UPDATED AND APPROPRIATE MESSAGES WERE PRINTED.  @Y30LB31*/ 05405000
*/*                                                          @Y30LB31*/ 05406000
*/********************************************************** @Y30LB31*/ 05407000
*                                                                  1409 05408000
*NEWVFRTN:                                                         1409 05409000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 05410000
*                                                                  1409 05411000
NEWVFRTN DS    0H                                                  1410 05412000
*   /*****************************************************************/ 05413000
*   /*                                                               */ 05414000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 05415000
*   /*                                                               */ 05416000
*   /*****************************************************************/ 05417000
*                                                                  1410 05418000
*   DCL                                                            1410 05419000
*     NEWVFRC FIXED(15);            /*                       @Y30LB31*/ 05420000
*                                                                  1410 05421000
*   /*****************************************************************/ 05422000
*   /*                                                               */ 05423000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO   @Y30LB31*/ 05424000
*   /* SAVEAREA. REG 14 WILL BE RESTORED UPON EXIT.          @Y30LB31*/ 05425000
*   /*                                                               */ 05426000
*   /*****************************************************************/ 05427000
*                                                                  1411 05428000
*   RESPECIFY                                                      1411 05429000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 05430000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 05431000
         ST    REG14,RETADDR3                                      1412 05432000
*   RESPECIFY                                                      1413 05433000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 05434000
*   OLDERID2=NEWERID2;                                             1414 05435000
         L     @15,@PC00001                                        1414 05436000
         L     @15,GDTTR2(,@15)                                    1414 05437000
         MVC   @TS00001(95),NEWERID2(@15)                          1414 05438000
         MVC   OLDERID2(95,@15),@TS00001                           1414 05439000
*   NEWID2='AVVF';                  /*                       @Y30LB31*/ 05440000
*                                                                  1415 05441000
         MVC   NEWID2(4,@15),@CC01883                              1415 05442000
*   /*****************************************************************/ 05443000
*   /*                                                               */ 05444000
*   /* ZERO THE CONDITION CODE USED WITHIN THIS PROCEDURE.   @Y30LB31*/ 05445000
*   /*                                                               */ 05446000
*   /*****************************************************************/ 05447000
*                                                                  1416 05448000
*   NEWVFRC=LASTCC00;               /*                       @Y30LB31*/ 05449000
*                                                                  1416 05450000
         SLR   @15,@15                                             1416 05451000
         STH   @15,NEWVFRC                                         1416 05452000
*   /*****************************************************************/ 05453000
*   /*                                                               */ 05454000
*   /* INITIALIZE THE DEFLIST FOR THE UPDATE VOLUME ATTRI    @Y30LB31*/ 05455000
*   /* REQUEST.                                              @Y30LB31*/ 05456000
*   /*                                                               */ 05457000
*   /*****************************************************************/ 05458000
*                                                                  1417 05459000
*   DEFLIST=''B;                    /*                       @Y30LB31*/ 05460000
         L     @15,DEFVPTR                                         1417 05461000
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1417 05462000
*   DEFVE=''B;                      /*                       @Y30LB31*/ 05463000
         L     @01,DEFVEPTR                                        1418 05464000
         XC    DEFVE(64,@01),DEFVE(@01)                            1418 05465000
*   DEFVOLD=MSVIVOL#;               /*                       @Y30LB31*/ 05466000
         MVC   DEFVOLD(6,@15),MSVIVOL#                             1419 05467000
*   IF NEWDEFLG=ON THEN             /*                       @Y30LB31*/ 05468000
         TM    NEWDEFLG,B'00000100'                                1420 05469000
         BNO   @RF01420                                            1420 05470000
*     DEFVSEC=ON;                   /*                       @Y30LB31*/ 05471000
         OI    DEFVSEC(@15),B'00100000'                            1421 05472000
*   IF NEWEXFLG=ON THEN             /*                       @Y30LB31*/ 05473000
@RF01420 TM    NEWEXFLG,B'00000010'                                1422 05474000
         BNO   @RF01422                                            1422 05475000
*     DEFVEXCL=ON;                  /*                       @Y30LB31*/ 05476000
         L     @01,DEFVPTR                                         1423 05477000
         OI    DEFVEXCL(@01),B'00010000'                           1423 05478000
*   IF NEWBIFLG=ON THEN             /*                       @Y30LB31*/ 05479000
@RF01422 TM    NEWBIFLG,B'00001000'                                1424 05480000
         BNO   @RF01424                                            1424 05481000
*     DEFVBIND=ON;                  /*                       @Y30LB31*/ 05482000
         L     @01,DEFVPTR                                         1425 05483000
         OI    DEFVBIND(@01),B'00000100'                           1425 05484000
*   IF NEWROFLG=ON THEN             /*                       @Y30LB31*/ 05485000
@RF01424 TM    NEWROFLG,B'00000001'                                1426 05486000
         BNO   @RF01426                                            1426 05487000
*     DEFVWINH=ON;                  /*                       @Y30LB31*/ 05488000
*                                                                  1427 05489000
         L     @01,DEFVPTR                                         1427 05490000
         OI    DEFVWINH(@01),B'00000010'                           1427 05491000
*   /*****************************************************************/ 05492000
*   /*                                                               */ 05493000
*   /* SETUP THE MSVC DEFINE EXTENSION LIST IF THE SERIAL    @Y30LB31*/ 05494000
*   /* MISMATCH AND RECOVERY DATA MUST BE CLEARED FROM THE MSVI      */ 05495000
*   /* BECAUSE THE VOLUME HAS BEEN RELABELED DURING THIS ADDV        */ 05496000
*   /* REQUEST. OTHERWISE, THERE ARE NO MSVC EXTENSIONS.     @Y30LB31*/ 05497000
*   /*                                                               */ 05498000
*   /*****************************************************************/ 05499000
*                                                                  1428 05500000
*   IF ADDR(NSER)^=NULLPTR THEN     /*                       @Y30LB31*/ 05501000
@RF01426 L     @15,@PC00001+4                                      1428 05502000
         L     @15,FDTPTR+20(,@15)                                 1428 05503000
         LTR   @15,@15                                             1428 05504000
         BZ    @RF01428                                            1428 05505000
*     DO;                           /*                       @Y30LB31*/ 05506000
*       DEFVVEXT=DEFVEPTR;          /*                       @Y30LB31*/ 05507000
         L     @15,DEFVEPTR                                        1430 05508000
         L     @14,DEFVPTR                                         1430 05509000
         ST    @15,DEFVVEXT(,@14)                                  1430 05510000
*       DEFLNGTH=DEFLEN;            /*                       @Y30LB31*/ 05511000
         LH    @14,DEFLEN                                          1431 05512000
         ST    @14,DEFLNGTH(,@15)                                  1431 05513000
*       DEFCRCVY=ON;                /*                       @Y30LB31*/ 05514000
         OI    DEFCRCVY(@15),B'01000000'                           1432 05515000
*       DEFLAMIS=ON;                /*                       @Y30LB31*/ 05516000
         OI    DEFLAMIS(@15),B'00100000'                           1433 05517000
*       DEFLABEL=BLANKIT;           /*                       @Y30LB31*/ 05518000
         MVI   DEFLABEL+1(@15),C' '                                1434 05519000
         MVC   DEFLABEL+2(4,@15),DEFLABEL+1(@15)                   1434 05520000
         MVI   DEFLABEL(@15),C' '                                  1434 05521000
*       DEFPVLAB=ON;                /*                       @Y30LB31*/ 05522000
         OI    DEFPVLAB(@15),B'01000000'                           1435 05523000
*     END;                          /*                       @Y30LB31*/ 05524000
*                                                                  1436 05525000
*   /*****************************************************************/ 05526000
*   /*                                                               */ 05527000
*   /* TAKE A SYMBOLIC DUMP OF DEFLIST BEFORE UPDATING THE   @Y30LB31*/ 05528000
*   /* ATTRIBUTES.                                           @Y30LB31*/ 05529000
*   /*                                                               */ 05530000
*   /*****************************************************************/ 05531000
*                                                                  1437 05532000
*   IF GDTDBG=NULLPTR THEN                                         1437 05533000
@RF01428 L     @15,@PC00001                                        1437 05534000
         L     @15,GDTDBG(,@15)                                    1437 05535000
         LTR   @15,@15                                             1437 05536000
         BZ    @RT01437                                            1437 05537000
*     ;                                                            1438 05538000
*   ELSE                                                           1439 05539000
*     DO;                                                          1439 05540000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 05541000
         LA    DMPINDEX,AVDMPLST                                   1440 05542000
*       DMPITMNM='AV01DEFV';                                       1441 05543000
         MVC   DMPITMNM(8,DMPINDEX),@CC01826                       1441 05544000
*       DMPITMPT=ADDR(AV01DEFV);                                   1442 05545000
         LA    @03,AV01DEFV                                        1442 05546000
         ST    @03,DMPITMPT(,DMPINDEX)                             1442 05547000
*       DMPITMLN=LENGTH(AV01DEFV);                                 1443 05548000
         MVC   DMPITMLN(2,DMPINDEX),@CH02000                       1443 05549000
*       DMPITMTP='H';                                              1444 05550000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1444 05551000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 05552000
         LA    @03,16                                              1445 05553000
         ALR   DMPINDEX,@03                                        1445 05554000
*       DMPITMNM='ADDVTBL';                                        1446 05555000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1446 05556000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1446 05557000
*       DMPITMPT=ADDR(ADDVTBL);                                    1447 05558000
         LA    @15,ADDVTBL                                         1447 05559000
         ST    @15,DMPITMPT(,DMPINDEX)                             1447 05560000
*       DMPITMLN=LENGTH(ADDVTBL);                                  1448 05561000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1448 05562000
*       DMPITMTP='H';                                              1449 05563000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1449 05564000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 05565000
         ALR   DMPINDEX,@03                                        1450 05566000
*       DMPTRM=DMPTRMVL;                                           1451 05567000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1451 05568000
*     END;                          /*                       @Y30LB31*/ 05569000
*   IF GDTDBG=NULLPTR THEN                                         1453 05570000
@RT01437 L     @15,@PC00001                                        1453 05571000
         L     @15,GDTDBG(,@15)                                    1453 05572000
         LTR   @15,@15                                             1453 05573000
         BZ    @RT01453                                            1453 05574000
*     ;                                                            1454 05575000
*   ELSE                                                           1455 05576000
*     CALL IDCDB010(GDTTBL,'AVAT',ADDR(AVDMPLST));/*         @Y30LB31*/ 05577000
*                                                                  1455 05578000
         L     @15,@PC00001                                        1455 05579000
         ST    @15,@AL00001                                        1455 05580000
         LA    @14,@CC01884                                        1455 05581000
         ST    @14,@AL00001+4                                      1455 05582000
         LA    @14,AVDMPLST                                        1455 05583000
         ST    @14,@AFTEMPS+20                                     1455 05584000
         LA    @14,@AFTEMPS+20                                     1455 05585000
         ST    @14,@AL00001+8                                      1455 05586000
         MVI   @AL00001+8,X'80'                                    1455 05587000
         L     @15,GDTDBG(,@15)                                    1455 05588000
         LA    @01,@AL00001                                        1455 05589000
         BALR  @14,@15                                             1455 05590000
*   /*****************************************************************/ 05591000
*   /*                                                               */ 05592000
*   /* REQUEST THE VOLUME ATTRIBUTE CHANGE VIA THE MSC       @Y30LB31*/ 05593000
*   /* DEFINE ORDER.                                         @Y30LB31*/ 05594000
*   /*                                                               */ 05595000
*   /*****************************************************************/ 05596000
*                                                                  1456 05597000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBCODE,ECBMSPTR);/*     05598000
*                                                            @Y30LB31*/ 05599000
@RT01453 L     @02,@PC00001                                        1456 05600000
         ST    @02,@AL00001                                        1456 05601000
         LA    @15,DEFINE                                          1456 05602000
         ST    @15,@AL00001+4                                      1456 05603000
         LA    @15,DEFVPTR                                         1456 05604000
         ST    @15,@AL00001+8                                      1456 05605000
         LA    @15,REASON                                          1456 05606000
         ST    @15,@AL00001+12                                     1456 05607000
         LA    @15,ECBCODE                                         1456 05608000
         ST    @15,@AL00001+16                                     1456 05609000
         LA    @15,ECBMSPTR                                        1456 05610000
         ST    @15,@AL00001+20                                     1456 05611000
         MVI   @AL00001+20,X'80'                                   1456 05612000
         L     @15,GDTSSC(,@02)                                    1456 05613000
         LA    @01,@AL00001                                        1456 05614000
         BALR  @14,@15                                             1456 05615000
*   RESPECIFY                                                      1457 05616000
*     RTNREG RSTD;                                                 1457 05617000
*   TESTRC=RTNREG;                                                 1458 05618000
         LR    TESTRC,RTNREG                                       1458 05619000
*   RESPECIFY                                                      1459 05620000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 05621000
*                                                                  1459 05622000
*   /*****************************************************************/ 05623000
*   /*                                                               */ 05624000
*   /* TEST RETURN CODE FROM THE MSC DEFINE ORDER. IF THE    @Y30LB31*/ 05625000
*   /* ATTRIBUTES WERE UPDATED BUT MSVC ENCOUNTERED AN I/O ERROR,    */ 05626000
*   /* TREAT THIS AS A MINOR ERROR REQUIRING AN EOJ CONDITION CODE OF*/ 05627000
*   /* AT LEAST 4.                                           @Y30LB31*/ 05628000
*   /*                                                               */ 05629000
*   /*****************************************************************/ 05630000
*                                                                  1460 05631000
*   IF TESTRC=12 THEN               /*                       @Y30LB31*/ 05632000
         C     TESTRC,@CF00606                                     1460 05633000
         BNE   @RF01460                                            1460 05634000
*     DO;                           /*                       @Y30LB31*/ 05635000
*       TESTRC=0;                   /*                       @Y30LB31*/ 05636000
         SLR   TESTRC,TESTRC                                       1462 05637000
*       CC04FLG=ON;                 /*                       @Y30LB31*/ 05638000
         OI    CC04FLG,B'10000000'                                 1463 05639000
*     END;                          /*                       @Y30LB31*/ 05640000
*                                                                  1465 05641000
*   /*****************************************************************/ 05642000
*   /*                                                               */ 05643000
*   /* IF THE REPLACE VOLUME ATTRIBUTE REQUEST FAILED, PRINT @Y30LB31*/ 05644000
*   /* SECONDARY MESSAGE.                                    @Y30LB31*/ 05645000
*   /*                                                               */ 05646000
*   /*****************************************************************/ 05647000
*                                                                  1465 05648000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 05649000
@RF01460 LTR   TESTRC,TESTRC                                       1465 05650000
         BZ    @RF01465                                            1465 05651000
*     DO;                           /*                       @Y30LB31*/ 05652000
*       NEWVFRC=4;                  /*                       @Y30LB31*/ 05653000
         LA    @02,4                                               1467 05654000
         STH   @02,NEWVFRC                                         1467 05655000
*       IF TESTRC=4 THEN            /*                       @Y30LB31*/ 05656000
         CR    TESTRC,@02                                          1468 05657000
         BNE   @RF01468                                            1468 05658000
*         CALL SSCMSG(REASON,ECBCODE);/*                     @Y30LB31*/ 05659000
         LA    @15,REASON                                          1469 05660000
         ST    @15,@AL00001                                        1469 05661000
         LA    @15,ECBCODE                                         1469 05662000
         ST    @15,@AL00001+4                                      1469 05663000
         LA    @01,@AL00001                                        1469 05664000
         BAL   @14,SSCMSG                                          1469 05665000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 05666000
*                                                                  1470 05667000
@RF01468 XC    PRINTTBL(28),PRINTTBL                               1470 05668000
*       /*************************************************************/ 05669000
*       /*                                                           */ 05670000
*       /* IF THE VOLUME SERIAL NO. WAS CHANGED DURING THIS  @Y30LB31*/ 05671000
*       /* ADDV REQUEST, THE ONLY ATTRIBUTE SET AT THIS TIME         */ 05672000
*       /* FOLLOWING THE VOL RELABELING IS THE READONLY ATTRI. PRINT */ 05673000
*       /* MESSAGE IDC2091I SINCE READONLY WAS NOT SET.      @Y30LB31*/ 05674000
*       /*                                                           */ 05675000
*       /*************************************************************/ 05676000
*                                                                  1471 05677000
*       IF ADDR(NSER)^=NULLPTR THEN /*                       @Y30LB31*/ 05678000
         L     @15,@PC00001+4                                      1471 05679000
         L     @15,FDTPTR+20(,@15)                                 1471 05680000
         LTR   @15,@15                                             1471 05681000
         BZ    @RF01471                                            1471 05682000
*         DO;                       /*                       @Y30LB31*/ 05683000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 05684000
         L     @15,DDSTRU                                          1473 05685000
         MVC   DARGSMOD(3,@15),@CC01697                            1473 05686000
*           DARGSENT=MSG2091A;      /* STID=CM015            @Y30LB31*/ 05687000
         MVI   DARGSENT(@15),X'0F'                                 1474 05688000
*           DARGDBP=ADDR(MSVIVOL#); /*                       @Y30LB31*/ 05689000
         LA    @14,MSVIVOL#                                        1475 05690000
         ST    @14,DARGDBP(,@15)                                   1475 05691000
*           DARGILP=LENGTH(MSVIVOL#);/*                      @Y30LB31*/ 05692000
         MVC   DARGILP(2,@15),@CH00159                             1476 05693000
*         END;                      /*                       @Y30LB31*/ 05694000
*                                                                  1477 05695000
*       /*************************************************************/ 05696000
*       /*                                                           */ 05697000
*       /* IF THE VOLUME SERIAL NO. WAS NOT CHANGED BUT THE  @Y30LB31*/ 05698000
*       /* VOLUME IS A GENERAL-USE BASE VOLUME, THE ATTRIBUTES WERE  */ 05699000
*       /* BEING CHANGED TO AGREE WITH THE GROUP. PRINT MESSAGE      */ 05700000
*       /* IDC2093I SINCE THE VOLUME ATTRIBUTES DO NOT AGREE WITH THE*/ 05701000
*       /* GROUP.                                            @Y30LB31*/ 05702000
*       /*                                                           */ 05703000
*       /*************************************************************/ 05704000
*                                                                  1478 05705000
*       ELSE                        /*                       @Y30LB31*/ 05706000
*         IF GRPMSFLG=ON THEN       /*                       @Y30LB31*/ 05707000
         B     @RC01471                                            1478 05708000
@RF01471 TM    GRPMSFLG,B'00000010'                                1478 05709000
         BNO   @RF01478                                            1478 05710000
*           DO;                     /*                       @Y30LB31*/ 05711000
*             DARGSMOD=COMMSGS;     /*                       @Y30LB31*/ 05712000
         L     @15,DDSTRU                                          1480 05713000
         MVC   DARGSMOD(3,@15),@CC01697                            1480 05714000
*             DARGSENT=MSG2093I;    /* STID=CM054            @Y30LB31*/ 05715000
         MVI   DARGSENT(@15),X'36'                                 1481 05716000
*             DARGDBP=ADDR(BASGROUP);/*                      @Y30LB31*/ 05717000
         LA    @14,BASGROUP(,BASEVPTR)                             1482 05718000
         ST    @14,DARGDBP(,@15)                                   1482 05719000
*             DARGILP=LENGTH(BASGROUP);/*                    @Y30LB31*/ 05720000
         MVC   DARGILP(2,@15),@CH00182                             1483 05721000
*           END;                    /*                       @Y30LB31*/ 05722000
*                                                                  1484 05723000
*       /*************************************************************/ 05724000
*       /*                                                           */ 05725000
*       /* IF THE ADDV REQUEST DID NOT INVOLVE A SERIAL NO.  @Y30LB31*/ 05726000
*       /* CHANGE OR GENERAL-USE VOLUME BUT READWRITE WAS SPECIFIED, */ 05727000
*       /* ISSUE MSG IDC2091I SINCE READWRITE WAS NOT SET.   @Y30LB31*/ 05728000
*       /*                                                           */ 05729000
*       /*************************************************************/ 05730000
*                                                                  1485 05731000
*       IF DARGSMOD=NOMODID THEN    /*                       @Y30LB31*/ 05732000
@RF01478 DS    0H                                                  1485 05733000
@RC01471 L     @15,DDSTRU                                          1485 05734000
         CLC   DARGSMOD(3,@15),@CB01647                            1485 05735000
         BNE   @RF01485                                            1485 05736000
*         DO;                       /*                       @Y30LB31*/ 05737000
*           DARGSMOD=ADDVMSGS;      /*                       @Y30LB31*/ 05738000
         MVC   DARGSMOD(3,@15),@CC01687                            1487 05739000
*           DARGSENT=MSG2091B;      /* STID=AV04             @Y30LB31*/ 05740000
         MVI   DARGSENT(@15),X'04'                                 1488 05741000
*           DARGDBP=ADDR(MSVIVOL#); /*                       @Y30LB31*/ 05742000
         LA    @14,MSVIVOL#                                        1489 05743000
         ST    @14,DARGDBP(,@15)                                   1489 05744000
*           DARGILP=LENGTH(MSVIVOL#);/*                      @Y30LB31*/ 05745000
         MVC   DARGILP(2,@15),@CH00159                             1490 05746000
*         END;                      /*                       @Y30LB31*/ 05747000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 05748000
@RF01485 L     @15,@PC00001                                        1492 05749000
         ST    @15,@AL00001                                        1492 05750000
         LA    @14,@CF00117                                        1492 05751000
         ST    @14,@AL00001+4                                      1492 05752000
         LA    @14,DDSTRU                                          1492 05753000
         ST    @14,@AL00001+8                                      1492 05754000
         MVI   @AL00001+8,X'80'                                    1492 05755000
         L     @15,GDTPRT(,@15)                                    1492 05756000
         LA    @01,@AL00001                                        1492 05757000
         BALR  @14,@15                                             1492 05758000
*     END;                          /*                       @Y30LB31*/ 05759000
*                                                                  1494 05760000
*   /*****************************************************************/ 05761000
*   /*                                                               */ 05762000
*   /* OUTPUT THE APPROPRIATE INFORMATIVE MESSAGE UNLESS A   @Y30LB31*/ 05763000
*   /* MESSAGE WAS OUTPUT EARLIER WHEN THE CARTRIDGE LABELS WERE     */ 05764000
*   /* UPDATED.                                              @Y30LB31*/ 05765000
*   /*                                                               */ 05766000
*   /*****************************************************************/ 05767000
*                                                                  1494 05768000
*   ELSE                            /*                       @Y30LB31*/ 05769000
*     DO;                           /*                       @Y30LB31*/ 05770000
         B     @RC01465                                            1494 05771000
@RF01465 DS    0H                                                  1495 05772000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 05773000
*                                                                  1495 05774000
         XC    PRINTTBL(28),PRINTTBL                               1495 05775000
*       /*************************************************************/ 05776000
*       /*                                                           */ 05777000
*       /* THE VOLUME ATTRIBUTES WERE UPDATED BY DEFAULT TO  @Y30LB31*/ 05778000
*       /* AGREE WITH THE GROUP.                             @Y30LB31*/ 05779000
*       /*                                                           */ 05780000
*       /*************************************************************/ 05781000
*                                                                  1496 05782000
*       IF GRPMSFLG=ON THEN         /*                       @Y30LB31*/ 05783000
         TM    GRPMSFLG,B'00000010'                                1496 05784000
         BNO   @RF01496                                            1496 05785000
*         DO;                       /*                       @Y30LB31*/ 05786000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 05787000
         L     @15,DDSTRU                                          1498 05788000
         MVC   DARGSMOD(3,@15),@CC01697                            1498 05789000
*           DARGSENT=MSG0073I;      /* STID=CM033            @Y30LB31*/ 05790000
         MVI   DARGSENT(@15),X'21'                                 1499 05791000
*           DARGDBP=ADDR(BASGROUP); /*                       @Y30LB31*/ 05792000
         LA    @14,BASGROUP(,BASEVPTR)                             1500 05793000
         ST    @14,DARGDBP(,@15)                                   1500 05794000
*           DARGILP=LENGTH(BASGROUP);/*                      @Y30LB31*/ 05795000
         MVC   DARGILP(2,@15),@CH00182                             1501 05796000
*         END;                      /*                       @Y30LB31*/ 05797000
*                                                                  1502 05798000
*       /*************************************************************/ 05799000
*       /*                                                           */ 05800000
*       /* THE READWRITE ATTRIBUTE IS BEING UPDATED BY       @Y30LB31*/ 05801000
*       /* REQUEST.                                          @Y30LB31*/ 05802000
*       /*                                                           */ 05803000
*       /*************************************************************/ 05804000
*                                                                  1503 05805000
*       ELSE                        /*                       @Y30LB31*/ 05806000
*         IF ADDR(NSER)=NULLPTR THEN/*                       @Y30LB31*/ 05807000
         B     @RC01496                                            1503 05808000
@RF01496 L     @15,@PC00001+4                                      1503 05809000
         L     @15,FDTPTR+20(,@15)                                 1503 05810000
         LTR   @15,@15                                             1503 05811000
         BNZ   @RF01503                                            1503 05812000
*           DO;                     /*                       @Y30LB31*/ 05813000
*             DARGSMOD=ADDVMSGS;    /*                       @Y30LB31*/ 05814000
         L     @15,DDSTRU                                          1505 05815000
         MVC   DARGSMOD(3,@15),@CC01687                            1505 05816000
*             DARGSENT=MSG0725I;    /* STID=AV06             @Y30LB31*/ 05817000
         MVI   DARGSENT(@15),X'06'                                 1506 05818000
*             DARGDBP=ADDR(MSVIVOL#);/*                      @Y30LB31*/ 05819000
         LA    @14,MSVIVOL#                                        1507 05820000
         ST    @14,DARGDBP(,@15)                                   1507 05821000
*             DARGILP=LENGTH(MSVIVOL#);/*                    @Y30LB31*/ 05822000
         MVC   DARGILP(2,@15),@CH00159                             1508 05823000
*           END;                    /*                       @Y30LB31*/ 05824000
*       IF DARGSMOD^=NOMODID THEN   /*                       @Y30LB31*/ 05825000
@RF01503 DS    0H                                                  1510 05826000
@RC01496 L     @01,DDSTRU                                          1510 05827000
         CLC   DARGSMOD(3,@01),@CB01647                            1510 05828000
         BE    @RF01510                                            1510 05829000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Y30LB31*/ 05830000
*                                                                  1511 05831000
         L     @15,@PC00001                                        1511 05832000
         ST    @15,@AL00001                                        1511 05833000
         LA    @14,@CF00117                                        1511 05834000
         ST    @14,@AL00001+4                                      1511 05835000
         LA    @14,DDSTRU                                          1511 05836000
         ST    @14,@AL00001+8                                      1511 05837000
         MVI   @AL00001+8,X'80'                                    1511 05838000
         L     @15,GDTPRT(,@15)                                    1511 05839000
         LA    @01,@AL00001                                        1511 05840000
         BALR  @14,@15                                             1511 05841000
*       /*************************************************************/ 05842000
*       /*                                                           */ 05843000
*       /* FREE THE MESSAGE STORAGE AREA.                    @Y30LB31*/ 05844000
*       /*                                                           */ 05845000
*       /*************************************************************/ 05846000
*                                                                  1512 05847000
*       CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*                    @Y30LB31*/ 05848000
@RF01510 L     @15,@PC00001                                        1512 05849000
         ST    @15,@AL00001                                        1512 05850000
         LA    @14,ECBMSPTR                                        1512 05851000
         ST    @14,@AL00001+4                                      1512 05852000
         L     @15,GDTFSP(,@15)                                    1512 05853000
         LA    @01,@AL00001                                        1512 05854000
         BALR  @14,@15                                             1512 05855000
*     END;                          /*                       @Y30LB31*/ 05856000
*                                                                  1513 05857000
*   /*****************************************************************/ 05858000
*   /*                                                               */ 05859000
*   /* RESTORE THE RETURN ADDRESS OF THE CALLER TO REG 14    @Y30LB31*/ 05860000
*   /* AND RETURN TO CALLER, PASSING THE CONDITION CODE IN REG 15.   */ 05861000
*   /*                                                       @Y30LB31*/ 05862000
*   /*                                                               */ 05863000
*   /*****************************************************************/ 05864000
*                                                                  1514 05865000
*   RESPECIFY                                                      1514 05866000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 05867000
@RC01465 DS    0H                                                  1515 05868000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 05869000
         L     REG14,RETADDR3                                      1515 05870000
*   RESPECIFY                                                      1516 05871000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 05872000
*   RETURN CODE(NEWVFRC);           /*                       @Y30LB31*/ 05873000
         LH    @15,NEWVFRC                                         1517 05874000
@EL00013 DS    0H                                                  1517 05875000
@EF00013 DS    0H                                                  1517 05876000
@ER00013 BR    @14                                                 1517 05877000
*   END NEWVFRTN;                   /*                       @Y30LB31*/ 05878000
*                                                                  1519 05879000
*/********************************************************** @Y30LB31*/ 05880000
*/*                                                          @Y30LB31*/ 05881000
*/* PROCEDURE NAME - SECCKRTN                                @Y30LB31*/ 05882000
*/*                                                          @Y30LB31*/ 05883000
*/* FUNCTION - DIRECTS THE VSAM AND SECURITY CHECK REQUIRED  @Y30LB31*/ 05884000
*/*            BEFORE CHANGING THE VOL SERIAL NO.  CALLS     @Y30LB31*/ 05885000
*/*            ALLOCRTN IF A UNIT ON WHICH TO MOUNT THE VOL  @Y30LB31*/ 05886000
*/*            MUST BE DYNAMICALLY ALLOCATED.  CALLS         @Y30LB31*/ 05887000
*/*            VPREPRTN TO MOUNT THE VOL IF THE VOL ALREADY  @Y30LB31*/ 05888000
*/*            HAS A VOL SERIAL MISMATCH.  CALLS VTOCKRTN TO @Y30LB31*/ 05889000
*/*            PERFORM THE VTOC SECURITY AND VSAM CHECKS.    @YD00175*/ 05890000
*/*            NO MSGS ARE ISSUED BY THIS PROC.              @Y30LB31*/ 05891000
*/*                                                          @Y30LB31*/ 05892000
*/* INPUT -  ADDVTBL, BCDV COMMON VOL RECORD FIELDS.         @Y30LB31*/ 05893000
*/*                                                          @Y30LB31*/ 05894000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES THE SECURITY CHECK @Y30LB31*/ 05895000
*/*          FOR A BASE VOL WAS SUCCESSFUL OR THAT THE VSAM  @Y30LB31*/ 05896000
*/*          STATUS WAS RETRIEVED FOR A DUPLICATE VOL.       @Y30LB31*/ 05897000
*/*          A RETURN CODE OF 4 INDICATES THE VOL COULD NOT  @Y30LB31*/ 05898000
*/*          BE MOUNTED FOR THE VTOC CHECK OR THAT THE VTOC  @Y30LB31*/ 05899000
*/*          CHECK WAS UNSUCCESSFUL.                         @Y30LB31*/ 05900000
*/*                                                          @Y30LB31*/ 05901000
*/*********************************************************  @Y30LB31*/ 05902000
*                                                                  1519 05903000
*SECCKRTN:                                                         1519 05904000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 05905000
*                                                                  1519 05906000
SECCKRTN DS    0H                                                  1520 05907000
*   /*****************************************************************/ 05908000
*   /*                                                               */ 05909000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 05910000
*   /*                                                               */ 05911000
*   /*****************************************************************/ 05912000
*                                                                  1520 05913000
*   DCL                                                            1520 05914000
*     SECCKRC FIXED(15);            /*                       @Y30LB31*/ 05915000
*                                                                  1520 05916000
*   /*****************************************************************/ 05917000
*   /*                                                               */ 05918000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE UPON EXIT @Y30LB31*/ 05919000
*   /*                                                               */ 05920000
*   /*****************************************************************/ 05921000
*                                                                  1521 05922000
*   RESPECIFY                                                      1521 05923000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 05924000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 05925000
         ST    REG14,RETADDR2                                      1522 05926000
*   RESPECIFY                                                      1523 05927000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 05928000
*   OLDERID2=NEWERID2;                                             1524 05929000
         L     @15,@PC00001                                        1524 05930000
         L     @15,GDTTR2(,@15)                                    1524 05931000
         MVC   @TS00001(95),NEWERID2(@15)                          1524 05932000
         MVC   OLDERID2(95,@15),@TS00001                           1524 05933000
*   NEWID2='AVSE';                  /*                       @Y30LB31*/ 05934000
*                                                                  1525 05935000
         MVC   NEWID2(4,@15),@CC01889                              1525 05936000
*   /*****************************************************************/ 05937000
*   /*                                                               */ 05938000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN     @Y30LB31*/ 05939000
*   /* THIS PROC.                                            @Y30LB31*/ 05940000
*   /*                                                               */ 05941000
*   /*****************************************************************/ 05942000
*                                                                  1526 05943000
*   SECCKRC=LASTCC00;               /*                       @Y30LB31*/ 05944000
*                                                                  1526 05945000
         SLR   @15,@15                                             1526 05946000
         STH   @15,SECCKRC                                         1526 05947000
*   /*****************************************************************/ 05948000
*   /*                                                               */ 05949000
*   /* DYNAMICALLY ALLOCATE A UNIT AND MOUNT THE VOLUME IF   @Y30LB31*/ 05950000
*   /* THE UNIT IS NOT ALREADY ALLOCATED.                    @Y30LB31*/ 05951000
*   /*                                                               */ 05952000
*   /*****************************************************************/ 05953000
*                                                                  1527 05954000
*   IF AUNITDDN=NODDNAME THEN       /*                       @Y30LB31*/ 05955000
         CLC   AUNITDDN(8),@CB01651                                1527 05956000
         BNE   @RF01527                                            1527 05957000
*     DO;                           /*                       @Y30LB31*/ 05958000
*       CALL ALLOCRTN;              /*                       @Y30LB31*/ 05959000
         BAL   @14,ALLOCRTN                                        1529 05960000
*       RESPECIFY                                                  1530 05961000
*         RTNREG RSTD;                                             1530 05962000
*       TESTRC=RTNREG;                                             1531 05963000
         LR    TESTRC,RTNREG                                       1531 05964000
*       RESPECIFY                                                  1532 05965000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 05966000
*                                                                  1532 05967000
*       /*************************************************************/ 05968000
*       /*                                                           */ 05969000
*       /* EXIT FROM THIS PROCEDURE IF DYNAMIC ALLOCATION    @Y30LB31*/ 05970000
*       /* FAILED.                                           @Y30LB31*/ 05971000
*       /*                                                           */ 05972000
*       /*************************************************************/ 05973000
*                                                                  1533 05974000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 05975000
         LTR   TESTRC,TESTRC                                       1533 05976000
         BZ    @RF01533                                            1533 05977000
*         SECCKRC=4;                /*                       @Y30LB31*/ 05978000
         MVC   SECCKRC(2),@CH00043                                 1534 05979000
*     END;                          /*                       @Y30LB31*/ 05980000
*                                                                  1535 05981000
*   /*****************************************************************/ 05982000
*   /*                                                               */ 05983000
*   /* CALL AN AMS SYSTEM ADAPTER ROUTINE TO MOUNT THE VOL   @Y30LB31*/ 05984000
*   /* IF A VOLUME SERIAL MISMATCH EXISTS BETWEEN THE CART AND VOL   */ 05985000
*   /* LABELS. OTHERWISE, AN OPEN VTOC EXECUTED BY THE VOLUME        */ 05986000
*   /*                                                       @Y30LB31*/ 05987000
*   /* SERVICES ROUTINE WILL CAUSE THE VOL TO BE MOUNTED.    @Y30LB31*/ 05988000
*   /*                                                               */ 05989000
*   /*****************************************************************/ 05990000
*                                                                  1536 05991000
*   ELSE                            /*                       @Y30LB31*/ 05992000
*     IF BCDBASE=ON&BCDSATIA=ZEROES THEN                           1536 05993000
         B     @RC01527                                            1536 05994000
@RF01527 TM    BCDBASE(BCDVPTR),B'00100000'                        1536 05995000
         BNO   @RF01536                                            1536 05996000
         CLC   BCDSATIA(2,BCDVPTR),@CB01654                        1536 05997000
         BE    @RT01536                                            1536 05998000
*       ;                           /* NO SPECIAL MNT        @Y30LB31*/ 05999000
*     ELSE                          /*                       @Y30LB31*/ 06000000
*       DO;                         /*                       @Y30LB31*/ 06001000
@RF01536 DS    0H                                                  1539 06002000
*         MOUNTFLG=ON;              /* VOL MOUNT REQUESTED   @Y30LB31*/ 06003000
*         WAITFLG=OFF;              /*                       @Y30LB31*/ 06004000
         OI    MOUNTFLG,B'01000000'                                1540 06005000
         NI    WAITFLG,B'11011111'                                 1540 06006000
*         VPREPVOL=MSVIVOL#;        /*                       @Y30LB31*/ 06007000
         MVC   VPREPVOL(6),MSVIVOL#                                1541 06008000
*         CALL VPREPRTN;            /*                       @Y30LB31*/ 06009000
         BAL   @14,VPREPRTN                                        1542 06010000
*         RESPECIFY                                                1543 06011000
*           RTNREG RSTD;                                           1543 06012000
*         TESTRC=RTNREG;                                           1544 06013000
         LR    TESTRC,RTNREG                                       1544 06014000
*         RESPECIFY                                                1545 06015000
*           RTNREG UNRSTD;          /*                       @Y30LB31*/ 06016000
*                                                                  1545 06017000
*         /***********************************************************/ 06018000
*         /*                                                         */ 06019000
*         /* EXIT FROM THIS PROC IF THE SPECIAL MOUNT        @Y30LB31*/ 06020000
*         /* FAILED FOR THE VOL WITH A SERIAL MISMATCH.      @Y30LB31*/ 06021000
*         /*                                                         */ 06022000
*         /***********************************************************/ 06023000
*                                                                  1546 06024000
*         IF TESTRC^=0 THEN         /*                       @Y30LB31*/ 06025000
         LTR   TESTRC,TESTRC                                       1546 06026000
         BZ    @RF01546                                            1546 06027000
*           SECCKRC=4;              /*                       @Y30LB31*/ 06028000
         MVC   SECCKRC(2),@CH00043                                 1547 06029000
*       END;                        /*                       @Y30LB31*/ 06030000
@RF01546 DS    0H                                                  1549 06031000
*                                                                  1549 06032000
*   /*****************************************************************/ 06033000
*   /*                                                               */ 06034000
*   /* IF THERE IS NO PROBLEM MOUNTING THE VOLUME FOR THE    @Y30LB31*/ 06035000
*   /* SECURITY AND VSAM CHECK OUT, CALL VTOCKRTN TO PERFORM THIS    */ 06036000
*   /* VTOC FUNCTION.                                        @Y30LB31*/ 06037000
*   /*                                                               */ 06038000
*   /*****************************************************************/ 06039000
*                                                                  1549 06040000
*   IF SECCKRC=0 THEN               /*                       @Y30LB31*/ 06041000
@RT01536 DS    0H                                                  1549 06042000
@RC01527 LH    @15,SECCKRC                                         1549 06043000
         LTR   @15,@15                                             1549 06044000
         BNZ   @RF01549                                            1549 06045000
*     DO;                           /*                       @Y30LB31*/ 06046000
*       CALL VTOCKRTN;              /*                       @Y30LB31*/ 06047000
         BAL   @14,VTOCKRTN                                        1551 06048000
*       RESPECIFY                                                  1552 06049000
*         RTNREG RSTD;                                             1552 06050000
*       TESTRC=RTNREG;                                             1553 06051000
         LR    TESTRC,RTNREG                                       1553 06052000
*       RESPECIFY                                                  1554 06053000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 06054000
*                                                                  1554 06055000
*       /*************************************************************/ 06056000
*       /*                                                           */ 06057000
*       /* SET AN UNSUCCESSFUL CONDITION CODE IF THE VSAM    @Y30LB31*/ 06058000
*       /* AND SECURITY CHECK COULD NOT BE PERFORMED.        @Y30LB31*/ 06059000
*       /*                                                           */ 06060000
*       /*************************************************************/ 06061000
*                                                                  1555 06062000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 06063000
         LTR   TESTRC,TESTRC                                       1555 06064000
         BZ    @RF01555                                            1555 06065000
*         SECCKRC=4;                /*                       @Y30LB31*/ 06066000
         MVC   SECCKRC(2),@CH00043                                 1556 06067000
*     END;                          /*                       @Y30LB31*/ 06068000
*                                                                  1557 06069000
@RF01555 DS    0H                                                  1558 06070000
*   /*****************************************************************/ 06071000
*   /*                                                               */ 06072000
*   /* RESTORE REG 14 TO THE RETURN ADDRESS OF THE CALLER    @Y30LB31*/ 06073000
*   /* AND EXIT FROM SECCKRTN. PASS THE CONDITION CODE IN REG 15.    */ 06074000
*   /*                                                       @Y30LB31*/ 06075000
*   /*                                                               */ 06076000
*   /*****************************************************************/ 06077000
*                                                                  1558 06078000
*   RESPECIFY                                                      1558 06079000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 06080000
@RF01549 DS    0H                                                  1559 06081000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 06082000
         L     REG14,RETADDR2                                      1559 06083000
*   RESPECIFY                                                      1560 06084000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 06085000
*   RETURN CODE(SECCKRC);           /*                       @Y30LB31*/ 06086000
         LH    @15,SECCKRC                                         1561 06087000
@EL00014 DS    0H                                                  1561 06088000
@EF00014 DS    0H                                                  1561 06089000
@ER00014 BR    @14                                                 1561 06090000
*   END SECCKRTN;                   /*                       @Y30LB31*/ 06091000
*                                                                  1563 06092000
*/********************************************************** @Y30LB31*/ 06093000
*/*                                                          @Y30LB31*/ 06094000
*/* PROCEDURE NAME - VPREPRTN                                @Y30LB31*/ 06095000
*/*                                                          @Y30LB31*/ 06096000
*/* FUNCTION - MOUNTS AND DEMOUNTS THE                       @Y30LB31*/ 06097000
*/*            VOLUME AND FOLLOWING A DEMOUNT RELEASES       @Y30LB31*/ 06098000
*/*            THE RESERVE SET BY THE VOL SERVICES ROUTINES  @Y30LB31*/ 06099000
*/*            WHICH CHECKED THE VTOC OR UPDATED THE VOL     @Y30LB31*/ 06100000
*/*            LABEL.  NO MESSAGES ARE ISSUED BY THIS PROC.  @Y30LB31*/ 06101000
*/*                                                          @Y30LB31*/ 06102000
*/* INPUT -  ADDVTBL, MDAGL.                                 @Y30LB31*/ 06103000
*/*                                                          @Y30LB31*/ 06104000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES VOL SUCCESSFULLY   @Y30LB31*/ 06105000
*/*          MOUNTED OR DEMOUNTED.  A RETURN CODE OF 4       @Y30LB31*/ 06106000
*/*          INDICATES A MOUNT OR DEMOUNT FAILURE.           @Y30LB31*/ 06107000
*/*                                                          @Y30LB31*/ 06108000
*/********************************************************** @Y30LB31*/ 06109000
*                                                                  1563 06110000
*VPREPRTN:                                                         1563 06111000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 06112000
*                                                                  1563 06113000
VPREPRTN DS    0H                                                  1564 06114000
*   /*****************************************************************/ 06115000
*   /*                                                               */ 06116000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 06117000
*   /*                                                               */ 06118000
*   /*****************************************************************/ 06119000
*                                                                  1564 06120000
*   DCL                                                            1564 06121000
*     VPREPRC FIXED(15);            /*                       @Y30LB31*/ 06122000
*                                                                  1564 06123000
*   /*****************************************************************/ 06124000
*   /*                                                               */ 06125000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON   @Y30LB31*/ 06126000
*   /* EXIT.                                                 @Y30LB31*/ 06127000
*   /*                                                               */ 06128000
*   /*****************************************************************/ 06129000
*                                                                  1565 06130000
*   RESPECIFY                                                      1565 06131000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 06132000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 06133000
         ST    REG14,RETADDR3                                      1566 06134000
*   RESPECIFY                                                      1567 06135000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 06136000
*   OLDERID2=NEWERID2;                                             1568 06137000
         L     @15,@PC00001                                        1568 06138000
         L     @14,GDTTR2(,@15)                                    1568 06139000
         MVC   @TS00001(95),NEWERID2(@14)                          1568 06140000
         MVC   OLDERID2(95,@14),@TS00001                           1568 06141000
*   NEWID2='AVVP';                  /*                       @Y30LB31*/ 06142000
*                                                                  1569 06143000
         MVC   NEWID2(4,@14),@CC01896                              1569 06144000
*   /*****************************************************************/ 06145000
*   /*                                                               */ 06146000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 06147000
*   /*                                                               */ 06148000
*   /*****************************************************************/ 06149000
*                                                                  1570 06150000
*   VPREPRC=LASTCC00;               /*                       @Y30LB31*/ 06151000
*                                                                  1570 06152000
         SLR   VPREPRC,VPREPRC                                     1570 06153000
*   /*****************************************************************/ 06154000
*   /*                                                               */ 06155000
*   /* IF A VOL DEMOUNT WAS REQUESTED, RELEASE THE           @ZA05125*/ 06156000
*   /* RESERVE SET BY EITHER IDCVS01 WHEN CHECKING THE VTOC OR BY    */ 06157000
*   /* IDCVS02 WHEN UPDATING THE VOL LABEL.                  @ZA05125*/ 06158000
*   /*                                                               */ 06159000
*   /*****************************************************************/ 06160000
*                                                                  1571 06161000
*   IF MOUNTFLG=OFF THEN            /*                       @ZA05125*/ 06162000
         TM    MOUNTFLG,B'01000000'                                1571 06163000
         BNZ   @RF01571                                            1571 06164000
*     DO;                           /*                       @ZA05125*/ 06165000
*       RNMSERNO=VPREPVOL;          /*                       @ZA05125*/ 06166000
         MVC   RNMSERNO(6),VPREPVOL                                1573 06167000
*       RNMTRAIL=RESERVE;           /*                       @ZA05119*/ 06168000
         MVC   RNMTRAIL(16),RESERVE                                1574 06169000
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @ZA05125*/ 06170000
         ST    @15,@AL00001                                        1575 06171000
         LA    @14,@CC01635                                        1575 06172000
         ST    @14,@AL00001+4                                      1575 06173000
         LA    @14,MINORNM                                         1575 06174000
         ST    @14,@AL00001+8                                      1575 06175000
         MVI   @AL00001+8,X'80'                                    1575 06176000
         L     @15,GDTDEQ(,@15)                                    1575 06177000
         LA    @01,@AL00001                                        1575 06178000
         BALR  @14,@15                                             1575 06179000
*     END;                          /*                       @ZA05125*/ 06180000
*                                                                  1576 06181000
*   /*****************************************************************/ 06182000
*   /*                                                               */ 06183000
*   /* IF THE MOUNT-DEMOUNT ARGUMENT LIST HAS NOT BEEN       @Y30LB31*/ 06184000
*   /* INITIALIZED, DO SO. THEN REUSE THE LIST FOR EACH SUBSEQUENT   */ 06185000
*   /* REQUEST IN ORDER NOT TO DESTROY THE ENQUEUE FLAG SET BY THE   */ 06186000
*   /* MOUNT ROUTINE AND USED BY THE DEMOUNT ROUTINE THAT IS @Y30LB31*/ 06187000
*   /* INVOKED.                                              @Y30LB31*/ 06188000
*   /*                                                               */ 06189000
*   /*****************************************************************/ 06190000
*                                                                  1577 06191000
*   IF MDDDNAME=NODDNAME THEN       /*                       @Y30LB31*/ 06192000
@RF01571 LA    @15,AVMDAGL                                         1577 06193000
         CLC   MDDDNAME(8,@15),@CB01651                            1577 06194000
         BNE   @RF01577                                            1577 06195000
*     DO;                           /*                       @Y30LB31*/ 06196000
*       MDDDNAME=AUNITDDN;          /*                       @Y30LB31*/ 06197000
         MVC   MDDDNAME(8,@15),AUNITDDN                            1579 06198000
*       MDUCBPTR=ADDR(AUNITUCB);    /*                       @Y30LB31*/ 06199000
         LA    @14,AUNITUCB                                        1580 06200000
         ST    @14,MDUCBPTR(,@15)                                  1580 06201000
*     END;                          /*                       @Y30LB31*/ 06202000
*   MDLABEL=VPREPVOL;               /*                       @Y30LB31*/ 06203000
@RF01577 LA    @15,AVMDAGL                                         1582 06204000
         MVC   MDLABEL(6,@15),VPREPVOL                             1582 06205000
*   IF WAITFLG=ON THEN              /*                       @Y30LB31*/ 06206000
         TM    WAITFLG,B'00100000'                                 1583 06207000
         BNO   @RF01583                                            1583 06208000
*     MDWAIT=ON;                    /*                       @Y30LB31*/ 06209000
         OI    MDWAIT(@15),B'00010000'                             1584 06210000
*   ELSE                            /*                       @Y30LB31*/ 06211000
*     MDWAIT=OFF;                   /*                       @Y30LB31*/ 06212000
         B     @RC01583                                            1585 06213000
@RF01583 LA    @15,AVMDAGL                                         1585 06214000
         NI    MDWAIT(@15),B'11101111'                             1585 06215000
*   IF MOUNTFLG=ON THEN             /*                       @Y30LB31*/ 06216000
@RC01583 TM    MOUNTFLG,B'01000000'                                1586 06217000
         BNO   @RF01586                                            1586 06218000
*     AMDTYPE=MOUNT;                /*                       @Y30LB31*/ 06219000
         MVC   AMDTYPE(8),MOUNT                                    1587 06220000
*   ELSE                            /*                       @Y30LB31*/ 06221000
*     AMDTYPE=DEMOUNT;              /*                       @Y30LB31*/ 06222000
*                                                                  1588 06223000
         B     @RC01586                                            1588 06224000
@RF01586 MVC   AMDTYPE(8),DEMOUNT                                  1588 06225000
*   /*****************************************************************/ 06226000
*   /*                                                               */ 06227000
*   /* TAKE A SYMBOLIC DUMP OF THE MOUNT-DEMOUNT PARM LIST   @Y30LB31*/ 06228000
*   /* BEFORE INVOKING THE MOUNT-DEMOUNT ROUTINE             @Y30LB31*/ 06229000
*   /*                                                               */ 06230000
*   /*****************************************************************/ 06231000
*                                                                  1589 06232000
*   IF GDTDBG=NULLPTR THEN                                         1589 06233000
@RC01586 L     @15,@PC00001                                        1589 06234000
         L     @15,GDTDBG(,@15)                                    1589 06235000
         LTR   @15,@15                                             1589 06236000
         BZ    @RT01589                                            1589 06237000
*     ;                                                            1590 06238000
*   ELSE                                                           1591 06239000
*     DO;                                                          1591 06240000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 06241000
         LA    DMPINDEX,AVDMPLST                                   1592 06242000
*       DMPITMNM='AVMDAGL';                                        1593 06243000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1593 06244000
         MVC   DMPITMNM(7,DMPINDEX),@CC01897                       1593 06245000
*       DMPITMPT=ADDR(AVMDAGL);                                    1594 06246000
         LA    @03,AVMDAGL                                         1594 06247000
         ST    @03,DMPITMPT(,DMPINDEX)                             1594 06248000
*       DMPITMLN=LENGTH(AVMDAGL);                                  1595 06249000
         MVC   DMPITMLN(2,DMPINDEX),@CH02001                       1595 06250000
*       DMPITMTP='H';                                              1596 06251000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1596 06252000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1597 06253000
*                                                                  1597 06254000
         LA    @03,16                                              1597 06255000
         ALR   DMPINDEX,@03                                        1597 06256000
*       /*************************************************************/ 06257000
*       /*                                                           */ 06258000
*       /*                                                   @Y30LB31*/ 06259000
*       /*                                                           */ 06260000
*       /*************************************************************/ 06261000
*                                                                  1598 06262000
*       DMPITMNM='ADDVTBL';                                        1598 06263000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1598 06264000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1598 06265000
*       DMPITMPT=ADDR(ADDVTBL);                                    1599 06266000
         LA    @15,ADDVTBL                                         1599 06267000
         ST    @15,DMPITMPT(,DMPINDEX)                             1599 06268000
*       DMPITMLN=LENGTH(ADDVTBL);                                  1600 06269000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1600 06270000
*       DMPITMTP='H';                                              1601 06271000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1601 06272000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1602 06273000
*                                                                  1602 06274000
         ALR   DMPINDEX,@03                                        1602 06275000
*       /*************************************************************/ 06276000
*       /*                                                           */ 06277000
*       /*                                                   @Y30LB31*/ 06278000
*       /*                                                           */ 06279000
*       /*************************************************************/ 06280000
*                                                                  1603 06281000
*       DMPTRM=DMPTRMVL;                                           1603 06282000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1603 06283000
*     END;                          /*                       @Y30LB31*/ 06284000
*   IF GDTDBG=NULLPTR THEN                                         1605 06285000
@RT01589 L     @15,@PC00001                                        1605 06286000
         L     @15,GDTDBG(,@15)                                    1605 06287000
         LTR   @15,@15                                             1605 06288000
         BZ    @RT01605                                            1605 06289000
*     ;                                                            1606 06290000
*   ELSE                                                           1607 06291000
*     CALL IDCDB010(GDTTBL,'AVMD',ADDR(AVDMPLST));/*         @Y30LB31*/ 06292000
*                                                                  1607 06293000
         L     @15,@PC00001                                        1607 06294000
         ST    @15,@AL00001                                        1607 06295000
         LA    @14,@CC01898                                        1607 06296000
         ST    @14,@AL00001+4                                      1607 06297000
         LA    @14,AVDMPLST                                        1607 06298000
         ST    @14,@AFTEMPS+24                                     1607 06299000
         LA    @14,@AFTEMPS+24                                     1607 06300000
         ST    @14,@AL00001+8                                      1607 06301000
         MVI   @AL00001+8,X'80'                                    1607 06302000
         L     @15,GDTDBG(,@15)                                    1607 06303000
         LA    @01,@AL00001                                        1607 06304000
         BALR  @14,@15                                             1607 06305000
*   /*****************************************************************/ 06306000
*   /*                                                               */ 06307000
*   /* MOUNT OR DEMOUNT THE VOLUME AS REQUESTED.             @Y30LB31*/ 06308000
*   /*                                                               */ 06309000
*   /*****************************************************************/ 06310000
*                                                                  1608 06311000
*   CALL IDCSA060(GDTTBL,AMDTYPE,MDAGL);/*                   @Y30LB31*/ 06312000
@RT01605 L     @02,@PC00001                                        1608 06313000
         ST    @02,@AL00001                                        1608 06314000
         LA    @15,AMDTYPE                                         1608 06315000
         ST    @15,@AL00001+4                                      1608 06316000
         LA    @15,AVMDAGL                                         1608 06317000
         ST    @15,@AL00001+8                                      1608 06318000
         MVI   @AL00001+8,X'80'                                    1608 06319000
         L     @15,GDTUNT(,@02)                                    1608 06320000
         LA    @01,@AL00001                                        1608 06321000
         BALR  @14,@15                                             1608 06322000
*   RESPECIFY                                                      1609 06323000
*     RTNREG RSTD;                                                 1609 06324000
*   TESTRC=RTNREG;                                                 1610 06325000
         LR    TESTRC,RTNREG                                       1610 06326000
*   RESPECIFY                                                      1611 06327000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 06328000
*   IF TESTRC=4 THEN                /*                       @Y30LB31*/ 06329000
         LA    @02,4                                               1612 06330000
         CR    TESTRC,@02                                          1612 06331000
         BNE   @RF01612                                            1612 06332000
*     VPREPRC=4;                    /*                       @Y30LB31*/ 06333000
*                                                                  1613 06334000
         LR    VPREPRC,@02                                         1613 06335000
*   /*****************************************************************/ 06336000
*   /*                                                               */ 06337000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER  @ZA05125*/ 06338000
*   /* AND EXIT FROM UPREPRTN. PASS THE CONDITION CODE IN REG 15.    */ 06339000
*   /*                                                       @Y30LB31*/ 06340000
*   /*                                                               */ 06341000
*   /*****************************************************************/ 06342000
*                                                                  1614 06343000
*   RESPECIFY                                                      1614 06344000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 06345000
@RF01612 DS    0H                                                  1615 06346000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 06347000
         L     REG14,RETADDR3                                      1615 06348000
*   RESPECIFY                                                      1616 06349000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 06350000
*   RETURN CODE(VPREPRC);           /*                       @Y30LB31*/ 06351000
         LR    @15,VPREPRC                                         1617 06352000
@EL00015 DS    0H                                                  1617 06353000
@EF00015 DS    0H                                                  1617 06354000
@ER00015 BR    @14                                                 1617 06355000
*   END VPREPRTN;                   /*                       @Y30LB31*/ 06356000
*                                                                  1619 06357000
*/********************************************************** @Y30LB31*/ 06358000
*/*                                                          @Y30LB31*/ 06359000
*/* PROCEDURE NAME - VTOCKRTN                                @Y30LB31*/ 06360000
*/*                                                          @Y30LB31*/ 06361000
*/* FUNCTION - FOR A BASE VOL, CHECKS FOR WRITE-LEVEL        @Y30LB31*/ 06362000
*/*            PROTECTED DATA SETS, UNEXPIRED DATA SETS,     @Y30LB31*/ 06363000
*/*            AND NON-VSAM STATUS ONLY.  FOR A DUPLICATE    @Y30LB31*/ 06364000
*/*            VOL, RETRIEVES THE VSAM OWNERSHIP STATUS FOR  @Y30LB31*/ 06365000
*/*            SUBSEQUENT TESTING.  NO MESSAGES ARE ISSUED   @Y30LB31*/ 06366000
*/*            BY THIS PROC.                                 @Y30LB31*/ 06367000
*/*                                                          @Y30LB31*/ 06368000
*/* INPUT - FDTTBL, ADDVTBL, BCDV FOR VOLUME RECORD.         @Y30LB31*/ 06369000
*/*                                                          @Y30LB31*/ 06370000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES A SUCCESSFUL       @Y30LB31*/ 06371000
*/*          SECURITY CHECK OR THE VSAM STATUS WAS           @Y30LB31*/ 06372000
*/*          RETRIEVED.  A RETURN CODE OF 4 INDICATES        @Y30LB31*/ 06373000
*/*          AN UNSUCCESSFUL SECURITY CHECK, OR FAILURE      @YD00175*/ 06374000
*/*          TO RETRIEVE THE VSAM STATUS FROM THE VTOC.      @YD00175*/ 06375000
*/*                                                          @Y30LB31*/ 06376000
*/********************************************************** @Y30LB31*/ 06377000
*                                                                  1619 06378000
*VTOCKRTN:                                                         1619 06379000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 06380000
*                                                                  1619 06381000
VTOCKRTN DS    0H                                                  1620 06382000
*   /*****************************************************************/ 06383000
*   /*                                                               */ 06384000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 06385000
*   /*                                                               */ 06386000
*   /*****************************************************************/ 06387000
*                                                                  1620 06388000
*   DCL                                                            1620 06389000
*     VTOCKRC FIXED(15);            /*                       @Y30LB31*/ 06390000
*                                                                  1620 06391000
*   /*****************************************************************/ 06392000
*   /*                                                               */ 06393000
*   /* DEFINE A COMMON AREA TO                               @Y30LB31*/ 06394000
*   /* TO DESCRIBE THE TYPE OF VOL SERVICE REQUEST.          @Y30LB31*/ 06395000
*   /*                                                               */ 06396000
*   /*****************************************************************/ 06397000
*                                                                  1621 06398000
*   DCL                                                            1621 06399000
*     AVS1TEST CHAR(8);             /*                       @Y30LB31*/ 06400000
*   DCL                                                            1622 06401000
*     IDCVS01 CHAR(8) CONSTANT('IDCVS01 ');/*                @Y30LB31*/ 06402000
*                                                                  1622 06403000
*   /*****************************************************************/ 06404000
*   /*                                                               */ 06405000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE           @Y30LB31*/ 06406000
*   /* IT UPON EXIT.                                         @Y30LB31*/ 06407000
*   /*                                                               */ 06408000
*   /*****************************************************************/ 06409000
*                                                                  1623 06410000
*   RESPECIFY                                                      1623 06411000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 06412000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 06413000
         ST    REG14,RETADDR3                                      1624 06414000
*   RESPECIFY                                                      1625 06415000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 06416000
*   OLDERID2=NEWERID2;                                             1626 06417000
         L     @05,@PC00001                                        1626 06418000
         L     @05,GDTTR2(,@05)                                    1626 06419000
         MVC   @TS00001(95),NEWERID2(@05)                          1626 06420000
         MVC   OLDERID2(95,@05),@TS00001                           1626 06421000
*   NEWID2='AVVC';                  /*                       @G24LB23*/ 06422000
*                                                                  1627 06423000
         MVC   NEWID2(4,@05),@CC01906                              1627 06424000
*   /*****************************************************************/ 06425000
*   /*                                                               */ 06426000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 06427000
*   /*                                                               */ 06428000
*   /*****************************************************************/ 06429000
*                                                                  1628 06430000
*   VTOCKRC=LASTCC00;               /*                       @Y30LB31*/ 06431000
*                                                                  1628 06432000
         SLR   @15,@15                                             1628 06433000
         LR    VTOCKRC,@15                                         1628 06434000
*   /*****************************************************************/ 06435000
*   /*                                                               */ 06436000
*   /* SETUP THE ARG LIST TO BE PASSED TO THE VOL SERV       @Y30LB31*/ 06437000
*   /* ROUTINE FOR THE VTOC CHECK. THEN SET THOSE FIELDS COMMON      */ 06438000
*   /*                                                       @Y30LB31*/ 06439000
*   /* TO EITHER THE VSAM OR SECURITY REQUEST.               @Y30LB31*/ 06440000
*   /*                                                               */ 06441000
*   /*****************************************************************/ 06442000
*                                                                  1629 06443000
*   VSRES=ON;                       /*                       @Y30LB31*/ 06444000
         LA    @05,AVVS1AGL                                        1629 06445000
         OI    VSRES(@05),B'10000000'                              1629 06446000
*   VSUCBP=ADDR(AUNITUCB);          /*                       @Y30LB31*/ 06447000
         LA    @14,AUNITUCB                                        1630 06448000
         ST    @14,VSUCBP(,@05)                                    1630 06449000
*   VSVOLP=ADDR(MSVIVOL#);          /*                       @Y30LB31*/ 06450000
         LA    @14,MSVIVOL#                                        1631 06451000
         ST    @14,VSVOLP(,@05)                                    1631 06452000
*   VSFILEP=ADDR(AUNITDDN);         /*                       @Y30LB31*/ 06453000
*                                                                  1632 06454000
         LA    @14,AUNITDDN                                        1632 06455000
         ST    @14,VSFILEP(,@05)                                   1632 06456000
*   /*****************************************************************/ 06457000
*   /*                                                               */ 06458000
*   /* IF THE VOL IS A BASE VOL, CHECK FOR WRITE-LEVEL       @Y30LB31*/ 06459000
*   /* PASSWORD PROTECTED DATA SETS, UNEXPIRED DATA SETS, AND        */ 06460000
*   /*                                                       @Y30LB31*/ 06461000
*   /* NON-VSAM STATUS ONLY.                                 @Y30LB31*/ 06462000
*   /*                                                               */ 06463000
*   /*****************************************************************/ 06464000
*                                                                  1633 06465000
*   IF BCDBASE=ON THEN              /*                       @Y30LB31*/ 06466000
         TM    BCDBASE(BCDVPTR),B'00100000'                        1633 06467000
         BNO   @RF01633                                            1633 06468000
*     DO;                           /*                       @Y30LB31*/ 06469000
*       VSWRITE=ON;                 /*                       @Y30LB31*/ 06470000
*       VSNOVSAM=ON;                /*                       @Y30LB31*/ 06471000
         OI    VSWRITE(@05),B'10001000'                            1636 06472000
*       IF ADDR(PFILE)^=NULLPTR THEN/*                       @Y30LB31*/ 06473000
         L     @14,@PC00001+4                                      1637 06474000
         L     @14,FDTPTR+32(,@14)                                 1637 06475000
         CR    @14,@15                                             1637 06476000
         BE    @RF01637                                            1637 06477000
*         VSPFILEP=ADDR(PFILE);     /*                       @Y30LB31*/ 06478000
         ST    @14,VSPFILEP(,@05)                                  1638 06479000
*       AVS1TEST=SECCHECK;          /*                       @Y30LB31*/ 06480000
@RF01637 MVC   AVS1TEST(8),SECCHECK                                1639 06481000
*     END;                          /*                       @Y30LB31*/ 06482000
*                                                                  1640 06483000
*   /*****************************************************************/ 06484000
*   /*                                                               */ 06485000
*   /* FOR A DUPLICATE VOL BYPASS THE SECURITY CHECK AND     @Y30LB31*/ 06486000
*   /* RETRIEVE THE VSAM OWNERSHIP STATUS.                   @Y30LB31*/ 06487000
*   /*                                                               */ 06488000
*   /*****************************************************************/ 06489000
*                                                                  1641 06490000
*   ELSE                            /*                       @Y30LB31*/ 06491000
*     DO;                           /*                       @Y30LB31*/ 06492000
         B     @RC01633                                            1641 06493000
@RF01633 DS    0H                                                  1642 06494000
*       VSVSFLAG=ON;                /*                       @Y30LB31*/ 06495000
         LA    @05,AVVS1AGL                                        1642 06496000
         OI    VSVSFLAG(@05),B'00100000'                           1642 06497000
*       AVS1TEST=GETVTOC;           /*                       @Y30LB31*/ 06498000
         MVC   AVS1TEST(8),GETVTOC                                 1643 06499000
*     END;                          /*                       @Y30LB31*/ 06500000
*                                                                  1645 06501000
*   /*****************************************************************/ 06502000
*   /*                                                               */ 06503000
*   /* TAKE A SYMBOLIC DUMP OF THE VOL SERVICES PARM LIST    @Y30LB31*/ 06504000
*   /* BEFORE CHECKING THE VTOC.                             @Y30LB31*/ 06505000
*   /*                                                               */ 06506000
*   /*****************************************************************/ 06507000
*                                                                  1645 06508000
*   IF GDTDBG=NULLPTR THEN                                         1645 06509000
@RC01633 L     @05,@PC00001                                        1645 06510000
         L     @05,GDTDBG(,@05)                                    1645 06511000
         LTR   @05,@05                                             1645 06512000
         BZ    @RT01645                                            1645 06513000
*     ;                                                            1646 06514000
*   ELSE                                                           1647 06515000
*     DO;                                                          1647 06516000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 06517000
         LA    DMPINDEX,AVDMPLST                                   1648 06518000
*       DMPITMNM='AVVS1AGL';                                       1649 06519000
         MVC   DMPITMNM(8,DMPINDEX),@CC01907                       1649 06520000
*       DMPITMPT=ADDR(AVVS1AGL);                                   1650 06521000
         LA    @05,AVVS1AGL                                        1650 06522000
         ST    @05,DMPITMPT(,DMPINDEX)                             1650 06523000
*       DMPITMLN=LENGTH(AVVS1AGL);                                 1651 06524000
         MVC   DMPITMLN(2,DMPINDEX),@CH02002                       1651 06525000
*       DMPITMTP='H';                                              1652 06526000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1652 06527000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1653 06528000
*                                                                  1653 06529000
         LA    @05,16                                              1653 06530000
         ALR   DMPINDEX,@05                                        1653 06531000
*       /*************************************************************/ 06532000
*       /*                                                           */ 06533000
*       /*                                                   @Y30LB31*/ 06534000
*       /*                                                           */ 06535000
*       /*************************************************************/ 06536000
*                                                                  1654 06537000
*       DMPITMNM='ADDVTBL';                                        1654 06538000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1654 06539000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1654 06540000
*       DMPITMPT=ADDR(ADDVTBL);                                    1655 06541000
         LA    @03,ADDVTBL                                         1655 06542000
         ST    @03,DMPITMPT(,DMPINDEX)                             1655 06543000
*       DMPITMLN=LENGTH(ADDVTBL);                                  1656 06544000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1656 06545000
*       DMPITMTP='H';                                              1657 06546000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1657 06547000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1658 06548000
*                                                                  1658 06549000
         ALR   DMPINDEX,@05                                        1658 06550000
*       /*************************************************************/ 06551000
*       /*                                                           */ 06552000
*       /*                                                   @Y30LB31*/ 06553000
*       /*                                                           */ 06554000
*       /*************************************************************/ 06555000
*                                                                  1659 06556000
*       DMPTRM=DMPTRMVL;                                           1659 06557000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1659 06558000
*     END;                          /*                       @Y30LB31*/ 06559000
*   IF GDTDBG=NULLPTR THEN                                         1661 06560000
@RT01645 L     @05,@PC00001                                        1661 06561000
         L     @05,GDTDBG(,@05)                                    1661 06562000
         LTR   @05,@05                                             1661 06563000
         BZ    @RT01661                                            1661 06564000
*     ;                                                            1662 06565000
*   ELSE                                                           1663 06566000
*     CALL IDCDB010(GDTTBL,'AVS1',ADDR(AVDMPLST));/*         @Y30LB31*/ 06567000
*                                                                  1663 06568000
         L     @05,@PC00001                                        1663 06569000
         ST    @05,@AL00001                                        1663 06570000
         LA    @15,@CC01908                                        1663 06571000
         ST    @15,@AL00001+4                                      1663 06572000
         LA    @15,AVDMPLST                                        1663 06573000
         ST    @15,@AFTEMPS+28                                     1663 06574000
         LA    @15,@AFTEMPS+28                                     1663 06575000
         ST    @15,@AL00001+8                                      1663 06576000
         MVI   @AL00001+8,X'80'                                    1663 06577000
         L     @15,GDTDBG(,@05)                                    1663 06578000
         LA    @01,@AL00001                                        1663 06579000
         BALR  @14,@15                                             1663 06580000
*   /*****************************************************************/ 06581000
*   /*                                                               */ 06582000
*   /* CALL THE VOLUME SERVICE ROUTINE WHICH PERFORMS THE    @Y30LB31*/ 06583000
*   /* VTOC CHECK.                                           @Y30LB31*/ 06584000
*   /*                                                               */ 06585000
*   /*****************************************************************/ 06586000
*                                                                  1664 06587000
*   CALL IDCSACL0(GDTTBL,IDCVS01,AVS1TEST,VS1AGL);/*         @Y30LB31*/ 06588000
@RT01661 L     @05,@PC00001                                        1664 06589000
         ST    @05,@AL00001                                        1664 06590000
         LA    @02,@CC01905                                        1664 06591000
         ST    @02,@AL00001+4                                      1664 06592000
         LA    @02,AVS1TEST                                        1664 06593000
         ST    @02,@AL00001+8                                      1664 06594000
         LA    @02,AVVS1AGL                                        1664 06595000
         ST    @02,@AL00001+12                                     1664 06596000
         MVI   @AL00001+12,X'80'                                   1664 06597000
         L     @15,GDTCAL(,@05)                                    1664 06598000
         LA    @01,@AL00001                                        1664 06599000
         BALR  @14,@15                                             1664 06600000
*   RESPECIFY                                                      1665 06601000
*     RTNREG RSTD;                                                 1665 06602000
*   TESTRC=RTNREG;                                                 1666 06603000
         LR    TESTRC,RTNREG                                       1666 06604000
*   RESPECIFY                                                      1667 06605000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 06606000
*                                                                  1667 06607000
*   /*****************************************************************/ 06608000
*   /*                                                               */ 06609000
*   /* PROCESS THE RETURN CODE FROM THE VOL SERVICE          @Y30LB31*/ 06610000
*   /* ROUTINE.                                              @Y30LB31*/ 06611000
*   /*                                                               */ 06612000
*   /*****************************************************************/ 06613000
*                                                                  1668 06614000
*   IF TESTRC=4 THEN                /*                       @Y30LB31*/ 06615000
         LA    @05,4                                               1668 06616000
         CR    TESTRC,@05                                          1668 06617000
         BNE   @RF01668                                            1668 06618000
*     VTOCKRC=4;                    /* SECURITY CHECK FAILED OR VSAM    06619000
*                                                            @Y30LB31   06620000
*                                      STATUS NOT RETRIEVED. @Y30LB31*/ 06621000
         LR    VTOCKRC,@05                                         1669 06622000
*   ELSE                            /*                       @Y30LB31*/ 06623000
*     IF TESTRC=8 THEN              /*                       @Y30LB31*/ 06624000
         B     @RC01668                                            1670 06625000
@RF01668 C     TESTRC,@CF00182                                     1670 06626000
         BNE   @RF01670                                            1670 06627000
*       CC04FLG=ON;                 /* A PASSWORD PROTECTED D.S. NOT    06628000
*                                                            @Y30LB31   06629000
*                                      CLOSED.               @Y30LB31*/ 06630000
         OI    CC04FLG,B'10000000'                                 1671 06631000
*                                                                  1672 06632000
*   /*****************************************************************/ 06633000
*   /*                                                               */ 06634000
*   /* CLOSE THE VTOC IF NOT CLOSED BY THE VOL SERVICES      @Y30LB31*/ 06635000
*   /* ROUTINE.                                              @Y30LB31*/ 06636000
*   /*                                                               */ 06637000
*   /*****************************************************************/ 06638000
*                                                                  1672 06639000
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB31*/ 06640000
@RF01670 DS    0H                                                  1672 06641000
@RC01668 LA    @05,AVVS1AGL                                        1672 06642000
         L     @15,VSIOP(,@05)                                     1672 06643000
         LTR   @15,@15                                             1672 06644000
         BZ    @RF01672                                            1672 06645000
*     DO;                           /*                       @Y30LB31*/ 06646000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB31*/ 06647000
         L     @02,@PC00001                                        1674 06648000
         ST    @02,@AL00001                                        1674 06649000
         LA    @05,VSIOP(,@05)                                     1674 06650000
         ST    @05,@AL00001+4                                      1674 06651000
         MVI   @AL00001+4,X'80'                                    1674 06652000
         L     @15,GDTCLS(,@02)                                    1674 06653000
         LA    @01,@AL00001                                        1674 06654000
         BALR  @14,@15                                             1674 06655000
*       RESPECIFY                                                  1675 06656000
*         RTNREG RSTD;                                             1675 06657000
*       TESTRC=RTNREG;                                             1676 06658000
         LR    TESTRC,RTNREG                                       1676 06659000
*       RESPECIFY                                                  1677 06660000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 06661000
*                                                                  1677 06662000
*       /*************************************************************/ 06663000
*       /*                                                           */ 06664000
*       /* SET THE EOJ COND CODE FLAG IF THE CLOSE FAILED.   @Y30LB31*/ 06665000
*       /*                                                           */ 06666000
*       /*************************************************************/ 06667000
*                                                                  1678 06668000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 06669000
         LTR   TESTRC,TESTRC                                       1678 06670000
         BZ    @RF01678                                            1678 06671000
*         CC04FLG=ON;               /*                       @Y30LB31*/ 06672000
         OI    CC04FLG,B'10000000'                                 1679 06673000
*     END;                          /*                       @Y30LB31*/ 06674000
*                                                                  1680 06675000
@RF01678 DS    0H                                                  1681 06676000
*   /*****************************************************************/ 06677000
*   /*                                                               */ 06678000
*   /* RELEASE THE RESERVE SET BY THE VOL SERVICES           @Y30LB31*/ 06679000
*   /* ROUTINE IF THE NEW VOL SERIAL NO. PROCESSING MUST     @Y30LB31*/ 06680000
*   /* TERMINATE.                                            @Y30LB31*/ 06681000
*   /*                                                               */ 06682000
*   /*****************************************************************/ 06683000
*                                                                  1681 06684000
*   IF VTOCKRC^=0 THEN              /*                       @Y30LB31*/ 06685000
@RF01672 LTR   VTOCKRC,VTOCKRC                                     1681 06686000
         BZ    @RF01681                                            1681 06687000
*     DO;                           /*                       @Y30LB31*/ 06688000
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/ 06689000
         MVC   RNMSERNO(6),MSVIVOL#                                1683 06690000
*       RNMTRAIL=RESERVE;           /*                       @ZA05119*/ 06691000
         MVC   RNMTRAIL(16),RESERVE                                1684 06692000
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/ 06693000
         L     @05,@PC00001                                        1685 06694000
         ST    @05,@AL00001                                        1685 06695000
         LA    @15,@CC01635                                        1685 06696000
         ST    @15,@AL00001+4                                      1685 06697000
         LA    @15,MINORNM                                         1685 06698000
         ST    @15,@AL00001+8                                      1685 06699000
         MVI   @AL00001+8,X'80'                                    1685 06700000
         L     @15,GDTDEQ(,@05)                                    1685 06701000
         LA    @01,@AL00001                                        1685 06702000
         BALR  @14,@15                                             1685 06703000
*     END;                          /*                       @Y30LB31*/ 06704000
*                                                                  1686 06705000
*   /*****************************************************************/ 06706000
*   /*                                                               */ 06707000
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER   @Y30LB31*/ 06708000
*   /* AND EXIT FROM VTOCKRTN. PASS THE CONDITION CODE IN REG 15.    */ 06709000
*   /*                                                       @Y30LB31*/ 06710000
*   /*                                                               */ 06711000
*   /*****************************************************************/ 06712000
*                                                                  1687 06713000
*   RESPECIFY                                                      1687 06714000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 06715000
@RF01681 DS    0H                                                  1688 06716000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 06717000
         L     REG14,RETADDR3                                      1688 06718000
*   RESPECIFY                                                      1689 06719000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 06720000
*   RETURN CODE(VTOCKRC);           /*                       @Y30LB31*/ 06721000
         LR    @15,VTOCKRC                                         1690 06722000
@EL00016 DS    0H                                                  1690 06723000
@EF00016 DS    0H                                                  1690 06724000
@ER00016 BR    @14                                                 1690 06725000
*   END VTOCKRTN;                   /*                       @Y30LB31*/ 06726000
*                                                                  1692 06727000
*/********************************************************** @Y30LB31*/ 06728000
*/*                                                          @Y30LB31*/ 06729000
*/* PROCEDURE NAME - CLABLRTN                                @Y30LB31*/ 06730000
*/*                                                          @Y30LB31*/ 06731000
*/* FUNCTION - DIRECTS THE VOLUME DEMOUNT, MSC RENAME        @Y30LB31*/ 06732000
*/*            TO CHANGE THE VOLUME SERIAL NO. IN THE        @Y30LB31*/ 06733000
*/*            CARTRIDGE LABELS, AND THE ACTIVATE WHICH      @Y30LB31*/ 06734000
*/*            PREPARES THE VOL FOR THE VOL LABEL UPDATE.    @Y30LB31*/ 06735000
*/*            CALLS VPREPRTN, RENAMRTN, AND ACTVRTN.        @Y30LB31*/ 06736000
*/*            ISSUES MESSAGES IDC2093I, IDC2091I,           @Y30LB31*/ 06737000
*/*            IDC0073I, IDC0064I, AND IDC0725I.             @Y30LB31*/ 06738000
*/*                                                          @Y30LB31*/ 06739000
*/* INPUT - ADDVTBL, PRINTTBL FOR MESSAGES,                  @Y30LB31*/ 06740000
*/*         BASEV AND BCDV FOR VOLUME RECORD.                @Y30LB31*/ 06741000
*/*                                                          @Y30LB31*/ 06742000
*/* OUTPUT - RETURN CODE OF 0 INDICATES BOTH A SUCCESSFUL    @Y30LB31*/ 06743000
*/*          CART LABEL UPDATE AND VOL ACTIVATE.  RETURN     @Y30LB31*/ 06744000
*/*          CODE OF 4 INDICATES A BASE VOL COULD NOT BE     @Y30LB31*/ 06745000
*/*          DEMOUNTED FOR THE CART LABEL UPDATE, OR THAT    @Y30LB31*/ 06746000
*/*          THE CART LABEL UPDATE FAILED.  RETURN CODE OF   @Y30LB31*/ 06747000
*/*          EIGHT INDICATES VOL ACTIVATE FAILED.            @Y30LB31*/ 06748000
*/*                                                          @Y30LB31*/ 06749000
*/********************************************************** @Y30LB31*/ 06750000
*                                                                  1692 06751000
*CLABLRTN:                                                         1692 06752000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 06753000
*                                                                  1692 06754000
CLABLRTN DS    0H                                                  1693 06755000
*   /*****************************************************************/ 06756000
*   /*                                                               */ 06757000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 06758000
*   /*                                                               */ 06759000
*   /*****************************************************************/ 06760000
*                                                                  1693 06761000
*   DCL                                                            1693 06762000
*     CLABLRC FIXED(15);            /*                       @Y30LB31*/ 06763000
*                                                                  1693 06764000
*   /*****************************************************************/ 06765000
*   /*                                                               */ 06766000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT        @Y30LB31*/ 06767000
*   /* UPON EXIT.                                            @Y30LB31*/ 06768000
*   /*                                                               */ 06769000
*   /*****************************************************************/ 06770000
*                                                                  1694 06771000
*   RESPECIFY                                                      1694 06772000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 06773000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 06774000
         ST    REG14,RETADDR2                                      1695 06775000
*   RESPECIFY                                                      1696 06776000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 06777000
*   OLDERID2=NEWERID2;                                             1697 06778000
         L     @15,@PC00001                                        1697 06779000
         L     @15,GDTTR2(,@15)                                    1697 06780000
         MVC   @TS00001(95),NEWERID2(@15)                          1697 06781000
         MVC   OLDERID2(95,@15),@TS00001                           1697 06782000
*   NEWID2='AVCL';                  /*                       @Y30LB31*/ 06783000
*                                                                  1698 06784000
         MVC   NEWID2(4,@15),@CC01913                              1698 06785000
*   /*****************************************************************/ 06786000
*   /*                                                               */ 06787000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 06788000
*   /*                                                               */ 06789000
*   /*****************************************************************/ 06790000
*                                                                  1699 06791000
*   CLABLRC=LASTCC00;               /*                       @Y30LB31*/ 06792000
*                                                                  1699 06793000
         SLR   @15,@15                                             1699 06794000
         STH   @15,CLABLRC                                         1699 06795000
*   /*****************************************************************/ 06796000
*   /*                                                               */ 06797000
*   /* A BASE VOLUME MUST BE DEMOUNTED TO UPDATE THE CART    @Y30LB31*/ 06798000
*   /* LABELS UNLESS THE SECURITY CHECK WAS BYPASSED. WHENEVER       */ 06799000
*   /*                                                       @Y30LB31*/ 06800000
*   /* THE ORIGINAL VOL SERIAL NO. IS BEING RESTORED DUE TO A        */ 06801000
*   /*                                                       @Y30LB31*/ 06802000
*   /* PREVIOUS RENAME FAILURE, THE SECURITY CHECK IS BYPASSED.      */ 06803000
*   /*                                                       @Y30LB31*/ 06804000
*   /*                                                               */ 06805000
*   /*****************************************************************/ 06806000
*                                                                  1700 06807000
*   IF BCDBASE=ON&BRECOVSW=OFF THEN /*                       @Y30LB31*/ 06808000
         TM    BCDBASE(BCDVPTR),B'00100000'                        1700 06809000
         BNO   @RF01700                                            1700 06810000
         TM    BRECOVSW,B'00000001'                                1700 06811000
         BNZ   @RF01700                                            1700 06812000
*     DO;                           /*                       @Y30LB31*/ 06813000
*       RENAMTYP=ACTIVE;            /*                       @Y30LB31*/ 06814000
         MVC   RENAMTYP(8),@CC01666                                1702 06815000
*       MOUNTFLG=OFF;               /* DEMOUNT REQUEST       @Y30LB31*/ 06816000
*       WAITFLG=ON;                 /*                       @Y30LB31*/ 06817000
         OI    WAITFLG,B'00100000'                                 1704 06818000
         NI    MOUNTFLG,B'10111111'                                1704 06819000
*       VPREPVOL=MSVIVOL#;          /*                       @Y30LB31*/ 06820000
         MVC   VPREPVOL(6),MSVIVOL#                                1705 06821000
*       CALL VPREPRTN;              /*                       @Y30LB31*/ 06822000
         BAL   @14,VPREPRTN                                        1706 06823000
*       RESPECIFY                                                  1707 06824000
*         RTNREG RSTD;                                             1707 06825000
*       TESTRC=RTNREG;                                             1708 06826000
         LR    TESTRC,RTNREG                                       1708 06827000
*       RESPECIFY                                                  1709 06828000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 06829000
*                                                                  1709 06830000
*       /*************************************************************/ 06831000
*       /*                                                           */ 06832000
*       /* EXIT FROM THIS PROC IF THE DEMOUNT FAILED.        @Y30LB31*/ 06833000
*       /*                                                           */ 06834000
*       /*************************************************************/ 06835000
*                                                                  1710 06836000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 06837000
         LTR   TESTRC,TESTRC                                       1710 06838000
         BZ    @RF01710                                            1710 06839000
*         CLABLRC=4;                /*                       @Y30LB31*/ 06840000
         MVC   CLABLRC(2),@CH00043                                 1711 06841000
*     END;                          /*                       @Y30LB31*/ 06842000
*                                                                  1712 06843000
*   /*****************************************************************/ 06844000
*   /*                                                               */ 06845000
*   /* INDICATE THE CART LABELS OF AN INACTIVE VOL ARE TO    @Y30LB31*/ 06846000
*   /* BE UPDATED IF THE VOL IS A DUPLICATE OR BASE VOL THAT @Y30LB31*/ 06847000
*   /* IS BEING RESTORED.                                    @Y30LB31*/ 06848000
*   /*                                                               */ 06849000
*   /*****************************************************************/ 06850000
*                                                                  1713 06851000
*   ELSE                            /*                       @Y30LB31*/ 06852000
*     RENAMTYP=INACTIVE;            /*                       @Y30LB31*/ 06853000
         B     @RC01700                                            1713 06854000
@RF01700 MVC   RENAMTYP(8),@CC01668                                1713 06855000
*                                                                  1714 06856000
*   /*****************************************************************/ 06857000
*   /*                                                               */ 06858000
*   /* CALL RENAMRTN TO UPDATE THE CART LABELS WITH THE      @Y30LB31*/ 06859000
*   /* NEW VOL SERIAL NO. AND OPTIONAL NEW VOL ATTRIBUTES.   @Y30LB31*/ 06860000
*   /*                                                               */ 06861000
*   /*****************************************************************/ 06862000
*                                                                  1714 06863000
*   IF CLABLRC=0 THEN               /*                       @Y30LB31*/ 06864000
@RC01700 LH    @15,CLABLRC                                         1714 06865000
         LTR   @15,@15                                             1714 06866000
         BNZ   @RF01714                                            1714 06867000
*     DO;                           /*                       @Y30LB31*/ 06868000
*       MSGFLG=OFF;                 /* DO NOT SAVE RENAME MSG      1716 06869000
*                                                            @Y30LB31*/ 06870000
         NI    MSGFLG,B'11101111'                                  1716 06871000
*       CALL RENAMRTN;              /*                       @Y30LB31*/ 06872000
         BAL   @14,RENAMRTN                                        1717 06873000
*       RESPECIFY                                                  1718 06874000
*         RTNREG RSTD;                                             1718 06875000
*       TESTRC=RTNREG;                                             1719 06876000
         LR    TESTRC,RTNREG                                       1719 06877000
*       RESPECIFY                                                  1720 06878000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 06879000
*                                                                  1720 06880000
*       /*************************************************************/ 06881000
*       /*                                                           */ 06882000
*       /* IF THE CART LABEL UPDATE FAILED EXIT FROM THIS    @Y30LB31*/ 06883000
*       /* PROC. ALSO, IF THE VOL ATTRIBUTES WERE TO BE UPDATED FOR  */ 06884000
*       /*                                                   @Y30LB31*/ 06885000
*       /* AN ACTIVE BASE VOL, ISSUE THE APPROPRIATE ERROR MSG.      */ 06886000
*       /*                                                   @Y30LB31*/ 06887000
*       /*                                                           */ 06888000
*       /*************************************************************/ 06889000
*                                                                  1721 06890000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 06891000
         LTR   TESTRC,TESTRC                                       1721 06892000
         BZ    @RF01721                                            1721 06893000
*         DO;                       /*                       @Y30LB31*/ 06894000
*           CLABLRC=4;              /*                       @Y30LB31*/ 06895000
         MVC   CLABLRC(2),@CH00043                                 1723 06896000
*           IF NEWVFFLG=ON&BCDBASE=ON&/*                     @Y30LB31*/ 06897000
*               BRECOVSW=OFF THEN   /*                       @Y30LB31*/ 06898000
         TM    NEWVFFLG,B'00001000'                                1724 06899000
         BNO   @RF01724                                            1724 06900000
         TM    BCDBASE(BCDVPTR),B'00100000'                        1724 06901000
         BNO   @RF01724                                            1724 06902000
         TM    BRECOVSW,B'00000001'                                1724 06903000
         BNZ   @RF01724                                            1724 06904000
*             DO;                   /*                       @Y30LB31*/ 06905000
*               PRINTTBL=''B;       /*                       @Y30LB31*/ 06906000
*                                                                  1726 06907000
         XC    PRINTTBL(28),PRINTTBL                               1726 06908000
*               /*****************************************************/ 06909000
*               /*                                                   */ 06910000
*               /* THE VOL ATTRIBUTES WERE BEING IMPLICITLY UPDATED  */ 06911000
*               /* TO AGREE WITH THE GROUP, BUT COULD NOT BE SET     */ 06912000
*               /*                                           @Y30LB31*/ 06913000
*               /* DUE TO AN ERROR.                          @Y30LB31*/ 06914000
*               /*                                                   */ 06915000
*               /*****************************************************/ 06916000
*                                                                  1727 06917000
*               IF GRPMSFLG=ON THEN /*                       @Y30LB31*/ 06918000
         TM    GRPMSFLG,B'00000010'                                1727 06919000
         BNO   @RF01727                                            1727 06920000
*                 DO;               /*                       @Y30LB31*/ 06921000
*                   DARGSMOD=COMMSGS;/*                      @Y30LB31*/ 06922000
         L     @15,DDSTRU                                          1729 06923000
         MVC   DARGSMOD(3,@15),@CC01697                            1729 06924000
*                   DARGSENT=MSG2093I;/* STID=CM054          @Y30LB31*/ 06925000
         MVI   DARGSENT(@15),X'36'                                 1730 06926000
*                   DARGDBP=ADDR(BASGROUP);/*                @Y30LB31*/ 06927000
         LA    @14,BASGROUP(,BASEVPTR)                             1731 06928000
         ST    @14,DARGDBP(,@15)                                   1731 06929000
*                   DARGILP=LENGTH(BASGROUP);/*              @Y30LB31*/ 06930000
         MVC   DARGILP(2,@15),@CH00182                             1732 06931000
*                 END;              /*                       @Y30LB31*/ 06932000
*                                                                  1733 06933000
*               /*****************************************************/ 06934000
*               /*                                                   */ 06935000
*               /* THE READWRITE ATTRIBUTE WAS REQUESTED     @Y30LB31*/ 06936000
*               /* BUT COULD NOT BE SET.                     @Y30LB31*/ 06937000
*               /*                                                   */ 06938000
*               /*****************************************************/ 06939000
*                                                                  1734 06940000
*               ELSE                /*                       @Y30LB31*/ 06941000
*                 DO;               /*                       @Y30LB31*/ 06942000
         B     @RC01727                                            1734 06943000
@RF01727 DS    0H                                                  1735 06944000
*                   DARGSMOD=ADDVMSGS;/*                     @Y30LB31*/ 06945000
         L     @15,DDSTRU                                          1735 06946000
         MVC   DARGSMOD(3,@15),@CC01687                            1735 06947000
*                   DARGSENT=MSG2091B;/* STID=AV04           @Y30LB31*/ 06948000
         MVI   DARGSENT(@15),X'04'                                 1736 06949000
*                   DARGDBP=ADDR(MSVIVOL#);/*                @Y30LB31*/ 06950000
         LA    @14,MSVIVOL#                                        1737 06951000
         ST    @14,DARGDBP(,@15)                                   1737 06952000
*                   DARGILP=LENGTH(MSVIVOL#);/*              @Y30LB31*/ 06953000
         MVC   DARGILP(2,@15),@CH00159                             1738 06954000
*                 END;              /*                       @Y30LB31*/ 06955000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB31*/ 06956000
@RC01727 L     @15,@PC00001                                        1740 06957000
         ST    @15,@AL00001                                        1740 06958000
         LA    @14,@CF00117                                        1740 06959000
         ST    @14,@AL00001+4                                      1740 06960000
         LA    @14,DDSTRU                                          1740 06961000
         ST    @14,@AL00001+8                                      1740 06962000
         MVI   @AL00001+8,X'80'                                    1740 06963000
         L     @15,GDTPRT(,@15)                                    1740 06964000
         LA    @01,@AL00001                                        1740 06965000
         BALR  @14,@15                                             1740 06966000
*             END;                  /*                       @Y30LB31*/ 06967000
*                                                                  1741 06968000
*           /*********************************************************/ 06969000
*           /*                                                       */ 06970000
*           /* CLOSE DO GROUP WHICH PROCESSED UNSUCCESSFUL   @Y30LB31*/ 06971000
*           /* CART LABEL UPDATE.                            @Y30LB31*/ 06972000
*           /*                                                       */ 06973000
*           /*********************************************************/ 06974000
*                                                                  1742 06975000
*         END;                      /*                       @Y30LB31*/ 06976000
*                                                                  1742 06977000
*       /*************************************************************/ 06978000
*       /*                                                           */ 06979000
*       /* ISSUE INFORMATIVE MESSAGES FOR A SUCCESSFUL       @Y30LB31*/ 06980000
*       /* CART LABEL UPDATE WITH THE NEW VOL SERIAL NO. AND OPTIONAL*/ 06981000
*       /* NEW VOL ATTRIBUTES. THEN ACTIVATE THE VOLUME FOR THE      */ 06982000
*       /*                                                   @Y30LB31*/ 06983000
*       /* SUBSEQUENT VOL LABEL UPDATE.                      @Y30LB31*/ 06984000
*       /*                                                           */ 06985000
*       /*************************************************************/ 06986000
*                                                                  1743 06987000
*       ELSE                        /*                       @Y30LB31*/ 06988000
*         DO;                       /*                       @Y30LB31*/ 06989000
         B     @RC01721                                            1743 06990000
@RF01721 DS    0H                                                  1744 06991000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 06992000
         XC    PRINTTBL(28),PRINTTBL                               1744 06993000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 06994000
         L     @15,DDSTRU                                          1745 06995000
         MVC   DARGSMOD(3,@15),@CC01697                            1745 06996000
*           DARGSENT=MSG0064I;      /* STID=CM046            @Y30LB31*/ 06997000
         MVI   DARGSENT(@15),X'2E'                                 1746 06998000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 06999000
*                                                                  1747 07000000
         L     @15,@PC00001                                        1747 07001000
         ST    @15,@AL00001                                        1747 07002000
         LA    @14,@CF00117                                        1747 07003000
         ST    @14,@AL00001+4                                      1747 07004000
         LA    @14,DDSTRU                                          1747 07005000
         ST    @14,@AL00001+8                                      1747 07006000
         MVI   @AL00001+8,X'80'                                    1747 07007000
         L     @15,GDTPRT(,@15)                                    1747 07008000
         LA    @01,@AL00001                                        1747 07009000
         BALR  @14,@15                                             1747 07010000
*           /*********************************************************/ 07011000
*           /*                                                       */ 07012000
*           /* ISSUE THE APPROPRIATE MSG IF THE VOL          @Y30LB31*/ 07013000
*           /* ATTRIBUTES WERE ALSO UPDATED.                 @Y30LB31*/ 07014000
*           /*                                                       */ 07015000
*           /*********************************************************/ 07016000
*                                                                  1748 07017000
*           IF NEWVFFLG=ON&ONLYROSW=OFF/*                    @Y30LB31*/ 07018000
*             THEN                  /*                       @Y30LB31*/ 07019000
         TM    NEWVFFLG,B'00001000'                                1748 07020000
         BNO   @RF01748                                            1748 07021000
         TM    ONLYROSW,B'10000000'                                1748 07022000
         BNZ   @RF01748                                            1748 07023000
*             DO;                   /*                       @Y30LB31*/ 07024000
*                                                                  1749 07025000
*               /*****************************************************/ 07026000
*               /*                                                   */ 07027000
*               /* ISSUE MSG IDC0073I IF THE VOL             @Y30LB31*/ 07028000
*               /* ATTRIBUTES WERE IMPLICITLY CHANGED TO AGREE WITH  */ 07029000
*               /* THE                                       @Y30LB31*/ 07030000
*               /* GROUP. ALSO, THE GROUP-MSG-SWITCH IS TURNED OFF TO*/ 07031000
*               /* AVOID                                     @Y30LB31*/ 07032000
*               /* ISSUING THE SAME MESSAGE AGAIN IF READONLY MUST BE*/ 07033000
*               /* SET                                       @Y30LB31*/ 07034000
*               /* FOLLOWING THE VOL LABEL UPDATE.           @Y30LB31*/ 07035000
*               /*                                                   */ 07036000
*               /*****************************************************/ 07037000
*                                                                  1750 07038000
*               IF GRPMSFLG=ON THEN /*                       @Y30LB31*/ 07039000
         TM    GRPMSFLG,B'00000010'                                1750 07040000
         BNO   @RF01750                                            1750 07041000
*                 DO;               /*                       @Y30LB31*/ 07042000
*                   GRPMSFLG=OFF;   /*                       @Y30LB31*/ 07043000
         NI    GRPMSFLG,B'11111101'                                1752 07044000
*                   DARGSMOD=COMMSGS;/*                      @Y30LB31*/ 07045000
         L     @15,DDSTRU                                          1753 07046000
         MVC   DARGSMOD(3,@15),@CC01697                            1753 07047000
*                   DARGSENT=MSG0073I;/* STID=CM033          @Y30LB31*/ 07048000
         MVI   DARGSENT(@15),X'21'                                 1754 07049000
*                   DARGDBP=ADDR(BASGROUP);/*                @Y30LB31*/ 07050000
         LA    @14,BASGROUP(,BASEVPTR)                             1755 07051000
         ST    @14,DARGDBP(,@15)                                   1755 07052000
*                   DARGILP=LENGTH(BASGROUP);/*              @Y30LB31*/ 07053000
         MVC   DARGILP(2,@15),@CH00182                             1756 07054000
*                 END;              /*                       @Y30LB31*/ 07055000
*                                                                  1757 07056000
*               /*****************************************************/ 07057000
*               /*                                                   */ 07058000
*               /* ISSUE MSG IDC0725I THAT THE REQUESTED     @Y30LB31*/ 07059000
*               /* READWRITE ATTRIBUTE WAS SUCCESSFULLY SET. @Y30LB31*/ 07060000
*               /*                                                   */ 07061000
*               /*****************************************************/ 07062000
*                                                                  1758 07063000
*               ELSE                /*                       @Y30LB31*/ 07064000
*                 DO;               /*                       @Y30LB31*/ 07065000
         B     @RC01750                                            1758 07066000
@RF01750 DS    0H                                                  1759 07067000
*                   DARGSMOD=ADDVMSGS;/*                     @Y30LB31*/ 07068000
         L     @15,DDSTRU                                          1759 07069000
         MVC   DARGSMOD(3,@15),@CC01687                            1759 07070000
*                   DARGSENT=MSG0725I;/* STID=AV06           @Y30LB31*/ 07071000
         MVI   DARGSENT(@15),X'06'                                 1760 07072000
*                   DARGDBP=ADDR(MSVIVOL#);/*                @Y30LB31*/ 07073000
         LA    @14,MSVIVOL#                                        1761 07074000
         ST    @14,DARGDBP(,@15)                                   1761 07075000
*                   DARGILP=LENGTH(MSVIVOL#);/*              @Y30LB31*/ 07076000
         MVC   DARGILP(2,@15),@CH00159                             1762 07077000
*                 END;              /*                       @Y30LB31*/ 07078000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB31*/ 07079000
@RC01750 L     @15,@PC00001                                        1764 07080000
         ST    @15,@AL00001                                        1764 07081000
         LA    @14,@CF00117                                        1764 07082000
         ST    @14,@AL00001+4                                      1764 07083000
         LA    @14,DDSTRU                                          1764 07084000
         ST    @14,@AL00001+8                                      1764 07085000
         MVI   @AL00001+8,X'80'                                    1764 07086000
         L     @15,GDTPRT(,@15)                                    1764 07087000
         LA    @01,@AL00001                                        1764 07088000
         BALR  @14,@15                                             1764 07089000
*             END;                  /*                       @Y30LB31*/ 07090000
*                                                                  1765 07091000
*           /*********************************************************/ 07092000
*           /*                                                       */ 07093000
*           /* ACTIVATE THE VOLUME FOLLOWING THE MSC         @Y30LB31*/ 07094000
*           /* RENAME OPERATION THAT UPDATED THE CART LABELS.        */ 07095000
*           /*                                               @Y30LB31*/ 07096000
*           /*                                                       */ 07097000
*           /*********************************************************/ 07098000
*                                                                  1766 07099000
*           MSGFLG=OFF;             /* DO NOT SAVE ACTIVATE MSG    1766 07100000
*                                                            @Y30LB31*/ 07101000
@RF01748 NI    MSGFLG,B'11101111'                                  1766 07102000
*           CALL ACTVRTN;           /*                       @Y30LB31*/ 07103000
         BAL   @14,ACTVRTN                                         1767 07104000
*           RESPECIFY                                              1768 07105000
*             RTNREG RSTD;                                         1768 07106000
*           TESTRC=RTNREG;                                         1769 07107000
         LR    TESTRC,RTNREG                                       1769 07108000
*           RESPECIFY                                              1770 07109000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 07110000
*                                                                  1770 07111000
*           /*********************************************************/ 07112000
*           /*                                                       */ 07113000
*           /* IF THE ACTIVATE FAILED, SET THE CONDITION     @Y30LB31*/ 07114000
*           /* CODE TO INDICATE ONLY CART LABEL UPDATE WAS           */ 07115000
*           /* SUCCESSFUL.                                   @Y30LB31*/ 07116000
*           /*                                                       */ 07117000
*           /*********************************************************/ 07118000
*                                                                  1771 07119000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 07120000
         LTR   TESTRC,TESTRC                                       1771 07121000
         BZ    @RF01771                                            1771 07122000
*             CLABLRC=LASTCC08;     /*                       @Y30LB31*/ 07123000
*                                                                  1772 07124000
         MVC   CLABLRC(2),@CH00182                                 1772 07125000
*           /*********************************************************/ 07126000
*           /*                                                       */ 07127000
*           /* CLOSE DO GROUP WHICH PROCESSED THE SUCCESSFUL @Y30LB31*/ 07128000
*           /* CART LABEL UPDATE FOLLOWED BY A VOLUME ACTIVATE.      */ 07129000
*           /*                                               @Y30LB31*/ 07130000
*           /*                                                       */ 07131000
*           /*********************************************************/ 07132000
*                                                                  1773 07133000
*         END;                      /*                       @Y30LB31*/ 07134000
*                                                                  1773 07135000
@RF01771 DS    0H                                                  1774 07136000
*       /*************************************************************/ 07137000
*       /*                                                           */ 07138000
*       /* CLOSE DO GROUP WHICH DIRECTED THE CART LABEL UPDATE       */ 07139000
*       /*                                                   @Y30LB31*/ 07140000
*       /* AND ACTIVATE.                                     @Y30LB31*/ 07141000
*       /*                                                           */ 07142000
*       /*************************************************************/ 07143000
*                                                                  1774 07144000
*     END;                          /*                       @Y30LB31*/ 07145000
*                                                                  1774 07146000
@RC01721 DS    0H                                                  1775 07147000
*   /*****************************************************************/ 07148000
*   /*                                                               */ 07149000
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER   @Y30LB31*/ 07150000
*   /* AND EXIT FROM CLABLRTN. PASS THE CONDITION CODE IN REG 15     */ 07151000
*   /*                                                       @Y30LB31*/ 07152000
*   /*                                                               */ 07153000
*   /*****************************************************************/ 07154000
*                                                                  1775 07155000
*   RESPECIFY                                                      1775 07156000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 07157000
@RF01714 DS    0H                                                  1776 07158000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 07159000
         L     REG14,RETADDR2                                      1776 07160000
*   RESPECIFY                                                      1777 07161000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 07162000
*   RETURN CODE(CLABLRC);           /*                       @Y30LB31*/ 07163000
         LH    @15,CLABLRC                                         1778 07164000
@EL00017 DS    0H                                                  1778 07165000
@EF00017 DS    0H                                                  1778 07166000
@ER00017 BR    @14                                                 1778 07167000
*   END CLABLRTN;                   /*                       @Y30LB31*/ 07168000
*                                                                  1780 07169000
*/********************************************************** @Y30LB31*/ 07170000
*/*                                                          @Y30LB31*/ 07171000
*/* PROCEDURE NAME - VLABLRTN                                @Y30LB31*/ 07172000
*/*                                                          @Y30LB31*/ 07173000
*/* FUNCTION - DIRECTS THE VOLUME LABEL UPDATE FOR THE NEW   @Y30LB31*/ 07174000
*/*            VOL SER NO., CLEARING OF THE SERIAL MISMATCH  @Y30LB31*/ 07175000
*/*            FLAG FROM THE MSVI, AND IF REQUIRED, A VOLUME @Y30LB31*/ 07176000
*/*            DEMOUNT AND READONLY ATTR UPDATE.  CALLS      @Y30LB31*/ 07177000
*/*            VPREPRTN, VS2RTN, MVRRTN, AND NEWFRTN TO      @Y30LB31*/ 07178000
*/*            PERFORM THESE FUNCTIONS.  MESSAGES IDC3070I,  @Y30LB31*/ 07179000
*/*            IDC0086I, IDC2093I, AND IDC2091I ARE ISSUED   @Y30LB31*/ 07180000
*/*            IN THIS PROC.                                 @Y30LB31*/ 07181000
*/*                                                          @Y30LB31*/ 07182000
*/* INPUT - ADDVTBL, PRINTTBL FOR MSGS, BASEV AND            @Y30LB31*/ 07183000
*/*         BCDV FOR VOLUME RECORD                           @Y30LB31*/ 07184000
*/*                                                          @Y30LB31*/ 07185000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES VOL LABEL UPDATED  @Y30LB31*/ 07186000
*/*          WITH NEW VOL SER NO.AND READONLY ATTR SET IF    @Y30LB31*/ 07187000
*/*          NECESSARY.                                      @Y30LB31*/ 07188000
*/*          A RETURN CODE OF 4 INDICATES THAT NEITHER THE   @Y30LB31*/ 07189000
*/*          VOL LABEL NOR READONLY ATTR WAS UPDATED.        @Y30LB31*/ 07190000
*/*          A RETURN CODE OF 8 INDICATES THAT THE VOL LABEL @Y30LB31*/ 07191000
*/*          WAS UPDATED BUT EITHER THE MISMATCH FLAG COULD  @Y30LB31*/ 07192000
*/*          NOT BE CLEARED FROM THE MSVI OR READONLY COULD  @Y30LB31*/ 07193000
*/*          NOT BE SET.                                     @Y30LB31*/ 07194000
*/*                                                          @Y30LB31*/ 07195000
*/********************************************************** @Y30LB31*/ 07196000
*                                                                  1780 07197000
*VLABLRTN:                                                         1780 07198000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 07199000
*                                                                  1780 07200000
VLABLRTN DS    0H                                                  1781 07201000
*   /*****************************************************************/ 07202000
*   /*                                                               */ 07203000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 07204000
*   /*                                                               */ 07205000
*   /*****************************************************************/ 07206000
*                                                                  1781 07207000
*   DCL                                                            1781 07208000
*     VLABLRC FIXED(15);            /*                       @Y30LB31*/ 07209000
*                                                                  1781 07210000
*   /*****************************************************************/ 07211000
*   /*                                                               */ 07212000
*   /* SAVE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT  @Y30LB31*/ 07213000
*   /* FOR THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY  */ 07214000
*   /* THIS PROC.                                            @Y30LB31*/ 07215000
*   /*                                                               */ 07216000
*   /*****************************************************************/ 07217000
*                                                                  1782 07218000
*   RESPECIFY                                                      1782 07219000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 07220000
*   RETADDR2=REG14;                 /*                       #Y30LB31*/ 07221000
         ST    REG14,RETADDR2                                      1783 07222000
*   RESPECIFY                                                      1784 07223000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 07224000
*   OLDERID2=NEWERID2;                                             1785 07225000
         L     @04,@PC00001                                        1785 07226000
         L     @04,GDTTR2(,@04)                                    1785 07227000
         MVC   @TS00001(95),NEWERID2(@04)                          1785 07228000
         MVC   OLDERID2(95,@04),@TS00001                           1785 07229000
*   NEWID2='AVVL';                  /*                       @Y30LB31*/ 07230000
         MVC   NEWID2(4,@04),@CC01918                              1786 07231000
*   VLABLRC=LASTCC00;               /*                       @Y30LB31*/ 07232000
*                                                                  1787 07233000
         SLR   VLABLRC,VLABLRC                                     1787 07234000
*   /*****************************************************************/ 07235000
*   /*                                                               */ 07236000
*   /* A SPECIAL VOLUME MOUNT IS REQUIRED DUE TO THE EXISTING VOL SER*/ 07237000
*   /* MISMATCH UNLESS THE VOL BEING RELABELED IS A          @Y30LB31*/ 07238000
*   /* DUPLICATE THAT IS STILL MOUNTED FROM THE EARLIER VSAM @Y30LB31*/ 07239000
*   /* CHECK OUT.                                            @Y30LB31*/ 07240000
*   /*                                                               */ 07241000
*   /*****************************************************************/ 07242000
*                                                                  1788 07243000
*   IF BCDDUP=ON THEN                                              1788 07244000
         TM    BCDDUP(BCDVPTR),B'00000100'                         1788 07245000
         BO    @RT01788                                            1788 07246000
*     ;                             /* NO SPECIAL MOUNT      @Y30LB31*/ 07247000
*   ELSE                            /*                       @Y30LB31*/ 07248000
*     DO;                           /*                       @Y30LB31*/ 07249000
*       MOUNTFLG=ON;                /*                       @Y30LB31*/ 07250000
*       WAITFLG=OFF;                /*                       @Y30LB31*/ 07251000
         OI    MOUNTFLG,B'01000000'                                1792 07252000
         NI    WAITFLG,B'11011111'                                 1792 07253000
*       VPREPVOL=MSVIVOL#;          /*                       @Y30LB31*/ 07254000
         MVC   VPREPVOL(6),MSVIVOL#                                1793 07255000
*       CALL VPREPRTN;              /*                       @Y30LB31*/ 07256000
         BAL   @14,VPREPRTN                                        1794 07257000
*       RESPECIFY                                                  1795 07258000
*         RTNREG RSTD;                                             1795 07259000
*       TESTRC=RTNREG;                                             1796 07260000
         LR    TESTRC,RTNREG                                       1796 07261000
*       RESPECIFY                                                  1797 07262000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 07263000
*                                                                  1797 07264000
*       /*************************************************************/ 07265000
*       /*                                                           */ 07266000
*       /* IF THE VOLUME CANNOT BE MOUNTED, ISSUE MSG        @Y30LB31*/ 07267000
*       /* IDC3070I DESCRIBING THE FAILURE TO UPDATE THE VOL SER NO. */ 07268000
*       /*                                                   @Y30LB31*/ 07269000
*       /* IN THE VOL LABEL. BEFORE EXITING FROM THIS PROCEDURE,     */ 07270000
*       /*                                                   @Y30LB31*/ 07271000
*       /* ISSUE A MSG THAT READONLY COULD NOT BE SET, IR REQUIRED.  */ 07272000
*       /*                                                   @Y30LB31*/ 07273000
*       /*                                                           */ 07274000
*       /*************************************************************/ 07275000
*                                                                  1798 07276000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 07277000
         LTR   TESTRC,TESTRC                                       1798 07278000
         BZ    @RF01798                                            1798 07279000
*         DO;                       /*                       @Y30LB31*/ 07280000
*           VLABLRC=4;              /*                       @Y30LB31*/ 07281000
         LA    VLABLRC,4                                           1800 07282000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 07283000
         XC    PRINTTBL(28),PRINTTBL                               1801 07284000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 07285000
         L     @04,DDSTRU                                          1802 07286000
         MVC   DARGSMOD(3,@04),@CC01697                            1802 07287000
*           DARGSENT=MSG3070I;      /* STID=CM036            @Y30LB31*/ 07288000
         MVI   DARGSENT(@04),X'24'                                 1803 07289000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 07290000
         L     @04,@PC00001                                        1804 07291000
         ST    @04,@AL00001                                        1804 07292000
         LA    @15,@CF00117                                        1804 07293000
         ST    @15,@AL00001+4                                      1804 07294000
         LA    @15,DDSTRU                                          1804 07295000
         ST    @15,@AL00001+8                                      1804 07296000
         MVI   @AL00001+8,X'80'                                    1804 07297000
         L     @15,GDTPRT(,@04)                                    1804 07298000
         LA    @01,@AL00001                                        1804 07299000
         BALR  @14,@15                                             1804 07300000
*         END;                      /*                       @Y30LB31*/ 07301000
*     END;                          /*                       @Y30LB31*/ 07302000
@RF01798 DS    0H                                                  1807 07303000
*                                                                  1807 07304000
*   /*****************************************************************/ 07305000
*   /*                                                               */ 07306000
*   /* IF THERE ARE NO ERRORS, CALL VS2RTN TO UPDATE THE VOL @Y30LB31*/ 07307000
*   /* LABEL WITH THE NEW VOL SERIAL NO.                     @Y30LB31*/ 07308000
*   /*                                                               */ 07309000
*   /*****************************************************************/ 07310000
*                                                                  1807 07311000
*   IF VLABLRC=0 THEN               /*                       @Y30LB31*/ 07312000
@RT01788 LTR   VLABLRC,VLABLRC                                     1807 07313000
         BNZ   @RF01807                                            1807 07314000
*     DO;                           /*                       @Y30LB31*/ 07315000
*       CALL VS2RTN;                /*                       @Y30LB31*/ 07316000
         BAL   @14,VS2RTN                                          1809 07317000
*       RESPECIFY                                                  1810 07318000
*         RTNREG RSTD;                                             1810 07319000
*       TESTRC=RTNREG;                                             1811 07320000
         LR    TESTRC,RTNREG                                       1811 07321000
*       RESPECIFY                                                  1812 07322000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 07323000
*                                                                  1812 07324000
*       /*************************************************************/ 07325000
*       /*                                                           */ 07326000
*       /* IF THE NEW SERIAL NO. COULD NOT BE UPDATED IN THE @Y30LB31*/ 07327000
*       /* VOL LABEL, PROCEED TO DEQUEUE THE RESERVE SET BY THE VOL  */ 07328000
*       /*                                                   @Y30LB31*/ 07329000
*       /* SERVICES ROUTINES AND OUTPUT THE READONLY MSG IF APPRO.   */ 07330000
*       /*                                                   @Y30LB31*/ 07331000
*       /* THEN EXIT FROM THIS PROC.                         @Y30LB31*/ 07332000
*       /*                                                           */ 07333000
*       /*************************************************************/ 07334000
*                                                                  1813 07335000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 07336000
         LTR   TESTRC,TESTRC                                       1813 07337000
         BZ    @RF01813                                            1813 07338000
*         VLABLRC=4;                /*                       @Y30LB31*/ 07339000
*                                                                  1814 07340000
         LA    VLABLRC,4                                           1814 07341000
*       /*************************************************************/ 07342000
*       /*                                                           */ 07343000
*       /* FOR A SUCCESSFUL VOL LABEL UPDATE, ISSUE          @Y30LB31*/ 07344000
*       /* INFORMATIVE MESSAGE IDC0086I.                     @Y30LB31*/ 07345000
*       /*                                                           */ 07346000
*       /*************************************************************/ 07347000
*                                                                  1815 07348000
*       ELSE                        /*                       @Y30LB31*/ 07349000
*         DO;                       /*                       @Y30LB31*/ 07350000
         B     @RC01813                                            1815 07351000
@RF01813 DS    0H                                                  1816 07352000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 07353000
         XC    PRINTTBL(28),PRINTTBL                               1816 07354000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 07355000
         L     @06,DDSTRU                                          1817 07356000
         MVC   DARGSMOD(3,@06),@CC01697                            1817 07357000
*           DARGSENT=MSG0086I;      /* STID=CM020            @Y30LB31*/ 07358000
         MVI   DARGSENT(@06),X'14'                                 1818 07359000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 07360000
*                                                                  1819 07361000
         L     @06,@PC00001                                        1819 07362000
         ST    @06,@AL00001                                        1819 07363000
         LA    @04,@CF00117                                        1819 07364000
         ST    @04,@AL00001+4                                      1819 07365000
         LA    @04,DDSTRU                                          1819 07366000
         ST    @04,@AL00001+8                                      1819 07367000
         MVI   @AL00001+8,X'80'                                    1819 07368000
         L     @15,GDTPRT(,@06)                                    1819 07369000
         LA    @01,@AL00001                                        1819 07370000
         BALR  @14,@15                                             1819 07371000
*           /*********************************************************/ 07372000
*           /*                                                       */ 07373000
*           /* FOLLOWING A SUCCESSFUL VOL LABEL UPDATE CLEAR @Y30LB31*/ 07374000
*           /* THE SERIAL MISMATCH FLAG FROM THE MSVI IF READONLY    */ 07375000
*           /* DOES NOT HAVE TO BE SET.                      @Y30LB31*/ 07376000
*           /*                                                       */ 07377000
*           /*********************************************************/ 07378000
*                                                                  1820 07379000
*           IF NEWROFLG=OFF THEN    /*                       @Y30LB31*/ 07380000
         TM    NEWROFLG,B'00000001'                                1820 07381000
         BNZ   @RF01820                                            1820 07382000
*             DO;                   /*                       @Y30LB31*/ 07383000
*               CALL MVRRTN;        /*                       @Y30LB31*/ 07384000
         BAL   @14,MVRRTN                                          1822 07385000
*               RESPECIFY                                          1823 07386000
*                 RTNREG RSTD;                                     1823 07387000
*               TESTRC=RTNREG;                                     1824 07388000
         LR    TESTRC,RTNREG                                       1824 07389000
*               RESPECIFY                                          1825 07390000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 07391000
*                                                                  1825 07392000
*               /*****************************************************/ 07393000
*               /*                                                   */ 07394000
*               /* IF THE MISMATCH FLAG COULD NOT BE CLEARED SET THE */ 07395000
*               /* CONDITION CODE TO 8 BECAUSE THE VOL HAS BEEN      */ 07396000
*               /*                                           @Y30LB31*/ 07397000
*               /* ACTIVATED.                                @Y30LB31*/ 07398000
*               /*                                                   */ 07399000
*               /*****************************************************/ 07400000
*                                                                  1826 07401000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 07402000
         LTR   TESTRC,TESTRC                                       1826 07403000
         BZ    @RF01826                                            1826 07404000
*                 VLABLRC=LASTCC08; /*                       @Y30LB31*/ 07405000
         LA    VLABLRC,8                                           1827 07406000
*             END;                  /*                       @Y30LB31*/ 07407000
@RF01826 DS    0H                                                  1829 07408000
*         END;                      /*                       @Y30LB31*/ 07409000
*                                                                  1829 07410000
@RF01820 DS    0H                                                  1830 07411000
*       /*************************************************************/ 07412000
*       /*                                                           */ 07413000
*       /* IF READONLY DOES NOT HAVE TO BE SET OR ERRORS     @Y30LB31*/ 07414000
*       /* HAVE BEEN ENCOUNTERED, RELEASE THE RESERVE SET BY ONE OF  */ 07415000
*       /*                                                   @Y30LB31*/ 07416000
*       /* THE VOLUME SERVICES ROUTINES. THEN OUTPUT THE READONLY-NOT*/ 07417000
*       /*                                                   @Y30LB31*/ 07418000
*       /* -SET MSG BEFORE EXITING FROM THIS PROC.           @Y30LB31*/ 07419000
*       /*                                                           */ 07420000
*       /*************************************************************/ 07421000
*                                                                  1830 07422000
*       IF NEWROFLG=OFF|VLABLRC^=0 THEN/*                    @Y30LB31*/ 07423000
@RC01813 TM    NEWROFLG,B'00000001'                                1830 07424000
         BZ    @RT01830                                            1830 07425000
         LTR   VLABLRC,VLABLRC                                     1830 07426000
         BZ    @RF01830                                            1830 07427000
@RT01830 DS    0H                                                  1831 07428000
*         DO;                       /*                       @Y30LB31*/ 07429000
*           RNMSERNO=MSVIVOL#;      /*                       @Y30LB31*/ 07430000
         MVC   RNMSERNO(6),MSVIVOL#                                1832 07431000
*           RNMTRAIL=RESERVE;       /*                       @ZA05119*/ 07432000
         MVC   RNMTRAIL(16),RESERVE                                1833 07433000
*           CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*         @Y30LB31*/ 07434000
         L     @06,@PC00001                                        1834 07435000
         ST    @06,@AL00001                                        1834 07436000
         LA    @04,@CC01635                                        1834 07437000
         ST    @04,@AL00001+4                                      1834 07438000
         LA    @04,MINORNM                                         1834 07439000
         ST    @04,@AL00001+8                                      1834 07440000
         MVI   @AL00001+8,X'80'                                    1834 07441000
         L     @15,GDTDEQ(,@06)                                    1834 07442000
         LA    @01,@AL00001                                        1834 07443000
         BALR  @14,@15                                             1834 07444000
*         END;                      /*                       @Y30LB31*/ 07445000
*                                                                  1835 07446000
*       /*************************************************************/ 07447000
*       /*                                                           */ 07448000
*       /* IF READONLY IS TO BE SET AND NO ERRORS HAVE BEEN  @Y30LB31*/ 07449000
*       /* ENCOUNTERED, DEMOUNT THE VOL IN ORDER TO UPDATE THE VOLUME*/ 07450000
*       /* ATTRIBUTES TO READONLY.                           @Y30LB31*/ 07451000
*       /*                                                           */ 07452000
*       /*************************************************************/ 07453000
*                                                                  1836 07454000
*       ELSE                        /*                       @Y30LB31*/ 07455000
*         DO;                       /*                       @Y30LB31*/ 07456000
         B     @RC01830                                            1836 07457000
@RF01830 DS    0H                                                  1837 07458000
*           MOUNTFLG=OFF;           /*                       @Y30LB31*/ 07459000
*           WAITFLG=ON;             /*                       @Y30LB31*/ 07460000
         OI    WAITFLG,B'00100000'                                 1838 07461000
         NI    MOUNTFLG,B'10111111'                                1838 07462000
*           VPREPVOL=MSVIVOL#;      /*                       @Y30LB31*/ 07463000
         MVC   VPREPVOL(6),MSVIVOL#                                1839 07464000
*           CALL VPREPRTN;          /*                       @Y30LB31*/ 07465000
         BAL   @14,VPREPRTN                                        1840 07466000
*           RESPECIFY                                              1841 07467000
*             RTNREG RSTD;                                         1841 07468000
*           TESTRC=RTNREG;                                         1842 07469000
         LR    TESTRC,RTNREG                                       1842 07470000
*           RESPECIFY                                              1843 07471000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 07472000
*                                                                  1843 07473000
*           /*********************************************************/ 07474000
*           /*                                                       */ 07475000
*           /* IF THE VOL DEMOUNT FAILED, THE VOL ATTRIBUTES CANNOT  */ 07476000
*           /* BE UPDATED. PROCEED TO OUTPUT THE APPROPRIATE ERROR SG*/ 07477000
*           /* AND TO CLEAR THE SERIAL MISMATCH FLAG FROM THE MSVI.  */ 07478000
*           /*                                               @Y30LB31*/ 07479000
*           /*                                                       */ 07480000
*           /*********************************************************/ 07481000
*                                                                  1844 07482000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 07483000
         LTR   TESTRC,TESTRC                                       1844 07484000
         BZ    @RF01844                                            1844 07485000
*             VLABLRC=LASTCC08;     /*                       @Y30LB31*/ 07486000
         LA    VLABLRC,8                                           1845 07487000
*         END;                      /*                       @Y30LB31*/ 07488000
*                                                                  1846 07489000
@RF01844 DS    0H                                                  1847 07490000
*       /*************************************************************/ 07491000
*       /*                                                           */ 07492000
*       /* CLOSE DO GROUP THAT HANDLED THE VOL LABEL UPDATE, @Y30LB31*/ 07493000
*       /* DEQUEUE, AND DEMOUNT.                             @Y30LB31*/ 07494000
*       /*                                                           */ 07495000
*       /*************************************************************/ 07496000
*                                                                  1847 07497000
*     END;                          /*                       @Y30LB31*/ 07498000
@RC01830 DS    0H                                                  1848 07499000
*                                                                  1848 07500000
*   /*****************************************************************/ 07501000
*   /*                                                               */ 07502000
*   /* DETERMINE WHETHER THE VOL ATTRIBUTES ARE TO BE UPDATED TO     */ 07503000
*   /* READONLY FOLLOWING THE VOL LABEL UPDATE.              @Y30LB31*/ 07504000
*   /*                                                               */ 07505000
*   /*****************************************************************/ 07506000
*                                                                  1848 07507000
*   IF NEWROFLG=ON THEN             /*                       @Y30LB31*/ 07508000
@RF01807 TM    NEWROFLG,B'00000001'                                1848 07509000
         BNO   @RF01848                                            1848 07510000
*     DO;                           /*                       @Y30LB31*/ 07511000
*                                                                  1849 07512000
*       /*************************************************************/ 07513000
*       /*                                                           */ 07514000
*       /* IF ERRORS HAVE BEEN ENCOUNTERED, BYPASS SETTTING READONLY.*/ 07515000
*       /* PRINT MSG IDC2093I IF THE VOL ATTRS ARE BEING     @Y30LB31*/ 07516000
*       /* IMPLICITLY CHANGED TO AGREE WITH THE GROUP. IF THIS MSG   */ 07517000
*       /*                                                   @Y30LB31*/ 07518000
*       /* HAS BEEN ISSUED EARLIER, PRINT MSG IDC2091I INSTEAD SINCE */ 07519000
*       /*                                                   @Y30LB31*/ 07520000
*       /* READONLY IS THE ONLY ATTR NOT IMPLICITLY CHANGED. @Y30LB31*/ 07521000
*       /*                                                           */ 07522000
*       /*************************************************************/ 07523000
*                                                                  1850 07524000
*       IF VLABLRC^=0 THEN          /*                       @Y30LB31*/ 07525000
         LTR   VLABLRC,VLABLRC                                     1850 07526000
         BZ    @RF01850                                            1850 07527000
*         DO;                       /*                       @Y30LB31*/ 07528000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 07529000
         XC    PRINTTBL(28),PRINTTBL                               1852 07530000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 07531000
         L     @06,DDSTRU                                          1853 07532000
         MVC   DARGSMOD(3,@06),@CC01697                            1853 07533000
*           IF GRPMSFLG=ON THEN     /*                       @Y30LB31*/ 07534000
         TM    GRPMSFLG,B'00000010'                                1854 07535000
         BNO   @RF01854                                            1854 07536000
*             DO;                   /*                       @Y30LB31*/ 07537000
*               DARGSENT=MSG2093I;  /* STID=CM054            @Y30LB31*/ 07538000
         MVI   DARGSENT(@06),X'36'                                 1856 07539000
*               DARGDBP=ADDR(BASGROUP);/*                    @Y30LB31*/ 07540000
         LA    @04,BASGROUP(,BASEVPTR)                             1857 07541000
         ST    @04,DARGDBP(,@06)                                   1857 07542000
*               DARGILP=LENGTH(BASGROUP);/*                  @Y30LB31*/ 07543000
         MVC   DARGILP(2,@06),@CH00182                             1858 07544000
*             END;                  /*                       @Y30LB31*/ 07545000
*           ELSE                    /*                       @Y30LB31*/ 07546000
*             DO;                   /*                       @Y30LB31*/ 07547000
         B     @RC01854                                            1860 07548000
@RF01854 DS    0H                                                  1861 07549000
*               DARGSENT=MSG2091A;  /* STID=CM015            @Y30LB31*/ 07550000
         L     @04,DDSTRU                                          1861 07551000
         MVI   DARGSENT(@04),X'0F'                                 1861 07552000
*               DARGDBP=ADDR(MSVIVOL#);/*                    @Y30LB31*/ 07553000
         LA    @15,MSVIVOL#                                        1862 07554000
         ST    @15,DARGDBP(,@04)                                   1862 07555000
*               DARGILP=LENGTH(MSVIVOL#);/*                  @Y30LB31*/ 07556000
         MVC   DARGILP(2,@04),@CH00159                             1863 07557000
*             END;                  /*                       @Y30LB31*/ 07558000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 07559000
@RC01854 L     @04,@PC00001                                        1865 07560000
         ST    @04,@AL00001                                        1865 07561000
         LA    @15,@CF00117                                        1865 07562000
         ST    @15,@AL00001+4                                      1865 07563000
         LA    @15,DDSTRU                                          1865 07564000
         ST    @15,@AL00001+8                                      1865 07565000
         MVI   @AL00001+8,X'80'                                    1865 07566000
         L     @15,GDTPRT(,@04)                                    1865 07567000
         LA    @01,@AL00001                                        1865 07568000
         BALR  @14,@15                                             1865 07569000
*         END;                      /*                       @Y30LB31*/ 07570000
*                                                                  1866 07571000
*       /*************************************************************/ 07572000
*       /*                                                           */ 07573000
*       /* SINCE NO ERRORS HAVE BEEN ENCOUNTERED, CALL NEWVFRTN TO   */ 07574000
*       /* SET THE READONLY VOL ATTR TO AGREE WITH THE GROUP AND TO  */ 07575000
*       /* CLEAR THE MISMATCH FLAG FROM THE VOL RECORD IN CONJUNCTION*/ 07576000
*       /* WITH THE ATTR UPDATE.                             @Y30LB31*/ 07577000
*       /*                                                           */ 07578000
*       /*************************************************************/ 07579000
*                                                                  1867 07580000
*       ELSE                        /*                       @Y30LB31*/ 07581000
*         DO;                       /*                       @Y30LB31*/ 07582000
         B     @RC01850                                            1867 07583000
@RF01850 DS    0H                                                  1868 07584000
*           CALL NEWVFRTN;          /*                       @Y30LB31*/ 07585000
         BAL   @14,NEWVFRTN                                        1868 07586000
*           RESPECIFY                                              1869 07587000
*             RTNREG RSTD;                                         1869 07588000
*           TESTRC=RTNREG;                                         1870 07589000
         LR    TESTRC,RTNREG                                       1870 07590000
*           RESPECIFY                                              1871 07591000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 07592000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 07593000
         LTR   TESTRC,TESTRC                                       1872 07594000
         BZ    @RF01872                                            1872 07595000
*             VLABLRC=LASTCC08;     /*                       @Y30LB31*/ 07596000
         LA    VLABLRC,8                                           1873 07597000
*         END;                      /*                       @Y30LB31*/ 07598000
*                                                                  1874 07599000
@RF01872 DS    0H                                                  1875 07600000
*       /*************************************************************/ 07601000
*       /*                                                           */ 07602000
*       /* IF READONLY COULD NOT BE SET BUT THE NEW VOL SER NO. HAS  */ 07603000
*       /* BEEN SUCCESSFULLY UPDATED IN THE VOL LABEL, THE   @Y30LB31*/ 07604000
*       /* SERIAL MISMATCH FLAG CAN BE CLEARED FROM THE MSVI.        */ 07605000
*       /*                                                   @Y30LB31*/ 07606000
*       /*                                                           */ 07607000
*       /*************************************************************/ 07608000
*                                                                  1875 07609000
*       IF VLABLRC>LASTCC04 THEN    /*                       @Y30LB31*/ 07610000
@RC01850 C     VLABLRC,@CF00043                                    1875 07611000
         BNH   @RF01875                                            1875 07612000
*         DO;                       /*                       @Y30LB31*/ 07613000
*           CALL MVRRTN;            /*                       @Y30LB31*/ 07614000
         BAL   @14,MVRRTN                                          1877 07615000
*           RESPECIFY                                              1878 07616000
*             RTNREG RSTD;                                         1878 07617000
*           TESTRC=RTNREG;                                         1879 07618000
         LR    TESTRC,RTNREG                                       1879 07619000
*           RESPECIFY                                              1880 07620000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 07621000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 07622000
         LTR   TESTRC,TESTRC                                       1881 07623000
         BZ    @RF01881                                            1881 07624000
*             VLABLRC=LASTCC08;     /*                       @Y30LB31*/ 07625000
         LA    VLABLRC,8                                           1882 07626000
*         END;                      /*                       @Y30LB31*/ 07627000
*                                                                  1883 07628000
@RF01881 DS    0H                                                  1884 07629000
*       /*************************************************************/ 07630000
*       /*                                                           */ 07631000
*       /* CLOSE THE DO GROUP WHICH PROCESSED THE READONLY   @Y30LB31*/ 07632000
*       /* UPDATE REQUEST.                                   @Y30LB31*/ 07633000
*       /*                                                           */ 07634000
*       /*************************************************************/ 07635000
*                                                                  1884 07636000
*     END;                          /*                       @Y30LB31*/ 07637000
*                                                                  1884 07638000
@RF01875 DS    0H                                                  1885 07639000
*   /*****************************************************************/ 07640000
*   /*                                                               */ 07641000
*   /* RESTORE REG 14 TO THE RETURN ADDRESS OF THE CALLER    @Y30LB31*/ 07642000
*   /* AND EXIT FROM VLABLRTN. PASS THE CONDITION CODE IN REG 15.    */ 07643000
*   /*                                                       @Y30LB31*/ 07644000
*   /*                                                               */ 07645000
*   /*****************************************************************/ 07646000
*                                                                  1885 07647000
*   RESPECIFY                                                      1885 07648000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 07649000
@RF01848 DS    0H                                                  1886 07650000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 07651000
         L     REG14,RETADDR2                                      1886 07652000
*   RESPECIFY                                                      1887 07653000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 07654000
*   RETURN CODE(VLABLRC);           /*                       @Y30LB31*/ 07655000
         LR    @15,VLABLRC                                         1888 07656000
@EL00018 DS    0H                                                  1888 07657000
@EF00018 DS    0H                                                  1888 07658000
@ER00018 BR    @14                                                 1888 07659000
*   END VLABLRTN;                   /*                       @Y30LB31*/ 07660000
*                                                                  1890 07661000
*/********************************************************** @Y30LB31*/ 07662000
*/*                                                          @Y30LB31*/ 07663000
*/* PROCEDURE NAME - VS2RTN                                  @Y30LB31*/ 07664000
*/*                                                          @Y30LB31*/ 07665000
*/* FUNCTION - UPDATES THE VOLUME LABEL WITH THE NEW VOLUME  @Y30LB31*/ 07666000
*/*            SERIAL NO.  NO MESSAGES ARE ISSUED BY THIS    @Y30LB31*/ 07667000
*/*            PROC.                                         @Y30LB31*/ 07668000
*/*                                                          @Y30LB31*/ 07669000
*/* INPUT - ADDVTBL, BCDV FOR VOLUME RECORD, AND             @Y30LB31*/ 07670000
*/*         VS2AGL.                                          @Y30LB31*/ 07671000
*/*                                                          @Y30LB31*/ 07672000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES A SUCCESSFUL VOL   @Y30LB31*/ 07673000
*/*          LABEL UPDATE.  ADDVTBL MAY BE UPDATED.          @Y30LB31*/ 07674000
*/*          A RETURN CODE OF 4 INDICATES THE VOL LABEL      @Y30LB31*/ 07675000
*/*          UPDATE FAILED.                                  @Y30LB31*/ 07676000
*/*                                                          @Y30LB31*/ 07677000
*/********************************************************** @Y30LB31*/ 07678000
*                                                                  1890 07679000
*VS2RTN:                                                           1890 07680000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 07681000
*                                                                  1890 07682000
VS2RTN   DS    0H                                                  1891 07683000
*   /*****************************************************************/ 07684000
*   /*                                                               */ 07685000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 07686000
*   /*                                                               */ 07687000
*   /*****************************************************************/ 07688000
*                                                                  1891 07689000
*   DCL                                                            1891 07690000
*     VS2RTNRC FIXED(15);           /*                       @Y30LB31*/ 07691000
*                                                                  1891 07692000
*   /*****************************************************************/ 07693000
*   /*                                                               */ 07694000
*   /* LOCAL DECLARATIONS. SETUP STORAGE AREA TO BUILD THE PARM LIST */ 07695000
*   /* FOR THE SECOND VOLUME SERVICES ROUTINE WHICH          @Y30LB31*/ 07696000
*   /* READS AND UPDATES VOL LABELS.                         @Y30LB31*/ 07697000
*   /*                                                               */ 07698000
*   /*****************************************************************/ 07699000
*                                                                  1892 07700000
*   DCL                                                            1892 07701000
*     AVVS2AGL CHAR(LENGTH(VS2AGL)) BDY(WORD);/*             @Y30LB31*/ 07702000
*   DCL                                                            1893 07703000
*     IDCVS02 CHAR(8) CONSTANT('IDCVS02 ');/*                @Y30LB31*/ 07704000
*                                                                  1893 07705000
*   /*****************************************************************/ 07706000
*   /*                                                               */ 07707000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON   @Y30LB31*/ 07708000
*   /* EXIT FROM THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE    */ 07709000
*   /* USED BY THIS PROC.                                    @Y30LB31*/ 07710000
*   /*                                                               */ 07711000
*   /*****************************************************************/ 07712000
*                                                                  1894 07713000
*   RESPECIFY                                                      1894 07714000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 07715000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 07716000
         ST    REG14,RETADDR3                                      1895 07717000
*   RESPECIFY                                                      1896 07718000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 07719000
*   OLDERID2=NEWERID2;                                             1897 07720000
         L     @15,@PC00001                                        1897 07721000
         L     @15,GDTTR2(,@15)                                    1897 07722000
         MVC   @TS00001(95),NEWERID2(@15)                          1897 07723000
         MVC   OLDERID2(95,@15),@TS00001                           1897 07724000
*   NEWID2='AVS2';                  /*                       @Y30LB31*/ 07725000
         MVC   NEWID2(4,@15),@CC01928                              1898 07726000
*   VS2RTNRC=LASTCC00;              /*                       @Y30LB31*/ 07727000
*                                                                  1899 07728000
         SLR   VS2RTNRC,VS2RTNRC                                   1899 07729000
*   /*****************************************************************/ 07730000
*   /*                                                               */ 07731000
*   /* INITIALIZE THE VS2 PARM LIST TO SET THE NEW VOLUME    @Y30LB31*/ 07732000
*   /* SERIAL NO. IN THE VOL LABEL.                          @Y30LB31*/ 07733000
*   /*                                                               */ 07734000
*   /*****************************************************************/ 07735000
*                                                                  1900 07736000
*   RESPECIFY                                                      1900 07737000
*     VS2AGL BASED(ADDR(AVVS2AGL)); /*                       @Y30LB31*/ 07738000
*   VS2AGL=''B;                     /*                       @Y30LB31*/ 07739000
         LA    @15,AVVS2AGL                                        1901 07740000
         XC    VS2AGL(52,@15),VS2AGL(@15)                          1901 07741000
*   VSVOLUME=MSVIVOL#;              /*                       @Y30LB31*/ 07742000
         MVC   VSVOLUME(6,@15),MSVIVOL#                            1902 07743000
*   VSVOLPTR=ADDR(MSVIVOL#);        /* NEW VOL SERIAL NO.    @Y30LB31*/ 07744000
         LA    @14,MSVIVOL#                                        1903 07745000
         ST    @14,VSVOLPTR(,@15)                                  1903 07746000
*   VSVOLSER=ON;                    /* UPDATE VOL SER FLAG   @Y30LB31*/ 07747000
         OI    VSVOLSER(@15),B'01000000'                           1904 07748000
*   VSDDNAME=AUNITDDN;              /*                       @Y30LB31*/ 07749000
*                                                                  1905 07750000
         MVC   VSDDNAME(8,@15),AUNITDDN                            1905 07751000
*   /*****************************************************************/ 07752000
*   /*                                                               */ 07753000
*   /* REQUEST A RESERVE BE SET DURING THE VOL LABEL UPDATE UNLESS A */ 07754000
*   /* PREVIOUS RESERVE SET BY THE VTOC VOL SERVICES         @Y30LB31*/ 07755000
*   /* ROUTINE IS STILL IN EFFECT FOR A DUPLICATE VOL.       @Y30LB31*/ 07756000
*   /*                                                               */ 07757000
*   /*****************************************************************/ 07758000
*                                                                  1906 07759000
*   IF BCDBASE=ON|BCDCOPY=ON THEN   /*                       @Y30LB31*/ 07760000
         TM    BCDBASE(BCDVPTR),B'00110000'                        1906 07761000
         BZ    @RF01906                                            1906 07762000
*     DO;                           /*                       @Y30LB31*/ 07763000
*       VS2RES=ON;                  /*                       @Y30LB31*/ 07764000
         OI    VS2RES(@15),B'10000000'                             1908 07765000
*       VSUCBPTR=ADDR(AUNITUCB);    /*                       @Y30LB31*/ 07766000
         LA    @06,AUNITUCB                                        1909 07767000
         ST    @06,VSUCBPTR(,@15)                                  1909 07768000
*     END;                          /*                       @Y30LB31*/ 07769000
*                                                                  1910 07770000
*   /*****************************************************************/ 07771000
*   /*                                                               */ 07772000
*   /* TAKE A SYMBOLIC DUMP OF THE VS2 PARM LIST BEFORE      @Y30LB31*/ 07773000
*   /* INVOKING THE VOLUME SERVICES ROUTINE THAT UPDATES THE VOL     */ 07774000
*   /*                                                       @Y30LB31*/ 07775000
*   /* LABEL.                                                @Y30LB31*/ 07776000
*   /*                                                               */ 07777000
*   /*****************************************************************/ 07778000
*                                                                  1911 07779000
*   IF GDTDBG=NULLPTR THEN                                         1911 07780000
@RF01906 L     @06,@PC00001                                        1911 07781000
         L     @06,GDTDBG(,@06)                                    1911 07782000
         LTR   @06,@06                                             1911 07783000
         BZ    @RT01911                                            1911 07784000
*     ;                                                            1912 07785000
*   ELSE                                                           1913 07786000
*     DO;                                                          1913 07787000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 07788000
         LA    DMPINDEX,AVDMPLST                                   1914 07789000
*       DMPITMNM='AVVS2AGL';                                       1915 07790000
         MVC   DMPITMNM(8,DMPINDEX),@CC01931                       1915 07791000
*       DMPITMPT=ADDR(AVVS2AGL);                                   1916 07792000
         LA    @06,AVVS2AGL                                        1916 07793000
         ST    @06,DMPITMPT(,DMPINDEX)                             1916 07794000
*       DMPITMLN=LENGTH(AVVS2AGL);                                 1917 07795000
         MVC   DMPITMLN(2,DMPINDEX),@CH02003                       1917 07796000
*       DMPITMTP='H';                                              1918 07797000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1918 07798000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1919 07799000
*                                                                  1919 07800000
         LA    @06,16                                              1919 07801000
         ALR   DMPINDEX,@06                                        1919 07802000
*       /*************************************************************/ 07803000
*       /*                                                           */ 07804000
*       /*                                                   @Y30LB31*/ 07805000
*       /*                                                           */ 07806000
*       /*************************************************************/ 07807000
*                                                                  1920 07808000
*       DMPITMNM='ADDVTBL';                                        1920 07809000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1920 07810000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1920 07811000
*       DMPITMPT=ADDR(ADDVTBL);                                    1921 07812000
         LA    @03,ADDVTBL                                         1921 07813000
         ST    @03,DMPITMPT(,DMPINDEX)                             1921 07814000
*       DMPITMLN=LENGTH(ADDVTBL);                                  1922 07815000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1922 07816000
*       DMPITMTP='H';                                              1923 07817000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1923 07818000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 07819000
         ALR   DMPINDEX,@06                                        1924 07820000
*       DMPTRM=DMPTRMVL;                                           1925 07821000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1925 07822000
*     END;                          /*                       @Y30LB31*/ 07823000
*   IF GDTDBG=NULLPTR THEN                                         1927 07824000
@RT01911 L     @06,@PC00001                                        1927 07825000
         L     @06,GDTDBG(,@06)                                    1927 07826000
         LTR   @06,@06                                             1927 07827000
         BZ    @RT01927                                            1927 07828000
*     ;                                                            1928 07829000
*   ELSE                                                           1929 07830000
*     CALL IDCDB010(GDTTBL,'AVNS',ADDR(AVDMPLST));/*         @Y30LB31*/ 07831000
*                                                                  1929 07832000
         L     @06,@PC00001                                        1929 07833000
         ST    @06,@AL00001                                        1929 07834000
         LA    @15,@CC01932                                        1929 07835000
         ST    @15,@AL00001+4                                      1929 07836000
         LA    @15,AVDMPLST                                        1929 07837000
         ST    @15,@AFTEMPS+32                                     1929 07838000
         LA    @15,@AFTEMPS+32                                     1929 07839000
         ST    @15,@AL00001+8                                      1929 07840000
         MVI   @AL00001+8,X'80'                                    1929 07841000
         L     @15,GDTDBG(,@06)                                    1929 07842000
         LA    @01,@AL00001                                        1929 07843000
         BALR  @14,@15                                             1929 07844000
*   /*****************************************************************/ 07845000
*   /*                                                               */ 07846000
*   /* INVOKE THE SECOND VOLUME SERVICES ROUTINE TO PERFORM THE VOL  */ 07847000
*   /* LABEL UPDATE FOR THE NEW VOL SER NO.                  @Y30LB31*/ 07848000
*   /*                                                               */ 07849000
*   /*****************************************************************/ 07850000
*                                                                  1930 07851000
*   CALL IDCSACL0(GDTTBL,IDCVS02,PUTLABEL,VS2AGL);/*         @Y30LB31*/ 07852000
@RT01927 L     @06,@PC00001                                        1930 07853000
         ST    @06,@AL00001                                        1930 07854000
         LA    @02,@CC01927                                        1930 07855000
         ST    @02,@AL00001+4                                      1930 07856000
         LA    @02,PUTLABEL                                        1930 07857000
         ST    @02,@AL00001+8                                      1930 07858000
         LA    @02,AVVS2AGL                                        1930 07859000
         ST    @02,@AL00001+12                                     1930 07860000
         MVI   @AL00001+12,X'80'                                   1930 07861000
         L     @15,GDTCAL(,@06)                                    1930 07862000
         LA    @01,@AL00001                                        1930 07863000
         BALR  @14,@15                                             1930 07864000
*   RESPECIFY                                                      1931 07865000
*     RTNREG RSTD;                                                 1931 07866000
*   TESTRC=RTNREG;                                                 1932 07867000
         LR    TESTRC,RTNREG                                       1932 07868000
*   RESPECIFY                                                      1933 07869000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 07870000
*                                                                  1934 07871000
*   /*****************************************************************/ 07872000
*   /*                                                               */ 07873000
*   /* TEST THE RETURN CODE FROM THE REQUEST TO UPDATE THE   @Y30LB31*/ 07874000
*   /* VOL LABEL. IF THE UPDATE WAS SUCCESSFUL BUT THE VTOC COULD NOT*/ 07875000
*   /* BE CLOSED BY THE VOL SERV ROUTINE, TREAT THIS AS A    @Y30LB31*/ 07876000
*   /* MINOR ERROR REQUIRING AN EOJ FINAL CONDITION CODE OF AT       */ 07877000
*   /*                                                       @Y30LB31*/ 07878000
*   /* LEAST 4.                                              @Y30LB31*/ 07879000
*   /*                                                               */ 07880000
*   /*****************************************************************/ 07881000
*                                                                  1934 07882000
*   IF TESTRC=8 THEN                /*                       @Y30LB31*/ 07883000
         C     TESTRC,@CF00182                                     1934 07884000
         BNE   @RF01934                                            1934 07885000
*     CC04FLG=ON;                   /*                       @Y30LB31*/ 07886000
*                                                                  1935 07887000
         OI    CC04FLG,B'10000000'                                 1935 07888000
*   /*****************************************************************/ 07889000
*   /*                                                               */ 07890000
*   /* EXIT WITH AN UNSUCCESSFUL CONDITION CODE IF THE VOL   @Y30LB31*/ 07891000
*   /* UPDATE FAILED.                                        @Y30LB31*/ 07892000
*   /*                                                               */ 07893000
*   /*****************************************************************/ 07894000
*                                                                  1936 07895000
*   ELSE                            /*                       @Y30LB31*/ 07896000
*     IF TESTRC=4 THEN              /*                       @Y30LB31*/ 07897000
         B     @RC01934                                            1936 07898000
@RF01934 LA    @06,4                                               1936 07899000
         CR    TESTRC,@06                                          1936 07900000
         BNE   @RF01936                                            1936 07901000
*       VS2RTNRC=4;                 /*                       @Y30LB31*/ 07902000
*                                                                  1937 07903000
         LR    VS2RTNRC,@06                                        1937 07904000
*   /*****************************************************************/ 07905000
*   /*                                                               */ 07906000
*   /* RESTORE REG 14 WITH THE CALLERS RETURN ADDRESS AND    @Y30LB31*/ 07907000
*   /* EXIT FROM THIS PROC. PASS THE CONDITION CODE TO THE CALLER IN */ 07908000
*   /* REG 15.                                               @Y30LB31*/ 07909000
*   /*                                                               */ 07910000
*   /*****************************************************************/ 07911000
*                                                                  1938 07912000
*   RESPECIFY                                                      1938 07913000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 07914000
@RF01936 DS    0H                                                  1938 07915000
@RC01934 DS    0H                                                  1939 07916000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 07917000
         L     REG14,RETADDR3                                      1939 07918000
*   RESPECIFY                                                      1940 07919000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 07920000
*   RETURN CODE(VS2RTNRC);          /*                       @Y30LB31*/ 07921000
         LR    @15,VS2RTNRC                                        1941 07922000
@EL00019 DS    0H                                                  1941 07923000
@EF00019 DS    0H                                                  1941 07924000
@ER00019 BR    @14                                                 1941 07925000
*   END VS2RTN;                     /*                       @Y30LB31*/ 07926000
*                                                                  1943 07927000
*/********************************************************** @Y30LB31*/ 07928000
*/*                                                          @Y30LB31*/ 07929000
*/* PROCEDURE NAME - MVRRTN                                  @Y30LB31*/ 07930000
*/*                                                          @Y30LB31*/ 07931000
*/* FUNCTION - CLEARS THE VOLUME SERIAL MISMATCH FLAG FROM   @Y30LB31*/ 07932000
*/*            THE VOL RECORD IN THE MSVI.  CALLS SSCMSG TO  @Y30LB31*/ 07933000
*/*            OUTPUT A MSSC REASON CODE MESSAGE IF THE      @Y30LB31*/ 07934000
*/*            UPDATE FAILS.  ALSO ISSUES A SECONDARY ERROR  @Y30LB31*/ 07935000
*/*            MSG IDC2065I.                                 @Y30LB31*/ 07936000
*/*                                                          @Y30LB31*/ 07937000
*/* INPUT - ADDVTBL, PRINTTBL FOR MESSAGES                   @Y30LB31*/ 07938000
*/*                                                          @Y30LB31*/ 07939000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES THE MISMATCH FLAG  @Y30LB31*/ 07940000
*/*          WAS CLEARED.  ADDVTBL MAY BE UPDATED.           @Y30LB31*/ 07941000
*/*          A RETURN CODE OF 4 INDICATES THE MISMATCH FLAG  @Y30LB31*/ 07942000
*/*          WAS NOT CLEARED.                                @Y30LB31*/ 07943000
*/*                                                          @Y30LB31*/ 07944000
*/********************************************************** @Y30LB31*/ 07945000
*                                                                  1943 07946000
*MVRRTN:                                                           1943 07947000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 07948000
*                                                                  1943 07949000
MVRRTN   DS    0H                                                  1944 07950000
*   /*****************************************************************/ 07951000
*   /*                                                               */ 07952000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 07953000
*   /*                                                               */ 07954000
*   /*****************************************************************/ 07955000
*                                                                  1944 07956000
*   DCL                                                            1944 07957000
*     MVRRTNRC FIXED(15);           /*                       @Y30LB31*/ 07958000
*                                                                  1944 07959000
*   /*****************************************************************/ 07960000
*   /*                                                               */ 07961000
*   /* LOCAL DECLARATIONS. SETUP A STORAGE AREA TO BUILD     @Y30LB31*/ 07962000
*   /* THE MSVC MODIFY-VOL-RECORD PARM LIST.                 @Y30LB31*/ 07963000
*   /*                                                               */ 07964000
*   /*****************************************************************/ 07965000
*                                                                  1945 07966000
*   DCL                                                            1945 07967000
*     1 AV01MVR BDY(WORD),          /*                       @Y30LB31*/ 07968000
*      2 AVMVRHDR CHAR(8),          /* MVR ARG LIST ID       @Y30LB31*/ 07969000
*      2 AVMVRTBL CHAR(LENGTH(MVR));/*                       @Y30LB31*/ 07970000
*                                                                  1945 07971000
*   /*****************************************************************/ 07972000
*   /*                                                               */ 07973000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE UPON EXIT FROM    */ 07974000
*   /* THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS */ 07975000
*   /* PROC.                                                 @Y30LB31*/ 07976000
*   /*                                                               */ 07977000
*   /*****************************************************************/ 07978000
*                                                                  1946 07979000
*   RESPECIFY                                                      1946 07980000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 07981000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 07982000
         ST    REG14,RETADDR3                                      1947 07983000
*   RESPECIFY                                                      1948 07984000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 07985000
*   OLDERID2=NEWERID2;                                             1949 07986000
         L     @06,@PC00001                                        1949 07987000
         L     @15,GDTTR2(,@06)                                    1949 07988000
         MVC   @TS00001(95),NEWERID2(@15)                          1949 07989000
         MVC   OLDERID2(95,@15),@TS00001                           1949 07990000
*   NEWID2='AVMV';                  /*                       @Y30LB31*/ 07991000
         MVC   NEWID2(4,@15),@CC01940                              1950 07992000
*   MVRRTNRC=LASTCC00;              /*                       @Y30LB31*/ 07993000
*                                                                  1951 07994000
         SLR   @15,@15                                             1951 07995000
         LR    MVRRTNRC,@15                                        1951 07996000
*   /*****************************************************************/ 07997000
*   /*                                                               */ 07998000
*   /* INITIALIZE THE MVR PARM LIST TO CLEAR THE SERIAL      @Y30LB31*/ 07999000
*   /* MISMATCH RECOVERY FLAG FROM THE MSVI.                 @Y30LB31*/ 08000000
*   /*                                                               */ 08001000
*   /*****************************************************************/ 08002000
*                                                                  1952 08003000
*   AVMVRHDR='MVR';                 /*                       @Y30LB31*/ 08004000
         MVI   AVMVRHDR+3,C' '                                     1952 08005000
         MVC   AVMVRHDR+4(4),AVMVRHDR+3                            1952 08006000
         MVC   AVMVRHDR(3),@CC01941                                1952 08007000
*   AVMVRTBL=''B;                   /*                       @Y30LB31*/ 08008000
         XC    AVMVRTBL(88),AVMVRTBL                               1953 08009000
*   MVRPTR=ADDR(AVMVRTBL);          /*                       @Y30LB31*/ 08010000
         LA    @14,AVMVRTBL                                        1954 08011000
         ST    @14,MVRPTR                                          1954 08012000
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB31*/ 08013000
         LH    @03,MVRLEN                                          1955 08014000
         ST    @03,MVRLNGTH(,@14)                                  1955 08015000
*   MVRCODE=MVROP;                  /*                       @Y30LB31*/ 08016000
         XC    MVRCODE+1(3,@14),MVRCODE+1(@14)                     1956 08017000
         MVI   MVRCODE(@14),X'85'                                  1956 08018000
*   MVRCLMIS=ON;                    /*                       @Y30LB31*/ 08019000
         OI    MVRCLMIS(@14),B'00000001'                           1957 08020000
*   MVRBVOL=MSVIVOL#;               /*                       @Y30LB31*/ 08021000
         MVC   MVRBVOL(6,@14),MSVIVOL#                             1958 08022000
*   MVRFLBAS=ON;                    /*                       @Y30LB31*/ 08023000
         OI    MVRFLBAS(@14),B'00100000'                           1959 08024000
*   MVRLABEL=BLANKIT;               /*                       @Y30LB31*/ 08025000
         MVI   MVRLABEL+1(@14),C' '                                1960 08026000
         MVC   MVRLABEL+2(4,@14),MVRLABEL+1(@14)                   1960 08027000
         MVI   MVRLABEL(@14),C' '                                  1960 08028000
*   MVRFLLAB=ON;                    /*                       @Y30LB31*/ 08029000
*                                                                  1961 08030000
         OI    MVRFLLAB(@14),B'00000001'                           1961 08031000
*   /*****************************************************************/ 08032000
*   /*                                                               */ 08033000
*   /* TAKE A SYMBOLIC DUMP OF THE MODIFY-VOL-REC PARM LIST  @Y30LB31*/ 08034000
*   /* BEFORE INVOKING MSVC TO CLEAR THE MISMATCH FLAG FROM THE      */ 08035000
*   /*                                                       @Y30LB31*/ 08036000
*   /* VOL RECORD.                                           @Y30LB31*/ 08037000
*   /*                                                               */ 08038000
*   /*****************************************************************/ 08039000
*                                                                  1962 08040000
*   IF GDTDBG=NULLPTR THEN                                         1962 08041000
         C     @15,GDTDBG(,@06)                                    1962 08042000
         BE    @RT01962                                            1962 08043000
*     ;                                                            1963 08044000
*   ELSE                                                           1964 08045000
*     DO;                                                          1964 08046000
*       DMPINDEX=ADDR(AVDMPLST);    /*                       @Y30LB31*/ 08047000
         LA    DMPINDEX,AVDMPLST                                   1965 08048000
*       DMPITMNM='AV01MVR';                                        1966 08049000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1966 08050000
         MVC   DMPITMNM(7,DMPINDEX),@CC01942                       1966 08051000
*       DMPITMPT=ADDR(AV01MVR);                                    1967 08052000
         LA    @06,AV01MVR                                         1967 08053000
         ST    @06,DMPITMPT(,DMPINDEX)                             1967 08054000
*       DMPITMLN=LENGTH(AV01MVR);                                  1968 08055000
         MVC   DMPITMLN(2,DMPINDEX),@CH02004                       1968 08056000
*       DMPITMTP='H';                                              1969 08057000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1969 08058000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 08059000
         LA    @06,16                                              1970 08060000
         ALR   DMPINDEX,@06                                        1970 08061000
*       DMPITMNM='ADDVTBL';                                        1971 08062000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1971 08063000
         MVC   DMPITMNM(7,DMPINDEX),@CC01766                       1971 08064000
*       DMPITMPT=ADDR(ADDVTBL);                                    1972 08065000
         LA    @03,ADDVTBL                                         1972 08066000
         ST    @03,DMPITMPT(,DMPINDEX)                             1972 08067000
*       DMPITMLN=LENGTH(ADDVTBL);                                  1973 08068000
         MVC   DMPITMLN(2,DMPINDEX),@CH01999                       1973 08069000
*       DMPITMTP='H';                                              1974 08070000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1974 08071000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 08072000
         ALR   DMPINDEX,@06                                        1975 08073000
*       DMPTRM=DMPTRMVL;                                           1976 08074000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1976 08075000
*     END;                          /*                       @Y30LB31*/ 08076000
*   IF GDTDBG=NULLPTR THEN                                         1978 08077000
@RT01962 L     @06,@PC00001                                        1978 08078000
         L     @06,GDTDBG(,@06)                                    1978 08079000
         LTR   @06,@06                                             1978 08080000
         BZ    @RT01978                                            1978 08081000
*     ;                                                            1979 08082000
*   ELSE                                                           1980 08083000
*     CALL IDCDB010(GDTTBL,'AVSM',ADDR(AVDMPLST));/*         @Y30LB31*/ 08084000
*                                                                  1980 08085000
         L     @06,@PC00001                                        1980 08086000
         ST    @06,@AL00001                                        1980 08087000
         LA    @15,@CC01943                                        1980 08088000
         ST    @15,@AL00001+4                                      1980 08089000
         LA    @15,AVDMPLST                                        1980 08090000
         ST    @15,@AFTEMPS+36                                     1980 08091000
         LA    @15,@AFTEMPS+36                                     1980 08092000
         ST    @15,@AL00001+8                                      1980 08093000
         MVI   @AL00001+8,X'80'                                    1980 08094000
         L     @15,GDTDBG(,@06)                                    1980 08095000
         LA    @01,@AL00001                                        1980 08096000
         BALR  @14,@15                                             1980 08097000
*   /*****************************************************************/ 08098000
*   /*                                                               */ 08099000
*   /* INVOKE MSVC TO CLEAR THE SERIAL MISMATCH FLAG FROM    @Y30LB31*/ 08100000
*   /* THE INVENTORY RECORD.                                 @Y30LB31*/ 08101000
*   /*                                                               */ 08102000
*   /*****************************************************************/ 08103000
*                                                                  1981 08104000
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASON);/*              @Y30LB31*/ 08105000
@RT01978 L     @06,@PC00001                                        1981 08106000
         ST    @06,@AL00001                                        1981 08107000
         LA    @02,VVIC                                            1981 08108000
         ST    @02,@AL00001+4                                      1981 08109000
         LA    @02,MVRPTR                                          1981 08110000
         ST    @02,@AL00001+8                                      1981 08111000
         LA    @02,REASON                                          1981 08112000
         ST    @02,@AL00001+12                                     1981 08113000
         MVI   @AL00001+12,X'80'                                   1981 08114000
         L     @15,GDTSSC(,@06)                                    1981 08115000
         LA    @01,@AL00001                                        1981 08116000
         BALR  @14,@15                                             1981 08117000
*   RESPECIFY                                                      1982 08118000
*     RTNREG RSTD;                                                 1982 08119000
*   TESTRC=RTNREG;                                                 1983 08120000
         LR    TESTRC,RTNREG                                       1983 08121000
*   RESPECIFY                                                      1984 08122000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 08123000
*                                                                  1984 08124000
*   /*****************************************************************/ 08125000
*   /*                                                               */ 08126000
*   /* IF MSVC ENCOUNTERED AN I/O ERROR UPDATING THE INVEN- TORY,    */ 08127000
*   /* TREAT THIS AS A MINOR ERROR REQUIRING AN EOJ FINAL    @Y30LB31*/ 08128000
*   /* CONDITION CODE OF AT LEAST 4.                         @Y30LB31*/ 08129000
*   /*                                                               */ 08130000
*   /*****************************************************************/ 08131000
*                                                                  1985 08132000
*   IF TESTRC=12 THEN               /*                       @Y30BL31*/ 08133000
         C     TESTRC,@CF00606                                     1985 08134000
         BNE   @RF01985                                            1985 08135000
*     DO;                           /*                       @Y30LB31*/ 08136000
*       TESTRC=LASTCC00;            /*                       @Y30LB31*/ 08137000
         SLR   TESTRC,TESTRC                                       1987 08138000
*       CC04FLG=ON;                 /*                       @Y30LB31*/ 08139000
         OI    CC04FLG,B'10000000'                                 1988 08140000
*     END;                          /*                       @Y30LB31*/ 08141000
*                                                                  1990 08142000
*   /*****************************************************************/ 08143000
*   /*                                                               */ 08144000
*   /* IF THE MISMATCH FLAG COULD NOT BE CLEARED FROM THE    @Y30LB31*/ 08145000
*   /* VOLUME RECORD, ISSUE THE APPROPRIATE MESSAGE CONTAINING THE   */ 08146000
*   /* MSSC REASON CODE. ISSUE A SECONDARY ERR MSG IDC2065I  @Y30LB31*/ 08147000
*   /* RELATING THAT THE MISMATCH FLAG COULD NOT BE CLEARED. @Y30LB31*/ 08148000
*   /*                                                               */ 08149000
*   /*****************************************************************/ 08150000
*                                                                  1990 08151000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 08152000
@RF01985 LTR   TESTRC,TESTRC                                       1990 08153000
         BZ    @RF01990                                            1990 08154000
*     DO;                           /*                       @Y30LB31*/ 08155000
*       MVRRTNRC=4;                 /*                       @Y30LB31*/ 08156000
         LA    MVRRTNRC,4                                          1992 08157000
*       CALL SSCMSG(REASON);        /*                       @Y30LB31*/ 08158000
*                                                                  1993 08159000
         LA    @06,REASON                                          1993 08160000
         ST    @06,@AL00001                                        1993 08161000
         LA    @01,@AL00001                                        1993 08162000
         BAL   @14,SSCMSG                                          1993 08163000
*       /*************************************************************/ 08164000
*       /*                                                           */ 08165000
*       /* OUTPUT SECONDARY ERROR MSG IDC2065I.              @Y30LB31*/ 08166000
*       /*                                                           */ 08167000
*       /*************************************************************/ 08168000
*                                                                  1994 08169000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 08170000
         XC    PRINTTBL(28),PRINTTBL                               1994 08171000
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/ 08172000
         L     @06,DDSTRU                                          1995 08173000
         MVC   DARGSMOD(3,@06),@CC01697                            1995 08174000
*       DARGSENT=MSG2065I;          /* STID=CM045            @Y30LB31*/ 08175000
         MVI   DARGSENT(@06),X'2D'                                 1996 08176000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 08177000
         L     @06,@PC00001                                        1997 08178000
         ST    @06,@AL00001                                        1997 08179000
         LA    @15,@CF00117                                        1997 08180000
         ST    @15,@AL00001+4                                      1997 08181000
         LA    @15,DDSTRU                                          1997 08182000
         ST    @15,@AL00001+8                                      1997 08183000
         MVI   @AL00001+8,X'80'                                    1997 08184000
         L     @15,GDTPRT(,@06)                                    1997 08185000
         LA    @01,@AL00001                                        1997 08186000
         BALR  @14,@15                                             1997 08187000
*     END;                          /*                       @Y30LB31*/ 08188000
*                                                                  1998 08189000
*   /*****************************************************************/ 08190000
*   /*                                                               */ 08191000
*   /* RESTORE REG 14 WITH CALLERS RETURN ADDRESS AND EXIT   @Y30LB31*/ 08192000
*   /* FROM MVRRTN. PASS THE CONDITION CODE IN REG 15.       @Y30LB31*/ 08193000
*   /*                                                               */ 08194000
*   /*****************************************************************/ 08195000
*                                                                  1999 08196000
*   RESPECIFY                                                      1999 08197000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 08198000
@RF01990 DS    0H                                                  2000 08199000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 08200000
         L     REG14,RETADDR3                                      2000 08201000
*   RESPECIFY                                                      2001 08202000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 08203000
*   RETURN CODE(MVRRTNRC);          /*                       @Y30LB31*/ 08204000
         LR    @15,MVRRTNRC                                        2002 08205000
@EL00020 DS    0H                                                  2002 08206000
@EF00020 DS    0H                                                  2002 08207000
@ER00020 BR    @14                                                 2002 08208000
*   END MVRRTN;                     /*                       @Y30LB31*/ 08209000
*                                                                  2004 08210000
*/********************************************************** @Y30LB31*/ 08211000
*/*                                                          @Y30LB31*/ 08212000
*/* PROCEDURE NAME - DUPVRTN                                 @Y30LB31*/ 08213000
*/*                                                          @Y30LB31*/ 08214000
*/* FUNCTION - DIRECTS THE ACTIVATE, VOLUME ATTRIBUTE        @Y30LB31*/ 08215000
*/*            UPDATE, AND NEW SERIAL NO. UPDATE FOR A       @Y30LB31*/ 08216000
*/*            COPY OR DUPLICATE VOLUME.  CALLS CLABLRTN     @Y30LB31*/ 08217000
*/*            TO UPDATE THE CARTRIDGE LABELS.  CALLS        @Y30LB31*/ 08218000
*/*            SECCKRTN TO CHECK VSAM STATUS OF A DUPLICATE  @Y30LB31*/ 08219000
*/*            VOLUME.  CALLS BKOUTRTN IF THE DUPLICATE      @Y30LB31*/ 08220000
*/*            VOL IS OWNED BY VSAM.  CALLS VLABLRTN TO      @Y30LB31*/ 08221000
*/*            UPDATE THE VOLUME LABEL.  ISSUES MESSAGES,    @Y30LB31*/ 08222000
*/*            IDC3070I, IDC0722I.                           @Y30LB31*/ 08223000
*/*                                                          @Y30LB31*/ 08224000
*/* INPUT - ADDVTBL, PRINTTBL FOR MESSAGES, VS1AGL,          @Y30LB31*/ 08225000
*/*         BCDV FORMAT FOR VOLUME RECORD                   @Y30LB31 */ 08226000
*/*                                                          @Y30LB31*/ 08227000
*/* OUTPUT - RETURN CODE OF 0 INDICATES VOLUME               @Y30LB31*/ 08228000
*/*          SUCCESSFULLY ACTIVATED WITH NEW VOLUME          @Y30LB31*/ 08229000
*/*          SERIAL NO.  RETURN CODE OF 8 INDICATES          @Y30LB31*/ 08230000
*/*          VOLUME ACTIVATED WITH ERRORS.  RETURN CODE      @Y30LB31*/ 08231000
*/*          OF 12 INDICATES 1)THE CARTRIDGE LABELS COULD    @Y30LB31*/ 08232000
*/*          NOT BE UPDATED, OR 2)FOLLOWING THE CART LABEL   @Y30LB31*/ 08233000
*/*          UPDATE THE ACTIVATE FAILED, OR 3)A DUPLICATE    @Y30LB31*/ 08234000
*/*          VOL IS OWNED BY VSAM.                           @Y30LB31*/ 08235000
*/*                                                          @Y30LB31*/ 08236000
*/********************************************************** @Y30LB31*/ 08237000
*                                                                  2004 08238000
*DUPVRTN:                                                          2004 08239000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 08240000
*                                                                  2004 08241000
DUPVRTN  DS    0H                                                  2005 08242000
*   /*****************************************************************/ 08243000
*   /*                                                               */ 08244000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 08245000
*   /*                                                               */ 08246000
*   /*****************************************************************/ 08247000
*                                                                  2005 08248000
*   DCL                                                            2005 08249000
*     DUPVRC FIXED(15);             /*                       @Y30LB31*/ 08250000
*                                                                  2005 08251000
*   /*****************************************************************/ 08252000
*   /*                                                               */ 08253000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON   @Y30LB31*/ 08254000
*   /* EXIT.                                                 @Y30LB31*/ 08255000
*   /*                                                               */ 08256000
*   /*****************************************************************/ 08257000
*                                                                  2006 08258000
*   RESPECIFY                                                      2006 08259000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 08260000
*   RETADDR1=REG14;                 /*                       @Y30LB31*/ 08261000
         ST    REG14,RETADDR1                                      2007 08262000
*   RESPECIFY                                                      2008 08263000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 08264000
*   OLDERID2=NEWERID2;                                             2009 08265000
         L     @15,@PC00001                                        2009 08266000
         L     @15,GDTTR2(,@15)                                    2009 08267000
         MVC   @TS00001(95),NEWERID2(@15)                          2009 08268000
         MVC   OLDERID2(95,@15),@TS00001                           2009 08269000
*   NEWID2='AVDU';                  /*                       @Y30LB31*/ 08270000
*                                                                  2010 08271000
         MVC   NEWID2(4,@15),@CC01948                              2010 08272000
*   /*****************************************************************/ 08273000
*   /*                                                               */ 08274000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 08275000
*   /*                                                               */ 08276000
*   /*****************************************************************/ 08277000
*                                                                  2011 08278000
*   DUPVRC=LASTCC00;                /*                       @Y30LB31*/ 08279000
*                                                                  2011 08280000
         SLR   @15,@15                                             2011 08281000
         STH   @15,DUPVRC                                          2011 08282000
*   /*****************************************************************/ 08283000
*   /*                                                               */ 08284000
*   /* IF THE VOLUME IS READONLY, SET READWRITE WHEN         @Y30LB31*/ 08285000
*   /* SETTING THE NEW VOL SERIAL NO. IN THE CARTRIDGE LABELS.       */ 08286000
*   /*                                                       @Y30LB31*/ 08287000
*   /* THIS ALLOWS THE NEW VOL SERIAL NO. TO BE WRITTEN IN THE       */ 08288000
*   /*                                                       @Y30LB31*/ 08289000
*   /* LABEL OF THE VOLUME. THE OTHER VOL ATTRIBUTES ARE NOT @Y30LB31*/ 08290000
*   /* CHANGED. THE DEFAULT VALUES FOR THE NEW VOL ATTRIBUTES        */ 08291000
*   /*                                                       @Y30LB31*/ 08292000
*   /* HAVE BEEN INITIALIZED TO OFF BY THE MAIN PROC IDCAV01.        */ 08293000
*   /*                                                       @Y30LB31*/ 08294000
*   /*                                                               */ 08295000
*   /*****************************************************************/ 08296000
*                                                                  2012 08297000
*   IF OLDROFLG=ON THEN             /*                       @Y30LB31*/ 08298000
         TM    OLDROFLG,B'00010000'                                2012 08299000
         BNO   @RF02012                                            2012 08300000
*     DO;                           /*                       @Y30LB31*/ 08301000
*       NEWVFFLG=ON;                /* UPDATE VOL ATTRIBUTES @Y30LB31*/ 08302000
         OI    NEWVFFLG,B'00001000'                                2014 08303000
*       NEWROFLG=OFF;               /* SET READWRITE         @Y30LB31*/ 08304000
         NI    NEWROFLG,B'11111110'                                2015 08305000
*       IF OLDBIFLG=ON THEN         /*                       @Y30LB31*/ 08306000
         TM    OLDBIFLG,B'10000000'                                2016 08307000
         BNO   @RF02016                                            2016 08308000
*         NEWBIFLG=ON;              /*                       @Y30LB31*/ 08309000
         OI    NEWBIFLG,B'00001000'                                2017 08310000
*       IF OLDDEFLG=ON THEN         /*                       @Y30LB31*/ 08311000
@RF02016 TM    OLDDEFLG,B'01000000'                                2018 08312000
         BNO   @RF02018                                            2018 08313000
*         NEWDEFLG=ON;              /*                       @Y30LB31*/ 08314000
         OI    NEWDEFLG,B'00000100'                                2019 08315000
*       IF OLDEXFLG=ON THEN         /*                       @Y30LB31*/ 08316000
@RF02018 TM    OLDEXFLG,B'00100000'                                2020 08317000
         BNO   @RF02020                                            2020 08318000
*         NEWEXFLG=ON;              /*                       @Y30LB31*/ 08319000
         OI    NEWEXFLG,B'00000010'                                2021 08320000
*     END;                          /*                       @Y30LB31*/ 08321000
@RF02020 DS    0H                                                  2023 08322000
*                                                                  2023 08323000
*   /*****************************************************************/ 08324000
*   /*                                                               */ 08325000
*   /* CALL CLABLRTN TO DIRECT THE CARTRIDGE UPDATE AND      @Y30LB31*/ 08326000
*   /* ACTIVATE OF THE COPY OR DUPLICATE VOLUME. THE NEW VOL @Y30LB31*/ 08327000
*   /* SERIAL NO. WILL BE SET IN THE CARTRIDGE LABELS, MSC   @Y30LB31*/ 08328000
*   /* TABLES, AND MSVI.                                     @Y30LB31*/ 08329000
*   /*                                                               */ 08330000
*   /*****************************************************************/ 08331000
*                                                                  2023 08332000
*   CALL CLABLRTN;                  /*                       @Y30LB31*/ 08333000
@RF02012 BAL   @14,CLABLRTN                                        2023 08334000
*   RESPECIFY                                                      2024 08335000
*     RTNREG RSTD;                                                 2024 08336000
*   TESTRC=RTNREG;                                                 2025 08337000
         LR    TESTRC,RTNREG                                       2025 08338000
*   RESPECIFY                                                      2026 08339000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 08340000
*                                                                  2026 08341000
*   /*****************************************************************/ 08342000
*   /*                                                               */ 08343000
*   /* IF THE MSC RENAME OR ACTIVATE FAILED, EXIT FROM THIS PROC.    */ 08344000
*   /*                                                       @Y30LB31*/ 08345000
*   /*                                                               */ 08346000
*   /*****************************************************************/ 08347000
*                                                                  2027 08348000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 08349000
         LTR   TESTRC,TESTRC                                       2027 08350000
         BZ    @RF02027                                            2027 08351000
*     DUPVRC=LASTCC12;              /*                       @Y30LB31*/ 08352000
*                                                                  2028 08353000
         MVC   DUPVRC(2),@CH00606                                  2028 08354000
*   /*****************************************************************/ 08355000
*   /*                                                               */ 08356000
*   /* IF THE VOL IS A DUPLICATE, DETERMINE WHETHER IT IS    @Y30LB31*/ 08357000
*   /* OWNED BY VSAM. SINCE VSAM STATUS IS NOT MAINTAINED IN THE     */ 08358000
*   /* MSVI, THIS CHECK IS NOT MADE UNTIL THE VOL IS         @Y30LB31*/ 08359000
*   /* ACTIVATED AND CAN BE MOUNTED FOR THE CHECK.           @Y30LB31*/ 08360000
*   /*                                                               */ 08361000
*   /*****************************************************************/ 08362000
*                                                                  2029 08363000
*   ELSE                            /*                       @Y30LB31*/ 08364000
*     IF BCDDUP=ON THEN             /*                       @Y30LB31*/ 08365000
         B     @RC02027                                            2029 08366000
@RF02027 TM    BCDDUP(BCDVPTR),B'00000100'                         2029 08367000
         BNO   @RF02029                                            2029 08368000
*       DO;                         /*                       @Y30LB31*/ 08369000
*         CALL SECCKRTN;            /*                       @Y30LB31*/ 08370000
         BAL   @14,SECCKRTN                                        2031 08371000
*         RESPECIFY                                                2032 08372000
*           RTNREG RSTD;                                           2032 08373000
*         TESTRC=RTNREG;                                           2033 08374000
         LR    TESTRC,RTNREG                                       2033 08375000
*         RESPECIFY                                                2034 08376000
*           RTNREG UNRSTD;          /*                       @Y30LB31*/ 08377000
*                                                                  2034 08378000
*         /***********************************************************/ 08379000
*         /*                                                         */ 08380000
*         /* IF THE VSAM STATUS COULD NOT BE DETERMINED, NO FURTHER  */ 08381000
*         /* PROCESSING CAN BE DONE. ISSUE MSG IDC3070I      @Y30LB31*/ 08382000
*         /* INDICATING THE NEW VOL SERIAL NO. HAS NOT BEEN SET IN   */ 08383000
*         /* THE                                             @Y30LB31*/ 08384000
*         /* VOLUME LABEL. THEN EXIT FROM THIS PROCEDURE.    @Y30LB31*/ 08385000
*         /*                                                         */ 08386000
*         /***********************************************************/ 08387000
*                                                                  2035 08388000
*         IF TESTRC^=0 THEN         /*                       @Y30LB31*/ 08389000
         LTR   TESTRC,TESTRC                                       2035 08390000
         BZ    @RF02035                                            2035 08391000
*           DO;                     /*                       @Y30LB31*/ 08392000
*             DUPVRC=LASTCC08;      /*                       @Y30LB31*/ 08393000
         MVC   DUPVRC(2),@CH00182                                  2037 08394000
*             PRINTTBL=''B;         /*                       @Y30LB31*/ 08395000
         XC    PRINTTBL(28),PRINTTBL                               2038 08396000
*             DARGSMOD=COMMSGS;     /*                       @Y30LB31*/ 08397000
         L     @15,DDSTRU                                          2039 08398000
         MVC   DARGSMOD(3,@15),@CC01697                            2039 08399000
*             DARGSENT=MSG3070I;    /* STID=CM036            @Y30LB31*/ 08400000
         MVI   DARGSENT(@15),X'24'                                 2040 08401000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB31*/ 08402000
         L     @15,@PC00001                                        2041 08403000
         ST    @15,@AL00001                                        2041 08404000
         LA    @14,@CF00117                                        2041 08405000
         ST    @14,@AL00001+4                                      2041 08406000
         LA    @14,DDSTRU                                          2041 08407000
         ST    @14,@AL00001+8                                      2041 08408000
         MVI   @AL00001+8,X'80'                                    2041 08409000
         L     @15,GDTPRT(,@15)                                    2041 08410000
         LA    @01,@AL00001                                        2041 08411000
         BALR  @14,@15                                             2041 08412000
*           END;                    /*                       @Y30LB31*/ 08413000
*                                                                  2042 08414000
*         /***********************************************************/ 08415000
*         /*                                                         */ 08416000
*         /* IF THE VOLUME IS OWNED BY VSAM, RESTORE THE     @Y30LB31*/ 08417000
*         /* DUPLICATE VOL TO ITS ORIGINAL STATUS.           @Y30LB31*/ 08418000
*         /*                                                         */ 08419000
*         /***********************************************************/ 08420000
*                                                                  2043 08421000
*         ELSE                      /*                       @Y30LB31*/ 08422000
*           IF VSVSAM=ON THEN       /*                       @Y30LB31*/ 08423000
         B     @RC02035                                            2043 08424000
@RF02035 LA    @15,AVVS1AGL                                        2043 08425000
         TM    VSVSAM(@15),B'10000000'                             2043 08426000
         BNO   @RF02043                                            2043 08427000
*             DO;                   /*                       @Y30LB31*/ 08428000
*               CALL BKOUTRTN;      /*                       @Y30LB31*/ 08429000
         BAL   @14,BKOUTRTN                                        2045 08430000
*               RESPECIFY                                          2046 08431000
*                 RTNREG RSTD;                                     2046 08432000
*               TESTRC=RTNREG;                                     2047 08433000
         LR    TESTRC,RTNREG                                       2047 08434000
*               RESPECIFY                                          2048 08435000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 08436000
*                                                                  2048 08437000
*               /*****************************************************/ 08438000
*               /*                                                   */ 08439000
*               /* IF THE VOLUME COULD NOT BE RESTORED       @Y30LB31*/ 08440000
*               /* TO ITS ORIGINAL STATUS, SET THE CONDITION CODE TO */ 08441000
*               /* INDICATE THE VOLUME HAS BEEN ACTIVATED WITH       */ 08442000
*               /* ERRORS. THEN EXIT FROM THIS PROC.         @Y30LB31*/ 08443000
*               /*                                                   */ 08444000
*               /*****************************************************/ 08445000
*                                                                  2049 08446000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 08447000
         LTR   TESTRC,TESTRC                                       2049 08448000
         BZ    @RF02049                                            2049 08449000
*                 DUPVRC=LASTCC08;  /*                       @Y30LB31*/ 08450000
*                                                                  2050 08451000
         MVC   DUPVRC(2),@CH00182                                  2050 08452000
*               /*****************************************************/ 08453000
*               /*                                                   */ 08454000
*               /* EXIT FROM THIS PROC FOLLOWING THE         @Y30LB31*/ 08455000
*               /* SUCCESSFUL RESTORE AND DEACTIVATE.        @Y30LB31*/ 08456000
*               /*                                                   */ 08457000
*               /*****************************************************/ 08458000
*                                                                  2051 08459000
*               ELSE                /*                       @Y30LB31*/ 08460000
*                 DUPVRC=LASTCC12;  /*                       @Y30LB31*/ 08461000
         B     @RC02049                                            2051 08462000
@RF02049 MVC   DUPVRC(2),@CH00606                                  2051 08463000
*             END;                  /*                       @Y30LB31*/ 08464000
*                                                                  2052 08465000
@RC02049 DS    0H                                                  2053 08466000
*         /***********************************************************/ 08467000
*         /*                                                         */ 08468000
*         /* CLOSE DO GROUP WHICH CHECKED VSAM STATUS FOR A  @Y30LB31*/ 08469000
*         /* DUPLICATE VOLUME.                               @Y30LB31*/ 08470000
*         /*                                                         */ 08471000
*         /***********************************************************/ 08472000
*                                                                  2053 08473000
*       END;                        /*                       @Y30LB31*/ 08474000
@RF02043 DS    0H                                                  2053 08475000
@RC02035 DS    0H                                                  2054 08476000
*                                                                  2054 08477000
*   /*****************************************************************/ 08478000
*   /*                                                               */ 08479000
*   /* CALL VLABLRTN TO DIRECT THE SERIAL NO. CHANGE IN THE VOLUME   */ 08480000
*   /* LABEL AND THE CLEARING OF THE SERIAL MISMATCH         @Y30LB31*/ 08481000
*   /* FLAG FROM THE MSVI.                                   @Y30LB31*/ 08482000
*   /*                                                               */ 08483000
*   /*****************************************************************/ 08484000
*                                                                  2054 08485000
*   IF DUPVRC=0 THEN                /*                       @Y30LB31*/ 08486000
@RF02029 DS    0H                                                  2054 08487000
@RC02027 LH    @15,DUPVRC                                          2054 08488000
         LTR   @15,@15                                             2054 08489000
         BNZ   @RF02054                                            2054 08490000
*     DO;                           /*                       @Y30LB31*/ 08491000
*       CALL VLABLRTN;              /*                       @Y30LB31*/ 08492000
         BAL   @14,VLABLRTN                                        2056 08493000
*       RESPECIFY                                                  2057 08494000
*         RTNREG RSTD;                                             2057 08495000
*       TESTRC=RTNREG;                                             2058 08496000
         LR    TESTRC,RTNREG                                       2058 08497000
*       RESPECIFY                                                  2059 08498000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 08499000
*                                                                  2059 08500000
*       /*************************************************************/ 08501000
*       /*                                                           */ 08502000
*       /* IF THE VOLUME LABEL UPDATE FAILED, SET THE        @Y30LB31*/ 08503000
*       /* CONDITION CODE TO INDICATE THE VOLUME HAS BEEN ACTIVATED  */ 08504000
*       /*                                                   @Y30LB31*/ 08505000
*       /* WITH ERRORS.                                      @Y30LB31*/ 08506000
*       /*                                                           */ 08507000
*       /*************************************************************/ 08508000
*                                                                  2060 08509000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 08510000
         LTR   TESTRC,TESTRC                                       2060 08511000
         BZ    @RF02060                                            2060 08512000
*         DUPVRC=LASTCC08;          /*                       @Y30LB31*/ 08513000
         MVC   DUPVRC(2),@CH00182                                  2061 08514000
*     END;                          /*                       @Y30LB31*/ 08515000
*                                                                  2062 08516000
@RF02060 DS    0H                                                  2063 08517000
*   /*****************************************************************/ 08518000
*   /*                                                               */ 08519000
*   /* ISSUE INFORMATIVE MSG, IDC0722I, IF THE               @Y30LB31*/ 08520000
*   /* CONDITION CODE INDICATES THE VOLUME HAS BEEN ACTIVATED.       */ 08521000
*   /*                                                       @Y30LB31*/ 08522000
*   /*                                                               */ 08523000
*   /*****************************************************************/ 08524000
*                                                                  2063 08525000
*   IF DUPVRC=LASTCC08 THEN         /*                       @Y30LB31*/ 08526000
@RF02054 CLC   DUPVRC(2),@CH00182                                  2063 08527000
         BNE   @RF02063                                            2063 08528000
*     DO;                           /*                       @Y30LB31*/ 08529000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 08530000
         XC    PRINTTBL(28),PRINTTBL                               2065 08531000
*       DARGSMOD=ADDVMSGS;          /*                       @Y30LB31*/ 08532000
         L     @15,DDSTRU                                          2066 08533000
         MVC   DARGSMOD(3,@15),@CC01687                            2066 08534000
*       DARGSENT=MSG0722I;          /*                       @Y30LB31*/ 08535000
         MVI   DARGSENT(@15),X'03'                                 2067 08536000
*       DARGDBP=ADDR(MSVIVOL#);     /*                       @Y30LB31*/ 08537000
         LA    @14,MSVIVOL#                                        2068 08538000
         ST    @14,DARGDBP(,@15)                                   2068 08539000
*       DARGILP=LENGTH(MSVIVOL#);   /*                       @Y30LB31*/ 08540000
         MVC   DARGILP(2,@15),@CH00159                             2069 08541000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 08542000
         L     @15,@PC00001                                        2070 08543000
         ST    @15,@AL00001                                        2070 08544000
         LA    @14,@CF00117                                        2070 08545000
         ST    @14,@AL00001+4                                      2070 08546000
         LA    @14,DDSTRU                                          2070 08547000
         ST    @14,@AL00001+8                                      2070 08548000
         MVI   @AL00001+8,X'80'                                    2070 08549000
         L     @15,GDTPRT(,@15)                                    2070 08550000
         LA    @01,@AL00001                                        2070 08551000
         BALR  @14,@15                                             2070 08552000
*     END;                          /*                       @Y30LB31*/ 08553000
*                                                                  2071 08554000
*   /*****************************************************************/ 08555000
*   /*                                                               */ 08556000
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER   @Y30LB31*/ 08557000
*   /* AND EXIT FROM DUPVRTN. PASS THE CONDITION CODE IN     @Y30LB31*/ 08558000
*   /* REG 15.                                               @Y30LB31*/ 08559000
*   /*                                                               */ 08560000
*   /*****************************************************************/ 08561000
*                                                                  2072 08562000
*   RESPECIFY                                                      2072 08563000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 08564000
@RF02063 DS    0H                                                  2073 08565000
*   REG14=RETADDR1;                 /*                       @Y30LB31*/ 08566000
         L     REG14,RETADDR1                                      2073 08567000
*   RESPECIFY                                                      2074 08568000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 08569000
*   RETURN CODE(DUPVRC);            /*                       @Y30LB31*/ 08570000
         LH    @15,DUPVRC                                          2075 08571000
@EL00021 DS    0H                                                  2075 08572000
@EF00021 DS    0H                                                  2075 08573000
@ER00021 BR    @14                                                 2075 08574000
*   END DUPVRTN;                    /*                       @Y30LB31*/ 08575000
*                                                                  2077 08576000
*/********************************************************** @Y30LB31*/ 08577000
*/*                                                          @Y30LB31*/ 08578000
*/* PROCEDURE NAME - BKOUTRTN                                @Y30LB31*/ 08579000
*/*                                                          @Y30LB31*/ 08580000
*/* FUNCTION - CALLS VPREPRTN TO DEMOUNT A DUPLICATE VOLUME  @Y30LB31*/ 08581000
*/*            THAT HAS BEEN ACTIVATED BUT FOUND TO BE       @Y30LB31*/ 08582000
*/*            VSAM.  CALLS RENAMRTN TO RESTORE THE          @Y30LB31*/ 08583000
*/*            ORIGINAL VOLUME SERIAL NO. IN THE             @Y30LB31*/ 08584000
*/*            CARTRIDGE LABELS AND INVENTORY RECORD AND TO  @Y30LB31*/ 08585000
*/*            DEACTIVATE THE VOLUME.  ISSUES MESSAGES       @Y30LB31*/ 08586000
*/*            IDC3062I, IDC0063I, AND IDC3067I.             @Y30LB31*/ 08587000
*/*                                                          @Y30LB31*/ 08588000
*/* INPUT - ADDVTBL, PRINTTBL FOR MESSAGES.                  @Y30LB31*/ 08589000
*/*                                                          @Y30LB31*/ 08590000
*/* OUTPUT - RETURN CODE OF 0 INDICATES ORIGINAL             @Y30LB31*/ 08591000
*/*          VOLUME SERIAL RESTORED AND VOLUME               @Y30LB31*/ 08592000
*/*          DEACTIVATED.  RETURN CODE OF 4 INDICATES EITHER @Y30LB31*/ 08593000
*/*          THE DEMOUNT FAILED THAT IS REQUIRED FOR THE     @Y30LB31*/ 08594000
*/*          BACKOUT OPERATIONS, OR THE ORIGINAL SERIAL NO.  @Y30LB31*/ 08595000
*/*          COULD NOT BE RESTORED.                          @Y30LB31*/ 08596000
*/*                                                          @Y30LB31*/ 08597000
*/********************************************************** @Y30LB31*/ 08598000
*                                                                  2077 08599000
*BKOUTRTN:                                                         2077 08600000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 08601000
*                                                                  2077 08602000
BKOUTRTN DS    0H                                                  2078 08603000
*   /*****************************************************************/ 08604000
*   /*                                                               */ 08605000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 08606000
*   /*                                                               */ 08607000
*   /*****************************************************************/ 08608000
*                                                                  2078 08609000
*   DCL                                                            2078 08610000
*     BKOUTRC FIXED(15);            /*                       @Y30LB31*/ 08611000
*                                                                  2078 08612000
*   /*****************************************************************/ 08613000
*   /*                                                               */ 08614000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON   @Y30LB31*/ 08615000
*   /* EXIT.                                                 @Y30LB31*/ 08616000
*   /*                                                               */ 08617000
*   /*****************************************************************/ 08618000
*                                                                  2079 08619000
*   RESPECIFY                                                      2079 08620000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 08621000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 08622000
         ST    REG14,RETADDR2                                      2080 08623000
*   RESPECIFY                                                      2081 08624000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 08625000
*   OLDERID2=NEWERID2;                                             2082 08626000
         L     @15,@PC00001                                        2082 08627000
         L     @14,GDTTR2(,@15)                                    2082 08628000
         MVC   @TS00001(95),NEWERID2(@14)                          2082 08629000
         MVC   OLDERID2(95,@14),@TS00001                           2082 08630000
*   NEWID2='AVBK';                  /*                       @Y30LB31*/ 08631000
*                                                                  2083 08632000
         MVC   NEWID2(4,@14),@CC01954                              2083 08633000
*   /*****************************************************************/ 08634000
*   /*                                                               */ 08635000
*   /* ZERO OUT CONDITION CODE SET BY THIS PROC.             @Y30LB31*/ 08636000
*   /*                                                               */ 08637000
*   /*****************************************************************/ 08638000
*                                                                  2084 08639000
*   BKOUTRC=LASTCC00;               /*                       @Y30LB31*/ 08640000
*                                                                  2084 08641000
         SLR   @14,@14                                             2084 08642000
         STH   @14,BKOUTRC                                         2084 08643000
*   /*****************************************************************/ 08644000
*   /*                                                               */ 08645000
*   /* ISSUE MSG IDC3067I IDENTIFYING THE VOLUME AS          @Y30LB31*/ 08646000
*   /* VSAM AND NOT TO BE ACTIVATED.                         @Y30LB31*/ 08647000
*   /*                                                               */ 08648000
*   /*****************************************************************/ 08649000
*                                                                  2085 08650000
*   PRINTTBL=''B;                   /*                       @Y30LB31*/ 08651000
         XC    PRINTTBL(28),PRINTTBL                               2085 08652000
*   DARGSMOD=COMMSGS;               /*                       @Y30LB31*/ 08653000
         L     @14,DDSTRU                                          2086 08654000
         MVC   DARGSMOD(3,@14),@CC01697                            2086 08655000
*   DARGSENT=MSG3067I;              /* STID=CM041            @Y30LB31*/ 08656000
         MVI   DARGSENT(@14),X'29'                                 2087 08657000
*   DARGDBP=ADDR(MSVIVOL#);         /*                       @Y30LB31*/ 08658000
         LA    @05,MSVIVOL#                                        2088 08659000
         ST    @05,DARGDBP(,@14)                                   2088 08660000
*   DARGILP=LENGTH(MSVIVOL#);       /*                       @Y30LB31*/ 08661000
         MVC   DARGILP(2,@14),@CH00159                             2089 08662000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB31*/ 08663000
*                                                                  2090 08664000
         ST    @15,@AL00001                                        2090 08665000
         LA    @14,@CF00117                                        2090 08666000
         ST    @14,@AL00001+4                                      2090 08667000
         LA    @14,DDSTRU                                          2090 08668000
         ST    @14,@AL00001+8                                      2090 08669000
         MVI   @AL00001+8,X'80'                                    2090 08670000
         L     @15,GDTPRT(,@15)                                    2090 08671000
         LA    @01,@AL00001                                        2090 08672000
         BALR  @14,@15                                             2090 08673000
*   /*****************************************************************/ 08674000
*   /*                                                               */ 08675000
*   /* DEMOUNT THE VOLUME IN ORDER TO ISSUE THE MSC RENAME   @Y30LB31*/ 08676000
*   /* ORDER TO RESTORE THE ORIGINAL VOLUME SERIAL NO.       @Y30LB31*/ 08677000
*   /*                                                               */ 08678000
*   /*****************************************************************/ 08679000
*                                                                  2091 08680000
*   MOUNTFLG=OFF;                   /* DEMOUNT REQUIRED      @Y30LB31*/ 08681000
*   WAITFLG=ON;                     /* WAIT TO DEMOUNT FINISH      2092 08682000
*                                                            @Y30LB31*/ 08683000
         OI    WAITFLG,B'00100000'                                 2092 08684000
         NI    MOUNTFLG,B'10111111'                                2092 08685000
*   VPREPVOL=MSVIVOL#;              /*                       @Y30LB31*/ 08686000
         MVC   VPREPVOL(6),MSVIVOL#                                2093 08687000
*   CALL VPREPRTN;                  /*                       @Y30LB31*/ 08688000
         BAL   @14,VPREPRTN                                        2094 08689000
*   RESPECIFY                                                      2095 08690000
*     RTNREG RSTD;                                                 2095 08691000
*   TESTRC=RTNREG;                                                 2096 08692000
         LR    TESTRC,RTNREG                                       2096 08693000
*   RESPECIFY                                                      2097 08694000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 08695000
*                                                                  2097 08696000
*   /*****************************************************************/ 08697000
*   /*                                                               */ 08698000
*   /* IF THE DEMOUNT FAILED, PROCEED TO                     @Y30BL31*/ 08699000
*   /* ISSUE MSG IDC3062I BEFORE EXITING FROM THIS PROC.     @Y30LB31*/ 08700000
*   /*                                                               */ 08701000
*   /*****************************************************************/ 08702000
*                                                                  2098 08703000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 08704000
         LTR   TESTRC,TESTRC                                       2098 08705000
         BZ    @RF02098                                            2098 08706000
*     BKOUTRC=4;                    /*                       @Y30LB31*/ 08707000
*                                                                  2099 08708000
         MVC   BKOUTRC(2),@CH00043                                 2099 08709000
*   /*****************************************************************/ 08710000
*   /*                                                               */ 08711000
*   /* FOLLOWING THE SUCCESSFUL DEMOUNT, RESTORE THE         @Y30LB31*/ 08712000
*   /* ORIGINAL VOLUME SERIAL NO. AND DEACTIVATE THE VOLUME. @Y30LB31*/ 08713000
*   /*                                                               */ 08714000
*   /*****************************************************************/ 08715000
*                                                                  2100 08716000
*   ELSE                            /*                       @Y30LB31*/ 08717000
*     DO;                           /*                       @Y30LB31*/ 08718000
         B     @RC02098                                            2100 08719000
@RF02098 DS    0H                                                  2101 08720000
*       RENAMTYP=BACKOUT;           /*                       @Y30LB31*/ 08721000
         MVC   RENAMTYP(8),@CC01674                                2101 08722000
*       MSGFLG=OFF;                 /* DO NOT SAVE RENAME MSG      2102 08723000
*                                                            @Y30LB31*/ 08724000
         NI    MSGFLG,B'11101111'                                  2102 08725000
*       CALL RENAMRTN;              /*                       @Y30LB31*/ 08726000
         BAL   @14,RENAMRTN                                        2103 08727000
*       RESPECIFY                                                  2104 08728000
*         RTNREG RSTD;                                             2104 08729000
*       TESTRC=RTNREG;                                             2105 08730000
         LR    TESTRC,RTNREG                                       2105 08731000
*       RESPECIFY                                                  2106 08732000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 08733000
*                                                                  2106 08734000
*       /*************************************************************/ 08735000
*       /*                                                           */ 08736000
*       /* TEST RETURN CODE FROM THE BACKOUT OPERATION.      @Y30LB31*/ 08737000
*       /* ISSUE MSG IDC0063I IF THE ORIGINAL VOLUME SERIAL NO. WAS  */ 08738000
*       /*                                                   @Y30LB31*/ 08739000
*       /* SUCCESSFULLY RESTORED.                            @Y30LB31*/ 08740000
*       /*                                                           */ 08741000
*       /*************************************************************/ 08742000
*                                                                  2107 08743000
*       IF TESTRC=0 THEN            /*                       @Y30LB31*/ 08744000
         LTR   TESTRC,TESTRC                                       2107 08745000
         BNZ   @RF02107                                            2107 08746000
*         DO;                       /*                       @Y30LB31*/ 08747000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 08748000
         XC    PRINTTBL(28),PRINTTBL                               2109 08749000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 08750000
         L     @15,DDSTRU                                          2110 08751000
         MVC   DARGSMOD(3,@15),@CC01697                            2110 08752000
*           DARGSENT=MSG0063I;      /* STID=CM047            @Y30LB31*/ 08753000
         MVI   DARGSENT(@15),X'2F'                                 2111 08754000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 08755000
         L     @15,@PC00001                                        2112 08756000
         ST    @15,@AL00001                                        2112 08757000
         LA    @14,@CF00117                                        2112 08758000
         ST    @14,@AL00001+4                                      2112 08759000
         LA    @14,DDSTRU                                          2112 08760000
         ST    @14,@AL00001+8                                      2112 08761000
         MVI   @AL00001+8,X'80'                                    2112 08762000
         L     @15,GDTPRT(,@15)                                    2112 08763000
         LA    @01,@AL00001                                        2112 08764000
         BALR  @14,@15                                             2112 08765000
*         END;                      /*                       @Y30LB31*/ 08766000
*       ELSE                        /*                       @Y30LB31*/ 08767000
*         BKOUTRC=4;                /*                       @Y30LB31*/ 08768000
         B     @RC02107                                            2114 08769000
@RF02107 MVC   BKOUTRC(2),@CH00043                                 2114 08770000
*     END;                          /*                       @Y30BL31*/ 08771000
@RC02107 DS    0H                                                  2116 08772000
*                                                                  2116 08773000
*   /*****************************************************************/ 08774000
*   /*                                                               */ 08775000
*   /* FOR EITHER A VOLUME DEMOUNT                           @Y30LB31*/ 08776000
*   /* FAILURE OR MSC RENAME FAILURE, ISSUE MSG IDC3062I SINCE       */ 08777000
*   /*                                                       @Y30LB31*/ 08778000
*   /* THE ORIGINAL VOLUME SERIAL NO. COULD NOT BE RESTORED IN       */ 08779000
*   /*                                                       @Y30LB31*/ 08780000
*   /* THE CARTRIDGE LABELS AND INVENTORY RECORD. THE VOLUME @Y30LB31*/ 08781000
*   /* HAS BEEN ACTIVATED BUT A SERIAL MISMATCH EXISTS IN THE        */ 08782000
*   /*                                                       @Y30LB31*/ 08783000
*   /* CARTRIDGE AND VOLUME LABELS.                          @Y30LB31*/ 08784000
*   /*                                                               */ 08785000
*   /*****************************************************************/ 08786000
*                                                                  2116 08787000
*   IF BKOUTRC^=0 THEN              /*                       @Y30LB31*/ 08788000
@RC02098 LH    @15,BKOUTRC                                         2116 08789000
         LTR   @15,@15                                             2116 08790000
         BZ    @RF02116                                            2116 08791000
*     DO;                           /*                       @Y30LB31*/ 08792000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 08793000
         XC    PRINTTBL(28),PRINTTBL                               2118 08794000
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/ 08795000
         L     @15,DDSTRU                                          2119 08796000
         MVC   DARGSMOD(3,@15),@CC01697                            2119 08797000
*       DARGSENT=MSG3062I;          /* STID=CM048            @Y30LB31*/ 08798000
         MVI   DARGSENT(@15),X'30'                                 2120 08799000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 08800000
         L     @15,@PC00001                                        2121 08801000
         ST    @15,@AL00001                                        2121 08802000
         LA    @14,@CF00117                                        2121 08803000
         ST    @14,@AL00001+4                                      2121 08804000
         LA    @14,DDSTRU                                          2121 08805000
         ST    @14,@AL00001+8                                      2121 08806000
         MVI   @AL00001+8,X'80'                                    2121 08807000
         L     @15,GDTPRT(,@15)                                    2121 08808000
         LA    @01,@AL00001                                        2121 08809000
         BALR  @14,@15                                             2121 08810000
*     END;                          /*                       @Y30LB31*/ 08811000
*                                                                  2122 08812000
*   /*****************************************************************/ 08813000
*   /*                                                               */ 08814000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */ 08815000
*   /* FROM BKOUTRTN. PASS THE CONDITION CODE IN             @Y30LB31*/ 08816000
*   /* REG 15.                                               @Y30LB31*/ 08817000
*   /*                                                               */ 08818000
*   /*****************************************************************/ 08819000
*                                                                  2123 08820000
*   RESPECIFY                                                      2123 08821000
*     REG14 RSTD;                   /*                       @ZDR2054*/ 08822000
@RF02116 DS    0H                                                  2124 08823000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 08824000
         L     REG14,RETADDR2                                      2124 08825000
*   RESPECIFY                                                      2125 08826000
*     REG14 UNRSTD;                 /*                       @ZDR2054*/ 08827000
*   RETURN CODE(BKOUTRC);           /*                       @Y30LB31*/ 08828000
         LH    @15,BKOUTRC                                         2126 08829000
@EL00022 DS    0H                                                  2126 08830000
@EF00022 DS    0H                                                  2126 08831000
@ER00022 BR    @14                                                 2126 08832000
*   END BKOUTRTN;                   /*                       @Y30LB31*/ 08833000
*                                                                  2128 08834000
*/****************************************************************** */ 08835000
*/*                                                          @Y30LB32*/ 08836000
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/ 08837000
*/*                                                          @Y30LB32*/ 08838000
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/ 08839000
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/ 08840000
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/ 08841000
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/ 08842000
*/*             CHARACTER                                    @Y30LB32*/ 08843000
*/*                                                          @Y30LB32*/ 08844000
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/ 08845000
*/*                                                          @Y30LB32*/ 08846000
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/ 08847000
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/ 08848000
*/*                                                          @Y30LB32*/ 08849000
*/********************************************************************/ 08850000
*                                                                  2128 08851000
*CKCSNLEN:                          /*                       @Y30LB32*/ 08852000
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/ 08853000
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/ 08854000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/ 08855000
*                                                                  2128 08856000
CKCSNLEN MVC   @PC00023(8),0(@01)                                  2128 08857000
*   /*****************************************************************/ 08858000
*   /*                                                               */ 08859000
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/ 08860000
*   /*                                                               */ 08861000
*   /*****************************************************************/ 08862000
*                                                                  2129 08863000
*   DCL                                                            2129 08864000
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/ 08865000
*   DCL                                                            2130 08866000
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/ 08867000
*   DCL                                                            2131 08868000
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/ 08869000
*   DCL                                                            2132 08870000
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/ 08871000
*   DCL                                                            2133 08872000
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/ 08873000
*   DCL                                                            2134 08874000
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/ 08875000
*   DCL                                                            2135 08876000
*     CKCOND FIXED(15);                                            2135 08877000
*                                                                  2135 08878000
*   /*****************************************************************/ 08879000
*   /*                                                               */ 08880000
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/ 08881000
*   /*                                                               */ 08882000
*   /*****************************************************************/ 08883000
*                                                                  2136 08884000
*   DCL                                                            2136 08885000
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32   08886000
*                                      CSN                   @Y30LB32*/ 08887000
*   DCL                                                            2137 08888000
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32   08889000
*                                      OF CSN AGAINST        @Y30LB32*/ 08890000
*   DCL                                                            2138 08891000
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/ 08892000
*   DCL                                                            2139 08893000
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/ 08894000
*                                                                  2140 08895000
*   /*****************************************************************/ 08896000
*   /*                                                               */ 08897000
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/ 08898000
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/ 08899000
*   /*                                                               */ 08900000
*   /*****************************************************************/ 08901000
*                                                                  2140 08902000
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/ 08903000
         LR    CKRETPTR,REG14                                      2140 08904000
*   OLDERID2=NEWERID2;                                             2141 08905000
         L     @02,@PC00001                                        2141 08906000
         L     @02,GDTTR2(,@02)                                    2141 08907000
         MVC   @TS00001(95),NEWERID2(@02)                          2141 08908000
         MVC   OLDERID2(95,@02),@TS00001                           2141 08909000
*   NEWID2='CKLN';                  /*                       @Y30LB32*/ 08910000
*                                                                  2142 08911000
         MVC   NEWID2(4,@02),@CC01972                              2142 08912000
*   /*****************************************************************/ 08913000
*   /*                                                               */ 08914000
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/ 08915000
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/ 08916000
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/ 08917000
*   /*                                                               */ 08918000
*   /*****************************************************************/ 08919000
*                                                                  2143 08920000
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/ 08921000
         L     @02,DDSTRU                                          2143 08922000
         ST    @02,CKSAVPTR                                        2143 08923000
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/ 08924000
         LA    @02,CKPRTTAB                                        2144 08925000
         ST    @02,DDSTRU                                          2144 08926000
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/ 08927000
         XC    CKPRTTAB(20),CKPRTTAB                               2145 08928000
*   CKCOND=''B;                     /*                       @Y30LB32*/ 08929000
*                                                                  2146 08930000
         SLR   CKCOND,CKCOND                                       2146 08931000
*   /*****************************************************************/ 08932000
*   /*                                                               */ 08933000
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/ 08934000
*   /* OR MORE                                               @Y30LB32*/ 08935000
*   /*                                                               */ 08936000
*   /*****************************************************************/ 08937000
*                                                                  2147 08938000
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/ 08939000
*                                                                  2147 08940000
         L     @02,@PC00023+4                                      2147 08941000
         CLI   CKLENGTH(@02),11                                    2147 08942000
         BL    @RF02147                                            2147 08943000
*     /***************************************************************/ 08944000
*     /*                                                             */ 08945000
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/ 08946000
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/ 08947000
*     /* CHARACTER                                           @Y30LB32*/ 08948000
*     /*                                                             */ 08949000
*     /***************************************************************/ 08950000
*                                                                  2148 08951000
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/ 08952000
         CLI   CKLENGTH(@02),11                                    2148 08953000
         BNE   @RF02148                                            2148 08954000
*       DO;                         /*                       @Y30LB32*/ 08955000
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/ 08956000
         MVI   CKCSNADJ+3,C' '                                     2150 08957000
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/ 08958000
         L     @02,@PC00023                                        2151 08959000
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@02)                       2151 08960000
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/ 08961000
         MVC   CKCSNVAL+3(9,@02),CKCSNADJ+3                        2152 08962000
*       END;                        /*                       @Y30LB32*/ 08963000
*     ELSE                                                         2154 08964000
*       ;                           /*                       @Y30LB32*/ 08965000
*                                                                  2154 08966000
@RF02148 DS    0H                                                  2155 08967000
*   /*****************************************************************/ 08968000
*   /*                                                               */ 08969000
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/ 08970000
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/ 08971000
*   /*                                                               */ 08972000
*   /*****************************************************************/ 08973000
*                                                                  2155 08974000
*   ELSE                            /*                       @Y30LB32*/ 08975000
*     DO;                           /*                       @Y30LB32*/ 08976000
         B     @RC02147                                            2155 08977000
@RF02147 DS    0H                                                  2156 08978000
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/ 08979000
         L     @02,DDSTRU                                          2156 08980000
         MVC   DARGSMOD(3,@02),@CC01697                            2156 08981000
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/ 08982000
         MVI   DARGSENT(@02),X'01'                                 2157 08983000
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/ 08984000
         L     @15,@PC00023                                        2158 08985000
         ST    @15,DARGDBP(,@02)                                   2158 08986000
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/ 08987000
         MVC   DARGILP(2,@02),@CH00606                             2159 08988000
*       DARGRETP=''B;               /*                       @Y30LB32*/ 08989000
         SLR   @15,@15                                             2160 08990000
         ST    @15,DARGRETP(,@02)                                  2160 08991000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 08992000
         L     @02,@PC00001                                        2161 08993000
         ST    @02,@AL00001                                        2161 08994000
         LA    @15,@CF00117                                        2161 08995000
         ST    @15,@AL00001+4                                      2161 08996000
         LA    @15,DDSTRU                                          2161 08997000
         ST    @15,@AL00001+8                                      2161 08998000
         MVI   @AL00001+8,X'80'                                    2161 08999000
         L     @15,GDTPRT(,@02)                                    2161 09000000
         LA    @01,@AL00001                                        2161 09001000
         BALR  @14,@15                                             2161 09002000
*       CKCOND=4;                   /*                       @Y30LB32*/ 09003000
         LA    CKCOND,4                                            2162 09004000
*     END;                          /*                       @Y30LB32*/ 09005000
*                                                                  2163 09006000
*   /*****************************************************************/ 09007000
*   /*                                                               */ 09008000
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/ 09009000
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/ 09010000
*   /*                                                               */ 09011000
*   /*****************************************************************/ 09012000
*                                                                  2164 09013000
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/ 09014000
@RC02147 L     @02,CKSAVPTR                                        2164 09015000
         ST    @02,DDSTRU                                          2164 09016000
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/ 09017000
         LR    REG14,CKRETPTR                                      2165 09018000
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/ 09019000
         LR    @15,CKCOND                                          2166 09020000
@EL00023 DS    0H                                                  2166 09021000
@EF00023 DS    0H                                                  2166 09022000
@ER00023 BR    @14                                                 2166 09023000
*   END CKCSNLEN;                   /*                       @Y30LB32*/ 09024000
*                                                                  2168 09025000
*/***********************************************************@Y30LB39*/ 09026000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 09027000
*/*                                                          @Y30LB39*/ 09028000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 09029000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 09030000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 09031000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 09032000
*/*                                                          @Y30LB39*/ 09033000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 09034000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 09035000
*/*   IN SSECBCD.                                            @Y30LB39*/ 09036000
*/*                                                          @Y30LB39*/ 09037000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 09038000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 09039000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 09040000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 09041000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 09042000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 09043000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 09044000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 09045000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 09046000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 09047000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 09048000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 09049000
*/*                                                          @Y30LB39*/ 09050000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 09051000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 09052000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 09053000
*/*                                                          @Y30LB39*/ 09054000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 09055000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 09056000
*/*                                                          @Y30LB39*/ 09057000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 09058000
*/*                                                          @Y30LB39*/ 09059000
*/***********************************************************@Y30LB39*/ 09060000
*                                                                  2168 09061000
*                                   /*                       @Y30LB39*/ 09062000
*SSCMSG:                                                           2168 09063000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 09064000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   09065000
*                                                            @Y30LB39*/ 09066000
SSCMSG   STM   @14,@12,@SA00024                                    2168 09067000
         MVC   @PC00024(8),0(@01)                                  2168 09068000
*                                   /*                       @Y30LB39*/ 09069000
*                                                                  2169 09070000
*   /*****************************************************************/ 09071000
*   /*                                                               */ 09072000
*   /*                                                       @Y30LB39*/ 09073000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 09074000
*   /*                                                       @Y30LB39*/ 09075000
*   /*                                                               */ 09076000
*   /*****************************************************************/ 09077000
*                                                                  2169 09078000
*                                   /*                       @Y30LB39   09079000
*                                                            @Y30LB39*/ 09080000
*                                                                  2169 09081000
*   /*****************************************************************/ 09082000
*   /*                                                               */ 09083000
*   /*                                                       @Y30LB39*/ 09084000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 09085000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 09086000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 09087000
*   /*                                                       @Y30LB39*/ 09088000
*   /*                                                               */ 09089000
*   /*****************************************************************/ 09090000
*                                                                  2169 09091000
*                                   /*                       @Y30LB39*/ 09092000
*   DCL                                                            2169 09093000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 09094000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 09095000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 09096000
*   DCL                                                            2170 09097000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   09098000
*                                                            @Y30LB39   09099000
*                                                            @Y30LB39*/ 09100000
*                                                                  2170 09101000
*   /*****************************************************************/ 09102000
*   /*                                                               */ 09103000
*   /*                                                       @Y30LB39*/ 09104000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 09105000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 09106000
*   /*                                                       @Y30LB39*/ 09107000
*   /*                                                               */ 09108000
*   /*****************************************************************/ 09109000
*                                                                  2171 09110000
*                                   /*                       @Y30LB39*/ 09111000
*   DCL                                                            2171 09112000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 09113000
*   DCL                                                            2172 09114000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   09115000
*                                                            @Y30LB39*/ 09116000
*                                                                  2172 09117000
*   /*****************************************************************/ 09118000
*   /*                                                               */ 09119000
*   /*                                                       @Y30LB39*/ 09120000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 09121000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 09122000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 09123000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 09124000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 09125000
*   /*                                                       @Y30LB39*/ 09126000
*   /*                                                               */ 09127000
*   /*****************************************************************/ 09128000
*                                                                  2173 09129000
*                                   /*                       @Y30LB39*/ 09130000
*   DECLARE                                                        2173 09131000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   09132000
*                                                            @Y30LB39*/ 09133000
*                                                                  2173 09134000
*   /*****************************************************************/ 09135000
*   /*                                                               */ 09136000
*   /*                                                       @Y30LB39*/ 09137000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 09138000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 09139000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 09140000
*   /* IDCTSCM0.                                             @Y30LB39*/ 09141000
*   /*                                                       @Y30LB39*/ 09142000
*   /*                                                               */ 09143000
*   /*****************************************************************/ 09144000
*                                                                  2174 09145000
*                                   /*                       @Y30LB39*/ 09146000
*   DECLARE                                                        2174 09147000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   09148000
*                                                            @Y30LB39*/ 09149000
*                                                                  2174 09150000
*   /*****************************************************************/ 09151000
*   /*                                                               */ 09152000
*   /*                                                       @Y30LB39*/ 09153000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 09154000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 09155000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 09156000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 09157000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 09158000
*   /*                                                       @Y30LB39*/ 09159000
*   /*                                                               */ 09160000
*   /*****************************************************************/ 09161000
*                                                                  2175 09162000
*                                   /*                       @Y30LB39*/ 09163000
*   DECLARE                                                        2175 09164000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 09165000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   09166000
*                                                            @Y30LB39*/ 09167000
*                                                                  2175 09168000
*   /*****************************************************************/ 09169000
*   /*                                                               */ 09170000
*   /*                                                       @Y30LB39*/ 09171000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 09172000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 09173000
*   /*                                                       @Y30LB39*/ 09174000
*   /*                                                               */ 09175000
*   /*****************************************************************/ 09176000
*                                                                  2176 09177000
*                                   /*                       @Y30LB39*/ 09178000
*   DECLARE                                                        2176 09179000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   09180000
*                                                            @Y30LB39*/ 09181000
*                                                                  2176 09182000
*   /*****************************************************************/ 09183000
*   /*                                                               */ 09184000
*   /*                                                       @Y30LB39*/ 09185000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 09186000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 09187000
*   /*                                                       @Y30LB39*/ 09188000
*   /*                                                               */ 09189000
*   /*****************************************************************/ 09190000
*                                                                  2177 09191000
*                                   /*                       @Y30LB39*/ 09192000
*   DECLARE                                                        2177 09193000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   09194000
*                                                            @Y30LB39*/ 09195000
*                                   /*                       @Y30LB39*/ 09196000
*                                                                  2178 09197000
*   /*****************************************************************/ 09198000
*   /*                                                               */ 09199000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 09200000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 09201000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 09202000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 09203000
*   /*                                                       @Y30LB39*/ 09204000
*   /*                                                               */ 09205000
*   /*****************************************************************/ 09206000
*                                                                  2178 09207000
*                                   /*                       @Y30LB39*/ 09208000
*   OLDERID2=NEWERID2;                                             2178 09209000
         L     @15,@PC00001                                        2178 09210000
         L     @14,GDTTR2(,@15)                                    2178 09211000
         MVC   @TS00001(95),NEWERID2(@14)                          2178 09212000
         MVC   OLDERID2(95,@14),@TS00001                           2178 09213000
*   NEWID2='SSAA';                  /*                       @Y30LB39   09214000
*                                                            @Y30LB39*/ 09215000
*                                                                  2179 09216000
         MVC   NEWID2(4,@14),@CC01994                              2179 09217000
*   /*****************************************************************/ 09218000
*   /*                                                               */ 09219000
*   /*                                                       @Y30LB39*/ 09220000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 09221000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 09222000
*   /*                                                       @Y30LB39*/ 09223000
*   /*                                                               */ 09224000
*   /*****************************************************************/ 09225000
*                                                                  2180 09226000
*                                   /*                       @Y30LB39*/ 09227000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   09228000
*                                                            @Y30LB39*/ 09229000
*                                                                  2180 09230000
         LA    @14,SSDRGLT                                         2180 09231000
         ST    @14,SSDLPTR                                         2180 09232000
*   /*****************************************************************/ 09233000
*   /*                                                               */ 09234000
*   /*                                                       @Y30LB39*/ 09235000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 09236000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 09237000
*   /*                                                       @Y30LB39*/ 09238000
*   /*                                                               */ 09239000
*   /*****************************************************************/ 09240000
*                                                                  2181 09241000
*                                   /*                       @Y30LB39*/ 09242000
*   IF SSRCODE>0 THEN                                              2181 09243000
         L     @07,@PC00024                                        2181 09244000
         L     @07,SSRCODE(,@07)                                   2181 09245000
         LTR   @07,@07                                             2181 09246000
         BNP   @RF02181                                            2181 09247000
*     DO;                           /*                       @Y30LB39   09248000
*                                                            @Y30LB39*/ 09249000
*                                                                  2182 09250000
*       /*************************************************************/ 09251000
*       /*                                                           */ 09252000
*       /*                                                   @Y30LB39*/ 09253000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 09254000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 09255000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 09256000
*       /* CODES.                                            @Y30LB39*/ 09257000
*       /*                                                   @Y30LB39*/ 09258000
*       /*                                                           */ 09259000
*       /*************************************************************/ 09260000
*                                                                  2183 09261000
*                                   /*                       @Y30LB39*/ 09262000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 09263000
         XC    SSDRGLT(20),SSDRGLT                                 2183 09264000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 09265000
         LA    @03,SSINXLST                                        2184 09266000
         ST    @03,DARGRETP(,@14)                                  2184 09267000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 09268000
         MVC   DARGSMOD(3,@14),SSMODSS0                            2185 09269000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 09270000
         MVI   DARGSENT(@14),X'01'                                 2186 09271000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   09272000
*                                                            @Y30LB39*/ 09273000
*                                                                  2187 09274000
         MVC   DARGRETL(2,@14),@CH02005                            2187 09275000
*       /*************************************************************/ 09276000
*       /*                                                           */ 09277000
*       /*                                                   @Y30LB39*/ 09278000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 09279000
*       /* ARRAY.                                            @Y30LB39*/ 09280000
*       /*                                                   @Y30LB39*/ 09281000
*       /*                                                           */ 09282000
*       /*************************************************************/ 09283000
*                                                                  2188 09284000
*                                   /*                       @Y30LB39*/ 09285000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   09286000
*                                                            @Y30LB39*/ 09287000
*                                                                  2188 09288000
         ST    @15,@AL00001                                        2188 09289000
         LA    @03,@CF00117                                        2188 09290000
         ST    @03,@AL00001+4                                      2188 09291000
         LA    @03,SSDLPTR                                         2188 09292000
         ST    @03,@AL00001+8                                      2188 09293000
         MVI   @AL00001+8,X'80'                                    2188 09294000
         L     @15,GDTPRT(,@15)                                    2188 09295000
         LA    @01,@AL00001                                        2188 09296000
         BALR  @14,@15                                             2188 09297000
*       /*************************************************************/ 09298000
*       /*                                                           */ 09299000
*       /*                                                   @Y30LB39*/ 09300000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 09301000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 09302000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 09303000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 09304000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 09305000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 09306000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 09307000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 09308000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 09309000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 09310000
*       /* REASON CODE.                                      @Y30LB39*/ 09311000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 09312000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 09313000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 09314000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 09315000
*       /*                                                   @Y30LB39*/ 09316000
*       /*                                                           */ 09317000
*       /*************************************************************/ 09318000
*                                                                  2189 09319000
*                                   /*                       @Y30LB39*/ 09320000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 09321000
         LA    ENTRYNUM,1                                          2189 09322000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   2190 09323000
@DL02190 DS    0H                                                  2191 09324000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 09325000
         AL    ENTRYNUM,@CF00222                                   2191 09326000
*       END;                        /*                       @Y30LB39   09327000
*                                                            @Y30LB39*/ 09328000
*                                                                  2192 09329000
@DE02190 L     @03,@PC00024                                        2192 09330000
         LR    @15,ENTRYNUM                                        2192 09331000
         ALR   @15,@15                                             2192 09332000
         LH    @15,SSARRAY-2(@15)                                  2192 09333000
         CH    @15,SSRHALF(,@03)                                   2192 09334000
         BE    @DC02190                                            2192 09335000
         SLR   @14,@14                                             2192 09336000
         CR    @15,@14                                             2192 09337000
         BNE   @DL02190                                            2192 09338000
@DC02190 DS    0H                                                  2193 09339000
*       /*************************************************************/ 09340000
*       /*                                                           */ 09341000
*       /*                                                   @Y30LB39*/ 09342000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 09343000
*       /*                                                   @Y30LB39*/ 09344000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 09345000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 09346000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 09347000
*       /* CODE OR                                           @Y30LB39*/ 09348000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 09349000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 09350000
*       /*                                                   @Y30LB39*/ 09351000
*       /*                                                           */ 09352000
*       /*************************************************************/ 09353000
*                                                                  2193 09354000
*                                   /*                       @Y30LB39*/ 09355000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 09356000
         XC    SSDRGLT(20),SSDRGLT                                 2193 09357000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 09358000
         L     @07,SSDLPTR                                         2194 09359000
         MVC   DARGSMOD(3,@07),SSMODSS0                            2194 09360000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 09361000
         STC   ENTRYNUM,DARGSENT(,@07)                             2195 09362000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 09363000
         CR    @15,@14                                             2196 09364000
         BNE   @RF02196                                            2196 09365000
*         DO;                       /*                       @Y30LB39*/ 09366000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 09367000
         ST    @03,DARGDBP(,@07)                                   2198 09368000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 09369000
         MVC   DARGILP(2,@07),@CH00043                             2199 09370000
*         END;                      /*                       @Y30LB39*/ 09371000
*     END;                          /*                       @Y30LB39*/ 09372000
*                                   /*                       @Y30LB39*/ 09373000
*                                                                  2202 09374000
*   /*****************************************************************/ 09375000
*   /*                                                               */ 09376000
*   /*                                                       @Y30LB39*/ 09377000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 09378000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 09379000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 09380000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 09381000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 09382000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 09383000
*   /* POST CODE.                                            @Y30LB39*/ 09384000
*   /*                                                       @Y30LB39*/ 09385000
*   /*                                                               */ 09386000
*   /*****************************************************************/ 09387000
*                                                                  2202 09388000
*                                   /*                       @Y30LB39*/ 09389000
*   ELSE                            /*                       @Y30LB39*/ 09390000
*     DO;                           /*                       @Y30LB39*/ 09391000
         B     @RC02181                                            2202 09392000
@RF02181 DS    0H                                                  2203 09393000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 09394000
         XC    SSDRGLT(20),SSDRGLT                                 2203 09395000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 09396000
         L     @15,SSDLPTR                                         2204 09397000
         MVC   DARGSMOD(3,@15),SSMODCM0                            2204 09398000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 09399000
         MVC   DARGSENT(1,@15),SSMSGNUM                            2205 09400000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 09401000
         L     @14,@PC00024+4                                      2206 09402000
         ST    @14,DARGDBP(,@15)                                   2206 09403000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 09404000
         MVC   DARGILP(2,@15),@CH00222                             2207 09405000
*     END;                          /*                       @Y30LB39   09406000
*                                                            @Y30LB39*/ 09407000
*                                                                  2208 09408000
*   /*****************************************************************/ 09409000
*   /*                                                               */ 09410000
*   /*                                                       @Y30LB39*/ 09411000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 09412000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 09413000
*   /*                                                       @Y30LB39*/ 09414000
*   /*                                                               */ 09415000
*   /*****************************************************************/ 09416000
*                                                                  2209 09417000
*                                   /*                       @Y30LB39*/ 09418000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   09419000
*                                                            @Y30LB39*/ 09420000
*                                                                  2209 09421000
@RC02181 L     @15,@PC00001                                        2209 09422000
         ST    @15,@AL00001                                        2209 09423000
         LA    @14,@CF00117                                        2209 09424000
         ST    @14,@AL00001+4                                      2209 09425000
         LA    @14,SSDLPTR                                         2209 09426000
         ST    @14,@AL00001+8                                      2209 09427000
         MVI   @AL00001+8,X'80'                                    2209 09428000
         L     @15,GDTPRT(,@15)                                    2209 09429000
         LA    @01,@AL00001                                        2209 09430000
         BALR  @14,@15                                             2209 09431000
*   /*****************************************************************/ 09432000
*   /*                                                               */ 09433000
*   /*                                                       @Y30LB39*/ 09434000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 09435000
*   /*                                                       @Y30LB39*/ 09436000
*   /*                                                               */ 09437000
*   /*****************************************************************/ 09438000
*                                                                  2210 09439000
*                                   /*                       @Y30LB39   09440000
*                                                            @Y30LB39*/ 09441000
*   RETURN CODE(0);                 /*                       @Y30LB39   09442000
*                                                            @Y30LB39*/ 09443000
         SLR   @15,@15                                             2210 09444000
         L     @14,@SA00024                                        2210 09445000
         LM    @00,@12,@SA00024+8                                  2210 09446000
         BR    @14                                                 2210 09447000
*   END SSCMSG;                     /*                       @Y30LB39*/ 09448000
*   END IDCAV01                     /*                       @Y30LB31*/ 09449000
*                                                                  2212 09450000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 09451000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 09452000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 09453000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 09454000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 09455000
*/*%INCLUDE SYSLIB  (IDCCSAV )                                       */ 09456000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 09457000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 09458000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 09459000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 09460000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 09461000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 09462000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 09463000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 09464000
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */ 09465000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 09466000
*                                                                  2212 09467000
*       ;                                                          2212 09468000
@DATA    DS    0H                                                       09469000
@CH00156 DC    H'2'                                                     09470000
@CH00298 DC    H'5'                                                     09471000
@CH00159 DC    H'6'                                                     09472000
@CH00885 DC    H'29'                                                    09473000
@CH02001 DC    H'37'                                                    09474000
@CH02003 DC    H'52'                                                    09475000
@CH01999 DC    H'59'                                                    09476000
@CH02002 DC    H'74'                                                    09477000
@CH01998 DC    H'76'                                                    09478000
@CH02004 DC    H'96'                                                    09479000
@CH02005 DC    H'120'                                                   09480000
@CH01997 DC    H'164'                                                   09481000
@CH02000 DC    H'212'                                                   09482000
@CH01996 DC    H'224'                                                   09483000
         DS    0F                                                       09484000
@AL00366 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        09485000
         DC    A(WAIT)                                                  09486000
         DC    A(@CC01635)                                              09487000
@DATD    DSECT                                                          09488000
         DS    0F                                                       09489000
@SA00001 DS    18F                                                      09490000
@PC00001 DS    3F                                                       09491000
@PC00023 DS    2F                                                       09492000
@SA00024 DS    15F                                                      09493000
@PC00024 DS    2F                                                       09494000
@AL00001 DS    6A                                                       09495000
@AFTEMPS DS    10F                                                      09496000
IDCAV01  CSECT                                                          09497000
         DS    0F                                                       09498000
@CF00117 DC    F'0'                                                     09499000
@CF00222 DC    F'1'                                                     09500000
@CH00222 EQU   @CF00222+2                                               09501000
@CF00043 DC    F'4'                                                     09502000
@CH00043 EQU   @CF00043+2                                               09503000
@CF00182 DC    F'8'                                                     09504000
@CH00182 EQU   @CF00182+2                                               09505000
@CF00606 DC    F'12'                                                    09506000
@CH00606 EQU   @CF00606+2                                               09507000
@CF01807 DC    XL4'00000208'                                            09508000
@CF01682 DC    XL4'26'                                                  09509000
@CF01684 DC    XL4'2A'                                                  09510000
@DATD    DSECT                                                          09511000
         DS    0D                                                       09512000
LISTSCAN DS    A                                                        09513000
IOCSPTR  DS    A                                                        09514000
OPNPTR   DS    A                                                        09515000
DDSTRU   DS    A                                                        09516000
FSADDR   DS    A                                                        09517000
ERCNVADR DS    A                                                        09518000
CCMSGPTR DS    A                                                        09519000
CTMSGPTR DS    A                                                        09520000
ELEMENT  DS    F                                                        09521000
COPYVPTR DS    A                                                        09522000
GROUPPTR DS    A                                                        09523000
RVVIPTR  DS    A                                                        09524000
MVRPTR   DS    A                                                        09525000
DEFVPTR  DS    A                                                        09526000
DEFVEPTR DS    A                                                        09527000
REASON   DS    F                                                        09528000
ECBMSPTR DS    A                                                        09529000
RETADDR1 DS    F                                                        09530000
RETADDR2 DS    F                                                        09531000
RETADDR3 DS    F                                                        09532000
DLSRET   DS    F                                                        09533000
CKSAVPTR DS    A                                                        09534000
SSDLPTR  DS    A                                                        09535000
LISTPTR  DS    A                                                        09536000
SETUPRC  DS    H                                                        09537000
UNIQVRC  DS    H                                                        09538000
NEWVFRC  DS    H                                                        09539000
SECCKRC  DS    H                                                        09540000
CLABLRC  DS    H                                                        09541000
DUPVRC   DS    H                                                        09542000
BKOUTRC  DS    H                                                        09543000
SETRC    DS    H                                                        09544000
LISTLN   DS    FL1                                                      09545000
         DS    0D                                                       09546000
@TS00001 DS    CL95                                                     09547000
         DS    CL1                                                      09548000
AV01DEFV DS    CL212                                                    09549000
         ORG   AV01DEFV                                                 09550000
AVDEFVID DS    CL8                                                      09551000
AVDEFV   DS    CL132                                                    09552000
AVDVEID  DS    CL8                                                      09553000
AVDEFVE  DS    CL64                                                     09554000
         ORG   AV01DEFV+212                                             09555000
MSGPARMS DS    CL36                                                     09556000
         ORG   MSGPARMS                                                 09557000
PRINTHDR DS    CL8                                                      09558000
PRINTTBL DS    CL28                                                     09559000
         ORG   MSGPARMS+36                                              09560000
AVDMPLST DS    CL33                                                     09561000
         DS    CL3                                                      09562000
AVMDAGL  DS    CL37                                                     09563000
         DS    CL3                                                      09564000
AVVS1AGL DS    CL74                                                     09565000
         DS    CL2                                                      09566000
AVEXCLST DS    CL23                                                     09567000
AMDTYPE  DS    CL8                                                      09568000
         DS    CL1                                                      09569000
AVALLAGL DS    CL39                                                     09570000
         ORG   AVALLAGL                                                 09571000
AVALLID  DS    CL8                                                      09572000
AVALLTBL DS    CL31                                                     09573000
         ORG   AVALLAGL+39                                              09574000
         DS    CL1                                                      09575000
AVUNLST  DS    CL12                                                     09576000
         ORG   AVUNLST                                                  09577000
AVUNCNT  DS    FL2                                                      09578000
AVUNLEN  DS    FL2                                                      09579000
AVUNVAL  DS    CL8                                                      09580000
         ORG   AVUNLST+12                                               09581000
AVVOLLST DS    CL10                                                     09582000
         ORG   AVVOLLST                                                 09583000
SERCNT   DS    FL2                                                      09584000
SERLEN   DS    FL2                                                      09585000
SERNO    DS    CL6                                                      09586000
         ORG   AVVOLLST+10                                              09587000
         DS    CL2                                                      09588000
VOLBUF   DS    CL232                                                    09589000
         ORG   VOLBUF                                                   09590000
VOLHDR   DS    CL8                                                      09591000
VOLREC   DS    CL224                                                    09592000
         ORG   VOLBUF+232                                               09593000
GRPBUF   DS    CL172                                                    09594000
         ORG   GRPBUF                                                   09595000
GRPHDR   DS    CL8                                                      09596000
GRPREC   DS    CL164                                                    09597000
         ORG   GRPBUF+172                                               09598000
TEMPBUFF DS    CL232                                                    09599000
         ORG   TEMPBUFF                                                 09600000
TEMPHDR  DS    CL8                                                      09601000
TEMPBUF  DS    CL224                                                    09602000
         ORG   TEMPBUFF+232                                             09603000
ECBCODE  DS    CL1                                                      09604000
MINORNM  DS    CL23                                                     09605000
         ORG   MINORNM                                                  09606000
RNMLEN   DS    FL1                                                      09607000
RNAME    DS    CL22                                                     09608000
         ORG   RNAME                                                    09609000
RNMSERNO DS    CL6                                                      09610000
RNMTRAIL DS    CL16                                                     09611000
         ORG   MINORNM+23                                               09612000
ADDVTBL  DS    CL59                                                     09613000
         ORG   ADDVTBL                                                  09614000
ADDVHDR  DS    CL8                                                      09615000
RECTYPE  DS    CL4                                                      09616000
RENAMTYP DS    CL8                                                      09617000
AUNITDDN DS    CL8                                                      09618000
AUNITUCB DS    AL4                                                      09619000
CSNWKA   DS    CL12                                                     09620000
VPREPVOL DS    CL6                                                      09621000
MSVIVOL# DS    CL6                                                      09622000
@NM00132 DS    BL2                                                      09623000
         ORG   @NM00132                                                 09624000
CC04FLG  DS    BL1                                                      09625000
MOUNTFLG EQU   @NM00132+0                                               09626000
WAITFLG  EQU   @NM00132+0                                               09627000
MSGFLG   EQU   @NM00132+0                                               09628000
NEWVFFLG EQU   @NM00132+0                                               09629000
ALLOCFLG EQU   @NM00132+0                                               09630000
GRPMSFLG EQU   @NM00132+0                                               09631000
BRECOVSW EQU   @NM00132+0                                               09632000
ONLYROSW DS    BL1                                                      09633000
@NM00133 EQU   @NM00132+1                                               09634000
         ORG   ADDVTBL+58                                               09635000
ATTRFLGS DS    BL1                                                      09636000
         ORG   ATTRFLGS                                                 09637000
OLDBIFLG DS    BL1                                                      09638000
OLDDEFLG EQU   ATTRFLGS+0                                               09639000
OLDEXFLG EQU   ATTRFLGS+0                                               09640000
OLDROFLG EQU   ATTRFLGS+0                                               09641000
NEWBIFLG EQU   ATTRFLGS+0                                               09642000
NEWDEFLG EQU   ATTRFLGS+0                                               09643000
NEWEXFLG EQU   ATTRFLGS+0                                               09644000
NEWROFLG EQU   ATTRFLGS+0                                               09645000
         ORG   ADDVTBL+59                                               09646000
CDATEWKA DS    CL4                                                      09647000
         DS    CL1                                                      09648000
AV01RVVI DS    CL76                                                     09649000
         ORG   AV01RVVI                                                 09650000
AVRVVIID DS    CL8                                                      09651000
AVRVVI   DS    CL68                                                     09652000
         ORG   AV01RVVI+76                                              09653000
AVCKAGL  DS    CL29                                                     09654000
AVS1TEST DS    CL8                                                      09655000
         DS    CL3                                                      09656000
AVVS2AGL DS    CL52                                                     09657000
AV01MVR  DS    CL96                                                     09658000
         ORG   AV01MVR                                                  09659000
AVMVRHDR DS    CL8                                                      09660000
AVMVRTBL DS    CL88                                                     09661000
         ORG   AV01MVR+96                                               09662000
CKCSNADJ DS    CL12                                                     09663000
CKPRTTAB DS    CL20                                                     09664000
SSDRGLT  DS    CL20                                                     09665000
SSINXLST DS    CL120                                                    09666000
         ORG   SSINXLST                                                 09667000
SSARRAY  DS    60H                                                      09668000
         ORG   SSINXLST+120                                             09669000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09670000
@ENDDATD EQU   *                                                        09671000
IDCAV01  CSECT                                                          09672000
         DS    0F                                                       09673000
@SIZDATD DC    AL1(0)                                                   09674000
         DC    AL3(@ENDDATD-@DATD)                                      09675000
         DS    0D                                                       09676000
RVVLEN   DC    AL2(68)                                                  09677000
MVRLEN   DC    AL2(88)                                                  09678000
DEFLEN   DC    AL2(64)                                                  09679000
SSMSGNUM DC    AL1(56)                                                  09680000
@CC01635 DC    C'SYSZAMS '                                              09681000
@CC01666 DC    C'ACTIVE  '                                              09682000
@CC01668 DC    C'INACTIVE'                                              09683000
@CC01670 DC    C'SYSGROUP'                                              09684000
@CC01672 DC    C'DUMMY   '                                              09685000
@CC01674 DC    C'BACKOUT '                                              09686000
@CC01767 DC    C'DARGLIST'                                              09687000
@CC01770 DC    C'GROUPREC'                                              09688000
@CC01816 DC    C'AV01RVVI'                                              09689000
@CC01826 DC    C'AV01DEFV'                                              09690000
@CC01905 DC    C'IDCVS01 '                                              09691000
@CC01907 DC    C'AVVS1AGL'                                              09692000
@CC01927 DC    C'IDCVS02 '                                              09693000
@CC01931 DC    C'AVVS2AGL'                                              09694000
@CC01766 DC    C'ADDVTBL'                                               09695000
@CC01771 DC    C'DEFLIST'                                               09696000
@CC01848 DC    C'AVCKAGL'                                               09697000
@CC01897 DC    C'AVMDAGL'                                               09698000
@CC01942 DC    C'AV01MVR'                                               09699000
@CC01768 DC    C'VOLREC'                                                09700000
@CC01769 DC    C'REPVOL'                                                09701000
@CC01773 DC    C'ALLAGL'                                                09702000
@CC01616 DC    C'3330V'                                                 09703000
@CC01772 DC    C'DEFVE'                                                 09704000
@CC01587 EQU   @CC01816                                                 09705000
@CC01656 DC    C'DUP '                                                  09706000
@CC01658 DC    C'GRP '                                                  09707000
@CC01660 DC    C'BASE'                                                  09708000
@CC01662 DC    C'UNKN'                                                  09709000
@CC01664 DC    C'COPY'                                                  09710000
@CC01764 DC    C'AVBG'                                                  09711000
@CC01785 DC    C'AVND'                                                  09712000
@CC01790 DC    C'AVUP'                                                  09713000
@CC01798 DC    C'AVVT'                                                  09714000
@CC01813 DC    C'AVRV'                                                  09715000
@CC01814 DC    C'RVVI'                                                  09716000
@CC01818 DC    C'AVRD'                                                  09717000
@CC01824 DC    C'AVVO'                                                  09718000
@CC01827 DC    C'AVRN'                                                  09719000
@CC01832 DC    C'AVRW'                                                  09720000
@CC01838 DC    C'AVNM'                                                  09721000
@CC01839 DC    C'AVBN'                                                  09722000
@CC01845 DC    C'AVAL'                                                  09723000
@CC01849 EQU   @CC01848                                                 09724000
@CC01854 DC    C'AVUQ'                                                  09725000
@CC01863 DC    C'AVAD'                                                  09726000
@CC01872 DC    C'AVDL'                                                  09727000
@CC01877 DC    C'AVAC'                                                  09728000
@CC01878 DC    C'AVDF'                                                  09729000
@CC01883 DC    C'AVVF'                                                  09730000
@CC01884 DC    C'AVAT'                                                  09731000
@CC01889 DC    C'AVSE'                                                  09732000
@CC01896 DC    C'AVVP'                                                  09733000
@CC01898 EQU   @CC01897                                                 09734000
@CC01906 DC    C'AVVC'                                                  09735000
@CC01908 DC    C'AVS1'                                                  09736000
@CC01913 DC    C'AVCL'                                                  09737000
@CC01918 DC    C'AVVL'                                                  09738000
@CC01928 DC    C'AVS2'                                                  09739000
@CC01932 DC    C'AVNS'                                                  09740000
@CC01940 DC    C'AVMV'                                                  09741000
@CC01943 DC    C'AVSM'                                                  09742000
@CC01948 DC    C'AVDU'                                                  09743000
@CC01954 DC    C'AVBK'                                                  09744000
@CC01972 DC    C'CKLN'                                                  09745000
@CC01994 DC    C'SSAA'                                                  09746000
@CC01687 EQU   @CC01816                                                 09747000
@CC01697 DC    C'CM0'                                                   09748000
@CC01732 DC    C'UV0'                                                   09749000
@CC01941 DC    C'MVR'                                                   09750000
@CB01651 DC    X'0000000000000000'                                      09751000
@CB01647 EQU   @CB01651                                                 09752000
@CB01654 EQU   @CB01651                                                 09753000
ALL      DC    CL3'ALL'                                                 09754000
FORMAT   DC    CL4'FORM'                                                09755000
HSECOND  DC    CL4'HSEC'                                                09756000
CLOCK    DC    CL4'KLOK'                                                09757000
SETZERO  DC    CL4'ZERO'                                                09758000
SETBLANK DC    CL4'BLNK'                                                09759000
NOSET    DC    CL4'NSET'                                                09760000
OVERRIDE DC    CL4'OVRD'                                                09761000
ACQUIRE  DC    CL8'ACQUIRE '                                            09762000
RELINQ   DC    CL8'RELINQ  '                                            09763000
MOUNT    DC    CL8'MOUNT   '                                            09764000
DEMOUNT  DC    CL8'DEMOUNT '                                            09765000
DEFINE   DC    CL8'DEFINE  '                                            09766000
MOVE     DC    CL8'MOVE    '                                            09767000
TRACEQ   DC    CL8'TRACEQ  '                                            09768000
COPYTABL DC    CL8'COPYTABL'                                            09769000
COPYCRTG DC    CL8'COPYCRTG'                                            09770000
COPYVOL  DC    CL8'COPYVOL '                                            09771000
VVIC     DC    CL8'VVIC    '                                            09772000
TUNE     DC    CL8'TUNE    '                                            09773000
NAMES    DC    CL4'NAME'                                                09774000
UNIT     DC    CL4'UNIT'                                                09775000
SHR      DC    CL4'SHR '                                                09776000
EXCL     DC    CL4'EXCL'                                                09777000
NOWAIT   DC    CL4'NWAI'                                                09778000
WAIT     DC    CL4'WAIT'                                                09779000
SECCHECK DC    CL8'SECCHECK'                                            09780000
SCRVTOC  DC    CL8'SCRVTOC '                                            09781000
GETVTOC  DC    CL8'GETVTOC '                                            09782000
PUTVTOC  DC    CL8'PUTVTOC '                                            09783000
RECATLG  DC    CL8'RECATLG '                                            09784000
INITVOL  DC    CL8'INITVOL '                                            09785000
CHECK    DC    CL8'CHECK   '                                            09786000
POSTUCB  DC    CL8'POSTUCB '                                            09787000
GET      DC    CL8'GET     '                                            09788000
PUT      DC    CL8'PUT     '                                            09789000
CLOSE    DC    CL8'CLOSE   '                                            09790000
OPEN     DC    CL8'OPEN    '                                            09791000
RVOPENR  DC    CL8'OPENR   '                                            09792000
RVRDCNT  DC    CL8'READCNT '                                            09793000
RVREADKD DC    CL8'READKD  '                                            09794000
RVSPACCR DC    CL8'SPACCR  '                                            09795000
RVFWRITE DC    CL8'FWRITE  '                                            09796000
RVWRITER DC    CL8'WRITEREC'                                            09797000
PUTLABEL DC    CL8'PUTLABEL'                                            09798000
GETLABEL DC    CL8'GETLABEL'                                            09799000
CANCEL   DC    CL8'CANCEL  '                                            09800000
SET      DC    CL8'SET     '                                            09801000
SELECTX  DC    CL8'SELECTX '                                            09802000
CHANGEX  DC    CL8'CHANGEX '                                            09803000
SELECTDD DC    CL8'SELECTDD'                                            09804000
SELECTDS DC    CL8'SELECTDS'                                            09805000
TBLREST  DC    CL8'TBLREST '                                            09806000
NULLIFYC DC    CL8'NULLIFYC'                                            09807000
RDMSC    DC    CL8'RDMSC   '                                            09808000
RDMSCTBL DC    CL8'RDMSCTBL'                                            09809000
RDCARTLB DC    CL8'RDCARTLB'                                            09810000
AUDITCEL DC    CL8'AUDITCEL'                                            09811000
RDSTGAD  DC    CL8'RDSTGAD '                                            09812000
MODIFYC  DC    CL8'MODIFYC '                                            09813000
MODID    DC    CL4'AV01'                                                09814000
FIXAREA  DS    CL569                                                    09815000
         ORG   FIXAREA                                                  09816000
@NM00129 DC    256X'00'                                                 09817000
@NM00130 DC    256X'00'                                                 09818000
@NM00131 DC    57X'00'                                                  09819000
         ORG   FIXAREA+569                                              09820000
RESERVE  DC    CL16'.VIRTUAL.RESERVE'                                   09821000
ENQUEUE  DC    CL16'.VIRTUAL.ENQUEUE'                                   09822000
SSMODSS0 DC    CL3'SS0'                                                 09823000
SSMODCM0 DC    CL3'CM0'                                                 09824000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       09825000
@01      EQU   01                                                       09826000
@02      EQU   02                                                       09827000
@03      EQU   03                                                       09828000
@04      EQU   04                                                       09829000
@05      EQU   05                                                       09830000
@06      EQU   06                                                       09831000
@07      EQU   07                                                       09832000
@08      EQU   08                                                       09833000
@09      EQU   09                                                       09834000
@10      EQU   10                                                       09835000
@11      EQU   11                                                       09836000
@12      EQU   12                                                       09837000
@13      EQU   13                                                       09838000
@14      EQU   14                                                       09839000
@15      EQU   15                                                       09840000
ENTRYNUM EQU   @02                                                      09841000
CKCOND   EQU   @03                                                      09842000
CKRETPTR EQU   @04                                                      09843000
MVRRTNRC EQU   @04                                                      09844000
VS2RTNRC EQU   @04                                                      09845000
VLABLRC  EQU   @05                                                      09846000
VTOCKRC  EQU   @04                                                      09847000
VPREPRC  EQU   @04                                                      09848000
ACTVRC   EQU   @05                                                      09849000
DLSRC    EQU   @05                                                      09850000
ADDRC    EQU   @04                                                      09851000
ALLOCRC  EQU   @04                                                      09852000
RENAMRC  EQU   @05                                                      09853000
RWCKRC   EQU   @04                                                      09854000
VOLCKRC  EQU   @04                                                      09855000
RVRTNRC  EQU   @04                                                      09856000
VTYPERC  EQU   @05                                                      09857000
TEMPPTR  EQU   @02                                                      09858000
BCDVPTR  EQU   @06                                                      09859000
DUPVPTR  EQU   @02                                                      09860000
BASEVPTR EQU   @07                                                      09861000
CMMSGPTR EQU   @02                                                      09862000
DMPINDEX EQU   @02                                                      09863000
TESTRC   EQU   @03                                                      09864000
REG8     EQU   @08                                                      09865000
REG9     EQU   @09                                                      09866000
REG10    EQU   @10                                                      09867000
REG12    EQU   @12                                                      09868000
RTNREG   EQU   @15                                                      09869000
REG14    EQU   @14                                                      09870000
DEFVR1   EQU   @01                                                      09871000
REG0     EQU   @00                                                      09872000
REG1     EQU   @01                                                      09873000
REG11    EQU   @11                                                      09874000
REG13    EQU   @13                                                      09875000
REG15    EQU   @15                                                      09876000
REG2     EQU   @02                                                      09877000
REG3     EQU   @03                                                      09878000
REG4     EQU   @04                                                      09879000
REG5     EQU   @05                                                      09880000
REG6     EQU   @06                                                      09881000
REG7     EQU   @07                                                      09882000
IDCSACL0 EQU   0                                                        09883000
IDCSAEP0 EQU   0                                                        09884000
IDCSAFS0 EQU   0                                                        09885000
IDCSAAL0 EQU   0                                                        09886000
IDCSADL0 EQU   0                                                        09887000
IDCSASS0 EQU   0                                                        09888000
IDCSANQ0 EQU   0                                                        09889000
IDCSADQ0 EQU   0                                                        09890000
IDCSA060 EQU   0                                                        09891000
TRACE1   EQU   0                                                        09892000
OLDERID1 EQU   TRACE1                                                   09893000
TRACE2   EQU   0                                                        09894000
OLDERID2 EQU   TRACE2                                                   09895000
NEWID2   EQU   TRACE2+95                                                09896000
NEWERID2 EQU   5                                                        09897000
CIRAGL   EQU   0                                                        09898000
CIRTYPE  EQU   CIRAGL                                                   09899000
ALLAGL   EQU   0                                                        09900000
ALLDDN   EQU   ALLAGL+4                                                 09901000
ALLULP   EQU   ALLAGL+12                                                09902000
ALLVLP   EQU   ALLAGL+16                                                09903000
ALLSTS   EQU   ALLAGL+24                                                09904000
ALLDSP   EQU   ALLAGL+25                                                09905000
ALLORG   EQU   ALLAGL+26                                                09906000
ALLOPT   EQU   ALLAGL+28                                                09907000
ALLOPTVL EQU   ALLOPT                                                   09908000
ALLOPTPV EQU   ALLOPT                                                   09909000
ALLVLCNT EQU   ALLAGL+29                                                09910000
ALLUNCNT EQU   ALLAGL+30                                                09911000
RACFAGL  EQU   0                                                        09912000
RACFFLG1 EQU   RACFAGL                                                  09913000
RACFFLG2 EQU   RACFAGL+1                                                09914000
RACFFLG3 EQU   RACFAGL+2                                                09915000
RACFFLG4 EQU   RACFAGL+3                                                09916000
UNITABL  EQU   0                                                        09917000
UNITADR  EQU   UNITABL+4                                                09918000
@NM00017 EQU   UNITADR                                                  09919000
UNITSTAT EQU   UNITABL+6                                                09920000
IDCIOCL0 EQU   0                                                        09921000
IOCSTR   EQU   0                                                        09922000
IOCDSO   EQU   IOCSTR+16                                                09923000
IOCRFM   EQU   IOCSTR+17                                                09924000
IOCMAC   EQU   IOCSTR+18                                                09925000
IOCMAC2  EQU   IOCSTR+19                                                09926000
IOCCHP   EQU   IOCSTR+20                                                09927000
IOCMSG   EQU   IOCSTR+21                                                09928000
IOCRBA   EQU   IOCSTR+40                                                09929000
IOCTTR   EQU   IOCRBA                                                   09930000
IOCMEM   EQU   IOCSTR+44                                                09931000
IOCNWM   EQU   IOCSTR+48                                                09932000
IOCREL   EQU   IOCSTR+60                                                09933000
OPNAGL   EQU   0                                                        09934000
OPNOPT   EQU   OPNAGL                                                   09935000
OPNRFM   EQU   OPNAGL+1                                                 09936000
OPNTYP   EQU   OPNAGL+2                                                 09937000
OPNMOD   EQU   OPNAGL+3                                                 09938000
OPNDEV   EQU   OPNAGL+24                                                09939000
OPNDSO   EQU   OPNAGL+41                                                09940000
OPNOPT2  EQU   OPNAGL+42                                                09941000
IOINFOPT EQU   0                                                        09942000
UVOLLIST EQU   0                                                        09943000
UVOLENT  EQU   UVOLLIST+2                                               09944000
AMSTP011 EQU   0                                                        09945000
DARGLIST EQU   0                                                        09946000
DARGDBP  EQU   DARGLIST                                                 09947000
DARGRETP EQU   DARGLIST+4                                               09948000
DARGSTID EQU   DARGLIST+8                                               09949000
DARGSMOD EQU   DARGSTID                                                 09950000
DARGSENT EQU   DARGSTID+3                                               09951000
DARGILP  EQU   DARGLIST+12                                              09952000
DARGCNT  EQU   DARGLIST+14                                              09953000
DARGRETL EQU   DARGLIST+16                                              09954000
DARGARY  EQU   DARGLIST+20                                              09955000
DARGINS  EQU   DARGARY                                                  09956000
DARGINL  EQU   DARGARY+2                                                09957000
DARGDTM  EQU   DARGARY+4                                                09958000
FMTLIST  EQU   0                                                        09959000
FMTFLGS  EQU   FMTLIST                                                  09960000
FMTSPF   EQU   FMTLIST+2                                                09961000
FMTRFNO  EQU   FMTSPF                                                   09962000
FMTILEN  EQU   FMTRFNO                                                  09963000
FMTIOFF  EQU   FMTLIST+4                                                09964000
FMTTRBC  EQU   FMTIOFF                                                  09965000
FMTSTO   EQU   FMTTRBC                                                  09966000
FMTOCOL  EQU   FMTLIST+6                                                09967000
FMTCNVF  EQU   FMTLIST+10                                               09968000
ERCNVTAB EQU   0                                                        09969000
ERTYPE   EQU   ERCNVTAB                                                 09970000
EROPER   EQU   ERCNVTAB+1                                               09971000
EROSOPER EQU   ERCNVTAB+2                                               09972000
ERCATRC  EQU   ERCNVTAB+16                                              09973000
ERCPLPT  EQU   ERCNVTAB+20                                              09974000
IDCDB010 EQU   0                                                        09975000
DMPITM   EQU   0                                                        09976000
DMPITMNM EQU   DMPITM                                                   09977000
DMPITMPT EQU   DMPITM+8                                                 09978000
DMPITMLN EQU   DMPITM+12                                                09979000
DMPITMTP EQU   DMPITM+14                                                09980000
DMPARY   EQU   0                                                        09981000
DMPTRM   EQU   0                                                        09982000
CCMSG    EQU   0                                                        09983000
CMMSG    EQU   0                                                        09984000
CMVOLFLG EQU   CMMSG+6                                                  09985000
CMDERAS  EQU   CMVOLFLG                                                 09986000
CMEXCL   EQU   CMVOLFLG                                                 09987000
CMBIND   EQU   CMVOLFLG                                                 09988000
CMRONLY  EQU   CMVOLFLG                                                 09989000
CMNEWVOL EQU   CMMSG+8                                                  09990000
CTMSG    EQU   0                                                        09991000
CTARRAY  EQU   CTMSG+4                                                  09992000
MDAGL    EQU   0                                                        09993000
MDUCBPTR EQU   MDAGL+8                                                  09994000
MDDDNAME EQU   MDAGL+12                                                 09995000
MDLABEL  EQU   MDAGL+24                                                 09996000
MDFLAGS  EQU   MDAGL+30                                                 09997000
MDWAIT   EQU   MDFLAGS                                                  09998000
MDVTOC   EQU   MDAGL+32                                                 09999000
PUAGL    EQU   0                                                        10000000
CKAGL    EQU   0                                                        10001000
CKUCBPTR EQU   CKAGL+8                                                  10002000
CKDDNAME EQU   CKAGL+12                                                 10003000
CKFLAGS  EQU   CKAGL+28                                                 10004000
CKTESTVT EQU   CKFLAGS                                                  10005000
EXCLAGL  EQU   0                                                        10006000
EXCLUCBP EQU   EXCLAGL+8                                                10007000
EXCLDDP  EQU   EXCLAGL+12                                               10008000
EXCLVOL  EQU   EXCLAGL+16                                               10009000
EXCLFLAG EQU   EXCLAGL+22                                               10010000
EXOARG   EQU   0                                                        10011000
EXOPT    EQU   EXOARG+32                                                10012000
EXFLG    EQU   EXOARG+33                                                10013000
EXGARG   EQU   0                                                        10014000
EXWRARG  EQU   0                                                        10015000
EXRWCHR  EQU   EXWRARG+26                                               10016000
EXSPACE  EQU   EXWRARG+36                                               10017000
EXPARG   EQU   0                                                        10018000
EXPDATA  EQU   EXPARG+12                                                10019000
EXPDATAB EQU   0                                                        10020000
EXPARRAY EQU   EXPDATAB+4                                               10021000
VS2AGL   EQU   0                                                        10022000
VSUCBPTR EQU   VS2AGL+8                                                 10023000
VSVOLPTR EQU   VS2AGL+20                                                10024000
VSLABOPT EQU   VS2AGL+28                                                10025000
VSVOLSER EQU   VSLABOPT                                                 10026000
VSVOLUME EQU   VS2AGL+29                                                10027000
VS2MSG   EQU   VS2AGL+35                                                10028000
VS2RESOP EQU   VS2AGL+36                                                10029000
VS2RES   EQU   VS2RESOP                                                 10030000
VSDDNAME EQU   VS2AGL+37                                                10031000
VS1AGL   EQU   0                                                        10032000
VSUCBP   EQU   VS1AGL+8                                                 10033000
VSVOLP   EQU   VS1AGL+12                                                10034000
VSFILEP  EQU   VS1AGL+16                                                10035000
VSIOP    EQU   VS1AGL+20                                                10036000
VSPFILEP EQU   VS1AGL+48                                                10037000
VSSECOPT EQU   VS1AGL+68                                                10038000
VSNOVSAM EQU   VSSECOPT                                                 10039000
VSWRITE  EQU   VSSECOPT                                                 10040000
VSVTOPT  EQU   VS1AGL+69                                                10041000
VSVSFLAG EQU   VSVTOPT                                                  10042000
VSCATOPT EQU   VS1AGL+70                                                10043000
VSRETURN EQU   VS1AGL+71                                                10044000
VSVSAM   EQU   VSRETURN                                                 10045000
VSMSG    EQU   VS1AGL+72                                                10046000
VSRESOPT EQU   VS1AGL+73                                                10047000
VSRES    EQU   VSRESOPT                                                 10048000
RCTAGL   EQU   0                                                        10049000
RCTOPT   EQU   RCTAGL+8                                                 10050000
STAEPARM EQU   0                                                        10051000
STARCVY  EQU   STAEPARM+52                                              10052000
STARETRY EQU   STAEPARM+53                                              10053000
VOLLABEL EQU   0                                                        10054000
SV82LIST EQU   0                                                        10055000
@NM00073 EQU   SV82LIST+4                                               10056000
SV82DCBP EQU   @NM00073                                                 10057000
@NM00074 EQU   SV82LIST+12                                              10058000
SV82WRKP EQU   @NM00074                                                 10059000
SRTAGL   EQU   0                                                        10060000
LCTINFO  EQU   0                                                        10061000
LCTFLAGS EQU   LCTINFO+32                                               10062000
UCTAGL   EQU   0                                                        10063000
UCTFLAGS EQU   UCTAGL+68                                                10064000
SELAGL   EQU   0                                                        10065000
SELFLAGS EQU   SELAGL+22                                                10066000
DATESAGL EQU   0                                                        10067000
DATESOPT EQU   DATESAGL+20                                              10068000
VS3AGL   EQU   0                                                        10069000
VS3FLAGS EQU   VS3AGL+58                                                10070000
VSDVTOC  EQU   0                                                        10071000
VSDSTAT  EQU   0                                                        10072000
VSDSFLG1 EQU   VSDSTAT+16                                               10073000
VSDFLG2  EQU   VSDSTAT+17                                               10074000
VSDSCR   EQU   0                                                        10075000
VSDSCRFL EQU   VSDSCR+4                                                 10076000
VSDUSAGE EQU   0                                                        10077000
VSDDORG  EQU   VSDUSAGE+9                                               10078000
VSDALLOC EQU   VSDUSAGE+10                                              10079000
VSDUSEF  EQU   VSDUSAGE+11                                              10080000
VSDDSORG EQU   VSDUSAGE+16                                              10081000
VSDBLOCK EQU   0                                                        10082000
VSDSPACE EQU   VSDBLOCK+12                                              10083000
VSDARRAY EQU   VSDBLOCK+16                                              10084000
VSDVARY  EQU   VSDARRAY+48                                              10085000
VOL      EQU   0                                                        10086000
VOLLEN   EQU   VOL                                                      10087000
VOLVAL   EQU   VOL+1                                                    10088000
CDATE    EQU   0                                                        10089000
DATE     EQU   0                                                        10090000
DATEVAL  EQU   DATE                                                     10091000
SEQ#     EQU   0                                                        10092000
SEQ#VAL  EQU   SEQ#                                                     10093000
CART     EQU   0                                                        10094000
CARTLEN  EQU   CART                                                     10095000
CARTVAL  EQU   CART+1                                                   10096000
NSER     EQU   0                                                        10097000
NSERVAL  EQU   NSER+1                                                   10098000
RWOPT    EQU   0                                                        10099000
FILE     EQU   0                                                        10100000
FILEVAL  EQU   FILE+1                                                   10101000
PFILE    EQU   0                                                        10102000
@NM00093 EQU   PFILE+2                                                  10103000
RVOL     EQU   0                                                        10104000
BASEV    EQU   0                                                        10105000
BASNAME  EQU   BASEV                                                    10106000
BASSERNO EQU   BASNAME+5                                                10107000
BASID    EQU   BASNAME+11                                               10108000
BASFLAGA EQU   BASEV+14                                                 10109000
BASTYPE  EQU   BASFLAGA                                                 10110000
BASDLSF  EQU   BASFLAGA+2                                               10111000
BASGENUS EQU   BASFLAGA+2                                               10112000
BASINAC  EQU   BASFLAGA+2                                               10113000
BASREASS EQU   BASFLAGA+3                                               10114000
BASRCVYF EQU   BASEV+20                                                 10115000
BASSATIA EQU   BASRCVYF                                                 10116000
BASMISCF EQU   BASRCVYF+2                                               10117000
BASCSN1  EQU   BASEV+24                                                 10118000
BASLIB1  EQU   BASEV+36                                                 10119000
BASLID1  EQU   BASLIB1                                                  10120000
BASLIB2  EQU   BASEV+49                                                 10121000
BASLID2  EQU   BASLIB2                                                  10122000
BASKLCPY EQU   BASEV+76                                                 10123000
BASCOPID EQU   BASKLCPY+11                                              10124000
BASRECOV EQU   BASEV+174                                                10125000
BASGROUP EQU   BASEV+180                                                10126000
COPYV    EQU   0                                                        10127000
COPNAME  EQU   COPYV                                                    10128000
COPID    EQU   COPNAME+11                                               10129000
COPFLAGA EQU   COPYV+14                                                 10130000
COPTYPE  EQU   COPFLAGA                                                 10131000
COPVSAM  EQU   COPFLAGA+2                                               10132000
COPGENUS EQU   COPFLAGA+2                                               10133000
COPRCVYF EQU   COPYV+20                                                 10134000
COPSATIA EQU   COPRCVYF                                                 10135000
COPMISCF EQU   COPRCVYF+2                                               10136000
COPLIB1  EQU   COPYV+36                                                 10137000
COPLID1  EQU   COPLIB1                                                  10138000
COPLIB2  EQU   COPYV+49                                                 10139000
COPLID2  EQU   COPLIB2                                                  10140000
DUPV     EQU   0                                                        10141000
DUPNAME  EQU   DUPV                                                     10142000
DUPID    EQU   DUPNAME+11                                               10143000
DUPFLAGA EQU   DUPV+14                                                  10144000
DUPTYPE  EQU   DUPFLAGA                                                 10145000
DUPRCVYF EQU   DUPV+20                                                  10146000
DUPLIB1  EQU   DUPV+36                                                  10147000
DUPLID1  EQU   DUPLIB1                                                  10148000
DUPLIB2  EQU   DUPV+49                                                  10149000
DUPLID2  EQU   DUPLIB2                                                  10150000
BCDV     EQU   0                                                        10151000
BCDNAME  EQU   BCDV                                                     10152000
BCDPREFX EQU   BCDNAME                                                  10153000
BCDID    EQU   BCDNAME+11                                               10154000
BCDFLAGA EQU   BCDV+14                                                  10155000
BCDTYPE  EQU   BCDFLAGA                                                 10156000
BCDBASE  EQU   BCDTYPE                                                  10157000
BCDCOPY  EQU   BCDTYPE                                                  10158000
BCDDUP   EQU   BCDTYPE                                                  10159000
BCDFLAGB EQU   BCDFLAGA+2                                               10160000
BCDRCVYF EQU   BCDV+20                                                  10161000
BCDSATIA EQU   BCDRCVYF                                                 10162000
BCDIVCRE EQU   BCDSATIA                                                 10163000
BCDIVCPY EQU   BCDSATIA                                                 10164000
BCDVSMIS EQU   BCDSATIA                                                 10165000
BCDMISCF EQU   BCDRCVYF+2                                               10166000
BCDCSN1  EQU   BCDV+24                                                  10167000
BCDLIB1  EQU   BCDV+36                                                  10168000
BCDLID1  EQU   BCDLIB1                                                  10169000
BCDLIB2  EQU   BCDV+49                                                  10170000
BCDLID2  EQU   BCDLIB2                                                  10171000
GROUP    EQU   0                                                        10172000
GRONAME  EQU   GROUP                                                    10173000
GROID    EQU   GRONAME+11                                               10174000
GROFLAGA EQU   GROUP+13                                                 10175000
GROTYPE  EQU   GROFLAGA                                                 10176000
GROBIND  EQU   GROFLAGA+2                                               10177000
GROEXCL  EQU   GROFLAGA+2                                               10178000
GRODAERA EQU   GROFLAGA+2                                               10179000
GRORONLY EQU   GROFLAGA+2                                               10180000
GROERRTS EQU   GROUP+56                                                 10181000
RVVI     EQU   0                                                        10182000
RVVLNGTH EQU   RVVI                                                     10183000
RVVOPCOD EQU   RVVI+4                                                   10184000
RVVCODE  EQU   RVVOPCOD                                                 10185000
RVVOLUME EQU   RVVI+8                                                   10186000
RVVGROUP EQU   RVVI+14                                                  10187000
RVVBUFLN EQU   RVVI+30                                                  10188000
RVVRTBUF EQU   RVVI+32                                                  10189000
RVVCDATE EQU   RVVI+38                                                  10190000
RVVRDSEQ EQU   RVVI+43                                                  10191000
RVVRDCSN EQU   RVVI+44                                                  10192000
RVVFLAGA EQU   RVVI+58                                                  10193000
RVVRMODE EQU   RVVFLAGA                                                 10194000
RVVRDR   EQU   RVVRMODE                                                 10195000
RVVCHAIN EQU   RVVFLAGA+1                                               10196000
RVVRDRCD EQU   RVVFLAGA+2                                               10197000
RVVBVRCD EQU   RVVRDRCD                                                 10198000
RVVGRPRC EQU   RVVRDRCD                                                 10199000
RVVCPYRC EQU   RVVRDRCD                                                 10200000
RVVDUPRC EQU   RVVRDRCD                                                 10201000
RVVRUNKN EQU   RVVRDRCD                                                 10202000
RVVRTEST EQU   RVVFLAGA+3                                               10203000
RVVCPYTP EQU   RVVFLAGA+4                                               10204000
RVVSPEC  EQU   RVVFLAGA+5                                               10205000
RVVSGRP  EQU   RVVSPEC                                                  10206000
RVVSDTE  EQU   RVVSPEC                                                  10207000
RVVSSEQ  EQU   RVVSPEC                                                  10208000
RVVSCSN  EQU   RVVSPEC                                                  10209000
RVVSVOL  EQU   RVVSPEC                                                  10210000
MVR      EQU   0                                                        10211000
MVRLNGTH EQU   MVR                                                      10212000
MVRCODE  EQU   MVR+4                                                    10213000
MVRFLAGA EQU   MVR+8                                                    10214000
MVRFLBAS EQU   MVRFLAGA                                                 10215000
MVRFLLAB EQU   MVRFLAGA                                                 10216000
MVRCLMIS EQU   MVRFLAGA+1                                               10217000
MVRBVOL  EQU   MVR+12                                                   10218000
MVRLABEL EQU   MVR+76                                                   10219000
DEFLIST  EQU   0                                                        10220000
DEFVFLG  EQU   DEFLIST+6                                                10221000
DEFVRNM  EQU   DEFVFLG                                                  10222000
DEFVRNTR EQU   DEFVFLG                                                  10223000
DEFVACT  EQU   DEFVFLG                                                  10224000
DEFVDACT EQU   DEFVFLG                                                  10225000
DEFVLIB  EQU   DEFLIST+7                                                10226000
DEFVOLD  EQU   DEFLIST+8                                                10227000
DEFVVFLG EQU   DEFLIST+14                                               10228000
DEFVSEC  EQU   DEFVVFLG                                                 10229000
DEFVEXCL EQU   DEFVVFLG                                                 10230000
DEFVBIND EQU   DEFVVFLG                                                 10231000
DEFVWINH EQU   DEFVVFLG                                                 10232000
DEFVNVOL EQU   DEFLIST+16                                               10233000
DEFVCSN1 EQU   DEFLIST+24                                               10234000
DEFVDATA EQU   DEFLIST+56                                               10235000
DEFVVEXT EQU   DEFLIST+128                                              10236000
DEFVE    EQU   0                                                        10237000
DEFLNGTH EQU   DEFVE                                                    10238000
DEFLABEL EQU   DEFVE+49                                                 10239000
DEFFLAGA EQU   DEFVE+55                                                 10240000
DEFPVLAB EQU   DEFFLAGA                                                 10241000
DEFFLAGB EQU   DEFVE+56                                                 10242000
DEFSETFL EQU   DEFFLAGB                                                 10243000
DEFSRCVY EQU   DEFSETFL                                                 10244000
DEFCRCVY EQU   DEFSETFL                                                 10245000
DEFRECFL EQU   DEFFLAGB+1                                               10246000
DEFLAMIS EQU   DEFRECFL                                                 10247000
DEFTYPFL EQU   DEFFLAGB+2                                               10248000
DEFDUP   EQU   DEFTYPFL                                                 10249000
DEFNULFL EQU   DEFFLAGB+3                                               10250000
AMSTP041 EQU   0                                                        10251000
AMSTP042 EQU   0                                                        10252000
AMSTP043 EQU   0                                                        10253000
AMSTP044 EQU   0                                                        10254000
IDCIOCO0 EQU   0                                                        10255000
IDCIOGT0 EQU   0                                                        10256000
IDCIOIT0 EQU   0                                                        10257000
IDCIOOP0 EQU   0                                                        10258000
IDCIOPO0 EQU   0                                                        10259000
IDCIOPT0 EQU   0                                                        10260000
IDCIOSI0 EQU   0                                                        10261000
IDCIOST0 EQU   0                                                        10262000
IDCIOTM0 EQU   0                                                        10263000
IDCIOVY0 EQU   0                                                        10264000
IDCIO050 EQU   0                                                        10265000
IDCSACA0 EQU   0                                                        10266000
IDCSACR0 EQU   0                                                        10267000
IDCSADE0 EQU   0                                                        10268000
IDCSAFP0 EQU   0                                                        10269000
IDCSAGP0 EQU   0                                                        10270000
IDCSAGS0 EQU   0                                                        10271000
IDCSAID0 EQU   0                                                        10272000
IDCSALC0 EQU   0                                                        10273000
IDCSALD0 EQU   0                                                        10274000
IDCSALK0 EQU   0                                                        10275000
IDCSAPR0 EQU   0                                                        10276000
IDCSAPT0 EQU   0                                                        10277000
IDCSAQL0 EQU   0                                                        10278000
IDCSARC0 EQU   0                                                        10279000
IDCSARK0 EQU   0                                                        10280000
IDCSARV0 EQU   0                                                        10281000
IDCSASC0 EQU   0                                                        10282000
IDCSASI0 EQU   0                                                        10283000
IDCSASN0 EQU   0                                                        10284000
IDCSAST0 EQU   0                                                        10285000
IDCSATI0 EQU   0                                                        10286000
IDCSAUC0 EQU   0                                                        10287000
IDCSAWO0 EQU   0                                                        10288000
IDCST010 EQU   0                                                        10289000
IDCTPER0 EQU   0                                                        10290000
LISTTEST EQU   0                                                        10291000
NEWERID1 EQU   5                                                        10292000
GDTTBL   EQU   0                                                        10293000
GDTTR1   EQU   GDTTBL+8                                                 10294000
GDTTR2   EQU   GDTTBL+12                                                10295000
GDTDBG   EQU   GDTTBL+40                                                10296000
GDTSTC   EQU   GDTTBL+44                                                10297000
GDTPRT   EQU   GDTTBL+48                                                10298000
GDTESS   EQU   GDTTBL+52                                                10299000
GDTESA   EQU   GDTTBL+56                                                10300000
GDTRST   EQU   GDTTBL+60                                                10301000
GDTRES   EQU   GDTTBL+64                                                10302000
GDTCAL   EQU   GDTTBL+68                                                10303000
GDTGSP   EQU   GDTTBL+72                                                10304000
GDTFSP   EQU   GDTTBL+76                                                10305000
GDTGPL   EQU   GDTTBL+80                                                10306000
GDTFPL   EQU   GDTTBL+84                                                10307000
GDTLOD   EQU   GDTTBL+88                                                10308000
GDTDEL   EQU   GDTTBL+92                                                10309000
GDTPRL   EQU   GDTTBL+96                                                10310000
GDTEPL   EQU   GDTTBL+100                                               10311000
GDTTIM   EQU   GDTTBL+104                                               10312000
GDTIIO   EQU   GDTTBL+108                                               10313000
GDTTIO   EQU   GDTTBL+112                                               10314000
GDTOPN   EQU   GDTTBL+124                                               10315000
GDTCLS   EQU   GDTTBL+128                                               10316000
GDTGET   EQU   GDTTBL+132                                               10317000
GDTPUT   EQU   GDTTBL+136                                               10318000
GDTPOS   EQU   GDTTBL+140                                               10319000
GDTCPY   EQU   GDTTBL+144                                               10320000
GDTCAT   EQU   GDTTBL+148                                               10321000
GDTSNP   EQU   GDTTBL+164                                               10322000
GDTVFY   EQU   GDTTBL+172                                               10323000
GDTUID   EQU   GDTTBL+192                                               10324000
GDTPMT   EQU   GDTTBL+196                                               10325000
GDTCIR   EQU   GDTTBL+200                                               10326000
GDTLNK   EQU   GDTTBL+204                                               10327000
GDTALC   EQU   GDTTBL+208                                               10328000
GDTDLC   EQU   GDTTBL+212                                               10329000
GDTQAL   EQU   GDTTBL+216                                               10330000
GDTSTW   EQU   GDTTBL+220                                               10331000
GDTSSC   EQU   GDTTBL+224                                               10332000
GDTENQ   EQU   GDTTBL+228                                               10333000
GDTRSV   EQU   GDTTBL+232                                               10334000
GDTDEQ   EQU   GDTTBL+236                                               10335000
GDTSFO   EQU   GDTTBL+240                                               10336000
GDTWTO   EQU   GDTTBL+244                                               10337000
GDTSCR   EQU   GDTTBL+248                                               10338000
GDTUNT   EQU   GDTTBL+252                                               10339000
GDTRCT   EQU   GDTTBL+256                                               10340000
GDTIFO   EQU   GDTTBL+260                                               10341000
GDTEXP   EQU   GDTTBL+264                                               10342000
GDTSTA   EQU   GDTTBL+268                                               10343000
GDTERR   EQU   GDTTBL+272                                               10344000
GDTUNC   EQU   GDTTBL+276                                               10345000
GDTLOC   EQU   GDTTBL+280                                               10346000
GDTRCK   EQU   GDTTBL+284                                               10347000
FDTTBL   EQU   0                                                        10348000
FDTPTR   EQU   FDTTBL+8                                                 10349000
LASTCOND EQU   0                                                        10350000
CKCSNVAL EQU   0                                                        10351000
CKLENGTH EQU   0                                                        10352000
SSRCODE  EQU   0                                                        10353000
SSRHALF  EQU   SSRCODE+2                                                10354000
SSECBCD  EQU   0                                                        10355000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    10356000
@NM00134 EQU   SSRCODE                                                  10357000
FDTVERB  EQU   FDTTBL                                                   10358000
GDTECT   EQU   GDTTBL+188                                               10359000
GDTPSB   EQU   GDTTBL+184                                               10360000
GDTUPT   EQU   GDTTBL+180                                               10361000
GDTCMB   EQU   GDTTBL+176                                               10362000
GDTSPR   EQU   GDTTBL+168                                               10363000
@NM00001 EQU   GDTTBL+160                                               10364000
GDTABH   EQU   GDTTBL+156                                               10365000
GDTABT   EQU   GDTTBL+152                                               10366000
GDTTOH   EQU   GDTTBL+120                                               10367000
GDTRIP   EQU   GDTTBL+116                                               10368000
GDTIOH   EQU   GDTTBL+36                                                10369000
GDTSAH   EQU   GDTTBL+32                                                10370000
GDTTPH   EQU   GDTTBL+28                                                10371000
GDTRIH   EQU   GDTTBL+24                                                10372000
GDTSTH   EQU   GDTTBL+20                                                10373000
GDTDBH   EQU   GDTTBL+16                                                10374000
GDTPRM   EQU   GDTTBL+4                                                 10375000
GDTHDR   EQU   GDTTBL                                                   10376000
@NM00128 EQU   DEFVE+60                                                 10377000
@NM00127 EQU   DEFNULFL                                                 10378000
DEFNEXPD EQU   DEFNULFL                                                 10379000
DEFNDESC EQU   DEFNULFL                                                 10380000
DEFNGRP  EQU   DEFNULFL                                                 10381000
@NM00126 EQU   DEFTYPFL                                                 10382000
DEFCOPY  EQU   DEFTYPFL                                                 10383000
DEFRSTD  EQU   DEFTYPFL                                                 10384000
DEFGENUS EQU   DEFTYPFL                                                 10385000
@NM00125 EQU   DEFRECFL                                                 10386000
DEFCREAT EQU   DEFRECFL                                                 10387000
DEFICOPY EQU   DEFRECFL                                                 10388000
@NM00124 EQU   DEFSETFL                                                 10389000
@NM00123 EQU   DEFFLAGA                                                 10390000
DEFPBKUP EQU   DEFFLAGA                                                 10391000
DEFPTO   EQU   DEFFLAGA                                                 10392000
DEFPDESC EQU   DEFFLAGA                                                 10393000
DEFPGRO  EQU   DEFFLAGA                                                 10394000
DEFPFOR  EQU   DEFFLAGA                                                 10395000
DEFBKUPN EQU   DEFVE+48                                                 10396000
DEFFOR   EQU   DEFVE+46                                                 10397000
DEFTO    EQU   DEFVE+42                                                 10398000
DEFDESCR EQU   DEFVE+12                                                 10399000
DEFGROUP EQU   DEFVE+4                                                  10400000
DEFTLAB  EQU   DEFVDATA+71                                              10401000
DEFR60   EQU   DEFVDATA+43                                              10402000
DEFOWNID EQU   DEFVDATA+29                                              10403000
DEFR55   EQU   DEFVDATA+3                                               10404000
DEFACSEC EQU   DEFVDATA+2                                               10405000
DEFR50   EQU   DEFVDATA                                                 10406000
DEFVECB  EQU   DEFLIST+52                                               10407000
DEFVASID EQU   DEFLIST+50                                               10408000
@NM00122 EQU   DEFLIST+48                                               10409000
DEFVCSN2 EQU   DEFLIST+36                                               10410000
@NM00121 EQU   DEFLIST+22                                               10411000
@NM00120 EQU   DEFLIST+15                                               10412000
@NM00119 EQU   DEFVVFLG                                                 10413000
@NM00118 EQU   DEFVVFLG                                                 10414000
@NM00117 EQU   DEFVVFLG                                                 10415000
DEFVCECT EQU   DEFVVFLG                                                 10416000
DEFVLID  EQU   DEFVLIB                                                  10417000
@NM00116 EQU   DEFVLIB                                                  10418000
DEFVELTR EQU   DEFVFLG                                                  10419000
DEFVREP  EQU   DEFVFLG                                                  10420000
DEFVELM  EQU   DEFVFLG                                                  10421000
DEFVCR   EQU   DEFVFLG                                                  10422000
@NM00115 EQU   DEFLIST+5                                                10423000
DEFVOPCD EQU   DEFLIST+4                                                10424000
DEFVLEN  EQU   DEFLIST                                                  10425000
@NM00114 EQU   MVR+82                                                   10426000
MVRBLNK1 EQU   MVR+75                                                   10427000
MVRBKUPN EQU   MVR+74                                                   10428000
MVRCSN   EQU   MVR+62                                                   10429000
MVRTO    EQU   MVR+58                                                   10430000
MVRDES   EQU   MVR+28                                                   10431000
MVRGROUP EQU   MVR+20                                                   10432000
MVRFOR   EQU   MVR+18                                                   10433000
@NM00113 EQU   MVRFLAGA+2                                               10434000
MVRCICPY EQU   MVRFLAGA+2                                               10435000
MVRCIVCF EQU   MVRFLAGA+2                                               10436000
MVRSLMIS EQU   MVRFLAGA+1                                               10437000
MVRNEXPD EQU   MVRFLAGA+1                                               10438000
MVRNDESC EQU   MVRFLAGA+1                                               10439000
MVRBKUP  EQU   MVRFLAGA+1                                               10440000
MVRNGRP  EQU   MVRFLAGA+1                                               10441000
MVRRSTD  EQU   MVRFLAGA+1                                               10442000
MVRGEN   EQU   MVRFLAGA+1                                               10443000
MVRFLBK  EQU   MVRFLAGA                                                 10444000
MVRFLCSN EQU   MVRFLAGA                                                 10445000
MVRFLTO  EQU   MVRFLAGA                                                 10446000
MVRFLDES EQU   MVRFLAGA                                                 10447000
MVRFLGRO EQU   MVRFLAGA                                                 10448000
MVRFLFOR EQU   MVRFLAGA                                                 10449000
@NM00112 EQU   MVRCODE+1                                                10450000
MVROPCD  EQU   MVRCODE                                                  10451000
@NM00111 EQU   RVVI+64                                                  10452000
RVVSDUP  EQU   RVVSPEC                                                  10453000
RVVSCPY  EQU   RVVSPEC                                                  10454000
RVVSEXP  EQU   RVVSPEC                                                  10455000
@NM00110 EQU   RVVCPYTP                                                 10456000
RVVCPLHD EQU   RVVCPYTP                                                 10457000
RVVLCOPY EQU   RVVCPYTP                                                 10458000
RVVOBKUP EQU   RVVCPYTP                                                 10459000
RVVLBKUP EQU   RVVCPYTP                                                 10460000
RVVBPLHD EQU   RVVRTEST                                                 10461000
RVVDVOL  EQU   RVVRTEST                                                 10462000
RVVACTV  EQU   RVVRTEST                                                 10463000
RVVINACT EQU   RVVRTEST                                                 10464000
RVVRSTD  EQU   RVVRTEST                                                 10465000
RVVGSVOL EQU   RVVRTEST                                                 10466000
RVVTHOLD EQU   RVVRTEST                                                 10467000
RVVEXPDT EQU   RVVRTEST                                                 10468000
RVVALL   EQU   RVVRDRCD                                                 10469000
RVVCPURC EQU   RVVRDRCD                                                 10470000
RVVCIRCD EQU   RVVRDRCD                                                 10471000
@NM00109 EQU   RVVCHAIN                                                 10472000
RVVNGVOL EQU   RVVCHAIN                                                 10473000
RVVGPVOL EQU   RVVCHAIN                                                 10474000
@NM00108 EQU   RVVRMODE                                                 10475000
RVVRDCH  EQU   RVVRMODE                                                 10476000
RVVRDNR  EQU   RVVRMODE                                                 10477000
RVVDUPID EQU   RVVI+57                                                  10478000
RVVCPYID EQU   RVVI+56                                                  10479000
RVVBLNK1 EQU   RVVI+42                                                  10480000
RVVEXPIR EQU   RVVI+36                                                  10481000
@NM00107 EQU   RVVI+28                                                  10482000
RVVAREA  EQU   RVVI+24                                                  10483000
RVVARLN  EQU   RVVI+22                                                  10484000
@NM00106 EQU   RVVOPCOD+1                                               10485000
@NM00105 EQU   GROUP+136                                                10486000
GROADDR  EQU   GROUP+106                                                10487000
GROOWNER EQU   GROUP+96                                                 10488000
GRORESSP EQU   GROUP+95                                                 10489000
GROCONUS EQU   GROUP+94                                                 10490000
GRODESCR EQU   GROUP+64                                                 10491000
GROERRTM EQU   GROERRTS+4                                               10492000
GROERRDT EQU   GROERRTS                                                 10493000
GRORETPD EQU   GROUP+52                                                 10494000
GROFREXT EQU   GROUP+48                                                 10495000
GROFRESP EQU   GROUP+44                                                 10496000
GROSTRSH EQU   GROUP+40                                                 10497000
GROSSPD  EQU   GROUP+38                                                 10498000
GROPSPD  EQU   GROUP+36                                                 10499000
GRONINAC EQU   GROUP+34                                                 10500000
GRONRSTD EQU   GROUP+32                                                 10501000
GRONGEN  EQU   GROUP+30                                                 10502000
GROPCENT EQU   GROUP+29                                                 10503000
GROLSN   EQU   GROUP+23                                                 10504000
GROFSN   EQU   GROUP+17                                                 10505000
@NM00104 EQU   GROFLAGA+2                                               10506000
GROMSG1  EQU   GROFLAGA+2                                               10507000
GRORETN  EQU   GROFLAGA+2                                               10508000
GRORLSE  EQU   GROFLAGA+2                                               10509000
GRORES1  EQU   GROTYPE                                                  10510000
GROGVR   EQU   GROTYPE                                                  10511000
GROZERO  EQU   GROID+1                                                  10512000
GROBLANK EQU   GROID                                                    10513000
GROVVGRP EQU   GRONAME+3                                                10514000
GROG     EQU   GRONAME                                                  10515000
BCD2BIT2 EQU   BCDLID2                                                  10516000
BCD2BIT1 EQU   BCDLID2                                                  10517000
BCDRES8  EQU   BCDLIB2                                                  10518000
BCDCSN2  EQU   BCDV+37                                                  10519000
BCD1BIT2 EQU   BCDLID1                                                  10520000
BCD1BIT1 EQU   BCDLID1                                                  10521000
BCDRE10  EQU   BCDLIB1                                                  10522000
BCDRES7A EQU   BCDMISCF                                                 10523000
BCDHOLD  EQU   BCDMISCF                                                 10524000
BCDRES7  EQU   BCDSATIA                                                 10525000
BCDCPUID EQU   BCDV+18                                                  10526000
BCDRES5  EQU   BCDFLAGB+1                                               10527000
BCDREASS EQU   BCDFLAGB+1                                               10528000
BCDRES4  EQU   BCDFLAGB                                                 10529000
BCDRES3  EQU   BCDTYPE                                                  10530000
BCDRES2  EQU   BCDTYPE                                                  10531000
BCDRES1  EQU   BCDTYPE                                                  10532000
BCDRES9  EQU   BCDV+13                                                  10533000
BCDINDEX EQU   BCDID+1                                                  10534000
BCDBLNK2 EQU   BCDID                                                    10535000
BCDSERNO EQU   BCDNAME+5                                                10536000
BCDBLNK1 EQU   BCDPREFX+1                                               10537000
BCDALPHA EQU   BCDPREFX                                                 10538000
@NM00103 EQU   DUPV+50                                                  10539000
DUP2BIT2 EQU   DUPLID2                                                  10540000
DUP2BIT1 EQU   DUPLID2                                                  10541000
DUPRES4  EQU   DUPLIB2                                                  10542000
DUPCSN2  EQU   DUPV+37                                                  10543000
DUP1BIT2 EQU   DUPLID1                                                  10544000
DUP1BIT1 EQU   DUPLID1                                                  10545000
DUPRES3  EQU   DUPLIB1                                                  10546000
DUPCSN1  EQU   DUPV+24                                                  10547000
DUPMISCF EQU   DUPRCVYF+2                                               10548000
DUPSATIA EQU   DUPRCVYF                                                 10549000
@NM00102 EQU   DUPV+18                                                  10550000
@NM00101 EQU   DUPFLAGA+2                                               10551000
DUPRES2  EQU   DUPTYPE                                                  10552000
DUPDUPLR EQU   DUPTYPE                                                  10553000
DUPRES1  EQU   DUPTYPE                                                  10554000
DUPRES5  EQU   DUPV+13                                                  10555000
DUPNO    EQU   DUPID+1                                                  10556000
DUPBLANK EQU   DUPID                                                    10557000
DUPSERNO EQU   DUPNAME+5                                                10558000
DUPD     EQU   DUPNAME                                                  10559000
@NM00100 EQU   COPYV+136                                                10560000
COPFREXT EQU   COPYV+132                                                10561000
COPLEXT  EQU   COPYV+130                                                10562000
COPFRESP EQU   COPYV+128                                                10563000
COPOWNER EQU   COPYV+118                                                10564000
COPDEST  EQU   COPYV+88                                                 10565000
COPDESCR EQU   COPYV+58                                                 10566000
COPDTREM EQU   COPYV+54                                                 10567000
COPDATE  EQU   COPYV+50                                                 10568000
COP2BIT2 EQU   COPLID2                                                  10569000
COP2BIT1 EQU   COPLID2                                                  10570000
COPRES5  EQU   COPLIB2                                                  10571000
COPCSN2  EQU   COPYV+37                                                 10572000
COP1BIT2 EQU   COPLID1                                                  10573000
COP1BIT1 EQU   COPLID1                                                  10574000
COPRES4  EQU   COPLIB1                                                  10575000
COPCSN1  EQU   COPYV+24                                                 10576000
@NM00099 EQU   COPMISCF                                                 10577000
COPHOLD  EQU   COPMISCF                                                 10578000
COPRES3  EQU   COPSATIA                                                 10579000
COPVSMIS EQU   COPSATIA                                                 10580000
COPIVCPY EQU   COPSATIA                                                 10581000
COPIVCRE EQU   COPSATIA                                                 10582000
@NM00098 EQU   COPYV+18                                                 10583000
@NM00097 EQU   COPFLAGA+3                                               10584000
COPDLSPF EQU   COPFLAGA+3                                               10585000
COPRONLY EQU   COPFLAGA+3                                               10586000
COPDAERA EQU   COPFLAGA+2                                               10587000
COPEXCL  EQU   COPFLAGA+2                                               10588000
COPBIND  EQU   COPFLAGA+2                                               10589000
COPBKUP  EQU   COPFLAGA+2                                               10590000
COPRSTD  EQU   COPFLAGA+2                                               10591000
COPGROUP EQU   COPFLAGA+2                                               10592000
COPRES2  EQU   COPTYPE                                                  10593000
COPCOPYV EQU   COPTYPE                                                  10594000
COPRES1  EQU   COPTYPE                                                  10595000
COPRES6  EQU   COPYV+13                                                 10596000
COPNO    EQU   COPID+1                                                  10597000
COPBLANK EQU   COPID                                                    10598000
COPSERNO EQU   COPNAME+5                                                10599000
COPV     EQU   COPNAME                                                  10600000
@NM00096 EQU   BASEV+192                                                10601000
BASXPDT2 EQU   BASEV+188                                                10602000
BASDEST  EQU   BASEV+144                                                10603000
BASOWNER EQU   BASEV+134                                                10604000
BASDESCR EQU   BASEV+104                                                10605000
BASDTREM EQU   BASEV+100                                                10606000
BASEXPDT EQU   BASEV+96                                                 10607000
BASDLMTD EQU   BASEV+92                                                 10608000
BASRES6  EQU   BASEV+89                                                 10609000
BASCOPNO EQU   BASCOPID+1                                               10610000
BASCOPBK EQU   BASCOPID                                                 10611000
BASCOPSN EQU   BASKLCPY+5                                               10612000
BASCOPV  EQU   BASKLCPY                                                 10613000
BASFREXT EQU   BASEV+72                                                 10614000
BASLEXT  EQU   BASEV+70                                                 10615000
BASFRESP EQU   BASEV+68                                                 10616000
@NM00095 EQU   BASEV+65                                                 10617000
BASBKLMT EQU   BASEV+64                                                 10618000
BASNBKUP EQU   BASEV+63                                                 10619000
BASNCOPY EQU   BASEV+62                                                 10620000
BASNEXTV EQU   BASEV+56                                                 10621000
BASPREV  EQU   BASEV+50                                                 10622000
BAS2BIT2 EQU   BASLID2                                                  10623000
BAS2BIT1 EQU   BASLID2                                                  10624000
BASRES5  EQU   BASLIB2                                                  10625000
BASCSN2  EQU   BASEV+37                                                 10626000
BAS1BIT2 EQU   BASLID1                                                  10627000
BAS1BIT1 EQU   BASLID1                                                  10628000
BASRES4  EQU   BASLIB1                                                  10629000
BASRES3  EQU   BASMISCF                                                 10630000
BASHOLD  EQU   BASMISCF                                                 10631000
BASRES8  EQU   BASSATIA                                                 10632000
BASVSMIS EQU   BASSATIA                                                 10633000
BASIVCPY EQU   BASSATIA                                                 10634000
BASIVCRE EQU   BASSATIA                                                 10635000
BASCPUID EQU   BASEV+18                                                 10636000
@NM00094 EQU   BASFLAGA+3                                               10637000
BASLAST  EQU   BASFLAGA+3                                               10638000
BASFIRST EQU   BASFLAGA+3                                               10639000
BASRONLY EQU   BASFLAGA+3                                               10640000
BASDAERA EQU   BASFLAGA+3                                               10641000
BASEXCL  EQU   BASFLAGA+2                                               10642000
BASBIND  EQU   BASFLAGA+2                                               10643000
BASRSTD  EQU   BASFLAGA+2                                               10644000
BASGRPV  EQU   BASFLAGA+2                                               10645000
BASNOCPY EQU   BASFLAGA+2                                               10646000
BASRES2  EQU   BASTYPE                                                  10647000
BASBASVR EQU   BASTYPE                                                  10648000
BASRES1  EQU   BASTYPE                                                  10649000
BASRES7  EQU   BASEV+13                                                 10650000
BASZERO  EQU   BASID+1                                                  10651000
BASBLANK EQU   BASID                                                    10652000
BASEVKEY EQU   BASNAME                                                  10653000
PFILEVAL EQU   @NM00093+1                                               10654000
PFILELEN EQU   @NM00093                                                 10655000
PFILECNT EQU   PFILE                                                    10656000
FILELEN  EQU   FILE                                                     10657000
NSERLEN  EQU   NSER                                                     10658000
VSDDSN   EQU   VSDARRAY+4                                               10659000
VSDVOLCT EQU   VSDARRAY                                                 10660000
VSDFMT0  EQU   VSDBLOCK+8                                               10661000
VSDVTOCS EQU   VSDBLOCK+4                                               10662000
VSDELEM  EQU   VSDBLOCK                                                 10663000
VSDFREE  EQU   VSDUSAGE+24                                              10664000
VSDALLC  EQU   VSDUSAGE+19                                              10665000
VSDDSOR3 EQU   VSDDSORG+2                                               10666000
@NM00092 EQU   VSDDSORG                                                 10667000
VSDSCAL  EQU   VSDUSAGE+12                                              10668000
@NM00091 EQU   VSDUSEF                                                  10669000
VSDCALFR EQU   VSDUSEF                                                  10670000
@NM00090 EQU   VSDALLOC                                                 10671000
VSDABSTR EQU   VSDALLOC                                                 10672000
VSDABLK  EQU   VSDALLOC                                                 10673000
VSDATRK  EQU   VSDALLOC                                                 10674000
VSDACYL  EQU   VSDALLOC                                                 10675000
@NM00089 EQU   VSDDORG                                                  10676000
VSDOU    EQU   VSDDORG                                                  10677000
VSDOIS   EQU   VSDDORG                                                  10678000
VSDODA   EQU   VSDDORG                                                  10679000
VSDOUN   EQU   VSDDORG                                                  10680000
VSDOPS   EQU   VSDDORG                                                  10681000
VSDOPO   EQU   VSDDORG                                                  10682000
VSDEXTS  EQU   VSDUSAGE+8                                               10683000
VSDSECAL EQU   VSDUSAGE+4                                               10684000
VSDFTRK  EQU   VSDUSAGE+2                                               10685000
VSDTRKS  EQU   VSDUSAGE                                                 10686000
@NM00088 EQU   VSDSCR+5                                                 10687000
@NM00087 EQU   VSDSCRFL                                                 10688000
VSDVSAM  EQU   VSDSCRFL                                                 10689000
VSDCATLC EQU   VSDSCRFL                                                 10690000
VSDACBPT EQU   VSDSCR                                                   10691000
@NM00086 EQU   VSDSTAT+29                                               10692000
VSDPRTC  EQU   VSDSTAT+25                                               10693000
VSDCAT   EQU   VSDSTAT+22                                               10694000
VSDEXP   EQU   VSDSTAT+20                                               10695000
VSDCRE   EQU   VSDSTAT+18                                               10696000
@NM00085 EQU   VSDFLG2                                                  10697000
VSDRACF  EQU   VSDFLG2                                                  10698000
VSDERROR EQU   VSDFLG2                                                  10699000
VSDPROT  EQU   VSDFLG2                                                  10700000
VSDPWW   EQU   VSDFLG2                                                  10701000
VSDPWR   EQU   VSDFLG2                                                  10702000
@NM00084 EQU   VSDSFLG1                                                 10703000
VSDCVSAM EQU   VSDSFLG1                                                 10704000
VSDCATLG EQU   VSDSFLG1                                                 10705000
VSDVSAME EQU   VSDSFLG1                                                 10706000
VSDVSAMC EQU   VSDSFLG1                                                 10707000
VSDVTOCE EQU   VSDSFLG1                                                 10708000
VSDVTOCC EQU   VSDSFLG1                                                 10709000
VSDOWNER EQU   VSDSTAT+8                                                10710000
VSDEXPIR EQU   VSDSTAT+4                                                10711000
VSDCREAT EQU   VSDSTAT                                                  10712000
VSDFRCCL EQU   VSDVTOC+21                                               10713000
@NM00083 EQU   VSDVTOC+20                                               10714000
VSDFREXT EQU   VSDVTOC+16                                               10715000
@NM00082 EQU   VSDVTOC+15                                               10716000
VSDFRTRK EQU   VSDVTOC+11                                               10717000
@NM00081 EQU   VSDVTOC+10                                               10718000
VSDFRCYL EQU   VSDVTOC+6                                                10719000
@NM00080 EQU   VSDVTOC                                                  10720000
@NM00079 EQU   VS3FLAGS                                                 10721000
VS3SYSNM EQU   VS3FLAGS                                                 10722000
VS3UNCAT EQU   VS3FLAGS                                                 10723000
VS3SCR   EQU   VS3FLAGS                                                 10724000
VS3USAGE EQU   VS3FLAGS                                                 10725000
VS3STAT  EQU   VS3FLAGS                                                 10726000
VS3DD    EQU   VS3AGL+50                                                10727000
VS3VOL   EQU   VS3AGL+44                                                10728000
VS3POOL  EQU   VS3AGL+40                                                10729000
VS3DEV   EQU   VS3AGL+36                                                10730000
VS3UCBP  EQU   VS3AGL+32                                                10731000
VS3CREAT EQU   VS3AGL+28                                                10732000
VS3EXPIR EQU   VS3AGL+24                                                10733000
VS3AST   EQU   VS3AGL+22                                                10734000
VS3LEVLN EQU   VS3AGL+20                                                10735000
VS3LEVP  EQU   VS3AGL+16                                                10736000
VS3EXDSP EQU   VS3AGL+12                                                10737000
VS3LISTP EQU   VS3AGL+8                                                 10738000
VS3HEAD  EQU   VS3AGL                                                   10739000
@NM00078 EQU   DATESOPT                                                 10740000
DATDAYOP EQU   DATESOPT                                                 10741000
DATDTEOP EQU   DATESOPT                                                 10742000
DATSUB   EQU   DATESOPT                                                 10743000
DATADD   EQU   DATESOPT                                                 10744000
DATRETRN EQU   DATESAGL+16                                              10745000
DATDAYS  EQU   DATESAGL+12                                              10746000
DATDATE  EQU   DATESAGL+8                                               10747000
DATHEAD  EQU   DATESAGL                                                 10748000
@NM00077 EQU   SELFLAGS                                                 10749000
SELVOL   EQU   SELAGL+16                                                10750000
SELDDNP  EQU   SELAGL+12                                                10751000
SELUCBP  EQU   SELAGL+8                                                 10752000
SELHEAD  EQU   SELAGL                                                   10753000
@NM00076 EQU   UCTFLAGS                                                 10754000
UCTVSCAT EQU   UCTFLAGS                                                 10755000
UCTDD    EQU   UCTAGL+60                                                10756000
UCTVOLP  EQU   UCTAGL+56                                                10757000
UCTACBP  EQU   UCTAGL+52                                                10758000
UCTDSN   EQU   UCTAGL+8                                                 10759000
UCTHEAD  EQU   UCTAGL                                                   10760000
@NM00075 EQU   LCTFLAGS                                                 10761000
LCTVSCAT EQU   LCTFLAGS                                                 10762000
LCTOWNER EQU   LCTINFO+24                                               10763000
LCTEXPIR EQU   LCTINFO+20                                               10764000
LCTCREAT EQU   LCTINFO+16                                               10765000
LCTACBP  EQU   LCTINFO+12                                               10766000
LCTMULVC EQU   LCTINFO+8                                                10767000
LCTHEAD  EQU   LCTINFO                                                  10768000
SRTWORKP EQU   SRTAGL+28                                                10769000
SRTFLDLN EQU   SRTAGL+24                                                10770000
SRTPOSIT EQU   SRTAGL+20                                                10771000
SRTLEN   EQU   SRTAGL+16                                                10772000
SRTNUM   EQU   SRTAGL+12                                                10773000
SRTADDR  EQU   SRTAGL+8                                                 10774000
SRTHEAD  EQU   SRTAGL                                                   10775000
SV82DEBP EQU   SV82WRKP                                                 10776000
SV82TTRP EQU   SV82LIST+8                                               10777000
SV82VOLP EQU   SV82DCBP                                                 10778000
SV82UCBP EQU   SV82LIST+1                                               10779000
SV82CODE EQU   SV82LIST                                                 10780000
VOLRESV3 EQU   VOLLABEL+55                                              10781000
VOLOWNER EQU   VOLLABEL+45                                              10782000
VOLRESV1 EQU   VOLLABEL+20                                              10783000
VOLVTOC  EQU   VOLLABEL+15                                              10784000
VOLSECTY EQU   VOLLABEL+14                                              10785000
VOLSERNO EQU   VOLLABEL+8                                               10786000
VOLNO    EQU   VOLLABEL+7                                               10787000
VOLLABI  EQU   VOLLABEL+4                                               10788000
VOLKEY   EQU   VOLLABEL                                                 10789000
STAVTTR  EQU   STAEPARM+54                                              10790000
@NM00072 EQU   STARETRY                                                 10791000
STAVTOC  EQU   STARETRY                                                 10792000
STAOFF   EQU   STARETRY                                                 10793000
STAIO05  EQU   STARETRY                                                 10794000
@NM00071 EQU   STARCVY                                                  10795000
STACLEAR EQU   STARCVY                                                  10796000
STAVPOST EQU   STARCVY                                                  10797000
STAVENQ  EQU   STARCVY                                                  10798000
STAVDMNT EQU   STARCVY                                                  10799000
STAVMNT  EQU   STARCVY                                                  10800000
STATCB   EQU   STAEPARM+48                                              10801000
STARTADD EQU   STAEPARM+44                                              10802000
STAEXSAV EQU   STAEPARM+40                                              10803000
STARTSAV EQU   STAEPARM+36                                              10804000
STARTTR  EQU   STAEPARM+32                                              10805000
@NM00070 EQU   STAEPARM+30                                              10806000
STARVOL  EQU   STAEPARM+24                                              10807000
STARUCB  EQU   STAEPARM+20                                              10808000
@NM00069 EQU   STAEPARM+18                                              10809000
STAVVOL  EQU   STAEPARM+12                                              10810000
STAVUCB  EQU   STAEPARM+8                                               10811000
STAHEAD  EQU   STAEPARM                                                 10812000
RCTDSET  EQU   RCTAGL+32                                                10813000
RCTNVOL  EQU   RCTAGL+26                                                10814000
RCTOVOL  EQU   RCTAGL+20                                                10815000
RCTNDEV  EQU   RCTAGL+16                                                10816000
RCTODEV  EQU   RCTAGL+12                                                10817000
@NM00068 EQU   RCTAGL+10                                                10818000
@NM00067 EQU   RCTOPT                                                   10819000
RCTVOL   EQU   RCTOPT                                                   10820000
RCTDEV   EQU   RCTOPT                                                   10821000
RCTHEAD  EQU   RCTAGL                                                   10822000
@NM00066 EQU   VSRESOPT                                                 10823000
VSREAL   EQU   VSRESOPT                                                 10824000
@NM00065 EQU   VSMSG                                                    10825000
VSTOV    EQU   VSMSG                                                    10826000
VSFROMV  EQU   VSMSG                                                    10827000
@NM00064 EQU   VSRETURN                                                 10828000
VSUCAT   EQU   VSRETURN                                                 10829000
@NM00063 EQU   VSCATOPT                                                 10830000
VSLIST   EQU   VSCATOPT                                                 10831000
VSSERIAL EQU   VSCATOPT                                                 10832000
VSDEVICE EQU   VSCATOPT                                                 10833000
@NM00062 EQU   VSVTOPT                                                  10834000
VSALTTRK EQU   VSVTOPT                                                  10835000
VSTIME   EQU   VSVTOPT                                                  10836000
VSUCMAST EQU   VSSECOPT                                                 10837000
VSOPCAT  EQU   VSSECOPT                                                 10838000
VSUCTEST EQU   VSSECOPT                                                 10839000
VSREAD   EQU   VSSECOPT                                                 10840000
VSNONONV EQU   VSSECOPT                                                 10841000
VSMASTER EQU   VSSECOPT                                                 10842000
VSODEVP  EQU   VS1AGL+64                                                10843000
VSOSERP  EQU   VS1AGL+60                                                10844000
VSDEVP   EQU   VS1AGL+56                                                10845000
VSSERP   EQU   VS1AGL+52                                                10846000
VSPSWDP  EQU   VS1AGL+44                                                10847000
VSCATDDP EQU   VS1AGL+40                                                10848000
VSACBP   EQU   VS1AGL+36                                                10849000
VSCATP   EQU   VS1AGL+32                                                10850000
VSNXTATP EQU   VS1AGL+28                                                10851000
VSNUMATP EQU   VS1AGL+24                                                10852000
VSHEAD   EQU   VS1AGL                                                   10853000
VSVTOCPT EQU   VS2AGL+48                                                10854000
@NM00061 EQU   VS2AGL+45                                                10855000
@NM00060 EQU   VS2RESOP                                                 10856000
VS2REAL  EQU   VS2RESOP                                                 10857000
@NM00059 EQU   VS2MSG                                                   10858000
VS2TOV   EQU   VS2MSG                                                   10859000
@NM00058 EQU   VSLABOPT                                                 10860000
VSNOVTOC EQU   VSLABOPT                                                 10861000
VSOWNER  EQU   VSLABOPT                                                 10862000
VSIOBKPT EQU   VS2AGL+24                                                10863000
VSOWNPTR EQU   VS2AGL+16                                                10864000
VSVTOCSZ EQU   VS2AGL+12                                                10865000
VS2HEAD  EQU   VS2AGL                                                   10866000
EXPDATAL EQU   EXPARRAY+6                                               10867000
@NM00057 EQU   EXPARRAY+5                                               10868000
EXPKEYLN EQU   EXPARRAY+4                                               10869000
EXPDATAP EQU   EXPARRAY                                                 10870000
EXPRECNO EQU   EXPDATAB                                                 10871000
EXPCCHHR EQU   EXPARG+16                                                10872000
EXPCTLBK EQU   EXPARG+8                                                 10873000
EXPHEAD  EQU   EXPARG                                                   10874000
EXRWFUN  EQU   EXWRARG+46                                               10875000
@NM00056 EQU   EXSPACE+8                                                10876000
@NM00055 EQU   EXSPACE+6                                                10877000
@NM00054 EQU   EXSPACE+4                                                10878000
@NM00053 EQU   EXSPACE+1                                                10879000
@NM00052 EQU   EXSPACE                                                  10880000
EXRWKDLN EQU   EXWRARG+32                                               10881000
@NM00051 EQU   EXWRARG+31                                               10882000
EXRECNUM EQU   EXRWCHR+4                                                10883000
EXHH     EQU   EXRWCHR+2                                                10884000
EXCC     EQU   EXRWCHR                                                  10885000
EXCCWCNT EQU   EXWRARG+24                                               10886000
EXLOCPTR EQU   EXWRARG+20                                               10887000
EXRWDARE EQU   EXWRARG+16                                               10888000
EXRWIOAR EQU   EXWRARG+12                                               10889000
EXRWCTBL EQU   EXWRARG+8                                                10890000
EXRWRES  EQU   EXWRARG                                                  10891000
EXGDATAL EQU   EXGARG+30                                                10892000
@NM00050 EQU   EXGARG+29                                                10893000
EXGKEYLN EQU   EXGARG+28                                                10894000
EXGDATAP EQU   EXGARG+24                                                10895000
EXGRECNO EQU   EXGARG+20                                                10896000
EXGCCHH2 EQU   EXGARG+16                                                10897000
EXGCCHH1 EQU   EXGARG+12                                                10898000
EXGCTLBK EQU   EXGARG+8                                                 10899000
EXGHEAD  EQU   EXGARG                                                   10900000
EXOVTH   EQU   EXFLG                                                    10901000
EXORVT   EQU   EXFLG                                                    10902000
EXORDS   EQU   EXFLG                                                    10903000
EXOSPK   EQU   EXFLG                                                    10904000
EXORVS   EQU   EXFLG                                                    10905000
@NM00049 EQU   EXFLG                                                    10906000
EXOREAD  EQU   EXFLG                                                    10907000
@NM00048 EQU   EXOPT                                                    10908000
EXOREP   EQU   EXOPT                                                    10909000
EXOVTOC  EQU   EXOPT                                                    10910000
EXONEW   EQU   EXOPT                                                    10911000
EXOPASS  EQU   EXOPT                                                    10912000
EXOLAB   EQU   EXOPT                                                    10913000
EXOTAB   EQU   EXOPT                                                    10914000
EXOCTLBK EQU   EXOARG+28                                                10915000
EXOEXT   EQU   EXOARG+24                                                10916000
EXOUCB   EQU   EXOARG+20                                                10917000
EXOVSN   EQU   EXOARG+16                                                10918000
EXODSN   EQU   EXOARG+12                                                10919000
EXODDN   EQU   EXOARG+8                                                 10920000
EXOHEAD  EQU   EXOARG                                                   10921000
@NM00047 EQU   EXCLFLAG                                                 10922000
EXCLMNT  EQU   EXCLFLAG                                                 10923000
EXCLHEAD EQU   EXCLAGL                                                  10924000
@NM00046 EQU   CKFLAGS                                                  10925000
CKDMTABL EQU   CKFLAGS                                                  10926000
CKRETTYP EQU   CKFLAGS                                                  10927000
CKLABELP EQU   CKAGL+24                                                 10928000
CKDATYPE EQU   CKAGL+20                                                 10929000
CKHEAD   EQU   CKAGL                                                    10930000
PULABELP EQU   PUAGL+16                                                 10931000
PUTTRPTR EQU   PUAGL+12                                                 10932000
PUUCBPTR EQU   PUAGL+8                                                  10933000
PUHEAD   EQU   PUAGL                                                    10934000
MDR      EQU   MDVTOC+4                                                 10935000
MDHH     EQU   MDVTOC+2                                                 10936000
MDCC     EQU   MDVTOC                                                   10937000
@NM00045 EQU   MDAGL+31                                                 10938000
MDVTOCTR EQU   MDFLAGS                                                  10939000
MDFORCE  EQU   MDFLAGS                                                  10940000
MDDEQ    EQU   MDFLAGS                                                  10941000
MDENQ    EQU   MDFLAGS                                                  10942000
MDPOST   EQU   MDFLAGS                                                  10943000
MDCLEAR  EQU   MDFLAGS                                                  10944000
MDNEWVOL EQU   MDFLAGS                                                  10945000
MDPUAGL  EQU   MDAGL+20                                                 10946000
MDHEAD   EQU   MDAGL                                                    10947000
CTTBLRR  EQU   CTARRAY+3                                                10948000
CTTBLHH  EQU   CTARRAY+2                                                10949000
CTTBLCC  EQU   CTARRAY+1                                                10950000
CTTBLID  EQU   CTARRAY                                                  10951000
CTREALH  EQU   CTMSG+3                                                  10952000
CTREALCC EQU   CTMSG+1                                                  10953000
@NM00044 EQU   CTMSG                                                    10954000
CMCSN2   EQU   CMMSG+28                                                 10955000
CMCSN1   EQU   CMMSG+16                                                 10956000
CMNUMCRT EQU   CMMSG+15                                                 10957000
@NM00043 EQU   CMMSG+14                                                 10958000
@NM00042 EQU   CMMSG+7                                                  10959000
@NM00041 EQU   CMVOLFLG                                                 10960000
CMSCRCRT EQU   CMVOLFLG                                                 10961000
CMSCRVOL EQU   CMVOLFLG                                                 10962000
CMCECART EQU   CMVOLFLG                                                 10963000
CMOLDVOL EQU   CMMSG                                                    10964000
CCOLDCSN EQU   CCMSG+24                                                 10965000
CCNEWCSN EQU   CCMSG+12                                                 10966000
@NM00040 EQU   CCMSG+10                                                 10967000
CCVOL    EQU   CCMSG+4                                                  10968000
@NM00039 EQU   CCMSG+2                                                  10969000
CCEJCODE EQU   CCMSG+1                                                  10970000
CCPSTCDE EQU   CCMSG                                                    10971000
@NM00038 EQU   DMPARY+15                                                10972000
DMPARYTP EQU   DMPARY+14                                                10973000
DMPARYEX EQU   DMPARY+12                                                10974000
DMPARYIC EQU   DMPARY+10                                                10975000
DMPARYSZ EQU   DMPARY+8                                                 10976000
DMPARYNM EQU   DMPARY                                                   10977000
@NM00037 EQU   DMPITM+15                                                10978000
@NM00036 EQU   ERCNVTAB+24                                              10979000
ERDARBPT EQU   ERCPLPT                                                  10980000
ERDYNRC  EQU   ERCATRC                                                  10981000
ERDSNM   EQU   ERCNVTAB+12                                              10982000
@NM00035 EQU   ERCNVTAB+4                                               10983000
@NM00034 EQU   ERCNVTAB+3                                               10984000
@NM00033 EQU   EROSOPER                                                 10985000
EROSUCDX EQU   EROSOPER                                                 10986000
EROSCATL EQU   EROSOPER                                                 10987000
@NM00032 EQU   EROPER                                                   10988000
ERCATAL  EQU   EROPER                                                   10989000
ERCATDL  EQU   EROPER                                                   10990000
ERCATDE  EQU   EROPER                                                   10991000
ERCATLC  EQU   EROPER                                                   10992000
@NM00031 EQU   ERTYPE                                                   10993000
ERDYNAL  EQU   ERTYPE                                                   10994000
EROSCAT  EQU   ERTYPE                                                   10995000
ERCATLG  EQU   ERTYPE                                                   10996000
@NM00030 EQU   FMTCNVF+1                                                10997000
FMTAR    EQU   FMTCNVF+1                                                10998000
FMTBS    EQU   FMTCNVF+1                                                10999000
FMTSS    EQU   FMTCNVF+1                                                11000000
FMTAL    EQU   FMTCNVF+1                                                11001000
FMTZS    EQU   FMTCNVF+1                                                11002000
@NM00029 EQU   FMTCNVF                                                  11003000
FMTPU    EQU   FMTCNVF                                                  11004000
FMTBD    EQU   FMTCNVF                                                  11005000
FMTBHD   EQU   FMTCNVF                                                  11006000
FMTBHA   EQU   FMTCNVF                                                  11007000
FMTBH    EQU   FMTCNVF                                                  11008000
FMTOLEN  EQU   FMTLIST+8                                                11009000
FMTRIO   EQU   FMTOCOL                                                  11010000
FMTSPT   EQU   FMTSTO                                                   11011000
FMTSTL   EQU   FMTILEN                                                  11012000
@NM00028 EQU   FMTFLGS+1                                                11013000
FMTSMSG  EQU   FMTFLGS+1                                                11014000
FMTHDF   EQU   FMTFLGS                                                  11015000
FMTDFF   EQU   FMTFLGS                                                  11016000
FMTSTF   EQU   FMTFLGS                                                  11017000
FMTREPF  EQU   FMTFLGS                                                  11018000
FMTBDF   EQU   FMTFLGS                                                  11019000
FMTIDF   EQU   FMTFLGS                                                  11020000
FMTSCF   EQU   FMTFLGS                                                  11021000
FMTEOLF  EQU   FMTFLGS                                                  11022000
DARGPCT  EQU   DARGINL                                                  11023000
DARGREP  EQU   DARGINS                                                  11024000
@NM00027 EQU   DARGLIST+19                                              11025000
DARGIND  EQU   DARGLIST+18                                              11026000
UVOLVOL  EQU   UVOLENT+4                                                11027000
UVOLDEV  EQU   UVOLENT                                                  11028000
UVOLCNT  EQU   UVOLLIST                                                 11029000
@NM00026 EQU   IOINFOPT                                                 11030000
IOINFLUB EQU   IOINFOPT                                                 11031000
IOINFTMS EQU   IOINFOPT                                                 11032000
IOINFSUP EQU   IOINFOPT                                                 11033000
IOINFDSN EQU   IOINFOPT                                                 11034000
IOINFVOL EQU   IOINFOPT                                                 11035000
IOINFDVT EQU   IOINFOPT                                                 11036000
OPNVOL   EQU   OPNAGL+44                                                11037000
OPNSTRNO EQU   OPNAGL+43                                                11038000
@NM00025 EQU   OPNOPT2                                                  11039000
OPNOPTJM EQU   OPNOPT2                                                  11040000
OPNOPTNM EQU   OPNOPT2                                                  11041000
OPNOPTAS EQU   OPNOPT2                                                  11042000
@NM00024 EQU   OPNDSO                                                   11043000
OPNDSOPO EQU   OPNDSO                                                   11044000
OPNDSOIS EQU   OPNDSO                                                   11045000
OPNDSOPS EQU   OPNDSO                                                   11046000
OPNDSOAM EQU   OPNDSO                                                   11047000
OPNKYL   EQU   OPNAGL+40                                                11048000
OPNBLK   EQU   OPNAGL+36                                                11049000
OPNREC   EQU   OPNAGL+32                                                11050000
OPNDEVIX EQU   OPNDEV+4                                                 11051000
OPNDEVDT EQU   OPNDEV                                                   11052000
OPNCBP   EQU   OPNAGL+20                                                11053000
OPNDSN   EQU   OPNAGL+16                                                11054000
OPNPWA   EQU   OPNAGL+12                                                11055000
OPNDDN   EQU   OPNAGL+8                                                 11056000
OPNIOC   EQU   OPNAGL+4                                                 11057000
OPNMODRP EQU   OPNMOD                                                   11058000
OPNMODUB EQU   OPNMOD                                                   11059000
OPNMODRS EQU   OPNMOD                                                   11060000
OPNMODAX EQU   OPNMOD                                                   11061000
OPNMODRR EQU   OPNMOD                                                   11062000
OPNMODRC EQU   OPNMOD                                                   11063000
OPNMODAC EQU   OPNMOD                                                   11064000
OPNMODPD EQU   OPNMOD                                                   11065000
OPNTYPSY EQU   OPNTYP                                                   11066000
OPNTYPRV EQU   OPNTYP                                                   11067000
OPNTYPEX EQU   OPNTYP                                                   11068000
OPNTYPRA EQU   OPNTYP                                                   11069000
OPNTYPXM EQU   OPNTYP                                                   11070000
OPNTYPCI EQU   OPNTYP                                                   11071000
OPNTYPSO EQU   OPNTYP                                                   11072000
OPNTYPSI EQU   OPNTYP                                                   11073000
@NM00023 EQU   OPNRFM                                                   11074000
OPNRFMBK EQU   OPNRFM                                                   11075000
OPNRFMSF EQU   OPNRFM                                                   11076000
OPNRFMUN EQU   OPNRFM                                                   11077000
OPNRFMVR EQU   OPNRFM                                                   11078000
OPNRFMFX EQU   OPNRFM                                                   11079000
OPNOPTSK EQU   OPNOPT                                                   11080000
OPNOPTDR EQU   OPNOPT                                                   11081000
OPNOPTCR EQU   OPNOPT                                                   11082000
OPNOPTKS EQU   OPNOPT                                                   11083000
OPNOPTBK EQU   OPNOPT                                                   11084000
OPNOPTUP EQU   OPNOPT                                                   11085000
OPNOPTOT EQU   OPNOPT                                                   11086000
OPNOPTIN EQU   OPNOPT                                                   11087000
IOCEXT   EQU   IOCSTR+64                                                11088000
IOCTSML  EQU   IOCREL+2                                                 11089000
IOCTPML  EQU   IOCREL                                                   11090000
IOCWORK  EQU   IOCSTR+56                                                11091000
IOCRRN   EQU   IOCSTR+52                                                11092000
IOCPNM   EQU   IOCNWM+2                                                 11093000
IOCPTL   EQU   IOCNWM                                                   11094000
IOCKYA   EQU   IOCMEM                                                   11095000
IOCVRC   EQU   IOCTTR                                                   11096000
IOCCBP   EQU   IOCSTR+36                                                11097000
IOCDSN   EQU   IOCSTR+32                                                11098000
IOCHURBA EQU   IOCSTR+28                                                11099000
IOCVOLSR EQU   IOCSTR+22                                                11100000
@NM00022 EQU   IOCMSG                                                   11101000
IOCMSGSM EQU   IOCMSG                                                   11102000
IOCMSGAE EQU   IOCMSG                                                   11103000
IOCMSGCE EQU   IOCMSG                                                   11104000
IOCMSGOE EQU   IOCMSG                                                   11105000
IOCMSGOP EQU   IOCMSG                                                   11106000
IOCCHPKG EQU   IOCMSG                                                   11107000
IOCCHPKE EQU   IOCMSG                                                   11108000
IOCCHPNU EQU   IOCCHP                                                   11109000
IOCCHPUP EQU   IOCCHP                                                   11110000
IOCCHPBK EQU   IOCCHP                                                   11111000
IOCCHPCR EQU   IOCCHP                                                   11112000
IOCCHPKS EQU   IOCCHP                                                   11113000
IOCCHPSK EQU   IOCCHP                                                   11114000
IOCCHPDR EQU   IOCCHP                                                   11115000
IOCCHPSQ EQU   IOCCHP                                                   11116000
IOCMACNT EQU   IOCMAC2                                                  11117000
IOCMACER EQU   IOCMAC2                                                  11118000
IOCMACPA EQU   IOCMAC2                                                  11119000
IOCMACEN EQU   IOCMAC2                                                  11120000
IOCMACCP EQU   IOCMAC2                                                  11121000
IOCMACRR EQU   IOCMAC2                                                  11122000
IOCMACAS EQU   IOCMAC2                                                  11123000
IOCMACSK EQU   IOCMAC2                                                  11124000
@NM00021 EQU   IOCMAC                                                   11125000
IOCMACCC EQU   IOCMAC                                                   11126000
IOCMACDR EQU   IOCMAC                                                   11127000
IOCMACBK EQU   IOCMAC                                                   11128000
IOCMACCR EQU   IOCMAC                                                   11129000
IOCMACUP EQU   IOCMAC                                                   11130000
IOCMACOT EQU   IOCMAC                                                   11131000
IOCMACIN EQU   IOCMAC                                                   11132000
@NM00020 EQU   IOCRFM                                                   11133000
IOCRFMBK EQU   IOCRFM                                                   11134000
IOCRFMSF EQU   IOCRFM                                                   11135000
IOCRFMUN EQU   IOCRFM                                                   11136000
IOCRFMVR EQU   IOCRFM                                                   11137000
IOCRFMFX EQU   IOCRFM                                                   11138000
@NM00019 EQU   IOCDSO                                                   11139000
IOCDSOPO EQU   IOCDSO                                                   11140000
IOCDSOIS EQU   IOCDSO                                                   11141000
IOCDSOPS EQU   IOCDSO                                                   11142000
IOCDSOAM EQU   IOCDSO                                                   11143000
IOCRKP   EQU   IOCSTR+13                                                11144000
IOCKYL   EQU   IOCSTR+12                                                11145000
IOCTRN   EQU   IOCSTR+8                                                 11146000
IOCDLN   EQU   IOCSTR+4                                                 11147000
IOCDAD   EQU   IOCSTR                                                   11148000
UNITVTOC EQU   UNITABL+7                                                11149000
@NM00018 EQU   UNITSTAT                                                 11150000
UNITUSHR EQU   UNITSTAT                                                 11151000
UNITXSHR EQU   UNITSTAT                                                 11152000
UNITISHR EQU   UNITSTAT                                                 11153000
UNITUA   EQU   @NM00017+1                                               11154000
UNITCHA  EQU   @NM00017                                                 11155000
UNITUCB  EQU   UNITABL                                                  11156000
RACFVOLS EQU   RACFAGL+16                                               11157000
RACFCLN  EQU   RACFAGL+12                                               11158000
RACFPROF EQU   RACFAGL+8                                                11159000
RACFENT  EQU   RACFAGL+4                                                11160000
@NM00016 EQU   RACFFLG4                                                 11161000
@NM00015 EQU   RACFFLG3                                                 11162000
RACFPRF  EQU   RACFFLG3                                                 11163000
@NM00014 EQU   RACFFLG3                                                 11164000
@NM00013 EQU   RACFFLG2                                                 11165000
RACFTRD  EQU   RACFFLG2                                                 11166000
RACFTUPD EQU   RACFFLG2                                                 11167000
RACFTCTL EQU   RACFFLG2                                                 11168000
@NM00012 EQU   RACFFLG2                                                 11169000
RACFTALT EQU   RACFFLG2                                                 11170000
RACFCSA  EQU   RACFFLG1                                                 11171000
RACFLOGN EQU   RACFFLG1                                                 11172000
RACFLOGF EQU   RACFFLG1                                                 11173000
@NM00011 EQU   RACFFLG1                                                 11174000
RACFDSTV EQU   RACFFLG1                                                 11175000
@NM00010 EQU   RACFFLG1                                                 11176000
@NM00009 EQU   ALLOPT                                                   11177000
ALLOPTUN EQU   ALLOPT                                                   11178000
ALLOPTDS EQU   ALLOPT                                                   11179000
@NM00008 EQU   ALLORG+1                                                 11180000
ALLORGVS EQU   ALLORG+1                                                 11181000
@NM00007 EQU   ALLORG+1                                                 11182000
ALLORGGS EQU   ALLORG+1                                                 11183000
ALLORGUN EQU   ALLORG                                                   11184000
ALLORGPO EQU   ALLORG                                                   11185000
ALLORGMQ EQU   ALLORG                                                   11186000
ALLORGCQ EQU   ALLORG                                                   11187000
ALLORGCX EQU   ALLORG                                                   11188000
ALLORGDA EQU   ALLORG                                                   11189000
ALLORGPS EQU   ALLORG                                                   11190000
ALLORGIS EQU   ALLORG                                                   11191000
ALLDSPUN EQU   ALLDSP                                                   11192000
ALLDSPCG EQU   ALLDSP                                                   11193000
ALLDSPDE EQU   ALLDSP                                                   11194000
ALLDSPKP EQU   ALLDSP                                                   11195000
@NM00006 EQU   ALLDSP                                                   11196000
ALLSTSOD EQU   ALLSTS                                                   11197000
ALLSTSMD EQU   ALLSTS                                                   11198000
ALLSTSNW EQU   ALLSTS                                                   11199000
ALLSTSSR EQU   ALLSTS                                                   11200000
@NM00005 EQU   ALLSTS                                                   11201000
ALLPWD   EQU   ALLAGL+20                                                11202000
ALLDSN   EQU   ALLAGL                                                   11203000
CIRPID   EQU   CIRAGL+28                                                11204000
CIRPWD   EQU   CIRAGL+24                                                11205000
CIRCAT   EQU   CIRAGL+20                                                11206000
CIRWKP   EQU   CIRAGL+16                                                11207000
CIRTLR   EQU   CIRAGL+12                                                11208000
CIRHDR   EQU   CIRAGL+8                                                 11209000
CIRTLN   EQU   CIRAGL+6                                                 11210000
CIRHLN   EQU   CIRAGL+4                                                 11211000
@NM00004 EQU   CIRAGL+1                                                 11212000
@NM00003 EQU   CIRTYPE                                                  11213000
CIRTYPAQ EQU   CIRTYPE                                                  11214000
CIRTYP1Q EQU   CIRTYPE                                                  11215000
NEWID1   EQU   TRACE1+95                                                11216000
CALLID   EQU   OLDERID1+90                                              11217000
@NM00002 EQU   OLDERID1                                                 11218000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      11219000
@RT00439 EQU   @RC00438                                                 11220000
@RF00492 EQU   @RC00484                                                 11221000
@RF00600 EQU   @RC00594                                                 11222000
@RC00659 EQU   @RC00652                                                 11223000
@RF00773 EQU   @RC00734                                                 11224000
@RC00765 EQU   @RC00734                                                 11225000
@RF00893 EQU   @RC00884                                                 11226000
@RF00892 EQU   @RC00884                                                 11227000
@RF00897 EQU   @RC00874                                                 11228000
@RF00927 EQU   @RC00919                                                 11229000
@RF00973 EQU   @RC00970                                                 11230000
@RC01006 EQU   @RC00996                                                 11231000
@RF01009 EQU   @RC00996                                                 11232000
@RC01027 EQU   @RC00996                                                 11233000
@RC01121 EQU   @RC01120                                                 11234000
@RF01245 EQU   @RC01242                                                 11235000
@RC01238 EQU   @RC01201                                                 11236000
@RC01236 EQU   @RC01201                                                 11237000
@RC01326 EQU   @RC01311                                                 11238000
@RF01533 EQU   @RC01527                                                 11239000
@RF01710 EQU   @RC01700                                                 11240000
@RF01724 EQU   @RC01721                                                 11241000
@RF02196 EQU   @RC02181                                                 11242000
@PB00024 EQU   @EL00001                                                 11243000
@RC01122 EQU   @RC01121                                                 11244000
@PB00023 EQU   @PB00024                                                 11245000
@PB00022 EQU   @PB00023                                                 11246000
@PB00021 EQU   @PB00022                                                 11247000
@PB00020 EQU   @PB00021                                                 11248000
@PB00019 EQU   @PB00020                                                 11249000
@PB00018 EQU   @PB00019                                                 11250000
@PB00017 EQU   @PB00018                                                 11251000
@PB00016 EQU   @PB00017                                                 11252000
@PB00015 EQU   @PB00016                                                 11253000
@PB00014 EQU   @PB00015                                                 11254000
@PB00013 EQU   @PB00014                                                 11255000
@PB00012 EQU   @PB00013                                                 11256000
@PB00011 EQU   @PB00012                                                 11257000
@PB00010 EQU   @PB00011                                                 11258000
@PB00009 EQU   @PB00010                                                 11259000
@PB00008 EQU   @PB00009                                                 11260000
@PB00007 EQU   @PB00008                                                 11261000
@PB00006 EQU   @PB00007                                                 11262000
@PB00005 EQU   @PB00006                                                 11263000
@PB00004 EQU   @PB00005                                                 11264000
@PB00003 EQU   @PB00004                                                 11265000
@PB00002 EQU   @PB00003                                                 11266000
@ENDDATA EQU   *                                                        11267000
         END   IDCAV01,(C'PLS2253',0603,77067)                          11268000
