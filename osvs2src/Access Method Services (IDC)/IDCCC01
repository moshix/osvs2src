         TITLE '****  IDCCC01:  CONVERT CATALOG FUNCTION SUPPORT ROUTIN*00001000
               NE  **** '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCC01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCC01   75.039'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @10,0                                               0002 00021000
@PSTART  LA    @11,4095(,@10)                                      0002 00022000
         LA    @12,4095(,@11)                                      0002 00023000
         USING @PSTART,@10                                         0002 00024000
         USING @PSTART+4095,@11                                    0002 00025000
         USING @PSTART+8190,@12                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @09,@01                                             0002 00029000
         USING @DATD,@09                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @09,8(,@13)                                         0002 00033000
         LR    @13,@09                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
*                                      /*MSG PRINTED FLAG    @YL026UD*/ 00036000
*        /************************************************************/ 00037000
*        /*                                                  @YL026UD*/ 00038000
*        /*  ZERO POINTER TO 'DNAME' VALUE OF THE 'CATALOG'  @YL026UD*/ 00039000
*        /*  PARAMETER (IF SPECIFIED) -                      @YL026UD*/ 00040000
*        /*                                                  @YL026UD*/ 00041000
*        /*  THE 'DNAME' VALUE IS NOT NEEDED TO FOR THE      @YL026UD*/ 00042000
*        /*  'UOPEN' REQUEST FOR VS2 RELEASE 2 (BECAUSE      @YL026UD*/ 00043000
*        /*  OF DYNAMIC ALLOCATION), BUT IS ALLOWED ON THE   @YL026UD*/ 00044000
*        /*  'CNVTCAT' COMMAND TO BE COMPATIBLE WITH OTHER   @YL026UD*/ 00045000
*        /*  AMS COMMANDS FOR PREVIOUS VS1 AND VS2 RELEASES  @YL026UD*/ 00046000
*        /*                                                  @YL026UD*/ 00047000
*        /************************************************************/ 00048000
*                                                                  0197 00049000
*        FDTPTR(5) = NULLPTR;                              /*@Y30SSMK*/ 00050000
*                                                                  0197 00051000
         SLR   @07,@07                                             0197 00052000
         L     @05,@PC00001+4                                      0197 00053000
         ST    @07,FDTPTR+16(,@05)                                 0197 00054000
*        /************************************************************/ 00055000
*        /*                                                  @YL026UD*/ 00056000
*        /*  INITIALIZE 'UPRINT' MACRO ARGUMENT LIST         @YL026UD*/ 00057000
*        /*                                                  @YL026UD*/ 00058000
*        /************************************************************/ 00059000
*                                                                  0198 00060000
*        DDSTRU = ADDR(PRNTLIST);                          /*@YL026UD*/ 00061000
         LA    @15,PRNTLIST                                        0198 00062000
         ST    @15,DDSTRU                                          0198 00063000
*        PRNTLIST = '00'X;                                 /*@YL026UD*/ 00064000
*                                                                  0199 00065000
         XC    PRNTLIST+1(19),PRNTLIST+1                           0199 00066000
         MVI   PRNTLIST,X'00'                                      0199 00067000
*        LASTMSG = OFF;                                    /*@YL026UD*/ 00068000
*                                                                  0200 00069000
*                                                                  0200 00070000
         NI    LASTMSG,B'01111111'                                 0200 00071000
*        /************************************************************/ 00072000
*        /*                                                  @YL026UD*/ 00073000
*        /*  OPEN THE INPUT DATA SET -                       @YL026UD*/ 00074000
*        /*                                                  @YL026UD*/ 00075000
*        /*  THE INPUT DATA SET (OS CATALOG 'SYSCTLG'        @YL026UD*/ 00076000
*        /*  DATA SET) IS OPENED FOR BSAM PROCESSING         @YL026UD*/ 00077000
*        /*                                                  @YL026UD*/ 00078000
*        /*  THE INPUT DATA SET IS REFERENCED VIA THE        @YL026UD*/ 00079000
*        /*  'INFILE' (DD CARD) OR 'INDATASET'               @YL026UD*/ 00080000
*        /*  (DYNAMIC ALLOCATION) PARAMETER                  @YL026UD*/ 00081000
*        /*                                                  @YL026UD*/ 00082000
*        /*  INITIALIZE INPUT 'UOPEN' MACRO ARGUMENT LIST    @YL026UD*/ 00083000
*        /*                                                  @YL026UD*/ 00084000
*        /************************************************************/ 00085000
*                                                                  0201 00086000
*        OPNPTR = ADDR(IOPENARG);                          /*@YL026UD*/ 00087000
         LA    OPNPTR,IOPENARG                                     0201 00088000
*        IOPENARG = '00'X;                                 /*@YL026UD*/ 00089000
*                                                                  0202 00090000
         XC    IOPENARG+1(43),IOPENARG+1                           0202 00091000
         MVI   IOPENARG,X'00'                                      0202 00092000
*        OPNOPTIN = ON;                                    /*@YL026UD*/ 00093000
*        OPNOPTBK = ON;                                    /*@YL026UD*/ 00094000
         OI    OPNOPTIN(OPNPTR),B'10010000'                        0204 00095000
*        OPNRFMFX = ON;                                    /*@YL026UD*/ 00096000
*        OPNRFMBK = ON;                                    /*@YL026UD*/ 00097000
         OI    OPNRFMFX(OPNPTR),B'10001000'                        0206 00098000
*        OPNIOC   = ADDR(IIOCSPTR);                        /*@YL026UD*/ 00099000
*                                                                  0207 00100000
         LA    @15,IIOCSPTR                                        0207 00101000
         ST    @15,OPNIOC(,OPNPTR)                                 0207 00102000
*        IF ADDR(IFILE) ^= NULLPTR                                 0208 00103000
*          THEN                                                    0208 00104000
         L     @05,FDTPTR(,@05)                                    0208 00105000
         CR    @05,@07                                             0208 00106000
         BE    @RF00208                                            0208 00107000
*            OPNDDN = ADDR(IFILEVAL);                      /*@YL026UD*/ 00108000
*                                                                  0209 00109000
         LA    @07,IFILEVAL(,@05)                                  0209 00110000
         ST    @07,OPNDDN(,OPNPTR)                                 0209 00111000
*        IF ADDR(IDS) ^= NULLPTR                                   0210 00112000
*          THEN                                                    0210 00113000
@RF00208 L     @07,@PC00001+4                                      0210 00114000
         L     @07,FDTPTR+4(,@07)                                  0210 00115000
         LTR   @07,@07                                             0210 00116000
         BZ    @RF00210                                            0210 00117000
*            OPNDSN = ADDR(IDSVAL);                        /*@YL026UD*/ 00118000
*                                                                  0211 00119000
         LA    @07,IDSVAL(,@07)                                    0211 00120000
         ST    @07,OPNDSN(,OPNPTR)                                 0211 00121000
*        OPNBLK = BLKSIZE;                                 /*@Y30SSMK*/ 00122000
@RF00210 MVC   OPNBLK(4,OPNPTR),@CF00823                           0212 00123000
*        OPNDSOPS = ON;                                    /*@YL026UD*/ 00124000
*                                                                  0213 00125000
         OI    OPNDSOPS(OPNPTR),B'01000000'                        0213 00126000
*        /************************************************************/ 00127000
*        /*                                                  @YL026UD*/ 00128000
*        /*  OPEN THE INPUT DATA SET ('UOPEN' MACRO)         @YL026UD*/ 00129000
*        /*                                                  @YL026UD*/ 00130000
*        /************************************************************/ 00131000
*                                                                  0214 00132000
*        CALL IDCIOOP0(GDTTBL,IOPENARG);                   /*@YL026UD*/ 00133000
*                                                                  0214 00134000
         L     @07,@PC00001                                        0214 00135000
         ST    @07,@AL00001                                        0214 00136000
         LA    @02,IOPENARG                                        0214 00137000
         ST    @02,@AL00001+4                                      0214 00138000
         MVI   @AL00001+4,X'80'                                    0214 00139000
         L     @15,GDTOPN(,@07)                                    0214 00140000
         LA    @01,@AL00001                                        0214 00141000
         BALR  @14,@15                                             0214 00142000
*        RESPECIFY RTNREG RSTD;                                    0215 00143000
*        TESTRC = RTNREG;                                          0216 00144000
         LR    TESTRC,RTNREG                                       0216 00145000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 00146000
*                                                                  0217 00147000
*        IF TESTRC ^= 0                                            0218 00148000
*          THEN                                                    0218 00149000
         SLR   @07,@07                                             0218 00150000
         CR    TESTRC,@07                                          0218 00151000
         BE    @RF00218                                            0218 00152000
*            DO;                                           /*@YL026UD*/ 00153000
*              /******************************************************/ 00154000
*              /*                                            @YL026UD*/ 00155000
*              /*  UNSUCCESSFUL OPEN OF INPUT DATA SET -     @YL026UD*/ 00156000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 00157000
*              /*                                            @YL026UD*/ 00158000
*              /******************************************************/ 00159000
*                                                                  0220 00160000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 00161000
*                                                                  0220 00162000
         L     @05,@PC00001+8                                      0220 00163000
         MVC   LASTCOND(2,@05),@CH00037                            0220 00164000
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/ 00165000
*                                                                  0221 00166000
         L     @05,DDSTRU                                          0221 00167000
         MVC   DARGSMOD(3,@05),@CC00849                            0221 00168000
*              /******************************************************/ 00169000
*              /*                                            @Y30SSMK*/ 00170000
*              /*  IN A TSO ENVIRONMENT, THE LASTCC MESSAGE  @Y30SSMK*/ 00171000
*              /*  WILL BE PRINTED OUT.  THE FUNCTION        @Y30SSMK*/ 00172000
*              /*  TERMINATED MESSAGE WILL BE PRINTED OUT    @Y30SSMK*/ 00173000
*              /*  FOR BACKGROUND PROCESSING.                @Y30SSMK*/ 00174000
*              /*                                            @Y30SSMK*/ 00175000
*              /******************************************************/ 00176000
*                                                                  0222 00177000
*              IF GDTECT ^= NULLPTR                                0222 00178000
*                THEN                                              0222 00179000
         L     @02,@PC00001                                        0222 00180000
         C     @07,GDTECT(,@02)                                    0222 00181000
         BE    @RF00222                                            0222 00182000
*                  DARGSENT = LSCCMSG#;                    /*@Y30SSMK*/ 00183000
         MVI   DARGSENT(@05),X'0F'                                 0223 00184000
*                ELSE                                              0224 00185000
*                  DARGSENT = TERMMSG#;                    /*@YL026UD*/ 00186000
*                                                                  0224 00187000
         B     @RC00222                                            0224 00188000
@RF00222 L     @07,DDSTRU                                          0224 00189000
         MVI   DARGSENT(@07),X'03'                                 0224 00190000
*              DARGDBP = ADDR(LASTCOND);                   /*@YL026UD*/ 00191000
@RC00222 L     @07,DDSTRU                                          0225 00192000
         L     @05,@PC00001+8                                      0225 00193000
         ST    @05,DARGDBP(,@07)                                   0225 00194000
*              DARGILP = LENGTH(LASTCOND);                 /*@YL026UD*/ 00195000
*                                                                  0226 00196000
         MVC   DARGILP(2,@07),@CH00149                             0226 00197000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 00198000
*                                                                  0227 00199000
         L     @07,@PC00001                                        0227 00200000
         ST    @07,@AL00001                                        0227 00201000
         LA    @05,@CF00113                                        0227 00202000
         ST    @05,@AL00001+4                                      0227 00203000
         LA    @05,DDSTRU                                          0227 00204000
         ST    @05,@AL00001+8                                      0227 00205000
         MVI   @AL00001+8,X'80'                                    0227 00206000
         L     @15,GDTPRT(,@07)                                    0227 00207000
         LA    @01,@AL00001                                        0227 00208000
         BALR  @14,@15                                             0227 00209000
*              CALL IDCSAEP0(GDTTBL,MODID);                        0228 00210000
         L     @07,@PC00001                                        0228 00211000
         ST    @07,@AL00001                                        0228 00212000
         LA    @05,MODID                                           0228 00213000
         ST    @05,@AL00001+4                                      0228 00214000
         MVI   @AL00001+4,X'80'                                    0228 00215000
         L     @15,GDTEPL(,@07)                                    0228 00216000
         LA    @01,@AL00001                                        0228 00217000
         BALR  @14,@15                                             0228 00218000
*                                                          /*@YL026UD*/ 00219000
*                                                                  0229 00220000
*            END;                                          /*@YL026UD*/ 00221000
*                                                                  0229 00222000
*        /************************************************************/ 00223000
*        /*                                                  @YL026UD*/ 00224000
*        /*  CONVERT THE OS CATALOG ENTRIES TO               @YL026UD*/ 00225000
*        /*  VSAM CATALOG ENTRIES                            @YL026UD*/ 00226000
*        /*                                                  @YL026UD*/ 00227000
*        /************************************************************/ 00228000
*                                                                  0230 00229000
*        CALL CONVERT;                                     /*@YL026UD*/ 00230000
*                                                                  0230 00231000
@RF00218 BAL   @14,CONVERT                                         0230 00232000
*        /************************************************************/ 00233000
*        /*                                                  @YL026UD*/ 00234000
*        /*  CLOSE THE INPUT DATA SET                        @YL026UD*/ 00235000
*        /*  ('UCLOSE' MACRO)                                @YL026UD*/ 00236000
*        /*  IF CLOSE IS NOT SUCCESSFUL, UPDATE THE LAST     @Y30SSMK*/ 00237000
*        /*  CONDITION CODE.                                 @Y30SSMK*/ 00238000
*        /*                                                  @YL026UD*/ 00239000
*        /************************************************************/ 00240000
*                                                                  0231 00241000
*        CALL IDCIOCL0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 00242000
*                                                                  0231 00243000
         L     @08,@PC00001                                        0231 00244000
         ST    @08,@AL00001                                        0231 00245000
         LA    @04,IIOCSPTR                                        0231 00246000
         ST    @04,@AL00001+4                                      0231 00247000
         MVI   @AL00001+4,X'80'                                    0231 00248000
         L     @15,GDTCLS(,@08)                                    0231 00249000
         LA    @01,@AL00001                                        0231 00250000
         BALR  @14,@15                                             0231 00251000
*        RESPECIFY RTNREG RSTD;                                    0232 00252000
*        TESTRC = RTNREG;                                          0233 00253000
         LR    TESTRC,RTNREG                                       0233 00254000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 00255000
*                                                                  0234 00256000
*        IF TESTRC ^= 0                                            0235 00257000
*          THEN                                                    0235 00258000
         LTR   TESTRC,TESTRC                                       0235 00259000
         BZ    @RF00235                                            0235 00260000
*            LASTCOND = MAX(LASTCOND,LASTCC04);            /*@YL026UD*/ 00261000
*                                                                  0236 00262000
         L     @08,@PC00001+8                                      0236 00263000
         LH    @15,LASTCOND(,@08)                                  0236 00264000
         LA    @14,4                                               0236 00265000
         CR    @15,@14                                             0236 00266000
         BNL   *+6                                                      00267000
         LR    @15,@14                                             0236 00268000
         STH   @15,LASTCOND(,@08)                                  0236 00269000
*        /************************************************************/ 00270000
*        /*                                                  @YL026UD*/ 00271000
*        /*  FREE STORAGE HELD BY SYSCTLG INDEX BLOCKS       @YL026UD*/ 00272000
*        /*  FREE STORAGE HELD BY CPL/FVT/FPL LISTS          @YL026UD*/ 00273000
*        /*  FREE STORAGE HELD BY VOLUME INFORMATION LISTS   @YL026UD*/ 00274000
*        /*  FREE STORAGE HELD BY CATALOG WORKAREA           @YL026UD*/ 00275000
*        /*  ('UFPOOL' MACRO)                                @YL026UD*/ 00276000
*        /*                                                  @YL026UD*/ 00277000
*        /************************************************************/ 00278000
*                                                                  0237 00279000
*        CALL IDCSAFP0(GDTTBL,POOLID);                     /*@YL026UD*/ 00280000
*                                                                  0237 00281000
@RF00235 L     @08,@PC00001                                        0237 00282000
         ST    @08,@AL00001                                        0237 00283000
         LA    @15,@CC00862                                        0237 00284000
         ST    @15,@AL00001+4                                      0237 00285000
         MVI   @AL00001+4,X'80'                                    0237 00286000
         L     @15,GDTFPL(,@08)                                    0237 00287000
         LA    @01,@AL00001                                        0237 00288000
         BALR  @14,@15                                             0237 00289000
*        /************************************************************/ 00290000
*        /*                                                  @YL026UD*/ 00291000
*        /*  PRINT THE 'CNVTCAT' FUNCTION COMPLETION MESSAGE @YL026UD*/ 00292000
*        /*  (IF NOT ALREADY PRINTED - I.E., 'INSUFFICIENT   @YL026UD*/ 00293000
*        /*  STORAGE' TERMINATION MESSAGE)                   @YL026UD*/ 00294000
*        /*  IN A TSO ENVIRONMENT, PRINT THE LASTCC MESSAGE  @Y30SSMK*/ 00295000
*        /*  ONLY IF THE FINAL CONDITION CODE IS GREATER     @Y30SSMK*/ 00296000
*        /*  THAN 0.                                         @Y30SSMK*/ 00297000
*        /*                                                  @YL026UD*/ 00298000
*        /************************************************************/ 00299000
*                                                                  0238 00300000
*        IF LASTMSG = OFF                                          0238 00301000
*          THEN                                                    0238 00302000
         TM    LASTMSG,B'10000000'                                 0238 00303000
         BNZ   @RF00238                                            0238 00304000
*            IF GDTECT ^= NULLPTR                                  0239 00305000
*              THEN                                                0239 00306000
         SLR   @08,@08                                             0239 00307000
         L     @15,@PC00001                                        0239 00308000
         C     @08,GDTECT(,@15)                                    0239 00309000
         BE    @RF00239                                            0239 00310000
*                DO;                                       /*@Y30SSMK*/ 00311000
*                  IF LASTCOND > 0                                 0241 00312000
*                    THEN                                          0241 00313000
         L     @14,@PC00001+8                                      0241 00314000
         CH    @08,LASTCOND(,@14)                                  0241 00315000
         BNL   @RF00241                                            0241 00316000
*                      DO;                                 /*@Y30SSMK*/ 00317000
*                        DARGSMOD = UNIVMSG;               /*@Y30SSMK*/ 00318000
         L     @08,DDSTRU                                          0243 00319000
         MVC   DARGSMOD(3,@08),@CC00849                            0243 00320000
*                        DARGSENT = LSCCMSG#;              /*@Y30SSMK*/ 00321000
         MVI   DARGSENT(@08),X'0F'                                 0244 00322000
*                        DARGDBP = ADDR(LASTCOND);         /*@Y30SSMK*/ 00323000
         ST    @14,DARGDBP(,@08)                                   0245 00324000
*                        DARGILP = LENGTH(LASTCOND);       /*@Y30SSMK*/ 00325000
*                                                                  0246 00326000
         MVC   DARGILP(2,@08),@CH00149                             0246 00327000
*                        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     0247 00328000
         ST    @15,@AL00001                                        0247 00329000
         LA    @08,@CF00113                                        0247 00330000
         ST    @08,@AL00001+4                                      0247 00331000
         LA    @08,DDSTRU                                          0247 00332000
         ST    @08,@AL00001+8                                      0247 00333000
         MVI   @AL00001+8,X'80'                                    0247 00334000
         L     @15,GDTPRT(,@15)                                    0247 00335000
         LA    @01,@AL00001                                        0247 00336000
         BALR  @14,@15                                             0247 00337000
*                                                          /*@Y30SSMK*/ 00338000
*                      END;                                /*@Y30SSMK*/ 00339000
*                END;                                      /*@Y30SSMK*/ 00340000
*              ELSE                                                0250 00341000
*                DO;                                       /*@Y30SSMK*/ 00342000
         B     @RC00239                                            0250 00343000
@RF00239 DS    0H                                                  0251 00344000
*                  IF LASTCOND < LASTCC12                          0251 00345000
*                    THEN                                          0251 00346000
         L     @08,@PC00001+8                                      0251 00347000
         LH    @08,LASTCOND(,@08)                                  0251 00348000
         C     @08,@CF00037                                        0251 00349000
         BNL   @RF00251                                            0251 00350000
*                      DARGSENT = END0MSG#;                /*@Y30SSMK*/ 00351000
         L     @08,DDSTRU                                          0252 00352000
         MVI   DARGSENT(@08),X'01'                                 0252 00353000
*                    ELSE                                          0253 00354000
*                      DARGSENT = TERMMSG#;                /*@Y30SSMK*/ 00355000
*                                                                  0253 00356000
         B     @RC00251                                            0253 00357000
@RF00251 L     @08,DDSTRU                                          0253 00358000
         MVI   DARGSENT(@08),X'03'                                 0253 00359000
*                  DARGSMOD = UNIVMSG;                     /*@Y30SSMK*/ 00360000
@RC00251 L     @08,DDSTRU                                          0254 00361000
         MVC   DARGSMOD(3,@08),@CC00849                            0254 00362000
*                  DARGDBP = ADDR(LASTCOND);               /*@Y30SSMK*/ 00363000
         L     @15,@PC00001+8                                      0255 00364000
         ST    @15,DARGDBP(,@08)                                   0255 00365000
*                  DARGILP = LENGTH(LASTCOND);             /*@Y30SSMK*/ 00366000
*                                                                  0256 00367000
         MVC   DARGILP(2,@08),@CH00149                             0256 00368000
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   /*@Y30SSMK*/ 00369000
         L     @08,@PC00001                                        0257 00370000
         ST    @08,@AL00001                                        0257 00371000
         LA    @15,@CF00113                                        0257 00372000
         ST    @15,@AL00001+4                                      0257 00373000
         LA    @15,DDSTRU                                          0257 00374000
         ST    @15,@AL00001+8                                      0257 00375000
         MVI   @AL00001+8,X'80'                                    0257 00376000
         L     @15,GDTPRT(,@08)                                    0257 00377000
         LA    @01,@AL00001                                        0257 00378000
         BALR  @14,@15                                             0257 00379000
*                END;                                      /*@Y30SSMK*/ 00380000
*                                                                  0258 00381000
*                                                                  0258 00382000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0259 00383000
@RC00239 DS    0H                                                  0259 00384000
@RF00238 L     @08,@PC00001                                        0259 00385000
         ST    @08,@AL00001                                        0259 00386000
         LA    @15,MODID                                           0259 00387000
         ST    @15,@AL00001+4                                      0259 00388000
         MVI   @AL00001+4,X'80'                                    0259 00389000
         L     @15,GDTEPL(,@08)                                    0259 00390000
         LA    @01,@AL00001                                        0259 00391000
         BALR  @14,@15                                             0259 00392000
*                                                          /*@YL026UD*/ 00393000
*/********************************************************************/ 00394000
*/*                                                          @YL026UD*/ 00395000
*/*  PROCEDURE NAME - CONVERT                                @YL026UD*/ 00396000
*/*                                                          @YL026UD*/ 00397000
*/*  FUNCTION - TO CONVERT THE OS CATALOG ENTRIES INTO       @YL026UD*/ 00398000
*/*             'NONVSAM', 'ALIAS', OR 'GDG BASE' ENTRIES    @YL026UD*/ 00399000
*/*             IN THE VSAM USER OR MASTER CATALOG           @YL026UD*/ 00400000
*/*                                                          @YL026UD*/ 00401000
*/*             THE SYSCTLG DATA SET IS SCANNED (BEGINNING   @YL026UD*/ 00402000
*/*             WITH THE VOLUME INDEX) TO OBTAIN AND BUILD   @YL026UD*/ 00403000
*/*             COMPLETE DATA SET NAMES TO BE DEFINED IN     @YL026UD*/ 00404000
*/*             THE VSAM CATALOG                             @YL026UD*/ 00405000
*/*                                                          @YL026UD*/ 00406000
*/*  INPUT - THE OS CATALOG ('SYSCTLG' DATA SET)             @YL026UD*/ 00407000
*/*          CONTAINING THE ENTRIES TO BE CONVERTED          @YL026UD*/ 00408000
*/*                                                          @YL026UD*/ 00409000
*/*  OUTPUT - THE VSAM USER CATALOG CONTAINING THE           @YL026UD*/ 00410000
*/*           CONVERTED CATALOG ENTRIES                      @YL026UD*/ 00411000
*/*                                                          @YL026UD*/ 00412000
*/********************************************************************/ 00413000
*                                                                  0260 00414000
*CONVERT: PROCEDURE;                                       /*@YL026UD*/ 00415000
@EL00001 L     @13,4(,@13)                                         0260 00416000
@EF00001 L     @00,@SIZDATD                                        0260 00417000
         LR    @01,@09                                             0260 00418000
         FREEMAIN R,LV=(0),A=(1)                                        00419000
@ER00001 LM    @14,@12,12(@13)                                     0260 00420000
         BR    @14                                                 0260 00421000
CONVERT  STM   @14,@12,@SA00002                                    0260 00422000
*        /************************************************************/ 00423000
*        /*                                                  @YL026UD*/ 00424000
*        /*  'SYSCTLG' DATA SET ENTRY TYPE CODES             @YL026UD*/ 00425000
*        /*                                                  @YL026UD*/ 00426000
*        /************************************************************/ 00427000
*                                                                  0261 00428000
*        /*  ALIAS ENTRY (AE) TYPE CODE                      @YL026UD*/ 00429000
*        DCL TYPEAE      BIT(8) BDY(BYTE) INIT('04'X);     /*@YL026UD*/ 00430000
*                                                                  0261 00431000
*        /*  CONTROL VOLUME POINTER ENTRY (CVPE) ENTRY CODES @YL026UD*/ 00432000
*        DCL TYPECVPE(2) BIT(8) BDY(BYTE) INIT('03'X,'05'X);       0262 00433000
*                                                                  0262 00434000
*        /*  DATA SET POINTER ENTRY (DSPE) TYPE CODES        @YL026UD*/ 00435000
*        DCL TYPEDSPE(5) BIT(8) BDY(BYTE) INIT('07'X,'0D'X,        0263 00436000
*                                              '13'X,'19'X,        0263 00437000
*                                              '1F'X);     /*@YL026UD*/ 00438000
*                                                                  0263 00439000
*        /*  GENERATION INDEX POINTER ENTRY (GIPE) TYPE CODE @YL026UD*/ 00440000
*        DCL TYPEGIPE    BIT(8) BDY(BYTE) INIT('02'X);     /*@YL026UD*/ 00441000
*                                                                  0264 00442000
*        /*  INDEX CONTROL ENTRY (ICE) TYPE CODE             @YL026UD*/ 00443000
*        /*  (ENTRY NAME = '00...01'X)                       @YL026UD*/ 00444000
*        DCL TYPEICE     BIT(8) BDY(BYTE) INIT('03'X);     /*@YL026UD*/ 00445000
*                                                                  0265 00446000
*        /*  INDEX LINK ENTRY (ILE) TYPE CODE                @YL026UD*/ 00447000
*        /*  (ENTRY NAME = 'FF...FF'X)                       @YL026UD*/ 00448000
*        DCL TYPEILE     BIT(8) BDY(BYTE) INIT('00'X);     /*@YL026UD*/ 00449000
*                                                                  0266 00450000
*        /*  INDEX POINTER ENTRY (IPE) TYPE CODE             @YL026UD*/ 00451000
*        DCL TYPEIPE     BIT(8) BDY(BYTE) INIT('00'X);     /*@YL026UD*/ 00452000
*                                                                  0267 00453000
*        /*  VOLUME CONTROL BLOCK POINTER ENTRY (VCBPE)      @YL026UD*/ 00454000
*        /*  TYPE CODE                                       @YL026UD*/ 00455000
*        DCL TYPEVCBP    BIT(8) BDY(BYTE) INIT('01'X);     /*@YL026UD*/ 00456000
*                                                                  0268 00457000
*        /*  VOLUME INDEX CONTROL ENTRY (VICE) TYPE CODE     @YL026UD*/ 00458000
*        /*  (ENTRY NAME = '00...01'X)                       @YL026UD*/ 00459000
*        DCL TYPEVICE    BIT(8) BDY(BYTE) INIT('05'X);     /*@YL026UD*/ 00460000
*                                                                  0269 00461000
*                                                                  0269 00462000
*        /************************************************************/ 00463000
*        /*                                                  @YL026UD*/ 00464000
*        /*  'SYSCTLG' DATA SET ENTRY FORMATS                @YL026UD*/ 00465000
*        /*                                                  @YL026UD*/ 00466000
*        /************************************************************/ 00467000
*                                                                  0270 00468000
*        DCL CATPTR          PTR(31);  /*CATALOG ENTRY       @YL026UD*/ 00469000
*                                      /*BASE POINTER        @YL026UD*/ 00470000
*                                                                  0271 00471000
*        /*  SYSCTLG BASIC ENTRY FORMAT                      @YL026UD*/ 00472000
*        DCL 1 CATFORM        CHAR(12)  BDY(WORD)  BASED(CATPTR),  0271 00473000
*              2 CATENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00474000
*              2 CATETTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/ 00475000
*              2 CATETYPE     BIT(8);  /*ENTRY TYPE CODE     @YL026UD*/ 00476000
*                                                                  0271 00477000
*        /*  ALIAS ENTRY (AE) FORMAT                         @YL026UD*/ 00478000
*        DCL 1 AEFORM         CHAR(20)  BDY(WORD)  BASED(CATPTR),  0272 00479000
*              2 AENAME       CHAR(8), /*ALIAS NAME          @YL026UD*/ 00480000
*              2 AETTR        CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/ 00481000
*              2 AETYPE       BIT(8),  /*ALIAS ENTRY TYPE    @YL026UD*/ 00482000
*              2 AETRUEN      CHAR(8); /*TRUE NAME OF ENTRY  @YL026UD*/ 00483000
*                                                                  0272 00484000
*        /*  'OLD' CONTROL VOLUME POINTER ENTRY (CVPE) FORM  @YL026UD*/ 00485000
*        DCL 1 CVP1FORM       CHAR(18)  BDY(WORD)  BASED(CATPTR),  0273 00486000
*              2 CVP1NAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00487000
*              2 CVP1TTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/ 00488000
*              2 CVP1TYPE     BIT(8),  /*OLD CVPE TYPE       @YL026UD*/ 00489000
*              2 CVP1VOL      CHAR(6); /*CVOL SERIAL NUMBER  @YL026UD*/ 00490000
*                                                                  0273 00491000
*        /*  'NEW' CONTROL VOLUME POINTER ENTRY (CVPE) FORM  @YL026UD*/ 00492000
*        DCL 1 CVP2FORM       CHAR(22)  BDY(WORD)  BASED(CATPTR),  0274 00493000
*              2 CVP2NAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00494000
*              2 CVP2TTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/ 00495000
*              2 CVP2TYPE     BIT(8),  /*NEW CVPE TYPE       @YL026UD*/ 00496000
*              2 CVP2VTYP     FIXED(32),/*CVOL DEVICE TYPE   @YL026UD*/ 00497000
*              2 CVP2VOL      CHAR(6); /*CVOL SERIAL NUMBER  @YL026UD*/ 00498000
*                                                                  0274 00499000
*        /*  DATA SET POINTER ENTRY (DSPE) FORMAT            @YL026UD*/ 00500000
*        DCL 1 DSPEFORM       CHAR(74)  BDY(WORD)  BASED(CATPTR),  0275 00501000
*              2 DSPENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00502000
*              2 DSPETTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/ 00503000
*              2 DSPETYPE     BIT(8),  /*DSPE ENTRY TYPE     @YL026UD*/ 00504000
*              2 DSPEVCNT     FIXED(15),/*VOLUME COUNT       @YL026UD*/ 00505000
*              2 DSPEDATA(5)  CHAR(12),/*VOLUME ENTRIES LIST @YL026UD*/ 00506000
*                3 DSPEDEVT   CHAR(4), /*DEVICE CODE         @YL026UD*/ 00507000
*                3 DSPEDVOL   CHAR(6), /*VOLUME SERIAL       @YL026UD*/ 00508000
*                3 DSPEDSEQ   CHAR(2); /*FILE SEQUENCE       @YL026UD*/ 00509000
*                                                                  0275 00510000
*        /*  GENERATION INDEX POINTER ENTRY (GIPE) FORMAT    @YL026UD*/ 00511000
*        DCL 1 GIPEFORM       CHAR(16)  BDY(WORD)  BASED(CATPTR),  0276 00512000
*              2 GIPENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00513000
*              2 GIPETTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/ 00514000
*              2 GIPETYPE     BIT(8),  /*GIPE ENTRY TYPE     @YL026UD*/ 00515000
*              2 GIPEFLGS     BIT(8),  /*GDG OPTION FLAGS    @YL026UD*/ 00516000
*                3 *          BIT(6),  /*  RESERVED FLAGS    @YL026UD*/ 00517000
*                3 GIPEFDEL   BIT(1),  /*  'DELETE' OPTION   @YL026UD*/ 00518000
*                3 GIPEFEMP   BIT(1),  /*  'EMPTY'  OPTION   @YL026UD*/ 00519000
*              2 GIPEMCNT     FIXED(8),/*MAXIMUM GENERATION  @YL026UD*/ 00520000
*              2 GIPECCNT     FIXED(15);/*CURRENT GENERATION @YL026UD*/ 00521000
*                                                                  0276 00522000
*        /*  INDEX CONTROL ENTRY (ICE) FORMAT                @YL026UD*/ 00523000
*        DCL 1 ICEFORM        CHAR(18)  BDY(WORD)  BASED(CATPTR),  0277 00524000
*              2 ICENAME      CHAR(8), /*ENTRY NAME          @YL026UD*/ 00525000
*              2 ICELBLK      CHAR(3), /*LAST  BLOCK ADDR    @YL026UD*/ 00526000
*              2 ICETYPE      BIT(8),  /*ICE ENTRY TYPE      @YL026UD*/ 00527000
*              2 ICEFBLK      CHAR(3), /*FIRST BLOCK ADDR    @YL026UD*/ 00528000
*              2 ICEACNT      FIXED(8),/*NUMBER OF ALIASES   @YL026UD*/ 00529000
*              2 *            CHAR(2); /*RESERVED            @YL026UD*/ 00530000
*                                                                  0277 00531000
*        /*  INDEX LINK ENTRY (ILE) FORMAT                   @YL026UD*/ 00532000
*        DCL 1 ILEFORM        CHAR(12)  BDY(WORD)  BASED(CATPTR),  0278 00533000
*              2 ILENAME      CHAR(8), /*ENTRY NAME          @YL026UD*/ 00534000
*              2 ILETTR       CHAR(3), /*LINK ADDRESS (TTR)  @YL026UD*/ 00535000
*              2 ILETYPE      BIT(8);  /*ILE ENTRY TYPE      @YL026UD*/ 00536000
*                                                                  0278 00537000
*        /*  INDEX POINTER ENTRY (IPE) FORMAT                @YL026UD*/ 00538000
*        DCL 1 IPEFORM        CHAR(12)  BDY(WORD)  BASED(CATPTR),  0279 00539000
*              2 IPENAME      CHAR(8), /*ENTRY NAME          @YL026UD*/ 00540000
*              2 IPETTR       CHAR(3), /*INDEX ADDRESS (TTR) @YL026UD*/ 00541000
*              2 IPETYPE      BIT(8);  /*IPE ENTRY TYPE      @YL026UD*/ 00542000
*                                                                  0279 00543000
*        /*  VOLUME CONTROL BLOCK (VCB) FORMAT               @YL026UD*/ 00544000
*        DCL 1 VCBFORM1       CHAR(242) BDY(WORD)  BASED(CATPTR),  0280 00545000
*              2 VCBVOLCT     FIXED(15),/*NUMBER OF VOLUMES  @YL026UD*/ 00546000
*              2 VCBVOLS(*)   CHAR(12),/*VOLUME INFORMATION  @YL026UD*/ 00547000
*                3 VCBDEVT    CHAR(4), /*DEVICE CODE         @YL026UD*/ 00548000
*                3 VCBDVOL    CHAR(6), /*VOLUME SERIAL       @YL026UD*/ 00549000
*                3 VCBDSEQ    CHAR(2); /*FILE SEQUENCE       @YL026UD*/ 00550000
*                                                                  0280 00551000
*        /*  VOLUME CONTROL BLOCK (VCB) CHAIN FORMAT         @Y30SSMK*/ 00552000
*        DCL 1 VCBFORM2       CHAR(14)  BDY(WORD)  BASED(CATPTR),  0281 00553000
*              2 VCBZERO1     CHAR(10),/*ZERO FIELD          @YL026UD*/ 00554000
*              2 VCBTTR       CHAR(3), /*CHAIN ADDRESS       @YL026UD*/ 00555000
*              2 VCBZERO2     CHAR(1); /*ZERO FIELD          @YL026UD*/ 00556000
*                                                                  0281 00557000
*        /*  VOLUME CONTROL BLOCK POINTER ENTRY (VCBPE)      @YL026UD*/ 00558000
*        /*  FORMAT                                          @YL026UD*/ 00559000
*        DCL 1 VCBPFORM       CHAR(14)  BDY(WORD)  BASED(CATPTR),  0282 00560000
*              2 VCBPNAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00561000
*              2 VCBPTTR      CHAR(3), /*VOLUME CONTROL      @YL026UD*/ 00562000
*                                      /*BLOCK ADDRESS (TTR) @YL026UD*/ 00563000
*              2 VCBPTYPE     BIT(8),  /*VCBPE ENTRY TYPE    @YL026UD*/ 00564000
*              2 VCBPZERO     FIXED(15);/*ZERO FIELD         @YL026UD*/ 00565000
*                                                                  0282 00566000
*        /*  VOLUME INDEX CONTROL ENTRY (VICE) FORMAT        @YL026UD*/ 00567000
*        DCL 1 VICEFORM       CHAR(22)  BDY(WORD)  BASED(CATPTR),  0283 00568000
*              2 VICENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/ 00569000
*              2 VICELBLK     CHAR(3), /*INDEX LAST  BLOCK   @YL026UD*/ 00570000
*                                      /*ADDRESS (TTR)       @YL026UD*/ 00571000
*              2 VICETYPE     BIT(8),  /*VICE ENTRY TYPE     @YL026UD*/ 00572000
*              2 VICECBLK     CHAR(3), /*CATALOG LAST BLOCK  @YL026UD*/ 00573000
*                                      /*ADDRESS (TTR)       @YL026UD*/ 00574000
*              2 VICEZRO1     FIXED(8),/*ZERO FIELD          @YL026UD*/ 00575000
*              2 VICEHOLE     CHAR(3), /*FIRST AVAILABLE     @YL026UD*/ 00576000
*                                      /*BLOCK ADDRESS (TTR) @YL026UD*/ 00577000
*              2 VICEZRO2     FIXED(8),/*ZERO FIELD          @YL026UD*/ 00578000
*              2 *            CHAR(2); /*RESERVED            @YL026UD*/ 00579000
*                                                                  0283 00580000
*                                                                  0283 00581000
*        /************************************************************/ 00582000
*        /*                                                  @YL026UD*/ 00583000
*        /*  DECLARATIONS FOR THE PUSH-DOWN STACK -          @YL026UD*/ 00584000
*        /*  USED IN SCANNING THE SYSCTLG DATA SET           @YL026UD*/ 00585000
*        /*                                                  @YL026UD*/ 00586000
*        /************************************************************/ 00587000
*                                                                  0284 00588000
*        DCL LVLINDEX       FIXED(15); /*PUSH-DOWN STACK     @YL026UD*/ 00589000
*                                      /*LEVEL INDEX         @YL026UD*/ 00590000
*                                                                  0285 00591000
*        /*  PUSH-DOWN STACK                                 @YL026UD*/ 00592000
*        DCL 1 LVLSTACK(22) CHAR(2)   BDY(HWORD),                  0285 00593000
*              2 LVLOFSET   FIXED(15); /*PROCESSING OFFSET   @YL026UD*/ 00594000
*                                      /*WITHIN INDEX LEVEL  @YL026UD*/ 00595000
*                                                                  0286 00596000
*        DCL LVLMAX   FIXED(15) CONSTANT(22);              /*@YL026UD*/ 00597000
*                                      /*MAX INDEX LEVELS    @YL026UD*/ 00598000
*                                                                  0287 00599000
*                                                                  0287 00600000
*        /************************************************************/ 00601000
*        /*                                                  @YL026UD*/ 00602000
*        /*  DECLARATIONS FOR DATA SET NAME -                @YL026UD*/ 00603000
*        /*  BUILT DURING SCAN OF SYSCTLG INDEX LEVELS       @YL026UD*/ 00604000
*        /*                                                  @YL026UD*/ 00605000
*        /************************************************************/ 00606000
*                                                                  0287 00607000
*        DCL 1 DSINFO       CHAR(52),  /*DSNAME INFORMATION  @YL026UD*/ 00608000
*              2 DSNAME     CHAR(44),  /*DSNAME BEING BUILT  @YL026UD*/ 00609000
*              2 *          CHAR(8);   /*DSNAME BUILD AREA   @YL026UD*/ 00610000
*                                                                  0287 00611000
*        DCL DSNLEN         FIXED(15); /*DATASET NAME LENGTH @YL026UD*/ 00612000
*                                                                  0288 00613000
*        DCL IXNLEN(22)     FIXED(15); /*SYSCTLG INDEX LEVEL @YL026UD*/ 00614000
*                                      /*NAME LENGTH         @YL026UD*/ 00615000
*                                                                  0290 00616000
*        DCL PERIOD         CHAR(1)   CONSTANT('.');       /*@YL026UD*/ 00617000
*                                      /*'PERIOD' CONSTANT   @YL026UD*/ 00618000
*                                                                  0291 00619000
*        DCL BLANK          CHAR(1)   CONSTANT(' ');       /*@YL026UD*/ 00620000
*                                      /*'BLANK' CONSTANT    @YL026UD*/ 00621000
*                                                                  0292 00622000
*        DCL TRUENAME CHAR(8);         /*ALIAS ENTRY 'TRUE'  @YL026UD*/ 00623000
*                                      /*TRUE NAME SEGMENT   @YL026UD*/ 00624000
*                                                                  0293 00625000
*        DCL TRUENLEN FIXED(15);       /*ALIAS 'TRUE' NAME   @YL026UD*/ 00626000
*                                      /*SEGMENT LENGTH      @YL026UD*/ 00627000
*                                                                  0294 00628000
*        DCL TRUEDSN  CHAR(44);        /*ALIAS ENTRY 'TRUE'  @YL026UD*/ 00629000
*                                      /*DATA SET NAME       @YL026UD*/ 00630000
*                                                                  0295 00631000
*        DCL ALIASDSN CHAR(44);        /*ALIAS ENTRY 'ALIAS' @YL026UD*/ 00632000
*                                      /*DATA SET NAME       @YL026UD*/ 00633000
*                                                                  0296 00634000
*        DCL DSCBTTR  CHAR(4);         /*DSCB RELATIVE TRACK @YL026UD*/ 00635000
*                                      /*ADDRESS (TTR)       @YL026UD*/ 00636000
*                                                                  0297 00637000
*                                                                  0297 00638000
*        /************************************************************/ 00639000
*        /*                                                  @YL026UD*/ 00640000
*        /*  DECLARATIONS FOR ACQUIRING STORAGE FOR          @YL026UD*/ 00641000
*        /*  VSAM CATALOG PARAMETER LISTS -                  @YL026UD*/ 00642000
*        /*  CPL, FVT, AND 4 FPLS                            @YL026UD*/ 00643000
*        /*  (DEVTYPE, FILESEQ, ENTYPE, CATVOL)              @YL026UD*/ 00644000
*        /*                                                  @YL026UD*/ 00645000
*        /************************************************************/ 00646000
*                                                                  0297 00647000
*        DCL CATPLPTR PTR(31);         /*VSAM PARM LISTS PTR @YL026UD*/ 00648000
*        DCL CATPLLEN FIXED(31);       /*VSAM PARM LISTS LEN @YL026UD*/ 00649000
*        DCL CATPL    CHAR(256)  BASED(CATPLPTR);          /*@YL026UD*/ 00650000
*                                      /*VSAM PARM LISTS     @YL026UD*/ 00651000
*                                                                  0300 00652000
*        /*  LENGTHS OF THE VSAM CATALOG PARAMETER LISTS     @YL026UD*/ 00653000
*        DCL CPLLEN   FIXED(15);       /*CATALOG PARM LIST   @YL026UD*/ 00654000
*        DCL FVTLEN   FIXED(15);       /*FIELD VECTOR TABLE  @YL026UD*/ 00655000
*        DCL FPLLEN   FIXED(15);       /*FIELD PARM LIST     @YL026UD*/ 00656000
*                                                                  0302 00657000
*        /*  ADDRESSES OF THE VSAM CATALOG PARAMETER LISTS   @YL026UD*/ 00658000
*        DCL DEVTFPL  PTR(31);         /*DEVICE TYPE    FPL  @YL026UD*/ 00659000
*        DCL FSEQFPL  PTR(31);         /*FILE SEQUENCE  FPL  @YL026UD*/ 00660000
*        DCL ENTYPFPL PTR(31);         /*ENTRY TYPE     FPL  @YL026UD*/ 00661000
*        DCL CATVLFPL PTR(31);         /*CATALOG VOLUME FPL  @YL026UD*/ 00662000
*                                                                  0306 00663000
*                                                                  0306 00664000
*        /************************************************************/ 00665000
*        /*                                                  @YL026UD*/ 00666000
*        /*  DECLARATIONS FOR EXTRACTING THE VOLUME          @YL026UD*/ 00667000
*        /*  IDENTIFICATION INFORMATION FROM THE DSPE AND    @YL026UD*/ 00668000
*        /*  VCB SYSCTLG ENTRIES -                           @YL026UD*/ 00669000
*        /*  DEVICE CODE, VOLUME SERIAL, DATA SET SEQUENCE   @YL026UD*/ 00670000
*        /*                                                  @YL026UD*/ 00671000
*        /************************************************************/ 00672000
*                                                                  0307 00673000
*        /* DEVICE CODE LIST                                 @YL026UD*/ 00674000
*        DCL 1 DEVTLIST(*)              BDY(HWORD)  BASED(DEVTPTR),     00675000
*              2 DEVTUNIT     CHAR(8), /*DEVICE UNIT NUMBER  @YL026UD*/ 00676000
*              2 DEVTCODE     CHAR(4); /*DEVICE CODE NUMBER  @YL026UD*/ 00677000
*                                                                  0307 00678000
*        /* VOLUME SERIAL NUMBER LIST                        @YL026UD*/ 00679000
*        DCL 1 VOLLIST        BDY(HWORD)  BASED(VOLPTR),   /*@YL026UD*/ 00680000
*              2 VOLSTLEN     FIXED(15),/*VOL SER LIST LEN   @YL026UD*/ 00681000
*              2 VOLSERS(*)   CHAR(8)   BDY(HWORD),        /*@YL026UD*/ 00682000
*                3 VOLZERO    FIXED(15),/*ZERO FIELD         @YL026UD*/ 00683000
*                3 VOLSER     CHAR(6); /*VOLUME SERIAL       @YL026UD*/ 00684000
*                                                                  0308 00685000
*        /* DATA SET SEQUENCE NUMBER LIST                    @YL026UD*/ 00686000
*        DCL 1 FILELIST(*)    BDY(HWORD)  BASED(FILEPTR),  /*@YL026UD*/ 00687000
*              2 FILESEQ      CHAR(2); /*DATA SET SEQUENCE   @YL026UD*/ 00688000
*                                                                  0309 00689000
*        /*  VOLUME INFORMATION AREA (ACQUIRED)              @YL026UD*/ 00690000
*        DCL VINFOPTR PTR(31);         /*VOL INFO AREA PTR   @YL026UD*/ 00691000
*        DCL VINFOLEN FIXED(31);       /*VOL INFO AREA LEN   @YL026UD*/ 00692000
*                                                                  0311 00693000
*        /*  DEVICE CODE LIST                                @YL026UD*/ 00694000
*        DCL DEVTPTR  PTR(31);         /*DEV CODE LIST PTR   @YL026UD*/ 00695000
*        DCL DEVTLEN  FIXED(15);       /*DEV CODE LIST LEN   @YL026UD*/ 00696000
*                                                                  0313 00697000
*        /*  VOLUME SERIAL NUMBER LIST                       @YL026UD*/ 00698000
*        DCL VOLPTR   PTR(31);         /*VOL SER LIST PTR    @YL026UD*/ 00699000
*        DCL VOLLEN   FIXED(15);       /*VOL SER LIST LEN    @YL026UD*/ 00700000
*                                                                  0315 00701000
*        /*  DATA SET SEQUENCE NUMBER LIST                   @YL026UD*/ 00702000
*        DCL FILEPTR  PTR(31);         /*FILE SEQ LIST PTR   @YL026UD*/ 00703000
*        DCL FILELEN  FIXED(15);       /*FILE SEQ LIST LEN   @YL026UD*/ 00704000
*                                                                  0317 00705000
*        DCL VOLCNT   FIXED(15);       /*DATA SET VOLUME CNT @YL026UD*/ 00706000
*                                                                  0318 00707000
*        DCL VLISTMAX FIXED(15)  CONSTANT(256);            /*@YL026UD*/ 00708000
*                                      /*VOLUME INFORMATION  @YL026UD*/ 00709000
*                                      /*MAXIMUM LIST LENGTH @YL026UD*/ 00710000
*                                                                  0320 00711000
*                                                                  0320 00712000
*        /************************************************************/ 00713000
*        /*                                                  @YL026UD*/ 00714000
*        /*  DECLARATIONS FOR EXTRACTING THE VOLUME          @YL026UD*/ 00715000
*        /*  IDENTIFICATION INFORMATION FROM THE VSAM        @YL026UD*/ 00716000
*        /*  CATALOG ENTRIES                                 @YL026UD*/ 00717000
*        /*                                                  @YL026UD*/ 00718000
*        /************************************************************/ 00719000
*                                                                  0320 00720000
*        /*  ENTRY TYPE (REFERENCED BY ENTRY TYPE FPL)       @YL026UD*/ 00721000
*        DCL ENTYPE   CHAR(1)   BASED;                     /*@YL026UD*/ 00722000
*                                                                  0320 00723000
*        /*  DEVICE TYPE, VOLUME SERIAL, DATA SET SEQUENCE   @YL026UD*/ 00724000
*        /*  NUMBER (REFERENCED BY CATALOG VOLUME FPL)       @YL026UD*/ 00725000
*        DCL 1 CATVLIST(*)  BASED,                                 0321 00726000
*              2 CVRELREP CHAR(2),     /*RELATIVE REPTITION  @YL026UD*/ 00727000
*                                      /*NUMBER      (UNUSED)@YL026UD*/ 00728000
*              2 CVDEVTYP CHAR(4),     /*DEVICE TYPE   (USED)@YL026UD*/ 00729000
*              2 CVVOLSER CHAR(6),     /*VOLUME SERIAL (USED)@YL026UD*/ 00730000
*              2 CVFSEQ   CHAR(2),     /*FILE SEQUENCE (USED)@YL026UD*/ 00731000
*              2 CVVOLFLG CHAR(1);     /*VOLUME FLAG (UNUSED)@YL026UD*/ 00732000
*                                                                  0321 00733000
*        DCL CATVLCNT FIXED(15);       /*CATALOGED VOL COUNT @YL026UD*/ 00734000
*                                                                  0322 00735000
*        /*  DECLARATIONS FOR CATALOG WORKAREA               @YL026UD*/ 00736000
*        /*  (REQUIRED FOR VSAM 'LOCATE' REQUEST)            @YL026UD*/ 00737000
*        DCL 1 WKAREA     BASED(WKAPTR),                           0323 00738000
*              2 WKALEN   FIXED(15),   /*WORKAREA LENGTH     @YL026UD*/ 00739000
*              2 WKAREQD  FIXED(15),   /*WORKAREA REQUIRED   @YL026UD*/ 00740000
*              2 WKADATA  CHAR(*);     /*WORKAREA DATA       @YL026UD*/ 00741000
*                                                                  0323 00742000
*        DCL WKAPTR   PTR(31);         /*WORKAREA POINTER    @Y30SSMK*/ 00743000
*                                                                  0324 00744000
*        DCL WKASIZE  FIXED(31);       /*CURRENT WORKAREA    @YL026UD*/ 00745000
*                                      /*SIZE                @YL026UD*/ 00746000
*                                                                  0326 00747000
*        DCL INITWKA  FIXED(31) CONSTANT(512);             /*@YL026UD*/ 00748000
*                                      /*INITIAL WORKAREA    @YL026UD*/ 00749000
*                                      /*SIZE                @YL026UD*/ 00750000
*                                                                  0327 00751000
*                                                                  0327 00752000
*        /************************************************************/ 00753000
*        /*                                                  @YL026UD*/ 00754000
*        /*  DECLARATIONS FOR SYSCTLG INDEX BLOCK            @YL026UD*/ 00755000
*        /*                                                  @YL026UD*/ 00756000
*        /************************************************************/ 00757000
*                                                                  0327 00758000
*        /*  SYSCTLG INDEX BLOCK STRUCTURE                   @YL026UD*/ 00759000
*        /*  (CONTAINING SYSCTLG BLOCKS AT EACH INDEX LEVEL) @YL026UD*/ 00760000
*        DCL BLOCK(*) CHAR(256) BDY(WORD) BASED(BLKLVPTR); /*@YL026UD*/ 00761000
*                                                                  0327 00762000
*        DCL BLKLVPTR PTR(31);         /*BLOCK STRUCTURE PTR @YL026UD*/ 00763000
*                                                                  0328 00764000
*        DCL BLKLVLEN FIXED(31);       /*BLOCK STRUCTURE LEN @YL026UD*/ 00765000
*                                                                  0329 00766000
*        DCL BLOCKCNT FIXED(15);       /*SYSCTLG BLOCK       @YL026UD*/ 00767000
*                                      /*COUNT FIELD         @YL026UD*/ 00768000
*                                                                  0331 00769000
*        DCL BLOCKPTR PTR(31);         /*INDIVIDUAL INDEX    @YL026UD*/ 00770000
*                                      /*BLOCK PTR           @YL026UD*/ 00771000
*                                                                  0332 00772000
*        DCL BLKREAD  CHAR(256)  BASED(IIOCSPTR->IOCDAD);  /*@YL026UD*/ 00773000
*                                      /*BLOCK READ BY       @YL026UD*/ 00774000
*                                      /*'UGET' MACRO        @YL026UD*/ 00775000
*                                                                  0333 00776000
*        DCL BLOCKTTR CHAR(4) BDY(WORD);/*BLOCK RELATIVE     @YL026UD*/ 00777000
*                                      /*TRACK ADDRESS       @YL026UD*/ 00778000
*                                                                  0334 00779000
*        DCL FIRSTTTR CHAR(4)   INIT('00000100'X);         /*@YL026UD*/ 00780000
*                                      /*TTR OF FIRST        @YL026UD*/ 00781000
*                                      /*SYSCTLG BLOCK       @YL026UD*/ 00782000
*                                      /*(THE VOLUME INDEX)  @YL026UD*/ 00783000
*                                                                  0335 00784000
*                                                                  0335 00785000
*        /************************************************************/ 00786000
*        /*                                                  @YL026UD*/ 00787000
*        /*  DECLARATIONS FOR TEXT PROCESSOR                 @YL026UD*/ 00788000
*        /*  'PAGE CONTROL ARGUMENT LIST' -                  @YL026UD*/ 00789000
*        /*  USED TO ESTABLISH SUBTITLE LINE                 @YL026UD*/ 00790000
*        /*                                                  @YL026UD*/ 00791000
*        /************************************************************/ 00792000
*                                                                  0335 00793000
*        DCL SUBTITLE CHAR(120);       /*SUBTITLE LINE AREA  @YL026UD*/ 00794000
*                                                                  0335 00795000
*        /*  PAGE CONTROL ARGUMENT LIST                      @YL026UD*/ 00796000
*        DCL 1 PCARGLST   BDY(WORD),                               0336 00797000
*              2 PCMTLP   PTR(31),     /*MAIN TITLE LINE PTR @YL026UD*/ 00798000
*              2 PCSTLP   PTR(31),     /*SUB  TITLE LINE PTR @YL026UD*/ 00799000
*              2 PCFLP    PTR(31),     /*FOOTING    LINE PTR @YL026UD*/ 00800000
*              2 PCPCP    PTR(31),     /*PRINT CHAIN     PTR @YL026UD*/ 00801000
*              2 PCPNL    FIXED(15),   /*MAIN TITLE PAGE LOC @YL026UD*/ 00802000
*              2 PCPTL    FIXED(15),   /*MAIN TITLE TIME LOC @YL026UD*/ 00803000
*              2 PCPDL    FIXED(15),   /*MAIN TITLE DATE LOC @YL026UD*/ 00804000
*              2 PCMTLC   FIXED(15),   /*MAIN TITLE LINE CNT @YL026UD*/ 00805000
*              2 PCSTLC   FIXED(15),   /*SUB  TITLE LINE CNT @YL026UD*/ 00806000
*              2 PCFLC    FIXED(15),   /*FOOTING    LINE CNT @YL026UD*/ 00807000
*              2 PCLW     FIXED(15),   /*SYSPRINT LINE WIDTH @YL026UD*/ 00808000
*              2 PCPD     FIXED(15),   /*SYSPRINT PAGE DEPTH @YL026UD*/ 00809000
*              2 PCDSC    FIXED(15);   /*DEFAULT SPACING     @YL026UD*/ 00810000
*                                                                  0336 00811000
*                                                                  0336 00812000
*        /************************************************************/ 00813000
*        /*                                                  @YL026UD*/ 00814000
*        /*  MISCELLANEOUS DECLARATIONS                      @YL026UD*/ 00815000
*        /*                                                  @YL026UD*/ 00816000
*        /************************************************************/ 00817000
*                                                                  0337 00818000
*        /*  COUNTS OF ENTRIES CONVERTED OR UPDATED          @YL026UD*/ 00819000
*        DCL CNVTCNT  FIXED(31);       /*CONVERSION COUNT    @YL026UD*/ 00820000
*        DCL UPDTCNT  FIXED(31);       /*UPDATE     COUNT    @YL026UD*/ 00821000
*                                                                  0338 00822000
*        DCL ILEENAME CHAR(8)   INIT('FFFFFFFFFFFFFFFF'X); /*@YL026UD*/ 00823000
*                                      /*'ILE' ENTRY NAME    @YL026UD*/ 00824000
*                                                                  0340 00825000
*        DCL ZEROTTR  CHAR(3)   INIT('000000'X);           /*@YL026UD*/ 00826000
*                                      /*ZERO TTR FOR 'ILE'  @YL026UD*/ 00827000
*                                      /*COMPARISON          @YL026UD*/ 00828000
*                                                                  0341 00829000
*        DCL ALLONES  CHAR(4)   INIT('FFFFFFFF'X);         /*@YL026UD*/ 00830000
*                                      /*CONSTANT FOR        @YL026UD*/ 00831000
*                                      /*COMPLEMENTING THE   @YL026UD*/ 00832000
*                                      /*G0000V00 GENERATION @YL026UD*/ 00833000
*                                      /*NUMBER              @YL026UD*/ 00834000
*                                                                  0342 00835000
*        DCL INDEX    FIXED(15);       /*MISCELLANEOUS INDEX @YL026UD*/ 00836000
*                                                                  0342 00837000
*        /*  'CVPE' ENTRY CVOL PROCESSING LOOP INDEXES       @YL026UD*/ 00838000
*        DCL CVENINDX FIXED(15);       /*CVOL NAME   INDEX   @YL026UD*/ 00839000
*        DCL CVEVINDX FIXED(15);       /*CVOL VOLUME INDEX   @YL026UD*/ 00840000
*                                                                  0344 00841000
*        DCL CVPEVOL  CHAR(6);         /*CVPE ENTRY VOLUME   @YL026UD*/ 00842000
*                                      /*SERIAL NUMBER       @YL026UD*/ 00843000
*                                                                  0346 00844000
*        DCL DSPEINDX FIXED(15);       /*'DSPE' ENTRY        @YL026UD*/ 00845000
*                                      /*PROCESSING INDEX    @YL026UD*/ 00846000
*                                                                  0347 00847000
*        /*'GIPE' ENTRY TO 'GDG BASE' ENTRY INFORMATION      @YL026UD*/ 00848000
*        DCL GDGLIMIT FIXED(8);        /*GDG BASE MAXIMUM    @YL026UD*/ 00849000
*                                      /*GENERATION COUNT    @YL026UD*/ 00850000
*        DCL GDGATTR  FIXED(8);        /*GDG BASE ATTRIBUTES @YL026UD*/ 00851000
*        DCL GDGEMPTY BIT(8)  CONSTANT('80'X);             /*@VS04383*/ 00852000
*                                      /*GDG BASE 'EMPTY'    @YL026UD*/ 00853000
*                                      /*ATTRIBUTE           @YL026UD*/ 00854000
*        DCL GDGDELET BIT(8)  CONSTANT('40'X);             /*@VS04383*/ 00855000
*                                      /*GDG BASE 'DELETE'   @YL026UD*/ 00856000
*                                      /*ATTRIBUTE           @YL026UD*/ 00857000
*                                                                  0351 00858000
*        /*'VCBPE' ENTRY AND 'VCB' PROCESSING INFORMATION    @YL026UD*/ 00859000
*        DCL VCBINDEX FIXED(15);       /*VCB PROCESSING INDEX@YL026UD*/ 00860000
*                                                                  0351 00861000
*        DCL VCBDONE  BIT(1);          /*VCB PROCESSING FLAG @YL026UD*/ 00862000
*                                                                  0352 00863000
*        DCL VCBVOLIM FIXED(15);       /*VCB VOLUME          @YL026UD*/ 00864000
*                                      /*LOOP LIMIT          @YL026UD*/ 00865000
*                                                                  0354 00866000
*        DCL VCBVOLMX FIXED(15) CONSTANT(20);              /*@YL026UD*/ 00867000
*                                      /*VCB MAXIMUM         @YL026UD*/ 00868000
*                                      /*VOLUME COUNT        @YL026UD*/ 00869000
*                                                                  0355 00870000
*        /*  CONVERSION PROCESSING FLAGS                     @YL026UD*/ 00871000
*        DCL ALIASFLG BIT(1);          /*'ALIAS PROCESSING'    FLAG  */ 00872000
*        DCL TRUEFLG  BIT(1);          /*'TRUENAME PROCESSING' FLAG  */ 00873000
*        DCL CVPEFLAG BIT(1);          /*'CVPE PROCESSING'     FLAG  */ 00874000
*        DCL ENDFLAG  BIT(1);          /*'PROCESSING COMPLETE' FLAG  */ 00875000
*        DCL FOUNDFLG BIT(1);          /*'ENTRY-TYPE FOUND'    FLAG  */ 00876000
*        DCL GDGFLAG  BIT(1);          /*'GDG BASE PROCESSING' FLAG  */ 00877000
*        DCL G0V0FLAG BIT(1);          /*'G0000V00 PROCESSING' FLAG  */ 00878000
*                                                                  0361 00879000
*        DCL VOLCONST CHAR(6)   CONSTANT('VOLUME');        /*@YL026UD*/ 00880000
*                                      /*'VOLUME' CONSTANT   @YL026UD*/ 00881000
*                                                                  0363 00882000
*        DCL VOLLVL   FIXED(15) CONSTANT(1);               /*@Y30SSMK*/ 00883000
*                                      /*VOLUME LEVEL INDEX  @Y30SSMK*/ 00884000
*                                                                  0364 00885000
*        /*  MESSAGE TEXT ('CVOL ENTRY NOT CONVERTED' MSG)   @YL026UD*/ 00886000
*        DCL 1 CVPETEXT   CHAR(14),    /*MESSAGE INSERT TEXT @YL026UD*/ 00887000
*              2 CVPTXTNM CHAR(8),     /*'CVPE' ENTRY NAME   @YL026UD*/ 00888000
*              2 CVPTXTVL CHAR(6);     /*'CVPE' ENTRY VOLUME @YL026UD*/ 00889000
*                                                                  0364 00890000
*                                                                  0364 00891000
*        /************************************************************/ 00892000
*        /*                                                  @YL026UD*/ 00893000
*        /*  DECLARATIONS FOR SYMBOLIC DUMP LISTS            @YL026UD*/ 00894000
*        /*                                                  @YL026UD*/ 00895000
*        /************************************************************/ 00896000
*                                                                  0365 00897000
*        /*  DUMP LIST FOR INPUT SYSCTLG BLOCK               @YL026UD*/ 00898000
*        DCL DLISTBLK CHAR(49)   BDY(WORD);                /*@YL026UD*/ 00899000
*                                                                  0365 00900000
*        /*  DUMP LIST FOR ENTRY VOLUME INFORMATION          @YL026UD*/ 00901000
*        DCL DLISTVIL CHAR(97)   BDY(WORD);                /*@YL026UD*/ 00902000
*                                                                  0366 00903000
*        /*  DUMP LIST FOR CPL/FVT/FPL PARM LISTS            @YL026UD*/ 00904000
*        DCL DLISTCPL CHAR(129)  BDY(WORD);                /*@YL026UD*/ 00905000
*        OLDERID2 = NEWERID2;                                      0368 00906000
         L     @07,@PC00001                                        0368 00907000
         L     @07,GDTTR2(,@07)                                    0368 00908000
         MVC   @TS00001(95),NEWERID2(@07)                          0368 00909000
         MVC   OLDERID2(95,@07),@TS00001                           0368 00910000
*        NEWID2 = 'CCCV';                                  /*@YL026UD*/ 00911000
*                                                                  0369 00912000
         MVC   NEWID2(4,@07),@CC01103                              0369 00913000
*        /************************************************************/ 00914000
*        /*                                                  @YL026UD*/ 00915000
*        /*  OBTAIN REQUIRED STORAGE FOR PROCESSING THE      @YL026UD*/ 00916000
*        /*  CATALOG CONVERSION                              @YL026UD*/ 00917000
*        /*                                                  @YL026UD*/ 00918000
*        /*  INITIALIZE THE CATALOG CONVERSION SUBTITLE LINE @YL026UD*/ 00919000
*        /*                                                  @YL026UD*/ 00920000
*        /*  INITIALIZE THE CONVERSION PROCESSING FLAGS      @YL026UD*/ 00921000
*        /*                                                  @Y30SSMK*/ 00922000
*        /*  TERMINATE PROCESSING IF STORAGE COULD NOT BE    @Y30SSMK*/ 00923000
*        /*  OBTAINED.                                       @Y30SSMK*/ 00924000
*        /*                                                  @YL026UD*/ 00925000
*        /************************************************************/ 00926000
*                                                                  0370 00927000
*        CALL CNVTINIT;                                    /*@YL026UD*/ 00928000
*                                                                  0370 00929000
         BAL   @14,CNVTINIT                                        0370 00930000
*        IF LASTCOND = LASTCC12                                    0371 00931000
*          THEN                                                    0371 00932000
         L     @07,@PC00001+8                                      0371 00933000
         CLC   LASTCOND(2,@07),@CH00037                            0371 00934000
         BE    @RT00371                                            0371 00935000
*            RETURN;                                       /*@YL026UD*/ 00936000
*                                                                  0372 00937000
*        /************************************************************/ 00938000
*        /*                                                  @YL026UD*/ 00939000
*        /*  OBTAIN THE FIRST-LEVEL SYSCTLG DATA SET INDEX   @YL026UD*/ 00940000
*        /*  (THE VOLUME INDEX) TO BEGIN OS CATALOG SCAN.    @Y30SSMK*/ 00941000
*        /*  TERMINATE IF THE FIRST-LEVEL SYSCTLG DATA SET   @Y30SSMK*/ 00942000
*        /*  INDEX COULD NOT BE OBTAINED.                    @Y30SSMK*/ 00943000
*        /*                                                  @YL026UD*/ 00944000
*        /************************************************************/ 00945000
*                                                                  0373 00946000
*        CALL VOLINDEX;                                    /*@YL026UD*/ 00947000
*                                                                  0373 00948000
         BAL   @14,VOLINDEX                                        0373 00949000
*        IF LASTCOND = LASTCC12                                    0374 00950000
*          THEN                                                    0374 00951000
         L     @07,@PC00001+8                                      0374 00952000
         CLC   LASTCOND(2,@07),@CH00037                            0374 00953000
         BNE   @RF00374                                            0374 00954000
*            DO;                                           /*@YL026UD*/ 00955000
*              ENDFLAG = ON;                               /*@YL026UD*/ 00956000
         OI    ENDFLAG,B'10000000'                                 0376 00957000
*              RETURN;                                     /*@YL026UD*/ 00958000
@EL00002 DS    0H                                                  0377 00959000
@EF00002 DS    0H                                                  0377 00960000
@ER00002 LM    @14,@12,@SA00002                                    0377 00961000
         BR    @14                                                 0377 00962000
*            END;                                          /*@YL026UD*/ 00963000
*                                                                  0378 00964000
*        /************************************************************/ 00965000
*        /*                                                  @YL026UD*/ 00966000
*        /*  MAIN SYSCTLG PROCESSING LOOP -                  @YL026UD*/ 00967000
*        /*  SCAN THE SYSCTLG DATA SET, CONVERTING ENTRIES   @YL026UD*/ 00968000
*        /*  UNTIL THE ENTIRE OS CATALOG HAS BEEN SCANNED    @YL026UD*/ 00969000
*        /*                                                  @YL026UD*/ 00970000
*        /************************************************************/ 00971000
*                                                                  0379 00972000
*SCANLOOP:                                                         0379 00973000
*        DO WHILE (ENDFLAG = OFF);                         /*@YL026UD*/ 00974000
*                                                                  0379 00975000
@RF00374 DS    0H                                                  0379 00976000
SCANLOOP B     @DE00379                                            0379 00977000
@DL00379 DS    0H                                                  0380 00978000
*          /**********************************************************/ 00979000
*          /*                                                @YL026UD*/ 00980000
*          /*  RESET 'ENTRY-TYPE FOUND' FLAG -               @YL026UD*/ 00981000
*          /*  THIS FLAG PREVENTS UNCONTROLLED LOOPING       @YL026UD*/ 00982000
*          /*  IF THE SYSCTLG DATA SET IS INVALID            @YL026UD*/ 00983000
*          /*                                                @YL026UD*/ 00984000
*          /**********************************************************/ 00985000
*                                                                  0380 00986000
*          FOUNDFLG = OFF;                                 /*@YL026UD*/ 00987000
*                                                                  0380 00988000
         NI    FOUNDFLG,B'01111111'                                0380 00989000
*          /**********************************************************/ 00990000
*          /*                                                @YL026UD*/ 00991000
*          /*  DETERMINE IF SYSCTLG ENTRY IS AN 'AE' -       @YL026UD*/ 00992000
*          /*                                                @YL026UD*/ 00993000
*          /*  AN ALIAS ENTRY ('AE') CONTAINS AN ALTERNATE   @YL026UD*/ 00994000
*          /*  NAME FOR THE HIGH-LEVEL QUALIFIER OF A        @YL026UD*/ 00995000
*          /*  DATA SET NAME                                 @YL026UD*/ 00996000
*          /*                                                @YL026UD*/ 00997000
*          /*  AN ALIAS ENTRY CAN APPEAR ONLY WITHIN THE     @YL026UD*/ 00998000
*          /*  VOLUME INDEX (THE FIRST-LEVEL SYSCTLG INDEX)  @YL026UD*/ 00999000
*          /*                                                @YL026UD*/ 01000000
*          /*  AN ALIAS ENTRY IS CONVERTED INTO AN ALIAS     @YL026UD*/ 01001000
*          /*  ENTRY (ENTRY TYPE = 'X') IN THE VSAM CATALOG  @YL026UD*/ 01002000
*          /*                                                @YL026UD*/ 01003000
*          /**********************************************************/ 01004000
*                                                                  0381 01005000
*          IF CATETYPE = TYPEAE & ENDFLAG = OFF                    0381 01006000
*            THEN                                                  0381 01007000
         CLC   CATETYPE(1,CATPTR),TYPEAE                           0381 01008000
         BNE   @RF00381                                            0381 01009000
         TM    ENDFLAG,B'10000000'                                 0381 01010000
         BNZ   @RF00381                                            0381 01011000
*AE:           DO;                                         /*@YL026UD*/ 01012000
AE       DS    0H                                                  0383 01013000
*                /****************************************************/ 01014000
*                /*                                          @YL026UD*/ 01015000
*                /*  SYSCTLG ENTRY IS AN 'AE' -              @YL026UD*/ 01016000
*                /*  PROCESS THE ALIAS ENTRY                 @YL026UD*/ 01017000
*                /*  TERMINATE IF ANY ERRORS ARE ENCOUNTERED @Y30SSMK*/ 01018000
*                /*  WHILE PROCESSING THE 'AE' ENTRY.        @Y30SSMK*/ 01019000
*                /*                                          @YL026UD*/ 01020000
*                /****************************************************/ 01021000
*                                                                  0383 01022000
*                FOUNDFLG = ON;                            /*@YL026UD*/ 01023000
*                                                                  0383 01024000
         OI    FOUNDFLG,B'10000000'                                0383 01025000
*                CALL AEPROC;                              /*@YL026UD*/ 01026000
*                                                                  0384 01027000
         BAL   @14,AEPROC                                          0384 01028000
*                IF LASTCOND = LASTCC12                            0385 01029000
*                  THEN                                            0385 01030000
         L     @07,@PC00001+8                                      0385 01031000
         CLC   LASTCOND(2,@07),@CH00037                            0385 01032000
         BNE   @RF00385                                            0385 01033000
*                    DO;                                   /*@YL026UD*/ 01034000
*                      ENDFLAG = ON;                       /*@YL026UD*/ 01035000
         OI    ENDFLAG,B'10000000'                                 0387 01036000
*                      RETURN;                             /*@YL026UD*/ 01037000
         B     @EL00002                                            0388 01038000
*                    END;                                  /*@YL026UD*/ 01039000
*                                                                  0389 01040000
*              END AE;                                     /*@YL026UD*/ 01041000
*                                                                  0390 01042000
*                                                                  0390 01043000
@RF00385 DS    0H                                                  0391 01044000
*          /**********************************************************/ 01045000
*          /*                                                @YL026UD*/ 01046000
*          /*  DETERMINE IF SYSCTLG ENTRY IS AN 'IPE' -      @YL026UD*/ 01047000
*          /*                                                @YL026UD*/ 01048000
*          /*  AN INDEX POINTER ENTRY ('IPE') POINTS TO A    @YL026UD*/ 01049000
*          /*  LOWER-LEVEL INDEX OF A DATA SET NAME          @YL026UD*/ 01050000
*          /*                                                @YL026UD*/ 01051000
*          /**********************************************************/ 01052000
*                                                                  0391 01053000
*          IF CATETYPE = TYPEIPE & CATENAME ^= ILEENAME            0391 01054000
*                           & ENDFLAG = OFF                        0391 01055000
*            THEN                                                  0391 01056000
@RF00381 CLC   CATETYPE(1,CATPTR),TYPEIPE                          0391 01057000
         BNE   @RF00391                                            0391 01058000
         CLC   CATENAME(8,CATPTR),ILEENAME                         0391 01059000
         BE    @RF00391                                            0391 01060000
         TM    ENDFLAG,B'10000000'                                 0391 01061000
         BNZ   @RF00391                                            0391 01062000
*IPE:          DO;                                         /*@YL026UD*/ 01063000
IPE      DS    0H                                                  0393 01064000
*                /****************************************************/ 01065000
*                /*                                          @YL026UD*/ 01066000
*                /*  SYSCTLG ENTRY IS AN 'IPE' -             @YL026UD*/ 01067000
*                /*  CONTINUE SCANNING AT LOWER INDEX LEVEL  @YL026UD*/ 01068000
*                /*  TERMINATE IF ANY ERRORS ARE ENCOUNTERED @Y30SSMK*/ 01069000
*                /*  IN THE CHANGE FROM ONE INDEX LEVEL TO   @Y30SSMK*/ 01070000
*                /*  THE NEXT LOWER INDEX LEVEL.             @Y30SSMK*/ 01071000
*                /*                                          @YL026UD*/ 01072000
*                /****************************************************/ 01073000
*                                                                  0393 01074000
*                FOUNDFLG = ON;                            /*@YL026UD*/ 01075000
*                                                                  0393 01076000
         OI    FOUNDFLG,B'10000000'                                0393 01077000
*                CALL PUSHDOWN;                            /*@YL026UD*/ 01078000
*                                                                  0394 01079000
         BAL   @14,PUSHDOWN                                        0394 01080000
*                IF LASTCOND = LASTCC12                            0395 01081000
*                  THEN                                            0395 01082000
         L     @07,@PC00001+8                                      0395 01083000
         CLC   LASTCOND(2,@07),@CH00037                            0395 01084000
         BNE   @RF00395                                            0395 01085000
*                    DO;                                   /*@YL026UD*/ 01086000
*                      ENDFLAG = ON;                       /*@YL026UD*/ 01087000
         OI    ENDFLAG,B'10000000'                                 0397 01088000
*                      RETURN;                             /*@YL026UD*/ 01089000
         B     @EL00002                                            0398 01090000
*                    END;                                  /*@YL026UD*/ 01091000
*                                                                  0399 01092000
*              END IPE;                                    /*@YL026UD*/ 01093000
*                                                                  0400 01094000
*                                                                  0400 01095000
@RF00395 DS    0H                                                  0401 01096000
*          /**********************************************************/ 01097000
*          /*                                                @YL026UD*/ 01098000
*          /*  DETERMINE IF SYSCTLG ENTRY IS AN 'ILE' -      @YL026UD*/ 01099000
*          /*                                                @YL026UD*/ 01100000
*          /*  AN INDEX LINK ENTRY ('ILE') IS ALWAYS THE     @YL026UD*/ 01101000
*          /*  LAST ENTRY IN ANY INDEX BLOCK.  IT IS USED    @YL026UD*/ 01102000
*          /*  TO LINK BLOCKS OF ONE INDEX INTO A CHAIN      @YL026UD*/ 01103000
*          /*                                                @YL026UD*/ 01104000
*          /**********************************************************/ 01105000
*                                                                  0401 01106000
*          IF CATETYPE = TYPEILE & CATENAME = ILEENAME             0401 01107000
*                           & ENDFLAG = OFF                        0401 01108000
*            THEN                                                  0401 01109000
@RF00391 CLC   CATETYPE(1,CATPTR),TYPEILE                          0401 01110000
         BNE   @RF00401                                            0401 01111000
         CLC   CATENAME(8,CATPTR),ILEENAME                         0401 01112000
         BNE   @RF00401                                            0401 01113000
         TM    ENDFLAG,B'10000000'                                 0401 01114000
         BNZ   @RF00401                                            0401 01115000
*ILE:          DO;                                         /*@YL026UD*/ 01116000
ILE      DS    0H                                                  0403 01117000
*                /****************************************************/ 01118000
*                /*                                          @YL026UD*/ 01119000
*                /*  SYSCTLG ENTRY IS AN 'ILE' -             @YL026UD*/ 01120000
*                /*  PROCESS THE INDEX LINK ENTRY            @YL026UD*/ 01121000
*                /*  TERMINATE IF ANY ERRORS ARE ENCOUNTERED @Y30SSMK*/ 01122000
*                /*  WHILE PROCESSING THE 'ILE' ENTRY.       @Y30SSMK*/ 01123000
*                /*                                          @YL026UD*/ 01124000
*                /****************************************************/ 01125000
*                                                                  0403 01126000
*                FOUNDFLG = ON;                            /*@YL026UD*/ 01127000
*                                                                  0403 01128000
         OI    FOUNDFLG,B'10000000'                                0403 01129000
*                CALL ILEPROC;                             /*@YL026UD*/ 01130000
*                                                                  0404 01131000
         BAL   @14,ILEPROC                                         0404 01132000
*                IF LASTCOND = LASTCC12                            0405 01133000
*                  THEN                                            0405 01134000
         L     @07,@PC00001+8                                      0405 01135000
         CLC   LASTCOND(2,@07),@CH00037                            0405 01136000
         BNE   @RF00405                                            0405 01137000
*                    DO;                                   /*@YL026UD*/ 01138000
*                      ENDFLAG = ON;                       /*@YL026UD*/ 01139000
         OI    ENDFLAG,B'10000000'                                 0407 01140000
*                      RETURN;                             /*@YL026UD*/ 01141000
         B     @EL00002                                            0408 01142000
*                    END;                                  /*@YL026UD*/ 01143000
*                                                                  0409 01144000
*              END ILE;                                    /*@YL026UD*/ 01145000
*                                                                  0410 01146000
*                                                                  0410 01147000
@RF00405 DS    0H                                                  0411 01148000
*          /**********************************************************/ 01149000
*          /*                                                @YL026UD*/ 01150000
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'DSPE' -      @YL026UD*/ 01151000
*          /*                                                @YL026UD*/ 01152000
*          /*  A DATA SET POINTER ENTRY ('DSPE') CONTAINS    @YL026UD*/ 01153000
*          /*  SIMPLE NAME OS A DATA SET AND FROM ONE TO     @YL026UD*/ 01154000
*          /*  FIVE 12-BYTE FIELDS THAT EACH IDENTIFY A      @YL026UD*/ 01155000
*          /*  VOLUME ON WHICH THE NAMED DATA SET RESIDES    @YL026UD*/ 01156000
*          /*                                                @YL026UD*/ 01157000
*          /*  A DATA SET POINTER ENTRY IS CONVERTED INTO    @YL026UD*/ 01158000
*          /*  A NONVSAM ENTRY (ENTRY TYPE = 'A'), OR        @YL026UD*/ 01159000
*          /*  AN ALIAS ENTRY (ENTRY TYPE = 'X' - IF THE     @YL026UD*/ 01160000
*          /*  'ALIAS PROCESSING' FLAG IS TURNED ON)         @YL026UD*/ 01161000
*          /*  IN THE VSAM CATALOG                           @YL026UD*/ 01162000
*          /*                                                @YL026UD*/ 01163000
*          /**********************************************************/ 01164000
*                                                                  0411 01165000
*DSPE:     DO INDEX = 1 TO DIM(TYPEDSPE);                  /*@YL026UD*/ 01166000
*                                                                  0411 01167000
@RF00401 DS    0H                                                  0411 01168000
DSPE     LA    INDEX,1                                             0411 01169000
@DL00411 DS    0H                                                  0412 01170000
*            IF CATETYPE = TYPEDSPE(INDEX) & ENDFLAG = OFF         0412 01171000
*              THEN                                                0412 01172000
         LA    @05,TYPEDSPE-1(INDEX)                               0412 01173000
         CLC   CATETYPE(1,CATPTR),0(@05)                           0412 01174000
         BNE   @RF00412                                            0412 01175000
         TM    ENDFLAG,B'10000000'                                 0412 01176000
         BNZ   @RF00412                                            0412 01177000
*                DO;                                       /*@YL026UD*/ 01178000
*                  /**************************************************/ 01179000
*                  /*                                        @YL026UD*/ 01180000
*                  /*  SYSCTLG ENTRY IS A 'DSPE' -           @YL026UD*/ 01181000
*                  /*  PROCESS THE DATA SET POINTER ENTRY    @YL026UD*/ 01182000
*                  /*  TERMINATE IF A TERMINAL ERROR IS      @Y30SSMK*/ 01183000
*                  /*  ENCOUNTERED WHILE PROCESSING THE      @Y30SSMK*/ 01184000
*                  /*  'DSPE' ENTRY.                         @Y30SSMK*/ 01185000
*                  /*                                        @YL026UD*/ 01186000
*                  /**************************************************/ 01187000
*                                                                  0414 01188000
*                  FOUNDFLG = ON;                          /*@YL026UD*/ 01189000
*                                                                  0414 01190000
         OI    FOUNDFLG,B'10000000'                                0414 01191000
*                  CALL DSPEPROC;                          /*@YL026UD*/ 01192000
*                                                                  0415 01193000
         BAL   @14,DSPEPROC                                        0415 01194000
*                  IF LASTCOND = LASTCC12                          0416 01195000
*                    THEN                                          0416 01196000
         L     @05,@PC00001+8                                      0416 01197000
         CLC   LASTCOND(2,@05),@CH00037                            0416 01198000
         BNE   @RF00416                                            0416 01199000
*                      DO;                                 /*@VS04383*/ 01200000
*                      ENDFLAG = ON;                       /*@VS04383*/ 01201000
         OI    ENDFLAG,B'10000000'                                 0418 01202000
*                      RETURN;                             /*@VS04383*/ 01203000
         B     @EL00002                                            0419 01204000
*                      END;                                /*@VS04383*/ 01205000
*                                                                  0420 01206000
*                END;                                      /*@YL026UD*/ 01207000
*                                                                  0421 01208000
@RF00416 DS    0H                                                  0422 01209000
*          END DSPE;                                       /*@YL026UD*/ 01210000
*                                                                  0422 01211000
*                                                                  0422 01212000
@RF00412 AL    INDEX,@CF00215                                      0422 01213000
         C     INDEX,@CF00426                                      0422 01214000
         BNH   @DL00411                                            0422 01215000
*          /**********************************************************/ 01216000
*          /*                                                @YL026UD*/ 01217000
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'VCBPE' -     @YL026UD*/ 01218000
*          /*                                                @YL026UD*/ 01219000
*          /*  A VOLUME CONTROL BLOCK POINTER ENTRY ('VCBPE')        */ 01220000
*          /*  CONTAINS THE SIMPLE NAME OF A DATA SET WHICH  @YL026UD*/ 01221000
*          /*  RESIDES ON MORE THAN FIVE VOLUMES             @YL026UD*/ 01222000
*          /*                                                @YL026UD*/ 01223000
*          /*  THE 'VCBPE' CONTAINS A POINTER TO A VOLUME    @YL026UD*/ 01224000
*          /*  CONTROL BLOCK ('VCB') CONTAINING THE VOLUME   @YL026UD*/ 01225000
*          /*  LIST FOR THE DATA SET THAT RESIDES ON MORE    @YL026UD*/ 01226000
*          /*  THAN FIVE VOLUMES                             @YL026UD*/ 01227000
*          /*                                                @YL026UD*/ 01228000
*          /*  A VOLUME CONTROL BLOCK POINTER ENTRY IS       @YL026UD*/ 01229000
*          /*  CONVERTED INTO A NONVSAM ENTRY                @YL026UD*/ 01230000
*          /*  (ENTRY TYPE = 'A'), OR AN ALIAS ENTRY         @YL026UD*/ 01231000
*          /*  (ENTRY TYPE = 'X' - IF THE 'ALIAS PROCESSING' @YL026UD*/ 01232000
*          /*  FLAG IS TURNED ON) IN THE VSAM CATALOG        @YL026UD*/ 01233000
*          /*                                                @YL026UD*/ 01234000
*          /**********************************************************/ 01235000
*                                                                  0423 01236000
*          IF CATETYPE = TYPEVCBP & ENDFLAG = OFF                  0423 01237000
*            THEN                                                  0423 01238000
         CLC   CATETYPE(1,CATPTR),TYPEVCBP                         0423 01239000
         BNE   @RF00423                                            0423 01240000
         TM    ENDFLAG,B'10000000'                                 0423 01241000
         BNZ   @RF00423                                            0423 01242000
*VCBPE:        DO;                                         /*@YL026UD*/ 01243000
VCBPE    DS    0H                                                  0425 01244000
*                /****************************************************/ 01245000
*                /*                                          @YL026UD*/ 01246000
*                /*  SYSCTLG ENTRY IS A 'VCBPE' -            @YL026UD*/ 01247000
*                /*  PROCESS THE VOLUME CONTROL BLOCK        @YL026UD*/ 01248000
*                /*  POINTER ENTRY AND THE CORRESPONDING     @YL026UD*/ 01249000
*                /*  VOLUME CONTROL BLOCK                    @YL026UD*/ 01250000
*                /*  TERMINATE IF ANY TERMINAL ERRORS ARE    @Y30SSMK*/ 01251000
*                /*  ENCOUNTERED WHILE PROCESSING THE        @Y30SSMK*/ 01252000
*                /*  'VCBPE' ENTRY.                          @Y30SSMK*/ 01253000
*                /*                                          @YL026UD*/ 01254000
*                /****************************************************/ 01255000
*                                                                  0425 01256000
*                FOUNDFLG = ON;                            /*@YL026UD*/ 01257000
*                                                                  0425 01258000
         OI    FOUNDFLG,B'10000000'                                0425 01259000
*                CALL VCBPPROC;                            /*@YL026UD*/ 01260000
*                                                                  0426 01261000
         BAL   @14,VCBPPROC                                        0426 01262000
*                IF LASTCOND = LASTCC12                            0427 01263000
*                  THEN                                            0427 01264000
         L     @07,@PC00001+8                                      0427 01265000
         CLC   LASTCOND(2,@07),@CH00037                            0427 01266000
         BNE   @RF00427                                            0427 01267000
*                    DO;                                   /*@YL026UD*/ 01268000
*                      ENDFLAG = ON;                       /*@YL026UD*/ 01269000
         OI    ENDFLAG,B'10000000'                                 0429 01270000
*                      RETURN;                             /*@YL026UD*/ 01271000
         B     @EL00002                                            0430 01272000
*                    END;                                  /*@YL026UD*/ 01273000
*                                                                  0431 01274000
*              END VCBPE;                                  /*@YL026UD*/ 01275000
*                                                                  0432 01276000
*                                                                  0432 01277000
@RF00427 DS    0H                                                  0433 01278000
*          /**********************************************************/ 01279000
*          /*                                                @YL026UD*/ 01280000
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'GIPE' -      @YL026UD*/ 01281000
*          /*                                                @YL026UD*/ 01282000
*          /*  A GENERATION INDEX POINTER ENTRY ('GIPE')     @YL026UD*/ 01283000
*          /*  POINTS TO THE LOWEST INDEX FOR A GENERATION   @YL026UD*/ 01284000
*          /*  DATA GROUP (THE GENERATION INDEX)             @YL026UD*/ 01285000
*          /*                                                @YL026UD*/ 01286000
*          /*  THE 'GIPE' CORRESPONDS TO THE SIMPLE NAME     @YL026UD*/ 01287000
*          /*  USED IN THE RELATIVE NAME FOR A GDG DATA SET  @YL026UD*/ 01288000
*          /*                                                @YL026UD*/ 01289000
*          /*  A GENERATION INDEX POINTER ENTRY IS CONVERTED @YL026UD*/ 01290000
*          /*  INTO A GDG BASE ENTRY (ENTRY TYPE = 'B')      @YL026UD*/ 01291000
*          /*  IN THE VSAM CATALOG                           @YL026UD*/ 01292000
*          /*                                                @YL026UD*/ 01293000
*          /**********************************************************/ 01294000
*                                                                  0433 01295000
*          IF CATETYPE = TYPEGIPE & ENDFLAG = OFF                  0433 01296000
*            THEN                                                  0433 01297000
@RF00423 CLC   CATETYPE(1,CATPTR),TYPEGIPE                         0433 01298000
         BNE   @RF00433                                            0433 01299000
         TM    ENDFLAG,B'10000000'                                 0433 01300000
         BNZ   @RF00433                                            0433 01301000
*GIPE:         DO;                                         /*@YL026UD*/ 01302000
GIPE     DS    0H                                                  0435 01303000
*                /****************************************************/ 01304000
*                /*                                          @YL026UD*/ 01305000
*                /*  SYSCTLG ENTRY IS A 'GIPE' -             @YL026UD*/ 01306000
*                /*  PROCESS THE GENERATION INDEX POINTER    @YL026UD*/ 01307000
*                /*  ENTRY                                   @YL026UD*/ 01308000
*                /*  TERMINATE IF ANY TERMINAL ERRORS ARE    @Y30SSMK*/ 01309000
*                /*  ENCOUNTERED WHILE PROCESSING THE 'GIPE' @Y30SSMK*/ 01310000
*                /*  ENTRY.                                  @Y30SSMK*/ 01311000
*                /*                                          @YL026UD*/ 01312000
*                /****************************************************/ 01313000
*                                                                  0435 01314000
*                FOUNDFLG = ON;                            /*@YL026UD*/ 01315000
*                                                                  0435 01316000
         OI    FOUNDFLG,B'10000000'                                0435 01317000
*                CALL GIPEPROC;                            /*@YL026UD*/ 01318000
*                                                                  0436 01319000
         BAL   @14,GIPEPROC                                        0436 01320000
*                IF LASTCOND = LASTCC12                            0437 01321000
*                  THEN                                            0437 01322000
         L     @07,@PC00001+8                                      0437 01323000
         CLC   LASTCOND(2,@07),@CH00037                            0437 01324000
         BNE   @RF00437                                            0437 01325000
*                    DO;                                   /*@YL026UD*/ 01326000
*                      ENDFLAG = ON;                       /*@YL026UD*/ 01327000
         OI    ENDFLAG,B'10000000'                                 0439 01328000
*                      RETURN;                             /*@YL026UD*/ 01329000
         B     @EL00002                                            0440 01330000
*                    END;                                  /*@YL026UD*/ 01331000
*                                                                  0441 01332000
*              END GIPE;                                   /*@YL026UD*/ 01333000
*                                                                  0442 01334000
*                                                                  0442 01335000
@RF00437 DS    0H                                                  0443 01336000
*          /**********************************************************/ 01337000
*          /*                                                @YL026UD*/ 01338000
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'CVPE' -      @YL026UD*/ 01339000
*          /*                                                @YL026UD*/ 01340000
*          /*  A CONTROL VOLUME POINTER ENTRY ('CVPE')       @YL026UD*/ 01341000
*          /*  CONNECTS ANOTHER CONTROL VOLUME (CVOL) TO     @YL026UD*/ 01342000
*          /*  THE CVOL BEING CONVERTED                      @YL026UD*/ 01343000
*          /*                                                @YL026UD*/ 01344000
*          /*  A CONTROL VOLUME POINTER ENTRY CAN APPEAR     @YL026UD*/ 01345000
*          /*  ONLY WITHIN THE VOLUME INDEX                  @YL026UD*/ 01346000
*          /*  (THE FIRST-LEVEL SYSCTLG INDEX)               @YL026UD*/ 01347000
*          /*                                                @YL026UD*/ 01348000
*          /*  THE 'CVPE' CONTAINS A NAME THAT APPEARS IN    @YL026UD*/ 01349000
*          /*  THE VOLUME INDEX OF THE CONNECTED CVOL        @YL026UD*/ 01350000
*          /*                                                @YL026UD*/ 01351000
*          /*  A CONTROL VOLUME POINTER ENTRY IS CONVERTED   @YL026UD*/ 01352000
*          /*  (BASED UPON PARAMETERS SPECIFIED WITH THE     @YL026UD*/ 01353000
*          /*  'CVOLEQUATES' PARAMETER) INTO AN ALIAS ENTRY  @YL026UD*/ 01354000
*          /*  (ENTRY TYPE = 'X') IN THE VSAM MASTER CATALOG @YL026UD*/ 01355000
*          /*                                                @YL026UD*/ 01356000
*          /**********************************************************/ 01357000
*                                                                  0443 01358000
*CVPE:     DO INDEX = 1 TO DIM(TYPECVPE);                  /*@YL026UD*/ 01359000
*                                                                  0443 01360000
@RF00433 DS    0H                                                  0443 01361000
CVPE     LA    INDEX,1                                             0443 01362000
@DL00443 DS    0H                                                  0444 01363000
*            IF CATETYPE = TYPECVPE(INDEX) & ENDFLAG = OFF         0444 01364000
*              THEN                                                0444 01365000
         LA    @05,TYPECVPE-1(INDEX)                               0444 01366000
         CLC   CATETYPE(1,CATPTR),0(@05)                           0444 01367000
         BNE   @RF00444                                            0444 01368000
         TM    ENDFLAG,B'10000000'                                 0444 01369000
         BNZ   @RF00444                                            0444 01370000
*                DO;                                       /*@YL026UD*/ 01371000
*                  /**************************************************/ 01372000
*                  /*                                        @YL026UD*/ 01373000
*                  /*  SYSCTLG ENTRY IS A 'CVPE' -           @YL026UD*/ 01374000
*                  /*  PROCESS THE CONTROL VOLUME POINTER    @YL026UD*/ 01375000
*                  /*  ENTRY                                 @YL026UD*/ 01376000
*                  /*                                        @YL026UD*/ 01377000
*                  /**************************************************/ 01378000
*                                                                  0446 01379000
*                  FOUNDFLG = ON;                          /*@YL026UD*/ 01380000
*                                                                  0446 01381000
         OI    FOUNDFLG,B'10000000'                                0446 01382000
*                  CALL CVPEPROC;                          /*@YL026UD*/ 01383000
*                                                                  0447 01384000
         BAL   @14,CVPEPROC                                        0447 01385000
*                END;                                      /*@YL026UD*/ 01386000
*                                                                  0448 01387000
*          END CVPE;                                       /*@YL026UD*/ 01388000
*                                                                  0449 01389000
*                                                                  0449 01390000
@RF00444 AL    INDEX,@CF00215                                      0449 01391000
         C     INDEX,@CF00149                                      0449 01392000
         BNH   @DL00443                                            0449 01393000
*          /**********************************************************/ 01394000
*          /*                                                @YL026UD*/ 01395000
*          /*  VERIFY THAT A VALID ENTRY TYPE HAS BEEN       @YL026UD*/ 01396000
*          /*  ENCOUNTERED FOR THIS ITERATION OF 'SCANLOOP'  @YL026UD*/ 01397000
*          /*                                                @YL026UD*/ 01398000
*          /**********************************************************/ 01399000
*                                                                  0450 01400000
*          IF FOUNDFLG = OFF                                       0450 01401000
*            THEN                                                  0450 01402000
         TM    FOUNDFLG,B'10000000'                                0450 01403000
         BNZ   @RF00450                                            0450 01404000
*              DO;                                         /*@YL026UD*/ 01405000
*                /****************************************************/ 01406000
*                /*                                          @YL026UD*/ 01407000
*                /*  VALID ENTRY TYPE NOT ENCOUNTERED -      @YL026UD*/ 01408000
*                /*  SCANNING ERROR ON SYSCTLG DATA SET -    @YL026UD*/ 01409000
*                /*  PRINT ERROR MESSAGE AND TERMINATE       @YL026UD*/ 01410000
*                /*                                          @YL026UD*/ 01411000
*                /****************************************************/ 01412000
*                                                                  0452 01413000
*                DARGSMOD = CNVTMSG;                       /*@YL026UD*/ 01414000
*                                                                  0452 01415000
         L     @07,DDSTRU                                          0452 01416000
         MVC   DARGSMOD(3,@07),@CC00831                            0452 01417000
*                DARGSENT = SCN1MSG#;                      /*@YL026UD*/ 01418000
*                                                                  0453 01419000
         MVI   DARGSENT(@07),X'05'                                 0453 01420000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@YL026UD*/ 01421000
*                                                                  0454 01422000
         L     @07,@PC00001                                        0454 01423000
         ST    @07,@AL00001                                        0454 01424000
         LA    @05,@CF00113                                        0454 01425000
         ST    @05,@AL00001+4                                      0454 01426000
         LA    @05,DDSTRU                                          0454 01427000
         ST    @05,@AL00001+8                                      0454 01428000
         MVI   @AL00001+8,X'80'                                    0454 01429000
         L     @15,GDTPRT(,@07)                                    0454 01430000
         LA    @01,@AL00001                                        0454 01431000
         BALR  @14,@15                                             0454 01432000
*                DARGSENT = SCN2MSG#;                      /*@YL026UD*/ 01433000
*                                                                  0455 01434000
         L     @07,DDSTRU                                          0455 01435000
         MVI   DARGSENT(@07),X'06'                                 0455 01436000
*                IF LVLINDEX = VOLLVL                              0456 01437000
*                  THEN                                            0456 01438000
         CLC   LVLINDEX(2),@CH00215                                0456 01439000
         BNE   @RF00456                                            0456 01440000
*                    DO;                                   /*@YL026UD*/ 01441000
*                      DARGDBP = ADDR(VOLCONST);           /*@YL026UD*/ 01442000
         LA    @05,@CC01092                                        0458 01443000
         ST    @05,DARGDBP(,@07)                                   0458 01444000
*                      DARGILP = LENGTH(VOLCONST);         /*@YL026UD*/ 01445000
         MVC   DARGILP(2,@07),@CH00152                             0459 01446000
*                    END;                                  /*@YL026UD*/ 01447000
*                  ELSE                                            0461 01448000
*                    DO;                                   /*@YL026UD*/ 01449000
         B     @RC00456                                            0461 01450000
@RF00456 DS    0H                                                  0462 01451000
*                      DARGDBP = ADDR(DSNAME);             /*@YL026UD*/ 01452000
         L     @07,DDSTRU                                          0462 01453000
         LA    @05,DSNAME                                          0462 01454000
         ST    @05,DARGDBP(,@07)                                   0462 01455000
*                      DARGILP = DSNLEN;                   /*@YL026UD*/ 01456000
         STH   DSNLEN,DARGILP(,@07)                                0463 01457000
*                    END;                                  /*@YL026UD*/ 01458000
*                                                                  0464 01459000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@YL026UD*/ 01460000
*                                                                  0465 01461000
@RC00456 L     @07,@PC00001                                        0465 01462000
         ST    @07,@AL00001                                        0465 01463000
         LA    @05,@CF00113                                        0465 01464000
         ST    @05,@AL00001+4                                      0465 01465000
         LA    @05,DDSTRU                                          0465 01466000
         ST    @05,@AL00001+8                                      0465 01467000
         MVI   @AL00001+8,X'80'                                    0465 01468000
         L     @15,GDTPRT(,@07)                                    0465 01469000
         LA    @01,@AL00001                                        0465 01470000
         BALR  @14,@15                                             0465 01471000
*                LASTCOND = LASTCC12;                      /*@Y30SSMK*/ 01472000
*                                                                  0466 01473000
         L     @07,@PC00001+8                                      0466 01474000
         MVC   LASTCOND(2,@07),@CH00037                            0466 01475000
*                /****************************************************/ 01476000
*                /*                                          @Y30SSMK*/ 01477000
*                /*  DUMP POINT WHEN AN INVALID ENTRY IS     @Y30SSMK*/ 01478000
*                /*  ENCOUNTERED IN THE OS CATALOG.          @Y30SSMK*/ 01479000
*                /*                                          @Y30SSMK*/ 01480000
*                /****************************************************/ 01481000
*                                                                  0467 01482000
*                IF GDTDBG = NULLPTR                               0467 01483000
*                  THEN;                                           0467 01484000
         L     @07,@PC00001                                        0467 01485000
         L     @07,GDTDBG(,@07)                                    0467 01486000
         LTR   @07,@07                                             0467 01487000
         BZ    @RT00467                                            0467 01488000
*                  ELSE                                            0469 01489000
*                    CALL IDCDB010(GDTTBL,'CCSE');                 0469 01490000
         L     @07,@PC00001                                        0469 01491000
         ST    @07,@AL00001                                        0469 01492000
         LA    @05,@CC01130                                        0469 01493000
         ST    @05,@AL00001+4                                      0469 01494000
         MVI   @AL00001+4,X'80'                                    0469 01495000
         L     @15,GDTDBG(,@07)                                    0469 01496000
         LA    @01,@AL00001                                        0469 01497000
         BALR  @14,@15                                             0469 01498000
*                                                          /*@YL026UD*/ 01499000
*                                                                  0470 01500000
*                ENDFLAG = ON;                             /*@YL026UD*/ 01501000
@RT00467 OI    ENDFLAG,B'10000000'                                 0470 01502000
*              END;                                        /*@YL026UD*/ 01503000
*                                                                  0471 01504000
*        /************************************************************/ 01505000
*        /*                                                  @YL026UD*/ 01506000
*        /*  END OF MAIN PROCESSING LOOP ('SCANLOOP')        @YL026UD*/ 01507000
*        /*                                                  @YL026UD*/ 01508000
*        /************************************************************/ 01509000
*                                                                  0472 01510000
*        END SCANLOOP;                                     /*@YL026UD*/ 01511000
*                                                                  0472 01512000
@RF00450 DS    0H                                                  0472 01513000
@DE00379 TM    ENDFLAG,B'10000000'                                 0472 01514000
         BZ    @DL00379                                            0472 01515000
*        /************************************************************/ 01516000
*        /*                                                  @Y30SSMK*/ 01517000
*        /*  DUMP POINT AFTER THE OS ENTRIES ARE CONVERTED   @Y30SSMK*/ 01518000
*        /*  TO VSAM ENTRIES.                                @Y30SSMK*/ 01519000
*        /*                                                  @Y30SSMK*/ 01520000
*        /************************************************************/ 01521000
*                                                                  0473 01522000
*        IF GDTDBG = NULLPTR                                       0473 01523000
*          THEN;                                                   0473 01524000
         L     @08,@PC00001                                        0473 01525000
         L     @08,GDTDBG(,@08)                                    0473 01526000
         LTR   @08,@08                                             0473 01527000
         BZ    @RT00473                                            0473 01528000
*          ELSE                                                    0475 01529000
*            CALL IDCDB010(GDTTBL,'CCSL');                         0475 01530000
         L     @08,@PC00001                                        0475 01531000
         ST    @08,@AL00001                                        0475 01532000
         LA    @15,@CC01131                                        0475 01533000
         ST    @15,@AL00001+4                                      0475 01534000
         MVI   @AL00001+4,X'80'                                    0475 01535000
         L     @15,GDTDBG(,@08)                                    0475 01536000
         LA    @01,@AL00001                                        0475 01537000
         BALR  @14,@15                                             0475 01538000
*                                                          /*@YL026UD*/ 01539000
*                                                                  0476 01540000
*        /************************************************************/ 01541000
*        /*                                                  @YL026UD*/ 01542000
*        /*  PRINT COUNT OF SYSCTLG ENTRIES CONVERTED TO     @YL026UD*/ 01543000
*        /*  NONVSAM ENTRIES IN VSAM CATALOG                 @YL026UD*/ 01544000
*        /*                                                  @YL026UD*/ 01545000
*        /************************************************************/ 01546000
*                                                                  0476 01547000
*        DARGSMOD = CNVTMSG;                               /*@YL026UD*/ 01548000
@RT00473 L     @08,DDSTRU                                          0476 01549000
         MVC   DARGSMOD(3,@08),@CC00831                            0476 01550000
*        DARGSENT = CCNTMSG#;                              /*@YL026UD*/ 01551000
*                                                                  0477 01552000
         MVI   DARGSENT(@08),X'07'                                 0477 01553000
*        DARGDBP = ADDR(CNVTCNT);                          /*@YL026UD*/ 01554000
         LA    @15,CNVTCNT                                         0478 01555000
         ST    @15,DARGDBP(,@08)                                   0478 01556000
*        DARGILP = LENGTH(CNVTCNT);                        /*@YL026UD*/ 01557000
*                                                                  0479 01558000
         MVC   DARGILP(2,@08),@CH00042                             0479 01559000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UD*/ 01560000
*                                                                  0480 01561000
         L     @08,@PC00001                                        0480 01562000
         ST    @08,@AL00001                                        0480 01563000
         LA    @15,@CF00113                                        0480 01564000
         ST    @15,@AL00001+4                                      0480 01565000
         LA    @15,DDSTRU                                          0480 01566000
         ST    @15,@AL00001+8                                      0480 01567000
         MVI   @AL00001+8,X'80'                                    0480 01568000
         L     @15,GDTPRT(,@08)                                    0480 01569000
         LA    @01,@AL00001                                        0480 01570000
         BALR  @14,@15                                             0480 01571000
*        /************************************************************/ 01572000
*        /*                                                  @YL026UD*/ 01573000
*        /*  PRINT COUNT OF VSAM CATALOG ENTRIES UPDATED     @YL026UD*/ 01574000
*        /*  (VOLUME INFORMATION ALTERED) TO MATCH THE       @YL026UD*/ 01575000
*        /*  CURRENT CORRESPONDING SYSCTLG ENTRY             @YL026UD*/ 01576000
*        /*                                                  @YL026UD*/ 01577000
*        /************************************************************/ 01578000
*                                                                  0481 01579000
*        DARGSMOD = CNVTMSG;                               /*@YL026UD*/ 01580000
         L     @08,DDSTRU                                          0481 01581000
         MVC   DARGSMOD(3,@08),@CC00831                            0481 01582000
*        DARGSENT = UCNTMSG#;                              /*@YL026UD*/ 01583000
*                                                                  0482 01584000
         MVI   DARGSENT(@08),X'0D'                                 0482 01585000
*        DARGDBP = ADDR(UPDTCNT);                          /*@YL026UD*/ 01586000
         LA    @15,UPDTCNT                                         0483 01587000
         ST    @15,DARGDBP(,@08)                                   0483 01588000
*        DARGILP = LENGTH(UPDTCNT);                        /*@YL026UD*/ 01589000
*                                                                  0484 01590000
         MVC   DARGILP(2,@08),@CH00042                             0484 01591000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UD*/ 01592000
*                                                                  0485 01593000
         L     @08,@PC00001                                        0485 01594000
         ST    @08,@AL00001                                        0485 01595000
         LA    @15,@CF00113                                        0485 01596000
         ST    @15,@AL00001+4                                      0485 01597000
         LA    @15,DDSTRU                                          0485 01598000
         ST    @15,@AL00001+8                                      0485 01599000
         MVI   @AL00001+8,X'80'                                    0485 01600000
         L     @15,GDTPRT(,@08)                                    0485 01601000
         LA    @01,@AL00001                                        0485 01602000
         BALR  @14,@15                                             0485 01603000
*        RETURN;                                           /*@YL026UD*/ 01604000
         B     @EL00002                                            0486 01605000
*/********************************************************************/ 01606000
*/*                                                          @YL026UD*/ 01607000
*/*  PROCEDURE NAME - CNVTINIT                               @YL026UD*/ 01608000
*/*                                                          @YL026UD*/ 01609000
*/*  FUNCTION - OBTAIN REQUIRED STORAGE FOR PROCESSING THE   @YL026UD*/ 01610000
*/*             CATALOG CONVERSION.  STORAGE IS NEEDED FOR   @YL026UD*/ 01611000
*/*             (1) SYSCTLG INDEX BLOCKS                     @YL026UD*/ 01612000
*/*             (2) VSAM PARAMETER LISTS (CPL/FVT/FPLS)      @YL026UD*/ 01613000
*/*             (3) DATA SET VOLUME INFORMATION LISTS        @YL026UD*/ 01614000
*/*             (4) CATALOG WORKAREA (VSAM CATALOG LOCATE)   @YL026UD*/ 01615000
*/*                                                          @YL026UD*/ 01616000
*/*             INITIALIZE THE CATALOG CONVERSION SUBTITLE   @YL026UD*/ 01617000
*/*             LINE (IF 'LIST' OPTION IN EFFECT)            @YL026UD*/ 01618000
*/*                                                          @YL026UD*/ 01619000
*/*             INITIALIZE THE FLAGS AND INDEXES USED FOR    @YL026UD*/ 01620000
*/*             SCANNING THE SYSCTLG DATA SET AND CONVERTING @YL026UD*/ 01621000
*/*             THE EXTRACTED ENTRIES                        @YL026UD*/ 01622000
*/*                                                          @YL026UD*/ 01623000
*/*  INPUT - (1) SIZES FOR REQUIRED STORAGE AREAS            @YL026UD*/ 01624000
*/*          (2) UNINITIALIZED CONVERSION FLAGS AND INDEXES  @YL026UD*/ 01625000
*/*                                                          @YL026UD*/ 01626000
*/*  OUTPUT - (1) INITIALIZED STORAGE AREAS                  @YL026UD*/ 01627000
*/*           (2) ESTABLISHED SUBTITLE LINE                  @YL026UD*/ 01628000
*/*               (IF 'LIST' OPTION SPECIFIED OR DEFAULTED)  @YL026UD*/ 01629000
*/*           (3) INITIALIZED CONVERSION FLAGS AND INDEXES   @YL026UD*/ 01630000
*/*                                                          @YL026UD*/ 01631000
*/********************************************************************/ 01632000
*                                                                  0487 01633000
*CNVTINIT: PROCEDURE;                                      /*@YL026UD*/ 01634000
CNVTINIT STM   @14,@03,@SA00003                                    0487 01635000
         ST    @05,@SA00003+24                                     0487 01636000
         ST    @07,@SA00003+28                                     0487 01637000
         STM   @09,@12,@SA00003+32                                 0487 01638000
*        OLDERID2 = NEWERID2;                                      0488 01639000
         L     @07,@PC00001                                        0488 01640000
         L     @15,GDTTR2(,@07)                                    0488 01641000
         MVC   @TS00001(95),NEWERID2(@15)                          0488 01642000
         MVC   OLDERID2(95,@15),@TS00001                           0488 01643000
*        NEWID2 = 'CCCI';                                  /*@YL026UD*/ 01644000
*                                                                  0489 01645000
         MVC   NEWID2(4,@15),@CC01135                              0489 01646000
*        /************************************************************/ 01647000
*        /*                                                  @YL026UD*/ 01648000
*        /*  OBTAIN STORAGE FOR SYSCTLG INDEX BLOCKS -       @YL026UD*/ 01649000
*        /*  ALLOW FOR 22 LEVELS OF INDEX BLOCKS             @YL026UD*/ 01650000
*        /*  ('UGPOOL' MACRO)                                @YL026UD*/ 01651000
*        /*                                                  @YL026UD*/ 01652000
*        /************************************************************/ 01653000
*                                                                  0490 01654000
*        BLKLVLEN = LVLMAX * LENGTH(BLOCK);                /*@YL026UD*/ 01655000
*                                                                  0490 01656000
         MVC   BLKLVLEN(4),@CF01297                                0490 01657000
*        CALL IDCSAGP0(GDTTBL,BLKLVLEN,BLKLVPTR,POOLID);   /*@YL026UD*/ 01658000
*                                                                  0491 01659000
         ST    @07,@AL00001                                        0491 01660000
         LA    @15,BLKLVLEN                                        0491 01661000
         ST    @15,@AL00001+4                                      0491 01662000
         LA    @15,BLKLVPTR                                        0491 01663000
         ST    @15,@AL00001+8                                      0491 01664000
         LA    @15,@CC00862                                        0491 01665000
         ST    @15,@AL00001+12                                     0491 01666000
         MVI   @AL00001+12,X'80'                                   0491 01667000
         L     @15,GDTGPL(,@07)                                    0491 01668000
         LA    @01,@AL00001                                        0491 01669000
         BALR  @14,@15                                             0491 01670000
*        RESPECIFY RTNREG RSTD;                                    0492 01671000
*        TESTRC = RTNREG;                                          0493 01672000
         LR    TESTRC,RTNREG                                       0493 01673000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 01674000
*                                                                  0494 01675000
*        IF TESTRC ^= 0                                            0495 01676000
*          THEN                                                    0495 01677000
         LTR   TESTRC,TESTRC                                       0495 01678000
         BZ    @RF00495                                            0495 01679000
*            DO;                                           /*@YL026UD*/ 01680000
*              /******************************************************/ 01681000
*              /*                                            @YL026UD*/ 01682000
*              /*  UNABLE TO OBTAIN STORAGE FOR SYSCTLG      @YL026UD*/ 01683000
*              /*  INDEX BLOCKS -                            @YL026UD*/ 01684000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 01685000
*              /*                                            @YL026UD*/ 01686000
*              /******************************************************/ 01687000
*                                                                  0497 01688000
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/ 01689000
         L     @07,DDSTRU                                          0497 01690000
         MVC   DARGSMOD(3,@07),@CC00849                            0497 01691000
*              DARGSENT = STORMSG#;                        /*@YL026UD*/ 01692000
*                                                                  0498 01693000
         MVI   DARGSENT(@07),X'04'                                 0498 01694000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 01695000
*                                                                  0499 01696000
         L     @07,@PC00001                                        0499 01697000
         ST    @07,@AL00001                                        0499 01698000
         LA    @05,@CF00113                                        0499 01699000
         ST    @05,@AL00001+4                                      0499 01700000
         LA    @05,DDSTRU                                          0499 01701000
         ST    @05,@AL00001+8                                      0499 01702000
         MVI   @AL00001+8,X'80'                                    0499 01703000
         L     @15,GDTPRT(,@07)                                    0499 01704000
         LA    @01,@AL00001                                        0499 01705000
         BALR  @14,@15                                             0499 01706000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 01707000
*                                                                  0500 01708000
         L     @07,@PC00001+8                                      0500 01709000
         MVC   LASTCOND(2,@07),@CH00037                            0500 01710000
*              LASTMSG = ON;                               /*@YL026UD*/ 01711000
*                                                                  0501 01712000
         OI    LASTMSG,B'10000000'                                 0501 01713000
*              RETURN;                                     /*@YL026UD*/ 01714000
@EL00003 DS    0H                                                  0502 01715000
@EF00003 DS    0H                                                  0502 01716000
@ER00003 LM    @14,@03,@SA00003                                    0502 01717000
         L     @05,@SA00003+24                                     0502 01718000
         L     @07,@SA00003+28                                     0502 01719000
         LM    @09,@12,@SA00003+32                                 0502 01720000
         BR    @14                                                 0502 01721000
*            END;                                          /*@YL026UD*/ 01722000
*                                                                  0503 01723000
*        /************************************************************/ 01724000
*        /*                                                  @YL026UD*/ 01725000
*        /*  OBTAIN STORAGE FOR CPL/FVT/FPL                  @YL026UD*/ 01726000
*        /*  (VSAM PARAMETER LISTS)                          @YL026UD*/ 01727000
*        /*  ('UGPOOL' MACRO)                                @YL026UD*/ 01728000
*        /*                                                  @YL026UD*/ 01729000
*        /*  CALCULATE LENGTHS TO                            @Y30SSMK*/ 01730000
*        /*  ALIGN CPL, FVT, AND FPLS ON FULLWORD            @YL026UD*/ 01731000
*        /*  BOUNDARIES                                      @YL026UD*/ 01732000
*        /*                                                  @YL026UD*/ 01733000
*        /************************************************************/ 01734000
*                                                                  0504 01735000
*        CPLLEN = ((LENGTH(CTGPL) + 12) / 4) * 4;          /*@YL026UD*/ 01736000
@RF00495 LA    @07,40                                              0504 01737000
         STH   @07,CPLLEN                                          0504 01738000
*        FVTLEN = ((LENGTH(CTGFV) + 12) / 4) * 4;          /*@YL026UD*/ 01739000
         LA    @15,104                                             0505 01740000
         STH   @15,FVTLEN                                          0505 01741000
*        FPLLEN = ((LENGTH(CTGFL) + 12) / 4) * 4;          /*@YL026UD*/ 01742000
*                                                                  0506 01743000
         LA    FPLLEN,28                                           0506 01744000
*        CATPLLEN = CPLLEN + FVTLEN + (4 * FPLLEN);        /*@YL026UD*/ 01745000
*                                                                  0507 01746000
         ALR   @07,@15                                             0507 01747000
         LR    @15,FPLLEN                                          0507 01748000
         SLA   @15,2                                               0507 01749000
         ALR   @07,@15                                             0507 01750000
         ST    @07,CATPLLEN                                        0507 01751000
*        CALL IDCSAGP0(GDTTBL,CATPLLEN,CATPLPTR,POOLID);   /*@YL026UD*/ 01752000
*                                                                  0508 01753000
         L     @07,@PC00001                                        0508 01754000
         ST    @07,@AL00001                                        0508 01755000
         LA    @15,CATPLLEN                                        0508 01756000
         ST    @15,@AL00001+4                                      0508 01757000
         LA    @15,CATPLPTR                                        0508 01758000
         ST    @15,@AL00001+8                                      0508 01759000
         LA    @15,@CC00862                                        0508 01760000
         ST    @15,@AL00001+12                                     0508 01761000
         MVI   @AL00001+12,X'80'                                   0508 01762000
         L     @15,GDTGPL(,@07)                                    0508 01763000
         LA    @01,@AL00001                                        0508 01764000
         BALR  @14,@15                                             0508 01765000
*        RESPECIFY RTNREG RSTD;                                    0509 01766000
*        TESTRC = RTNREG;                                          0510 01767000
         LR    TESTRC,RTNREG                                       0510 01768000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 01769000
*                                                                  0511 01770000
*        IF TESTRC ^= 0                                            0512 01771000
*          THEN                                                    0512 01772000
         LTR   TESTRC,TESTRC                                       0512 01773000
         BZ    @RF00512                                            0512 01774000
*            DO;                                           /*@YL026UD*/ 01775000
*              /******************************************************/ 01776000
*              /*                                            @YL026UD*/ 01777000
*              /*  UNABLE TO OBTAIN STORAGE FOR VSAM         @YL026UD*/ 01778000
*              /*  CATALOG PARAMETER LISTS -                 @YL026UD*/ 01779000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 01780000
*              /*                                            @YL026UD*/ 01781000
*              /******************************************************/ 01782000
*                                                                  0514 01783000
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/ 01784000
         L     @07,DDSTRU                                          0514 01785000
         MVC   DARGSMOD(3,@07),@CC00849                            0514 01786000
*              DARGSENT = STORMSG#;                        /*@YL026UD*/ 01787000
*                                                                  0515 01788000
         MVI   DARGSENT(@07),X'04'                                 0515 01789000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 01790000
*                                                                  0516 01791000
         L     @07,@PC00001                                        0516 01792000
         ST    @07,@AL00001                                        0516 01793000
         LA    @05,@CF00113                                        0516 01794000
         ST    @05,@AL00001+4                                      0516 01795000
         LA    @05,DDSTRU                                          0516 01796000
         ST    @05,@AL00001+8                                      0516 01797000
         MVI   @AL00001+8,X'80'                                    0516 01798000
         L     @15,GDTPRT(,@07)                                    0516 01799000
         LA    @01,@AL00001                                        0516 01800000
         BALR  @14,@15                                             0516 01801000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 01802000
*                                                                  0517 01803000
         L     @07,@PC00001+8                                      0517 01804000
         MVC   LASTCOND(2,@07),@CH00037                            0517 01805000
*              LASTMSG = ON;                               /*@YL026UD*/ 01806000
*                                                                  0518 01807000
         OI    LASTMSG,B'10000000'                                 0518 01808000
*              RETURN;                                     /*@YL026UD*/ 01809000
         B     @EL00003                                            0519 01810000
*            END;                                          /*@YL026UD*/ 01811000
*                                                                  0520 01812000
*        CTGPLPTR = CATPLPTR;                              /*@YL026UD*/ 01813000
*                                                                  0521 01814000
@RF00512 L     @07,CATPLPTR                                        0521 01815000
         LR    CTGPLPTR,@07                                        0521 01816000
*        CTGFVT   = CATPLPTR + CPLLEN;                     /*@YL026UD*/ 01817000
*                                                                  0522 01818000
         AH    @07,CPLLEN                                          0522 01819000
         ST    @07,CTGFVT(,CTGPLPTR)                               0522 01820000
*        DEVTFPL  = CATPLPTR + CPLLEN + FVTLEN;            /*@YL026UD*/ 01821000
         AH    @07,FVTLEN                                          0523 01822000
         ST    @07,DEVTFPL                                         0523 01823000
*        FSEQFPL  = DEVTFPL  + FPLLEN;                     /*@YL026UD*/ 01824000
         ALR   @07,FPLLEN                                          0524 01825000
         ST    @07,FSEQFPL                                         0524 01826000
*        ENTYPFPL = FSEQFPL  + FPLLEN;                     /*@YL026UD*/ 01827000
         ALR   @07,FPLLEN                                          0525 01828000
         ST    @07,ENTYPFPL                                        0525 01829000
*        CATVLFPL = ENTYPFPL + FPLLEN;                     /*@YL026UD*/ 01830000
*                                                                  0526 01831000
         ALR   @07,FPLLEN                                          0526 01832000
         ST    @07,CATVLFPL                                        0526 01833000
*        /************************************************************/ 01834000
*        /*                                                  @YL026UD*/ 01835000
*        /*  OBTAIN STORAGE FOR DEVICE CODE, VOLUME SERIAL,  @YL026UD*/ 01836000
*        /*  AND DATA SET SEQUENCE NUMBER LISTS              @YL026UD*/ 01837000
*        /*  ('UGPOOL' MACRO)                                @YL026UD*/ 01838000
*        /*                                                  @YL026UD*/ 01839000
*        /************************************************************/ 01840000
*                                                                  0527 01841000
*        DEVTLEN = VLISTMAX * LENGTH(DEVTLIST);            /*@YL026UD*/ 01842000
*                                                                  0527 01843000
         LA    @07,3072                                            0527 01844000
         STH   @07,DEVTLEN                                         0527 01845000
*        VOLLEN  = VLISTMAX * (LENGTH(VOLSERS) + 1);       /*@YL026UD*/ 01846000
*                                                                  0528 01847000
         LA    @15,2304                                            0528 01848000
         STH   @15,VOLLEN                                          0528 01849000
*        FILELEN = VLISTMAX * LENGTH(FILELIST);            /*@YL026UD*/ 01850000
*                                                                  0529 01851000
         LA    @14,512                                             0529 01852000
         STH   @14,FILELEN                                         0529 01853000
*        VINFOLEN = DEVTLEN + VOLLEN + FILELEN;            /*@YL026UD*/ 01854000
*                                                                  0530 01855000
         ALR   @07,@15                                             0530 01856000
         ALR   @07,@14                                             0530 01857000
         ST    @07,VINFOLEN                                        0530 01858000
*        CALL IDCSAGP0(GDTTBL,VINFOLEN,VINFOPTR,POOLID);   /*@YL026UD*/ 01859000
*                                                                  0531 01860000
         L     @07,@PC00001                                        0531 01861000
         ST    @07,@AL00001                                        0531 01862000
         LA    @15,VINFOLEN                                        0531 01863000
         ST    @15,@AL00001+4                                      0531 01864000
         LA    @15,VINFOPTR                                        0531 01865000
         ST    @15,@AL00001+8                                      0531 01866000
         LA    @15,@CC00862                                        0531 01867000
         ST    @15,@AL00001+12                                     0531 01868000
         MVI   @AL00001+12,X'80'                                   0531 01869000
         L     @15,GDTGPL(,@07)                                    0531 01870000
         LA    @01,@AL00001                                        0531 01871000
         BALR  @14,@15                                             0531 01872000
*        RESPECIFY RTNREG RSTD;                                    0532 01873000
*        TESTRC = RTNREG;                                          0533 01874000
         LR    TESTRC,RTNREG                                       0533 01875000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 01876000
*                                                                  0534 01877000
*        IF TESTRC ^= 0                                            0535 01878000
*          THEN                                                    0535 01879000
         LTR   TESTRC,TESTRC                                       0535 01880000
         BZ    @RF00535                                            0535 01881000
*            DO;                                           /*@YL026UD*/ 01882000
*              /******************************************************/ 01883000
*              /*                                            @YL026UD*/ 01884000
*              /*  UNABLE TO OBTAIN STORAGE                  @YL026UD*/ 01885000
*              /*  FOR REQUIRED LISTS -                      @YL026UD*/ 01886000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 01887000
*              /*                                            @YL026UD*/ 01888000
*              /******************************************************/ 01889000
*                                                                  0537 01890000
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/ 01891000
         L     @07,DDSTRU                                          0537 01892000
         MVC   DARGSMOD(3,@07),@CC00849                            0537 01893000
*              DARGSENT = STORMSG#;                        /*@YL026UD*/ 01894000
*                                                                  0538 01895000
         MVI   DARGSENT(@07),X'04'                                 0538 01896000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 01897000
*                                                                  0539 01898000
         L     @07,@PC00001                                        0539 01899000
         ST    @07,@AL00001                                        0539 01900000
         LA    @05,@CF00113                                        0539 01901000
         ST    @05,@AL00001+4                                      0539 01902000
         LA    @05,DDSTRU                                          0539 01903000
         ST    @05,@AL00001+8                                      0539 01904000
         MVI   @AL00001+8,X'80'                                    0539 01905000
         L     @15,GDTPRT(,@07)                                    0539 01906000
         LA    @01,@AL00001                                        0539 01907000
         BALR  @14,@15                                             0539 01908000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 01909000
*                                                                  0540 01910000
         L     @07,@PC00001+8                                      0540 01911000
         MVC   LASTCOND(2,@07),@CH00037                            0540 01912000
*              LASTMSG = ON;                               /*@YL026UD*/ 01913000
*                                                                  0541 01914000
         OI    LASTMSG,B'10000000'                                 0541 01915000
*              RETURN;                                     /*@YL026UD*/ 01916000
         B     @EL00003                                            0542 01917000
*            END;                                          /*@YL026UD*/ 01918000
*                                                                  0543 01919000
*        DEVTPTR = VINFOPTR;                               /*@YL026UD*/ 01920000
@RF00535 L     @07,VINFOPTR                                        0544 01921000
         ST    @07,DEVTPTR                                         0544 01922000
*        VOLPTR  = VINFOPTR + DEVTLEN;                     /*@YL026UD*/ 01923000
         AH    @07,DEVTLEN                                         0545 01924000
         ST    @07,VOLPTR                                          0545 01925000
*        FILEPTR = VOLPTR   + VOLLEN;                      /*@YL026UD*/ 01926000
*                                                                  0546 01927000
*                                                                  0546 01928000
         AH    @07,VOLLEN                                          0546 01929000
         ST    @07,FILEPTR                                         0546 01930000
*        /************************************************************/ 01931000
*        /*                                                  @YL026UD*/ 01932000
*        /*  OBTAIN STORAGE FOR (INITIAL) CATALOG WORKAREA - @YL026UD*/ 01933000
*        /*  THE WORKAREA IS REQUIRED FOR LOCATING ENTRIES   @YL026UD*/ 01934000
*        /*  IN THE VSAM CATALOG ('UGPOOL' MACRO)            @YL026UD*/ 01935000
*        /*                                                  @YL026UD*/ 01936000
*        /************************************************************/ 01937000
*                                                                  0547 01938000
*        WKASIZE = INITWKA;                                /*@YL026UD*/ 01939000
*                                                                  0547 01940000
         MVC   WKASIZE(4),@CF01036                                 0547 01941000
*        CALL IDCSAGP0(GDTTBL,WKASIZE,WKAPTR,POOLID,SETZERO);/*    0548 01942000
*                                                            @YL026UD*/ 01943000
*                                                                  0548 01944000
         L     @07,@PC00001                                        0548 01945000
         ST    @07,@AL00001                                        0548 01946000
         LA    @15,WKASIZE                                         0548 01947000
         ST    @15,@AL00001+4                                      0548 01948000
         LA    @15,WKAPTR                                          0548 01949000
         ST    @15,@AL00001+8                                      0548 01950000
         LA    @15,@CC00862                                        0548 01951000
         ST    @15,@AL00001+12                                     0548 01952000
         LA    @15,SETZERO                                         0548 01953000
         ST    @15,@AL00001+16                                     0548 01954000
         MVI   @AL00001+16,X'80'                                   0548 01955000
         L     @15,GDTGPL(,@07)                                    0548 01956000
         LA    @01,@AL00001                                        0548 01957000
         BALR  @14,@15                                             0548 01958000
*        RESPECIFY RTNREG RSTD;                                    0549 01959000
*        TESTRC = RTNREG;                                          0550 01960000
         LR    TESTRC,RTNREG                                       0550 01961000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 01962000
*                                                                  0551 01963000
*        IF TESTRC ^= 0                                            0552 01964000
*          THEN                                                    0552 01965000
         LTR   TESTRC,TESTRC                                       0552 01966000
         BZ    @RF00552                                            0552 01967000
*            DO;                                           /*@YL026UD*/ 01968000
*              /******************************************************/ 01969000
*              /*                                            @YL026UD*/ 01970000
*              /*  UNABLE TO OBTAIN STORAGE FOR WORKAREA -   @YL026UD*/ 01971000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 01972000
*              /*                                            @YL026UD*/ 01973000
*              /******************************************************/ 01974000
*                                                                  0554 01975000
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/ 01976000
         L     @07,DDSTRU                                          0554 01977000
         MVC   DARGSMOD(3,@07),@CC00849                            0554 01978000
*              DARGSENT = STORMSG#;                        /*@YL026UD*/ 01979000
*                                                                  0555 01980000
         MVI   DARGSENT(@07),X'04'                                 0555 01981000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 01982000
*                                                                  0556 01983000
         L     @07,@PC00001                                        0556 01984000
         ST    @07,@AL00001                                        0556 01985000
         LA    @05,@CF00113                                        0556 01986000
         ST    @05,@AL00001+4                                      0556 01987000
         LA    @05,DDSTRU                                          0556 01988000
         ST    @05,@AL00001+8                                      0556 01989000
         MVI   @AL00001+8,X'80'                                    0556 01990000
         L     @15,GDTPRT(,@07)                                    0556 01991000
         LA    @01,@AL00001                                        0556 01992000
         BALR  @14,@15                                             0556 01993000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 01994000
*                                                                  0557 01995000
         L     @07,@PC00001+8                                      0557 01996000
         MVC   LASTCOND(2,@07),@CH00037                            0557 01997000
*              LASTMSG = ON;                               /*@YL026UD*/ 01998000
*                                                                  0558 01999000
         OI    LASTMSG,B'10000000'                                 0558 02000000
*              RETURN;                                     /*@YL026UD*/ 02001000
         B     @EL00003                                            0559 02002000
*            END;                                          /*@YL026UD*/ 02003000
*                                                                  0560 02004000
*                                                                  0560 02005000
*        /************************************************************/ 02006000
*        /*                                                  @YL026UD*/ 02007000
*        /*  IF 'LIST' OPTION IS SPECIFIED OR DEFAULTED -    @YL026UD*/ 02008000
*        /*  OBTAIN AND ESTABLISH THE CNVTCAT SUBTITLE LINE  @YL026UD*/ 02009000
*        /*  ('UPRINT' AND 'UESTA' MACROS)                   @YL026UD*/ 02010000
*        /*                                                  @YL026UD*/ 02011000
*        /************************************************************/ 02012000
*                                                                  0561 02013000
*        IF ADDR(LIST) ^= NULLPTR  &  GDTECT = NULLPTR             0561 02014000
*          THEN                                                    0561 02015000
@RF00552 SLR   @05,@05                                             0561 02016000
         L     @15,@PC00001+4                                      0561 02017000
         C     @05,FDTPTR+36(,@15)                                 0561 02018000
         BE    @RF00561                                            0561 02019000
         L     @15,@PC00001                                        0561 02020000
         C     @05,GDTECT(,@15)                                    0561 02021000
         BNE   @RF00561                                            0561 02022000
*            DO;                                           /*@YL026UD*/ 02023000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 02024000
         L     @05,DDSTRU                                          0563 02025000
         MVC   DARGSMOD(3,@05),@CC00831                            0563 02026000
*              DARGSENT = SUBTMSG#;                        /*@YL026UD*/ 02027000
*                                                                  0564 02028000
         MVI   DARGSENT(@05),X'01'                                 0564 02029000
*              DARGRETP = ADDR(SUBTITLE);                  /*@YL026UD*/ 02030000
         LA    @14,SUBTITLE                                        0565 02031000
         ST    @14,DARGRETP(,@05)                                  0565 02032000
*              DARGRETL = LENGTH(SUBTITLE);                /*@YL026UD*/ 02033000
*                                                                  0566 02034000
         MVC   DARGRETL(2,@05),@CH01047                            0566 02035000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 02036000
*                                                                  0567 02037000
         ST    @15,@AL00001                                        0567 02038000
         LA    @05,@CF00113                                        0567 02039000
         ST    @05,@AL00001+4                                      0567 02040000
         LA    @05,DDSTRU                                          0567 02041000
         ST    @05,@AL00001+8                                      0567 02042000
         MVI   @AL00001+8,X'80'                                    0567 02043000
         L     @15,GDTPRT(,@15)                                    0567 02044000
         LA    @01,@AL00001                                        0567 02045000
         BALR  @14,@15                                             0567 02046000
*              DARGRETP = NULLPTR;                         /*@YL026UD*/ 02047000
         SLR   @05,@05                                             0568 02048000
         L     @15,DDSTRU                                          0568 02049000
         ST    @05,DARGRETP(,@15)                                  0568 02050000
*              DARGRETL = 0;                               /*@YL026UD*/ 02051000
*                                                                  0569 02052000
         STH   @05,DARGRETL(,@15)                                  0569 02053000
*              PCARGLST = '00'X;                           /*@YL026UD*/ 02054000
         XC    PCARGLST+1(33),PCARGLST+1                           0570 02055000
         MVI   PCARGLST,X'00'                                      0570 02056000
*              PCSTLP = ADDR(SUBTITLE);                    /*@YL026UD*/ 02057000
         LA    @05,SUBTITLE                                        0571 02058000
         ST    @05,PCSTLP                                          0571 02059000
*              PCSTLC = 1;                                 /*@YL026UD*/ 02060000
*                                                                  0572 02061000
         MVC   PCSTLC(2),@CH00215                                  0572 02062000
*              CALL AMSTP042(GDTTBL,PRTFILE,PCARGLST);     /*@YL026UD*/ 02063000
*                                                                  0573 02064000
         L     @05,@PC00001                                        0573 02065000
         ST    @05,@AL00001                                        0573 02066000
         LA    @15,@CF00113                                        0573 02067000
         ST    @15,@AL00001+4                                      0573 02068000
         LA    @15,PCARGLST                                        0573 02069000
         ST    @15,@AL00001+8                                      0573 02070000
         L     @15,GDTESA(,@05)                                    0573 02071000
         LA    @01,@AL00001                                        0573 02072000
         BALR  @14,@15                                             0573 02073000
*            END;                                          /*@YL026UD*/ 02074000
*                                                                  0574 02075000
*                                                                  0574 02076000
*        /************************************************************/ 02077000
*        /*                                                  @YL026UD*/ 02078000
*        /*  INITIALIZE FLAGS AND INDEXES USED FOR           @YL026UD*/ 02079000
*        /*  SCANNING THE SYSCTLG DATA SET                   @YL026UD*/ 02080000
*        /*                                                  @YL026UD*/ 02081000
*        /************************************************************/ 02082000
*                                                                  0575 02083000
*        DSNAME = ' ';                 /*INITIALIZE 'NULL'   @YL026UD*/ 02084000
@RF00561 MVI   DSNAME+1,C' '                                       0575 02085000
         MVC   DSNAME+2(42),DSNAME+1                               0575 02086000
         MVI   DSNAME,C' '                                         0575 02087000
*                                      /*DATA SET NAME       @YL026UD*/ 02088000
*                                                                  0576 02089000
*        DSNLEN = 0;                   /*DATA SET NAME LENGTH        */ 02090000
*                                                                  0576 02091000
         SLR   @05,@05                                             0576 02092000
         LR    DSNLEN,@05                                          0576 02093000
*        DSCBTTR = '00'X;              /*DSCB RELATIVE TRACK @YL026UD*/ 02094000
         XC    DSCBTTR+1(3),DSCBTTR+1                              0577 02095000
         MVI   DSCBTTR,X'00'                                       0577 02096000
*                                      /*ADDRESS (TTR)       @YL026UD*/ 02097000
*                                                                  0578 02098000
*        LVLINDEX = 1;                 /*PUSH-DOWN STACK INDEX       */ 02099000
*                                                                  0578 02100000
         MVC   LVLINDEX(2),@CH00215                                0578 02101000
*        CNVTCNT = 0;                  /*INITIALIZE COUNT    @YL026UD*/ 02102000
         ST    @05,CNVTCNT                                         0579 02103000
*                                      /*OF CONVERSTIONS     @YL026UD*/ 02104000
*        UPDTCNT = 0;                  /*INITIALIZE COUNT    @YL026UD*/ 02105000
         ST    @05,UPDTCNT                                         0580 02106000
*                                      /*OF UPDATED ENTRIES  @YL026UD*/ 02107000
*                                                                  0581 02108000
*        ALIASFLG = OFF;               /*'ALIAS ENTRY' FLAG  @YL026UD*/ 02109000
         NI    ALIASFLG,B'01111111'                                0581 02110000
*        TRUEFLG  = OFF;               /*'TRUE ENTRY'  FLAG  @YL026UD*/ 02111000
         NI    TRUEFLG,B'01111111'                                 0582 02112000
*        CVPEFLAG = OFF;               /*'CVPE ENTRY'  FLAG  @YL026UD*/ 02113000
         NI    CVPEFLAG,B'01111111'                                0583 02114000
*        GDGFLAG  = OFF;               /*'GDG BASE'    FLAG  @YL026UD*/ 02115000
         NI    GDGFLAG,B'01111111'                                 0584 02116000
*        G0V0FLAG = OFF;               /*'G0000V00'    FLAG  @YL026UD*/ 02117000
*                                                                  0585 02118000
         NI    G0V0FLAG,B'01111111'                                0585 02119000
*        ENDFLAG  = OFF;               /*'CONVERT PROCESSING @YL026UD*/ 02120000
         NI    ENDFLAG,B'01111111'                                 0586 02121000
*                                      /* COMPLETE' FLAG     @YL026UD*/ 02122000
*                                                                  0587 02123000
*        /************************************************************/ 02124000
*        /*                                                  @Y30SSMK*/ 02125000
*        /*  DUMP POINT AFTER STORAGE IS OBTAINED AND        @Y30SSMK*/ 02126000
*        /*  INITIALIZED.                                    @Y30SSMK*/ 02127000
*        /*                                                  @Y30SSMK*/ 02128000
*        /************************************************************/ 02129000
*                                                                  0587 02130000
*        IF GDTDBG = NULLPTR                                       0587 02131000
*          THEN;                                                   0587 02132000
         L     @07,@PC00001                                        0587 02133000
         C     @05,GDTDBG(,@07)                                    0587 02134000
         BE    @RT00587                                            0587 02135000
*          ELSE                                                    0589 02136000
*            CALL IDCDB010(GDTTBL,'CCIC');                         0589 02137000
         L     @07,@PC00001                                        0589 02138000
         ST    @07,@AL00001                                        0589 02139000
         LA    @05,@CC01136                                        0589 02140000
         ST    @05,@AL00001+4                                      0589 02141000
         MVI   @AL00001+4,X'80'                                    0589 02142000
         L     @15,GDTDBG(,@07)                                    0589 02143000
         LA    @01,@AL00001                                        0589 02144000
         BALR  @14,@15                                             0589 02145000
*                                                          /*@YL026UD*/ 02146000
*                                                                  0590 02147000
*        END CNVTINIT;                                     /*@YL026UD*/ 02148000
         B     @EL00003                                            0590 02149000
*/********************************************************************/ 02150000
*/*                                                          @YL026UD*/ 02151000
*/*  PROCEDURE NAME - VOLINDEX                               @YL026UD*/ 02152000
*/*                                                          @YL026UD*/ 02153000
*/*  FUNCTION - OBTAIN THE FIRST-LEVEL SYSCTLG DATA SET      @YL026UD*/ 02154000
*/*             INDEX (THE VOLUME INDEX)                     @YL026UD*/ 02155000
*/*                                                          @YL026UD*/ 02156000
*/*             VERIFY THAT THE FIRST INDEX ENTRY IS A       @YL026UD*/ 02157000
*/*             VOLUME INDEX CONTROL ENTRY ('VICE')          @YL026UD*/ 02158000
*/*                                                          @YL026UD*/ 02159000
*/*             IF THE FIRST VOLUME INDEX BLOCK CANNOT BE    @YL026UD*/ 02160000
*/*             OBTAINED, OR IF THE 'VICE' CANNOT BE         @YL026UD*/ 02161000
*/*             VERIFIED, PROCESSING IS TERMINATED           @YL026UD*/ 02162000
*/*                                                          @YL026UD*/ 02163000
*/*  INPUT - INITIAL SYSCTLG RELATIVE TRACK ADDRESS (TTR)    @YL026UD*/ 02164000
*/*          NEEDED TO OBTAIN THE VOLUME INDEX               @YL026UD*/ 02165000
*/*                                                          @YL026UD*/ 02166000
*/*  OUTPUT - THE ACQUIRED FIRST BLOCK OF THE SYSCTLG        @YL026UD*/ 02167000
*/*           VOLUME INDEX WITH SCANNING POINTERS            @YL026UD*/ 02168000
*/*           POSITIONED AFTER THE 'VICE'                    @YL026UD*/ 02169000
*/*                                                          @YL026UD*/ 02170000
*/********************************************************************/ 02171000
*                                                                  0591 02172000
*VOLINDEX: PROCEDURE;                                      /*@YL026UD*/ 02173000
VOLINDEX STM   @14,@02,@SA00004                                    0591 02174000
         STM   @04,@12,@SA00004+20                                 0591 02175000
*        OLDERID2 = NEWERID2;                                      0592 02176000
         L     @08,@PC00001                                        0592 02177000
         L     @04,GDTTR2(,@08)                                    0592 02178000
         MVC   @TS00001(95),NEWERID2(@04)                          0592 02179000
         MVC   OLDERID2(95,@04),@TS00001                           0592 02180000
*        NEWID2 = 'CCVX';                                  /*@YL026UD*/ 02181000
*                                                                  0593 02182000
         MVC   NEWID2(4,@04),@CC01140                              0593 02183000
*        /************************************************************/ 02184000
*        /*                                                  @YL026UD*/ 02185000
*        /*  OBTAIN THE FIRST-LEVEL SYSCTLG DATA SET INDEX   @YL026UD*/ 02186000
*        /*  (THE VOLUME INDEX) -                            @YL026UD*/ 02187000
*        /*                                                  @YL026UD*/ 02188000
*        /*  INITIALIZE THE RELATIVE TRACK ADDRESS (TTR)     @YL026UD*/ 02189000
*        /*  FOR THE INITIAL SYSCTLG INDEX BLOCK             @YL026UD*/ 02190000
*        /*                                                  @YL026UD*/ 02191000
*        /*  ISSUE 'UPOSIT'/'UGET' MACROS                    @YL026UD*/ 02192000
*        /*                                                  @YL026UD*/ 02193000
*        /************************************************************/ 02194000
*                                                                  0594 02195000
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/ 02196000
*                                                                  0594 02197000
         LH    @04,LVLINDEX                                        0594 02198000
         SLA   @04,8                                               0594 02199000
         L     @02,BLKLVPTR                                        0594 02200000
         AL    @02,@CF01312                                        0594 02201000
         LA    @04,BLOCK(@04,@02)                                  0594 02202000
         ST    @04,BLOCKPTR                                        0594 02203000
*        BLOCKTTR = FIRSTTTR;                              /*@YL026UD*/ 02204000
*                                                                  0595 02205000
         MVC   BLOCKTTR(4),FIRSTTTR                                0595 02206000
*        IIOCSPTR -> IOCTTR = BLOCKTTR;                    /*@YL026UD*/ 02207000
*                                                                  0596 02208000
         L     @04,IIOCSPTR                                        0596 02209000
         MVC   IOCTTR(4,@04),BLOCKTTR                              0596 02210000
*        CALL IDCIOPO0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 02211000
*                                                                  0597 02212000
         ST    @08,@AL00001                                        0597 02213000
         LA    @04,IIOCSPTR                                        0597 02214000
         ST    @04,@AL00001+4                                      0597 02215000
         MVI   @AL00001+4,X'80'                                    0597 02216000
         L     @15,GDTPOS(,@08)                                    0597 02217000
         LA    @01,@AL00001                                        0597 02218000
         BALR  @14,@15                                             0597 02219000
*        CALL IDCIOGT0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 02220000
*                                                                  0598 02221000
         L     @08,@PC00001                                        0598 02222000
         ST    @08,@AL00001                                        0598 02223000
         LA    @04,IIOCSPTR                                        0598 02224000
         ST    @04,@AL00001+4                                      0598 02225000
         MVI   @AL00001+4,X'80'                                    0598 02226000
         L     @15,GDTGET(,@08)                                    0598 02227000
         LA    @01,@AL00001                                        0598 02228000
         BALR  @14,@15                                             0598 02229000
*        RESPECIFY RTNREG RSTD;                                    0599 02230000
*        TESTRC = RTNREG;                                          0600 02231000
         LR    TESTRC,RTNREG                                       0600 02232000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 02233000
*                                                                  0601 02234000
*        IF TESTRC ^= 0                                            0602 02235000
*          THEN                                                    0602 02236000
         LTR   TESTRC,TESTRC                                       0602 02237000
         BZ    @RF00602                                            0602 02238000
*            DO;                                           /*@YL026UD*/ 02239000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 02240000
         L     @08,@PC00001+8                                      0604 02241000
         MVC   LASTCOND(2,@08),@CH00037                            0604 02242000
*              RETURN;                                     /*@YL026UD*/ 02243000
@EL00004 DS    0H                                                  0605 02244000
@EF00004 DS    0H                                                  0605 02245000
@ER00004 LM    @14,@02,@SA00004                                    0605 02246000
         LM    @04,@12,@SA00004+20                                 0605 02247000
         BR    @14                                                 0605 02248000
*            END;                                          /*@YL026UD*/ 02249000
*                                                                  0606 02250000
*        BLOCK(LVLINDEX) = BLKREAD;                        /*@YL026UD*/ 02251000
*                                                                  0607 02252000
@RF00602 LH    @08,LVLINDEX                                        0607 02253000
         SLA   @08,8                                               0607 02254000
         L     @02,BLKLVPTR                                        0607 02255000
         ALR   @02,@08                                             0607 02256000
         AL    @02,@CF01312                                        0607 02257000
         L     @08,IIOCSPTR                                        0607 02258000
         L     @08,IOCDAD(,@08)                                    0607 02259000
         MVC   BLOCK(256,@02),BLKREAD(@08)                         0607 02260000
*        CATPTR = BLOCKPTR + LENGTH(BLOCKCNT);             /*@YL026UD*/ 02261000
*                                                                  0608 02262000
         LA    CATPTR,2                                            0608 02263000
         AL    CATPTR,BLOCKPTR                                     0608 02264000
*        /************************************************************/ 02265000
*        /*                                                  @YL026UD*/ 02266000
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/ 02267000
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/ 02268000
*        /*  THE INPUT SYSCTLG BLOCK                         @YL026UD*/ 02269000
*        /*                                                  @YL026UD*/ 02270000
*        /************************************************************/ 02271000
*                                                                  0609 02272000
*                                                                  0609 02273000
*        IF GDTDBG = NULLPTR                                       0609 02274000
*          THEN;                                                   0609 02275000
         L     @08,@PC00001                                        0609 02276000
         L     @08,GDTDBG(,@08)                                    0609 02277000
         LTR   @08,@08                                             0609 02278000
         BZ    @RT00609                                            0609 02279000
*          ELSE                                                    0611 02280000
*            DO;                                                   0611 02281000
*              DMPINDEX = ADDR(DLISTBLK);                          0612 02282000
*                                                                  0612 02283000
         LA    DMPINDEX,DLISTBLK                                   0612 02284000
*              DMPITMNM = 'BLKLEVEL';                              0613 02285000
         MVC   DMPITMNM(8,DMPINDEX),@CC01141                       0613 02286000
*              DMPITMPT = ADDR(LVLINDEX);                          0614 02287000
         LA    @08,LVLINDEX                                        0614 02288000
         ST    @08,DMPITMPT(,DMPINDEX)                             0614 02289000
*              DMPITMLN = 2;                                       0615 02290000
         MVC   DMPITMLN(2,DMPINDEX),@CH00149                       0615 02291000
*              DMPITMTP = 'F';                                     0616 02292000
         MVI   DMPITMTP(DMPINDEX),C'F'                             0616 02293000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0617 02294000
*                                                                  0617 02295000
         LA    @08,16                                              0617 02296000
         ALR   DMPINDEX,@08                                        0617 02297000
*              DMPITMNM = 'BLOCKPTR';                              0618 02298000
         MVC   DMPITMNM(8,DMPINDEX),@CC01142                       0618 02299000
*              DMPITMPT = ADDR(BLOCKPTR);                          0619 02300000
         LA    @15,BLOCKPTR                                        0619 02301000
         ST    @15,DMPITMPT(,DMPINDEX)                             0619 02302000
*              DMPITMLN = 4;                                       0620 02303000
         MVC   DMPITMLN(2,DMPINDEX),@CH00042                       0620 02304000
*              DMPITMTP = 'H';                                     0621 02305000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0621 02306000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0622 02307000
*                                                                  0622 02308000
         ALR   DMPINDEX,@08                                        0622 02309000
*              DMPITMNM = 'BLOCK';                                 0623 02310000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0623 02311000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0623 02312000
         MVC   DMPITMNM(5,DMPINDEX),@CC01144                       0623 02313000
*              DMPITMPT = ADDR(BLKREAD);                           0624 02314000
         L     @01,IIOCSPTR                                        0624 02315000
         L     @15,IOCDAD(,@01)                                    0624 02316000
         ST    @15,DMPITMPT(,DMPINDEX)                             0624 02317000
*              DMPITMLN = 256;                                     0625 02318000
         MVC   DMPITMLN(2,DMPINDEX),@CH00823                       0625 02319000
*              DMPITMTP = 'H';                                     0626 02320000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0626 02321000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0627 02322000
*                                                                  0627 02323000
         ALR   DMPINDEX,@08                                        0627 02324000
*              DMPTRM = DMPTRMVL;                                  0628 02325000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0628 02326000
*            END;                                                  0629 02327000
*                                                                  0629 02328000
*        /************************************************************/ 02329000
*        /*                                                  @Y30SSMK*/ 02330000
*        /*  DUMP POINT TO DUMP FIRST BLOCK OF VOLUME INDEX. @Y30SSMK*/ 02331000
*        /*                                                  @Y30SSMK*/ 02332000
*        /************************************************************/ 02333000
*                                                                  0630 02334000
*        IF GDTDBG = NULLPTR                                       0630 02335000
*          THEN;                                                   0630 02336000
@RT00609 L     @08,@PC00001                                        0630 02337000
         L     @08,GDTDBG(,@08)                                    0630 02338000
         LTR   @08,@08                                             0630 02339000
         BZ    @RT00630                                            0630 02340000
*          ELSE                                                    0632 02341000
*            CALL IDCDB010(GDTTBL,'CCVI',ADDR(DLISTBLK));          0632 02342000
         L     @08,@PC00001                                        0632 02343000
         ST    @08,@AL00001                                        0632 02344000
         LA    @02,@CC01145                                        0632 02345000
         ST    @02,@AL00001+4                                      0632 02346000
         LA    @02,DLISTBLK                                        0632 02347000
         ST    @02,@AFTEMPS                                        0632 02348000
         LA    @02,@AFTEMPS                                        0632 02349000
         ST    @02,@AL00001+8                                      0632 02350000
         MVI   @AL00001+8,X'80'                                    0632 02351000
         L     @15,GDTDBG(,@08)                                    0632 02352000
         LA    @01,@AL00001                                        0632 02353000
         BALR  @14,@15                                             0632 02354000
*                                                          /*@YL026UD*/ 02355000
*                                                                  0633 02356000
*        /************************************************************/ 02357000
*        /*                                                  @YL026UD*/ 02358000
*        /*  VERIFY THAT THE FIRST INDEX ENTRY IS A          @YL026UD*/ 02359000
*        /*  VOLUME INDEX CONTROL ENTRY ('VICE')             @YL026UD*/ 02360000
*        /*                                                  @YL026UD*/ 02361000
*        /************************************************************/ 02362000
*                                                                  0633 02363000
*        IF CATETYPE = TYPEVICE                                    0633 02364000
*          THEN                                                    0633 02365000
@RT00630 CLC   CATETYPE(1,CATPTR),TYPEVICE                         0633 02366000
         BNE   @RF00633                                            0633 02367000
*            DO;                                           /*@YL026UD*/ 02368000
*              /******************************************************/ 02369000
*              /*                                            @YL026UD*/ 02370000
*              /*  ENTRY IS A 'VICE' -                       @YL026UD*/ 02371000
*              /*  BYPASS THE VICE ENTRY                     @YL026UD*/ 02372000
*              /*                                            @YL026UD*/ 02373000
*              /******************************************************/ 02374000
*                                                                  0635 02375000
*              CATPTR = CATPTR + (CATETYPE * 2)                    0635 02376000
*                       + LENGTH(CATFORM);                 /*@YL026UD*/ 02377000
         SLR   @08,@08                                             0635 02378000
         IC    @08,CATETYPE(,CATPTR)                               0635 02379000
         ALR   @08,@08                                             0635 02380000
         ALR   @08,CATPTR                                          0635 02381000
         AL    @08,@CF00037                                        0635 02382000
         LR    CATPTR,@08                                          0635 02383000
*            END;                                          /*@YL026UD*/ 02384000
*          ELSE                                                    0637 02385000
*            DO;                                           /*@YL026UD*/ 02386000
         B     @RC00633                                            0637 02387000
@RF00633 DS    0H                                                  0638 02388000
*              /******************************************************/ 02389000
*              /*                                            @YL026UD*/ 02390000
*              /*  ENTRY IS NOT A 'VICE' -                   @YL026UD*/ 02391000
*              /*  FURTHER SCANNING OF THE SYSCTLG DATA SET  @YL026UD*/ 02392000
*              /*  IS IMPOSSIBLE -                           @YL026UD*/ 02393000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 02394000
*              /*                                            @YL026UD*/ 02395000
*              /******************************************************/ 02396000
*                                                                  0638 02397000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 02398000
*                                                                  0638 02399000
         L     @08,DDSTRU                                          0638 02400000
         MVC   DARGSMOD(3,@08),@CC00831                            0638 02401000
*              DARGSENT = SCN1MSG#;                        /*@YL026UD*/ 02402000
*                                                                  0639 02403000
         MVI   DARGSENT(@08),X'05'                                 0639 02404000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 02405000
*                                                                  0640 02406000
         L     @08,@PC00001                                        0640 02407000
         ST    @08,@AL00001                                        0640 02408000
         LA    @02,@CF00113                                        0640 02409000
         ST    @02,@AL00001+4                                      0640 02410000
         LA    @02,DDSTRU                                          0640 02411000
         ST    @02,@AL00001+8                                      0640 02412000
         MVI   @AL00001+8,X'80'                                    0640 02413000
         L     @15,GDTPRT(,@08)                                    0640 02414000
         LA    @01,@AL00001                                        0640 02415000
         BALR  @14,@15                                             0640 02416000
*              DARGSENT = SCN2MSG#;                        /*@YL026UD*/ 02417000
*                                                                  0641 02418000
         L     @08,DDSTRU                                          0641 02419000
         MVI   DARGSENT(@08),X'06'                                 0641 02420000
*              DARGDBP = ADDR(VOLCONST);                   /*@YL026UD*/ 02421000
         LA    @02,@CC01092                                        0642 02422000
         ST    @02,DARGDBP(,@08)                                   0642 02423000
*              DARGILP = LENGTH(VOLCONST);                 /*@YL026UD*/ 02424000
*                                                                  0643 02425000
         MVC   DARGILP(2,@08),@CH00152                             0643 02426000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 02427000
*                                                                  0644 02428000
         L     @08,@PC00001                                        0644 02429000
         ST    @08,@AL00001                                        0644 02430000
         LA    @02,@CF00113                                        0644 02431000
         ST    @02,@AL00001+4                                      0644 02432000
         LA    @02,DDSTRU                                          0644 02433000
         ST    @02,@AL00001+8                                      0644 02434000
         MVI   @AL00001+8,X'80'                                    0644 02435000
         L     @15,GDTPRT(,@08)                                    0644 02436000
         LA    @01,@AL00001                                        0644 02437000
         BALR  @14,@15                                             0644 02438000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 02439000
*                                                                  0645 02440000
         L     @08,@PC00001+8                                      0645 02441000
         MVC   LASTCOND(2,@08),@CH00037                            0645 02442000
*              /******************************************************/ 02443000
*              /*                                            @Y30SSMK*/ 02444000
*              /*  DUMP POINT WHEN 'VICE' ENTRY IS NOT FOUND @Y30SSMK*/ 02445000
*              /*                                            @Y30SSMK*/ 02446000
*              /******************************************************/ 02447000
*                                                                  0646 02448000
*              IF GDTDBG = NULLPTR                                 0646 02449000
*                THEN;                                             0646 02450000
         L     @08,@PC00001                                        0646 02451000
         L     @08,GDTDBG(,@08)                                    0646 02452000
         LTR   @08,@08                                             0646 02453000
         BZ    @RT00646                                            0646 02454000
*                ELSE                                              0648 02455000
*                  CALL IDCDB010(GDTTBL,'CCVE');                   0648 02456000
         L     @08,@PC00001                                        0648 02457000
         ST    @08,@AL00001                                        0648 02458000
         LA    @02,@CC01146                                        0648 02459000
         ST    @02,@AL00001+4                                      0648 02460000
         MVI   @AL00001+4,X'80'                                    0648 02461000
         L     @15,GDTDBG(,@08)                                    0648 02462000
         LA    @01,@AL00001                                        0648 02463000
         BALR  @14,@15                                             0648 02464000
*                                                          /*@YL026UD*/ 02465000
*                                                                  0649 02466000
*              RETURN;                                     /*@YL026UD*/ 02467000
         B     @EL00004                                            0649 02468000
*            END;                                          /*@YL026UD*/ 02469000
*                                                                  0650 02470000
*        END VOLINDEX;                                     /*@YL026UD*/ 02471000
         B     @EL00004                                            0651 02472000
*/********************************************************************/ 02473000
*/*                                                          @YL026UD*/ 02474000
*/*  PROCEDURE NAME - AEPROC                                 @YL026UD*/ 02475000
*/*                                                          @YL026UD*/ 02476000
*/*  FUNCTION - PROCESSING OF SYSCTLG ALIAS ENTRIES ('AE')   @YL026UD*/ 02477000
*/*                                                          @YL026UD*/ 02478000
*/*             THE TRUE NAME OF THE ENTRY IS SAVED          @YL026UD*/ 02479000
*/*                                                          @YL026UD*/ 02480000
*/*             THE 'ALIAS PROCESSING' FLAG IS TURNED ON     @YL026UD*/ 02481000
*/*             TO INDICATE THAT AN ALIAS ENTRY IS BEING     @YL026UD*/ 02482000
*/*             CONVERTED TO A VSAM CATALOG ALIAS ENTRY      @YL026UD*/ 02483000
*/*                                                          @YL026UD*/ 02484000
*/*  INPUT - (1) THE SYSCTLG ALIAS ENTRY                     @YL026UD*/ 02485000
*/*          (2) AN AREA TO SAVE THE TRUE NAME OF THE        @YL026UD*/ 02486000
*/*              ALIAS ENTRY                                 @YL026UD*/ 02487000
*/*                                                          @YL026UD*/ 02488000
*/*  OUTPUT - THE ALIAS NAME IS ADDED TO THE DATA SET NAME   @YL026UD*/ 02489000
*/*           BEING BUILT                                    @YL026UD*/ 02490000
*/*                                                          @YL026UD*/ 02491000
*/*           THE TRUE NAME IS SAVED FOR USE WHEN DEFINING   @YL026UD*/ 02492000
*/*           THE ALIAS DATA SET NAME(S) TO THE VSAM CATALOG @YL026UD*/ 02493000
*/*                                                          @YL026UD*/ 02494000
*/*           SCANNING CONTINUES AT THE NEXT LOWER INDEX     @YL026UD*/ 02495000
*/*           LEVEL TO OBTAIN ALL DATA SETS UNDER THIS       @YL026UD*/ 02496000
*/*           ALIAS SPECIFICATION                            @YL026UD*/ 02497000
*/*                                                          @YL026UD*/ 02498000
*/********************************************************************/ 02499000
*                                                                  0652 02500000
*AEPROC:   PROCEDURE;                                      /*@YL026UD*/ 02501000
AEPROC   STM   @14,@02,@SA00005                                    0652 02502000
         STM   @04,@05,@SA00005+20                                 0652 02503000
         STM   @07,@12,@SA00005+28                                 0652 02504000
*        OLDERID2 = NEWERID2;                                      0653 02505000
         L     @08,@PC00001                                        0653 02506000
         L     @08,GDTTR2(,@08)                                    0653 02507000
         MVC   @TS00001(95),NEWERID2(@08)                          0653 02508000
         MVC   OLDERID2(95,@08),@TS00001                           0653 02509000
*        NEWID2 = 'CCAP';                                  /*@YL026UD*/ 02510000
*                                                                  0654 02511000
         MVC   NEWID2(4,@08),@CC01150                              0654 02512000
*        /************************************************************/ 02513000
*        /*                                                  @YL026UD*/ 02514000
*        /*  SAVE THE 'TRUE' NAME FROM THE AE ENTRY          @YL026UD*/ 02515000
*        /*  (AND DETERMINE ITS LENGTH)                      @YL026UD*/ 02516000
*        /*                                                  @YL026UD*/ 02517000
*        /************************************************************/ 02518000
*                                                                  0655 02519000
*        TRUENAME = AETRUEN;                               /*@YL026UD*/ 02520000
*                                                                  0655 02521000
         MVC   TRUENAME(8),AETRUEN(CATPTR)                         0655 02522000
*        TRUENLEN = 0;                                     /*@YL026UD*/ 02523000
*                                                                  0656 02524000
         SLR   @08,@08                                             0656 02525000
         STH   @08,TRUENLEN                                        0656 02526000
*        DO INDEX = LENGTH(TRUENAME) TO 1 BY -1                    0657 02527000
*                    WHILE(TRUENLEN = 0);                  /*@YL026UD*/ 02528000
*                                                                  0657 02529000
         LA    INDEX,8                                             0657 02530000
@DL00657 LH    @08,TRUENLEN                                        0657 02531000
         LTR   @08,@08                                             0657 02532000
         BNZ   @DC00657                                            0657 02533000
*          IF TRUENAME(INDEX) ^= BLANK                             0658 02534000
*            THEN                                                  0658 02535000
         LA    @08,TRUENAME-1(INDEX)                               0658 02536000
         CLI   0(@08),C' '                                         0658 02537000
         BE    @RF00658                                            0658 02538000
*              TRUENLEN = INDEX;                           /*@YL026UD*/ 02539000
*                                                                  0659 02540000
         STH   INDEX,TRUENLEN                                      0659 02541000
*        END;                                              /*@YL026UD*/ 02542000
*                                                                  0660 02543000
@RF00658 BCTR  INDEX,0                                             0660 02544000
         LTR   INDEX,INDEX                                         0660 02545000
         BP    @DL00657                                            0660 02546000
@DC00657 DS    0H                                                  0661 02547000
*        /************************************************************/ 02548000
*        /*                                                  @YL026UD*/ 02549000
*        /*  TURN ON 'ALIAS PROCESSING' FLAG, AND            @YL026UD*/ 02550000
*        /*  CONTINUE SCANNING AT NEXT-LOWER INDEX LEVEL     @YL026UD*/ 02551000
*        /*                                                  @YL026UD*/ 02552000
*        /************************************************************/ 02553000
*                                                                  0661 02554000
*        ALIASFLG = ON;                                    /*@YL026UD*/ 02555000
*                                                                  0661 02556000
         OI    ALIASFLG,B'10000000'                                0661 02557000
*        CALL PUSHDOWN;                                    /*@YL026UD*/ 02558000
*                                                                  0662 02559000
         BAL   @14,PUSHDOWN                                        0662 02560000
*        END AEPROC;                                       /*@YL026UD*/ 02561000
@EL00005 DS    0H                                                  0663 02562000
@EF00005 DS    0H                                                  0663 02563000
@ER00005 LM    @14,@02,@SA00005                                    0663 02564000
         LM    @04,@05,@SA00005+20                                 0663 02565000
         LM    @07,@12,@SA00005+28                                 0663 02566000
         BR    @14                                                 0663 02567000
*/********************************************************************/ 02568000
*/*                                                          @YL026UD*/ 02569000
*/*  PROCEDURE NAME - ILEPROC                                @YL026UD*/ 02570000
*/*                                                          @YL026UD*/ 02571000
*/*  FUNCTION - PROCESSING OF SYSCTLG INDEX LINK ENTRIES     @YL026UD*/ 02572000
*/*             ('ILE')                                      @YL026UD*/ 02573000
*/*                                                          @YL026UD*/ 02574000
*/*             DETERMINES IF CONVERSION PROCESSING IS       @YL026UD*/ 02575000
*/*             (1) COMPLETE FOR ENTIRE SYSCTLG DATA SET,    @YL026UD*/ 02576000
*/*             (2) COMPLETE FOR A PARTICULAR INDEX LEVEL,   @YL026UD*/ 02577000
*/*             (3) CONTINUED IN ANOTHER INDEX BLOCK AT      @YL026UD*/ 02578000
*/*                 THE SAME INDEX LEVEL                     @YL026UD*/ 02579000
*/*                                                          @YL026UD*/ 02580000
*/*             IF CONVERSION PROCESSING IS COMPLETE FOR     @YL026UD*/ 02581000
*/*             ENTIRE SYSCTLG DATA SET, A 'PROCESSING       @YL026UD*/ 02582000
*/*             COMPLETE' FLAG IS TURNED ON                  @YL026UD*/ 02583000
*/*                                                          @YL026UD*/ 02584000
*/*             IF CONVERSION PROCESSING IS COMPLETE FOR     @YL026UD*/ 02585000
*/*             A PARTICULAR INDEX LEVEL, THE 'POP' FLAG     @YL026UD*/ 02586000
*/*             IS TURNED ON, TO INDICATE THAT SCANNING      @YL026UD*/ 02587000
*/*             IS TO RETURN TO A HIGHER INDEX LEVEL         @YL026UD*/ 02588000
*/*                                                          @YL026UD*/ 02589000
*/*             IF CONVERSION PROCESSING IS CONTINUED IN     @YL026UD*/ 02590000
*/*             ANOTHER INDEX BLOCK, THE 'CONTINUE' FLAG     @YL026UD*/ 02591000
*/*             IF TURNED ON, TO OBTAIN THE CONTINUATION     @YL026UD*/ 02592000
*/*             INDEX BLOCK                                  @YL026UD*/ 02593000
*/*                                                          @YL026UD*/ 02594000
*/*  INPUT - THE SYSCTLG INDEX LINK ENTRY                    @YL026UD*/ 02595000
*/*                                                          @YL026UD*/ 02596000
*/*  OUTPUT - (1) SCANNING CONTINUES WITHIN THE SAME INDEX   @YL026UD*/ 02597000
*/*               LEVEL CONTINUATION BLOCK ('ILE' TTR ^= 0)  @YL026UD*/ 02598000
*/*           (2) SCANNING CONTINUES WITHIN THE NEXT HIGHER  @YL026UD*/ 02599000
*/*               LEVEL INDEX BLOCK ('ILE' TTR = 0), OR      @YL026UD*/ 02600000
*/*           (3) SCANNING IS COMPLETE, AND THE 'PROCESSING  @YL026UD*/ 02601000
*/*               COMPLETE' FLAG IS TURNED ON                @YL026UD*/ 02602000
*/*               (VOLUME INDEX 'ILE' TTR = 0)               @YL026UD*/ 02603000
*/*                                                          @YL026UD*/ 02604000
*/********************************************************************/ 02605000
*                                                                  0664 02606000
*ILEPROC:  PROCEDURE;                                      /*@YL026UD*/ 02607000
ILEPROC  STM   @14,@02,@SA00006                                    0664 02608000
         STM   @04,@05,@SA00006+20                                 0664 02609000
         STM   @07,@12,@SA00006+28                                 0664 02610000
*        OLDERID2 = NEWERID2;                                      0665 02611000
         L     @08,@PC00001                                        0665 02612000
         L     @08,GDTTR2(,@08)                                    0665 02613000
         MVC   @TS00001(95),NEWERID2(@08)                          0665 02614000
         MVC   OLDERID2(95,@08),@TS00001                           0665 02615000
*        NEWID2 = 'CCIP';                                  /*@YL026UD*/ 02616000
*                                                                  0666 02617000
         MVC   NEWID2(4,@08),@CC01155                              0666 02618000
*        /************************************************************/ 02619000
*        /*                                                  @YL026UD*/ 02620000
*        /*  DETERMINE IF THE ILE TTR CONTAINS ZERO          @YL026UD*/ 02621000
*        /*                                                  @YL026UD*/ 02622000
*        /************************************************************/ 02623000
*                                                                  0667 02624000
*        IF ILETTR = ZEROTTR                                       0667 02625000
*          THEN                                                    0667 02626000
         CLC   ILETTR(3,CATPTR),ZEROTTR                            0667 02627000
         BNE   @RF00667                                            0667 02628000
*ILEZERO:    DO;                                           /*@YL026UD*/ 02629000
ILEZERO  DS    0H                                                  0669 02630000
*              /******************************************************/ 02631000
*              /*                                            @YL026UD*/ 02632000
*              /*  ILE TTR CONTAINS ZERO -                   @YL026UD*/ 02633000
*              /*  FINAL ENTRY FOR CURRENT INDEX LEVEL       @YL026UD*/ 02634000
*              /*                                            @YL026UD*/ 02635000
*              /*  DETERMINE IF AT VOLUME INDEX LEVEL        @YL026UD*/ 02636000
*              /*                                            @YL026UD*/ 02637000
*              /******************************************************/ 02638000
*                                                                  0669 02639000
*              IF LVLINDEX = 1                                     0669 02640000
*                THEN                                              0669 02641000
         CLC   LVLINDEX(2),@CH00215                                0669 02642000
         BNE   @RF00669                                            0669 02643000
*                  DO;                                     /*@YL026UD*/ 02644000
*                    /************************************************/ 02645000
*                    /*                                      @YL026UD*/ 02646000
*                    /*  ILE IS FINAL ENTRY OF VOLUME INDEX  @YL026UD*/ 02647000
*                    /*  (ENTIRE CATALOG HAS BEEN SCANNED)   @YL026UD*/ 02648000
*                    /*                                      @YL026UD*/ 02649000
*                    /*  SET END FLAG TO INDICATE THAT       @YL026UD*/ 02650000
*                    /*  PROCESSING IS COMPLETE              @YL026UD*/ 02651000
*                    /*                                      @YL026UD*/ 02652000
*                    /************************************************/ 02653000
*                                                                  0671 02654000
*                    ENDFLAG = ON;                         /*@YL026UD*/ 02655000
         OI    ENDFLAG,B'10000000'                                 0671 02656000
*                  END;                                    /*@YL026UD*/ 02657000
*                ELSE                                              0673 02658000
*                  DO;                                     /*@YL026UD*/ 02659000
         B     @RC00669                                            0673 02660000
@RF00669 DS    0H                                                  0674 02661000
*                    /************************************************/ 02662000
*                    /*                                      @YL026UD*/ 02663000
*                    /*  ILE IS FINAL ENTRY OF LOWER-LEVEL   @YL026UD*/ 02664000
*                    /*  INDEX -                             @YL026UD*/ 02665000
*                    /*                                      @YL026UD*/ 02666000
*                    /*  TURN OFF 'GENERATION INDEX          @YL026UD*/ 02667000
*                    /*  PROCESSING' (G0000V00) FLAG         @YL026UD*/ 02668000
*                    /*                                      @YL026UD*/ 02669000
*                    /*  CONTINUE SCANNING AT HIGHER-LEVEL   @YL026UD*/ 02670000
*                    /*  INDEX (POP-UP INDEX STATUS FROM     @YL026UD*/ 02671000
*                    /*  PUSH-DOWN STACK)                    @YL026UD*/ 02672000
*                    /*                                      @YL026UD*/ 02673000
*                    /************************************************/ 02674000
*                                                                  0674 02675000
*                    G0V0FLAG = OFF;                       /*@YL026UD*/ 02676000
*                                                                  0674 02677000
         NI    G0V0FLAG,B'01111111'                                0674 02678000
*                    CALL POPUP;                           /*@YL026UD*/ 02679000
         BAL   @14,POPUP                                           0675 02680000
*                  END;                                    /*@YL026UD*/ 02681000
*            END ILEZERO;                                  /*@YL026UD*/ 02682000
*          ELSE                                                    0678 02683000
*ILENZERO:   DO;                                           /*@YL026UD*/ 02684000
         B     @RC00667                                            0678 02685000
@RF00667 DS    0H                                                  0678 02686000
ILENZERO DS    0H                                                  0679 02687000
*              /******************************************************/ 02688000
*              /*                                            @YL026UD*/ 02689000
*              /*  ILE TTR DOES NOT CONTAIN ZERO -           @YL026UD*/ 02690000
*              /*  INDEX IS CONTINUED IN ANOTHER INDEX BLOCK @YL026UD*/ 02691000
*              /*                                            @YL026UD*/ 02692000
*              /*  OBTAIN CONTINUATION INDEX BLOCK           @YL026UD*/ 02693000
*              /*                                            @YL026UD*/ 02694000
*              /******************************************************/ 02695000
*                                                                  0679 02696000
*              CALL CONTINUE;                              /*@YL026UD*/ 02697000
*                                                                  0679 02698000
         BAL   @14,CONTINUE                                        0679 02699000
*            END ILENZERO;                                 /*@YL026UD*/ 02700000
*                                                                  0680 02701000
*        END ILEPROC;                                      /*@YL026UD*/ 02702000
@EL00006 DS    0H                                                  0681 02703000
@EF00006 DS    0H                                                  0681 02704000
@ER00006 LM    @14,@02,@SA00006                                    0681 02705000
         LM    @04,@05,@SA00006+20                                 0681 02706000
         LM    @07,@12,@SA00006+28                                 0681 02707000
         BR    @14                                                 0681 02708000
*/********************************************************************/ 02709000
*/*                                                          @YL026UD*/ 02710000
*/*  PROCEDURE NAME - DSPEPROC                               @YL026UD*/ 02711000
*/*                                                          @YL026UD*/ 02712000
*/*  FUNCTION -PROCESSING OF SYSCTLG DATA SET POINTER        @YL026UD*/ 02713000
*/*            ENTRIES ('DSPE')                              @YL026UD*/ 02714000
*/*                                                          @YL026UD*/ 02715000
*/*            THE FOLLOWING ARE EXTRACTED FROM THE DSPE -   @YL026UD*/ 02716000
*/*            (1) FINAL SEGMENT OF THE DATA SET NAME        @YL026UD*/ 02717000
*/*            (2) DSCB RELATIVE TRACK ADDRESS (TTR)         @YL026UD*/ 02718000
*/*            (3) DATA SET VOLUME INFORMATION               @YL026UD*/ 02719000
*/*                                                          @YL026UD*/ 02720000
*/*            THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE  @YL026UD*/ 02721000
*/*            THE CONVERTED 'NONVSAM' OR 'ALIAS' ENTRY      @YL026UD*/ 02722000
*/*            IN THE VSAM CATALOG                           @YL026UD*/ 02723000
*/*                                                          @YL026UD*/ 02724000
*/*  INPUT - (1) THE SYSCTLG DATA SET POINTER ENTRY          @YL026UD*/ 02725000
*/*          (2) THE ACQUIRED STORAGE AREA FOR THE DEVICE    @YL026UD*/ 02726000
*/*              TYPE LIST, VOLUME SERIAL LIST, AND FILE     @YL026UD*/ 02727000
*/*              SEQUENCE NUMBER LIST                        @YL026UD*/ 02728000
*/*                                                          @YL026UD*/ 02729000
*/*  OUTPUT - THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/ 02730000
*/*           'DSPE' TO A 'NONVSAM' OR 'ALIAS' ENTRY IN      @YL026UD*/ 02731000
*/*           THE VSAM CATALOG                               @YL026UD*/ 02732000
*/*                                                          @YL026UD*/ 02733000
*/*           SCANNING CONTINUES WITHIN THE SAME INDEX       @YL026UD*/ 02734000
*/*           BLOCK IMMEDIATELY FOLLOWING THE 'DSPE'         @YL026UD*/ 02735000
*/*                                                          @YL026UD*/ 02736000
*/********************************************************************/ 02737000
*                                                                  0682 02738000
*DSPEPROC: PROCEDURE;                                      /*@YL026UD*/ 02739000
DSPEPROC STM   @14,@02,@SA00007                                    0682 02740000
         STM   @04,@05,@SA00007+20                                 0682 02741000
         STM   @08,@12,@SA00007+28                                 0682 02742000
*        OLDERID2 = NEWERID2;                                      0683 02743000
         L     @07,@PC00001                                        0683 02744000
         L     @07,GDTTR2(,@07)                                    0683 02745000
         MVC   @TS00001(95),NEWERID2(@07)                          0683 02746000
         MVC   OLDERID2(95,@07),@TS00001                           0683 02747000
*        NEWID2 = 'CCDP';                                  /*@YL026UD*/ 02748000
*                                                                  0684 02749000
         MVC   NEWID2(4,@07),@CC01165                              0684 02750000
*        /************************************************************/ 02751000
*        /*                                                  @YL026UD*/ 02752000
*        /*  ADD FINAL SEGMENT (DSPE NAME) TO DATA SET NAME  @YL026UD*/ 02753000
*        /*                                                  @YL026UD*/ 02754000
*        /************************************************************/ 02755000
*                                                                  0685 02756000
*        DSNAME(DSNLEN+1:DSNLEN+9) = DSPENAME;             /*@YL026UD*/ 02757000
*                                                                  0685 02758000
         LA    @07,DSNAME(DSNLEN)                                  0685 02759000
         MVI   8(@07),C' '                                         0685 02760000
         MVC   0(8,@07),DSPENAME(CATPTR)                           0685 02761000
*        DSNLEN = DSNLEN + LENGTH(DSPENAME);               /*@YL026UD*/ 02762000
*                                                                  0686 02763000
         AL    DSNLEN,@CF00175                                     0686 02764000
*        /************************************************************/ 02765000
*        /*                                                  @YL026UD*/ 02766000
*        /*  EXTRACT DSCB TTR FROM THE DSPE ENTRY            @YL026UD*/ 02767000
*        /*                                                  @YL026UD*/ 02768000
*        /************************************************************/ 02769000
*                                                                  0687 02770000
*        DSCBTTR(1:3) = DSPETTR;                           /*@YL026UD*/ 02771000
*                                                                  0687 02772000
         MVC   DSCBTTR(3),DSPETTR(CATPTR)                          0687 02773000
*        /************************************************************/ 02774000
*        /*                                                  @YL026UD*/ 02775000
*        /*  EXTRACT VOLUME INFORMATION FROM THE SYSCTLG     @YL026UD*/ 02776000
*        /*  ENTRY TO BE USED IN 'DEFINING' THE VSAM         @YL026UD*/ 02777000
*        /*  CATALOG ENTRY                                   @YL026UD*/ 02778000
*        /*                                                  @YL026UD*/ 02779000
*        /************************************************************/ 02780000
*                                                                  0688 02781000
*        VOLCNT = DSPEVCNT;                                /*@YL026UD*/ 02782000
*                                                                  0688 02783000
         LH    @07,DSPEVCNT(,CATPTR)                               0688 02784000
         STH   @07,VOLCNT                                          0688 02785000
*        VOLSTLEN = DSPEVCNT * LENGTH(VOLSERS);            /*@YL026UD*/ 02786000
*                                                                  0689 02787000
         SLA   @07,3                                               0689 02788000
         L     @05,VOLPTR                                          0689 02789000
         STH   @07,VOLSTLEN(,@05)                                  0689 02790000
*        DO DSPEINDX = 1 TO DSPEVCNT;                      /*@YL026UD*/ 02791000
*                                                                  0690 02792000
         LA    DSPEINDX,1                                          0690 02793000
         B     @DE00690                                            0690 02794000
@DL00690 DS    0H                                                  0691 02795000
*          DEVTUNIT(DSPEINDX) = ' ';                       /*@YL026UD*/ 02796000
         L     @07,DEVTPTR                                         0691 02797000
         LR    @05,DSPEINDX                                        0691 02798000
         MH    @05,@CH00037                                        0691 02799000
         ST    @05,@TF00001                                        0691 02800000
         ALR   @05,@07                                             0691 02801000
         AL    @05,@CF01313                                        0691 02802000
         MVI   DEVTUNIT+1(@05),C' '                                0691 02803000
         MVC   DEVTUNIT+2(6,@05),DEVTUNIT+1(@05)                   0691 02804000
         MVI   DEVTUNIT(@05),C' '                                  0691 02805000
*          DEVTCODE(DSPEINDX) = DSPEDEVT(DSPEINDX);        /*@YL026UD*/ 02806000
*                                                                  0692 02807000
         AL    @07,@TF00001                                        0692 02808000
         AL    @07,@CF01314                                        0692 02809000
         LR    @05,CATPTR                                          0692 02810000
         AL    @05,@TF00001                                        0692 02811000
         MVC   DEVTCODE-8(4,@07),DSPEDEVT-12(@05)                  0692 02812000
*          VOLZERO(DSPEINDX) = 0;                          /*@YL026UD*/ 02813000
         L     @07,VOLPTR                                          0693 02814000
         LR    @05,DSPEINDX                                        0693 02815000
         SLA   @05,3                                               0693 02816000
         SLR   @15,@15                                             0693 02817000
         LA    @14,0(@05,@07)                                      0693 02818000
         AL    @14,@CF01315                                        0693 02819000
         STH   @15,VOLZERO-2(,@14)                                 0693 02820000
*          VOLSER(DSPEINDX)  = DSPEDVOL(DSPEINDX);         /*@YL026UD*/ 02821000
*                                                                  0694 02822000
         ALR   @07,@05                                             0694 02823000
         AL    @07,@CF01314                                        0694 02824000
         LR    @05,CATPTR                                          0694 02825000
         AL    @05,@TF00001                                        0694 02826000
         MVC   VOLSER-4(6,@07),DSPEDVOL-12(@05)                    0694 02827000
*          FILESEQ(DSPEINDX) = DSPEDSEQ(DSPEINDX);         /*@YL026UD*/ 02828000
         LR    @07,DSPEINDX                                        0695 02829000
         ALR   @07,@07                                             0695 02830000
         L     @05,FILEPTR                                         0695 02831000
         ALR   @05,@07                                             0695 02832000
         AL    @05,@CF01316                                        0695 02833000
         LR    @07,CATPTR                                          0695 02834000
         AL    @07,@TF00001                                        0695 02835000
         MVC   FILESEQ(2,@05),DSPEDSEQ-12(@07)                     0695 02836000
*        END;                                              /*@YL026UD*/ 02837000
*                                                                  0696 02838000
         AL    DSPEINDX,@CF00215                                   0696 02839000
@DE00690 CH    DSPEINDX,DSPEVCNT(,CATPTR)                          0696 02840000
         BNH   @DL00690                                            0696 02841000
*        /************************************************************/ 02842000
*        /*                                                  @YL026UD*/ 02843000
*        /*  INITIALIZE CPL/FVT/FPL AND ISSUE CATALOG-ADD    @YL026UD*/ 02844000
*        /*  REQUEST TO 'DEFINE' NONVSAM ENTRY               @YL026UD*/ 02845000
*        /*                                                  @YL026UD*/ 02846000
*        /************************************************************/ 02847000
*                                                                  0697 02848000
*        CALL CATALOG;                                     /*@YL026UD*/ 02849000
*                                                                  0697 02850000
         BAL   @14,CATALOG                                         0697 02851000
*        /************************************************************/ 02852000
*        /*                                                  @YL026UD*/ 02853000
*        /*  DETERMINE IF ADDITIONAL CATALOG-ADD REQUEST IS  @YL026UD*/ 02854000
*        /*  NECESSARY TO 'DEFINE' ALIAS ENTRY               @YL026UD*/ 02855000
*        /*                                                  @YL026UD*/ 02856000
*        /*  THIS IS NECESSARY IF THE PREVIOUS CATALOG-ADD   @YL026UD*/ 02857000
*        /*  REQUEST WAS FOR AN ALIAS DATA SET NAME, BUT THE @YL026UD*/ 02858000
*        /*  REQUEST WAS NEEDED TO 'DEFINE' THE RELATED      @YL026UD*/ 02859000
*        /*  TRUE DATA SET NAME FIRST ('TRUEFLG' = ON)       @YL026UD*/ 02860000
*        /*                                                  @YL026UD*/ 02861000
*        /************************************************************/ 02862000
*                                                                  0698 02863000
*        IF TRUEFLG = ON                                           0698 02864000
*          THEN                                                    0698 02865000
         TM    TRUEFLG,B'10000000'                                 0698 02866000
         BNO   @RF00698                                            0698 02867000
*            CALL CATALOG;                                 /*@YL026UD*/ 02868000
*                                                                  0699 02869000
         BAL   @14,CATALOG                                         0699 02870000
*        /************************************************************/ 02871000
*        /*                                                  @YL026UD*/ 02872000
*        /*  SUBTRACT FINAL SEGMENT FROM DATA SET NAME       @YL026UD*/ 02873000
*        /*  IN PREPARATION FOR SUBSEQUENT DSPES             @YL026UD*/ 02874000
*        /*                                                  @YL026UD*/ 02875000
*        /************************************************************/ 02876000
*                                                                  0700 02877000
*        DSNLEN = DSNLEN - LENGTH(DSPENAME);               /*@YL026UD*/ 02878000
*                                                                  0700 02879000
@RF00698 SL    DSNLEN,@CF00175                                     0700 02880000
*        DSNAME(DSNLEN+1:DSNLEN+9) = '        ';           /*@YL026UD*/ 02881000
*                                                                  0701 02882000
         LA    @08,DSNAME(DSNLEN)                                  0701 02883000
         MVI   8(@08),C' '                                         0701 02884000
         MVC   0(8,@08),@CC01167                                   0701 02885000
*        CATPTR = CATPTR + (2 * DSPETYPE) +                        0702 02886000
*                 LENGTH(CATFORM);                         /*@YL026UD*/ 02887000
*                                                                  0702 02888000
         SLR   @08,@08                                             0702 02889000
         IC    @08,DSPETYPE(,CATPTR)                               0702 02890000
         ALR   @08,@08                                             0702 02891000
         ALR   @08,CATPTR                                          0702 02892000
         AL    @08,@CF00037                                        0702 02893000
         LR    CATPTR,@08                                          0702 02894000
*        END DSPEPROC;                                     /*@YL026UD*/ 02895000
@EL00007 DS    0H                                                  0703 02896000
@EF00007 DS    0H                                                  0703 02897000
@ER00007 LM    @14,@02,@SA00007                                    0703 02898000
         LM    @04,@05,@SA00007+20                                 0703 02899000
         LM    @08,@12,@SA00007+28                                 0703 02900000
         BR    @14                                                 0703 02901000
*/********************************************************************/ 02902000
*/*                                                          @YL026UD*/ 02903000
*/*  PROCEDURE NAME - VCBPPROC                               @YL026UD*/ 02904000
*/*                                                          @YL026UD*/ 02905000
*/*  FUNCTION - PROCESSING OF SYSCTLG VOLUME CONTROL BLOCK   @YL026UD*/ 02906000
*/*             POINTER ENTRIES ('VCBPE') AND THEIR          @YL026UD*/ 02907000
*/*             CORRESPONDING VOLUME CONTROL BLOCKS ('VCB')  @YL026UD*/ 02908000
*/*                                                          @YL026UD*/ 02909000
*/*             THE FOLLOWING ARE EXTRACTED FROM THE VCBPE - @YL026UD*/ 02910000
*/*             (1) FINAL SEGMENT OF THE DATA SET NAME       @YL026UD*/ 02911000
*/*             (2) DSCB RELATIVE TRACK ADDRESS (TTR)        @YL026UD*/ 02912000
*/*                                                          @YL026UD*/ 02913000
*/*             THE DATA SET VOLUME INFORMATION IS EXTRACTED @YL026UD*/ 02914000
*/*             FROM THE VCB                                 @YL026UD*/ 02915000
*/*                                                          @YL026UD*/ 02916000
*/*             THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE @YL026UD*/ 02917000
*/*             THE CONVERTED 'NONVSAM' OR 'ALIAS' ENTRY     @YL026UD*/ 02918000
*/*             IN THE VSAM CATALOG                          @YL026UD*/ 02919000
*/*                                                          @YL026UD*/ 02920000
*/*  INPUT - (1) THE SYSCTLG VOLUME CONTROL BLOCK POINTER    @YL026UD*/ 02921000
*/*              ENTRY (AND CORRESPONDING VOLUME CONTROL     @YL026UD*/ 02922000
*/*              BLOCK)                                      @YL026UD*/ 02923000
*/*          (2) THE ACQUIRED STORAGE AREA FOR THE DEVICE    @YL026UD*/ 02924000
*/*              TYPE LIST, VOLUME SERIAL LIST, AND FILE     @YL026UD*/ 02925000
*/*              SEQUENCE NUMBER LIST                        @YL026UD*/ 02926000
*/*                                                          @YL026UD*/ 02927000
*/*  OUTPUT - THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/ 02928000
*/*           'VCBPE' TO A 'NONVSAM' OR 'ALIAS' ENTRY IN     @YL026UD*/ 02929000
*/*           THE VSAM CATALOG                               @YL026UD*/ 02930000
*/*                                                          @YL026UD*/ 02931000
*/*           SCANNING CONTINUES WITHIN THE SAME INDEX       @YL026UD*/ 02932000
*/*           BLOCK, IMMEDIATELY FOLLOWING THE 'VCBPE'       @YL026UD*/ 02933000
*/*                                                          @YL026UD*/ 02934000
*/********************************************************************/ 02935000
*                                                                  0704 02936000
*VCBPPROC: PROCEDURE;                                      /*@YL026UD*/ 02937000
VCBPPROC STM   @14,@02,@SA00008                                    0704 02938000
         STM   @04,@05,@SA00008+20                                 0704 02939000
         STM   @07,@12,@SA00008+28                                 0704 02940000
*        OLDERID2 = NEWERID2;                                      0705 02941000
         L     @07,@PC00001                                        0705 02942000
         L     @07,GDTTR2(,@07)                                    0705 02943000
         MVC   @TS00001(95),NEWERID2(@07)                          0705 02944000
         MVC   OLDERID2(95,@07),@TS00001                           0705 02945000
*        NEWID2 = 'CCVP';                                  /*@YL026UD*/ 02946000
*                                                                  0706 02947000
         MVC   NEWID2(4,@07),@CC01171                              0706 02948000
*        /************************************************************/ 02949000
*        /*                                                  @YL026UD*/ 02950000
*        /*  ADD FINAL SEGMENT (VCBPE NAME) TO DATA SET NAME @YL026UD*/ 02951000
*        /*                                                  @YL026UD*/ 02952000
*        /************************************************************/ 02953000
*                                                                  0707 02954000
*        DSNAME(DSNLEN+1:DSNLEN+9) = VCBPNAME;             /*@YL026UD*/ 02955000
*                                                                  0707 02956000
         LA    @07,DSNAME(DSNLEN)                                  0707 02957000
         MVI   8(@07),C' '                                         0707 02958000
         MVC   0(8,@07),VCBPNAME(CATPTR)                           0707 02959000
*        DSNLEN = DSNLEN + LENGTH(VCBPNAME);               /*@YL026UD*/ 02960000
*                                                                  0708 02961000
         AL    DSNLEN,@CF00175                                     0708 02962000
*        /************************************************************/ 02963000
*        /*                                                  @YL026UD*/ 02964000
*        /*  EXTRACT DSCB TTR FROM THE VCBPE ENTRY           @YL026UD*/ 02965000
*        /*                                                  @YL026UD*/ 02966000
*        /************************************************************/ 02967000
*                                                                  0709 02968000
*        DSCBTTR(1:3) = VCBPTTR;                           /*@YL026UD*/ 02969000
*                                                                  0709 02970000
         MVC   DSCBTTR(3),VCBPTTR(CATPTR)                          0709 02971000
*        /************************************************************/ 02972000
*        /*                                                  @YL026UD*/ 02973000
*        /*  SAVE VCBPE OFFSET WITHIN INDEX BLOCK -          @YL026UD*/ 02974000
*        /*  PLACE THE INFORMATION IN THE PUSH-DOWN STACK    @YL026UD*/ 02975000
*        /*                                                  @YL026UD*/ 02976000
*        /*  CONTINUE SYSCTLG SCANNING AT THE NEXT LOWER     @YL026UD*/ 02977000
*        /*  INDEX LEVEL - THE LEVEL OF THE 'VCB'            @YL026UD*/ 02978000
*        /*                                                  @YL026UD*/ 02979000
*        /************************************************************/ 02980000
*                                                                  0710 02981000
*        LVLOFSET(LVLINDEX) =                                      0710 02982000
*                (CATPTR + (2 * VCBPTYPE) +                        0710 02983000
*                LENGTH(CATFORM)) - BLOCKPTR;              /*@YL026UD*/ 02984000
*                                                                  0710 02985000
         LH    @07,LVLINDEX                                        0710 02986000
         LR    @05,@07                                             0710 02987000
         ALR   @05,@05                                             0710 02988000
         SLR   @02,@02                                             0710 02989000
         IC    @02,VCBPTYPE(,CATPTR)                               0710 02990000
         ALR   @02,@02                                             0710 02991000
         ALR   @02,CATPTR                                          0710 02992000
         AL    @02,@CF00037                                        0710 02993000
         SL    @02,BLOCKPTR                                        0710 02994000
         STH   @02,LVLOFSET-2(@05)                                 0710 02995000
*        IXNLEN(LVLINDEX) = LENGTH(VCBPNAME) - 1;          /*@YL026UD*/ 02996000
*                                                                  0711 02997000
         LA    @02,7                                               0711 02998000
         STH   @02,IXNLEN-2(@05)                                   0711 02999000
*        LVLINDEX = LVLINDEX + 1;                          /*@YL026UD*/ 03000000
*                                                                  0712 03001000
         LA    @05,1                                               0712 03002000
         ALR   @07,@05                                             0712 03003000
         STH   @07,LVLINDEX                                        0712 03004000
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/ 03005000
*                                                                  0713 03006000
         SLA   @07,8                                               0713 03007000
         L     @02,BLKLVPTR                                        0713 03008000
         AL    @02,@CF01312                                        0713 03009000
         LA    @07,BLOCK(@07,@02)                                  0713 03010000
         ST    @07,BLOCKPTR                                        0713 03011000
*        /************************************************************/ 03012000
*        /*                                                  @YL026UD*/ 03013000
*        /*  INITIALIZE FLAGS AND INDEXES FOR VCB CHAIN      @YL026UD*/ 03014000
*        /*  PROCESSING                                      @YL026UD*/ 03015000
*        /*                                                  @YL026UD*/ 03016000
*        /************************************************************/ 03017000
*                                                                  0714 03018000
*        VCBINDEX = 1;                                     /*@YL026UD*/ 03019000
*                                                                  0714 03020000
         STH   @05,VCBINDEX                                        0714 03021000
*        VCBDONE = NO;                                     /*@YL026UD*/ 03022000
*                                                                  0715 03023000
         NI    VCBDONE,B'01111111'                                 0715 03024000
*        VOLSTLEN = 0;                                     /*@YL026UD*/ 03025000
*                                                                  0716 03026000
         SLR   @07,@07                                             0716 03027000
         L     @05,VOLPTR                                          0716 03028000
         STH   @07,VOLSTLEN(,@05)                                  0716 03029000
*        VOLCNT = 0;                                       /*@YL026UD*/ 03030000
*                                                                  0717 03031000
         STH   @07,VOLCNT                                          0717 03032000
*        BLOCKTTR(1:3) = VCBPTTR;                          /*@YL026UD*/ 03033000
*                                                                  0718 03034000
         MVC   BLOCKTTR(3),VCBPTTR(CATPTR)                         0718 03035000
*VCBLOOP:                                                          0719 03036000
*        DO WHILE (VCBDONE = NO);                          /*@YL026UD*/ 03037000
*                                                                  0719 03038000
VCBLOOP  B     @DE00719                                            0719 03039000
@DL00719 DS    0H                                                  0720 03040000
*          /**********************************************************/ 03041000
*          /*                                                @YL026UD*/ 03042000
*          /*  OBTAIN THE NEXT VCB -                         @YL026UD*/ 03043000
*          /*  ISSUE THE 'UPOSIT'/'UGET' MACROS              @YL026UD*/ 03044000
*          /*  TERMINATE IF AN ERROR OCCURS WHEN THE 'UGET'  @Y30SSMK*/ 03045000
*          /*  MACRO IS ISSUED.                              @Y30SSMK*/ 03046000
*          /*                                                @YL026UD*/ 03047000
*          /**********************************************************/ 03048000
*                                                                  0720 03049000
*          IIOCSPTR -> IOCTTR = BLOCKTTR;                  /*@YL026UD*/ 03050000
*                                                                  0720 03051000
         L     @07,IIOCSPTR                                        0720 03052000
         MVC   IOCTTR(4,@07),BLOCKTTR                              0720 03053000
*          CALL IDCIOPO0(GDTTBL,IIOCSPTR);                 /*@YL026UD*/ 03054000
*                                                                  0721 03055000
         L     @07,@PC00001                                        0721 03056000
         ST    @07,@AL00001                                        0721 03057000
         LA    @02,IIOCSPTR                                        0721 03058000
         ST    @02,@AL00001+4                                      0721 03059000
         MVI   @AL00001+4,X'80'                                    0721 03060000
         L     @15,GDTPOS(,@07)                                    0721 03061000
         LA    @01,@AL00001                                        0721 03062000
         BALR  @14,@15                                             0721 03063000
*          CALL IDCIOGT0(GDTTBL,IIOCSPTR);                 /*@YL026UD*/ 03064000
*                                                                  0722 03065000
         L     @07,@PC00001                                        0722 03066000
         ST    @07,@AL00001                                        0722 03067000
         LA    @02,IIOCSPTR                                        0722 03068000
         ST    @02,@AL00001+4                                      0722 03069000
         MVI   @AL00001+4,X'80'                                    0722 03070000
         L     @15,GDTGET(,@07)                                    0722 03071000
         LA    @01,@AL00001                                        0722 03072000
         BALR  @14,@15                                             0722 03073000
*          RESPECIFY RTNREG RSTD;                                  0723 03074000
*          TESTRC = RTNREG;                                        0724 03075000
         LR    TESTRC,RTNREG                                       0724 03076000
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UD*/ 03077000
*                                                                  0725 03078000
*          IF TESTRC ^= 0                                          0726 03079000
*            THEN                                                  0726 03080000
         LTR   TESTRC,TESTRC                                       0726 03081000
         BZ    @RF00726                                            0726 03082000
*              DO;                                         /*@YL026UD*/ 03083000
*                LASTCOND = LASTCC12;                      /*@YL026UD*/ 03084000
         L     @08,@PC00001+8                                      0728 03085000
         MVC   LASTCOND(2,@08),@CH00037                            0728 03086000
*                RETURN;                                   /*@YL026UD*/ 03087000
@EL00008 DS    0H                                                  0729 03088000
@EF00008 DS    0H                                                  0729 03089000
@ER00008 LM    @14,@02,@SA00008                                    0729 03090000
         LM    @04,@05,@SA00008+20                                 0729 03091000
         LM    @07,@12,@SA00008+28                                 0729 03092000
         BR    @14                                                 0729 03093000
*              END;                                        /*@YL026UD*/ 03094000
*                                                                  0730 03095000
*          BLOCK(LVLINDEX) = BLKREAD;                      /*@YL026UD*/ 03096000
*                                                                  0731 03097000
@RF00726 LH    @07,LVLINDEX                                        0731 03098000
         SLA   @07,8                                               0731 03099000
         L     @05,BLKLVPTR                                        0731 03100000
         ALR   @05,@07                                             0731 03101000
         AL    @05,@CF01312                                        0731 03102000
         L     @07,IIOCSPTR                                        0731 03103000
         L     @07,IOCDAD(,@07)                                    0731 03104000
         MVC   BLOCK(256,@05),BLKREAD(@07)                         0731 03105000
*          CATPTR = BLOCKPTR;                              /*@YL026UD*/ 03106000
*                                                                  0732 03107000
         L     CATPTR,BLOCKPTR                                     0732 03108000
*          VCBVOLIM = MIN(VCBVOLCT,VCBVOLMX);              /*@YL026UD*/ 03109000
*                                                                  0733 03110000
         LH    @07,VCBVOLCT(,CATPTR)                               0733 03111000
         LA    VCBVOLIM,20                                         0733 03112000
         CR    VCBVOLIM,@07                                        0733 03113000
         BNH   *+6                                                      03114000
         LR    VCBVOLIM,@07                                        0733 03115000
*          /**********************************************************/ 03116000
*          /*                                                @YL026UD*/ 03117000
*          /*  EXTRACT VOLUME INFORMATION FROM THE SYSCTLG   @YL026UD*/ 03118000
*          /*  VCB ENTRY TO BE USED IN 'DEFINING' THE VSAM   @YL026UD*/ 03119000
*          /*  CATALOG ENTRY                                 @YL026UD*/ 03120000
*          /*                                                @YL026UD*/ 03121000
*          /**********************************************************/ 03122000
*                                                                  0734 03123000
*          VOLCNT = MAX(VOLCNT,VCBVOLCT);                  /*@YL026UD*/ 03124000
*                                                                  0734 03125000
         LH    @05,VOLCNT                                          0734 03126000
         CR    @05,@07                                             0734 03127000
         BNL   *+6                                                      03128000
         LR    @05,@07                                             0734 03129000
         STH   @05,VOLCNT                                          0734 03130000
*          VOLSTLEN = MAX(VOLSTLEN,                                0735 03131000
*                         (VCBVOLCT * LENGTH(VOLSERS)));   /*@YL026UD*/ 03132000
*                                                                  0735 03133000
         L     @05,VOLPTR                                          0735 03134000
         SLA   @07,3                                               0735 03135000
         LH    @15,VOLSTLEN(,@05)                                  0735 03136000
         CR    @15,@07                                             0735 03137000
         BNL   *+6                                                      03138000
         LR    @15,@07                                             0735 03139000
         STH   @15,VOLSTLEN(,@05)                                  0735 03140000
*          DO INDEX = 1 TO VCBVOLIM;                       /*@YL026UD*/ 03141000
*                                                                  0736 03142000
         LA    INDEX,1                                             0736 03143000
         B     @DE00736                                            0736 03144000
@DL00736 DS    0H                                                  0737 03145000
*            DEVTUNIT(VCBINDEX) = ' ';                     /*@YL026UD*/ 03146000
         L     @05,DEVTPTR                                         0737 03147000
         LH    @15,VCBINDEX                                        0737 03148000
         LA    @14,12                                              0737 03149000
         LR    @01,@15                                             0737 03150000
         MR    @00,@14                                             0737 03151000
         ST    @01,@TF00001                                        0737 03152000
         ALR   @01,@05                                             0737 03153000
         AL    @01,@CF01313                                        0737 03154000
         MVI   DEVTUNIT+1(@01),C' '                                0737 03155000
         MVC   DEVTUNIT+2(6,@01),DEVTUNIT+1(@01)                   0737 03156000
         MVI   DEVTUNIT(@01),C' '                                  0737 03157000
*            DEVTCODE(VCBINDEX) = VCBDEVT(INDEX);          /*@YL026UD*/ 03158000
*                                                                  0738 03159000
         AL    @05,@TF00001                                        0738 03160000
         AL    @05,@CF01314                                        0738 03161000
         LR    @01,@14                                             0738 03162000
         MR    @00,INDEX                                           0738 03163000
         ST    @01,@TF00001                                        0738 03164000
         ALR   @01,CATPTR                                          0738 03165000
         AL    @01,@CF01317                                        0738 03166000
         MVC   DEVTCODE-8(4,@05),VCBDEVT-2(@01)                    0738 03167000
*            VOLZERO(VCBINDEX) = 0;                        /*@YL026UD*/ 03168000
         L     @05,VOLPTR                                          0739 03169000
         LR    @14,@15                                             0739 03170000
         SLA   @14,3                                               0739 03171000
         SLR   @01,@01                                             0739 03172000
         LA    @05,0(@14,@05)                                      0739 03173000
         AL    @05,@CF01315                                        0739 03174000
         STH   @01,VOLZERO-2(,@05)                                 0739 03175000
*            VOLSER(VCBINDEX)  = VCBDVOL(INDEX);           /*@YL026UD*/ 03176000
*                                                                  0740 03177000
         L     @05,VOLPTR                                          0740 03178000
         ALR   @05,@14                                             0740 03179000
         AL    @05,@CF01314                                        0740 03180000
         LR    @01,CATPTR                                          0740 03181000
         AL    @01,@TF00001                                        0740 03182000
         AL    @01,@CF01315                                        0740 03183000
         MVC   VOLSER-4(6,@05),VCBDVOL-6(@01)                      0740 03184000
*            FILESEQ(VCBINDEX) = VCBDSEQ(INDEX);           /*@YL026UD*/ 03185000
*                                                                  0741 03186000
         LR    @05,@15                                             0741 03187000
         ALR   @05,@05                                             0741 03188000
         L     @01,FILEPTR                                         0741 03189000
         ALR   @01,@05                                             0741 03190000
         AL    @01,@CF01316                                        0741 03191000
         LR    @05,CATPTR                                          0741 03192000
         AL    @05,@TF00001                                        0741 03193000
         MVC   FILESEQ(2,@01),VCBDSEQ-12(@05)                      0741 03194000
*            VCBINDEX = VCBINDEX + 1;                      /*@YL026UD*/ 03195000
         AL    @15,@CF00215                                        0742 03196000
         STH   @15,VCBINDEX                                        0742 03197000
*          END;                                            /*@YL026UD*/ 03198000
*                                                                  0743 03199000
         AL    INDEX,@CF00215                                      0743 03200000
@DE00736 CR    INDEX,VCBVOLIM                                      0743 03201000
         BNH   @DL00736                                            0743 03202000
*          CATPTR = CATPTR + LENGTH(VCBVOLCT) +                    0744 03203000
*                            (VCBVOLMX * LENGTH(VCBVOLS)); /*@YL026UD*/ 03204000
*                                                                  0744 03205000
         AL    CATPTR,@CF00948                                     0744 03206000
*          /**********************************************************/ 03207000
*          /*                                                @YL026UD*/ 03208000
*          /*  DETERMINE IF CURRENT VCB IS FINAL VCB IN      @YL026UD*/ 03209000
*          /*  VCB CHAIN (VCB TTR = 0)                       @YL026UD*/ 03210000
*          /*                                                @YL026UD*/ 03211000
*          /**********************************************************/ 03212000
*                                                                  0745 03213000
*          IF VCBTTR = ZEROTTR                                     0745 03214000
*            THEN                                                  0745 03215000
         CLC   VCBTTR(3,CATPTR),ZEROTTR                            0745 03216000
         BNE   @RF00745                                            0745 03217000
*              /******************************************************/ 03218000
*              /*                                            @YL026UD*/ 03219000
*              /*  FINAL VCB -                               @YL026UD*/ 03220000
*              /*  SET 'VCB PROCESSING DONE' FLAG            @YL026UD*/ 03221000
*              /*                                            @YL026UD*/ 03222000
*              /******************************************************/ 03223000
*                                                                  0746 03224000
*              VCBDONE = YES;                              /*@YL026UD*/ 03225000
*                                                                  0746 03226000
         OI    VCBDONE,B'10000000'                                 0746 03227000
*            ELSE                                                  0747 03228000
*              /******************************************************/ 03229000
*              /*                                            @YL026UD*/ 03230000
*              /*  NOT FINAL VCB -                           @YL026UD*/ 03231000
*              /*  OBTAIN TTR OF NEXT VCB IN CHAIN           @YL026UD*/ 03232000
*              /*                                            @YL026UD*/ 03233000
*              /******************************************************/ 03234000
*                                                                  0747 03235000
*              BLOCKTTR(1:3) = VCBTTR;                     /*@YL026UD*/ 03236000
*                                                                  0747 03237000
         B     @RC00745                                            0747 03238000
@RF00745 MVC   BLOCKTTR(3),VCBTTR(CATPTR)                          0747 03239000
*        END VCBLOOP;                                      /*@YL026UD*/ 03240000
*                                                                  0748 03241000
@RC00745 DS    0H                                                  0748 03242000
@DE00719 TM    VCBDONE,B'10000000'                                 0748 03243000
         BZ    @DL00719                                            0748 03244000
*        /************************************************************/ 03245000
*        /*                                                  @YL026UD*/ 03246000
*        /*  ALL VCB ENTRIES HAVE BEEN PROCESSED -           @YL026UD*/ 03247000
*        /*  ALL VOLUME INFORMATION HAS BEEN PLACED          @YL026UD*/ 03248000
*        /*  IN THE VOLUME LIST                              @YL026UD*/ 03249000
*        /*                                                  @YL026UD*/ 03250000
*        /*  INITIALIZE CPL/FVT/FPL AND ISSUE CATALOG-ADD    @YL026UD*/ 03251000
*        /*  REQUEST TO 'DEFINE' NONVSAM ENTRY               @YL026UD*/ 03252000
*        /*                                                  @YL026UD*/ 03253000
*        /************************************************************/ 03254000
*                                                                  0749 03255000
*        CALL CATALOG;                                     /*@YL026UD*/ 03256000
*                                                                  0749 03257000
         BAL   @14,CATALOG                                         0749 03258000
*        /************************************************************/ 03259000
*        /*                                                  @YL026UD*/ 03260000
*        /*  DETERMINE IF ADDITIONAL CATALOG-ADD REQUEST IS  @YL026UD*/ 03261000
*        /*  NECESSARY TO 'DEFINE' ALIAS ENTRY               @YL026UD*/ 03262000
*        /*                                                  @YL026UD*/ 03263000
*        /*  THIS IS NECESSARY IF THE PREVIOUS CATALOG-ADD   @YL026UD*/ 03264000
*        /*  REQUEST WAS FOR AN ALIAS DATA SET NAME, BUT THE @YL026UD*/ 03265000
*        /*  REQUEST WAS NEEDED TO 'DEFINE' THE RELATED      @YL026UD*/ 03266000
*        /*  TRUE DATA SET NAME FIRST ('TRUEFLG' = ON)       @YL026UD*/ 03267000
*        /*                                                  @YL026UD*/ 03268000
*        /************************************************************/ 03269000
*                                                                  0750 03270000
*        IF TRUEFLG = ON                                           0750 03271000
*          THEN                                                    0750 03272000
         TM    TRUEFLG,B'10000000'                                 0750 03273000
         BNO   @RF00750                                            0750 03274000
*            CALL CATALOG;                                 /*@YL026UD*/ 03275000
*                                                                  0751 03276000
         BAL   @14,CATALOG                                         0751 03277000
*        /************************************************************/ 03278000
*        /*                                                  @YL026UD*/ 03279000
*        /*  CONTINUE SYSCTLG SCANNING AT THE NEXT HIGHER    @YL026UD*/ 03280000
*        /*  INDEX LEVEL - THE LEVEL OF THE 'VCBPE'          @YL026UD*/ 03281000
*        /*                                                  @YL026UD*/ 03282000
*        /************************************************************/ 03283000
*                                                                  0752 03284000
*        CALL POPUP;                                       /*@YL026UD*/ 03285000
*                                                                  0752 03286000
@RF00750 BAL   @14,POPUP                                           0752 03287000
*        END VCBPPROC;                                     /*@YL026UD*/ 03288000
         B     @EL00008                                            0753 03289000
*/********************************************************************/ 03290000
*/*                                                          @YL026UD*/ 03291000
*/*  PROCEDURE NAME - GIPEPROC                               @YL026UD*/ 03292000
*/*                                                          @YL026UD*/ 03293000
*/*  FUNCTION - PROCESSING OF SYSCTLG GENERATION INDEX       @YL026UD*/ 03294000
*/*             POINTER ENTRIES ('GIPE')                     @YL026UD*/ 03295000
*/*                                                          @YL026UD*/ 03296000
*/*             IF THE 'ALIAS PROCESSING' FLAG IS TURNED ON, @YL026UD*/ 03297000
*/*             NO CONVERSION IS PERFORMED ON THE 'GIPE'     @YL026UD*/ 03298000
*/*             (VSAM DOES NOT ALLOW ALIASES OF 'GDG BASE')  @YL026UD*/ 03299000
*/*             ENTRIES).  AN INFORMATIONAL MESSAGE IS       @YL026UD*/ 03300000
*/*             PRINTED, EXPLAINING THE NON-CONVERSION       @YL026UD*/ 03301000
*/*                                                          @YL026UD*/ 03302000
*/*             IF THE 'ALIAS PROCESSING' FLAG IS 'OFF',     @YL026UD*/ 03303000
*/*             THE FOLLOWING ARE EXTRACTED FROM THE GIPE -  @YL026UD*/ 03304000
*/*             (1) FINAL SEGMENT OF DATA SET NAME           @YL026UD*/ 03305000
*/*             (2) MAXIMUM GENERATION COUNT                 @YL026UD*/ 03306000
*/*             (3) GENERATION DATA GROUP OPTION FLAGS       @YL026UD*/ 03307000
*/*                                                          @YL026UD*/ 03308000
*/*             THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE @YL026UD*/ 03309000
*/*             THE CONVERTED 'GDG BASE' ENTRY IN THE VSAM   @YL026UD*/ 03310000
*/*             CATALOG                                      @YL026UD*/ 03311000
*/*                                                          @YL026UD*/ 03312000
*/*             THE 'G0000V00 PROCESSING' FLAG IS TURNED ON  @YL026UD*/ 03313000
*/*             TO INDICATE THAT SUBSEQUENT (GENERATION      @YL026UD*/ 03314000
*/*             INDEX) PROCESSING WILL TAKE PLACE            @YL026UD*/ 03315000
*/*                                                          @YL026UD*/ 03316000
*/*  INPUT - THE SYSCTLG GENERATION INDEX POINTER ENTRY      @YL026UD*/ 03317000
*/*                                                          @YL026UD*/ 03318000
*/*  OUTPUT - (1) IF THE 'ALIAS PROCESSING' FLAG IS 'ON',    @YL026UD*/ 03319000
*/*           AN INFORMATIONAL MESSAGE EXPLAINING THE        @YL026UD*/ 03320000
*/*           'GIPE' ALIAS NON-CONVERSION, OR                @Y30SSMK*/ 03321000
*/*           (2) IF THE 'ALIAS PROCESSING' FLAG IS 'OFF',   @YL026UD*/ 03322000
*/*           THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/ 03323000
*/*           'GIPE' TO A 'GDG BASE' ENTRY IN THE VSAM       @YL026UD*/ 03324000
*/*           CATALOG                                        @YL026UD*/ 03325000
*/*                                                          @YL026UD*/ 03326000
*/*           SCANNING CONTINUES WITHIN THE NEXT-LOWER       @YL026UD*/ 03327000
*/*           LEVEL INDEX (THE GENERATION INDEX) TO          @YL026UD*/ 03328000
*/*           CONVERT ALL GENERATIONS (G0000V00 ENTRIES)     @YL026UD*/ 03329000
*/*           WHICH ARE ASSOCIATED WITH THE 'GIPE'           @YL026UD*/ 03330000
*/*                                                          @YL026UD*/ 03331000
*/********************************************************************/ 03332000
*                                                                  0754 03333000
*GIPEPROC: PROCEDURE;                                      /*@YL026UD*/ 03334000
GIPEPROC STM   @14,@02,@SA00009                                    0754 03335000
         STM   @04,@05,@SA00009+20                                 0754 03336000
         STM   @07,@12,@SA00009+28                                 0754 03337000
*        OLDERID2 = NEWERID2;                                      0755 03338000
         L     @07,@PC00001                                        0755 03339000
         L     @05,GDTTR2(,@07)                                    0755 03340000
         MVC   @TS00001(95),NEWERID2(@05)                          0755 03341000
         MVC   OLDERID2(95,@05),@TS00001                           0755 03342000
*        NEWID2 = 'CCGP';                                  /*@YL026UD*/ 03343000
*                                                                  0756 03344000
         MVC   NEWID2(4,@05),@CC01178                              0756 03345000
*        /************************************************************/ 03346000
*        /*                                                  @YL026UD*/ 03347000
*        /*  ADD FINAL SEGMENT (GIPE NAME) TO DATA SET NAME  @YL026UD*/ 03348000
*        /*                                                  @YL026UD*/ 03349000
*        /************************************************************/ 03350000
*                                                                  0757 03351000
*        DSNAME(DSNLEN+1:DSNLEN+9) = GIPENAME;             /*@YL026UD*/ 03352000
*                                                                  0757 03353000
         LA    @05,DSNAME(DSNLEN)                                  0757 03354000
         MVI   8(@05),C' '                                         0757 03355000
         MVC   0(8,@05),GIPENAME(CATPTR)                           0757 03356000
*        DSNLEN = DSNLEN + LENGTH(GIPENAME);               /*@YL026UD*/ 03357000
*                                                                  0758 03358000
         AL    DSNLEN,@CF00175                                     0758 03359000
*        /************************************************************/ 03360000
*        /*                                                  @YL026UD*/ 03361000
*        /*  DETERMINE IF 'ALIAS PROCESSING' FLAG IS 'ON' -  @YL026UD*/ 03362000
*        /*  ALIASES OF VSAM 'GDG BASE' ENTRIES              @YL026UD*/ 03363000
*        /*  ARE NOT ALLOWED                                 @YL026UD*/ 03364000
*        /*                                                  @YL026UD*/ 03365000
*        /************************************************************/ 03366000
*                                                                  0759 03367000
*        IF ALIASFLG = ON                                          0759 03368000
*          THEN                                                    0759 03369000
         TM    ALIASFLG,B'10000000'                                0759 03370000
         BNO   @RF00759                                            0759 03371000
*            DO;                                           /*@YL026UD*/ 03372000
*              /******************************************************/ 03373000
*              /*                                            @YL026UD*/ 03374000
*              /*  'ALIAS PROCESSING' FLAG IS TURNED ON -    @YL026UD*/ 03375000
*              /*  'GIPE' ALIAS ENTRY CANNOT BE CONVERTED    @YL026UD*/ 03376000
*              /*                                            @YL026UD*/ 03377000
*              /*  PRINT INFORMATIONAL MESSAGE AND CONTINUE  @YL026UD*/ 03378000
*              /*  SYSCTLG SCANNING AT SAME INDEX LEVEL      @YL026UD*/ 03379000
*              /*                                            @YL026UD*/ 03380000
*              /******************************************************/ 03381000
*                                                                  0761 03382000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 03383000
         L     @08,DDSTRU                                          0761 03384000
         MVC   DARGSMOD(3,@08),@CC00831                            0761 03385000
*              DARGSENT = GDGAMSG#;                        /*@YL026UD*/ 03386000
*                                                                  0762 03387000
         MVI   DARGSENT(@08),X'0E'                                 0762 03388000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 03389000
*                                                                  0763 03390000
         ST    @07,@AL00001                                        0763 03391000
         LA    @08,@CF00113                                        0763 03392000
         ST    @08,@AL00001+4                                      0763 03393000
         LA    @08,DDSTRU                                          0763 03394000
         ST    @08,@AL00001+8                                      0763 03395000
         MVI   @AL00001+8,X'80'                                    0763 03396000
         L     @15,GDTPRT(,@07)                                    0763 03397000
         LA    @01,@AL00001                                        0763 03398000
         BALR  @14,@15                                             0763 03399000
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/ 03400000
*                                                                  0764 03401000
         L     @08,DDSTRU                                          0764 03402000
         MVI   DARGSENT(@08),X'09'                                 0764 03403000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 03404000
         LA    @07,DSNAME                                          0765 03405000
         ST    @07,DARGDBP(,@08)                                   0765 03406000
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/ 03407000
*                                                                  0766 03408000
         MVC   DARGILP(2,@08),@CH00583                             0766 03409000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 03410000
*                                                                  0767 03411000
         L     @08,@PC00001                                        0767 03412000
         ST    @08,@AL00001                                        0767 03413000
         LA    @07,@CF00113                                        0767 03414000
         ST    @07,@AL00001+4                                      0767 03415000
         LA    @07,DDSTRU                                          0767 03416000
         ST    @07,@AL00001+8                                      0767 03417000
         MVI   @AL00001+8,X'80'                                    0767 03418000
         L     @15,GDTPRT(,@08)                                    0767 03419000
         LA    @01,@AL00001                                        0767 03420000
         BALR  @14,@15                                             0767 03421000
*              LASTCOND = LASTCC04;                        /*@YL026UD*/ 03422000
*                                                                  0768 03423000
         L     @08,@PC00001+8                                      0768 03424000
         MVC   LASTCOND(2,@08),@CH00042                            0768 03425000
*              DSNLEN = DSNLEN - LENGTH(GIPENAME);         /*@YL026UD*/ 03426000
*                                                                  0769 03427000
         SL    DSNLEN,@CF00175                                     0769 03428000
*              DSNAME(DSNLEN+1:DSNLEN+9) = '        ';     /*@YL026UD*/ 03429000
*                                                                  0770 03430000
         LA    @08,DSNAME(DSNLEN)                                  0770 03431000
         MVI   8(@08),C' '                                         0770 03432000
         MVC   0(8,@08),@CC01167                                   0770 03433000
*              CATPTR = CATPTR + (2 * GIPETYPE) +                  0771 03434000
*                       LENGTH(CATFORM);                   /*@YL026UD*/ 03435000
*                                                                  0771 03436000
         SLR   @08,@08                                             0771 03437000
         IC    @08,GIPETYPE(,CATPTR)                               0771 03438000
         ALR   @08,@08                                             0771 03439000
         ALR   @08,CATPTR                                          0771 03440000
         AL    @08,@CF00037                                        0771 03441000
         LR    CATPTR,@08                                          0771 03442000
*              RETURN;                                     /*@YL026UD*/ 03443000
*                                                                  0772 03444000
@EL00009 DS    0H                                                  0772 03445000
@EF00009 DS    0H                                                  0772 03446000
@ER00009 LM    @14,@02,@SA00009                                    0772 03447000
         LM    @04,@05,@SA00009+20                                 0772 03448000
         LM    @07,@12,@SA00009+28                                 0772 03449000
         BR    @14                                                 0772 03450000
*            END;                                          /*@YL026UD*/ 03451000
*                                                                  0773 03452000
*        /************************************************************/ 03453000
*        /*                                                  @YL026UD*/ 03454000
*        /*  FLAG THE ENTRY AS A 'GIPE' ENTRY                @YL026UD*/ 03455000
*        /*  AND EXTRACT THE MAXIMUM GENERATION              @YL026UD*/ 03456000
*        /*  COUNT AND GDG OPTION FLAGS FROM THE             @YL026UD*/ 03457000
*        /*  GIPE ENTRY TO BE USED IN DEFINING THE           @YL026UD*/ 03458000
*        /*  'GDG BASE' ENTRY IN THE VSAM CATALOG            @YL026UD*/ 03459000
*        /*                                                  @YL026UD*/ 03460000
*        /************************************************************/ 03461000
*                                                                  0774 03462000
*        GDGFLAG = ON;                                     /*@YL026UD*/ 03463000
*                                                                  0774 03464000
@RF00759 OI    GDGFLAG,B'10000000'                                 0774 03465000
*        GDGLIMIT = GIPEMCNT;                              /*@YL026UD*/ 03466000
*                                                                  0775 03467000
         MVC   GDGLIMIT(1),GIPEMCNT(CATPTR)                        0775 03468000
*        GDGATTR = 0;                                      /*@YL026UD*/ 03469000
*                                                                  0776 03470000
         MVI   GDGATTR,X'00'                                       0776 03471000
*        IF GIPEFEMP = ON                                          0777 03472000
*          THEN                                                    0777 03473000
         TM    GIPEFEMP(CATPTR),B'00000001'                        0777 03474000
         BNO   @RF00777                                            0777 03475000
*            GDGATTR = GDGEMPTY;                           /*@YL026UD*/ 03476000
*                                                                  0778 03477000
         MVI   GDGATTR,X'80'                                       0778 03478000
*        IF GIPEFDEL = ON                                          0779 03479000
*          THEN                                                    0779 03480000
@RF00777 TM    GIPEFDEL(CATPTR),B'00000010'                        0779 03481000
         BNO   @RF00779                                            0779 03482000
*            GDGATTR = GDGATTR + GDGDELET;                 /*@YL026UD*/ 03483000
*                                                                  0780 03484000
         LA    @07,64                                              0780 03485000
         SLR   @05,@05                                             0780 03486000
         IC    @05,GDGATTR                                         0780 03487000
         ALR   @07,@05                                             0780 03488000
         STC   @07,GDGATTR                                         0780 03489000
*        /************************************************************/ 03490000
*        /*                                                  @YL026UD*/ 03491000
*        /*  INITIALIZE CPL/FVT AND ISSUE                    @YL026UD*/ 03492000
*        /*  CATALOG-ADD REQUEST TO 'DEFINE'                 @YL026UD*/ 03493000
*        /*  THE 'GDG BASE' ENTRY                            @YL026UD*/ 03494000
*        /*                                                  @YL026UD*/ 03495000
*        /************************************************************/ 03496000
*                                                                  0781 03497000
*        CALL CATALOG;                                     /*@YL026UD*/ 03498000
*                                                                  0781 03499000
@RF00779 BAL   @14,CATALOG                                         0781 03500000
*        /************************************************************/ 03501000
*        /*                                                  @YL026UD*/ 03502000
*        /*  PROCESS THE GENERATION INDEX                    @YL026UD*/ 03503000
*        /*  (NEXT LOWER INDEX LEVEL) ASSOCIATED             @YL026UD*/ 03504000
*        /*  WITH THE GIPE ENTRY JUST PROCESSED              @YL026UD*/ 03505000
*        /*                                                  @YL026UD*/ 03506000
*        /*  FLAG SUBSEQUENT PROCESSING AS                   @YL026UD*/ 03507000
*        /*  'GENERATION INDEX' (G0000V00)                   @YL026UD*/ 03508000
*        /*  PROCESSING                                      @YL026UD*/ 03509000
*        /*                                                  @YL026UD*/ 03510000
*        /************************************************************/ 03511000
*                                                                  0782 03512000
*        DSNLEN = DSNLEN - LENGTH(GIPENAME);               /*@YL026UD*/ 03513000
*                                                                  0782 03514000
         SL    DSNLEN,@CF00175                                     0782 03515000
*        GDGFLAG = OFF;                                    /*@YL026UD*/ 03516000
*                                                                  0783 03517000
         NI    GDGFLAG,B'01111111'                                 0783 03518000
*        G0V0FLAG = ON;                                    /*@YL026UD*/ 03519000
*                                                                  0784 03520000
         OI    G0V0FLAG,B'10000000'                                0784 03521000
*        CALL PUSHDOWN;                                    /*@YL026UD*/ 03522000
*                                                                  0785 03523000
         BAL   @14,PUSHDOWN                                        0785 03524000
*        END GIPEPROC;                                     /*@YL026UD*/ 03525000
         B     @EL00009                                            0786 03526000
*/********************************************************************/ 03527000
*/*                                                          @YL026UD*/ 03528000
*/*  PROCEDURE NAME - CVPEPROC                               @YL026UD*/ 03529000
*/*                                                          @YL026UD*/ 03530000
*/*  FUNCTION - PROCESSES SYSCTLG CONTROL VOLUME POINTER     @YL026UD*/ 03531000
*/*             ENTRIES ('CVPE')                             @YL026UD*/ 03532000
*/*                                                          @YL026UD*/ 03533000
*/*             THE FOLLOWING ARE EXTRACTED FROM THE CVPE -  @YL026UD*/ 03534000
*/*             (1) THE CVPE NAME                            @YL026UD*/ 03535000
*/*             (2) THE CONNECTED CONTROL VOLUME NAME        @YL026UD*/ 03536000
*/*                                                          @YL026UD*/ 03537000
*/*             THE CONNECTED CONTROL VOLUME NAME (FROM THE  @YL026UD*/ 03538000
*/*             CVPE) IS COMPARED WITH THE VOLUME NAMES      @YL026UD*/ 03539000
*/*             LISTED IN THE 'CVOLEQUATES' PARAMETER.       @YL026UD*/ 03540000
*/*             IF A MATCHING VOLUME NAME IS FOUND, THEN     @YL026UD*/ 03541000
*/*             THE CVPE ENTRY IS CONVERTED INTO AN ALIAS    @YL026UD*/ 03542000
*/*             (ENTRY TYPE = 'X') ENTRY IN THE VSAM MASTER  @YL026UD*/ 03543000
*/*             CATALOG.  THE ALIAS NAME IS THE CVPE NAME,   @YL026UD*/ 03544000
*/*             AND THE TRUE NAME IS THE CATALOG NAME IN     @YL026UD*/ 03545000
*/*             THE 'CVOLEQAUTES' PARAMETER CORRESPONDING    @YL026UD*/ 03546000
*/*             TO THE MATCHING VOLUME NAME.                 @YL026UD*/ 03547000
*/*                                                          @YL026UD*/ 03548000
*/*             THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE @YL026UD*/ 03549000
*/*             THE CONVERTED 'ALAIS' ENTRY IN THE VSAM      @YL026UD*/ 03550000
*/*             MASTER CATALOG                               @YL026UD*/ 03551000
*/*                                                          @YL026UD*/ 03552000
*/*  INPUT - (1) THE SYSCTLG CONTROL VOLUME POINTER ENTRY    @YL026UD*/ 03553000
*/*          (2) THE 'CVOLEQUATES' PARAMETER VALUES, AND     @YL026UD*/ 03554000
*/*              THE 'MASTERCATALOG' PARAMETER VALUES        @YL026UD*/ 03555000
*/*                                                          @YL026UD*/ 03556000
*/*  OUTPUT - THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/ 03557000
*/*           'CVPE' TO AN 'ALIAS' ENTRY IN THE VSAM MASTER  @YL026UD*/ 03558000
*/*           CATALOG                                        @YL026UD*/ 03559000
*/*                                                          @YL026UD*/ 03560000
*/*           SCANNING CONTINUES WITHIN THE VOLUME INDEX,    @YL026UD*/ 03561000
*/*           IMMEDIATELY FOLLOWING THE 'CVPE'               @YL026UD*/ 03562000
*/*                                                          @YL026UD*/ 03563000
*/********************************************************************/ 03564000
*                                                                  0787 03565000
*CVPEPROC: PROCEDURE;                                      /*@YL026UD*/ 03566000
CVPEPROC STM   @14,@02,@SA00010                                    0787 03567000
         STM   @04,@06,@SA00010+20                                 0787 03568000
         STM   @08,@12,@SA00010+32                                 0787 03569000
*        OLDERID2 = NEWERID2;                                      0788 03570000
         L     @05,@PC00001                                        0788 03571000
         L     @05,GDTTR2(,@05)                                    0788 03572000
         MVC   @TS00001(95),NEWERID2(@05)                          0788 03573000
         MVC   OLDERID2(95,@05),@TS00001                           0788 03574000
*        NEWID2 = 'CCCP';                                  /*@YL026UD*/ 03575000
*                                                                  0789 03576000
         MVC   NEWID2(4,@05),@CC01182                              0789 03577000
*        /************************************************************/ 03578000
*        /*                                                  @YL026UD*/ 03579000
*        /*  OBTAIN CONTROL VOLUME SERIAL NUMBER             @YL026UD*/ 03580000
*        /*                                                  @YL026UD*/ 03581000
*        /************************************************************/ 03582000
*                                                                  0790 03583000
*        IF CATETYPE = TYPECVPE(1)                                 0790 03584000
*          THEN                                                    0790 03585000
         CLC   CATETYPE(1,CATPTR),TYPECVPE                         0790 03586000
         BNE   @RF00790                                            0790 03587000
*            CVPEVOL = CVP1VOL;                            /*@YL026UD*/ 03588000
         MVC   CVPEVOL(6),CVP1VOL(CATPTR)                          0791 03589000
*          ELSE                                                    0792 03590000
*            CVPEVOL = CVP2VOL;                            /*@YL026UD*/ 03591000
*                                                                  0792 03592000
         B     @RC00790                                            0792 03593000
@RF00790 MVC   CVPEVOL(6),CVP2VOL(CATPTR)                          0792 03594000
*        /************************************************************/ 03595000
*        /*                                                  @YL026UD*/ 03596000
*        /*  COMPARE THE CONTROL VOLUME NUMBER               @YL026UD*/ 03597000
*        /*  FROM THE CVPE ENTRY WITH THE VOLUME             @YL026UD*/ 03598000
*        /*  SERIAL NUMBERS IN THE 'CVOLEQUATES'             @YL026UD*/ 03599000
*        /*  PARAMETER, IF SPECIFIED                         @YL026UD*/ 03600000
*        /*                                                  @YL026UD*/ 03601000
*        /************************************************************/ 03602000
*                                                                  0793 03603000
*        IF ADDR(CVEQU) ^= NULLPTR                                 0793 03604000
*          THEN                                                    0793 03605000
@RC00790 L     @05,@PC00001+4                                      0793 03606000
         L     @05,FDTPTR+20(,@05)                                 0793 03607000
         LTR   @05,@05                                             0793 03608000
         BZ    @RF00793                                            0793 03609000
*            /********************************************************/ 03610000
*            /*                                              @YL026UD*/ 03611000
*            /*  'CVOLEQUATES' SPECIFIED -                   @YL026UD*/ 03612000
*            /*  SEARCH ALL 'CVOLEQUATES'                    @YL026UD*/ 03613000
*            /*  VOLUME SERIAL LISTS                         @YL026UD*/ 03614000
*            /*                                              @YL026UD*/ 03615000
*            /********************************************************/ 03616000
*                                                                  0794 03617000
*CVPE1:      DO CVENINDX = 1 TO CVEQUCNT                           0794 03618000
*                       WHILE(CVPEFLAG = OFF);             /*@YL026UD*/ 03619000
*                                                                  0794 03620000
CVPE1    LA    CVENINDX,1                                          0794 03621000
         B     @DE00794                                            0794 03622000
@DL00794 TM    CVPEFLAG,B'10000000'                                0794 03623000
         BNZ   @DC00794                                            0794 03624000
*              /******************************************************/ 03625000
*              /*                                            @YL026UD*/ 03626000
*              /*  SEARCH EACH VOLUME NUMBER                 @YL026UD*/ 03627000
*              /*  WITHIN A VOLUME SERIAL LIST               @YL026UD*/ 03628000
*              /*                                            @YL026UD*/ 03629000
*              /******************************************************/ 03630000
*                                                                  0795 03631000
*CVPE2:        DO CVEVINDX = 1 TO CVEVSPTR(CVENINDX) ->            0795 03632000
*                         CVEVSCNT                                 0795 03633000
*                         WHILE(CVPEFLAG = OFF);           /*@YL026UD*/ 03634000
*                                                                  0795 03635000
CVPE2    LA    CVEVINDX,1                                          0795 03636000
         B     @DE00795                                            0795 03637000
@DL00795 TM    CVPEFLAG,B'10000000'                                0795 03638000
         BNZ   @DC00795                                            0795 03639000
*                IF CVPEVOL = CVEVSPTR(CVENINDX) ->                0796 03640000
*                             CVEVSVAL(CVEVINDX)                   0796 03641000
*                  THEN                                            0796 03642000
         LR    @15,CVEVINDX                                        0796 03643000
         SLA   @15,3                                               0796 03644000
         LR    @14,CVENINDX                                        0796 03645000
         SLA   @14,2                                               0796 03646000
         L     @01,@PC00001+4                                      0796 03647000
         L     @01,FDTPTR+28(,@01)                                 0796 03648000
         AL    @01,@CF01314                                        0796 03649000
         L     @01,CVEVSPTR(@14,@01)                               0796 03650000
         ALR   @01,@15                                             0796 03651000
         AL    @01,@CF01318                                        0796 03652000
         CLC   CVPEVOL(6),CVEVSVAL-3(@01)                          0796 03653000
         BNE   @RF00796                                            0796 03654000
*                    DO;                                   /*@YL026UD*/ 03655000
*                      /**********************************************/ 03656000
*                      /*                                    @YL026UD*/ 03657000
*                      /*  A MATCHING VOLUME HAS             @YL026UD*/ 03658000
*                      /*  BEEN FOUND -                      @YL026UD*/ 03659000
*                      /*  'DEFINE' THE CVPE ENTRY           @YL026UD*/ 03660000
*                      /*  NAME AS A MASTER CATALOG          @YL026UD*/ 03661000
*                      /*  ALIAS ENTRY TO THE                @YL026UD*/ 03662000
*                      /*  CORRESPONDING CATALOG             @YL026UD*/ 03663000
*                      /*  NAME FROM THE                     @YL026UD*/ 03664000
*                      /*  'CVOLEQUATES' PARAMETER           @YL026UD*/ 03665000
*                      /*                                    @YL026UD*/ 03666000
*                      /**********************************************/ 03667000
*                                                                  0798 03668000
*                      DSNAME(1:8) = CATENAME;             /*@YL026UD*/ 03669000
*                                                                  0798 03670000
         MVC   DSNAME(8),CATENAME(CATPTR)                          0798 03671000
*                      TRUEDSN = CVECNPTR(CVENINDX) ->             0799 03672000
*                                CVECNVAL;                 /*@YL026UD*/ 03673000
*                                                                  0799 03674000
         L     @15,@PC00001+4                                      0799 03675000
         L     @01,FDTPTR+24(,@15)                                 0799 03676000
         AL    @01,@CF01314                                        0799 03677000
         L     @01,CVECNPTR(@14,@01)                               0799 03678000
         MVC   TRUEDSN(44),CVECNVAL(@01)                           0799 03679000
*                      CVPEFLAG = ON;                      /*@YL026UD*/ 03680000
*                                                                  0800 03681000
         OI    CVPEFLAG,B'10000000'                                0800 03682000
*                      CALL CATALOG;                       /*@YL026UD*/ 03683000
         BAL   @14,CATALOG                                         0801 03684000
*                    END;                                  /*@YL026UD*/ 03685000
*                                                                  0802 03686000
*              END CVPE2;                                  /*@YL026UD*/ 03687000
*                                                                  0803 03688000
@RF00796 AL    CVEVINDX,@CF00215                                   0803 03689000
@DE00795 LR    @15,CVENINDX                                        0803 03690000
         SLA   @15,2                                               0803 03691000
         L     @14,@PC00001+4                                      0803 03692000
         L     @01,FDTPTR+28(,@14)                                 0803 03693000
         AL    @01,@CF01314                                        0803 03694000
         L     @01,CVEVSPTR(@15,@01)                               0803 03695000
         CH    CVEVINDX,CVEVSCNT(,@01)                             0803 03696000
         BNH   @DL00795                                            0803 03697000
@DC00795 DS    0H                                                  0804 03698000
*            END CVPE1;                                    /*@YL026UD*/ 03699000
*                                                                  0804 03700000
         AL    CVENINDX,@CF00215                                   0804 03701000
@DE00794 L     @05,@PC00001+4                                      0804 03702000
         LA    @05,FDTPTR+20(,@05)                                 0804 03703000
         C     CVENINDX,CVEQUCNT(,@05)                             0804 03704000
         BNH   @DL00794                                            0804 03705000
@DC00794 DS    0H                                                  0805 03706000
*        /************************************************************/ 03707000
*        /*                                                  @YL026UD*/ 03708000
*        /*  IF A MATCHING VOLUME NUMBER WAS NOT             @YL026UD*/ 03709000
*        /*  FOUND IN THE 'CVOLEQUATES' PARAMETER            @YL026UD*/ 03710000
*        /*  THEN PRINT 'CVPE ENTRY NOT CONVERTED'           @YL026UD*/ 03711000
*        /*  MESSAGE                                         @YL026UD*/ 03712000
*        /*                                                  @YL026UD*/ 03713000
*        /************************************************************/ 03714000
*                                                                  0805 03715000
*        IF CVPEFLAG = ON                                          0805 03716000
*          THEN                                                    0805 03717000
@RF00793 TM    CVPEFLAG,B'10000000'                                0805 03718000
         BNO   @RF00805                                            0805 03719000
*            CVPEFLAG = OFF;                               /*@YL026UD*/ 03720000
         NI    CVPEFLAG,B'01111111'                                0806 03721000
*          ELSE                                                    0807 03722000
*            DO;                                           /*@YL026UD*/ 03723000
         B     @RC00805                                            0807 03724000
@RF00805 DS    0H                                                  0808 03725000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 03726000
         L     @08,DDSTRU                                          0808 03727000
         MVC   DARGSMOD(3,@08),@CC00831                            0808 03728000
*              DARGSENT = CVPEMSG#;                        /*@YL026UD*/ 03729000
*                                                                  0809 03730000
         MVI   DARGSENT(@08),X'02'                                 0809 03731000
*              CVPTXTNM = CATENAME;                        /*@YL026UD*/ 03732000
         MVC   CVPTXTNM(8),CATENAME(CATPTR)                        0810 03733000
*              CVPTXTVL = CVPEVOL;                         /*@YL026UD*/ 03734000
*                                                                  0811 03735000
         MVC   CVPTXTVL(6),CVPEVOL                                 0811 03736000
*              DARGDBP = ADDR(CVPETEXT);                   /*@YL026UD*/ 03737000
         LA    @06,CVPETEXT                                        0812 03738000
         ST    @06,DARGDBP(,@08)                                   0812 03739000
*              DARGILP = LENGTH(CVPETEXT);                 /*@YL026UD*/ 03740000
*                                                                  0813 03741000
         MVC   DARGILP(2,@08),@CH00847                             0813 03742000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 03743000
*                                                                  0814 03744000
         L     @08,@PC00001                                        0814 03745000
         ST    @08,@AL00001                                        0814 03746000
         LA    @06,@CF00113                                        0814 03747000
         ST    @06,@AL00001+4                                      0814 03748000
         LA    @06,DDSTRU                                          0814 03749000
         ST    @06,@AL00001+8                                      0814 03750000
         MVI   @AL00001+8,X'80'                                    0814 03751000
         L     @15,GDTPRT(,@08)                                    0814 03752000
         LA    @01,@AL00001                                        0814 03753000
         BALR  @14,@15                                             0814 03754000
*              LASTCOND = LASTCC04;                        /*@YL026UD*/ 03755000
*                                                                  0815 03756000
         L     @08,@PC00001+8                                      0815 03757000
         MVC   LASTCOND(2,@08),@CH00042                            0815 03758000
*            END;                                          /*@YL026UD*/ 03759000
*                                                                  0816 03760000
*        CATPTR = CATPTR + (2*CATETYPE) +                          0817 03761000
*                 LENGTH(CATFORM);                         /*@YL026UD*/ 03762000
*                                                                  0817 03763000
@RC00805 SLR   @08,@08                                             0817 03764000
         IC    @08,CATETYPE(,CATPTR)                               0817 03765000
         ALR   @08,@08                                             0817 03766000
         ALR   @08,CATPTR                                          0817 03767000
         AL    @08,@CF00037                                        0817 03768000
         LR    CATPTR,@08                                          0817 03769000
*        END CVPEPROC;                                     /*@YL026UD*/ 03770000
@EL00010 DS    0H                                                  0818 03771000
@EF00010 DS    0H                                                  0818 03772000
@ER00010 LM    @14,@02,@SA00010                                    0818 03773000
         LM    @04,@06,@SA00010+20                                 0818 03774000
         LM    @08,@12,@SA00010+32                                 0818 03775000
         BR    @14                                                 0818 03776000
*/********************************************************************/ 03777000
*/*                                                          @YL026UD*/ 03778000
*/*  PROCEDURE NAME - PUSHDOWN                               @YL026UD*/ 03779000
*/*                                                          @YL026UD*/ 03780000
*/*  FUNCTION - PROCESSES THE CHANGE FROM ONE SYSCTLG INDEX  @YL026UD*/ 03781000
*/*             LEVEL TO A LOWER SYSCTLG INDEX LEVEL         @YL026UD*/ 03782000
*/*             WHILE SCANNING THE SYSCTLG DATA SET          @YL026UD*/ 03783000
*/*                                                          @YL026UD*/ 03784000
*/*             THE CURRENT INDEX SCANNING STATUS IS SAVED - @YL026UD*/ 03785000
*/*             I.E., THE OFFSET WITHIN THE INDEX BLOCK      @YL026UD*/ 03786000
*/*                                                          @YL026UD*/ 03787000
*/*             THE INDEX NAME IS EXTRACTED FROM THE         @YL026UD*/ 03788000
*/*             CURRENT INDEX ENTRY IS ADDED TO THE DATA     @YL026UD*/ 03789000
*/*             SET NAME BEING BUILT                         @YL026UD*/ 03790000
*/*                                                          @YL026UD*/ 03791000
*/*             THE LOWER LEVEL SYSCTLG INDEX BLOCK IS       @YL026UD*/ 03792000
*/*             OBTAINED (VIA THE 'UPOSIT'/'UGET' MACROS)    @YL026UD*/ 03793000
*/*             FROM TTR INFORMATION IN THE CURRENT INDEX    @YL026UD*/ 03794000
*/*             ENTRY ('IPE', 'GIPE', OR 'AE' ENTRY)         @YL026UD*/ 03795000
*/*                                                          @YL026UD*/ 03796000
*/*             THE FIRST ENTRY IN THE LOWER LEVEL INDEX     @YL026UD*/ 03797000
*/*             BLOCK IS VERIFIED TO BE AN INDEX CONTROL     @YL026UD*/ 03798000
*/*             ENTRY ('ICE')                                @YL026UD*/ 03799000
*/*                                                          @YL026UD*/ 03800000
*/*             IF THE LOWER LEVEL INDEX BLOCK CANNOT BE     @YL026UD*/ 03801000
*/*             OBTAINED, OR IF THE 'ICE' CANNOT BE          @YL026UD*/ 03802000
*/*             VERIFIED, PROCESSING IS TERMINATED           @YL026UD*/ 03803000
*/*                                                          @YL026UD*/ 03804000
*/*  INPUT - (1) THE OFFSET WITHIN THE CURRENT SYSCTLG       @YL026UD*/ 03805000
*/*              BLOCK, AND THE PUSH-DOWN STACK IN WHICH     @YL026UD*/ 03806000
*/*              THE OFFSET IS SAVED                         @YL026UD*/ 03807000
*/*          (2) THE RELATIVE TRACK ADDRESS (TTR) OF THE     @YL026UD*/ 03808000
*/*              NEXT-LOWER LEVEL SYSCTLG INDEX BLOCK AT     @YL026UD*/ 03809000
*/*              WHICH SCANNING IS TO CONTINUE               @YL026UD*/ 03810000
*/*                                                          @YL026UD*/ 03811000
*/*  OUTPUT - THE ACQUIRED FIRST BLOCK OF THE NEXT-LOWER     @YL026UD*/ 03812000
*/*           SYSCTLG INDEX WITH SCANNING POINTERS           @YL026UD*/ 03813000
*/*           POSITIONED FOLLOWING THE 'ICE'                 @YL026UD*/ 03814000
*/*                                                          @YL026UD*/ 03815000
*/********************************************************************/ 03816000
*                                                                  0819 03817000
*PUSHDOWN: PROCEDURE;                                      /*@YL026UD*/ 03818000
PUSHDOWN STM   @14,@02,@SA00011                                    0819 03819000
         STM   @04,@05,@SA00011+20                                 0819 03820000
         STM   @07,@12,@SA00011+28                                 0819 03821000
*        OLDERID2 = NEWERID2;                                      0820 03822000
         L     @08,@PC00001                                        0820 03823000
         L     @08,GDTTR2(,@08)                                    0820 03824000
         MVC   @TS00001(95),NEWERID2(@08)                          0820 03825000
         MVC   OLDERID2(95,@08),@TS00001                           0820 03826000
*        NEWID2 = 'CCPH';                                  /*@YL026UD*/ 03827000
*                                                                  0821 03828000
         MVC   NEWID2(4,@08),@CC01190                              0821 03829000
*        /************************************************************/ 03830000
*        /*                                                  @YL026UD*/ 03831000
*        /*  SAVE CURRENT INDEX SCANNING STATUS -            @YL026UD*/ 03832000
*        /*  THE OFFSET WITHIN THE CURRENT INDEX BLOCK       @YL026UD*/ 03833000
*        /*                                                  @YL026UD*/ 03834000
*        /************************************************************/ 03835000
*                                                                  0822 03836000
*        LVLOFSET(LVLINDEX) = (CATPTR +                            0822 03837000
*                (2*CATETYPE) + LENGTH(CATFORM)) -                 0822 03838000
*                BLOCKPTR;                                 /*@YL026UD*/ 03839000
*                                                                  0822 03840000
         LH    @08,LVLINDEX                                        0822 03841000
         ALR   @08,@08                                             0822 03842000
         SLR   @07,@07                                             0822 03843000
         IC    @07,CATETYPE(,CATPTR)                               0822 03844000
         ALR   @07,@07                                             0822 03845000
         ALR   @07,CATPTR                                          0822 03846000
         AL    @07,@CF00037                                        0822 03847000
         SL    @07,BLOCKPTR                                        0822 03848000
         STH   @07,LVLOFSET-2(@08)                                 0822 03849000
*        /************************************************************/ 03850000
*        /*                                                  @YL026UD*/ 03851000
*        /*  ADD INDEX NAME TO DATA SET NAME BEING BUILT     @YL026UD*/ 03852000
*        /*  (DETERMINE LENGTH OF INDEX NAME)                @YL026UD*/ 03853000
*        /*                                                  @YL026UD*/ 03854000
*        /************************************************************/ 03855000
*                                                                  0823 03856000
*        IXNLEN(LVLINDEX) = 0;                             /*@YL026UD*/ 03857000
*                                                                  0823 03858000
         SLR   @07,@07                                             0823 03859000
         STH   @07,IXNLEN-2(@08)                                   0823 03860000
*        DO INDEX = LENGTH(CATENAME) TO 1 BY -1                    0824 03861000
*                    WHILE(IXNLEN(LVLINDEX) = 0);          /*@YL026UD*/ 03862000
*                                                                  0824 03863000
         LA    INDEX,8                                             0824 03864000
@DL00824 LH    @08,LVLINDEX                                        0824 03865000
         ALR   @08,@08                                             0824 03866000
         LH    @02,IXNLEN-2(@08)                                   0824 03867000
         LTR   @02,@02                                             0824 03868000
         BNZ   @DC00824                                            0824 03869000
*          IF CATENAME(INDEX) ^= BLANK                             0825 03870000
*            THEN                                                  0825 03871000
         LR    @02,CATPTR                                          0825 03872000
         ALR   @02,INDEX                                           0825 03873000
         AL    @02,@CF01151                                        0825 03874000
         CLI   CATENAME(@02),C' '                                  0825 03875000
         BE    @RF00825                                            0825 03876000
*              IXNLEN(LVLINDEX) = INDEX;                   /*@YL026UD*/ 03877000
*                                                                  0826 03878000
         STH   INDEX,IXNLEN-2(@08)                                 0826 03879000
*        END;                                              /*@YL026UD*/ 03880000
*                                                                  0827 03881000
@RF00825 BCTR  INDEX,0                                             0827 03882000
         LTR   INDEX,INDEX                                         0827 03883000
         BP    @DL00824                                            0827 03884000
@DC00824 DS    0H                                                  0828 03885000
*        DSNAME(DSNLEN + 1:DSNLEN + IXNLEN(LVLINDEX) + 1)          0828 03886000
*                              = CATENAME;                 /*@YL026UD*/ 03887000
*                                                                  0828 03888000
         LA    @08,DSNAME(DSNLEN)                                  0828 03889000
         LH    @07,LVLINDEX                                        0828 03890000
         LR    @04,@07                                             0828 03891000
         ALR   @04,@04                                             0828 03892000
         LH    @04,IXNLEN-2(@04)                                   0828 03893000
         EX    @04,@SM01319                                        0828 03894000
*        DSNLEN = DSNLEN + IXNLEN(LVLINDEX);               /*@YL026UD*/ 03895000
*                                                                  0829 03896000
         ALR   DSNLEN,@04                                          0829 03897000
*        /************************************************************/ 03898000
*        /*                                                  @YL026UD*/ 03899000
*        /*  ADD A PERIOD TO THE DATA SET NAME -             @YL026UD*/ 03900000
*        /*  TO SEPARATE SEGMENT JUST ADDED FROM THE NEXT    @YL026UD*/ 03901000
*        /*  INDEX LEVEL NAME SEGMENT TO BE ADDED            @YL026UD*/ 03902000
*        /*                                                  @YL026UD*/ 03903000
*        /************************************************************/ 03904000
*                                                                  0830 03905000
*        DSNAME(DSNLEN + 1) = PERIOD;                      /*@YL026UD*/ 03906000
*                                                                  0830 03907000
         LA    @08,DSNAME(DSNLEN)                                  0830 03908000
         MVI   0(@08),C'.'                                         0830 03909000
*        DSNLEN = DSNLEN + 1;                              /*@YL026UD*/ 03910000
*                                                                  0831 03911000
         LA    @08,1                                               0831 03912000
         ALR   DSNLEN,@08                                          0831 03913000
*        /************************************************************/ 03914000
*        /*                                                  @YL026UD*/ 03915000
*        /*  OBTAIN THE LOWER LEVEL INDEX BLOCK              @YL026UD*/ 03916000
*        /*  ('UPOSIT'/'UGET' MACROS)                        @YL026UD*/ 03917000
*        /*                                                  @YL026UD*/ 03918000
*        /************************************************************/ 03919000
*                                                                  0832 03920000
*        LVLINDEX = LVLINDEX + 1;                          /*@YL026UD*/ 03921000
*                                                                  0832 03922000
         ALR   @07,@08                                             0832 03923000
         STH   @07,LVLINDEX                                        0832 03924000
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/ 03925000
*                                                                  0833 03926000
         SLA   @07,8                                               0833 03927000
         L     @08,BLKLVPTR                                        0833 03928000
         AL    @08,@CF01312                                        0833 03929000
         LA    @08,BLOCK(@07,@08)                                  0833 03930000
         ST    @08,BLOCKPTR                                        0833 03931000
*        BLOCKTTR(1:3) = CATETTR;                          /*@YL026UD*/ 03932000
*                                                                  0834 03933000
         MVC   BLOCKTTR(3),CATETTR(CATPTR)                         0834 03934000
*        IIOCSPTR -> IOCTTR = BLOCKTTR;                    /*@YL026UD*/ 03935000
*                                                                  0835 03936000
         L     @08,IIOCSPTR                                        0835 03937000
         MVC   IOCTTR(4,@08),BLOCKTTR                              0835 03938000
*        CALL IDCIOPO0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 03939000
*                                                                  0836 03940000
         L     @08,@PC00001                                        0836 03941000
         ST    @08,@AL00001                                        0836 03942000
         LA    @07,IIOCSPTR                                        0836 03943000
         ST    @07,@AL00001+4                                      0836 03944000
         MVI   @AL00001+4,X'80'                                    0836 03945000
         L     @15,GDTPOS(,@08)                                    0836 03946000
         LA    @01,@AL00001                                        0836 03947000
         BALR  @14,@15                                             0836 03948000
*        CALL IDCIOGT0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 03949000
*                                                                  0837 03950000
         L     @08,@PC00001                                        0837 03951000
         ST    @08,@AL00001                                        0837 03952000
         LA    @07,IIOCSPTR                                        0837 03953000
         ST    @07,@AL00001+4                                      0837 03954000
         MVI   @AL00001+4,X'80'                                    0837 03955000
         L     @15,GDTGET(,@08)                                    0837 03956000
         LA    @01,@AL00001                                        0837 03957000
         BALR  @14,@15                                             0837 03958000
*        RESPECIFY RTNREG RSTD;                                    0838 03959000
*        TESTRC = RTNREG;                                          0839 03960000
         LR    TESTRC,RTNREG                                       0839 03961000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 03962000
*                                                                  0840 03963000
*        IF TESTRC ^= 0                                            0841 03964000
*          THEN                                                    0841 03965000
         LTR   TESTRC,TESTRC                                       0841 03966000
         BZ    @RF00841                                            0841 03967000
*            DO;                                           /*@YL026UD*/ 03968000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 03969000
         L     @08,@PC00001+8                                      0843 03970000
         MVC   LASTCOND(2,@08),@CH00037                            0843 03971000
*              RETURN;                                     /*@YL026UD*/ 03972000
@EL00011 DS    0H                                                  0844 03973000
@EF00011 DS    0H                                                  0844 03974000
@ER00011 LM    @14,@02,@SA00011                                    0844 03975000
         LM    @04,@05,@SA00011+20                                 0844 03976000
         LM    @07,@12,@SA00011+28                                 0844 03977000
         BR    @14                                                 0844 03978000
*            END;                                          /*@YL026UD*/ 03979000
*                                                                  0845 03980000
*        BLOCK(LVLINDEX) = BLKREAD;                        /*@YL026UD*/ 03981000
*                                                                  0846 03982000
@RF00841 LH    @08,LVLINDEX                                        0846 03983000
         SLA   @08,8                                               0846 03984000
         L     @07,BLKLVPTR                                        0846 03985000
         ALR   @07,@08                                             0846 03986000
         AL    @07,@CF01312                                        0846 03987000
         L     @08,IIOCSPTR                                        0846 03988000
         L     @08,IOCDAD(,@08)                                    0846 03989000
         MVC   BLOCK(256,@07),BLKREAD(@08)                         0846 03990000
*        CATPTR = BLOCKPTR + LENGTH(BLOCKCNT);             /*@YL026UD*/ 03991000
*                                                                  0847 03992000
         LA    CATPTR,2                                            0847 03993000
         AL    CATPTR,BLOCKPTR                                     0847 03994000
*        /************************************************************/ 03995000
*        /*                                                  @Y30SSMK*/ 03996000
*        /*  DUMP POINT TO DUMP INPUT SYSCTLG BLOCK          @Y30SSMK*/ 03997000
*        /*  OBTAINED AT SAME INDEX AS LAST BLOCK.           @Y30SSMK*/ 03998000
*        /*                                                  @Y30SSMK*/ 03999000
*        /************************************************************/ 04000000
*                                                                  0848 04001000
*        IF GDTDBG = NULLPTR                                       0848 04002000
*          THEN;                                                   0848 04003000
         L     @08,@PC00001                                        0848 04004000
         L     @08,GDTDBG(,@08)                                    0848 04005000
         LTR   @08,@08                                             0848 04006000
         BZ    @RT00848                                            0848 04007000
*          ELSE                                                    0850 04008000
*            CALL IDCDB010(GDTTBL,'CCPD',ADDR(DLISTBLK));          0850 04009000
         L     @08,@PC00001                                        0850 04010000
         ST    @08,@AL00001                                        0850 04011000
         LA    @07,@CC01191                                        0850 04012000
         ST    @07,@AL00001+4                                      0850 04013000
         LA    @07,DLISTBLK                                        0850 04014000
         ST    @07,@AFTEMPS+4                                      0850 04015000
         LA    @07,@AFTEMPS+4                                      0850 04016000
         ST    @07,@AL00001+8                                      0850 04017000
         MVI   @AL00001+8,X'80'                                    0850 04018000
         L     @15,GDTDBG(,@08)                                    0850 04019000
         LA    @01,@AL00001                                        0850 04020000
         BALR  @14,@15                                             0850 04021000
*                                                          /*@YL026UD*/ 04022000
*                                                                  0851 04023000
*        /************************************************************/ 04024000
*        /*                                                  @YL026UD*/ 04025000
*        /*  NEW BLOCK IS FIRST BLOCK OF INDEX -             @YL026UD*/ 04026000
*        /*  VERIFY THAT THE FIRST ENTRY IS AN               @YL026UD*/ 04027000
*        /*  INDEX CONTROL ENTRY (ICE)                       @YL026UD*/ 04028000
*        /*                                                  @YL026UD*/ 04029000
*        /************************************************************/ 04030000
*                                                                  0851 04031000
*        IF CATETYPE = TYPEICE                                     0851 04032000
*          THEN                                                    0851 04033000
@RT00848 CLC   CATETYPE(1,CATPTR),TYPEICE                          0851 04034000
         BNE   @RF00851                                            0851 04035000
*            DO;                                           /*@YL026UD*/ 04036000
*              /******************************************************/ 04037000
*              /*                                            @YL026UD*/ 04038000
*              /*  ENTRY IS AN 'ICE' -                       @YL026UD*/ 04039000
*              /*  BYPASS THE ICE ENTRY                      @YL026UD*/ 04040000
*              /*                                            @YL026UD*/ 04041000
*              /******************************************************/ 04042000
*                                                                  0853 04043000
*              CATPTR = CATPTR + (CATETYPE * 2) +                  0853 04044000
*                       LENGTH(CATFORM);                   /*@YL026UD*/ 04045000
         SLR   @08,@08                                             0853 04046000
         IC    @08,CATETYPE(,CATPTR)                               0853 04047000
         ALR   @08,@08                                             0853 04048000
         ALR   @08,CATPTR                                          0853 04049000
         AL    @08,@CF00037                                        0853 04050000
         LR    CATPTR,@08                                          0853 04051000
*            END;                                          /*@YL026UD*/ 04052000
*          ELSE                                                    0855 04053000
*            DO;                                           /*@Y30SSMK*/ 04054000
         B     @RC00851                                            0855 04055000
@RF00851 DS    0H                                                  0856 04056000
*              /******************************************************/ 04057000
*              /*                                            @YL026UD*/ 04058000
*              /*  ENTRY IS NOT AN 'ICE' -                   @YL026UD*/ 04059000
*              /*  FURTHER SCANNING OF THE SYSCTLG           @YL026UD*/ 04060000
*              /*  DATA SET IS IMPOSSIBLE -                  @YL026UD*/ 04061000
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/ 04062000
*              /*  CNVTCAT PROCESSING                        @YL026UD*/ 04063000
*              /*                                            @YL026UD*/ 04064000
*              /******************************************************/ 04065000
*                                                                  0856 04066000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 04067000
*                                                                  0856 04068000
         L     @08,DDSTRU                                          0856 04069000
         MVC   DARGSMOD(3,@08),@CC00831                            0856 04070000
*              DARGSENT = SCN1MSG#;                        /*@YL026UD*/ 04071000
*                                                                  0857 04072000
         MVI   DARGSENT(@08),X'05'                                 0857 04073000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 04074000
*                                                                  0858 04075000
         L     @08,@PC00001                                        0858 04076000
         ST    @08,@AL00001                                        0858 04077000
         LA    @07,@CF00113                                        0858 04078000
         ST    @07,@AL00001+4                                      0858 04079000
         LA    @07,DDSTRU                                          0858 04080000
         ST    @07,@AL00001+8                                      0858 04081000
         MVI   @AL00001+8,X'80'                                    0858 04082000
         L     @15,GDTPRT(,@08)                                    0858 04083000
         LA    @01,@AL00001                                        0858 04084000
         BALR  @14,@15                                             0858 04085000
*              DARGSENT = SCN2MSG#;                        /*@YL026UD*/ 04086000
*                                                                  0859 04087000
         L     @08,DDSTRU                                          0859 04088000
         MVI   DARGSENT(@08),X'06'                                 0859 04089000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 04090000
         LA    @07,DSNAME                                          0860 04091000
         ST    @07,DARGDBP(,@08)                                   0860 04092000
*              DARGILP = DSNLEN;                           /*@YL026UD*/ 04093000
*                                                                  0861 04094000
         STH   DSNLEN,DARGILP(,@08)                                0861 04095000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 04096000
*                                                                  0862 04097000
         L     @08,@PC00001                                        0862 04098000
         ST    @08,@AL00001                                        0862 04099000
         LA    @07,@CF00113                                        0862 04100000
         ST    @07,@AL00001+4                                      0862 04101000
         LA    @07,DDSTRU                                          0862 04102000
         ST    @07,@AL00001+8                                      0862 04103000
         MVI   @AL00001+8,X'80'                                    0862 04104000
         L     @15,GDTPRT(,@08)                                    0862 04105000
         LA    @01,@AL00001                                        0862 04106000
         BALR  @14,@15                                             0862 04107000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 04108000
*                                                                  0863 04109000
         L     @08,@PC00001+8                                      0863 04110000
         MVC   LASTCOND(2,@08),@CH00037                            0863 04111000
*              /******************************************************/ 04112000
*              /*                                            @Y30SSMK*/ 04113000
*              /*  DUMP POINT WHEN 'ICE' ENTRY IS NOT FOUND. @Y30SSMK*/ 04114000
*              /*                                            @Y30SSMK*/ 04115000
*              /******************************************************/ 04116000
*                                                                  0864 04117000
*              IF GDTDBG = NULLPTR                                 0864 04118000
*                THEN;                                             0864 04119000
         L     @08,@PC00001                                        0864 04120000
         L     @08,GDTDBG(,@08)                                    0864 04121000
         LTR   @08,@08                                             0864 04122000
         BZ    @RT00864                                            0864 04123000
*                ELSE                                              0866 04124000
*                  CALL IDCDB010(GDTTBL,'CCIE');                   0866 04125000
         L     @08,@PC00001                                        0866 04126000
         ST    @08,@AL00001                                        0866 04127000
         LA    @07,@CC01192                                        0866 04128000
         ST    @07,@AL00001+4                                      0866 04129000
         MVI   @AL00001+4,X'80'                                    0866 04130000
         L     @15,GDTDBG(,@08)                                    0866 04131000
         LA    @01,@AL00001                                        0866 04132000
         BALR  @14,@15                                             0866 04133000
*                                                          /*@YL026UD*/ 04134000
*                                                                  0867 04135000
*              RETURN;                                     /*@YL026UD*/ 04136000
         B     @EL00011                                            0867 04137000
*            END;                                          /*@YL026UD*/ 04138000
*                                                                  0868 04139000
*        END PUSHDOWN;                                     /*@YL026UD*/ 04140000
         B     @EL00011                                            0869 04141000
*/********************************************************************/ 04142000
*/*                                                          @YL026UD*/ 04143000
*/*  PROCEDURE NAME - CONTINUE                               @YL026UD*/ 04144000
*/*                                                          @YL026UD*/ 04145000
*/*  FUNCTION - PROCESSES THE CHANGE FROM SYSCTLG INDEX      @YL026UD*/ 04146000
*/*             BLOCK TO THE CONTINUATION OF THE SAME INDEX  @YL026UD*/ 04147000
*/*             LEVEL IN A NEW SYSCTLG INDEX BLOCK           @YL026UD*/ 04148000
*/*             WHILE SCANNING THE SYSCTLG DATA SET          @YL026UD*/ 04149000
*/*                                                          @YL026UD*/ 04150000
*/*             THE CONTINUATION SYSCTLG INDEX BLOCK IS      @YL026UD*/ 04151000
*/*             OBTAINED (VIA THE 'UPOSIT'/'UGET' MACROS)    @YL026UD*/ 04152000
*/*             FROM TTR INFORMATION IN THE CURRENT INDEX    @YL026UD*/ 04153000
*/*             ENTRY ('ILE' ENTRY WITH NONZERO TTR FIELD)   @YL026UD*/ 04154000
*/*                                                          @YL026UD*/ 04155000
*/*             THE FIRST ENTRY IN THE CONTINUATION INDEX    @YL026UD*/ 04156000
*/*             BLOCK IS NOT AN INDEX CONTROL ENTRY ('ICE')  @YL026UD*/ 04157000
*/*             SINCE THE BLOCK IS NOT THE BEGINNING OF A    @YL026UD*/ 04158000
*/*             INDEX LEVEL, BUT THE CONTINUATION OF ONE     @YL026UD*/ 04159000
*/*                                                          @YL026UD*/ 04160000
*/*             IF THE CONTINUATION INDEX BLOCK CANNOT BE    @YL026UD*/ 04161000
*/*             OBTAINED, PROCESSING IS TERMINATED           @YL026UD*/ 04162000
*/*                                                          @YL026UD*/ 04163000
*/*  INPUT - THE RELATIVE TRACK ADDRESS (TTR) OF THE         @YL026UD*/ 04164000
*/*          CONTINUATION SYSCTLG INDEX BLOCK AT WHICH       @YL026UD*/ 04165000
*/*          SCANNING IS TO CONTINUE                         @YL026UD*/ 04166000
*/*                                                          @YL026UD*/ 04167000
*/*  OUTPUT - THE ACQUIRED CONTINUATION BLOCK AT THE SAME    @YL026UD*/ 04168000
*/*           INDEX LEVEL WITH SCANNING POINTERS POSITIONED  @YL026UD*/ 04169000
*/*           TO THE FIRST ENTRY                             @YL026UD*/ 04170000
*/*                                                          @YL026UD*/ 04171000
*/********************************************************************/ 04172000
*                                                                  0870 04173000
*CONTINUE: PROCEDURE;                                      /*@YL026UD*/ 04174000
CONTINUE STM   @14,@02,@SA00012                                    0870 04175000
         STM   @04,@12,@SA00012+20                                 0870 04176000
*        OLDERID2 = NEWERID2;                                      0871 04177000
         L     @08,@PC00001                                        0871 04178000
         L     @04,GDTTR2(,@08)                                    0871 04179000
         MVC   @TS00001(95),NEWERID2(@04)                          0871 04180000
         MVC   OLDERID2(95,@04),@TS00001                           0871 04181000
*        NEWID2 = 'CCCE';                                  /*@YL026UD*/ 04182000
*                                                                  0872 04183000
         MVC   NEWID2(4,@04),@CC01196                              0872 04184000
*        /************************************************************/ 04185000
*        /*                                                  @YL026UD*/ 04186000
*        /*  OBTAIN THE CONTINUATION INDEX BLOCK             @YL026UD*/ 04187000
*        /*  ('UPOSIT'/'UGET' MACROS)                        @YL026UD*/ 04188000
*        /*                                                  @YL026UD*/ 04189000
*        /************************************************************/ 04190000
*                                                                  0873 04191000
*        BLOCKTTR(1:3) = CATETTR;                          /*@YL026UD*/ 04192000
*                                                                  0873 04193000
         MVC   BLOCKTTR(3),CATETTR(CATPTR)                         0873 04194000
*        IIOCSPTR -> IOCTTR = BLOCKTTR;                    /*@YL026UD*/ 04195000
*                                                                  0874 04196000
         L     @04,IIOCSPTR                                        0874 04197000
         MVC   IOCTTR(4,@04),BLOCKTTR                              0874 04198000
*        CALL IDCIOPO0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 04199000
*                                                                  0875 04200000
         ST    @08,@AL00001                                        0875 04201000
         LA    @04,IIOCSPTR                                        0875 04202000
         ST    @04,@AL00001+4                                      0875 04203000
         MVI   @AL00001+4,X'80'                                    0875 04204000
         L     @15,GDTPOS(,@08)                                    0875 04205000
         LA    @01,@AL00001                                        0875 04206000
         BALR  @14,@15                                             0875 04207000
*        CALL IDCIOGT0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/ 04208000
*                                                                  0876 04209000
         L     @08,@PC00001                                        0876 04210000
         ST    @08,@AL00001                                        0876 04211000
         LA    @04,IIOCSPTR                                        0876 04212000
         ST    @04,@AL00001+4                                      0876 04213000
         MVI   @AL00001+4,X'80'                                    0876 04214000
         L     @15,GDTGET(,@08)                                    0876 04215000
         LA    @01,@AL00001                                        0876 04216000
         BALR  @14,@15                                             0876 04217000
*        RESPECIFY RTNREG RSTD;                                    0877 04218000
*        TESTRC = RTNREG;                                          0878 04219000
         LR    TESTRC,RTNREG                                       0878 04220000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 04221000
*                                                                  0879 04222000
*        IF TESTRC ^= 0                                            0880 04223000
*          THEN                                                    0880 04224000
         LTR   TESTRC,TESTRC                                       0880 04225000
         BZ    @RF00880                                            0880 04226000
*            DO;                                           /*@YL026UD*/ 04227000
*              LASTCOND = LASTCC12;                        /*@YL026UD*/ 04228000
         L     @08,@PC00001+8                                      0882 04229000
         MVC   LASTCOND(2,@08),@CH00037                            0882 04230000
*              RETURN;                                     /*@YL026UD*/ 04231000
@EL00012 DS    0H                                                  0883 04232000
@EF00012 DS    0H                                                  0883 04233000
@ER00012 LM    @14,@02,@SA00012                                    0883 04234000
         LM    @04,@12,@SA00012+20                                 0883 04235000
         BR    @14                                                 0883 04236000
*            END;                                          /*@YL026UD*/ 04237000
*                                                                  0884 04238000
*        BLOCK(LVLINDEX) = BLKREAD;                        /*@YL026UD*/ 04239000
*                                                                  0885 04240000
@RF00880 LH    @08,LVLINDEX                                        0885 04241000
         SLA   @08,8                                               0885 04242000
         L     @02,BLKLVPTR                                        0885 04243000
         ALR   @02,@08                                             0885 04244000
         AL    @02,@CF01312                                        0885 04245000
         L     @08,IIOCSPTR                                        0885 04246000
         L     @08,IOCDAD(,@08)                                    0885 04247000
         MVC   BLOCK(256,@02),BLKREAD(@08)                         0885 04248000
*        CATPTR = BLOCKPTR + LENGTH(BLOCKCNT);             /*@YL026UD*/ 04249000
*                                                                  0886 04250000
         LA    CATPTR,2                                            0886 04251000
         AL    CATPTR,BLOCKPTR                                     0886 04252000
*        /************************************************************/ 04253000
*        /*                                                  @Y30SSMK*/ 04254000
*        /*  DUMP POINT AFTER SYSCTLG BLOCK AT SAME INDEX AS @Y30SSMK*/ 04255000
*        /*  LAST BLOCK IS OBTAINED.                         @Y30SSMK*/ 04256000
*        /*                                                  @Y30SSMK*/ 04257000
*        /************************************************************/ 04258000
*                                                                  0887 04259000
*        IF GDTDBG = NULLPTR                                       0887 04260000
*          THEN;                                                   0887 04261000
         L     @08,@PC00001                                        0887 04262000
         L     @08,GDTDBG(,@08)                                    0887 04263000
         LTR   @08,@08                                             0887 04264000
         BZ    @RT00887                                            0887 04265000
*          ELSE                                                    0889 04266000
*            CALL IDCDB010(GDTTBL,'CCCN',ADDR(DLISTBLK));          0889 04267000
         L     @08,@PC00001                                        0889 04268000
         ST    @08,@AL00001                                        0889 04269000
         LA    @02,@CC01197                                        0889 04270000
         ST    @02,@AL00001+4                                      0889 04271000
         LA    @02,DLISTBLK                                        0889 04272000
         ST    @02,@AFTEMPS+8                                      0889 04273000
         LA    @02,@AFTEMPS+8                                      0889 04274000
         ST    @02,@AL00001+8                                      0889 04275000
         MVI   @AL00001+8,X'80'                                    0889 04276000
         L     @15,GDTDBG(,@08)                                    0889 04277000
         LA    @01,@AL00001                                        0889 04278000
         BALR  @14,@15                                             0889 04279000
*                                                          /*@YL026UD*/ 04280000
*                                                                  0890 04281000
*        END CONTINUE;                                     /*@YL026UD*/ 04282000
         B     @EL00012                                            0890 04283000
*/********************************************************************/ 04284000
*/*                                                          @YL026UD*/ 04285000
*/*  PROCEDURE NAME - POPUP                                  @YL026UD*/ 04286000
*/*                                                          @YL026UD*/ 04287000
*/*  FUNCTION - PROCESSES THE CHANGE FROM ONE SYSCTLG INDEX  @YL026UD*/ 04288000
*/*             LEVEL TO A HIGHER SYSCTLG INDEX LEVEL        @YL026UD*/ 04289000
*/*             WHILE SCANNING THE SYSCTLG DATA SET          @YL026UD*/ 04290000
*/*                                                          @YL026UD*/ 04291000
*/*             SCANNING CONTINUES AT A HIGHER INDEX LEVEL   @YL026UD*/ 04292000
*/*             WHEN THE END OF THE CURRENT INDEX LEVEL IS   @YL026UD*/ 04293000
*/*             ENCOUNTERED ('ILE' ENTRY WITH A ZERO TTR,    @YL026UD*/ 04294000
*/*             OR AT THE END OF A 'VCB')                    @YL026UD*/ 04295000
*/*                                                          @YL026UD*/ 04296000
*/*             THE HIGHER LEVEL SYSCTLG INDEX BLOCK IS      @YL026UD*/ 04297000
*/*             OBTAINED (I.E., RETURNED TO) BY RESTORING    @YL026UD*/ 04298000
*/*             THE SAVED STATUS OF THE HIGHER LEVEL INDEX   @YL026UD*/ 04299000
*/*             LEVEL -                                      @YL026UD*/ 04300000
*/*             I.E., THE OFFSET WITHIN THE INDEX BLOCK      @YL026UD*/ 04301000
*/*                                                          @YL026UD*/ 04302000
*/*             THE INDEX NAME FROM THE CURRENT INDEX LEVEL  @YL026UD*/ 04303000
*/*             IS REMOVED FROM THE DATA SET NAME BEING      @YL026UD*/ 04304000
*/*             BUILT                                        @YL026UD*/ 04305000
*/*                                                          @YL026UD*/ 04306000
*/*             IF THE RESTORED HIGHER-LEVEL INDEX IS THE    @YL026UD*/ 04307000
*/*             VOLUME INDEX, THEN THE 'ALIAS PROCESSING'    @YL026UD*/ 04308000
*/*             FLAG IS TURNED OFF                           @YL026UD*/ 04309000
*/*                                                          @YL026UD*/ 04310000
*/*             THE 'G0000V00 PROCESSING' FLAG (IF ON) IS    @YL026UD*/ 04311000
*/*             TURNED OFF BEFORE SCANNING THE RESTORED      @YL026UD*/ 04312000
*/*             HIGHER LEVEL INDEX                           @YL026UD*/ 04313000
*/*                                                          @YL026UD*/ 04314000
*/*  INPUT - THE OFFSET WITHIN THE HIGHER LEVEL SYSCTLG      @YL026UD*/ 04315000
*/*          INDEX BLOCK (RETRIEVED FROM THE PUSH-DOWN       @YL026UD*/ 04316000
*/*          STACK)                                          @YL026UD*/ 04317000
*/*                                                          @YL026UD*/ 04318000
*/*  OUTPUT - THE RESTORED STATUS OF THE HIGHER LEVEL        @YL026UD*/ 04319000
*/*           SYSCTLG INDED BLOCK WITH SCANNING POINTERS     @YL026UD*/ 04320000
*/*           POSITIONED FOLLOWING THE ENTRY AT WHICH        @YL026UD*/ 04321000
*/*           PREVIOUS SCANNING (OF THIS BLOCK) WAS          @YL026UD*/ 04322000
*/*           INTERRUPTED                                    @YL026UD*/ 04323000
*/*                                                          @YL026UD*/ 04324000
*/********************************************************************/ 04325000
*                                                                  0891 04326000
*POPUP:    PROCEDURE;                                      /*@YL026UD*/ 04327000
POPUP    STM   @14,@02,@SA00013                                    0891 04328000
         STM   @04,@05,@SA00013+20                                 0891 04329000
         STM   @07,@12,@SA00013+28                                 0891 04330000
*        OLDERID2 = NEWERID2;                                      0892 04331000
         L     @08,@PC00001                                        0892 04332000
         L     @08,GDTTR2(,@08)                                    0892 04333000
         MVC   @TS00001(95),NEWERID2(@08)                          0892 04334000
         MVC   OLDERID2(95,@08),@TS00001                           0892 04335000
*        NEWID2 = 'CCPP';                                  /*@YL026UD*/ 04336000
*                                                                  0893 04337000
         MVC   NEWID2(4,@08),@CC01201                              0893 04338000
*        /************************************************************/ 04339000
*        /*                                                  @YL026UD*/ 04340000
*        /*  REMOVE LAST DATA SET NAME SEGMENT FROM          @YL026UD*/ 04341000
*        /*  DATA SET NAME                                   @YL026UD*/ 04342000
*        /*                                                  @YL026UD*/ 04343000
*        /*  RESTORE THE SAVED STATUS OF THE INDEX LEVEL     @YL026UD*/ 04344000
*        /*  TO WHICH SCANNING IS RETURNING -                @YL026UD*/ 04345000
*        /*  THE OFFSET WITHIN THE INDEX BLOCK               @YL026UD*/ 04346000
*        /*                                                  @YL026UD*/ 04347000
*        /************************************************************/ 04348000
*                                                                  0894 04349000
*        LVLINDEX = LVLINDEX - 1;                          /*@YL026UD*/ 04350000
*                                                                  0894 04351000
         LH    @08,LVLINDEX                                        0894 04352000
         BCTR  @08,0                                               0894 04353000
         STH   @08,LVLINDEX                                        0894 04354000
*        DSNLEN = DSNLEN - (IXNLEN(LVLINDEX) + 1);         /*@YL026UD*/ 04355000
*                                                                  0895 04356000
         LA    @07,1                                               0895 04357000
         LR    @02,@08                                             0895 04358000
         ALR   @02,@02                                             0895 04359000
         LH    @15,IXNLEN-2(@02)                                   0895 04360000
         ALR   @15,@07                                             0895 04361000
         SLR   DSNLEN,@15                                          0895 04362000
*        DSNAME(DSNLEN+1:DSNLEN+9) = '        ';           /*@YL026UD*/ 04363000
*                                                                  0896 04364000
         LA    @01,DSNAME(DSNLEN)                                  0896 04365000
         MVI   8(@01),C' '                                         0896 04366000
         MVC   0(8,@01),@CC01167                                   0896 04367000
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/ 04368000
*                                                                  0897 04369000
         LR    @15,@08                                             0897 04370000
         SLA   @15,8                                               0897 04371000
         L     @01,BLKLVPTR                                        0897 04372000
         AL    @01,@CF01312                                        0897 04373000
         LA    @15,BLOCK(@15,@01)                                  0897 04374000
         ST    @15,BLOCKPTR                                        0897 04375000
*        /************************************************************/ 04376000
*        /*                                                  @YL026UD*/ 04377000
*        /*  RETURN TO THE HIGHER LEVEL INDEX BLOCK          @YL026UD*/ 04378000
*        /*                                                  @YL026UD*/ 04379000
*        /************************************************************/ 04380000
*                                                                  0898 04381000
*        CATPTR = BLOCKPTR + LVLOFSET(LVLINDEX);           /*@YL026UD*/ 04382000
*                                                                  0898 04383000
         AH    @15,LVLOFSET-2(@02)                                 0898 04384000
         LR    CATPTR,@15                                          0898 04385000
*        /************************************************************/ 04386000
*        /*                                                  @YL026UD*/ 04387000
*        /*  IF RESTORED INDEX IS THE VOLUME INDEX           @YL026UD*/ 04388000
*        /*  (I.E., THE FIRST-LEVEL INDEX),                  @YL026UD*/ 04389000
*        /*  TURN OFF THE 'ALIAS PROCESSING' FLAG            @YL026UD*/ 04390000
*        /*                                                  @YL026UD*/ 04391000
*        /************************************************************/ 04392000
*                                                                  0899 04393000
*        IF LVLINDEX = 1                                           0899 04394000
*          THEN                                                    0899 04395000
         CR    @08,@07                                             0899 04396000
         BNE   @RF00899                                            0899 04397000
*            ALIASFLG = OFF;                               /*@YL026UD*/ 04398000
*                                                                  0900 04399000
         NI    ALIASFLG,B'01111111'                                0900 04400000
*        /************************************************************/ 04401000
*        /*                                                  @Y30SSMK*/ 04402000
*        /*  DUMP POINT WHEN READY TO CONTINUE SCAN OF       @Y30SSMK*/ 04403000
*        /*  HIGHER LEVEL INDEX BLOCK.                       @Y30SSMK*/ 04404000
*        /*                                                  @Y30SSMK*/ 04405000
*        /************************************************************/ 04406000
*                                                                  0901 04407000
*        IF GDTDBG = NULLPTR                                       0901 04408000
*          THEN;                                                   0901 04409000
@RF00899 L     @08,@PC00001                                        0901 04410000
         L     @08,GDTDBG(,@08)                                    0901 04411000
         LTR   @08,@08                                             0901 04412000
         BZ    @RT00901                                            0901 04413000
*          ELSE                                                    0903 04414000
*            CALL IDCDB010(GDTTBL,'CCPU');                         0903 04415000
         L     @08,@PC00001                                        0903 04416000
         ST    @08,@AL00001                                        0903 04417000
         LA    @07,@CC01202                                        0903 04418000
         ST    @07,@AL00001+4                                      0903 04419000
         MVI   @AL00001+4,X'80'                                    0903 04420000
         L     @15,GDTDBG(,@08)                                    0903 04421000
         LA    @01,@AL00001                                        0903 04422000
         BALR  @14,@15                                             0903 04423000
*                                                          /*@YL026UD*/ 04424000
*                                                                  0904 04425000
*        END POPUP;                                        /*@YL026UD*/ 04426000
@EL00013 DS    0H                                                  0904 04427000
@EF00013 DS    0H                                                  0904 04428000
@ER00013 LM    @14,@02,@SA00013                                    0904 04429000
         LM    @04,@05,@SA00013+20                                 0904 04430000
         LM    @07,@12,@SA00013+28                                 0904 04431000
         BR    @14                                                 0904 04432000
*/********************************************************************/ 04433000
*/*                                                          @YL026UD*/ 04434000
*/*  PROCEDURE NAME - CATALOG                                @YL026UD*/ 04435000
*/*                                                          @YL026UD*/ 04436000
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/ 04437000
*/*             (CPL, FVT, AND FPLS) WHICH 'DEFINE' THE      @YL026UD*/ 04438000
*/*             ENTRY TO BE CONVERTED TO THE VSAM CATALOG.   @YL026UD*/ 04439000
*/*             THE ENTRY IS DEFINED TO THE VSAM CATALOG     @YL026UD*/ 04440000
*/*             VIA THE 'UCATLG' MACRO.                      @YL026UD*/ 04441000
*/*                                                          @YL026UD*/ 04442000
*/*             THREE VSAM ENTRY TYPES CAN BE DEFINED -      @YL026UD*/ 04443000
*/*             (1) 'NONVSAM' ENTRY                          @YL026UD*/ 04444000
*/*                 (FOR SYSCTLG 'DSPE' OR 'VCBPE' ENTRY)    @YL026UD*/ 04445000
*/*             (2) 'GDG BASE' ENTRY                         @YL026UD*/ 04446000
*/*                 (FOR SYSCTLG 'GIPE' ENTRY)               @YL026UD*/ 04447000
*/*             (3) 'ALIAS' ENTRY                            @YL026UD*/ 04448000
*/*                 (FOR SYSCTLG 'AE' OR 'CVPE' ENTRY)       @YL026UD*/ 04449000
*/*                 (A 'CVPE' ENTRY IS CONVERTED INTO AN     @YL026UD*/ 04450000
*/*                 ALIAS ENTRY IN THE VSAM MASTER CATALOG)  @YL026UD*/ 04451000
*/*                                                          @YL026UD*/ 04452000
*/*             THE VSAM CATALOG RETURN CODE IS EXAMINED     @YL026UD*/ 04453000
*/*             TO DETERMINE IS THE 'DEFINE' REQUEST WAS     @YL026UD*/ 04454000
*/*             SUCCESSFUL, IF THE ENTRY ALREADY EXISTS IN   @YL026UD*/ 04455000
*/*             THE VSAM CATALOG, OR IF THERE WAS ANOTHER    @YL026UD*/ 04456000
*/*             REASON FOR FAILURE.                          @YL026UD*/ 04457000
*/*                                                          @YL026UD*/ 04458000
*/*             IF THE ENTRY ALREADY EXISTS IN THE VSAM      @YL026UD*/ 04459000
*/*             CATALOG, AND THE ENTRY NAME DOES NOT BEGIN   @YL026UD*/ 04460000
*/*             WITH 'SYS1.', A VSAM 'LOCATE' REQUEST IS     @YL026UD*/ 04461000
*/*             ISSUED TO DETERMINE THE ENTRY TYPE AND THE   @YL026UD*/ 04462000
*/*             VOLUME INFORMATION OF THE CATALOGED ENTRY.   @YL026UD*/ 04463000
*/*                                                          @YL026UD*/ 04464000
*/*             IF THE CATALOGED ENTRY IS NOT A NONVSAM      @YL026UD*/ 04465000
*/*             ENTRY, NO FURTHER ACTION IS TAKEN.           @YL026UD*/ 04466000
*/*                                                          @YL026UD*/ 04467000
*/*             IF THE CATALOGED ENTRY IS A NONVSAM ENTRY,   @YL026UD*/ 04468000
*/*             IT IS ASSUMED TO BE THE SAME DATA SET AS     @YL026UD*/ 04469000
*/*             THE DATA SET ENTRY UNDERGOING CONVERSION.    @YL026UD*/ 04470000
*/*             THE VOLUME INFORMATION RETURNED BY THE       @YL026UD*/ 04471000
*/*             'LOCATE' REQUEST IS COMPARED WITH THAT OF    @YL026UD*/ 04472000
*/*             THE ENTRY UNDERGOING CONVERSION.  IF THE     @YL026UD*/ 04473000
*/*             VOLUME INFORMATION IS DIFFERENT, A VSAM      @YL026UD*/ 04474000
*/*             'ALTER' REQUEST IS ISSUED AGAINST THE        @YL026UD*/ 04475000
*/*             CATALOGED ENTRY TO UPDATE THE VOLUME         @YL026UD*/ 04476000
*/*             INFORMATION TO AGREE WITH THAT OF THE ENTRY  @YL026UD*/ 04477000
*/*             UNDERGOING CONVERSION.                       @YL026UD*/ 04478000
*/*                                                          @YL026UD*/ 04479000
*/*  INPUT - THE VOLUME LIST (FOR THE FVT PSEUDO FPL),       @YL026UD*/ 04480000
*/*          THE DEVICE LIST (FOR THE DEVICE TYPE FPL),      @YL026UD*/ 04481000
*/*          THE DATA SET SEQUENCE LIST (FOR THE DATA SET    @YL026UD*/ 04482000
*/*          SEQUENCE FPL),                                  @YL026UD*/ 04483000
*/*          THE NAME OF THE ENTRY TO BE CONVERTED           @YL026UD*/ 04484000
*/*                                                          @YL026UD*/ 04485000
*/*  OUTPUT - THE SUCCESSFUL CONVERSION OR UPDATING OF THE   @YL026UD*/ 04486000
*/*           SPECIFIED ENTRY (IF THE 'LIST' OPTION IS       @YL026UD*/ 04487000
*/*           SPECIFIED OR DEFAULTED, THE CONVERTED OR       @YL026UD*/ 04488000
*/*           UPDATED ENTRY NAME WILL BE PRINTED), OR AN     @YL026UD*/ 04489000
*/*           ERROR MESSAGE IS PRINTED EXPLAINING THE        @YL026UD*/ 04490000
*/*           REASON FOR THE UNSUCCESSFUL CONVERSION OR      @YL026UD*/ 04491000
*/*           UPDATING OF THE SPECIFIED ENTRY.               @YL026UD*/ 04492000
*/*                                                          @YL026UD*/ 04493000
*/********************************************************************/ 04494000
*                                                                  0905 04495000
*CATALOG: PROCEDURE;                                       /*@YL026UD*/ 04496000
CATALOG  STM   @14,@06,@SA00014                                    0905 04497000
         STM   @08,@12,@SA00014+36                                 0905 04498000
*        /************************************************************/ 04499000
*        /*                                                  @YL026UD*/ 04500000
*        /*  DECLARATIONS FOR 'CATALOG' PROCEDURE            @YL026UD*/ 04501000
*        /*                                                  @YL026UD*/ 04502000
*        /************************************************************/ 04503000
*                                                                  0906 04504000
*        DCL SYS1NAME CHAR(5)   CONSTANT('SYS1.');         /*@YL026UD*/ 04505000
*                                      /*'SYS1.' DATA SET    @YL026UD*/ 04506000
*                                      /*NAME PREFIX         @YL026UD*/ 04507000
*                                                                  0907 04508000
*        DCL CATZERO  CHAR(8)   INIT('0000000000000000'X); /*@YL026UD*/ 04509000
*                                      /*8-BYTE ZERO FIELD   @YL026UD*/ 04510000
*                                                                  0908 04511000
*        DCL DEVTCON  CHAR(8)   CONSTANT('DEVTYP  ');      /*@YL026UD*/ 04512000
*                                      /*'DEVTYPE' FPL-TYPE  @YL026UD*/ 04513000
*        DCL FILECON  CHAR(8)   CONSTANT('FILESEQ ');      /*@YL026UD*/ 04514000
*                                      /*'FILESEQ' FPL-TYPE  @YL026UD*/ 04515000
*        DCL ENTYPCON CHAR(8)   CONSTANT('ENTYPE  ');      /*@YL026UD*/ 04516000
*                                      /*'ENTYPE'  FPL-TYPE  @YL026UD*/ 04517000
*        DCL CATVLCON CHAR(8)   CONSTANT('CATVOL  ');      /*@YL026UD*/ 04518000
*                                      /*'CATVOL'  FPL-TYPE  @YL026UD*/ 04519000
*                                                                  0912 04520000
*        DCL LOCATFLG BIT(1);          /*'LOCATE ENTRY' FLAG @YL026UD*/ 04521000
*        DCL MATCHFLG BIT(1);          /*'VOLUME MATCH' FLAG @YL026UD*/ 04522000
*        DCL SCANFLAG BIT(1);          /*'VOLUME SCAN'  FLAG @YL026UD*/ 04523000
*                                                                  0914 04524000
*        DCL CATVINDX FIXED(15);       /*VSAM    VOLUME      @YL026UD*/ 04525000
*                                      /*INFORMATION INDEX   @YL026UD*/ 04526000
*        DCL VOLINDX  FIXED(15);       /*SYSCTLG VOLUME      @YL026UD*/ 04527000
*                                      /*INFORMATION INDEX   @YL026UD*/ 04528000
*                                                                  0917 04529000
*        DCL DUPLCODE FIXED(15) CONSTANT(8);               /*@YL026UD*/ 04530000
*                                      /*'DUPLICATE ENTRY'   @YL026UD*/ 04531000
*                                      /*VSAM RETURN CODE    @YL026UD*/ 04532000
*        DCL CATFULL FIXED(15) CONSTANT(20);               /*@VS04383*/ 04533000
*                                      /* 'CATALOG FULL'     @VS04383*/ 04534000
*                                      /* VSAM RETURN CODE   @VS04383*/ 04535000
*        DCL WKASCODE FIXED(15) CONSTANT(40);              /*@YL026UD*/ 04536000
*                                      /*'WORKAREA SPACE'    @YL026UD*/ 04537000
*                                      /*VSAM RETURN CODE    @YL026UD*/ 04538000
*                                                                  0920 04539000
*        DCL LOCINFO  CHAR(256) BASED; /*INFORMATION         @YL026UD*/ 04540000
*                                      /*RETURNED FROM VSAM  @YL026UD*/ 04541000
*                                      /*'LOCATE' REQUEST    @YL026UD*/ 04542000
*                                                                  0921 04543000
*        DCL ERRORTAB CHAR(LENGTH(ERCNVTAB)) BDY(WORD);    /*@Y30SSMK*/ 04544000
*                                      /*ERROR CONVERSION TABLE      */ 04545000
*        DCL ERRORTYP FIXED(8);                            /*@Y30SSMK*/ 04546000
*                                      /*CATALOG OPERATION PERFORMED */ 04547000
*        DCL ERRORDE FIXED(8) CONSTANT(1);                 /*@Y30SSMK*/ 04548000
*                                      /*CATALOG DEFINE ERROR        */ 04549000
*        DCL ERRORLC FIXED(8) CONSTANT(2);                 /*@Y30SSMK*/ 04550000
*                                      /*CATALOG LOCATE ERROR        */ 04551000
*        DCL ERRORAL FIXED(8) CONSTANT(3);                 /*@Y30SSMK*/ 04552000
*                                      /*CATALOG ALTER ERROR @Y30SSMK*/ 04553000
*        OLDERID2 = NEWERID2;                                      0926 04554000
         L     @07,@PC00001                                        0926 04555000
         L     @07,GDTTR2(,@07)                                    0926 04556000
         MVC   @TS00001(95),NEWERID2(@07)                          0926 04557000
         MVC   OLDERID2(95,@07),@TS00001                           0926 04558000
*        NEWID2 = 'CCCT';                                  /*@YL026UD*/ 04559000
*                                                                  0927 04560000
         MVC   NEWID2(4,@07),@CC01234                              0927 04561000
*        /************************************************************/ 04562000
*        /*                                                  @YL026UD*/ 04563000
*        /*  IF ENTRY NAME IS AN ALIAS DATA SET NAME -       @YL026UD*/ 04564000
*        /*  OBTAIN THE TRUE DATA SET NAME BEFORE            @YL026UD*/ 04565000
*        /*  'DEFINING' THE CORRESPONDING VSAM ALIAS ENTRY   @YL026UD*/ 04566000
*        /*  AND DETERMINE IF THE TRUE DATA SET NAME MUST    @YL026UD*/ 04567000
*        /*  BE 'DEFINED' BEFORE THE ALIAS DATA SET NAME     @YL026UD*/ 04568000
*        /*                                                  @YL026UD*/ 04569000
*        /************************************************************/ 04570000
*                                                                  0928 04571000
*        IF ALIASFLG = ON                                          0928 04572000
*          THEN                                                    0928 04573000
         TM    ALIASFLG,B'10000000'                                0928 04574000
         BNO   @RF00928                                            0928 04575000
*            DO;                                           /*@YL026UD*/ 04576000
*                                                                  0929 04577000
*              TRUEDSN = ' ';                              /*@YL026UD*/ 04578000
*                                                                  0930 04579000
         MVI   TRUEDSN+1,C' '                                      0930 04580000
         MVC   TRUEDSN+2(42),TRUEDSN+1                             0930 04581000
         MVI   TRUEDSN,C' '                                        0930 04582000
*              TRUEDSN(1:TRUENLEN) = TRUENAME;             /*@YL026UD*/ 04583000
*                                                                  0931 04584000
         LH    @07,TRUENLEN                                        0931 04585000
         LR    @05,@07                                             0931 04586000
         BCTR  @05,0                                               0931 04587000
         EX    @05,@SM01321                                        0931 04588000
*              TRUEDSN(TRUENLEN+1:DSNLEN+TRUENLEN-IXNLEN(1)) =     0932 04589000
*                     DSNAME(IXNLEN(1)+1:DSNLEN);          /*@YL026UD*/ 04590000
*                                                                  0932 04591000
         LA    @05,TRUEDSN(@07)                                    0932 04592000
         LR    @15,DSNLEN                                          0932 04593000
         ALR   @15,@07                                             0932 04594000
         LH    @14,IXNLEN                                          0932 04595000
         SLR   @15,@14                                             0932 04596000
         SLR   @15,@07                                             0932 04597000
         BCTR  @15,0                                               0932 04598000
         LA    @07,DSNAME(@14)                                     0932 04599000
         EX    @15,@SM01323                                        0932 04600000
*              /******************************************************/ 04601000
*              /*                                            @YL026UD*/ 04602000
*              /*  DETERMINE IF THE TRUE DATA SET NAME MUST  @YL026UD*/ 04603000
*              /*  BE 'DEFINED' OR IS ALREADY CONVERTED      @YL026UD*/ 04604000
*              /*                                            @YL026UD*/ 04605000
*              /*  THE TRUE ENTRY NAME MUST EXIST BEFORE     @YL026UD*/ 04606000
*              /*  THE ALIAS ENTRY CAN BE 'DEFINED'          @YL026UD*/ 04607000
*              /*                                            @YL026UD*/ 04608000
*              /******************************************************/ 04609000
*                                                                  0933 04610000
*              IF DSNAME < TRUEDSN                                 0933 04611000
*                THEN                                              0933 04612000
         CLC   DSNAME(44),TRUEDSN                                  0933 04613000
         BNL   @RF00933                                            0933 04614000
*                  DO;                                     /*@YL026UD*/ 04615000
*                    /************************************************/ 04616000
*                    /*                                      @YL026UD*/ 04617000
*                    /*  THE TRUE DATA SET NAME HAS NOT BEEN @YL026UD*/ 04618000
*                    /*  'DEFINED' -                         @YL026UD*/ 04619000
*                    /*  CONVERT THE TRUE DATA SET NAME NOW  @YL026UD*/ 04620000
*                    /*                                      @YL026UD*/ 04621000
*                    /************************************************/ 04622000
*                                                                  0935 04623000
*                    ALIASDSN = DSNAME;                    /*@YL026UD*/ 04624000
         MVC   ALIASDSN(44),DSNAME                                 0935 04625000
*                    DSNAME = TRUEDSN;                     /*@YL026UD*/ 04626000
*                                                                  0936 04627000
         MVC   DSNAME(44),TRUEDSN                                  0936 04628000
*                    TRUEFLG = ON;                         /*@YL026UD*/ 04629000
         OI    TRUEFLG,B'10000000'                                 0937 04630000
*                    ALIASFLG = OFF;                       /*@YL026UD*/ 04631000
*                                                                  0938 04632000
         NI    ALIASFLG,B'01111111'                                0938 04633000
*                  END;                                    /*@YL026UD*/ 04634000
*                                                                  0939 04635000
*            END;                                          /*@YL026UD*/ 04636000
*          ELSE                                                    0941 04637000
*            /********************************************************/ 04638000
*            /*                                              @YL026UD*/ 04639000
*            /*  IF ENTRY NAME IS AN ALIAS DATA SET NAME     @YL026UD*/ 04640000
*            /*  WHOSE RELATED TRUE DATA SET NAME WAS        @YL026UD*/ 04641000
*            /*  'DEFINED' DURING THE PREVIOUS CALL TO       @YL026UD*/ 04642000
*            /*  'CATALOG' PROCEDURE -                       @YL026UD*/ 04643000
*            /*  OBTAIN THE ALIAS DATA SET NAME AND 'DEFINE' @YL026UD*/ 04644000
*            /*  THE VSAM ALIAS ENTRY AT THIS TIME           @YL026UD*/ 04645000
*            /*                                              @YL026UD*/ 04646000
*            /********************************************************/ 04647000
*                                                                  0941 04648000
*            IF TRUEFLG = ON                                       0941 04649000
*              THEN                                                0941 04650000
         B     @RC00928                                            0941 04651000
@RF00928 TM    TRUEFLG,B'10000000'                                 0941 04652000
         BNO   @RF00941                                            0941 04653000
*                DO;                                       /*@YL026UD*/ 04654000
*                                                                  0942 04655000
*                  TRUEFLG = OFF;                          /*@YL026UD*/ 04656000
         NI    TRUEFLG,B'01111111'                                 0943 04657000
*                  ALIASFLG = ON;                          /*@YL026UD*/ 04658000
*                                                                  0944 04659000
         OI    ALIASFLG,B'10000000'                                0944 04660000
*                  DSNAME = ALIASDSN;                      /*@YL026UD*/ 04661000
*                                                                  0945 04662000
         MVC   DSNAME(44),ALIASDSN                                 0945 04663000
*                END;                                      /*@YL026UD*/ 04664000
*                                                                  0946 04665000
*        /************************************************************/ 04666000
*        /*                                                  @YL026UD*/ 04667000
*        /*  IF ENTRY NAME IS A GENERATION DATA SET NAME -   @YL026UD*/ 04668000
*        /*  COMPLEMENT THE G0000V00 GENERATION NUMBER       @YL026UD*/ 04669000
*        /*  BEFORE 'DEFINING' THE CORRESPONDING VSAM        @YL026UD*/ 04670000
*        /*  ALIEN (NONVSAM) ENTRY                           @YL026UD*/ 04671000
*        /*                                                  @YL026UD*/ 04672000
*        /************************************************************/ 04673000
*                                                                  0947 04674000
*        IF G0V0FLAG = ON                                          0947 04675000
*          THEN                                                    0947 04676000
@RF00941 DS    0H                                                  0947 04677000
@RC00928 TM    G0V0FLAG,B'10000000'                                0947 04678000
         BNO   @RF00947                                            0947 04679000
*            DO;                                           /*@YL026UD*/ 04680000
*                                                                  0948 04681000
*              DSNAME(DSNLEN-6:DSNLEN-3) =                         0949 04682000
*                    DSNAME(DSNLEN-6:DSNLEN-3) && ALLONES; /*@YL026UD*/ 04683000
*                                                                  0949 04684000
         LA    @07,DSNAME-7(DSNLEN)                                0949 04685000
         XC    0(4,@07),ALLONES                                    0949 04686000
*            END;                                          /*@YL026UD*/ 04687000
*                                                                  0950 04688000
*        /************************************************************/ 04689000
*        /*                                                  @YL026UD*/ 04690000
*        /*  BUILD THE VSAM CATALOG PARAMETER LISTS          @YL026UD*/ 04691000
*        /*  TO 'DEFINE' THE CONVERTED CATALOG ENTRY         @YL026UD*/ 04692000
*        /*                                                  @YL026UD*/ 04693000
*        /*  PARAMETER LISTS REQUIRED ARE -                  @YL026UD*/ 04694000
*        /*  (1) CPL - CATALOG PARAMETER LIST                @YL026UD*/ 04695000
*        /*            (TO IDENTIFY THE 'DEFINE' REQUEST     @YL026UD*/ 04696000
*        /*            AND THE RECEIVING VSAM CATALOG)       @YL026UD*/ 04697000
*        /*  (2) FVT - FIELD VECTOR TABLE                    @YL026UD*/ 04698000
*        /*            (TO IDENTIFY THE CONVERTED ENTRY)     @YL026UD*/ 04699000
*        /*  (3) FPL - FIELD PARAMETER LISTS                 @YL026UD*/ 04700000
*        /*            (FOR DEVICE TYPE AND FILE SEQUENCE    @YL026UD*/ 04701000
*        /*            INFORMATION)                          @YL026UD*/ 04702000
*        /*                                                  @YL026UD*/ 04703000
*        /************************************************************/ 04704000
*                                                                  0951 04705000
*        CALL DEFNLSTS;                                    /*@YL026UD*/ 04706000
*                                                                  0951 04707000
@RF00947 BAL   @14,DEFNLSTS                                        0951 04708000
*        /************************************************************/ 04709000
*        /*                                                  @YL026UD*/ 04710000
*        /*  ISSUE 'UCATLG' MACRO -                          @YL026UD*/ 04711000
*        /*  TO DEFINE THE NONVSAM, ALIAS, OR GDG BASE       @YL026UD*/ 04712000
*        /*  ENTRY TO THE PROPER VSAM CATALOG                @YL026UD*/ 04713000
*        /*                                                  @YL026UD*/ 04714000
*        /************************************************************/ 04715000
*                                                                  0952 04716000
*        CALL IDCSACA0(GDTTBL,CATPLPTR);                   /*@YL026UD*/ 04717000
*                                                                  0952 04718000
         L     @15,@PC00001                                        0952 04719000
         ST    @15,@AL00001                                        0952 04720000
         LA    @14,CATPLPTR                                        0952 04721000
         ST    @14,@AL00001+4                                      0952 04722000
         L     @15,GDTCAT(,@15)                                    0952 04723000
         LA    @01,@AL00001                                        0952 04724000
         BALR  @14,@15                                             0952 04725000
*        RESPECIFY RTNREG RSTD;                                    0953 04726000
*        TESTRC = RTNREG;                                          0954 04727000
         LR    TESTRC,RTNREG                                       0954 04728000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 04729000
*                                                                  0955 04730000
*        IF TESTRC = 0                                             0956 04731000
*          THEN                                                    0956 04732000
         SLR   @15,@15                                             0956 04733000
         CR    TESTRC,@15                                          0956 04734000
         BNE   @RF00956                                            0956 04735000
*            DO;                                           /*@YL026UD*/ 04736000
*              /******************************************************/ 04737000
*              /*                                            @YL026UD*/ 04738000
*              /*  VSAM CATALOG RETURN CODE IS ZERO -        @YL026UD*/ 04739000
*              /*  SYSCTLG ENTRY SUCCESSFULLY CONVERTED      @YL026UD*/ 04740000
*              /*  TO VSAM CATALOG ENTRY                     @YL026UD*/ 04741000
*              /*                                            @YL026UD*/ 04742000
*              /*  IF 'LIST' OPTION SPECIFIED OR DEFAULTED - @YL026UD*/ 04743000
*              /*  PRINT NAME OF ENTRY SUCCESSFULLY CONVERTED        */ 04744000
*              /*                                            @YL026UD*/ 04745000
*              /******************************************************/ 04746000
*                                                                  0958 04747000
*              IF ADDR(LIST) ^= NULLPTR                            0958 04748000
*                THEN                                              0958 04749000
         L     @08,@PC00001+4                                      0958 04750000
         C     @15,FDTPTR+36(,@08)                                 0958 04751000
         BE    @RF00958                                            0958 04752000
*                  DO;                                     /*@YL026UD*/ 04753000
*                    /************************************************/ 04754000
*                    /*                                      @YL026UD*/ 04755000
*                    /*  'LIST' OPTION IS SPECIFIED -        @YL026UD*/ 04756000
*                    /*  PRINT THE NAME OF ENTRY CONVERTED   @YL026UD*/ 04757000
*                    /*                                      @YL026UD*/ 04758000
*                    /************************************************/ 04759000
*                                                                  0960 04760000
*                    DARGSMOD = CNVTMSG;                   /*@YL026UD*/ 04761000
         L     @08,DDSTRU                                          0960 04762000
         MVC   DARGSMOD(3,@08),@CC00831                            0960 04763000
*                    DARGSENT = CNVTMSG#;                  /*@YL026UD*/ 04764000
*                                                                  0961 04765000
         MVI   DARGSENT(@08),X'0A'                                 0961 04766000
*                    DARGDBP = ADDR(DSNAME);               /*@YL026UD*/ 04767000
         LA    @05,DSNAME                                          0962 04768000
         ST    @05,DARGDBP(,@08)                                   0962 04769000
*                    DARGILP = LENGTH(DSNAME);             /*@YL026UD*/ 04770000
*                                                                  0963 04771000
         MVC   DARGILP(2,@08),@CH00583                             0963 04772000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU); /*@YL026UD*/ 04773000
*                                                                  0964 04774000
         L     @08,@PC00001                                        0964 04775000
         ST    @08,@AL00001                                        0964 04776000
         LA    @05,@CF00113                                        0964 04777000
         ST    @05,@AL00001+4                                      0964 04778000
         LA    @05,DDSTRU                                          0964 04779000
         ST    @05,@AL00001+8                                      0964 04780000
         MVI   @AL00001+8,X'80'                                    0964 04781000
         L     @15,GDTPRT(,@08)                                    0964 04782000
         LA    @01,@AL00001                                        0964 04783000
         BALR  @14,@15                                             0964 04784000
*                  END;                                    /*@YL026UD*/ 04785000
*                                                                  0965 04786000
*              /******************************************************/ 04787000
*              /*                                            @YL026UD*/ 04788000
*              /*  INCREMENT COUNT OF ENTRIES                @YL026UD*/ 04789000
*              /*  SUCCESSFULLY CONVERTED                    @YL026UD*/ 04790000
*              /*                                            @YL026UD*/ 04791000
*              /******************************************************/ 04792000
*                                                                  0966 04793000
*              CNVTCNT = CNVTCNT + 1;                      /*@YL026UD*/ 04794000
*                                                                  0966 04795000
@RF00958 LA    @08,1                                               0966 04796000
         AL    @08,CNVTCNT                                         0966 04797000
         ST    @08,CNVTCNT                                         0966 04798000
*              RETURN;                                     /*@YL026UD*/ 04799000
*                                                                  0967 04800000
@EL00014 DS    0H                                                  0967 04801000
@EF00014 DS    0H                                                  0967 04802000
@ER00014 LM    @14,@06,@SA00014                                    0967 04803000
         LM    @08,@12,@SA00014+36                                 0967 04804000
         BR    @14                                                 0967 04805000
*            END;                                          /*@YL026UD*/ 04806000
*                                                                  0968 04807000
*        /************************************************************/ 04808000
*        /*                                                  @VS04383*/ 04809000
*        /* VSAM CATALOG IS FULL, CALL ERRPROC TO INVOKE UERROR TO   */ 04810000
*        /* PRINT ERROR MESSAGE, AND INDICATE THAT THE ENTRY @Y30SSMK*/ 04811000
*        /* WAS NOT SUCCESSFULLY CONVERTED AND END.          @Y30SSMK*/ 04812000
*        /*                                                  @VS04383*/ 04813000
*        /************************************************************/ 04814000
*        IF TESTRC = CATFULL                                       0969 04815000
*          THEN                                                    0969 04816000
@RF00956 C     TESTRC,@CF00894                                     0969 04817000
         BNE   @RF00969                                            0969 04818000
*                DO;                                       /*@VS04383*/ 04819000
*                                                                  0970 04820000
*                ERRORTYP = ERRORDE;                       /*@Y30SSMK*/ 04821000
         LA    ERRORTYP,1                                          0971 04822000
*                CALL ERRPROC;                             /*@Y30SSMK*/ 04823000
*                                                                  0972 04824000
         BAL   @14,ERRPROC                                         0972 04825000
*                DARGSMOD = CNVTMSG;                               0973 04826000
         L     @08,DDSTRU                                          0973 04827000
         MVC   DARGSMOD(3,@08),@CC00831                            0973 04828000
*                DARGSENT = NCVTMSG#;                              0974 04829000
         MVI   DARGSENT(@08),X'09'                                 0974 04830000
*                DARGDBP = ADDR(DSNAME);                           0975 04831000
         LA    @05,DSNAME                                          0975 04832000
         ST    @05,DARGDBP(,@08)                                   0975 04833000
*                DARGILP = LENGTH(DSNAME);                         0976 04834000
*                                                                  0976 04835000
         MVC   DARGILP(2,@08),@CH00583                             0976 04836000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             0977 04837000
*                                                                  0977 04838000
         L     @08,@PC00001                                        0977 04839000
         ST    @08,@AL00001                                        0977 04840000
         LA    @05,@CF00113                                        0977 04841000
         ST    @05,@AL00001+4                                      0977 04842000
         LA    @05,DDSTRU                                          0977 04843000
         ST    @05,@AL00001+8                                      0977 04844000
         MVI   @AL00001+8,X'80'                                    0977 04845000
         L     @15,GDTPRT(,@08)                                    0977 04846000
         LA    @01,@AL00001                                        0977 04847000
         BALR  @14,@15                                             0977 04848000
*                LASTCOND = LASTCC12;                      /*@VS04383*/ 04849000
         L     @08,@PC00001+8                                      0978 04850000
         MVC   LASTCOND(2,@08),@CH00037                            0978 04851000
*                RETURN;                                           0979 04852000
*                                                                  0979 04853000
         B     @EL00014                                            0979 04854000
*                END;                                      /*@VS04383*/ 04855000
*                                                                  0980 04856000
*        /************************************************************/ 04857000
*        /*                                                  @YL026UD*/ 04858000
*        /*  VSAM CATALOG RETURN CODE IS NOT EQUAL TO ZERO - @YL026UD*/ 04859000
*        /*  IF NOT DEFINING A NONVSAM ENTRY OR IF THE VSAM  @YL026UD*/ 04860000
*        /*  RETURN CODE DOES NOT INDICATE A DUPLICATE ENTRY @YL026UD*/ 04861000
*        /*  THEN CALL ERRPROC TO INVOKE UERROR TO           @Y30SSMK*/ 04862000
*        /*  PRINT THE ERROR MESSAGE AND INDICATE            @Y30SSMK*/ 04863000
*        /*  THAT THE ENTRY WAS NOT SUCCESSFULLY CONVERTED   @YL026UD*/ 04864000
*        /*                                                  @YL026UD*/ 04865000
*        /************************************************************/ 04866000
*                                                                  0981 04867000
*        IF CVPEFLAG = ON | ALIASFLG = ON | GDGFLAG = ON           0981 04868000
*         | TESTRC ^= DUPLCODE                                     0981 04869000
*          THEN                                                    0981 04870000
@RF00969 TM    CVPEFLAG,B'10000000'                                0981 04871000
         BO    @RT00981                                            0981 04872000
         TM    ALIASFLG,B'10000000'                                0981 04873000
         BO    @RT00981                                            0981 04874000
         TM    GDGFLAG,B'10000000'                                 0981 04875000
         BO    @RT00981                                            0981 04876000
         C     TESTRC,@CF00175                                     0981 04877000
         BE    @RF00981                                            0981 04878000
@RT00981 DS    0H                                                  0982 04879000
*            DO;                                           /*@YL026UD*/ 04880000
*                                                                  0982 04881000
*              ERRORTYP = ERRORDE;                         /*@Y30SSMK*/ 04882000
         LA    ERRORTYP,1                                          0983 04883000
*              CALL ERRPROC;                               /*@Y30SSMK*/ 04884000
*                                                                  0984 04885000
         BAL   @14,ERRPROC                                         0984 04886000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 04887000
         L     @08,DDSTRU                                          0985 04888000
         MVC   DARGSMOD(3,@08),@CC00831                            0985 04889000
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/ 04890000
*                                                                  0986 04891000
         MVI   DARGSENT(@08),X'09'                                 0986 04892000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 04893000
         LA    @05,DSNAME                                          0987 04894000
         ST    @05,DARGDBP(,@08)                                   0987 04895000
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/ 04896000
*                                                                  0988 04897000
         MVC   DARGILP(2,@08),@CH00583                             0988 04898000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 04899000
*                                                                  0989 04900000
         L     @08,@PC00001                                        0989 04901000
         ST    @08,@AL00001                                        0989 04902000
         LA    @05,@CF00113                                        0989 04903000
         ST    @05,@AL00001+4                                      0989 04904000
         LA    @05,DDSTRU                                          0989 04905000
         ST    @05,@AL00001+8                                      0989 04906000
         MVI   @AL00001+8,X'80'                                    0989 04907000
         L     @15,GDTPRT(,@08)                                    0989 04908000
         LA    @01,@AL00001                                        0989 04909000
         BALR  @14,@15                                             0989 04910000
*              LASTCOND = LASTCC08;                        /*@YL026UD*/ 04911000
*                                                                  0990 04912000
         L     @08,@PC00001+8                                      0990 04913000
         MVC   LASTCOND(2,@08),@CH00175                            0990 04914000
*              RETURN;                                     /*@YL026UD*/ 04915000
         B     @EL00014                                            0991 04916000
*            END;                                          /*@YL026UD*/ 04917000
*                                                                  0992 04918000
*        /************************************************************/ 04919000
*        /*                                                  @YL026UD*/ 04920000
*        /*  DEFINE OPERATION WAS FOR A NONVSAM ENTRY AND    @YL026UD*/ 04921000
*        /*  FAILED DUE TO DUPLICATE ENTRY IN VSAM CATALOG   @YL026UD*/ 04922000
*        /*                                                  @YL026UD*/ 04923000
*        /*  THE VOLUME INFORMATION OF THE DUPLICATE ENTRY   @YL026UD*/ 04924000
*        /*  WILL BE ALTERED (UPDATED) IF IT HAS CHANGED     @YL026UD*/ 04925000
*        /*                                                  @YL026UD*/ 04926000
*        /*  DETERMINE IF THE NONVSAM ENTRY IS A             @YL026UD*/ 04927000
*        /*  'SYS1.' DATA SET ENTRY - NO ATTEMPT IS MADE TO  @YL026UD*/ 04928000
*        /*  UPDATE THE VOLUME INFORMATION OF THESE ENTRIES  @YL026UD*/ 04929000
*        /*                                                  @YL026UD*/ 04930000
*        /************************************************************/ 04931000
*                                                                  0993 04932000
*        IF DSNAME(1:5) = SYS1NAME                                 0993 04933000
*          THEN                                                    0993 04934000
@RF00981 CLC   DSNAME(5),@CC01207                                  0993 04935000
         BNE   @RF00993                                            0993 04936000
*            DO;                                           /*@YL026UD*/ 04937000
*              /******************************************************/ 04938000
*              /*                                            @YL026UD*/ 04939000
*              /*  DATA SET NAME BEGINS WITH 'SYS1.' -       @YL026UD*/ 04940000
*              /*  THE VOLUME INFORMATION IS NOT UPDATED     @YL026UD*/ 04941000
*              /*                                            @YL026UD*/ 04942000
*              /******************************************************/ 04943000
*                                                                  0995 04944000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 04945000
         L     @08,DDSTRU                                          0995 04946000
         MVC   DARGSMOD(3,@08),@CC00831                            0995 04947000
*              DARGSENT = SYS1MSG#;                        /*@YL026UD*/ 04948000
*                                                                  0996 04949000
         MVI   DARGSENT(@08),X'04'                                 0996 04950000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 04951000
*                                                                  0997 04952000
         L     @08,@PC00001                                        0997 04953000
         ST    @08,@AL00001                                        0997 04954000
         LA    @05,@CF00113                                        0997 04955000
         ST    @05,@AL00001+4                                      0997 04956000
         LA    @05,DDSTRU                                          0997 04957000
         ST    @05,@AL00001+8                                      0997 04958000
         MVI   @AL00001+8,X'80'                                    0997 04959000
         L     @15,GDTPRT(,@08)                                    0997 04960000
         LA    @01,@AL00001                                        0997 04961000
         BALR  @14,@15                                             0997 04962000
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/ 04963000
*                                                                  0998 04964000
         L     @08,DDSTRU                                          0998 04965000
         MVI   DARGSENT(@08),X'09'                                 0998 04966000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 04967000
         LA    @05,DSNAME                                          0999 04968000
         ST    @05,DARGDBP(,@08)                                   0999 04969000
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/ 04970000
*                                                                  1000 04971000
         MVC   DARGILP(2,@08),@CH00583                             1000 04972000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 04973000
*                                                                  1001 04974000
         L     @08,@PC00001                                        1001 04975000
         ST    @08,@AL00001                                        1001 04976000
         LA    @05,@CF00113                                        1001 04977000
         ST    @05,@AL00001+4                                      1001 04978000
         LA    @05,DDSTRU                                          1001 04979000
         ST    @05,@AL00001+8                                      1001 04980000
         MVI   @AL00001+8,X'80'                                    1001 04981000
         L     @15,GDTPRT(,@08)                                    1001 04982000
         LA    @01,@AL00001                                        1001 04983000
         BALR  @14,@15                                             1001 04984000
*              LASTCOND = LASTCC04;                        /*@YL026UD*/ 04985000
*                                                                  1002 04986000
         L     @08,@PC00001+8                                      1002 04987000
         MVC   LASTCOND(2,@08),@CH00042                            1002 04988000
*              RETURN;                                     /*@YL026UD*/ 04989000
*                                                                  1003 04990000
         B     @EL00014                                            1003 04991000
*            END;                                          /*@YL026UD*/ 04992000
*                                                                  1004 04993000
*        OLDERID2 = NEWERID2;                                      1005 04994000
@RF00993 L     @07,@PC00001                                        1005 04995000
         L     @07,GDTTR2(,@07)                                    1005 04996000
         MVC   @TS00001(95),NEWERID2(@07)                          1005 04997000
         MVC   OLDERID2(95,@07),@TS00001                           1005 04998000
*        NEWID2 = 'CCLT';                                  /*@YL026UD*/ 04999000
*                                                                  1006 05000000
         MVC   NEWID2(4,@07),@CC01237                              1006 05001000
*        /************************************************************/ 05002000
*        /*                                                  @YL026UD*/ 05003000
*        /*  LOCATE THE DUPLICATE ENTRY IN THE VSAM CATALOG -        */ 05004000
*        /*  TO DETERMINE THE ENTRY TYPE AND OBTAIN THE      @YL026UD*/ 05005000
*        /*  VOLUME INFORMATION OF THE ENTRY                 @YL026UD*/ 05006000
*        /*                                                  @YL026UD*/ 05007000
*        /*  BUILD THE VSAM CATALOG PARAMETER LISTS          @YL026UD*/ 05008000
*        /*  TO 'LOCATE' THE DUPLICATE CATALOG ENTRY         @YL026UD*/ 05009000
*        /*                                                  @YL026UD*/ 05010000
*        /*  THE PARAMETER LISTS REQUIRED ARE -              @YL026UD*/ 05011000
*        /*  (1) CPL - CATALOG PARAMETER LIST                @YL026UD*/ 05012000
*        /*            (TO IDENTIFY THE 'LOCATE' REQUEST,    @YL026UD*/ 05013000
*        /*            THE DUPLICATE ENTRY NAME,             @YL026UD*/ 05014000
*        /*            AND THE RECEIVING VSAM CATALOG)       @YL026UD*/ 05015000
*        /*  (2) FPL - FIELD PARAMETER LISTS                 @YL026UD*/ 05016000
*        /*            (TO REQUEST THAT ENTRY TYPE AND       @YL026UD*/ 05017000
*        /*            ENTRY VOLUME INFO BE RETURNED)        @YL026UD*/ 05018000
*        /*                                                  @YL026UD*/ 05019000
*        /************************************************************/ 05020000
*                                                                  1007 05021000
*        CALL LOCTLSTS;                                    /*@YL026UD*/ 05022000
*                                                                  1007 05023000
         BAL   @14,LOCTLSTS                                        1007 05024000
*        /************************************************************/ 05025000
*        /*                                                  @YL026UD*/ 05026000
*        /*  ISSUE 'UCATLG' MACRO -                          @YL026UD*/ 05027000
*        /*  TO LOCATE THE DUPLICATE ENTRY IN VSAM CATALOG   @YL026UD*/ 05028000
*        /*                                                  @YL026UD*/ 05029000
*        /*  LOOP PERMITS REISSUANCE OF LOCATE WHEN INITIAL  @YL026UD*/ 05030000
*        /*  INVOCATION SPECIFIES INSUFFICIENT WORKAREA      @YL026UD*/ 05031000
*        /*  (IF INSUFFICIENT WORKAREA, A 'UFSPACE' MACRO    @YL026UD*/ 05032000
*        /*  IF ISSUED TO FREE THE EXISTING WORKAREA, AND    @YL026UD*/ 05033000
*        /*  A 'UGPOOL' MACRO IS ISSUED TO ACQUIRE THE       @YL026UD*/ 05034000
*        /*  LARGER WORKAREA REQUIRED.  THE LARGER REQUIRED  @YL026UD*/ 05035000
*        /*  SIZE IS RETURNED FROM VSAM CATALOG MANAGEMENT   @YL026UD*/ 05036000
*        /*  IN THE EXISTING WORKAREA)                       @YL026UD*/ 05037000
*        /*                                                  @YL026UD*/ 05038000
*        /************************************************************/ 05039000
*                                                                  1008 05040000
*        LOCATFLG = ON;                                    /*@YL026UD*/ 05041000
*                                                                  1008 05042000
         OI    LOCATFLG,B'10000000'                                1008 05043000
*LOCATE: DO INDEX = 1 TO 2 WHILE(LOCATFLG = ON);           /*@YL026UD*/ 05044000
*                                                                  1009 05045000
LOCATE   LA    INDEX,1                                             1009 05046000
@DL01009 TM    LOCATFLG,B'10000000'                                1009 05047000
         BNO   @DC01009                                            1009 05048000
*          CTGWKA = WKAPTR;                                /*@YL026UD*/ 05049000
*                                                                  1010 05050000
         L     @15,WKAPTR                                          1010 05051000
         ST    @15,CTGWKA(,CTGPLPTR)                               1010 05052000
*          WKALEN = WKASIZE;                               /*@YL026UD*/ 05053000
*                                                                  1011 05054000
         L     @14,WKASIZE                                         1011 05055000
         STH   @14,WKALEN(,@15)                                    1011 05056000
*          CALL IDCSACA0(GDTTBL,CATPLPTR);                 /*@YL026UD*/ 05057000
*                                                                  1012 05058000
         L     @15,@PC00001                                        1012 05059000
         ST    @15,@AL00001                                        1012 05060000
         LA    @14,CATPLPTR                                        1012 05061000
         ST    @14,@AL00001+4                                      1012 05062000
         L     @15,GDTCAT(,@15)                                    1012 05063000
         LA    @01,@AL00001                                        1012 05064000
         BALR  @14,@15                                             1012 05065000
*          RESPECIFY RTNREG RSTD;                                  1013 05066000
*          TESTRC = RTNREG;                                        1014 05067000
         LR    TESTRC,RTNREG                                       1014 05068000
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UD*/ 05069000
*                                                                  1015 05070000
*          IF TESTRC ^= 0                                          1016 05071000
*            THEN                                                  1016 05072000
         LTR   TESTRC,TESTRC                                       1016 05073000
         BZ    @RF01016                                            1016 05074000
*              DO;                                         /*@YL026UD*/ 05075000
*                /****************************************************/ 05076000
*                /*                                          @YL026UD*/ 05077000
*                /*  VSAM CATALOG RETURN CODE IS NOT ZERO -  @YL026UD*/ 05078000
*                /*  IF RETURN CODE SPECIFIES INSUFFICIENT   @YL026UD*/ 05079000
*                /*  WORKAREA, INCREASE THE WORKAREA AND     @YL026UD*/ 05080000
*                /*  REISSUE THE 'LOCATE' REQUEST            @YL026UD*/ 05081000
*                /*                                          @YL026UD*/ 05082000
*                /****************************************************/ 05083000
*                                                                  1018 05084000
*                IF TESTRC = WKASCODE & INDEX = 1                  1018 05085000
*                  THEN                                            1018 05086000
         C     TESTRC,@CF01227                                     1018 05087000
         BNE   @RF01018                                            1018 05088000
         C     INDEX,@CF00215                                      1018 05089000
         BNE   @RF01018                                            1018 05090000
*                    DO;                                   /*@YL026UD*/ 05091000
*                      WKASIZE = WKAREQD;                  /*@YL026UD*/ 05092000
*                                                                  1020 05093000
         L     @01,WKAPTR                                          1020 05094000
         LH    @15,WKAREQD(,@01)                                   1020 05095000
         ST    @15,WKASIZE                                         1020 05096000
*                      CALL IDCSAFS0(GDTTBL,WKAPTR);       /*@YL026UD*/ 05097000
*                                                                  1021 05098000
         L     @15,@PC00001                                        1021 05099000
         ST    @15,@AL00001                                        1021 05100000
         LA    @14,WKAPTR                                          1021 05101000
         ST    @14,@AL00001+4                                      1021 05102000
         L     @15,GDTFSP(,@15)                                    1021 05103000
         LA    @01,@AL00001                                        1021 05104000
         BALR  @14,@15                                             1021 05105000
*                      CALL IDCSAGP0(GDTTBL,WKASIZE,WKAPTR,        1022 05106000
*                             POOLID,SETZERO);             /*@YL026UD*/ 05107000
*                                                                  1022 05108000
         L     @15,@PC00001                                        1022 05109000
         ST    @15,@AL00001                                        1022 05110000
         LA    @14,WKASIZE                                         1022 05111000
         ST    @14,@AL00001+4                                      1022 05112000
         LA    @14,WKAPTR                                          1022 05113000
         ST    @14,@AL00001+8                                      1022 05114000
         LA    @14,@CC00862                                        1022 05115000
         ST    @14,@AL00001+12                                     1022 05116000
         LA    @14,SETZERO                                         1022 05117000
         ST    @14,@AL00001+16                                     1022 05118000
         MVI   @AL00001+16,X'80'                                   1022 05119000
         L     @15,GDTGPL(,@15)                                    1022 05120000
         LA    @01,@AL00001                                        1022 05121000
         BALR  @14,@15                                             1022 05122000
*                      RESPECIFY RTNREG RSTD;                      1023 05123000
*                      TESTRC = RTNREG;                            1024 05124000
         LR    TESTRC,RTNREG                                       1024 05125000
*                      RESPECIFY RTNREG UNRSTD;            /*@YL026UD*/ 05126000
*                                                                  1025 05127000
*                      IF TESTRC ^= 0                              1026 05128000
*                        THEN                                      1026 05129000
         LTR   TESTRC,TESTRC                                       1026 05130000
         BZ    @RF01026                                            1026 05131000
*                          TESTRC = WKASCODE;              /*@YL026UD*/ 05132000
         LA    TESTRC,40                                           1027 05133000
*                    END;                                  /*@YL026UD*/ 05134000
*                                                                  1028 05135000
@RF01026 DS    0H                                                  1029 05136000
*                /****************************************************/ 05137000
*                /*                                          @YL026UD*/ 05138000
*                /*  VSAM CATALOG RETURN CODE IS NOT ZERO -  @YL026UD*/ 05139000
*                /*  CALL ERRPROC TO INVOKE UERROR TO        @Y30SSMK*/ 05140000
*                /*  PRINT THE ERROR MESSAGE, AND INDICATE THAT      */ 05141000
*                /*  THE ENTRY WAS NOT SUCESSFULLY CONVERTED.        */ 05142000
*                /*                                          @YL026UD*/ 05143000
*                /*  NOTE: ONLY ONE ATTEMPT IS MADE TO       @YL026UD*/ 05144000
*                /*  SATISFY THE 'INSUFFICIENT WORKAREA'     @YL026UD*/ 05145000
*                /*  RETURN CODE BY SUPPLYING THE 'REQUIRED' @YL026UD*/ 05146000
*                /*  WORKAREA TO VSAM CATALOG MANAGEMENT     @YL026UD*/ 05147000
*                /*                                          @YL026UD*/ 05148000
*                /****************************************************/ 05149000
*                                                                  1029 05150000
*                IF TESTRC ^= 0                                    1029 05151000
*                  THEN                                            1029 05152000
@RF01018 LTR   TESTRC,TESTRC                                       1029 05153000
         BZ    @RF01029                                            1029 05154000
*                    DO;                                   /*@YL026UD*/ 05155000
*                                                                  1030 05156000
*                      ERRORTYP = ERRORLC;                 /*@Y30SSMK*/ 05157000
         LA    ERRORTYP,2                                          1031 05158000
*                      CALL ERRPROC;                       /*@Y30SSMK*/ 05159000
*                                                                  1032 05160000
         BAL   @14,ERRPROC                                         1032 05161000
*                      DARGSMOD = CNVTMSG;                 /*@YL026UD*/ 05162000
         L     @08,DDSTRU                                          1033 05163000
         MVC   DARGSMOD(3,@08),@CC00831                            1033 05164000
*                      DARGSENT = NCVTMSG#;                /*@YL026UD*/ 05165000
*                                                                  1034 05166000
         MVI   DARGSENT(@08),X'09'                                 1034 05167000
*                      DARGDBP = ADDR(DSNAME);             /*@YL026UD*/ 05168000
         LA    @05,DSNAME                                          1035 05169000
         ST    @05,DARGDBP(,@08)                                   1035 05170000
*                      DARGILP = LENGTH(DSNAME);           /*@YL026UD*/ 05171000
*                                                                  1036 05172000
         MVC   DARGILP(2,@08),@CH00583                             1036 05173000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       1037 05174000
         L     @08,@PC00001                                        1037 05175000
         ST    @08,@AL00001                                        1037 05176000
         LA    @05,@CF00113                                        1037 05177000
         ST    @05,@AL00001+4                                      1037 05178000
         LA    @05,DDSTRU                                          1037 05179000
         ST    @05,@AL00001+8                                      1037 05180000
         MVI   @AL00001+8,X'80'                                    1037 05181000
         L     @15,GDTPRT(,@08)                                    1037 05182000
         LA    @01,@AL00001                                        1037 05183000
         BALR  @14,@15                                             1037 05184000
*                                                          /*@YL026UD*/ 05185000
*                                                                  1038 05186000
*                      LASTCOND = LASTCC08;                /*@YL026UD*/ 05187000
*                                                                  1038 05188000
         L     @08,@PC00001+8                                      1038 05189000
         MVC   LASTCOND(2,@08),@CH00175                            1038 05190000
*                      RETURN;                             /*@YL026UD*/ 05191000
         B     @EL00014                                            1039 05192000
*                    END;                                  /*@YL026UD*/ 05193000
*                                                                  1040 05194000
*              END;                                        /*@YL026UD*/ 05195000
*            ELSE                                                  1042 05196000
*              LOCATFLG = OFF;                             /*@YL026UD*/ 05197000
*                                                                  1042 05198000
         B     @RC01016                                            1042 05199000
@RF01016 NI    LOCATFLG,B'01111111'                                1042 05200000
*        END LOCATE;                                       /*@YL026UD*/ 05201000
*                                                                  1043 05202000
@RC01016 AL    INDEX,@CF00215                                      1043 05203000
         C     INDEX,@CF00149                                      1043 05204000
         BNH   @DL01009                                            1043 05205000
@DC01009 DS    0H                                                  1044 05206000
*        /************************************************************/ 05207000
*        /*                                                  @YL026UD*/ 05208000
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/ 05209000
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/ 05210000
*        /*  THE ENTRY TYPE, AND CATALOG VOLUME INFORMATION  @YL026UD*/ 05211000
*        /*  RETURNED BY THE VSAM 'LOCATE' REQUEST           @YL026UD*/ 05212000
*        /*                                                  @YL026UD*/ 05213000
*        /************************************************************/ 05214000
*                                                                  1044 05215000
*                                                                  1044 05216000
*        IF GDTDBG = NULLPTR                                       1044 05217000
*          THEN;                                                   1044 05218000
         L     @05,@PC00001                                        1044 05219000
         L     @05,GDTDBG(,@05)                                    1044 05220000
         LTR   @05,@05                                             1044 05221000
         BZ    @RT01044                                            1044 05222000
*          ELSE                                                    1046 05223000
*            DO;                                                   1046 05224000
*              DMPINDEX = ADDR(DLISTVIL);                          1047 05225000
*                                                                  1047 05226000
         LA    DMPINDEX,DLISTVIL                                   1047 05227000
*              DMPITMNM = 'ENTYPPTR';                              1048 05228000
         MVC   DMPITMNM(8,DMPINDEX),@CC01241                       1048 05229000
*              DMPITMPT = ADDR(ENTYPFPL->CTGFLPT(1));              1049 05230000
         L     @05,ENTYPFPL                                        1049 05231000
         LA    @03,CTGFLPT(,@05)                                   1049 05232000
         ST    @03,DMPITMPT(,DMPINDEX)                             1049 05233000
*              DMPITMLN = 4;                                       1050 05234000
         LA    @03,4                                               1050 05235000
         STH   @03,DMPITMLN(,DMPINDEX)                             1050 05236000
*              DMPITMTP = 'H';                                     1051 05237000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1051 05238000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1052 05239000
*                                                                  1052 05240000
         LA    @15,16                                              1052 05241000
         ALR   DMPINDEX,@15                                        1052 05242000
*              DMPITMNM = 'ENTYPLST';                              1053 05243000
         MVC   DMPITMNM(8,DMPINDEX),@CC01242                       1053 05244000
*              DMPITMPT = ADDR(ENTYPFPL->CTGFLPT(1)->LOCINFO);     1054 05245000
         L     @14,CTGFLPT(,@05)                                   1054 05246000
         ST    @14,DMPITMPT(,DMPINDEX)                             1054 05247000
*              DMPITMLN = MIN(256,ENTYPFPL->CTGFLNG(1));           1055 05248000
         LA    @14,256                                             1055 05249000
         L     @05,CTGFLNG(,@05)                                   1055 05250000
         CR    @05,@14                                             1055 05251000
         BNH   *+6                                                      05252000
         LR    @05,@14                                             1055 05253000
         STH   @05,DMPITMLN(,DMPINDEX)                             1055 05254000
*              DMPITMTP = 'H';                                     1056 05255000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1056 05256000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1057 05257000
*                                                                  1057 05258000
         ALR   DMPINDEX,@15                                        1057 05259000
*              DMPITMNM = 'CATVLPTR';                              1058 05260000
         MVC   DMPITMNM(8,DMPINDEX),@CC01243                       1058 05261000
*              DMPITMPT = ADDR(CATVLFPL->CTGFLPT(1));              1059 05262000
         L     @05,CATVLFPL                                        1059 05263000
         LA    @01,CTGFLPT(,@05)                                   1059 05264000
         ST    @01,DMPITMPT(,DMPINDEX)                             1059 05265000
*              DMPITMLN = 4;                                       1060 05266000
         STH   @03,DMPITMLN(,DMPINDEX)                             1060 05267000
*              DMPITMTP = 'H';                                     1061 05268000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1061 05269000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1062 05270000
*                                                                  1062 05271000
         ALR   DMPINDEX,@15                                        1062 05272000
*              DMPITMNM = 'CATVLLST';                              1063 05273000
         MVC   DMPITMNM(8,DMPINDEX),@CC01244                       1063 05274000
*              DMPITMPT = ADDR(CATVLFPL->CTGFLPT(1)->LOCINFO);     1064 05275000
         L     @03,CTGFLPT(,@05)                                   1064 05276000
         ST    @03,DMPITMPT(,DMPINDEX)                             1064 05277000
*              DMPITMLN = MIN(256,CATVLFPL->CTGFLNG(1));           1065 05278000
         L     @05,CTGFLNG(,@05)                                   1065 05279000
         CR    @05,@14                                             1065 05280000
         BNH   *+6                                                      05281000
         LR    @05,@14                                             1065 05282000
         STH   @05,DMPITMLN(,DMPINDEX)                             1065 05283000
*              DMPITMTP = 'H';                                     1066 05284000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1066 05285000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1067 05286000
*                                                                  1067 05287000
         ALR   DMPINDEX,@15                                        1067 05288000
*              DMPTRM = DMPTRMVL;                                  1068 05289000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1068 05290000
*            END;                                                  1069 05291000
*                                                                  1069 05292000
*        /************************************************************/ 05293000
*        /*                                                  @Y30SSMK*/ 05294000
*        /*  DUMP POINT AFTER VOLUME INFORMATION IS RETURNED @Y30SSMK*/ 05295000
*        /*                                                  @Y30SSMK*/ 05296000
*        /************************************************************/ 05297000
*                                                                  1070 05298000
*        IF GDTDBG = NULLPTR                                       1070 05299000
*          THEN;                                                   1070 05300000
@RT01044 L     @05,@PC00001                                        1070 05301000
         L     @05,GDTDBG(,@05)                                    1070 05302000
         LTR   @05,@05                                             1070 05303000
         BZ    @RT01070                                            1070 05304000
*          ELSE                                                    1072 05305000
*            CALL IDCDB010(GDTTBL,'CCLV',ADDR(DLISTVIL));          1072 05306000
         L     @05,@PC00001                                        1072 05307000
         ST    @05,@AL00001                                        1072 05308000
         LA    @15,@CC01245                                        1072 05309000
         ST    @15,@AL00001+4                                      1072 05310000
         LA    @15,DLISTVIL                                        1072 05311000
         ST    @15,@AFTEMPS+24                                     1072 05312000
         LA    @15,@AFTEMPS+24                                     1072 05313000
         ST    @15,@AL00001+8                                      1072 05314000
         MVI   @AL00001+8,X'80'                                    1072 05315000
         L     @15,GDTDBG(,@05)                                    1072 05316000
         LA    @01,@AL00001                                        1072 05317000
         BALR  @14,@15                                             1072 05318000
*                                                          /*@YL026UD*/ 05319000
*                                                                  1073 05320000
*        /************************************************************/ 05321000
*        /*                                                  @YL026UD*/ 05322000
*        /*  DUPLICATE ENTRY SUCCESSFULLY LOCATED -          @YL026UD*/ 05323000
*        /*  DETERMINE ENTRY TYPE OF LOCATED ENTRY           @YL026UD*/ 05324000
*        /*  (FROM INFORMATION RETURNED BY LOCATE            @YL026UD*/ 05325000
*        /*  IN THE ENTRY TYPE FPL)                          @YL026UD*/ 05326000
*        /*                                                  @YL026UD*/ 05327000
*        /************************************************************/ 05328000
*                                                                  1073 05329000
*        IF ENTYPFPL -> CTGFLPT(1) -> ENTYPE ^= CTGTALIN           1073 05330000
*          THEN                                                    1073 05331000
@RT01070 L     @05,ENTYPFPL                                        1073 05332000
         L     @05,CTGFLPT(,@05)                                   1073 05333000
         CLI   ENTYPE(@05),C'A'                                    1073 05334000
         BE    @RF01073                                            1073 05335000
*            DO;                                           /*@YL026UD*/ 05336000
*              /******************************************************/ 05337000
*              /*                                            @YL026UD*/ 05338000
*              /*  ENTRY LOCATED IS NOT A NONVSAM ENTRY -    @YL026UD*/ 05339000
*              /*  DUPLICATE ENTRY IS NOT CONVERTED          @YL026UD*/ 05340000
*              /*                                            @YL026UD*/ 05341000
*              /******************************************************/ 05342000
*                                                                  1075 05343000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 05344000
         L     @08,DDSTRU                                          1075 05345000
         MVC   DARGSMOD(3,@08),@CC00831                            1075 05346000
*              DARGSENT = DUPLMSG#;                        /*@YL026UD*/ 05347000
*                                                                  1076 05348000
         MVI   DARGSENT(@08),X'03'                                 1076 05349000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 05350000
*                                                                  1077 05351000
         L     @08,@PC00001                                        1077 05352000
         ST    @08,@AL00001                                        1077 05353000
         LA    @05,@CF00113                                        1077 05354000
         ST    @05,@AL00001+4                                      1077 05355000
         LA    @05,DDSTRU                                          1077 05356000
         ST    @05,@AL00001+8                                      1077 05357000
         MVI   @AL00001+8,X'80'                                    1077 05358000
         L     @15,GDTPRT(,@08)                                    1077 05359000
         LA    @01,@AL00001                                        1077 05360000
         BALR  @14,@15                                             1077 05361000
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/ 05362000
*                                                                  1078 05363000
         L     @08,DDSTRU                                          1078 05364000
         MVI   DARGSENT(@08),X'09'                                 1078 05365000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 05366000
         LA    @05,DSNAME                                          1079 05367000
         ST    @05,DARGDBP(,@08)                                   1079 05368000
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/ 05369000
*                                                                  1080 05370000
         MVC   DARGILP(2,@08),@CH00583                             1080 05371000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 05372000
*                                                                  1081 05373000
         L     @08,@PC00001                                        1081 05374000
         ST    @08,@AL00001                                        1081 05375000
         LA    @05,@CF00113                                        1081 05376000
         ST    @05,@AL00001+4                                      1081 05377000
         LA    @05,DDSTRU                                          1081 05378000
         ST    @05,@AL00001+8                                      1081 05379000
         MVI   @AL00001+8,X'80'                                    1081 05380000
         L     @15,GDTPRT(,@08)                                    1081 05381000
         LA    @01,@AL00001                                        1081 05382000
         BALR  @14,@15                                             1081 05383000
*              TRUEFLG = OFF;                              /*@YL026UD*/ 05384000
*                                                                  1082 05385000
         NI    TRUEFLG,B'01111111'                                 1082 05386000
*              LASTCOND = LASTCC08;                        /*@YL026UD*/ 05387000
*                                                                  1083 05388000
         L     @08,@PC00001+8                                      1083 05389000
         MVC   LASTCOND(2,@08),@CH00175                            1083 05390000
*              RETURN;                                     /*@YL026UD*/ 05391000
         B     @EL00014                                            1084 05392000
*            END;                                          /*@YL026UD*/ 05393000
*                                                                  1085 05394000
*        /************************************************************/ 05395000
*        /*                                                  @YL026UD*/ 05396000
*        /*  ENTRY LOCATED IS A NONVSAM ENTRY -              @YL026UD*/ 05397000
*        /*  COMPARE THE VOLUME INFORMATION OF THE CATALOGED @YL026UD*/ 05398000
*        /*  ENTRY WITH THE VOLUME INFORMATION OF THE        @YL026UD*/ 05399000
*        /*  DUPLICATE ENTRY BEING DEFINED                   @YL026UD*/ 05400000
*        /*                                                  @YL026UD*/ 05401000
*        /*  THE VOLUME INFORMATION OF THE CATALOGED ENTRY   @YL026UD*/ 05402000
*        /*  WILL BE UPDATED (IF NECESSARY) TO MATCH THAT    @YL026UD*/ 05403000
*        /*  OF THE DUPLICATE ENTRY BEING DEFINED            @YL026UD*/ 05404000
*        /*                                                  @YL026UD*/ 05405000
*        /************************************************************/ 05406000
*                                                                  1086 05407000
*        SCANFLAG = OFF;                                   /*@YL026UD*/ 05408000
*                                                                  1086 05409000
@RF01073 NI    SCANFLAG,B'01111111'                                1086 05410000
*        CATVLCNT = CATVLFPL -> CTGFLNG(1)/LENGTH(CATVLIST);       1087 05411000
*                                                                  1087 05412000
         L     @01,CATVLFPL                                        1087 05413000
         L     @00,CTGFLNG(,@01)                                   1087 05414000
         SRDA  @00,32                                              1087 05415000
         D     @00,@CF00224                                        1087 05416000
         LR    CATVLCNT,@01                                        1087 05417000
*        /************************************************************/ 05418000
*        /*                                                  @YL026UD*/ 05419000
*        /*  COMPARE THE NUMBER OF VOLUMES OVER WHICH        @YL026UD*/ 05420000
*        /*  THE DUPLICATE DATA SETS ARE DEFINED -           @YL026UD*/ 05421000
*        /*  IF UNEQUAL, THE VOLUME INFORMATION CANNOT MATCH @YL026UD*/ 05422000
*        /*                                                  @YL026UD*/ 05423000
*        /************************************************************/ 05424000
*                                                                  1088 05425000
*        IF CATVLCNT = VOLCNT                                      1088 05426000
*          THEN                                                    1088 05427000
         CH    CATVLCNT,VOLCNT                                     1088 05428000
         BNE   @RF01088                                            1088 05429000
*VOLSCAN1:   DO;                                           /*@YL026UD*/ 05430000
VOLSCAN1 DS    0H                                                  1090 05431000
*              /******************************************************/ 05432000
*              /*                                            @YL026UD*/ 05433000
*              /*  NUMBER OF VOLUMES IS EQUAL FOR THE        @YL026UD*/ 05434000
*              /*  DUPLICATE DATA SETS                       @YL026UD*/ 05435000
*              /*                                            @YL026UD*/ 05436000
*              /*  COMPARE THE VOLUME SERIAL NUMBERS FOR     @YL026UD*/ 05437000
*              /*  EACH VOLUME OVER WHICH THE DUPLICATE      @YL026UD*/ 05438000
*              /*  DATA SETS ARE DEFINED                     @YL026UD*/ 05439000
*              /*                                            @YL026UD*/ 05440000
*              /*  LOOP THROUGH EACH VOLUME SERIAL NUMBER    @YL026UD*/ 05441000
*              /*  FOR THE CATALOGED DATA SET UNTIL          @YL026UD*/ 05442000
*              /*  UNMATCHING VOLUME INFORMATION IS FOUND    @YL026UD*/ 05443000
*              /*                                            @YL026UD*/ 05444000
*              /******************************************************/ 05445000
*                                                                  1090 05446000
*              SCANFLAG = ON;                              /*@YL026UD*/ 05447000
*                                                                  1090 05448000
         OI    SCANFLAG,B'10000000'                                1090 05449000
*VOLSCAN2:     DO CATVINDX = 1 TO CATVLCNT                         1091 05450000
*                            WHILE(SCANFLAG = ON);         /*@YL026UD*/ 05451000
*                                                                  1091 05452000
VOLSCAN2 LA    CATVINDX,1                                          1091 05453000
         B     @DE01091                                            1091 05454000
@DL01091 TM    SCANFLAG,B'10000000'                                1091 05455000
         BNO   @DC01091                                            1091 05456000
*                MATCHFLG = OFF;                           /*@YL026UD*/ 05457000
*                                                                  1092 05458000
         NI    MATCHFLG,B'01111111'                                1092 05459000
*                /****************************************************/ 05460000
*                /*                                          @YL026UD*/ 05461000
*                /*  LOOP THROUGH EACH VOLUME SERIAL NUMBER  @YL026UD*/ 05462000
*                /*  FOR THE DUPLICATE DATA SET BEING        @YL026UD*/ 05463000
*                /*  CONVERTED UNTIL UNMATCHING VOLUME       @YL026UD*/ 05464000
*                /*  INFORMATION IS FOUND                    @YL026UD*/ 05465000
*                /*                                          @YL026UD*/ 05466000
*                /****************************************************/ 05467000
*VOLSCAN3:       DO VOLINDX = 1 TO VOLCNT                          1093 05468000
*                             WHILE(MATCHFLG = OFF);       /*@YL026UD*/ 05469000
*                                                                  1093 05470000
VOLSCAN3 LA    VOLINDX,1                                           1093 05471000
         B     @DE01093                                            1093 05472000
@DL01093 TM    MATCHFLG,B'10000000'                                1093 05473000
         BNZ   @DC01093                                            1093 05474000
*                  IF VOLSER(VOLINDX) = CATVLFPL ->                1094 05475000
*                           CTGFLPT(1) -> CVVOLSER(CATVINDX)       1094 05476000
*                    THEN                                          1094 05477000
         LR    @15,VOLINDX                                         1094 05478000
         SLA   @15,3                                               1094 05479000
         LR    @14,CATVINDX                                        1094 05480000
         MH    @14,@CH00224                                        1094 05481000
         L     @01,CATVLFPL                                        1094 05482000
         L     @01,CTGFLPT(,@01)                                   1094 05483000
         ST    @15,@TF00001                                        1094 05484000
         L     @15,VOLPTR                                          1094 05485000
         AL    @15,@TF00001                                        1094 05486000
         AL    @15,@CF01314                                        1094 05487000
         ST    @14,@TF00001                                        1094 05488000
         ALR   @14,@01                                             1094 05489000
         AL    @14,@CF01325                                        1094 05490000
         CLC   VOLSER-4(6,@15),CVVOLSER-6(@14)                     1094 05491000
         BNE   @RF01094                                            1094 05492000
*                      DO;                                 /*@YL026UD*/ 05493000
*                        /********************************************/ 05494000
*                        /*                                  @YL026UD*/ 05495000
*                        /*  MATCHING VOLUME NUMBER FOUND -  @YL026UD*/ 05496000
*                        /*  COMPARE DEVICE TYPE AND FILE    @YL026UD*/ 05497000
*                        /*  SEQUENCE INFORMATION FOR THE    @YL026UD*/ 05498000
*                        /*  MATCHING VOLUMES                @YL026UD*/ 05499000
*                        /*                                  @YL026UD*/ 05500000
*                        /********************************************/ 05501000
*                                                                  1096 05502000
*                        IF DEVTCODE(VOLINDX) ^=                   1096 05503000
*                                   CATVLFPL -> CTGFLPT(1) ->      1096 05504000
*                                   CVDEVTYP(CATVINDX)             1096 05505000
*                          | FILESEQ(VOLINDX) ^=                   1096 05506000
*                                   CATVLFPL -> CTGFLPT(1) ->      1096 05507000
*                                   CVFSEQ(CATVINDX)               1096 05508000
*                          THEN                                    1096 05509000
         LR    @15,VOLINDX                                         1096 05510000
         MH    @15,@CH00037                                        1096 05511000
         L     @14,DEVTPTR                                         1096 05512000
         ALR   @14,@15                                             1096 05513000
         AL    @14,@CF01314                                        1096 05514000
         LR    @15,@01                                             1096 05515000
         AL    @15,@TF00001                                        1096 05516000
         AL    @15,@CF01326                                        1096 05517000
         CLC   DEVTCODE-8(4,@14),CVDEVTYP-2(@15)                   1096 05518000
         BNE   @RT01096                                            1096 05519000
         LR    @15,VOLINDX                                         1096 05520000
         ALR   @15,@15                                             1096 05521000
         L     @14,FILEPTR                                         1096 05522000
         ALR   @14,@15                                             1096 05523000
         AL    @14,@CF01316                                        1096 05524000
         AL    @01,@TF00001                                        1096 05525000
         AL    @01,@CF01327                                        1096 05526000
         CLC   FILESEQ(2,@14),CVFSEQ-12(@01)                       1096 05527000
         BE    @RF01096                                            1096 05528000
@RT01096 DS    0H                                                  1097 05529000
*                            SCANFLAG = OFF;               /*@YL026UD*/ 05530000
*                                                                  1097 05531000
         NI    SCANFLAG,B'01111111'                                1097 05532000
*                        MATCHFLG = ON;                    /*@YL026UD*/ 05533000
@RF01096 OI    MATCHFLG,B'10000000'                                1098 05534000
*                      END;                                /*@YL026UD*/ 05535000
*                                                                  1099 05536000
*                END VOLSCAN3;                             /*@YL026UD*/ 05537000
*                                                                  1100 05538000
@RF01094 AL    VOLINDX,@CF00215                                    1100 05539000
@DE01093 CH    VOLINDX,VOLCNT                                      1100 05540000
         BNH   @DL01093                                            1100 05541000
@DC01093 DS    0H                                                  1101 05542000
*                IF MATCHFLG = OFF                                 1101 05543000
*                  THEN                                            1101 05544000
         TM    MATCHFLG,B'10000000'                                1101 05545000
         BNZ   @RF01101                                            1101 05546000
*                    SCANFLAG = OFF;                       /*@YL026UD*/ 05547000
*                                                                  1102 05548000
         NI    SCANFLAG,B'01111111'                                1102 05549000
*              END VOLSCAN2;                               /*@YL026UD*/ 05550000
*                                                                  1103 05551000
@RF01101 AL    CATVINDX,@CF00215                                   1103 05552000
@DE01091 CR    CATVINDX,CATVLCNT                                   1103 05553000
         BNH   @DL01091                                            1103 05554000
@DC01091 DS    0H                                                  1104 05555000
*            END VOLSCAN1;                                 /*@YL026UD*/ 05556000
*                                                                  1104 05557000
*        /************************************************************/ 05558000
*        /*                                                  @YL026UD*/ 05559000
*        /*  IF THE VOLUME INFORMATION OF THE CATALOGED      @YL026UD*/ 05560000
*        /*  ENTRY MATCHES THAT OF THE DUPLICATE ENTRY       @YL026UD*/ 05561000
*        /*  BEING DEFINED - NO UPDATING OF THE VOLUME       @YL026UD*/ 05562000
*        /*  INFORMATION IS REQUIRED                         @YL026UD*/ 05563000
*        /*                                                  @YL026UD*/ 05564000
*        /*  IF 'LIST' OPTION IS SPECIFIED OR DEFAULTED -    @YL026UD*/ 05565000
*        /*  PRINT THE NAME OF THE EXISTING ENTRY            @YL026UD*/ 05566000
*        /*                                                  @YL026UD*/ 05567000
*        /************************************************************/ 05568000
*                                                                  1105 05569000
*        IF SCANFLAG = ON & ADDR(LIST) ^= NULLPTR                  1105 05570000
*          THEN                                                    1105 05571000
@RF01088 TM    SCANFLAG,B'10000000'                                1105 05572000
         BNO   @RF01105                                            1105 05573000
         L     @05,@PC00001+4                                      1105 05574000
         L     @05,FDTPTR+36(,@05)                                 1105 05575000
         LTR   @05,@05                                             1105 05576000
         BZ    @RF01105                                            1105 05577000
*            DO;                                           /*@YL026UD*/ 05578000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 05579000
         L     @08,DDSTRU                                          1107 05580000
         MVC   DARGSMOD(3,@08),@CC00831                            1107 05581000
*              DARGSENT = EXSTMSG#;                        /*@YL026UD*/ 05582000
*                                                                  1108 05583000
         MVI   DARGSENT(@08),X'08'                                 1108 05584000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 05585000
         LA    @05,DSNAME                                          1109 05586000
         ST    @05,DARGDBP(,@08)                                   1109 05587000
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/ 05588000
*                                                                  1110 05589000
         MVC   DARGILP(2,@08),@CH00583                             1110 05590000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 05591000
*                                                                  1111 05592000
         L     @08,@PC00001                                        1111 05593000
         ST    @08,@AL00001                                        1111 05594000
         LA    @05,@CF00113                                        1111 05595000
         ST    @05,@AL00001+4                                      1111 05596000
         LA    @05,DDSTRU                                          1111 05597000
         ST    @05,@AL00001+8                                      1111 05598000
         MVI   @AL00001+8,X'80'                                    1111 05599000
         L     @15,GDTPRT(,@08)                                    1111 05600000
         LA    @01,@AL00001                                        1111 05601000
         BALR  @14,@15                                             1111 05602000
*              RETURN;                                     /*@YL026UD*/ 05603000
         B     @EL00014                                            1112 05604000
*            END;                                          /*@YL026UD*/ 05605000
*                                                                  1113 05606000
*        OLDERID2 = NEWERID2;                                      1114 05607000
@RF01105 L     @05,@PC00001                                        1114 05608000
         L     @05,GDTTR2(,@05)                                    1114 05609000
         MVC   @TS00001(95),NEWERID2(@05)                          1114 05610000
         MVC   OLDERID2(95,@05),@TS00001                           1114 05611000
*        NEWID2 = 'CCAT';                                  /*@YL026UD*/ 05612000
*                                                                  1115 05613000
         MVC   NEWID2(4,@05),@CC01252                              1115 05614000
*        /************************************************************/ 05615000
*        /*                                                  @YL026UD*/ 05616000
*        /*  VOLUME INFORMATION OF THE CATALOGED ENTRY       @YL026UD*/ 05617000
*        /*  DOES NOT MATCH THE VOLUME INFORMATION OF THE    @YL026UD*/ 05618000
*        /*  DUPLICATE ENTRY BEING DEFINED -                 @YL026UD*/ 05619000
*        /*  VOLUME INFORMATION OF THE CATALOGED ENTRY       @YL026UD*/ 05620000
*        /*  MUST BE UPDATED (ALTERED) TO MATCH THE          @YL026UD*/ 05621000
*        /*  DUPLICATE ENTRY BEING DEFINED                   @YL026UD*/ 05622000
*        /*                                                  @YL026UD*/ 05623000
*        /*  BUILD THE VSAM CATALOG PARAMETER LISTS          @YL026UD*/ 05624000
*        /*  TO 'ALTER' THE NONVSAM CATALOG ENTRY            @YL026UD*/ 05625000
*        /*                                                  @YL026UD*/ 05626000
*        /*  THE PARAMETER LISTS REQUIRED ARE -              @YL026UD*/ 05627000
*        /*  (1) CPL - CATALOG PARAMETER LIST                @YL026UD*/ 05628000
*        /*            (TO IDENTIFY THE 'ALTER' REQUEST      @YL026UD*/ 05629000
*        /*            AND THE RECEIVING VSAM CATALOG)       @YL026UD*/ 05630000
*        /*  (2) FVT - FIELD VECTOR TABLE                    @YL026UD*/ 05631000
*        /*            (TO IDENTIFY THE ENTRY TO BE ALTERED) @YL026UD*/ 05632000
*        /*  (3) FPL - FIELD PARAMETER LISTS                 @YL026UD*/ 05633000
*        /*            (FOR THE UPDATED DEVICE TYPE AND      @YL026UD*/ 05634000
*        /*            FILE SEQUENCE INFORMATION)            @YL026UD*/ 05635000
*        /*                                                  @YL026UD*/ 05636000
*        /************************************************************/ 05637000
*                                                                  1116 05638000
*        CALL ALTRLSTS;                                    /*@YL026UD*/ 05639000
*                                                                  1116 05640000
         BAL   @14,ALTRLSTS                                        1116 05641000
*        /************************************************************/ 05642000
*        /*                                                  @YL026UD*/ 05643000
*        /*  ISSUE 'UCATLG' MACRO -                          @YL026UD*/ 05644000
*        /*  TO ALTER THE NONVSAM ENTRY IN THE VSAM CATALOG  @YL026UD*/ 05645000
*        /*                                                  @YL026UD*/ 05646000
*        /************************************************************/ 05647000
*                                                                  1117 05648000
*        CALL IDCSACA0(GDTTBL,CATPLPTR);                   /*@YL026UD*/ 05649000
*                                                                  1117 05650000
         L     @08,@PC00001                                        1117 05651000
         ST    @08,@AL00001                                        1117 05652000
         LA    @15,CATPLPTR                                        1117 05653000
         ST    @15,@AL00001+4                                      1117 05654000
         L     @15,GDTCAT(,@08)                                    1117 05655000
         LA    @01,@AL00001                                        1117 05656000
         BALR  @14,@15                                             1117 05657000
*        RESPECIFY RTNREG RSTD;                                    1118 05658000
*        TESTRC = RTNREG;                                          1119 05659000
         LR    TESTRC,RTNREG                                       1119 05660000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/ 05661000
*                                                                  1120 05662000
*        IF TESTRC = 0                                             1121 05663000
*          THEN                                                    1121 05664000
         SLR   @08,@08                                             1121 05665000
         CR    TESTRC,@08                                          1121 05666000
         BNE   @RF01121                                            1121 05667000
*            DO;                                           /*@YL026UD*/ 05668000
*              /******************************************************/ 05669000
*              /*                                            @YL026UD*/ 05670000
*              /*  VSAM CATALOG RETURN CODE IS ZERO -        @YL026UD*/ 05671000
*              /*  NONVSAM ENTRY SUCCESSFULLY ALTERED        @YL026UD*/ 05672000
*              /*                                            @YL026UD*/ 05673000
*              /*  IF 'LIST' OPTION IS SPECIFIED OR DEFAULTED        */ 05674000
*              /*  PRINT NAME OF ENTRY SUCCESSFULLY ALTERED  @YL026UD*/ 05675000
*              /*                                            @YL026UD*/ 05676000
*              /******************************************************/ 05677000
*                                                                  1123 05678000
*              IF ADDR(LIST) ^= NULLPTR                            1123 05679000
*                THEN                                              1123 05680000
         L     @05,@PC00001+4                                      1123 05681000
         C     @08,FDTPTR+36(,@05)                                 1123 05682000
         BE    @RF01123                                            1123 05683000
*                  DO;                                     /*@YL026UD*/ 05684000
*                    DARGSMOD = CNVTMSG;                   /*@YL026UD*/ 05685000
         L     @08,DDSTRU                                          1125 05686000
         MVC   DARGSMOD(3,@08),@CC00831                            1125 05687000
*                    DARGSENT = UPDTMSG#;                  /*@YL026UD*/ 05688000
*                                                                  1126 05689000
         MVI   DARGSENT(@08),X'0C'                                 1126 05690000
*                    DARGDBP = ADDR(DSNAME);               /*@YL026UD*/ 05691000
         LA    @05,DSNAME                                          1127 05692000
         ST    @05,DARGDBP(,@08)                                   1127 05693000
*                    DARGILP = LENGTH(DSNAME);             /*@YL026UD*/ 05694000
*                                                                  1128 05695000
         MVC   DARGILP(2,@08),@CH00583                             1128 05696000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU); /*@YL026UD*/ 05697000
         L     @08,@PC00001                                        1129 05698000
         ST    @08,@AL00001                                        1129 05699000
         LA    @05,@CF00113                                        1129 05700000
         ST    @05,@AL00001+4                                      1129 05701000
         LA    @05,DDSTRU                                          1129 05702000
         ST    @05,@AL00001+8                                      1129 05703000
         MVI   @AL00001+8,X'80'                                    1129 05704000
         L     @15,GDTPRT(,@08)                                    1129 05705000
         LA    @01,@AL00001                                        1129 05706000
         BALR  @14,@15                                             1129 05707000
*                  END;                                    /*@YL026UD*/ 05708000
*                                                                  1130 05709000
*              /******************************************************/ 05710000
*              /*                                            @YL026UD*/ 05711000
*              /*  INCREMENT COUNT OF ENTRIES                @YL026UD*/ 05712000
*              /*  SUCCESSFULLY UPDATED                      @YL026UD*/ 05713000
*              /*                                            @YL026UD*/ 05714000
*              /******************************************************/ 05715000
*                                                                  1131 05716000
*              UPDTCNT = UPDTCNT + 1;                      /*@YL026UD*/ 05717000
*                                                                  1131 05718000
@RF01123 LA    @08,1                                               1131 05719000
         AL    @08,UPDTCNT                                         1131 05720000
         ST    @08,UPDTCNT                                         1131 05721000
*              RETURN;                                     /*@YL026UD*/ 05722000
         B     @EL00014                                            1132 05723000
*            END;                                          /*@YL026UD*/ 05724000
*          ELSE                                                    1134 05725000
*            DO;                                           /*@YL026UD*/ 05726000
@RF01121 DS    0H                                                  1135 05727000
*              /******************************************************/ 05728000
*              /*                                            @YL026UD*/ 05729000
*              /*  VSAM CATALOG RETURN CODE IS NOT ZERO -    @YL026UD*/ 05730000
*              /*  NONVSAM ENTRY NOT SUCCESSFULLY ALTERED    @YL026UD*/ 05731000
*              /*                                            @YL026UD*/ 05732000
*              /*  CALL ERRPROC TO INVOKE UERROR TO PRINT THE        */ 05733000
*              /*  ERROR MESSAGE, AND INDICATE THAT THE ENTRY        */ 05734000
*              /*  WAS NOT SUCCESSFULLY UPDATED.             @Y30SSMK*/ 05735000
*              /*                                            @YL026UD*/ 05736000
*              /******************************************************/ 05737000
*                                                                  1135 05738000
*              ERRORTYP = ERRORAL;                         /*@Y30SSMK*/ 05739000
         LA    ERRORTYP,3                                          1135 05740000
*              CALL ERRPROC;                               /*@Y30SSMK*/ 05741000
*                                                                  1136 05742000
         BAL   @14,ERRPROC                                         1136 05743000
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/ 05744000
         L     @08,DDSTRU                                          1137 05745000
         MVC   DARGSMOD(3,@08),@CC00831                            1137 05746000
*              DARGSENT = NUPDMSG#;                        /*@YL026UD*/ 05747000
*                                                                  1138 05748000
         MVI   DARGSENT(@08),X'0B'                                 1138 05749000
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/ 05750000
         LA    @05,DSNAME                                          1139 05751000
         ST    @05,DARGDBP(,@08)                                   1139 05752000
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/ 05753000
*                                                                  1140 05754000
         MVC   DARGILP(2,@08),@CH00583                             1140 05755000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/ 05756000
*                                                                  1141 05757000
         L     @08,@PC00001                                        1141 05758000
         ST    @08,@AL00001                                        1141 05759000
         LA    @05,@CF00113                                        1141 05760000
         ST    @05,@AL00001+4                                      1141 05761000
         LA    @05,DDSTRU                                          1141 05762000
         ST    @05,@AL00001+8                                      1141 05763000
         MVI   @AL00001+8,X'80'                                    1141 05764000
         L     @15,GDTPRT(,@08)                                    1141 05765000
         LA    @01,@AL00001                                        1141 05766000
         BALR  @14,@15                                             1141 05767000
*              LASTCOND = LASTCC08;                        /*@YL026UD*/ 05768000
*                                                                  1142 05769000
         L     @08,@PC00001+8                                      1142 05770000
         MVC   LASTCOND(2,@08),@CH00175                            1142 05771000
*              RETURN;                                     /*@YL026UD*/ 05772000
         B     @EL00014                                            1143 05773000
*            END;                                          /*@YL026UD*/ 05774000
*/********************************************************************/ 05775000
*/*                                                          @YL026UD*/ 05776000
*/*  PROCEDURE NAME - DEFNLSTS                               @YL026UD*/ 05777000
*/*                                                          @YL026UD*/ 05778000
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/ 05779000
*/*             REQUIRED TO 'DEFINE' THE CONVERTED ENTRY     @YL026UD*/ 05780000
*/*             IN THE PROPER VSAM CATALOG                   @YL026UD*/ 05781000
*/*                                                          @YL026UD*/ 05782000
*/*             THREE VSAM ENTRY TYPES CAN BE DEFINED -      @YL026UD*/ 05783000
*/*             (1) 'NONVSAM' ENTRY                          @YL026UD*/ 05784000
*/*                 (FOR SYSCTLG 'DSPE' OR 'VCBPE' ENTRY)    @YL026UD*/ 05785000
*/*             (2) 'GDG BASE' ENTRY                         @YL026UD*/ 05786000
*/*                 (FOR SYSCTLG 'GIPE' ENTRY)               @YL026UD*/ 05787000
*/*             (3) 'ALIAS' ENTRY                            @YL026UD*/ 05788000
*/*                 (FOR SYSCTLG 'AE' OR 'CVPE' ENTRY)       @YL026UD*/ 05789000
*/*                 (A 'CVPE' ENTRY IS CONVERTED INTO  AN    @YL026UD*/ 05790000
*/*                 ALIAS ENTRY IN THE VSAM MASTER CATALOG)  @YL026UD*/ 05791000
*/*                                                          @YL026UD*/ 05792000
*/*             THREE PARAMETER LISTS ARE REQUIRED -         @YL026UD*/ 05793000
*/*             (1) CPL - CATALOG PARAMETER LIST             @YL026UD*/ 05794000
*/*                 (TO IDENTIFY THE 'DEFINE' REQUEST        @YL026UD*/ 05795000
*/*                 AND THE RECEIVING VSAM CATALOG)          @YL026UD*/ 05796000
*/*             (2) FVT - FIELD VECTOR TABLE                 @YL026UD*/ 05797000
*/*                 (TO IDENTIFY THE ENTRY TO BE DEFINED     @YL026UD*/ 05798000
*/*                 AND THE TYPE OF VSAM ENTRY CREATED)      @YL026UD*/ 05799000
*/*             (3) FPL - FIELD PARAMETER LISTS              @YL026UD*/ 05800000
*/*                 (FOR THE DEVICE TYPE AND FILE SEQUENCE   @YL026UD*/ 05801000
*/*                 INFORMATION)                             @YL026UD*/ 05802000
*/*                 (THE FPLS ARE NEEDED ONLY FOR THE        @YL026UD*/ 05803000
*/*                 'NONVSAM' ENTRY TYPE)                    @YL026UD*/ 05804000
*/*                                                          @YL026UD*/ 05805000
*/*  INPUT - THE REQUIRED STORAGE AREAS FOR THE VSAM         @YL026UD*/ 05806000
*/*          CATALOG PARAMETER LISTS                         @YL026UD*/ 05807000
*/*                                                          @YL026UD*/ 05808000
*/*  OUTPUT - THE INITIALIZED VSAM CATALOG PARAMETER LISTS   @YL026UD*/ 05809000
*/*           TO 'DEFINE' THE CONVERTED ENTRY                @YL026UD*/ 05810000
*/*                                                          @YL026UD*/ 05811000
*/********************************************************************/ 05812000
*                                                                  1145 05813000
*DEFNLSTS: PROCEDURE;                                      /*@YL026UD*/ 05814000
DEFNLSTS STM   @14,@06,@SA00015                                    1145 05815000
         STM   @08,@12,@SA00015+36                                 1145 05816000
*        OLDERID2 = NEWERID2;                                      1146 05817000
         L     @05,@PC00001                                        1146 05818000
         L     @05,GDTTR2(,@05)                                    1146 05819000
         MVC   @TS00001(95),NEWERID2(@05)                          1146 05820000
         MVC   OLDERID2(95,@05),@TS00001                           1146 05821000
*        NEWID2 = 'CCDL';                                  /*@YL026UD*/ 05822000
*                                                                  1147 05823000
         MVC   NEWID2(4,@05),@CC01257                              1147 05824000
*        /************************************************************/ 05825000
*        /*                                                  @YL026UD*/ 05826000
*        /*  ZERO THE CPL/FVT/FPL PARAMETER LISTS            @YL026UD*/ 05827000
*        /*  (NECESSARY SINCE THESE ARE NOT TREATED AS       @YL026UD*/ 05828000
*        /*  READ-ONLY PARAMETER LISTS BY VSAM)              @YL026UD*/ 05829000
*        /*                                                  @YL026UD*/ 05830000
*        /************************************************************/ 05831000
*                                                                  1148 05832000
*        DO INDEX = 1 TO CATPLLEN BY 8;                    /*@YL026UD*/ 05833000
*                                                                  1148 05834000
         LA    INDEX,1                                             1148 05835000
         B     @DE01148                                            1148 05836000
@DL01148 DS    0H                                                  1149 05837000
*          CATPL(INDEX:INDEX+7) = CATZERO;                 /*@YL026UD*/ 05838000
*                                                                  1149 05839000
         L     @06,CATPLPTR                                        1149 05840000
         ALR   @06,INDEX                                           1149 05841000
         AL    @06,@CF01151                                        1149 05842000
         MVC   CATPL(8,@06),CATZERO                                1149 05843000
*        END;                                              /*@YL026UD*/ 05844000
*                                                                  1150 05845000
         AL    INDEX,@CF00175                                      1150 05846000
@DE01148 C     INDEX,CATPLLEN                                      1150 05847000
         BNH   @DL01148                                            1150 05848000
*        /************************************************************/ 05849000
*        /*                                                  @YL026UD*/ 05850000
*        /*  INITIALIZE CATALOG PARAMETER LIST (CPL)         @YL026UD*/ 05851000
*        /*                                                  @YL026UD*/ 05852000
*        /************************************************************/ 05853000
*                                                                  1151 05854000
*        CTGFUNC = CTGCMS;                                 /*@YL026UD*/ 05855000
         NI    CTGFUNC(CTGPLPTR),B'10011111'                       1151 05856000
         OI    CTGFUNC(CTGPLPTR),B'10000000'                       1151 05857000
*        CTGOPTNS = CTGDEFIN;                              /*@YL026UD*/ 05858000
         NI    CTGOPTNS(CTGPLPTR),B'00001111'                      1152 05859000
         OI    CTGOPTNS(CTGPLPTR),B'00001000'                      1152 05860000
*        CTGAM0 = ON;                                      /*@YL026UD*/ 05861000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        1153 05862000
*        CTGNAME = ON;                                     /*@YL026UD*/ 05863000
*        CTGCNAME = ON;                                    /*@YL026UD*/ 05864000
*                                                                  1155 05865000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       1155 05866000
*        /************************************************************/ 05867000
*        /*                                                  @YL026UD*/ 05868000
*        /*  IF A 'CVPE' ENTRY IS BEING PROCESSED            @YL026UD*/ 05869000
*        /*  THEN AN ALIAS ENTRY IS TO BE DEFINED            @YL026UD*/ 05870000
*        /*  IN THE VSAM MASTER CATALOG                      @YL026UD*/ 05871000
*        /*                                                  @YL026UD*/ 05872000
*        /************************************************************/ 05873000
*                                                                  1156 05874000
*        IF CVPEFLAG = ON                                          1156 05875000
*          THEN                                                    1156 05876000
         TM    CVPEFLAG,B'10000000'                                1156 05877000
         BNO   @RF01156                                            1156 05878000
*            DO;                                           /*@YL026UD*/ 05879000
*              /******************************************************/ 05880000
*              /*                                            @YL026UD*/ 05881000
*              /*  'CVPE' ENTRY BEING PROCESSED -            @YL026UD*/ 05882000
*              /*  ADDRESS THE MASTER CATALOG IN THE CPL     @YL026UD*/ 05883000
*              /*                                            @YL026UD*/ 05884000
*              /******************************************************/ 05885000
*                                                                  1158 05886000
*              IF MRCATPLN ^= 0                                    1158 05887000
*                THEN                                              1158 05888000
         L     @06,@PC00001+4                                      1158 05889000
         L     @06,FDTPTR+32(,@06)                                 1158 05890000
         CLI   MRCATPLN(@06),0                                     1158 05891000
         BE    @RF01158                                            1158 05892000
*                  CTGPSWD = ADDR(MRCATPAS);               /*@YL026UD*/ 05893000
*                                                                  1159 05894000
         LA    @06,MRCATPAS(,@06)                                  1159 05895000
         ST    @06,CTGPSWD(,CTGPLPTR)                              1159 05896000
*              CTGCAT = ADDR(MRCATVAL);                    /*@YL026UD*/ 05897000
*                                                                  1160 05898000
@RF01158 L     @06,@PC00001+4                                      1160 05899000
         L     @06,FDTPTR+32(,@06)                                 1160 05900000
         LA    @06,MRCATVAL(,@06)                                  1160 05901000
         ST    @06,CTGCAT(,CTGPLPTR)                               1160 05902000
*            END;                                          /*@YL026UD*/ 05903000
*          ELSE                                                    1162 05904000
*            DO;                                           /*@YL026UD*/ 05905000
         B     @RC01156                                            1162 05906000
@RF01156 DS    0H                                                  1163 05907000
*              /******************************************************/ 05908000
*              /*                                            @YL026UD*/ 05909000
*              /*  'CVPE' ENTRY NOT BEING PROCESSED -        @YL026UD*/ 05910000
*              /*  ADDRESS THE VSAM CATALOG SPECIFIED        @YL026UD*/ 05911000
*              /*  BY 'CATALOG' PARAMETER, STEPCAT,          @YL026UD*/ 05912000
*              /*  JOBCAT, OR MASTERCATALOG HIERARCHY        @YL026UD*/ 05913000
*              /*                                            @YL026UD*/ 05914000
*              /******************************************************/ 05915000
*                                                                  1163 05916000
*              IF CATNMPLN ^= 0                                    1163 05917000
*                THEN                                              1163 05918000
         L     @06,@PC00001+4                                      1163 05919000
         L     @06,FDTPTR+12(,@06)                                 1163 05920000
         CLI   CATNMPLN(@06),0                                     1163 05921000
         BE    @RF01163                                            1163 05922000
*                  CTGPSWD = ADDR(CATNMPAS);               /*@YL026UD*/ 05923000
*                                                                  1164 05924000
         LA    @06,CATNMPAS(,@06)                                  1164 05925000
         ST    @06,CTGPSWD(,CTGPLPTR)                              1164 05926000
*              IF ADDR(CAT) ^= 0                                   1165 05927000
*                THEN                                              1165 05928000
@RF01163 L     @06,@PC00001+4                                      1165 05929000
         L     @05,FDTPTR+8(,@06)                                  1165 05930000
         LTR   @05,@05                                             1165 05931000
         BZ    @RF01165                                            1165 05932000
*                  CTGCAT = ADDR(CATNMVAL);                /*@Y30SSMK*/ 05933000
*                                                                  1166 05934000
         L     @06,FDTPTR+12(,@06)                                 1166 05935000
         LA    @06,CATNMVAL(,@06)                                  1166 05936000
         ST    @06,CTGCAT(,CTGPLPTR)                               1166 05937000
*            END;                                          /*@YL026UD*/ 05938000
*                                                                  1167 05939000
@RF01165 DS    0H                                                  1168 05940000
*        CTGFVT = CATPLPTR + CPLLEN;                       /*@YL026UD*/ 05941000
*                                                                  1168 05942000
@RC01156 LH    @06,CPLLEN                                          1168 05943000
         AL    @06,CATPLPTR                                        1168 05944000
         ST    @06,CTGFVT(,CTGPLPTR)                               1168 05945000
*        /************************************************************/ 05946000
*        /*                                                  @YL026UD*/ 05947000
*        /*  INITIALIZE THE PROPER FVT -                     @YL026UD*/ 05948000
*        /*  FOR ALIAS, GDG BASE, OR ALIEN (NONVSAM) ENTRY   @YL026UD*/ 05949000
*        /*                                                  @YL026UD*/ 05950000
*        /************************************************************/ 05951000
*                                                                  1169 05952000
*        CTGFVENT = ADDR(DSNAME);                          /*@YL026UD*/ 05953000
*                                                                  1169 05954000
         LA    @05,DSNAME                                          1169 05955000
         ST    @05,CTGFVENT(,@06)                                  1169 05956000
*        /************************************************************/ 05957000
*        /*                                                  @YL026UD*/ 05958000
*        /*  IF 'CVPE' OR 'ALIAS' ENTRY IS BEING PROCESSED - @YL026UD*/ 05959000
*        /*  INITIALIZE 'ALIAS' FVT                          @YL026UD*/ 05960000
*        /*                                                  @YL026UD*/ 05961000
*        /************************************************************/ 05962000
*                                                                  1170 05963000
*        IF CVPEFLAG = ON | ALIASFLG = ON                          1170 05964000
*          THEN                                                    1170 05965000
         TM    CVPEFLAG,B'10000000'                                1170 05966000
         BO    @RT01170                                            1170 05967000
         TM    ALIASFLG,B'10000000'                                1170 05968000
         BNO   @RF01170                                            1170 05969000
@RT01170 DS    0H                                                  1171 05970000
*ALIASFVT:   DO;                                           /*@YL026UD*/ 05971000
*                                                                  1171 05972000
ALIASFVT DS    0H                                                  1172 05973000
*              CTGFVTYP = CTGFVANM;                        /*@YL026UD*/ 05974000
         L     @06,CTGFVT(,CTGPLPTR)                               1172 05975000
         MVI   CTGFVTYP(@06),C'X'                                  1172 05976000
*              CTGFVNAM = ADDR(TRUEDSN);                   /*@YL026UD*/ 05977000
*                                                                  1173 05978000
         LA    @05,TRUEDSN                                         1173 05979000
         ST    @05,CTGFVNAM(,@06)                                  1173 05980000
*            END ALIASFVT;                                 /*@Y30SSMK*/ 05981000
*                                                                  1174 05982000
*        /************************************************************/ 05983000
*        /*                                                  @YL026UD*/ 05984000
*        /*  IF 'GIPE' ENTRY IS BEING PROCESSED -            @YL026UD*/ 05985000
*        /*  INITIALIZE 'GDG BASE' FVT                       @YL026UD*/ 05986000
*        /*                                                  @YL026UD*/ 05987000
*        /************************************************************/ 05988000
*                                                                  1175 05989000
*        IF GDGFLAG = ON                                           1175 05990000
*          THEN                                                    1175 05991000
@RF01170 TM    GDGFLAG,B'10000000'                                 1175 05992000
         BNO   @RF01175                                            1175 05993000
*GDGFVT:     DO;                                           /*@YL026UD*/ 05994000
*                                                                  1176 05995000
GDGFVT   DS    0H                                                  1177 05996000
*              CTGFVTYP = CTGFVGBS;                        /*@YL026UD*/ 05997000
         L     @06,CTGFVT(,CTGPLPTR)                               1177 05998000
         MVI   CTGFVTYP(@06),C'B'                                  1177 05999000
*              CTGFVLMT = ADDR(GDGLIMIT);                  /*@YL026UD*/ 06000000
         LA    @05,GDGLIMIT                                        1178 06001000
         ST    @05,CTGFVLMT(,@06)                                  1178 06002000
*              CTGFVGAT = ADDR(GDGATTR);                   /*@YL026UD*/ 06003000
*                                                                  1179 06004000
         LA    @05,GDGATTR                                         1179 06005000
         ST    @05,CTGFVGAT(,@06)                                  1179 06006000
*            END GDGFVT;                                   /*@YL026UD*/ 06007000
*                                                                  1180 06008000
*        /************************************************************/ 06009000
*        /*                                                  @YL026UD*/ 06010000
*        /*  IF 'DSPE' OR 'VCBPE' ENTRY IS BEING PROCESSED - @YL026UD*/ 06011000
*        /*  INITIALIZE 'ALIEN' (NONVSAM) FVT                @YL026UD*/ 06012000
*        /*  AND INITIALIZE REQUIRED FPLS                    @YL026UD*/ 06013000
*        /*                                                  @YL026UD*/ 06014000
*        /************************************************************/ 06015000
*                                                                  1181 06016000
*        IF CVPEFLAG = OFF & ALIASFLG = OFF & GDGFLAG = OFF        1181 06017000
*          THEN                                                    1181 06018000
@RF01175 TM    CVPEFLAG,B'10000000'                                1181 06019000
         BNZ   @RF01181                                            1181 06020000
         TM    ALIASFLG,B'10000000'                                1181 06021000
         BNZ   @RF01181                                            1181 06022000
         TM    GDGFLAG,B'10000000'                                 1181 06023000
         BNZ   @RF01181                                            1181 06024000
*ALIENFVT:   DO;                                           /*@YL026UD*/ 06025000
*                                                                  1182 06026000
ALIENFVT DS    0H                                                  1183 06027000
*              CTGFVTYP = CTGFVALN;                        /*@YL026UD*/ 06028000
         L     @06,CTGFVT(,CTGPLPTR)                               1183 06029000
         MVI   CTGFVTYP(@06),C'A'                                  1183 06030000
*              CTGFVNDC = ON;                              /*@YL026UD*/ 06031000
         OI    CTGFVNDC(@06),B'00100000'                           1184 06032000
*              CTGFVVLT = ADDR(VOLLIST);                   /*@YL026UD*/ 06033000
         L     @05,VOLPTR                                          1185 06034000
         ST    @05,CTGFVVLT(,@06)                                  1185 06035000
*              CTGFVDVT = DEVTFPL;                         /*@YL026UD*/ 06036000
         L     @05,DEVTFPL                                         1186 06037000
         ST    @05,CTGFVDVT(,@06)                                  1186 06038000
*              CTGFVTTR = ADDR(DSCBTTR);                   /*@YL026UD*/ 06039000
         LA    @15,DSCBTTR                                         1187 06040000
         ST    @15,CTGFVTTR(,@06)                                  1187 06041000
*              CTGFVFSN = FSEQFPL;                         /*@YL026UD*/ 06042000
*                                                                  1188 06043000
         L     @15,FSEQFPL                                         1188 06044000
         ST    @15,CTGFVFSN(,@06)                                  1188 06045000
*              /******************************************************/ 06046000
*              /*                                            @YL026UD*/ 06047000
*              /*  INITIALIZE DEVICE TYPE FPL (DEVTFPL)      @YL026UD*/ 06048000
*              /*                                            @YL026UD*/ 06049000
*              /******************************************************/ 06050000
*                                                                  1189 06051000
*              DEVTFPL -> CTGFLDNO = 1;                    /*@YL026UD*/ 06052000
         MVI   CTGFLDNO(@05),X'01'                                 1189 06053000
*              DEVTFPL -> CTGFLDNM = ADDR(DEVTCON);        /*@YL026UD*/ 06054000
         LA    @06,@CC01212                                        1190 06055000
         ST    @06,CTGFLDNM(,@05)                                  1190 06056000
*              DEVTFPL -> CTGFLNG(1)  = VOLCNT * LENGTH(DEVTLIST); 1191 06057000
         LH    @06,VOLCNT                                          1191 06058000
         LR    @14,@06                                             1191 06059000
         MH    @14,@CH00037                                        1191 06060000
         ST    @14,CTGFLNG(,@05)                                   1191 06061000
*              DEVTFPL -> CTGFLPT(1)  = ADDR(DEVTLIST);    /*@YL026UD*/ 06062000
*                                                                  1192 06063000
         L     @14,DEVTPTR                                         1192 06064000
         ST    @14,CTGFLPT(,@05)                                   1192 06065000
*              /******************************************************/ 06066000
*              /*                                            @YL026UD*/ 06067000
*              /*  INITIALIZE DATA SET SEQUENCE NUMBER FPL (FSEQFPL) */ 06068000
*              /*                                            @YL026UD*/ 06069000
*              /******************************************************/ 06070000
*                                                                  1193 06071000
*              FSEQFPL -> CTGFLDNO = 1;                    /*@YL026UD*/ 06072000
         MVI   CTGFLDNO(@15),X'01'                                 1193 06073000
*              FSEQFPL -> CTGFLDNM = ADDR(FILECON);        /*@YL026UD*/ 06074000
         LA    @05,@CC01214                                        1194 06075000
         ST    @05,CTGFLDNM(,@15)                                  1194 06076000
*              FSEQFPL -> CTGFLNG(1)  = VOLCNT * LENGTH(FILELIST); 1195 06077000
         ALR   @06,@06                                             1195 06078000
         ST    @06,CTGFLNG(,@15)                                   1195 06079000
*              FSEQFPL -> CTGFLPT(1)  = ADDR(FILELIST);    /*@YL026UD*/ 06080000
*                                                                  1196 06081000
         L     @06,FILEPTR                                         1196 06082000
         ST    @06,CTGFLPT(,@15)                                   1196 06083000
*              /******************************************************/ 06084000
*              /*                                            @YL026UD*/ 06085000
*              /*  DIAGNOSTIC AID (TEST MODE) -              @YL026UD*/ 06086000
*              /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP     */ 06087000
*              /*  THE DEVICE TYPE LIST, VOLUME LIST, AND    @YL026UD*/ 06088000
*              /*  DATA SET SEQUENCE LIST                    @YL026UD*/ 06089000
*              /*  (REFERENCED BY THE FVT AND RESPECTIVE FPLS)       */ 06090000
*              /*                                            @YL026UD*/ 06091000
*              /******************************************************/ 06092000
*                                                                  1197 06093000
*                                                                  1197 06094000
*              IF GDTDBG = NULLPTR                                 1197 06095000
*                THEN;                                             1197 06096000
         L     @06,@PC00001                                        1197 06097000
         L     @06,GDTDBG(,@06)                                    1197 06098000
         LTR   @06,@06                                             1197 06099000
         BZ    @RT01197                                            1197 06100000
*                ELSE                                              1199 06101000
*                  DO;                                             1199 06102000
*                    DMPINDEX = ADDR(DLISTVIL);                    1200 06103000
*                                                                  1200 06104000
         LA    DMPINDEX,DLISTVIL                                   1200 06105000
*                    DMPITMNM = 'DEVTPTR';                         1201 06106000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1201 06107000
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1201 06108000
*                    DMPITMPT = ADDR(DEVTPTR);                     1202 06109000
         LA    @06,DEVTPTR                                         1202 06110000
         ST    @06,DMPITMPT(,DMPINDEX)                             1202 06111000
*                    DMPITMLN = 4;                                 1203 06112000
         LA    @06,4                                               1203 06113000
         STH   @06,DMPITMLN(,DMPINDEX)                             1203 06114000
*                    DMPITMTP = 'H';                               1204 06115000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1204 06116000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1205 06117000
*                                                                  1205 06118000
         LA    @05,16                                              1205 06119000
         ALR   DMPINDEX,@05                                        1205 06120000
*                    DMPITMNM = 'DEVTLIST';                        1206 06121000
         MVC   DMPITMNM(8,DMPINDEX),@CC01265                       1206 06122000
*                    DMPITMPT = ADDR(DEVTLIST);                    1207 06123000
         L     @03,DEVTPTR                                         1207 06124000
         ST    @03,DMPITMPT(,DMPINDEX)                             1207 06125000
*                    DMPITMLN = MIN(256,DEVTLEN);                  1208 06126000
         LA    @03,256                                             1208 06127000
         LH    @15,DEVTLEN                                         1208 06128000
         CR    @15,@03                                             1208 06129000
         BNH   *+6                                                      06130000
         LR    @15,@03                                             1208 06131000
         STH   @15,DMPITMLN(,DMPINDEX)                             1208 06132000
*                    DMPITMTP = 'H';                               1209 06133000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1209 06134000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1210 06135000
         ALR   DMPINDEX,@05                                        1210 06136000
*                    DMPITMNM = 'VOLPTR';                          1211 06137000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1211 06138000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1211 06139000
         MVC   DMPITMNM(6,DMPINDEX),@CC01266                       1211 06140000
*                    DMPITMPT = ADDR(VOLPTR);                      1212 06141000
         LA    @15,VOLPTR                                          1212 06142000
         ST    @15,DMPITMPT(,DMPINDEX)                             1212 06143000
*                    DMPITMLN = 4;                                 1213 06144000
         STH   @06,DMPITMLN(,DMPINDEX)                             1213 06145000
*                    DMPITMTP = 'H';                               1214 06146000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1214 06147000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1215 06148000
*                                                                  1215 06149000
         ALR   DMPINDEX,@05                                        1215 06150000
*                    DMPITMNM = 'VOLLIST';                         1216 06151000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1216 06152000
         MVC   DMPITMNM(7,DMPINDEX),@CC01267                       1216 06153000
*                    DMPITMPT = ADDR(VOLLIST);                     1217 06154000
         L     @15,VOLPTR                                          1217 06155000
         ST    @15,DMPITMPT(,DMPINDEX)                             1217 06156000
*                    DMPITMLN = MIN(256,VOLLEN);                   1218 06157000
         LH    @15,VOLLEN                                          1218 06158000
         CR    @15,@03                                             1218 06159000
         BNH   *+6                                                      06160000
         LR    @15,@03                                             1218 06161000
         STH   @15,DMPITMLN(,DMPINDEX)                             1218 06162000
*                    DMPITMTP = 'H';                               1219 06163000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1219 06164000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1220 06165000
*                                                                  1220 06166000
         ALR   DMPINDEX,@05                                        1220 06167000
*                    DMPITMNM = 'FILEPTR';                         1221 06168000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1221 06169000
         MVC   DMPITMNM(7,DMPINDEX),@CC01268                       1221 06170000
*                    DMPITMPT = ADDR(FILEPTR);                     1222 06171000
         LA    @15,FILEPTR                                         1222 06172000
         ST    @15,DMPITMPT(,DMPINDEX)                             1222 06173000
*                    DMPITMLN = 4;                                 1223 06174000
         STH   @06,DMPITMLN(,DMPINDEX)                             1223 06175000
*                    DMPITMTP = 'H';                               1224 06176000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1224 06177000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1225 06178000
*                                                                  1225 06179000
         ALR   DMPINDEX,@05                                        1225 06180000
*                    DMPITMNM = 'FILELIST';                        1226 06181000
         MVC   DMPITMNM(8,DMPINDEX),@CC01269                       1226 06182000
*                    DMPITMPT = ADDR(FILELIST);                    1227 06183000
         L     @06,FILEPTR                                         1227 06184000
         ST    @06,DMPITMPT(,DMPINDEX)                             1227 06185000
*                    DMPITMLN = MIN(256,FILELEN);                  1228 06186000
         LH    @06,FILELEN                                         1228 06187000
         CR    @06,@03                                             1228 06188000
         BNH   *+6                                                      06189000
         LR    @06,@03                                             1228 06190000
         STH   @06,DMPITMLN(,DMPINDEX)                             1228 06191000
*                    DMPITMTP = 'H';                               1229 06192000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1229 06193000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1230 06194000
         ALR   DMPINDEX,@05                                        1230 06195000
*                    DMPTRM = DMPTRMVL;                            1231 06196000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1231 06197000
*                  END;                                            1232 06198000
*                                                                  1232 06199000
*              /******************************************************/ 06200000
*              /*                                            @Y30SSMK*/ 06201000
*              /*  DUMP POINT AFTER VSAM ARGUMENT LIST IS    @Y30SSMK*/ 06202000
*              /*  BUILT TO DUMP DEVICE TYPE LIST, VOLUME    @Y30SSMK*/ 06203000
*              /*  LIST, AND DATA SET SEQUENCE LIST.         @Y30SSMK*/ 06204000
*              /*                                            @Y30SSMK*/ 06205000
*              /******************************************************/ 06206000
*                                                                  1233 06207000
*              IF GDTDBG = NULLPTR                                 1233 06208000
*                THEN;                                             1233 06209000
@RT01197 L     @06,@PC00001                                        1233 06210000
         L     @06,GDTDBG(,@06)                                    1233 06211000
         LTR   @06,@06                                             1233 06212000
         BZ    @RT01233                                            1233 06213000
*                ELSE                                              1235 06214000
*                  CALL IDCDB010(GDTTBL,'CCDV',ADDR(DLISTVIL));    1235 06215000
         L     @06,@PC00001                                        1235 06216000
         ST    @06,@AL00001                                        1235 06217000
         LA    @05,@CC01270                                        1235 06218000
         ST    @05,@AL00001+4                                      1235 06219000
         LA    @05,DLISTVIL                                        1235 06220000
         ST    @05,@AFTEMPS+12                                     1235 06221000
         LA    @05,@AFTEMPS+12                                     1235 06222000
         ST    @05,@AL00001+8                                      1235 06223000
         MVI   @AL00001+8,X'80'                                    1235 06224000
         L     @15,GDTDBG(,@06)                                    1235 06225000
         LA    @01,@AL00001                                        1235 06226000
         BALR  @14,@15                                             1235 06227000
*                                                          /*@YL026UD*/ 06228000
*                                                                  1236 06229000
*            END ALIENFVT;                                 /*@YL026UD*/ 06230000
*                                                                  1236 06231000
@RT01233 DS    0H                                                  1237 06232000
*        /************************************************************/ 06233000
*        /*                                                  @YL026UD*/ 06234000
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/ 06235000
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/ 06236000
*        /*  THE CPL, FVT, AND FPLS                          @YL026UD*/ 06237000
*        /*                                                  @YL026UD*/ 06238000
*        /************************************************************/ 06239000
*                                                                  1237 06240000
*                                                                  1237 06241000
*        IF GDTDBG = NULLPTR                                       1237 06242000
*          THEN;                                                   1237 06243000
@RF01181 L     @06,@PC00001                                        1237 06244000
         L     @06,GDTDBG(,@06)                                    1237 06245000
         LTR   @06,@06                                             1237 06246000
         BZ    @RT01237                                            1237 06247000
*          ELSE                                                    1239 06248000
*            DO;                                                   1239 06249000
*              DMPINDEX = ADDR(DLISTCPL);                          1240 06250000
*                                                                  1240 06251000
         LA    DMPINDEX,DLISTCPL                                   1240 06252000
*              DMPITMNM = 'CPLPTR';                                1241 06253000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1241 06254000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1241 06255000
         MVC   DMPITMNM(6,DMPINDEX),@CC01271                       1241 06256000
*              DMPITMPT = ADDR(CATPLPTR);                          1242 06257000
         LA    @06,CATPLPTR                                        1242 06258000
         ST    @06,DMPITMPT(,DMPINDEX)                             1242 06259000
*              DMPITMLN = 4;                                       1243 06260000
         LA    @06,4                                               1243 06261000
         STH   @06,DMPITMLN(,DMPINDEX)                             1243 06262000
*              DMPITMTP = 'H';                                     1244 06263000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1244 06264000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1245 06265000
*                                                                  1245 06266000
         LA    @05,16                                              1245 06267000
         ALR   DMPINDEX,@05                                        1245 06268000
*              DMPITMNM = 'CPL';                                   1246 06269000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1246 06270000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1246 06271000
         MVC   DMPITMNM(3,DMPINDEX),@CC01272                       1246 06272000
*              DMPITMPT = ADDR(CATPL);                             1247 06273000
         L     @03,CATPLPTR                                        1247 06274000
         ST    @03,DMPITMPT(,DMPINDEX)                             1247 06275000
*              DMPITMLN = CPLLEN;                                  1248 06276000
         LH    @03,CPLLEN                                          1248 06277000
         STH   @03,DMPITMLN(,DMPINDEX)                             1248 06278000
*              DMPITMTP = 'H';                                     1249 06279000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1249 06280000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1250 06281000
*                                                                  1250 06282000
         ALR   DMPINDEX,@05                                        1250 06283000
*              DMPITMNM = 'FVTPTR';                                1251 06284000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1251 06285000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1251 06286000
         MVC   DMPITMNM(6,DMPINDEX),@CC01273                       1251 06287000
*              DMPITMPT = ADDR(CTGFVT);                            1252 06288000
         LA    @03,CTGFVT(,CTGPLPTR)                               1252 06289000
         ST    @03,DMPITMPT(,DMPINDEX)                             1252 06290000
*              DMPITMLN = 4;                                       1253 06291000
         STH   @06,DMPITMLN(,DMPINDEX)                             1253 06292000
*              DMPITMTP = 'H';                                     1254 06293000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1254 06294000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1255 06295000
*                                                                  1255 06296000
         ALR   DMPINDEX,@05                                        1255 06297000
*              DMPITMNM = 'FVT';                                   1256 06298000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1256 06299000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1256 06300000
         MVC   DMPITMNM(3,DMPINDEX),@CC01274                       1256 06301000
*              DMPITMPT = ADDR(CTGFV);                             1257 06302000
         L     @03,CTGFVT(,CTGPLPTR)                               1257 06303000
         ST    @03,DMPITMPT(,DMPINDEX)                             1257 06304000
*              DMPITMLN = FVTLEN;                                  1258 06305000
         LH    @03,FVTLEN                                          1258 06306000
         STH   @03,DMPITMLN(,DMPINDEX)                             1258 06307000
*              DMPITMTP = 'H';                                     1259 06308000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1259 06309000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1260 06310000
*                                                                  1260 06311000
         ALR   DMPINDEX,@05                                        1260 06312000
*              DMPITMNM = 'DEVTPTR';                               1261 06313000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1261 06314000
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1261 06315000
*              DMPITMPT = ADDR(DEVTFPL);                           1262 06316000
         LA    @03,DEVTFPL                                         1262 06317000
         ST    @03,DMPITMPT(,DMPINDEX)                             1262 06318000
*              DMPITMLN = 4;                                       1263 06319000
         STH   @06,DMPITMLN(,DMPINDEX)                             1263 06320000
*              DMPITMTP = 'H';                                     1264 06321000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1264 06322000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1265 06323000
*                                                                  1265 06324000
         ALR   DMPINDEX,@05                                        1265 06325000
*              DMPITMNM = 'DEVTFPL';                               1266 06326000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1266 06327000
         MVC   DMPITMNM(7,DMPINDEX),@CC01275                       1266 06328000
*              DMPITMPT = ADDR(DEVTFPL->CTGFL);                    1267 06329000
         L     @03,DEVTFPL                                         1267 06330000
         ST    @03,DMPITMPT(,DMPINDEX)                             1267 06331000
*              DMPITMLN = FPLLEN;                                  1268 06332000
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1268 06333000
*              DMPITMTP = 'H';                                     1269 06334000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1269 06335000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1270 06336000
*                                                                  1270 06337000
         ALR   DMPINDEX,@05                                        1270 06338000
*              DMPITMNM = 'FSEQPTR';                               1271 06339000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1271 06340000
         MVC   DMPITMNM(7,DMPINDEX),@CC01276                       1271 06341000
*              DMPITMPT = ADDR(FSEQFPL);                           1272 06342000
         LA    @03,FSEQFPL                                         1272 06343000
         ST    @03,DMPITMPT(,DMPINDEX)                             1272 06344000
*              DMPITMLN = 4;                                       1273 06345000
         STH   @06,DMPITMLN(,DMPINDEX)                             1273 06346000
*              DMPITMTP = 'H';                                     1274 06347000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1274 06348000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1275 06349000
*                                                                  1275 06350000
         ALR   DMPINDEX,@05                                        1275 06351000
*              DMPITMNM = 'FSEQFPL';                               1276 06352000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1276 06353000
         MVC   DMPITMNM(7,DMPINDEX),@CC01277                       1276 06354000
*              DMPITMPT = ADDR(FSEQFPL->CTGFL);                    1277 06355000
         L     @06,FSEQFPL                                         1277 06356000
         ST    @06,DMPITMPT(,DMPINDEX)                             1277 06357000
*              DMPITMLN = FPLLEN;                                  1278 06358000
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1278 06359000
*              DMPITMTP = 'H';                                     1279 06360000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1279 06361000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1280 06362000
*                                                                  1280 06363000
         ALR   DMPINDEX,@05                                        1280 06364000
*              DMPTRM = DMPTRMVL;                                  1281 06365000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1281 06366000
*            END;                                                  1282 06367000
*                                                                  1282 06368000
*        /************************************************************/ 06369000
*        /*                                                  @Y30SSMK*/ 06370000
*        /*  DUMP POINT TO DUMP CPL, FVT, AND FPLS.          @Y30SSMK*/ 06371000
*        /*                                                  @Y30SSMK*/ 06372000
*        /************************************************************/ 06373000
*                                                                  1283 06374000
*        IF GDTDBG = NULLPTR                                       1283 06375000
*          THEN;                                                   1283 06376000
@RT01237 L     @06,@PC00001                                        1283 06377000
         L     @06,GDTDBG(,@06)                                    1283 06378000
         LTR   @06,@06                                             1283 06379000
         BZ    @RT01283                                            1283 06380000
*          ELSE                                                    1285 06381000
*            CALL IDCDB010(GDTTBL,'CCDC',ADDR(DLISTCPL));          1285 06382000
         L     @06,@PC00001                                        1285 06383000
         ST    @06,@AL00001                                        1285 06384000
         LA    @05,@CC01278                                        1285 06385000
         ST    @05,@AL00001+4                                      1285 06386000
         LA    @05,DLISTCPL                                        1285 06387000
         ST    @05,@AFTEMPS+12                                     1285 06388000
         LA    @05,@AFTEMPS+12                                     1285 06389000
         ST    @05,@AL00001+8                                      1285 06390000
         MVI   @AL00001+8,X'80'                                    1285 06391000
         L     @15,GDTDBG(,@06)                                    1285 06392000
         LA    @01,@AL00001                                        1285 06393000
         BALR  @14,@15                                             1285 06394000
*                                                          /*@YL026UD*/ 06395000
*                                                                  1286 06396000
*        END DEFNLSTS;                                     /*@YL026UD*/ 06397000
@EL00015 DS    0H                                                  1286 06398000
@EF00015 DS    0H                                                  1286 06399000
@ER00015 LM    @14,@06,@SA00015                                    1286 06400000
         LM    @08,@12,@SA00015+36                                 1286 06401000
         BR    @14                                                 1286 06402000
*/********************************************************************/ 06403000
*/*                                                          @YL026UD*/ 06404000
*/*  PROCEDURE NAME - LOCTLSTS                               @YL026UD*/ 06405000
*/*                                                          @YL026UD*/ 06406000
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/ 06407000
*/*             REQUIRED TO 'LOCATE' THE DUPLICATE ENTRY     @YL026UD*/ 06408000
*/*             IN THE PROPER VSAM CATALOG                   @YL026UD*/ 06409000
*/*                                                          @YL026UD*/ 06410000
*/*             THE VSAM LOCATE PARAMETER LISTS WILL REQUEST @YL026UD*/ 06411000
*/*             THAT THE FOLLOWING INFORMATION BE RETURNED   @YL026UD*/ 06412000
*/*             FROM THE DUPLICATE ENTRY -                   @YL026UD*/ 06413000
*/*             (1) ENTRY TYPE                               @YL026UD*/ 06414000
*/*                 (VIA THE 'ENTYPE' FPL)                   @YL026UD*/ 06415000
*/*             (2) CATALOG ENTRY VOLUME INFORMATION,        @YL026UD*/ 06416000
*/*                 INCLUDING DEVICE TYPE(S), VOLUME SERIAL  @YL026UD*/ 06417000
*/*                 NUMBER(S), AND FILE SEQUENCE NUMBER(S)   @YL026UD*/ 06418000
*/*                 (VIA THE 'CATVOL' FPL)                   @YL026UD*/ 06419000
*/*                                                          @YL026UD*/ 06420000
*/*             TWO PARAMETER LISTS ARE REQUIRED -           @YL026UD*/ 06421000
*/*             (1) CPL - CATALOG PARAMETER LIST             @YL026UD*/ 06422000
*/*                 (TO IDENTIFY THE 'LOCATE' REQUEST,       @YL026UD*/ 06423000
*/*                 THE DUPLICATE ENTRY BEING LOCATED,       @YL026UD*/ 06424000
*/*                 AND THE RECEIVING VSAM CATALOG)          @YL026UD*/ 06425000
*/*             (2) FPL - FIELD PARAMETER LISTS              @YL026UD*/ 06426000
*/*                 (TO REQUEST THAT THE ENTRY TYPE AND      @YL026UD*/ 06427000
*/*                 CATALOG ENTRY INFORMATION BE RETURNED)   @YL026UD*/ 06428000
*/*                                                          @YL026UD*/ 06429000
*/*  INPUT - THE REQUIRED STORAGE AREAS FOR THE VSAM         @YL026UD*/ 06430000
*/*          CATALOG PARAMETER LISTS                         @YL026UD*/ 06431000
*/*                                                          @YL026UD*/ 06432000
*/*  OUTPUT - THE INITIALIZED VSAM CATALOG PARAMETER LISTS   @YL026UD*/ 06433000
*/*           TO 'LOCATE' THE DUPLICATE ENTRY                @YL026UD*/ 06434000
*/*                                                          @YL026UD*/ 06435000
*/********************************************************************/ 06436000
*                                                                  1287 06437000
*LOCTLSTS: PROCEDURE;                                      /*@YL026UD*/ 06438000
LOCTLSTS STM   @14,@12,@SA00016                                    1287 06439000
*        OLDERID2 = NEWERID2;                                      1288 06440000
         L     @05,@PC00001                                        1288 06441000
         L     @05,GDTTR2(,@05)                                    1288 06442000
         MVC   @TS00001(95),NEWERID2(@05)                          1288 06443000
         MVC   OLDERID2(95,@05),@TS00001                           1288 06444000
*        NEWID2 = 'CCLL';                                  /*@YL026UD*/ 06445000
*                                                                  1289 06446000
         MVC   NEWID2(4,@05),@CC01282                              1289 06447000
*        /************************************************************/ 06448000
*        /*                                                  @YL026UD*/ 06449000
*        /*  ZERO THE CPL AND FPLS TO BUILD 'LOCATE' REQUEST @YL026UD*/ 06450000
*        /*                                                  @YL026UD*/ 06451000
*        /************************************************************/ 06452000
*                                                                  1290 06453000
*        DO INDEX = 1 TO CATPLLEN BY 8;                    /*@YL026UD*/ 06454000
*                                                                  1290 06455000
         LA    INDEX,1                                             1290 06456000
         B     @DE01290                                            1290 06457000
@DL01290 DS    0H                                                  1291 06458000
*          CATPL(INDEX:INDEX+7) = CATZERO;                 /*@YL026UD*/ 06459000
*                                                                  1291 06460000
         L     @06,CATPLPTR                                        1291 06461000
         ALR   @06,INDEX                                           1291 06462000
         AL    @06,@CF01151                                        1291 06463000
         MVC   CATPL(8,@06),CATZERO                                1291 06464000
*        END;                                              /*@YL026UD*/ 06465000
*                                                                  1292 06466000
         AL    INDEX,@CF00175                                      1292 06467000
@DE01290 C     INDEX,CATPLLEN                                      1292 06468000
         BNH   @DL01290                                            1292 06469000
*        /************************************************************/ 06470000
*        /*                                                  @YL026UD*/ 06471000
*        /*  INITIALIZE THE CATALOG PARAMETER LIST (CPL) -   @YL026UD*/ 06472000
*        /*  FOR THE 'LOCATE' REQUEST                        @YL026UD*/ 06473000
*        /*                                                  @YL026UD*/ 06474000
*        /************************************************************/ 06475000
*                                                                  1293 06476000
*        CTGFUNC = CTGLOC;                                 /*@YL026UD*/ 06477000
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       1293 06478000
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       1293 06479000
*        CTGNAME = ON;                                     /*@YL026UD*/ 06480000
         OI    CTGNAME(CTGPLPTR),B'00000100'                       1294 06481000
*        CTGAM0 = ON;                                      /*@YL026UD*/ 06482000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        1295 06483000
*        CTGNAME = ON;                                     /*@YL026UD*/ 06484000
*        CTGCNAME = ON;                                    /*@YL026UD*/ 06485000
*                                                                  1297 06486000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       1297 06487000
*        IF CATNMPLN ^= 0                                          1298 06488000
*          THEN                                                    1298 06489000
         L     @05,@PC00001+4                                      1298 06490000
         L     @05,FDTPTR+12(,@05)                                 1298 06491000
         CLI   CATNMPLN(@05),0                                     1298 06492000
         BE    @RF01298                                            1298 06493000
*            CTGPSWD = ADDR(CATNMPAS);                     /*@YL026UD*/ 06494000
*                                                                  1299 06495000
         LA    @05,CATNMPAS(,@05)                                  1299 06496000
         ST    @05,CTGPSWD(,CTGPLPTR)                              1299 06497000
*        IF ADDR(CAT) ^= NULLPTR                                   1300 06498000
*          THEN                                                    1300 06499000
@RF01298 L     @05,@PC00001+4                                      1300 06500000
         L     @15,FDTPTR+8(,@05)                                  1300 06501000
         LTR   @15,@15                                             1300 06502000
         BZ    @RF01300                                            1300 06503000
*            CTGCAT = ADDR(CATNMVAL);                      /*@Y30SSMK*/ 06504000
*                                                                  1301 06505000
         L     @05,FDTPTR+12(,@05)                                 1301 06506000
         LA    @05,CATNMVAL(,@05)                                  1301 06507000
         ST    @05,CTGCAT(,CTGPLPTR)                               1301 06508000
*        CTGENT = ADDR(DSNAME);                            /*@YL026UD*/ 06509000
*                                                                  1302 06510000
@RF01300 LA    @05,DSNAME                                          1302 06511000
         ST    @05,CTGENT(,CTGPLPTR)                               1302 06512000
*        CTGNOFLD = 2;                                     /*@YL026UD*/ 06513000
         MVI   CTGNOFLD(CTGPLPTR),X'02'                            1303 06514000
*        CTGFIELD(1) = ENTYPFPL;                           /*@YL026UD*/ 06515000
         L     @05,ENTYPFPL                                        1304 06516000
         ST    @05,CTGFIELD(,CTGPLPTR)                             1304 06517000
*        CTGFIELD(2) = CATVLFPL;                           /*@YL026UD*/ 06518000
*                                                                  1305 06519000
         L     @15,CATVLFPL                                        1305 06520000
         ST    @15,CTGFIELD+4(,CTGPLPTR)                           1305 06521000
*        /************************************************************/ 06522000
*        /*                                                  @YL026UD*/ 06523000
*        /*  INITIALIZE ENTRY TYPE FPL (ENTYPFPL)            @YL026UD*/ 06524000
*        /*                                                  @YL026UD*/ 06525000
*        /************************************************************/ 06526000
*                                                                  1306 06527000
*        ENTYPFPL -> CTGFLDNO = 1;                         /*@YL026UD*/ 06528000
         MVI   CTGFLDNO(@05),X'01'                                 1306 06529000
*        ENTYPFPL -> CTGFLDNM = ADDR(ENTYPCON);            /*@YL026UD*/ 06530000
*                                                                  1307 06531000
         LA    @14,@CC01216                                        1307 06532000
         ST    @14,CTGFLDNM(,@05)                                  1307 06533000
*        /************************************************************/ 06534000
*        /*                                                  @YL026UD*/ 06535000
*        /*  INITIALIZE CATALOG VOLUME INFORMATION FPL       @YL026UD*/ 06536000
*        /*  (CATVLFPL)                                      @YL026UD*/ 06537000
*        /*                                                  @YL026UD*/ 06538000
*        /************************************************************/ 06539000
*                                                                  1308 06540000
*        CATVLFPL -> CTGFLDNO = 1;                         /*@YL026UD*/ 06541000
         MVI   CTGFLDNO(@15),X'01'                                 1308 06542000
*        CATVLFPL -> CTGFLDNM = ADDR(CATVLCON);            /*@YL026UD*/ 06543000
*                                                                  1309 06544000
         LA    @05,@CC01218                                        1309 06545000
         ST    @05,CTGFLDNM(,@15)                                  1309 06546000
*        /************************************************************/ 06547000
*        /*                                                  @YL026UD*/ 06548000
*        /*  DIAGNOSTIC AIDS (TEST MODE) -                   @YL026UD*/ 06549000
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/ 06550000
*        /*  THE CPL AND FPLS                                @YL026UD*/ 06551000
*        /*                                                  @YL026UD*/ 06552000
*        /************************************************************/ 06553000
*                                                                  1310 06554000
*                                                                  1310 06555000
*        IF GDTDBG = NULLPTR                                       1310 06556000
*          THEN;                                                   1310 06557000
         L     @05,@PC00001                                        1310 06558000
         L     @05,GDTDBG(,@05)                                    1310 06559000
         LTR   @05,@05                                             1310 06560000
         BZ    @RT01310                                            1310 06561000
*          ELSE                                                    1312 06562000
*            DO;                                                   1312 06563000
*              DMPINDEX = ADDR(DLISTCPL);                          1313 06564000
*                                                                  1313 06565000
         LA    DMPINDEX,DLISTCPL                                   1313 06566000
*              DMPITMNM = 'CPLPTR';                                1314 06567000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1314 06568000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1314 06569000
         MVC   DMPITMNM(6,DMPINDEX),@CC01271                       1314 06570000
*              DMPITMPT = ADDR(CATPLPTR);                          1315 06571000
         LA    @05,CATPLPTR                                        1315 06572000
         ST    @05,DMPITMPT(,DMPINDEX)                             1315 06573000
*              DMPITMLN = 4;                                       1316 06574000
         LA    @05,4                                               1316 06575000
         STH   @05,DMPITMLN(,DMPINDEX)                             1316 06576000
*              DMPITMTP = 'H';                                     1317 06577000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1317 06578000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1318 06579000
*                                                                  1318 06580000
         LA    @03,16                                              1318 06581000
         ALR   DMPINDEX,@03                                        1318 06582000
*              DMPITMNM = 'CPL';                                   1319 06583000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1319 06584000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1319 06585000
         MVC   DMPITMNM(3,DMPINDEX),@CC01272                       1319 06586000
*              DMPITMPT = ADDR(CATPL);                             1320 06587000
         L     @15,CATPLPTR                                        1320 06588000
         ST    @15,DMPITMPT(,DMPINDEX)                             1320 06589000
*              DMPITMLN = CPLLEN;                                  1321 06590000
         LH    @15,CPLLEN                                          1321 06591000
         STH   @15,DMPITMLN(,DMPINDEX)                             1321 06592000
*              DMPITMTP = 'H';                                     1322 06593000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1322 06594000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1323 06595000
*                                                                  1323 06596000
         ALR   DMPINDEX,@03                                        1323 06597000
*              DMPITMNM = 'ENTYPPTR';                              1324 06598000
         MVC   DMPITMNM(8,DMPINDEX),@CC01241                       1324 06599000
*              DMPITMPT = ADDR(ENTYPFPL);                          1325 06600000
         LA    @15,ENTYPFPL                                        1325 06601000
         ST    @15,DMPITMPT(,DMPINDEX)                             1325 06602000
*              DMPITMLN = 4;                                       1326 06603000
         STH   @05,DMPITMLN(,DMPINDEX)                             1326 06604000
*              DMPITMTP = 'H';                                     1327 06605000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1327 06606000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1328 06607000
*                                                                  1328 06608000
         ALR   DMPINDEX,@03                                        1328 06609000
*              DMPITMNM = 'ENTYPFPL';                              1329 06610000
         MVC   DMPITMNM(8,DMPINDEX),@CC01283                       1329 06611000
*              DMPITMPT = ADDR(ENTYPFPL->CTGFL);                   1330 06612000
         L     @15,ENTYPFPL                                        1330 06613000
         ST    @15,DMPITMPT(,DMPINDEX)                             1330 06614000
*              DMPITMLN = FPLLEN;                                  1331 06615000
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1331 06616000
*              DMPITMTP = 'H';                                     1332 06617000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1332 06618000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1333 06619000
*                                                                  1333 06620000
         ALR   DMPINDEX,@03                                        1333 06621000
*              DMPITMNM = 'CATVLPTR';                              1334 06622000
         MVC   DMPITMNM(8,DMPINDEX),@CC01243                       1334 06623000
*              DMPITMPT = ADDR(CATVLFPL);                          1335 06624000
         LA    @15,CATVLFPL                                        1335 06625000
         ST    @15,DMPITMPT(,DMPINDEX)                             1335 06626000
*              DMPITMLN = 4;                                       1336 06627000
         STH   @05,DMPITMLN(,DMPINDEX)                             1336 06628000
*              DMPITMTP = 'H';                                     1337 06629000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1337 06630000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1338 06631000
*                                                                  1338 06632000
         ALR   DMPINDEX,@03                                        1338 06633000
*              DMPITMNM = 'CATVLFPL';                              1339 06634000
         MVC   DMPITMNM(8,DMPINDEX),@CC01284                       1339 06635000
*              DMPITMPT = ADDR(CATVLFPL->CTGFL);                   1340 06636000
         L     @05,CATVLFPL                                        1340 06637000
         ST    @05,DMPITMPT(,DMPINDEX)                             1340 06638000
*              DMPITMLN = FPLLEN;                                  1341 06639000
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1341 06640000
*              DMPITMTP = 'H';                                     1342 06641000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1342 06642000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1343 06643000
*                                                                  1343 06644000
         ALR   DMPINDEX,@03                                        1343 06645000
*              DMPTRM = DMPTRMVL;                                  1344 06646000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1344 06647000
*            END;                                                  1345 06648000
*                                                                  1345 06649000
*        /************************************************************/ 06650000
*        /*                                                  @Y30SSMK*/ 06651000
*        /*  DUMP POINT TO DUMP CPL AND FPLS AFTER VSAM      @Y30SSMK*/ 06652000
*        /*  PARAMETER LIST IS BUILT TO LOCATE INFORMATION   @Y30SSMK*/ 06653000
*        /*  IN THE VSAM CATALOG.                            @Y30SSMK*/ 06654000
*        /*                                                  @Y30SSMK*/ 06655000
*        /************************************************************/ 06656000
*                                                                  1346 06657000
*        IF GDTDBG = NULLPTR                                       1346 06658000
*          THEN;                                                   1346 06659000
@RT01310 L     @05,@PC00001                                        1346 06660000
         L     @05,GDTDBG(,@05)                                    1346 06661000
         LTR   @05,@05                                             1346 06662000
         BZ    @RT01346                                            1346 06663000
*          ELSE                                                    1348 06664000
*            CALL IDCDB010(GDTTBL,'CCLC',ADDR(DLISTCPL));          1348 06665000
         L     @05,@PC00001                                        1348 06666000
         ST    @05,@AL00001                                        1348 06667000
         LA    @15,@CC01285                                        1348 06668000
         ST    @15,@AL00001+4                                      1348 06669000
         LA    @15,DLISTCPL                                        1348 06670000
         ST    @15,@AFTEMPS+16                                     1348 06671000
         LA    @15,@AFTEMPS+16                                     1348 06672000
         ST    @15,@AL00001+8                                      1348 06673000
         MVI   @AL00001+8,X'80'                                    1348 06674000
         L     @15,GDTDBG(,@05)                                    1348 06675000
         LA    @01,@AL00001                                        1348 06676000
         BALR  @14,@15                                             1348 06677000
*                                                          /*@YL026UD*/ 06678000
*                                                                  1349 06679000
*        END LOCTLSTS;                                     /*@YL026UD*/ 06680000
@EL00016 DS    0H                                                  1349 06681000
@EF00016 DS    0H                                                  1349 06682000
@ER00016 LM    @14,@12,@SA00016                                    1349 06683000
         BR    @14                                                 1349 06684000
*/********************************************************************/ 06685000
*/*                                                          @YL026UD*/ 06686000
*/*  PROCEDURE NAME - ALTRLSTS                               @YL026UD*/ 06687000
*/*                                                          @YL026UD*/ 06688000
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/ 06689000
*/*             REQUIRED TO 'ALTER' THE NONVSAM CATALOG      @YL026UD*/ 06690000
*/*             ENTRY IN THE PROPER VSAM CATALOG             @YL026UD*/ 06691000
*/*                                                          @YL026UD*/ 06692000
*/*             THREE PARAMETER LISTS ARE REQUIRED -         @YL026UD*/ 06693000
*/*             (1) CPL - CATALOG PARAMETER LIST             @YL026UD*/ 06694000
*/*                 (TO IDENTIFY THE 'ALTER' REQUEST         @YL026UD*/ 06695000
*/*                 AND THE RECEIVING VSAM CATALOG)          @YL026UD*/ 06696000
*/*              (2) FVT - FIELD VECTOR TABLE                @YL026UD*/ 06697000
*/*                  (TO IDENTIFY THE ENTRY TO BE ALTERED)   @YL026UD*/ 06698000
*/*              (3) FPL - FIELD PARAMETER LISTS             @YL026UD*/ 06699000
*/*                  (FOR THE UPDATED DEVICE TYPE AND FILE   @YL026UD*/ 06700000
*/*                  SEQUENCE INFORMATION)                   @YL026UD*/ 06701000
*/*                                                          @YL026UD*/ 06702000
*/*  INPUT - THE REQUIRED STORAGE AREAS FOR THE VSAM         @YL026UD*/ 06703000
*/*          CATALOG PARAMETER LISTS                         @YL026UD*/ 06704000
*/*                                                          @YL026UD*/ 06705000
*/*  OUTPUT - THE INITIALIZED VSAM CATALOG PARAMETER LISTS   @YL026UD*/ 06706000
*/*           TO 'ALTER' THE NONVSAM CATALOG ENTRY           @YL026UD*/ 06707000
*/*                                                          @YL026UD*/ 06708000
*/********************************************************************/ 06709000
*                                                                  1350 06710000
*ALTRLSTS: PROCEDURE;                                      /*@YL026UD*/ 06711000
ALTRLSTS STM   @14,@06,@SA00017                                    1350 06712000
         STM   @08,@12,@SA00017+36                                 1350 06713000
*        OLDERID2 = NEWERID2;                                      1351 06714000
         L     @05,@PC00001                                        1351 06715000
         L     @05,GDTTR2(,@05)                                    1351 06716000
         MVC   @TS00001(95),NEWERID2(@05)                          1351 06717000
         MVC   OLDERID2(95,@05),@TS00001                           1351 06718000
*        NEWID2 = 'CCAL';                                  /*@YL026UD*/ 06719000
*                                                                  1352 06720000
         MVC   NEWID2(4,@05),@CC01289                              1352 06721000
*        /************************************************************/ 06722000
*        /*                                                  @YL026UD*/ 06723000
*        /*  ZERO THE CPL/FVT/FPL PARAMETER LISTS            @YL026UD*/ 06724000
*        /*                                                  @YL026UD*/ 06725000
*        /************************************************************/ 06726000
*                                                                  1353 06727000
*        DO INDEX = 1 TO CATPLLEN BY 8;                    /*@YL026UD*/ 06728000
*                                                                  1353 06729000
         LA    INDEX,1                                             1353 06730000
         B     @DE01353                                            1353 06731000
@DL01353 DS    0H                                                  1354 06732000
*          CATPL(INDEX:INDEX+7) = CATZERO;                 /*@YL026UD*/ 06733000
*                                                                  1354 06734000
         L     @06,CATPLPTR                                        1354 06735000
         ALR   @06,INDEX                                           1354 06736000
         AL    @06,@CF01151                                        1354 06737000
         MVC   CATPL(8,@06),CATZERO                                1354 06738000
*        END;                                              /*@YL026UD*/ 06739000
*                                                                  1355 06740000
         AL    INDEX,@CF00175                                      1355 06741000
@DE01353 C     INDEX,CATPLLEN                                      1355 06742000
         BNH   @DL01353                                            1355 06743000
*        /************************************************************/ 06744000
*        /*                                                  @YL026UD*/ 06745000
*        /*  INITIALIZE THE CPL FOR THE 'ALTER' REQUEST      @YL026UD*/ 06746000
*        /*                                                  @YL026UD*/ 06747000
*        /************************************************************/ 06748000
*                                                                  1356 06749000
*        CTGFUNC = CTGCMS;                                 /*@YL026UD*/ 06750000
         NI    CTGFUNC(CTGPLPTR),B'10011111'                       1356 06751000
         OI    CTGFUNC(CTGPLPTR),B'10000000'                       1356 06752000
*        CTGOPTNS = CTGALTER;                              /*@YL026UD*/ 06753000
         NI    CTGOPTNS(CTGPLPTR),B'00010111'                      1357 06754000
         OI    CTGOPTNS(CTGPLPTR),B'00010000'                      1357 06755000
*        CTGAM0 = ON;                                      /*@YL026UD*/ 06756000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        1358 06757000
*        CTGNAME = ON;                                     /*@YL026UD*/ 06758000
*        CTGCNAME = ON;                                    /*@YL026UD*/ 06759000
*                                                                  1360 06760000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       1360 06761000
*        IF CATNMPLN ^= 0                                          1361 06762000
*          THEN                                                    1361 06763000
         L     @06,@PC00001+4                                      1361 06764000
         L     @06,FDTPTR+12(,@06)                                 1361 06765000
         CLI   CATNMPLN(@06),0                                     1361 06766000
         BE    @RF01361                                            1361 06767000
*            CTGPSWD = ADDR(CATNMPAS);                     /*@YL026UD*/ 06768000
*                                                                  1362 06769000
         LA    @06,CATNMPAS(,@06)                                  1362 06770000
         ST    @06,CTGPSWD(,CTGPLPTR)                              1362 06771000
*        IF ADDR(CAT) ^= NULLPTR                                   1363 06772000
*          THEN                                                    1363 06773000
@RF01361 L     @06,@PC00001+4                                      1363 06774000
         L     @05,FDTPTR+8(,@06)                                  1363 06775000
         LTR   @05,@05                                             1363 06776000
         BZ    @RF01363                                            1363 06777000
*            CTGCAT = ADDR(CATNMVAL);                      /*@Y30SSMK*/ 06778000
*                                                                  1364 06779000
         L     @06,FDTPTR+12(,@06)                                 1364 06780000
         LA    @06,CATNMVAL(,@06)                                  1364 06781000
         ST    @06,CTGCAT(,CTGPLPTR)                               1364 06782000
*        CTGFVT = CATPLPTR + CPLLEN;                       /*@YL026UD*/ 06783000
*                                                                  1365 06784000
@RF01363 LH    @06,CPLLEN                                          1365 06785000
         AL    @06,CATPLPTR                                        1365 06786000
         ST    @06,CTGFVT(,CTGPLPTR)                               1365 06787000
*        /************************************************************/ 06788000
*        /*                                                  @YL026UD*/ 06789000
*        /*  INITIALIZE THE ALIEN (NONVSAM) FVT              @YL026UD*/ 06790000
*        /*                                                  @YL026UD*/ 06791000
*        /************************************************************/ 06792000
*                                                                  1366 06793000
*        CTGFVENT = ADDR(DSNAME);                          /*@YL026UD*/ 06794000
         LA    @05,DSNAME                                          1366 06795000
         ST    @05,CTGFVENT(,@06)                                  1366 06796000
*        CTGFVTYP = CTGFVALN;                              /*@YL026UD*/ 06797000
         MVI   CTGFVTYP(@06),C'A'                                  1367 06798000
*        CTGFVNDC = ON;                                    /*@YL026UD*/ 06799000
         OI    CTGFVNDC(@06),B'00100000'                           1368 06800000
*        CTGFVVLT = ADDR(VOLLIST);                         /*@YL026UD*/ 06801000
         L     @05,VOLPTR                                          1369 06802000
         ST    @05,CTGFVVLT(,@06)                                  1369 06803000
*        CTGFVDVT = DEVTFPL;                               /*@YL026UD*/ 06804000
         L     @05,DEVTFPL                                         1370 06805000
         ST    @05,CTGFVDVT(,@06)                                  1370 06806000
*        CTGFVTTR = ADDR(DSCBTTR);                         /*@YL026UD*/ 06807000
         LA    @15,DSCBTTR                                         1371 06808000
         ST    @15,CTGFVTTR(,@06)                                  1371 06809000
*        CTGFVFSN = FSEQFPL;                               /*@YL026UD*/ 06810000
*                                                                  1372 06811000
         L     @15,FSEQFPL                                         1372 06812000
         ST    @15,CTGFVFSN(,@06)                                  1372 06813000
*        /************************************************************/ 06814000
*        /*                                                  @YL026UD*/ 06815000
*        /*  INITIALIZE THE DEVICE TYPE FPL (DEVTFPL)        @YL026UD*/ 06816000
*        /*                                                  @YL026UD*/ 06817000
*        /************************************************************/ 06818000
*                                                                  1373 06819000
*        DEVTFPL -> CTGFLDNO = 1;                          /*@YL026UD*/ 06820000
         MVI   CTGFLDNO(@05),X'01'                                 1373 06821000
*        DEVTFPL -> CTGFLDNM = ADDR(DEVTCON);              /*@YL026UD*/ 06822000
         LA    @06,@CC01212                                        1374 06823000
         ST    @06,CTGFLDNM(,@05)                                  1374 06824000
*        DEVTFPL -> CTGFLNG(1) = VOLCNT * LENGTH(DEVTLIST);/*@YL026UD*/ 06825000
         LH    @06,VOLCNT                                          1375 06826000
         LR    @14,@06                                             1375 06827000
         MH    @14,@CH00037                                        1375 06828000
         ST    @14,CTGFLNG(,@05)                                   1375 06829000
*        DEVTFPL -> CTGFLPT(1) = ADDR(DEVTLIST);           /*@YL026UD*/ 06830000
*                                                                  1376 06831000
         L     @14,DEVTPTR                                         1376 06832000
         ST    @14,CTGFLPT(,@05)                                   1376 06833000
*        /************************************************************/ 06834000
*        /*                                                  @YL026UD*/ 06835000
*        /*  INITIALIZE FILE SEQUENCE NUMBER FPL (FSEQFPL)   @YL026UD*/ 06836000
*        /*                                                  @YL026UD*/ 06837000
*        /************************************************************/ 06838000
*                                                                  1377 06839000
*        FSEQFPL -> CTGFLDNO = 1;                          /*@YL026UD*/ 06840000
         MVI   CTGFLDNO(@15),X'01'                                 1377 06841000
*        FSEQFPL -> CTGFLDNM = ADDR(FILECON);              /*@YL026UD*/ 06842000
         LA    @05,@CC01214                                        1378 06843000
         ST    @05,CTGFLDNM(,@15)                                  1378 06844000
*        FSEQFPL -> CTGFLNG(1) = VOLCNT * LENGTH(FILELIST);/*@YL026UD*/ 06845000
         ALR   @06,@06                                             1379 06846000
         ST    @06,CTGFLNG(,@15)                                   1379 06847000
*        FSEQFPL -> CTGFLPT(1) = ADDR(FILELIST);           /*@YL026UD*/ 06848000
*                                                                  1380 06849000
         L     @06,FILEPTR                                         1380 06850000
         ST    @06,CTGFLPT(,@15)                                   1380 06851000
*        /************************************************************/ 06852000
*        /*                                                  @YL026UD*/ 06853000
*        /*  DIAGNOSTIC AIDS (TEST MODE) -                   @YL026UD*/ 06854000
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/ 06855000
*        /*  THE DEVICE TYPE LIST, VOLUME LIST, AND          @YL026UD*/ 06856000
*        /*  DATA SET SEQUENCE LIST                          @YL026UD*/ 06857000
*        /*  (REFERENCED BY THE FVT AND RESPECTIVE FPLS)     @YL026UD*/ 06858000
*        /*                                                  @YL026UD*/ 06859000
*        /************************************************************/ 06860000
*                                                                  1381 06861000
*                                                                  1381 06862000
*        IF GDTDBG = NULLPTR                                       1381 06863000
*          THEN;                                                   1381 06864000
         L     @06,@PC00001                                        1381 06865000
         L     @06,GDTDBG(,@06)                                    1381 06866000
         LTR   @06,@06                                             1381 06867000
         BZ    @RT01381                                            1381 06868000
*          ELSE                                                    1383 06869000
*            DO;                                                   1383 06870000
*              DMPINDEX = ADDR(DLISTVIL);                          1384 06871000
*                                                                  1384 06872000
         LA    DMPINDEX,DLISTVIL                                   1384 06873000
*              DMPITMNM = 'DEVTPTR';                               1385 06874000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1385 06875000
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1385 06876000
*              DMPITMPT = ADDR(DEVTPTR);                           1386 06877000
         LA    @06,DEVTPTR                                         1386 06878000
         ST    @06,DMPITMPT(,DMPINDEX)                             1386 06879000
*              DMPITMLN = 4;                                       1387 06880000
         LA    @06,4                                               1387 06881000
         STH   @06,DMPITMLN(,DMPINDEX)                             1387 06882000
*              DMPITMTP = 'H';                                     1388 06883000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1388 06884000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1389 06885000
*                                                                  1389 06886000
         LA    @05,16                                              1389 06887000
         ALR   DMPINDEX,@05                                        1389 06888000
*              DMPITMNM = 'DEVTLIST';                              1390 06889000
         MVC   DMPITMNM(8,DMPINDEX),@CC01265                       1390 06890000
*              DMPITMPT = ADDR(DEVTLIST);                          1391 06891000
         L     @03,DEVTPTR                                         1391 06892000
         ST    @03,DMPITMPT(,DMPINDEX)                             1391 06893000
*              DMPITMLN = MIN(256,DEVTLEN);                        1392 06894000
         LA    @03,256                                             1392 06895000
         LH    @15,DEVTLEN                                         1392 06896000
         CR    @15,@03                                             1392 06897000
         BNH   *+6                                                      06898000
         LR    @15,@03                                             1392 06899000
         STH   @15,DMPITMLN(,DMPINDEX)                             1392 06900000
*              DMPITMTP = 'H';                                     1393 06901000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1393 06902000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1394 06903000
*                                                                  1394 06904000
         ALR   DMPINDEX,@05                                        1394 06905000
*              DMPITMNM = 'VOLPTR';                                1395 06906000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1395 06907000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1395 06908000
         MVC   DMPITMNM(6,DMPINDEX),@CC01266                       1395 06909000
*              DMPITMPT = ADDR(VOLPTR);                            1396 06910000
         LA    @15,VOLPTR                                          1396 06911000
         ST    @15,DMPITMPT(,DMPINDEX)                             1396 06912000
*              DMPITMLN = 4;                                       1397 06913000
         STH   @06,DMPITMLN(,DMPINDEX)                             1397 06914000
*              DMPITMTP = 'H';                                     1398 06915000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1398 06916000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1399 06917000
*                                                                  1399 06918000
         ALR   DMPINDEX,@05                                        1399 06919000
*              DMPITMNM = 'VOLLIST';                               1400 06920000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1400 06921000
         MVC   DMPITMNM(7,DMPINDEX),@CC01267                       1400 06922000
*              DMPITMPT = ADDR(VOLLIST);                           1401 06923000
         L     @15,VOLPTR                                          1401 06924000
         ST    @15,DMPITMPT(,DMPINDEX)                             1401 06925000
*              DMPITMLN = MIN(256,VOLLEN);                         1402 06926000
         LH    @15,VOLLEN                                          1402 06927000
         CR    @15,@03                                             1402 06928000
         BNH   *+6                                                      06929000
         LR    @15,@03                                             1402 06930000
         STH   @15,DMPITMLN(,DMPINDEX)                             1402 06931000
*              DMPITMTP = 'H';                                     1403 06932000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1403 06933000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1404 06934000
*                                                                  1404 06935000
         ALR   DMPINDEX,@05                                        1404 06936000
*              DMPITMNM = 'FILEPTR';                               1405 06937000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1405 06938000
         MVC   DMPITMNM(7,DMPINDEX),@CC01268                       1405 06939000
*              DMPITMPT = ADDR(FILEPTR);                           1406 06940000
         LA    @15,FILEPTR                                         1406 06941000
         ST    @15,DMPITMPT(,DMPINDEX)                             1406 06942000
*              DMPITMLN = 4;                                       1407 06943000
         STH   @06,DMPITMLN(,DMPINDEX)                             1407 06944000
*              DMPITMTP = 'H';                                     1408 06945000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1408 06946000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1409 06947000
*                                                                  1409 06948000
         ALR   DMPINDEX,@05                                        1409 06949000
*              DMPITMNM = 'FILELIST';                              1410 06950000
         MVC   DMPITMNM(8,DMPINDEX),@CC01269                       1410 06951000
*              DMPITMPT = ADDR(FILELIST);                          1411 06952000
         L     @06,FILEPTR                                         1411 06953000
         ST    @06,DMPITMPT(,DMPINDEX)                             1411 06954000
*              DMPITMLN = MIN(256,FILELEN);                        1412 06955000
         LH    @06,FILELEN                                         1412 06956000
         CR    @06,@03                                             1412 06957000
         BNH   *+6                                                      06958000
         LR    @06,@03                                             1412 06959000
         STH   @06,DMPITMLN(,DMPINDEX)                             1412 06960000
*              DMPITMTP = 'H';                                     1413 06961000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1413 06962000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1414 06963000
*                                                                  1414 06964000
         ALR   DMPINDEX,@05                                        1414 06965000
*              DMPTRM = DMPTRMVL;                                  1415 06966000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1415 06967000
*            END;                                                  1416 06968000
*                                                                  1416 06969000
*        /************************************************************/ 06970000
*        /*                                                  @Y30SSMK*/ 06971000
*        /*  DUMP POINT TO DUMP DEVICE TYPE LIST, VOLUME     @Y30SSMK*/ 06972000
*        /*  LIST, AND DATA SET SEQUENCE LIST AFTER BUILDING @Y30SSMK*/ 06973000
*        /*  THE VSAM PARAMETER LIST TO ALTER A VSAM CATALOG @Y30SSMK*/ 06974000
*        /*  ENTRY.                                          @Y30SSMK*/ 06975000
*        /*                                                  @Y30SSMK*/ 06976000
*        /************************************************************/ 06977000
*                                                                  1417 06978000
*        IF GDTDBG = NULLPTR                                       1417 06979000
*          THEN;                                                   1417 06980000
@RT01381 L     @06,@PC00001                                        1417 06981000
         L     @06,GDTDBG(,@06)                                    1417 06982000
         LTR   @06,@06                                             1417 06983000
         BZ    @RT01417                                            1417 06984000
*          ELSE                                                    1419 06985000
*            CALL IDCDB010(GDTTBL,'CCAV',ADDR(DLISTVIL));          1419 06986000
         L     @06,@PC00001                                        1419 06987000
         ST    @06,@AL00001                                        1419 06988000
         LA    @05,@CC01290                                        1419 06989000
         ST    @05,@AL00001+4                                      1419 06990000
         LA    @05,DLISTVIL                                        1419 06991000
         ST    @05,@AFTEMPS+20                                     1419 06992000
         LA    @05,@AFTEMPS+20                                     1419 06993000
         ST    @05,@AL00001+8                                      1419 06994000
         MVI   @AL00001+8,X'80'                                    1419 06995000
         L     @15,GDTDBG(,@06)                                    1419 06996000
         LA    @01,@AL00001                                        1419 06997000
         BALR  @14,@15                                             1419 06998000
*                                                          /*@YL026UD*/ 06999000
*                                                                  1420 07000000
*        /************************************************************/ 07001000
*        /*                                                  @YL026UD*/ 07002000
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/ 07003000
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/ 07004000
*        /*  THE CPL, FVT, AND FPLS                          @YL026UD*/ 07005000
*        /*                                                  @YL026UD*/ 07006000
*        /************************************************************/ 07007000
*                                                                  1420 07008000
*                                                                  1420 07009000
*        IF GDTDBG = NULLPTR                                       1420 07010000
*          THEN;                                                   1420 07011000
@RT01417 L     @06,@PC00001                                        1420 07012000
         L     @06,GDTDBG(,@06)                                    1420 07013000
         LTR   @06,@06                                             1420 07014000
         BZ    @RT01420                                            1420 07015000
*          ELSE                                                    1422 07016000
*            DO;                                                   1422 07017000
*              DMPINDEX = ADDR(DLISTCPL);                          1423 07018000
*                                                                  1423 07019000
         LA    DMPINDEX,DLISTCPL                                   1423 07020000
*              DMPITMNM = 'CPLPTR';                                1424 07021000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1424 07022000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1424 07023000
         MVC   DMPITMNM(6,DMPINDEX),@CC01271                       1424 07024000
*              DMPITMPT = ADDR(CATPLPTR);                          1425 07025000
         LA    @06,CATPLPTR                                        1425 07026000
         ST    @06,DMPITMPT(,DMPINDEX)                             1425 07027000
*              DMPITMLN = 4;                                       1426 07028000
         LA    @06,4                                               1426 07029000
         STH   @06,DMPITMLN(,DMPINDEX)                             1426 07030000
*              DMPITMTP = 'H';                                     1427 07031000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1427 07032000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1428 07033000
*                                                                  1428 07034000
         LA    @05,16                                              1428 07035000
         ALR   DMPINDEX,@05                                        1428 07036000
*              DMPITMNM = 'CPL';                                   1429 07037000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1429 07038000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1429 07039000
         MVC   DMPITMNM(3,DMPINDEX),@CC01272                       1429 07040000
*              DMPITMPT = ADDR(CATPL);                             1430 07041000
         L     @03,CATPLPTR                                        1430 07042000
         ST    @03,DMPITMPT(,DMPINDEX)                             1430 07043000
*              DMPITMLN = CPLLEN;                                  1431 07044000
         LH    @03,CPLLEN                                          1431 07045000
         STH   @03,DMPITMLN(,DMPINDEX)                             1431 07046000
*              DMPITMTP = 'H';                                     1432 07047000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1432 07048000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1433 07049000
*                                                                  1433 07050000
         ALR   DMPINDEX,@05                                        1433 07051000
*              DMPITMNM = 'FVTPTR';                                1434 07052000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1434 07053000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1434 07054000
         MVC   DMPITMNM(6,DMPINDEX),@CC01273                       1434 07055000
*              DMPITMPT = ADDR(CTGFVT);                            1435 07056000
         LA    @03,CTGFVT(,CTGPLPTR)                               1435 07057000
         ST    @03,DMPITMPT(,DMPINDEX)                             1435 07058000
*              DMPITMLN = 4;                                       1436 07059000
         STH   @06,DMPITMLN(,DMPINDEX)                             1436 07060000
*              DMPITMTP = 'H';                                     1437 07061000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1437 07062000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1438 07063000
*                                                                  1438 07064000
         ALR   DMPINDEX,@05                                        1438 07065000
*              DMPITMNM = 'FVT';                                   1439 07066000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1439 07067000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1439 07068000
         MVC   DMPITMNM(3,DMPINDEX),@CC01274                       1439 07069000
*              DMPITMPT = ADDR(CTGFV);                             1440 07070000
         L     @03,CTGFVT(,CTGPLPTR)                               1440 07071000
         ST    @03,DMPITMPT(,DMPINDEX)                             1440 07072000
*              DMPITMLN = FVTLEN;                                  1441 07073000
         LH    @03,FVTLEN                                          1441 07074000
         STH   @03,DMPITMLN(,DMPINDEX)                             1441 07075000
*              DMPITMTP = 'H';                                     1442 07076000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1442 07077000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1443 07078000
*                                                                  1443 07079000
         ALR   DMPINDEX,@05                                        1443 07080000
*              DMPITMNM = 'DEVTPTR';                               1444 07081000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1444 07082000
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1444 07083000
*              DMPITMPT = ADDR(DEVTFPL);                           1445 07084000
         LA    @03,DEVTFPL                                         1445 07085000
         ST    @03,DMPITMPT(,DMPINDEX)                             1445 07086000
*              DMPITMLN = 4;                                       1446 07087000
         STH   @06,DMPITMLN(,DMPINDEX)                             1446 07088000
*              DMPITMTP = 'H';                                     1447 07089000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1447 07090000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1448 07091000
*                                                                  1448 07092000
         ALR   DMPINDEX,@05                                        1448 07093000
*              DMPITMNM = 'DEVTFPL';                               1449 07094000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1449 07095000
         MVC   DMPITMNM(7,DMPINDEX),@CC01275                       1449 07096000
*              DMPITMPT = ADDR(DEVTFPL->CTGFL);                    1450 07097000
         L     @03,DEVTFPL                                         1450 07098000
         ST    @03,DMPITMPT(,DMPINDEX)                             1450 07099000
*              DMPITMLN = FPLLEN;                                  1451 07100000
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1451 07101000
*              DMPITMTP = 'H';                                     1452 07102000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1452 07103000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1453 07104000
*                                                                  1453 07105000
         ALR   DMPINDEX,@05                                        1453 07106000
*              DMPITMNM = 'FSEQPTR';                               1454 07107000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1454 07108000
         MVC   DMPITMNM(7,DMPINDEX),@CC01276                       1454 07109000
*              DMPITMPT = ADDR(FSEQFPL);                           1455 07110000
         LA    @03,FSEQFPL                                         1455 07111000
         ST    @03,DMPITMPT(,DMPINDEX)                             1455 07112000
*              DMPITMLN = 4;                                       1456 07113000
         STH   @06,DMPITMLN(,DMPINDEX)                             1456 07114000
*              DMPITMTP = 'H';                                     1457 07115000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1457 07116000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1458 07117000
*                                                                  1458 07118000
         ALR   DMPINDEX,@05                                        1458 07119000
*              DMPITMNM = 'FSEQFPL';                               1459 07120000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1459 07121000
         MVC   DMPITMNM(7,DMPINDEX),@CC01277                       1459 07122000
*              DMPITMPT = ADDR(FSEQFPL->CTGFL);                    1460 07123000
         L     @06,FSEQFPL                                         1460 07124000
         ST    @06,DMPITMPT(,DMPINDEX)                             1460 07125000
*              DMPITMLN = FPLLEN;                                  1461 07126000
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1461 07127000
*              DMPITMTP = 'H';                                     1462 07128000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1462 07129000
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1463 07130000
*                                                                  1463 07131000
         ALR   DMPINDEX,@05                                        1463 07132000
*              DMPTRM = DMPTRMVL;                                  1464 07133000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1464 07134000
*            END;                                                  1465 07135000
*                                                                  1465 07136000
*        /************************************************************/ 07137000
*        /*                                                  @Y30SSMK*/ 07138000
*        /*  DUMP POINT TO DUMP CPL, FVT, AND FPLS AFTER     @Y30SSMK*/ 07139000
*        /*  BUILDING THE VSAM PARAMETER LIST TO ALTER A     @Y30SSMK*/ 07140000
*        /*  VSAM CATALOG ENTRY.                             @Y30SSMK*/ 07141000
*        /*                                                  @Y30SSMK*/ 07142000
*        /************************************************************/ 07143000
*                                                                  1466 07144000
*        IF GDTDBG = NULLPTR                                       1466 07145000
*          THEN;                                                   1466 07146000
@RT01420 L     @08,@PC00001                                        1466 07147000
         L     @08,GDTDBG(,@08)                                    1466 07148000
         LTR   @08,@08                                             1466 07149000
         BZ    @RT01466                                            1466 07150000
*          ELSE                                                    1468 07151000
*            CALL IDCDB010(GDTTBL,'CCAC',ADDR(DLISTCPL));          1468 07152000
         L     @08,@PC00001                                        1468 07153000
         ST    @08,@AL00001                                        1468 07154000
         LA    @06,@CC01291                                        1468 07155000
         ST    @06,@AL00001+4                                      1468 07156000
         LA    @06,DLISTCPL                                        1468 07157000
         ST    @06,@AFTEMPS+20                                     1468 07158000
         LA    @06,@AFTEMPS+20                                     1468 07159000
         ST    @06,@AL00001+8                                      1468 07160000
         MVI   @AL00001+8,X'80'                                    1468 07161000
         L     @15,GDTDBG(,@08)                                    1468 07162000
         LA    @01,@AL00001                                        1468 07163000
         BALR  @14,@15                                             1468 07164000
*                                                          /*@YL026UD*/ 07165000
*                                                                  1469 07166000
*        END ALTRLSTS;                                     /*@YL026UD*/ 07167000
@EL00017 DS    0H                                                  1469 07168000
@EF00017 DS    0H                                                  1469 07169000
@ER00017 LM    @14,@06,@SA00017                                    1469 07170000
         LM    @08,@12,@SA00017+36                                 1469 07171000
         BR    @14                                                 1469 07172000
*/********************************************************************/ 07173000
*/*                                                          @Y30SSMK*/ 07174000
*/* PROCEDURE NAME - ERRPROC                                 @Y30SSMK*/ 07175000
*/*                                                          @Y30SSMK*/ 07176000
*/* FUNCTION - TO BUILD THE ERROR CONVERSION TABLE AND       @Y30SSMK*/ 07177000
*/*            INVOKE UERROR TO PRINT THE APPROPRIATE        @Y30SSMK*/ 07178000
*/*            ERROR MESSAGE.                                @Y30SSMK*/ 07179000
*/*                                                          @Y30SSMK*/ 07180000
*/* INPUT - THE REQUIRED STORAGE AREA FOR THE ERROR          @Y30SSMK*/ 07181000
*/*         CONVERSION TABLE AND A FIELD INDICATING THE TYPE @Y30SSMK*/ 07182000
*/*         OF CATALOG OPERATION PERFORMED.                  @Y30SSMK*/ 07183000
*/*                                                          @Y30SSMK*/ 07184000
*/* OUTPUT - APPROPRIATE ERROR MESSAGE PRINTED.              @Y30SSMK*/ 07185000
*/*                                                          @Y30SSMK*/ 07186000
*/********************************************************************/ 07187000
*                                                                  1470 07188000
*ERRPROC: PROCEDURE;                                       /*@Y30SSMK*/ 07189000
ERRPROC  STM   @14,@12,@SA00018                                    1470 07190000
*        /************************************************************/ 07191000
*        /*                                                  @Y30SSMK*/ 07192000
*        /*  BUILD THE ERROR CONVERSION TABLE AND INVOKE     @Y30SSMK*/ 07193000
*        /*  UERROR TO PRINT THE APPROPRIATE ERROR MESSAGE.  @Y30SSMK*/ 07194000
*        /*                                                  @Y30SSMK*/ 07195000
*        /************************************************************/ 07196000
*                                                                  1471 07197000
*        OLDERID2 = NEWERID2;                                      1471 07198000
         L     @08,@PC00001                                        1471 07199000
         L     @08,GDTTR2(,@08)                                    1471 07200000
         MVC   @TS00001(95),NEWERID2(@08)                          1471 07201000
         MVC   OLDERID2(95,@08),@TS00001                           1471 07202000
*        NEWID2 = 'CCER';                                  /*@Y30SSMK*/ 07203000
*                                                                  1472 07204000
         MVC   NEWID2(4,@08),@CC01295                              1472 07205000
*        ERCNVADR = ADDR(ERRORTAB);                        /*@Y30SSMK*/ 07206000
         LA    @08,ERRORTAB                                        1473 07207000
         ST    @08,ERCNVADR                                        1473 07208000
*        ERCNVTAB = ''B;                                   /*@Y30SSMK*/ 07209000
         XC    ERCNVTAB(32,@08),ERCNVTAB(@08)                      1474 07210000
*        ERCATLG = ON;                                     /*@Y30SSMK*/ 07211000
*                                                                  1475 07212000
         OI    ERCATLG(@08),B'10000000'                            1475 07213000
*        /************************************************************/ 07214000
*        /*                                                  @Y30SSMK*/ 07215000
*        /*  SET THE APPROPRIATE FUNCTION TYPE FLAG          @Y30SSMK*/ 07216000
*        /*  DEPENDING ON WHAT CATALOG FUNCTION WAS BEING    @Y30SSMK*/ 07217000
*        /*  EXECUTED. (I.E., DEFINE, LOCATE, OR ALTER)      @Y30SSMK*/ 07218000
*        /*                                                  @Y30SSMK*/ 07219000
*        /************************************************************/ 07220000
*                                                                  1476 07221000
*        IF ERRORTYP = ERRORDE                                     1476 07222000
*          THEN                                                    1476 07223000
         C     ERRORTYP,@CF00215                                   1476 07224000
         BNE   @RF01476                                            1476 07225000
*            ERCATDE = ON;                                 /*@Y30SSMK*/ 07226000
         OI    ERCATDE(@08),B'01000000'                            1477 07227000
*          ELSE                                                    1478 07228000
*            IF ERRORTYP = ERRORLC                                 1478 07229000
*              THEN                                                1478 07230000
         B     @RC01476                                            1478 07231000
@RF01476 C     ERRORTYP,@CF00149                                   1478 07232000
         BNE   @RF01478                                            1478 07233000
*                ERCATLC = ON;                             /*@Y30SSMK*/ 07234000
         L     @08,ERCNVADR                                        1479 07235000
         OI    ERCATLC(@08),B'10000000'                            1479 07236000
*              ELSE                                                1480 07237000
*                ERCATAL = ON;                             /*@Y30SSMK*/ 07238000
         B     @RC01478                                            1480 07239000
@RF01478 L     @08,ERCNVADR                                        1480 07240000
         OI    ERCATAL(@08),B'00010000'                            1480 07241000
*        ERCATRC = TESTRC;                                 /*@Y30SSMK*/ 07242000
@RC01478 DS    0H                                                  1481 07243000
@RC01476 L     @08,ERCNVADR                                        1481 07244000
         ST    TESTRC,ERCATRC(,@08)                                1481 07245000
*        ERCPLPT = CATPLPTR;                               /*@Y30SSMK*/ 07246000
*                                                                  1482 07247000
         L     @04,CATPLPTR                                        1482 07248000
         ST    @04,ERCPLPT(,@08)                                   1482 07249000
*        /************************************************************/ 07250000
*        /*                                                  @Y30SSMK*/ 07251000
*        /*  WHEN A DUPLICATE ENTRY IS ENCOUNTERED, INSERT   @Y30SSMK*/ 07252000
*        /*  THE ENTRY NAME IN THE UERROR PARAMETER LIST.    @Y30SSMK*/ 07253000
*        /*                                                  @Y30SSMK*/ 07254000
*        /************************************************************/ 07255000
*                                                                  1483 07256000
*        IF TESTRC = DUPLCODE                                      1483 07257000
*          THEN                                                    1483 07258000
         C     TESTRC,@CF00175                                     1483 07259000
         BNE   @RF01483                                            1483 07260000
*            ERDSNM = ADDR(DSNAME);                        /*@Y30SSMK*/ 07261000
*                                                                  1484 07262000
         LA    @15,DSNAME                                          1484 07263000
         ST    @15,ERDSNM(,@08)                                    1484 07264000
*        /************************************************************/ 07265000
*        /*                                                  @Y30SSMK*/ 07266000
*        /*  INVOKE UERROR TO PRINT OUT THE APPROPRIATE VSAM @Y30SSMK*/ 07267000
*        /*  CATALOG ERROR MESSAGE.                          @Y30SSMK*/ 07268000
*        /*                                                  @Y30SSMK*/ 07269000
*        /************************************************************/ 07270000
*                                                                  1485 07271000
*        CALL IDCTPER0 (GDTTBL,ERCNVADR);                  /*@Y30SSMK*/ 07272000
*                                                                  1485 07273000
@RF01483 L     @08,@PC00001                                        1485 07274000
         ST    @08,@AL00001                                        1485 07275000
         LA    @15,ERCNVADR                                        1485 07276000
         ST    @15,@AL00001+4                                      1485 07277000
         MVI   @AL00001+4,X'80'                                    1485 07278000
         L     @15,GDTERR(,@08)                                    1485 07279000
         LA    @01,@AL00001                                        1485 07280000
         BALR  @14,@15                                             1485 07281000
*        END ERRPROC;                                      /*@Y30SSMK*/ 07282000
@EL00018 DS    0H                                                  1486 07283000
@EF00018 DS    0H                                                  1486 07284000
@ER00018 LM    @14,@12,@SA00018                                    1486 07285000
         BR    @14                                                 1486 07286000
*        END CATALOG;                                      /*@YL026UD*/ 07287000
*                                                                  1487 07288000
*                                                                  1487 07289000
*        END CONVERT;                                      /*@YL026UD*/ 07290000
*                                                                  1488 07291000
*                                                                  1488 07292000
         B     @EL00002                                            1488 07293000
*        END IDCCC01                                       /*@YL026UD*/ 07294000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07295000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 07296000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 07297000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 07298000
*/*%INCLUDE SYSLIB  (IDCCSCC )                                        * 07299000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 07300000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 07301000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 07302000
*;                                                                 1489 07303000
@DATA    DS    0H                                                       07304000
@CH00042 DC    H'4'                                                     07305000
@CH00152 DC    H'6'                                                     07306000
@CH00847 DC    H'14'                                                    07307000
@CH00583 DC    H'44'                                                    07308000
@CH01047 DC    H'120'                                                   07309000
@SM01319 MVC   0(0,@08),CATENAME(CATPTR)                                07310000
@SM01321 MVC   TRUEDSN(0),TRUENAME                                      07311000
@SM01323 MVC   0(0,@05),0(@07)                                          07312000
@DATD    DSECT                                                          07313000
         DS    0F                                                       07314000
@SA00001 DS    18F                                                      07315000
@PC00001 DS    3F                                                       07316000
@SA00002 DS    15F                                                      07317000
@SA00003 DS    12F                                                      07318000
@SA00004 DS    14F                                                      07319000
@SA00005 DS    13F                                                      07320000
@SA00011 DS    13F                                                      07321000
@SA00006 DS    13F                                                      07322000
@SA00007 DS    12F                                                      07323000
@SA00008 DS    13F                                                      07324000
@SA00009 DS    13F                                                      07325000
@SA00010 DS    13F                                                      07326000
@SA00013 DS    13F                                                      07327000
@SA00012 DS    14F                                                      07328000
@SA00014 DS    14F                                                      07329000
@SA00015 DS    14F                                                      07330000
@SA00018 DS    15F                                                      07331000
@SA00016 DS    15F                                                      07332000
@SA00017 DS    14F                                                      07333000
@AL00001 DS    5A                                                       07334000
@TF00001 DS    F                                                        07335000
@AFTEMPS DS    7F                                                       07336000
IDCCC01  CSECT                                                          07337000
         DS    0F                                                       07338000
@CF00113 DC    F'0'                                                     07339000
@CF00215 DC    F'1'                                                     07340000
@CH00215 EQU   @CF00215+2                                               07341000
@CF00149 DC    F'2'                                                     07342000
@CH00149 EQU   @CF00149+2                                               07343000
@CF00426 DC    F'5'                                                     07344000
@CF00175 DC    F'8'                                                     07345000
@CH00175 EQU   @CF00175+2                                               07346000
@CF00037 DC    F'12'                                                    07347000
@CH00037 EQU   @CF00037+2                                               07348000
@CF00224 DC    F'15'                                                    07349000
@CH00224 EQU   @CF00224+2                                               07350000
@CF00894 DC    F'20'                                                    07351000
@CF01227 DC    F'40'                                                    07352000
@CF00948 DC    F'242'                                                   07353000
@CF00823 DC    F'256'                                                   07354000
@CH00823 EQU   @CF00823+2                                               07355000
@CF01036 DC    F'512'                                                   07356000
@CF01297 DC    F'5632'                                                  07357000
@CF01312 DC    F'-256'                                                  07358000
@CF01326 DC    F'-13'                                                   07359000
@CF01313 DC    F'-12'                                                   07360000
@CF01317 DC    F'-10'                                                   07361000
@CF01325 DC    F'-9'                                                    07362000
@CF01315 DC    F'-6'                                                    07363000
@CF01318 DC    F'-5'                                                    07364000
@CF01314 DC    F'-4'                                                    07365000
@CF01327 DC    F'-3'                                                    07366000
@CF01316 DC    F'-2'                                                    07367000
@CF01151 DC    F'-1'                                                    07368000
@DATD    DSECT                                                          07369000
         DS    0D                                                       07370000
LISTSCAN DS    A                                                        07371000
IOCSPTR  DS    A                                                        07372000
DDSTRU   DS    A                                                        07373000
FSADDR   DS    A                                                        07374000
ERCNVADR DS    A                                                        07375000
CTGFLPTR DS    A                                                        07376000
IIOCSPTR DS    A                                                        07377000
CATPLPTR DS    A                                                        07378000
CATPLLEN DS    F                                                        07379000
DEVTFPL  DS    A                                                        07380000
FSEQFPL  DS    A                                                        07381000
ENTYPFPL DS    A                                                        07382000
CATVLFPL DS    A                                                        07383000
DEVTPTR  DS    A                                                        07384000
VOLPTR   DS    A                                                        07385000
FILEPTR  DS    A                                                        07386000
VINFOPTR DS    A                                                        07387000
VINFOLEN DS    F                                                        07388000
WKAPTR   DS    A                                                        07389000
WKASIZE  DS    F                                                        07390000
BLKLVPTR DS    A                                                        07391000
BLKLVLEN DS    F                                                        07392000
BLOCKPTR DS    A                                                        07393000
CNVTCNT  DS    F                                                        07394000
UPDTCNT  DS    F                                                        07395000
LISTPTR  DS    A                                                        07396000
OIOCSPTR DS    A                                                        07397000
LVLINDEX DS    H                                                        07398000
TRUENLEN DS    H                                                        07399000
CPLLEN   DS    H                                                        07400000
FVTLEN   DS    H                                                        07401000
DEVTLEN  DS    H                                                        07402000
VOLLEN   DS    H                                                        07403000
FILELEN  DS    H                                                        07404000
VOLCNT   DS    H                                                        07405000
BLOCKCNT DS    H                                                        07406000
VCBINDEX DS    H                                                        07407000
SETRC    DS    H                                                        07408000
GDGLIMIT DS    FL1                                                      07409000
GDGATTR  DS    FL1                                                      07410000
LISTLN   DS    FL1                                                      07411000
@TS00001 DS    CL95                                                     07412000
PRNTLIST DS    CL20                                                     07413000
IOPENARG DS    CL44                                                     07414000
LASTMSG  DS    BL1                                                      07415000
DSINFO   DS    CL52                                                     07416000
         ORG   DSINFO                                                   07417000
DSNAME   DS    CL44                                                     07418000
@NM00053 DS    CL8                                                      07419000
         ORG   DSINFO+52                                                07420000
TRUENAME DS    CL8                                                      07421000
TRUEDSN  DS    CL44                                                     07422000
ALIASDSN DS    CL44                                                     07423000
DSCBTTR  DS    CL4                                                      07424000
         DS    CL3                                                      07425000
BLOCKTTR DS    CL4                                                      07426000
SUBTITLE DS    CL120                                                    07427000
PCARGLST DS    CL34                                                     07428000
         ORG   PCARGLST                                                 07429000
PCMTLP   DS    AL4                                                      07430000
PCSTLP   DS    AL4                                                      07431000
PCFLP    DS    AL4                                                      07432000
PCPCP    DS    AL4                                                      07433000
PCPNL    DS    FL2                                                      07434000
PCPTL    DS    FL2                                                      07435000
PCPDL    DS    FL2                                                      07436000
PCMTLC   DS    FL2                                                      07437000
PCSTLC   DS    FL2                                                      07438000
PCFLC    DS    FL2                                                      07439000
PCLW     DS    FL2                                                      07440000
PCPD     DS    FL2                                                      07441000
PCDSC    DS    FL2                                                      07442000
         ORG   PCARGLST+34                                              07443000
CVPEVOL  DS    CL6                                                      07444000
VCBDONE  DS    BL1                                                      07445000
ALIASFLG DS    BL1                                                      07446000
TRUEFLG  DS    BL1                                                      07447000
CVPEFLAG DS    BL1                                                      07448000
ENDFLAG  DS    BL1                                                      07449000
FOUNDFLG DS    BL1                                                      07450000
GDGFLAG  DS    BL1                                                      07451000
G0V0FLAG DS    BL1                                                      07452000
CVPETEXT DS    CL14                                                     07453000
         ORG   CVPETEXT                                                 07454000
CVPTXTNM DS    CL8                                                      07455000
CVPTXTVL DS    CL6                                                      07456000
         ORG   CVPETEXT+14                                              07457000
         DS    CL2                                                      07458000
DLISTBLK DS    CL49                                                     07459000
         DS    CL3                                                      07460000
DLISTVIL DS    CL97                                                     07461000
         DS    CL3                                                      07462000
DLISTCPL DS    CL129                                                    07463000
LOCATFLG DS    BL1                                                      07464000
MATCHFLG DS    BL1                                                      07465000
SCANFLAG DS    BL1                                                      07466000
ERRORTAB DS    CL32                                                     07467000
OOPENARG DS    CL44                                                     07468000
LVLSTACK DS    CL2                                                      07469000
         ORG   LVLSTACK+0                                               07470000
LVLOFSET DS    FL2                                                      07471000
         ORG   LVLSTACK+44                                              07472000
IXNLEN   DS    22H                                                      07473000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07474000
@ENDDATD EQU   *                                                        07475000
IDCCC01  CSECT                                                          07476000
         DS    0F                                                       07477000
@SIZDATD DC    AL1(0)                                                   07478000
         DC    AL3(@ENDDATD-@DATD)                                      07479000
         DS    0D                                                       07480000
@CC01141 DC    C'BLKLEVEL'                                              07481000
@CC01142 DC    C'BLOCKPTR'                                              07482000
@CC01167 DC    C'        '                                              07483000
@CC01212 DC    C'DEVTYP  '                                              07484000
@CC01214 DC    C'FILESEQ '                                              07485000
@CC01216 DC    C'ENTYPE  '                                              07486000
@CC01218 DC    C'CATVOL  '                                              07487000
@CC01241 DC    C'ENTYPPTR'                                              07488000
@CC01242 DC    C'ENTYPLST'                                              07489000
@CC01243 DC    C'CATVLPTR'                                              07490000
@CC01244 DC    C'CATVLLST'                                              07491000
@CC01265 DC    C'DEVTLIST'                                              07492000
@CC01269 DC    C'FILELIST'                                              07493000
@CC01283 DC    C'ENTYPFPL'                                              07494000
@CC01284 DC    C'CATVLFPL'                                              07495000
@CC01264 DC    C'DEVTPTR'                                               07496000
@CC01267 DC    C'VOLLIST'                                               07497000
@CC01268 DC    C'FILEPTR'                                               07498000
@CC01275 DC    C'DEVTFPL'                                               07499000
@CC01276 DC    C'FSEQPTR'                                               07500000
@CC01277 DC    C'FSEQFPL'                                               07501000
@CC01092 DC    C'VOLUME'                                                07502000
@CC01266 DC    C'VOLPTR'                                                07503000
@CC01271 DC    C'CPLPTR'                                                07504000
@CC01273 DC    C'FVTPTR'                                                07505000
@CC01144 EQU   @CC01142                                                 07506000
@CC01207 DC    C'SYS1.'                                                 07507000
@CC00862 DC    C'CC00'                                                  07508000
@CC01103 DC    C'CCCV'                                                  07509000
@CC01130 DC    C'CCSE'                                                  07510000
@CC01131 DC    C'CCSL'                                                  07511000
@CC01135 DC    C'CCCI'                                                  07512000
@CC01136 DC    C'CCIC'                                                  07513000
@CC01140 DC    C'CCVX'                                                  07514000
@CC01145 DC    C'CCVI'                                                  07515000
@CC01146 DC    C'CCVE'                                                  07516000
@CC01150 DC    C'CCAP'                                                  07517000
@CC01155 DC    C'CCIP'                                                  07518000
@CC01165 DC    C'CCDP'                                                  07519000
@CC01171 DC    C'CCVP'                                                  07520000
@CC01178 DC    C'CCGP'                                                  07521000
@CC01182 DC    C'CCCP'                                                  07522000
@CC01190 DC    C'CCPH'                                                  07523000
@CC01191 DC    C'CCPD'                                                  07524000
@CC01192 DC    C'CCIE'                                                  07525000
@CC01196 DC    C'CCCE'                                                  07526000
@CC01197 DC    C'CCCN'                                                  07527000
@CC01201 DC    C'CCPP'                                                  07528000
@CC01202 DC    C'CCPU'                                                  07529000
@CC01234 DC    C'CCCT'                                                  07530000
@CC01237 DC    C'CCLT'                                                  07531000
@CC01245 DC    C'CCLV'                                                  07532000
@CC01252 DC    C'CCAT'                                                  07533000
@CC01257 DC    C'CCDL'                                                  07534000
@CC01270 DC    C'CCDV'                                                  07535000
@CC01278 DC    C'CCDC'                                                  07536000
@CC01282 DC    C'CCLL'                                                  07537000
@CC01285 DC    C'CCLC'                                                  07538000
@CC01289 DC    C'CCAL'                                                  07539000
@CC01290 DC    C'CCAV'                                                  07540000
@CC01291 DC    C'CCAC'                                                  07541000
@CC01295 DC    C'CCER'                                                  07542000
@CC00831 EQU   @CC00862                                                 07543000
@CC00849 DC    C'UV0'                                                   07544000
@CC01272 EQU   @CC01271                                                 07545000
@CC01274 EQU   @CC01273                                                 07546000
ALL      DC    CL3'ALL'                                                 07547000
FORMAT   DC    CL4'FORM'                                                07548000
HSECOND  DC    CL4'HSEC'                                                07549000
CLOCK    DC    CL4'KLOK'                                                07550000
SETZERO  DC    CL4'ZERO'                                                07551000
SETBLANK DC    CL4'BLNK'                                                07552000
NOSET    DC    CL4'NSET'                                                07553000
OVERRIDE DC    CL4'OVRD'                                                07554000
ACQUIRE  DC    CL8'ACQUIRE '                                            07555000
RELINQ   DC    CL8'RELINQ  '                                            07556000
MOUNT    DC    CL8'MOUNT   '                                            07557000
DEMOUNT  DC    CL8'DEMOUNT '                                            07558000
DEFINE   DC    CL8'DEFINE  '                                            07559000
MOVE     DC    CL8'MOVE    '                                            07560000
TRACEQ   DC    CL8'TRACEQ  '                                            07561000
COPYTABL DC    CL8'COPYTABL'                                            07562000
COPYCRTG DC    CL8'COPYCRTG'                                            07563000
COPYVOL  DC    CL8'COPYVOL '                                            07564000
VVIC     DC    CL8'VVIC    '                                            07565000
TUNE     DC    CL8'TUNE    '                                            07566000
NAMES    DC    CL4'NAME'                                                07567000
UNIT     DC    CL4'UNIT'                                                07568000
SHR      DC    CL4'SHR '                                                07569000
EXCL     DC    CL4'EXCL'                                                07570000
NOWAIT   DC    CL4'NWAI'                                                07571000
WAIT     DC    CL4'WAIT'                                                07572000
MODID    DC    CL4'CC01'                                                07573000
FIXAREA  DS    CL512                                                    07574000
         ORG   FIXAREA                                                  07575000
@NM00046 DS    CL256                                                    07576000
         ORG   @NM00046                                                 07577000
@NM00047 DC    256X'00'                                                 07578000
         ORG   FIXAREA+256                                              07579000
@NM00048 DS    CL256                                                    07580000
         ORG   @NM00048                                                 07581000
@NM00049 DC    256X'00'                                                 07582000
         ORG   FIXAREA+512                                              07583000
TYPEAE   DC    X'04'                                                    07584000
TYPEGIPE DC    X'02'                                                    07585000
TYPEICE  DC    X'03'                                                    07586000
TYPEILE  DC    X'00'                                                    07587000
TYPEIPE  DC    X'00'                                                    07588000
TYPEVCBP DC    X'01'                                                    07589000
TYPEVICE DC    X'05'                                                    07590000
FIRSTTTR DC    X'00000100'                                              07591000
ILEENAME DC    X'FFFFFFFFFFFFFFFF'                                      07592000
ZEROTTR  DC    X'000000'                                                07593000
ALLONES  DC    X'FFFFFFFF'                                              07594000
CATZERO  DC    X'0000000000000000'                                      07595000
TYPECVPE DC    X'03'                                                    07596000
         DC    X'05'                                                    07597000
TYPEDSPE DC    X'07'                                                    07598000
         DC    X'0D'                                                    07599000
         DC    X'13'                                                    07600000
         DC    X'19'                                                    07601000
         DC    X'1F'                                                    07602000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07603000
@01      EQU   01                                                       07604000
@02      EQU   02                                                       07605000
@03      EQU   03                                                       07606000
@04      EQU   04                                                       07607000
@05      EQU   05                                                       07608000
@06      EQU   06                                                       07609000
@07      EQU   07                                                       07610000
@08      EQU   08                                                       07611000
@09      EQU   09                                                       07612000
@10      EQU   10                                                       07613000
@11      EQU   11                                                       07614000
@12      EQU   12                                                       07615000
@13      EQU   13                                                       07616000
@14      EQU   14                                                       07617000
@15      EQU   15                                                       07618000
ERRORTYP EQU   @02                                                      07619000
VOLINDX  EQU   @02                                                      07620000
CATVINDX EQU   @03                                                      07621000
VCBVOLIM EQU   @02                                                      07622000
DSPEINDX EQU   @02                                                      07623000
CVEVINDX EQU   @05                                                      07624000
CVENINDX EQU   @02                                                      07625000
INDEX    EQU   @07                                                      07626000
CATVLCNT EQU   @05                                                      07627000
FPLLEN   EQU   @08                                                      07628000
DSNLEN   EQU   @06                                                      07629000
CATPTR   EQU   @03                                                      07630000
CTGPLPTR EQU   @04                                                      07631000
DMPINDEX EQU   @02                                                      07632000
OPNPTR   EQU   @02                                                      07633000
TESTRC   EQU   @05                                                      07634000
RTNREG   EQU   @15                                                      07635000
REG0     EQU   @00                                                      07636000
REG1     EQU   @01                                                      07637000
REG10    EQU   @10                                                      07638000
REG11    EQU   @11                                                      07639000
REG12    EQU   @12                                                      07640000
REG13    EQU   @13                                                      07641000
REG14    EQU   @14                                                      07642000
REG15    EQU   @15                                                      07643000
REG2     EQU   @02                                                      07644000
REG3     EQU   @03                                                      07645000
REG4     EQU   @04                                                      07646000
REG5     EQU   @05                                                      07647000
REG6     EQU   @06                                                      07648000
REG7     EQU   @07                                                      07649000
REG8     EQU   @08                                                      07650000
REG9     EQU   @09                                                      07651000
IDCSAEP0 EQU   0                                                        07652000
IDCSAFS0 EQU   0                                                        07653000
IDCSAGP0 EQU   0                                                        07654000
IDCSAFP0 EQU   0                                                        07655000
IDCSACA0 EQU   0                                                        07656000
TRACE1   EQU   0                                                        07657000
OLDERID1 EQU   TRACE1                                                   07658000
TRACE2   EQU   0                                                        07659000
OLDERID2 EQU   TRACE2                                                   07660000
NEWID2   EQU   TRACE2+95                                                07661000
NEWERID2 EQU   5                                                        07662000
CIRAGL   EQU   0                                                        07663000
CIRTYPE  EQU   CIRAGL                                                   07664000
ALLAGL   EQU   0                                                        07665000
ALLSTS   EQU   ALLAGL+24                                                07666000
ALLDSP   EQU   ALLAGL+25                                                07667000
ALLORG   EQU   ALLAGL+26                                                07668000
ALLOPT   EQU   ALLAGL+28                                                07669000
UNITABL  EQU   0                                                        07670000
UNITADR  EQU   UNITABL+4                                                07671000
@NM00010 EQU   UNITADR                                                  07672000
UNITSTAT EQU   UNITABL+6                                                07673000
IDCIOOP0 EQU   0                                                        07674000
IDCIOCL0 EQU   0                                                        07675000
IDCIOPO0 EQU   0                                                        07676000
IDCIOGT0 EQU   0                                                        07677000
IOCSTR   EQU   0                                                        07678000
IOCDAD   EQU   IOCSTR                                                   07679000
IOCDSO   EQU   IOCSTR+16                                                07680000
IOCRFM   EQU   IOCSTR+17                                                07681000
IOCMAC   EQU   IOCSTR+18                                                07682000
IOCMAC2  EQU   IOCSTR+19                                                07683000
IOCCHP   EQU   IOCSTR+20                                                07684000
IOCMSG   EQU   IOCSTR+21                                                07685000
IOCRBA   EQU   IOCSTR+40                                                07686000
IOCTTR   EQU   IOCRBA                                                   07687000
IOCMEM   EQU   IOCSTR+44                                                07688000
IOCNWM   EQU   IOCSTR+48                                                07689000
OPNAGL   EQU   0                                                        07690000
OPNOPT   EQU   OPNAGL                                                   07691000
OPNOPTIN EQU   OPNOPT                                                   07692000
OPNOPTBK EQU   OPNOPT                                                   07693000
OPNRFM   EQU   OPNAGL+1                                                 07694000
OPNRFMFX EQU   OPNRFM                                                   07695000
OPNRFMBK EQU   OPNRFM                                                   07696000
OPNTYP   EQU   OPNAGL+2                                                 07697000
OPNMOD   EQU   OPNAGL+3                                                 07698000
OPNIOC   EQU   OPNAGL+4                                                 07699000
OPNDDN   EQU   OPNAGL+8                                                 07700000
OPNDSN   EQU   OPNAGL+16                                                07701000
OPNDEV   EQU   OPNAGL+24                                                07702000
OPNBLK   EQU   OPNAGL+36                                                07703000
OPNDSO   EQU   OPNAGL+41                                                07704000
OPNDSOPS EQU   OPNDSO                                                   07705000
OPNOPT2  EQU   OPNAGL+42                                                07706000
IOINFOPT EQU   0                                                        07707000
UVOLLIST EQU   0                                                        07708000
UVOLENT  EQU   UVOLLIST+2                                               07709000
AMSTP011 EQU   0                                                        07710000
AMSTP042 EQU   0                                                        07711000
IDCTPER0 EQU   0                                                        07712000
DARGLIST EQU   0                                                        07713000
DARGDBP  EQU   DARGLIST                                                 07714000
DARGRETP EQU   DARGLIST+4                                               07715000
DARGSTID EQU   DARGLIST+8                                               07716000
DARGSMOD EQU   DARGSTID                                                 07717000
DARGSENT EQU   DARGSTID+3                                               07718000
DARGILP  EQU   DARGLIST+12                                              07719000
DARGRETL EQU   DARGLIST+16                                              07720000
DARGARY  EQU   DARGLIST+20                                              07721000
DARGINS  EQU   DARGARY                                                  07722000
DARGINL  EQU   DARGARY+2                                                07723000
FMTLIST  EQU   0                                                        07724000
FMTFLGS  EQU   FMTLIST                                                  07725000
FMTSPF   EQU   FMTLIST+2                                                07726000
FMTRFNO  EQU   FMTSPF                                                   07727000
FMTILEN  EQU   FMTRFNO                                                  07728000
FMTIOFF  EQU   FMTLIST+4                                                07729000
FMTTRBC  EQU   FMTIOFF                                                  07730000
FMTSTO   EQU   FMTTRBC                                                  07731000
FMTOCOL  EQU   FMTLIST+6                                                07732000
FMTCNVF  EQU   FMTLIST+10                                               07733000
ERCNVTAB EQU   0                                                        07734000
ERTYPE   EQU   ERCNVTAB                                                 07735000
ERCATLG  EQU   ERTYPE                                                   07736000
EROPER   EQU   ERCNVTAB+1                                               07737000
ERCATLC  EQU   EROPER                                                   07738000
ERCATDE  EQU   EROPER                                                   07739000
ERCATAL  EQU   EROPER                                                   07740000
ERDSNM   EQU   ERCNVTAB+12                                              07741000
ERCATRC  EQU   ERCNVTAB+16                                              07742000
ERCPLPT  EQU   ERCNVTAB+20                                              07743000
IDCDB010 EQU   0                                                        07744000
DMPITM   EQU   0                                                        07745000
DMPITMNM EQU   DMPITM                                                   07746000
DMPITMPT EQU   DMPITM+8                                                 07747000
DMPITMLN EQU   DMPITM+12                                                07748000
DMPITMTP EQU   DMPITM+14                                                07749000
DMPARY   EQU   0                                                        07750000
DMPTRM   EQU   0                                                        07751000
IFILE    EQU   0                                                        07752000
IFILEVAL EQU   IFILE+1                                                  07753000
IDS      EQU   0                                                        07754000
IDSFLG   EQU   IDS+10                                                   07755000
IDSVAL   EQU   IDS+21                                                   07756000
CAT      EQU   0                                                        07757000
CATNM    EQU   0                                                        07758000
CATNMPLN EQU   CATNM                                                    07759000
CATNMPAS EQU   CATNM+1                                                  07760000
CATNMFLG EQU   CATNM+10                                                 07761000
CATNMVAL EQU   CATNM+21                                                 07762000
CATDN    EQU   0                                                        07763000
CVEQU    EQU   0                                                        07764000
CVEQUCNT EQU   0                                                        07765000
CVECNPTR EQU   0                                                        07766000
CVECN    EQU   0                                                        07767000
CVECNFLG EQU   CVECN+10                                                 07768000
CVECNVAL EQU   CVECN+21                                                 07769000
CVEVSPTR EQU   0                                                        07770000
CVEVS    EQU   0                                                        07771000
CVEVSCNT EQU   CVEVS                                                    07772000
@NM00037 EQU   CVEVS+2                                                  07773000
CVEVSVAL EQU   @NM00037+1                                               07774000
MRCAT    EQU   0                                                        07775000
MRCATPLN EQU   MRCAT                                                    07776000
MRCATPAS EQU   MRCAT+1                                                  07777000
MRCATFLG EQU   MRCAT+10                                                 07778000
MRCATVAL EQU   MRCAT+21                                                 07779000
LIST     EQU   0                                                        07780000
CTGPL    EQU   0                                                        07781000
CTGOPTN1 EQU   CTGPL                                                    07782000
CTGNAME  EQU   CTGOPTN1                                                 07783000
CTGCNAME EQU   CTGOPTN1                                                 07784000
CTGOPTN2 EQU   CTGPL+1                                                  07785000
CTGEXT   EQU   CTGOPTN2                                                 07786000
CTGERASE EQU   CTGOPTN2                                                 07787000
CTGSMF   EQU   CTGERASE                                                 07788000
CTGREL   EQU   CTGSMF                                                   07789000
CTGPURG  EQU   CTGOPTN2                                                 07790000
CTGVMNT  EQU   CTGPURG                                                  07791000
CTGOPTN3 EQU   CTGPL+2                                                  07792000
CTGFUNC  EQU   CTGOPTN3                                                 07793000
CTGAM0   EQU   CTGOPTN3                                                 07794000
CTGOPTN4 EQU   CTGPL+3                                                  07795000
CTGENT   EQU   CTGPL+4                                                  07796000
CTGFVT   EQU   CTGENT                                                   07797000
CTGCAT   EQU   CTGPL+8                                                  07798000
CTGWKA   EQU   CTGPL+12                                                 07799000
CTGDSORG EQU   CTGPL+16                                                 07800000
CTGOPTNS EQU   CTGDSORG                                                 07801000
CTGNOFLD EQU   CTGPL+19                                                 07802000
CTGDDNM  EQU   CTGPL+20                                                 07803000
CTGNEWNM EQU   CTGDDNM                                                  07804000
CTGFBFLG EQU   CTGNEWNM+2                                               07805000
CTGJSCB  EQU   CTGPL+24                                                 07806000
CTGPSWD  EQU   CTGJSCB                                                  07807000
CTGFIELD EQU   CTGPL+28                                                 07808000
CTGFV    EQU   0                                                        07809000
CTGFVTYP EQU   CTGFV                                                    07810000
CTGFVPRO EQU   CTGFV+1                                                  07811000
CTGFVNDC EQU   CTGFVPRO                                                 07812000
CTGFVENT EQU   CTGFV+20                                                 07813000
CTGFVVLT EQU   CTGFV+40                                                 07814000
CTGFVDVT EQU   CTGFV+48                                                 07815000
CTGFVSPC EQU   CTGFV+52                                                 07816000
CTGFVTTR EQU   CTGFVSPC                                                 07817000
CTGFVAMD EQU   CTGFV+56                                                 07818000
CTGFVFSN EQU   CTGFVAMD                                                 07819000
CTGFVLMT EQU   CTGFV+72                                                 07820000
CTGFVGAT EQU   CTGFV+76                                                 07821000
CTGFVNAM EQU   CTGFV+80                                                 07822000
CTGFL    EQU   0                                                        07823000
CTGFLDNO EQU   CTGFL                                                    07824000
CTGFLDRE EQU   CTGFL+3                                                  07825000
CTGFLDNM EQU   CTGFL+8                                                  07826000
CTGFLDAT EQU   CTGFL+16                                                 07827000
CTGFLNG  EQU   CTGFLDAT                                                 07828000
CTGFLPT  EQU   CTGFLDAT+4                                               07829000
CATFORM  EQU   0                                                        07830000
CATENAME EQU   CATFORM                                                  07831000
CATETTR  EQU   CATFORM+8                                                07832000
CATETYPE EQU   CATFORM+11                                               07833000
AEFORM   EQU   0                                                        07834000
AETRUEN  EQU   AEFORM+12                                                07835000
CVP1FORM EQU   0                                                        07836000
CVP1VOL  EQU   CVP1FORM+12                                              07837000
CVP2FORM EQU   0                                                        07838000
CVP2VOL  EQU   CVP2FORM+16                                              07839000
DSPEFORM EQU   0                                                        07840000
DSPENAME EQU   DSPEFORM                                                 07841000
DSPETTR  EQU   DSPEFORM+8                                               07842000
DSPETYPE EQU   DSPEFORM+11                                              07843000
DSPEVCNT EQU   DSPEFORM+12                                              07844000
DSPEDATA EQU   DSPEFORM+14                                              07845000
DSPEDEVT EQU   DSPEDATA                                                 07846000
DSPEDVOL EQU   DSPEDATA+4                                               07847000
DSPEDSEQ EQU   DSPEDATA+10                                              07848000
GIPEFORM EQU   0                                                        07849000
GIPENAME EQU   GIPEFORM                                                 07850000
GIPETYPE EQU   GIPEFORM+11                                              07851000
GIPEFLGS EQU   GIPEFORM+12                                              07852000
GIPEFDEL EQU   GIPEFLGS                                                 07853000
GIPEFEMP EQU   GIPEFLGS                                                 07854000
GIPEMCNT EQU   GIPEFORM+13                                              07855000
ICEFORM  EQU   0                                                        07856000
ILEFORM  EQU   0                                                        07857000
ILETTR   EQU   ILEFORM+8                                                07858000
IPEFORM  EQU   0                                                        07859000
VCBFORM1 EQU   0                                                        07860000
VCBVOLCT EQU   VCBFORM1                                                 07861000
VCBVOLS  EQU   VCBFORM1+2                                               07862000
VCBDEVT  EQU   VCBVOLS                                                  07863000
VCBDVOL  EQU   VCBVOLS+4                                                07864000
VCBDSEQ  EQU   VCBVOLS+10                                               07865000
VCBFORM2 EQU   0                                                        07866000
VCBTTR   EQU   VCBFORM2+10                                              07867000
VCBPFORM EQU   0                                                        07868000
VCBPNAME EQU   VCBPFORM                                                 07869000
VCBPTTR  EQU   VCBPFORM+8                                               07870000
VCBPTYPE EQU   VCBPFORM+11                                              07871000
VICEFORM EQU   0                                                        07872000
CATPL    EQU   0                                                        07873000
DEVTLIST EQU   0                                                        07874000
DEVTUNIT EQU   DEVTLIST                                                 07875000
DEVTCODE EQU   DEVTLIST+8                                               07876000
VOLLIST  EQU   0                                                        07877000
VOLSTLEN EQU   VOLLIST                                                  07878000
VOLSERS  EQU   VOLLIST+2                                                07879000
VOLZERO  EQU   VOLSERS                                                  07880000
VOLSER   EQU   VOLSERS+2                                                07881000
FILELIST EQU   0                                                        07882000
FILESEQ  EQU   FILELIST                                                 07883000
ENTYPE   EQU   0                                                        07884000
CATVLIST EQU   0                                                        07885000
CVDEVTYP EQU   CATVLIST+2                                               07886000
CVVOLSER EQU   CATVLIST+6                                               07887000
CVFSEQ   EQU   CATVLIST+12                                              07888000
WKAREA   EQU   0                                                        07889000
WKALEN   EQU   WKAREA                                                   07890000
WKAREQD  EQU   WKAREA+2                                                 07891000
BLOCK    EQU   0                                                        07892000
BLKREAD  EQU   0                                                        07893000
LOCINFO  EQU   0                                                        07894000
AMSTP041 EQU   0                                                        07895000
AMSTP043 EQU   0                                                        07896000
AMSTP044 EQU   0                                                        07897000
IDCIOCO0 EQU   0                                                        07898000
IDCIOIT0 EQU   0                                                        07899000
IDCIOPT0 EQU   0                                                        07900000
IDCIOSI0 EQU   0                                                        07901000
IDCIOST0 EQU   0                                                        07902000
IDCIOTM0 EQU   0                                                        07903000
IDCIOVY0 EQU   0                                                        07904000
IDCIO050 EQU   0                                                        07905000
IDCSAAL0 EQU   0                                                        07906000
IDCSACL0 EQU   0                                                        07907000
IDCSACR0 EQU   0                                                        07908000
IDCSADE0 EQU   0                                                        07909000
IDCSADL0 EQU   0                                                        07910000
IDCSADQ0 EQU   0                                                        07911000
IDCSAGS0 EQU   0                                                        07912000
IDCSAID0 EQU   0                                                        07913000
IDCSALD0 EQU   0                                                        07914000
IDCSALK0 EQU   0                                                        07915000
IDCSANQ0 EQU   0                                                        07916000
IDCSAPR0 EQU   0                                                        07917000
IDCSAPT0 EQU   0                                                        07918000
IDCSAQL0 EQU   0                                                        07919000
IDCSARC0 EQU   0                                                        07920000
IDCSARV0 EQU   0                                                        07921000
IDCSASC0 EQU   0                                                        07922000
IDCSASI0 EQU   0                                                        07923000
IDCSASN0 EQU   0                                                        07924000
IDCSASS0 EQU   0                                                        07925000
IDCSAST0 EQU   0                                                        07926000
IDCSATI0 EQU   0                                                        07927000
IDCSAWO0 EQU   0                                                        07928000
IDCSA060 EQU   0                                                        07929000
IDCST010 EQU   0                                                        07930000
LISTTEST EQU   0                                                        07931000
NEWERID1 EQU   5                                                        07932000
NLIST    EQU   0                                                        07933000
GDTTBL   EQU   0                                                        07934000
GDTTR1   EQU   GDTTBL+8                                                 07935000
GDTTR2   EQU   GDTTBL+12                                                07936000
GDTDBG   EQU   GDTTBL+40                                                07937000
GDTSTC   EQU   GDTTBL+44                                                07938000
GDTPRT   EQU   GDTTBL+48                                                07939000
GDTESS   EQU   GDTTBL+52                                                07940000
GDTESA   EQU   GDTTBL+56                                                07941000
GDTRST   EQU   GDTTBL+60                                                07942000
GDTRES   EQU   GDTTBL+64                                                07943000
GDTCAL   EQU   GDTTBL+68                                                07944000
GDTGSP   EQU   GDTTBL+72                                                07945000
GDTFSP   EQU   GDTTBL+76                                                07946000
GDTGPL   EQU   GDTTBL+80                                                07947000
GDTFPL   EQU   GDTTBL+84                                                07948000
GDTLOD   EQU   GDTTBL+88                                                07949000
GDTDEL   EQU   GDTTBL+92                                                07950000
GDTPRL   EQU   GDTTBL+96                                                07951000
GDTEPL   EQU   GDTTBL+100                                               07952000
GDTTIM   EQU   GDTTBL+104                                               07953000
GDTIIO   EQU   GDTTBL+108                                               07954000
GDTTIO   EQU   GDTTBL+112                                               07955000
GDTOPN   EQU   GDTTBL+124                                               07956000
GDTCLS   EQU   GDTTBL+128                                               07957000
GDTGET   EQU   GDTTBL+132                                               07958000
GDTPUT   EQU   GDTTBL+136                                               07959000
GDTPOS   EQU   GDTTBL+140                                               07960000
GDTCPY   EQU   GDTTBL+144                                               07961000
GDTCAT   EQU   GDTTBL+148                                               07962000
GDTSNP   EQU   GDTTBL+164                                               07963000
GDTVFY   EQU   GDTTBL+172                                               07964000
GDTECT   EQU   GDTTBL+188                                               07965000
GDTUID   EQU   GDTTBL+192                                               07966000
GDTPMT   EQU   GDTTBL+196                                               07967000
GDTCIR   EQU   GDTTBL+200                                               07968000
GDTLNK   EQU   GDTTBL+204                                               07969000
GDTALC   EQU   GDTTBL+208                                               07970000
GDTDLC   EQU   GDTTBL+212                                               07971000
GDTQAL   EQU   GDTTBL+216                                               07972000
GDTSTW   EQU   GDTTBL+220                                               07973000
GDTSSC   EQU   GDTTBL+224                                               07974000
GDTENQ   EQU   GDTTBL+228                                               07975000
GDTRSV   EQU   GDTTBL+232                                               07976000
GDTDEQ   EQU   GDTTBL+236                                               07977000
GDTSFO   EQU   GDTTBL+240                                               07978000
GDTWTO   EQU   GDTTBL+244                                               07979000
GDTSCR   EQU   GDTTBL+248                                               07980000
GDTUNT   EQU   GDTTBL+252                                               07981000
GDTRCT   EQU   GDTTBL+256                                               07982000
GDTIFO   EQU   GDTTBL+260                                               07983000
GDTEXP   EQU   GDTTBL+264                                               07984000
GDTSTA   EQU   GDTTBL+268                                               07985000
GDTERR   EQU   GDTTBL+272                                               07986000
FDTTBL   EQU   0                                                        07987000
FDTPTR   EQU   FDTTBL+8                                                 07988000
LASTCOND EQU   0                                                        07989000
@NM00042 EQU   CTGDDNM                                                  07990000
CTGPROB  EQU   @NM00042                                                 07991000
CTGREASN EQU   CTGPROB+2                                                07992000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07993000
CTGREAS2 EQU   CTGREASN+1                                               07994000
CTGREAS1 EQU   CTGREASN                                                 07995000
CTGMODID EQU   CTGPROB                                                  07996000
FDTVERB  EQU   FDTTBL                                                   07997000
GDTPSB   EQU   GDTTBL+184                                               07998000
GDTUPT   EQU   GDTTBL+180                                               07999000
GDTCMB   EQU   GDTTBL+176                                               08000000
GDTSPR   EQU   GDTTBL+168                                               08001000
@NM00001 EQU   GDTTBL+160                                               08002000
GDTABH   EQU   GDTTBL+156                                               08003000
GDTABT   EQU   GDTTBL+152                                               08004000
GDTTOH   EQU   GDTTBL+120                                               08005000
GDTRIP   EQU   GDTTBL+116                                               08006000
GDTIOH   EQU   GDTTBL+36                                                08007000
GDTSAH   EQU   GDTTBL+32                                                08008000
GDTTPH   EQU   GDTTBL+28                                                08009000
GDTRIH   EQU   GDTTBL+24                                                08010000
GDTSTH   EQU   GDTTBL+20                                                08011000
GDTDBH   EQU   GDTTBL+16                                                08012000
GDTPRM   EQU   GDTTBL+4                                                 08013000
GDTHDR   EQU   GDTTBL                                                   08014000
WKADATA  EQU   WKAREA+4                                                 08015000
CVVOLFLG EQU   CATVLIST+14                                              08016000
CVRELREP EQU   CATVLIST                                                 08017000
@NM00052 EQU   VICEFORM+20                                              08018000
VICEZRO2 EQU   VICEFORM+19                                              08019000
VICEHOLE EQU   VICEFORM+16                                              08020000
VICEZRO1 EQU   VICEFORM+15                                              08021000
VICECBLK EQU   VICEFORM+12                                              08022000
VICETYPE EQU   VICEFORM+11                                              08023000
VICELBLK EQU   VICEFORM+8                                               08024000
VICENAME EQU   VICEFORM                                                 08025000
VCBPZERO EQU   VCBPFORM+12                                              08026000
VCBZERO2 EQU   VCBFORM2+13                                              08027000
VCBZERO1 EQU   VCBFORM2                                                 08028000
IPETYPE  EQU   IPEFORM+11                                               08029000
IPETTR   EQU   IPEFORM+8                                                08030000
IPENAME  EQU   IPEFORM                                                  08031000
ILETYPE  EQU   ILEFORM+11                                               08032000
ILENAME  EQU   ILEFORM                                                  08033000
@NM00051 EQU   ICEFORM+16                                               08034000
ICEACNT  EQU   ICEFORM+15                                               08035000
ICEFBLK  EQU   ICEFORM+12                                               08036000
ICETYPE  EQU   ICEFORM+11                                               08037000
ICELBLK  EQU   ICEFORM+8                                                08038000
ICENAME  EQU   ICEFORM                                                  08039000
GIPECCNT EQU   GIPEFORM+14                                              08040000
@NM00050 EQU   GIPEFLGS                                                 08041000
GIPETTR  EQU   GIPEFORM+8                                               08042000
CVP2VTYP EQU   CVP2FORM+12                                              08043000
CVP2TYPE EQU   CVP2FORM+11                                              08044000
CVP2TTR  EQU   CVP2FORM+8                                               08045000
CVP2NAME EQU   CVP2FORM                                                 08046000
CVP1TYPE EQU   CVP1FORM+11                                              08047000
CVP1TTR  EQU   CVP1FORM+8                                               08048000
CVP1NAME EQU   CVP1FORM                                                 08049000
AETYPE   EQU   AEFORM+11                                                08050000
AETTR    EQU   AEFORM+8                                                 08051000
AENAME   EQU   AEFORM                                                   08052000
CTGFLCHN EQU   CTGFL+12                                                 08053000
CTGFLDWA EQU   CTGFL+4                                                  08054000
CTGFLDTS EQU   CTGFLDRE                                                 08055000
@NM00045 EQU   CTGFLDRE                                                 08056000
CTGFLDGC EQU   CTGFL+2                                                  08057000
CTGFLDCD EQU   CTGFL+1                                                  08058000
CTGFVWKA EQU   CTGFV+88                                                 08059000
CTGFVPWD EQU   CTGFV+84                                                 08060000
CTGFVUPG EQU   CTGFVGAT                                                 08061000
CTGFVEXT EQU   CTGFVLMT                                                 08062000
CTGFVLRS EQU   CTGFV+68                                                 08063000
CTGFVBUF EQU   CTGFV+64                                                 08064000
CTGFVATR EQU   CTGFV+60                                                 08065000
CTGFVRNG EQU   CTGFV+44                                                 08066000
CTGFVCRE EQU   CTGFV+36                                                 08067000
CTGFVEXP EQU   CTGFV+32                                                 08068000
CTGFVOWN EQU   CTGFV+28                                                 08069000
CTGFVSTY EQU   CTGFV+24                                                 08070000
CTGFVIND EQU   CTGFV+16                                                 08071000
CTGFVVCH EQU   CTGFV+12                                                 08072000
CTGFVICH EQU   CTGFV+8                                                  08073000
CTGFVDCH EQU   CTGFV+4                                                  08074000
@NM00044 EQU   CTGFV+3                                                  08075000
CTGFVELM EQU   CTGFV+2                                                  08076000
@NM00043 EQU   CTGFVPRO                                                 08077000
CTGFVDRC EQU   CTGFVPRO                                                 08078000
CTGFVRVL EQU   CTGFVPRO                                                 08079000
CTGFVAVL EQU   CTGFVPRO                                                 08080000
@NM00041 EQU   CTGFBFLG                                                 08081000
CTGNGDSN EQU   CTGFBFLG                                                 08082000
CTGGDGB  EQU   CTGFBFLG                                                 08083000
CTGKEEP  EQU   CTGFBFLG                                                 08084000
CTGPAR   EQU   CTGFBFLG                                                 08085000
CTGFDBK  EQU   CTGNEWNM                                                 08086000
CTGTYPE  EQU   CTGPL+18                                                 08087000
@NM00040 EQU   CTGDSORG                                                 08088000
CTGCVOL  EQU   CTGCAT                                                   08089000
@NM00039 EQU   CTGOPTN4                                                 08090000
CTGDOCAT EQU   CTGOPTN4                                                 08091000
CTGLBASE EQU   CTGOPTN4                                                 08092000
CTGNUM   EQU   CTGOPTN3                                                 08093000
CTGSRH   EQU   CTGOPTN3                                                 08094000
CTGGDGL  EQU   CTGOPTN3                                                 08095000
CTGSUPLT EQU   CTGOPTN3                                                 08096000
@NM00038 EQU   CTGOPTN2                                                 08097000
CTGSCR   EQU   CTGOPTN2                                                 08098000
CTGOVRID EQU   CTGOPTN2                                                 08099000
CTGDISC  EQU   CTGOPTN2                                                 08100000
CTGGTNXT EQU   CTGOPTN2                                                 08101000
CTGRCATN EQU   CTGVMNT                                                  08102000
CTGGTALL EQU   CTGREL                                                   08103000
CTGNSVS  EQU   CTGEXT                                                   08104000
CTGGENLD EQU   CTGOPTN1                                                 08105000
CTGREAD  EQU   CTGOPTN1                                                 08106000
CTGUPD   EQU   CTGOPTN1                                                 08107000
CTGCI    EQU   CTGOPTN1                                                 08108000
CTGMAST  EQU   CTGOPTN1                                                 08109000
CTGBYPSS EQU   CTGOPTN1                                                 08110000
MRCATLEN EQU   MRCAT+20                                                 08111000
MRCATMEM EQU   MRCAT+12                                                 08112000
MRCATMLN EQU   MRCAT+11                                                 08113000
MRCATFUQ EQU   MRCATFLG                                                 08114000
MRCATPOS EQU   MRCAT+9                                                  08115000
CVEVSLEN EQU   @NM00037                                                 08116000
CVECNLEN EQU   CVECN+20                                                 08117000
CVECNMEM EQU   CVECN+12                                                 08118000
CVECNMLN EQU   CVECN+11                                                 08119000
CVECNFUQ EQU   CVECNFLG                                                 08120000
CVECNPOS EQU   CVECN+9                                                  08121000
CVECNPAS EQU   CVECN+1                                                  08122000
CVECNPLN EQU   CVECN                                                    08123000
CATDNVAL EQU   CATDN+1                                                  08124000
CATDNLEN EQU   CATDN                                                    08125000
CATNMLEN EQU   CATNM+20                                                 08126000
CATNMMEM EQU   CATNM+12                                                 08127000
CATNMMLN EQU   CATNM+11                                                 08128000
CATNMFUQ EQU   CATNMFLG                                                 08129000
CATNMPOS EQU   CATNM+9                                                  08130000
IDSLEN   EQU   IDS+20                                                   08131000
IDSMEM   EQU   IDS+12                                                   08132000
IDSMLN   EQU   IDS+11                                                   08133000
IDSFUQ   EQU   IDSFLG                                                   08134000
IDSPOS   EQU   IDS+9                                                    08135000
IDSPAS   EQU   IDS+1                                                    08136000
IDSPLN   EQU   IDS                                                      08137000
IFILELEN EQU   IFILE                                                    08138000
@NM00036 EQU   DMPARY+15                                                08139000
DMPARYTP EQU   DMPARY+14                                                08140000
DMPARYEX EQU   DMPARY+12                                                08141000
DMPARYIC EQU   DMPARY+10                                                08142000
DMPARYSZ EQU   DMPARY+8                                                 08143000
DMPARYNM EQU   DMPARY                                                   08144000
@NM00035 EQU   DMPITM+15                                                08145000
@NM00034 EQU   ERCNVTAB+24                                              08146000
@NM00033 EQU   ERCNVTAB+4                                               08147000
@NM00032 EQU   ERCNVTAB+2                                               08148000
@NM00031 EQU   EROPER                                                   08149000
ERCATDL  EQU   EROPER                                                   08150000
@NM00030 EQU   ERTYPE                                                   08151000
@NM00029 EQU   FMTCNVF+1                                                08152000
FMTBS    EQU   FMTCNVF+1                                                08153000
FMTSS    EQU   FMTCNVF+1                                                08154000
FMTAL    EQU   FMTCNVF+1                                                08155000
FMTZS    EQU   FMTCNVF+1                                                08156000
@NM00028 EQU   FMTCNVF                                                  08157000
FMTPU    EQU   FMTCNVF                                                  08158000
FMTBD    EQU   FMTCNVF                                                  08159000
FMTBHD   EQU   FMTCNVF                                                  08160000
FMTBHA   EQU   FMTCNVF                                                  08161000
FMTBH    EQU   FMTCNVF                                                  08162000
FMTOLEN  EQU   FMTLIST+8                                                08163000
FMTRIO   EQU   FMTOCOL                                                  08164000
FMTSPT   EQU   FMTSTO                                                   08165000
FMTSTL   EQU   FMTILEN                                                  08166000
@NM00027 EQU   FMTFLGS+1                                                08167000
FMTHDF   EQU   FMTFLGS                                                  08168000
FMTDFF   EQU   FMTFLGS                                                  08169000
FMTSTF   EQU   FMTFLGS                                                  08170000
FMTREPF  EQU   FMTFLGS                                                  08171000
FMTBDF   EQU   FMTFLGS                                                  08172000
FMTIDF   EQU   FMTFLGS                                                  08173000
FMTSCF   EQU   FMTFLGS                                                  08174000
FMTEOLF  EQU   FMTFLGS                                                  08175000
DARGDTM  EQU   DARGARY+4                                                08176000
DARGPCT  EQU   DARGINL                                                  08177000
DARGREP  EQU   DARGINS                                                  08178000
@NM00026 EQU   DARGLIST+19                                              08179000
DARGIND  EQU   DARGLIST+18                                              08180000
DARGCNT  EQU   DARGLIST+14                                              08181000
UVOLVOL  EQU   UVOLENT+4                                                08182000
UVOLDEV  EQU   UVOLENT                                                  08183000
UVOLCNT  EQU   UVOLLIST                                                 08184000
@NM00025 EQU   IOINFOPT                                                 08185000
IOINFTMS EQU   IOINFOPT                                                 08186000
IOINFSUP EQU   IOINFOPT                                                 08187000
IOINFDSN EQU   IOINFOPT                                                 08188000
IOINFVOL EQU   IOINFOPT                                                 08189000
IOINFDVT EQU   IOINFOPT                                                 08190000
OPNVOL   EQU   OPNAGL+44                                                08191000
@NM00024 EQU   OPNAGL+43                                                08192000
@NM00023 EQU   OPNOPT2                                                  08193000
OPNOPTJM EQU   OPNOPT2                                                  08194000
@NM00022 EQU   OPNOPT2                                                  08195000
OPNOPTAS EQU   OPNOPT2                                                  08196000
@NM00021 EQU   OPNDSO                                                   08197000
OPNDSOPO EQU   OPNDSO                                                   08198000
OPNDSOIS EQU   OPNDSO                                                   08199000
OPNDSOAM EQU   OPNDSO                                                   08200000
OPNKYL   EQU   OPNAGL+40                                                08201000
OPNREC   EQU   OPNAGL+32                                                08202000
OPNDEVIX EQU   OPNDEV+4                                                 08203000
OPNDEVDT EQU   OPNDEV                                                   08204000
OPNCBP   EQU   OPNAGL+20                                                08205000
OPNPWA   EQU   OPNAGL+12                                                08206000
OPNMODRP EQU   OPNMOD                                                   08207000
OPNMODUB EQU   OPNMOD                                                   08208000
OPNMODRS EQU   OPNMOD                                                   08209000
OPNMODAX EQU   OPNMOD                                                   08210000
OPNMODRR EQU   OPNMOD                                                   08211000
OPNMODRC EQU   OPNMOD                                                   08212000
OPNMODAC EQU   OPNMOD                                                   08213000
OPNMODPD EQU   OPNMOD                                                   08214000
@NM00020 EQU   OPNTYP                                                   08215000
OPNTYPRV EQU   OPNTYP                                                   08216000
OPNTYPEX EQU   OPNTYP                                                   08217000
OPNTYPRA EQU   OPNTYP                                                   08218000
OPNTYPXM EQU   OPNTYP                                                   08219000
OPNTYPCI EQU   OPNTYP                                                   08220000
OPNTYPSO EQU   OPNTYP                                                   08221000
OPNTYPSI EQU   OPNTYP                                                   08222000
@NM00019 EQU   OPNRFM                                                   08223000
OPNRFMSF EQU   OPNRFM                                                   08224000
OPNRFMUN EQU   OPNRFM                                                   08225000
OPNRFMVR EQU   OPNRFM                                                   08226000
OPNOPTSK EQU   OPNOPT                                                   08227000
OPNOPTDR EQU   OPNOPT                                                   08228000
OPNOPTCR EQU   OPNOPT                                                   08229000
OPNOPTKS EQU   OPNOPT                                                   08230000
OPNOPTUP EQU   OPNOPT                                                   08231000
OPNOPTOT EQU   OPNOPT                                                   08232000
IOCEXT   EQU   IOCSTR+64                                                08233000
IOCREL   EQU   IOCSTR+60                                                08234000
IOCWORK  EQU   IOCSTR+56                                                08235000
IOCRRN   EQU   IOCSTR+52                                                08236000
IOCPNM   EQU   IOCNWM+2                                                 08237000
IOCPTL   EQU   IOCNWM                                                   08238000
IOCKYA   EQU   IOCMEM                                                   08239000
IOCVRC   EQU   IOCTTR                                                   08240000
IOCCBP   EQU   IOCSTR+36                                                08241000
IOCDSN   EQU   IOCSTR+32                                                08242000
IOCHURBA EQU   IOCSTR+28                                                08243000
IOCVOLSR EQU   IOCSTR+22                                                08244000
@NM00018 EQU   IOCMSG                                                   08245000
IOCMSGAE EQU   IOCMSG                                                   08246000
IOCMSGCE EQU   IOCMSG                                                   08247000
IOCMSGOE EQU   IOCMSG                                                   08248000
IOCMSGOP EQU   IOCMSG                                                   08249000
@NM00017 EQU   IOCMSG                                                   08250000
IOCCHPSY EQU   IOCCHP                                                   08251000
IOCCHPAS EQU   IOCCHP                                                   08252000
IOCCHPBK EQU   IOCCHP                                                   08253000
IOCCHPCR EQU   IOCCHP                                                   08254000
IOCCHPKS EQU   IOCCHP                                                   08255000
IOCCHPSK EQU   IOCCHP                                                   08256000
IOCCHPDR EQU   IOCCHP                                                   08257000
IOCCHPSQ EQU   IOCCHP                                                   08258000
@NM00016 EQU   IOCMAC2                                                  08259000
IOCMACPA EQU   IOCMAC2                                                  08260000
@NM00015 EQU   IOCMAC2                                                  08261000
IOCMACCP EQU   IOCMAC2                                                  08262000
IOCMACRR EQU   IOCMAC2                                                  08263000
IOCMACAS EQU   IOCMAC2                                                  08264000
IOCMACSK EQU   IOCMAC2                                                  08265000
@NM00014 EQU   IOCMAC                                                   08266000
IOCMACCC EQU   IOCMAC                                                   08267000
IOCMACDR EQU   IOCMAC                                                   08268000
IOCMACBK EQU   IOCMAC                                                   08269000
IOCMACCR EQU   IOCMAC                                                   08270000
IOCMACUP EQU   IOCMAC                                                   08271000
IOCMACOT EQU   IOCMAC                                                   08272000
IOCMACIN EQU   IOCMAC                                                   08273000
@NM00013 EQU   IOCRFM                                                   08274000
IOCRFMBK EQU   IOCRFM                                                   08275000
IOCRFMSF EQU   IOCRFM                                                   08276000
IOCRFMUN EQU   IOCRFM                                                   08277000
IOCRFMVR EQU   IOCRFM                                                   08278000
IOCRFMFX EQU   IOCRFM                                                   08279000
@NM00012 EQU   IOCDSO                                                   08280000
IOCDSOPO EQU   IOCDSO                                                   08281000
IOCDSOIS EQU   IOCDSO                                                   08282000
IOCDSOPS EQU   IOCDSO                                                   08283000
IOCDSOAM EQU   IOCDSO                                                   08284000
IOCRKP   EQU   IOCSTR+13                                                08285000
IOCKYL   EQU   IOCSTR+12                                                08286000
IOCTRN   EQU   IOCSTR+8                                                 08287000
IOCDLN   EQU   IOCSTR+4                                                 08288000
UNITVTOC EQU   UNITABL+7                                                08289000
@NM00011 EQU   UNITSTAT                                                 08290000
UNITXSHR EQU   UNITSTAT                                                 08291000
UNITISHR EQU   UNITSTAT                                                 08292000
UNITUA   EQU   @NM00010+1                                               08293000
UNITCHA  EQU   @NM00010                                                 08294000
UNITUCB  EQU   UNITABL                                                  08295000
ALLUNCNT EQU   ALLAGL+30                                                08296000
ALLVLCNT EQU   ALLAGL+29                                                08297000
@NM00009 EQU   ALLOPT                                                   08298000
ALLOPTUN EQU   ALLOPT                                                   08299000
ALLOPTPV EQU   ALLOPT                                                   08300000
ALLOPTDS EQU   ALLOPT                                                   08301000
ALLOPTVL EQU   ALLOPT                                                   08302000
@NM00008 EQU   ALLORG+1                                                 08303000
ALLORGVS EQU   ALLORG+1                                                 08304000
@NM00007 EQU   ALLORG+1                                                 08305000
ALLORGGS EQU   ALLORG+1                                                 08306000
ALLORGUN EQU   ALLORG                                                   08307000
ALLORGPO EQU   ALLORG                                                   08308000
ALLORGMQ EQU   ALLORG                                                   08309000
ALLORGCQ EQU   ALLORG                                                   08310000
ALLORGCX EQU   ALLORG                                                   08311000
ALLORGDA EQU   ALLORG                                                   08312000
ALLORGPS EQU   ALLORG                                                   08313000
ALLORGIS EQU   ALLORG                                                   08314000
ALLDSPUN EQU   ALLDSP                                                   08315000
ALLDSPCG EQU   ALLDSP                                                   08316000
ALLDSPDE EQU   ALLDSP                                                   08317000
ALLDSPKP EQU   ALLDSP                                                   08318000
@NM00006 EQU   ALLDSP                                                   08319000
ALLSTSOD EQU   ALLSTS                                                   08320000
ALLSTSMD EQU   ALLSTS                                                   08321000
ALLSTSNW EQU   ALLSTS                                                   08322000
ALLSTSSR EQU   ALLSTS                                                   08323000
@NM00005 EQU   ALLSTS                                                   08324000
ALLPWD   EQU   ALLAGL+20                                                08325000
ALLVLP   EQU   ALLAGL+16                                                08326000
ALLULP   EQU   ALLAGL+12                                                08327000
ALLDDN   EQU   ALLAGL+4                                                 08328000
ALLDSN   EQU   ALLAGL                                                   08329000
CIRPID   EQU   CIRAGL+28                                                08330000
CIRPWD   EQU   CIRAGL+24                                                08331000
CIRCAT   EQU   CIRAGL+20                                                08332000
CIRWKP   EQU   CIRAGL+16                                                08333000
CIRTLR   EQU   CIRAGL+12                                                08334000
CIRHDR   EQU   CIRAGL+8                                                 08335000
CIRTLN   EQU   CIRAGL+6                                                 08336000
CIRHLN   EQU   CIRAGL+4                                                 08337000
@NM00004 EQU   CIRAGL+1                                                 08338000
@NM00003 EQU   CIRTYPE                                                  08339000
CIRTYPAQ EQU   CIRTYPE                                                  08340000
CIRTYP1Q EQU   CIRTYPE                                                  08341000
NEWID1   EQU   TRACE1+95                                                08342000
CALLID   EQU   OLDERID1+90                                              08343000
@NM00002 EQU   OLDERID1                                                 08344000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08345000
@RF00241 EQU   @RC00239                                                 08346000
@RT00371 EQU   @EL00002                                                 08347000
@RT00587 EQU   @EL00003                                                 08348000
@RT00646 EQU   @EL00004                                                 08349000
@RC00633 EQU   @EL00004                                                 08350000
@RC00667 EQU   @EL00006                                                 08351000
@RT00864 EQU   @EL00011                                                 08352000
@RC00851 EQU   @EL00011                                                 08353000
@RT00887 EQU   @EL00012                                                 08354000
@RT00901 EQU   @EL00013                                                 08355000
@RF00933 EQU   @RC00928                                                 08356000
@RF01029 EQU   @RC01016                                                 08357000
@RT01283 EQU   @EL00015                                                 08358000
@RT01346 EQU   @EL00016                                                 08359000
@RT01466 EQU   @EL00017                                                 08360000
@PB00002 EQU   @EL00001                                                 08361000
@RC00669 EQU   @RC00667                                                 08362000
@ENDDATA EQU   *                                                        08363000
         END   IDCCC01,(C'PLS0100',0602,75039)                          08364000
