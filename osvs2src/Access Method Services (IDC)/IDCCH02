         TITLE '************* IDCCH02:  CHECKMSS MSC/SA CHECK ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCH02  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCH02   77.297'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @10,4095(,@12)                                      0002 00022000
         LA    @09,4095(,@10)                                      0002 00023000
         LA    @08,4095(,@09)                                      0002 00024000
         LA    @07,4095(,@08)                                      0002 00025000
         LA    @06,4095(,@07)                                      0002 00026000
         USING @PSTART,@12                                         0002 00027000
         USING @PSTART+4095,@10                                    0002 00028000
         USING @PSTART+8190,@09                                    0002 00029000
         USING @PSTART+12285,@08                                   0002 00030000
         USING @PSTART+16380,@07                                   0002 00031000
         USING @PSTART+20475,@06                                   0002 00032000
         L     @00,@SIZDATD                                        0002 00033000
         GETMAIN  R,LV=(0)                                              00034000
         LR    @11,@01                                             0002 00035000
         USING @DATD,@11                                           0002 00036000
         ST    @13,@SA00001+4                                      0002 00037000
         LM    @00,@01,20(@13)                                     0002 00038000
         ST    @11,8(,@13)                                         0002 00039000
         LR    @13,@11                                             0002 00040000
         MVC   @PC00001(12),0(@01)                                 0002 00041000
*                                                                  0385 00042000
*/********************************************************************/ 00043000
*/*                                                          @Z40LB61*/ 00044000
*/* PROCEDURE NAME - IDCCH02                                 @Z40LB61*/ 00045000
*/*                                                          @Z40LB61*/ 00046000
*/* FUCNTION - THIS ROUTINE PRIMARILY ROUTES CONTROL TO      @Z40LB61*/ 00047000
*/*            SUBROUTINES WHICH CHECK MSC AND SA TABLES     @Z40LB61*/ 00048000
*/*            FOR CONSISTENCY.  MSC TABLES ARE COMPARED     @Z40LB61*/ 00049000
*/*            WITH SA TABLES (IF REQUESTED) AND MSC TABLES  @Z40LB61*/ 00050000
*/*            ARE COMPARED TO EACH OTHER (IF REQUESTED).    @Z40LB61*/ 00051000
*/*                                                          @Z40LB61*/ 00052000
*/*            THIS ROUTINE ALSO INITIALLY READS THE MSC     @Z40LB61*/ 00053000
*/*            CONFIGURATION INDEX AND MSC VIRTUAL VOLUME    @Z40LB61*/ 00054000
*/*            ADDRESS TABLE INTO IN-STORAGE LOCATIONS       @Z40LB61*/ 00055000
*/*            IN PREPARATION FOR SUBSEQUENT CHECKING.       @Z40LB61*/ 00056000
*/*                                                          @Z40LB61*/ 00057000
*/* INPUT -                                                  @Z40LB61*/ 00058000
*/*        (1) MSC CONFIGURATION INDEX                       @Z40LB61*/ 00059000
*/*        (2) MSC VIRTUAL VOLUME ADDRESS TABLE              @Z40LB61*/ 00060000
*/*        (3) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 00061000
*/*                                                          @Z40LB61*/ 00062000
*/* OUTPUT -                                                 @Z40LB61*/ 00063000
*/*        (1) FUNCTION CONDITION CODE                       @Z40LB61*/ 00064000
*/*                                                          @Z40LB61*/ 00065000
*/********************************************************************/ 00066000
*                                                                  0385 00067000
*   /*****************************************************************/ 00068000
*   /*                                                               */ 00069000
*   /* IF INTERNAL MSC TABLE CHECKING WAS REQUESTED,         @Z40LB61*/ 00070000
*   /* COMPARE THE MSC CELL MAP AGAINST RELATED TABLES.      @Z40LB61*/ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                                  0385 00074000
*   IF MSCCHK=ON THEN                                              0385 00075000
         L     @15,@PC00001+4                                      0385 00076000
         TM    MSCCHK(@15),B'10000000'                             0385 00077000
         BNO   @RF00385                                            0385 00078000
*     DO;                           /*                       @Z40LB61*/ 00079000
*       CALL CELLMAP;               /*                       @Z40LB61*/ 00080000
         BAL   @14,CELLMAP                                         0387 00081000
*       IF LASTCOND^=0 THEN                                        0388 00082000
         L     @15,@PC00001+8                                      0388 00083000
         ICM   @14,3,LASTCOND(@15)                                 0388 00084000
         BNZ   @RT00388                                            0388 00085000
*         RETURN;                   /*                       @Z40LB61*/ 00086000
*                                                                  0389 00087000
*       /*************************************************************/ 00088000
*       /*                                                           */ 00089000
*       /* OBTAIN THE CONFIGURATION INDEX AND MOVE IT TO WHERE       */ 00090000
*       /*                                                   @Z40LB61*/ 00091000
*       /* IT WILL RESIDE IN STORAGE DURING SUBSEQUENT CHECKING      */ 00092000
*       /*                                                   @Z40LB61*/ 00093000
*       /*                                                           */ 00094000
*       /*************************************************************/ 00095000
*                                                                  0390 00096000
*       TABLEID=CFGTBLID;           /*                       @Z40LB61*/ 00097000
         L     @15,@PC00001+4                                      0390 00098000
         L     @14,EARGPTR(,@15)                                   0390 00099000
         MVC   TABLEID(1,@14),CFGTBLID                             0390 00100000
*       CIFLAG=ON;                  /*                       @Z40LB61*/ 00101000
         OI    CIFLAG(@14),B'00001000'                             0391 00102000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB61*/ 00103000
         L     @14,@PC00001                                        0392 00104000
         ST    @14,@AL00001                                        0392 00105000
         ST    @15,@AL00001+4                                      0392 00106000
         L     @15,@CV01494                                        0392 00107000
         LA    @01,@AL00001                                        0392 00108000
         BALR  @14,@15                                             0392 00109000
*       IF GETRC^=0 THEN                                           0393 00110000
         L     @15,@PC00001+4                                      0393 00111000
         L     @01,EARGPTR(,@15)                                   0393 00112000
         ICM   @00,3,GETRC(@01)                                    0393 00113000
         BZ    @RF00393                                            0393 00114000
*         DO;                       /*                       @Z40LB61*/ 00115000
*           LASTCOND=LASTCC12;      /*                       @Z40LB61*/ 00116000
         L     @15,@PC00001+8                                      0395 00117000
         MVC   LASTCOND(2,@15),@CH00567                            0395 00118000
*           RETURN;                 /*                       @Z40LB61*/ 00119000
@EL00001 L     @13,4(,@13)                                         0396 00120000
@EF00001 L     @00,@SIZDATD                                        0396 00121000
         LR    @01,@11                                             0396 00122000
         FREEMAIN R,LV=(0),A=(1)                                        00123000
@ER00001 LM    @14,@12,12(@13)                                     0396 00124000
         BR    @14                                                 0396 00125000
*         END;                      /*                       @Z40LB61*/ 00126000
*       CIADDR->MOVEAREA(1:MICOFFST)=TBLADDR->MOVEAREA(1:MICOFFST);/*   00127000
*                                                            @Z40LB61*/ 00128000
@RF00393 L     @15,@PC00001+4                                      0398 00129000
         L     @14,CIADDR(,@15)                                    0398 00130000
         L     @15,EARGPTR(,@15)                                   0398 00131000
         L     @01,TBLADDR(,@15)                                   0398 00132000
         MVC   MOVEAREA(128,@14),MOVEAREA(@01)                     0398 00133000
*       CIENTPTR=CIADDR;            /*                       @Z40LB61*/ 00134000
         ST    @14,CIENTPTR                                        0399 00135000
*       CICHR=PREVCHR;              /*                       @Z40LB61*/ 00136000
         MVC   CICHR(5),PREVCHR(@15)                               0400 00137000
*     END;                          /*                       @Z40LB61*/ 00138000
*                                                                  0401 00139000
*   /*****************************************************************/ 00140000
*   /*                                                               */ 00141000
*   /* OBTAIN THE VIRTUAL VOLUME ADDRESS TABLE AND MOVE IT   @Z40LB61*/ 00142000
*   /* TO WHERE IT WILL RESIDE IN STORAGE DURING SUBSEQUENT  @Z40LB61*/ 00143000
*   /* CHECKING.                                             @Z40LB61*/ 00144000
*   /*                                                               */ 00145000
*   /*****************************************************************/ 00146000
*                                                                  0402 00147000
*   TABLEID=VVATBLID;               /*                       @Z40LB61*/ 00148000
@RF00385 L     @15,@PC00001+4                                      0402 00149000
         L     @14,EARGPTR(,@15)                                   0402 00150000
         MVC   TABLEID(1,@14),VVATBLID                             0402 00151000
*   TBLADDR=NULLPTR;                /*                       @Z40LB61*/ 00152000
         SLR   @05,@05                                             0403 00153000
         ST    @05,TBLADDR(,@14)                                   0403 00154000
*   MOVEPTR=VVATADDR;               /*                       @Z40LB61*/ 00155000
         MVC   MOVEPTR(4),VVATADDR(@15)                            0404 00156000
*   DO TBLBLK#=1 TO RECSVVAT;       /*                       @Z40LB61*/ 00157000
         LA    @15,1                                               0405 00158000
         STH   @15,TBLBLK#                                         0405 00159000
@DL00405 DS    0H                                                  0406 00160000
*     GETNEXT=ON;                   /*                       @Z40LB61*/ 00161000
         L     @15,@PC00001+4                                      0406 00162000
         L     @01,EARGPTR(,@15)                                   0406 00163000
         OI    GETNEXT(@01),B'10000000'                            0406 00164000
*     CALL IDCCH03(GDTTBL,CDALIST); /*                       @Z40LB61*/ 00165000
         L     @14,@PC00001                                        0407 00166000
         ST    @14,@AL00001                                        0407 00167000
         ST    @15,@AL00001+4                                      0407 00168000
         L     @15,@CV01494                                        0407 00169000
         LA    @01,@AL00001                                        0407 00170000
         BALR  @14,@15                                             0407 00171000
*     IF GETRC^=0 THEN                                             0408 00172000
         L     @15,@PC00001+4                                      0408 00173000
         L     @01,EARGPTR(,@15)                                   0408 00174000
         ICM   @00,3,GETRC(@01)                                    0408 00175000
         BZ    @RF00408                                            0408 00176000
*       DO;                         /*                       @Z40LB61*/ 00177000
*         LASTCOND=LASTCC12;        /*                       @Z40LB61*/ 00178000
         L     @15,@PC00001+8                                      0410 00179000
         MVC   LASTCOND(2,@15),@CH00567                            0410 00180000
*         RETURN;                   /*                       @Z40LB61*/ 00181000
         B     @EL00001                                            0411 00182000
*       END;                        /*                       @Z40LB61*/ 00183000
*     MOVEAREA(1:SECTRLEN)=TBLADDR->MOVEAREA(1:SECTRLEN);/*  @Z40LB61*/ 00184000
@RF00408 L     @15,MOVEPTR                                         0413 00185000
         L     @14,@PC00001+4                                      0413 00186000
         L     @14,EARGPTR(,@14)                                   0413 00187000
         L     @01,TBLADDR(,@14)                                   0413 00188000
         MVC   MOVEAREA(256,@15),MOVEAREA(@01)                     0413 00189000
*     MOVEPTR=MOVEPTR+SECTRLEN;     /*                       @Z40LB61*/ 00190000
         AH    @15,@CH00606                                        0414 00191000
         ST    @15,MOVEPTR                                         0414 00192000
*     VVATCHR(TBLBLK#)=PREVCHR;     /*                       @Z40LB61*/ 00193000
         LH    @15,TBLBLK#                                         0415 00194000
         LR    @05,@15                                             0415 00195000
         MH    @05,@CH00290                                        0415 00196000
         LA    @04,VVATCHR-5(@05)                                  0415 00197000
         MVC   0(5,@04),PREVCHR(@14)                               0415 00198000
*   END;                            /*                       @Z40LB61*/ 00199000
*                                                                  0416 00200000
         AH    @15,@CH00223                                        0416 00201000
         STH   @15,TBLBLK#                                         0416 00202000
         CH    @15,@CH00157                                        0416 00203000
         BNH   @DL00405                                            0416 00204000
*   /*****************************************************************/ 00205000
*   /*                                                               */ 00206000
*   /* CHECK EACH MOUNTED VOLUME TABLE ENTRY AGAINST         @Z40LB61*/ 00207000
*   /* CORRESPONDING INFORMATION IN RELATED MSC AND SA       @Z40LB61*/ 00208000
*   /* TABLES                                                @Z40LB61*/ 00209000
*   /*                                                               */ 00210000
*   /*****************************************************************/ 00211000
*                                                                  0417 00212000
*   CALL MVTLOOP;                   /*                       @Z40LB61*/ 00213000
         BAL   @14,MVTLOOP                                         0417 00214000
*   IF LASTCOND^=0 THEN                                            0418 00215000
         L     @15,@PC00001+8                                      0418 00216000
         ICM   @14,3,LASTCOND(@15)                                 0418 00217000
         BNZ   @RT00418                                            0418 00218000
*     RETURN;                       /*                       @Z40LB61*/ 00219000
*                                                                  0419 00220000
*   /*****************************************************************/ 00221000
*   /*                                                               */ 00222000
*   /* SCAN SELECTED TABLES, CHECKING FOR CONSISTENCY AND    @Z40LB61*/ 00223000
*   /* CHECKING THAT ACCUMULATED SUMS OF VALUES MATCH THE    @Z40LB61*/ 00224000
*   /* CORRESPONDING TOTALS KEPT FOR THOSE VALUES.           @Z40LB61*/ 00225000
*   /*                                                               */ 00226000
*   /*****************************************************************/ 00227000
*                                                                  0420 00228000
*   CALL SCANSUMS;                  /*                       @Z40LB61*/ 00229000
         BAL   @14,SCANSUMS                                        0420 00230000
*   IF LASTCOND^=0 THEN                                            0421 00231000
         L     @15,@PC00001+8                                      0421 00232000
         ICM   @14,3,LASTCOND(@15)                                 0421 00233000
         BNZ   @RT00421                                            0421 00234000
*     RETURN;                       /*                       @Z40LB61*/ 00235000
*                                                                  0422 00236000
*   /*****************************************************************/ 00237000
*   /*                                                               */ 00238000
*   /* RESCAN SELECTED MSC AND SA TABLES, CHECKING THAT ALL  @Z40LB61*/ 00239000
*   /* VALID TABLE ENTRIES HAVE BEEN REFERENCED BY RELATED   @Z40LB61*/ 00240000
*   /* MSC TABLES.                                           @Z40LB61*/ 00241000
*   /*                                                               */ 00242000
*   /*****************************************************************/ 00243000
*                                                                  0423 00244000
*   CALL RESCAN;                    /*                       @Z40LB61*/ 00245000
         BAL   @14,RESCAN                                          0423 00246000
*                                                                  0424 00247000
*/*  ******************************************************* @Z40LB64*/ 00248000
*/*                                                          @Z40LB64*/ 00249000
*/*   PROCEDURE NAME - CELLMAP                               @Z40LB64*/ 00250000
*/*                                                          @Z40LB64*/ 00251000
*/*   FUNCTION - COMPARES THE MSC VOLUME INVENTORY,          @Z40LB64*/ 00252000
*/*              TRANSIENT VOLUME LIST, AND SCRATCH          @Z40LB64*/ 00253000
*/*              CARTRIDGE LIST ENTRIES AGAINST THE CELL     @Z40LB64*/ 00254000
*/*              MAP.                                        @Z40LB64*/ 00255000
*/*                                                          @Z40LB64*/ 00256000
*/*              THE CELL MAP FOR EACH VALID MSF IS READ     @Z40LB64*/ 00257000
*/*              INTO STORAGE FROM THE WORK DATA SET.        @Z40LB64*/ 00258000
*/*                                                          @Z40LB64*/ 00259000
*/*              ALL MSC VOLUME INVENTORY ENTRIES, FOLLOWED  @Z40LB64*/ 00260000
*/*              BY ALL MSC TRANSIENT VOLUME LIST ENTRIES,   @Z40LB64*/ 00261000
*/*              AND FINALLY ALL MSC SCRATCH CARTRIDGE LIST  @Z40LB64*/ 00262000
*/*              ENTRIES RE OBTAINED INDIVIDUALLY VIA THE    @Z40LB64*/ 00263000
*/*              'IDCCH03' PROCEDURE, AND THE SEQUENCE #1    @Z40LB64*/ 00264000
*/*              AND SEQUENCE #2 CELL LOCATIONS ARE CHECKED  @Z40LB64*/ 00265000
*/*              FOR VALIDITY IN THE CELL MAP.               @Z40LB64*/ 00266000
*/*                                                          @Z40LB64*/ 00267000
*/*              IF THE CELL MAP INDICIATES THAT A           @Z40LB64*/ 00268000
*/*              PARTICULAR CELL LOCATIONS IS INVALID,       @Z40LB64*/ 00269000
*/*              EMPTY, OR MULTIPLY REFERENCED, AN ERROR     @Z40LB64*/ 00270000
*/*              MESSAGE IS PRINTED.                         @Z40LB64*/ 00271000
*/*                                                          @Z40LB64*/ 00272000
*/*              WHEN ALL VI, TVL, AND SCL ENTRIES HAVE      @Z40LB64*/ 00273000
*/*              BEEN COMPARED AGAINST THE CELL MAP, ALL     @Z40LB64*/ 00274000
*/*              CELL LOCATIONS THAT ARE VALID AND FULL      @Z40LB64*/ 00275000
*/*              SHOULD HAVE BEEN ACCOUNTED FOR.             @Z40LB64*/ 00276000
*/*                                                          @Z40LB64*/ 00277000
*/*   INPUT - (1) THE MSC CELL MAP FOR EACH VALID MSF        @Z40LB64*/ 00278000
*/*               (INCLUDING THE ORIGINAL STATE CELL MAP     @Z40LB64*/ 00279000
*/*               DISTINQUISHING VALID/INVALID LOCATIONS)    @Z40LB64*/ 00280000
*/*           (2) THE MSC VOLUME INVENTORY                   @Z40LB64*/ 00281000
*/*           (3) THE MSC TRANSIENT VOLUME LIST              @Z40LB64*/ 00282000
*/*           (4) THE MSC SCRATCH CARTRIDGE LIST             @Z40LB64*/ 00283000
*/*                                                          @Z40LB64*/ 00284000
*/*   OUTPUT -                                               @Z40LB61*/ 00285000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 00286000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 00287000
*/*                                                          @Z40LB64*/ 00288000
*/*  *****************************************************************/ 00289000
*                                                                  0424 00290000
*CELLMAP:                                                          0424 00291000
*   PROCEDURE;                      /*                       @Z40LB64*/ 00292000
         B     @PB00002                                            0424 00293000
CELLMAP  STM   @14,@12,@SA00002                                    0424 00294000
*   OLDERID2=NEWERID2;                                             0425 00295000
         L     @15,@PC00001                                        0425 00296000
         L     @15,GDTTR2(,@15)                                    0425 00297000
         MVC   @TS00001(95),NEWERID2(@15)                          0425 00298000
         MVC   OLDERID2(95,@15),@TS00001                           0425 00299000
*   NEWID2='CH2A';                  /*                       @Z40LB61*/ 00300000
*                                                                  0426 00301000
         MVC   NEWID2(4,@15),@CC01503                              0426 00302000
*   /*****************************************************************/ 00303000
*   /*                                                               */ 00304000
*   /* DETERMINE THE LOW X-VALUE FOR EACH VALID MSF BY       @Z40LB64*/ 00305000
*   /* SCANNING THE CELL MAP CONTROL BLOCK OF EACH MSF       @Z40LB64*/ 00306000
*   /* UNTIL A CUBE ADDRESS OF 'FF'X IS FOUND.               @Z40LB64*/ 00307000
*   /*                                                               */ 00308000
*   /*****************************************************************/ 00309000
*                                                                  0427 00310000
*LOWXLOOP:                                                         0427 00311000
*   DO MSF#=1 TO MSFVLCNT;          /*                       @Z40LB64*/ 00312000
*                                                                  0427 00313000
LOWXLOOP LA    @15,1                                               0427 00314000
         B     @DE00427                                            0427 00315000
@DL00427 DS    0H                                                  0428 00316000
*     /***************************************************************/ 00317000
*     /*                                                             */ 00318000
*     /* READ THE CELL MAP CONTROL BLOCK FOR EACH            @Z40LB64*/ 00319000
*     /* VALID MSF.                                          @Z40LB64*/ 00320000
*     /*                                                             */ 00321000
*     /***************************************************************/ 00322000
*                                                                  0428 00323000
*     TABLEID=CMTBLID;              /*                       @Z40LB64*/ 00324000
         L     @14,@PC00001+4                                      0428 00325000
         L     @05,EARGPTR(,@14)                                   0428 00326000
         MVC   TABLEID(1,@05),CMTBLID                              0428 00327000
*     CELLBLK=(BLKSMSF+1)*VLDMSFID(MSF#)+1;/*                @Z40LB64*/ 00328000
         ALR   @15,@15                                             0429 00329000
         LH    @04,VLDMSFID-2(@15,@14)                             0429 00330000
         MH    @04,@CH00290                                        0429 00331000
         AH    @04,@CH00223                                        0429 00332000
         STH   @04,CELLBLK(,@05)                                   0429 00333000
*     CALL IDCCH03(GDTTBL,CDALIST); /*                       @Z40LB64*/ 00334000
         L     @15,@PC00001                                        0430 00335000
         ST    @15,@AL00001                                        0430 00336000
         ST    @14,@AL00001+4                                      0430 00337000
         L     @15,@CV01494                                        0430 00338000
         LA    @01,@AL00001                                        0430 00339000
         BALR  @14,@15                                             0430 00340000
*     IF GETRC=0 THEN                                              0431 00341000
         L     @15,@PC00001+4                                      0431 00342000
         L     @15,EARGPTR(,@15)                                   0431 00343000
         ICM   @14,3,GETRC(@15)                                    0431 00344000
         BNZ   @RF00431                                            0431 00345000
*       DO;                         /*                       @Z40LB64*/ 00346000
*                                                                  0432 00347000
*         /***********************************************************/ 00348000
*         /*                                                         */ 00349000
*         /* DETERMINE THE LOW X VALUE FOR THIS MSF          @Z40LB64*/ 00350000
*         /*                                                         */ 00351000
*         /***********************************************************/ 00352000
*                                                                  0433 00353000
*         CMCBPTR=TBLADDR;          /*                       @Z40LB64*/ 00354000
         MVC   CMCBPTR(4),TBLADDR(@15)                             0433 00355000
*         CUBE#=1;                  /*                       @Z40LB64*/ 00356000
         MVC   CUBE#(2),@CH00223                                   0434 00357000
*         ENDFLAG=OFF;              /*                       @Z40LB64*/ 00358000
         NI    ENDFLAG,B'01111111'                                 0435 00359000
*         DO WHILE ENDFLAG=OFF;     /*                       @Z40LB64*/ 00360000
         B     @DE00436                                            0436 00361000
@DL00436 DS    0H                                                  0437 00362000
*           IF CMCPTRS(CUBE#)=LASTCUBE THEN                        0437 00363000
         LH    @15,CUBE#                                           0437 00364000
         L     @01,CMCBPTR                                         0437 00365000
         SLR   @14,@14                                             0437 00366000
         IC    @14,CMCPTRS-1(@15,@01)                              0437 00367000
         SLR   @05,@05                                             0437 00368000
         IC    @05,LASTCUBE                                        0437 00369000
         CR    @14,@05                                             0437 00370000
         BNE   @RF00437                                            0437 00371000
*             DO;                   /*                       @Z40LB64*/ 00372000
*                                                                  0438 00373000
*               /*****************************************************/ 00374000
*               /*                                                   */ 00375000
*               /* THE END OF THE CUBE ADDRESSES IN THE      @Z40LB64*/ 00376000
*               /* CELL MAP CONTROL BLOCK HAS BEEN FOUND.    @Z40LB64*/ 00377000
*               /* THE LOW X VALUE IS CALCULATED BY THE      @Z40LB64*/ 00378000
*               /* FOLLOWING FORMULA: X = MAXIMUM RELATIVE X @Z40LB64*/ 00379000
*               /* - (NUMBER OF CUBE PTRS/NUMBER OF CUBE     @Z40LB64*/ 00380000
*               /* PTRS PER CHUNK) * RANGE OF X PER CHUNK) - @Z40LB64*/ 00381000
*               /* RANGE OF X PER CHUNK/2. THE LATTER        @Z40LB64*/ 00382000
*               /* SUBTRACTION ACCOUNTS FOR THE FACT THAT    @Z40LB64*/ 00383000
*               /* THE LAST CHUNK IS ONLY HALF FULL.         @Z40LB64*/ 00384000
*               /*                                                   */ 00385000
*               /*****************************************************/ 00386000
*                                                                  0439 00387000
*               MSFXLOW(MSF#)=MSFXMAX-(((CUBE#/CUBESCNK)*XRNGCNK)- 0439 00388000
*                   XRNGCNK/2);     /*                       @Z40LB64*/ 00389000
         LH    @14,MSF#                                            0439 00390000
         ALR   @14,@14                                             0439 00391000
         LR    @00,@15                                             0439 00392000
         SRDA  @00,32                                              0439 00393000
         D     @00,@CF00769                                        0439 00394000
         SLA   @01,2                                               0439 00395000
         LCR   @01,@01                                             0439 00396000
         AH    @01,@CH00157                                        0439 00397000
         AH    @01,@CH01472                                        0439 00398000
         STH   @01,MSFXLOW-2(@14)                                  0439 00399000
*               ENDFLAG=ON;         /*                       @Z40LB64*/ 00400000
         OI    ENDFLAG,B'10000000'                                 0440 00401000
*             END;                  /*                       @Z40LB64*/ 00402000
*           ELSE                                                   0442 00403000
*             CUBE#=CUBE#+1;        /*                       @Z40LB64*/ 00404000
         B     @RC00437                                            0442 00405000
@RF00437 LA    @15,1                                               0442 00406000
         AH    @15,CUBE#                                           0442 00407000
         STH   @15,CUBE#                                           0442 00408000
*         END;                      /*                       @Z40LB64*/ 00409000
@RC00437 DS    0H                                                  0443 00410000
@DE00436 TM    ENDFLAG,B'10000000'                                 0443 00411000
         BZ    @DL00436                                            0443 00412000
*       END;                        /*                       @Z40LB64*/ 00413000
*     IF GETRC=TABLERR THEN                                        0445 00414000
@RF00431 LA    @15,12                                              0445 00415000
         L     @14,@PC00001+4                                      0445 00416000
         L     @01,EARGPTR(,@14)                                   0445 00417000
         CH    @15,GETRC(,@01)                                     0445 00418000
         BNE   @RF00445                                            0445 00419000
*       DO;                         /*                       @Z40LB64*/ 00420000
*                                                                  0446 00421000
*         /***********************************************************/ 00422000
*         /*                                                         */ 00423000
*         /* AN ERROR WAS ENCOUNTERED WHILE TRYING           @Z40LB64*/ 00424000
*         /* TO OBTAIN A CELL MAP CONTROL BLOCK.             @Z40LB64*/ 00425000
*         /* TERMINATE CHECKMSS PROCESSING.                  @Z40LB64*/ 00426000
*         /*                                                         */ 00427000
*         /***********************************************************/ 00428000
*                                                                  0447 00429000
*         LASTCOND=LASTCC12;        /*                       @Z40LB64*/ 00430000
         L     @14,@PC00001+8                                      0447 00431000
         STH   @15,LASTCOND(,@14)                                  0447 00432000
*         RETURN;                   /*                       @Z40LB64*/ 00433000
@EL00002 DS    0H                                                  0448 00434000
@EF00002 DS    0H                                                  0448 00435000
@ER00002 LM    @14,@12,@SA00002                                    0448 00436000
         BR    @14                                                 0448 00437000
*       END;                        /*                       @Z40LB64*/ 00438000
*   END LOWXLOOP;                   /*                       @Z40LB64*/ 00439000
*                                                                  0450 00440000
@RF00445 LA    @15,1                                               0450 00441000
         AH    @15,MSF#                                            0450 00442000
@DE00427 STH   @15,MSF#                                            0450 00443000
         L     @14,@PC00001+4                                      0450 00444000
         CH    @15,MSFVLCNT(,@14)                                  0450 00445000
         BNH   @DL00427                                            0450 00446000
*   /*****************************************************************/ 00447000
*   /*                                                               */ 00448000
*   /* READ THE CELL MAP DATA BLOCKS FOR EACH VALID MSF      @Z40LB64*/ 00449000
*   /* AND THE ORGINAL STATE CELL MAP INTO THE CELL MAP      @Z40LB64*/ 00450000
*   /* BUFFERS.                                              @Z40LB64*/ 00451000
*   /*                                                               */ 00452000
*   /*****************************************************************/ 00453000
*                                                                  0451 00454000
*CMREAD:                                                           0451 00455000
*   DO MSF#=1 TO MSFVLCNT+1;        /*                       @Z40LB64*/ 00456000
*                                                                  0451 00457000
CMREAD   LA    @15,1                                               0451 00458000
         B     @DE00451                                            0451 00459000
@DL00451 DS    0H                                                  0452 00460000
*     /***************************************************************/ 00461000
*     /*                                                             */ 00462000
*     /* READ EACH CELL MAP ONE BLOCK AT A TIME              @Z40LB64*/ 00463000
*     /*                                                             */ 00464000
*     /***************************************************************/ 00465000
*                                                                  0452 00466000
*BLKREAD:                                                          0452 00467000
*     DO CMBLK#=1 TO BLKSMSF;       /*                       @Z40LB64*/ 00468000
BLKREAD  LA    @15,1                                               0452 00469000
         STH   @15,CMBLK#                                          0452 00470000
@DL00452 DS    0H                                                  0453 00471000
*       TABLEID=CMTBLID;            /*                       @Z40LB64*/ 00472000
         L     @14,@PC00001+4                                      0453 00473000
         L     @05,EARGPTR(,@14)                                   0453 00474000
         MVC   TABLEID(1,@05),CMTBLID                              0453 00475000
*       IF MSF#<=MSFVLCNT THEN                                     0454 00476000
         LH    @04,MSF#                                            0454 00477000
         CH    @04,MSFVLCNT(,@14)                                  0454 00478000
         BH    @RF00454                                            0454 00479000
*         CELLBLK=((BLKSMSF+1)*VLDMSFID(MSF#))+CMBLK#+1;/*   @Z40LB64*/ 00480000
         ALR   @04,@04                                             0455 00481000
         LH    @14,VLDMSFID-2(@04,@14)                             0455 00482000
         MH    @14,@CH00290                                        0455 00483000
         ALR   @14,@15                                             0455 00484000
         AH    @14,@CH00223                                        0455 00485000
         STH   @14,CELLBLK(,@05)                                   0455 00486000
*       ELSE                                                       0456 00487000
*         CELLBLK=ORGCMBLK+CMBLK#-1;/*                       @Z40LB64*/ 00488000
         B     @RC00454                                            0456 00489000
@RF00454 L     @15,@PC00001+4                                      0456 00490000
         L     @01,EARGPTR(,@15)                                   0456 00491000
         LH    @00,CMBLK#                                          0456 00492000
         SH    @00,@CH01723                                        0456 00493000
         STH   @00,CELLBLK(,@01)                                   0456 00494000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB64*/ 00495000
@RC00454 L     @15,@PC00001                                        0457 00496000
         ST    @15,@AL00001                                        0457 00497000
         L     @15,@PC00001+4                                      0457 00498000
         ST    @15,@AL00001+4                                      0457 00499000
         L     @15,@CV01494                                        0457 00500000
         LA    @01,@AL00001                                        0457 00501000
         BALR  @14,@15                                             0457 00502000
*       IF GETRC=0 THEN                                            0458 00503000
         L     @15,@PC00001+4                                      0458 00504000
         L     @14,EARGPTR(,@15)                                   0458 00505000
         ICM   @05,3,GETRC(@14)                                    0458 00506000
         BNZ   @RF00458                                            0458 00507000
*         DO;                       /*                       @Z40LB64*/ 00508000
*                                                                  0459 00509000
*           /*********************************************************/ 00510000
*           /*                                                       */ 00511000
*           /* CELL MAP BLOCK SUCCESSFULLY OBTAINED.         @Z40LB64*/ 00512000
*           /* MOVE THE CELL MAP BLOCK FROM THE I/O          @Z40LB64*/ 00513000
*           /* BUFFER INTO THE CELL MAP BUFFER, SAVE         @Z40LB64*/ 00514000
*           /* THE CCHHR INFORMATION, AND ZERO THE           @Z40LB64*/ 00515000
*           /* CORRESPONDING CHECK-OFF TABLE BLOCK.          @Z40LB64*/ 00516000
*           /*                                                       */ 00517000
*           /*********************************************************/ 00518000
*                                                                  0460 00519000
*           CMBLOCK=TBLADDR->MOVEAREA(1:LENGTH(CMBLOCK));/*  @Z40LB64*/ 00520000
         LH    @05,MSF#                                            0460 00521000
         LR    @04,@05                                             0460 00522000
         SLA   @04,2                                               0460 00523000
         AH    @04,CMBLK#                                          0460 00524000
         LR    @03,@04                                             0460 00525000
         SLA   @03,2                                               0460 00526000
         L     @01,CMBUFPTR-20(@03,@15)                            0460 00527000
         L     @02,TBLADDR(,@14)                                   0460 00528000
         MVC   CMBLOCK(256,@01),MOVEAREA(@02)                      0460 00529000
*           CMCHR(MSF#,CMBLK#)=PREVCHR;/*                    @Z40LB64*/ 00530000
         MH    @04,@CH00290                                        0461 00531000
         LA    @01,CMCHR-25(@04)                                   0461 00532000
         MVC   0(5,@01),PREVCHR(@14)                               0461 00533000
*           IF MSF#<=MSFVLCNT THEN                                 0462 00534000
         CH    @05,MSFVLCNT(,@15)                                  0462 00535000
         BH    @RF00462                                            0462 00536000
*             CMCOBLK=''B;          /*                       @Z40LB64*/ 00537000
         L     @01,CMCOPTR-20(@03,@15)                             0463 00538000
         XC    CMCOBLK(256,@01),CMCOBLK(@01)                       0463 00539000
*         END;                      /*                       @Z40LB64*/ 00540000
@RF00462 DS    0H                                                  0465 00541000
*       IF GETRC=TABLERR THEN                                      0465 00542000
@RF00458 LA    @15,12                                              0465 00543000
         L     @14,@PC00001+4                                      0465 00544000
         L     @01,EARGPTR(,@14)                                   0465 00545000
         CH    @15,GETRC(,@01)                                     0465 00546000
         BNE   @RF00465                                            0465 00547000
*         DO;                       /*                       @Z40LB64*/ 00548000
*                                                                  0466 00549000
*           /*********************************************************/ 00550000
*           /*                                                       */ 00551000
*           /* AN ERROR WAS ENCOUNTERED WHILE TRYING TO      @Z40LB64*/ 00552000
*           /* OBTAIN A CELL MAP BLOCK. TERMINATE            @Z40LB64*/ 00553000
*           /* CHECKMSS PROCESSING.                          @Z40LB64*/ 00554000
*           /*                                                       */ 00555000
*           /*********************************************************/ 00556000
*                                                                  0467 00557000
*           LASTCOND=LASTCC12;      /*                       @Z40LB64*/ 00558000
         L     @14,@PC00001+8                                      0467 00559000
         STH   @15,LASTCOND(,@14)                                  0467 00560000
*           RETURN;                 /*                       @Z40LB64*/ 00561000
         B     @EL00002                                            0468 00562000
*         END;                      /*                       @Z40LB64*/ 00563000
*     END BLKREAD;                  /*                       @Z40LB64*/ 00564000
@RF00465 LA    @15,1                                               0470 00565000
         AH    @15,CMBLK#                                          0470 00566000
         STH   @15,CMBLK#                                          0470 00567000
         CH    @15,@CH00046                                        0470 00568000
         BNH   @DL00452                                            0470 00569000
*   END CMREAD;                     /*                       @Z40LB64*/ 00570000
*                                                                  0471 00571000
         LA    @15,1                                               0471 00572000
         AH    @15,MSF#                                            0471 00573000
@DE00451 STH   @15,MSF#                                            0471 00574000
         L     @14,@PC00001+4                                      0471 00575000
         LA    @05,1                                               0471 00576000
         AH    @05,MSFVLCNT(,@14)                                  0471 00577000
         CR    @15,@05                                             0471 00578000
         BNH   @DL00451                                            0471 00579000
*   /*****************************************************************/ 00580000
*   /*                                                               */ 00581000
*   /* READ EACH MSC VOLUME INVENTORY ENTRY, THEN EACH       @Z40LB64*/ 00582000
*   /* MSC TRANSIENT VOLUME LIST ENTRY, AND FINALLY EACH     @Z40LB64*/ 00583000
*   /* SCRATCH CARTRIDGE LIST ENTRY FOR COMPARISON WITH      @Z40LB64*/ 00584000
*   /* THE CELL MAP.                                         @Z40LB64*/ 00585000
*   /*                                                               */ 00586000
*   /*****************************************************************/ 00587000
*                                                                  0472 00588000
*   SCLMSF#=1;                      /*                       @Z40LB64*/ 00589000
         MVC   SCLMSF#(2),@CH00223                                 0472 00590000
*MSCTBLS:                                                          0473 00591000
*   DO MSCTBL=1 TO MSCTYPES;        /*                       @Z40LB64*/ 00592000
MSCTBLS  LA    @15,1                                               0473 00593000
         STH   @15,MSCTBL                                          0473 00594000
@DL00473 DS    0H                                                  0474 00595000
*     ENDFLAG=OFF;                  /*                       @Z40LB64*/ 00596000
         NI    ENDFLAG,B'01111111'                                 0474 00597000
*     TBLADDR=0;                    /*                       @Z40LB64*/ 00598000
         L     @15,@PC00001+4                                      0475 00599000
         L     @01,EARGPTR(,@15)                                   0475 00600000
         SLR   @00,@00                                             0475 00601000
         ST    @00,TBLADDR(,@01)                                   0475 00602000
*TBLREAD:                                                          0476 00603000
*     DO WHILE ENDFLAG=OFF;         /*                       @Z40LB64*/ 00604000
TBLREAD  B     @DE00476                                            0476 00605000
@DL00476 DS    0H                                                  0477 00606000
*       GETNEXT=ON;                 /*                       @Z40LB64*/ 00607000
         L     @15,@PC00001+4                                      0477 00608000
         L     @15,EARGPTR(,@15)                                   0477 00609000
         OI    GETNEXT(@15),B'10000000'                            0477 00610000
*       IF MSCTBL=VITYPE THEN                                      0478 00611000
         CLC   MSCTBL(2),@CH00223                                  0478 00612000
         BNE   @RF00478                                            0478 00613000
*         TABLEID=VITBLID;          /*                       @Z40LB64*/ 00614000
         MVC   TABLEID(1,@15),VITBLID                              0479 00615000
*       IF MSCTBL=TVLTYPE THEN                                     0480 00616000
@RF00478 CLC   MSCTBL(2),@CH00157                                  0480 00617000
         BNE   @RF00480                                            0480 00618000
*         TABLEID=TVLTBLID;         /*                       @Z40LB64*/ 00619000
         L     @15,@PC00001+4                                      0481 00620000
         L     @01,EARGPTR(,@15)                                   0481 00621000
         MVC   TABLEID(1,@01),TVLTBLID                             0481 00622000
*       IF MSCTBL=SCLTYPE THEN                                     0482 00623000
@RF00480 CLC   MSCTBL(2),@CH00166                                  0482 00624000
         BNE   @RF00482                                            0482 00625000
*         DO;                       /*                       @Z40LB64*/ 00626000
*           TABLEID=SCLTBLID;       /*                       @Z40LB64*/ 00627000
         L     @15,@PC00001+4                                      0484 00628000
         L     @14,EARGPTR(,@15)                                   0484 00629000
         MVC   TABLEID(1,@14),SCLTBLID                             0484 00630000
*           MSFID=VLDMSFID(SCLMSF#);/*                       @Z40LB64*/ 00631000
         LH    @05,SCLMSF#                                         0485 00632000
         ALR   @05,@05                                             0485 00633000
         LH    @15,VLDMSFID-2(@05,@15)                             0485 00634000
         STH   @15,MSFID(,@14)                                     0485 00635000
*         END;                      /*                       @Z40LB64*/ 00636000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB64*/ 00637000
@RF00482 L     @15,@PC00001                                        0487 00638000
         ST    @15,@AL00001                                        0487 00639000
         L     @15,@PC00001+4                                      0487 00640000
         ST    @15,@AL00001+4                                      0487 00641000
         L     @15,@CV01494                                        0487 00642000
         LA    @01,@AL00001                                        0487 00643000
         BALR  @14,@15                                             0487 00644000
*       IF GETRC=0 THEN                                            0488 00645000
         L     @15,@PC00001+4                                      0488 00646000
         L     @01,EARGPTR(,@15)                                   0488 00647000
         ICM   @00,3,GETRC(@01)                                    0488 00648000
         BNZ   @RF00488                                            0488 00649000
*CMCHK:                                                            0489 00650000
*         DO;                       /*                       @Z40LB64*/ 00651000
*                                                                  0489 00652000
CMCHK    DS    0H                                                  0490 00653000
*           /*********************************************************/ 00654000
*           /*                                                       */ 00655000
*           /* MSC TABLE (VI, TVL, OR SCL) ENTRY WAS         @Z40LB64*/ 00656000
*           /* SUCCESSFULLY OBTAINED.                        @Z40LB64*/ 00657000
*           /*                                                       */ 00658000
*           /*********************************************************/ 00659000
*                                                                  0490 00660000
*           IF MSCTBL=VITYPE THEN                                  0490 00661000
         CLC   MSCTBL(2),@CH00223                                  0490 00662000
         BNE   @RF00490                                            0490 00663000
*             VIENTPTR=TBLADDR;     /*                       @Z40LB64*/ 00664000
         L     @15,@PC00001+4                                      0491 00665000
         L     @01,EARGPTR(,@15)                                   0491 00666000
         MVC   VIENTPTR(4),TBLADDR(@01)                            0491 00667000
*           IF MSCTBL=TVLTYPE THEN                                 0492 00668000
@RF00490 CLC   MSCTBL(2),@CH00157                                  0492 00669000
         BNE   @RF00492                                            0492 00670000
*             TVENTPTR=TBLADDR;     /*                       @Z40LB64*/ 00671000
         L     @15,@PC00001+4                                      0493 00672000
         L     @01,EARGPTR(,@15)                                   0493 00673000
         MVC   TVENTPTR(4),TBLADDR(@01)                            0493 00674000
*           IF MSCTBL=SCLTYPE THEN                                 0494 00675000
@RF00492 CLC   MSCTBL(2),@CH00166                                  0494 00676000
         BNE   @RF00494                                            0494 00677000
*             SCENTPTR=TBLADDR;     /*                       @Z40LB64*/ 00678000
*                                                                  0495 00679000
         L     @15,@PC00001+4                                      0495 00680000
         L     @01,EARGPTR(,@15)                                   0495 00681000
         MVC   SCENTPTR(4),TBLADDR(@01)                            0495 00682000
*           /*********************************************************/ 00683000
*           /*                                                       */ 00684000
*           /* IF THE VOLUME INVENTORY AND TRANSIENT         @Z40LB64*/ 00685000
*           /* VOLUME LIST TABLES WERE CHECKED-OFF           @Z40LB64*/ 00686000
*           /* DURING MSVI VS. MSC TABLE CHECKING,           @Z40LB64*/ 00687000
*           /* VERIFY THAT THE MSVI ACCOUNTED FOR ALL        @Z40LB64*/ 00688000
*           /* VOLUME INVENTORY AND TRANSIENT VOLUME LIST    @Z40LB64*/ 00689000
*           /* ENTRIES.                                      @Z40LB64*/ 00690000
*           /*                                                       */ 00691000
*           /*********************************************************/ 00692000
*                                                                  0496 00693000
*           IF MSVICHK=ON THEN                                     0496 00694000
@RF00494 L     @15,@PC00001+4                                      0496 00695000
         TM    MSVICHK(@15),B'00100000'                            0496 00696000
         BNO   @RF00496                                            0496 00697000
*MSVICHKF:                                                         0497 00698000
*             DO;                   /*                       @Z40LB64*/ 00699000
MSVICHKF DS    0H                                                  0498 00700000
*               IF MSCTBL=VITYPE THEN                              0498 00701000
         CLC   MSCTBL(2),@CH00223                                  0498 00702000
         BNE   @RF00498                                            0498 00703000
*                 DO;               /*                       @Z40LB64*/ 00704000
*                                                                  0499 00705000
*                   /*************************************************/ 00706000
*                   /*                                               */ 00707000
*                   /* VERIFY THAT THE VOLUME                @Z40LB64*/ 00708000
*                   /* INVENTORY ENTRY IS CHECKED-OFF        @Z40LB64*/ 00709000
*                   /*                                               */ 00710000
*                   /*************************************************/ 00711000
*                                                                  0500 00712000
*                   IF(VICHKFF(BYTE#)&BITMASK(BIT#))=0 THEN        0500 00713000
         L     @15,@PC00001+4                                      0500 00714000
         L     @14,EARGPTR(,@15)                                   0500 00715000
         LH    @01,BYTE#(,@14)                                     0500 00716000
         L     @05,VICOPTR(,@15)                                   0500 00717000
         LH    @04,BIT#(,@14)                                      0500 00718000
         AL    @05,@CF01340                                        0500 00719000
         SLR   @00,@00                                             0500 00720000
         IC    @00,VICHKFF(@01,@05)                                0500 00721000
         SLR   @05,@05                                             0500 00722000
         IC    @05,BITMASK-1(@04)                                  0500 00723000
         NR    @00,@05                                             0500 00724000
         LTR   @00,@00                                             0500 00725000
         BNZ   @RF00500                                            0500 00726000
*                     DO;           /*                       @Z40LB64*/ 00727000
*                                                                  0501 00728000
*                       /*********************************************/ 00729000
*                       /*                                           */ 00730000
*                       /* VOLUME INVENTORY ENTRY            @Z40LB64*/ 00731000
*                       /* WAS NOT CHECKED-OFF.              @Z40LB64*/ 00732000
*                       /* PRINT ERROR MESSAGE.              @Z40LB64*/ 00733000
*                       /*                                           */ 00734000
*                       /*********************************************/ 00735000
*                                                                  0502 00736000
*                       MTCHMSG=ON; /*                       @Z40LB64*/ 00737000
         L     @05,MARGPTR(,@15)                                   0502 00738000
         OI    MTCHMSG(@05),B'00010000'                            0502 00739000
*                       MSVITBL(1)=ON;/*                     @Z40LB64*/ 00740000
         OI    MSVITBL(@05),B'00001000'                            0503 00741000
*                       VITBL(2)=ON;/*                       @Z40LB64*/ 00742000
         OI    VITBL+4(@05),B'01000000'                            0504 00743000
*                       VSNFLD=ON;  /*                       @Z40LB64*/ 00744000
         OI    VSNFLD(@05),B'00000001'                             0505 00745000
*                       FLDCHAR(1)=VIVOLID;/*                @Z40LB64*/ 00746000
         MVI   FLDCHAR+6(@05),C' '                                 0506 00747000
         MVC   FLDCHAR+7(5,@05),FLDCHAR+6(@05)                     0506 00748000
         L     @04,VIENTPTR                                        0506 00749000
         MVC   FLDCHAR(6,@05),VIVOLID(@04)                         0506 00750000
*                       VSNINDEX(2)=VIVOLID;/*               @Z40LB64*/ 00751000
         MVC   VSNINDEX+24(6,@05),VIVOLID(@04)                     0507 00752000
*                       CHRINDEX(2)=PREVCHR;/*               @Z40LB64*/ 00753000
         MVC   CHRINDEX+24(5,@05),PREVCHR(@14)                     0508 00754000
*                       CALL IDCCH04(GDTTBL,CDALIST);              0509 00755000
         L     @14,@PC00001                                        0509 00756000
         ST    @14,@AL00001                                        0509 00757000
         ST    @15,@AL00001+4                                      0509 00758000
         L     @15,@CV01495                                        0509 00759000
         LA    @01,@AL00001                                        0509 00760000
         BALR  @14,@15                                             0509 00761000
*                     END;          /*                       @Z40LB64*/ 00762000
*                 END;              /*                       @Z40LB64*/ 00763000
@RF00500 DS    0H                                                  0512 00764000
*               IF MSCTBL=TVLTYPE THEN                             0512 00765000
@RF00498 CLC   MSCTBL(2),@CH00157                                  0512 00766000
         BNE   @RF00512                                            0512 00767000
*                 DO;               /*                       @Z40LB64*/ 00768000
*                                                                  0513 00769000
*                   /*************************************************/ 00770000
*                   /*                                               */ 00771000
*                   /* VERIFY THAT THE TRANSIENT             @Z40LB64*/ 00772000
*                   /* VOLUME LIST ENTRY IS                  @Z40LB64*/ 00773000
*                   /* CHECKED-OFF.                          @Z40LB64*/ 00774000
*                   /*                                               */ 00775000
*                   /*************************************************/ 00776000
*                                                                  0514 00777000
*                   IF(TVLCHKFF(BYTE#)&BITMASK(BIT#))=0 THEN       0514 00778000
         L     @15,@PC00001+4                                      0514 00779000
         L     @14,EARGPTR(,@15)                                   0514 00780000
         LH    @01,BYTE#(,@14)                                     0514 00781000
         L     @05,TVLCOPTR(,@15)                                  0514 00782000
         LH    @04,BIT#(,@14)                                      0514 00783000
         AL    @05,@CF01340                                        0514 00784000
         SLR   @00,@00                                             0514 00785000
         IC    @00,TVLCHKFF(@01,@05)                               0514 00786000
         SLR   @05,@05                                             0514 00787000
         IC    @05,BITMASK-1(@04)                                  0514 00788000
         NR    @00,@05                                             0514 00789000
         LTR   @00,@00                                             0514 00790000
         BNZ   @RF00514                                            0514 00791000
*                     DO;           /*                       @Z40LB64*/ 00792000
*                                                                  0515 00793000
*                       /*********************************************/ 00794000
*                       /*                                           */ 00795000
*                       /* TRANSIENT VOLUME LIST             @Z40LB64*/ 00796000
*                       /* ENTRY WAS NOT CHECKED             @Z40LB64*/ 00797000
*                       /* OFF. PRINT ERROR MESSAGE          @Z40LB64*/ 00798000
*                       /*                                           */ 00799000
*                       /*********************************************/ 00800000
*                                                                  0516 00801000
*                       MTCHMSG=ON; /*                       @Z40LB64*/ 00802000
         L     @05,MARGPTR(,@15)                                   0516 00803000
         OI    MTCHMSG(@05),B'00010000'                            0516 00804000
*                       MSVITBL(1)=ON;/*                     @Z40LB64*/ 00805000
         OI    MSVITBL(@05),B'00001000'                            0517 00806000
*                       TVLTBL(2)=ON;/*                      @Z40LB64*/ 00807000
         OI    TVLTBL+4(@05),B'00100000'                           0518 00808000
*                       CSNFLD=ON;  /*                       @Z40LB64*/ 00809000
         OI    CSNFLD(@05),B'10000000'                             0519 00810000
*                       FLDCHAR(1)=TVCSN;/*                  @Z40LB64*/ 00811000
         L     @04,TVENTPTR                                        0520 00812000
         MVC   FLDCHAR(12,@05),TVCSN(@04)                          0520 00813000
*                       CSNINDEX(2)=TVCSN;/*                 @Z40LB64*/ 00814000
         MVC   CSNINDEX+24(12,@05),TVCSN(@04)                      0521 00815000
*                       VSNINDEX(2)=TVVOLID;/*               @Z40LB64*/ 00816000
         MVC   VSNINDEX+24(6,@05),TVVOLID(@04)                     0522 00817000
*                       CHRINDEX(2)=PREVCHR;/*               @Z40LB64*/ 00818000
         MVC   CHRINDEX+24(5,@05),PREVCHR(@14)                     0523 00819000
*                       CALL IDCCH04(GDTTBL,CDALIST);              0524 00820000
         L     @14,@PC00001                                        0524 00821000
         ST    @14,@AL00001                                        0524 00822000
         ST    @15,@AL00001+4                                      0524 00823000
         L     @15,@CV01495                                        0524 00824000
         LA    @01,@AL00001                                        0524 00825000
         BALR  @14,@15                                             0524 00826000
*                     END;          /*                       @Z40LB64*/ 00827000
*                 END;              /*                       @Z40LB64*/ 00828000
@RF00514 DS    0H                                                  0527 00829000
*             END MSVICHKF;         /*                       @Z40LB64*/ 00830000
*                                                                  0527 00831000
@RF00512 DS    0H                                                  0528 00832000
*           /*********************************************************/ 00833000
*           /*                                                       */ 00834000
*           /* FIND THE MATCHING CELL ADDRESSES IN THE       @Z40LB64*/ 00835000
*           /* CELL MAP FOR THE SEQUENCE #1 AND SEQUENCE     @Z40LB64*/ 00836000
*           /* #2 CARTRIDGES (EXCEPT FOR THE SCRATCH         @Z40LB64*/ 00837000
*           /* CARTRIDGE LIST WHICH CONTAINS ONLY ONE        @Z40LB64*/ 00838000
*           /* CARTRIDGE ADDRESS PER ENTRY).                 @Z40LB64*/ 00839000
*           /*                                                       */ 00840000
*           /*********************************************************/ 00841000
*                                                                  0528 00842000
*CTGCHK:                                                           0528 00843000
*           DO CTGSEQ#=1 TO CTGSVOL;/*                       @Z40LB64*/ 00844000
@RF00496 DS    0H                                                  0528 00845000
CTGCHK   LA    @15,1                                               0528 00846000
         STH   @15,CTGSEQ#                                         0528 00847000
@DL00528 DS    0H                                                  0529 00848000
*             ERRFLAG=OFF;          /*                       @Z40LB64*/ 00849000
*                                                                  0529 00850000
         NI    ERRFLAG,B'01111111'                                 0529 00851000
*             /*******************************************************/ 00852000
*             /*                                                     */ 00853000
*             /* SEPARATE THE 'LZYX' ADDRESS INTO ITS        @Z40LB64*/ 00854000
*             /* INDIVIDUAL L, X, Y, AND Z COMPONENTS.       @Z40LB64*/ 00855000
*             /*                                                     */ 00856000
*             /*******************************************************/ 00857000
*                                                                  0530 00858000
*             IF MSCTBL=VITYPE THEN                                0530 00859000
         LA    @14,1                                               0530 00860000
         CH    @14,MSCTBL                                          0530 00861000
         BNE   @RF00530                                            0530 00862000
*               IF CTGSEQ#=1 THEN                                  0531 00863000
         CR    @15,@14                                             0531 00864000
         BNE   @RF00531                                            0531 00865000
*                 LZYXADDR=VILZYX1; /*                       @Z40LB64*/ 00866000
         L     @01,VIENTPTR                                        0532 00867000
         MVC   LZYXADDR(2),VILZYX1(@01)                            0532 00868000
*               ELSE                                               0533 00869000
*                 LZYXADDR=VILZYX2; /*                       @Z40LB64*/ 00870000
         B     @RC00531                                            0533 00871000
@RF00531 L     @01,VIENTPTR                                        0533 00872000
         MVC   LZYXADDR(2),VILZYX2(@01)                            0533 00873000
*             IF MSCTBL=TVLTYPE THEN                               0534 00874000
@RC00531 DS    0H                                                  0534 00875000
@RF00530 CLC   MSCTBL(2),@CH00157                                  0534 00876000
         BNE   @RF00534                                            0534 00877000
*               IF CTGSEQ#=1 THEN                                  0535 00878000
         CLC   CTGSEQ#(2),@CH00223                                 0535 00879000
         BNE   @RF00535                                            0535 00880000
*                 LZYXADDR=TVLZYX1; /*                       @Z40LB64*/ 00881000
         L     @01,TVENTPTR                                        0536 00882000
         MVC   LZYXADDR(2),TVLZYX1(@01)                            0536 00883000
*               ELSE                                               0537 00884000
*                 LZYXADDR=TVLZYX2; /*                       @Z40LB64*/ 00885000
         B     @RC00535                                            0537 00886000
@RF00535 L     @01,TVENTPTR                                        0537 00887000
         MVC   LZYXADDR(2),TVLZYX2(@01)                            0537 00888000
*             IF MSCTBL=SCLTYPE THEN                               0538 00889000
@RC00535 DS    0H                                                  0538 00890000
@RF00534 CLC   MSCTBL(2),@CH00166                                  0538 00891000
         BNE   @RF00538                                            0538 00892000
*               IF CTGSEQ#=1 THEN                                  0539 00893000
         CLC   CTGSEQ#(2),@CH00223                                 0539 00894000
         BNE   @RF00539                                            0539 00895000
*                 LZYXADDR=SCLZYX;  /*                       @Z40LB64*/ 00896000
         L     @01,SCENTPTR                                        0540 00897000
         MVC   LZYXADDR(2),SCLZYX(@01)                             0540 00898000
*               ELSE                                               0541 00899000
*                 ERRFLAG=ON;       /*                       @Z40LB64*/ 00900000
         B     @RC00539                                            0541 00901000
@RF00539 OI    ERRFLAG,B'10000000'                                 0541 00902000
*             MSFL#=LZYXADDR/LVALSHFT;/*                     @Z40LB64*/ 00903000
@RC00539 DS    0H                                                  0542 00904000
@RF00538 SLR   @15,@15                                             0542 00905000
         ICM   @15,3,LZYXADDR                                      0542 00906000
         LR    @14,@15                                             0542 00907000
         SRL   @14,14                                              0542 00908000
         STH   @14,MSFL#                                           0542 00909000
*             MSFZ#=(LZYXADDR&ZVALMASK)/ZVALSHFT;/*          @Z40LB64*/ 00910000
         SLR   @00,@00                                             0543 00911000
         ICM   @00,3,ZVALMASK                                      0543 00912000
         NR    @00,@15                                             0543 00913000
         SRL   @00,13                                              0543 00914000
         STH   @00,MSFZ#                                           0543 00915000
*             MSFY#=(LZYXADDR&YVALMASK)/YVALSHFT;/*          @Z40LB64*/ 00916000
         SLR   @02,@02                                             0544 00917000
         ICM   @02,3,YVALMASK                                      0544 00918000
         NR    @02,@15                                             0544 00919000
         SRL   @02,8                                               0544 00920000
         STH   @02,MSFY#                                           0544 00921000
*             MSFX#=(LZYXADDR&XVALMASK);/*                   @Z40LB64*/ 00922000
*                                                                  0545 00923000
         SLR   @14,@14                                             0545 00924000
         ICM   @14,3,XVALMASK                                      0545 00925000
         NR    @15,@14                                             0545 00926000
         STH   @15,MSFX#                                           0545 00927000
*             /*******************************************************/ 00928000
*             /*                                                     */ 00929000
*             /* IF THE L-VALUE DOES NOT SPECIFY A           @Z40LB64*/ 00930000
*             /* VALID MSF, PRINT AN ERROR                   @Z40LB61*/ 00931000
*             /* MESSAGE. NO COMPARISON TO THE CELL MAP      @Z40LB64*/ 00932000
*             /* IS POSSIBLE.                                @Z40LB64*/ 00933000
*             /*                                                     */ 00934000
*             /*******************************************************/ 00935000
*                                                                  0546 00936000
*             MSFFLAG=OFF;          /*                       @Z40LB64*/ 00937000
         NI    MSFFLAG,B'01111111'                                 0546 00938000
*             DO MSF#=1 TO MSFVLCNT WHILE MSFFLAG=OFF;/*     @Z40LB64*/ 00939000
         LA    @02,1                                               0547 00940000
         B     @DE00547                                            0547 00941000
@DL00547 TM    MSFFLAG,B'10000000'                                 0547 00942000
         BNZ   @DC00547                                            0547 00943000
*               IF MSFL#=VLDMSFID(MSF#) THEN                       0548 00944000
         ALR   @02,@02                                             0548 00945000
         L     @15,@PC00001+4                                      0548 00946000
         LH    @14,MSFL#                                           0548 00947000
         CH    @14,VLDMSFID-2(@02,@15)                             0548 00948000
         BNE   @RF00548                                            0548 00949000
*                 MSFFLAG=ON;       /*                       @Z40LB64*/ 00950000
         OI    MSFFLAG,B'10000000'                                 0549 00951000
*             END;                  /*                       @Z40LB64*/ 00952000
@RF00548 LA    @02,1                                               0550 00953000
         AH    @02,MSF#                                            0550 00954000
@DE00547 STH   @02,MSF#                                            0550 00955000
         L     @15,@PC00001+4                                      0550 00956000
         CH    @02,MSFVLCNT(,@15)                                  0550 00957000
         BNH   @DL00547                                            0550 00958000
@DC00547 DS    0H                                                  0551 00959000
*             IF MSFFLAG=OFF&ERRFLAG=OFF THEN                      0551 00960000
         TM    MSFFLAG,B'10000000'                                 0551 00961000
         BNZ   @RF00551                                            0551 00962000
         TM    ERRFLAG,B'10000000'                                 0551 00963000
         BNZ   @RF00551                                            0551 00964000
*               DO;                 /*                       @Z40LB64*/ 00965000
*                 MTCHMSG=ON;       /*                       @Z40LB64*/ 00966000
         L     @02,@PC00001+4                                      0553 00967000
         L     @02,MARGPTR(,@02)                                   0553 00968000
         OI    MTCHMSG(@02),B'00010000'                            0553 00969000
*                 CMTBL(1)=ON;      /*                       @Z40LB64*/ 00970000
         OI    CMTBL(@02),B'00000100'                              0554 00971000
*                 IF MSCTBL=VITYPE THEN                            0555 00972000
         CLC   MSCTBL(2),@CH00223                                  0555 00973000
         BNE   @RF00555                                            0555 00974000
*                   DO;             /*                       @Z40LB64*/ 00975000
*                     VITBL(2)=ON;  /*                       @Z40LB64*/ 00976000
         OI    VITBL+4(@02),B'01000000'                            0557 00977000
*                     VSNINDEX(2)=VIVOLID;/*                 @Z40LB64*/ 00978000
         L     @15,VIENTPTR                                        0558 00979000
         MVC   VSNINDEX+24(6,@02),VIVOLID(@15)                     0558 00980000
*                   END;            /*                       @Z40LB64*/ 00981000
*                 IF MSCTBL=TVLTYPE THEN                           0560 00982000
@RF00555 CLC   MSCTBL(2),@CH00157                                  0560 00983000
         BNE   @RF00560                                            0560 00984000
*                   DO;             /*                       @Z40LB64*/ 00985000
*                     TVLTBL(2)=ON; /*                       @Z40LB64*/ 00986000
         L     @02,@PC00001+4                                      0562 00987000
         L     @02,MARGPTR(,@02)                                   0562 00988000
         OI    TVLTBL+4(@02),B'00100000'                           0562 00989000
*                     CSNINDEX(2)=TVCSN;/*                   @Z40LB64*/ 00990000
         L     @15,TVENTPTR                                        0563 00991000
         MVC   CSNINDEX+24(12,@02),TVCSN(@15)                      0563 00992000
*                     VSNINDEX(2)=TVVOLID;/*                 @Z40LB64*/ 00993000
         MVC   VSNINDEX+24(6,@02),TVVOLID(@15)                     0564 00994000
*                   END;            /*                       @Z40LB64*/ 00995000
*                 IF MSCTBL=SCLTYPE THEN                           0566 00996000
@RF00560 CLC   MSCTBL(2),@CH00166                                  0566 00997000
         BNE   @RF00566                                            0566 00998000
*                   DO;             /*                       @Z40LB64*/ 00999000
*                     SCLTBL(2)=ON; /*                       @Z40LB64*/ 01000000
         L     @02,@PC00001+4                                      0568 01001000
         L     @02,MARGPTR(,@02)                                   0568 01002000
         OI    SCLTBL+4(@02),B'00010000'                           0568 01003000
*                     CSNINDEX(2)=SCCSN;/*                   @Z40LB64*/ 01004000
         L     @15,SCENTPTR                                        0569 01005000
         MVC   CSNINDEX+24(12,@02),SCCSN(@15)                      0569 01006000
*                     MSFINDEX(2)=MSFL#;/*                   @Z40LB64*/ 01007000
         MVC   MSFINDEX+24(1,@02),MSFL#+1                          0570 01008000
*                   END;            /*                       @Z40LB64*/ 01009000
*                 MSFFLD=ON;        /*                       @Z40LB64*/ 01010000
@RF00566 L     @02,@PC00001+4                                      0572 01011000
         L     @15,MARGPTR(,@02)                                   0572 01012000
         OI    MSFFLD(@15),B'00000010'                             0572 01013000
*                 FLDNUM(1)=MSFL#;  /*                       @Z40LB64*/ 01014000
         LH    @14,MSFL#                                           0573 01015000
         ST    @14,FLDNUM(,@15)                                    0573 01016000
*                 CHRINDEX(2)=PREVCHR;/*                     @Z40LB64*/ 01017000
         L     @14,EARGPTR(,@02)                                   0574 01018000
         MVC   CHRINDEX+24(5,@15),PREVCHR(@14)                     0574 01019000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @Z40LB64*/ 01020000
         L     @00,@PC00001                                        0575 01021000
         LR    @15,@00                                             0575 01022000
         ST    @15,@AL00001                                        0575 01023000
         ST    @02,@AL00001+4                                      0575 01024000
         L     @15,@CV01495                                        0575 01025000
         LA    @01,@AL00001                                        0575 01026000
         BALR  @14,@15                                             0575 01027000
*                 ERRFLAG=ON;       /*                       @Z40LB64*/ 01028000
         OI    ERRFLAG,B'10000000'                                 0576 01029000
*               END;                /*                       @Z40LB64*/ 01030000
*             MSF#=MSF#-1;          /*                       @Z40LB64*/ 01031000
*                                                                  0578 01032000
@RF00551 LH    @02,MSF#                                            0578 01033000
         BCTR  @02,0                                               0578 01034000
         STH   @02,MSF#                                            0578 01035000
*             /*******************************************************/ 01036000
*             /*                                                     */ 01037000
*             /* IF THE X-VALUE OR Y-VALUE IF NOT WITHIN     @Z40LB64*/ 01038000
*             /* THEIR ALLOWABLE RANGE, PRINT AN ERROR       @Z40LB64*/ 01039000
*             /* MESSAGE. NO COMPARISON TO THE CELL MAP      @Z40LB64*/ 01040000
*             /* IS POSSIBLE.                                @Z40LB64*/ 01041000
*             /*                                                     */ 01042000
*             /*******************************************************/ 01043000
*                                                                  0579 01044000
*             IF((MSFX#<(MSFXLOW(MSF#)+MSFXSTRT))|(MSFX#>=MSFXSTRT+     01045000
*                 MSFXMAX)|(MSFY#>=MSFYMAX))&ERRFLAG=OFF THEN      0579 01046000
         LH    @15,MSFX#                                           0579 01047000
         ALR   @02,@02                                             0579 01048000
         LA    @14,150                                             0579 01049000
         AH    @14,MSFXLOW-2(@02)                                  0579 01050000
         CR    @15,@14                                             0579 01051000
         BL    @GL00002                                            0579 01052000
         CH    @15,@CH01726                                        0579 01053000
         BNL   @GL00002                                            0579 01054000
         LH    @02,MSFY#                                           0579 01055000
         CH    @02,@CH01474                                        0579 01056000
         BL    @RF00579                                            0579 01057000
@GL00002 TM    ERRFLAG,B'10000000'                                 0579 01058000
         BNZ   @RF00579                                            0579 01059000
*               DO;                 /*                       @Z40LB64*/ 01060000
*                 MTCHMSG=ON;       /*                       @Z40LB64*/ 01061000
         L     @02,@PC00001+4                                      0581 01062000
         L     @02,MARGPTR(,@02)                                   0581 01063000
         OI    MTCHMSG(@02),B'00010000'                            0581 01064000
*                 CMTBL(1)=ON;      /*                       @Z40LB64*/ 01065000
         OI    CMTBL(@02),B'00000100'                              0582 01066000
*                 IF MSCTBL=VITYPE THEN                            0583 01067000
         CLC   MSCTBL(2),@CH00223                                  0583 01068000
         BNE   @RF00583                                            0583 01069000
*                   DO;             /*                       @Z40LB64*/ 01070000
*                     VITBL(2)=ON;  /*                       @Z40LB64*/ 01071000
         OI    VITBL+4(@02),B'01000000'                            0585 01072000
*                     VSNINDEX(2)=VIVOLID;/*                 @Z40LB64*/ 01073000
         L     @15,VIENTPTR                                        0586 01074000
         MVC   VSNINDEX+24(6,@02),VIVOLID(@15)                     0586 01075000
*                   END;            /*                       @Z40LB64*/ 01076000
*                 IF MSCTBL=TVLTYPE THEN                           0588 01077000
@RF00583 CLC   MSCTBL(2),@CH00157                                  0588 01078000
         BNE   @RF00588                                            0588 01079000
*                   DO;             /*                       @Z40LB64*/ 01080000
*                     TVLTBL(2)=ON; /*                       @Z40LB64*/ 01081000
         L     @02,@PC00001+4                                      0590 01082000
         L     @02,MARGPTR(,@02)                                   0590 01083000
         OI    TVLTBL+4(@02),B'00100000'                           0590 01084000
*                     CSNINDEX(2)=TVCSN;/*                   @Z40LB64*/ 01085000
         L     @15,TVENTPTR                                        0591 01086000
         MVC   CSNINDEX+24(12,@02),TVCSN(@15)                      0591 01087000
*                     VSNINDEX(2)=TVVOLID;/*                 @Z40LB64*/ 01088000
         MVC   VSNINDEX+24(6,@02),TVVOLID(@15)                     0592 01089000
*                   END;            /*                       @Z40LB64*/ 01090000
*                 IF MSCTBL=SCLTYPE THEN                           0594 01091000
@RF00588 CLC   MSCTBL(2),@CH00166                                  0594 01092000
         BNE   @RF00594                                            0594 01093000
*                   DO;             /*                       @Z40LB64*/ 01094000
*                     SCLTBL(2)=ON; /*                       @Z40LB64*/ 01095000
         L     @02,@PC00001+4                                      0596 01096000
         L     @02,MARGPTR(,@02)                                   0596 01097000
         OI    SCLTBL+4(@02),B'00010000'                           0596 01098000
*                     CSNINDEX(2)=SCCSN;/*                   @Z40LB64*/ 01099000
         L     @15,SCENTPTR                                        0597 01100000
         MVC   CSNINDEX+24(12,@02),SCCSN(@15)                      0597 01101000
*                     MSFINDEX(2)=MSFL#;/*                   @Z40LB64*/ 01102000
         MVC   MSFINDEX+24(1,@02),MSFL#+1                          0598 01103000
*                   END;            /*                       @Z40LB64*/ 01104000
*                 CAFLD=ON;         /*                       @Z40LB64*/ 01105000
@RF00594 L     @02,@PC00001+4                                      0600 01106000
         L     @15,MARGPTR(,@02)                                   0600 01107000
         OI    CAFLD(@15),B'00010000'                              0600 01108000
*                 FLDNUM(1)=LZYXADDR;/*                      @Z40LB64*/ 01109000
         SLR   @14,@14                                             0601 01110000
         ICM   @14,3,LZYXADDR                                      0601 01111000
         ST    @14,FLDNUM(,@15)                                    0601 01112000
*                 CHRINDEX(2)=PREVCHR;/*                     @Z40LB64*/ 01113000
         L     @14,EARGPTR(,@02)                                   0602 01114000
         MVC   CHRINDEX+24(5,@15),PREVCHR(@14)                     0602 01115000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @Z40LB64*/ 01116000
         L     @00,@PC00001                                        0603 01117000
         LR    @15,@00                                             0603 01118000
         ST    @15,@AL00001                                        0603 01119000
         ST    @02,@AL00001+4                                      0603 01120000
         L     @15,@CV01495                                        0603 01121000
         LA    @01,@AL00001                                        0603 01122000
         BALR  @14,@15                                             0603 01123000
*                 ERRFLAG=ON;       /*                       @Z40LB64*/ 01124000
         OI    ERRFLAG,B'10000000'                                 0604 01125000
*               END;                /*                       @Z40LB64*/ 01126000
*                                                                  0605 01127000
*             /*******************************************************/ 01128000
*             /*                                                     */ 01129000
*             /* IF THE CARTRIDGE ADDRESS IS WITHIN THE      @Z40LB64*/ 01130000
*             /* ALLOWABLE RANGE, DETERMINE THE CELL MAP     @Z40LB64*/ 01131000
*             /* MSF, BLOCK, CHUNK, AND CUBE OF THE          @Z40LB64*/ 01132000
*             /* CARTRIDGE ADDRESS.                          @Z40LB64*/ 01133000
*             /*                                                     */ 01134000
*             /*******************************************************/ 01135000
*                                                                  0606 01136000
*             IF ERRFLAG=OFF THEN                                  0606 01137000
@RF00579 TM    ERRFLAG,B'10000000'                                 0606 01138000
         BNZ   @RF00606                                            0606 01139000
*LZYXOKAY:                                                         0607 01140000
*               DO;                 /*                       @Z40LB64*/ 01141000
LZYXOKAY DS    0H                                                  0608 01142000
*                 CMBLK#=(MSFX#-MSFXSTRT)/XRNGBLK+1;/*       @Z40LB64*/ 01143000
         LA    @02,1                                               0608 01144000
         LH    @15,MSFX#                                           0608 01145000
         SH    @15,@CH01476                                        0608 01146000
         LR    @04,@15                                             0608 01147000
         SRDA  @04,32                                              0608 01148000
         D     @04,@CF00225                                        0608 01149000
         ALR   @05,@02                                             0608 01150000
         STH   @05,CMBLK#                                          0608 01151000
*                 CHUNK#=((MSFX#-MSFXSTRT)-((CMBLK#-1)*XRNGBLK))/  0609 01152000
*                     XRNGCNK+1;    /*                       @Z40LB64*/ 01153000
         LA    @14,4                                               0609 01154000
         BCTR  @05,0                                               0609 01155000
         SLA   @05,5                                               0609 01156000
         SLR   @15,@05                                             0609 01157000
         LR    @04,@15                                             0609 01158000
         SRDA  @04,32                                              0609 01159000
         DR    @04,@14                                             0609 01160000
         ALR   @05,@02                                             0609 01161000
         STH   @05,CHUNK#                                          0609 01162000
*                 XPOSCUBE=((MSFX#-MSFXSTRT)-((CMBLK#-1)*XRNGBLK))//    01163000
*                     XRNGCNK+1;    /*                       @Z40LB64*/ 01164000
         LR    @00,@15                                             0610 01165000
         SRDA  @00,32                                              0610 01166000
         D     @00,@CF00046                                        0610 01167000
         ALR   @00,@02                                             0610 01168000
         STH   @00,XPOSCUBE                                        0610 01169000
*                 CUBE#=MSFY#/YRNGCUBE+1;/*                  @Z40LB64*/ 01170000
         LH    @15,MSFY#                                           0611 01171000
         LR    @00,@15                                             0611 01172000
         SRDA  @00,32                                              0611 01173000
         DR    @00,@14                                             0611 01174000
         ALR   @01,@02                                             0611 01175000
         STH   @01,CUBE#                                           0611 01176000
*                 YPOSCUBE=MSFY#//YRNGCUBE+1;/*              @Z40LB64*/ 01177000
*                                                                  0612 01178000
         LR    @00,@15                                             0612 01179000
         SRDA  @00,32                                              0612 01180000
         D     @00,@CF00046                                        0612 01181000
         ALR   @00,@02                                             0612 01182000
         STH   @00,YPOSCUBE                                        0612 01183000
*                 /***************************************************/ 01184000
*                 /*                                                 */ 01185000
*                 /* INDEX INTO THE CELL MAP AND TEST        @Z40LB64*/ 01186000
*                 /* THE SELECTED BIT (CELL LOCATION)        @Z40LB64*/ 01187000
*                 /*                                                 */ 01188000
*                 /***************************************************/ 01189000
*                                                                  0613 01190000
*                 BLKPOS#=((CHUNK#-1)*CHUNKLEN)+((CUBE#-1)*CUBELEN)+(   01191000
*                     YPOSCUBE-1);  /*                       @Z40LB64*/ 01192000
         BCTR  @05,0                                               0613 01193000
         SLA   @05,5                                               0613 01194000
         LH    @04,CUBE#                                           0613 01195000
         BCTR  @04,0                                               0613 01196000
         SLA   @04,2                                               0613 01197000
         ALR   @05,@04                                             0613 01198000
         BCTR  @00,0                                               0613 01199000
         ALR   @05,@00                                             0613 01200000
         STH   @05,BLKPOS#                                         0613 01201000
*                 CMENTPTR=CMBUFPTR(MSF#,CMBLK#)+BLKPOS#;/*  @Z40LB64*/ 01202000
         LH    @04,CMBLK#                                          0614 01203000
         LH    @15,MSF#                                            0614 01204000
         SLA   @15,2                                               0614 01205000
         ALR   @15,@04                                             0614 01206000
         SLA   @15,2                                               0614 01207000
         L     @14,@PC00001+4                                      0614 01208000
         L     @15,CMBUFPTR-20(@15,@14)                            0614 01209000
         ALR   @15,@05                                             0614 01210000
         ST    @15,CMENTPTR                                        0614 01211000
*                 CMENTMSK=2*(XPOSCUBE-1)+MSFZ#+1;/*         @Z40LB64*/ 01212000
         LH    @01,XPOSCUBE                                        0615 01213000
         BCTR  @01,0                                               0615 01214000
         ALR   @01,@01                                             0615 01215000
         AH    @01,MSFZ#                                           0615 01216000
         ALR   @01,@02                                             0615 01217000
         STH   @01,CMENTMSK                                        0615 01218000
*                 CMENTVAL=CMENTRY&BITMASK(CMENTMSK);/*      @Z40LB64*/ 01219000
*                                                                  0616 01220000
         SLR   @02,@02                                             0616 01221000
         IC    @02,BITMASK-1(@01)                                  0616 01222000
         SLR   @01,@01                                             0616 01223000
         IC    @01,CMENTRY(,@15)                                   0616 01224000
         NR    @01,@02                                             0616 01225000
         STH   @01,CMENTVAL                                        0616 01226000
*                 /***************************************************/ 01227000
*                 /*                                                 */ 01228000
*                 /* OBTAIN THE SAME CELL LOCATION           @Z40LB64*/ 01229000
*                 /* THE ORIGINAL STATE CELL MAP TO          @Z40LB64*/ 01230000
*                 /* DETERMINE IF THE CELL IS AN             @Z40LB64*/ 01231000
*                 /* ALLOWABLE CELL.                         @Z40LB64*/ 01232000
*                 /*                                                 */ 01233000
*                 /***************************************************/ 01234000
*                                                                  0617 01235000
*                 CMENTPTR=CMBUFPTR(MSFVLCNT+1,CMBLK#)+BLKPOS#;/*  0617 01236000
*                                                            @Z40LB64*/ 01237000
         LH    @15,MSFVLCNT(,@14)                                  0617 01238000
         SLA   @15,2                                               0617 01239000
         ALR   @15,@04                                             0617 01240000
         SLA   @15,2                                               0617 01241000
         AL    @05,CMBUFPTR-4(@15,@14)                             0617 01242000
         ST    @05,CMENTPTR                                        0617 01243000
*                 CMORGVAL=CMENTRY&BITMASK(CMENTMSK);/*      @Z40LB64*/ 01244000
*                                                                  0618 01245000
         SLR   @04,@04                                             0618 01246000
         IC    @04,CMENTRY(,@05)                                   0618 01247000
         NR    @02,@04                                             0618 01248000
         STH   @02,CMORGVAL                                        0618 01249000
*                 /***************************************************/ 01250000
*                 /*                                                 */ 01251000
*                 /* DETERMINE IF THE ORIGINAL STATE         @Z40LB64*/ 01252000
*                 /* CELL MAP LOCATION SPECIFIES A           @Z40LB64*/ 01253000
*                 /* VALID CELL LOCATION.                    @Z40LB64*/ 01254000
*                 /*                                                 */ 01255000
*                 /***************************************************/ 01256000
*                                                                  0619 01257000
*                 IF CMORGVAL^=0 THEN                              0619 01258000
         LTR   @02,@02                                             0619 01259000
         BZ    @RF00619                                            0619 01260000
*CELLOKAY:                                                         0620 01261000
*                   DO;             /*                       @Z40LB64*/ 01262000
*                                                                  0620 01263000
CELLOKAY DS    0H                                                  0621 01264000
*                     /***********************************************/ 01265000
*                     /*                                             */ 01266000
*                     /* ORIGINAL STATE CELL MAP             @Z40LB64*/ 01267000
*                     /* INDICATES THAT THE CELL             @Z40LB64*/ 01268000
*                     /* LOCATION IS VALID. DETERMINE        @Z40LB64*/ 01269000
*                     /* IF THE CELL LOCATION IS             @Z40LB64*/ 01270000
*                     /* ALREADY CHECKED-OFF.                @Z40LB64*/ 01271000
*                     /*                                             */ 01272000
*                     /***********************************************/ 01273000
*                                                                  0621 01274000
*                     CMCOEPTR=CMCOPTR(MSF#,CMBLK#)+BLKPOS#;/*     0621 01275000
*                                                            @Z40LB64*/ 01276000
         LH    @02,MSF#                                            0621 01277000
         SLA   @02,2                                               0621 01278000
         AH    @02,CMBLK#                                          0621 01279000
         SLA   @02,2                                               0621 01280000
         L     @15,@PC00001+4                                      0621 01281000
         LH    @14,BLKPOS#                                         0621 01282000
         AL    @14,CMCOPTR-20(@02,@15)                             0621 01283000
         ST    @14,CMCOEPTR                                        0621 01284000
*                     CMCOVAL=CMCOENT&BITMASK(CMENTMSK);/*   @Z40LB64*/ 01285000
         SLR   @15,@15                                             0622 01286000
         IC    @15,CMCOENT(,@14)                                   0622 01287000
         LH    @01,CMENTMSK                                        0622 01288000
         SLR   @02,@02                                             0622 01289000
         IC    @02,BITMASK-1(@01)                                  0622 01290000
         LR    @05,@15                                             0622 01291000
         NR    @05,@02                                             0622 01292000
         STH   @05,CMCOVAL                                         0622 01293000
*                     IF CMCOVAL=0 THEN                            0623 01294000
*                                                                  0623 01295000
         LTR   @05,@05                                             0623 01296000
         BNZ   @RF00623                                            0623 01297000
*                       /*********************************************/ 01298000
*                       /*                                           */ 01299000
*                       /* CELL MAP CELL LOCATION            @Z40LB64*/ 01300000
*                       /* IS NOT CHECKED-OFF.               @Z40LB64*/ 01301000
*                       /* CHECK-OFF THE LOCATION            @Z40LB64*/ 01302000
*                       /* AT THIS TIME.                     @Z40LB64*/ 01303000
*                       /*                                           */ 01304000
*                       /*********************************************/ 01305000
*                                                                  0624 01306000
*                       CMCOENT=CMCOENT|BITMASK(CMENTMSK);         0624 01307000
         OR    @15,@02                                             0624 01308000
         STC   @15,CMCOENT(,@14)                                   0624 01309000
*                     ELSE                                         0625 01310000
*                                                                  0625 01311000
*                       /*********************************************/ 01312000
*                       /*                                           */ 01313000
*                       /* CELL MAP LOCATION IS              @Z40LB64*/ 01314000
*                       /* ALREADY CHECKED-OFF.              @Z40LB64*/ 01315000
*                       /* PRINT ERROR MESSAGE.              @Z40LB64*/ 01316000
*                       /*                                           */ 01317000
*                       /*********************************************/ 01318000
*                                                                  0625 01319000
*                       DO;         /*                       @Z40LB64*/ 01320000
         B     @RC00623                                            0625 01321000
@RF00623 DS    0H                                                  0626 01322000
*                         DUPLMSG=ON;/*                      @Z40LB64*/ 01323000
         L     @02,@PC00001+4                                      0626 01324000
         L     @02,MARGPTR(,@02)                                   0626 01325000
         OI    DUPLMSG(@02),B'01000000'                            0626 01326000
*                         CAFLD=ON; /*                       @Z40LB64*/ 01327000
         OI    CAFLD(@02),B'00010000'                              0627 01328000
*                         FLDNUM(1)=LZYXADDR;/*              @Z40LB64*/ 01329000
         SLR   @15,@15                                             0628 01330000
         ICM   @15,3,LZYXADDR                                      0628 01331000
         ST    @15,FLDNUM(,@02)                                    0628 01332000
*                         IF MSCTBL=VITYPE THEN                    0629 01333000
         CLC   MSCTBL(2),@CH00223                                  0629 01334000
         BNE   @RF00629                                            0629 01335000
*                           DO;     /*                       @Z40LB64*/ 01336000
*                             VITBL(1)=ON;/*                 @Z40LB64*/ 01337000
         OI    VITBL(@02),B'01000000'                              0631 01338000
*                             VSNINDEX(1)=VIVOLID;                 0632 01339000
         L     @01,VIENTPTR                                        0632 01340000
         MVC   VSNINDEX(6,@02),VIVOLID(@01)                        0632 01341000
*                           END;    /*                       @Z40LB64*/ 01342000
*                         IF MSCTBL=TVLTYPE THEN                   0634 01343000
@RF00629 CLC   MSCTBL(2),@CH00157                                  0634 01344000
         BNE   @RF00634                                            0634 01345000
*                           DO;     /*                       @Z40LB64*/ 01346000
*                             TVLTBL(1)=ON;/*                @Z40LB64*/ 01347000
         L     @02,@PC00001+4                                      0636 01348000
         L     @02,MARGPTR(,@02)                                   0636 01349000
         OI    TVLTBL(@02),B'00100000'                             0636 01350000
*                             CSNINDEX(1)=TVCSN;                   0637 01351000
         L     @15,TVENTPTR                                        0637 01352000
         MVC   CSNINDEX(12,@02),TVCSN(@15)                         0637 01353000
*                             VSNINDEX(1)=TVVOLID;                 0638 01354000
         MVC   VSNINDEX(6,@02),TVVOLID(@15)                        0638 01355000
*                           END;    /*                       @Z40LB64*/ 01356000
*                         IF MSCTBL=SCLTYPE THEN                   0640 01357000
@RF00634 CLC   MSCTBL(2),@CH00166                                  0640 01358000
         BNE   @RF00640                                            0640 01359000
*                           DO;     /*                       @Z40LB64*/ 01360000
*                             SCLTBL(1)=ON;/*                @Z40LB64*/ 01361000
         L     @02,@PC00001+4                                      0642 01362000
         L     @02,MARGPTR(,@02)                                   0642 01363000
         OI    SCLTBL(@02),B'00010000'                             0642 01364000
*                             CSNINDEX(1)=SCCSN;                   0643 01365000
         L     @01,SCENTPTR                                        0643 01366000
         MVC   CSNINDEX(12,@02),SCCSN(@01)                         0643 01367000
*                             MSFINDEX(1)=MSFL#;                   0644 01368000
         MVC   MSFINDEX(1,@02),MSFL#+1                             0644 01369000
*                           END;    /*                       @Z40LB64*/ 01370000
*                         CHRINDEX(1)=PREVCHR;/*             @Z40LB64*/ 01371000
@RF00640 L     @02,@PC00001+4                                      0646 01372000
         L     @01,MARGPTR(,@02)                                   0646 01373000
         L     @15,EARGPTR(,@02)                                   0646 01374000
         MVC   CHRINDEX(5,@01),PREVCHR(@15)                        0646 01375000
*                         CALL IDCCH04(GDTTBL,/*             @Z40LB64*/ 01376000
*                             CDALIST,LASTCOND);/*           @Z40LB64*/ 01377000
         L     @15,@PC00001                                        0647 01378000
         ST    @15,@AL00001                                        0647 01379000
         ST    @02,@AL00001+4                                      0647 01380000
         L     @02,@PC00001+8                                      0647 01381000
         ST    @02,@AL00001+8                                      0647 01382000
         L     @15,@CV01495                                        0647 01383000
         LA    @01,@AL00001                                        0647 01384000
         BALR  @14,@15                                             0647 01385000
*                         IF LASTCOND^=0 THEN                      0648 01386000
         L     @02,@PC00001+8                                      0648 01387000
         ICM   @15,3,LASTCOND(@02)                                 0648 01388000
         BNZ   @RT00648                                            0648 01389000
*                           RETURN; /*                       @Z40LB64*/ 01390000
*                       END;        /*                       @Z40LB64*/ 01391000
*                                                                  0650 01392000
*                     /***********************************************/ 01393000
*                     /*                                             */ 01394000
*                     /* IF THE CELL MAP SPECIFIES           @Z40LB64*/ 01395000
*                     /* THAT THE CELL LOCATION IS           @Z40LB64*/ 01396000
*                     /* EMPTY, PRINT ERROR MESSAGE.         @Z40LB64*/ 01397000
*                     /*                                             */ 01398000
*                     /***********************************************/ 01399000
*                                                                  0651 01400000
*                     IF CMENTVAL^=0 THEN                          0651 01401000
@RC00623 ICM   @02,3,CMENTVAL                                      0651 01402000
         BZ    @RF00651                                            0651 01403000
*                       DO;         /*                       @Z40LB64*/ 01404000
*                         INCNMSG=ON;/*                      @Z40LB64*/ 01405000
         L     @02,@PC00001+4                                      0653 01406000
         L     @02,MARGPTR(,@02)                                   0653 01407000
         OI    INCNMSG(@02),B'10000000'                            0653 01408000
*                         CMTBL(1)=ON;/*                     @Z40LB64*/ 01409000
         OI    CMTBL(@02),B'00000100'                              0654 01410000
*                         IF MSCTBL=VITYPE THEN                    0655 01411000
         CLC   MSCTBL(2),@CH00223                                  0655 01412000
         BNE   @RF00655                                            0655 01413000
*                           DO;     /*                       @Z40LB64*/ 01414000
*                             VITBL(2)=ON;/*                 @Z40LB64*/ 01415000
         OI    VITBL+4(@02),B'01000000'                            0657 01416000
*                             VSNINDEX(2)=VIVOLID;                 0658 01417000
         L     @01,VIENTPTR                                        0658 01418000
         MVC   VSNINDEX+24(6,@02),VIVOLID(@01)                     0658 01419000
*                           END;    /*                       @Z40LB64*/ 01420000
*                         IF MSCTBL=TVLTYPE THEN                   0660 01421000
@RF00655 CLC   MSCTBL(2),@CH00157                                  0660 01422000
         BNE   @RF00660                                            0660 01423000
*                           DO;     /*                       @Z40LB64*/ 01424000
*                             TVLTBL(2)=ON;/*                @Z40LB64*/ 01425000
         L     @02,@PC00001+4                                      0662 01426000
         L     @02,MARGPTR(,@02)                                   0662 01427000
         OI    TVLTBL+4(@02),B'00100000'                           0662 01428000
*                             CSNINDEX(2)=TVCSN;                   0663 01429000
         L     @15,TVENTPTR                                        0663 01430000
         MVC   CSNINDEX+24(12,@02),TVCSN(@15)                      0663 01431000
*                             VSNINDEX(2)=TVVOLID;                 0664 01432000
         MVC   VSNINDEX+24(6,@02),TVVOLID(@15)                     0664 01433000
*                           END;    /*                       @Z40LB64*/ 01434000
*                         IF MSCTBL=SCLTYPE THEN                   0666 01435000
@RF00660 CLC   MSCTBL(2),@CH00166                                  0666 01436000
         BNE   @RF00666                                            0666 01437000
*                           DO;     /*                       @Z40LB64*/ 01438000
*                             SCLTBL(2)=ON;/*                @Z40LB64*/ 01439000
         L     @02,@PC00001+4                                      0668 01440000
         L     @02,MARGPTR(,@02)                                   0668 01441000
         OI    SCLTBL+4(@02),B'00010000'                           0668 01442000
*                             CSNINDEX(2)=SCCSN;                   0669 01443000
         L     @01,SCENTPTR                                        0669 01444000
         MVC   CSNINDEX+24(12,@02),SCCSN(@01)                      0669 01445000
*                             MSFINDEX(2)=MSFL#;                   0670 01446000
         MVC   MSFINDEX+24(1,@02),MSFL#+1                          0670 01447000
*                           END;    /*                       @Z40LB64*/ 01448000
*                         COSFLD=ON;/*                       @Z40LB64*/ 01449000
@RF00666 L     @02,@PC00001+4                                      0672 01450000
         L     @15,MARGPTR(,@02)                                   0672 01451000
         OI    COSFLD(@15),B'00001000'                             0672 01452000
*                         FLDCHAR(1)=STATNO;/*               @Z40LB64*/ 01453000
         MVI   FLDCHAR+3(@15),C' '                                 0673 01454000
         MVC   FLDCHAR+4(8,@15),FLDCHAR+3(@15)                     0673 01455000
         MVC   FLDCHAR(3,@15),@CC01345                             0673 01456000
*                         FLDCHAR(2)=STATYES;/*              @Z40LB64*/ 01457000
         MVI   FLDCHAR+15(@15),C' '                                0674 01458000
         MVC   FLDCHAR+16(8,@15),FLDCHAR+15(@15)                   0674 01459000
         MVC   FLDCHAR+12(3,@15),@CC01343                          0674 01460000
*                         MSFINDEX(1)=MSFL#;/*               @Z40LB64*/ 01461000
         MVC   MSFINDEX(1,@15),MSFL#+1                             0675 01462000
*                         XYZINDEX(1)=LZYXADDR;/*            @Z40LB64*/ 01463000
         MVC   XYZINDEX(2,@15),LZYXADDR                            0676 01464000
*                         CHRINDEX(1)=CMCHR(MSF#,CMBLK#);          0677 01465000
         LH    @14,MSF#                                            0677 01466000
         SLA   @14,2                                               0677 01467000
         AH    @14,CMBLK#                                          0677 01468000
         MH    @14,@CH00290                                        0677 01469000
         LA    @01,CMCHR-25(@14)                                   0677 01470000
         MVC   CHRINDEX(5,@15),0(@01)                              0677 01471000
*                         CHRINDEX(2)=PREVCHR;/*             @Z40LB64*/ 01472000
         L     @01,EARGPTR(,@02)                                   0678 01473000
         MVC   CHRINDEX+24(5,@15),PREVCHR(@01)                     0678 01474000
*                         CALL IDCCH04(GDTTBL,CDALIST);            0679 01475000
         L     @15,@PC00001                                        0679 01476000
         ST    @15,@AL00001                                        0679 01477000
         ST    @02,@AL00001+4                                      0679 01478000
         L     @15,@CV01495                                        0679 01479000
         LA    @01,@AL00001                                        0679 01480000
         BALR  @14,@15                                             0679 01481000
*                       END;        /*                       @Z40LB64*/ 01482000
*                   END CELLOKAY;   /*                       @Z40LB64*/ 01483000
*                 ELSE                                             0682 01484000
*CELLBAD:                                                          0682 01485000
*                   DO;             /*                       @Z40LB64*/ 01486000
*                                                                  0682 01487000
         B     @RC00619                                            0682 01488000
@RF00619 DS    0H                                                  0682 01489000
CELLBAD  DS    0H                                                  0683 01490000
*                     /***********************************************/ 01491000
*                     /*                                             */ 01492000
*                     /* ORIGINAL CELL MAP INDICATES         @Z40LB64*/ 01493000
*                     /* THAT THE CELL LOCATION IS           @Z40LB64*/ 01494000
*                     /* NOT AN ALLOWABLE LOCATION.          @Z40LB64*/ 01495000
*                     /* PRINT AN ERROR MESSAGE.             @Z40LB64*/ 01496000
*                     /*                                             */ 01497000
*                     /***********************************************/ 01498000
*                                                                  0683 01499000
*                     MTCHMSG=ON;   /*                       @Z40LB64*/ 01500000
         L     @02,@PC00001+4                                      0683 01501000
         L     @02,MARGPTR(,@02)                                   0683 01502000
         OI    MTCHMSG(@02),B'00010000'                            0683 01503000
*                     CMTBL(1)=ON;  /*                       @Z40LB64*/ 01504000
         OI    CMTBL(@02),B'00000100'                              0684 01505000
*                     IF MSCTBL=VITYPE THEN                        0685 01506000
         CLC   MSCTBL(2),@CH00223                                  0685 01507000
         BNE   @RF00685                                            0685 01508000
*                       DO;         /*                       @Z40LB64*/ 01509000
*                         VITBL(2)=ON;/*                     @Z40LB64*/ 01510000
         OI    VITBL+4(@02),B'01000000'                            0687 01511000
*                         VSNINDEX(2)=VIVOLID;/*             @Z40LB64*/ 01512000
         L     @01,VIENTPTR                                        0688 01513000
         MVC   VSNINDEX+24(6,@02),VIVOLID(@01)                     0688 01514000
*                       END;        /*                       @Z40LB64*/ 01515000
*                     IF MSCTBL=TVLTYPE THEN                       0690 01516000
@RF00685 CLC   MSCTBL(2),@CH00157                                  0690 01517000
         BNE   @RF00690                                            0690 01518000
*                       DO;         /*                       @Z40LB64*/ 01519000
*                         TVLTBL(2)=ON;/*                    @Z40LB64*/ 01520000
         L     @02,@PC00001+4                                      0692 01521000
         L     @02,MARGPTR(,@02)                                   0692 01522000
         OI    TVLTBL+4(@02),B'00100000'                           0692 01523000
*                         CSNINDEX(2)=TVCSN;/*               @Z40LB64*/ 01524000
         L     @15,TVENTPTR                                        0693 01525000
         MVC   CSNINDEX+24(12,@02),TVCSN(@15)                      0693 01526000
*                         VSNINDEX(2)=TVVOLID;/*             @Z40LB64*/ 01527000
         MVC   VSNINDEX+24(6,@02),TVVOLID(@15)                     0694 01528000
*                       END;        /*                       @Z40LB64*/ 01529000
*                     IF MSCTBL=SCLTYPE THEN                       0696 01530000
@RF00690 CLC   MSCTBL(2),@CH00166                                  0696 01531000
         BNE   @RF00696                                            0696 01532000
*                       DO;         /*                       @Z40LB64*/ 01533000
*                         SCLTBL(2)=ON;/*                    @Z40LB64*/ 01534000
         L     @02,@PC00001+4                                      0698 01535000
         L     @02,MARGPTR(,@02)                                   0698 01536000
         OI    SCLTBL+4(@02),B'00010000'                           0698 01537000
*                         CSNINDEX(2)=SCCSN;/*               @Z40LB64*/ 01538000
         L     @01,SCENTPTR                                        0699 01539000
         MVC   CSNINDEX+24(12,@02),SCCSN(@01)                      0699 01540000
*                         MSFINDEX(2)=MSFL#;/*               @Z40LB64*/ 01541000
         MVC   MSFINDEX+24(1,@02),MSFL#+1                          0700 01542000
*                       END;        /*                       @Z40LB64*/ 01543000
*                     CAFLD=ON;     /*                       @Z40LB64*/ 01544000
@RF00696 L     @02,@PC00001+4                                      0702 01545000
         L     @15,MARGPTR(,@02)                                   0702 01546000
         OI    CAFLD(@15),B'00010000'                              0702 01547000
*                     FLDNUM(1)=LZYXADDR;/*                  @Z40LB64*/ 01548000
         SLR   @14,@14                                             0703 01549000
         ICM   @14,3,LZYXADDR                                      0703 01550000
         ST    @14,FLDNUM(,@15)                                    0703 01551000
*                     CHRINDEX(2)=PREVCHR;/*                 @Z40LB64*/ 01552000
         L     @01,EARGPTR(,@02)                                   0704 01553000
         MVC   CHRINDEX+24(5,@15),PREVCHR(@01)                     0704 01554000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB64*/ 01555000
         L     @15,@PC00001                                        0705 01556000
         ST    @15,@AL00001                                        0705 01557000
         ST    @02,@AL00001+4                                      0705 01558000
         L     @15,@CV01495                                        0705 01559000
         LA    @01,@AL00001                                        0705 01560000
         BALR  @14,@15                                             0705 01561000
*                   END CELLBAD;    /*                       @Z40LB64*/ 01562000
*               END LZYXOKAY;       /*                       @Z40LB64*/ 01563000
@RC00619 DS    0H                                                  0708 01564000
*           END CTGCHK;             /*                       @Z40LB64*/ 01565000
@RF00606 LA    @15,1                                               0708 01566000
         AH    @15,CTGSEQ#                                         0708 01567000
         STH   @15,CTGSEQ#                                         0708 01568000
         CH    @15,@CH00157                                        0708 01569000
         BNH   @DL00528                                            0708 01570000
*         END CMCHK;                /*                       @Z40LB64*/ 01571000
*                                                                  0709 01572000
*       /*************************************************************/ 01573000
*       /*                                                           */ 01574000
*       /* IF THE END OF ONE OF THE MSC TABLES (VI, TVL,     @Z40LB64*/ 01575000
*       /* SCL) WAS REACHED, PREPARE TO SCAN THE NEXT        @Z40LB64*/ 01576000
*       /* MSC TABLE. IN THE CASE OF THE SCRATCH CARTRIDGE   @Z40LB64*/ 01577000
*       /* LIST, AN INDIVIDUAL SCAN IS PERFORMED FOR EACH    @Z40LB64*/ 01578000
*       /* VALID MSF.                                        @Z40LB64*/ 01579000
*       /*                                                           */ 01580000
*       /*************************************************************/ 01581000
*                                                                  0710 01582000
*       IF GETRC=ENDOFTBL THEN                                     0710 01583000
@RF00488 L     @02,@PC00001+4                                      0710 01584000
         L     @01,EARGPTR(,@02)                                   0710 01585000
         CLC   GETRC(2,@01),@CH00046                               0710 01586000
         BNE   @RF00710                                            0710 01587000
*         DO;                       /*                       @Z40LB64*/ 01588000
*           IF MSCTBL=SCLTYPE THEN                                 0712 01589000
         CLC   MSCTBL(2),@CH00166                                  0712 01590000
         BNE   @RF00712                                            0712 01591000
*             IF SCLMSF#=MSFVLCNT THEN                             0713 01592000
         CLC   SCLMSF#(2),MSFVLCNT(@02)                            0713 01593000
         BNE   @RF00713                                            0713 01594000
*               ENDFLAG=ON;         /*                       @Z40LB64*/ 01595000
         OI    ENDFLAG,B'10000000'                                 0714 01596000
*             ELSE                                                 0715 01597000
*               DO;                 /*                       @Z40LB64*/ 01598000
         B     @RC00713                                            0715 01599000
@RF00713 DS    0H                                                  0716 01600000
*                 SCLMSF#=SCLMSF#+1;/*                       @Z40LB64*/ 01601000
         LA    @02,1                                               0716 01602000
         AH    @02,SCLMSF#                                         0716 01603000
         STH   @02,SCLMSF#                                         0716 01604000
*                 TBLADDR=0;        /*                       @Z40LB64*/ 01605000
         L     @02,@PC00001+4                                      0717 01606000
         L     @01,EARGPTR(,@02)                                   0717 01607000
         SLR   @00,@00                                             0717 01608000
         ST    @00,TBLADDR(,@01)                                   0717 01609000
*               END;                /*                       @Z40LB64*/ 01610000
*           ELSE                                                   0719 01611000
*             ENDFLAG=ON;           /*                       @Z40LB64*/ 01612000
         B     @RC00712                                            0719 01613000
@RF00712 OI    ENDFLAG,B'10000000'                                 0719 01614000
*         END;                      /*                       @Z40LB64*/ 01615000
*                                                                  0720 01616000
@RC00712 DS    0H                                                  0721 01617000
*       /*************************************************************/ 01618000
*       /*                                                           */ 01619000
*       /* IF AN ERROR WAS ENCOUNTERED WHILE TRYING TO       @Z40LB64*/ 01620000
*       /* OBTAIN AN ENTRY FROM ONE OF THE MSC TABLES,       @Z40LB64*/ 01621000
*       /* TERMINATE CHECKMSS PROCESSING.                    @Z40LB64*/ 01622000
*       /*                                                           */ 01623000
*       /*************************************************************/ 01624000
*                                                                  0721 01625000
*       IF GETRC=TABLERR THEN                                      0721 01626000
@RF00710 LA    @02,12                                              0721 01627000
         L     @15,@PC00001+4                                      0721 01628000
         L     @01,EARGPTR(,@15)                                   0721 01629000
         CH    @02,GETRC(,@01)                                     0721 01630000
         BNE   @RF00721                                            0721 01631000
*         DO;                       /*                       @Z40LB64*/ 01632000
*           LASTCOND=LASTCC12;      /*                       @Z40LB64*/ 01633000
         L     @15,@PC00001+8                                      0723 01634000
         STH   @02,LASTCOND(,@15)                                  0723 01635000
*           RETURN;                 /*                       @Z40LB64*/ 01636000
         B     @EL00002                                            0724 01637000
*         END;                      /*                       @Z40LB64*/ 01638000
*     END TBLREAD;                  /*                       @Z40LB64*/ 01639000
@RF00721 DS    0H                                                  0726 01640000
@DE00476 TM    ENDFLAG,B'10000000'                                 0726 01641000
         BZ    @DL00476                                            0726 01642000
*   END MSCTBLS;                    /*                       @Z40LB64*/ 01643000
*                                                                  0727 01644000
         LA    @15,1                                               0727 01645000
         AH    @15,MSCTBL                                          0727 01646000
         STH   @15,MSCTBL                                          0727 01647000
         CH    @15,@CH00166                                        0727 01648000
         BNH   @DL00473                                            0727 01649000
*   /*****************************************************************/ 01650000
*   /*                                                               */ 01651000
*   /* THE MSC VOLUME INVENTORY, TRANSIENT VOLUME LIST, AND  @Z40LB64*/ 01652000
*   /* SCRATCH CARTRIDGE LIST SHOULD HAVE ACCOUNTED FOR      @Z40LB64*/ 01653000
*   /* EVERY FULL CELL LOCATION IN THE CELL MAP. SCAN THE    @Z40LB64*/ 01654000
*   /* ENTIRE CELL MAP TO VERIFY THAT ALL ALLOWABLE FULL     @Z40LB64*/ 01655000
*   /* CELL LOCATIONS HAVE BEEN CHECKED-OFF.                 @Z40LB64*/ 01656000
*   /* SCAN THE CELL MAP OF EACH VALID MSF.                  @Z40LB64*/ 01657000
*   /*                                                               */ 01658000
*   /*****************************************************************/ 01659000
*                                                                  0728 01660000
*MSFSCAN:                                                          0728 01661000
*   DO MSF#=1 TO MSFVLCNT;          /*                       @Z40LB64*/ 01662000
MSFSCAN  LA    @02,1                                               0728 01663000
         B     @DE00728                                            0728 01664000
@DL00728 DS    0H                                                  0729 01665000
*     MSFL#=VLDMSFID(MSF#);         /*                       @Z40LB64*/ 01666000
         ALR   @02,@02                                             0729 01667000
         L     @15,@PC00001+4                                      0729 01668000
         LH    @02,VLDMSFID-2(@02,@15)                             0729 01669000
         STH   @02,MSFL#                                           0729 01670000
*     MSFX#=1;                      /*                       @Z40LB64*/ 01671000
*                                                                  0730 01672000
         MVC   MSFX#(2),@CH00223                                   0730 01673000
*     /***************************************************************/ 01674000
*     /*                                                             */ 01675000
*     /* FOR EACH VALID MSF, SCAN EACH DATA BLOCK            @Z40LB64*/ 01676000
*     /*                                                             */ 01677000
*     /***************************************************************/ 01678000
*                                                                  0731 01679000
*BLKSCAN:                                                          0731 01680000
*     DO CMBLK#=1 TO BLKSMSF;       /*                       @Z40LB64*/ 01681000
*                                                                  0731 01682000
BLKSCAN  LA    @02,1                                               0731 01683000
         STH   @02,CMBLK#                                          0731 01684000
@DL00731 DS    0H                                                  0732 01685000
*       /*************************************************************/ 01686000
*       /*                                                           */ 01687000
*       /* FOR EACH DATA BLOCK, SCAN EACH CELL MAP CHUNK     @Z40LB64*/ 01688000
*       /*                                                           */ 01689000
*       /*************************************************************/ 01690000
*                                                                  0732 01691000
*CHNKSCAN:                                                         0732 01692000
*       DO CHUNK#=1 TO CNKSBLK;     /*                       @Z40LB64*/ 01693000
CHNKSCAN LA    @02,1                                               0732 01694000
         STH   @02,CHUNK#                                          0732 01695000
@DL00732 DS    0H                                                  0733 01696000
*         MSFY#=0;                  /*                       @Z40LB64*/ 01697000
         SLR   @02,@02                                             0733 01698000
         STH   @02,MSFY#                                           0733 01699000
*         XINCREAS=0;               /*                       @Z40LB64*/ 01700000
*                                                                  0734 01701000
         STH   @02,XINCREAS                                        0734 01702000
*         /***********************************************************/ 01703000
*         /*                                                         */ 01704000
*         /* FOR EACH CELL MAP CHUNK, SCAN EACH CUBE         @Z40LB64*/ 01705000
*         /*                                                         */ 01706000
*         /***********************************************************/ 01707000
*                                                                  0735 01708000
*CUBESCAN:                                                         0735 01709000
*         DO CUBE#=1 TO CUBESCNK;   /*                       @Z40LB64*/ 01710000
*                                                                  0735 01711000
CUBESCAN LA    @02,1                                               0735 01712000
         STH   @02,CUBE#                                           0735 01713000
@DL00735 DS    0H                                                  0736 01714000
*           /*********************************************************/ 01715000
*           /*                                                       */ 01716000
*           /* FOR EACH CELL MAP CUBE, SCAN EACH BYTE        @Z40LB64*/ 01717000
*           /*                                                       */ 01718000
*           /*********************************************************/ 01719000
*                                                                  0736 01720000
*BYTESCAN:                                                         0736 01721000
*           DO CUBEBYTE=1 TO CUBELEN;/*                      @Z40LB64*/ 01722000
BYTESCAN LA    @02,1                                               0736 01723000
         STH   @02,CUBEBYTE                                        0736 01724000
@DL00736 DS    0H                                                  0737 01725000
*             MSFY#=MSFY#+1;        /*                       @Z40LB64*/ 01726000
         LA    @15,1                                               0737 01727000
         AH    @15,MSFY#                                           0737 01728000
         STH   @15,MSFY#                                           0737 01729000
*             BLKPOS#=((CHUNK#-1)*CHUNKLEN)+((CUBE#-1)*CUBELEN)+(  0738 01730000
*                 CUBEBYTE-1);      /*                       @Z40LB64*/ 01731000
*                                                                  0738 01732000
         LH    @15,CHUNK#                                          0738 01733000
         BCTR  @15,0                                               0738 01734000
         SLA   @15,5                                               0738 01735000
         LH    @14,CUBE#                                           0738 01736000
         BCTR  @14,0                                               0738 01737000
         SLA   @14,2                                               0738 01738000
         ALR   @15,@14                                             0738 01739000
         BCTR  @02,0                                               0738 01740000
         ALR   @15,@02                                             0738 01741000
         STH   @15,BLKPOS#                                         0738 01742000
*             /*******************************************************/ 01743000
*             /*                                                     */ 01744000
*             /* IF X-VALUE IS WITHIN THE ALLOWABLE RANGE    @Z40LB64*/ 01745000
*             /* FOR THIS MSF, SCAN EACH BIT IN THE BYTE     @Z40LB64*/ 01746000
*             /*                                                     */ 01747000
*             /*******************************************************/ 01748000
*                                                                  0739 01749000
*             IF MSFX#+XINCREAS-1>=MSFXLOW(MSF#) THEN              0739 01750000
         LH    @02,MSFX#                                           0739 01751000
         AH    @02,XINCREAS                                        0739 01752000
         BCTR  @02,0                                               0739 01753000
         LH    @15,MSF#                                            0739 01754000
         ALR   @15,@15                                             0739 01755000
         CH    @02,MSFXLOW-2(@15)                                  0739 01756000
         BL    @RF00739                                            0739 01757000
*BITSCAN:                                                          0740 01758000
*               DO CUBEBIT=(2*XINCREAS)+1 TO BITSBYTE;/*     @Z40LB64*/ 01759000
BITSCAN  LH    @02,XINCREAS                                        0740 01760000
         ALR   @02,@02                                             0740 01761000
         AH    @02,@CH00223                                        0740 01762000
         B     @DE00740                                            0740 01763000
@DL00740 DS    0H                                                  0741 01764000
*                 MSFZ#=(CUBEBIT+1)//2;/*                    @Z40LB64*/ 01765000
*                                                                  0741 01766000
         LA    @00,1                                               0741 01767000
         ALR   @00,@02                                             0741 01768000
         SRDA  @00,32                                              0741 01769000
         D     @00,@CF00157                                        0741 01770000
         STH   @00,MSFZ#                                           0741 01771000
*                 /***************************************************/ 01772000
*                 /*                                                 */ 01773000
*                 /* DETERMINE IF THE ORIGINAL STATE         @Z40LB64*/ 01774000
*                 /* CELL MAP SPECIFIES THAT THE CELL        @Z40LB64*/ 01775000
*                 /* LOCATION IS AN ALLOWABLE LOCATION.      @Z40LB64*/ 01776000
*                 /*                                                 */ 01777000
*                 /***************************************************/ 01778000
*                                                                  0742 01779000
*                 CMENTPTR=CMBUFPTR(MSFVLCNT+1,CMBLK#)+BLKPOS#;/*  0742 01780000
*                                                            @Z40LB64*/ 01781000
         L     @15,@PC00001+4                                      0742 01782000
         LH    @14,MSFVLCNT(,@15)                                  0742 01783000
         SLA   @14,2                                               0742 01784000
         AH    @14,CMBLK#                                          0742 01785000
         SLA   @14,2                                               0742 01786000
         LH    @05,BLKPOS#                                         0742 01787000
         AL    @05,CMBUFPTR-4(@14,@15)                             0742 01788000
         ST    @05,CMENTPTR                                        0742 01789000
*                 IF(CMENTRY&BITMASK(CUBEBIT))^=0 THEN             0743 01790000
         SLR   @04,@04                                             0743 01791000
         IC    @04,CMENTRY(,@05)                                   0743 01792000
         SLR   @05,@05                                             0743 01793000
         IC    @05,BITMASK-1(@02)                                  0743 01794000
         NR    @04,@05                                             0743 01795000
         LTR   @04,@04                                             0743 01796000
         BZ    @RF00743                                            0743 01797000
*CELLVLD:                                                          0744 01798000
*                   DO;             /*                       @Z40LB64*/ 01799000
*                                                                  0744 01800000
CELLVLD  DS    0H                                                  0745 01801000
*                     /***********************************************/ 01802000
*                     /*                                             */ 01803000
*                     /* CELL LOCATION IS AN ALLOWABLE       @Z40LB64*/ 01804000
*                     /* LOCATION. IF CELL LOCATION IS       @Z40LB64*/ 01805000
*                     /* FOR THE LOW X VALUE, Y=0, Z=0       @Z40LB64*/ 01806000
*                     /* THE CELL IS A RESERVED CELL,        @Z40LB64*/ 01807000
*                     /* AND IS TREATED AS EMTPY.            @Z40LB64*/ 01808000
*                     /*                                             */ 01809000
*                     /***********************************************/ 01810000
*                                                                  0745 01811000
*                     CMENTPTR=CMBUFPTR(MSF#,CMBLK#)+BLKPOS#;/*    0745 01812000
*                                                            @Z40LB64*/ 01813000
         LH    @02,MSF#                                            0745 01814000
         LR    @15,@02                                             0745 01815000
         SLA   @15,2                                               0745 01816000
         AH    @15,CMBLK#                                          0745 01817000
         SLA   @15,2                                               0745 01818000
         L     @14,@PC00001+4                                      0745 01819000
         LH    @05,BLKPOS#                                         0745 01820000
         AL    @05,CMBUFPTR-20(@15,@14)                            0745 01821000
         ST    @05,CMENTPTR                                        0745 01822000
*                     IF(MSFX#-1=MSFXLOW(MSF#))&(MSFY#=1)&(MSFZ#=0)     01823000
*                       THEN                                       0746 01824000
         LH    @04,MSFX#                                           0746 01825000
         BCTR  @04,0                                               0746 01826000
         ALR   @02,@02                                             0746 01827000
         CH    @04,MSFXLOW-2(@02)                                  0746 01828000
         BNE   @RF00746                                            0746 01829000
         CLC   MSFY#(2),@CH00223                                   0746 01830000
         BNE   @RF00746                                            0746 01831000
         ICM   @04,3,MSFZ#                                         0746 01832000
         BNZ   @RF00746                                            0746 01833000
*                       CMENTRY=CMENTRY|BITMASK(CUBEBIT);          0747 01834000
*                                                                  0747 01835000
         LH    @01,CUBEBIT                                         0747 01836000
         LA    @04,BITMASK-1(@01)                                  0747 01837000
         OC    CMENTRY(1,@05),0(@04)                               0747 01838000
*                     /***********************************************/ 01839000
*                     /*                                             */ 01840000
*                     /* DETERMINE IF THE CELL MAP           @Z40LB64*/ 01841000
*                     /* SPECIFIES THAT THE CELL IS          @Z40LB64*/ 01842000
*                     /* OCCUPIED.                           @Z40LB64*/ 01843000
*                     /*                                             */ 01844000
*                     /***********************************************/ 01845000
*                                                                  0748 01846000
*                     IF(CMENTRY&BITMASK(CUBEBIT))=0 THEN          0748 01847000
@RF00746 LH    @01,CUBEBIT                                         0748 01848000
         L     @02,CMENTPTR                                        0748 01849000
         SLR   @00,@00                                             0748 01850000
         IC    @00,CMENTRY(,@02)                                   0748 01851000
         SLR   @02,@02                                             0748 01852000
         IC    @02,BITMASK-1(@01)                                  0748 01853000
         NR    @00,@02                                             0748 01854000
         LTR   @00,@00                                             0748 01855000
         BNZ   @RF00748                                            0748 01856000
*CELLFULL:                                                         0749 01857000
*                       DO;         /*                       @Z40LB64*/ 01858000
*                                                                  0749 01859000
CELLFULL DS    0H                                                  0750 01860000
*                         /*******************************************/ 01861000
*                         /*                                         */ 01862000
*                         /* CELL IS OCCUPIED. VERIFY        @Z40LB64*/ 01863000
*                         /* THAT THE CELL LOCATION          @Z40LB64*/ 01864000
*                         /* IS CHECKED-OFF. IF NOT          @Z40LB64*/ 01865000
*                         /* CHECKED-OFF, PRINT AN           @Z40LB64*/ 01866000
*                         /* ERROR MESSAGE.                  @Z40LB64*/ 01867000
*                         /*                                         */ 01868000
*                         /*******************************************/ 01869000
*                                                                  0750 01870000
*                         CMCOEPTR=CMCOPTR(MSF#,CMBLK#)+BLKPOS#;/* 0750 01871000
*                                                            @Z40LB64*/ 01872000
         LH    @02,MSF#                                            0750 01873000
         SLA   @02,2                                               0750 01874000
         AH    @02,CMBLK#                                          0750 01875000
         SLA   @02,2                                               0750 01876000
         L     @15,@PC00001+4                                      0750 01877000
         LH    @14,BLKPOS#                                         0750 01878000
         AL    @14,CMCOPTR-20(@02,@15)                             0750 01879000
         ST    @14,CMCOEPTR                                        0750 01880000
*                         IF(CMCOENT&BITMASK(CUBEBIT))=0 THEN      0751 01881000
         LH    @01,CUBEBIT                                         0751 01882000
         SLR   @15,@15                                             0751 01883000
         IC    @15,CMCOENT(,@14)                                   0751 01884000
         SLR   @14,@14                                             0751 01885000
         IC    @14,BITMASK-1(@01)                                  0751 01886000
         NR    @15,@14                                             0751 01887000
         LTR   @15,@15                                             0751 01888000
         BNZ   @RF00751                                            0751 01889000
*CELLNCHK:                                                         0752 01890000
*                           DO;     /*                       @Z40LB64*/ 01891000
CELLNCHK DS    0H                                                  0753 01892000
*                             MTCHMSG=ON;/*                  @Z40LB64*/ 01893000
         L     @02,@PC00001+4                                      0753 01894000
         L     @15,MARGPTR(,@02)                                   0753 01895000
         OI    MTCHMSG(@15),B'00010000'                            0753 01896000
*                             CAFLD=ON;/*                    @Z40LB64*/ 01897000
         OI    CAFLD(@15),B'00010000'                              0754 01898000
*                             VTSTBL(1)=ON;/*                @Z40LB64*/ 01899000
         OI    VTSTBL(@15),B'00000100'                             0755 01900000
*                             CMTBL(2)=ON;/*                 @Z40LB64*/ 01901000
         OI    CMTBL+4(@15),B'00000100'                            0756 01902000
*                             FLDNUM(1)=MSFL#*LVALSHFT+MSFZ#*ZVALSHFT+( 01903000
*                                 MSFY#-1)*YVALSHFT+MSFX#+(MSFXSTRT-1)+ 01904000
*                                 (CUBEBIT-1)/2;/*           @Z40LB64*/ 01905000
         LH    @14,MSFL#                                           0757 01906000
         LR    @05,@14                                             0757 01907000
         SLA   @05,14                                              0757 01908000
         LH    @04,MSFZ#                                           0757 01909000
         SLA   @04,13                                              0757 01910000
         ALR   @05,@04                                             0757 01911000
         LH    @04,MSFY#                                           0757 01912000
         BCTR  @04,0                                               0757 01913000
         SLA   @04,8                                               0757 01914000
         ALR   @05,@04                                             0757 01915000
         AH    @05,MSFX#                                           0757 01916000
         AH    @05,@CH01727                                        0757 01917000
         LH    @00,CUBEBIT                                         0757 01918000
         BCTR  @00,0                                               0757 01919000
         SRDA  @00,32                                              0757 01920000
         D     @00,@CF00157                                        0757 01921000
         ALR   @05,@01                                             0757 01922000
         ST    @05,FLDNUM(,@15)                                    0757 01923000
*                             MSFINDEX(2)=MSFL#;/*           @Z40LB64*/ 01924000
         STC   @14,MSFINDEX+24(,@15)                               0758 01925000
*                             XYZINDEX(2)=FLDNUM(1);               0759 01926000
         MVC   XYZINDEX+24(2,@15),FLDNUM+2(@15)                    0759 01927000
*                             CHRINDEX(2)=CMCHR(MSF#,CMBLK#);      0760 01928000
         LH    @14,MSF#                                            0760 01929000
         SLA   @14,2                                               0760 01930000
         AH    @14,CMBLK#                                          0760 01931000
         MH    @14,@CH00290                                        0760 01932000
         LA    @01,CMCHR-25(@14)                                   0760 01933000
         MVC   CHRINDEX+24(5,@15),0(@01)                           0760 01934000
*                             CALL IDCCH04(GDTTBL,CDALIST);/*      0761 01935000
*                                                            @Z40LB61*/ 01936000
         L     @15,@PC00001                                        0761 01937000
         ST    @15,@AL00001                                        0761 01938000
         ST    @02,@AL00001+4                                      0761 01939000
         L     @15,@CV01495                                        0761 01940000
         LA    @01,@AL00001                                        0761 01941000
         BALR  @14,@15                                             0761 01942000
*                           END CELLNCHK;/*                  @Z40LB64*/ 01943000
*                       END CELLFULL;/*                      @Z40LB64*/ 01944000
@RF00751 DS    0H                                                  0764 01945000
*                   END CELLVLD;    /*                       @Z40LB64*/ 01946000
@RF00748 DS    0H                                                  0765 01947000
*               END BITSCAN;        /*                       @Z40LB64*/ 01948000
@RF00743 LA    @02,1                                               0765 01949000
         AH    @02,CUBEBIT                                         0765 01950000
@DE00740 STH   @02,CUBEBIT                                         0765 01951000
         CH    @02,@CH00183                                        0765 01952000
         BNH   @DL00740                                            0765 01953000
*             ELSE                                                 0766 01954000
*                                                                  0766 01955000
*               /*****************************************************/ 01956000
*               /*                                                   */ 01957000
*               /* LOW X VALUE HAS NOT BEEN REACHED.         @Z40LB64*/ 01958000
*               /*                                                   */ 01959000
*               /*****************************************************/ 01960000
*                                                                  0766 01961000
*               XINCREAS=XINCREAS+1;/*                       @Z40LB64*/ 01962000
         B     @RC00739                                            0766 01963000
@RF00739 LA    @02,1                                               0766 01964000
         AH    @02,XINCREAS                                        0766 01965000
         STH   @02,XINCREAS                                        0766 01966000
*           END BYTESCAN;           /*                       @Z40LB64*/ 01967000
@RC00739 LA    @02,1                                               0767 01968000
         AH    @02,CUBEBYTE                                        0767 01969000
         STH   @02,CUBEBYTE                                        0767 01970000
         CH    @02,@CH00046                                        0767 01971000
         BNH   @DL00736                                            0767 01972000
*           XINCREAS=0;             /*                       @Z40LB64*/ 01973000
         SLR   @02,@02                                             0768 01974000
         STH   @02,XINCREAS                                        0768 01975000
*         END CUBESCAN;             /*                       @Z40LB64*/ 01976000
*                                                                  0769 01977000
         LA    @02,1                                               0769 01978000
         AH    @02,CUBE#                                           0769 01979000
         STH   @02,CUBE#                                           0769 01980000
         CH    @02,@CH00769                                        0769 01981000
         BNH   @DL00735                                            0769 01982000
*         /***********************************************************/ 01983000
*         /*                                                         */ 01984000
*         /* TEST IF THIS IS THE LAST DATA BLOCK IN THE      @Z40LB64*/ 01985000
*         /* MSF. IF SO, THERE WILL BE ONLY ONE CHUNK        @Z40LB64*/ 01986000
*         /* IN THIS BLOCK AND THE SCAN IS TERMINATED.       @Z40LB64*/ 01987000
*         /* OTHERWISE CONTINUE WITH THE CHUNK SCAN.         @Z40LB64*/ 01988000
*         /*                                                         */ 01989000
*         /***********************************************************/ 01990000
*                                                                  0770 01991000
*         IF CMBLK#=BLKSMSF THEN                                   0770 01992000
         CLC   CMBLK#(2),@CH00046                                  0770 01993000
         BNE   @RF00770                                            0770 01994000
*           CHUNK#=CNKSBLK;         /*                       @Z40LB64*/ 01995000
         MVC   CHUNK#(2),@CH00183                                  0771 01996000
*         MSFX#=MSFX#+XRNGCNK;      /*                       @Z40LB64*/ 01997000
@RF00770 LA    @02,4                                               0772 01998000
         AH    @02,MSFX#                                           0772 01999000
         STH   @02,MSFX#                                           0772 02000000
*       END CHNKSCAN;               /*                       @Z40LB64*/ 02001000
         LA    @02,1                                               0773 02002000
         AH    @02,CHUNK#                                          0773 02003000
         STH   @02,CHUNK#                                          0773 02004000
         CH    @02,@CH00183                                        0773 02005000
         BNH   @DL00732                                            0773 02006000
*     END BLKSCAN;                  /*                       @Z40LB64*/ 02007000
         LA    @02,1                                               0774 02008000
         AH    @02,CMBLK#                                          0774 02009000
         STH   @02,CMBLK#                                          0774 02010000
         CH    @02,@CH00046                                        0774 02011000
         BNH   @DL00731                                            0774 02012000
*   END MSFSCAN;                    /*                       @Z40LB64*/ 02013000
         LA    @02,1                                               0775 02014000
         AH    @02,MSF#                                            0775 02015000
@DE00728 STH   @02,MSF#                                            0775 02016000
         L     @15,@PC00001+4                                      0775 02017000
         CH    @02,MSFVLCNT(,@15)                                  0775 02018000
         BNH   @DL00728                                            0775 02019000
*   IF GDTDBG=NULLPTR THEN                                         0776 02020000
         L     @02,@PC00001                                        0776 02021000
         ICM   @15,15,GDTDBG(@02)                                  0776 02022000
         BZ    @RT00776                                            0776 02023000
*     ;                                                            0777 02024000
*   ELSE                                                           0778 02025000
*     CALL IDCDB010(GDTTBL,'CH2X'); /*                       @Z40LB64*/ 02026000
         L     @02,@PC00001                                        0778 02027000
         ST    @02,@AL00001                                        0778 02028000
         LA    @15,@CC01546                                        0778 02029000
         ST    @15,@AL00001+4                                      0778 02030000
         MVI   @AL00001+4,X'80'                                    0778 02031000
         L     @15,GDTDBG(,@02)                                    0778 02032000
         LA    @01,@AL00001                                        0778 02033000
         BALR  @14,@15                                             0778 02034000
*   END CELLMAP;                    /*                       @Z40LB64*/ 02035000
         B     @EL00002                                            0779 02036000
*                                                                  0780 02037000
*/********************************************************************/ 02038000
*/*                                                          @Z40LB61*/ 02039000
*/* PROCEDURE NAME - MVTLOOP                                 @Z40LB61*/ 02040000
*/*                                                          @Z40LB61*/ 02041000
*/* FUNCTION - THIS ROUTINE OBTAINS EACH MVT ENTRY AND THEN  @Z40LB61*/ 02042000
*/*            ROUTES CONTROL TO SUBROUTINES WHICH COMPARE   @Z40LB61*/ 02043000
*/*            MVT ENTRY INFORMATION AGAINST CORRESPONDING   @Z40LB61*/ 02044000
*/*            DATA IN SA TABLES AND OTHER MSC TABLES.       @Z40LB61*/ 02045000
*/*                                                          @Z40LB61*/ 02046000
*/* INPUT -                                                  @Z40LB61*/ 02047000
*/*        (1) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 02048000
*/*        (2) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 02049000
*/*                                                          @Z40LB61*/ 02050000
*/* OUTPUT -                                                 @Z40LB61*/ 02051000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 02052000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 02053000
*/*                                                          @Z40LB61*/ 02054000
*/********************************************************************/ 02055000
*                                                                  0780 02056000
*MVTLOOP:                                                          0780 02057000
*   PROCEDURE;                      /*                       @Z40LB61*/ 02058000
MVTLOOP  STM   @14,@12,@SA00003                                    0780 02059000
*   OLDERID2=NEWERID2;                                             0781 02060000
         L     @02,@PC00001                                        0781 02061000
         L     @02,GDTTR2(,@02)                                    0781 02062000
         MVC   @TS00001(95),NEWERID2(@02)                          0781 02063000
         MVC   OLDERID2(95,@02),@TS00001                           0781 02064000
*   NEWID2='CH2E';                  /*                       @Z40LB61*/ 02065000
*                                                                  0782 02066000
         MVC   NEWID2(4,@02),@CC01550                              0782 02067000
*   /*****************************************************************/ 02068000
*   /*                                                               */ 02069000
*   /* INITIALIZE POINTER AND COUNT VARIABLES AND            @Z40LB61*/ 02070000
*   /* CHECK-OFF TABLES                                      @Z40LB61*/ 02071000
*   /*                                                               */ 02072000
*   /*****************************************************************/ 02073000
*                                                                  0783 02074000
*   TBLADDR=NULLPTR;                /*                       @Z40LB61*/ 02075000
         L     @02,@PC00001+4                                      0783 02076000
         L     @01,EARGPTR(,@02)                                   0783 02077000
         SLR   @00,@00                                             0783 02078000
         ST    @00,TBLADDR(,@01)                                   0783 02079000
*   DO SDG#=1 TO SDGMAX;            /*                       @Z40LB61*/ 02080000
         LA    @02,1                                               0784 02081000
         STH   @02,SDG#                                            0784 02082000
@DL00784 DS    0H                                                  0785 02083000
*     MNTCOUNT(SDG#)=0;             /*                       @Z40LB61*/ 02084000
         LR    @15,@02                                             0785 02085000
         ALR   @15,@15                                             0785 02086000
         SLR   @14,@14                                             0785 02087000
         STH   @14,MNTCOUNT-2(@15)                                 0785 02088000
*     RPMCOT(SDG#)=''B;             /*                       @Z40LB61*/ 02089000
         LR    @15,@02                                             0786 02090000
         MH    @15,@CH01728                                        0786 02091000
         L     @14,@PC00001+4                                      0786 02092000
         L     @01,RPMCOPTR(,@14)                                  0786 02093000
         ALR   @01,@15                                             0786 02094000
         AL    @01,@CF01755                                        0786 02095000
         XC    RPMCOT(56,@01),RPMCOT(@01)                          0786 02096000
*     DVBCOT(SDG#)=''B;             /*                       @Z40LB61*/ 02097000
         LR    @15,@02                                             0787 02098000
         SLA   @15,4                                               0787 02099000
         L     @01,DVBCOPTR(,@14)                                  0787 02100000
         ALR   @01,@15                                             0787 02101000
         AL    @01,@CF01756                                        0787 02102000
         XC    DVBCOT(16,@01),DVBCOT(@01)                          0787 02103000
*     LPBCOT(SDG#)=''B;             /*                       @Z40LB61*/ 02104000
         L     @01,LPBCOPTR(,@14)                                  0788 02105000
         ALR   @01,@15                                             0788 02106000
         AL    @01,@CF01756                                        0788 02107000
         XC    LPBCOT(16,@01),LPBCOT(@01)                          0788 02108000
*   END;                            /*                       @Z40LB61*/ 02109000
         AH    @02,@CH00223                                        0789 02110000
         STH   @02,SDG#                                            0789 02111000
         CH    @02,@CH00781                                        0789 02112000
         BNH   @DL00784                                            0789 02113000
*   DO SA#=1 TO SAMAX;              /*                       @Z40LB61*/ 02114000
         LA    @02,1                                               0790 02115000
         STH   @02,SA#                                             0790 02116000
@DL00790 DS    0H                                                  0791 02117000
*     IF IVVITPTR(SA#)^=NULLPTR&    /*                       @ZA27324*/ 02118000
*         IVVITPTR(SA#)^=DUMMYPTR THEN/*                     @ZA27324*/ 02119000
         LR    @15,@02                                             0791 02120000
         SLA   @15,2                                               0791 02121000
         L     @14,@PC00001+4                                      0791 02122000
         L     @05,IVVITPTR-4(@15,@14)                             0791 02123000
         LTR   @05,@05                                             0791 02124000
         BZ    @RF00791                                            0791 02125000
         C     @05,DUMMYPTR                                        0791 02126000
         BE    @RF00791                                            0791 02127000
*       DO;                         /*                       @Z40LB61*/ 02128000
*         CDBCOT(SA#)=''B;          /*                       @Z40LB61*/ 02129000
         MH    @02,@CH00314                                        0793 02130000
         L     @01,CDBCOPTR(,@14)                                  0793 02131000
         ALR   @01,@02                                             0793 02132000
         AL    @01,@CF01757                                        0793 02133000
         XC    CDBCOT(24,@01),CDBCOT(@01)                          0793 02134000
*         VVACOT(SA#)=''B;          /*                       @Z40LB61*/ 02135000
         L     @01,VVACOPTR(,@14)                                  0794 02136000
         ALR   @01,@02                                             0794 02137000
         AL    @01,@CF01757                                        0794 02138000
         XC    VVACOT(24,@01),VVACOT(@01)                          0794 02139000
*         VMXCOT(SA#)=''B;          /*                       @Z40LB61*/ 02140000
         L     @01,VMXCOPTR(,@14)                                  0795 02141000
         ALR   @01,@02                                             0795 02142000
         AL    @01,@CF01757                                        0795 02143000
         XC    VMXCOT(24,@01),VMXCOT(@01)                          0795 02144000
*         IF SACHK=ON THEN                                         0796 02145000
         TM    SACHK(@14),B'01000000'                              0796 02146000
         BNO   @RF00796                                            0796 02147000
*           DO;                     /*                       @Z40LB61*/ 02148000
*             VVICOT=''B;           /*                       @Z40LB61*/ 02149000
         L     @01,VVICOPTR-4(@15,@14)                             0798 02150000
         XC    VVICOT(24,@01),VVICOT(@01)                          0798 02151000
*             VADCOT=''B;           /*                       @Z40LB61*/ 02152000
         L     @01,VADCOPTR-4(@15,@14)                             0799 02153000
         XC    VADCOT(24,@01),VADCOT(@01)                          0799 02154000
*             PSTCOT=''B;           /*                       @Z40LB61*/ 02155000
         L     @01,PSTCOPTR-4(@15,@14)                             0800 02156000
         XC    PSTCOT(112,@01),PSTCOT(@01)                         0800 02157000
*           END;                    /*                       @Z40LB61*/ 02158000
*       END;                        /*                       @Z40LB61*/ 02159000
@RF00796 DS    0H                                                  0803 02160000
*   END;                            /*                       @Z40LB61*/ 02161000
*                                                                  0803 02162000
@RF00791 LA    @02,1                                               0803 02163000
         AH    @02,SA#                                             0803 02164000
         STH   @02,SA#                                             0803 02165000
         CH    @02,@CH00478                                        0803 02166000
         BNH   @DL00790                                            0803 02167000
*   /*****************************************************************/ 02168000
*   /*                                                               */ 02169000
*   /* PROCESS EVERY MOUNTED VOLUME TABLE (MVT) ENTRY,       @Z40LB61*/ 02170000
*   /* CHECKING THE FIELDS AGAINST RELATED IN CORRESPONDING  @Z40LB61*/ 02171000
*   /* MSC AND/OR SA TABLES.                                 @Z40LB61*/ 02172000
*   /*                                                               */ 02173000
*   /*****************************************************************/ 02174000
*                                                                  0804 02175000
*MVTLOOP1:                                                         0804 02176000
*   DO WHILE(LASTCOND=0);           /*                       @Z40LB61*/ 02177000
*                                                                  0804 02178000
MVTLOOP1 B     @DE00804                                            0804 02179000
@DL00804 DS    0H                                                  0805 02180000
*     /***************************************************************/ 02181000
*     /*                                                             */ 02182000
*     /* OBTAIN THE NEXT MVT ENTRY. CHECK FOR A NON-ZERO     @Z40LB61*/ 02183000
*     /* RETURN CODE WHICH INDICATES EITHER AN ERROR OR      @Z40LB61*/ 02184000
*     /* THE END OF THE TABLE.                               @Z40LB61*/ 02185000
*     /*                                                             */ 02186000
*     /***************************************************************/ 02187000
*                                                                  0805 02188000
*     TABLEID=MVTBLID;              /*                       @Z40LB61*/ 02189000
         L     @02,@PC00001+4                                      0805 02190000
         L     @15,EARGPTR(,@02)                                   0805 02191000
         MVC   TABLEID(1,@15),MVTBLID                              0805 02192000
*     GETNEXT=ON;                   /*                       @Z40LB61*/ 02193000
*     BUFFER2=ON;                   /*                       @Z40LB61*/ 02194000
         OI    GETNEXT(@15),B'11000000'                            0807 02195000
*     CALL IDCCH03(GDTTBL,CDALIST); /*                       @Z40LB61*/ 02196000
         L     @15,@PC00001                                        0808 02197000
         ST    @15,@AL00001                                        0808 02198000
         ST    @02,@AL00001+4                                      0808 02199000
         L     @15,@CV01494                                        0808 02200000
         LA    @01,@AL00001                                        0808 02201000
         BALR  @14,@15                                             0808 02202000
*     IF GETRC^=0 THEN                                             0809 02203000
         L     @02,@PC00001+4                                      0809 02204000
         L     @01,EARGPTR(,@02)                                   0809 02205000
         LH    @02,GETRC(,@01)                                     0809 02206000
         LTR   @02,@02                                             0809 02207000
         BZ    @RF00809                                            0809 02208000
*       DO;                         /*                       @Z40LB61*/ 02209000
*         IF GETRC=TABLERR THEN                                    0811 02210000
         LA    @15,12                                              0811 02211000
         CR    @02,@15                                             0811 02212000
         BNE   @RF00811                                            0811 02213000
*           LASTCOND=LASTCC12;      /*                       @Z40LB61*/ 02214000
         L     @14,@PC00001+8                                      0812 02215000
         STH   @15,LASTCOND(,@14)                                  0812 02216000
*         RETURN;                   /*                       @Z40LB61*/ 02217000
@EL00003 DS    0H                                                  0813 02218000
@EF00003 DS    0H                                                  0813 02219000
@ER00003 LM    @14,@12,@SA00003                                    0813 02220000
         BR    @14                                                 0813 02221000
*       END;                        /*                       @Z40LB61*/ 02222000
*     MVENTPTR=TBLADDR;             /*                       @Z40LB61*/ 02223000
@RF00809 L     @02,@PC00001+4                                      0815 02224000
         L     @15,EARGPTR(,@02)                                   0815 02225000
         L     @14,TBLADDR(,@15)                                   0815 02226000
         ST    @14,MVENTPTR                                        0815 02227000
*     SAVEID=ENTRYID;               /*                       @Z40LB61*/ 02228000
*                                                                  0816 02229000
         MVC   SAVEID(12),ENTRYID(@15)                             0816 02230000
*     /***************************************************************/ 02231000
*     /*                                                             */ 02232000
*     /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES        @Z40LB61*/ 02233000
*     /*                                                             */ 02234000
*     /***************************************************************/ 02235000
*                                                                  0817 02236000
*     VSNINDEX(2)=MVVOLID;          /*                       @Z40LB61*/ 02237000
         L     @15,MARGPTR(,@02)                                   0817 02238000
         MVC   VSNINDEX+24(6,@15),MVVOLID(@14)                     0817 02239000
*     CHRINDEX(2)=SAVECHR;          /*                       @Z40LB61*/ 02240000
         MVC   CHRINDEX+24(5,@15),SAVECHR                          0818 02241000
*     MV3333=MV3333&MASK3333;       /*                       @Z40LB61*/ 02242000
*                                                                  0819 02243000
         SLR   @15,@15                                             0819 02244000
         IC    @15,MV3333(,@14)                                    0819 02245000
         SLR   @05,@05                                             0819 02246000
         IC    @05,MASK3333                                        0819 02247000
         NR    @15,@05                                             0819 02248000
         STC   @15,MV3333(,@14)                                    0819 02249000
*     /***************************************************************/ 02250000
*     /*                                                             */ 02251000
*     /* IF MSC-MSC TABLE CHECKING WAS REQUESTED, COMPARE    @Z40LB61*/ 02252000
*     /* THE MVT TO THE MSC VOLUME INVENTORY (VI).           @Z40LB61*/ 02253000
*     /* DO NOT COMPARE THE TABLES IF THE MVT ENTRY IS       @ZA11666*/ 02254000
*     /* FLAGGED AS REMOUNTED SINCE THERE IS NO GUARANTEE    @ZA11666*/ 02255000
*     /* THAT A VI ENTRY EXISTS.                             @ZA11666*/ 02256000
*     /*                                                             */ 02257000
*     /***************************************************************/ 02258000
*                                                                  0820 02259000
*     IF MSCCHK=ON&MVREMNT=OFF THEN /*                       @ZA11666*/ 02260000
         TM    MSCCHK(@02),B'10000000'                             0820 02261000
         BNO   @RF00820                                            0820 02262000
         TM    MVREMNT(@14),B'00010000'                            0820 02263000
         BNZ   @RF00820                                            0820 02264000
*       DO;                         /*                       @Z40LB61*/ 02265000
*         CALL CHKMVTVI;            /*                       @Z40LB61*/ 02266000
         BAL   @14,CHKMVTVI                                        0822 02267000
*         IF LASTCOND^=0 THEN                                      0823 02268000
         L     @02,@PC00001+8                                      0823 02269000
         ICM   @15,3,LASTCOND(@02)                                 0823 02270000
         BNZ   @RT00823                                            0823 02271000
*           RETURN;                 /*                       @Z40LB61*/ 02272000
*       END;                        /*                       @Z40LB61*/ 02273000
*                                                                  0825 02274000
*     /***************************************************************/ 02275000
*     /*                                                             */ 02276000
*     /* IF THE MVT ENTRY INDICATES THAT THE VOLUME IS       @Z40LB61*/ 02277000
*     /* MOUNTED, CHECK INFORMATION IN RELATED TABLES        @Z40LB61*/ 02278000
*     /* THAT CORRESPONDS TO THE VVA AND VUA FIELDS OF       @Z40LB61*/ 02279000
*     /* THE MVT ENTRY.                                      @Z40LB61*/ 02280000
*     /*                                                             */ 02281000
*     /***************************************************************/ 02282000
*                                                                  0826 02283000
*     IF MVMNTVOL=ON THEN                                          0826 02284000
@RF00820 L     @01,MVENTPTR                                        0826 02285000
         TM    MVMNTVOL(@01),B'10000000'                           0826 02286000
         BNO   @RF00826                                            0826 02287000
*MNTDMVT:                                                          0827 02288000
*       DO;                         /*                       @Z40LB61*/ 02289000
MNTDMVT  DS    0H                                                  0828 02290000
*         CALL MVTVVAS;             /*                       @Z40LB61*/ 02291000
         BAL   @14,MVTVVAS                                         0828 02292000
*         IF LASTCOND^=0 THEN                                      0829 02293000
         L     @02,@PC00001+8                                      0829 02294000
         ICM   @15,3,LASTCOND(@02)                                 0829 02295000
         BNZ   @RT00829                                            0829 02296000
*           RETURN;                 /*                       @Z40LB61*/ 02297000
*         CALL MVTVUAS;             /*                       @Z40LB61*/ 02298000
         BAL   @14,MVTVUAS                                         0831 02299000
*         IF LASTCOND^=0 THEN                                      0832 02300000
         L     @02,@PC00001+8                                      0832 02301000
         ICM   @15,3,LASTCOND(@02)                                 0832 02302000
         BNZ   @RT00832                                            0832 02303000
*           RETURN;                 /*                       @Z40LB61*/ 02304000
*                                                                  0833 02305000
*         /***********************************************************/ 02306000
*         /*                                                         */ 02307000
*         /* SET UP TO CHECK THE MVT CHECK-OFF TABLE. IF     @Z40LB61*/ 02308000
*         /* MSVI CHECKING WAS REQUESTED AND THIS MVT ENTRY  @Z40LB61*/ 02309000
*         /* HAS NOT BEEN CHECKED OFF, THEN THE MVT AND      @Z40LB61*/ 02310000
*         /* MSVI DIFFER AS TO THE MOUNTED STATUS OF THIS    @Z40LB61*/ 02311000
*         /* VOLUME. IF SO, PRINT AN ERROR MESSAGE.          @Z40LB61*/ 02312000
*         /*                                                         */ 02313000
*         /***********************************************************/ 02314000
*                                                                  0834 02315000
*         BYTE#=(SAVEREC#-1)/8+1;   /*                       @Z40LB61*/ 02316000
         L     @02,@PC00001+4                                      0834 02317000
         L     @15,EARGPTR(,@02)                                   0834 02318000
         LA    @14,1                                               0834 02319000
         LH    @05,SAVEREC#                                        0834 02320000
         BCTR  @05,0                                               0834 02321000
         LR    @00,@05                                             0834 02322000
         SRDA  @00,32                                              0834 02323000
         D     @00,@CF00183                                        0834 02324000
         ALR   @01,@14                                             0834 02325000
         STH   @01,BYTE#(,@15)                                     0834 02326000
*         BIT#=(SAVEREC#-1)//8+1;   /*                       @Z40LB61*/ 02327000
         LR    @02,@05                                             0835 02328000
         SRDA  @02,32                                              0835 02329000
         D     @02,@CF00183                                        0835 02330000
         ALR   @02,@14                                             0835 02331000
         STH   @02,BIT#(,@15)                                      0835 02332000
*         IF MSVICHK=ON THEN                                       0836 02333000
         L     @03,@PC00001+4                                      0836 02334000
         TM    MSVICHK(@03),B'00100000'                            0836 02335000
         BNO   @RF00836                                            0836 02336000
*           IF(MVTCHKFF(BYTE#)&BITMASK(BIT#))='00'X THEN           0837 02337000
         L     @15,MVTCOPTR(,@03)                                  0837 02338000
         ALR   @15,@01                                             0837 02339000
         AL    @15,@CF01340                                        0837 02340000
         MVC   @TS00001(1),MVTCHKFF(@15)                           0837 02341000
         LA    @01,BITMASK-1(@02)                                  0837 02342000
         NC    @TS00001(1),0(@01)                                  0837 02343000
         CLI   @TS00001,X'00'                                      0837 02344000
         BNE   @RF00837                                            0837 02345000
*             DO;                   /*                       @Z40LB61*/ 02346000
*               MTCHMSG=ON;         /*                       @Z40LB61*/ 02347000
         L     @02,MARGPTR(,@03)                                   0839 02348000
         OI    MTCHMSG(@02),B'00010000'                            0839 02349000
*               MSVITBL(1)=ON;      /*                       @Z40LB61*/ 02350000
         OI    MSVITBL(@02),B'00001000'                            0840 02351000
*               MVTTBL(2)=ON;       /*                       @Z40LB61*/ 02352000
         OI    MVTTBL+4(@02),B'10000000'                           0841 02353000
*               VSNFLD=ON;          /*                       @Z40LB61*/ 02354000
         OI    VSNFLD(@02),B'00000001'                             0842 02355000
*               FLDCHAR(1)=MVVOLID; /*                       @Z40LB61*/ 02356000
         MVI   FLDCHAR+6(@02),C' '                                 0843 02357000
         MVC   FLDCHAR+7(5,@02),FLDCHAR+6(@02)                     0843 02358000
         L     @01,MVENTPTR                                        0843 02359000
         MVC   FLDCHAR(6,@02),MVVOLID(@01)                         0843 02360000
*               CALL IDCCH04(GDTTBL,CDALIST);/*              @Z40LB61*/ 02361000
         L     @02,@PC00001                                        0844 02362000
         ST    @02,@AL00001                                        0844 02363000
         ST    @03,@AL00001+4                                      0844 02364000
         L     @15,@CV01495                                        0844 02365000
         LA    @01,@AL00001                                        0844 02366000
         BALR  @14,@15                                             0844 02367000
*             END;                  /*                       @Z40LB61*/ 02368000
*       END MNTDMVT;                /*                       @Z40LB61*/ 02369000
*                                                                  0846 02370000
*     /***************************************************************/ 02371000
*     /*                                                             */ 02372000
*     /* FOR A DEMOUNTED VOLUME'S MVT ENTRY, MAKE SURE NO    @VS41105*/ 02373000
*     /* SPECIAL CHECKING IS DONE IF IT'S A BOUND VOLUME     @VS41105*/ 02374000
*     /*                                                             */ 02375000
*     /***************************************************************/ 02376000
*                                                                  0847 02377000
*     ELSE                                                         0847 02378000
*       MVBNDVOL=OFF;               /*                       @VS41105*/ 02379000
*                                                                  0847 02380000
         B     @RC00826                                            0847 02381000
@RF00826 L     @01,MVENTPTR                                        0847 02382000
         NI    MVBNDVOL(@01),B'11111011'                           0847 02383000
*     /***************************************************************/ 02384000
*     /*                                                             */ 02385000
*     /* CHECK PAGE ALLOCATION INFORMATION FOR CONSISTENCY   @Z40LB61*/ 02386000
*     /* AMONG RELATED TABLES.                               @Z40LB61*/ 02387000
*     /*                                                             */ 02388000
*     /***************************************************************/ 02389000
*                                                                  0848 02390000
*     CALL MVTPAGES;                /*                       @Z40LB61*/ 02391000
@RC00826 BAL   @14,MVTPAGES                                        0848 02392000
*     ENTRYID=SAVEID;               /*                       @Z40LB61*/ 02393000
         L     @15,@PC00001+4                                      0849 02394000
         L     @01,EARGPTR(,@15)                                   0849 02395000
         MVC   ENTRYID(12,@01),SAVEID                              0849 02396000
*   END MVTLOOP1;                   /*                       @Z40LB61*/ 02397000
@DE00804 SLR   @15,@15                                             0850 02398000
         L     @14,@PC00001+8                                      0850 02399000
         CH    @15,LASTCOND(,@14)                                  0850 02400000
         BE    @DL00804                                            0850 02401000
*   IF GDTDBG=NULLPTR THEN                                         0851 02402000
         L     @14,@PC00001                                        0851 02403000
         C     @15,GDTDBG(,@14)                                    0851 02404000
         BE    @RT00851                                            0851 02405000
*     ;                                                            0852 02406000
*   ELSE                                                           0853 02407000
*     CALL IDCDB010(GDTTBL,'CH2Y'); /*                       @Z40LB61*/ 02408000
         L     @15,@PC00001                                        0853 02409000
         ST    @15,@AL00001                                        0853 02410000
         LA    @14,@CC01559                                        0853 02411000
         ST    @14,@AL00001+4                                      0853 02412000
         MVI   @AL00001+4,X'80'                                    0853 02413000
         L     @15,GDTDBG(,@15)                                    0853 02414000
         LA    @01,@AL00001                                        0853 02415000
         BALR  @14,@15                                             0853 02416000
*   END MVTLOOP;                    /*                       @Z40LB61*/ 02417000
         B     @EL00003                                            0854 02418000
*                                                                  0855 02419000
*/********************************************************************/ 02420000
*/*                                                          @Z40LB61*/ 02421000
*/* PROCEDURE NAME - CHKMVTVI                                @Z40LB61*/ 02422000
*/*                                                          @Z40LB61*/ 02423000
*/* FUNCTION - THIS ROUTINE COMPARES INFORMATION BETWEEN     @Z40LB61*/ 02424000
*/*            AN MSC MOUNTED VOLUME TABLE ENTRY AND ITS     @Z40LB61*/ 02425000
*/*            CORRESPONDING MSC VOLUME INVENTORY ENTRY.     @Z40LB61*/ 02426000
*/*                                                          @Z40LB61*/ 02427000
*/* INPUT -                                                  @Z40LB61*/ 02428000
*/*        (1) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 02429000
*/*        (2) MSC VOLUME INVENTORY TABLE                    @Z40LB61*/ 02430000
*/*                                                          @Z40LB61*/ 02431000
*/* OUTPUT -                                                 @Z40LB61*/ 02432000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 02433000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 02434000
*/*                                                          @Z40LB61*/ 02435000
*/********************************************************************/ 02436000
*                                                                  0855 02437000
*CHKMVTVI:                                                         0855 02438000
*   PROCEDURE;                      /*                       @Z40LB61*/ 02439000
CHKMVTVI STM   @14,@12,@SA00004                                    0855 02440000
*   OLDERID2=NEWERID2;                                             0856 02441000
         L     @15,@PC00001                                        0856 02442000
         L     @14,GDTTR2(,@15)                                    0856 02443000
         MVC   @TS00001(95),NEWERID2(@14)                          0856 02444000
         MVC   OLDERID2(95,@14),@TS00001                           0856 02445000
*   NEWID2='CH2F';                  /*                       @Z40LB61*/ 02446000
*                                                                  0857 02447000
         MVC   NEWID2(4,@14),@CC01563                              0857 02448000
*   /*****************************************************************/ 02449000
*   /*                                                               */ 02450000
*   /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES.         @Z40LB61*/ 02451000
*   /*                                                               */ 02452000
*   /*****************************************************************/ 02453000
*                                                                  0858 02454000
*   VITBL(1)=ON;                    /*                       @Z40LB61*/ 02455000
         L     @14,@PC00001+4                                      0858 02456000
         L     @05,MARGPTR(,@14)                                   0858 02457000
         OI    VITBL(@05),B'01000000'                              0858 02458000
*   MVTTBL(2)=ON;                   /*                       @Z40LB61*/ 02459000
*                                                                  0859 02460000
         OI    MVTTBL+4(@05),B'10000000'                           0859 02461000
*   /*****************************************************************/ 02462000
*   /*                                                               */ 02463000
*   /* OBTAIN THE VOLUME INVENTORY ENTRY CORRESPONDING       @Z40LB61*/ 02464000
*   /* TO THE VOLUME IN THE MVT.                             @Z40LB61*/ 02465000
*   /*                                                               */ 02466000
*   /*****************************************************************/ 02467000
*                                                                  0860 02468000
*   TABLEID=VITBLID;                /*                       @Z40LB61*/ 02469000
         L     @05,EARGPTR(,@14)                                   0860 02470000
         MVC   TABLEID(1,@05),VITBLID                              0860 02471000
*   VOLID=MVVOLID;                  /*                       @Z40LB61*/ 02472000
         L     @04,MVENTPTR                                        0861 02473000
         MVC   VOLID(6,@05),MVVOLID(@04)                           0861 02474000
*   CALL IDCCH03(GDTTBL,CDALIST);   /*                       @Z40LB61*/ 02475000
         ST    @15,@AL00001                                        0862 02476000
         ST    @14,@AL00001+4                                      0862 02477000
         L     @15,@CV01494                                        0862 02478000
         LA    @01,@AL00001                                        0862 02479000
         BALR  @14,@15                                             0862 02480000
*   IF GETRC=TABLERR THEN                                          0863 02481000
         LA    @15,12                                              0863 02482000
         L     @14,@PC00001+4                                      0863 02483000
         L     @01,EARGPTR(,@14)                                   0863 02484000
         CH    @15,GETRC(,@01)                                     0863 02485000
         BNE   @RF00863                                            0863 02486000
*     DO;                           /*                       @Z40LB61*/ 02487000
*       LASTCOND=LASTCC12;          /*                       @Z40LB61*/ 02488000
         L     @14,@PC00001+8                                      0865 02489000
         STH   @15,LASTCOND(,@14)                                  0865 02490000
*       RETURN;                     /*                       @Z40LB61*/ 02491000
@EL00004 DS    0H                                                  0866 02492000
@EF00004 DS    0H                                                  0866 02493000
@ER00004 LM    @14,@12,@SA00004                                    0866 02494000
         BR    @14                                                 0866 02495000
*     END;                          /*                       @Z40LB61*/ 02496000
*   ELSE                                                           0868 02497000
*                                                                  0868 02498000
*     /***************************************************************/ 02499000
*     /*                                                             */ 02500000
*     /* IF NO MATCHING VI ENTRY WAS FOUND, PRINT AN         @Z40LB61*/ 02501000
*     /* ERROR MESSAGE.                                      @Z40LB61*/ 02502000
*     /*                                                             */ 02503000
*     /***************************************************************/ 02504000
*                                                                  0868 02505000
*     IF GETRC=NOTFOUND THEN                                       0868 02506000
@RF00863 L     @15,@PC00001+4                                      0868 02507000
         L     @01,EARGPTR(,@15)                                   0868 02508000
         CLC   GETRC(2,@01),@CH00183                               0868 02509000
         BNE   @RF00868                                            0868 02510000
*       DO;                         /*                       @Z40LB61*/ 02511000
*         MTCHMSG=ON;               /*                       @Z40LB61*/ 02512000
         L     @14,MARGPTR(,@15)                                   0870 02513000
         OI    MTCHMSG(@14),B'00010000'                            0870 02514000
*         VSNFLD=ON;                /*                       @Z40LB61*/ 02515000
         OI    VSNFLD(@14),B'00000001'                             0871 02516000
*         FLDCHAR(1)=MVVOLID;       /*                       @Z40LB61*/ 02517000
         MVI   FLDCHAR+6(@14),C' '                                 0872 02518000
         MVC   FLDCHAR+7(5,@14),FLDCHAR+6(@14)                     0872 02519000
         L     @01,MVENTPTR                                        0872 02520000
         MVC   FLDCHAR(6,@14),MVVOLID(@01)                         0872 02521000
*         CALL IDCCH04(GDTTBL,CDALIST);/*                    @Z40LB61*/ 02522000
         L     @14,@PC00001                                        0873 02523000
         ST    @14,@AL00001                                        0873 02524000
         ST    @15,@AL00001+4                                      0873 02525000
         L     @15,@CV01495                                        0873 02526000
         LA    @01,@AL00001                                        0873 02527000
         BALR  @14,@15                                             0873 02528000
*       END;                        /*                       @Z40LB61*/ 02529000
*     ELSE                                                         0875 02530000
*                                                                  0875 02531000
*       /*************************************************************/ 02532000
*       /*                                                           */ 02533000
*       /* IF THE VI ENTRY WAS FOUND, PREPARE TO CHECK       @Z40LB61*/ 02534000
*       /* FOR CONSISTENCY OF COMMON INFORMATION.            @Z40LB61*/ 02535000
*       /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES.     @Z40LB61*/ 02536000
*       /*                                                           */ 02537000
*       /*************************************************************/ 02538000
*                                                                  0875 02539000
*MVTVIM:                                                           0875 02540000
*       DO;                         /*                       @Z40LB61*/ 02541000
         B     @RC00868                                            0875 02542000
@RF00868 DS    0H                                                  0875 02543000
MVTVIM   DS    0H                                                  0876 02544000
*         VIENTPTR=TBLADDR;         /*                       @Z40LB61*/ 02545000
         L     @15,@PC00001+4                                      0876 02546000
         L     @14,EARGPTR(,@15)                                   0876 02547000
         L     @05,TBLADDR(,@14)                                   0876 02548000
         ST    @05,VIENTPTR                                        0876 02549000
*         INCNMSG=ON;               /*                       @Z40LB61*/ 02550000
         L     @04,MARGPTR(,@15)                                   0877 02551000
         OI    INCNMSG(@04),B'10000000'                            0877 02552000
*         CHRINDEX(1)=PREVCHR;      /*                       @Z40LB61*/ 02553000
         MVC   CHRINDEX(5,@04),PREVCHR(@14)                        0878 02554000
*         VSNINDEX(1)=VOLID;        /*                       @Z40LB61*/ 02555000
         MVC   VSNINDEX(6,@04),VOLID(@14)                          0879 02556000
*         MSGNRSET=ON;              /*                       @Z40LB61*/ 02557000
         OI    MSGNRSET(@04),B'00000001'                           0880 02558000
*         TBLNRSET(1)=ON;           /*                       @Z40LB61*/ 02559000
         OI    TBLNRSET(@04),B'00000001'                           0881 02560000
*         TBLNRSET(2)=ON;           /*                       @Z40LB61*/ 02561000
*                                                                  0882 02562000
         OI    TBLNRSET+4(@04),B'00000001'                         0882 02563000
*         /***********************************************************/ 02564000
*         /*                                                         */ 02565000
*         /* CHECK FOR MATCHING 'SECURE VOLUME' STATUS.      @Z40LB61*/ 02566000
*         /* IF INCONSISTENT, PRINT AN ERROR MESSAGE.        @Z40LB61*/ 02567000
*         /*                                                         */ 02568000
*         /***********************************************************/ 02569000
*                                                                  0883 02570000
*         IF VISECVOL=ON&MVSECVOL=OFF THEN                         0883 02571000
         TM    VISECVOL(@05),B'00100000'                           0883 02572000
         BNO   @RF00883                                            0883 02573000
         L     @01,MVENTPTR                                        0883 02574000
         TM    MVSECVOL(@01),B'00100000'                           0883 02575000
         BNZ   @RF00883                                            0883 02576000
*           DO;                     /*                       @Z40LB61*/ 02577000
*             VSSFLD=ON;            /*                       @Z40LB61*/ 02578000
         OI    VSSFLD(@04),B'01000000'                             0885 02579000
*             FLDCHAR(1)=STATYES;   /*                       @Z40LB61*/ 02580000
         MVI   FLDCHAR+3(@04),C' '                                 0886 02581000
         MVC   FLDCHAR+4(8,@04),FLDCHAR+3(@04)                     0886 02582000
         MVC   FLDCHAR(3,@04),@CC01343                             0886 02583000
*             FLDCHAR(2)=STATNO;    /*                       @Z40LB61*/ 02584000
         MVI   FLDCHAR+15(@04),C' '                                0887 02585000
         MVC   FLDCHAR+16(8,@04),FLDCHAR+15(@04)                   0887 02586000
         MVC   FLDCHAR+12(3,@04),@CC01345                          0887 02587000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02588000
         L     @14,@PC00001                                        0888 02589000
         ST    @14,@AL00001                                        0888 02590000
         ST    @15,@AL00001+4                                      0888 02591000
         L     @15,@CV01495                                        0888 02592000
         LA    @01,@AL00001                                        0888 02593000
         BALR  @14,@15                                             0888 02594000
*           END;                    /*                       @Z40LB61*/ 02595000
*         IF VISECVOL=OFF&MVSECVOL=ON THEN                         0890 02596000
@RF00883 L     @01,VIENTPTR                                        0890 02597000
         TM    VISECVOL(@01),B'00100000'                           0890 02598000
         BNZ   @RF00890                                            0890 02599000
         L     @01,MVENTPTR                                        0890 02600000
         TM    MVSECVOL(@01),B'00100000'                           0890 02601000
         BNO   @RF00890                                            0890 02602000
*           DO;                     /*                       @Z40LB61*/ 02603000
*             VSSFLD=ON;            /*                       @Z40LB61*/ 02604000
         L     @15,@PC00001+4                                      0892 02605000
         L     @14,MARGPTR(,@15)                                   0892 02606000
         OI    VSSFLD(@14),B'01000000'                             0892 02607000
*             FLDCHAR(1)=STATNO;    /*                       @Z40LB61*/ 02608000
         MVI   FLDCHAR+3(@14),C' '                                 0893 02609000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0893 02610000
         MVC   FLDCHAR(3,@14),@CC01345                             0893 02611000
*             FLDCHAR(2)=STATYES;   /*                       @Z40LB61*/ 02612000
         MVI   FLDCHAR+15(@14),C' '                                0894 02613000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0894 02614000
         MVC   FLDCHAR+12(3,@14),@CC01343                          0894 02615000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02616000
         L     @14,@PC00001                                        0895 02617000
         ST    @14,@AL00001                                        0895 02618000
         ST    @15,@AL00001+4                                      0895 02619000
         L     @15,@CV01495                                        0895 02620000
         LA    @01,@AL00001                                        0895 02621000
         BALR  @14,@15                                             0895 02622000
*           END;                    /*                       @Z40LB61*/ 02623000
*                                                                  0896 02624000
*         /***********************************************************/ 02625000
*         /*                                                         */ 02626000
*         /* CHECK FOR MATCHING 'EXCLUSIVE VOLUME' STATUS.   @Z40LB61*/ 02627000
*         /* IF INCONSISTENT, PRINT AN ERROR MESSAGE.        @Z40LB61*/ 02628000
*         /*                                                         */ 02629000
*         /***********************************************************/ 02630000
*                                                                  0897 02631000
*         IF VIEXCVOL=ON&MVEXCVOL=OFF THEN                         0897 02632000
@RF00890 L     @01,VIENTPTR                                        0897 02633000
         TM    VIEXCVOL(@01),B'00010000'                           0897 02634000
         BNO   @RF00897                                            0897 02635000
         L     @01,MVENTPTR                                        0897 02636000
         TM    MVEXCVOL(@01),B'00010000'                           0897 02637000
         BNZ   @RF00897                                            0897 02638000
*           DO;                     /*                       @Z40LB61*/ 02639000
*             VESFLD=ON;            /*                       @Z40LB61*/ 02640000
         L     @15,@PC00001+4                                      0899 02641000
         L     @14,MARGPTR(,@15)                                   0899 02642000
         OI    VESFLD(@14),B'00100000'                             0899 02643000
*             FLDCHAR(1)=STATYES;   /*                       @Z40LB61*/ 02644000
         MVI   FLDCHAR+3(@14),C' '                                 0900 02645000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0900 02646000
         MVC   FLDCHAR(3,@14),@CC01343                             0900 02647000
*             FLDCHAR(2)=STATNO;    /*                       @Z40LB61*/ 02648000
         MVI   FLDCHAR+15(@14),C' '                                0901 02649000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0901 02650000
         MVC   FLDCHAR+12(3,@14),@CC01345                          0901 02651000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02652000
         L     @14,@PC00001                                        0902 02653000
         ST    @14,@AL00001                                        0902 02654000
         ST    @15,@AL00001+4                                      0902 02655000
         L     @15,@CV01495                                        0902 02656000
         LA    @01,@AL00001                                        0902 02657000
         BALR  @14,@15                                             0902 02658000
*           END;                    /*                       @Z40LB61*/ 02659000
*         IF VIEXCVOL=OFF&MVEXCVOL=ON THEN                         0904 02660000
@RF00897 L     @01,VIENTPTR                                        0904 02661000
         TM    VIEXCVOL(@01),B'00010000'                           0904 02662000
         BNZ   @RF00904                                            0904 02663000
         L     @01,MVENTPTR                                        0904 02664000
         TM    MVEXCVOL(@01),B'00010000'                           0904 02665000
         BNO   @RF00904                                            0904 02666000
*           DO;                     /*                       @Z40LB61*/ 02667000
*             VESFLD=ON;            /*                       @Z40LB61*/ 02668000
         L     @15,@PC00001+4                                      0906 02669000
         L     @14,MARGPTR(,@15)                                   0906 02670000
         OI    VESFLD(@14),B'00100000'                             0906 02671000
*             FLDCHAR(1)=STATNO;    /*                       @Z40LB61*/ 02672000
         MVI   FLDCHAR+3(@14),C' '                                 0907 02673000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0907 02674000
         MVC   FLDCHAR(3,@14),@CC01345                             0907 02675000
*             FLDCHAR(2)=STATYES;   /*                       @Z40LB61*/ 02676000
         MVI   FLDCHAR+15(@14),C' '                                0908 02677000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0908 02678000
         MVC   FLDCHAR+12(3,@14),@CC01343                          0908 02679000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02680000
         L     @14,@PC00001                                        0909 02681000
         ST    @14,@AL00001                                        0909 02682000
         ST    @15,@AL00001+4                                      0909 02683000
         L     @15,@CV01495                                        0909 02684000
         LA    @01,@AL00001                                        0909 02685000
         BALR  @14,@15                                             0909 02686000
*           END;                    /*                       @Z40LB61*/ 02687000
*                                                                  0910 02688000
*         /***********************************************************/ 02689000
*         /*                                                         */ 02690000
*         /* CHECK FOR MATCHING 'BOUND VOLUME' STATUS.       @Z40LB61*/ 02691000
*         /* IF INCONSISTENT, PRINT AN ERROR MESSAGE.        @Z40LB61*/ 02692000
*         /*                                                         */ 02693000
*         /***********************************************************/ 02694000
*                                                                  0911 02695000
*         IF VIBNDVOL=ON&MVBNDVOL=OFF THEN                         0911 02696000
@RF00904 L     @01,VIENTPTR                                        0911 02697000
         TM    VIBNDVOL(@01),B'00000100'                           0911 02698000
         BNO   @RF00911                                            0911 02699000
         L     @01,MVENTPTR                                        0911 02700000
         TM    MVBNDVOL(@01),B'00000100'                           0911 02701000
         BNZ   @RF00911                                            0911 02702000
*           DO;                     /*                       @Z40LB61*/ 02703000
*             VBSFLD=ON;            /*                       @Z40LB61*/ 02704000
         L     @15,@PC00001+4                                      0913 02705000
         L     @14,MARGPTR(,@15)                                   0913 02706000
         OI    VBSFLD(@14),B'00010000'                             0913 02707000
*             FLDCHAR(1)=STATYES;   /*                       @Z40LB61*/ 02708000
         MVI   FLDCHAR+3(@14),C' '                                 0914 02709000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0914 02710000
         MVC   FLDCHAR(3,@14),@CC01343                             0914 02711000
*             FLDCHAR(2)=STATNO;    /*                       @Z40LB61*/ 02712000
         MVI   FLDCHAR+15(@14),C' '                                0915 02713000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0915 02714000
         MVC   FLDCHAR+12(3,@14),@CC01345                          0915 02715000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02716000
         L     @14,@PC00001                                        0916 02717000
         ST    @14,@AL00001                                        0916 02718000
         ST    @15,@AL00001+4                                      0916 02719000
         L     @15,@CV01495                                        0916 02720000
         LA    @01,@AL00001                                        0916 02721000
         BALR  @14,@15                                             0916 02722000
*           END;                    /*                       @Z40LB61*/ 02723000
*         IF VIBNDVOL=OFF&MVBNDVOL=ON THEN                         0918 02724000
@RF00911 L     @01,VIENTPTR                                        0918 02725000
         TM    VIBNDVOL(@01),B'00000100'                           0918 02726000
         BNZ   @RF00918                                            0918 02727000
         L     @01,MVENTPTR                                        0918 02728000
         TM    MVBNDVOL(@01),B'00000100'                           0918 02729000
         BNO   @RF00918                                            0918 02730000
*           DO;                     /*                       @Z40LB61*/ 02731000
*             VBSFLD=ON;            /*                       @Z40LB61*/ 02732000
         L     @15,@PC00001+4                                      0920 02733000
         L     @14,MARGPTR(,@15)                                   0920 02734000
         OI    VBSFLD(@14),B'00010000'                             0920 02735000
*             FLDCHAR(1)=STATNO;    /*                       @Z40LB61*/ 02736000
         MVI   FLDCHAR+3(@14),C' '                                 0921 02737000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0921 02738000
         MVC   FLDCHAR(3,@14),@CC01345                             0921 02739000
*             FLDCHAR(2)=STATYES;   /*                       @Z40LB61*/ 02740000
         MVI   FLDCHAR+15(@14),C' '                                0922 02741000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0922 02742000
         MVC   FLDCHAR+12(3,@14),@CC01343                          0922 02743000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02744000
         L     @14,@PC00001                                        0923 02745000
         ST    @14,@AL00001                                        0923 02746000
         ST    @15,@AL00001+4                                      0923 02747000
         L     @15,@CV01495                                        0923 02748000
         LA    @01,@AL00001                                        0923 02749000
         BALR  @14,@15                                             0923 02750000
*           END;                    /*                       @Z40LB61*/ 02751000
*                                                                  0924 02752000
*         /***********************************************************/ 02753000
*         /*                                                         */ 02754000
*         /* CHECK FOR MATCHING 'WRITE INHIBIT' STATUS.      @Z40LB61*/ 02755000
*         /* IF INCONSISTENT, PRINT AN ERROR MESSAGE.        @Z40LB61*/ 02756000
*         /*                                                         */ 02757000
*         /***********************************************************/ 02758000
*                                                                  0925 02759000
*         IF VIWRTINH=ON&MVWRTINH=OFF THEN                         0925 02760000
@RF00918 L     @01,VIENTPTR                                        0925 02761000
         TM    VIWRTINH(@01),B'00000010'                           0925 02762000
         BNO   @RF00925                                            0925 02763000
         L     @01,MVENTPTR                                        0925 02764000
         TM    MVWRTINH(@01),B'00000010'                           0925 02765000
         BNZ   @RF00925                                            0925 02766000
*           DO;                     /*                       @Z40LB61*/ 02767000
*             WISFLD=ON;            /*                       @Z40LB61*/ 02768000
         L     @15,@PC00001+4                                      0927 02769000
         L     @14,MARGPTR(,@15)                                   0927 02770000
         OI    WISFLD(@14),B'00000100'                             0927 02771000
*             FLDCHAR(1)=STATYES;   /*                       @Z40LB61*/ 02772000
         MVI   FLDCHAR+3(@14),C' '                                 0928 02773000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0928 02774000
         MVC   FLDCHAR(3,@14),@CC01343                             0928 02775000
*             FLDCHAR(2)=STATNO;    /*                       @Z40LB61*/ 02776000
         MVI   FLDCHAR+15(@14),C' '                                0929 02777000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0929 02778000
         MVC   FLDCHAR+12(3,@14),@CC01345                          0929 02779000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02780000
         L     @14,@PC00001                                        0930 02781000
         ST    @14,@AL00001                                        0930 02782000
         ST    @15,@AL00001+4                                      0930 02783000
         L     @15,@CV01495                                        0930 02784000
         LA    @01,@AL00001                                        0930 02785000
         BALR  @14,@15                                             0930 02786000
*           END;                    /*                       @Z40LB61*/ 02787000
*         IF VIWRTINH=OFF&MVWRTINH=ON THEN                         0932 02788000
@RF00925 L     @01,VIENTPTR                                        0932 02789000
         TM    VIWRTINH(@01),B'00000010'                           0932 02790000
         BNZ   @RF00932                                            0932 02791000
         L     @01,MVENTPTR                                        0932 02792000
         TM    MVWRTINH(@01),B'00000010'                           0932 02793000
         BNO   @RF00932                                            0932 02794000
*           DO;                     /*                       @Z40LB61*/ 02795000
*             WISFLD=ON;            /*                       @Z40LB61*/ 02796000
         L     @15,@PC00001+4                                      0934 02797000
         L     @14,MARGPTR(,@15)                                   0934 02798000
         OI    WISFLD(@14),B'00000100'                             0934 02799000
*             FLDCHAR(1)=STATNO;    /*                       @Z40LB61*/ 02800000
         MVI   FLDCHAR+3(@14),C' '                                 0935 02801000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     0935 02802000
         MVC   FLDCHAR(3,@14),@CC01345                             0935 02803000
*             FLDCHAR(2)=STATYES;   /*                       @Z40LB61*/ 02804000
         MVI   FLDCHAR+15(@14),C' '                                0936 02805000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   0936 02806000
         MVC   FLDCHAR+12(3,@14),@CC01343                          0936 02807000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02808000
         L     @14,@PC00001                                        0937 02809000
         ST    @14,@AL00001                                        0937 02810000
         ST    @15,@AL00001+4                                      0937 02811000
         L     @15,@CV01495                                        0937 02812000
         LA    @01,@AL00001                                        0937 02813000
         BALR  @14,@15                                             0937 02814000
*           END;                    /*                       @Z40LB61*/ 02815000
*                                                                  0938 02816000
*         /***********************************************************/ 02817000
*         /*                                                         */ 02818000
*         /* CHECK FOR MATCHING CELL ADDRESSES. IF           @Z40LB61*/ 02819000
*         /* INCONSISTENT, PRINT AN ERROR MESSAGE.           @Z40LB61*/ 02820000
*         /*                                                         */ 02821000
*         /***********************************************************/ 02822000
*                                                                  0939 02823000
*         IF VILZYX1^=MVLZYX1 THEN                                 0939 02824000
@RF00932 L     @15,VIENTPTR                                        0939 02825000
         L     @14,MVENTPTR                                        0939 02826000
         CLC   VILZYX1(2,@15),MVLZYX1(@14)                         0939 02827000
         BE    @RF00939                                            0939 02828000
*           DO;                     /*                       @Z40LB61*/ 02829000
*             CAFLD=ON;             /*                       @Z40LB61*/ 02830000
         L     @05,@PC00001+4                                      0941 02831000
         L     @04,MARGPTR(,@05)                                   0941 02832000
         OI    CAFLD(@04),B'00010000'                              0941 02833000
*             FLDNUM(1)=VILZYX1;    /*                       @Z40LB61*/ 02834000
         SLR   @03,@03                                             0942 02835000
         ICM   @03,3,VILZYX1(@15)                                  0942 02836000
         ST    @03,FLDNUM(,@04)                                    0942 02837000
*             FLDNUM(2)=MVLZYX1;    /*                       @Z40LB61*/ 02838000
         SLR   @15,@15                                             0943 02839000
         ICM   @15,3,MVLZYX1(@14)                                  0943 02840000
         ST    @15,FLDNUM+12(,@04)                                 0943 02841000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02842000
         L     @04,@PC00001                                        0944 02843000
         ST    @04,@AL00001                                        0944 02844000
         ST    @05,@AL00001+4                                      0944 02845000
         L     @15,@CV01495                                        0944 02846000
         LA    @01,@AL00001                                        0944 02847000
         BALR  @14,@15                                             0944 02848000
*           END;                    /*                       @Z40LB61*/ 02849000
*         IF VILZYX2^=MVLZYX2 THEN                                 0946 02850000
@RF00939 L     @15,VIENTPTR                                        0946 02851000
         L     @14,MVENTPTR                                        0946 02852000
         CLC   VILZYX2(2,@15),MVLZYX2(@14)                         0946 02853000
         BE    @RF00946                                            0946 02854000
*           DO;                     /*                       @Z40LB61*/ 02855000
*             CAFLD=ON;             /*                       @Z40LB61*/ 02856000
         L     @05,@PC00001+4                                      0948 02857000
         L     @04,MARGPTR(,@05)                                   0948 02858000
         OI    CAFLD(@04),B'00010000'                              0948 02859000
*             FLDNUM(1)=VILZYX2;    /*                       @Z40LB61*/ 02860000
         SLR   @03,@03                                             0949 02861000
         ICM   @03,3,VILZYX2(@15)                                  0949 02862000
         ST    @03,FLDNUM(,@04)                                    0949 02863000
*             FLDNUM(2)=MVLZYX2;    /*                       @Z40LB61*/ 02864000
         SLR   @15,@15                                             0950 02865000
         ICM   @15,3,MVLZYX2(@14)                                  0950 02866000
         ST    @15,FLDNUM+12(,@04)                                 0950 02867000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 02868000
         L     @04,@PC00001                                        0951 02869000
         ST    @04,@AL00001                                        0951 02870000
         ST    @05,@AL00001+4                                      0951 02871000
         L     @15,@CV01495                                        0951 02872000
         LA    @01,@AL00001                                        0951 02873000
         BALR  @14,@15                                             0951 02874000
*           END;                    /*                       @Z40LB61*/ 02875000
*                                                                  0952 02876000
*         /***********************************************************/ 02877000
*         /*                                                         */ 02878000
*         /* RESET THE 'IDCCH04' OPTION FLAGS                @Z40LB61*/ 02879000
*         /*                                                         */ 02880000
*         /***********************************************************/ 02881000
*                                                                  0953 02882000
*         MSGTYPE=''B;              /*                       @Z40LB61*/ 02883000
@RF00946 L     @15,@PC00001+4                                      0953 02884000
         L     @15,MARGPTR(,@15)                                   0953 02885000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         0953 02886000
*         TBLTYPE(1)=''B;           /*                       @Z40LB61*/ 02887000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         0954 02888000
*         TBLTYPE(2)=''B;           /*                       @Z40LB61*/ 02889000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     0955 02890000
*       END MVTVIM;                 /*                       @Z40LB61*/ 02891000
*   END CHKMVTVI;                   /*                       @Z40LB61*/ 02892000
         B     @EL00004                                            0957 02893000
*                                                                  0958 02894000
*/********************************************************************/ 02895000
*/*                                                          @Z40LB61*/ 02896000
*/* PROCEDURE NAME - MVTVVAS                                 @Z40LB61*/ 02897000
*/*                                                          @Z40LB61*/ 02898000
*/* FUNCTION - THIS ROUTINE COMPARES MVT VVA-RELATED DATA    @Z40LB61*/ 02899000
*/*            AGAINST VVA-RELATED DATA IN CORRESPONDING     @Z40LB61*/ 02900000
*/*            MSC AND SA TABLES.                            @Z40LB61*/ 02901000
*/*                                                          @Z40LB61*/ 02902000
*/* INPUT -                                                  @Z40LB61*/ 02903000
*/*        (1) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 02904000
*/*        (2) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 02905000
*/*        (3) MSC VIRTUAL VOLUME ADDRESS TABLE              @Z40LB61*/ 02906000
*/*        (4) MSC VVA/MVT CROSS REFERENCE TABLE             @Z40LB61*/ 02907000
*/*        (5) SA VIRTUAL VOLUME INFORMATION TABLE           @Z40LB61*/ 02908000
*/*                                                          @Z40LB61*/ 02909000
*/* OUTPUT -                                                 @Z40LB61*/ 02910000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 02911000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 02912000
*/*        (3) VVAT CHECK-OFF TABLE                          @Z40LB61*/ 02913000
*/*        (4) VVA/MVT XREF CHECK-OFF TABLE                  @Z40LB61*/ 02914000
*/*        (5) VVIT CHECK-OFF TABLE                          @Z40LB61*/ 02915000
*/*                                                          @Z40LB61*/ 02916000
*/********************************************************************/ 02917000
*                                                                  0958 02918000
*MVTVVAS:                                                          0958 02919000
*   PROCEDURE;                      /*                       @Z40LB61*/ 02920000
MVTVVAS  STM   @14,@12,@SA00005                                    0958 02921000
*   OLDERID2=NEWERID2;                                             0959 02922000
         L     @15,@PC00001                                        0959 02923000
         L     @15,GDTTR2(,@15)                                    0959 02924000
         MVC   @TS00001(95),NEWERID2(@15)                          0959 02925000
         MVC   OLDERID2(95,@15),@TS00001                           0959 02926000
*   NEWID2='CH2G';                  /*                       @Z40LB61*/ 02927000
*                                                                  0960 02928000
         MVC   NEWID2(4,@15),@CC01569                              0960 02929000
*   /*****************************************************************/ 02930000
*   /*                                                               */ 02931000
*   /* DETERMINE THE MOUNTED STATUS OF THE VOLUME WITH       @Z40LB61*/ 02932000
*   /* RESPECT TO SA PATHS. FOR CHECKING PURPOSES,           @Z40LB61*/ 02933000
*   /* A VALID SA PATH IS OF NO INTEREST IF NONE OF          @Z40LB61*/ 02934000
*   /* ITS INTERFACES ARE ACTIVE.                            @Z40LB61*/ 02935000
*   /*                                                               */ 02936000
*   /*****************************************************************/ 02937000
*                                                                  0961 02938000
*   DO MVPATH#=1 TO SASSDG;         /*                       @Z40LB61*/ 02939000
         LA    @15,1                                               0961 02940000
         STH   @15,MVPATH#                                         0961 02941000
@DL00961 DS    0H                                                  0962 02942000
*     IF MVVLDSA(MVPATH#)=ON&(MVACTB(MVPATH#)=ON|MVACTC(MVPATH#)=ON|    02943000
*         MVACTD(MVPATH#)=ON) THEN                                 0962 02944000
         L     @14,MVENTPTR                                        0962 02945000
         LR    @05,@15                                             0962 02946000
         SLA   @05,3                                               0962 02947000
         ST    @05,@TF00001                                        0962 02948000
         ALR   @05,@14                                             0962 02949000
         TM    MVVLDSA-8(@05),B'10000000'                          0962 02950000
         BNO   @RF00962                                            0962 02951000
         AL    @14,@TF00001                                        0962 02952000
         TM    MVACTB-8(@14),B'01110000'                           0962 02953000
         BZ    @RF00962                                            0962 02954000
*       ACTIVSA(MVPATH#)=ON;        /*                       @Z40LB61*/ 02955000
         LA    @14,ACTIVSA-1(@15)                                  0963 02956000
         OI    0(@14),B'10000000'                                  0963 02957000
*     ELSE                                                         0964 02958000
*       ACTIVSA(MVPATH#)=OFF;       /*                       @Z40LB61*/ 02959000
         B     @RC00962                                            0964 02960000
@RF00962 LH    @01,MVPATH#                                         0964 02961000
         LA    @15,ACTIVSA-1(@01)                                  0964 02962000
         NI    0(@15),B'01111111'                                  0964 02963000
*   END;                            /*                       @Z40LB61*/ 02964000
@RC00962 LA    @15,1                                               0965 02965000
         AH    @15,MVPATH#                                         0965 02966000
         STH   @15,MVPATH#                                         0965 02967000
         CH    @15,@CH00157                                        0965 02968000
         BNH   @DL00961                                            0965 02969000
*   IF ACTIVSA(1)=ON&ACTIVSA(2)=ON THEN                            0966 02970000
         TM    ACTIVSA,B'10000000'                                 0966 02971000
         BNO   @RF00966                                            0966 02972000
         TM    ACTIVSA+1,B'10000000'                               0966 02973000
         BNO   @RF00966                                            0966 02974000
*     MVSHARED=ON;                  /*                       @Z40LB61*/ 02975000
         OI    MVSHARED,B'10000000'                                0967 02976000
*   ELSE                                                           0968 02977000
*     MVSHARED=OFF;                 /*                       @Z40LB61*/ 02978000
*                                                                  0968 02979000
         B     @RC00966                                            0968 02980000
@RF00966 NI    MVSHARED,B'01111111'                                0968 02981000
*   /*****************************************************************/ 02982000
*   /*                                                               */ 02983000
*   /* CHECK FIELDS RELATED TO EACH VALID SA PATH            @Z40LB61*/ 02984000
*   /*                                                               */ 02985000
*   /*****************************************************************/ 02986000
*                                                                  0969 02987000
*SALOOP1:                                                          0969 02988000
*   DO MVPATH#=1 TO SASSDG;         /*                       @Z40LB61*/ 02989000
@RC00966 DS    0H                                                  0969 02990000
SALOOP1  LA    @15,1                                               0969 02991000
         STH   @15,MVPATH#                                         0969 02992000
@DL00969 DS    0H                                                  0970 02993000
*     IF ACTIVSA(MVPATH#)=ON THEN                                  0970 02994000
*                                                                  0970 02995000
         LA    @14,ACTIVSA-1(@15)                                  0970 02996000
         TM    0(@14),B'10000000'                                  0970 02997000
         BNO   @RF00970                                            0970 02998000
*       /*************************************************************/ 02999000
*       /*                                                           */ 03000000
*       /* FOR AN SA WITH AT LEAST ONE ACTIVE INTERFACE,     @Z40LB61*/ 03001000
*       /* CHECK RELATED FIELDS.                             @Z40LB61*/ 03002000
*       /*                                                           */ 03003000
*       /*************************************************************/ 03004000
*                                                                  0971 03005000
*ACTIVESA:                                                         0971 03006000
*       DO;                         /*                       @Z40LB61*/ 03007000
ACTIVESA DS    0H                                                  0972 03008000
*         MVSA#=MVSA(MVPATH#)&MASK15;/*                      @Z40LB61*/ 03009000
         LH    @15,MVPATH#                                         0972 03010000
         SLA   @15,3                                               0972 03011000
         L     @01,MVENTPTR                                        0972 03012000
         SLR   @14,@14                                             0972 03013000
         IC    @14,MVSA-8(@15,@01)                                 0972 03014000
         SLR   @15,@15                                             0972 03015000
         IC    @15,MASK15                                          0972 03016000
         NR    @14,@15                                             0972 03017000
         STH   @14,MVSA#                                           0972 03018000
*         SA#=MVSA#+1;              /*                       @Z40LB61*/ 03019000
*                                                                  0973 03020000
         AH    @14,@CH00223                                        0973 03021000
         STH   @14,SA#                                             0973 03022000
*         /***********************************************************/ 03023000
*         /*                                                         */ 03024000
*         /* IF THE SA# OR VVA# FROM THE MVT ENTRY IS        @Z40LB61*/ 03025000
*         /* INVALID, PRINT AN ERROR MESSAGE. DON'T DO ANY   @Z40LB61*/ 03026000
*         /* FURTHER CHECKING INVOLVING THIS SA.             @Z40LB61*/ 03027000
*         /* IF THE SA# IS OFFLINE OR SUU THEN SKIP PROCESS- @ZA27324*/ 03028000
*         /* ING THIS PARTICULAR SA.                         @ZA27324*/ 03029000
*         /*                                                         */ 03030000
*         /***********************************************************/ 03031000
*                                                                  0974 03032000
*         IF IVVITPTR(SA#)=NULLPTR| /*                       @ZA27324*/ 03033000
*             IVVITPTR(SA#)=DUMMYPTR THEN/*                  @ZA27324*/ 03034000
         SLA   @14,2                                               0974 03035000
         L     @15,@PC00001+4                                      0974 03036000
         L     @15,IVVITPTR-4(@14,@15)                             0974 03037000
         LTR   @15,@15                                             0974 03038000
         BZ    @RT00974                                            0974 03039000
         C     @15,DUMMYPTR                                        0974 03040000
         BNE   @RF00974                                            0974 03041000
@RT00974 DS    0H                                                  0975 03042000
*           DO;                     /*                       @ZA27324*/ 03043000
*             IF IVVITPTR(SA#)=DUMMYPTR THEN                       0976 03044000
         LH    @15,SA#                                             0976 03045000
         SLA   @15,2                                               0976 03046000
         L     @14,@PC00001+4                                      0976 03047000
         L     @15,IVVITPTR-4(@15,@14)                             0976 03048000
         C     @15,DUMMYPTR                                        0976 03049000
         BE    @RT00976                                            0976 03050000
*               ;                   /*                       @ZA27324*/ 03051000
*             ELSE                  /*                       @ZA27324*/ 03052000
*               DO;                 /*                       @ZA27324*/ 03053000
*                 MTCHMSG=ON;       /*                       @ZA27324*/ 03054000
         L     @15,@PC00001+4                                      0979 03055000
         L     @14,MARGPTR(,@15)                                   0979 03056000
         OI    MTCHMSG(@14),B'00010000'                            0979 03057000
*                 CBMTBL(1)=ON;     /*                       @ZA27324*/ 03058000
         OI    CBMTBL(@14),B'00001000'                             0980 03059000
*                 MVTTBL(2)=ON;     /*                       @ZA27324*/ 03060000
         OI    MVTTBL+4(@14),B'10000000'                           0981 03061000
*                 SAFLD=ON;         /*                       @ZA27324*/ 03062000
         OI    SAFLD(@14),B'00001000'                              0982 03063000
*                 FLDNUM(1)=MVSA#;  /*                       @ZA27324*/ 03064000
         LH    @05,MVSA#                                           0983 03065000
         ST    @05,FLDNUM(,@14)                                    0983 03066000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @ZA27324*/ 03067000
         L     @14,@PC00001                                        0984 03068000
         ST    @14,@AL00001                                        0984 03069000
         ST    @15,@AL00001+4                                      0984 03070000
         L     @15,@CV01495                                        0984 03071000
         LA    @01,@AL00001                                        0984 03072000
         BALR  @14,@15                                             0984 03073000
*               END;                /*                       @ZA27324*/ 03074000
*           END;                    /*                       @Z40LB61*/ 03075000
*         ELSE                                                     0987 03076000
*           IF MVVVA(MVPATH#)<LOWVVA THEN                          0987 03077000
         B     @RC00974                                            0987 03078000
@RF00974 LH    @15,MVPATH#                                         0987 03079000
         SLA   @15,3                                               0987 03080000
         L     @01,MVENTPTR                                        0987 03081000
         SLR   @14,@14                                             0987 03082000
         IC    @14,MVVVA-8(@15,@01)                                0987 03083000
         CH    @14,@CH00580                                        0987 03084000
         BNL   @RF00987                                            0987 03085000
*             DO;                   /*                       @Z40LB61*/ 03086000
*               MTCHMSG=ON;         /*                       @Z40LB61*/ 03087000
         L     @15,@PC00001+4                                      0989 03088000
         L     @05,MARGPTR(,@15)                                   0989 03089000
         OI    MTCHMSG(@05),B'00010000'                            0989 03090000
*               VVATTBL(1)=ON;      /*                       @Z40LB61*/ 03091000
         OI    VVATTBL(@05),B'10000000'                            0990 03092000
*               MVTTBL(2)=ON;       /*                       @Z40LB61*/ 03093000
         OI    MVTTBL+4(@05),B'10000000'                           0991 03094000
*               VVAFLD=ON;          /*                       @Z40LB61*/ 03095000
         OI    VVAFLD(@05),B'01000000'                             0992 03096000
*               FLDNUM(1)=MVVVA(MVPATH#);/*                  @Z40LB61*/ 03097000
         ST    @14,FLDNUM(,@05)                                    0993 03098000
*               CALL IDCCH04(GDTTBL,CDALIST);/*              @Z40LB61*/ 03099000
         L     @14,@PC00001                                        0994 03100000
         ST    @14,@AL00001                                        0994 03101000
         ST    @15,@AL00001+4                                      0994 03102000
         L     @15,@CV01495                                        0994 03103000
         LA    @01,@AL00001                                        0994 03104000
         BALR  @14,@15                                             0994 03105000
*             END;                  /*                       @Z40LB61*/ 03106000
*           ELSE                                                   0996 03107000
*                                                                  0996 03108000
*             /*******************************************************/ 03109000
*             /*                                                     */ 03110000
*             /* IF SA AND VVA ARE VALID, PREPARE TO COMPARE @Z40LB61*/ 03111000
*             /* WITH VVA-RELATED SA AND MSC TABLES.         @Z40LB61*/ 03112000
*             /*                                                     */ 03113000
*             /*******************************************************/ 03114000
*                                                                  0996 03115000
*SAVVAOK:                                                          0996 03116000
*             DO;                   /*                       @Z40LB61*/ 03117000
         B     @RC00987                                            0996 03118000
@RF00987 DS    0H                                                  0996 03119000
SAVVAOK  DS    0H                                                  0997 03120000
*               OLDERID2=NEWERID2;                                 0997 03121000
         L     @15,@PC00001                                        0997 03122000
         L     @15,GDTTR2(,@15)                                    0997 03123000
         MVC   @TS00001(95),NEWERID2(@15)                          0997 03124000
         MVC   OLDERID2(95,@15),@TS00001                           0997 03125000
*               NEWID2='CH2H';      /*                       @Z40LB61*/ 03126000
         MVC   NEWID2(4,@15),@CC01576                              0998 03127000
*               WORKVVA=MVVVA(MVPATH#)-LOWVVA+1;/*           @Z40LB61*/ 03128000
         LH    @15,MVPATH#                                         0999 03129000
         SLA   @15,3                                               0999 03130000
         L     @01,MVENTPTR                                        0999 03131000
         SLR   @14,@14                                             0999 03132000
         IC    @14,MVVVA-8(@15,@01)                                0999 03133000
         AH    @14,@CH01729                                        0999 03134000
         STH   @14,WORKVVA                                         0999 03135000
*               BYTE#=(WORKVVA-1)/8+1;/*                     @Z40LB61*/ 03136000
         L     @15,@PC00001+4                                      1000 03137000
         L     @05,EARGPTR(,@15)                                   1000 03138000
         LA    @04,1                                               1000 03139000
         BCTR  @14,0                                               1000 03140000
         LR    @00,@14                                             1000 03141000
         SRDA  @00,32                                              1000 03142000
         D     @00,@CF00183                                        1000 03143000
         ALR   @01,@04                                             1000 03144000
         STH   @01,BYTE#(,@05)                                     1000 03145000
*               BIT#=(WORKVVA-1)//8+1;/*                     @Z40LB61*/ 03146000
*                                                                  1001 03147000
         SRDA  @14,32                                              1001 03148000
         D     @14,@CF00183                                        1001 03149000
         ALR   @14,@04                                             1001 03150000
         STH   @14,BIT#(,@05)                                      1001 03151000
*               /*****************************************************/ 03152000
*               /*                                                   */ 03153000
*               /* CHECK THAT THE BIT IN THE MSC VIRTUAL     @Z40LB61*/ 03154000
*               /* VOLUME ADDRESS TABLE THAT CORRESPONDS TO  @Z40LB61*/ 03155000
*               /* CURRENT VVA IS 'IN USE'.                  @ZD00043*/ 03156000
*               /* IF 'IN USE', CHECK-OFF THAT VVA. IF NOT,  @Z40LB61*/ 03157000
*               /* PRINT AN ERROR MESSAGE.                   @Z40LB61*/ 03158000
*               /*                                                   */ 03159000
*               /*****************************************************/ 03160000
*                                                                  1002 03161000
*               VVATPTR=VVATADDR+LENGTH(VVAT)*MVSA#;/*       @Z40LB61*/ 03162000
         L     @15,@PC00001+4                                      1002 03163000
         LH    @00,MVSA#                                           1002 03164000
         SLA   @00,5                                               1002 03165000
         AL    @00,VVATADDR(,@15)                                  1002 03166000
         ST    @00,VVATPTR                                         1002 03167000
*               IF(VVATVVA(BYTE#)&BITMASK(BIT#))^=0 THEN           1003 03168000
         LR    @05,@00                                             1003 03169000
         AL    @05,@CF01340                                        1003 03170000
         SLR   @04,@04                                             1003 03171000
         IC    @04,VVATVVA(@01,@05)                                1003 03172000
         SLR   @05,@05                                             1003 03173000
         IC    @05,BITMASK-1(@14)                                  1003 03174000
         NR    @04,@05                                             1003 03175000
         LTR   @04,@04                                             1003 03176000
         BZ    @RF01003                                            1003 03177000
*                 VVACHKFF(SA#,BYTE#)=VVACHKFF(SA#,BYTE#)|BITMASK(BIT#) 03178000
*                   ;               /*                       @Z40LB61*/ 03179000
         LH    @05,SA#                                             1004 03180000
         MH    @05,@CH00314                                        1004 03181000
         ALR   @05,@01                                             1004 03182000
         L     @01,VVACOPTR(,@15)                                  1004 03183000
         ALR   @01,@05                                             1004 03184000
         AL    @01,@CF01759                                        1004 03185000
         LA    @15,BITMASK-1(@14)                                  1004 03186000
         OC    VVACHKFF(1,@01),0(@15)                              1004 03187000
*               ELSE                                               1005 03188000
*                 DO;               /*                       @Z40LB61*/ 03189000
         B     @RC01003                                            1005 03190000
@RF01003 DS    0H                                                  1006 03191000
*                   INCNMSG=ON;     /*                       @Z40LB61*/ 03192000
         L     @15,@PC00001+4                                      1006 03193000
         L     @15,MARGPTR(,@15)                                   1006 03194000
         OI    INCNMSG(@15),B'10000000'                            1006 03195000
*                   VVATTBL(1)=ON;  /*                       @Z40LB61*/ 03196000
         OI    VVATTBL(@15),B'10000000'                            1007 03197000
*                   MVTTBL(2)=ON;   /*                       @Z40LB61*/ 03198000
         OI    MVTTBL+4(@15),B'10000000'                           1008 03199000
*                   IUSFLD=ON;      /*                       @Z40LB61*/ 03200000
         OI    IUSFLD(@15),B'00000001'                             1009 03201000
*                   FLDCHAR(1)=STATNO;/*                     @Z40LB61*/ 03202000
         MVI   FLDCHAR+3(@15),C' '                                 1010 03203000
         MVC   FLDCHAR+4(8,@15),FLDCHAR+3(@15)                     1010 03204000
         MVC   FLDCHAR(3,@15),@CC01345                             1010 03205000
*                   FLDCHAR(2)=STATYES;/*                    @Z40LB61*/ 03206000
         MVI   FLDCHAR+15(@15),C' '                                1011 03207000
         MVC   FLDCHAR+16(8,@15),FLDCHAR+15(@15)                   1011 03208000
         MVC   FLDCHAR+12(3,@15),@CC01343                          1011 03209000
*                   IF MVSA#<SAMAX/2 THEN                          1012 03210000
         LH    @14,MVSA#                                           1012 03211000
         CH    @14,@CH00183                                        1012 03212000
         BNL   @RF01012                                            1012 03213000
*                     CHRINDEX(1)=VVATCHR(1);/*              @Z40LB61*/ 03214000
         MVC   CHRINDEX(5,@15),VVATCHR                             1013 03215000
*                   ELSE                                           1014 03216000
*                     CHRINDEX(1)=VVATCHR(2);/*              @Z40LB61*/ 03217000
         B     @RC01012                                            1014 03218000
@RF01012 L     @15,@PC00001+4                                      1014 03219000
         L     @01,MARGPTR(,@15)                                   1014 03220000
         MVC   CHRINDEX(5,@01),VVATCHR+5                           1014 03221000
*                   SAINDEX(1)=MVSA#;/*                      @Z40LB61*/ 03222000
@RC01012 L     @15,@PC00001+4                                      1015 03223000
         L     @14,MARGPTR(,@15)                                   1015 03224000
         MVC   SAINDEX(1,@14),MVSA#+1                              1015 03225000
*                   VVAINDEX(1)=MVVVA(MVPATH#);/*            @Z40LB61*/ 03226000
         LH    @05,MVPATH#                                         1016 03227000
         SLA   @05,3                                               1016 03228000
         L     @01,MVENTPTR                                        1016 03229000
         SLR   @04,@04                                             1016 03230000
         IC    @04,MVVVA-8(@05,@01)                                1016 03231000
         STC   @04,VVAINDEX(,@14)                                  1016 03232000
*                   CALL IDCCH04(GDTTBL,CDALIST);/*          @Z40LB61*/ 03233000
         L     @14,@PC00001                                        1017 03234000
         ST    @14,@AL00001                                        1017 03235000
         ST    @15,@AL00001+4                                      1017 03236000
         L     @15,@CV01495                                        1017 03237000
         LA    @01,@AL00001                                        1017 03238000
         BALR  @14,@15                                             1017 03239000
*                 END;              /*                       @Z40LB61*/ 03240000
*                                                                  1018 03241000
*               /*****************************************************/ 03242000
*               /*                                                   */ 03243000
*               /* IF MSC-MSC CHECKING WAS REQUESTED, CHECK  @Z40LB61*/ 03244000
*               /* FOR A VVA MATCH WITH THE MSC VVA/MVT XREF @Z40LB61*/ 03245000
*               /* (VMX) TABLE.                              @Z40LB61*/ 03246000
*               /*                                                   */ 03247000
*               /*****************************************************/ 03248000
*                                                                  1019 03249000
*               IF MSCCHK=ON THEN                                  1019 03250000
@RC01003 L     @15,@PC00001+4                                      1019 03251000
         TM    MSCCHK(@15),B'10000000'                             1019 03252000
         BNO   @RF01019                                            1019 03253000
*VMXCHK:                                                           1020 03254000
*                 DO;               /*                       @Z40LB61*/ 03255000
*                                                                  1020 03256000
VMXCHK   DS    0H                                                  1021 03257000
*                   /*************************************************/ 03258000
*                   /*                                               */ 03259000
*                   /* OBTAIN THE PART OF THE VMX TABLE THAT @Z40LB61*/ 03260000
*                   /* SHOULD CONTAIN A VALID ENTRY FOR THE  @Z40LB61*/ 03261000
*                   /* CURRENT VVA.                          @Z40LB61*/ 03262000
*                   /*                                               */ 03263000
*                   /*************************************************/ 03264000
*                                                                  1021 03265000
*                   TABLEID=VMXTBLID;/*                      @Z40LB61*/ 03266000
         L     @15,@PC00001+4                                      1021 03267000
         L     @14,EARGPTR(,@15)                                   1021 03268000
         MVC   TABLEID(1,@14),VMXTBLID                             1021 03269000
*                   SANUM=MVSA#;    /*                       @Z40LB61*/ 03270000
         MVC   SANUM(2,@14),MVSA#                                  1022 03271000
*                   VVADDR=MVVVA(MVPATH#);/*                 @Z40LB61*/ 03272000
         LH    @05,MVPATH#                                         1023 03273000
         SLA   @05,3                                               1023 03274000
         L     @01,MVENTPTR                                        1023 03275000
         SLR   @04,@04                                             1023 03276000
         IC    @04,MVVVA-8(@05,@01)                                1023 03277000
         STH   @04,VVADDR(,@14)                                    1023 03278000
*                   CALL IDCCH03(GDTTBL,CDALIST);/*          @Z40LB61*/ 03279000
         L     @14,@PC00001                                        1024 03280000
         ST    @14,@AL00001                                        1024 03281000
         ST    @15,@AL00001+4                                      1024 03282000
         L     @15,@CV01494                                        1024 03283000
         LA    @01,@AL00001                                        1024 03284000
         BALR  @14,@15                                             1024 03285000
*                   IF GETRC^=0 THEN                               1025 03286000
         L     @15,@PC00001+4                                      1025 03287000
         L     @01,EARGPTR(,@15)                                   1025 03288000
         ICM   @00,3,GETRC(@01)                                    1025 03289000
         BZ    @RF01025                                            1025 03290000
*                     DO;           /*                       @Z40LB61*/ 03291000
*                       LASTCOND=LASTCC12;/*                 @Z40LB61*/ 03292000
         L     @15,@PC00001+8                                      1027 03293000
         MVC   LASTCOND(2,@15),@CH00567                            1027 03294000
*                       RETURN;     /*                       @Z40LB61*/ 03295000
@EL00005 DS    0H                                                  1028 03296000
@EF00005 DS    0H                                                  1028 03297000
@ER00005 LM    @14,@12,@SA00005                                    1028 03298000
         BR    @14                                                 1028 03299000
*                     END;          /*                       @Z40LB61*/ 03300000
*                   VMXPTR=TBLADDR; /*                       @Z40LB61*/ 03301000
*                                                                  1030 03302000
@RF01025 L     @15,@PC00001+4                                      1030 03303000
         L     @14,EARGPTR(,@15)                                   1030 03304000
         L     @05,TBLADDR(,@14)                                   1030 03305000
         ST    @05,VMXPTR                                          1030 03306000
*                   /*************************************************/ 03307000
*                   /*                                               */ 03308000
*                   /* DO COMMON SET-UP FOR POSSIBLE         @Z40LB61*/ 03309000
*                   /* ERROR MESSAGES.                       @Z40LB61*/ 03310000
*                   /*                                               */ 03311000
*                   /*************************************************/ 03312000
*                                                                  1031 03313000
*                   SAINDEX(1)=MVSA#;/*                      @Z40LB61*/ 03314000
         L     @04,MARGPTR(,@15)                                   1031 03315000
         MVC   SAINDEX(1,@04),MVSA#+1                              1031 03316000
*                   VVAINDEX(1)=VVADDR;/*                    @Z40LB61*/ 03317000
         MVC   VVAINDEX(1,@04),VVADDR+1(@14)                       1032 03318000
*                   CHRINDEX(1)=PREVCHR;/*                   @Z40LB61*/ 03319000
*                                                                  1033 03320000
         MVC   CHRINDEX(5,@04),PREVCHR(@14)                        1033 03321000
*                   /*************************************************/ 03322000
*                   /*                                               */ 03323000
*                   /* IF THE CORRESPONDING VMX ENTRY FOR    @Z40LB61*/ 03324000
*                   /* THE CURRENT VVA IS NOT VALID, PRINT   @Z40LB61*/ 03325000
*                   /* AN ERROR MESSAGE.                     @Z40LB61*/ 03326000
*                   /*                                               */ 03327000
*                   /*************************************************/ 03328000
*                                                                  1034 03329000
*                   IF VMXVALID=OFF THEN                           1034 03330000
         TM    VMXVALID(@05),B'10000000'                           1034 03331000
         BNZ   @RF01034                                            1034 03332000
*                     DO;           /*                       @Z40LB61*/ 03333000
*                       VMXTBL(1)=ON;/*                      @Z40LB61*/ 03334000
         OI    VMXTBL(@04),B'00000001'                             1036 03335000
*                       MVTTBL(2)=ON;/*                      @Z40LB61*/ 03336000
         OI    MVTTBL+4(@04),B'10000000'                           1037 03337000
*                       INCNMSG=ON; /*                       @Z40LB61*/ 03338000
         OI    INCNMSG(@04),B'10000000'                            1038 03339000
*                       IUSFLD=ON;  /*                       @Z40LB61*/ 03340000
         OI    IUSFLD(@04),B'00000001'                             1039 03341000
*                       FLDCHAR(1)=STATNO;/*                 @Z40LB61*/ 03342000
         MVI   FLDCHAR+3(@04),C' '                                 1040 03343000
         MVC   FLDCHAR+4(8,@04),FLDCHAR+3(@04)                     1040 03344000
         MVC   FLDCHAR(3,@04),@CC01345                             1040 03345000
*                       FLDCHAR(2)=STATYES;/*                @Z40LB61*/ 03346000
         MVI   FLDCHAR+15(@04),C' '                                1041 03347000
         MVC   FLDCHAR+16(8,@04),FLDCHAR+15(@04)                   1041 03348000
         MVC   FLDCHAR+12(3,@04),@CC01343                          1041 03349000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 03350000
         L     @14,@PC00001                                        1042 03351000
         ST    @14,@AL00001                                        1042 03352000
         ST    @15,@AL00001+4                                      1042 03353000
         L     @15,@CV01495                                        1042 03354000
         LA    @01,@AL00001                                        1042 03355000
         BALR  @14,@15                                             1042 03356000
*                     END;          /*                       @Z40LB61*/ 03357000
*                   ELSE                                           1044 03358000
*                                                                  1044 03359000
*                     /***********************************************/ 03360000
*                     /*                                             */ 03361000
*                     /* IF A VALID VMX ENTRY WAS FOUND,     @Z40LB61*/ 03362000
*                     /* CHECK-OFF THAT VMX ENTRY AND CHECK  @Z40LB61*/ 03363000
*                     /* THAT IT CONTAINS THE MVT POINTER    @Z40LB61*/ 03364000
*                     /* TO THE CURRENT MVT ENTRY.           @Z40LB61*/ 03365000
*                     /*                                             */ 03366000
*                     /***********************************************/ 03367000
*                                                                  1044 03368000
*MVTVMXM:                                                          1044 03369000
*                     DO;           /*                       @Z40LB61*/ 03370000
         B     @RC01034                                            1044 03371000
@RF01034 DS    0H                                                  1044 03372000
MVTVMXM  DS    0H                                                  1045 03373000
*                       VMXCHKFF(SA#,BYTE#)=VMXCHKFF(SA#,BYTE#)|BITMASK 03374000
*                           (BIT#); /*                       @Z40LB61*/ 03375000
         LH    @15,SA#                                             1045 03376000
         MH    @15,@CH00314                                        1045 03377000
         L     @14,@PC00001+4                                      1045 03378000
         L     @05,EARGPTR(,@14)                                   1045 03379000
         AH    @15,BYTE#(,@05)                                     1045 03380000
         L     @01,VMXCOPTR(,@14)                                  1045 03381000
         ALR   @01,@15                                             1045 03382000
         AL    @01,@CF01759                                        1045 03383000
         LH    @15,BIT#(,@05)                                      1045 03384000
         LA    @05,BITMASK-1(@15)                                  1045 03385000
         OC    VMXCHKFF(1,@01),0(@05)                              1045 03386000
*                       IF VMXMVT^=(SAVEREC#-1) THEN               1046 03387000
         L     @01,VMXPTR                                          1046 03388000
         SLR   @15,@15                                             1046 03389000
         ICM   @15,3,VMXMVT(@01)                                   1046 03390000
         LH    @05,SAVEREC#                                        1046 03391000
         BCTR  @05,0                                               1046 03392000
         CR    @15,@05                                             1046 03393000
         BE    @RF01046                                            1046 03394000
*                         DO;       /*                       @Z40LB61*/ 03395000
*                           VMXTBL(1)=ON;/*                  @Z40LB61*/ 03396000
         L     @04,MARGPTR(,@14)                                   1048 03397000
         OI    VMXTBL(@04),B'00000001'                             1048 03398000
*                           MVTTBL(2)=ON;/*                  @Z40LB61*/ 03399000
         OI    MVTTBL+4(@04),B'10000000'                           1049 03400000
*                           INCNMSG=ON;/*                    @Z40LB61*/ 03401000
         OI    INCNMSG(@04),B'10000000'                            1050 03402000
*                           MVTPFLD=ON;/*                    @Z40LB61*/ 03403000
         OI    MVTPFLD(@04),B'00100000'                            1051 03404000
*                           FLDNUM(1)=VMXMVT;/*              @Z40LB61*/ 03405000
         ST    @15,FLDNUM(,@04)                                    1052 03406000
*                           FLDNUM(2)=SAVEREC#-1;/*          @Z40LB61*/ 03407000
         ST    @05,FLDNUM+12(,@04)                                 1053 03408000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @Z40LB61*/ 03409000
         L     @15,@PC00001                                        1054 03410000
         ST    @15,@AL00001                                        1054 03411000
         ST    @14,@AL00001+4                                      1054 03412000
         L     @15,@CV01495                                        1054 03413000
         LA    @01,@AL00001                                        1054 03414000
         BALR  @14,@15                                             1054 03415000
*                         END;      /*                       @Z40LB61*/ 03416000
*                     END MVTVMXM;  /*                       @Z40LB61*/ 03417000
@RF01046 DS    0H                                                  1057 03418000
*                 END VMXCHK;       /*                       @Z40LB61*/ 03419000
*                                                                  1057 03420000
@RC01034 DS    0H                                                  1058 03421000
*               /*****************************************************/ 03422000
*               /*                                                   */ 03423000
*               /* IF SA CHECKING WAS REQUESTED, CHECK THE   @Z40LB61*/ 03424000
*               /* SA VIRTUAL VOLUME INFORMATION TABLE (VVIT)        */ 03425000
*               /*                                           @Z40LB61*/ 03426000
*               /* FOR CONSISTENCY WITH THE MVT ENTRY.       @Z40LB61*/ 03427000
*               /*                                                   */ 03428000
*               /*****************************************************/ 03429000
*                                                                  1058 03430000
*               IF SACHK=ON THEN                                   1058 03431000
@RF01019 L     @15,@PC00001+4                                      1058 03432000
         TM    SACHK(@15),B'01000000'                              1058 03433000
         BNO   @RF01058                                            1058 03434000
*VVITCHK:                                                          1059 03435000
*                 DO;               /*                       @Z40LB61*/ 03436000
*                                                                  1059 03437000
VVITCHK  DS    0H                                                  1060 03438000
*                   /*************************************************/ 03439000
*                   /*                                               */ 03440000
*                   /* DO COMMON SET-UP FOR POSSIBLE ERROR   @Z40LB61*/ 03441000
*                   /* MESSAGES                              @Z40LB61*/ 03442000
*                   /*                                               */ 03443000
*                   /*************************************************/ 03444000
*                                                                  1060 03445000
*                   VVITTBL(1)=ON;  /*                       @Z40LB61*/ 03446000
         L     @15,@PC00001+4                                      1060 03447000
         L     @14,MARGPTR(,@15)                                   1060 03448000
         OI    VVITTBL(@14),B'00100000'                            1060 03449000
*                   MVTTBL(2)=ON;   /*                       @Z40LB61*/ 03450000
         OI    MVTTBL+4(@14),B'10000000'                           1061 03451000
*                   INCNMSG=ON;     /*                       @Z40LB61*/ 03452000
         OI    INCNMSG(@14),B'10000000'                            1062 03453000
*                   SAINDEX(1)=MVSA#;/*                      @Z40LB61*/ 03454000
         MVC   SAINDEX(1,@14),MVSA#+1                              1063 03455000
*                   VVAINDEX(1)=MVVVA(MVPATH#);/*            @Z40LB61*/ 03456000
         L     @05,MVENTPTR                                        1064 03457000
         LH    @04,MVPATH#                                         1064 03458000
         SLA   @04,3                                               1064 03459000
         SLR   @03,@03                                             1064 03460000
         IC    @03,MVVVA-8(@04,@05)                                1064 03461000
         STC   @03,VVAINDEX(,@14)                                  1064 03462000
*                   MSGNRSET=ON;    /*                       @Z40LB61*/ 03463000
         OI    MSGNRSET(@14),B'00000001'                           1065 03464000
*                   TBLNRSET(1)=ON; /*                       @Z40LB61*/ 03465000
         OI    TBLNRSET(@14),B'00000001'                           1066 03466000
*                   TBLNRSET(2)=ON; /*                       @Z40LB61*/ 03467000
*                                                                  1067 03468000
         OI    TBLNRSET+4(@14),B'00000001'                         1067 03469000
*                   /*************************************************/ 03470000
*                   /*                                               */ 03471000
*                   /* FOR CORRESPONDING VVIT ENTRY, CHECK-OFF       */ 03472000
*                   /*                                       @Z40LB61*/ 03473000
*                   /* THE ENTRY AND PREPARE TO CHECK FOR    @Z40LB61*/ 03474000
*                   /* CONSISTENCY IN CORRESPONDING FIELDS   @Z40LB61*/ 03475000
*                   /*                                               */ 03476000
*                   /*************************************************/ 03477000
*                                                                  1068 03478000
*                   VVICHKFF(BYTE#)=VVICHKFF(BYTE#)|BITMASK(BIT#);/*    03479000
*                                                            @Z40LB61*/ 03480000
*                                                                  1068 03481000
         L     @04,EARGPTR(,@15)                                   1068 03482000
         LH    @01,BYTE#(,@04)                                     1068 03483000
         LH    @03,SA#                                             1068 03484000
         SLA   @03,2                                               1068 03485000
         L     @02,VVICOPTR-4(@03,@15)                             1068 03486000
         ALR   @02,@01                                             1068 03487000
         AL    @02,@CF01340                                        1068 03488000
         LH    @01,BIT#(,@04)                                      1068 03489000
         LA    @04,BITMASK-1(@01)                                  1068 03490000
         OC    VVICHKFF(1,@02),0(@04)                              1068 03491000
*                   /*************************************************/ 03492000
*                   /*                                               */ 03493000
*                   /* CHECK FOR MATCHING 'WRITE INHIBIT'    @Z40LB61*/ 03494000
*                   /* STATUS                                @Z40LB61*/ 03495000
*                   /*                                               */ 03496000
*                   /*************************************************/ 03497000
*                                                                  1069 03498000
*                   IF IVVIWI(WORKVVA)=ON&MVWRTINH=OFF THEN        1069 03499000
         LH    @02,WORKVVA                                         1069 03500000
         ALR   @02,@02                                             1069 03501000
         L     @01,IVVITPTR-4(@03,@15)                             1069 03502000
         ALR   @01,@02                                             1069 03503000
         AL    @01,@CF01760                                        1069 03504000
         TM    IVVIWI(@01),B'00000010'                             1069 03505000
         BNO   @RF01069                                            1069 03506000
         TM    MVWRTINH(@05),B'00000010'                           1069 03507000
         BNZ   @RF01069                                            1069 03508000
*                     DO;           /*                       @Z40LB61*/ 03509000
*                       WISFLD=ON;  /*                       @Z40LB61*/ 03510000
         OI    WISFLD(@14),B'00000100'                             1071 03511000
*                       FLDCHAR(1)=STATYES;/*                @Z40LB61*/ 03512000
         MVI   FLDCHAR+3(@14),C' '                                 1072 03513000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1072 03514000
         MVC   FLDCHAR(3,@14),@CC01343                             1072 03515000
*                       FLDCHAR(2)=STATNO;/*                 @Z40LB61*/ 03516000
         MVI   FLDCHAR+15(@14),C' '                                1073 03517000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1073 03518000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1073 03519000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 03520000
         L     @14,@PC00001                                        1074 03521000
         ST    @14,@AL00001                                        1074 03522000
         ST    @15,@AL00001+4                                      1074 03523000
         L     @15,@CV01495                                        1074 03524000
         LA    @01,@AL00001                                        1074 03525000
         BALR  @14,@15                                             1074 03526000
*                     END;          /*                       @Z40LB61*/ 03527000
*                   IF IVVIWI(WORKVVA)=OFF&MVWRTINH=ON THEN        1076 03528000
@RF01069 LH    @15,WORKVVA                                         1076 03529000
         ALR   @15,@15                                             1076 03530000
         LH    @14,SA#                                             1076 03531000
         SLA   @14,2                                               1076 03532000
         L     @05,@PC00001+4                                      1076 03533000
         L     @01,IVVITPTR-4(@14,@05)                             1076 03534000
         ALR   @01,@15                                             1076 03535000
         AL    @01,@CF01760                                        1076 03536000
         TM    IVVIWI(@01),B'00000010'                             1076 03537000
         BNZ   @RF01076                                            1076 03538000
         L     @01,MVENTPTR                                        1076 03539000
         TM    MVWRTINH(@01),B'00000010'                           1076 03540000
         BNO   @RF01076                                            1076 03541000
*                     DO;           /*                       @Z40LB61*/ 03542000
*                       WISFLD=ON;  /*                       @Z40LB61*/ 03543000
         L     @04,MARGPTR(,@05)                                   1078 03544000
         OI    WISFLD(@04),B'00000100'                             1078 03545000
*                       FLDCHAR(1)=STATNO;/*                 @Z40LB61*/ 03546000
         MVI   FLDCHAR+3(@04),C' '                                 1079 03547000
         MVC   FLDCHAR+4(8,@04),FLDCHAR+3(@04)                     1079 03548000
         MVC   FLDCHAR(3,@04),@CC01345                             1079 03549000
*                       FLDCHAR(2)=STATYES;/*                @Z40LB61*/ 03550000
         MVI   FLDCHAR+15(@04),C' '                                1080 03551000
         MVC   FLDCHAR+16(8,@04),FLDCHAR+15(@04)                   1080 03552000
         MVC   FLDCHAR+12(3,@04),@CC01343                          1080 03553000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 03554000
         L     @04,@PC00001                                        1081 03555000
         ST    @04,@AL00001                                        1081 03556000
         ST    @05,@AL00001+4                                      1081 03557000
         L     @15,@CV01495                                        1081 03558000
         LA    @01,@AL00001                                        1081 03559000
         BALR  @14,@15                                             1081 03560000
*                     END;          /*                       @Z40LB61*/ 03561000
*                                                                  1082 03562000
*                   /*************************************************/ 03563000
*                   /*                                               */ 03564000
*                   /* CHECK FOR MATCHING 'SHARED VOLUME'    @Z40LB61*/ 03565000
*                   /* STATUS                                @Z40LB61*/ 03566000
*                   /*                                               */ 03567000
*                   /*************************************************/ 03568000
*                                                                  1083 03569000
*                   IF IVVISHR(WORKVVA)=ON&MVSHARED=OFF THEN       1083 03570000
@RF01076 LH    @15,WORKVVA                                         1083 03571000
         ALR   @15,@15                                             1083 03572000
         LH    @14,SA#                                             1083 03573000
         SLA   @14,2                                               1083 03574000
         L     @05,@PC00001+4                                      1083 03575000
         L     @01,IVVITPTR-4(@14,@05)                             1083 03576000
         ALR   @01,@15                                             1083 03577000
         AL    @01,@CF01760                                        1083 03578000
         TM    IVVISHR(@01),B'00000001'                            1083 03579000
         BNO   @RF01083                                            1083 03580000
         TM    MVSHARED,B'10000000'                                1083 03581000
         BNZ   @RF01083                                            1083 03582000
*                     DO;           /*                       @Z40LB61*/ 03583000
*                       VSHSFLD=ON; /*                       @Z40LB61*/ 03584000
         L     @04,MARGPTR(,@05)                                   1085 03585000
         OI    VSHSFLD(@04),B'01000000'                            1085 03586000
*                       FLDCHAR(1)=STATYES;/*                @Z40LB61*/ 03587000
         MVI   FLDCHAR+3(@04),C' '                                 1086 03588000
         MVC   FLDCHAR+4(8,@04),FLDCHAR+3(@04)                     1086 03589000
         MVC   FLDCHAR(3,@04),@CC01343                             1086 03590000
*                       FLDCHAR(2)=STATNO;/*                 @Z40LB61*/ 03591000
         MVI   FLDCHAR+15(@04),C' '                                1087 03592000
         MVC   FLDCHAR+16(8,@04),FLDCHAR+15(@04)                   1087 03593000
         MVC   FLDCHAR+12(3,@04),@CC01345                          1087 03594000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 03595000
         L     @04,@PC00001                                        1088 03596000
         ST    @04,@AL00001                                        1088 03597000
         ST    @05,@AL00001+4                                      1088 03598000
         L     @15,@CV01495                                        1088 03599000
         LA    @01,@AL00001                                        1088 03600000
         BALR  @14,@15                                             1088 03601000
*                     END;          /*                       @Z40LB61*/ 03602000
*                   IF IVVISHR(WORKVVA)=OFF&MVSHARED=ON THEN       1090 03603000
@RF01083 LH    @15,WORKVVA                                         1090 03604000
         ALR   @15,@15                                             1090 03605000
         LH    @14,SA#                                             1090 03606000
         SLA   @14,2                                               1090 03607000
         L     @05,@PC00001+4                                      1090 03608000
         L     @01,IVVITPTR-4(@14,@05)                             1090 03609000
         ALR   @01,@15                                             1090 03610000
         AL    @01,@CF01760                                        1090 03611000
         TM    IVVISHR(@01),B'00000001'                            1090 03612000
         BNZ   @RF01090                                            1090 03613000
         TM    MVSHARED,B'10000000'                                1090 03614000
         BNO   @RF01090                                            1090 03615000
*                     DO;           /*                       @Z40LB61*/ 03616000
*                       VSHSFLD=ON; /*                       @Z40LB61*/ 03617000
         L     @04,MARGPTR(,@05)                                   1092 03618000
         OI    VSHSFLD(@04),B'01000000'                            1092 03619000
*                       FLDCHAR(1)=STATNO;/*                 @Z40LB61*/ 03620000
         MVI   FLDCHAR+3(@04),C' '                                 1093 03621000
         MVC   FLDCHAR+4(8,@04),FLDCHAR+3(@04)                     1093 03622000
         MVC   FLDCHAR(3,@04),@CC01345                             1093 03623000
*                       FLDCHAR(2)=STATYES;/*                @Z40LB61*/ 03624000
         MVI   FLDCHAR+15(@04),C' '                                1094 03625000
         MVC   FLDCHAR+16(8,@04),FLDCHAR+15(@04)                   1094 03626000
         MVC   FLDCHAR+12(3,@04),@CC01343                          1094 03627000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 03628000
         L     @04,@PC00001                                        1095 03629000
         ST    @04,@AL00001                                        1095 03630000
         ST    @05,@AL00001+4                                      1095 03631000
         L     @15,@CV01495                                        1095 03632000
         LA    @01,@AL00001                                        1095 03633000
         BALR  @14,@15                                             1095 03634000
*                     END;          /*                       @Z40LB61*/ 03635000
*                                                                  1096 03636000
*                   /*************************************************/ 03637000
*                   /*                                               */ 03638000
*                   /* IN PREPARATION FOR COMPARING RESERVED-        */ 03639000
*                   /*                                       @Z40LB61*/ 03640000
*                   /* VOLUME STATUS BETWEEN MVT AND VVIT,   @Z40LB61*/ 03641000
*                   /* ADJUST THE INTERFACE ID'S FROM THE    @Z40LB61*/ 03642000
*                   /* VVIT AND MVT SO AS TO COMPARE THEM    @Z40LB61*/ 03643000
*                   /* NUMERICALLY                           @Z40LB61*/ 03644000
*                   /*                                               */ 03645000
*                   /*************************************************/ 03646000
*                                                                  1097 03647000
*                   WORKVAL1=IVVI2(WORKVVA)/SHIFT4;/*        @Z40LB61*/ 03648000
@RF01090 LH    @15,WORKVVA                                         1097 03649000
         ALR   @15,@15                                             1097 03650000
         LH    @14,SA#                                             1097 03651000
         SLA   @14,2                                               1097 03652000
         L     @05,@PC00001+4                                      1097 03653000
         L     @01,IVVITPTR-4(@14,@05)                             1097 03654000
         AL    @01,@CF01340                                        1097 03655000
         SLR   @14,@14                                             1097 03656000
         IC    @14,IVVI2-1(@15,@01)                                1097 03657000
         SRL   @14,4                                               1097 03658000
         STH   @14,WORKVAL1                                        1097 03659000
*                   WORKVAL1=(WORKVAL1&&FLIPMASK)&MASK3;/*   @Z40LB61*/ 03660000
         SLR   @15,@15                                             1098 03661000
         IC    @15,MASK3                                           1098 03662000
         SLR   @05,@05                                             1098 03663000
         IC    @05,FLIPMASK                                        1098 03664000
         XR    @14,@05                                             1098 03665000
         NR    @14,@15                                             1098 03666000
         STH   @14,WORKVAL1                                        1098 03667000
*                   WORKVAL2=MVRESRVE&MASK3;/*               @Z40LB61*/ 03668000
         L     @14,MVENTPTR                                        1099 03669000
         SLR   @05,@05                                             1099 03670000
         IC    @05,MVRESRVE(,@14)                                  1099 03671000
         NR    @15,@05                                             1099 03672000
         STH   @15,WORKVAL2                                        1099 03673000
*                   ERRTYPE=0;      /*                       @Z40LB61*/ 03674000
*                                                                  1100 03675000
         SLR   @14,@14                                             1100 03676000
         STH   @14,ERRTYPE                                         1100 03677000
*                   /*************************************************/ 03678000
*                   /*                                               */ 03679000
*                   /* A VOLUME SHOULD NOT INDICATE IT IS    @Z40LB61*/ 03680000
*                   /* RESERVED UNLESS THE VOLUME IS SHARED. @Z40LB61*/ 03681000
*                   /*                                               */ 03682000
*                   /*************************************************/ 03683000
*                                                                  1101 03684000
*                   IF MVSHARED=OFF THEN                           1101 03685000
         TM    MVSHARED,B'10000000'                                1101 03686000
         BNZ   @RF01101                                            1101 03687000
*                     IF WORKVAL2^=0 THEN                          1102 03688000
         CR    @15,@14                                             1102 03689000
         BE    @RF01102                                            1102 03690000
*                       ERRTYPE=2;  /*                       @Z40LB61*/ 03691000
         MVC   ERRTYPE(2),@CH00157                                 1103 03692000
*                     ELSE                                         1104 03693000
*                       ;           /*                       @Z40LB61*/ 03694000
@RF01102 DS    0H                                                  1105 03695000
*                   ELSE                                           1105 03696000
*                                                                  1105 03697000
*                     /***********************************************/ 03698000
*                     /*                                             */ 03699000
*                     /* FOR A SHARED VOLUME, RESERVED STATUS        */ 03700000
*                     /*                                     @Z40LB61*/ 03701000
*                     /* SHOULD MATCH BETWEEN MVT AND VVIT.  @Z40LB61*/ 03702000
*                     /*                                             */ 03703000
*                     /***********************************************/ 03704000
*                                                                  1105 03705000
*                     IF WORKVAL2=0 THEN                           1105 03706000
         B     @RC01101                                            1105 03707000
@RF01101 ICM   @15,3,WORKVAL2                                      1105 03708000
         BNZ   @RF01105                                            1105 03709000
*                       IF IVVIRSVD(WORKVVA)=ON THEN               1106 03710000
         LH    @15,WORKVVA                                         1106 03711000
         ALR   @15,@15                                             1106 03712000
         LH    @14,SA#                                             1106 03713000
         SLA   @14,2                                               1106 03714000
         L     @05,@PC00001+4                                      1106 03715000
         L     @01,IVVITPTR-4(@14,@05)                             1106 03716000
         ALR   @01,@15                                             1106 03717000
         AL    @01,@CF01340                                        1106 03718000
         TM    IVVIRSVD-1(@01),B'00001000'                         1106 03719000
         BNO   @RF01106                                            1106 03720000
*                         ERRTYPE=1;/*                       @Z40LB61*/ 03721000
         MVC   ERRTYPE(2),@CH00223                                 1107 03722000
*                       ELSE                                       1108 03723000
*                         ;         /*                       @Z40LB61*/ 03724000
@RF01106 DS    0H                                                  1109 03725000
*                     ELSE                                         1109 03726000
*                       IF IVVIRSVD(WORKVVA)=OFF THEN              1109 03727000
         B     @RC01105                                            1109 03728000
@RF01105 LH    @15,WORKVVA                                         1109 03729000
         ALR   @15,@15                                             1109 03730000
         LH    @14,SA#                                             1109 03731000
         SLA   @14,2                                               1109 03732000
         L     @05,@PC00001+4                                      1109 03733000
         L     @01,IVVITPTR-4(@14,@05)                             1109 03734000
         ALR   @01,@15                                             1109 03735000
         AL    @01,@CF01340                                        1109 03736000
         TM    IVVIRSVD-1(@01),B'00001000'                         1109 03737000
         BNZ   @RF01109                                            1109 03738000
*                         ERRTYPE=2;/*                       @Z40LB61*/ 03739000
*                                                                  1110 03740000
         MVC   ERRTYPE(2),@CH00157                                 1110 03741000
*                   /*************************************************/ 03742000
*                   /*                                               */ 03743000
*                   /* IF RESERVED STATUS FLAGS MATCH, THEN  @Z40LB61*/ 03744000
*                   /* CHECK FOR MATCHING DATA AS TO THE     @Z40LB61*/ 03745000
*                   /* INTERFACES RESERVED.                  @Z40LB61*/ 03746000
*                   /*                                               */ 03747000
*                   /*************************************************/ 03748000
*                                                                  1111 03749000
*                       ELSE                                       1111 03750000
*                                                                  1111 03751000
*                         /*******************************************/ 03752000
*                         /*                                         */ 03753000
*                         /* IF WE'RE CURRENTLY EXAMINING THE        */ 03754000
*                         /*                                 @Z40LB61*/ 03755000
*                         /* SA THAT HAS THE VOLUME RESERVED,        */ 03756000
*                         /*                                 @Z40LB61*/ 03757000
*                         /* THE INTERFACE ID'S SHOULD MATCH.        */ 03758000
*                         /*                                 @Z40LB61*/ 03759000
*                         /* IF WE'RE EXAMINING THE OTHER SA @Z40LB61*/ 03760000
*                         /* SHARING THE VOLUME, IT SHOULD BE        */ 03761000
*                         /*                                 @Z40LB61*/ 03762000
*                         /* RESERVED TO THE MSC (INTERFACE 0).      */ 03763000
*                         /*                                 @Z40LB61*/ 03764000
*                         /*                                         */ 03765000
*                         /*******************************************/ 03766000
*                                                                  1111 03767000
*                         IF MVPATH#=1 THEN                        1111 03768000
         B     @RC01109                                            1111 03769000
@RF01109 CLC   MVPATH#(2),@CH00223                                 1111 03770000
         BNE   @RF01111                                            1111 03771000
*                           IF MVSA2RSV=OFF THEN                   1112 03772000
         L     @01,MVENTPTR                                        1112 03773000
         TM    MVSA2RSV(@01),B'00001000'                           1112 03774000
         BNZ   @RF01112                                            1112 03775000
*                             IF WORKVAL1^=WORKVAL2 THEN           1113 03776000
         CLC   WORKVAL1(2),WORKVAL2                                1113 03777000
         BE    @RF01113                                            1113 03778000
*                               ERRTYPE=2;/*                 @Z40LB61*/ 03779000
         MVC   ERRTYPE(2),@CH00157                                 1114 03780000
*                             ELSE                                 1115 03781000
*                               ;   /*                       @Z40LB61*/ 03782000
@RF01113 DS    0H                                                  1116 03783000
*                           ELSE                                   1116 03784000
*                             IF WORKVAL1^=0 THEN                  1116 03785000
         B     @RC01112                                            1116 03786000
@RF01112 ICM   @15,3,WORKVAL1                                      1116 03787000
         BZ    @RF01116                                            1116 03788000
*                               ERRTYPE=2;/*                 @Z40LB61*/ 03789000
         MVC   ERRTYPE(2),@CH00157                                 1117 03790000
*                             ELSE                                 1118 03791000
*                               ;   /*                       @Z40LB61*/ 03792000
@RF01116 DS    0H                                                  1119 03793000
*                         ELSE                                     1119 03794000
*                           IF MVSA2RSV=ON THEN                    1119 03795000
         B     @RC01111                                            1119 03796000
@RF01111 L     @01,MVENTPTR                                        1119 03797000
         TM    MVSA2RSV(@01),B'00001000'                           1119 03798000
         BNO   @RF01119                                            1119 03799000
*                             IF WORKVAL1^=WORKVAL2 THEN           1120 03800000
         CLC   WORKVAL1(2),WORKVAL2                                1120 03801000
         BE    @RF01120                                            1120 03802000
*                               ERRTYPE=2;/*                 @Z40LB61*/ 03803000
         MVC   ERRTYPE(2),@CH00157                                 1121 03804000
*                             ELSE                                 1122 03805000
*                               ;   /*                       @Z40LB61*/ 03806000
@RF01120 DS    0H                                                  1123 03807000
*                           ELSE                                   1123 03808000
*                             IF WORKVAL1^=0 THEN                  1123 03809000
         B     @RC01119                                            1123 03810000
@RF01119 ICM   @15,3,WORKVAL1                                      1123 03811000
         BZ    @RF01123                                            1123 03812000
*                               ERRTYPE=2;/*                 @Z40LB61*/ 03813000
*                                                                  1124 03814000
         MVC   ERRTYPE(2),@CH00157                                 1124 03815000
*                   /*************************************************/ 03816000
*                   /*                                               */ 03817000
*                   /* PRINT AN ERROR MESSAGE BASED UPON     @Z40LB61*/ 03818000
*                   /* THE TYPE OF INCONSISTENCY, IF ANY     @Z40LB61*/ 03819000
*                   /* INCONSISTENCY WAS FOUND.              @Z40LB61*/ 03820000
*                   /*                                               */ 03821000
*                   /*************************************************/ 03822000
*                                                                  1125 03823000
*                   IF ERRTYPE=1 THEN                              1125 03824000
@RF01123 DS    0H                                                  1125 03825000
@RC01119 DS    0H                                                  1125 03826000
@RC01111 DS    0H                                                  1125 03827000
@RC01109 DS    0H                                                  1125 03828000
@RC01105 DS    0H                                                  1125 03829000
@RC01101 CLC   ERRTYPE(2),@CH00223                                 1125 03830000
         BNE   @RF01125                                            1125 03831000
*                     DO;           /*                       @Z40LB61*/ 03832000
*                       VRSFLD=ON;  /*                       @Z40LB61*/ 03833000
         L     @15,@PC00001+4                                      1127 03834000
         L     @14,MARGPTR(,@15)                                   1127 03835000
         OI    VRSFLD(@14),B'00001000'                             1127 03836000
*                       FLDCHAR(1)=STATYES;/*                @Z40LB61*/ 03837000
         MVI   FLDCHAR+3(@14),C' '                                 1128 03838000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1128 03839000
         MVC   FLDCHAR(3,@14),@CC01343                             1128 03840000
*                       FLDCHAR(2)=STATNO;/*                 @Z40LB61*/ 03841000
         MVI   FLDCHAR+15(@14),C' '                                1129 03842000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1129 03843000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1129 03844000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 03845000
         L     @14,@PC00001                                        1130 03846000
         ST    @14,@AL00001                                        1130 03847000
         ST    @15,@AL00001+4                                      1130 03848000
         L     @15,@CV01495                                        1130 03849000
         LA    @01,@AL00001                                        1130 03850000
         BALR  @14,@15                                             1130 03851000
*                     END;          /*                       @Z40LB61*/ 03852000
*                   ELSE                                           1132 03853000
*                     IF ERRTYPE=2 THEN                            1132 03854000
         B     @RC01125                                            1132 03855000
@RF01125 CLC   ERRTYPE(2),@CH00157                                 1132 03856000
         BNE   @RF01132                                            1132 03857000
*                       DO;         /*                       @Z40LB61*/ 03858000
*                         VRSFLD=ON;/*                       @Z40LB61*/ 03859000
         L     @15,@PC00001+4                                      1134 03860000
         L     @14,MARGPTR(,@15)                                   1134 03861000
         OI    VRSFLD(@14),B'00001000'                             1134 03862000
*                         FLDCHAR(1)=STATNO;/*               @Z40LB61*/ 03863000
         MVI   FLDCHAR+3(@14),C' '                                 1135 03864000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1135 03865000
         MVC   FLDCHAR(3,@14),@CC01345                             1135 03866000
*                         FLDCHAR(2)=STATYES;/*              @Z40LB61*/ 03867000
         MVI   FLDCHAR+15(@14),C' '                                1136 03868000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1136 03869000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1136 03870000
*                         CALL IDCCH04(GDTTBL,CDALIST);/*    @Z40LB61*/ 03871000
         L     @14,@PC00001                                        1137 03872000
         ST    @14,@AL00001                                        1137 03873000
         ST    @15,@AL00001+4                                      1137 03874000
         L     @15,@CV01495                                        1137 03875000
         LA    @01,@AL00001                                        1137 03876000
         BALR  @14,@15                                             1137 03877000
*                       END;        /*                       @Z40LB61*/ 03878000
*                                                                  1138 03879000
*                   /*************************************************/ 03880000
*                   /*                                               */ 03881000
*                   /* RESET THE 'IDCCH04' OPTION FLAGS      @Z40LB61*/ 03882000
*                   /*                                               */ 03883000
*                   /*************************************************/ 03884000
*                                                                  1139 03885000
*                   MSGTYPE=''B;    /*                       @Z40LB61*/ 03886000
@RF01132 DS    0H                                                  1139 03887000
@RC01125 L     @15,@PC00001+4                                      1139 03888000
         L     @15,MARGPTR(,@15)                                   1139 03889000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1139 03890000
*                   TBLTYPE(1)=''B; /*                       @Z40LB61*/ 03891000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1140 03892000
*                   TBLTYPE(2)=''B; /*                       @Z40LB61*/ 03893000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1141 03894000
*                 END VVITCHK;      /*                       @Z40LB61*/ 03895000
*             END SAVVAOK;          /*                       @Z40LB61*/ 03896000
@RF01058 DS    0H                                                  1144 03897000
*       END ACTIVESA;               /*                       @Z40LB61*/ 03898000
@RC00987 DS    0H                                                  1144 03899000
@RC00974 DS    0H                                                  1145 03900000
*   END SALOOP1;                    /*                       @Z40LB61*/ 03901000
@RF00970 LA    @15,1                                               1145 03902000
         AH    @15,MVPATH#                                         1145 03903000
         STH   @15,MVPATH#                                         1145 03904000
         CH    @15,@CH00157                                        1145 03905000
         BNH   @DL00969                                            1145 03906000
*   END MVTVVAS;                    /*                       @Z40LB61*/ 03907000
         B     @EL00005                                            1146 03908000
*                                                                  1147 03909000
*/********************************************************************/ 03910000
*/*                                                          @Z40LB61*/ 03911000
*/* PROCEDURE NAME - MVTVUAS                                @Z40LB61 */ 03912000
*/*                                                          @Z40LB61*/ 03913000
*/* FUNCTION - THIS ROUTINE COMPARES MVT VUA-RELATED DATA    @Z40LB61*/ 03914000
*/*            AGAINST VUA-RELATED DATA IN CORRESPONDING     @Z40LB61*/ 03915000
*/*            MSC AND SA TABLES.                            @Z40LB61*/ 03916000
*/*                                                          @Z40LB61*/ 03917000
*/* INPUT -                                                  @Z40LB61*/ 03918000
*/*        (1) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 03919000
*/*        (2) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 03920000
*/*        (3) MSC CONFIGURATION INDEX                       @Z40LB61*/ 03921000
*/*        (4) MSC CONFIGURATION DATA BLOCK                  @Z40LB61*/ 03922000
*/*        (5) SA VIRTUAL ADDRESS DIRECTORY                  @Z40LB61*/ 03923000
*/*                                                          @Z40LB61*/ 03924000
*/* OUTPUT -                                                 @Z40LB61*/ 03925000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 03926000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 03927000
*/*        (3) CDB CHECK-OFF TABLE                           @Z40LB61*/ 03928000
*/*        (4) COUNT OF MOUNTED VOLUMES PER SDG              @Z40LB61*/ 03929000
*/*        (5) VAD CHECK-OFF TABLE                           @Z40LB61*/ 03930000
*/*                                                          @Z40LB61*/ 03931000
*/********************************************************************/ 03932000
*                                                                  1147 03933000
*MVTVUAS:                                                          1147 03934000
*   PROCEDURE;                      /*                       @Z40LB61*/ 03935000
MVTVUAS  STM   @14,@12,@SA00006                                    1147 03936000
*   OLDERID2=NEWERID2;                                             1148 03937000
         L     @15,@PC00001                                        1148 03938000
         L     @15,GDTTR2(,@15)                                    1148 03939000
         MVC   @TS00001(95),NEWERID2(@15)                          1148 03940000
         MVC   OLDERID2(95,@15),@TS00001                           1148 03941000
*   NEWID2='CH2J';                  /*                       @Z40LB61*/ 03942000
*                                                                  1149 03943000
         MVC   NEWID2(4,@15),@CC01586                              1149 03944000
*   /*****************************************************************/ 03945000
*   /*                                                               */ 03946000
*   /* SET UP INDICATORS POINTING TO ACTIVE INTERFACES       @Z40LB61*/ 03947000
*   /* OF VALID SA PATHS                                     @Z40LB61*/ 03948000
*   /*                                                               */ 03949000
*   /*****************************************************************/ 03950000
*                                                                  1150 03951000
*   INTARRAY=''B;                   /*                       @Z40LB61*/ 03952000
         XC    INTARRAY(6),INTARRAY                                1150 03953000
*   DO MVPATH#=1 TO SASSDG;         /*                       @Z40LB61*/ 03954000
         LA    @15,1                                               1151 03955000
         STH   @15,MVPATH#                                         1151 03956000
@DL01151 DS    0H                                                  1152 03957000
*     IF MVVLDSA(MVPATH#)=ON THEN                                  1152 03958000
         L     @14,MVENTPTR                                        1152 03959000
         LR    @05,@15                                             1152 03960000
         SLA   @05,3                                               1152 03961000
         ST    @05,@TF00001                                        1152 03962000
         ALR   @05,@14                                             1152 03963000
         TM    MVVLDSA-8(@05),B'10000000'                          1152 03964000
         BNO   @RF01152                                            1152 03965000
*       DO;                         /*                       @Z40LB61*/ 03966000
*         IF MVACTB(MVPATH#)=ON THEN                               1154 03967000
         AL    @14,@TF00001                                        1154 03968000
         TM    MVACTB-8(@14),B'01000000'                           1154 03969000
         BNO   @RF01154                                            1154 03970000
*           ACTINTF(MVPATH#,1)=ON;  /*                       @Z40LB61*/ 03971000
         MH    @15,@CH00166                                        1155 03972000
         LA    @14,ACTINTF-3(@15)                                  1155 03973000
         OI    0(@14),B'10000000'                                  1155 03974000
*         IF MVACTC(MVPATH#)=ON THEN                               1156 03975000
@RF01154 LH    @15,MVPATH#                                         1156 03976000
         LR    @14,@15                                             1156 03977000
         SLA   @14,3                                               1156 03978000
         L     @01,MVENTPTR                                        1156 03979000
         ALR   @01,@14                                             1156 03980000
         TM    MVACTC-8(@01),B'00100000'                           1156 03981000
         BNO   @RF01156                                            1156 03982000
*           ACTINTF(MVPATH#,2)=ON;  /*                       @Z40LB61*/ 03983000
         MH    @15,@CH00166                                        1157 03984000
         LA    @14,ACTINTF-2(@15)                                  1157 03985000
         OI    0(@14),B'10000000'                                  1157 03986000
*         IF MVACTD(MVPATH#)=ON THEN                               1158 03987000
@RF01156 LH    @15,MVPATH#                                         1158 03988000
         LR    @14,@15                                             1158 03989000
         SLA   @14,3                                               1158 03990000
         L     @01,MVENTPTR                                        1158 03991000
         ALR   @01,@14                                             1158 03992000
         TM    MVACTD-8(@01),B'00010000'                           1158 03993000
         BNO   @RF01158                                            1158 03994000
*           ACTINTF(MVPATH#,3)=ON;  /*                       @Z40LB61*/ 03995000
         MH    @15,@CH00166                                        1159 03996000
         LA    @14,ACTINTF-1(@15)                                  1159 03997000
         OI    0(@14),B'10000000'                                  1159 03998000
*       END;                        /*                       @Z40LB61*/ 03999000
@RF01158 DS    0H                                                  1161 04000000
*   END;                            /*                       @Z40LB61*/ 04001000
*                                                                  1161 04002000
@RF01152 LA    @15,1                                               1161 04003000
         AH    @15,MVPATH#                                         1161 04004000
         STH   @15,MVPATH#                                         1161 04005000
         CH    @15,@CH00157                                        1161 04006000
         BNH   @DL01151                                            1161 04007000
*   /*****************************************************************/ 04008000
*   /*                                                               */ 04009000
*   /* EXAMINE THE MVT FIELDS ASSOCIATED WITH ALL POSSIBLE   @Z40LB61*/ 04010000
*   /* VALID SA PATHS                                        @Z40LB61*/ 04011000
*   /*                                                               */ 04012000
*   /*****************************************************************/ 04013000
*                                                                  1162 04014000
*SALOOP2:                                                          1162 04015000
*   DO MVPATH#=1 TO SASSDG;         /*                       @Z40LB61*/ 04016000
SALOOP2  LA    @15,1                                               1162 04017000
         STH   @15,MVPATH#                                         1162 04018000
@DL01162 DS    0H                                                  1163 04019000
*     MVSA#=MVSA(MVPATH#)&MASK15;   /*                       @Z40LB61*/ 04020000
         SLA   @15,3                                               1163 04021000
         L     @01,MVENTPTR                                        1163 04022000
         SLR   @14,@14                                             1163 04023000
         IC    @14,MVSA-8(@15,@01)                                 1163 04024000
         SLR   @15,@15                                             1163 04025000
         IC    @15,MASK15                                          1163 04026000
         NR    @14,@15                                             1163 04027000
         STH   @14,MVSA#                                           1163 04028000
*     SA#=MVSA#+1;                  /*                       @Z40LB61*/ 04029000
*                                                                  1164 04030000
         AH    @14,@CH00223                                        1164 04031000
         STH   @14,SA#                                             1164 04032000
*     /***************************************************************/ 04033000
*     /*                                                             */ 04034000
*     /* IF THE SA# FROM THE MVT IS INVALID, PRINT AN        @Z40LB61*/ 04035000
*     /* ERROR MESSAGE AND DON'T DO FURTHER CHECKING THAT    @Z40LB61*/ 04036000
*     /* INVOLVES THAT SA.                                   @Z40LB61*/ 04037000
*     /* IF THE SA# IS OFFLINE OR SUU THEN SKIP PROCESS-     @ZA27324*/ 04038000
*     /* ING THIS PARTICULAR SA.                             @ZA27324*/ 04039000
*     /*                                                             */ 04040000
*     /***************************************************************/ 04041000
*                                                                  1165 04042000
*     IF IVADPTR(SA#)=NULLPTR|      /*                       @ZA27324*/ 04043000
*         IVADPTR(SA#)=DUMMYPTR THEN/*                       @ZA27324*/ 04044000
         SLA   @14,2                                               1165 04045000
         L     @15,@PC00001+4                                      1165 04046000
         AL    @15,@CF01761                                        1165 04047000
         L     @15,IVADPTR(@14,@15)                                1165 04048000
         LTR   @15,@15                                             1165 04049000
         BZ    @RT01165                                            1165 04050000
         C     @15,DUMMYPTR                                        1165 04051000
         BNE   @RF01165                                            1165 04052000
@RT01165 DS    0H                                                  1166 04053000
*       DO;                         /*                       @ZA27324*/ 04054000
*         IF IVADPTR(SA#)=DUMMYPTR THEN                            1167 04055000
         LH    @15,SA#                                             1167 04056000
         SLA   @15,2                                               1167 04057000
         L     @14,@PC00001+4                                      1167 04058000
         AL    @14,@CF01761                                        1167 04059000
         L     @15,IVADPTR(@15,@14)                                1167 04060000
         C     @15,DUMMYPTR                                        1167 04061000
         BE    @RT01167                                            1167 04062000
*           ;                       /*                       @ZA27324*/ 04063000
*         ELSE                      /*                       @ZA27324*/ 04064000
*           DO;                     /*                       @ZA27324*/ 04065000
*             MTCHMSG=ON;           /*                       @ZA27324*/ 04066000
         L     @15,@PC00001+4                                      1170 04067000
         L     @14,MARGPTR(,@15)                                   1170 04068000
         OI    MTCHMSG(@14),B'00010000'                            1170 04069000
*             CBMTBL(1)=ON;         /*                       @ZA27324*/ 04070000
         OI    CBMTBL(@14),B'00001000'                             1171 04071000
*             MVTTBL(2)=ON;         /*                       @ZA27324*/ 04072000
         OI    MVTTBL+4(@14),B'10000000'                           1172 04073000
*             SAFLD=ON;             /*                       @ZA27324*/ 04074000
         OI    SAFLD(@14),B'00001000'                              1173 04075000
*             FLDNUM(1)=MVSA#;      /*                       @ZA27324*/ 04076000
         LH    @05,MVSA#                                           1174 04077000
         ST    @05,FLDNUM(,@14)                                    1174 04078000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @ZA27324*/ 04079000
         L     @14,@PC00001                                        1175 04080000
         ST    @14,@AL00001                                        1175 04081000
         ST    @15,@AL00001+4                                      1175 04082000
         L     @15,@CV01495                                        1175 04083000
         LA    @01,@AL00001                                        1175 04084000
         BALR  @14,@15                                             1175 04085000
*           END;                    /*                       @ZA27324*/ 04086000
*       END;                        /*                       @Z40LB61*/ 04087000
*     ELSE                                                         1178 04088000
*                                                                  1178 04089000
*       /*************************************************************/ 04090000
*       /*                                                           */ 04091000
*       /* DO TABLE CHECKING FOR EACH ACTIVE INTERFACE       @Z40LB61*/ 04092000
*       /*                                                           */ 04093000
*       /*************************************************************/ 04094000
*                                                                  1178 04095000
*INTFLOOP:                                                         1178 04096000
*       DO INTF#=1 TO INTFSSA;      /*                       @Z40LB61*/ 04097000
         B     @RC01165                                            1178 04098000
@RF01165 DS    0H                                                  1178 04099000
INTFLOOP LA    @15,1                                               1178 04100000
         STH   @15,INTF#                                           1178 04101000
@DL01178 DS    0H                                                  1179 04102000
*         IF ACTINTF(MVPATH#,INTF#)=ON THEN                        1179 04103000
         LH    @14,MVPATH#                                         1179 04104000
         MH    @14,@CH00166                                        1179 04105000
         ALR   @14,@15                                             1179 04106000
         LA    @15,ACTINTF-4(@14)                                  1179 04107000
         TM    0(@15),B'10000000'                                  1179 04108000
         BNO   @RF01179                                            1179 04109000
*GOODINTF:                                                         1180 04110000
*           DO;                     /*                       @Z40LB61*/ 04111000
GOODINTF DS    0H                                                  1181 04112000
*             OLDERID2=NEWERID2;                                   1181 04113000
         L     @15,@PC00001                                        1181 04114000
         L     @15,GDTTR2(,@15)                                    1181 04115000
         MVC   @TS00001(95),NEWERID2(@15)                          1181 04116000
         MVC   OLDERID2(95,@15),@TS00001                           1181 04117000
*             NEWID2='CH2K';        /*                       @Z40LB61*/ 04118000
         MVC   NEWID2(4,@15),@CC01593                              1182 04119000
*             WRKCPUID=MVCPUID(INTF#)&MASK15;/*              @Z40LB61*/ 04120000
         LH    @15,INTF#                                           1183 04121000
         L     @14,MVENTPTR                                        1183 04122000
         LH    @05,MVPATH#                                         1183 04123000
         SLA   @05,3                                               1183 04124000
         LA    @04,MVCPUIDS-8(@05,@14)                             1183 04125000
         AL    @04,@CF01340                                        1183 04126000
         SLR   @03,@03                                             1183 04127000
         IC    @03,MVCPUID(@15,@04)                                1183 04128000
         SLR   @02,@02                                             1183 04129000
         IC    @02,MASK15                                          1183 04130000
         NR    @03,@02                                             1183 04131000
         STH   @03,WRKCPUID                                        1183 04132000
*             WORKVUA=MVVUA(INTF#)&MASK63;/*                 @Z40LB61*/ 04133000
         LA    @14,MVVUAS-8(@05,@14)                               1184 04134000
         AL    @14,@CF01340                                        1184 04135000
         SLR   @05,@05                                             1184 04136000
         IC    @05,MVVUA(@15,@14)                                  1184 04137000
         SLR   @04,@04                                             1184 04138000
         IC    @04,MASK63                                          1184 04139000
         NR    @05,@04                                             1184 04140000
         STH   @05,WORKVUA                                         1184 04141000
*             BYTE#=WORKVUA/8+1;    /*                       @Z40LB61*/ 04142000
         L     @04,@PC00001+4                                      1185 04143000
         L     @15,EARGPTR(,@04)                                   1185 04144000
         LA    @14,1                                               1185 04145000
         LR    @00,@05                                             1185 04146000
         SRDA  @00,32                                              1185 04147000
         D     @00,@CF00183                                        1185 04148000
         ALR   @01,@14                                             1185 04149000
         STH   @01,BYTE#(,@15)                                     1185 04150000
*             BIT#=WORKVUA//8+1;    /*                       @Z40LB61*/ 04151000
*                                                                  1186 04152000
         LR    @00,@05                                             1186 04153000
         SRDA  @00,32                                              1186 04154000
         D     @00,@CF00183                                        1186 04155000
         ALR   @00,@14                                             1186 04156000
         STH   @00,BIT#(,@15)                                      1186 04157000
*             /*******************************************************/ 04158000
*             /*                                                     */ 04159000
*             /* IF SA CHECKING WAS REQUESTED, PREPARE TO    @Z40LB61*/ 04160000
*             /* COMPARE THE SA VIRTUAL ADDRESS DIRECTORY    @Z40LB61*/ 04161000
*             /* (VAD) AGAINST THE MVT ENTRY.                @Z40LB61*/ 04162000
*             /*                                                     */ 04163000
*             /*******************************************************/ 04164000
*                                                                  1187 04165000
*             IF SACHK=ON THEN                                     1187 04166000
         TM    SACHK(@04),B'01000000'                              1187 04167000
         BNO   @RF01187                                            1187 04168000
*VADCHK:                                                           1188 04169000
*               DO;                 /*                       @Z40LB61*/ 04170000
*                                                                  1188 04171000
VADCHK   DS    0H                                                  1189 04172000
*                 /***************************************************/ 04173000
*                 /*                                                 */ 04174000
*                 /* DO COMMON SET-UP FOR POSSIBLE ERROR     @Z40LB61*/ 04175000
*                 /* MESSAGES                                @Z40LB61*/ 04176000
*                 /*                                                 */ 04177000
*                 /***************************************************/ 04178000
*                                                                  1189 04179000
*                 VADTBL(1)=ON;     /*                       @Z40LB61*/ 04180000
         L     @15,@PC00001+4                                      1189 04181000
         L     @14,MARGPTR(,@15)                                   1189 04182000
         OI    VADTBL(@14),B'00000001'                             1189 04183000
*                 MVTTBL(2)=ON;     /*                       @Z40LB61*/ 04184000
         OI    MVTTBL+4(@14),B'10000000'                           1190 04185000
*                 INCNMSG=ON;       /*                       @Z40LB61*/ 04186000
         OI    INCNMSG(@14),B'10000000'                            1191 04187000
*                 SAINDEX(1)=MVSA#; /*                       @Z40LB61*/ 04188000
         MVC   SAINDEX(1,@14),MVSA#+1                              1192 04189000
*                 INFINDEX(1)=INTF#;/*                       @Z40LB61*/ 04190000
         LH    @05,INTF#                                           1193 04191000
         STC   @05,INFINDEX(,@14)                                  1193 04192000
*                 VUAINDEX(1)=WORKVUA;/*                     @Z40LB61*/ 04193000
*                                                                  1194 04194000
         LH    @04,WORKVUA                                         1194 04195000
         STC   @04,VUAINDEX(,@14)                                  1194 04196000
*                 /***************************************************/ 04197000
*                 /*                                                 */ 04198000
*                 /* IF THE CORRESPONDING VAD ENTRY FOR THE  @Z40LB61*/ 04199000
*                 /* CURRENT INTERFACE'S VUA IS NOT VALID,   @Z40LB61*/ 04200000
*                 /* PRINT AN ERROR MESSAGE.                 @Z40LB61*/ 04201000
*                 /*                                                 */ 04202000
*                 /***************************************************/ 04203000
*                                                                  1195 04204000
*                 IF IVADVVA(INTF#,WORKVUA+1)=0 THEN               1195 04205000
         SLA   @05,6                                               1195 04206000
         ALR   @05,@04                                             1195 04207000
         ALR   @05,@05                                             1195 04208000
         LH    @04,SA#                                             1195 04209000
         SLA   @04,2                                               1195 04210000
         AL    @04,@CF01761                                        1195 04211000
         L     @01,IVADPTR(@04,@15)                                1195 04212000
         AL    @01,@CF01762                                        1195 04213000
         SLR   @04,@04                                             1195 04214000
         IC    @04,IVADVVA(@05,@01)                                1195 04215000
         CH    @04,@CH00119                                        1195 04216000
         BNE   @RF01195                                            1195 04217000
*                   DO;             /*                       @Z40LB61*/ 04218000
*                     IUSFLD=ON;    /*                       @Z40LB61*/ 04219000
         OI    IUSFLD(@14),B'00000001'                             1197 04220000
*                     FLDCHAR(1)=STATNO;/*                   @Z40LB61*/ 04221000
         MVI   FLDCHAR+3(@14),C' '                                 1198 04222000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1198 04223000
         MVC   FLDCHAR(3,@14),@CC01345                             1198 04224000
*                     FLDCHAR(2)=STATYES;/*                  @Z40LB61*/ 04225000
         MVI   FLDCHAR+15(@14),C' '                                1199 04226000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1199 04227000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1199 04228000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB61*/ 04229000
         L     @14,@PC00001                                        1200 04230000
         ST    @14,@AL00001                                        1200 04231000
         ST    @15,@AL00001+4                                      1200 04232000
         L     @15,@CV01495                                        1200 04233000
         LA    @01,@AL00001                                        1200 04234000
         BALR  @14,@15                                             1200 04235000
*                   END;            /*                       @Z40LB61*/ 04236000
*                 ELSE                                             1202 04237000
*                                                                  1202 04238000
*                   /*************************************************/ 04239000
*                   /*                                               */ 04240000
*                   /* FOR A VALID VAD ENTRY, CHECK-OFF      @Z40LB61*/ 04241000
*                   /* THE ENTRY AND PREPARE TO CHECK FOR    @Z40LB61*/ 04242000
*                   /* CONSISTENCY IN CORRESPONDING FIELDS   @Z40LB61*/ 04243000
*                   /*                                               */ 04244000
*                   /*************************************************/ 04245000
*                                                                  1202 04246000
*MVTVADM:                                                          1202 04247000
*                   DO;             /*                       @Z40LB61*/ 04248000
         B     @RC01195                                            1202 04249000
@RF01195 DS    0H                                                  1202 04250000
MVTVADM  DS    0H                                                  1203 04251000
*                     VADCHKFF(INTF#,BYTE#)=VADCHKFF(INTF#,BYTE#)| 1203 04252000
*                         BITMASK(BIT#);/*                   @Z40LB61*/ 04253000
*                                                                  1203 04254000
         LH    @15,INTF#                                           1203 04255000
         LR    @14,@15                                             1203 04256000
         SLA   @14,3                                               1203 04257000
         L     @05,@PC00001+4                                      1203 04258000
         L     @04,EARGPTR(,@05)                                   1203 04259000
         AH    @14,BYTE#(,@04)                                     1203 04260000
         LH    @03,SA#                                             1203 04261000
         SLA   @03,2                                               1203 04262000
         L     @01,VADCOPTR-4(@03,@05)                             1203 04263000
         ALR   @01,@14                                             1203 04264000
         AL    @01,@CF01763                                        1203 04265000
         LH    @02,BIT#(,@04)                                      1203 04266000
         LA    @14,BITMASK-1(@02)                                  1203 04267000
         OC    VADCHKFF(1,@01),0(@14)                              1203 04268000
*                     /***********************************************/ 04269000
*                     /*                                             */ 04270000
*                     /* CHECK FOR MATCHING VVA FIELDS. IF   @Z40LB61*/ 04271000
*                     /* INCONSISTENT, PRINT AN ERROR MESSAGE.       */ 04272000
*                     /*                                     @Z40LB61*/ 04273000
*                     /*                                             */ 04274000
*                     /***********************************************/ 04275000
*                                                                  1204 04276000
*                     IF IVADVVA(INTF#,WORKVUA+1)^=MVVVA(MVPATH#) THEN  04277000
         SLA   @15,6                                               1204 04278000
         AH    @15,WORKVUA                                         1204 04279000
         ALR   @15,@15                                             1204 04280000
         AL    @03,@CF01761                                        1204 04281000
         L     @01,IVADPTR(@03,@05)                                1204 04282000
         AL    @01,@CF01762                                        1204 04283000
         SLR   @14,@14                                             1204 04284000
         IC    @14,IVADVVA(@15,@01)                                1204 04285000
         LH    @15,MVPATH#                                         1204 04286000
         SLA   @15,3                                               1204 04287000
         L     @01,MVENTPTR                                        1204 04288000
         SLR   @04,@04                                             1204 04289000
         IC    @04,MVVVA-8(@15,@01)                                1204 04290000
         CR    @14,@04                                             1204 04291000
         BE    @RF01204                                            1204 04292000
*                       DO;         /*                       @Z40LB61*/ 04293000
*                         VVAFLD=ON;/*                       @Z40LB61*/ 04294000
         L     @15,MARGPTR(,@05)                                   1206 04295000
         OI    VVAFLD(@15),B'01000000'                             1206 04296000
*                         FLDNUM(1)=IVADVVA(INTF#,WORKVUA+1);/*    1207 04297000
*                                                            @Z40LB61*/ 04298000
         ST    @14,FLDNUM(,@15)                                    1207 04299000
*                         FLDNUM(2)=MVVVA(MVPATH#);/*        @Z40LB61*/ 04300000
         ST    @04,FLDNUM+12(,@15)                                 1208 04301000
*                         CALL IDCCH04(GDTTBL,CDALIST);/*    @Z40LB61*/ 04302000
         L     @04,@PC00001                                        1209 04303000
         ST    @04,@AL00001                                        1209 04304000
         ST    @05,@AL00001+4                                      1209 04305000
         L     @15,@CV01495                                        1209 04306000
         LA    @01,@AL00001                                        1209 04307000
         BALR  @14,@15                                             1209 04308000
*                       END;        /*                       @Z40LB61*/ 04309000
*                   END MVTVADM;    /*                       @Z40LB61*/ 04310000
@RF01204 DS    0H                                                  1212 04311000
*               END VADCHK;         /*                       @Z40LB61*/ 04312000
*                                                                  1212 04313000
@RC01195 DS    0H                                                  1213 04314000
*             /*******************************************************/ 04315000
*             /*                                                     */ 04316000
*             /* IF MSC-MSC CHECKING WAS REQUESTED, CHECK    @Z40LB61*/ 04317000
*             /* THAT THE CPUID FROM THE CONFIGURATION       @Z40LB61*/ 04318000
*             /* INDEX (CI) MATCHES WITH THE MVT CPUID FOR   @Z40LB61*/ 04319000
*             /* THE CURRENT SA AND INTERFACE NUMBER.        @Z40LB61*/ 04320000
*             /* IF NOT, PRINT AN ERROR MESSAGE.             @Z40LB61*/ 04321000
*             /*                                                     */ 04322000
*             /*******************************************************/ 04323000
*                                                                  1213 04324000
*             IF MSCCHK=ON THEN                                    1213 04325000
@RF01187 L     @15,@PC00001+4                                      1213 04326000
         TM    MSCCHK(@15),B'10000000'                             1213 04327000
         BNO   @RF01213                                            1213 04328000
*CICHK:                                                            1214 04329000
*               DO;                 /*                       @Z40LB61*/ 04330000
CICHK    DS    0H                                                  1215 04331000
*                 CISA#=SA#;        /*                       @Z40LB61*/ 04332000
         LH    @15,SA#                                             1215 04333000
         STH   @15,CISA#                                           1215 04334000
*                 IF CICPUID(INTF#)^=WRKCPUID THEN                 1216 04335000
         LH    @14,WRKCPUID                                        1216 04336000
         LH    @05,INTF#                                           1216 04337000
         LR    @04,@05                                             1216 04338000
         ALR   @04,@04                                             1216 04339000
         SLA   @15,3                                               1216 04340000
         L     @01,CIENTPTR                                        1216 04341000
         AL    @01,@CF01764                                        1216 04342000
         LA    @15,CISACHNL-2(@15,@01)                             1216 04343000
         AL    @15,@CF01760                                        1216 04344000
         SLR   @03,@03                                             1216 04345000
         IC    @03,CICPUID(@04,@15)                                1216 04346000
         CR    @03,@14                                             1216 04347000
         BE    @RF01216                                            1216 04348000
*                   DO;             /*                       @Z40LB61*/ 04349000
*                     INCNMSG=ON;   /*                       @Z40LB61*/ 04350000
         L     @02,@PC00001+4                                      1218 04351000
         L     @15,MARGPTR(,@02)                                   1218 04352000
         OI    INCNMSG(@15),B'10000000'                            1218 04353000
*                     CITBL(1)=ON;  /*                       @Z40LB61*/ 04354000
         OI    CITBL(@15),B'01000000'                              1219 04355000
*                     MVTTBL(2)=ON; /*                       @Z40LB61*/ 04356000
         OI    MVTTBL+4(@15),B'10000000'                           1220 04357000
*                     CPUFLD=ON;    /*                       @Z40LB61*/ 04358000
         OI    CPUFLD(@15),B'00000100'                             1221 04359000
*                     FLDNUM(1)=CICPUID(INTF#);/*            @Z40LB61*/ 04360000
         ST    @03,FLDNUM(,@15)                                    1222 04361000
*                     FLDNUM(2)=WRKCPUID;/*                  @Z40LB61*/ 04362000
         ST    @14,FLDNUM+12(,@15)                                 1223 04363000
*                     SAINDEX(1)=MVSA#;/*                    @Z40LB61*/ 04364000
         MVC   SAINDEX(1,@15),MVSA#+1                              1224 04365000
*                     INFINDEX(1)=INTF#;/*                   @Z40LB61*/ 04366000
         STC   @05,INFINDEX(,@15)                                  1225 04367000
*                     CHRINDEX(1)=CICHR;/*                   @Z40LB61*/ 04368000
         MVC   CHRINDEX(5,@15),CICHR                               1226 04369000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB61*/ 04370000
         L     @03,@PC00001                                        1227 04371000
         ST    @03,@AL00001                                        1227 04372000
         ST    @02,@AL00001+4                                      1227 04373000
         L     @15,@CV01495                                        1227 04374000
         LA    @01,@AL00001                                        1227 04375000
         BALR  @14,@15                                             1227 04376000
*                   END;            /*                       @Z40LB61*/ 04377000
*               END CICHK;          /*                       @Z40LB61*/ 04378000
*                                                                  1229 04379000
@RF01216 DS    0H                                                  1230 04380000
*             /*******************************************************/ 04381000
*             /*                                                     */ 04382000
*             /* IF THE CURRENT ACTIVE INTERFACE HAS NOT     @Z40LB61*/ 04383000
*             /* ALREADY BEEN FOUND TO BE AN ALTERNATE       @Z40LB61*/ 04384000
*             /* PATH, OBTAIN THE CONFIGURATION DATA BLOCK   @Z40LB61*/ 04385000
*             /* (CDB) CORRESPONDING TO THE CURRENT VUA      @Z40LB61*/ 04386000
*             /*                                                     */ 04387000
*             /*******************************************************/ 04388000
*                                                                  1230 04389000
*             IF DONEINTF(MVPATH#,INTF#)=OFF THEN                  1230 04390000
@RF01213 LH    @15,MVPATH#                                         1230 04391000
         MH    @15,@CH00166                                        1230 04392000
         AH    @15,INTF#                                           1230 04393000
         LA    @14,DONEINTF-4(@15)                                 1230 04394000
         TM    0(@14),B'01000000'                                  1230 04395000
         BNZ   @RF01230                                            1230 04396000
*CDBCHK:                                                           1231 04397000
*               DO;                 /*                       @Z40LB61*/ 04398000
CDBCHK   DS    0H                                                  1232 04399000
*                 DONEINTF(MVPATH#,INTF#)=ON;/*              @Z40LB61*/ 04400000
         LH    @15,INTF#                                           1232 04401000
         LH    @14,MVPATH#                                         1232 04402000
         MH    @14,@CH00166                                        1232 04403000
         ALR   @14,@15                                             1232 04404000
         LA    @01,DONEINTF-4(@14)                                 1232 04405000
         OI    0(@01),B'01000000'                                  1232 04406000
*                 TABLEID=CFGTBLID; /*                       @Z40LB61*/ 04407000
         L     @14,@PC00001+4                                      1233 04408000
         L     @05,EARGPTR(,@14)                                   1233 04409000
         MVC   TABLEID(1,@05),CFGTBLID                             1233 04410000
*                 CDBFLAG=ON;       /*                       @Z40LB61*/ 04411000
         OI    CDBFLAG(@05),B'00000010'                            1234 04412000
*                 SANUM=MVSA#;      /*                       @Z40LB61*/ 04413000
         MVC   SANUM(2,@05),MVSA#                                  1235 04414000
*                 INTFID=INTF#;     /*                       @Z40LB61*/ 04415000
         STH   @15,INTFID(,@05)                                    1236 04416000
*                 CALL IDCCH03(GDTTBL,CDALIST);/*            @Z40LB61*/ 04417000
         L     @15,@PC00001                                        1237 04418000
         ST    @15,@AL00001                                        1237 04419000
         ST    @14,@AL00001+4                                      1237 04420000
         L     @15,@CV01494                                        1237 04421000
         LA    @01,@AL00001                                        1237 04422000
         BALR  @14,@15                                             1237 04423000
*                 IF GETRC^=0 THEN                                 1238 04424000
         L     @15,@PC00001+4                                      1238 04425000
         L     @01,EARGPTR(,@15)                                   1238 04426000
         ICM   @00,3,GETRC(@01)                                    1238 04427000
         BZ    @RF01238                                            1238 04428000
*                   DO;             /*                       @Z40LB61*/ 04429000
*                     LASTCOND=LASTCC12;/*                   @Z40LB61*/ 04430000
         L     @15,@PC00001+8                                      1240 04431000
         MVC   LASTCOND(2,@15),@CH00567                            1240 04432000
*                     RETURN;       /*                       @Z40LB61*/ 04433000
@EL00006 DS    0H                                                  1241 04434000
@EF00006 DS    0H                                                  1241 04435000
@ER00006 LM    @14,@12,@SA00006                                    1241 04436000
         BR    @14                                                 1241 04437000
*                   END;            /*                       @Z40LB61*/ 04438000
*                 CDBPTR=TBLADDR;   /*                       @Z40LB61*/ 04439000
@RF01238 L     @15,@PC00001+4                                      1243 04440000
         L     @14,EARGPTR(,@15)                                   1243 04441000
         L     @05,TBLADDR(,@14)                                   1243 04442000
         ST    @05,CDBPTR                                          1243 04443000
*                 CDBVUA#=WORKVUA+1;/*                       @Z40LB61*/ 04444000
*                                                                  1244 04445000
         LH    @04,WORKVUA                                         1244 04446000
         LA    @03,1                                               1244 04447000
         ALR   @03,@04                                             1244 04448000
         STH   @03,CDBVUA#                                         1244 04449000
*                 /***************************************************/ 04450000
*                 /*                                                 */ 04451000
*                 /* DO COMMON SET-UP FOR POSSIBLE ERROR     @Z40LB61*/ 04452000
*                 /* MESSAGES                                @Z40LB61*/ 04453000
*                 /*                                                 */ 04454000
*                 /***************************************************/ 04455000
*                                                                  1245 04456000
*                 CDBTBL(1)=ON;     /*                       @Z40LB61*/ 04457000
         L     @15,MARGPTR(,@15)                                   1245 04458000
         OI    CDBTBL(@15),B'00100000'                             1245 04459000
*                 MVTTBL(2)=ON;     /*                       @Z40LB61*/ 04460000
         OI    MVTTBL+4(@15),B'10000000'                           1246 04461000
*                 INCNMSG=ON;       /*                       @Z40LB61*/ 04462000
         OI    INCNMSG(@15),B'10000000'                            1247 04463000
*                 SAINDEX(1)=MVSA#; /*                       @Z40LB61*/ 04464000
         MVC   SAINDEX(1,@15),MVSA#+1                              1248 04465000
*                 INFINDEX(1)=INTF#;/*                       @Z40LB61*/ 04466000
         MVC   INFINDEX(1,@15),INTF#+1                             1249 04467000
*                 VUAINDEX(1)=WORKVUA;/*                     @Z40LB61*/ 04468000
         STC   @04,VUAINDEX(,@15)                                  1250 04469000
*                 CHRINDEX(1)=PREVCHR;/*                     @Z40LB61*/ 04470000
         MVC   CHRINDEX(5,@15),PREVCHR(@14)                        1251 04471000
*                 TBLNRSET(1)=ON;   /*                       @Z40LB61*/ 04472000
         OI    TBLNRSET(@15),B'00000001'                           1252 04473000
*                 TBLNRSET(2)=ON;   /*                       @Z40LB61*/ 04474000
         OI    TBLNRSET+4(@15),B'00000001'                         1253 04475000
*                 MSGNRSET=ON;      /*                       @Z40LB61*/ 04476000
*                                                                  1254 04477000
         OI    MSGNRSET(@15),B'00000001'                           1254 04478000
*                 /***************************************************/ 04479000
*                 /*                                                 */ 04480000
*                 /* IF THE CDB ENTRY INDICATES THIS VUA IS  @Z40LB61*/ 04481000
*                 /* AN ALTERNATE PATH, NO FURTHER CHECKING  @Z40LB61*/ 04482000
*                 /* IS DONE.                                @Z40LB61*/ 04483000
*                 /*                                                 */ 04484000
*                 /***************************************************/ 04485000
*                                                                  1255 04486000
*                 IF CDBCNFIG(CDBVUA#)='FF'X THEN                  1255 04487000
         SLA   @03,2                                               1255 04488000
         ALR   @05,@03                                             1255 04489000
         AL    @05,@CF01761                                        1255 04490000
         CLI   CDBCNFIG(@05),X'FF'                                 1255 04491000
         BE    @RT01255                                            1255 04492000
*                   ;               /*                       @Z40LB61*/ 04493000
*                 ELSE                                             1257 04494000
*                                                                  1257 04495000
*                   /*************************************************/ 04496000
*                   /*                                               */ 04497000
*                   /* IF THE CDB ENTRY INDICATES THAT THIS  @Z40LB61*/ 04498000
*                   /* VUA IS NOT IN USE, PRINT AN ERROR MSG @Z40LB61*/ 04499000
*                   /*                                               */ 04500000
*                   /*************************************************/ 04501000
*                                                                  1257 04502000
*                   IF CDBINUSE(CDBVUA#)=OFF THEN                  1257 04503000
         LH    @15,CDBVUA#                                         1257 04504000
         SLA   @15,2                                               1257 04505000
         L     @01,CDBPTR                                          1257 04506000
         ALR   @01,@15                                             1257 04507000
         AL    @01,@CF01761                                        1257 04508000
         TM    CDBINUSE(@01),B'01000000'                           1257 04509000
         BNZ   @RF01257                                            1257 04510000
*                     DO;           /*                       @Z40LB61*/ 04511000
*                       IUSFLD=ON;  /*                       @Z40LB61*/ 04512000
         L     @15,@PC00001+4                                      1259 04513000
         L     @14,MARGPTR(,@15)                                   1259 04514000
         OI    IUSFLD(@14),B'00000001'                             1259 04515000
*                       FLDCHAR(1)=STATNO;/*                 @Z40LB61*/ 04516000
         MVI   FLDCHAR+3(@14),C' '                                 1260 04517000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1260 04518000
         MVC   FLDCHAR(3,@14),@CC01345                             1260 04519000
*                       FLDCHAR(2)=STATYES;/*                @Z40LB61*/ 04520000
         MVI   FLDCHAR+15(@14),C' '                                1261 04521000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1261 04522000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1261 04523000
*                       CALL IDCCH04(GDTTBL,CDALIST);/*      @Z40LB61*/ 04524000
         L     @14,@PC00001                                        1262 04525000
         ST    @14,@AL00001                                        1262 04526000
         ST    @15,@AL00001+4                                      1262 04527000
         L     @15,@CV01495                                        1262 04528000
         LA    @01,@AL00001                                        1262 04529000
         BALR  @14,@15                                             1262 04530000
*                     END;          /*                       @Z40LB61*/ 04531000
*                   ELSE                                           1264 04532000
*                                                                  1264 04533000
*                     /***********************************************/ 04534000
*                     /*                                             */ 04535000
*                     /* IF A MATCHING, IN-USE CDB ENTRY WAS @Z40LB61*/ 04536000
*                     /* FOUND, CHECK-OFF THE ENTRY AND SET UP       */ 04537000
*                     /*                                     @Z40LB61*/ 04538000
*                     /* TO CHECK CORRESPONDING FIELDS FOR   @Z40LB61*/ 04539000
*                     /* CONSISTENCY.                        @Z40LB61*/ 04540000
*                     /*                                             */ 04541000
*                     /***********************************************/ 04542000
*                                                                  1264 04543000
*MVTCDBM:                                                          1264 04544000
*                     DO;           /*                       @Z40LB61*/ 04545000
         B     @RC01257                                            1264 04546000
@RF01257 DS    0H                                                  1264 04547000
MVTCDBM  DS    0H                                                  1265 04548000
*                       OLDERID2=NEWERID2;                         1265 04549000
         L     @15,@PC00001                                        1265 04550000
         L     @15,GDTTR2(,@15)                                    1265 04551000
         MVC   @TS00001(95),NEWERID2(@15)                          1265 04552000
         MVC   OLDERID2(95,@15),@TS00001                           1265 04553000
*                       NEWID2='CH2L';/*                     @Z40LB61*/ 04554000
         MVC   NEWID2(4,@15),@CC01604                              1266 04555000
*                       CDBCHKFF(SA#,INTF#,BYTE#)=CDBCHKFF(SA#,INTF#,   04556000
*                           BYTE#)|BITMASK(BIT#);                  1267 04557000
*                                                                  1267 04558000
         LH    @15,SA#                                             1267 04559000
         MH    @15,@CH00166                                        1267 04560000
         AH    @15,INTF#                                           1267 04561000
         SLA   @15,3                                               1267 04562000
         L     @14,@PC00001+4                                      1267 04563000
         L     @05,EARGPTR(,@14)                                   1267 04564000
         AH    @15,BYTE#(,@05)                                     1267 04565000
         L     @01,CDBCOPTR(,@14)                                  1267 04566000
         ALR   @01,@15                                             1267 04567000
         AL    @01,@CF01765                                        1267 04568000
         LH    @15,BIT#(,@05)                                      1267 04569000
         LA    @14,BITMASK-1(@15)                                  1267 04570000
         OC    CDBCHKFF(1,@01),0(@14)                              1267 04571000
*                       /*********************************************/ 04572000
*                       /*                                           */ 04573000
*                       /* IF THE SDG# IS VALID, ADD ONE TO  @Z40LB61*/ 04574000
*                       /* THE MOUNT COUNT (ACTIVE INTERFACES)       */ 04575000
*                       /*                                   @Z40LB61*/ 04576000
*                       /* FOR THE SDG FOR THIS VOLUME       @Z40LB61*/ 04577000
*                       /*                                           */ 04578000
*                       /*********************************************/ 04579000
*                                                                  1268 04580000
*                       IF MVSDG<SDGMAX THEN                       1268 04581000
         L     @15,MVENTPTR                                        1268 04582000
         CLI   MVSDG(@15),30                                       1268 04583000
         BNL   @RF01268                                            1268 04584000
*                         MNTCOUNT(MVSDG+1)=MNTCOUNT(MVSDG+1)+1;/* 1269 04585000
*                                                            @Z40LB61*/ 04586000
*                                                                  1269 04587000
         SLR   @14,@14                                             1269 04588000
         IC    @14,MVSDG(,@15)                                     1269 04589000
         ALR   @14,@14                                             1269 04590000
         LA    @15,1                                               1269 04591000
         AH    @15,MNTCOUNT(@14)                                   1269 04592000
         STH   @15,MNTCOUNT(@14)                                   1269 04593000
*                       /*********************************************/ 04594000
*                       /*                                           */ 04595000
*                       /* CHECK FOR MATCHING 3333 ADDRESS.  @Z40LB61*/ 04596000
*                       /* IF INCONSISTENT, PRINT AN ERROR MSG       */ 04597000
*                       /*                                   @Z40LB61*/ 04598000
*                       /*                                           */ 04599000
*                       /*********************************************/ 04600000
*                                                                  1270 04601000
*                       WORK3333=MV3333/SHIFT3;/*            @Z40LB61*/ 04602000
@RF01268 L     @01,MVENTPTR                                        1270 04603000
         SLR   @00,@00                                             1270 04604000
         IC    @00,MV3333(,@01)                                    1270 04605000
         SRL   @00,3                                               1270 04606000
         STC   @00,WORK3333                                        1270 04607000
*                       IF CDB3333(CDBVUA#)=OFF&WORK3333=1 THEN    1271 04608000
         LH    @15,CDBVUA#                                         1271 04609000
         SLA   @15,2                                               1271 04610000
         L     @01,CDBPTR                                          1271 04611000
         ALR   @01,@15                                             1271 04612000
         AL    @01,@CF01761                                        1271 04613000
         TM    CDB3333(@01),B'00100000'                            1271 04614000
         BNZ   @RF01271                                            1271 04615000
         CLI   WORK3333,1                                          1271 04616000
         BNE   @RF01271                                            1271 04617000
*                         DO;       /*                       @Z40LB61*/ 04618000
*                           L3AFLD=ON;/*                     @Z40LB61*/ 04619000
         L     @15,@PC00001+4                                      1273 04620000
         L     @14,MARGPTR(,@15)                                   1273 04621000
         OI    L3AFLD(@14),B'00000001'                             1273 04622000
*                           FLDNUM(1)=0;/*                   @Z40LB61*/ 04623000
         SLR   @05,@05                                             1274 04624000
         ST    @05,FLDNUM(,@14)                                    1274 04625000
*                           FLDNUM(2)=1;/*                   @Z40LB61*/ 04626000
         MVC   FLDNUM+12(4,@14),@CF00223                           1275 04627000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @Z40LB61*/ 04628000
         L     @14,@PC00001                                        1276 04629000
         ST    @14,@AL00001                                        1276 04630000
         ST    @15,@AL00001+4                                      1276 04631000
         L     @15,@CV01495                                        1276 04632000
         LA    @01,@AL00001                                        1276 04633000
         BALR  @14,@15                                             1276 04634000
*                         END;      /*                       @Z40LB61*/ 04635000
*                       IF CDB3333(CDBVUA#)=ON&WORK3333=0 THEN     1278 04636000
@RF01271 LH    @15,CDBVUA#                                         1278 04637000
         SLA   @15,2                                               1278 04638000
         L     @01,CDBPTR                                          1278 04639000
         ALR   @01,@15                                             1278 04640000
         AL    @01,@CF01761                                        1278 04641000
         TM    CDB3333(@01),B'00100000'                            1278 04642000
         BNO   @RF01278                                            1278 04643000
         CLI   WORK3333,0                                          1278 04644000
         BNE   @RF01278                                            1278 04645000
*                         DO;       /*                       @Z40LB61*/ 04646000
*                           L3AFLD=ON;/*                     @Z40LB61*/ 04647000
         L     @15,@PC00001+4                                      1280 04648000
         L     @14,MARGPTR(,@15)                                   1280 04649000
         OI    L3AFLD(@14),B'00000001'                             1280 04650000
*                           FLDNUM(1)=1;/*                   @Z40LB61*/ 04651000
         MVC   FLDNUM(4,@14),@CF00223                              1281 04652000
*                           FLDNUM(2)=0;/*                   @Z40LB61*/ 04653000
         SLR   @05,@05                                             1282 04654000
         ST    @05,FLDNUM+12(,@14)                                 1282 04655000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @Z40LB61*/ 04656000
         L     @14,@PC00001                                        1283 04657000
         ST    @14,@AL00001                                        1283 04658000
         ST    @15,@AL00001+4                                      1283 04659000
         L     @15,@CV01495                                        1283 04660000
         LA    @01,@AL00001                                        1283 04661000
         BALR  @14,@15                                             1283 04662000
*                         END;      /*                       @Z40LB61*/ 04663000
*                                                                  1284 04664000
*                       /*********************************************/ 04665000
*                       /*                                           */ 04666000
*                       /* CHECK FOR MATCHING SDG#. IF       @Z40LB61*/ 04667000
*                       /* INCONSISTENT, PRINT AN ERROR MSG  @Z40LB61*/ 04668000
*                       /*                                           */ 04669000
*                       /*********************************************/ 04670000
*                                                                  1285 04671000
*                       SDG#=CDBSDG(CDBVUA#)&MASK31;/*       @Z40LB61*/ 04672000
@RF01278 LH    @15,CDBVUA#                                         1285 04673000
         SLA   @15,2                                               1285 04674000
         L     @01,CDBPTR                                          1285 04675000
         AL    @01,@CF01761                                        1285 04676000
         SLR   @14,@14                                             1285 04677000
         IC    @14,CDBSDG(@15,@01)                                 1285 04678000
         SLR   @15,@15                                             1285 04679000
         IC    @15,MASK31                                          1285 04680000
         NR    @14,@15                                             1285 04681000
         STH   @14,SDG#                                            1285 04682000
*                       IF SDG#^=MVSDG THEN                        1286 04683000
         L     @01,MVENTPTR                                        1286 04684000
         SLR   @15,@15                                             1286 04685000
         IC    @15,MVSDG(,@01)                                     1286 04686000
         CR    @14,@15                                             1286 04687000
         BE    @RF01286                                            1286 04688000
*                         DO;       /*                       @Z40LB61*/ 04689000
*                           SDGFLD=ON;/*                     @Z40LB61*/ 04690000
         L     @05,@PC00001+4                                      1288 04691000
         L     @04,MARGPTR(,@05)                                   1288 04692000
         OI    SDGFLD(@04),B'00000010'                             1288 04693000
*                           FLDNUM(1)=SDG#;/*                @Z40LB61*/ 04694000
         ST    @14,FLDNUM(,@04)                                    1289 04695000
*                           FLDNUM(2)=MVSDG;/*               @Z40LB61*/ 04696000
         ST    @15,FLDNUM+12(,@04)                                 1290 04697000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @Z40LB61*/ 04698000
         L     @04,@PC00001                                        1291 04699000
         ST    @04,@AL00001                                        1291 04700000
         ST    @05,@AL00001+4                                      1291 04701000
         L     @15,@CV01495                                        1291 04702000
         LA    @01,@AL00001                                        1291 04703000
         BALR  @14,@15                                             1291 04704000
*                         END;      /*                       @Z40LB61*/ 04705000
*                                                                  1292 04706000
*                       /*********************************************/ 04707000
*                       /*                                           */ 04708000
*                       /* CHECK FOR MATCHING MVT POINTER.   @ZD00051*/ 04709000
*                       /* IF INCONSISTENT, PRINT AN ERROR MSG       */ 04710000
*                       /*                                   @ZD00051*/ 04711000
*                       /*                                           */ 04712000
*                       /*********************************************/ 04713000
*                                                                  1293 04714000
*                       IF CDBMVTP(CDBVUA#)^=SAVEREC#-1 THEN       1293 04715000
@RF01286 LH    @15,CDBVUA#                                         1293 04716000
         SLA   @15,2                                               1293 04717000
         L     @01,CDBPTR                                          1293 04718000
         ALR   @01,@15                                             1293 04719000
         AL    @01,@CF01760                                        1293 04720000
         SLR   @15,@15                                             1293 04721000
         ICM   @15,3,CDBMVTP-2(@01)                                1293 04722000
         LH    @14,SAVEREC#                                        1293 04723000
         BCTR  @14,0                                               1293 04724000
         CR    @15,@14                                             1293 04725000
         BE    @RF01293                                            1293 04726000
*                         DO;       /*                       @ZD00051*/ 04727000
*                           MVTPFLD=ON;/*                    @ZD00051*/ 04728000
         L     @05,@PC00001+4                                      1295 04729000
         L     @04,MARGPTR(,@05)                                   1295 04730000
         OI    MVTPFLD(@04),B'00100000'                            1295 04731000
*                           FLDNUM(1)=CDBMVTP(CDBVUA#);/*    @ZD00051*/ 04732000
         ST    @15,FLDNUM(,@04)                                    1296 04733000
*                           FLDNUM(2)=SAVEREC#-1;/*          @ZD00051*/ 04734000
         ST    @14,FLDNUM+12(,@04)                                 1297 04735000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @ZD00051*/ 04736000
         L     @04,@PC00001                                        1298 04737000
         ST    @04,@AL00001                                        1298 04738000
         ST    @05,@AL00001+4                                      1298 04739000
         L     @15,@CV01495                                        1298 04740000
         LA    @01,@AL00001                                        1298 04741000
         BALR  @14,@15                                             1298 04742000
*                         END;      /*                       @ZD00051*/ 04743000
*                                                                  1299 04744000
*                       /*********************************************/ 04745000
*                       /*                                           */ 04746000
*                       /* CHECK FOR ALTERNATE PATH VALIDITY @ZD00051*/ 04747000
*                       /* FOR EACH INTERFACE OF EACH SA FOR @ZD00051*/ 04748000
*                       /* THIS VUA ENTRY. TEMPORARILY SAVE  @ZD00051*/ 04749000
*                       /* THE 'PATH#' INDEX VARIABLE.       @ZD00051*/ 04750000
*                       /*                                           */ 04751000
*                       /*********************************************/ 04752000
*                                                                  1300 04753000
*                       TBLSECT#=MVPATH#;/*                  @ZD00051*/ 04754000
@RF01293 MVC   TBLSECT#(2),MVPATH#                                 1300 04755000
*ALTPATH:                                                          1301 04756000
*                       DO MVPATH#=1 TO SASSDG;/*            @ZD00051*/ 04757000
ALTPATH  LA    @15,1                                               1301 04758000
         STH   @15,MVPATH#                                         1301 04759000
@DL01301 DS    0H                                                  1302 04760000
*                         DO SAINTF#=1 TO INTFSSA;/*         @ZD00051*/ 04761000
         LA    @15,1                                               1302 04762000
         STH   @15,SAINTF#                                         1302 04763000
@DL01302 DS    0H                                                  1303 04764000
*                           IF(BITMASK((MVPATH#-1)*4+SAINTF#+1)&   1303 04765000
*                               CDBPATHS(CDBVUA#))^=0 THEN         1303 04766000
*                                                                  1303 04767000
         LH    @14,MVPATH#                                         1303 04768000
         LR    @05,@14                                             1303 04769000
         BCTR  @05,0                                               1303 04770000
         SLA   @05,2                                               1303 04771000
         ALR   @05,@15                                             1303 04772000
         LH    @04,CDBVUA#                                         1303 04773000
         SLA   @04,2                                               1303 04774000
         SLR   @03,@03                                             1303 04775000
         IC    @03,BITMASK(@05)                                    1303 04776000
         L     @02,CDBPTR                                          1303 04777000
         AL    @02,@CF01766                                        1303 04778000
         SLR   @05,@05                                             1303 04779000
         IC    @05,CDBPATHS-1(@04,@02)                             1303 04780000
         NR    @03,@05                                             1303 04781000
         LTR   @03,@03                                             1303 04782000
         BZ    @RF01303                                            1303 04783000
*                             /***************************************/ 04784000
*                             /*                                     */ 04785000
*                             /* IF THE CDB INDICATES A VALID        */ 04786000
*                             /*                             @ZD00051*/ 04787000
*                             /* PATH, CHECK IN THE MVT ENTRY        */ 04788000
*                             /*                             @ZD00051*/ 04789000
*                             /* THAT THE INTERFACE IS ACTIVE        */ 04790000
*                             /*                             @ZD00051*/ 04791000
*                             /* AND HAS THE SAME CPUID AND  @Z40LB61*/ 04792000
*                             /* VUA AS THE PRIMARY PATH.    @Z40LB61*/ 04793000
*                             /* FOR ANY INCONSISTENCY,      @Z40LB61*/ 04794000
*                             /* PRINT AN ERROR MESSAGE.     @Z40LB61*/ 04795000
*                             /*                                     */ 04796000
*                             /***************************************/ 04797000
*                                                                  1304 04798000
*                             DO;   /*                       @Z40LB61*/ 04799000
*                               IF ACTINTF(MVPATH#,SAINTF#)=OFF|(MVVUA( 04800000
*                                   SAINTF#)&MASK63)^=WORKVUA|(MVCPUID( 04801000
*                                   SAINTF#)&MASK15)^=WRKCPUID THEN     04802000
         LR    @05,@14                                             1305 04803000
         MH    @05,@CH00166                                        1305 04804000
         ALR   @05,@15                                             1305 04805000
         LA    @04,ACTINTF-4(@05)                                  1305 04806000
         TM    0(@04),B'10000000'                                  1305 04807000
         BZ    @RT01305                                            1305 04808000
         L     @05,MVENTPTR                                        1305 04809000
         SLA   @14,3                                               1305 04810000
         LA    @04,MVVUAS-8(@14,@05)                               1305 04811000
         AL    @04,@CF01340                                        1305 04812000
         SLR   @03,@03                                             1305 04813000
         IC    @03,MVVUA(@15,@04)                                  1305 04814000
         SLR   @02,@02                                             1305 04815000
         IC    @02,MASK63                                          1305 04816000
         NR    @03,@02                                             1305 04817000
         CH    @03,WORKVUA                                         1305 04818000
         BNE   @RT01305                                            1305 04819000
         LA    @14,MVCPUIDS-8(@14,@05)                             1305 04820000
         AL    @14,@CF01340                                        1305 04821000
         SLR   @05,@05                                             1305 04822000
         IC    @05,MVCPUID(@15,@14)                                1305 04823000
         SLR   @04,@04                                             1305 04824000
         IC    @04,MASK15                                          1305 04825000
         NR    @05,@04                                             1305 04826000
         CH    @05,WRKCPUID                                        1305 04827000
         BE    @RF01305                                            1305 04828000
@RT01305 DS    0H                                                  1306 04829000
*                                 DO;/*                      @Z40LB61*/ 04830000
*                                   APSFLD=ON;/*             @Z40LB61*/ 04831000
         L     @15,@PC00001+4                                      1307 04832000
         L     @14,MARGPTR(,@15)                                   1307 04833000
         OI    APSFLD(@14),B'10000000'                             1307 04834000
*                                   FLDCHAR(1)=STATYES;/*    @Z40LB61*/ 04835000
         MVI   FLDCHAR+3(@14),C' '                                 1308 04836000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1308 04837000
         MVC   FLDCHAR(3,@14),@CC01343                             1308 04838000
*                                   FLDCHAR(2)=STATNO;/*     @Z40LB61*/ 04839000
         MVI   FLDCHAR+15(@14),C' '                                1309 04840000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1309 04841000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1309 04842000
*                                   CALL IDCCH04(GDTTBL,CDALIST);/*     04843000
*                                                            @Z40LB61*/ 04844000
         L     @14,@PC00001                                        1310 04845000
         ST    @14,@AL00001                                        1310 04846000
         ST    @15,@AL00001+4                                      1310 04847000
         L     @15,@CV01495                                        1310 04848000
         LA    @01,@AL00001                                        1310 04849000
         BALR  @14,@15                                             1310 04850000
*                                 END;/*                     @Z40LB61*/ 04851000
*                               DONEINTF(MVPATH#,SAINTF#)=ON;/*    1312 04852000
*                                                            @Z40LB61*/ 04853000
@RF01305 LH    @15,MVPATH#                                         1312 04854000
         MH    @15,@CH00166                                        1312 04855000
         AH    @15,SAINTF#                                         1312 04856000
         LA    @14,DONEINTF-4(@15)                                 1312 04857000
         OI    0(@14),B'01000000'                                  1312 04858000
*                             END;  /*                       @Z40LB61*/ 04859000
*                         END;      /*                       @Z40LB61*/ 04860000
@RF01303 LA    @15,1                                               1314 04861000
         AH    @15,SAINTF#                                         1314 04862000
         STH   @15,SAINTF#                                         1314 04863000
         CH    @15,@CH00166                                        1314 04864000
         BNH   @DL01302                                            1314 04865000
*                       END ALTPATH;/*                       @Z40LB61*/ 04866000
*                                                                  1315 04867000
         LA    @15,1                                               1315 04868000
         AH    @15,MVPATH#                                         1315 04869000
         STH   @15,MVPATH#                                         1315 04870000
         CH    @15,@CH00157                                        1315 04871000
         BNH   @DL01301                                            1315 04872000
*                       /*********************************************/ 04873000
*                       /*                                           */ 04874000
*                       /* RESTORE 'PATH#' VARIABLE          @Z40LB61*/ 04875000
*                       /*                                           */ 04876000
*                       /*********************************************/ 04877000
*                                                                  1316 04878000
*                       MVPATH#=TBLSECT#;/*                  @Z40LB61*/ 04879000
         MVC   MVPATH#(2),TBLSECT#                                 1316 04880000
*                     END MVTCDBM;  /*                       @Z40LB61*/ 04881000
*                                                                  1317 04882000
*                 /***************************************************/ 04883000
*                 /*                                                 */ 04884000
*                 /* RESET 'IDCCH04' OPTION FLAGS            @Z40LB61*/ 04885000
*                 /*                                                 */ 04886000
*                 /***************************************************/ 04887000
*                                                                  1318 04888000
*                 MSGTYPE=''B;      /*                       @Z40LB61*/ 04889000
@RC01257 DS    0H                                                  1318 04890000
@RT01255 L     @15,@PC00001+4                                      1318 04891000
         L     @15,MARGPTR(,@15)                                   1318 04892000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1318 04893000
*                 TBLTYPE(1)=''B;   /*                       @Z40LB61*/ 04894000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1319 04895000
*                 TBLTYPE(2)=''B;   /*                       @Z40LB61*/ 04896000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1320 04897000
*               END CDBCHK;         /*                       @Z40LB61*/ 04898000
*           END GOODINTF;           /*                       @Z40LB61*/ 04899000
@RF01230 DS    0H                                                  1323 04900000
*       END INTFLOOP;               /*                       @Z40LB61*/ 04901000
@RF01179 LA    @15,1                                               1323 04902000
         AH    @15,INTF#                                           1323 04903000
         STH   @15,INTF#                                           1323 04904000
         CH    @15,@CH00166                                        1323 04905000
         BNH   @DL01178                                            1323 04906000
*   END SALOOP2;                    /*                       @Z40LB61*/ 04907000
@RC01165 LA    @15,1                                               1324 04908000
         AH    @15,MVPATH#                                         1324 04909000
         STH   @15,MVPATH#                                         1324 04910000
         CH    @15,@CH00157                                        1324 04911000
         BNH   @DL01162                                            1324 04912000
*   END MVTVUAS;                    /*                       @Z40LB61*/ 04913000
         B     @EL00006                                            1325 04914000
*                                                                  1326 04915000
*/********************************************************************/ 04916000
*/*                                                          @Z40LB61*/ 04917000
*/* PROCEDURE NAME - MVTPAGES                                @Z40LB61*/ 04918000
*/*                                                          @Z40LB61*/ 04919000
*/* FUNCTION - THIS ROUTINE PRIMARILY ROUTES CONTROL TO      @Z40LB61*/ 04920000
*/*            SUBROUTINES WHICH COMPARE PAGE ALLOCATION     @Z40LB61*/ 04921000
*/*            DATA IN THE MVT AGAINST PAGE ALLOCATION       @Z40LB61*/ 04922000
*/*            DATA IN CORRESPONDING MSC AND SA TABLES.      @Z40LB61*/ 04923000
*/*                                                          @Z40LB61*/ 04924000
*/* INPUT -                                                  @Z40LB61*/ 04925000
*/*        (1) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 04926000
*/*                                                          @Z40LB61*/ 04927000
*/* OUTPUT -                                                 @Z40LB61*/ 04928000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 04929000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 04930000
*/*                                                          @Z40LB61*/ 04931000
*/********************************************************************/ 04932000
*                                                                  1326 04933000
*MVTPAGES:                                                         1326 04934000
*   PROCEDURE;                      /*                       @Z40LB61*/ 04935000
MVTPAGES STM   @14,@12,@SA00007                                    1326 04936000
*   OLDERID2=NEWERID2;                                             1327 04937000
         L     @15,@PC00001                                        1327 04938000
         L     @14,GDTTR2(,@15)                                    1327 04939000
         MVC   @TS00001(95),NEWERID2(@14)                          1327 04940000
         MVC   OLDERID2(95,@14),@TS00001                           1327 04941000
*   NEWID2='CH2M';                  /*                       @Z40LB61*/ 04942000
*                                                                  1328 04943000
         MVC   NEWID2(4,@14),@CC01610                              1328 04944000
*   /*****************************************************************/ 04945000
*   /*                                                               */ 04946000
*   /* IF THE STAGING DRIVE GROUP (SDG) NUMBER FROM THE      @Z40LB61*/ 04947000
*   /* MVT ENTRY IS NOT WITHIN THE ALLOWABLE RANGE, PRINT    @Z40LB61*/ 04948000
*   /* AN ERROR MESSAGE.                                     @Z40LB61*/ 04949000
*   /*                                                               */ 04950000
*   /*****************************************************************/ 04951000
*                                                                  1329 04952000
*   IF MVSDG>=SDGMAX THEN                                          1329 04953000
         L     @14,MVENTPTR                                        1329 04954000
         CLI   MVSDG(@14),30                                       1329 04955000
         BL    @RF01329                                            1329 04956000
*     DO;                           /*                       @Z40LB61*/ 04957000
*       MTCHMSG=ON;                 /*                       @Z40LB61*/ 04958000
         L     @05,@PC00001+4                                      1331 04959000
         L     @04,MARGPTR(,@05)                                   1331 04960000
         OI    MTCHMSG(@04),B'00010000'                            1331 04961000
*       PABTBL(1)=ON;               /*                       @Z40LB61*/ 04962000
         OI    PABTBL(@04),B'00010000'                             1332 04963000
*       MVTTBL(2)=ON;               /*                       @Z40LB61*/ 04964000
         OI    MVTTBL+4(@04),B'10000000'                           1333 04965000
*       SDGFLD=ON;                  /*                       @Z40LB61*/ 04966000
         OI    SDGFLD(@04),B'00000010'                             1334 04967000
*       FLDNUM(1)=MVSDG;            /*                       @Z40LB61*/ 04968000
         SLR   @03,@03                                             1335 04969000
         IC    @03,MVSDG(,@14)                                     1335 04970000
         ST    @03,FLDNUM(,@04)                                    1335 04971000
*       CALL IDCCH04(GDTTBL,CDALIST);/*                      @Z40LB61*/ 04972000
         ST    @15,@AL00001                                        1336 04973000
         ST    @05,@AL00001+4                                      1336 04974000
         L     @15,@CV01495                                        1336 04975000
         LA    @01,@AL00001                                        1336 04976000
         BALR  @14,@15                                             1336 04977000
*     END;                          /*                       @Z40LB61*/ 04978000
*   ELSE                                                           1338 04979000
*                                                                  1338 04980000
*     /***************************************************************/ 04981000
*     /*                                                             */ 04982000
*     /* IF THE SDG# IS VALID, PERFORM CHECKING ASSOCIATED   @Z40LB61*/ 04983000
*     /* WITH PAGES ALLOCATED TO THE STAGING DRIVE GROUP     @Z40LB61*/ 04984000
*     /*                                                             */ 04985000
*     /***************************************************************/ 04986000
*                                                                  1338 04987000
*     DO;                           /*                       @Z40LB61*/ 04988000
*                                                                  1338 04989000
         B     @RC01329                                            1338 04990000
@RF01329 DS    0H                                                  1339 04991000
*       /*************************************************************/ 04992000
*       /*                                                           */ 04993000
*       /* PERFORM CONSISTENCY CHECKING FOR ALLOCATED PAGES  @Z40LB61*/ 04994000
*       /* AS DESCRIBED IN THE SDG PAGE AVAILABILITY BLOCK   @Z40LB61*/ 04995000
*       /*                                                           */ 04996000
*       /*************************************************************/ 04997000
*                                                                  1339 04998000
*       CALL MVTPAB;                /*                       @Z40LB61*/ 04999000
         BAL   @14,MVTPAB                                          1339 05000000
*       IF LASTCOND^=0 THEN                                        1340 05001000
         L     @15,@PC00001+8                                      1340 05002000
         ICM   @14,3,LASTCOND(@15)                                 1340 05003000
         BNZ   @RT01340                                            1340 05004000
*         RETURN;                   /*                       @Z40LB61*/ 05005000
*                                                                  1341 05006000
*       /*************************************************************/ 05007000
*       /*                                                           */ 05008000
*       /* PERFORM CONSISTENCY CHECKING FOR ALLOCATED PAGES  @Z40LB61*/ 05009000
*       /* AS DESCRIBED IN THE SDG REAL PAGE MAP             @Z40LB61*/ 05010000
*       /*                                                           */ 05011000
*       /*************************************************************/ 05012000
*                                                                  1342 05013000
*       CALL MVTRPM;                /*                       @Z40LB61*/ 05014000
         BAL   @14,MVTRPM                                          1342 05015000
*       IF LASTCOND^=0 THEN                                        1343 05016000
         L     @15,@PC00001+8                                      1343 05017000
         ICM   @14,3,LASTCOND(@15)                                 1343 05018000
         BNZ   @RT01343                                            1343 05019000
*         RETURN;                   /*                       @Z40LB61*/ 05020000
*                                                                  1344 05021000
*       /*************************************************************/ 05022000
*       /*                                                           */ 05023000
*       /* IF MSC-MSC CHECKING WAS REQUESTED, PERFORM        @Z40LB61*/ 05024000
*       /* CONSISTENCY CHECKING INVOLVING PAGES WHICH ARE    @Z40LB61*/ 05025000
*       /* ALLOCATED BUT INACTIVE.                           @Z40LB61*/ 05026000
*       /*                                                           */ 05027000
*       /*************************************************************/ 05028000
*                                                                  1345 05029000
*       IF MSCCHK=ON THEN                                          1345 05030000
         L     @15,@PC00001+4                                      1345 05031000
         TM    MSCCHK(@15),B'10000000'                             1345 05032000
         BNO   @RF01345                                            1345 05033000
*         CALL INACTIVE;            /*                       @Z40LB61*/ 05034000
         BAL   @14,INACTIVE                                        1346 05035000
*     END;                          /*                       @Z40LB61*/ 05036000
*   END MVTPAGES;                   /*                       @Z40LB61*/ 05037000
@EL00007 DS    0H                                                  1348 05038000
@EF00007 DS    0H                                                  1348 05039000
@ER00007 LM    @14,@12,@SA00007                                    1348 05040000
         BR    @14                                                 1348 05041000
*                                                                  1349 05042000
*/********************************************************************/ 05043000
*/*                                                          @Z40LB61*/ 05044000
*/* PROCEDURE NAME - MVTPAB                                  @Z40LB61*/ 05045000
*/*                                                          @Z40LB61*/ 05046000
*/* FUNCTION - THIS ROUTINE COMPARES MVT PAGE ALLOCATION     @Z40LB61*/ 05047000
*/*            DATA AGAINST RELATED INFORMATION IN THE       @Z40LB61*/ 05048000
*/*            ASSOCIATED SDG PAGE AVAILABILITY BLOCK        @Z40LB61*/ 05049000
*/*                                                          @Z40LB61*/ 05050000
*/* INPUT -                                                  @Z40LB61*/ 05051000
*/*        (1) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 05052000
*/*        (2) MSC SDG PAGE AVAILABILITY BLOCK               @Z40LB61*/ 05053000
*/*                                                          @Z40LB61*/ 05054000
*/* OUTPUT -                                                 @Z40LB61*/ 05055000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 05056000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 05057000
*/*        (3) COUNT OF INACTIVE PAGES FOR THIS VOLUME       @Z40LB61*/ 05058000
*/*                                                          @Z40LB61*/ 05059000
*/********************************************************************/ 05060000
*                                                                  1349 05061000
*MVTPAB:                                                           1349 05062000
*   PROCEDURE;                      /*                       @Z40LB61*/ 05063000
MVTPAB   STM   @14,@12,@SA00008                                    1349 05064000
*   OLDERID2=NEWERID2;                                             1350 05065000
         L     @15,@PC00001                                        1350 05066000
         L     @14,GDTTR2(,@15)                                    1350 05067000
         MVC   @TS00001(95),NEWERID2(@14)                          1350 05068000
         MVC   OLDERID2(95,@14),@TS00001                           1350 05069000
*   NEWID2='CH2N';                  /*                       @Z40LB61*/ 05070000
*                                                                  1351 05071000
         MVC   NEWID2(4,@14),@CC01617                              1351 05072000
*   /*****************************************************************/ 05073000
*   /*                                                               */ 05074000
*   /* OBTAIN THE PAGE AVAILABILITY BLOCK (PAB) FOR THE      @Z40LB61*/ 05075000
*   /* SDG ASSOCIATED WITH THE CURRENT MVT ENTRY.            @Z40LB61*/ 05076000
*   /*                                                               */ 05077000
*   /*****************************************************************/ 05078000
*                                                                  1352 05079000
*   TABLEID=SDGTBLID;               /*                       @Z40LB61*/ 05080000
         L     @14,@PC00001+4                                      1352 05081000
         L     @05,EARGPTR(,@14)                                   1352 05082000
         MVC   TABLEID(1,@05),SDGTBLID                             1352 05083000
*   PABFLAG=ON;                     /*                       @Z40LB61*/ 05084000
         OI    PABFLAG(@05),B'01000000'                            1353 05085000
*   SDGNUM=MVSDG;                   /*                       @Z40LB61*/ 05086000
         L     @01,MVENTPTR                                        1354 05087000
         SLR   @00,@00                                             1354 05088000
         IC    @00,MVSDG(,@01)                                     1354 05089000
         STH   @00,SDGNUM(,@05)                                    1354 05090000
*   CALL IDCCH03(GDTTBL,CDALIST);   /*                       @Z40LB61*/ 05091000
         ST    @15,@AL00001                                        1355 05092000
         ST    @14,@AL00001+4                                      1355 05093000
         L     @15,@CV01494                                        1355 05094000
         LA    @01,@AL00001                                        1355 05095000
         BALR  @14,@15                                             1355 05096000
*   IF GETRC^=0 THEN                                               1356 05097000
         L     @15,@PC00001+4                                      1356 05098000
         L     @01,EARGPTR(,@15)                                   1356 05099000
         ICM   @00,3,GETRC(@01)                                    1356 05100000
         BZ    @RF01356                                            1356 05101000
*     DO;                           /*                       @Z40LB61*/ 05102000
*       LASTCOND=LASTCC12;          /*                       @Z40LB61*/ 05103000
         L     @15,@PC00001+8                                      1358 05104000
         MVC   LASTCOND(2,@15),@CH00567                            1358 05105000
*       RETURN;                     /*                       @Z40LB61*/ 05106000
@EL00008 DS    0H                                                  1359 05107000
@EF00008 DS    0H                                                  1359 05108000
@ER00008 LM    @14,@12,@SA00008                                    1359 05109000
         BR    @14                                                 1359 05110000
*     END;                          /*                       @Z40LB61*/ 05111000
*   PABPTR=TBLADDR;                 /*                       @Z40LB61*/ 05112000
*                                                                  1361 05113000
@RF01356 L     @15,@PC00001+4                                      1361 05114000
         L     @01,EARGPTR(,@15)                                   1361 05115000
         MVC   PABPTR(4),TBLADDR(@01)                              1361 05116000
*   /*****************************************************************/ 05117000
*   /*                                                               */ 05118000
*   /* EXAMINE THE DEVICE ATTRIBUTE FLAGS OF THE PAB TO      @Z40LB61*/ 05119000
*   /* DETERMINE WHICH DEVICES ARE STAGING DEVICES           @Z40LB61*/ 05120000
*   /*                                                               */ 05121000
*   /*****************************************************************/ 05122000
*                                                                  1362 05123000
*   STAGEDEV=''B;                   /*                       @Z40LB61*/ 05124000
         MVI   STAGEDEV,X'00'                                      1362 05125000
*   DO DEV#=1 TO DEVSSDG;           /*                       @Z40LB61*/ 05126000
         LA    @15,1                                               1363 05127000
         STH   @15,DEV#                                            1363 05128000
@DL01363 DS    0H                                                  1364 05129000
*     IF PABDEX(DEV#)=ON&(PABVARV(DEV#)=ON|PABVARN(DEV#)=ON) THEN  1364 05130000
         L     @14,PABPTR                                          1364 05131000
         LR    @05,@15                                             1364 05132000
         SLA   @05,2                                               1364 05133000
         ST    @05,@TF00001                                        1364 05134000
         ALR   @05,@14                                             1364 05135000
         TM    PABDEX-4(@05),B'10000000'                           1364 05136000
         BNO   @RF01364                                            1364 05137000
         AL    @14,@TF00001                                        1364 05138000
         TM    PABVARV-4(@14),B'01000010'                          1364 05139000
         BZ    @RF01364                                            1364 05140000
*       STAGEDEV=STAGEDEV|BITMASK(DEV#);/*                   @Z40LB61*/ 05141000
         LA    @14,BITMASK-1(@15)                                  1365 05142000
         OC    STAGEDEV(1),0(@14)                                  1365 05143000
*   END;                            /*                       @Z40LB61*/ 05144000
*                                                                  1366 05145000
@RF01364 LA    @15,1                                               1366 05146000
         AH    @15,DEV#                                            1366 05147000
         STH   @15,DEV#                                            1366 05148000
         CH    @15,@CH00183                                        1366 05149000
         BNH   @DL01363                                            1366 05150000
*   /*****************************************************************/ 05151000
*   /*                                                               */ 05152000
*   /* CHECK MVT INFORMATION PERTAINING TO BOTH POSSIBLE     @Z40LB61*/ 05153000
*   /* SA PATHS                                              @Z40LB61*/ 05154000
*   /*                                                               */ 05155000
*   /*****************************************************************/ 05156000
*                                                                  1367 05157000
*   PABABOX=L3333SSA;               /*                       @Z40LB61*/ 05158000
         MVC   PABABOX(2),@CH00157                                 1367 05159000
*MVTPABM1:                                                         1368 05160000
*   DO MVPATH#=1 TO SASSDG;         /*                       @Z40LB61*/ 05161000
MVTPABM1 LA    @15,1                                               1368 05162000
         STH   @15,MVPATH#                                         1368 05163000
@DL01368 DS    0H                                                  1369 05164000
*     MVSA#=MVSA(MVPATH#)&MASK15;   /*                       @Z40LB61*/ 05165000
*                                                                  1369 05166000
         L     @14,MVENTPTR                                        1369 05167000
         SLA   @15,3                                               1369 05168000
         SLR   @05,@05                                             1369 05169000
         IC    @05,MVSA-8(@15,@14)                                 1369 05170000
         SLR   @04,@04                                             1369 05171000
         IC    @04,MASK15                                          1369 05172000
         NR    @05,@04                                             1369 05173000
         STH   @05,MVSA#                                           1369 05174000
*     /***************************************************************/ 05175000
*     /*                                                             */ 05176000
*     /* CHECK WHETHER THE SA PATH IS VALID                  @Z40LB61*/ 05177000
*     /*                                                             */ 05178000
*     /***************************************************************/ 05179000
*                                                                  1370 05180000
*     IF MVVLDSA(MVPATH#)=ON&       /*                       @ZA27324*/ 05181000
*         VLDSSID(MVSA#)^=NULLSSID THEN/*                    @ZA27324*/ 05182000
         ALR   @14,@15                                             1370 05183000
         TM    MVVLDSA-8(@14),B'10000000'                          1370 05184000
         BNO   @RF01370                                            1370 05185000
         ALR   @05,@05                                             1370 05186000
         L     @04,@PC00001+4                                      1370 05187000
         LH    @15,VLDSSID-2(@05,@04)                              1370 05188000
         CH    @15,@CH01340                                        1370 05189000
         BE    @RF01370                                            1370 05190000
*MVTPABM2:                                                         1371 05191000
*       DO;                         /*                       @Z40LB61*/ 05192000
MVTPABM2 DS    0H                                                  1372 05193000
*         MATCHED=OFF;              /*                       @Z40LB61*/ 05194000
*                                                                  1372 05195000
         NI    MATCHED,B'01111111'                                 1372 05196000
*         /***********************************************************/ 05197000
*         /*                                                         */ 05198000
*         /* FOR A VALID SA PATH BASED ON THE MVT ENTRY,     @Z40LB61*/ 05199000
*         /* CHECK EACH POSSIBLE SA PATH IN THE PAB FOR      @Z40LB61*/ 05200000
*         /* MATCHING INFORMATION                            @Z40LB61*/ 05201000
*         /*                                                         */ 05202000
*         /***********************************************************/ 05203000
*                                                                  1373 05204000
*         DO PABPATH#=1 TO SASSDG;  /*                       @Z40LB61*/ 05205000
         LA    @15,1                                               1373 05206000
         STH   @15,PABPATH#                                        1373 05207000
@DL01373 DS    0H                                                  1374 05208000
*           WORKSA=PABSA(PABPATH#)&MASK15;/*                 @Z40LB61*/ 05209000
*                                                                  1374 05210000
         L     @14,PABPTR                                          1374 05211000
         SLR   @05,@05                                             1374 05212000
         IC    @05,PABSA-1(@15,@14)                                1374 05213000
         SLR   @04,@04                                             1374 05214000
         IC    @04,MASK15                                          1374 05215000
         NR    @05,@04                                             1374 05216000
         STH   @05,WORKSA                                          1374 05217000
*           /*********************************************************/ 05218000
*           /*                                                       */ 05219000
*           /* IF A MATCHING SA IS FOUND IN THE PAB, NOTE IT @Z40LB61*/ 05220000
*           /* HAS BEEN MATCHED. CONVERT THE 3333 ADDRESS    @Z40LB61*/ 05221000
*           /* ASSOCIATED WITH IT INTO A NUMERIC VALUE.      @Z40LB61*/ 05222000
*           /*                                                       */ 05223000
*           /*********************************************************/ 05224000
*                                                                  1375 05225000
*           IF PABVLDSA(PABPATH#)=ON&WORKSA=MVSA# THEN             1375 05226000
         ALR   @15,@14                                             1375 05227000
         TM    PABVLDSA-1(@15),B'10000000'                         1375 05228000
         BNO   @RF01375                                            1375 05229000
         CH    @05,MVSA#                                           1375 05230000
         BNE   @RF01375                                            1375 05231000
*             DO;                   /*                       @Z40LB61*/ 05232000
*               MATCHED=ON;         /*                       @Z40LB61*/ 05233000
         OI    MATCHED,B'10000000'                                 1377 05234000
*               PABVLDSA(PABPATH#)=OFF;/*                    @Z40LB61*/ 05235000
         LH    @15,PABPATH#                                        1378 05236000
         ALR   @15,@14                                             1378 05237000
         NI    PABVLDSA-1(@15),B'01111111'                         1378 05238000
*               IF PAB3333(PABPATH#)=OFF THEN                      1379 05239000
         LH    @15,PABPATH#                                        1379 05240000
         ALR   @14,@15                                             1379 05241000
         TM    PAB3333-1(@14),B'00010000'                          1379 05242000
         BNZ   @RF01379                                            1379 05243000
*                 PABABOX=0;        /*                       @Z40LB61*/ 05244000
         SLR   @15,@15                                             1380 05245000
         STH   @15,PABABOX                                         1380 05246000
*               ELSE                                               1381 05247000
*                 PABABOX=1;        /*                       @Z40LB61*/ 05248000
         B     @RC01379                                            1381 05249000
@RF01379 MVC   PABABOX(2),@CH00223                                 1381 05250000
*             END;                  /*                       @Z40LB61*/ 05251000
@RC01379 DS    0H                                                  1383 05252000
*         END;                      /*                       @Z40LB61*/ 05253000
*                                                                  1383 05254000
@RF01375 LA    @15,1                                               1383 05255000
         AH    @15,PABPATH#                                        1383 05256000
         STH   @15,PABPATH#                                        1383 05257000
         CH    @15,@CH00157                                        1383 05258000
         BNH   @DL01373                                            1383 05259000
*         /***********************************************************/ 05260000
*         /*                                                         */ 05261000
*         /* IF NO MATCH IS FOUND IN THE PAB FOR A VALID MVT @Z40LB61*/ 05262000
*         /* SA#, PRINT AN ERROR MESSAGE                     @Z40LB61*/ 05263000
*         /*                                                         */ 05264000
*         /***********************************************************/ 05265000
*                                                                  1384 05266000
*         IF MATCHED=OFF THEN                                      1384 05267000
         TM    MATCHED,B'10000000'                                 1384 05268000
         BNZ   @RF01384                                            1384 05269000
*           DO;                     /*                       @Z40LB61*/ 05270000
*             PABTBL(1)=ON;         /*                       @Z40LB61*/ 05271000
         L     @15,@PC00001+4                                      1386 05272000
         L     @14,MARGPTR(,@15)                                   1386 05273000
         OI    PABTBL(@14),B'00010000'                             1386 05274000
*             MVTTBL(2)=ON;         /*                       @Z40LB61*/ 05275000
         OI    MVTTBL+4(@14),B'10000000'                           1387 05276000
*             MTCHMSG=ON;           /*                       @Z40LB61*/ 05277000
         OI    MTCHMSG(@14),B'00010000'                            1388 05278000
*             SAFLD=ON;             /*                       @Z40LB61*/ 05279000
         OI    SAFLD(@14),B'00001000'                              1389 05280000
*             FLDNUM(1)=MVSA#;      /*                       @Z40LB61*/ 05281000
         LH    @05,MVSA#                                           1390 05282000
         ST    @05,FLDNUM(,@14)                                    1390 05283000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 05284000
         L     @14,@PC00001                                        1391 05285000
         ST    @14,@AL00001                                        1391 05286000
         ST    @15,@AL00001+4                                      1391 05287000
         L     @15,@CV01495                                        1391 05288000
         LA    @01,@AL00001                                        1391 05289000
         BALR  @14,@15                                             1391 05290000
*           END;                    /*                       @Z40LB61*/ 05291000
*       END MVTPABM2;               /*                       @Z40LB61*/ 05292000
@RF01384 DS    0H                                                  1394 05293000
*   END MVTPABM1;                   /*                       @Z40LB61*/ 05294000
*                                                                  1394 05295000
@RF01370 LA    @15,1                                               1394 05296000
         AH    @15,MVPATH#                                         1394 05297000
         STH   @15,MVPATH#                                         1394 05298000
         CH    @15,@CH00157                                        1394 05299000
         BNH   @DL01368                                            1394 05300000
*   /*****************************************************************/ 05301000
*   /*                                                               */ 05302000
*   /* NOW CHECK THAT EACH POSSIBLE SA PATH IN THE PAB       @Z40LB61*/ 05303000
*   /* MATCHED WITH AN MVT SA                                @Z40LB61*/ 05304000
*   /*                                                               */ 05305000
*   /*****************************************************************/ 05306000
*                                                                  1395 05307000
*MVTPABM3:                                                         1395 05308000
*   DO PABPATH#=1 TO SASSDG;        /*                       @Z40LB61*/ 05309000
MVTPABM3 LA    @15,1                                               1395 05310000
         STH   @15,PABPATH#                                        1395 05311000
@DL01395 DS    0H                                                  1396 05312000
*     PABSA#=PABSA(PABPATH#)&MASK15;/*                       @ZA27324*/ 05313000
*                                                                  1396 05314000
         L     @14,PABPTR                                          1396 05315000
         SLR   @05,@05                                             1396 05316000
         IC    @05,PABSA-1(@15,@14)                                1396 05317000
         SLR   @04,@04                                             1396 05318000
         IC    @04,MASK15                                          1396 05319000
         NR    @05,@04                                             1396 05320000
         STH   @05,PABSA#                                          1396 05321000
*     /***************************************************************/ 05322000
*     /*                                                             */ 05323000
*     /* IF AN SA IS UNMATCHED, PRINT AN ERROR MESSAGE       @Z40LB61*/ 05324000
*     /*                                                             */ 05325000
*     /***************************************************************/ 05326000
*                                                                  1397 05327000
*     IF PABVLDSA(PABPATH#)=ON&     /*                       @ZA27324*/ 05328000
*         VLDSSID(PABSA#)^=NULLSSID THEN/*                   @ZA27324*/ 05329000
         ALR   @14,@15                                             1397 05330000
         TM    PABVLDSA-1(@14),B'10000000'                         1397 05331000
         BNO   @RF01397                                            1397 05332000
         LR    @04,@05                                             1397 05333000
         ALR   @04,@04                                             1397 05334000
         L     @15,@PC00001+4                                      1397 05335000
         LH    @14,VLDSSID-2(@04,@15)                              1397 05336000
         CH    @14,@CH01340                                        1397 05337000
         BE    @RF01397                                            1397 05338000
*       DO;                         /*                       @Z40LB61*/ 05339000
*         MTCHMSG=ON;               /*                       @Z40LB61*/ 05340000
         L     @14,MARGPTR(,@15)                                   1399 05341000
         OI    MTCHMSG(@14),B'00010000'                            1399 05342000
*         MVTTBL(1)=ON;             /*                       @Z40LB61*/ 05343000
         OI    MVTTBL(@14),B'10000000'                             1400 05344000
*         PABTBL(2)=ON;             /*                       @Z40LB61*/ 05345000
         OI    PABTBL+4(@14),B'00010000'                           1401 05346000
*         SAFLD=ON;                 /*                       @Z40LB61*/ 05347000
         OI    SAFLD(@14),B'00001000'                              1402 05348000
*         FLDNUM(1)=PABSA#;         /*                       @ZA27324*/ 05349000
         ST    @05,FLDNUM(,@14)                                    1403 05350000
*         SDGINDEX(2)=MVSDG;        /*                       @Z40LB61*/ 05351000
         L     @05,MVENTPTR                                        1404 05352000
         MVC   SDGINDEX+24(1,@14),MVSDG(@05)                       1404 05353000
*         LUAINDEX(2)=MV3333;       /*                       @Z40LB61*/ 05354000
         MVC   LUAINDEX+24(1,@14),MV3333(@05)                      1405 05355000
*         CHRINDEX(2)=PREVCHR;      /*                       @Z40LB61*/ 05356000
         L     @01,EARGPTR(,@15)                                   1406 05357000
         MVC   CHRINDEX+24(5,@14),PREVCHR(@01)                     1406 05358000
*         CALL IDCCH04(GDTTBL,CDALIST);/*                    @Z40LB61*/ 05359000
         L     @14,@PC00001                                        1407 05360000
         ST    @14,@AL00001                                        1407 05361000
         ST    @15,@AL00001+4                                      1407 05362000
         L     @15,@CV01495                                        1407 05363000
         LA    @01,@AL00001                                        1407 05364000
         BALR  @14,@15                                             1407 05365000
*       END;                        /*                       @Z40LB61*/ 05366000
*   END MVTPABM3;                   /*                       @Z40LB61*/ 05367000
*                                                                  1409 05368000
@RF01397 LA    @15,1                                               1409 05369000
         AH    @15,PABPATH#                                        1409 05370000
         STH   @15,PABPATH#                                        1409 05371000
         CH    @15,@CH00157                                        1409 05372000
         BNH   @DL01395                                            1409 05373000
*   /*****************************************************************/ 05374000
*   /*                                                               */ 05375000
*   /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES          @Z40LB61*/ 05376000
*   /*                                                               */ 05377000
*   /*****************************************************************/ 05378000
*                                                                  1410 05379000
*   PABTBL(1)=ON;                   /*                       @Z40LB61*/ 05380000
         L     @15,@PC00001+4                                      1410 05381000
         L     @14,MARGPTR(,@15)                                   1410 05382000
         OI    PABTBL(@14),B'00010000'                             1410 05383000
*   MVTTBL(2)=ON;                   /*                       @Z40LB61*/ 05384000
         OI    MVTTBL+4(@14),B'10000000'                           1411 05385000
*   INCNMSG=ON;                     /*                       @Z40LB61*/ 05386000
         OI    INCNMSG(@14),B'10000000'                            1412 05387000
*   SDGINDEX(1)=MVSDG;              /*                       @Z40LB61*/ 05388000
         L     @05,MVENTPTR                                        1413 05389000
         MVC   SDGINDEX(1,@14),MVSDG(@05)                          1413 05390000
*   LUAINDEX(1)=MV3333;             /*                       @Z40LB61*/ 05391000
         SLR   @04,@04                                             1414 05392000
         IC    @04,MV3333(,@05)                                    1414 05393000
         STC   @04,LUAINDEX(,@14)                                  1414 05394000
*   CHRINDEX(1)=PREVCHR;            /*                       @Z40LB61*/ 05395000
         L     @01,EARGPTR(,@15)                                   1415 05396000
         MVC   CHRINDEX(5,@14),PREVCHR(@01)                        1415 05397000
*   VSNINDEX(2)=MVVOLID;            /*                       @Z40LB61*/ 05398000
         MVC   VSNINDEX+24(6,@14),MVVOLID(@05)                     1416 05399000
*   CHRINDEX(2)=SAVECHR;            /*                       @Z40LB61*/ 05400000
         MVC   CHRINDEX+24(5,@14),SAVECHR                          1417 05401000
*   MSGNRSET=ON;                    /*                       @Z40LB61*/ 05402000
         OI    MSGNRSET(@14),B'00000001'                           1418 05403000
*   TBLNRSET(1)=ON;                 /*                       @Z40LB61*/ 05404000
         OI    TBLNRSET(@14),B'00000001'                           1419 05405000
*   TBLNRSET(2)=ON;                 /*                       @Z40LB61*/ 05406000
*                                                                  1420 05407000
         OI    TBLNRSET+4(@14),B'00000001'                         1420 05408000
*   /*****************************************************************/ 05409000
*   /*                                                               */ 05410000
*   /* CHECK THAT THE LOGICAL 3333 ADDRESS FROM THE PAB      @Z40LB61*/ 05411000
*   /* MATCHES THE 3333 ADDRESS FROM THE MVT ENTRY           @Z40LB61*/ 05412000
*   /*                                                               */ 05413000
*   /*****************************************************************/ 05414000
*                                                                  1421 05415000
*   WORK3333=MV3333/SHIFT3;         /*                       @Z40LB61*/ 05416000
         SRL   @04,3                                               1421 05417000
         STC   @04,WORK3333                                        1421 05418000
*   IF PABABOX^=L3333SSA&PABABOX^=WORK3333 THEN                    1422 05419000
         LH    @05,PABABOX                                         1422 05420000
         CH    @05,@CH00157                                        1422 05421000
         BE    @RF01422                                            1422 05422000
         CR    @05,@04                                             1422 05423000
         BE    @RF01422                                            1422 05424000
*     DO;                           /*                       @Z40LB61*/ 05425000
*       L3AFLD=ON;                  /*                       @Z40LB61*/ 05426000
         OI    L3AFLD(@14),B'00000001'                             1424 05427000
*       FLDNUM(1)=PABABOX;          /*                       @Z40LB61*/ 05428000
         ST    @05,FLDNUM(,@14)                                    1425 05429000
*       FLDNUM(2)=WORK3333;         /*                       @Z40LB61*/ 05430000
         ST    @04,FLDNUM+12(,@14)                                 1426 05431000
*       CALL IDCCH04(GDTTBL,CDALIST);/*                      @Z40LB61*/ 05432000
         L     @14,@PC00001                                        1427 05433000
         ST    @14,@AL00001                                        1427 05434000
         ST    @15,@AL00001+4                                      1427 05435000
         L     @15,@CV01495                                        1427 05436000
         LA    @01,@AL00001                                        1427 05437000
         BALR  @14,@15                                             1427 05438000
*     END;                          /*                       @Z40LB61*/ 05439000
*                                                                  1428 05440000
*   /*****************************************************************/ 05441000
*   /*                                                               */ 05442000
*   /* EXAMINE EACH VIRTUAL PAGE ENTRY OF THE CURRENT MVT    @Z40LB61*/ 05443000
*   /*                                                               */ 05444000
*   /*****************************************************************/ 05445000
*                                                                  1429 05446000
*   INACTCNT=0;                     /*                       @Z40LB61*/ 05447000
@RF01422 SLR   @15,@15                                             1429 05448000
         STH   @15,INACTCNT                                        1429 05449000
*VPLOOP1:                                                          1430 05450000
*   DO MVVP#=1 TO VPMAX;            /*                       @Z40LB61*/ 05451000
*                                                                  1430 05452000
VPLOOP1  LA    @15,1                                               1430 05453000
         STH   @15,MVVP#                                           1430 05454000
@DL01430 DS    0H                                                  1431 05455000
*     /***************************************************************/ 05456000
*     /*                                                             */ 05457000
*     /* FOR VIRTUAL PAGES THAT ARE ALLOCATED, PREPARE TO    @Z40LB61*/ 05458000
*     /* CHECK FOR CONSISTENCY WITH THE PAB                  @Z40LB61*/ 05459000
*     /*                                                             */ 05460000
*     /***************************************************************/ 05461000
*                                                                  1431 05462000
*     IF MVRPNUM(MVVP#)^=0 THEN                                    1431 05463000
         SLA   @15,2                                               1431 05464000
         L     @01,MVENTPTR                                        1431 05465000
         SLR   @14,@14                                             1431 05466000
         IC    @14,MVRPNUM-4(@15,@01)                              1431 05467000
         CH    @14,@CH00119                                        1431 05468000
         BE    @RF01431                                            1431 05469000
*PGALLOC:                                                          1432 05470000
*       DO;                         /*                       @Z40LB61*/ 05471000
PGALLOC  DS    0H                                                  1433 05472000
*         OLDERID2=NEWERID2;                                       1433 05473000
         L     @15,@PC00001                                        1433 05474000
         L     @15,GDTTR2(,@15)                                    1433 05475000
         MVC   @TS00001(95),NEWERID2(@15)                          1433 05476000
         MVC   OLDERID2(95,@15),@TS00001                           1433 05477000
*         NEWID2='CH2P';            /*                       @Z40LB61*/ 05478000
         MVC   NEWID2(4,@15),@CC01628                              1434 05479000
*         DEV#=(MVLOGDEV(MVVP#)&MASK7)+1;/*                  @Z40LB61*/ 05480000
         LA    @15,1                                               1435 05481000
         L     @14,MVENTPTR                                        1435 05482000
         LH    @05,MVVP#                                           1435 05483000
         SLA   @05,2                                               1435 05484000
         SLR   @04,@04                                             1435 05485000
         IC    @04,MVLOGDEV-4(@05,@14)                             1435 05486000
         SLR   @03,@03                                             1435 05487000
         IC    @03,MASK7                                           1435 05488000
         NR    @04,@03                                             1435 05489000
         ALR   @04,@15                                             1435 05490000
         STH   @04,DEV#                                            1435 05491000
*         LUAINDEX(1)=DEV#+MV3333-1;/*                       @Z40LB61*/ 05492000
*                                                                  1436 05493000
         L     @03,@PC00001+4                                      1436 05494000
         L     @01,MARGPTR(,@03)                                   1436 05495000
         SLR   @00,@00                                             1436 05496000
         IC    @00,MV3333(,@14)                                    1436 05497000
         ALR   @04,@00                                             1436 05498000
         BCTR  @04,0                                               1436 05499000
         STC   @04,LUAINDEX(,@01)                                  1436 05500000
*         /***********************************************************/ 05501000
*         /*                                                         */ 05502000
*         /* IF THE VIRTUAL PAGE IS INACTIVE, ADD 1 TO THE   @Z40LB61*/ 05503000
*         /* COUNT OF INACTIVE PAGES FOR THIS MVT ENTRY      @Z40LB61*/ 05504000
*         /*                                                         */ 05505000
*         /***********************************************************/ 05506000
*                                                                  1437 05507000
*         IF MVPINACT(MVVP#)=ON THEN                               1437 05508000
         ALR   @14,@05                                             1437 05509000
         TM    MVPINACT-4(@14),B'10000000'                         1437 05510000
         BNO   @RF01437                                            1437 05511000
*           INACTCNT=INACTCNT+1;    /*                       @Z40LB61*/ 05512000
*                                                                  1438 05513000
         AH    @15,INACTCNT                                        1438 05514000
         STH   @15,INACTCNT                                        1438 05515000
*         /***********************************************************/ 05516000
*         /*                                                         */ 05517000
*         /* CHECK THAT THE DEVICE# FROM THE VIRTUAL PAGE    @Z40LB61*/ 05518000
*         /* ENTRY IS A VALID STAGING DEVICE IN THE PAB      @Z40LB61*/ 05519000
*         /*                                                         */ 05520000
*         /***********************************************************/ 05521000
*                                                                  1439 05522000
*         IF(STAGEDEV&BITMASK(DEV#))^=0 THEN                       1439 05523000
@RF01437 LH    @01,DEV#                                            1439 05524000
         SLR   @00,@00                                             1439 05525000
         IC    @00,STAGEDEV                                        1439 05526000
         SLR   @15,@15                                             1439 05527000
         IC    @15,BITMASK-1(@01)                                  1439 05528000
         NR    @00,@15                                             1439 05529000
         LTR   @00,@00                                             1439 05530000
         BZ    @RF01439                                            1439 05531000
*VALIDDEV:                                                         1440 05532000
*           DO;                     /*                       @Z40LB61*/ 05533000
*                                                                  1440 05534000
VALIDDEV DS    0H                                                  1441 05535000
*             /*******************************************************/ 05536000
*             /*                                                     */ 05537000
*             /* CHECK FOR CONSISTENT 'VOLUME BOUND' STATUS. @Z40LB61*/ 05538000
*             /* IF INCONSISTENT, PRINT AN ERROR MESSAGE     @Z40LB61*/ 05539000
*             /*                                                     */ 05540000
*             /*******************************************************/ 05541000
*                                                                  1441 05542000
*             IF PABVBND(DEV#)=ON&MVBNDVOL=OFF THEN                1441 05543000
         LH    @15,DEV#                                            1441 05544000
         SLA   @15,2                                               1441 05545000
         L     @01,PABPTR                                          1441 05546000
         ALR   @01,@15                                             1441 05547000
         TM    PABVBND-4(@01),B'00000100'                          1441 05548000
         BNO   @RF01441                                            1441 05549000
         L     @01,MVENTPTR                                        1441 05550000
         TM    MVBNDVOL(@01),B'00000100'                           1441 05551000
         BNZ   @RF01441                                            1441 05552000
*               DO;                 /*                       @Z40LB61*/ 05553000
*                 VBSFLD=ON;        /*                       @Z40LB61*/ 05554000
         L     @15,@PC00001+4                                      1443 05555000
         L     @14,MARGPTR(,@15)                                   1443 05556000
         OI    VBSFLD(@14),B'00010000'                             1443 05557000
*                 FLDCHAR(1)=STATYES;/*                      @Z40LB61*/ 05558000
         MVI   FLDCHAR+3(@14),C' '                                 1444 05559000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1444 05560000
         MVC   FLDCHAR(3,@14),@CC01343                             1444 05561000
*                 FLDCHAR(2)=STATNO;/*                       @Z40LB61*/ 05562000
         MVI   FLDCHAR+15(@14),C' '                                1445 05563000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1445 05564000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1445 05565000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @Z40LB61*/ 05566000
         L     @14,@PC00001                                        1446 05567000
         ST    @14,@AL00001                                        1446 05568000
         ST    @15,@AL00001+4                                      1446 05569000
         L     @15,@CV01495                                        1446 05570000
         LA    @01,@AL00001                                        1446 05571000
         BALR  @14,@15                                             1446 05572000
*               END;                /*                       @Z40LB61*/ 05573000
*             IF PABVBND(DEV#)=OFF&MVBNDVOL=ON THEN                1448 05574000
@RF01441 LH    @15,DEV#                                            1448 05575000
         SLA   @15,2                                               1448 05576000
         L     @01,PABPTR                                          1448 05577000
         ALR   @01,@15                                             1448 05578000
         TM    PABVBND-4(@01),B'00000100'                          1448 05579000
         BNZ   @RF01448                                            1448 05580000
         L     @01,MVENTPTR                                        1448 05581000
         TM    MVBNDVOL(@01),B'00000100'                           1448 05582000
         BNO   @RF01448                                            1448 05583000
*               DO;                 /*                       @Z40LB61*/ 05584000
*                 VBSFLD=ON;        /*                       @Z40LB61*/ 05585000
         L     @15,@PC00001+4                                      1450 05586000
         L     @14,MARGPTR(,@15)                                   1450 05587000
         OI    VBSFLD(@14),B'00010000'                             1450 05588000
*                 FLDCHAR(1)=STATNO;/*                       @Z40LB61*/ 05589000
         MVI   FLDCHAR+3(@14),C' '                                 1451 05590000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1451 05591000
         MVC   FLDCHAR(3,@14),@CC01345                             1451 05592000
*                 FLDCHAR(2)=STATYES;/*                      @Z40LB61*/ 05593000
         MVI   FLDCHAR+15(@14),C' '                                1452 05594000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1452 05595000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1452 05596000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @Z40LB61*/ 05597000
         L     @14,@PC00001                                        1453 05598000
         ST    @14,@AL00001                                        1453 05599000
         ST    @15,@AL00001+4                                      1453 05600000
         L     @15,@CV01495                                        1453 05601000
         LA    @01,@AL00001                                        1453 05602000
         BALR  @14,@15                                             1453 05603000
*               END;                /*                       @Z40LB61*/ 05604000
*           END VALIDDEV;           /*                       @Z40LB61*/ 05605000
*         ELSE                                                     1456 05606000
*                                                                  1456 05607000
*           /*********************************************************/ 05608000
*           /*                                                       */ 05609000
*           /* IF THE PAB INDICATES THAT THE DEVICE IS NOT   @Z40LB61*/ 05610000
*           /* VALID OR IS NOT ONLINE, PRINT AN ERROR MESSAGE        */ 05611000
*           /*                                               @Z40LB61*/ 05612000
*           /*                                                       */ 05613000
*           /*********************************************************/ 05614000
*                                                                  1456 05615000
*           DO;                     /*                       @Z40LB61*/ 05616000
         B     @RC01439                                            1456 05617000
@RF01439 DS    0H                                                  1457 05618000
*             IF PABDEX(DEV#)=OFF THEN                             1457 05619000
         LH    @15,DEV#                                            1457 05620000
         SLA   @15,2                                               1457 05621000
         L     @01,PABPTR                                          1457 05622000
         ALR   @01,@15                                             1457 05623000
         TM    PABDEX-4(@01),B'10000000'                           1457 05624000
         BNZ   @RF01457                                            1457 05625000
*               DVSFLD=ON;          /*                       @Z40LB61*/ 05626000
         L     @15,@PC00001+4                                      1458 05627000
         L     @01,MARGPTR(,@15)                                   1458 05628000
         OI    DVSFLD(@01),B'00000100'                             1458 05629000
*             ELSE                                                 1459 05630000
*               DOSFLD=ON;          /*                       @Z40LB61*/ 05631000
         B     @RC01457                                            1459 05632000
@RF01457 L     @15,@PC00001+4                                      1459 05633000
         L     @01,MARGPTR(,@15)                                   1459 05634000
         OI    DOSFLD(@01),B'00000010'                             1459 05635000
*             FLDCHAR(1)=STATNO;    /*                       @Z40LB61*/ 05636000
@RC01457 L     @15,@PC00001+4                                      1460 05637000
         L     @14,MARGPTR(,@15)                                   1460 05638000
         MVI   FLDCHAR+3(@14),C' '                                 1460 05639000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1460 05640000
         MVC   FLDCHAR(3,@14),@CC01345                             1460 05641000
*             FLDCHAR(2)=STATYES;   /*                       @Z40LB61*/ 05642000
         MVI   FLDCHAR+15(@14),C' '                                1461 05643000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1461 05644000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1461 05645000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 05646000
         L     @14,@PC00001                                        1462 05647000
         ST    @14,@AL00001                                        1462 05648000
         ST    @15,@AL00001+4                                      1462 05649000
         L     @15,@CV01495                                        1462 05650000
         LA    @01,@AL00001                                        1462 05651000
         BALR  @14,@15                                             1462 05652000
*           END;                    /*                       @Z40LB61*/ 05653000
*       END PGALLOC;                /*                       @Z40LB61*/ 05654000
@RC01439 DS    0H                                                  1465 05655000
*   END VPLOOP1;                    /*                       @Z40LB61*/ 05656000
*                                                                  1465 05657000
@RF01431 LA    @15,1                                               1465 05658000
         AH    @15,MVVP#                                           1465 05659000
         STH   @15,MVVP#                                           1465 05660000
         CH    @15,@CH00868                                        1465 05661000
         BNH   @DL01430                                            1465 05662000
*   /*****************************************************************/ 05663000
*   /*                                                               */ 05664000
*   /* RESET 'IDCCH04' OPTION FLAGS                          @Z40LB61*/ 05665000
*   /*                                                               */ 05666000
*   /*****************************************************************/ 05667000
*                                                                  1466 05668000
*   MSGTYPE=''B;                    /*                       @Z40LB61*/ 05669000
         L     @15,@PC00001+4                                      1466 05670000
         L     @15,MARGPTR(,@15)                                   1466 05671000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1466 05672000
*   TBLTYPE(1)=''B;                 /*                       @Z40LB61*/ 05673000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1467 05674000
*   TBLTYPE(2)=''B;                 /*                       @Z40LB61*/ 05675000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1468 05676000
*   END MVTPAB;                     /*                       @Z40LB61*/ 05677000
         B     @EL00008                                            1469 05678000
*                                                                  1470 05679000
*/********************************************************************/ 05680000
*/*                                                          @Z40LB61*/ 05681000
*/* PROCEDURE NAME - MVTRPM                                  @Z40LB61*/ 05682000
*/*                                                          @Z40LB61*/ 05683000
*/* FUNCTION - THIS ROUTINE COMPARES MVT PAGE ALLOCATION     @Z40LB61*/ 05684000
*/*            DATA AGAINST RELATED DATA IN THE ASSOCIATED   @Z40LB61*/ 05685000
*/*            SDG REAL PAGE MAPS AND ASSOCIATED SA PAGE     @Z40LB61*/ 05686000
*/*            STATUS TABLE(S).                              @Z40LB61*/ 05687000
*/*                                                          @Z40LB61*/ 05688000
*/* INPUT -                                                  @Z40LB61*/ 05689000
*/*        (1) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 05690000
*/*        (2) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 05691000
*/*        (3) MSC SDG REAL PAGE MAPS                        @Z40LB61*/ 05692000
*/*        (4) SA PAGE STATUS TABLE                          @Z40LB61*/ 05693000
*/*                                                          @Z40LB61*/ 05694000
*/* OUTPUT -                                                 @Z40LB61*/ 05695000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 05696000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 05697000
*/*        (3) SDG RPM CHECK-OFF TABLE                       @Z40LB61*/ 05698000
*/*        (4) PST CHECK-OFF TABLE                           @Z40LB61*/ 05699000
*/*                                                          @Z40LB61*/ 05700000
*/********************************************************************/ 05701000
*                                                                  1470 05702000
*MVTRPM:                                                           1470 05703000
*   PROCEDURE;                      /*                       @Z40LB61*/ 05704000
MVTRPM   STM   @14,@12,@SA00009                                    1470 05705000
*   OLDERID2=NEWERID2;                                             1471 05706000
         L     @15,@PC00001                                        1471 05707000
         L     @15,GDTTR2(,@15)                                    1471 05708000
         MVC   @TS00001(95),NEWERID2(@15)                          1471 05709000
         MVC   OLDERID2(95,@15),@TS00001                           1471 05710000
*   NEWID2='CH2Q';                  /*                       @Z40LB61*/ 05711000
*                                                                  1472 05712000
         MVC   NEWID2(4,@15),@CC01634                              1472 05713000
*   /*****************************************************************/ 05714000
*   /*                                                               */ 05715000
*   /* FOR THE STAGING DRIVE GROUP OF THE CURRENT MVT ENTRY  @Z40LB61*/ 05716000
*   /* EXAMINE DATA FOR EACH LOGICAL STAGING DEVICE          @Z40LB61*/ 05717000
*   /*                                                               */ 05718000
*   /*****************************************************************/ 05719000
*                                                                  1473 05720000
*   SDG#=MVSDG+1;                   /*                       @Z40LB61*/ 05721000
         LA    @15,1                                               1473 05722000
         L     @14,MVENTPTR                                        1473 05723000
         SLR   @05,@05                                             1473 05724000
         IC    @05,MVSDG(,@14)                                     1473 05725000
         ALR   @15,@05                                             1473 05726000
         STH   @15,SDG#                                            1473 05727000
*DEVLOOP1:                                                         1474 05728000
*   DO DEV#=1 TO DEVSSDG;           /*                       @Z40LB61*/ 05729000
DEVLOOP1 LA    @15,1                                               1474 05730000
         STH   @15,DEV#                                            1474 05731000
@DL01474 DS    0H                                                  1475 05732000
*     VP1STHIT=OFF;                 /*                       @Z40LB61*/ 05733000
         NI    VP1STHIT,B'01111111'                                1475 05734000
*     IF(STAGEDEV&BITMASK(DEV#))^=0 THEN                           1476 05735000
*                                                                  1476 05736000
         SLR   @14,@14                                             1476 05737000
         IC    @14,STAGEDEV                                        1476 05738000
         SLR   @05,@05                                             1476 05739000
         IC    @05,BITMASK-1(@15)                                  1476 05740000
         NR    @14,@05                                             1476 05741000
         LTR   @14,@14                                             1476 05742000
         BZ    @RF01476                                            1476 05743000
*       /*************************************************************/ 05744000
*       /*                                                           */ 05745000
*       /* SCAN ALL THE VIRTUAL PAGES ALLOCATED TO THE       @Z40LB61*/ 05746000
*       /* MVT ENTRY, SEARCHING FOR THOSE ALLOCATED TO       @Z40LB61*/ 05747000
*       /* THE STAGING DEVICE CURRENTLY BEING EXAMINED.      @Z40LB61*/ 05748000
*       /*                                                           */ 05749000
*       /*************************************************************/ 05750000
*                                                                  1477 05751000
*VPLOOP2:                                                          1477 05752000
*       DO MVVP#=1 TO VPMAX;        /*                       @Z40LB61*/ 05753000
*                                                                  1477 05754000
VPLOOP2  LA    @15,1                                               1477 05755000
         STH   @15,MVVP#                                           1477 05756000
@DL01477 DS    0H                                                  1478 05757000
*         /***********************************************************/ 05758000
*         /*                                                         */ 05759000
*         /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES    @Z40LB61*/ 05760000
*         /*                                                         */ 05761000
*         /***********************************************************/ 05762000
*                                                                  1478 05763000
*         RPMTBL(1)=ON;             /*                       @Z40LB61*/ 05764000
         L     @14,@PC00001+4                                      1478 05765000
         L     @05,MARGPTR(,@14)                                   1478 05766000
         OI    RPMTBL(@05),B'00000010'                             1478 05767000
*         MVTTBL(2)=ON;             /*                       @Z40LB61*/ 05768000
         OI    MVTTBL+4(@05),B'10000000'                           1479 05769000
*         TBLNRSET(1)=ON;           /*                       @Z40LB61*/ 05770000
         OI    TBLNRSET(@05),B'00000001'                           1480 05771000
*         TBLNRSET(2)=ON;           /*                       @Z40LB61*/ 05772000
         OI    TBLNRSET+4(@05),B'00000001'                         1481 05773000
*         WORKDEV=(MVLOGDEV(MVVP#)&MASK7)+1;/*               @Z40LB61*/ 05774000
         LA    @04,1                                               1482 05775000
         L     @03,MVENTPTR                                        1482 05776000
         SLA   @15,2                                               1482 05777000
         SLR   @02,@02                                             1482 05778000
         IC    @02,MVLOGDEV-4(@15,@03)                             1482 05779000
         SLR   @01,@01                                             1482 05780000
         IC    @01,MASK7                                           1482 05781000
         NR    @02,@01                                             1482 05782000
         ALR   @02,@04                                             1482 05783000
         STH   @02,WORKDEV                                         1482 05784000
*         WORKRP=MVRPNUM(MVVP#)+1;  /*                       @Z40LB61*/ 05785000
*                                                                  1483 05786000
         SLR   @01,@01                                             1483 05787000
         IC    @01,MVRPNUM-4(@15,@03)                              1483 05788000
         ALR   @01,@04                                             1483 05789000
         STH   @01,WORKRP                                          1483 05790000
*         /***********************************************************/ 05791000
*         /*                                                         */ 05792000
*         /* FOR A VALID VIRTUAL PAGE ENTRY WHOSE DEVICE     @Z40LB61*/ 05793000
*         /* MATCHES, CHECK THAT THE REAL PAGE# FROM THE     @Z40LB61*/ 05794000
*         /* VP ENTRY IS WITHIN THE VALID RANGE. IF NOT,     @Z40LB61*/ 05795000
*         /* PRINT AN ERROR MESSAGE.                         @Z40LB61*/ 05796000
*         /*                                                         */ 05797000
*         /***********************************************************/ 05798000
*                                                                  1484 05799000
*         IF WORKDEV=DEV#&WORKRP^=1 THEN                           1484 05800000
         CH    @02,DEV#                                            1484 05801000
         BNE   @RF01484                                            1484 05802000
         CR    @01,@04                                             1484 05803000
         BE    @RF01484                                            1484 05804000
*           IF WORKRP>RPMAX THEN                                   1485 05805000
         CH    @01,@CH00684                                        1485 05806000
         BNH   @RF01485                                            1485 05807000
*             DO;                   /*                       @Z40LB61*/ 05808000
*               MTCHMSG=ON;         /*                       @Z40LB61*/ 05809000
         OI    MTCHMSG(@05),B'00010000'                            1487 05810000
*               RPFLD=ON;           /*                       @Z40LB61*/ 05811000
         OI    RPFLD(@05),B'00100000'                              1488 05812000
*               FLDNUM(1)=WORKRP-1; /*                       @Z40LB61*/ 05813000
         BCTR  @01,0                                               1489 05814000
         ST    @01,FLDNUM(,@05)                                    1489 05815000
*               CALL IDCCH04(GDTTBL,CDALIST);/*              @Z40LB61*/ 05816000
         L     @15,@PC00001                                        1490 05817000
         ST    @15,@AL00001                                        1490 05818000
         ST    @14,@AL00001+4                                      1490 05819000
         L     @15,@CV01495                                        1490 05820000
         LA    @01,@AL00001                                        1490 05821000
         BALR  @14,@15                                             1490 05822000
*             END;                  /*                       @Z40LB61*/ 05823000
*           ELSE                                                   1492 05824000
*                                                                  1492 05825000
*             /*******************************************************/ 05826000
*             /*                                                     */ 05827000
*             /* FOR A VALID VP ENTRY WITH A GOOD REAL       @Z40LB61*/ 05828000
*             /* PAGE#, FIRST DO COMMON SET-UP FOR           @Z40LB61*/ 05829000
*             /* POSSIBLE ERROR MESSAGES.                    @Z40LB61*/ 05830000
*             /*                                                     */ 05831000
*             /*******************************************************/ 05832000
*                                                                  1492 05833000
*GOODPAGE:                                                         1492 05834000
*             DO;                   /*                       @Z40LB61*/ 05835000
         B     @RC01485                                            1492 05836000
@RF01485 DS    0H                                                  1492 05837000
GOODPAGE DS    0H                                                  1493 05838000
*               OLDERID2=NEWERID2;                                 1493 05839000
         L     @15,@PC00001                                        1493 05840000
         L     @14,GDTTR2(,@15)                                    1493 05841000
         MVC   @TS00001(95),NEWERID2(@14)                          1493 05842000
         MVC   OLDERID2(95,@14),@TS00001                           1493 05843000
*               NEWID2='CH2R';      /*                       @Z40LB61*/ 05844000
         MVC   NEWID2(4,@14),@CC01641                              1494 05845000
*               INCNMSG=ON;         /*                       @Z40LB61*/ 05846000
         L     @14,@PC00001+4                                      1495 05847000
         L     @05,MARGPTR(,@14)                                   1495 05848000
         OI    INCNMSG(@05),B'10000000'                            1495 05849000
*               SDGINDEX(1)=MVSDG;  /*                       @Z40LB61*/ 05850000
         L     @04,MVENTPTR                                        1496 05851000
         SLR   @03,@03                                             1496 05852000
         IC    @03,MVSDG(,@04)                                     1496 05853000
         STC   @03,SDGINDEX(,@05)                                  1496 05854000
*               LUAINDEX(1)=DEV#+MV3333-1;/*                 @Z40LB61*/ 05855000
         LH    @02,DEV#                                            1497 05856000
         SLR   @01,@01                                             1497 05857000
         IC    @01,MV3333(,@04)                                    1497 05858000
         ALR   @01,@02                                             1497 05859000
         BCTR  @01,0                                               1497 05860000
         STC   @01,LUAINDEX(,@05)                                  1497 05861000
*               RPINDEX(1)=WORKRP-1;/*                       @Z40LB61*/ 05862000
         LH    @04,WORKRP                                          1498 05863000
         BCTR  @04,0                                               1498 05864000
         STC   @04,RPINDEX(,@05)                                   1498 05865000
*               MSGNRSET=ON;        /*                       @Z40LB61*/ 05866000
*                                                                  1499 05867000
         OI    MSGNRSET(@05),B'00000001'                           1499 05868000
*               /*****************************************************/ 05869000
*               /*                                                   */ 05870000
*               /* WHEN THE FIRST VIRTUAL PAGE ENTRY IS      @Z40LB61*/ 05871000
*               /* FOUND CORRESPONDING TO THE CURRENT        @Z40LB61*/ 05872000
*               /* DEVICE, OBTAIN THE REAL PAGE MAP (RPM)    @Z40LB61*/ 05873000
*               /* FOR THAT DEVICE.                          @Z40LB61*/ 05874000
*               /*                                                   */ 05875000
*               /*****************************************************/ 05876000
*                                                                  1500 05877000
*               IF VP1STHIT=OFF THEN                               1500 05878000
         TM    VP1STHIT,B'10000000'                                1500 05879000
         BNZ   @RF01500                                            1500 05880000
*                 DO;               /*                       @Z40LB61*/ 05881000
*                   VP1STHIT=ON;    /*                       @Z40LB61*/ 05882000
         OI    VP1STHIT,B'10000000'                                1502 05883000
*                   TABLEID=SDGTBLID;/*                      @Z40LB61*/ 05884000
         L     @05,EARGPTR(,@14)                                   1503 05885000
         MVC   TABLEID(1,@05),SDGTBLID                             1503 05886000
*                   RPMFLAG=ON;     /*                       @Z40LB61*/ 05887000
         OI    RPMFLAG(@05),B'10000000'                            1504 05888000
*                   SDGNUM=MVSDG;   /*                       @Z40LB61*/ 05889000
         STH   @03,SDGNUM(,@05)                                    1505 05890000
*                   DEVICEID=DEV#-1;/*                       @Z40LB61*/ 05891000
         BCTR  @02,0                                               1506 05892000
         STH   @02,DEVICEID(,@05)                                  1506 05893000
*                   CALL IDCCH03(GDTTBL,CDALIST);/*          @Z40LB61*/ 05894000
         ST    @15,@AL00001                                        1507 05895000
         ST    @14,@AL00001+4                                      1507 05896000
         L     @15,@CV01494                                        1507 05897000
         LA    @01,@AL00001                                        1507 05898000
         BALR  @14,@15                                             1507 05899000
*                   IF GETRC^=0 THEN                               1508 05900000
         L     @15,@PC00001+4                                      1508 05901000
         L     @01,EARGPTR(,@15)                                   1508 05902000
         ICM   @00,3,GETRC(@01)                                    1508 05903000
         BZ    @RF01508                                            1508 05904000
*                     DO;           /*                       @Z40LB61*/ 05905000
*                       LASTCOND=LASTCC12;/*                 @Z40LB61*/ 05906000
         L     @15,@PC00001+8                                      1510 05907000
         MVC   LASTCOND(2,@15),@CH00567                            1510 05908000
*                       RETURN;     /*                       @Z40LB61*/ 05909000
@EL00009 DS    0H                                                  1511 05910000
@EF00009 DS    0H                                                  1511 05911000
@ER00009 LM    @14,@12,@SA00009                                    1511 05912000
         BR    @14                                                 1511 05913000
*                     END;          /*                       @Z40LB61*/ 05914000
*                   RPMPTR=TBLADDR; /*                       @Z40LB61*/ 05915000
@RF01508 L     @15,@PC00001+4                                      1513 05916000
         L     @14,EARGPTR(,@15)                                   1513 05917000
         MVC   RPMPTR(4),TBLADDR(@14)                              1513 05918000
*                   CHRINDEX(1)=PREVCHR;/*                   @Z40LB61*/ 05919000
         L     @01,MARGPTR(,@15)                                   1514 05920000
         MVC   CHRINDEX(5,@01),PREVCHR(@14)                        1514 05921000
*                 END;              /*                       @Z40LB61*/ 05922000
*                                                                  1515 05923000
*               /*****************************************************/ 05924000
*               /*                                                   */ 05925000
*               /* CHECK-OFF THE REAL PAGE MAP ENTRY THAT    @Z40LB61*/ 05926000
*               /* CORRESPONDS TO THE REAL PAGE#             @Z40LB61*/ 05927000
*               /*                                                   */ 05928000
*               /*****************************************************/ 05929000
*                                                                  1516 05930000
*               BYTE#=(WORKRP-1)/8+1;/*                      @Z40LB61*/ 05931000
@RF01500 L     @15,@PC00001+4                                      1516 05932000
         L     @14,EARGPTR(,@15)                                   1516 05933000
         LA    @05,1                                               1516 05934000
         LH    @04,WORKRP                                          1516 05935000
         LR    @03,@04                                             1516 05936000
         BCTR  @03,0                                               1516 05937000
         LR    @00,@03                                             1516 05938000
         SRDA  @00,32                                              1516 05939000
         D     @00,@CF00183                                        1516 05940000
         ALR   @01,@05                                             1516 05941000
         STH   @01,BYTE#(,@14)                                     1516 05942000
*               BIT#=(WORKRP-1)//8+1;/*                      @Z40LB61*/ 05943000
         LR    @00,@03                                             1517 05944000
         ST    @01,@TF00001                                        1517 05945000
         SRDA  @00,32                                              1517 05946000
         D     @00,@CF00183                                        1517 05947000
         ALR   @00,@05                                             1517 05948000
         STH   @00,BIT#(,@14)                                      1517 05949000
*               RPMCHKFF(SDG#,DEV#,BYTE#)=RPMCHKFF(SDG#,DEV#,BYTE#)|    05950000
*                   BITMASK(BIT#);  /*                       @Z40LB61*/ 05951000
*                                                                  1518 05952000
         LH    @01,SDG#                                            1518 05953000
         SLA   @01,3                                               1518 05954000
         AH    @01,DEV#                                            1518 05955000
         MH    @01,@CH00769                                        1518 05956000
         AL    @01,@TF00001                                        1518 05957000
         L     @14,RPMCOPTR(,@15)                                  1518 05958000
         ALR   @14,@01                                             1518 05959000
         AL    @14,@CF01767                                        1518 05960000
         LR    @01,@00                                             1518 05961000
         LA    @05,BITMASK-1(@01)                                  1518 05962000
         OC    RPMCHKFF(1,@14),0(@05)                              1518 05963000
*               /*****************************************************/ 05964000
*               /*                                                   */ 05965000
*               /* CHECK VIRTUAL PAGE#'S FOR CONSISTENCY.    @Z40LB61*/ 05966000
*               /* IF INCONSISTENT, PRINT AN ERROR MESSAGE   @Z40LB61*/ 05967000
*               /*                                                   */ 05968000
*               /*****************************************************/ 05969000
*                                                                  1519 05970000
*               IF RPMVPNUM(WORKRP)^=MVVP#-1 THEN                  1519 05971000
         SLA   @04,2                                               1519 05972000
         L     @01,RPMPTR                                          1519 05973000
         AL    @01,@CF01766                                        1519 05974000
         SLR   @05,@05                                             1519 05975000
         IC    @05,RPMVPNUM-1(@04,@01)                             1519 05976000
         LH    @04,MVVP#                                           1519 05977000
         BCTR  @04,0                                               1519 05978000
         CR    @05,@04                                             1519 05979000
         BE    @RF01519                                            1519 05980000
*                 DO;               /*                       @Z40LB61*/ 05981000
*                   VPFLD=ON;       /*                       @Z40LB61*/ 05982000
         L     @14,MARGPTR(,@15)                                   1521 05983000
         OI    VPFLD(@14),B'00100000'                              1521 05984000
*                   FLDNUM(1)=RPMVPNUM(WORKRP);/*            @Z40LB61*/ 05985000
         ST    @05,FLDNUM(,@14)                                    1522 05986000
*                   FLDNUM(2)=MVVP#-1;/*                     @Z40LB61*/ 05987000
         ST    @04,FLDNUM+12(,@14)                                 1523 05988000
*                   CALL IDCCH04(GDTTBL,CDALIST);/*          @Z40LB61*/ 05989000
         L     @14,@PC00001                                        1524 05990000
         ST    @14,@AL00001                                        1524 05991000
         ST    @15,@AL00001+4                                      1524 05992000
         L     @15,@CV01495                                        1524 05993000
         LA    @01,@AL00001                                        1524 05994000
         BALR  @14,@15                                             1524 05995000
*                 END;              /*                       @Z40LB61*/ 05996000
*                                                                  1525 05997000
*               /*****************************************************/ 05998000
*               /*                                                   */ 05999000
*               /* CHECK MVT POINTERS FOR CONSISTENCY.       @Z40LB61*/ 06000000
*               /* IF INCONSISTENT, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 06001000
*               /*                                                   */ 06002000
*               /*****************************************************/ 06003000
*                                                                  1526 06004000
*               IF RPMMVT(WORKRP)^=SAVEREC#-1 THEN                 1526 06005000
@RF01519 LH    @15,WORKRP                                          1526 06006000
         SLA   @15,2                                               1526 06007000
         L     @01,RPMPTR                                          1526 06008000
         ALR   @01,@15                                             1526 06009000
         AL    @01,@CF01760                                        1526 06010000
         SLR   @15,@15                                             1526 06011000
         ICM   @15,3,RPMMVT-2(@01)                                 1526 06012000
         LH    @14,SAVEREC#                                        1526 06013000
         BCTR  @14,0                                               1526 06014000
         CR    @15,@14                                             1526 06015000
         BE    @RF01526                                            1526 06016000
*                 DO;               /*                       @Z40LB61*/ 06017000
*                   MVTPFLD=ON;     /*                       @Z40LB61*/ 06018000
         L     @05,@PC00001+4                                      1528 06019000
         L     @04,MARGPTR(,@05)                                   1528 06020000
         OI    MVTPFLD(@04),B'00100000'                            1528 06021000
*                   FLDNUM(1)=RPMMVT(WORKRP);/*              @Z40LB61*/ 06022000
         ST    @15,FLDNUM(,@04)                                    1529 06023000
*                   FLDNUM(2)=SAVEREC#-1;/*                  @Z40LB61*/ 06024000
         ST    @14,FLDNUM+12(,@04)                                 1530 06025000
*                   CALL IDCCH04(GDTTBL,CDALIST);/*          @Z40LB61*/ 06026000
         L     @04,@PC00001                                        1531 06027000
         ST    @04,@AL00001                                        1531 06028000
         ST    @05,@AL00001+4                                      1531 06029000
         L     @15,@CV01495                                        1531 06030000
         LA    @01,@AL00001                                        1531 06031000
         BALR  @14,@15                                             1531 06032000
*                 END;              /*                       @Z40LB61*/ 06033000
*                                                                  1532 06034000
*               /*****************************************************/ 06035000
*               /*                                                   */ 06036000
*               /* CHECK 'BOUND VOLUME' STATUS CONSISTENCY.  @Z40LB61*/ 06037000
*               /* IF INCONSISTENT, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 06038000
*               /*                                                   */ 06039000
*               /*****************************************************/ 06040000
*                                                                  1533 06041000
*               IF RPMVBND(WORKRP)=ON THEN                         1533 06042000
@RF01526 LH    @15,WORKRP                                          1533 06043000
         SLA   @15,2                                               1533 06044000
         L     @01,RPMPTR                                          1533 06045000
         ALR   @01,@15                                             1533 06046000
         AL    @01,@CF01761                                        1533 06047000
         TM    RPMVBND(@01),B'00010000'                            1533 06048000
         BNO   @RF01533                                            1533 06049000
*                 IF MVBNDVOL=OFF THEN                             1534 06050000
         L     @01,MVENTPTR                                        1534 06051000
         TM    MVBNDVOL(@01),B'00000100'                           1534 06052000
         BNZ   @RF01534                                            1534 06053000
*                   DO;             /*                       @Z40LB61*/ 06054000
*                     VBSFLD=ON;    /*                       @Z40LB61*/ 06055000
         L     @15,@PC00001+4                                      1536 06056000
         L     @14,MARGPTR(,@15)                                   1536 06057000
         OI    VBSFLD(@14),B'00010000'                             1536 06058000
*                     FLDCHAR(1)=STATYES;/*                  @Z40LB61*/ 06059000
         MVI   FLDCHAR+3(@14),C' '                                 1537 06060000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1537 06061000
         MVC   FLDCHAR(3,@14),@CC01343                             1537 06062000
*                     FLDCHAR(2)=STATNO;/*                   @Z40LB61*/ 06063000
         MVI   FLDCHAR+15(@14),C' '                                1538 06064000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1538 06065000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1538 06066000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB61*/ 06067000
         L     @14,@PC00001                                        1539 06068000
         ST    @14,@AL00001                                        1539 06069000
         ST    @15,@AL00001+4                                      1539 06070000
         L     @15,@CV01495                                        1539 06071000
         LA    @01,@AL00001                                        1539 06072000
         BALR  @14,@15                                             1539 06073000
*                   END;            /*                       @Z40LB61*/ 06074000
*                 ELSE                                             1541 06075000
*                   ;               /*                       @Z40LB61*/ 06076000
@RF01534 DS    0H                                                  1542 06077000
*               ELSE                                               1542 06078000
*                 IF MVBNDVOL=ON THEN                              1542 06079000
         B     @RC01533                                            1542 06080000
@RF01533 L     @01,MVENTPTR                                        1542 06081000
         TM    MVBNDVOL(@01),B'00000100'                           1542 06082000
         BNO   @RF01542                                            1542 06083000
*                   DO;             /*                       @Z40LB61*/ 06084000
*                     VBSFLD=ON;    /*                       @Z40LB61*/ 06085000
         L     @15,@PC00001+4                                      1544 06086000
         L     @14,MARGPTR(,@15)                                   1544 06087000
         OI    VBSFLD(@14),B'00010000'                             1544 06088000
*                     FLDCHAR(1)=STATNO;/*                   @Z40LB61*/ 06089000
         MVI   FLDCHAR+3(@14),C' '                                 1545 06090000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1545 06091000
         MVC   FLDCHAR(3,@14),@CC01345                             1545 06092000
*                     FLDCHAR(2)=STATYES;/*                  @Z40LB61*/ 06093000
         MVI   FLDCHAR+15(@14),C' '                                1546 06094000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1546 06095000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1546 06096000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB61*/ 06097000
         L     @14,@PC00001                                        1547 06098000
         ST    @14,@AL00001                                        1547 06099000
         ST    @15,@AL00001+4                                      1547 06100000
         L     @15,@CV01495                                        1547 06101000
         LA    @01,@AL00001                                        1547 06102000
         BALR  @14,@15                                             1547 06103000
*                   END;            /*                       @Z40LB61*/ 06104000
*                 ELSE                                             1549 06105000
*                                                                  1549 06106000
*                   /*************************************************/ 06107000
*                   /*                                               */ 06108000
*                   /* IF BOTH TABLES INDICATE THAT THIS     @Z40LB61*/ 06109000
*                   /* PAGE ISN'T FOR A BOUND VOLUME, CHECK  @Z40LB61*/ 06110000
*                   /* FOR INCONSISTENT PAGE ATTRIBUTES.     @Z40LB61*/ 06111000
*                   /* IF INCONSISTENT, PRINT AN ERROR MSG   @Z40LB61*/ 06112000
*                   /*                                               */ 06113000
*                   /*************************************************/ 06114000
*                                                                  1549 06115000
*PGSTATUS:                                                         1549 06116000
*                   DO;             /*                       @Z40LB61*/ 06117000
         B     @RC01542                                            1549 06118000
@RF01542 DS    0H                                                  1549 06119000
PGSTATUS DS    0H                                                  1550 06120000
*                     MATCHED=OFF;  /*                       @Z40LB61*/ 06121000
         NI    MATCHED,B'01111111'                                 1550 06122000
*                     IF MVPINACT(MVVP#)=ON THEN                   1551 06123000
         LH    @15,MVVP#                                           1551 06124000
         SLA   @15,2                                               1551 06125000
         L     @01,MVENTPTR                                        1551 06126000
         ALR   @01,@15                                             1551 06127000
         TM    MVPINACT-4(@01),B'10000000'                         1551 06128000
         BNO   @RF01551                                            1551 06129000
*                       IF RPMINACT(WORKRP)=OFF THEN               1552 06130000
         LH    @15,WORKRP                                          1552 06131000
         SLA   @15,2                                               1552 06132000
         L     @01,RPMPTR                                          1552 06133000
         ALR   @01,@15                                             1552 06134000
         AL    @01,@CF01761                                        1552 06135000
         TM    RPMINACT(@01),B'01000000'                           1552 06136000
         BNZ   @RF01552                                            1552 06137000
*                         IPASFLD=ON;/*                      @Z40LB61*/ 06138000
         L     @15,@PC00001+4                                      1553 06139000
         L     @01,MARGPTR(,@15)                                   1553 06140000
         OI    IPASFLD(@01),B'00001000'                            1553 06141000
*                       ELSE                                       1554 06142000
*                         MATCHED=ON;/*                      @Z40LB61*/ 06143000
         B     @RC01552                                            1554 06144000
@RF01552 OI    MATCHED,B'10000000'                                 1554 06145000
*                     ELSE                                         1555 06146000
*                       IF MVBNDCNT(MVVP#)>0 THEN                  1555 06147000
         B     @RC01551                                            1555 06148000
@RF01551 LH    @15,MVVP#                                           1555 06149000
         SLA   @15,2                                               1555 06150000
         L     @01,MVENTPTR                                        1555 06151000
         SLR   @14,@14                                             1555 06152000
         IC    @14,MVBNDCNT-4(@15,@01)                             1555 06153000
         CH    @14,@CH00119                                        1555 06154000
         BNH   @RF01555                                            1555 06155000
*                         IF RPMBND(WORKRP)=OFF THEN               1556 06156000
         LH    @15,WORKRP                                          1556 06157000
         SLA   @15,2                                               1556 06158000
         L     @01,RPMPTR                                          1556 06159000
         ALR   @01,@15                                             1556 06160000
         AL    @01,@CF01761                                        1556 06161000
         TM    RPMBND(@01),B'00100000'                             1556 06162000
         BNZ   @RF01556                                            1556 06163000
*                           BPASFLD=ON;/*                    @Z40LB61*/ 06164000
         L     @15,@PC00001+4                                      1557 06165000
         L     @01,MARGPTR(,@15)                                   1557 06166000
         OI    BPASFLD(@01),B'00001000'                            1557 06167000
*                         ELSE                                     1558 06168000
*                           MATCHED=ON;/*                    @Z40LB61*/ 06169000
         B     @RC01556                                            1558 06170000
@RF01556 OI    MATCHED,B'10000000'                                 1558 06171000
*                       ELSE                                       1559 06172000
*                         IF RPMACT(WORKRP)=OFF THEN               1559 06173000
         B     @RC01555                                            1559 06174000
@RF01555 LH    @15,WORKRP                                          1559 06175000
         SLA   @15,2                                               1559 06176000
         L     @01,RPMPTR                                          1559 06177000
         ALR   @01,@15                                             1559 06178000
         AL    @01,@CF01761                                        1559 06179000
         TM    RPMACT(@01),B'10000000'                             1559 06180000
         BNZ   @RF01559                                            1559 06181000
*                           APASFLD=ON;/*                    @Z40LB61*/ 06182000
         L     @15,@PC00001+4                                      1560 06183000
         L     @01,MARGPTR(,@15)                                   1560 06184000
         OI    APASFLD(@01),B'00010000'                            1560 06185000
*                         ELSE                                     1561 06186000
*                           MATCHED=ON;/*                    @Z40LB61*/ 06187000
         B     @RC01559                                            1561 06188000
@RF01559 OI    MATCHED,B'10000000'                                 1561 06189000
*                     IF MATCHED=OFF THEN                          1562 06190000
@RC01559 DS    0H                                                  1562 06191000
@RC01555 DS    0H                                                  1562 06192000
@RC01551 TM    MATCHED,B'10000000'                                 1562 06193000
         BNZ   @RF01562                                            1562 06194000
*                       DO;         /*                       @Z40LB61*/ 06195000
*                         FLDCHAR(1)=STATNO;/*               @Z40LB61*/ 06196000
         L     @15,@PC00001+4                                      1564 06197000
         L     @14,MARGPTR(,@15)                                   1564 06198000
         MVI   FLDCHAR+3(@14),C' '                                 1564 06199000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1564 06200000
         MVC   FLDCHAR(3,@14),@CC01345                             1564 06201000
*                         FLDCHAR(2)=STATYES;/*              @Z40LB61*/ 06202000
         MVI   FLDCHAR+15(@14),C' '                                1565 06203000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1565 06204000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1565 06205000
*                         CALL IDCCH04(GDTTBL,CDALIST);/*    @Z40LB61*/ 06206000
         L     @14,@PC00001                                        1566 06207000
         ST    @14,@AL00001                                        1566 06208000
         ST    @15,@AL00001+4                                      1566 06209000
         L     @15,@CV01495                                        1566 06210000
         LA    @01,@AL00001                                        1566 06211000
         BALR  @14,@15                                             1566 06212000
*                       END;        /*                       @Z40LB61*/ 06213000
*                   END PGSTATUS;   /*                       @Z40LB61*/ 06214000
*                                                                  1568 06215000
@RF01562 DS    0H                                                  1569 06216000
*               /*****************************************************/ 06217000
*               /*                                                   */ 06218000
*               /* RESET 'IDCCH04' OPTION FLAGS              @Z40LB61*/ 06219000
*               /*                                                   */ 06220000
*               /*****************************************************/ 06221000
*                                                                  1569 06222000
*               MSGTYPE=''B;        /*                       @Z40LB61*/ 06223000
@RC01542 DS    0H                                                  1569 06224000
@RC01533 L     @15,@PC00001+4                                      1569 06225000
         L     @14,MARGPTR(,@15)                                   1569 06226000
         XC    MSGTYPE(4,@14),MSGTYPE(@14)                         1569 06227000
*               TBLTYPE(1)=''B;     /*                       @Z40LB61*/ 06228000
         XC    TBLTYPE(4,@14),TBLTYPE(@14)                         1570 06229000
*               TBLTYPE(2)=''B;     /*                       @Z40LB61*/ 06230000
*                                                                  1571 06231000
         XC    TBLTYPE+4(4,@14),TBLTYPE+4(@14)                     1571 06232000
*               /*****************************************************/ 06233000
*               /*                                                   */ 06234000
*               /* IF SA CHECKING WAS REQUESTED, THE MVT IS  @Z40LB61*/ 06235000
*               /* FOR A MOUNTED VOLUME, THE VIRTUAL PAGE    @Z40LB61*/ 06236000
*               /* IS NOT AN INACTIVE PAGE, AND THE MVT      @Z40LB61*/ 06237000
*               /* VP ENTRY SHOWS THAT THERE ARE SOME VALID  @Z40LB61*/ 06238000
*               /* CYLINDERS ALLOCATED, THEN COMPARE PAGE    @Z40LB61*/ 06239000
*               /* DATA WITH THE PAGE STATUS TABLE (PST)     @Z40LB61*/ 06240000
*               /* FOR EACH VALID SA FOR THIS MVT ENTRY.     @Z40LB61*/ 06241000
*               /*                                                   */ 06242000
*               /*****************************************************/ 06243000
*                                                                  1572 06244000
*               IF SACHK=ON&MVMNTVOL=ON&MVPINACT(MVVP#)=OFF&MVCYLMAP(   06245000
*                   MVVP#)^=0 THEN                                 1572 06246000
         TM    SACHK(@15),B'01000000'                              1572 06247000
         BNO   @RF01572                                            1572 06248000
         L     @15,MVENTPTR                                        1572 06249000
         TM    MVMNTVOL(@15),B'10000000'                           1572 06250000
         BNO   @RF01572                                            1572 06251000
         LH    @14,MVVP#                                           1572 06252000
         SLA   @14,2                                               1572 06253000
         ST    @14,@TF00001                                        1572 06254000
         ALR   @14,@15                                             1572 06255000
         TM    MVPINACT-4(@14),B'10000000'                         1572 06256000
         BNZ   @RF01572                                            1572 06257000
         L     @14,@TF00001                                        1572 06258000
         SLR   @05,@05                                             1572 06259000
         IC    @05,MVCYLMAP-4(@14,@15)                             1572 06260000
         CH    @05,@CH00119                                        1572 06261000
         BE    @RF01572                                            1572 06262000
*PSTCHK:                                                           1573 06263000
*                 DO MVPATH#=1 TO SASSDG;/*                  @Z40LB61*/ 06264000
PSTCHK   LA    @15,1                                               1573 06265000
         STH   @15,MVPATH#                                         1573 06266000
@DL01573 DS    0H                                                  1574 06267000
*                   MVSA#=MVSA(MVPATH#)&MASK15;/*            @Z40LB61*/ 06268000
         L     @14,MVENTPTR                                        1574 06269000
         SLA   @15,3                                               1574 06270000
         SLR   @05,@05                                             1574 06271000
         IC    @05,MVSA-8(@15,@14)                                 1574 06272000
         SLR   @04,@04                                             1574 06273000
         IC    @04,MASK15                                          1574 06274000
         NR    @05,@04                                             1574 06275000
         STH   @05,MVSA#                                           1574 06276000
*                   SA#=MVSA#+1;    /*                       @Z40LB61*/ 06277000
         LA    @04,1                                               1575 06278000
         ALR   @05,@04                                             1575 06279000
         STH   @05,SA#                                             1575 06280000
*                   WORK3333=MV3333/SHIFT3+1;/*              @Z40LB61*/ 06281000
*                                                                  1576 06282000
         SLR   @03,@03                                             1576 06283000
         IC    @03,MV3333(,@14)                                    1576 06284000
         SRL   @03,3                                               1576 06285000
         ALR   @03,@04                                             1576 06286000
         STC   @03,WORK3333                                        1576 06287000
*                   /*************************************************/ 06288000
*                   /*                                               */ 06289000
*                   /* FOR A VALID SA WITH A NON-ZERO VVA    @ZA13059*/ 06290000
*                   /* IN THE PST, CHECK OFF THE PST         @ZA13059*/ 06291000
*                   /* ENTRY FOR THE CURRENT REAL PAGE#      @Z40LB61*/ 06292000
*                   /*                                               */ 06293000
*                   /*************************************************/ 06294000
*                                                                  1577 06295000
*                   IF MVVLDSA(MVPATH#)=ON&IPSTPTR(SA#)^=NULLPTR&/*     06296000
*                                                            @ZA13059*/ 06297000
*                       IPSTPTR(SA#)^=DUMMYPTR&/*            @ZA27324*/ 06298000
*                       IPSTVVA(WORK3333,DEV#,WORKRP)^=0/*   @ZA13059*/ 06299000
*                     THEN          /*                       @ZA13059*/ 06300000
         ALR   @14,@15                                             1577 06301000
         TM    MVVLDSA-8(@14),B'10000000'                          1577 06302000
         BNO   @RF01577                                            1577 06303000
         SLR   @04,@04                                             1577 06304000
         SLA   @05,2                                               1577 06305000
         L     @02,@PC00001+4                                      1577 06306000
         L     @05,IPSTPTR-4(@05,@02)                              1577 06307000
         CR    @05,@04                                             1577 06308000
         BE    @RF01577                                            1577 06309000
         C     @05,DUMMYPTR                                        1577 06310000
         BE    @RF01577                                            1577 06311000
         SLA   @03,3                                               1577 06312000
         AH    @03,DEV#                                            1577 06313000
         MH    @03,@CH00684                                        1577 06314000
         AH    @03,WORKRP                                          1577 06315000
         ALR   @03,@03                                             1577 06316000
         AL    @05,@CF01768                                        1577 06317000
         SLR   @02,@02                                             1577 06318000
         IC    @02,IPSTVVA(@03,@05)                                1577 06319000
         CR    @04,@02                                             1577 06320000
         BE    @RF01577                                            1577 06321000
*MVTPSTM:                                                          1578 06322000
*                     DO;           /*                       @Z40LB61*/ 06323000
MVTPSTM  DS    0H                                                  1579 06324000
*                       PSTCHKFF(WORK3333,DEV#,BYTE#)=PSTCHKFF(WORK3333 06325000
*                           ,DEV#,BYTE#)|BITMASK(BIT#);/*    @Z40LB61*/ 06326000
*                                                                  1579 06327000
         LH    @15,DEV#                                            1579 06328000
         SLR   @14,@14                                             1579 06329000
         IC    @14,WORK3333                                        1579 06330000
         SLA   @14,3                                               1579 06331000
         ALR   @14,@15                                             1579 06332000
         LR    @05,@14                                             1579 06333000
         MH    @05,@CH00769                                        1579 06334000
         L     @04,@PC00001+4                                      1579 06335000
         L     @03,EARGPTR(,@04)                                   1579 06336000
         AH    @05,BYTE#(,@03)                                     1579 06337000
         LH    @02,SA#                                             1579 06338000
         SLA   @02,2                                               1579 06339000
         L     @01,PSTCOPTR-4(@02,@04)                             1579 06340000
         ALR   @01,@05                                             1579 06341000
         AL    @01,@CF01767                                        1579 06342000
         LH    @03,BIT#(,@03)                                      1579 06343000
         LA    @05,BITMASK-1(@03)                                  1579 06344000
         OC    PSTCHKFF(1,@01),0(@05)                              1579 06345000
*                       /*********************************************/ 06346000
*                       /*                                           */ 06347000
*                       /* DO COMMON SET-UP FOR POSSIBLE     @Z40LB61*/ 06348000
*                       /* ERROR MESSAGES                    @Z40LB61*/ 06349000
*                       /*                                           */ 06350000
*                       /*********************************************/ 06351000
*                                                                  1580 06352000
*                       PSTTBL(1)=ON;/*                      @Z40LB61*/ 06353000
         L     @03,MARGPTR(,@04)                                   1580 06354000
         OI    PSTTBL(@03),B'10000000'                             1580 06355000
*                       MVTTBL(2)=ON;/*                      @Z40LB61*/ 06356000
         OI    MVTTBL+4(@03),B'10000000'                           1581 06357000
*                       INCNMSG=ON; /*                       @Z40LB61*/ 06358000
         OI    INCNMSG(@03),B'10000000'                            1582 06359000
*                       SAINDEX(1)=MVSA#;/*                  @Z40LB61*/ 06360000
         MVC   SAINDEX(1,@03),MVSA#+1                              1583 06361000
*                       LUAINDEX(1)=DEV#+MV3333-1;/*         @Z40LB61*/ 06362000
         L     @05,MVENTPTR                                        1584 06363000
         SLR   @01,@01                                             1584 06364000
         IC    @01,MV3333(,@05)                                    1584 06365000
         ALR   @15,@01                                             1584 06366000
         BCTR  @15,0                                               1584 06367000
         STC   @15,LUAINDEX(,@03)                                  1584 06368000
*                       RPINDEX(1)=WORKRP-1;/*               @Z40LB61*/ 06369000
         LH    @15,WORKRP                                          1585 06370000
         LR    @01,@15                                             1585 06371000
         BCTR  @01,0                                               1585 06372000
         STC   @01,RPINDEX(,@03)                                   1585 06373000
*                       MSGNRSET=ON;/*                       @Z40LB61*/ 06374000
         OI    MSGNRSET(@03),B'00000001'                           1586 06375000
*                       TBLNRSET(1)=ON;/*                    @Z40LB61*/ 06376000
         OI    TBLNRSET(@03),B'00000001'                           1587 06377000
*                       TBLNRSET(2)=ON;/*                    @Z40LB61*/ 06378000
*                                                                  1588 06379000
         OI    TBLNRSET+4(@03),B'00000001'                         1588 06380000
*                       /*********************************************/ 06381000
*                       /*                                           */ 06382000
*                       /* THE VVA'S SHOULD MATCH BETWEEN    @Z40LB61*/ 06383000
*                       /* MVT AND PST FOR ACTIVE SA'S.      @Z40LB61*/ 06384000
*                       /* IF NOT, PRINT AN ERROR MESSAGE.   @Z40LB61*/ 06385000
*                       /*                                           */ 06386000
*                       /*********************************************/ 06387000
*                                                                  1589 06388000
*                       IF ACTIVSA(MVPATH#)=ON&IPSTVVA(WORK3333,DEV#,   06389000
*                           WORKRP)^=MVVVA(MVPATH#) THEN           1589 06390000
         LH    @01,MVPATH#                                         1589 06391000
         LA    @15,ACTIVSA-1(@01)                                  1589 06392000
         TM    0(@15),B'10000000'                                  1589 06393000
         BNO   @RF01589                                            1589 06394000
         LH    @15,WORKRP                                          1589 06395000
         MH    @14,@CH00684                                        1589 06396000
         ALR   @14,@15                                             1589 06397000
         ALR   @14,@14                                             1589 06398000
         L     @15,IPSTPTR-4(@02,@04)                              1589 06399000
         AL    @15,@CF01768                                        1589 06400000
         SLR   @02,@02                                             1589 06401000
         IC    @02,IPSTVVA(@14,@15)                                1589 06402000
         SLA   @01,3                                               1589 06403000
         SLR   @15,@15                                             1589 06404000
         IC    @15,MVVVA-8(@01,@05)                                1589 06405000
         CR    @02,@15                                             1589 06406000
         BE    @RF01589                                            1589 06407000
*                         DO;       /*                       @Z40LB61*/ 06408000
*                           VVAFLD=ON;/*                     @Z40LB61*/ 06409000
         OI    VVAFLD(@03),B'01000000'                             1591 06410000
*                           FLDNUM(1)=IPSTVVA(WORK3333,DEV#,WORKRP);    06411000
         ST    @02,FLDNUM(,@03)                                    1592 06412000
*                                   /*                       @Z40LB61*/ 06413000
*                           FLDNUM(2)=MVVVA(MVPATH#);/*      @Z40LB61*/ 06414000
         ST    @15,FLDNUM+12(,@03)                                 1593 06415000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @Z40LB61*/ 06416000
         L     @05,@PC00001                                        1594 06417000
         ST    @05,@AL00001                                        1594 06418000
         ST    @04,@AL00001+4                                      1594 06419000
         L     @15,@CV01495                                        1594 06420000
         LA    @01,@AL00001                                        1594 06421000
         BALR  @14,@15                                             1594 06422000
*                         END;      /*                       @Z40LB61*/ 06423000
*                                                                  1595 06424000
*                       /*********************************************/ 06425000
*                       /*                                           */ 06426000
*                       /* CHECK FOR MATCHING VIRTUAL PAGE#. @Z40LB61*/ 06427000
*                       /* IF INCONSISTENT, PRINT ERROR MSG  @Z40LB61*/ 06428000
*                       /*                                           */ 06429000
*                       /*********************************************/ 06430000
*                                                                  1596 06431000
*                       IF IPSTVP(WORK3333,DEV#,WORKRP)^=MVVP#-1 THEN   06432000
@RF01589 SLR   @15,@15                                             1596 06433000
         IC    @15,WORK3333                                        1596 06434000
         SLA   @15,3                                               1596 06435000
         AH    @15,DEV#                                            1596 06436000
         MH    @15,@CH00684                                        1596 06437000
         AH    @15,WORKRP                                          1596 06438000
         ALR   @15,@15                                             1596 06439000
         LH    @14,SA#                                             1596 06440000
         SLA   @14,2                                               1596 06441000
         L     @05,@PC00001+4                                      1596 06442000
         L     @01,IPSTPTR-4(@14,@05)                              1596 06443000
         AL    @01,@CF01769                                        1596 06444000
         SLR   @14,@14                                             1596 06445000
         IC    @14,IPSTVP-1(@15,@01)                               1596 06446000
         LH    @15,MVVP#                                           1596 06447000
         BCTR  @15,0                                               1596 06448000
         CR    @14,@15                                             1596 06449000
         BE    @RF01596                                            1596 06450000
*                         DO;       /*                       @Z40LB61*/ 06451000
*                           VPFLD=ON;/*                      @Z40LB61*/ 06452000
         L     @04,MARGPTR(,@05)                                   1598 06453000
         OI    VPFLD(@04),B'00100000'                              1598 06454000
*                           FLDNUM(1)=IPSTVP(WORK3333,DEV#,WORKRP);/*   06455000
*                                                            @Z40LB61*/ 06456000
         ST    @14,FLDNUM(,@04)                                    1599 06457000
*                           FLDNUM(2)=MVVP#-1;/*             @ZA13477*/ 06458000
         ST    @15,FLDNUM+12(,@04)                                 1600 06459000
*                           CALL IDCCH04(GDTTBL,CDALIST);/*  @Z40LB61*/ 06460000
         L     @04,@PC00001                                        1601 06461000
         ST    @04,@AL00001                                        1601 06462000
         ST    @05,@AL00001+4                                      1601 06463000
         L     @15,@CV01495                                        1601 06464000
         LA    @01,@AL00001                                        1601 06465000
         BALR  @14,@15                                             1601 06466000
*                         END;      /*                       @Z40LB61*/ 06467000
*                     END MVTPSTM;  /*                       @Z40LB61*/ 06468000
*                                                                  1603 06469000
@RF01596 DS    0H                                                  1604 06470000
*                   /*************************************************/ 06471000
*                   /*                                               */ 06472000
*                   /* RESET 'IDCCH04' OPTION FLAGS          @Z40LB61*/ 06473000
*                   /*                                               */ 06474000
*                   /*************************************************/ 06475000
*                                                                  1604 06476000
*                   MSGTYPE=''B;    /*                       @Z40LB61*/ 06477000
@RF01577 L     @15,@PC00001+4                                      1604 06478000
         L     @15,MARGPTR(,@15)                                   1604 06479000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1604 06480000
*                   TBLTYPE(1)=''B; /*                       @Z40LB61*/ 06481000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1605 06482000
*                   TBLTYPE(2)=''B; /*                       @Z40LB61*/ 06483000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1606 06484000
*                 END PSTCHK;       /*                       @Z40LB61*/ 06485000
         LA    @15,1                                               1607 06486000
         AH    @15,MVPATH#                                         1607 06487000
         STH   @15,MVPATH#                                         1607 06488000
         CH    @15,@CH00157                                        1607 06489000
         BNH   @DL01573                                            1607 06490000
*             END GOODPAGE;         /*                       @Z40LB61*/ 06491000
*                                                                  1608 06492000
@RF01572 DS    0H                                                  1609 06493000
*         /***********************************************************/ 06494000
*         /*                                                         */ 06495000
*         /* RESET 'IDCCH04' OPTION FLAGS                    @Z40LB61*/ 06496000
*         /*                                                         */ 06497000
*         /***********************************************************/ 06498000
*                                                                  1609 06499000
*         MSGTYPE=''B;              /*                       @Z40LB61*/ 06500000
@RC01485 DS    0H                                                  1609 06501000
@RF01484 L     @15,@PC00001+4                                      1609 06502000
         L     @15,MARGPTR(,@15)                                   1609 06503000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1609 06504000
*         TBLTYPE(1)=''B;           /*                       @Z40LB61*/ 06505000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1610 06506000
*         TBLTYPE(2)=''B;           /*                       @Z40LB61*/ 06507000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1611 06508000
*       END VPLOOP2;                /*                       @Z40LB61*/ 06509000
         LA    @15,1                                               1612 06510000
         AH    @15,MVVP#                                           1612 06511000
         STH   @15,MVVP#                                           1612 06512000
         CH    @15,@CH00868                                        1612 06513000
         BNH   @DL01477                                            1612 06514000
*   END DEVLOOP1;                   /*                       @Z40LB61*/ 06515000
@RF01476 LA    @15,1                                               1613 06516000
         AH    @15,DEV#                                            1613 06517000
         STH   @15,DEV#                                            1613 06518000
         CH    @15,@CH00183                                        1613 06519000
         BNH   @DL01474                                            1613 06520000
*   END MVTRPM;                     /*                       @Z40LB61*/ 06521000
         B     @EL00009                                            1614 06522000
*                                                                  1615 06523000
*/********************************************************************/ 06524000
*/*                                                          @Z40LB61*/ 06525000
*/* PROCEDURE NAME - INACTIVE                                @Z40LB61*/ 06526000
*/*                                                          @Z40LB61*/ 06527000
*/* FUNCTION - THIS ROUTINE COMPARES MVT DATA RELATED TO     @Z40LB61*/ 06528000
*/*            INACTIVE ALLOCATED PAGES WITH ASSOCIATED      @Z40LB61*/ 06529000
*/*            DATA IN OTHER MSC TABLES.                     @Z40LB61*/ 06530000
*/*                                                          @Z40LB61*/ 06531000
*/* INPUT -                                                  @Z40LB61*/ 06532000
*/*        (1) MSC MOUNTED VOLUME TABLE                      @Z40LB61*/ 06533000
*/*        (2) INACTIVE PAGE COUNT FOR THIS VOLUME           @Z40LB61*/ 06534000
*/*        (3) MSC SDG DEMOUNTED VOLUME BLOCK                @Z40LB61*/ 06535000
*/*        (4) MSC SDG LRU PAGES BLOCK                       @Z40LB61*/ 06536000
*/*                                                          @Z40LB61*/ 06537000
*/* OUTPUT -                                                 @Z40LB61*/ 06538000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 06539000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 06540000
*/*        (3) DVB CHECK-OFF TABLE                           @Z40LB61*/ 06541000
*/*        (4) LPB CHECK-OFF TABLE                           @Z40LB61*/ 06542000
*/*                                                          @Z40LB61*/ 06543000
*/********************************************************************/ 06544000
*                                                                  1615 06545000
*INACTIVE:                                                         1615 06546000
*   PROCEDURE;                      /*                       @Z40LB61*/ 06547000
INACTIVE STM   @14,@12,@SA00010                                    1615 06548000
*   OLDERID2=NEWERID2;                                             1616 06549000
         L     @15,@PC00001                                        1616 06550000
         L     @14,GDTTR2(,@15)                                    1616 06551000
         MVC   @TS00001(95),NEWERID2(@14)                          1616 06552000
         MVC   OLDERID2(95,@14),@TS00001                           1616 06553000
*   NEWID2='CH2S';                  /*                       @Z40LB61*/ 06554000
*                                                                  1617 06555000
         MVC   NEWID2(4,@14),@CC01651                              1617 06556000
*   /*****************************************************************/ 06557000
*   /*                                                               */ 06558000
*   /* COMPARE THE SUM OF INACTIVE PAGES ACCUMULATED FROM    @Z40LB61*/ 06559000
*   /* MVT VIRTUAL PAGE ENTRIES TO THE MVT INACTIVE PAGE     @Z40LB61*/ 06560000
*   /* TOTAL FIELD. IF INCONSISTENT, PRINT AN ERROR MSG.     @Z40LB61*/ 06561000
*   /*                                                               */ 06562000
*   /*****************************************************************/ 06563000
*                                                                  1618 06564000
*   IF INACTCNT^=MVPINCNT THEN                                     1618 06565000
         LH    @14,INACTCNT                                        1618 06566000
         L     @01,MVENTPTR                                        1618 06567000
         SLR   @05,@05                                             1618 06568000
         IC    @05,MVPINCNT(,@01)                                  1618 06569000
         CR    @14,@05                                             1618 06570000
         BE    @RF01618                                            1618 06571000
*     DO;                           /*                       @Z40LB61*/ 06572000
*       SUMSMSG=ON;                 /*                       @Z40LB61*/ 06573000
         L     @04,@PC00001+4                                      1620 06574000
         L     @03,MARGPTR(,@04)                                   1620 06575000
         OI    SUMSMSG(@03),B'00100000'                            1620 06576000
*       MVTTBL(1)=ON;               /*                       @Z40LB61*/ 06577000
         OI    MVTTBL(@03),B'10000000'                             1621 06578000
*       MVTTBL(2)=ON;               /*                       @Z40LB61*/ 06579000
         OI    MVTTBL+4(@03),B'10000000'                           1622 06580000
*       IPFLD=ON;                   /*                       @Z40LB61*/ 06581000
         OI    IPFLD(@03),B'00000001'                              1623 06582000
*       FLDNUM(1)=INACTCNT;         /*                       @Z40LB61*/ 06583000
         ST    @14,FLDNUM(,@03)                                    1624 06584000
*       FLDNUM(2)=MVPINCNT;         /*                       @Z40LB61*/ 06585000
         ST    @05,FLDNUM+12(,@03)                                 1625 06586000
*       CALL IDCCH04(GDTTBL,CDALIST);/*                      @Z40LB61*/ 06587000
         ST    @15,@AL00001                                        1626 06588000
         ST    @04,@AL00001+4                                      1626 06589000
         L     @15,@CV01495                                        1626 06590000
         LA    @01,@AL00001                                        1626 06591000
         BALR  @14,@15                                             1626 06592000
*     END;                          /*                       @Z40LB61*/ 06593000
*                                                                  1627 06594000
*   /*****************************************************************/ 06595000
*   /*                                                               */ 06596000
*   /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES          @Z40LB61*/ 06597000
*   /*                                                               */ 06598000
*   /*****************************************************************/ 06599000
*                                                                  1628 06600000
*   FLDNUM(1)=SAVEREC#-1;           /*                       @Z40LB61*/ 06601000
*                                                                  1628 06602000
@RF01618 L     @15,@PC00001+4                                      1628 06603000
         L     @01,MARGPTR(,@15)                                   1628 06604000
         LH    @00,SAVEREC#                                        1628 06605000
         BCTR  @00,0                                               1628 06606000
         ST    @00,FLDNUM(,@01)                                    1628 06607000
*   /*****************************************************************/ 06608000
*   /*                                                               */ 06609000
*   /* PREPARE TO ACCESS TABLES, CHECKING WHETHER THE        @Z40LB61*/ 06610000
*   /* CURRENT MVT ENTRY HAS ANY INACTIVE PAGES.             @Z40LB61*/ 06611000
*   /*                                                               */ 06612000
*   /*****************************************************************/ 06613000
*                                                                  1629 06614000
*   SDG#=MVSDG+1;                   /*                       @Z40LB61*/ 06615000
         L     @14,MVENTPTR                                        1629 06616000
         SLR   @05,@05                                             1629 06617000
         IC    @05,MVSDG(,@14)                                     1629 06618000
         LA    @04,1                                               1629 06619000
         ALR   @04,@05                                             1629 06620000
         STH   @04,SDG#                                            1629 06621000
*   SDGNUM=MVSDG;                   /*                       @Z40LB61*/ 06622000
         L     @01,EARGPTR(,@15)                                   1630 06623000
         STH   @05,SDGNUM(,@01)                                    1630 06624000
*   IF MVMNTVOL=ON THEN             /*                       @ZA13049*/ 06625000
*                                                                  1631 06626000
         TM    MVMNTVOL(@14),B'10000000'                           1631 06627000
         BNO   @RF01631                                            1631 06628000
*     /***************************************************************/ 06629000
*     /*                                                             */ 06630000
*     /* A MOUNTED VOLUME WITH INACTIVE PAGES SHOULD BE      @Z40LB61*/ 06631000
*     /* REFERENCED IN THE LRU PAGES BLOCK, SO OBTAIN        @Z40LB61*/ 06632000
*     /* THE LPB FOR THIS VOLUME'S SDG.                      @Z40LB61*/ 06633000
*     /*                                                             */ 06634000
*     /***************************************************************/ 06635000
*                                                                  1632 06636000
*LPBCHK:                                                           1632 06637000
*     DO;                           /*                       @Z40LB61*/ 06638000
LPBCHK   DS    0H                                                  1633 06639000
*       TABLEID=SDGTBLID;           /*                       @Z40LB61*/ 06640000
         L     @15,@PC00001+4                                      1633 06641000
         L     @14,EARGPTR(,@15)                                   1633 06642000
         MVC   TABLEID(1,@14),SDGTBLID                             1633 06643000
*       LPBFLAG=ON;                 /*                       @Z40LB61*/ 06644000
         OI    LPBFLAG(@14),B'00010000'                            1634 06645000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB61*/ 06646000
         L     @14,@PC00001                                        1635 06647000
         ST    @14,@AL00001                                        1635 06648000
         ST    @15,@AL00001+4                                      1635 06649000
         L     @15,@CV01494                                        1635 06650000
         LA    @01,@AL00001                                        1635 06651000
         BALR  @14,@15                                             1635 06652000
*       IF GETRC^=0 THEN                                           1636 06653000
         L     @15,@PC00001+4                                      1636 06654000
         L     @01,EARGPTR(,@15)                                   1636 06655000
         ICM   @00,3,GETRC(@01)                                    1636 06656000
         BZ    @RF01636                                            1636 06657000
*         DO;                       /*                       @Z40LB61*/ 06658000
*           LASTCOND=LASTCC12;      /*                       @Z40LB61*/ 06659000
         L     @15,@PC00001+8                                      1638 06660000
         MVC   LASTCOND(2,@15),@CH00567                            1638 06661000
*           RETURN;                 /*                       @Z40LB61*/ 06662000
@EL00010 DS    0H                                                  1639 06663000
@EF00010 DS    0H                                                  1639 06664000
@ER00010 LM    @14,@12,@SA00010                                    1639 06665000
         BR    @14                                                 1639 06666000
*         END;                      /*                       @Z40LB61*/ 06667000
*       LPBPTR=TBLADDR;             /*                       @Z40LB61*/ 06668000
*                                                                  1641 06669000
@RF01636 L     @15,@PC00001+4                                      1641 06670000
         L     @01,EARGPTR(,@15)                                   1641 06671000
         MVC   LPBPTR(4),TBLADDR(@01)                              1641 06672000
*       /*************************************************************/ 06673000
*       /*                                                           */ 06674000
*       /* SEARCH EACH VALID ENTRY IN THE LPB FOR THE MVT    @Z40LB61*/ 06675000
*       /* POINTER TO THE CURRENT MVT ENTRY                  @Z40LB61*/ 06676000
*       /*                                                           */ 06677000
*       /*************************************************************/ 06678000
*                                                                  1642 06679000
*       MATCHED=OFF;                /*                       @Z40LB61*/ 06680000
         NI    MATCHED,B'01111111'                                 1642 06681000
*       DO ENTRY#=1 TO DVLPMAX WHILE(MATCHED=OFF&((ENTRY#*LENGTH(LPBMVT 06682000
*             )<=(LPBNEXT-4))|      /*                       @ZA16115*/ 06683000
*             LPBNEXT=0));          /*                       @ZA16115*/ 06684000
         LA    @15,1                                               1643 06685000
         STH   @15,ENTRY#                                          1643 06686000
@DL01643 TM    MATCHED,B'10000000'                                 1643 06687000
         BNZ   @DC01643                                            1643 06688000
         ALR   @15,@15                                             1643 06689000
         L     @14,LPBPTR                                          1643 06690000
         SLR   @05,@05                                             1643 06691000
         IC    @05,LPBNEXT(,@14)                                   1643 06692000
         SH    @05,@CH00046                                        1643 06693000
         CR    @15,@05                                             1643 06694000
         BNH   @DB01643                                            1643 06695000
         CLI   LPBNEXT(@14),0                                      1643 06696000
         BNE   @DC01643                                            1643 06697000
@DB01643 DS    0H                                                  1644 06698000
*         IF(SAVEREC#-1)=(LPBMVT(ENTRY#)&MASK8191) THEN            1644 06699000
*                                                                  1644 06700000
         LH    @15,SAVEREC#                                        1644 06701000
         BCTR  @15,0                                               1644 06702000
         LH    @14,ENTRY#                                          1644 06703000
         LR    @05,@14                                             1644 06704000
         ALR   @05,@05                                             1644 06705000
         SLR   @04,@04                                             1644 06706000
         ICM   @04,3,MASK8191                                      1644 06707000
         L     @01,LPBPTR                                          1644 06708000
         ALR   @01,@05                                             1644 06709000
         SLR   @05,@05                                             1644 06710000
         ICM   @05,3,LPBMVT-2(@01)                                 1644 06711000
         NR    @04,@05                                             1644 06712000
         CR    @15,@04                                             1644 06713000
         BNE   @RF01644                                            1644 06714000
*           /*********************************************************/ 06715000
*           /*                                                       */ 06716000
*           /* FOR A MATCHING MVT POINTER, CHECK-OFF THE     @Z40LB61*/ 06717000
*           /* ENTRY AND NOTE THE MATCH                      @Z40LB61*/ 06718000
*           /*                                                       */ 06719000
*           /*********************************************************/ 06720000
*                                                                  1645 06721000
*           DO;                     /*                       @Z40LB61*/ 06722000
*             BYTE#=(ENTRY#-1)/8+1; /*                       @Z40LB61*/ 06723000
         L     @15,@PC00001+4                                      1646 06724000
         L     @05,EARGPTR(,@15)                                   1646 06725000
         LA    @04,1                                               1646 06726000
         BCTR  @14,0                                               1646 06727000
         LR    @00,@14                                             1646 06728000
         SRDA  @00,32                                              1646 06729000
         D     @00,@CF00183                                        1646 06730000
         ALR   @01,@04                                             1646 06731000
         STH   @01,BYTE#(,@05)                                     1646 06732000
*             BIT#=(ENTRY#-1)//8+1; /*                       @Z40LB61*/ 06733000
         SRDA  @14,32                                              1647 06734000
         D     @14,@CF00183                                        1647 06735000
         ALR   @14,@04                                             1647 06736000
         STH   @14,BIT#(,@05)                                      1647 06737000
*             LPBCHKFF(SDG#,BYTE#)=LPBCHKFF(SDG#,BYTE#)|BITMASK(BIT#);  06738000
         LH    @15,SDG#                                            1648 06739000
         SLA   @15,4                                               1648 06740000
         ALR   @15,@01                                             1648 06741000
         L     @05,@PC00001+4                                      1648 06742000
         L     @01,LPBCOPTR(,@05)                                  1648 06743000
         ALR   @01,@15                                             1648 06744000
         AL    @01,@CF01770                                        1648 06745000
         LA    @15,BITMASK-1(@14)                                  1648 06746000
         OC    LPBCHKFF(1,@01),0(@15)                              1648 06747000
*                                   /*                       @Z40LB61*/ 06748000
*             MATCHED=ON;           /*                       @Z40LB61*/ 06749000
         OI    MATCHED,B'10000000'                                 1649 06750000
*           END;                    /*                       @Z40LB61*/ 06751000
*       END;                        /*                       @Z40LB61*/ 06752000
*                                                                  1651 06753000
@RF01644 LA    @15,1                                               1651 06754000
         AH    @15,ENTRY#                                          1651 06755000
         STH   @15,ENTRY#                                          1651 06756000
         CH    @15,@CH00753                                        1651 06757000
         BNH   @DL01643                                            1651 06758000
@DC01643 DS    0H                                                  1652 06759000
*       /*************************************************************/ 06760000
*       /*                                                           */ 06761000
*       /* IF NO MATCHING MVT POINTER WAS FOUND IN THE LPB,  @Z40LB61*/ 06762000
*       /* FOR AN MVT ENTRY W/INACTIVE PAGES GREATER THAN 0  @ZA13049*/ 06763000
*       /* PRINT AN ERROR MESSAGE.                           @Z40LB61*/ 06764000
*       /*                                                           */ 06765000
*       /*************************************************************/ 06766000
*                                                                  1652 06767000
*       IF MATCHED=OFF&MVPINCNT>0 THEN/*                     @ZA13049*/ 06768000
         TM    MATCHED,B'10000000'                                 1652 06769000
         BNZ   @RF01652                                            1652 06770000
         L     @01,MVENTPTR                                        1652 06771000
         CLI   MVPINCNT(@01),0                                     1652 06772000
         BNH   @RF01652                                            1652 06773000
*         DO;                       /*                       @Z40LB61*/ 06774000
*           MTCHMSG=ON;             /*                       @Z40LB61*/ 06775000
         L     @15,@PC00001+4                                      1654 06776000
         L     @14,MARGPTR(,@15)                                   1654 06777000
         OI    MTCHMSG(@14),B'00010000'                            1654 06778000
*           MVTTBL(2)=ON;           /*                       @Z40LB61*/ 06779000
         OI    MVTTBL+4(@14),B'10000000'                           1655 06780000
*           MVTPFLD=ON;             /*                       @Z40LB61*/ 06781000
         OI    MVTPFLD(@14),B'00100000'                            1656 06782000
*           LPBTBL(1)=ON;           /*                       @Z40LB61*/ 06783000
         OI    LPBTBL(@14),B'00000100'                             1657 06784000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 06785000
         L     @14,@PC00001                                        1658 06786000
         ST    @14,@AL00001                                        1658 06787000
         ST    @15,@AL00001+4                                      1658 06788000
         L     @15,@CV01495                                        1658 06789000
         LA    @01,@AL00001                                        1658 06790000
         BALR  @14,@15                                             1658 06791000
*         END;                      /*                       @Z40LB61*/ 06792000
*     END LPBCHK;                   /*                       @Z40LB61*/ 06793000
*   ELSE                                                           1661 06794000
*                                                                  1661 06795000
*     /***************************************************************/ 06796000
*     /*                                                             */ 06797000
*     /* A DEMOUNTED VOLUME WITH INACTIVE PAGES,             @Z40LB61*/ 06798000
*     /* SHOULD BE                                           @Z40LB61*/ 06799000
*     /* REFERENCED IN THE DEMOUNTED VOLUME BLOCK (DVB)      @Z40LB61*/ 06800000
*     /* SO OBTAIN THE DVB FOR THIS VOLUME'S SDG.            @Z40LB61*/ 06801000
*     /*                                                             */ 06802000
*     /***************************************************************/ 06803000
*                                                                  1661 06804000
*DVBCHK:                                                           1661 06805000
*     DO;                           /*                       @Z40LB61*/ 06806000
         B     @RC01631                                            1661 06807000
@RF01631 DS    0H                                                  1661 06808000
DVBCHK   DS    0H                                                  1662 06809000
*       TABLEID=SDGTBLID;           /*                       @Z40LB61*/ 06810000
         L     @15,@PC00001+4                                      1662 06811000
         L     @14,EARGPTR(,@15)                                   1662 06812000
         MVC   TABLEID(1,@14),SDGTBLID                             1662 06813000
*       DVBFLAG=ON;                 /*                       @Z40LB61*/ 06814000
         OI    DVBFLAG(@14),B'00100000'                            1663 06815000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB61*/ 06816000
         L     @14,@PC00001                                        1664 06817000
         ST    @14,@AL00001                                        1664 06818000
         ST    @15,@AL00001+4                                      1664 06819000
         L     @15,@CV01494                                        1664 06820000
         LA    @01,@AL00001                                        1664 06821000
         BALR  @14,@15                                             1664 06822000
*       IF GETRC^=0 THEN                                           1665 06823000
         L     @15,@PC00001+4                                      1665 06824000
         L     @01,EARGPTR(,@15)                                   1665 06825000
         ICM   @00,3,GETRC(@01)                                    1665 06826000
         BZ    @RF01665                                            1665 06827000
*         DO;                       /*                       @Z40LB61*/ 06828000
*           LASTCOND=LASTCC12;      /*                       @Z40LB61*/ 06829000
         L     @15,@PC00001+8                                      1667 06830000
         MVC   LASTCOND(2,@15),@CH00567                            1667 06831000
*           RETURN;                 /*                       @Z40LB61*/ 06832000
         B     @EL00010                                            1668 06833000
*         END;                      /*                       @Z40LB61*/ 06834000
*       DVBPTR=TBLADDR;             /*                       @Z40LB61*/ 06835000
*                                                                  1670 06836000
@RF01665 L     @15,@PC00001+4                                      1670 06837000
         L     @01,EARGPTR(,@15)                                   1670 06838000
         MVC   DVBPTR(4),TBLADDR(@01)                              1670 06839000
*       /*************************************************************/ 06840000
*       /*                                                           */ 06841000
*       /* SEARCH EACH VALID ENTRY IN THE DVB FOR THE MVT    @Z40LB61*/ 06842000
*       /* POINTER TO THE CURRENT MVT ENTRY                  @Z40LB61*/ 06843000
*       /*                                                           */ 06844000
*       /*************************************************************/ 06845000
*                                                                  1671 06846000
*       MATCHED=OFF;                /*                       @Z40LB61*/ 06847000
         NI    MATCHED,B'01111111'                                 1671 06848000
*       DO ENTRY#=1 TO DVLPMAX WHILE(MATCHED=OFF&((ENTRY#*LENGTH(DVBMVT 06849000
*             )<=(DVBNEXT-4))       /*                       @ZA16115*/ 06850000
*             |DVBNEXT=0));         /*                       @ZA16115*/ 06851000
         LA    @15,1                                               1672 06852000
         STH   @15,ENTRY#                                          1672 06853000
@DL01672 TM    MATCHED,B'10000000'                                 1672 06854000
         BNZ   @DC01672                                            1672 06855000
         ALR   @15,@15                                             1672 06856000
         L     @14,DVBPTR                                          1672 06857000
         SLR   @05,@05                                             1672 06858000
         IC    @05,DVBNEXT(,@14)                                   1672 06859000
         SH    @05,@CH00046                                        1672 06860000
         CR    @15,@05                                             1672 06861000
         BNH   @DB01672                                            1672 06862000
         CLI   DVBNEXT(@14),0                                      1672 06863000
         BNE   @DC01672                                            1672 06864000
@DB01672 DS    0H                                                  1673 06865000
*         IF(SAVEREC#-1)=(DVBMVT(ENTRY#)&MASK8191) THEN            1673 06866000
*                                                                  1673 06867000
         LH    @15,SAVEREC#                                        1673 06868000
         BCTR  @15,0                                               1673 06869000
         LH    @14,ENTRY#                                          1673 06870000
         LR    @05,@14                                             1673 06871000
         ALR   @05,@05                                             1673 06872000
         SLR   @04,@04                                             1673 06873000
         ICM   @04,3,MASK8191                                      1673 06874000
         L     @01,DVBPTR                                          1673 06875000
         ALR   @01,@05                                             1673 06876000
         SLR   @05,@05                                             1673 06877000
         ICM   @05,3,DVBMVT-2(@01)                                 1673 06878000
         NR    @04,@05                                             1673 06879000
         CR    @15,@04                                             1673 06880000
         BNE   @RF01673                                            1673 06881000
*           /*********************************************************/ 06882000
*           /*                                                       */ 06883000
*           /* FOR A MATCHING MVT POINTER, CHECK-OFF THE     @Z40LB61*/ 06884000
*           /* ENTRY AND NOTE THE MATCH                      @Z40LB61*/ 06885000
*           /*                                                       */ 06886000
*           /*********************************************************/ 06887000
*                                                                  1674 06888000
*           DO;                     /*                       @Z40LB61*/ 06889000
*             BYTE#=(ENTRY#-1)/8+1; /*                       @Z40LB61*/ 06890000
         L     @15,@PC00001+4                                      1675 06891000
         L     @05,EARGPTR(,@15)                                   1675 06892000
         LA    @04,1                                               1675 06893000
         BCTR  @14,0                                               1675 06894000
         LR    @00,@14                                             1675 06895000
         SRDA  @00,32                                              1675 06896000
         D     @00,@CF00183                                        1675 06897000
         ALR   @01,@04                                             1675 06898000
         STH   @01,BYTE#(,@05)                                     1675 06899000
*             BIT#=(ENTRY#-1)//8+1; /*                       @Z40LB61*/ 06900000
         SRDA  @14,32                                              1676 06901000
         D     @14,@CF00183                                        1676 06902000
         ALR   @14,@04                                             1676 06903000
         STH   @14,BIT#(,@05)                                      1676 06904000
*             DVBCHKFF(SDG#,BYTE#)=DVBCHKFF(SDG#,BYTE#)|BITMASK(BIT#);  06905000
         LH    @15,SDG#                                            1677 06906000
         SLA   @15,4                                               1677 06907000
         ALR   @15,@01                                             1677 06908000
         L     @05,@PC00001+4                                      1677 06909000
         L     @01,DVBCOPTR(,@05)                                  1677 06910000
         ALR   @01,@15                                             1677 06911000
         AL    @01,@CF01770                                        1677 06912000
         LA    @15,BITMASK-1(@14)                                  1677 06913000
         OC    DVBCHKFF(1,@01),0(@15)                              1677 06914000
*                                   /*                       @Z40LB61*/ 06915000
*             MATCHED=ON;           /*                       @Z40LB61*/ 06916000
         OI    MATCHED,B'10000000'                                 1678 06917000
*           END;                    /*                       @Z40LB61*/ 06918000
*       END;                        /*                       @Z40LB61*/ 06919000
*                                                                  1680 06920000
@RF01673 LA    @15,1                                               1680 06921000
         AH    @15,ENTRY#                                          1680 06922000
         STH   @15,ENTRY#                                          1680 06923000
         CH    @15,@CH00753                                        1680 06924000
         BNH   @DL01672                                            1680 06925000
@DC01672 DS    0H                                                  1681 06926000
*       /*************************************************************/ 06927000
*       /*                                                           */ 06928000
*       /* IF NO MATCHING MVT POINTER WAS FOUND IN THE DVB,  @Z40LB61*/ 06929000
*       /* FOR AN MVT ENTRY W/INACTIVE PAGES GREATER THAN 0  @ZA13049*/ 06930000
*       /* PRINT AN ERROR MESSAGE.                           @Z40LB61*/ 06931000
*       /*                                                           */ 06932000
*       /*************************************************************/ 06933000
*                                                                  1681 06934000
*       IF MATCHED=OFF&MVPINCNT>0 THEN/*                     @ZA13049*/ 06935000
         TM    MATCHED,B'10000000'                                 1681 06936000
         BNZ   @RF01681                                            1681 06937000
         L     @01,MVENTPTR                                        1681 06938000
         CLI   MVPINCNT(@01),0                                     1681 06939000
         BNH   @RF01681                                            1681 06940000
*         DO;                       /*                       @Z40LB61*/ 06941000
*           MTCHMSG=ON;             /*                       @Z40LB61*/ 06942000
         L     @15,@PC00001+4                                      1683 06943000
         L     @14,MARGPTR(,@15)                                   1683 06944000
         OI    MTCHMSG(@14),B'00010000'                            1683 06945000
*           MVTTBL(2)=ON;           /*                       @Z40LB61*/ 06946000
         OI    MVTTBL+4(@14),B'10000000'                           1684 06947000
*           MVTPFLD=ON;             /*                       @Z40LB61*/ 06948000
         OI    MVTPFLD(@14),B'00100000'                            1685 06949000
*           DVBTBL(1)=ON;           /*                       @Z40LB61*/ 06950000
         OI    DVBTBL(@14),B'00001000'                             1686 06951000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 06952000
         L     @14,@PC00001                                        1687 06953000
         ST    @14,@AL00001                                        1687 06954000
         ST    @15,@AL00001+4                                      1687 06955000
         L     @15,@CV01495                                        1687 06956000
         LA    @01,@AL00001                                        1687 06957000
         BALR  @14,@15                                             1687 06958000
*         END;                      /*                       @Z40LB61*/ 06959000
*     END DVBCHK;                   /*                       @Z40LB61*/ 06960000
*   END INACTIVE;                   /*                       @Z40LB61*/ 06961000
         B     @EL00010                                            1690 06962000
*                                                                  1691 06963000
*/********************************************************************/ 06964000
*/*                                                          @Z40LB61*/ 06965000
*/* PROCEDURE NAME - SCANSUMS                                @Z40LB61*/ 06966000
*/*                                                          @Z40LB61*/ 06967000
*/* FUNCTION - THIS ROUTINE OBTAINS AND COMPARES TOTALS      @Z40LB61*/ 06968000
*/*            RELATED TO ALL VOLUMES COLLECTIVELY WITH      @Z40LB61*/ 06969000
*/*            SUM TOTALS ACCUMULATED DURING PROCESSING OF   @Z40LB61*/ 06970000
*/*            ALL INDIVIDUAL VOLUMES.                       @Z40LB61*/ 06971000
*/*                                                          @Z40LB61*/ 06972000
*/* INPUT -                                                  @Z40LB61*/ 06973000
*/*        (1) COUNTS OF MOUNTED VOLUMES PER SDG             @Z40LB61*/ 06974000
*/*        (2) MSC MOUNT EQUALIZATION TABLE                  @Z40LB61*/ 06975000
*/*        (3) MSC SDG PAGE AVAILABILITY BLOCKS              @Z40LB61*/ 06976000
*/*        (4) MSC SDG REAL PAGE MAPS                        @Z40LB61*/ 06977000
*/*        (5) SDG RPM CHECK-OFF TABLE                       @Z40LB61*/ 06978000
*/*                                                          @Z40LB61*/ 06979000
*/* OUTPUT -                                                 @Z40LB61*/ 06980000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 06981000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 06982000
*/*        (3) REAL PAGE MAP PAGE STATUS SUM TOTALS          @Z40LB61*/ 06983000
*/*                                                          @Z40LB61*/ 06984000
*/********************************************************************/ 06985000
*                                                                  1691 06986000
*SCANSUMS:                                                         1691 06987000
*   PROCEDURE;                      /*                       @Z40LB61*/ 06988000
SCANSUMS STM   @14,@12,@SA00011                                    1691 06989000
*   OLDERID2=NEWERID2;                                             1692 06990000
         L     @15,@PC00001                                        1692 06991000
         L     @15,GDTTR2(,@15)                                    1692 06992000
         MVC   @TS00001(95),NEWERID2(@15)                          1692 06993000
         MVC   OLDERID2(95,@15),@TS00001                           1692 06994000
*   NEWID2='CH2T';                  /*                       @Z40LB61*/ 06995000
*                                                                  1693 06996000
         MVC   NEWID2(4,@15),@CC01659                              1693 06997000
*   /*****************************************************************/ 06998000
*   /*                                                               */ 06999000
*   /* PERFORM VARIOUS CONSISTENCY CHECKING FOR EACH         @Z40LB61*/ 07000000
*   /* STAGING DRIVE GROUP                                   @Z40LB61*/ 07001000
*   /*                                                               */ 07002000
*   /*****************************************************************/ 07003000
*                                                                  1694 07004000
*   MERPTR=IMERPTR;                 /*                       @Z40LB64*/ 07005000
         L     @15,@PC00001+4                                      1694 07006000
         MVC   MERPTR(4),IMERPTR(@15)                              1694 07007000
*SDGLOOP:                                                          1695 07008000
*   DO SDG#=1 TO SDGMAX;            /*                       @Z40LB61*/ 07009000
*                                                                  1695 07010000
SDGLOOP  LA    @15,1                                               1695 07011000
         STH   @15,SDG#                                            1695 07012000
@DL01695 DS    0H                                                  1696 07013000
*     /***************************************************************/ 07014000
*     /*                                                             */ 07015000
*     /* IF MSC VS. MSC CHECKING WAS REQUESTED,              @Z40LB61*/ 07016000
*     /* CHECK THAT THE SUM OF MOUNTED VOLUMES ACCUMULATED   @Z40LB61*/ 07017000
*     /* FROM SCANNING THE MVT MATCHES THE MOUNTED TOTAL     @Z40LB61*/ 07018000
*     /* FOR THE SDG IN THE MOUNT EQUALIZATION TABLE. IF     @Z40LB61*/ 07019000
*     /* INCONSISTENT, PRINT AN ERROR MESSAGE.               @Z40LB61*/ 07020000
*     /*                                                             */ 07021000
*     /***************************************************************/ 07022000
*                                                                  1696 07023000
*     IF MSCCHK=ON&MEMNTCNT(SDG#)^=MNTCOUNT(SDG#) THEN             1696 07024000
         L     @14,@PC00001+4                                      1696 07025000
         TM    MSCCHK(@14),B'10000000'                             1696 07026000
         BNO   @RF01696                                            1696 07027000
         LR    @05,@15                                             1696 07028000
         SLA   @05,2                                               1696 07029000
         L     @01,MERPTR                                          1696 07030000
         ALR   @01,@05                                             1696 07031000
         AL    @01,@CF01760                                        1696 07032000
         SLR   @05,@05                                             1696 07033000
         ICM   @05,3,MEMNTCNT-2(@01)                               1696 07034000
         LR    @04,@15                                             1696 07035000
         ALR   @04,@04                                             1696 07036000
         LH    @04,MNTCOUNT-2(@04)                                 1696 07037000
         CR    @05,@04                                             1696 07038000
         BE    @RF01696                                            1696 07039000
*       DO;                         /*                       @Z40LB61*/ 07040000
*         SUMSMSG=ON;               /*                       @Z40LB61*/ 07041000
         L     @03,MARGPTR(,@14)                                   1698 07042000
         OI    SUMSMSG(@03),B'00100000'                            1698 07043000
*         MVTTBL(1)=ON;             /*                       @Z40LB61*/ 07044000
         OI    MVTTBL(@03),B'10000000'                             1699 07045000
*         METBL(2)=ON;              /*                       @Z40LB61*/ 07046000
         OI    METBL+4(@03),B'00010000'                            1700 07047000
*         MVFLD=ON;                 /*                       @Z40LB61*/ 07048000
         OI    MVFLD(@03),B'00100000'                              1701 07049000
*         FLDNUM(1)=MNTCOUNT(SDG#); /*                       @Z40LB61*/ 07050000
         ST    @04,FLDNUM(,@03)                                    1702 07051000
*         FLDNUM(2)=MEMNTCNT(SDG#); /*                       @Z40LB61*/ 07052000
         ST    @05,FLDNUM+12(,@03)                                 1703 07053000
*         SDGINDEX(2)=SDG#-1;       /*                       @Z40LB61*/ 07054000
         BCTR  @15,0                                               1704 07055000
         STC   @15,SDGINDEX+24(,@03)                               1704 07056000
*         CALL IDCCH04(GDTTBL,CDALIST);/*                    @Z40LB61*/ 07057000
         L     @15,@PC00001                                        1705 07058000
         ST    @15,@AL00001                                        1705 07059000
         ST    @14,@AL00001+4                                      1705 07060000
         L     @15,@CV01495                                        1705 07061000
         LA    @01,@AL00001                                        1705 07062000
         BALR  @14,@15                                             1705 07063000
*       END;                        /*                       @Z40LB61*/ 07064000
*                                                                  1706 07065000
*     /***************************************************************/ 07066000
*     /*                                                             */ 07067000
*     /* OBTAIN THE PAGE AVAILABILITY BLOCK FOR THIS SDG     @Z40LB61*/ 07068000
*     /*                                                             */ 07069000
*     /***************************************************************/ 07070000
*                                                                  1707 07071000
*     TABLEID=SDGTBLID;             /*                       @Z40LB61*/ 07072000
@RF01696 L     @15,@PC00001+4                                      1707 07073000
         L     @14,EARGPTR(,@15)                                   1707 07074000
         MVC   TABLEID(1,@14),SDGTBLID                             1707 07075000
*     PABFLAG=ON;                   /*                       @Z40LB61*/ 07076000
         OI    PABFLAG(@14),B'01000000'                            1708 07077000
*     SDGNUM=SDG#-1;                /*                       @Z40LB61*/ 07078000
         LH    @05,SDG#                                            1709 07079000
         BCTR  @05,0                                               1709 07080000
         STH   @05,SDGNUM(,@14)                                    1709 07081000
*     BUFFER2=ON;                   /*                       @Z40LB61*/ 07082000
         OI    BUFFER2(@14),B'01000000'                            1710 07083000
*     CALL IDCCH03(GDTTBL,CDALIST); /*                       @Z40LB61*/ 07084000
         L     @14,@PC00001                                        1711 07085000
         ST    @14,@AL00001                                        1711 07086000
         ST    @15,@AL00001+4                                      1711 07087000
         L     @15,@CV01494                                        1711 07088000
         LA    @01,@AL00001                                        1711 07089000
         BALR  @14,@15                                             1711 07090000
*     IF GETRC^=0 THEN                                             1712 07091000
         L     @15,@PC00001+4                                      1712 07092000
         L     @01,EARGPTR(,@15)                                   1712 07093000
         ICM   @00,3,GETRC(@01)                                    1712 07094000
         BZ    @RF01712                                            1712 07095000
*       DO;                         /*                       @Z40LB61*/ 07096000
*         LASTCOND=LASTCC12;        /*                       @Z40LB61*/ 07097000
         L     @15,@PC00001+8                                      1714 07098000
         MVC   LASTCOND(2,@15),@CH00567                            1714 07099000
*         RETURN;                   /*                       @Z40LB61*/ 07100000
@EL00011 DS    0H                                                  1715 07101000
@EF00011 DS    0H                                                  1715 07102000
@ER00011 LM    @14,@12,@SA00011                                    1715 07103000
         BR    @14                                                 1715 07104000
*       END;                        /*                       @Z40LB61*/ 07105000
*     PABPTR=TBLADDR;               /*                       @Z40LB61*/ 07106000
@RF01712 L     @15,@PC00001+4                                      1717 07107000
         L     @15,EARGPTR(,@15)                                   1717 07108000
         MVC   PABPTR(4),TBLADDR(@15)                              1717 07109000
*     SAVEID=ENTRYID;               /*                       @Z40LB61*/ 07110000
*                                                                  1718 07111000
         MVC   SAVEID(12),ENTRYID(@15)                             1718 07112000
*     /***************************************************************/ 07113000
*     /*                                                             */ 07114000
*     /* PREPARE TO CHECK CONSISTENCY AND ACCUMULATE COUNTS  @Z40LB61*/ 07115000
*     /* RELATED TO EACH DEVICE OF THE SDG.                  @Z40LB61*/ 07116000
*     /*                                                             */ 07117000
*     /***************************************************************/ 07118000
*                                                                  1719 07119000
*     FPTOTAL=0;                    /*                       @Z40LB61*/ 07120000
         SLR   @15,@15                                             1719 07121000
         STH   @15,FPTOTAL                                         1719 07122000
*     APTOTAL=0;                    /*                       @Z40LB61*/ 07123000
         STH   @15,APTOTAL                                         1720 07124000
*     IPTOTAL=0;                    /*                       @Z40LB61*/ 07125000
         STH   @15,IPTOTAL                                         1721 07126000
*     BPTOTAL=0;                    /*                       @Z40LB61*/ 07127000
         STH   @15,BPTOTAL                                         1722 07128000
*DEVLOOP2:                                                         1723 07129000
*     DO DEV#=1 TO DEVSSDG;         /*                       @Z40LB61*/ 07130000
*                                                                  1723 07131000
DEVLOOP2 LA    @15,1                                               1723 07132000
         STH   @15,DEV#                                            1723 07133000
@DL01723 DS    0H                                                  1724 07134000
*       /*************************************************************/ 07135000
*       /*                                                           */ 07136000
*       /* INITIALIZE DEVICE COUNT VARIABLES                 @Z40LB61*/ 07137000
*       /*                                                           */ 07138000
*       /*************************************************************/ 07139000
*                                                                  1724 07140000
*       FPCOUNT(DEV#)=0;            /*                       @Z40LB61*/ 07141000
         SLR   @14,@14                                             1724 07142000
         LR    @05,@15                                             1724 07143000
         ALR   @05,@05                                             1724 07144000
         STH   @14,FPCOUNT-2(@05)                                  1724 07145000
*       APCOUNT(DEV#)=0;            /*                       @Z40LB61*/ 07146000
         STH   @14,APCOUNT-2(@05)                                  1725 07147000
*       IPCOUNT(DEV#)=0;            /*                       @Z40LB61*/ 07148000
         STH   @14,IPCOUNT-2(@05)                                  1726 07149000
*       BPCOUNT(DEV#)=0;            /*                       @Z40LB61*/ 07150000
*                                                                  1727 07151000
         STH   @14,BPCOUNT-2(@05)                                  1727 07152000
*       /*************************************************************/ 07153000
*       /*                                                           */ 07154000
*       /* IF THE DEVICE EXISTS, OBTAIN THE REAL PAGE MAP    @Z40LB61*/ 07155000
*       /* DESCRIBING ITS PAGES.                             @Z40LB61*/ 07156000
*       /*                                                           */ 07157000
*       /*************************************************************/ 07158000
*                                                                  1728 07159000
*       IF PABDEX(DEV#)=ON THEN                                    1728 07160000
         SLA   @15,2                                               1728 07161000
         L     @01,PABPTR                                          1728 07162000
         ALR   @01,@15                                             1728 07163000
         TM    PABDEX-4(@01),B'10000000'                           1728 07164000
         BNO   @RF01728                                            1728 07165000
*GOODDEV2:                                                         1729 07166000
*         DO;                       /*                       @Z40LB61*/ 07167000
GOODDEV2 DS    0H                                                  1730 07168000
*           TABLEID=SDGTBLID;       /*                       @Z40LB61*/ 07169000
         L     @15,@PC00001+4                                      1730 07170000
         L     @14,EARGPTR(,@15)                                   1730 07171000
         MVC   TABLEID(1,@14),SDGTBLID                             1730 07172000
*           RPMFLAG=ON;             /*                       @Z40LB61*/ 07173000
         OI    RPMFLAG(@14),B'10000000'                            1731 07174000
*           SDGNUM=SDG#-1;          /*                       @Z40LB61*/ 07175000
         LH    @05,SDG#                                            1732 07176000
         BCTR  @05,0                                               1732 07177000
         STH   @05,SDGNUM(,@14)                                    1732 07178000
*           DEVICEID=DEV#-1;        /*                       @Z40LB61*/ 07179000
         LH    @05,DEV#                                            1733 07180000
         BCTR  @05,0                                               1733 07181000
         STH   @05,DEVICEID(,@14)                                  1733 07182000
*           CALL IDCCH03(GDTTBL,CDALIST);/*                  @Z40LB61*/ 07183000
         L     @14,@PC00001                                        1734 07184000
         ST    @14,@AL00001                                        1734 07185000
         ST    @15,@AL00001+4                                      1734 07186000
         L     @15,@CV01494                                        1734 07187000
         LA    @01,@AL00001                                        1734 07188000
         BALR  @14,@15                                             1734 07189000
*           IF GETRC^=0 THEN                                       1735 07190000
         L     @15,@PC00001+4                                      1735 07191000
         L     @01,EARGPTR(,@15)                                   1735 07192000
         ICM   @00,3,GETRC(@01)                                    1735 07193000
         BZ    @RF01735                                            1735 07194000
*             DO;                   /*                       @Z40LB61*/ 07195000
*               LASTCOND=LASTCC12;  /*                       @Z40LB61*/ 07196000
         L     @15,@PC00001+8                                      1737 07197000
         MVC   LASTCOND(2,@15),@CH00567                            1737 07198000
*               RETURN;             /*                       @Z40LB61*/ 07199000
         B     @EL00011                                            1738 07200000
*             END;                  /*                       @Z40LB61*/ 07201000
*           RPMPTR=TBLADDR;         /*                       @Z40LB61*/ 07202000
*                                                                  1740 07203000
@RF01735 L     @15,@PC00001+4                                      1740 07204000
         L     @01,EARGPTR(,@15)                                   1740 07205000
         MVC   RPMPTR(4),TBLADDR(@01)                              1740 07206000
*           /*********************************************************/ 07207000
*           /*                                                       */ 07208000
*           /* 'BUILD' A LOGICAL UNIT ADDRESS FROM DEVICE    @Z40LB61*/ 07209000
*           /* NUMBER AND 3333 ADDRESS.                      @Z40LB61*/ 07210000
*           /*                                                       */ 07211000
*           /*********************************************************/ 07212000
*                                                                  1741 07213000
*           IF PAB3333(1)=ON THEN                                  1741 07214000
         L     @01,PABPTR                                          1741 07215000
         TM    PAB3333(@01),B'00010000'                            1741 07216000
         BNO   @RF01741                                            1741 07217000
*             LUA#=DEV#+DEVSSDG-1;  /*                       @Z40LB61*/ 07218000
         LH    @15,DEV#                                            1742 07219000
         SH    @15,@CH01733                                        1742 07220000
         STH   @15,LUA#                                            1742 07221000
*           ELSE                                                   1743 07222000
*             LUA#=DEV#-1;          /*                       @Z40LB61*/ 07223000
*                                                                  1743 07224000
         B     @RC01741                                            1743 07225000
@RF01741 LH    @15,DEV#                                            1743 07226000
         BCTR  @15,0                                               1743 07227000
         STH   @15,LUA#                                            1743 07228000
*           /*********************************************************/ 07229000
*           /*                                                       */ 07230000
*           /* CHECK EACH REAL PAGE ENTRY OF THE RPM. THE    @Z40LB61*/ 07231000
*           /* SECOND HALF OF A 3330 MOD 11 HAS ONE FEWER    @Z40LB61*/ 07232000
*           /* ALLOCATABLE PAGE THAN OTHER DEVICES.          @Z40LB61*/ 07233000
*           /*                                                       */ 07234000
*           /*********************************************************/ 07235000
*                                                                  1744 07236000
*           IF PAB2M11(DEV#)=ON THEN                               1744 07237000
@RC01741 LH    @15,DEV#                                            1744 07238000
         SLA   @15,2                                               1744 07239000
         L     @01,PABPTR                                          1744 07240000
         ALR   @01,@15                                             1744 07241000
         TM    PAB2M11-4(@01),B'00000001'                          1744 07242000
         BNO   @RF01744                                            1744 07243000
*             PGLIMIT=RPMAX-1;      /*                       @Z40LB61*/ 07244000
         MVC   PGLIMIT(2),@CH00868                                 1745 07245000
*           ELSE                                                   1746 07246000
*             PGLIMIT=RPMAX;        /*                       @Z40LB61*/ 07247000
         B     @RC01744                                            1746 07248000
@RF01744 MVC   PGLIMIT(2),@CH00684                                 1746 07249000
*RPLOOP:                                                           1747 07250000
*           DO RP#=2 TO PGLIMIT;    /*                       @Z40LB61*/ 07251000
*                                                                  1747 07252000
@RC01744 DS    0H                                                  1747 07253000
RPLOOP   LA    @15,2                                               1747 07254000
         B     @DE01747                                            1747 07255000
@DL01747 DS    0H                                                  1748 07256000
*             /*******************************************************/ 07257000
*             /*                                                     */ 07258000
*             /* DO COMMON SET-UP FOR POSSIBLE ERROR MSG'S   @Z40LB61*/ 07259000
*             /*                                                     */ 07260000
*             /*******************************************************/ 07261000
*                                                                  1748 07262000
*             SDGINDEX(2)=SDG#-1;   /*                       @Z40LB61*/ 07263000
         L     @14,@PC00001+4                                      1748 07264000
         L     @05,MARGPTR(,@14)                                   1748 07265000
         LH    @04,SDG#                                            1748 07266000
         LR    @03,@04                                             1748 07267000
         BCTR  @03,0                                               1748 07268000
         STC   @03,SDGINDEX+24(,@05)                               1748 07269000
*             LUAINDEX(2)=LUA#;     /*                       @Z40LB61*/ 07270000
         MVC   LUAINDEX+24(1,@05),LUA#+1                           1749 07271000
*             RPINDEX(2)=RP#-1;     /*                       @Z40LB61*/ 07272000
         LR    @03,@15                                             1750 07273000
         BCTR  @03,0                                               1750 07274000
         STC   @03,RPINDEX+24(,@05)                                1750 07275000
*             CHRINDEX(2)=PREVCHR;  /*                       @Z40LB61*/ 07276000
*                                                                  1751 07277000
         L     @02,EARGPTR(,@14)                                   1751 07278000
         MVC   CHRINDEX+24(5,@05),PREVCHR(@02)                     1751 07279000
*             /*******************************************************/ 07280000
*             /*                                                     */ 07281000
*             /* CHECK THAT VALID REAL PAGE ENTRIES HAVE     @Z40LB61*/ 07282000
*             /* BEEN CHECKED-OFF. IF NOT,PRINT AN ERROR     @Z40LB61*/ 07283000
*             /* MESSAGE.                                    @Z40LB61*/ 07284000
*             /*                                                     */ 07285000
*             /*******************************************************/ 07286000
*                                                                  1752 07287000
*             BYTE#=(RP#-1)/8+1;    /*                       @Z40LB61*/ 07288000
         LA    @01,1                                               1752 07289000
         LR    @04,@03                                             1752 07290000
         SRDA  @04,32                                              1752 07291000
         D     @04,@CF00183                                        1752 07292000
         ALR   @05,@01                                             1752 07293000
         STH   @05,BYTE#(,@02)                                     1752 07294000
*             BIT#=(RP#-1)//8+1;    /*                       @Z40LB61*/ 07295000
         LR    @14,@03                                             1753 07296000
         SRDA  @14,32                                              1753 07297000
         D     @14,@CF00183                                        1753 07298000
         ALR   @14,@01                                             1753 07299000
         STH   @14,BIT#(,@02)                                      1753 07300000
*             IF(RPMACT(RP#)=ON|RPMINACT(RP#)=ON|RPMBND(RP#)=ON|RPMVBND 07301000
*                 (RP#)=ON)&RPMIOERR(RP#)=OFF&(RPMCHKFF(SDG#,DEV#,BYTE# 07302000
*                 )&BITMASK(BIT#))=0 THEN                          1754 07303000
         L     @15,RPMPTR                                          1754 07304000
         LH    @04,RP#                                             1754 07305000
         SLA   @04,2                                               1754 07306000
         ST    @04,@TF00001                                        1754 07307000
         ALR   @04,@15                                             1754 07308000
         AL    @04,@CF01761                                        1754 07309000
         TM    RPMACT(@04),B'11110000'                             1754 07310000
         BZ    @RF01754                                            1754 07311000
         AL    @15,@TF00001                                        1754 07312000
         AL    @15,@CF01761                                        1754 07313000
         TM    RPMIOERR(@15),B'00001000'                           1754 07314000
         BNZ   @RF01754                                            1754 07315000
         LH    @15,SDG#                                            1754 07316000
         SLA   @15,3                                               1754 07317000
         AH    @15,DEV#                                            1754 07318000
         MH    @15,@CH00769                                        1754 07319000
         ALR   @15,@05                                             1754 07320000
         L     @02,@PC00001+4                                      1754 07321000
         L     @01,RPMCOPTR(,@02)                                  1754 07322000
         AL    @01,@CF01767                                        1754 07323000
         SLR   @00,@00                                             1754 07324000
         IC    @00,RPMCHKFF(@15,@01)                               1754 07325000
         SLR   @15,@15                                             1754 07326000
         IC    @15,BITMASK-1(@14)                                  1754 07327000
         NR    @00,@15                                             1754 07328000
         LTR   @00,@00                                             1754 07329000
         BNZ   @RF01754                                            1754 07330000
*               DO;                 /*                       @Z40LB61*/ 07331000
*                 MTCHMSG=ON;       /*                       @Z40LB61*/ 07332000
         L     @15,@PC00001+4                                      1756 07333000
         L     @15,MARGPTR(,@15)                                   1756 07334000
         OI    MTCHMSG(@15),B'00010000'                            1756 07335000
*                 MVTTBL(1)=ON;     /*                       @Z40LB61*/ 07336000
         OI    MVTTBL(@15),B'10000000'                             1757 07337000
*                 RPMTBL(2)=ON;     /*                       @Z40LB61*/ 07338000
         OI    RPMTBL+4(@15),B'00000010'                           1758 07339000
*                 RPFLD=ON;         /*                       @Z40LB61*/ 07340000
         OI    RPFLD(@15),B'00100000'                              1759 07341000
*                 FLDNUM(1)=RP#-1;  /*                       @Z40LB61*/ 07342000
         ST    @03,FLDNUM(,@15)                                    1760 07343000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @Z40LB61*/ 07344000
         L     @03,@PC00001                                        1761 07345000
         ST    @03,@AL00001                                        1761 07346000
         ST    @02,@AL00001+4                                      1761 07347000
         L     @15,@CV01495                                        1761 07348000
         LA    @01,@AL00001                                        1761 07349000
         BALR  @14,@15                                             1761 07350000
*               END;                /*                       @Z40LB61*/ 07351000
*                                                                  1762 07352000
*             /*******************************************************/ 07353000
*             /*                                                     */ 07354000
*             /* IF MSC VS. MSC CHECKING WAS REQUESTED,      @Z40LB61*/ 07355000
*             /* AND THE RPM ENTRY DOES NOT INDICATE THE     @Z40LB61*/ 07356000
*             /* PAGE IS NOT AVAILABLE OR PART OF A BOUND    @Z40LB61*/ 07357000
*             /* VOLUME, THEN FIRST DO COMMON SET-UP FOR     @Z40LB61*/ 07358000
*             /* POSSIBLE ERROR MESSAGES.                    @Z40LB61*/ 07359000
*             /*                                                     */ 07360000
*             /*******************************************************/ 07361000
*                                                                  1763 07362000
*             IF MSCCHK=ON&RPMNA(RP#)=OFF&RPMVBND(RP#)=OFF THEN    1763 07363000
@RF01754 L     @15,@PC00001+4                                      1763 07364000
         TM    MSCCHK(@15),B'10000000'                             1763 07365000
         BNO   @RF01763                                            1763 07366000
         LH    @15,RP#                                             1763 07367000
         SLA   @15,2                                               1763 07368000
         L     @01,RPMPTR                                          1763 07369000
         ALR   @01,@15                                             1763 07370000
         AL    @01,@CF01761                                        1763 07371000
         TM    RPMNA(@01),B'00010001'                              1763 07372000
         BNZ   @RF01763                                            1763 07373000
*RPMPABM:                                                          1764 07374000
*               DO;                 /*                       @Z40LB61*/ 07375000
RPMPABM  DS    0H                                                  1765 07376000
*                 INCNMSG=ON;       /*                       @Z40LB61*/ 07377000
         L     @15,@PC00001+4                                      1765 07378000
         L     @14,MARGPTR(,@15)                                   1765 07379000
         OI    INCNMSG(@14),B'10000000'                            1765 07380000
*                 PABTBL(1)=ON;     /*                       @Z40LB61*/ 07381000
         OI    PABTBL(@14),B'00010000'                             1766 07382000
*                 RPMTBL(2)=ON;     /*                       @Z40LB61*/ 07383000
         OI    RPMTBL+4(@14),B'00000010'                           1767 07384000
*                 SDGINDEX(1)=SDG#-1;/*                      @Z40LB61*/ 07385000
         LH    @05,SDG#                                            1768 07386000
         BCTR  @05,0                                               1768 07387000
         STC   @05,SDGINDEX(,@14)                                  1768 07388000
*                 LUAINDEX(1)=LUA#; /*                       @Z40LB61*/ 07389000
         MVC   LUAINDEX(1,@14),LUA#+1                              1769 07390000
*                 CHRINDEX(1)=SAVECHR;/*                     @Z40LB61*/ 07391000
         MVC   CHRINDEX(5,@14),SAVECHR                             1770 07392000
*                 MSGNRSET=ON;      /*                       @Z40LB61*/ 07393000
         OI    MSGNRSET(@14),B'00000001'                           1771 07394000
*                 TBLNRSET(1)=ON;   /*                       @Z40LB61*/ 07395000
         OI    TBLNRSET(@14),B'00000001'                           1772 07396000
*                 TBLNRSET(2)=ON;   /*                       @Z40LB61*/ 07397000
*                                                                  1773 07398000
         OI    TBLNRSET+4(@14),B'00000001'                         1773 07399000
*                 /***************************************************/ 07400000
*                 /*                                                 */ 07401000
*                 /* IF THE PAGE IS ACTIVE, ADD 1 TO THE     @Z40LB61*/ 07402000
*                 /* COUNT OF ACTIVE PAGES FOR THIS DEVICE   @Z40LB61*/ 07403000
*                 /*                                                 */ 07404000
*                 /***************************************************/ 07405000
*                                                                  1774 07406000
*                 IF RPMACT(RP#)=ON THEN                           1774 07407000
         LH    @05,RP#                                             1774 07408000
         SLA   @05,2                                               1774 07409000
         L     @01,RPMPTR                                          1774 07410000
         ALR   @01,@05                                             1774 07411000
         AL    @01,@CF01761                                        1774 07412000
         TM    RPMACT(@01),B'10000000'                             1774 07413000
         BNO   @RF01774                                            1774 07414000
*                   DO;             /*                       @Z40LB61*/ 07415000
*                     APCOUNT(DEV#)=APCOUNT(DEV#)+1;/*       @Z40LB61*/ 07416000
*                                                                  1776 07417000
         LH    @05,DEV#                                            1776 07418000
         LR    @04,@05                                             1776 07419000
         ALR   @04,@04                                             1776 07420000
         LA    @03,1                                               1776 07421000
         AH    @03,APCOUNT-2(@04)                                  1776 07422000
         STH   @03,APCOUNT-2(@04)                                  1776 07423000
*                     /***********************************************/ 07424000
*                     /*                                             */ 07425000
*                     /* IF THIS ACTIVE PAGE IS NOT REFLECTED        */ 07426000
*                     /*                                     @Z40LB61*/ 07427000
*                     /* IN THE PAB ACTIVE PAGE BIT MAP, THEN        */ 07428000
*                     /*                                     @Z40LB61*/ 07429000
*                     /* PRINT AN ERROR MESSAGE.             @Z40LB61*/ 07430000
*                     /*                                             */ 07431000
*                     /***********************************************/ 07432000
*                                                                  1777 07433000
*                     IF(PABAMAP(DEV#,BYTE#)&BITMASK(BIT#))=0 THEN 1777 07434000
         SLA   @05,3                                               1777 07435000
         L     @04,EARGPTR(,@15)                                   1777 07436000
         AH    @05,BYTE#(,@04)                                     1777 07437000
         LH    @01,BIT#(,@04)                                      1777 07438000
         L     @04,PABPTR                                          1777 07439000
         SLR   @00,@00                                             1777 07440000
         IC    @00,PABAMAP-9(@05,@04)                              1777 07441000
         SLR   @05,@05                                             1777 07442000
         IC    @05,BITMASK-1(@01)                                  1777 07443000
         NR    @00,@05                                             1777 07444000
         LTR   @00,@00                                             1777 07445000
         BNZ   @RF01777                                            1777 07446000
*                       DO;         /*                       @Z40LB61*/ 07447000
*                         APASFLD=ON;/*                      @Z40LB61*/ 07448000
         OI    APASFLD(@14),B'00010000'                            1779 07449000
*                         FLDCHAR(1)=STATNO;/*               @Z40LB61*/ 07450000
         MVI   FLDCHAR+3(@14),C' '                                 1780 07451000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1780 07452000
         MVC   FLDCHAR(3,@14),@CC01345                             1780 07453000
*                         FLDCHAR(2)=STATYES;/*              @Z40LB61*/ 07454000
         MVI   FLDCHAR+15(@14),C' '                                1781 07455000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1781 07456000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1781 07457000
*                         CALL IDCCH04(GDTTBL,CDALIST);/*    @Z40LB61*/ 07458000
         L     @14,@PC00001                                        1782 07459000
         ST    @14,@AL00001                                        1782 07460000
         ST    @15,@AL00001+4                                      1782 07461000
         L     @15,@CV01495                                        1782 07462000
         LA    @01,@AL00001                                        1782 07463000
         BALR  @14,@15                                             1782 07464000
*                       END;        /*                       @Z40LB61*/ 07465000
*                   END;            /*                       @Z40LB61*/ 07466000
*                 ELSE                                             1785 07467000
*                                                                  1785 07468000
*                   /*************************************************/ 07469000
*                   /*                                               */ 07470000
*                   /* IF THE PAGE IS INACTIVE, ADD 1 TO     @Z40LB61*/ 07471000
*                   /* THE COUNT OF INACTIVE PAGES FOR THIS  @Z40LB61*/ 07472000
*                   /* DEVICE                                @Z40LB61*/ 07473000
*                   /*                                               */ 07474000
*                   /*************************************************/ 07475000
*                                                                  1785 07476000
*                   IF RPMINACT(RP#)=ON THEN                       1785 07477000
         B     @RC01774                                            1785 07478000
@RF01774 LH    @15,RP#                                             1785 07479000
         SLA   @15,2                                               1785 07480000
         L     @01,RPMPTR                                          1785 07481000
         ALR   @01,@15                                             1785 07482000
         AL    @01,@CF01761                                        1785 07483000
         TM    RPMINACT(@01),B'01000000'                           1785 07484000
         BNO   @RF01785                                            1785 07485000
*                     IPCOUNT(DEV#)=IPCOUNT(DEV#)+1;/*       @Z40LB61*/ 07486000
         LH    @15,DEV#                                            1786 07487000
         ALR   @15,@15                                             1786 07488000
         LA    @14,1                                               1786 07489000
         AH    @14,IPCOUNT-2(@15)                                  1786 07490000
         STH   @14,IPCOUNT-2(@15)                                  1786 07491000
*                   ELSE                                           1787 07492000
*                                                                  1787 07493000
*                     /***********************************************/ 07494000
*                     /*                                             */ 07495000
*                     /* IF THE PAGE IS BOUND, ADD 1 TO THE  @Z40LB61*/ 07496000
*                     /* COUNT OF BOUND PAGES FOR THIS       @Z40LB61*/ 07497000
*                     /* DEVICE.                             @Z40LB61*/ 07498000
*                     /*                                             */ 07499000
*                     /***********************************************/ 07500000
*                                                                  1787 07501000
*                     IF RPMBND(RP#)=ON|RPMMSCT(RP#)=ON THEN       1787 07502000
         B     @RC01785                                            1787 07503000
@RF01785 LH    @15,RP#                                             1787 07504000
         SLA   @15,2                                               1787 07505000
         L     @01,RPMPTR                                          1787 07506000
         ALR   @01,@15                                             1787 07507000
         AL    @01,@CF01761                                        1787 07508000
         TM    RPMBND(@01),B'00100010'                             1787 07509000
         BZ    @RF01787                                            1787 07510000
*                       BPCOUNT(DEV#)=BPCOUNT(DEV#)+1;/*     @Z40LB61*/ 07511000
         LH    @15,DEV#                                            1788 07512000
         ALR   @15,@15                                             1788 07513000
         LA    @14,1                                               1788 07514000
         AH    @14,BPCOUNT-2(@15)                                  1788 07515000
         STH   @14,BPCOUNT-2(@15)                                  1788 07516000
*                     ELSE                                         1789 07517000
*                                                                  1789 07518000
*                       /*********************************************/ 07519000
*                       /*                                           */ 07520000
*                       /* THE PAGE MUST BE FREE, SO ADD 1   @Z40LB61*/ 07521000
*                       /* TO THE COUNT OF FREE PAGES FOR    @Z40LB61*/ 07522000
*                       /* THIS DEVICE. IF THIS FREE PAGE    @Z40LB61*/ 07523000
*                       /* IS NOT REFLECTED IN THE PAB FREE  @Z40LB61*/ 07524000
*                       /* PAGE BIT MAP, PRINT AN ERROR MSG  @Z40LB61*/ 07525000
*                       /*                                           */ 07526000
*                       /*********************************************/ 07527000
*                                                                  1789 07528000
*                       DO;         /*                       @Z40LB61*/ 07529000
         B     @RC01787                                            1789 07530000
@RF01787 DS    0H                                                  1790 07531000
*                         FPCOUNT(DEV#)=FPCOUNT(DEV#)+1;/*   @Z40LB61*/ 07532000
         LH    @15,DEV#                                            1790 07533000
         LR    @14,@15                                             1790 07534000
         ALR   @14,@14                                             1790 07535000
         LA    @05,1                                               1790 07536000
         AH    @05,FPCOUNT-2(@14)                                  1790 07537000
         STH   @05,FPCOUNT-2(@14)                                  1790 07538000
*                         IF(PABFMAP(DEV#,BYTE#)&BITMASK(BIT#))=0 THEN  07539000
         SLA   @15,3                                               1791 07540000
         L     @14,@PC00001+4                                      1791 07541000
         L     @05,EARGPTR(,@14)                                   1791 07542000
         AH    @15,BYTE#(,@05)                                     1791 07543000
         LH    @01,BIT#(,@05)                                      1791 07544000
         L     @05,PABPTR                                          1791 07545000
         SLR   @04,@04                                             1791 07546000
         IC    @04,PABFMAP-9(@15,@05)                              1791 07547000
         SLR   @05,@05                                             1791 07548000
         IC    @05,BITMASK-1(@01)                                  1791 07549000
         NR    @04,@05                                             1791 07550000
         LTR   @04,@04                                             1791 07551000
         BNZ   @RF01791                                            1791 07552000
*                           DO;     /*                       @Z40LB61*/ 07553000
*                             FPASFLD=ON;/*                  @Z40LB61*/ 07554000
         L     @15,MARGPTR(,@14)                                   1793 07555000
         OI    FPASFLD(@15),B'00000100'                            1793 07556000
*                             FLDCHAR(1)=STATNO;/*           @Z40LB61*/ 07557000
         MVI   FLDCHAR+3(@15),C' '                                 1794 07558000
         MVC   FLDCHAR+4(8,@15),FLDCHAR+3(@15)                     1794 07559000
         MVC   FLDCHAR(3,@15),@CC01345                             1794 07560000
*                             FLDCHAR(2)=STATYES;/*          @Z40LB61*/ 07561000
         MVI   FLDCHAR+15(@15),C' '                                1795 07562000
         MVC   FLDCHAR+16(8,@15),FLDCHAR+15(@15)                   1795 07563000
         MVC   FLDCHAR+12(3,@15),@CC01343                          1795 07564000
*                             CALL IDCCH04(GDTTBL,CDALIST);/*      1796 07565000
*                                                            @Z40LB61*/ 07566000
         L     @15,@PC00001                                        1796 07567000
         ST    @15,@AL00001                                        1796 07568000
         ST    @14,@AL00001+4                                      1796 07569000
         L     @15,@CV01495                                        1796 07570000
         LA    @01,@AL00001                                        1796 07571000
         BALR  @14,@15                                             1796 07572000
*                           END;    /*                       @Z40LB61*/ 07573000
*                       END;        /*                       @Z40LB61*/ 07574000
*                                                                  1798 07575000
@RF01791 DS    0H                                                  1799 07576000
*                 /***************************************************/ 07577000
*                 /*                                                 */ 07578000
*                 /* RESET THE 'IDCCH04' OPTION FLAGS        @Z40LB61*/ 07579000
*                 /*                                                 */ 07580000
*                 /***************************************************/ 07581000
*                                                                  1799 07582000
*                 MSGTYPE=''B;      /*                       @Z40LB61*/ 07583000
@RC01787 DS    0H                                                  1799 07584000
@RC01785 DS    0H                                                  1799 07585000
@RC01774 L     @15,@PC00001+4                                      1799 07586000
         L     @15,MARGPTR(,@15)                                   1799 07587000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1799 07588000
*                 TBLTYPE(1)=''B;   /*                       @Z40LB61*/ 07589000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1800 07590000
*                 TBLTYPE(2)=''B;   /*                       @Z40LB61*/ 07591000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1801 07592000
*               END RPMPABM;        /*                       @Z40LB61*/ 07593000
*           END RPLOOP;             /*                       @Z40LB61*/ 07594000
@RF01763 LA    @15,1                                               1803 07595000
         AH    @15,RP#                                             1803 07596000
@DE01747 STH   @15,RP#                                             1803 07597000
         CH    @15,PGLIMIT                                         1803 07598000
         BNH   @DL01747                                            1803 07599000
*         END GOODDEV2;             /*                       @Z40LB61*/ 07600000
*     END DEVLOOP2;                 /*                       @Z40LB61*/ 07601000
*                                                                  1805 07602000
@RF01728 LA    @15,1                                               1805 07603000
         AH    @15,DEV#                                            1805 07604000
         STH   @15,DEV#                                            1805 07605000
         CH    @15,@CH00183                                        1805 07606000
         BNH   @DL01723                                            1805 07607000
*     /***************************************************************/ 07608000
*     /*                                                             */ 07609000
*     /* GO PERFORM FURTHER CHECKING INVOLVING SUMS,         @Z40LB61*/ 07610000
*     /* COUNTS, AND TOTALS FOR THE PAGES OF THIS SDG.       @Z40LB61*/ 07611000
*     /*                                                             */ 07612000
*     /***************************************************************/ 07613000
*                                                                  1806 07614000
*     CALL CHKSUMS;                 /*                       @Z40LB61*/ 07615000
         BAL   @14,CHKSUMS                                         1806 07616000
*   END SDGLOOP;                    /*                       @Z40LB61*/ 07617000
         LA    @15,1                                               1807 07618000
         AH    @15,SDG#                                            1807 07619000
         STH   @15,SDG#                                            1807 07620000
         CH    @15,@CH00781                                        1807 07621000
         BNH   @DL01695                                            1807 07622000
*   END SCANSUMS;                   /*                       @Z40LB61*/ 07623000
         B     @EL00011                                            1808 07624000
*                                                                  1809 07625000
*/********************************************************************/ 07626000
*/*                                                          @Z40LB61*/ 07627000
*/* PROCEDURE NAME - CHKSUMS                                 @Z40LB61*/ 07628000
*/*                                                          @Z40LB61*/ 07629000
*/* FUNCTION - THIS ROUTINE COMPARES SDG PAGE ALLOCATION     @Z40LB61*/ 07630000
*/*            TOTALS WITH SUM TOTALS ACCUMULATED DURING     @Z40LB61*/ 07631000
*/*            INDIVIDUAL PAGE ANALYSIS.                     @Z40LB61*/ 07632000
*/*                                                          @Z40LB61*/ 07633000
*/*            ALSO CHECKED IS DEVICE DATA ASSOCIATED WITH   @Z40LB61*/ 07634000
*/*            THE STAGING DEVICES OF EACH SDG.              @Z40LB61*/ 07635000
*/*                                                          @Z40LB61*/ 07636000
*/* INPUT -                                                  @Z40LB61*/ 07637000
*/*        (1) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 07638000
*/*        (2) MSC CONFIGURATION BIT MAP                     @Z40LB61*/ 07639000
*/*        (3) MSC SDG PAGE AVAILABILITY BLOCK               @Z40LB61*/ 07640000
*/*        (4) REAL PAGE MAP PAGE STATUS SUM TOTALS          @Z40LB61*/ 07641000
*/*        (5) SA LOGICAL-TO-REAL TABLE                      @Z40LB61*/ 07642000
*/*                                                          @Z40LB61*/ 07643000
*/* OUTPUT -                                                 @Z40LB61*/ 07644000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 07645000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 07646000
*/*                                                          @Z40LB61*/ 07647000
*/********************************************************************/ 07648000
*                                                                  1809 07649000
*CHKSUMS:                                                          1809 07650000
*   PROCEDURE;                      /*                       @Z40LB61*/ 07651000
CHKSUMS  STM   @14,@12,@SA00012                                    1809 07652000
*   OLDERID2=NEWERID2;                                             1810 07653000
         L     @15,@PC00001                                        1810 07654000
         L     @15,GDTTR2(,@15)                                    1810 07655000
         MVC   @TS00001(95),NEWERID2(@15)                          1810 07656000
         MVC   OLDERID2(95,@15),@TS00001                           1810 07657000
*   NEWID2='CH2U';                  /*                       @Z40LB61*/ 07658000
*                                                                  1811 07659000
         MVC   NEWID2(4,@15),@CC01674                              1811 07660000
*   /*****************************************************************/ 07661000
*   /*                                                               */ 07662000
*   /* PERFORM CHECKING FOR EACH DEVICE OF THIS SDG.         @Z40LB61*/ 07663000
*   /*                                                               */ 07664000
*   /*****************************************************************/ 07665000
*                                                                  1812 07666000
*   LRUDCNT=0;                      /*                       @Z40LB61*/ 07667000
         SLR   @15,@15                                             1812 07668000
         STH   @15,LRUDCNT                                         1812 07669000
*DEVLOOP3:                                                         1813 07670000
*   DO DEV#=1 TO DEVSSDG;           /*                       @Z40LB61*/ 07671000
*                                                                  1813 07672000
DEVLOOP3 LA    @15,1                                               1813 07673000
         STH   @15,DEV#                                            1813 07674000
@DL01813 DS    0H                                                  1814 07675000
*     /***************************************************************/ 07676000
*     /*                                                             */ 07677000
*     /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES        @Z40LB61*/ 07678000
*     /*                                                             */ 07679000
*     /***************************************************************/ 07680000
*                                                                  1814 07681000
*     SDGINDEX(2)=SDG#-1;           /*                       @Z40LB61*/ 07682000
         L     @14,@PC00001+4                                      1814 07683000
         L     @14,MARGPTR(,@14)                                   1814 07684000
         LH    @05,SDG#                                            1814 07685000
         BCTR  @05,0                                               1814 07686000
         STC   @05,SDGINDEX+24(,@14)                               1814 07687000
*     IF PAB3333(1)=ON THEN                                        1815 07688000
         L     @01,PABPTR                                          1815 07689000
         TM    PAB3333(@01),B'00010000'                            1815 07690000
         BNO   @RF01815                                            1815 07691000
*       LUAINDEX(2)=DEV#+DEVSSDG-1; /*                       @Z40LB61*/ 07692000
         SH    @15,@CH01733                                        1816 07693000
         STC   @15,LUAINDEX+24(,@14)                               1816 07694000
*     ELSE                                                         1817 07695000
*       LUAINDEX(2)=DEV#-1;         /*                       @Z40LB61*/ 07696000
         B     @RC01815                                            1817 07697000
@RF01815 L     @15,@PC00001+4                                      1817 07698000
         L     @01,MARGPTR(,@15)                                   1817 07699000
         LH    @00,DEV#                                            1817 07700000
         BCTR  @00,0                                               1817 07701000
         STC   @00,LUAINDEX+24(,@01)                               1817 07702000
*     CHRINDEX(2)=SAVECHR;          /*                       @Z40LB61*/ 07703000
*                                                                  1818 07704000
@RC01815 L     @15,@PC00001+4                                      1818 07705000
         L     @01,MARGPTR(,@15)                                   1818 07706000
         MVC   CHRINDEX+24(5,@01),SAVECHR                          1818 07707000
*     /***************************************************************/ 07708000
*     /*                                                             */ 07709000
*     /* IF MSC-MSC CHECKING WAS REQUESTED, PERFORM          @Z40LB61*/ 07710000
*     /* CHECKING BETWEEN THE PAB AND REAL PAGE MAPS         @Z40LB61*/ 07711000
*     /*                                                             */ 07712000
*     /***************************************************************/ 07713000
*                                                                  1819 07714000
*     IF MSCCHK=ON THEN                                            1819 07715000
         TM    MSCCHK(@15),B'10000000'                             1819 07716000
         BNO   @RF01819                                            1819 07717000
*CHKSUMS1:                                                         1820 07718000
*       DO;                         /*                       @Z40LB61*/ 07719000
*                                                                  1820 07720000
CHKSUMS1 DS    0H                                                  1821 07721000
*         /***********************************************************/ 07722000
*         /*                                                         */ 07723000
*         /* COUNT UP ALL THE BITS SET 'ON' IN THE PAB FREE  @Z40LB61*/ 07724000
*         /* PAGE BIT MAP AND PAB ACTIVE PAGE BIT MAP        @Z40LB61*/ 07725000
*         /*                                                         */ 07726000
*         /***********************************************************/ 07727000
*                                                                  1821 07728000
*         FPBITCNT=0;               /*                       @Z40LB61*/ 07729000
         SLR   @15,@15                                             1821 07730000
         STH   @15,FPBITCNT                                        1821 07731000
*         APBITCNT=0;               /*                       @Z40LB61*/ 07732000
         STH   @15,APBITCNT                                        1822 07733000
*         WORKVAL1=1;               /*                       @Z40LB61*/ 07734000
         LA    @15,1                                               1823 07735000
         STH   @15,WORKVAL1                                        1823 07736000
*         DO BYTE#=1 TO(RPMAX-1)/8+1;/*                      @Z40LB61*/ 07737000
         L     @14,@PC00001+4                                      1824 07738000
         L     @14,EARGPTR(,@14)                                   1824 07739000
         STH   @15,BYTE#(,@14)                                     1824 07740000
@DL01824 DS    0H                                                  1825 07741000
*           DO BIT#=1 TO 8 WHILE(WORKVAL1<=RPMAX);/*         @Z40LB61*/ 07742000
         LA    @15,1                                               1825 07743000
         L     @14,@PC00001+4                                      1825 07744000
         L     @14,EARGPTR(,@14)                                   1825 07745000
         STH   @15,BIT#(,@14)                                      1825 07746000
@DL01825 LH    @15,WORKVAL1                                        1825 07747000
         CH    @15,@CH00684                                        1825 07748000
         BH    @DC01825                                            1825 07749000
*             IF(PABFMAP(DEV#,BYTE#)&BITMASK(BIT#))^=0 THEN        1826 07750000
         LH    @15,DEV#                                            1826 07751000
         SLA   @15,3                                               1826 07752000
         L     @14,@PC00001+4                                      1826 07753000
         L     @14,EARGPTR(,@14)                                   1826 07754000
         AH    @15,BYTE#(,@14)                                     1826 07755000
         LH    @01,BIT#(,@14)                                      1826 07756000
         L     @14,PABPTR                                          1826 07757000
         SLR   @00,@00                                             1826 07758000
         IC    @00,PABFMAP-9(@15,@14)                              1826 07759000
         SLR   @15,@15                                             1826 07760000
         IC    @15,BITMASK-1(@01)                                  1826 07761000
         NR    @00,@15                                             1826 07762000
         LTR   @00,@00                                             1826 07763000
         BZ    @RF01826                                            1826 07764000
*               FPBITCNT=FPBITCNT+1;/*                       @Z40LB61*/ 07765000
         LA    @15,1                                               1827 07766000
         AH    @15,FPBITCNT                                        1827 07767000
         STH   @15,FPBITCNT                                        1827 07768000
*             IF(PABAMAP(DEV#,BYTE#)&BITMASK(BIT#))^=0 THEN        1828 07769000
@RF01826 LH    @15,DEV#                                            1828 07770000
         SLA   @15,3                                               1828 07771000
         L     @14,@PC00001+4                                      1828 07772000
         L     @14,EARGPTR(,@14)                                   1828 07773000
         AH    @15,BYTE#(,@14)                                     1828 07774000
         LH    @01,BIT#(,@14)                                      1828 07775000
         L     @14,PABPTR                                          1828 07776000
         SLR   @00,@00                                             1828 07777000
         IC    @00,PABAMAP-9(@15,@14)                              1828 07778000
         SLR   @15,@15                                             1828 07779000
         IC    @15,BITMASK-1(@01)                                  1828 07780000
         NR    @00,@15                                             1828 07781000
         LTR   @00,@00                                             1828 07782000
         BZ    @RF01828                                            1828 07783000
*               APBITCNT=APBITCNT+1;/*                       @Z40LB61*/ 07784000
         LA    @15,1                                               1829 07785000
         AH    @15,APBITCNT                                        1829 07786000
         STH   @15,APBITCNT                                        1829 07787000
*             WORKVAL1=WORKVAL1+1;  /*                       @Z40LB61*/ 07788000
@RF01828 LA    @15,1                                               1830 07789000
         AH    @15,WORKVAL1                                        1830 07790000
         STH   @15,WORKVAL1                                        1830 07791000
*           END;                    /*                       @Z40LB61*/ 07792000
         L     @14,@PC00001+4                                      1831 07793000
         L     @01,EARGPTR(,@14)                                   1831 07794000
         LA    @15,1                                               1831 07795000
         AH    @15,BIT#(,@01)                                      1831 07796000
         L     @14,@PC00001+4                                      1831 07797000
         L     @14,EARGPTR(,@14)                                   1831 07798000
         STH   @15,BIT#(,@14)                                      1831 07799000
         CH    @15,@CH00183                                        1831 07800000
         BNH   @DL01825                                            1831 07801000
@DC01825 DS    0H                                                  1832 07802000
*         END;                      /*                       @Z40LB61*/ 07803000
*                                                                  1832 07804000
         L     @14,@PC00001+4                                      1832 07805000
         L     @01,EARGPTR(,@14)                                   1832 07806000
         LA    @15,1                                               1832 07807000
         AH    @15,BYTE#(,@01)                                     1832 07808000
         L     @14,@PC00001+4                                      1832 07809000
         L     @14,EARGPTR(,@14)                                   1832 07810000
         STH   @15,BYTE#(,@14)                                     1832 07811000
         CH    @15,@CH00769                                        1832 07812000
         BNH   @DL01824                                            1832 07813000
*         /***********************************************************/ 07814000
*         /*                                                         */ 07815000
*         /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES    @Z40LB61*/ 07816000
*         /*                                                         */ 07817000
*         /***********************************************************/ 07818000
*                                                                  1833 07819000
*         PABTBL(2)=ON;             /*                       @Z40LB61*/ 07820000
         L     @15,@PC00001+4                                      1833 07821000
         L     @14,MARGPTR(,@15)                                   1833 07822000
         OI    PABTBL+4(@14),B'00010000'                           1833 07823000
*         SUMSMSG=ON;               /*                       @Z40LB61*/ 07824000
         OI    SUMSMSG(@14),B'00100000'                            1834 07825000
*         MSGNRSET=ON;              /*                       @Z40LB61*/ 07826000
         OI    MSGNRSET(@14),B'00000001'                           1835 07827000
*         TBLNRSET(2)=ON;           /*                       @Z40LB61*/ 07828000
*                                                                  1836 07829000
         OI    TBLNRSET+4(@14),B'00000001'                         1836 07830000
*         /***********************************************************/ 07831000
*         /*                                                         */ 07832000
*         /* IF THE SUM OF FREE PAGES FROM THE PAB FREE PAGE @Z40LB61*/ 07833000
*         /* BIT MAP DOES NOT EQUAL THE PAB FREE PAGE COUNT  @Z40LB61*/ 07834000
*         /* FIELD FOR THIS DEVICE, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 07835000
*         /*                                                         */ 07836000
*         /***********************************************************/ 07837000
*                                                                  1837 07838000
*         IF FPBITCNT^=PABFCNT(DEV#) THEN                          1837 07839000
         LH    @05,FPBITCNT                                        1837 07840000
         LH    @04,DEV#                                            1837 07841000
         SLA   @04,2                                               1837 07842000
         L     @01,PABPTR                                          1837 07843000
         SLR   @03,@03                                             1837 07844000
         IC    @03,PABFCNT-4(@04,@01)                              1837 07845000
         CR    @05,@03                                             1837 07846000
         BE    @RF01837                                            1837 07847000
*           DO;                     /*                       @Z40LB61*/ 07848000
*             PABTBL(1)=ON;         /*                       @Z40LB61*/ 07849000
         OI    PABTBL(@14),B'00010000'                             1839 07850000
*             FPFLD=ON;             /*                       @Z40LB61*/ 07851000
         OI    FPFLD(@14),B'00000100'                              1840 07852000
*             FLDNUM(1)=FPBITCNT;   /*                       @Z40LB61*/ 07853000
         ST    @05,FLDNUM(,@14)                                    1841 07854000
*             FLDNUM(2)=PABFCNT(DEV#);/*                     @Z40LB61*/ 07855000
         ST    @03,FLDNUM+12(,@14)                                 1842 07856000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 07857000
         L     @14,@PC00001                                        1843 07858000
         ST    @14,@AL00001                                        1843 07859000
         ST    @15,@AL00001+4                                      1843 07860000
         L     @15,@CV01495                                        1843 07861000
         LA    @01,@AL00001                                        1843 07862000
         BALR  @14,@15                                             1843 07863000
*           END;                    /*                       @Z40LB61*/ 07864000
*                                                                  1844 07865000
*         /***********************************************************/ 07866000
*         /*                                                         */ 07867000
*         /* IF THE SUM OF ACTIVE PAGES FROM PAB ACTIVE PAGE @Z40LB61*/ 07868000
*         /* BIT MAP DOES NOT EQUAL THE PAB ACTIVE PAGE COUNT        */ 07869000
*         /*                                                 @Z40LB61*/ 07870000
*         /* FIELD FOR THIS DEVICE, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 07871000
*         /*                                                         */ 07872000
*         /***********************************************************/ 07873000
*                                                                  1845 07874000
*         IF APBITCNT^=PABACNT(DEV#) THEN                          1845 07875000
@RF01837 LH    @15,APBITCNT                                        1845 07876000
         LH    @14,DEV#                                            1845 07877000
         SLA   @14,2                                               1845 07878000
         L     @01,PABPTR                                          1845 07879000
         SLR   @05,@05                                             1845 07880000
         IC    @05,PABACNT-4(@14,@01)                              1845 07881000
         CR    @15,@05                                             1845 07882000
         BE    @RF01845                                            1845 07883000
*           DO;                     /*                       @Z40LB61*/ 07884000
*             PABTBL(1)=ON;         /*                       @Z40LB61*/ 07885000
         L     @04,@PC00001+4                                      1847 07886000
         L     @14,MARGPTR(,@04)                                   1847 07887000
         OI    PABTBL(@14),B'00010000'                             1847 07888000
*             APFLD=ON;             /*                       @Z40LB61*/ 07889000
         OI    APFLD(@14),B'00000010'                              1848 07890000
*             FLDNUM(1)=APBITCNT;   /*                       @Z40LB61*/ 07891000
         ST    @15,FLDNUM(,@14)                                    1849 07892000
*             FLDNUM(2)=PABACNT(DEV#);/*                     @Z40LB61*/ 07893000
         ST    @05,FLDNUM+12(,@14)                                 1850 07894000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 07895000
         L     @05,@PC00001                                        1851 07896000
         ST    @05,@AL00001                                        1851 07897000
         ST    @04,@AL00001+4                                      1851 07898000
         L     @15,@CV01495                                        1851 07899000
         LA    @01,@AL00001                                        1851 07900000
         BALR  @14,@15                                             1851 07901000
*           END;                    /*                       @Z40LB61*/ 07902000
*                                                                  1852 07903000
*         /***********************************************************/ 07904000
*         /*                                                         */ 07905000
*         /* IF THE SUM OF FREE PAGES FROM THE REAL PAGE MAP @Z40LB61*/ 07906000
*         /* ENTRIES DOES NOT EQUAL THE PAB FREE PAGE COUNT  @Z40LB61*/ 07907000
*         /* FIELD FOR THIS DEVICE, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 07908000
*         /*                                                         */ 07909000
*         /***********************************************************/ 07910000
*                                                                  1853 07911000
*         IF FPCOUNT(DEV#)^=PABFCNT(DEV#) THEN                     1853 07912000
@RF01845 LH    @15,DEV#                                            1853 07913000
         LR    @14,@15                                             1853 07914000
         ALR   @14,@14                                             1853 07915000
         LH    @14,FPCOUNT-2(@14)                                  1853 07916000
         SLA   @15,2                                               1853 07917000
         L     @01,PABPTR                                          1853 07918000
         SLR   @05,@05                                             1853 07919000
         IC    @05,PABFCNT-4(@15,@01)                              1853 07920000
         CR    @14,@05                                             1853 07921000
         BE    @RF01853                                            1853 07922000
*           DO;                     /*                       @Z40LB61*/ 07923000
*             RPMTBL(1)=ON;         /*                       @Z40LB61*/ 07924000
         L     @15,@PC00001+4                                      1855 07925000
         L     @04,MARGPTR(,@15)                                   1855 07926000
         OI    RPMTBL(@04),B'00000010'                             1855 07927000
*             FPFLD=ON;             /*                       @Z40LB61*/ 07928000
         OI    FPFLD(@04),B'00000100'                              1856 07929000
*             FLDNUM(1)=FPCOUNT(DEV#);/*                     @Z40LB61*/ 07930000
         ST    @14,FLDNUM(,@04)                                    1857 07931000
*             FLDNUM(2)=PABFCNT(DEV#);/*                     @Z40LB61*/ 07932000
         ST    @05,FLDNUM+12(,@04)                                 1858 07933000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 07934000
         L     @14,@PC00001                                        1859 07935000
         ST    @14,@AL00001                                        1859 07936000
         ST    @15,@AL00001+4                                      1859 07937000
         L     @15,@CV01495                                        1859 07938000
         LA    @01,@AL00001                                        1859 07939000
         BALR  @14,@15                                             1859 07940000
*           END;                    /*                       @Z40LB61*/ 07941000
*                                                                  1860 07942000
*         /***********************************************************/ 07943000
*         /*                                                         */ 07944000
*         /* IF THE SUM OF ACTIVE PAGES FROM THE RPM         @Z40LB61*/ 07945000
*         /* ENTRIES DOES NOT EQUAL THE PAB ACTIVE PAGE COUNT        */ 07946000
*         /*                                                 @Z40LB61*/ 07947000
*         /* FIELD FOR THIS DEVICE, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 07948000
*         /*                                                         */ 07949000
*         /***********************************************************/ 07950000
*                                                                  1861 07951000
*         IF APCOUNT(DEV#)^=PABACNT(DEV#) THEN                     1861 07952000
@RF01853 LH    @15,DEV#                                            1861 07953000
         LR    @14,@15                                             1861 07954000
         ALR   @14,@14                                             1861 07955000
         LH    @14,APCOUNT-2(@14)                                  1861 07956000
         SLA   @15,2                                               1861 07957000
         L     @01,PABPTR                                          1861 07958000
         SLR   @05,@05                                             1861 07959000
         IC    @05,PABACNT-4(@15,@01)                              1861 07960000
         CR    @14,@05                                             1861 07961000
         BE    @RF01861                                            1861 07962000
*           DO;                     /*                       @Z40LB61*/ 07963000
*             RPMTBL(1)=ON;         /*                       @Z40LB61*/ 07964000
         L     @15,@PC00001+4                                      1863 07965000
         L     @04,MARGPTR(,@15)                                   1863 07966000
         OI    RPMTBL(@04),B'00000010'                             1863 07967000
*             APFLD=ON;             /*                       @Z40LB61*/ 07968000
         OI    APFLD(@04),B'00000010'                              1864 07969000
*             FLDNUM(1)=APCOUNT(DEV#);/*                     @Z40LB61*/ 07970000
         ST    @14,FLDNUM(,@04)                                    1865 07971000
*             FLDNUM(2)=PABACNT(DEV#);/*                     @Z40LB61*/ 07972000
         ST    @05,FLDNUM+12(,@04)                                 1866 07973000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 07974000
         L     @14,@PC00001                                        1867 07975000
         ST    @14,@AL00001                                        1867 07976000
         ST    @15,@AL00001+4                                      1867 07977000
         L     @15,@CV01495                                        1867 07978000
         LA    @01,@AL00001                                        1867 07979000
         BALR  @14,@15                                             1867 07980000
*           END;                    /*                       @Z40LB61*/ 07981000
*                                                                  1868 07982000
*         /***********************************************************/ 07983000
*         /*                                                         */ 07984000
*         /* IF THE SUM OF INACTIVE PAGES FROM RPM ENTRIES   @Z40LB61*/ 07985000
*         /* DOES NOT EQUAL THE PAB INACTIVE PAGE COUNT      @Z40LB61*/ 07986000
*         /* FIELD FOR THIS DEVICE, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 07987000
*         /*                                                         */ 07988000
*         /***********************************************************/ 07989000
*                                                                  1869 07990000
*         IF IPCOUNT(DEV#)^=PABICNT(DEV#) THEN                     1869 07991000
@RF01861 LH    @15,DEV#                                            1869 07992000
         LR    @14,@15                                             1869 07993000
         ALR   @14,@14                                             1869 07994000
         LH    @14,IPCOUNT-2(@14)                                  1869 07995000
         SLA   @15,2                                               1869 07996000
         L     @01,PABPTR                                          1869 07997000
         SLR   @05,@05                                             1869 07998000
         IC    @05,PABICNT-4(@15,@01)                              1869 07999000
         CR    @14,@05                                             1869 08000000
         BE    @RF01869                                            1869 08001000
*           DO;                     /*                       @Z40LB61*/ 08002000
*             RPMTBL(1)=ON;         /*                       @Z40LB61*/ 08003000
         L     @15,@PC00001+4                                      1871 08004000
         L     @04,MARGPTR(,@15)                                   1871 08005000
         OI    RPMTBL(@04),B'00000010'                             1871 08006000
*             IPFLD=ON;             /*                       @Z40LB61*/ 08007000
         OI    IPFLD(@04),B'00000001'                              1872 08008000
*             FLDNUM(1)=IPCOUNT(DEV#);/*                     @Z40LB61*/ 08009000
         ST    @14,FLDNUM(,@04)                                    1873 08010000
*             FLDNUM(2)=PABICNT(DEV#);/*                     @Z40LB61*/ 08011000
         ST    @05,FLDNUM+12(,@04)                                 1874 08012000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 08013000
         L     @14,@PC00001                                        1875 08014000
         ST    @14,@AL00001                                        1875 08015000
         ST    @15,@AL00001+4                                      1875 08016000
         L     @15,@CV01495                                        1875 08017000
         LA    @01,@AL00001                                        1875 08018000
         BALR  @14,@15                                             1875 08019000
*           END;                    /*                       @Z40LB61*/ 08020000
*                                                                  1876 08021000
*         /***********************************************************/ 08022000
*         /*                                                         */ 08023000
*         /* IF THE SUM OF BOUND PAGES FROM THE RPM          @Z40LB61*/ 08024000
*         /* ENTRIES DOES NOT EQUAL THE PAB BOUND PAGE COUNT @Z40LB61*/ 08025000
*         /* FIELD FOR THIS DEVICE, PRINT AN ERROR MESSAGE.  @Z40LB61*/ 08026000
*         /*                                                         */ 08027000
*         /***********************************************************/ 08028000
*                                                                  1877 08029000
*         IF BPCOUNT(DEV#)^=PABBCNT(DEV#) THEN                     1877 08030000
@RF01869 LH    @15,DEV#                                            1877 08031000
         LR    @14,@15                                             1877 08032000
         ALR   @14,@14                                             1877 08033000
         LH    @14,BPCOUNT-2(@14)                                  1877 08034000
         SLA   @15,2                                               1877 08035000
         L     @01,PABPTR                                          1877 08036000
         SLR   @05,@05                                             1877 08037000
         IC    @05,PABBCNT-4(@15,@01)                              1877 08038000
         CR    @14,@05                                             1877 08039000
         BE    @RF01877                                            1877 08040000
*           DO;                     /*                       @Z40LB61*/ 08041000
*             RPMTBL(1)=ON;         /*                       @Z40LB61*/ 08042000
         L     @15,@PC00001+4                                      1879 08043000
         L     @04,MARGPTR(,@15)                                   1879 08044000
         OI    RPMTBL(@04),B'00000010'                             1879 08045000
*             BPFLD=ON;             /*                       @Z40LB61*/ 08046000
         OI    BPFLD(@04),B'10000000'                              1880 08047000
*             FLDNUM(1)=BPCOUNT(DEV#);/*                     @Z40LB61*/ 08048000
         ST    @14,FLDNUM(,@04)                                    1881 08049000
*             FLDNUM(2)=PABBCNT(DEV#);/*                     @Z40LB61*/ 08050000
         ST    @05,FLDNUM+12(,@04)                                 1882 08051000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 08052000
         L     @14,@PC00001                                        1883 08053000
         ST    @14,@AL00001                                        1883 08054000
         ST    @15,@AL00001+4                                      1883 08055000
         L     @15,@CV01495                                        1883 08056000
         LA    @01,@AL00001                                        1883 08057000
         BALR  @14,@15                                             1883 08058000
*           END;                    /*                       @Z40LB61*/ 08059000
*                                                                  1884 08060000
*         /***********************************************************/ 08061000
*         /*                                                         */ 08062000
*         /* RESET THE 'IDCCH04' OPTION FLAGS                @Z40LB61*/ 08063000
*         /*                                                         */ 08064000
*         /***********************************************************/ 08065000
*                                                                  1885 08066000
*         MSGTYPE=''B;              /*                       @Z40LB61*/ 08067000
@RF01877 L     @15,@PC00001+4                                      1885 08068000
         L     @15,MARGPTR(,@15)                                   1885 08069000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1885 08070000
*         TBLTYPE(1)=''B;           /*                       @Z40LB61*/ 08071000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1886 08072000
*         TBLTYPE(2)=''B;           /*                       @Z40LB61*/ 08073000
*                                                                  1887 08074000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1887 08075000
*         /***********************************************************/ 08076000
*         /*                                                         */ 08077000
*         /* ADD THE PAGE COUNTS FOR THE CURRENT DEVICE OF   @Z40LB61*/ 08078000
*         /* THIS SDG TO THE SUM TOTAL BEING ACCUMULATED     @Z40LB61*/ 08079000
*         /* IF THIS DEVICE IS VARIED ON VIRTUAL.            @Z40LB64*/ 08080000
*         /*                                                         */ 08081000
*         /***********************************************************/ 08082000
*                                                                  1888 08083000
*         IF PABVARV(DEV#)=ON THEN                                 1888 08084000
         L     @15,PABPTR                                          1888 08085000
         LH    @14,DEV#                                            1888 08086000
         SLA   @14,2                                               1888 08087000
         ST    @14,@TF00001                                        1888 08088000
         ALR   @14,@15                                             1888 08089000
         TM    PABVARV-4(@14),B'01000000'                          1888 08090000
         BNO   @RF01888                                            1888 08091000
*           DO;                     /*                       @Z40LB64*/ 08092000
*             FPTOTAL=FPTOTAL+PABFCNT(DEV#);/*               @Z40LB61*/ 08093000
         L     @14,@TF00001                                        1890 08094000
         SLR   @05,@05                                             1890 08095000
         IC    @05,PABFCNT-4(@14,@15)                              1890 08096000
         AH    @05,FPTOTAL                                         1890 08097000
         STH   @05,FPTOTAL                                         1890 08098000
*             APTOTAL=APTOTAL+PABACNT(DEV#);/*               @Z40LB61*/ 08099000
         L     @14,@TF00001                                        1891 08100000
         SLR   @05,@05                                             1891 08101000
         IC    @05,PABACNT-4(@14,@15)                              1891 08102000
         AH    @05,APTOTAL                                         1891 08103000
         STH   @05,APTOTAL                                         1891 08104000
*             IPTOTAL=IPTOTAL+PABICNT(DEV#);/*               @Z40LB61*/ 08105000
         L     @14,@TF00001                                        1892 08106000
         SLR   @05,@05                                             1892 08107000
         IC    @05,PABICNT-4(@14,@15)                              1892 08108000
         AH    @05,IPTOTAL                                         1892 08109000
         STH   @05,IPTOTAL                                         1892 08110000
*             BPTOTAL=BPTOTAL+PABBCNT(DEV#);/*               @Z40LB61*/ 08111000
         L     @14,@TF00001                                        1893 08112000
         SLR   @05,@05                                             1893 08113000
         IC    @05,PABBCNT-4(@14,@15)                              1893 08114000
         AH    @05,BPTOTAL                                         1893 08115000
         STH   @05,BPTOTAL                                         1893 08116000
*           END;                    /*                       @Z40LB64*/ 08117000
*                                                                  1894 08118000
*         /***********************************************************/ 08119000
*         /*                                                         */ 08120000
*         /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES    @Z40LB61*/ 08121000
*         /*                                                         */ 08122000
*         /***********************************************************/ 08123000
*                                                                  1895 08124000
*         INCNMSG=ON;               /*                       @Z40LB61*/ 08125000
@RF01888 L     @15,@PC00001+4                                      1895 08126000
         L     @14,MARGPTR(,@15)                                   1895 08127000
         OI    INCNMSG(@14),B'10000000'                            1895 08128000
*         CBMTBL(1)=ON;             /*                       @Z40LB61*/ 08129000
         OI    CBMTBL(@14),B'00001000'                             1896 08130000
*         PABTBL(2)=ON;             /*                       @Z40LB61*/ 08131000
         OI    PABTBL+4(@14),B'00010000'                           1897 08132000
*         SDGINDEX(1)=SDGINDEX(2);  /*                       @Z40LB61*/ 08133000
         MVC   SDGINDEX(1,@14),SDGINDEX+24(@14)                    1898 08134000
*         LUAINDEX(1)=LUAINDEX(2);  /*                       @Z40LB61*/ 08135000
         MVC   LUAINDEX(1,@14),LUAINDEX+24(@14)                    1899 08136000
*         MSGNRSET=ON;              /*                       @Z40LB61*/ 08137000
         OI    MSGNRSET(@14),B'00000001'                           1900 08138000
*         TBLNRSET(1)=ON;           /*                       @Z40LB61*/ 08139000
         OI    TBLNRSET(@14),B'00000001'                           1901 08140000
*         TBLNRSET(2)=ON;           /*                       @Z40LB61*/ 08141000
*                                                                  1902 08142000
         OI    TBLNRSET+4(@14),B'00000001'                         1902 08143000
*         /***********************************************************/ 08144000
*         /*                                                         */ 08145000
*         /* CHECK 'DEVICE VALID' STATUS BETWEEN THE PAB AND @Z40LB61*/ 08146000
*         /* THE CONFIGURATION BIT MAP. IF INCONSISTENT,     @Z40LB61*/ 08147000
*         /* PRINT AN ERROR MESSAGE.                         @Z40LB61*/ 08148000
*         /*                                                         */ 08149000
*         /***********************************************************/ 08150000
*                                                                  1903 08151000
*         CBMPTR=CBMADDR;           /*                       @Z40LB61*/ 08152000
         L     @05,CBMADDR(,@15)                                   1903 08153000
         ST    @05,CBMPTR                                          1903 08154000
*         IF PABDEX(DEV#)=OFF THEN                                 1904 08155000
         LH    @04,DEV#                                            1904 08156000
         LR    @03,@04                                             1904 08157000
         SLA   @03,2                                               1904 08158000
         L     @01,PABPTR                                          1904 08159000
         ALR   @01,@03                                             1904 08160000
         TM    PABDEX-4(@01),B'10000000'                           1904 08161000
         BNZ   @RF01904                                            1904 08162000
*           IF(CBMDRIVE(SDG#)&BITMASK(DEV#))^=0 THEN               1905 08163000
         LH    @01,SDG#                                            1905 08164000
         SLR   @00,@00                                             1905 08165000
         IC    @00,CBMDRIVE-1(@01,@05)                             1905 08166000
         SLR   @05,@05                                             1905 08167000
         IC    @05,BITMASK-1(@04)                                  1905 08168000
         NR    @00,@05                                             1905 08169000
         LTR   @00,@00                                             1905 08170000
         BZ    @RF01905                                            1905 08171000
*             DO;                   /*                       @Z40LB61*/ 08172000
*               DVSFLD=ON;          /*                       @Z40LB61*/ 08173000
         OI    DVSFLD(@14),B'00000100'                             1907 08174000
*               FLDCHAR(1)=STATYES; /*                       @Z40LB61*/ 08175000
         MVI   FLDCHAR+3(@14),C' '                                 1908 08176000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1908 08177000
         MVC   FLDCHAR(3,@14),@CC01343                             1908 08178000
*               FLDCHAR(2)=STATNO;  /*                       @Z40LB61*/ 08179000
         MVI   FLDCHAR+15(@14),C' '                                1909 08180000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1909 08181000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1909 08182000
*               CALL IDCCH04(GDTTBL,CDALIST);/*              @Z40LB61*/ 08183000
         L     @14,@PC00001                                        1910 08184000
         ST    @14,@AL00001                                        1910 08185000
         ST    @15,@AL00001+4                                      1910 08186000
         L     @15,@CV01495                                        1910 08187000
         LA    @01,@AL00001                                        1910 08188000
         BALR  @14,@15                                             1910 08189000
*             END;                  /*                       @Z40LB61*/ 08190000
*           ELSE                                                   1912 08191000
*             ;                     /*                       @Z40LB61*/ 08192000
@RF01905 DS    0H                                                  1913 08193000
*         ELSE                                                     1913 08194000
*                                                                  1913 08195000
*           /*********************************************************/ 08196000
*           /*                                                       */ 08197000
*           /* IF THE DEVICE EXISTS AND IS NOT THE 2ND HALF  @Z40LB61*/ 08198000
*           /* OF A 3330 MOD 11, CONTINUE STATUS CHECKING.   @Z40LB61*/ 08199000
*           /*                                                       */ 08200000
*           /*********************************************************/ 08201000
*                                                                  1913 08202000
*           IF PAB2M11(DEV#)=OFF THEN                              1913 08203000
         B     @RC01904                                            1913 08204000
@RF01904 LH    @15,DEV#                                            1913 08205000
         SLA   @15,2                                               1913 08206000
         L     @01,PABPTR                                          1913 08207000
         ALR   @01,@15                                             1913 08208000
         TM    PAB2M11-4(@01),B'00000001'                          1913 08209000
         BNZ   @RF01913                                            1913 08210000
*GOODDEV1:                                                         1914 08211000
*             DO;                   /*                       @Z40LB61*/ 08212000
GOODDEV1 DS    0H                                                  1915 08213000
*               IF(CBMDRIVE(SDG#)&BITMASK(DEV#))=0 THEN            1915 08214000
         LH    @01,SDG#                                            1915 08215000
         LH    @15,DEV#                                            1915 08216000
         L     @14,CBMPTR                                          1915 08217000
         SLR   @00,@00                                             1915 08218000
         IC    @00,CBMDRIVE-1(@01,@14)                             1915 08219000
         SLR   @14,@14                                             1915 08220000
         IC    @14,BITMASK-1(@15)                                  1915 08221000
         NR    @00,@14                                             1915 08222000
         LTR   @00,@00                                             1915 08223000
         BNZ   @RF01915                                            1915 08224000
*                 DO;               /*                       @Z40LB61*/ 08225000
*                   DVSFLD=ON;      /*                       @Z40LB61*/ 08226000
         L     @15,@PC00001+4                                      1917 08227000
         L     @14,MARGPTR(,@15)                                   1917 08228000
         OI    DVSFLD(@14),B'00000100'                             1917 08229000
*                   FLDCHAR(1)=STATNO;/*                     @Z40LB61*/ 08230000
         MVI   FLDCHAR+3(@14),C' '                                 1918 08231000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1918 08232000
         MVC   FLDCHAR(3,@14),@CC01345                             1918 08233000
*                   FLDCHAR(2)=STATYES;/*                    @Z40LB61*/ 08234000
         MVI   FLDCHAR+15(@14),C' '                                1919 08235000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1919 08236000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1919 08237000
*                   CALL IDCCH04(GDTTBL,CDALIST);/*          @Z40LB61*/ 08238000
         L     @14,@PC00001                                        1920 08239000
         ST    @14,@AL00001                                        1920 08240000
         ST    @15,@AL00001+4                                      1920 08241000
         L     @15,@CV01495                                        1920 08242000
         LA    @01,@AL00001                                        1920 08243000
         BALR  @14,@15                                             1920 08244000
*                 END;              /*                       @Z40LB61*/ 08245000
*                                                                  1921 08246000
*               /*****************************************************/ 08247000
*               /*                                                   */ 08248000
*               /* FOR A VALID DEVICE, CHECK 'ONLINE' STATUS @Z40LB61*/ 08249000
*               /* BETWEEN PAB AND CBM. IF INCONSISTENT,     @Z40LB61*/ 08250000
*               /* PRINT AN ERROR MESSAGE.                   @Z40LB61*/ 08251000
*               /*                                                   */ 08252000
*               /*****************************************************/ 08253000
*                                                                  1922 08254000
*               CBMPTR=CBMADDR+LENGTH(CBMAP);/*              @Z40LB61*/ 08255000
@RF01915 L     @15,@PC00001+4                                      1922 08256000
         LA    @14,40                                              1922 08257000
         AL    @14,CBMADDR(,@15)                                   1922 08258000
         ST    @14,CBMPTR                                          1922 08259000
*               IF PABVARV(DEV#)=ON|PABVARR(DEV#)=ON THEN          1923 08260000
         LH    @05,DEV#                                            1923 08261000
         LR    @04,@05                                             1923 08262000
         SLA   @04,2                                               1923 08263000
         L     @01,PABPTR                                          1923 08264000
         ALR   @01,@04                                             1923 08265000
         TM    PABVARV-4(@01),B'01100000'                          1923 08266000
         BZ    @RF01923                                            1923 08267000
*                 IF(CBMDRIVE(SDG#)&BITMASK(DEV#))=0 THEN          1924 08268000
         LH    @01,SDG#                                            1924 08269000
         SLR   @00,@00                                             1924 08270000
         IC    @00,CBMDRIVE-1(@01,@14)                             1924 08271000
         SLR   @04,@04                                             1924 08272000
         IC    @04,BITMASK-1(@05)                                  1924 08273000
         NR    @00,@04                                             1924 08274000
         LTR   @00,@00                                             1924 08275000
         BNZ   @RF01924                                            1924 08276000
*                   DO;             /*                       @Z40LB61*/ 08277000
*                     DOSFLD=ON;    /*                       @Z40LB61*/ 08278000
         L     @14,MARGPTR(,@15)                                   1926 08279000
         OI    DOSFLD(@14),B'00000010'                             1926 08280000
*                     FLDCHAR(1)=STATNO;/*                   @Z40LB61*/ 08281000
         MVI   FLDCHAR+3(@14),C' '                                 1927 08282000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1927 08283000
         MVC   FLDCHAR(3,@14),@CC01345                             1927 08284000
*                     FLDCHAR(2)=STATYES;/*                  @Z40LB61*/ 08285000
         MVI   FLDCHAR+15(@14),C' '                                1928 08286000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1928 08287000
         MVC   FLDCHAR+12(3,@14),@CC01343                          1928 08288000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB61*/ 08289000
         L     @14,@PC00001                                        1929 08290000
         ST    @14,@AL00001                                        1929 08291000
         ST    @15,@AL00001+4                                      1929 08292000
         L     @15,@CV01495                                        1929 08293000
         LA    @01,@AL00001                                        1929 08294000
         BALR  @14,@15                                             1929 08295000
*                   END;            /*                       @Z40LB61*/ 08296000
*                 ELSE                                             1931 08297000
*                   ;               /*                       @Z40LB61*/ 08298000
@RF01924 DS    0H                                                  1932 08299000
*               ELSE                                               1932 08300000
*                 IF(CBMDRIVE(SDG#)&BITMASK(DEV#))^=0 THEN         1932 08301000
         B     @RC01923                                            1932 08302000
@RF01923 LH    @01,SDG#                                            1932 08303000
         LH    @15,DEV#                                            1932 08304000
         L     @14,CBMPTR                                          1932 08305000
         SLR   @00,@00                                             1932 08306000
         IC    @00,CBMDRIVE-1(@01,@14)                             1932 08307000
         SLR   @14,@14                                             1932 08308000
         IC    @14,BITMASK-1(@15)                                  1932 08309000
         NR    @00,@14                                             1932 08310000
         LTR   @00,@00                                             1932 08311000
         BZ    @RF01932                                            1932 08312000
*                   DO;             /*                       @Z40LB61*/ 08313000
*                     DOSFLD=ON;    /*                       @Z40LB61*/ 08314000
         L     @15,@PC00001+4                                      1934 08315000
         L     @14,MARGPTR(,@15)                                   1934 08316000
         OI    DOSFLD(@14),B'00000010'                             1934 08317000
*                     FLDCHAR(1)=STATYES;/*                  @Z40LB61*/ 08318000
         MVI   FLDCHAR+3(@14),C' '                                 1935 08319000
         MVC   FLDCHAR+4(8,@14),FLDCHAR+3(@14)                     1935 08320000
         MVC   FLDCHAR(3,@14),@CC01343                             1935 08321000
*                     FLDCHAR(2)=STATNO;/*                   @Z40LB61*/ 08322000
         MVI   FLDCHAR+15(@14),C' '                                1936 08323000
         MVC   FLDCHAR+16(8,@14),FLDCHAR+15(@14)                   1936 08324000
         MVC   FLDCHAR+12(3,@14),@CC01345                          1936 08325000
*                     CALL IDCCH04(GDTTBL,CDALIST);/*        @Z40LB61*/ 08326000
         L     @14,@PC00001                                        1937 08327000
         ST    @14,@AL00001                                        1937 08328000
         ST    @15,@AL00001+4                                      1937 08329000
         L     @15,@CV01495                                        1937 08330000
         LA    @01,@AL00001                                        1937 08331000
         BALR  @14,@15                                             1937 08332000
*                   END;            /*                       @Z40LB61*/ 08333000
*             END GOODDEV1;         /*                       @Z40LB61*/ 08334000
*                                                                  1939 08335000
@RF01932 DS    0H                                                  1939 08336000
@RC01923 DS    0H                                                  1940 08337000
*         /***********************************************************/ 08338000
*         /*                                                         */ 08339000
*         /* FOR A DEVICE VARIED ON VIRTUAL AND NOT FOR A    @Z40LB61*/ 08340000
*         /* BOUND VOLUME, ADD 1 TO THE COUNT OF DEVICES     @Z40LB61*/ 08341000
*         /* ASSOCIATED WITH THE LRU THRESHOLD VALUES.       @Z40LB61*/ 08342000
*         /*                                                         */ 08343000
*         /***********************************************************/ 08344000
*                                                                  1940 08345000
*         IF PABVARV(DEV#)=ON&PABVBND(DEV#)=OFF THEN               1940 08346000
@RF01913 DS    0H                                                  1940 08347000
@RC01904 LH    @15,DEV#                                            1940 08348000
         SLA   @15,2                                               1940 08349000
         L     @01,PABPTR                                          1940 08350000
         ALR   @01,@15                                             1940 08351000
         TM    PABVARV-4(@01),B'01000000'                          1940 08352000
         BNO   @RF01940                                            1940 08353000
         TM    PABVBND-4(@01),B'00000100'                          1940 08354000
         BNZ   @RF01940                                            1940 08355000
*           LRUDCNT=LRUDCNT+1;      /*                       @Z40LB61*/ 08356000
*                                                                  1941 08357000
         LA    @15,1                                               1941 08358000
         AH    @15,LRUDCNT                                         1941 08359000
         STH   @15,LRUDCNT                                         1941 08360000
*         /***********************************************************/ 08361000
*         /*                                                         */ 08362000
*         /* RESET THE 'IDCCH04' OPTION FLAGS                @Z40LB61*/ 08363000
*         /*                                                         */ 08364000
*         /***********************************************************/ 08365000
*                                                                  1942 08366000
*         MSGTYPE=''B;              /*                       @Z40LB61*/ 08367000
@RF01940 L     @15,@PC00001+4                                      1942 08368000
         L     @15,MARGPTR(,@15)                                   1942 08369000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         1942 08370000
*         TBLTYPE(1)=''B;           /*                       @Z40LB61*/ 08371000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         1943 08372000
*         TBLTYPE(2)=''B;           /*                       @Z40LB61*/ 08373000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     1944 08374000
*       END CHKSUMS1;               /*                       @Z40LB61*/ 08375000
*                                                                  1945 08376000
*     /***************************************************************/ 08377000
*     /*                                                             */ 08378000
*     /* IF SA CHECKING WAS REQUESTED AND THE CURRENT        @Z40LB61*/ 08379000
*     /* DEVICE IS VARIED ON VIRTUAL OR REAL (IF REAL,       @ZD00047*/ 08380000
*     /* A REAL INTERFACE FLAG MUST BE SET) OR VARIED        @ZD00047*/ 08381000
*     /* OFF NEUTRAL, THEN DO THE FOLLOWING FOR EACH         @Z40LB61*/ 08382000
*     /* VALID SA PATH INDICATED IN THE PAB.                 @Z40LB61*/ 08383000
*     /*                                                             */ 08384000
*     /***************************************************************/ 08385000
*                                                                  1946 08386000
*     IF SACHK=ON&(PABVARV(DEV#)=ON|PABVARR(DEV#)=ON|PABVARN(DEV#)=ON)  08387000
*       THEN                                                       1946 08388000
@RF01819 L     @15,@PC00001+4                                      1946 08389000
         TM    SACHK(@15),B'01000000'                              1946 08390000
         BNO   @RF01946                                            1946 08391000
         LH    @15,DEV#                                            1946 08392000
         SLA   @15,2                                               1946 08393000
         L     @01,PABPTR                                          1946 08394000
         ALR   @01,@15                                             1946 08395000
         TM    PABVARV-4(@01),B'01100010'                          1946 08396000
         BZ    @RF01946                                            1946 08397000
*LTRCHK:                                                           1947 08398000
*       DO PABPATH#=1 TO SASSDG;    /*                       @Z40LB61*/ 08399000
LTRCHK   LA    @15,1                                               1947 08400000
         STH   @15,PABPATH#                                        1947 08401000
@DL01947 DS    0H                                                  1948 08402000
*         IF PABPATH#=1 THEN                                       1948 08403000
         CH    @15,@CH00223                                        1948 08404000
         BNE   @RF01948                                            1948 08405000
*           WORKVAL2=SHIFT4;        /*                       @ZD00047*/ 08406000
         MVC   WORKVAL2(2),@CH00478                                1949 08407000
*         ELSE                                                     1950 08408000
*           WORKVAL2=1;             /*                       @ZD00047*/ 08409000
         B     @RC01948                                            1950 08410000
@RF01948 MVC   WORKVAL2(2),@CH00223                                1950 08411000
*         IF PABVLDSA(PABPATH#)=ON THEN                            1951 08412000
@RC01948 L     @15,PABPTR                                          1951 08413000
         LH    @01,PABPATH#                                        1951 08414000
         ALR   @01,@15                                             1951 08415000
         TM    PABVLDSA-1(@01),B'10000000'                         1951 08416000
         BNO   @RF01951                                            1951 08417000
*           IF PABVARR(DEV#)=ON&((PABRINTF(DEV#)/WORKVAL2)&MASK7)=0     08418000
*             THEN                                                 1952 08419000
         LH    @14,DEV#                                            1952 08420000
         SLA   @14,2                                               1952 08421000
         ST    @14,@TF00001                                        1952 08422000
         ALR   @14,@15                                             1952 08423000
         TM    PABVARR-4(@14),B'00100000'                          1952 08424000
         BNO   @RF01952                                            1952 08425000
         L     @14,@TF00001                                        1952 08426000
         SLR   @01,@01                                             1952 08427000
         IC    @01,PABRINTF-4(@14,@15)                             1952 08428000
         SLR   @00,@00                                             1952 08429000
         LH    @15,WORKVAL2                                        1952 08430000
         DR    @00,@15                                             1952 08431000
         SLR   @00,@00                                             1952 08432000
         IC    @00,MASK7                                           1952 08433000
         NR    @01,@00                                             1952 08434000
         LTR   @01,@01                                             1952 08435000
         BZ    @RT01952                                            1952 08436000
*             ;                     /*                       @ZD00047*/ 08437000
*           ELSE                                                   1954 08438000
*PABLTRM:                                                          1954 08439000
*             DO;                   /*                       @Z40LB61*/ 08440000
*                                                                  1954 08441000
@RF01952 DS    0H                                                  1954 08442000
PABLTRM  DS    0H                                                  1955 08443000
*               /*****************************************************/ 08444000
*               /*                                                   */ 08445000
*               /* SET UP INDICES TO SA LOGICAL-TO-REAL TABLE        */ 08446000
*               /*                                           @Z40LB61*/ 08447000
*               /* ENTRY FOR CURRENT SA AND DEVICE           @Z40LB61*/ 08448000
*               /*                                                   */ 08449000
*               /*****************************************************/ 08450000
*                                                                  1955 08451000
*               SA#=(PABSA(PABPATH#)&MASK15)+1;/*            @Z40LB61*/ 08452000
         L     @15,PABPTR                                          1955 08453000
         LH    @14,PABPATH#                                        1955 08454000
         SLR   @05,@05                                             1955 08455000
         IC    @05,PABSA-1(@14,@15)                                1955 08456000
         SLR   @04,@04                                             1955 08457000
         IC    @04,MASK15                                          1955 08458000
         NR    @05,@04                                             1955 08459000
         AH    @05,@CH00223                                        1955 08460000
         STH   @05,SA#                                             1955 08461000
*               IF PAB3333(PABPATH#)=ON THEN                       1956 08462000
         ALR   @15,@14                                             1956 08463000
         TM    PAB3333-1(@15),B'00010000'                          1956 08464000
         BNO   @RF01956                                            1956 08465000
*                 ENTRY#=DEV#+DEVSSDG;/*                     @Z40LB61*/ 08466000
         LA    @15,8                                               1957 08467000
         AH    @15,DEV#                                            1957 08468000
         STH   @15,ENTRY#                                          1957 08469000
*               ELSE                                               1958 08470000
*                 ENTRY#=DEV#;      /*                       @Z40LB61*/ 08471000
*                                                                  1958 08472000
         B     @RC01956                                            1958 08473000
@RF01956 MVC   ENTRY#(2),DEV#                                      1958 08474000
*               /*****************************************************/ 08475000
*               /*                                                   */ 08476000
*               /* IF THE REAL UNIT ADDRESS FROM THE LTR DOES        */ 08477000
*               /*                                           @Z40LB61*/ 08478000
*               /* NOT MATCH THE RUA FROM THE PAB, PRINT AN  @Z40LB61*/ 08479000
*               /* ERROR MESSAGE.                            @Z40LB61*/ 08480000
*               /*                                                   */ 08481000
*               /*****************************************************/ 08482000
*                                                                  1959 08483000
*               IF ILTRPTR(SA#)^=NULLPTR&ILTRPTR(SA#)^=DUMMYPTR&/* 1959 08484000
*                                                            @ZA27324*/ 08485000
*                   (ILTRRUA(ENTRY#)&MASK31)^=/*             @ZA27324*/ 08486000
*                   (PABRUA(DEV#)&MASK31) THEN/*             @ZA27324*/ 08487000
@RC01956 LH    @15,SA#                                             1959 08488000
         LR    @14,@15                                             1959 08489000
         SLA   @14,2                                               1959 08490000
         L     @05,@PC00001+4                                      1959 08491000
         L     @14,ILTRPTR-4(@14,@05)                              1959 08492000
         LTR   @14,@14                                             1959 08493000
         BZ    @RF01959                                            1959 08494000
         C     @14,DUMMYPTR                                        1959 08495000
         BE    @RF01959                                            1959 08496000
         SLR   @04,@04                                             1959 08497000
         IC    @04,MASK31                                          1959 08498000
         LH    @01,ENTRY#                                          1959 08499000
         AL    @14,@CF01340                                        1959 08500000
         SLR   @00,@00                                             1959 08501000
         IC    @00,ILTRRUA(@01,@14)                                1959 08502000
         NR    @00,@04                                             1959 08503000
         LH    @01,DEV#                                            1959 08504000
         SLA   @01,2                                               1959 08505000
         L     @14,PABPTR                                          1959 08506000
         SLR   @03,@03                                             1959 08507000
         IC    @03,PABRUA-4(@01,@14)                               1959 08508000
         NR    @04,@03                                             1959 08509000
         CR    @00,@04                                             1959 08510000
         BE    @RF01959                                            1959 08511000
*                 DO;               /*                       @ZA27324*/ 08512000
*                   INCNMSG=ON;     /*                       @Z40LB61*/ 08513000
         L     @01,MARGPTR(,@05)                                   1961 08514000
         OI    INCNMSG(@01),B'10000000'                            1961 08515000
*                   LTRTBL(1)=ON;   /*                       @Z40LB61*/ 08516000
         OI    LTRTBL(@01),B'01000000'                             1962 08517000
*                   PABTBL(2)=ON;   /*                       @Z40LB61*/ 08518000
         OI    PABTBL+4(@01),B'00010000'                           1963 08519000
*                   LUAINDEX(1)=LUAINDEX(2);/*               @Z40LB61*/ 08520000
         MVC   LUAINDEX(1,@01),LUAINDEX+24(@01)                    1964 08521000
*                   SAINDEX(1)=SA#-1;/*                      @Z40LB61*/ 08522000
         BCTR  @15,0                                               1965 08523000
         STC   @15,SAINDEX(,@01)                                   1965 08524000
*                   RUAFLD=ON;      /*                       @Z40LB61*/ 08525000
         OI    RUAFLD(@01),B'00010000'                             1966 08526000
*                   FLDNUM(1)=ILTRRUA(ENTRY#)&MASK31;/*      @Z40LB61*/ 08527000
         ST    @00,FLDNUM(,@01)                                    1967 08528000
*                   FLDNUM(2)=PABRUA(DEV#)&MASK31;/*         @Z40LB61*/ 08529000
         ST    @04,FLDNUM+12(,@01)                                 1968 08530000
*                   CALL IDCCH04(GDTTBL,CDALIST);/*          @Z40LB61*/ 08531000
         L     @04,@PC00001                                        1969 08532000
         ST    @04,@AL00001                                        1969 08533000
         ST    @05,@AL00001+4                                      1969 08534000
         L     @15,@CV01495                                        1969 08535000
         LA    @01,@AL00001                                        1969 08536000
         BALR  @14,@15                                             1969 08537000
*                 END;              /*                       @Z40LB61*/ 08538000
*             END PABLTRM;          /*                       @Z40LB61*/ 08539000
@RF01959 DS    0H                                                  1972 08540000
*       END LTRCHK;                 /*                       @Z40LB61*/ 08541000
@RT01952 DS    0H                                                  1972 08542000
@RF01951 LA    @15,1                                               1972 08543000
         AH    @15,PABPATH#                                        1972 08544000
         STH   @15,PABPATH#                                        1972 08545000
         CH    @15,@CH00157                                        1972 08546000
         BNH   @DL01947                                            1972 08547000
*   END DEVLOOP3;                   /*                       @Z40LB61*/ 08548000
*                                                                  1973 08549000
@RF01946 LA    @15,1                                               1973 08550000
         AH    @15,DEV#                                            1973 08551000
         STH   @15,DEV#                                            1973 08552000
         CH    @15,@CH00183                                        1973 08553000
         BNH   @DL01813                                            1973 08554000
*   /*****************************************************************/ 08555000
*   /*                                                               */ 08556000
*   /* IF MSC-MSC CHECKING WAS REQUESTED, THEN COUNTS AND    @Z40LB61*/ 08557000
*   /* SUMS INTERNAL TO THE PAB MUST BE CHECKED. FIRST,      @Z40LB61*/ 08558000
*   /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES.         @Z40LB61*/ 08559000
*   /*                                                               */ 08560000
*   /*****************************************************************/ 08561000
*                                                                  1974 08562000
*   IF MSCCHK=ON THEN                                              1974 08563000
         L     @15,@PC00001+4                                      1974 08564000
         TM    MSCCHK(@15),B'10000000'                             1974 08565000
         BNO   @RF01974                                            1974 08566000
*PABSUMS:                                                          1975 08567000
*     DO;                           /*                       @Z40LB61*/ 08568000
PABSUMS  DS    0H                                                  1976 08569000
*       SUMSMSG=ON;                 /*                       @Z40LB61*/ 08570000
         L     @15,@PC00001+4                                      1976 08571000
         L     @14,MARGPTR(,@15)                                   1976 08572000
         OI    SUMSMSG(@14),B'00100000'                            1976 08573000
*       PABTBL(1)=ON;               /*                       @Z40LB61*/ 08574000
         OI    PABTBL(@14),B'00010000'                             1977 08575000
*       PABTBL(2)=ON;               /*                       @Z40LB61*/ 08576000
         OI    PABTBL+4(@14),B'00010000'                           1978 08577000
*       MSGNRSET=ON;                /*                       @Z40LB61*/ 08578000
         OI    MSGNRSET(@14),B'00000001'                           1979 08579000
*       TBLNRSET(1)=ON;             /*                       @Z40LB61*/ 08580000
         OI    TBLNRSET(@14),B'00000001'                           1980 08581000
*       TBLNRSET(2)=ON;             /*                       @Z40LB61*/ 08582000
*                                                                  1981 08583000
         OI    TBLNRSET+4(@14),B'00000001'                         1981 08584000
*       /*************************************************************/ 08585000
*       /*                                                           */ 08586000
*       /* IF THE SUM TOTAL OF FREE PAGES ACCUMULATED FOR    @Z40LB61*/ 08587000
*       /* ALL DEVICES OF THE SDG DOES NOT MATCH THE TOTAL   @Z40LB61*/ 08588000
*       /* FIELD IN THE PAB, PRINT AN ERROR MESSAGE.         @Z40LB61*/ 08589000
*       /*                                                           */ 08590000
*       /*************************************************************/ 08591000
*                                                                  1982 08592000
*       IF FPTOTAL^=PABFTOT THEN                                   1982 08593000
         LH    @05,FPTOTAL                                         1982 08594000
         L     @01,PABPTR                                          1982 08595000
         SLR   @04,@04                                             1982 08596000
         ICM   @04,3,PABFTOT(@01)                                  1982 08597000
         CR    @05,@04                                             1982 08598000
         BE    @RF01982                                            1982 08599000
*         DO;                       /*                       @Z40LB61*/ 08600000
*           FPCFLD=ON;              /*                       @Z40LB61*/ 08601000
         OI    FPCFLD(@14),B'00000010'                             1984 08602000
*           FLDNUM(1)=FPTOTAL;      /*                       @Z40LB61*/ 08603000
         ST    @05,FLDNUM(,@14)                                    1985 08604000
*           FLDNUM(2)=PABFTOT;      /*                       @Z40LB61*/ 08605000
         ST    @04,FLDNUM+12(,@14)                                 1986 08606000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 08607000
         L     @14,@PC00001                                        1987 08608000
         ST    @14,@AL00001                                        1987 08609000
         ST    @15,@AL00001+4                                      1987 08610000
         L     @15,@CV01495                                        1987 08611000
         LA    @01,@AL00001                                        1987 08612000
         BALR  @14,@15                                             1987 08613000
*         END;                      /*                       @Z40LB61*/ 08614000
*                                                                  1988 08615000
*       /*************************************************************/ 08616000
*       /*                                                           */ 08617000
*       /* IF THE SUM TOTAL OF ACTIVE PAGES ACCUMULATED FOR  @Z40LB61*/ 08618000
*       /* ALL DEVICES OF THE SDG DOES NOT MATCH THE TOTAL   @Z40LB61*/ 08619000
*       /* FIELD IN THE PAB, PRINT AN ERROR MESSAGE.         @Z40LB61*/ 08620000
*       /*                                                           */ 08621000
*       /*************************************************************/ 08622000
*                                                                  1989 08623000
*       IF APTOTAL^=PABATOT THEN                                   1989 08624000
@RF01982 LH    @15,APTOTAL                                         1989 08625000
         L     @01,PABPTR                                          1989 08626000
         SLR   @14,@14                                             1989 08627000
         ICM   @14,3,PABATOT(@01)                                  1989 08628000
         CR    @15,@14                                             1989 08629000
         BE    @RF01989                                            1989 08630000
*         DO;                       /*                       @Z40LB61*/ 08631000
*           APCFLD=ON;              /*                       @Z40LB61*/ 08632000
         L     @05,@PC00001+4                                      1991 08633000
         L     @04,MARGPTR(,@05)                                   1991 08634000
         OI    APCFLD(@04),B'00000001'                             1991 08635000
*           FLDNUM(1)=APTOTAL;      /*                       @Z40LB61*/ 08636000
         ST    @15,FLDNUM(,@04)                                    1992 08637000
*           FLDNUM(2)=PABATOT;      /*                       @Z40LB61*/ 08638000
         ST    @14,FLDNUM+12(,@04)                                 1993 08639000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 08640000
         L     @04,@PC00001                                        1994 08641000
         ST    @04,@AL00001                                        1994 08642000
         ST    @05,@AL00001+4                                      1994 08643000
         L     @15,@CV01495                                        1994 08644000
         LA    @01,@AL00001                                        1994 08645000
         BALR  @14,@15                                             1994 08646000
*         END;                      /*                       @Z40LB61*/ 08647000
*                                                                  1995 08648000
*       /*************************************************************/ 08649000
*       /*                                                           */ 08650000
*       /* IF THE SUM TOTAL OF INACTIVE PAGES ACCUMULATED FOR        */ 08651000
*       /*                                                   @Z40LB61*/ 08652000
*       /* ALL DEVICES OF THE SDG DOES NOT MATCH THE TOTAL   @Z40LB61*/ 08653000
*       /* FIELD IN THE PAB, PRINT AN ERROR MESSAGE.         @Z40LB61*/ 08654000
*       /*                                                           */ 08655000
*       /*************************************************************/ 08656000
*                                                                  1996 08657000
*       IF IPTOTAL^=PABITOT THEN                                   1996 08658000
@RF01989 LH    @15,IPTOTAL                                         1996 08659000
         L     @01,PABPTR                                          1996 08660000
         SLR   @14,@14                                             1996 08661000
         ICM   @14,3,PABITOT(@01)                                  1996 08662000
         CR    @15,@14                                             1996 08663000
         BE    @RF01996                                            1996 08664000
*         DO;                       /*                       @Z40LB61*/ 08665000
*           IPCFLD=ON;              /*                       @Z40LB61*/ 08666000
         L     @05,@PC00001+4                                      1998 08667000
         L     @04,MARGPTR(,@05)                                   1998 08668000
         OI    IPCFLD(@04),B'10000000'                             1998 08669000
*           FLDNUM(1)=IPTOTAL;      /*                       @Z40LB61*/ 08670000
         ST    @15,FLDNUM(,@04)                                    1999 08671000
*           FLDNUM(2)=PABITOT;      /*                       @Z40LB61*/ 08672000
         ST    @14,FLDNUM+12(,@04)                                 2000 08673000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 08674000
         L     @04,@PC00001                                        2001 08675000
         ST    @04,@AL00001                                        2001 08676000
         ST    @05,@AL00001+4                                      2001 08677000
         L     @15,@CV01495                                        2001 08678000
         LA    @01,@AL00001                                        2001 08679000
         BALR  @14,@15                                             2001 08680000
*         END;                      /*                       @Z40LB61*/ 08681000
*                                                                  2002 08682000
*       /*************************************************************/ 08683000
*       /*                                                           */ 08684000
*       /* IF THE SUM TOTAL OF BOUND PAGES ACCUMULATED FOR   @Z40LB61*/ 08685000
*       /* ALL DEVICES OF THE SDG DOES NOT MATCH THE TOTAL   @Z40LB61*/ 08686000
*       /* FIELD IN THE PAB, PRINT AN ERROR MESSAGE.         @Z40LB61*/ 08687000
*       /*                                                           */ 08688000
*       /*************************************************************/ 08689000
*                                                                  2003 08690000
*       IF BPTOTAL^=PABBTOT THEN                                   2003 08691000
@RF01996 LH    @15,BPTOTAL                                         2003 08692000
         L     @01,PABPTR                                          2003 08693000
         SLR   @14,@14                                             2003 08694000
         ICM   @14,3,PABBTOT(@01)                                  2003 08695000
         CR    @15,@14                                             2003 08696000
         BE    @RF02003                                            2003 08697000
*         DO;                       /*                       @Z40LB61*/ 08698000
*           BPCFLD=ON;              /*                       @Z40LB61*/ 08699000
         L     @05,@PC00001+4                                      2005 08700000
         L     @04,MARGPTR(,@05)                                   2005 08701000
         OI    BPCFLD(@04),B'01000000'                             2005 08702000
*           FLDNUM(1)=BPTOTAL;      /*                       @Z40LB61*/ 08703000
         ST    @15,FLDNUM(,@04)                                    2006 08704000
*           FLDNUM(2)=PABBTOT;      /*                       @Z40LB61*/ 08705000
         ST    @14,FLDNUM+12(,@04)                                 2007 08706000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 08707000
         L     @04,@PC00001                                        2008 08708000
         ST    @04,@AL00001                                        2008 08709000
         ST    @05,@AL00001+4                                      2008 08710000
         L     @15,@CV01495                                        2008 08711000
         LA    @01,@AL00001                                        2008 08712000
         BALR  @14,@15                                             2008 08713000
*         END;                      /*                       @Z40LB61*/ 08714000
*                                                                  2009 08715000
*       /*************************************************************/ 08716000
*       /*                                                           */ 08717000
*       /* THE LRU DELTA VALUES MULTIPLIED BY THE COUNT OF   @Z40LB61*/ 08718000
*       /* STAGING DEVICES THAT ARE NOT BOUND VOLUMES SHOULD @Z40LB61*/ 08719000
*       /* MATCH THEIR RESPECTIVE LRU THRESHOLD VALUES.      @Z40LB61*/ 08720000
*       /*                                                           */ 08721000
*       /*************************************************************/ 08722000
*                                                                  2010 08723000
*       IF(LRUDCNT*PABUPDEL)^=PABUPTH THEN                         2010 08724000
@RF02003 L     @15,PABPTR                                          2010 08725000
         SLR   @14,@14                                             2010 08726000
         IC    @14,PABUPDEL(,@15)                                  2010 08727000
         MH    @14,LRUDCNT                                         2010 08728000
         SLR   @05,@05                                             2010 08729000
         ICM   @05,3,PABUPTH(@15)                                  2010 08730000
         CR    @14,@05                                             2010 08731000
         BE    @RF02010                                            2010 08732000
*         DO;                       /*                       @Z40LB61*/ 08733000
*           LRUDFLD=ON;             /*                       @Z40LB61*/ 08734000
         L     @15,@PC00001+4                                      2012 08735000
         L     @04,MARGPTR(,@15)                                   2012 08736000
         OI    LRUDFLD(@04),B'01000000'                            2012 08737000
*           FLDNUM(1)=LRUDCNT*PABUPDEL;/*                    @Z40LB61*/ 08738000
         ST    @14,FLDNUM(,@04)                                    2013 08739000
*           FLDNUM(2)=PABUPTH;      /*                       @Z40LB61*/ 08740000
         ST    @05,FLDNUM+12(,@04)                                 2014 08741000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 08742000
         L     @14,@PC00001                                        2015 08743000
         ST    @14,@AL00001                                        2015 08744000
         ST    @15,@AL00001+4                                      2015 08745000
         L     @15,@CV01495                                        2015 08746000
         LA    @01,@AL00001                                        2015 08747000
         BALR  @14,@15                                             2015 08748000
*         END;                      /*                       @Z40LB61*/ 08749000
*       IF(LRUDCNT*PABLODEL)^=PABLOTH THEN                         2017 08750000
@RF02010 L     @15,PABPTR                                          2017 08751000
         SLR   @14,@14                                             2017 08752000
         IC    @14,PABLODEL(,@15)                                  2017 08753000
         MH    @14,LRUDCNT                                         2017 08754000
         SLR   @05,@05                                             2017 08755000
         ICM   @05,3,PABLOTH(@15)                                  2017 08756000
         CR    @14,@05                                             2017 08757000
         BE    @RF02017                                            2017 08758000
*         DO;                       /*                       @Z40LB61*/ 08759000
*           LRUDFLD=ON;             /*                       @Z40LB61*/ 08760000
         L     @15,@PC00001+4                                      2019 08761000
         L     @04,MARGPTR(,@15)                                   2019 08762000
         OI    LRUDFLD(@04),B'01000000'                            2019 08763000
*           FLDNUM(1)=LRUDCNT*PABLODEL;/*                    @Z40LB61*/ 08764000
         ST    @14,FLDNUM(,@04)                                    2020 08765000
*           FLDNUM(2)=PABLOTH;      /*                       @Z40LB61*/ 08766000
         ST    @05,FLDNUM+12(,@04)                                 2021 08767000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 08768000
         L     @14,@PC00001                                        2022 08769000
         ST    @14,@AL00001                                        2022 08770000
         ST    @15,@AL00001+4                                      2022 08771000
         L     @15,@CV01495                                        2022 08772000
         LA    @01,@AL00001                                        2022 08773000
         BALR  @14,@15                                             2022 08774000
*         END;                      /*                       @Z40LB61*/ 08775000
*                                                                  2023 08776000
*       /*************************************************************/ 08777000
*       /*                                                           */ 08778000
*       /* RESET THE 'IDCCH04' OPTION FLAGS                  @Z40LB61*/ 08779000
*       /*                                                           */ 08780000
*       /*************************************************************/ 08781000
*                                                                  2024 08782000
*       MSGTYPE=''B;                /*                       @Z40LB61*/ 08783000
@RF02017 L     @15,@PC00001+4                                      2024 08784000
         L     @15,MARGPTR(,@15)                                   2024 08785000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         2024 08786000
*       TBLTYPE(1)=''B;             /*                       @Z40LB61*/ 08787000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         2025 08788000
*       TBLTYPE(2)=''B;             /*                       @Z40LB61*/ 08789000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     2026 08790000
*     END PABSUMS;                  /*                       @Z40LB61*/ 08791000
*   END CHKSUMS;                    /*                       @Z40LB61*/ 08792000
@EL00012 DS    0H                                                  2028 08793000
@EF00012 DS    0H                                                  2028 08794000
@ER00012 LM    @14,@12,@SA00012                                    2028 08795000
         BR    @14                                                 2028 08796000
*                                                                  2029 08797000
*/********************************************************************/ 08798000
*/*                                                          @Z40LB61*/ 08799000
*/* PROCEDURE NAME - RESCAN                                  @Z40LB61*/ 08800000
*/*                                                          @Z40LB61*/ 08801000
*/* FUNCTION - THIS ROUTINE ROUTES CONTROL TO SUBROUTINES    @Z40LB61*/ 08802000
*/*            WHICH RESCAN SA AND MSC TABLES TOGETHER WITH  @Z40LB61*/ 08803000
*/*            THEIR CORRESPONDING CHECK-OFF TABLES TO SEE   @Z40LB61*/ 08804000
*/*            IF ANY VALID TABLE ENTRIES WERE NOT MATCHED   @Z40LB61*/ 08805000
*/*            UP WITH MOUNTED VOLUME TABLE ENTRIES.         @Z40LB61*/ 08806000
*/*                                                          @Z40LB61*/ 08807000
*/* INPUT -                                                  @Z40LB61*/ 08808000
*/*        (1) CHECKMSS REQUEST OPTIONS                      @Z40LB61*/ 08809000
*/*                                                          @Z40LB61*/ 08810000
*/* OUTPUT -                                                 @Z40LB61*/ 08811000
*/*        (1) FUNCTION CONDITION CODE                       @Z40LB61*/ 08812000
*/*                                                          @Z40LB61*/ 08813000
*/********************************************************************/ 08814000
*                                                                  2029 08815000
*RESCAN:                                                           2029 08816000
*   PROCEDURE;                      /*                       @Z40LB61*/ 08817000
RESCAN   STM   @14,@12,@SA00013                                    2029 08818000
*   OLDERID2=NEWERID2;                                             2030 08819000
         L     @15,@PC00001                                        2030 08820000
         L     @15,GDTTR2(,@15)                                    2030 08821000
         MVC   @TS00001(95),NEWERID2(@15)                          2030 08822000
         MVC   OLDERID2(95,@15),@TS00001                           2030 08823000
*   NEWID2='CH2V';                  /*                       @Z40LB61*/ 08824000
*                                                                  2031 08825000
         MVC   NEWID2(4,@15),@CC01690                              2031 08826000
*   /*****************************************************************/ 08827000
*   /*                                                               */ 08828000
*   /* IF SA CHECKING WAS REQUESTED, RESCAN SA TABLES IN     @Z40LB61*/ 08829000
*   /* CONJUNCTION WITH THEIR RESPECTIVE CHECK-OFF TABLES    @Z40LB61*/ 08830000
*   /* TO CHECK THAT EVERY VALID ENTRY HAS BEEN MATCHED.     @Z40LB61*/ 08831000
*   /*                                                               */ 08832000
*   /*****************************************************************/ 08833000
*                                                                  2032 08834000
*   IF SACHK=ON THEN                                               2032 08835000
         L     @15,@PC00001+4                                      2032 08836000
         TM    SACHK(@15),B'01000000'                              2032 08837000
         BNO   @RF02032                                            2032 08838000
*     CALL SCANSA;                  /*                       @Z40LB61*/ 08839000
         BAL   @14,SCANSA                                          2033 08840000
*   IF LASTCOND^=0 THEN                                            2034 08841000
@RF02032 L     @15,@PC00001+8                                      2034 08842000
         ICM   @14,3,LASTCOND(@15)                                 2034 08843000
         BNZ   @RT02034                                            2034 08844000
*     RETURN;                       /*                       @Z40LB61*/ 08845000
*                                                                  2035 08846000
*   /*****************************************************************/ 08847000
*   /*                                                               */ 08848000
*   /* IF MSC CHECKING WAS REQUESTED, RESCAN MSC TABLES IN   @Z40LB61*/ 08849000
*   /* CONJUNCTION WITH THEIR RESPECTIVE CHECK-OFF TABLES    @Z40LB61*/ 08850000
*   /* TO CHECK THAT EVERY VALID ENTRY HAS BEEN MATCHED.     @Z40LB61*/ 08851000
*   /*                                                               */ 08852000
*   /*****************************************************************/ 08853000
*                                                                  2036 08854000
*   IF MSCCHK=ON THEN                                              2036 08855000
         L     @15,@PC00001+4                                      2036 08856000
         TM    MSCCHK(@15),B'10000000'                             2036 08857000
         BNO   @RF02036                                            2036 08858000
*     CALL SCANMSC;                 /*                       @Z40LB61*/ 08859000
         BAL   @14,SCANMSC                                         2037 08860000
*   END RESCAN;                     /*                       @Z40LB61*/ 08861000
@EL00013 DS    0H                                                  2038 08862000
@EF00013 DS    0H                                                  2038 08863000
@ER00013 LM    @14,@12,@SA00013                                    2038 08864000
         BR    @14                                                 2038 08865000
*                                                                  2039 08866000
*/********************************************************************/ 08867000
*/*                                                          @Z40LB61*/ 08868000
*/* PROCEDURE NAME - SCANSA                                  @Z40LB61*/ 08869000
*/*                                                          @Z40LB61*/ 08870000
*/* FUNCTION - THIS ROUTINE RESCANS SA TABLES IN CONJUNCTION @Z40LB61*/ 08871000
*/*            WITH THEIR RESPECTIVE CHECK-OFF TABLES,       @Z40LB61*/ 08872000
*/*            CHECKING FOR VALID SA TABLE ENTRIES WHICH     @Z40LB61*/ 08873000
*/*            DID NOT MATCH UP WITH ANY MVT ENTRY.          @Z40LB61*/ 08874000
*/*                                                          @Z40LB61*/ 08875000
*/* INPUT -                                                  @Z40LB61*/ 08876000
*/*        (1) SA VIRTUAL VOLUME INFORMATION TABLE           @Z40LB61*/ 08877000
*/*        (2) VVIT CHECK-OFF TABLE                          @Z40LB61*/ 08878000
*/*        (3) SA VIRTUAL ADDRESS DIRECTORY                  @Z40LB61*/ 08879000
*/*        (4) VAD CHECK-OFF TABLE                           @Z40LB61*/ 08880000
*/*        (5) SA PAGE STATUS TABLE                          @Z40LB61*/ 08881000
*/*        (6) PST CHECK-OFF TABLE                           @Z40LB61*/ 08882000
*/*                                                          @Z40LB61*/ 08883000
*/* OUTPUT -                                                 @Z40LB61*/ 08884000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 08885000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 08886000
*/*                                                          @Z40LB61*/ 08887000
*/********************************************************************/ 08888000
*                                                                  2039 08889000
*SCANSA:                                                           2039 08890000
*   PROCEDURE;                      /*                       @Z40LB61*/ 08891000
SCANSA   STM   @14,@12,@SA00014                                    2039 08892000
*   OLDERID2=NEWERID2;                                             2040 08893000
         L     @15,@PC00001                                        2040 08894000
         L     @15,GDTTR2(,@15)                                    2040 08895000
         MVC   @TS00001(95),NEWERID2(@15)                          2040 08896000
         MVC   OLDERID2(95,@15),@TS00001                           2040 08897000
*   NEWID2='CH2W';                  /*                       @Z40LB61*/ 08898000
*                                                                  2041 08899000
         MVC   NEWID2(4,@15),@CC01696                              2041 08900000
*   /*****************************************************************/ 08901000
*   /*                                                               */ 08902000
*   /* PERFORM RESCANNING OF SA TABLES AND THEIR CHECK-OFF   @Z40LB61*/ 08903000
*   /* TABLES FOR EACH VALID SA                              @Z40LB61*/ 08904000
*   /*                                                               */ 08905000
*   /*****************************************************************/ 08906000
*                                                                  2042 08907000
*SALOOP3:                                                          2042 08908000
*   DO SA#=1 TO SAMAX;              /*                       @Z40LB61*/ 08909000
SALOOP3  LA    @15,1                                               2042 08910000
         STH   @15,SA#                                             2042 08911000
@DL02042 DS    0H                                                  2043 08912000
*     IF IVVITPTR(SA#)^=NULLPTR&    /*                       @ZA27324*/ 08913000
*         IVVITPTR(SA#)^=DUMMYPTR THEN/*                     @ZA27324*/ 08914000
         SLA   @15,2                                               2043 08915000
         L     @14,@PC00001+4                                      2043 08916000
         L     @15,IVVITPTR-4(@15,@14)                             2043 08917000
         LTR   @15,@15                                             2043 08918000
         BZ    @RF02043                                            2043 08919000
         C     @15,DUMMYPTR                                        2043 08920000
         BE    @RF02043                                            2043 08921000
*VALIDSA:                                                          2044 08922000
*       DO;                         /*                       @ZA27324*/ 08923000
VALIDSA  DS    0H                                                  2045 08924000
*         SAINDEX(2)=SA#-1;         /*                       @Z40LB61*/ 08925000
*                                                                  2045 08926000
         L     @15,@PC00001+4                                      2045 08927000
         L     @01,MARGPTR(,@15)                                   2045 08928000
         LH    @00,SA#                                             2045 08929000
         BCTR  @00,0                                               2045 08930000
         STC   @00,SAINDEX+24(,@01)                                2045 08931000
*         /***********************************************************/ 08932000
*         /*                                                         */ 08933000
*         /* RESCAN THE ENTRIES FOR EACH VVA OF THE VVIT     @Z40LB61*/ 08934000
*         /*                                                         */ 08935000
*         /***********************************************************/ 08936000
*                                                                  2046 08937000
*SCANVVIT:                                                         2046 08938000
*         DO VVA#=LOWVVA TO HIGHVVA;/*                       @Z40LB61*/ 08939000
*                                                                  2046 08940000
SCANVVIT LA    @15,64                                              2046 08941000
         STH   @15,VVA#                                            2046 08942000
@DL02046 DS    0H                                                  2047 08943000
*           /*********************************************************/ 08944000
*           /*                                                       */ 08945000
*           /* SET UP INDICES TO THE CURRENT VVIT ENTRY AND  @Z40LB61*/ 08946000
*           /* CORRESPONDING BIT OF THE CHECK-OFF TABLE      @Z40LB61*/ 08947000
*           /*                                                       */ 08948000
*           /*********************************************************/ 08949000
*                                                                  2047 08950000
*           WORKVVA=VVA#-LOWVVA+1;  /*                       @Z40LB61*/ 08951000
         LH    @14,@CH01729                                        2047 08952000
         ALR   @14,@15                                             2047 08953000
         STH   @14,WORKVVA                                         2047 08954000
*           BYTE#=(WORKVVA-1)/8+1;  /*                       @Z40LB61*/ 08955000
         L     @05,@PC00001+4                                      2048 08956000
         L     @04,EARGPTR(,@05)                                   2048 08957000
         LA    @03,1                                               2048 08958000
         LR    @02,@14                                             2048 08959000
         BCTR  @02,0                                               2048 08960000
         LR    @00,@02                                             2048 08961000
         SRDA  @00,32                                              2048 08962000
         D     @00,@CF00183                                        2048 08963000
         ALR   @01,@03                                             2048 08964000
         STH   @01,BYTE#(,@04)                                     2048 08965000
*           BIT#=(WORKVVA-1)//8+1;  /*                       @Z40LB61*/ 08966000
*                                                                  2049 08967000
         ST    @03,@TF00001                                        2049 08968000
         SRDA  @02,32                                              2049 08969000
         D     @02,@CF00183                                        2049 08970000
         AL    @02,@TF00001                                        2049 08971000
         STH   @02,BIT#(,@04)                                      2049 08972000
*           /*********************************************************/ 08973000
*           /*                                                       */ 08974000
*           /* IF THE VVIT ENTRY IS VALID BUT THE CHECK-OFF  @Z40LB61*/ 08975000
*           /* BIT IS OFF, PRINT AN ERROR MESSAGE.           @Z40LB61*/ 08976000
*           /*                                                       */ 08977000
*           /*********************************************************/ 08978000
*                                                                  2050 08979000
*           WORKVAL1=VVICHKFF(BYTE#)&BITMASK(BIT#);/*        @Z40LB61*/ 08980000
         LH    @03,SA#                                             2050 08981000
         SLA   @03,2                                               2050 08982000
         L     @04,VVICOPTR-4(@03,@05)                             2050 08983000
         AL    @04,@CF01340                                        2050 08984000
         SLR   @00,@00                                             2050 08985000
         IC    @00,VVICHKFF(@01,@04)                               2050 08986000
         SLR   @01,@01                                             2050 08987000
         IC    @01,BITMASK-1(@02)                                  2050 08988000
         NR    @00,@01                                             2050 08989000
         STH   @00,WORKVAL1                                        2050 08990000
*           IF IVVIT(WORKVVA)^='0000'X&WORKVAL1=0 THEN             2051 08991000
         ALR   @14,@14                                             2051 08992000
         L     @01,IVVITPTR-4(@03,@05)                             2051 08993000
         ALR   @01,@14                                             2051 08994000
         AL    @01,@CF01760                                        2051 08995000
         CLC   IVVIT(2,@01),@CB01703                               2051 08996000
         BE    @RF02051                                            2051 08997000
         LTR   @00,@00                                             2051 08998000
         BNZ   @RF02051                                            2051 08999000
*             DO;                   /*                       @Z40LB61*/ 09000000
*               MTCHMSG=ON;         /*                       @Z40LB61*/ 09001000
         L     @14,MARGPTR(,@05)                                   2053 09002000
         OI    MTCHMSG(@14),B'00010000'                            2053 09003000
*               MVTTBL(1)=ON;       /*                       @Z40LB61*/ 09004000
         OI    MVTTBL(@14),B'10000000'                             2054 09005000
*               VVITTBL(2)=ON;      /*                       @Z40LB61*/ 09006000
         OI    VVITTBL+4(@14),B'00100000'                          2055 09007000
*               VVAFLD=ON;          /*                       @Z40LB61*/ 09008000
         OI    VVAFLD(@14),B'01000000'                             2056 09009000
*               FLDNUM(1)=VVA#;     /*                       @Z40LB61*/ 09010000
         ST    @15,FLDNUM(,@14)                                    2057 09011000
*               VVAINDEX(2)=VVA#;   /*                       @Z40LB61*/ 09012000
         STC   @15,VVAINDEX+24(,@14)                               2058 09013000
*               CALL IDCCH04(GDTTBL,CDALIST);/*              @Z40LB61*/ 09014000
         L     @04,@PC00001                                        2059 09015000
         ST    @04,@AL00001                                        2059 09016000
         ST    @05,@AL00001+4                                      2059 09017000
         L     @15,@CV01495                                        2059 09018000
         LA    @01,@AL00001                                        2059 09019000
         BALR  @14,@15                                             2059 09020000
*             END;                  /*                       @Z40LB61*/ 09021000
*         END SCANVVIT;             /*                       @Z40LB61*/ 09022000
*                                                                  2061 09023000
@RF02051 LA    @15,1                                               2061 09024000
         AH    @15,VVA#                                            2061 09025000
         STH   @15,VVA#                                            2061 09026000
         CH    @15,@CH01333                                        2061 09027000
         BNH   @DL02046                                            2061 09028000
*         /***********************************************************/ 09029000
*         /*                                                         */ 09030000
*         /* RESCAN THE ENTRIES FOR EACH INTERFACE AND VUA   @Z40LB61*/ 09031000
*         /* WITHIN INTERFACE OF THE VAD                     @Z40LB61*/ 09032000
*         /*                                                         */ 09033000
*         /***********************************************************/ 09034000
*                                                                  2062 09035000
*SCANVAD:                                                          2062 09036000
*         DO INTF#=1 TO INTFSSA;    /*                       @Z40LB61*/ 09037000
SCANVAD  LA    @15,1                                               2062 09038000
         STH   @15,INTF#                                           2062 09039000
@DL02062 DS    0H                                                  2063 09040000
*           DO WORKVUA=1 TO HIGHVUA+1;/*                     @Z40LB61*/ 09041000
*                                                                  2063 09042000
         LA    @15,1                                               2063 09043000
         STH   @15,WORKVUA                                         2063 09044000
@DL02063 DS    0H                                                  2064 09045000
*             /*******************************************************/ 09046000
*             /*                                                     */ 09047000
*             /* IF THE VAD ENTRY IS VALID BUT THE CHECK-    @Z40LB61*/ 09048000
*             /* OFF BIT IS OFF, PRINT AN ERROR MESSAGE.     @Z40LB61*/ 09049000
*             /*                                                     */ 09050000
*             /*******************************************************/ 09051000
*                                                                  2064 09052000
*             BYTE#=(WORKVUA-1)/8+1;/*                       @Z40LB61*/ 09053000
         L     @14,@PC00001+4                                      2064 09054000
         L     @05,EARGPTR(,@14)                                   2064 09055000
         LA    @04,1                                               2064 09056000
         LR    @03,@15                                             2064 09057000
         BCTR  @03,0                                               2064 09058000
         LR    @00,@03                                             2064 09059000
         SRDA  @00,32                                              2064 09060000
         D     @00,@CF00183                                        2064 09061000
         ALR   @01,@04                                             2064 09062000
         STH   @01,BYTE#(,@05)                                     2064 09063000
*             BIT#=(WORKVUA-1)//8+1;/*                       @Z40LB61*/ 09064000
         LR    @14,@03                                             2065 09065000
         SRDA  @14,32                                              2065 09066000
         D     @14,@CF00183                                        2065 09067000
         ALR   @14,@04                                             2065 09068000
         STH   @14,BIT#(,@05)                                      2065 09069000
*             WORKVAL1=VADCHKFF(INTF#,BYTE#)&BITMASK(BIT#);/*      2066 09070000
*                                                            @Z40LB61*/ 09071000
         LH    @15,INTF#                                           2066 09072000
         LR    @02,@15                                             2066 09073000
         SLA   @02,3                                               2066 09074000
         ALR   @02,@01                                             2066 09075000
         LH    @05,SA#                                             2066 09076000
         SLA   @05,2                                               2066 09077000
         L     @04,@PC00001+4                                      2066 09078000
         L     @01,VADCOPTR-4(@05,@04)                             2066 09079000
         AL    @01,@CF01763                                        2066 09080000
         SLR   @00,@00                                             2066 09081000
         IC    @00,VADCHKFF(@02,@01)                               2066 09082000
         SLR   @01,@01                                             2066 09083000
         IC    @01,BITMASK-1(@14)                                  2066 09084000
         NR    @00,@01                                             2066 09085000
         STH   @00,WORKVAL1                                        2066 09086000
*             IF IVADVVA(INTF#,WORKVUA)>=LOWVVA&WORKVAL1=0 THEN    2067 09087000
         LH    @02,WORKVUA                                         2067 09088000
         LR    @14,@15                                             2067 09089000
         SLA   @14,6                                               2067 09090000
         ALR   @14,@02                                             2067 09091000
         ALR   @14,@14                                             2067 09092000
         AL    @05,@CF01761                                        2067 09093000
         L     @01,IVADPTR(@05,@04)                                2067 09094000
         AL    @01,@CF01771                                        2067 09095000
         SLR   @02,@02                                             2067 09096000
         IC    @02,IVADVVA(@14,@01)                                2067 09097000
         CH    @02,@CH00580                                        2067 09098000
         BL    @RF02067                                            2067 09099000
         LTR   @00,@00                                             2067 09100000
         BNZ   @RF02067                                            2067 09101000
*               DO;                 /*                       @Z40LB61*/ 09102000
*                 MTCHMSG=ON;       /*                       @Z40LB61*/ 09103000
         L     @02,MARGPTR(,@04)                                   2069 09104000
         OI    MTCHMSG(@02),B'00010000'                            2069 09105000
*                 MVTTBL(1)=ON;     /*                       @Z40LB61*/ 09106000
         OI    MVTTBL(@02),B'10000000'                             2070 09107000
*                 VADTBL(2)=ON;     /*                       @Z40LB61*/ 09108000
         OI    VADTBL+4(@02),B'00000001'                           2071 09109000
*                 VUAFLD=ON;        /*                       @Z40LB61*/ 09110000
         OI    VUAFLD(@02),B'00010000'                             2072 09111000
*                 FLDNUM(1)=WORKVUA-1;/*                     @Z40LB61*/ 09112000
         ST    @03,FLDNUM(,@02)                                    2073 09113000
*                 VUAINDEX(2)=WORKVUA-1;/*                   @Z40LB61*/ 09114000
         STC   @03,VUAINDEX+24(,@02)                               2074 09115000
*                 INFINDEX(2)=INTF#;/*                       @Z40LB61*/ 09116000
         STC   @15,INFINDEX+24(,@02)                               2075 09117000
*                 CALL IDCCH04(GDTTBL,CDALIST);/*            @Z40LB61*/ 09118000
         L     @05,@PC00001                                        2076 09119000
         ST    @05,@AL00001                                        2076 09120000
         ST    @04,@AL00001+4                                      2076 09121000
         L     @15,@CV01495                                        2076 09122000
         LA    @01,@AL00001                                        2076 09123000
         BALR  @14,@15                                             2076 09124000
*               END;                /*                       @Z40LB61*/ 09125000
*           END;                    /*                       @Z40LB61*/ 09126000
@RF02067 LA    @15,1                                               2078 09127000
         AH    @15,WORKVUA                                         2078 09128000
         STH   @15,WORKVUA                                         2078 09129000
         CH    @15,@CH00580                                        2078 09130000
         BNH   @DL02063                                            2078 09131000
*         END SCANVAD;              /*                       @Z40LB61*/ 09132000
*                                                                  2079 09133000
         LA    @15,1                                               2079 09134000
         AH    @15,INTF#                                           2079 09135000
         STH   @15,INTF#                                           2079 09136000
         CH    @15,@CH00166                                        2079 09137000
         BNH   @DL02062                                            2079 09138000
*         /***********************************************************/ 09139000
*         /*                                                         */ 09140000
*         /* RESCAN THE ENTRIES FOR EACH LOGICAL UNIT        @Z40LB61*/ 09141000
*         /* ADDRESS AND REAL PAGE WITHIN LUA OF THE PST     @Z40LB61*/ 09142000
*         /*                                                         */ 09143000
*         /***********************************************************/ 09144000
*                                                                  2080 09145000
*SCANPST:                                                          2080 09146000
*         DO L3333#=1 TO L3333SSA;  /*                       @Z40LB61*/ 09147000
SCANPST  LA    @15,1                                               2080 09148000
         STH   @15,L3333#                                          2080 09149000
@DL02080 DS    0H                                                  2081 09150000
*           DO DEV#=1 TO DEVSSDG;   /*                       @Z40LB61*/ 09151000
         LA    @15,1                                               2081 09152000
         STH   @15,DEV#                                            2081 09153000
@DL02081 DS    0H                                                  2082 09154000
*             DO WORKRP=2 TO RPMAX; /*                       @Z40LB61*/ 09155000
*                                                                  2082 09156000
         LA    @15,2                                               2082 09157000
         STH   @15,WORKRP                                          2082 09158000
@DL02082 DS    0H                                                  2083 09159000
*               /*****************************************************/ 09160000
*               /*                                                   */ 09161000
*               /* IF THE PST ENTRY IS VALID BUT THE CHECK-  @Z40LB61*/ 09162000
*               /* OFF BIT IS OFF, PRINT AN ERROR MESSAGE.   @Z40LB61*/ 09163000
*               /*                                                   */ 09164000
*               /*****************************************************/ 09165000
*                                                                  2083 09166000
*               BYTE#=(WORKRP-1)/8+1;/*                      @Z40LB61*/ 09167000
         L     @14,@PC00001+4                                      2083 09168000
         L     @05,EARGPTR(,@14)                                   2083 09169000
         LA    @04,1                                               2083 09170000
         LR    @03,@15                                             2083 09171000
         BCTR  @03,0                                               2083 09172000
         LR    @00,@03                                             2083 09173000
         SRDA  @00,32                                              2083 09174000
         D     @00,@CF00183                                        2083 09175000
         ALR   @01,@04                                             2083 09176000
         STH   @01,BYTE#(,@05)                                     2083 09177000
*               BIT#=(WORKRP-1)//8+1;/*                      @Z40LB61*/ 09178000
         LR    @14,@03                                             2084 09179000
         SRDA  @14,32                                              2084 09180000
         D     @14,@CF00183                                        2084 09181000
         ALR   @14,@04                                             2084 09182000
         STH   @14,BIT#(,@05)                                      2084 09183000
*               WORKVAL1=PSTCHKFF(L3333#,DEV#,BYTE#)&BITMASK(BIT#);/*   09184000
*                                                            @Z40LB61*/ 09185000
         LH    @15,DEV#                                            2085 09186000
         LH    @02,L3333#                                          2085 09187000
         LR    @05,@02                                             2085 09188000
         SLA   @05,3                                               2085 09189000
         ALR   @05,@15                                             2085 09190000
         LR    @04,@05                                             2085 09191000
         MH    @04,@CH00769                                        2085 09192000
         ALR   @04,@01                                             2085 09193000
         LH    @01,SA#                                             2085 09194000
         SLA   @01,2                                               2085 09195000
         L     @00,@PC00001+4                                      2085 09196000
         LR    @15,@00                                             2085 09197000
         L     @15,PSTCOPTR-4(@01,@15)                             2085 09198000
         AL    @15,@CF01767                                        2085 09199000
         SLR   @02,@02                                             2085 09200000
         IC    @02,PSTCHKFF(@04,@15)                               2085 09201000
         SLR   @15,@15                                             2085 09202000
         IC    @15,BITMASK-1(@14)                                  2085 09203000
         NR    @02,@15                                             2085 09204000
         STH   @02,WORKVAL1                                        2085 09205000
*               IF IPSTVVA(L3333#,DEV#,WORKRP)>=LOWVVA&WORKVAL1=0 THEN  09206000
         LH    @04,WORKRP                                          2086 09207000
         MH    @05,@CH00684                                        2086 09208000
         ALR   @05,@04                                             2086 09209000
         ALR   @05,@05                                             2086 09210000
         LR    @04,@00                                             2086 09211000
         L     @04,IPSTPTR-4(@01,@04)                              2086 09212000
         AL    @04,@CF01768                                        2086 09213000
         SLR   @01,@01                                             2086 09214000
         IC    @01,IPSTVVA(@05,@04)                                2086 09215000
         CH    @01,@CH00580                                        2086 09216000
         BL    @RF02086                                            2086 09217000
         LTR   @02,@02                                             2086 09218000
         BNZ   @RF02086                                            2086 09219000
*                 DO;               /*                       @Z40LB61*/ 09220000
*                   MTCHMSG=ON;     /*                       @Z40LB61*/ 09221000
         LR    @01,@00                                             2088 09222000
         L     @02,MARGPTR(,@01)                                   2088 09223000
         OI    MTCHMSG(@02),B'00010000'                            2088 09224000
*                   MVTTBL(1)=ON;   /*                       @Z40LB61*/ 09225000
         OI    MVTTBL(@02),B'10000000'                             2089 09226000
*                   PSTTBL(2)=ON;   /*                       @Z40LB61*/ 09227000
         OI    PSTTBL+4(@02),B'10000000'                           2090 09228000
*                   RPFLD=ON;       /*                       @Z40LB61*/ 09229000
         OI    RPFLD(@02),B'00100000'                              2091 09230000
*                   FLDNUM(1)=WORKRP-1;/*                    @Z40LB61*/ 09231000
         ST    @03,FLDNUM(,@02)                                    2092 09232000
*                   LUAINDEX(2)=DEV#+(L3333#-1)*DEVSSDG-1;/* @Z40LB61*/ 09233000
         LH    @01,DEV#                                            2093 09234000
         LH    @15,L3333#                                          2093 09235000
         BCTR  @15,0                                               2093 09236000
         SLA   @15,3                                               2093 09237000
         ALR   @01,@15                                             2093 09238000
         BCTR  @01,0                                               2093 09239000
         STC   @01,LUAINDEX+24(,@02)                               2093 09240000
*                   RPINDEX(2)=WORKRP-1;/*                   @Z40LB61*/ 09241000
         STC   @03,RPINDEX+24(,@02)                                2094 09242000
*                   CALL IDCCH04(GDTTBL,CDALIST);/*          @Z40LB61*/ 09243000
         L     @01,@PC00001                                        2095 09244000
         ST    @01,@AL00001                                        2095 09245000
         LR    @01,@00                                             2095 09246000
         ST    @01,@AL00001+4                                      2095 09247000
         L     @15,@CV01495                                        2095 09248000
         LA    @01,@AL00001                                        2095 09249000
         BALR  @14,@15                                             2095 09250000
*                 END;              /*                       @Z40LB61*/ 09251000
*             END;                  /*                       @Z40LB61*/ 09252000
@RF02086 LA    @15,1                                               2097 09253000
         AH    @15,WORKRP                                          2097 09254000
         STH   @15,WORKRP                                          2097 09255000
         CH    @15,@CH00684                                        2097 09256000
         BNH   @DL02082                                            2097 09257000
*           END;                    /*                       @Z40LB61*/ 09258000
         LA    @15,1                                               2098 09259000
         AH    @15,DEV#                                            2098 09260000
         STH   @15,DEV#                                            2098 09261000
         CH    @15,@CH00183                                        2098 09262000
         BNH   @DL02081                                            2098 09263000
*         END SCANPST;              /*                       @Z40LB61*/ 09264000
         LA    @15,1                                               2099 09265000
         AH    @15,L3333#                                          2099 09266000
         STH   @15,L3333#                                          2099 09267000
         CH    @15,@CH00157                                        2099 09268000
         BNH   @DL02080                                            2099 09269000
*       END VALIDSA;                /*                       @Z40LB61*/ 09270000
*   END SALOOP3;                    /*                       @Z40LB61*/ 09271000
@RF02043 LA    @15,1                                               2101 09272000
         AH    @15,SA#                                             2101 09273000
         STH   @15,SA#                                             2101 09274000
         CH    @15,@CH00478                                        2101 09275000
         BNH   @DL02042                                            2101 09276000
*   END SCANSA;                     /*                       @Z40LB61*/ 09277000
@EL00014 DS    0H                                                  2102 09278000
@EF00014 DS    0H                                                  2102 09279000
@ER00014 LM    @14,@12,@SA00014                                    2102 09280000
         BR    @14                                                 2102 09281000
*                                                                  2103 09282000
*/********************************************************************/ 09283000
*/*                                                          @Z40LB61*/ 09284000
*/* PROCEDURE NAME - SCANMSC                                 @Z40LB61*/ 09285000
*/*                                                          @Z40LB61*/ 09286000
*/* FUNCTION - THIS ROUTINE SCANS MSC TABLES IN CONJUNCTION  @Z40LB61*/ 09287000
*/*            WITH THEIR RESPECTIVE CHECK-OFF TABLES,       @Z40LB61*/ 09288000
*/*            CHECKING FOR VALID MSC TABLE ENTRIES WHICH    @Z40LB61*/ 09289000
*/*            DID NOT MATCH UP WITH ANY MVT ENTRY.          @Z40LB61*/ 09290000
*/*                                                          @Z40LB61*/ 09291000
*/* INPUT -                                                  @Z40LB61*/ 09292000
*/*        (1) MSC SDG DEMOUNTED VOLUME BLOCKS               @Z40LB61*/ 09293000
*/*        (2) MSC SDG DVB CHECK-OFF TABLE                   @Z40LB61*/ 09294000
*/*        (3) MSC SDG LRU PAGES BLOCKS                      @Z40LB61*/ 09295000
*/*        (4) MSC SDG LPB CHECK-OFF TABLE                   @Z40LB61*/ 09296000
*/*        (5) MSC VIRTUAL VOLUME ADDRESS TABLE              @Z40LB61*/ 09297000
*/*        (6) MSC VVAT CHECK-OFF TABLE                      @Z40LB61*/ 09298000
*/*        (7) MSC VVA/MVT CROSS REFERENCE TABLE             @Z40LB61*/ 09299000
*/*        (8) MSC VVA/MVT XREF CHECK-OFF TABLE              @Z40LB61*/ 09300000
*/*        (9) MSC CONFIGURATION DATA BLOCKS                 @Z40LB61*/ 09301000
*/*        (10) MSC CDB CHECK-OFF TABLE                      @Z40LB61*/ 09302000
*/*                                                          @Z40LB61*/ 09303000
*/* OUTPUT -                                                 @Z40LB61*/ 09304000
*/*        (1) ERROR MESSAGES DESCRIBING ANY INCONSISTENCIES @Z40LB61*/ 09305000
*/*        (2) FUNCTION CONDITION CODE                       @Z40LB61*/ 09306000
*/*                                                          @Z40LB61*/ 09307000
*/********************************************************************/ 09308000
*                                                                  2103 09309000
*SCANMSC:                                                          2103 09310000
*   PROCEDURE;                      /*                       @Z40LB61*/ 09311000
SCANMSC  STM   @14,@12,@SA00015                                    2103 09312000
*   OLDERID2=NEWERID2;                                             2104 09313000
         L     @15,@PC00001                                        2104 09314000
         L     @15,GDTTR2(,@15)                                    2104 09315000
         MVC   @TS00001(95),NEWERID2(@15)                          2104 09316000
         MVC   OLDERID2(95,@15),@TS00001                           2104 09317000
*   NEWID2='CH2X';                  /*                       @Z40LB61*/ 09318000
*                                                                  2105 09319000
         MVC   NEWID2(4,@15),@CC01546                              2105 09320000
*   /*****************************************************************/ 09321000
*   /*                                                               */ 09322000
*   /* DO COMMON SET-UP FOR POSSIBLE ERROR MESSAGES          @Z40LB61*/ 09323000
*   /*                                                               */ 09324000
*   /*****************************************************************/ 09325000
*                                                                  2106 09326000
*   MTCHMSG=ON;                     /*                       @Z40LB61*/ 09327000
         L     @15,@PC00001+4                                      2106 09328000
         L     @15,MARGPTR(,@15)                                   2106 09329000
         OI    MTCHMSG(@15),B'00010000'                            2106 09330000
*   MVTTBL(1)=ON;                   /*                       @Z40LB61*/ 09331000
         OI    MVTTBL(@15),B'10000000'                             2107 09332000
*   MSGNRSET=ON;                    /*                       @Z40LB61*/ 09333000
         OI    MSGNRSET(@15),B'00000001'                           2108 09334000
*   TBLNRSET(1)=ON;                 /*                       @Z40LB61*/ 09335000
*                                                                  2109 09336000
         OI    TBLNRSET(@15),B'00000001'                           2109 09337000
*   /*****************************************************************/ 09338000
*   /*                                                               */ 09339000
*   /* PERFORM RESCANNING OF MSC TABLES ORGANIZED BY SDG     @Z40LB61*/ 09340000
*   /*                                                               */ 09341000
*   /*****************************************************************/ 09342000
*                                                                  2110 09343000
*SCANSDG:                                                          2110 09344000
*   DO SDG#=1 TO SDGMAX;            /*                       @Z40LB61*/ 09345000
SCANSDG  LA    @15,1                                               2110 09346000
         STH   @15,SDG#                                            2110 09347000
@DL02110 DS    0H                                                  2111 09348000
*     SDGINDEX(2)=SDG#-1;           /*                       @Z40LB61*/ 09349000
*                                                                  2111 09350000
         L     @14,@PC00001+4                                      2111 09351000
         L     @01,MARGPTR(,@14)                                   2111 09352000
         BCTR  @15,0                                               2111 09353000
         STC   @15,SDGINDEX+24(,@01)                               2111 09354000
*     /***************************************************************/ 09355000
*     /*                                                             */ 09356000
*     /* OBTAIN THE LPB FOR THE CURRENT SDG                  @Z40LB61*/ 09357000
*     /*                                                             */ 09358000
*     /***************************************************************/ 09359000
*                                                                  2112 09360000
*     TABLEID=SDGTBLID;             /*                       @Z40LB61*/ 09361000
         L     @05,EARGPTR(,@14)                                   2112 09362000
         MVC   TABLEID(1,@05),SDGTBLID                             2112 09363000
*     LPBFLAG=ON;                   /*                       @Z40LB61*/ 09364000
         OI    LPBFLAG(@05),B'00010000'                            2113 09365000
*     SDGNUM=SDG#-1;                /*                       @Z40LB61*/ 09366000
         STH   @15,SDGNUM(,@05)                                    2114 09367000
*     CALL IDCCH03(GDTTBL,CDALIST); /*                       @Z40LB61*/ 09368000
         L     @15,@PC00001                                        2115 09369000
         ST    @15,@AL00001                                        2115 09370000
         ST    @14,@AL00001+4                                      2115 09371000
         L     @15,@CV01494                                        2115 09372000
         LA    @01,@AL00001                                        2115 09373000
         BALR  @14,@15                                             2115 09374000
*     IF GETRC^=0 THEN                                             2116 09375000
         L     @15,@PC00001+4                                      2116 09376000
         L     @01,EARGPTR(,@15)                                   2116 09377000
         ICM   @00,3,GETRC(@01)                                    2116 09378000
         BZ    @RF02116                                            2116 09379000
*       DO;                         /*                       @Z40LB61*/ 09380000
*         LASTCOND=LASTCC12;        /*                       @Z40LB61*/ 09381000
         L     @15,@PC00001+8                                      2118 09382000
         MVC   LASTCOND(2,@15),@CH00567                            2118 09383000
*         RETURN;                   /*                       @Z40LB61*/ 09384000
@EL00015 DS    0H                                                  2119 09385000
@EF00015 DS    0H                                                  2119 09386000
@ER00015 LM    @14,@12,@SA00015                                    2119 09387000
         BR    @14                                                 2119 09388000
*       END;                        /*                       @Z40LB61*/ 09389000
*     LPBPTR=TBLADDR;               /*                       @Z40LB61*/ 09390000
*                                                                  2121 09391000
@RF02116 L     @15,@PC00001+4                                      2121 09392000
         L     @01,EARGPTR(,@15)                                   2121 09393000
         MVC   LPBPTR(4),TBLADDR(@01)                              2121 09394000
*     /***************************************************************/ 09395000
*     /*                                                             */ 09396000
*     /* RESCAN THE LPB CHECK-OFF TABLE, CHECKING AS MANY    @Z40LB61*/ 09397000
*     /* BITS AS THERE ARE VALID LPB ENTRIES. IF ANY OF      @Z40LB61*/ 09398000
*     /* THE BITS ARE OFF, PRINT AN ERROR MESSAGE.           @Z40LB61*/ 09399000
*     /*                                                             */ 09400000
*     /***************************************************************/ 09401000
*                                                                  2122 09402000
*SCANLPB:                                                          2122 09403000
*     DO ENTRY#=1 TO DVLPMAX WHILE((ENTRY#*LENGTH(LPBMVT)<=LPBNEXT-4)   09404000
*                                   /*                       @ZA16115*/ 09405000
*           |LPBNEXT=0);            /*                       @ZA16115*/ 09406000
SCANLPB  LA    @15,1                                               2122 09407000
         STH   @15,ENTRY#                                          2122 09408000
@DL02122 ALR   @15,@15                                             2122 09409000
         L     @14,LPBPTR                                          2122 09410000
         SLR   @05,@05                                             2122 09411000
         IC    @05,LPBNEXT(,@14)                                   2122 09412000
         SH    @05,@CH00046                                        2122 09413000
         CR    @15,@05                                             2122 09414000
         BNH   @DB02122                                            2122 09415000
         CLI   LPBNEXT(@14),0                                      2122 09416000
         BNE   @DC02122                                            2122 09417000
@DB02122 DS    0H                                                  2123 09418000
*       BYTE#=(ENTRY#-1)/8+1;       /*                       @Z40LB61*/ 09419000
         L     @15,@PC00001+4                                      2123 09420000
         L     @14,EARGPTR(,@15)                                   2123 09421000
         LA    @05,1                                               2123 09422000
         LH    @04,ENTRY#                                          2123 09423000
         LR    @03,@04                                             2123 09424000
         BCTR  @03,0                                               2123 09425000
         LR    @00,@03                                             2123 09426000
         SRDA  @00,32                                              2123 09427000
         D     @00,@CF00183                                        2123 09428000
         ALR   @01,@05                                             2123 09429000
         STH   @01,BYTE#(,@14)                                     2123 09430000
*       BIT#=(ENTRY#-1)//8+1;       /*                       @Z40LB61*/ 09431000
         LR    @00,@03                                             2124 09432000
         ST    @01,@TF00001                                        2124 09433000
         SRDA  @00,32                                              2124 09434000
         D     @00,@CF00183                                        2124 09435000
         ALR   @00,@05                                             2124 09436000
         STH   @00,BIT#(,@14)                                      2124 09437000
*       IF(LPBCHKFF(SDG#,BYTE#)&BITMASK(BIT#))=0 THEN              2125 09438000
         LH    @01,SDG#                                            2125 09439000
         SLA   @01,4                                               2125 09440000
         AL    @01,@TF00001                                        2125 09441000
         L     @05,LPBCOPTR(,@15)                                  2125 09442000
         AL    @05,@CF01770                                        2125 09443000
         SLR   @03,@03                                             2125 09444000
         IC    @03,LPBCHKFF(@01,@05)                               2125 09445000
         LR    @02,@00                                             2125 09446000
         SLR   @05,@05                                             2125 09447000
         IC    @05,BITMASK-1(@02)                                  2125 09448000
         NR    @03,@05                                             2125 09449000
         LTR   @03,@03                                             2125 09450000
         BNZ   @RF02125                                            2125 09451000
*         DO;                       /*                       @Z40LB61*/ 09452000
*           LPBTBL(2)=ON;           /*                       @Z40LB61*/ 09453000
         L     @05,MARGPTR(,@15)                                   2127 09454000
         OI    LPBTBL+4(@05),B'00000100'                           2127 09455000
*           MVTPFLD=ON;             /*                       @Z40LB61*/ 09456000
         OI    MVTPFLD(@05),B'00100000'                            2128 09457000
*           FLDNUM(1)=LPBMVT(ENTRY#)&MASK8191;/*             @Z40LB61*/ 09458000
         ALR   @04,@04                                             2129 09459000
         SLR   @03,@03                                             2129 09460000
         ICM   @03,3,MASK8191                                      2129 09461000
         L     @02,LPBPTR                                          2129 09462000
         ALR   @02,@04                                             2129 09463000
         SLR   @04,@04                                             2129 09464000
         ICM   @04,3,LPBMVT-2(@02)                                 2129 09465000
         NR    @03,@04                                             2129 09466000
         ST    @03,FLDNUM(,@05)                                    2129 09467000
*           CHRINDEX(2)=PREVCHR;    /*                       @Z40LB61*/ 09468000
         MVC   CHRINDEX+24(5,@05),PREVCHR(@14)                     2130 09469000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 09470000
         L     @14,@PC00001                                        2131 09471000
         ST    @14,@AL00001                                        2131 09472000
         ST    @15,@AL00001+4                                      2131 09473000
         L     @15,@CV01495                                        2131 09474000
         LA    @01,@AL00001                                        2131 09475000
         BALR  @14,@15                                             2131 09476000
*         END;                      /*                       @Z40LB61*/ 09477000
*     END SCANLPB;                  /*                       @Z40LB61*/ 09478000
*                                                                  2133 09479000
@RF02125 LA    @15,1                                               2133 09480000
         AH    @15,ENTRY#                                          2133 09481000
         STH   @15,ENTRY#                                          2133 09482000
         CH    @15,@CH00753                                        2133 09483000
         BNH   @DL02122                                            2133 09484000
@DC02122 DS    0H                                                  2134 09485000
*     /***************************************************************/ 09486000
*     /*                                                             */ 09487000
*     /* OBTAIN THE DVB FOR THE CURRENT SDG                  @Z40LB61*/ 09488000
*     /*                                                             */ 09489000
*     /***************************************************************/ 09490000
*                                                                  2134 09491000
*     TABLEID=SDGTBLID;             /*                       @Z40LB61*/ 09492000
         L     @15,@PC00001+4                                      2134 09493000
         L     @14,EARGPTR(,@15)                                   2134 09494000
         MVC   TABLEID(1,@14),SDGTBLID                             2134 09495000
*     DVBFLAG=ON;                   /*                       @Z40LB61*/ 09496000
         OI    DVBFLAG(@14),B'00100000'                            2135 09497000
*     CALL IDCCH03(GDTTBL,CDALIST); /*                       @Z40LB61*/ 09498000
         L     @14,@PC00001                                        2136 09499000
         ST    @14,@AL00001                                        2136 09500000
         ST    @15,@AL00001+4                                      2136 09501000
         L     @15,@CV01494                                        2136 09502000
         LA    @01,@AL00001                                        2136 09503000
         BALR  @14,@15                                             2136 09504000
*     IF GETRC^=0 THEN                                             2137 09505000
         L     @15,@PC00001+4                                      2137 09506000
         L     @01,EARGPTR(,@15)                                   2137 09507000
         ICM   @00,3,GETRC(@01)                                    2137 09508000
         BZ    @RF02137                                            2137 09509000
*       DO;                         /*                       @Z40LB61*/ 09510000
*         LASTCOND=LASTCC12;        /*                       @Z40LB61*/ 09511000
         L     @15,@PC00001+8                                      2139 09512000
         MVC   LASTCOND(2,@15),@CH00567                            2139 09513000
*         RETURN;                   /*                       @Z40LB61*/ 09514000
         B     @EL00015                                            2140 09515000
*       END;                        /*                       @Z40LB61*/ 09516000
*     DVBPTR=TBLADDR;               /*                       @Z40LB61*/ 09517000
*                                                                  2142 09518000
@RF02137 L     @15,@PC00001+4                                      2142 09519000
         L     @01,EARGPTR(,@15)                                   2142 09520000
         MVC   DVBPTR(4),TBLADDR(@01)                              2142 09521000
*     /***************************************************************/ 09522000
*     /*                                                             */ 09523000
*     /* RESCAN THE DVB CHECK-OFF TABLE, CHECKING AS MANY    @Z40LB61*/ 09524000
*     /* BITS AS THERE WERE VALID DVB ENTRIES. IF ANY OF     @Z40LB61*/ 09525000
*     /* THE BITS ARE OFF, PRINT AN ERROR MESSAGE.           @Z40LB61*/ 09526000
*     /*                                                             */ 09527000
*     /***************************************************************/ 09528000
*                                                                  2143 09529000
*SCANDVB:                                                          2143 09530000
*     DO ENTRY#=1 TO DVLPMAX WHILE((ENTRY#*LENGTH(DVBMVT)<=DVBNEXT-4)   09531000
*                                   /*                       @ZA16115*/ 09532000
*           |DVBNEXT=0);            /*                       @ZA16115*/ 09533000
SCANDVB  LA    @15,1                                               2143 09534000
         STH   @15,ENTRY#                                          2143 09535000
@DL02143 ALR   @15,@15                                             2143 09536000
         L     @14,DVBPTR                                          2143 09537000
         SLR   @05,@05                                             2143 09538000
         IC    @05,DVBNEXT(,@14)                                   2143 09539000
         SH    @05,@CH00046                                        2143 09540000
         CR    @15,@05                                             2143 09541000
         BNH   @DB02143                                            2143 09542000
         CLI   DVBNEXT(@14),0                                      2143 09543000
         BNE   @DC02143                                            2143 09544000
@DB02143 DS    0H                                                  2144 09545000
*       BYTE#=(ENTRY#-1)/8+1;       /*                       @Z40LB61*/ 09546000
         L     @15,@PC00001+4                                      2144 09547000
         L     @14,EARGPTR(,@15)                                   2144 09548000
         LA    @05,1                                               2144 09549000
         LH    @04,ENTRY#                                          2144 09550000
         LR    @03,@04                                             2144 09551000
         BCTR  @03,0                                               2144 09552000
         LR    @00,@03                                             2144 09553000
         SRDA  @00,32                                              2144 09554000
         D     @00,@CF00183                                        2144 09555000
         ALR   @01,@05                                             2144 09556000
         STH   @01,BYTE#(,@14)                                     2144 09557000
*       BIT#=(ENTRY#-1)//8+1;       /*                       @Z40LB61*/ 09558000
         LR    @00,@03                                             2145 09559000
         ST    @01,@TF00001                                        2145 09560000
         SRDA  @00,32                                              2145 09561000
         D     @00,@CF00183                                        2145 09562000
         ALR   @00,@05                                             2145 09563000
         STH   @00,BIT#(,@14)                                      2145 09564000
*       IF(DVBCHKFF(SDG#,BYTE#)&BITMASK(BIT#))=0 THEN              2146 09565000
         LH    @01,SDG#                                            2146 09566000
         SLA   @01,4                                               2146 09567000
         AL    @01,@TF00001                                        2146 09568000
         L     @05,DVBCOPTR(,@15)                                  2146 09569000
         AL    @05,@CF01770                                        2146 09570000
         SLR   @03,@03                                             2146 09571000
         IC    @03,DVBCHKFF(@01,@05)                               2146 09572000
         LR    @02,@00                                             2146 09573000
         SLR   @05,@05                                             2146 09574000
         IC    @05,BITMASK-1(@02)                                  2146 09575000
         NR    @03,@05                                             2146 09576000
         LTR   @03,@03                                             2146 09577000
         BNZ   @RF02146                                            2146 09578000
*         DO;                       /*                       @Z40LB61*/ 09579000
*           DVBTBL(2)=ON;           /*                       @Z40LB61*/ 09580000
         L     @05,MARGPTR(,@15)                                   2148 09581000
         OI    DVBTBL+4(@05),B'00001000'                           2148 09582000
*           MVTPFLD=ON;             /*                       @Z40LB61*/ 09583000
         OI    MVTPFLD(@05),B'00100000'                            2149 09584000
*           FLDNUM(1)=DVBMVT(ENTRY#)&MASK8191;/*             @Z40LB61*/ 09585000
         ALR   @04,@04                                             2150 09586000
         SLR   @03,@03                                             2150 09587000
         ICM   @03,3,MASK8191                                      2150 09588000
         L     @02,DVBPTR                                          2150 09589000
         ALR   @02,@04                                             2150 09590000
         SLR   @04,@04                                             2150 09591000
         ICM   @04,3,DVBMVT-2(@02)                                 2150 09592000
         NR    @03,@04                                             2150 09593000
         ST    @03,FLDNUM(,@05)                                    2150 09594000
*           CHRINDEX(2)=PREVCHR;    /*                       @Z40LB61*/ 09595000
         MVC   CHRINDEX+24(5,@05),PREVCHR(@14)                     2151 09596000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 09597000
         L     @14,@PC00001                                        2152 09598000
         ST    @14,@AL00001                                        2152 09599000
         ST    @15,@AL00001+4                                      2152 09600000
         L     @15,@CV01495                                        2152 09601000
         LA    @01,@AL00001                                        2152 09602000
         BALR  @14,@15                                             2152 09603000
*         END;                      /*                       @Z40LB61*/ 09604000
*     END SCANDVB;                  /*                       @Z40LB61*/ 09605000
@RF02146 LA    @15,1                                               2154 09606000
         AH    @15,ENTRY#                                          2154 09607000
         STH   @15,ENTRY#                                          2154 09608000
         CH    @15,@CH00753                                        2154 09609000
         BNH   @DL02143                                            2154 09610000
@DC02143 DS    0H                                                  2155 09611000
*   END SCANSDG;                    /*                       @Z40LB61*/ 09612000
*                                                                  2155 09613000
         LA    @15,1                                               2155 09614000
         AH    @15,SDG#                                            2155 09615000
         STH   @15,SDG#                                            2155 09616000
         CH    @15,@CH00781                                        2155 09617000
         BNH   @DL02110                                            2155 09618000
*   /*****************************************************************/ 09619000
*   /*                                                               */ 09620000
*   /* PERFORM RESCANNING OF MSC TABLES ORGANIZED BY SA      @Z40LB61*/ 09621000
*   /*                                                               */ 09622000
*   /*****************************************************************/ 09623000
*                                                                  2156 09624000
*SALOOP4:                                                          2156 09625000
*   DO SA#=1 TO SAMAX;              /*                       @Z40LB61*/ 09626000
SALOOP4  LA    @15,1                                               2156 09627000
         STH   @15,SA#                                             2156 09628000
@DL02156 DS    0H                                                  2157 09629000
*     SAINDEX(2)=SA#-1;             /*                       @Z40LB61*/ 09630000
*                                                                  2157 09631000
         L     @14,@PC00001+4                                      2157 09632000
         L     @01,MARGPTR(,@14)                                   2157 09633000
         BCTR  @15,0                                               2157 09634000
         STC   @15,SAINDEX+24(,@01)                                2157 09635000
*     /***************************************************************/ 09636000
*     /*                                                             */ 09637000
*     /* COMPUTE POINTER TO VVAT SECTION FOR CURRENT SA      @Z40LB61*/ 09638000
*     /*                                                             */ 09639000
*     /***************************************************************/ 09640000
*                                                                  2158 09641000
*     VVATPTR=VVATADDR+(SA#-1)*LENGTH(VVAT);/*               @Z40LB61*/ 09642000
*                                                                  2158 09643000
         SLA   @15,5                                               2158 09644000
         AL    @15,VVATADDR(,@14)                                  2158 09645000
         ST    @15,VVATPTR                                         2158 09646000
*     /***************************************************************/ 09647000
*     /*                                                             */ 09648000
*     /* RESCAN THE ENTRIES FOR EACH VVA OF THE VVAT AND     @Z40LB61*/ 09649000
*     /* VMX TABLES                                          @Z40LB61*/ 09650000
*     /*                                                             */ 09651000
*     /***************************************************************/ 09652000
*                                                                  2159 09653000
*SCANVVAS:                                                         2159 09654000
*     DO VVA#=LOWVVA TO HIGHVVA     /*                       @ZA27324*/ 09655000
*           WHILE VLDSSID(SA#)^=NULLSSID;/*                  @ZA27324*/ 09656000
*                                                                  2159 09657000
SCANVVAS LA    @15,64                                              2159 09658000
         STH   @15,VVA#                                            2159 09659000
@DL02159 LH    @14,SA#                                             2159 09660000
         LR    @05,@14                                             2159 09661000
         ALR   @05,@05                                             2159 09662000
         L     @04,@PC00001+4                                      2159 09663000
         LH    @05,VLDSSID-2(@05,@04)                              2159 09664000
         CH    @05,@CH01340                                        2159 09665000
         BE    @DC02159                                            2159 09666000
*       /*************************************************************/ 09667000
*       /*                                                           */ 09668000
*       /* DO COMMON SET-UP OF INDICES TO THE CURRENT VVA    @Z40LB61*/ 09669000
*       /* AND SET-UP FOR POSSIBLE ERROR MESSAGES.           @Z40LB61*/ 09670000
*       /*                                                           */ 09671000
*       /*************************************************************/ 09672000
*                                                                  2160 09673000
*       WORKVVA=VVA#-LOWVVA+1;      /*                       @Z40LB61*/ 09674000
         LH    @05,@CH01729                                        2160 09675000
         ALR   @05,@15                                             2160 09676000
         STH   @05,WORKVVA                                         2160 09677000
*       BYTE#=(WORKVVA-1)/8+1;      /*                       @Z40LB61*/ 09678000
         L     @03,EARGPTR(,@04)                                   2161 09679000
         LA    @02,1                                               2161 09680000
         BCTR  @05,0                                               2161 09681000
         LR    @00,@05                                             2161 09682000
         SRDA  @00,32                                              2161 09683000
         D     @00,@CF00183                                        2161 09684000
         ALR   @01,@02                                             2161 09685000
         STH   @01,BYTE#(,@03)                                     2161 09686000
*       BIT#=(WORKVVA-1)//8+1;      /*                       @Z40LB61*/ 09687000
         LR    @14,@05                                             2162 09688000
         SRDA  @14,32                                              2162 09689000
         D     @14,@CF00183                                        2162 09690000
         ALR   @14,@02                                             2162 09691000
         STH   @14,BIT#(,@03)                                      2162 09692000
*       VVAINDEX(2)=VVA#;           /*                       @Z40LB61*/ 09693000
         LH    @15,VVA#                                            2163 09694000
         L     @05,MARGPTR(,@04)                                   2163 09695000
         STC   @15,VVAINDEX+24(,@05)                               2163 09696000
*       FLDNUM(1)=VVA#;             /*                       @Z40LB61*/ 09697000
*                                                                  2164 09698000
         ST    @15,FLDNUM(,@05)                                    2164 09699000
*       /*************************************************************/ 09700000
*       /*                                                           */ 09701000
*       /* IF THE VVAT ENTRY IS VALID BUT THE CHECK-OFF      @Z40LB61*/ 09702000
*       /* BIT IS OFF, PRINT AN ERROR MESSAGE.               @Z40LB61*/ 09703000
*       /*                                                           */ 09704000
*       /*************************************************************/ 09705000
*                                                                  2165 09706000
*       WORKVAL1=VVATVVA(BYTE#)&BITMASK(BIT#);/*             @Z40LB61*/ 09707000
         SLR   @15,@15                                             2165 09708000
         IC    @15,BITMASK-1(@14)                                  2165 09709000
         L     @14,VVATPTR                                         2165 09710000
         AL    @14,@CF01340                                        2165 09711000
         SLR   @00,@00                                             2165 09712000
         IC    @00,VVATVVA(@01,@14)                                2165 09713000
         NR    @00,@15                                             2165 09714000
         STH   @00,WORKVAL1                                        2165 09715000
*       WORKVAL2=VVACHKFF(SA#,BYTE#)&BITMASK(BIT#);/*        @Z40LB61*/ 09716000
         LH    @14,SA#                                             2166 09717000
         LR    @03,@14                                             2166 09718000
         MH    @03,@CH00314                                        2166 09719000
         ALR   @03,@01                                             2166 09720000
         L     @01,VVACOPTR(,@04)                                  2166 09721000
         AL    @01,@CF01759                                        2166 09722000
         SLR   @02,@02                                             2166 09723000
         IC    @02,VVACHKFF(@03,@01)                               2166 09724000
         NR    @15,@02                                             2166 09725000
         STH   @15,WORKVAL2                                        2166 09726000
*       IF WORKVAL1^=0&WORKVAL2=0 THEN                             2167 09727000
         SLR   @01,@01                                             2167 09728000
         CR    @00,@01                                             2167 09729000
         BE    @RF02167                                            2167 09730000
         CR    @15,@01                                             2167 09731000
         BNE   @RF02167                                            2167 09732000
*         DO;                       /*                       @Z40LB61*/ 09733000
*           VVATTBL(2)=ON;          /*                       @Z40LB61*/ 09734000
         OI    VVATTBL+4(@05),B'10000000'                          2169 09735000
*           VVAFLD=ON;              /*                       @Z40LB61*/ 09736000
         OI    VVAFLD(@05),B'01000000'                             2170 09737000
*           IF SA#>SAMAX/2 THEN                                    2171 09738000
         CH    @14,@CH00183                                        2171 09739000
         BNH   @RF02171                                            2171 09740000
*             CHRINDEX(2)=VVATCHR(2);/*                      @Z40LB61*/ 09741000
         MVC   CHRINDEX+24(5,@05),VVATCHR+5                        2172 09742000
*           ELSE                                                   2173 09743000
*             CHRINDEX(2)=VVATCHR(1);/*                      @Z40LB61*/ 09744000
         B     @RC02171                                            2173 09745000
@RF02171 L     @15,@PC00001+4                                      2173 09746000
         L     @01,MARGPTR(,@15)                                   2173 09747000
         MVC   CHRINDEX+24(5,@01),VVATCHR                          2173 09748000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 09749000
@RC02171 L     @15,@PC00001                                        2174 09750000
         ST    @15,@AL00001                                        2174 09751000
         L     @15,@PC00001+4                                      2174 09752000
         ST    @15,@AL00001+4                                      2174 09753000
         L     @15,@CV01495                                        2174 09754000
         LA    @01,@AL00001                                        2174 09755000
         BALR  @14,@15                                             2174 09756000
*         END;                      /*                       @Z40LB61*/ 09757000
*                                                                  2175 09758000
*       /*************************************************************/ 09759000
*       /*                                                           */ 09760000
*       /* OBTAIN THE VVA/MVT XREF TABLE ENTRY FOR THE       @Z40LB61*/ 09761000
*       /* CURRENT VVA                                       @Z40LB61*/ 09762000
*       /*                                                           */ 09763000
*       /*************************************************************/ 09764000
*                                                                  2176 09765000
*       TABLEID=VMXTBLID;           /*                       @Z40LB61*/ 09766000
@RF02167 L     @15,@PC00001+4                                      2176 09767000
         L     @14,EARGPTR(,@15)                                   2176 09768000
         MVC   TABLEID(1,@14),VMXTBLID                             2176 09769000
*       SANUM=SA#-1;                /*                       @Z40LB61*/ 09770000
         LH    @05,SA#                                             2177 09771000
         BCTR  @05,0                                               2177 09772000
         STH   @05,SANUM(,@14)                                     2177 09773000
*       VVADDR=VVA#;                /*                       @Z40LB61*/ 09774000
         MVC   VVADDR(2,@14),VVA#                                  2178 09775000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB61*/ 09776000
         L     @14,@PC00001                                        2179 09777000
         ST    @14,@AL00001                                        2179 09778000
         ST    @15,@AL00001+4                                      2179 09779000
         L     @15,@CV01494                                        2179 09780000
         LA    @01,@AL00001                                        2179 09781000
         BALR  @14,@15                                             2179 09782000
*       IF GETRC^=0 THEN                                           2180 09783000
         L     @15,@PC00001+4                                      2180 09784000
         L     @01,EARGPTR(,@15)                                   2180 09785000
         ICM   @00,3,GETRC(@01)                                    2180 09786000
         BZ    @RF02180                                            2180 09787000
*         DO;                       /*                       @Z40LB61*/ 09788000
*           LASTCOND=LASTCC12;      /*                       @Z40LB61*/ 09789000
         L     @15,@PC00001+8                                      2182 09790000
         MVC   LASTCOND(2,@15),@CH00567                            2182 09791000
*           RETURN;                 /*                       @Z40LB61*/ 09792000
         B     @EL00015                                            2183 09793000
*         END;                      /*                       @Z40LB61*/ 09794000
*       VMXPTR=TBLADDR;             /*                       @Z40LB61*/ 09795000
*                                                                  2185 09796000
@RF02180 L     @15,@PC00001+4                                      2185 09797000
         L     @14,EARGPTR(,@15)                                   2185 09798000
         L     @05,TBLADDR(,@14)                                   2185 09799000
         ST    @05,VMXPTR                                          2185 09800000
*       /*************************************************************/ 09801000
*       /*                                                           */ 09802000
*       /* IF THE VMX ENTRY IS VALID BUT THE CHECK-OFF       @Z40LB61*/ 09803000
*       /* BIT IS OFF, PRINT AN ERROR MESSAGE.               @Z40LB61*/ 09804000
*       /*                                                           */ 09805000
*       /*************************************************************/ 09806000
*                                                                  2186 09807000
*       WORKVAL1=VMXCHKFF(SA#,BYTE#)&BITMASK(BIT#);/*        @Z40LB61*/ 09808000
         LH    @04,SA#                                             2186 09809000
         MH    @04,@CH00314                                        2186 09810000
         AH    @04,BYTE#(,@14)                                     2186 09811000
         L     @01,VMXCOPTR(,@15)                                  2186 09812000
         LH    @03,BIT#(,@14)                                      2186 09813000
         AL    @01,@CF01759                                        2186 09814000
         SLR   @00,@00                                             2186 09815000
         IC    @00,VMXCHKFF(@04,@01)                               2186 09816000
         SLR   @02,@02                                             2186 09817000
         IC    @02,BITMASK-1(@03)                                  2186 09818000
         NR    @00,@02                                             2186 09819000
         STH   @00,WORKVAL1                                        2186 09820000
*       IF VMXVALID=ON&WORKVAL1=0 THEN                             2187 09821000
         TM    VMXVALID(@05),B'10000000'                           2187 09822000
         BNO   @RF02187                                            2187 09823000
         LTR   @00,@00                                             2187 09824000
         BNZ   @RF02187                                            2187 09825000
*         DO;                       /*                       @Z40LB61*/ 09826000
*           VMXTBL(2)=ON;           /*                       @Z40LB61*/ 09827000
         L     @05,MARGPTR(,@15)                                   2189 09828000
         OI    VMXTBL+4(@05),B'00000001'                           2189 09829000
*           VVAFLD=ON;              /*                       @Z40LB61*/ 09830000
         OI    VVAFLD(@05),B'01000000'                             2190 09831000
*           CHRINDEX(2)=PREVCHR;    /*                       @Z40LB61*/ 09832000
         MVC   CHRINDEX+24(5,@05),PREVCHR(@14)                     2191 09833000
*           CALL IDCCH04(GDTTBL,CDALIST);/*                  @Z40LB61*/ 09834000
         L     @14,@PC00001                                        2192 09835000
         ST    @14,@AL00001                                        2192 09836000
         ST    @15,@AL00001+4                                      2192 09837000
         L     @15,@CV01495                                        2192 09838000
         LA    @01,@AL00001                                        2192 09839000
         BALR  @14,@15                                             2192 09840000
*         END;                      /*                       @Z40LB61*/ 09841000
*     END SCANVVAS;                 /*                       @Z40LB61*/ 09842000
*                                                                  2194 09843000
@RF02187 LA    @15,1                                               2194 09844000
         AH    @15,VVA#                                            2194 09845000
         STH   @15,VVA#                                            2194 09846000
         CH    @15,@CH01333                                        2194 09847000
         BNH   @DL02159                                            2194 09848000
@DC02159 DS    0H                                                  2195 09849000
*     /***************************************************************/ 09850000
*     /*                                                             */ 09851000
*     /* RESCAN THE ENTRIES FOR EACH INTERFACE OF THE CDB    @Z40LB61*/ 09852000
*     /*                                                             */ 09853000
*     /***************************************************************/ 09854000
*                                                                  2195 09855000
*SCANCDB:                                                          2195 09856000
*     DO INTF#=1 TO INTFSSA         /*                       @ZA27324*/ 09857000
*           WHILE VLDSSID(SA#)^=NULLSSID;/*                  @ZA27324*/ 09858000
*                                                                  2195 09859000
SCANCDB  LA    @15,1                                               2195 09860000
         STH   @15,INTF#                                           2195 09861000
@DL02195 LH    @14,SA#                                             2195 09862000
         ALR   @14,@14                                             2195 09863000
         L     @05,@PC00001+4                                      2195 09864000
         LH    @14,VLDSSID-2(@14,@05)                              2195 09865000
         CH    @14,@CH01340                                        2195 09866000
         BE    @DC02195                                            2195 09867000
*       /*************************************************************/ 09868000
*       /*                                                           */ 09869000
*       /* OBTAIN THE CDB TABLE BLOCK FOR THE CURRENT SA     @Z40LB61*/ 09870000
*       /* INTERFACE                                         @Z40LB61*/ 09871000
*       /*                                                           */ 09872000
*       /*************************************************************/ 09873000
*                                                                  2196 09874000
*       BUFFER2=ON;                 /*                       @Z40LB61*/ 09875000
         L     @14,EARGPTR(,@05)                                   2196 09876000
         OI    BUFFER2(@14),B'01000000'                            2196 09877000
*       TABLEID=CFGTBLID;           /*                       @Z40LB61*/ 09878000
         MVC   TABLEID(1,@14),CFGTBLID                             2197 09879000
*       CDBFLAG=ON;                 /*                       @Z40LB61*/ 09880000
         OI    CDBFLAG(@14),B'00000010'                            2198 09881000
*       INTFID=INTF#;               /*                       @Z40LB61*/ 09882000
         STH   @15,INTFID(,@14)                                    2199 09883000
*       CALL IDCCH03(GDTTBL,CDALIST);/*                      @Z40LB61*/ 09884000
         L     @04,@PC00001                                        2200 09885000
         ST    @04,@AL00001                                        2200 09886000
         ST    @05,@AL00001+4                                      2200 09887000
         L     @15,@CV01494                                        2200 09888000
         LA    @01,@AL00001                                        2200 09889000
         BALR  @14,@15                                             2200 09890000
*       IF GETRC^=0 THEN                                           2201 09891000
         L     @15,@PC00001+4                                      2201 09892000
         L     @01,EARGPTR(,@15)                                   2201 09893000
         ICM   @00,3,GETRC(@01)                                    2201 09894000
         BZ    @RF02201                                            2201 09895000
*         DO;                       /*                       @Z40LB61*/ 09896000
*           LASTCOND=LASTCC12;      /*                       @Z40LB61*/ 09897000
         L     @15,@PC00001+8                                      2203 09898000
         MVC   LASTCOND(2,@15),@CH00567                            2203 09899000
*           RETURN;                 /*                       @Z40LB61*/ 09900000
         B     @EL00015                                            2204 09901000
*         END;                      /*                       @Z40LB61*/ 09902000
*       CDBPTR=TBLADDR;             /*                       @Z40LB61*/ 09903000
*                                                                  2206 09904000
@RF02201 L     @15,@PC00001+4                                      2206 09905000
         L     @01,EARGPTR(,@15)                                   2206 09906000
         MVC   CDBPTR(4),TBLADDR(@01)                              2206 09907000
*       /*************************************************************/ 09908000
*       /*                                                           */ 09909000
*       /* RESCAN THE CDB ENTRY FOR EACH VIRTUAL UNIT ADDR   @Z40LB61*/ 09910000
*       /*                                                           */ 09911000
*       /*************************************************************/ 09912000
*                                                                  2207 09913000
*       DO WORKVUA=1 TO HIGHVUA+1   /*                       @ZA27324*/ 09914000
*             WHILE VLDSSID(SA#)^=NULLSSID;/*                @ZA27324*/ 09915000
*                                                                  2207 09916000
         LA    @15,1                                               2207 09917000
         STH   @15,WORKVUA                                         2207 09918000
@DL02207 LH    @14,SA#                                             2207 09919000
         LR    @05,@14                                             2207 09920000
         ALR   @05,@05                                             2207 09921000
         L     @04,@PC00001+4                                      2207 09922000
         LH    @05,VLDSSID-2(@05,@04)                              2207 09923000
         CH    @05,@CH01340                                        2207 09924000
         BE    @DC02207                                            2207 09925000
*         /***********************************************************/ 09926000
*         /*                                                         */ 09927000
*         /* IF THE CDB ENTRY IS VALID BUT THE CHECK-OFF     @Z40LB61*/ 09928000
*         /* BIT IS OFF, PRINT AN ERROR MESSAGE.             @Z40LB61*/ 09929000
*         /*                                                         */ 09930000
*         /***********************************************************/ 09931000
*                                                                  2208 09932000
*         BYTE#=(WORKVUA-1)/8+1;    /*                       @Z40LB61*/ 09933000
         L     @05,EARGPTR(,@04)                                   2208 09934000
         LA    @03,1                                               2208 09935000
         LR    @02,@15                                             2208 09936000
         BCTR  @02,0                                               2208 09937000
         LR    @00,@02                                             2208 09938000
         SRDA  @00,32                                              2208 09939000
         D     @00,@CF00183                                        2208 09940000
         ALR   @01,@03                                             2208 09941000
         STH   @01,BYTE#(,@05)                                     2208 09942000
*         BIT#=(WORKVUA-1)//8+1;    /*                       @Z40LB61*/ 09943000
         LR    @14,@02                                             2209 09944000
         SRDA  @14,32                                              2209 09945000
         D     @14,@CF00183                                        2209 09946000
         ALR   @14,@03                                             2209 09947000
         STH   @14,BIT#(,@05)                                      2209 09948000
*         WORKVAL1=CDBCHKFF(SA#,INTF#,BYTE#)&BITMASK(BIT#);/*      2210 09949000
*                                                            @Z40LB61*/ 09950000
         LH    @15,INTF#                                           2210 09951000
         LH    @03,SA#                                             2210 09952000
         MH    @03,@CH00166                                        2210 09953000
         ALR   @03,@15                                             2210 09954000
         SLA   @03,3                                               2210 09955000
         ALR   @03,@01                                             2210 09956000
         L     @01,CDBCOPTR(,@04)                                  2210 09957000
         AL    @01,@CF01765                                        2210 09958000
         SLR   @00,@00                                             2210 09959000
         IC    @00,CDBCHKFF(@03,@01)                               2210 09960000
         SLR   @01,@01                                             2210 09961000
         IC    @01,BITMASK-1(@14)                                  2210 09962000
         NR    @00,@01                                             2210 09963000
         STH   @00,WORKVAL1                                        2210 09964000
*         IF CDBCNFIG(WORKVUA)^='FF'X&CDBINUSE(WORKVUA)=ON&WORKVAL1=0   09965000
*           THEN                                                   2211 09966000
         L     @03,CDBPTR                                          2211 09967000
         LH    @14,WORKVUA                                         2211 09968000
         SLA   @14,2                                               2211 09969000
         ST    @14,@TF00001                                        2211 09970000
         ALR   @14,@03                                             2211 09971000
         AL    @14,@CF01761                                        2211 09972000
         CLI   CDBCNFIG(@14),X'FF'                                 2211 09973000
         BE    @RF02211                                            2211 09974000
         AL    @03,@TF00001                                        2211 09975000
         AL    @03,@CF01761                                        2211 09976000
         TM    CDBINUSE(@03),B'01000000'                           2211 09977000
         BNO   @RF02211                                            2211 09978000
         LTR   @00,@00                                             2211 09979000
         BNZ   @RF02211                                            2211 09980000
*           DO;                     /*                       @Z40LB61*/ 09981000
*             CDBTBL(2)=ON;         /*                       @Z40LB61*/ 09982000
         L     @03,MARGPTR(,@04)                                   2213 09983000
         OI    CDBTBL+4(@03),B'00100000'                           2213 09984000
*             VUAFLD=ON;            /*                       @Z40LB61*/ 09985000
         OI    VUAFLD(@03),B'00010000'                             2214 09986000
*             FLDNUM(1)=WORKVUA-1;  /*                       @Z40LB61*/ 09987000
         ST    @02,FLDNUM(,@03)                                    2215 09988000
*             INFINDEX(2)=INTF#;    /*                       @Z40LB61*/ 09989000
         STC   @15,INFINDEX+24(,@03)                               2216 09990000
*             VUAINDEX(2)=WORKVUA-1;/*                       @Z40LB61*/ 09991000
         STC   @02,VUAINDEX+24(,@03)                               2217 09992000
*             CHRINDEX(2)=PREVCHR;  /*                       @Z40LB61*/ 09993000
         MVC   CHRINDEX+24(5,@03),PREVCHR(@05)                     2218 09994000
*             CALL IDCCH04(GDTTBL,CDALIST);/*                @Z40LB61*/ 09995000
         L     @05,@PC00001                                        2219 09996000
         ST    @05,@AL00001                                        2219 09997000
         ST    @04,@AL00001+4                                      2219 09998000
         L     @15,@CV01495                                        2219 09999000
         LA    @01,@AL00001                                        2219 10000000
         BALR  @14,@15                                             2219 10001000
*           END;                    /*                       @Z40LB61*/ 10002000
*       END;                        /*                       @Z40LB61*/ 10003000
@RF02211 LA    @15,1                                               2221 10004000
         AH    @15,WORKVUA                                         2221 10005000
         STH   @15,WORKVUA                                         2221 10006000
         CH    @15,@CH00580                                        2221 10007000
         BNH   @DL02207                                            2221 10008000
@DC02207 DS    0H                                                  2222 10009000
*     END SCANCDB;                  /*                       @Z40LB61*/ 10010000
         LA    @15,1                                               2222 10011000
         AH    @15,INTF#                                           2222 10012000
         STH   @15,INTF#                                           2222 10013000
         CH    @15,@CH00166                                        2222 10014000
         BNH   @DL02195                                            2222 10015000
@DC02195 DS    0H                                                  2223 10016000
*   END SALOOP4;                    /*                       @Z40LB61*/ 10017000
*                                                                  2223 10018000
         LA    @15,1                                               2223 10019000
         AH    @15,SA#                                             2223 10020000
         STH   @15,SA#                                             2223 10021000
         CH    @15,@CH00478                                        2223 10022000
         BNH   @DL02156                                            2223 10023000
*   /*****************************************************************/ 10024000
*   /*                                                               */ 10025000
*   /* RESET THE 'IDCCH04' OPTION FLAGS                      @Z40LB61*/ 10026000
*   /*                                                               */ 10027000
*   /*****************************************************************/ 10028000
*                                                                  2224 10029000
*   MSGTYPE=''B;                    /*                       @Z40LB61*/ 10030000
         L     @15,@PC00001+4                                      2224 10031000
         L     @15,MARGPTR(,@15)                                   2224 10032000
         XC    MSGTYPE(4,@15),MSGTYPE(@15)                         2224 10033000
*   TBLTYPE(1)=''B;                 /*                       @Z40LB61*/ 10034000
         XC    TBLTYPE(4,@15),TBLTYPE(@15)                         2225 10035000
*   TBLTYPE(2)=''B;                 /*                       @Z40LB61*/ 10036000
         XC    TBLTYPE+4(4,@15),TBLTYPE+4(@15)                     2226 10037000
*   END SCANMSC;                    /*                       @Z40LB61*/ 10038000
         B     @EL00015                                            2227 10039000
@PB00015 DS    0H                                                  2228 10040000
*   CALL IDCSAEP0(GDTTBL,MODID);                                   2228 10041000
*                                                                  2228 10042000
         L     @15,@PC00001                                        2228 10043000
         ST    @15,@AL00001                                        2228 10044000
         LA    @14,MODID                                           2228 10045000
         ST    @14,@AL00001+4                                      2228 10046000
         MVI   @AL00001+4,X'80'                                    2228 10047000
         L     @15,GDTEPL(,@15)                                    2228 10048000
         LA    @01,@AL00001                                        2228 10049000
         BALR  @14,@15                                             2228 10050000
*   /*****************************************************************/ 10051000
*   /*                                                               */ 10052000
*   /*                                                       @Z40LB61*/ 10053000
*   /*                                                               */ 10054000
*   /*****************************************************************/ 10055000
*                                                                  2229 10056000
*   END IDCCH02                     /*                       @Z40LB61*/ 10057000
*                                                                  2229 10058000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 10059000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 10060000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 10061000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 10062000
*/*%INCLUDE SYSLIB  (IDCDF11 )                                       */ 10063000
*/*%INCLUDE SYSLIB  (IDCDF56 )                                       */ 10064000
*                                                                  2229 10065000
*       ;                                                          2229 10066000
         B     @EL00001                                            2229 10067000
@DATA    DS    0H                                                       10068000
@CH00119 DC    H'0'                                                     10069000
@CH00166 DC    H'3'                                                     10070000
@CH00290 DC    H'5'                                                     10071000
@CH00567 DC    H'12'                                                    10072000
@CH00478 DC    H'16'                                                    10073000
@CH00314 DC    H'24'                                                    10074000
@CH01474 DC    H'28'                                                    10075000
@CH00781 DC    H'30'                                                    10076000
@CH00868 DC    H'51'                                                    10077000
@CH00684 DC    H'52'                                                    10078000
@CH01728 DC    H'56'                                                    10079000
@CH00580 DC    H'64'                                                    10080000
@CH01472 DC    H'98'                                                    10081000
@CH00753 DC    H'126'                                                   10082000
@CH01727 DC    H'149'                                                   10083000
@CH01476 DC    H'150'                                                   10084000
@CH01726 DC    H'248'                                                   10085000
@CH01333 DC    H'255'                                                   10086000
@CH00606 DC    H'256'                                                   10087000
@CH01729 DC    H'-63'                                                   10088000
@CH01723 DC    H'-20'                                                   10089000
@CH01733 DC    H'-7'                                                    10090000
@DATD    DSECT                                                          10091000
         DS    0F                                                       10092000
@SA00001 DS    18F                                                      10093000
@PC00001 DS    3F                                                       10094000
@SA00002 DS    15F                                                      10095000
@SA00003 DS    15F                                                      10096000
@SA00011 DS    15F                                                      10097000
@SA00013 DS    15F                                                      10098000
@SA00007 DS    15F                                                      10099000
@SA00015 DS    0F                                                       10100000
@SA00014 DS    0F                                                       10101000
@SA00012 DS    0F                                                       10102000
@SA00010 DS    0F                                                       10103000
@SA00009 DS    0F                                                       10104000
@SA00008 DS    0F                                                       10105000
@SA00006 DS    0F                                                       10106000
@SA00005 DS    0F                                                       10107000
@SA00004 DS    0F                                                       10108000
         DS    15F                                                      10109000
@AL00001 DS    3A                                                       10110000
@TF00001 DS    F                                                        10111000
IDCCH02  CSECT                                                          10112000
         DS    0F                                                       10113000
@CF00223 DC    F'1'                                                     10114000
@CH00223 EQU   @CF00223+2                                               10115000
@CF00157 DC    F'2'                                                     10116000
@CH00157 EQU   @CF00157+2                                               10117000
@CF00046 DC    F'4'                                                     10118000
@CH00046 EQU   @CF00046+2                                               10119000
@CF00769 DC    F'7'                                                     10120000
@CH00769 EQU   @CF00769+2                                               10121000
@CF00183 DC    F'8'                                                     10122000
@CH00183 EQU   @CF00183+2                                               10123000
@CF00225 DC    F'32'                                                    10124000
@CF01768 DC    F'-938'                                                  10125000
@CF01769 DC    F'-937'                                                  10126000
@CF01771 DC    F'-130'                                                  10127000
@CF01762 DC    F'-128'                                                  10128000
@CF01767 DC    F'-64'                                                   10129000
@CF01755 DC    F'-56'                                                   10130000
@CF01765 DC    F'-33'                                                   10131000
@CF01759 DC    F'-25'                                                   10132000
@CF01757 DC    F'-24'                                                   10133000
@CF01770 DC    F'-17'                                                   10134000
@CF01756 DC    F'-16'                                                   10135000
@CF01763 DC    F'-9'                                                    10136000
@CF01764 DC    F'-6'                                                    10137000
@CF01761 DC    F'-4'                                                    10138000
@CF01766 DC    F'-3'                                                    10139000
@CF01760 DC    F'-2'                                                    10140000
@CF01340 DC    F'-1'                                                    10141000
@CH01340 EQU   @CF01340+2                                               10142000
@DATD    DSECT                                                          10143000
         DS    0D                                                       10144000
LISTSCAN DS    A                                                        10145000
IOCSPTR  DS    A                                                        10146000
OPNPTR   DS    A                                                        10147000
DDSTRU   DS    A                                                        10148000
FSADDR   DS    A                                                        10149000
ERCNVADR DS    A                                                        10150000
DMPINDEX DS    A                                                        10151000
VADPTR1  DS    A                                                        10152000
VADPTR2  DS    A                                                        10153000
VVITPTR1 DS    A                                                        10154000
VVITPTR2 DS    A                                                        10155000
PSTPTR   DS    A                                                        10156000
LTRPTR   DS    A                                                        10157000
VTR1PTR  DS    A                                                        10158000
RPMPTR   DS    A                                                        10159000
PABPTR   DS    A                                                        10160000
DVBPTR   DS    A                                                        10161000
LPBPTR   DS    A                                                        10162000
VMXPTR   DS    A                                                        10163000
VVATPTR  DS    A                                                        10164000
CBMPTR   DS    A                                                        10165000
MERPTR   DS    A                                                        10166000
MVCBPTR  DS    A                                                        10167000
MVIBPTR  DS    A                                                        10168000
MVENTPTR DS    A                                                        10169000
SCCFPTR  DS    A                                                        10170000
SCENTPTR DS    A                                                        10171000
VICFPTR  DS    A                                                        10172000
VIENTPTR DS    A                                                        10173000
TVCFPTR  DS    A                                                        10174000
TVENTPTR DS    A                                                        10175000
CIENTPTR DS    A                                                        10176000
MICPTR   DS    A                                                        10177000
CDBPTR   DS    A                                                        10178000
CMCBPTR  DS    A                                                        10179000
CMENTPTR DS    A                                                        10180000
MOVEPTR  DS    A                                                        10181000
CMCOEPTR DS    A                                                        10182000
LISTPTR  DS    A                                                        10183000
MVPATH#  DS    H                                                        10184000
CISA#    DS    H                                                        10185000
CDBVUA#  DS    H                                                        10186000
SA#      DS    H                                                        10187000
TBLBLK#  DS    H                                                        10188000
INTF#    DS    H                                                        10189000
SDG#     DS    H                                                        10190000
ENTRY#   DS    H                                                        10191000
DEV#     DS    H                                                        10192000
LUA#     DS    H                                                        10193000
MVVP#    DS    H                                                        10194000
RP#      DS    H                                                        10195000
PABPATH# DS    H                                                        10196000
VVA#     DS    H                                                        10197000
L3333#   DS    H                                                        10198000
TBLSECT# DS    H                                                        10199000
SAINTF#  DS    H                                                        10200000
WORKSA   DS    H                                                        10201000
WRKCPUID DS    H                                                        10202000
WORKVUA  DS    H                                                        10203000
WORKVVA  DS    H                                                        10204000
WORKDEV  DS    H                                                        10205000
WORKRP   DS    H                                                        10206000
PABABOX  DS    H                                                        10207000
ERRTYPE  DS    H                                                        10208000
MVSA#    DS    H                                                        10209000
PABSA#   DS    H                                                        10210000
WORKVAL1 DS    H                                                        10211000
WORKVAL2 DS    H                                                        10212000
PGLIMIT  DS    H                                                        10213000
INACTCNT DS    H                                                        10214000
LRUDCNT  DS    H                                                        10215000
FPBITCNT DS    H                                                        10216000
APBITCNT DS    H                                                        10217000
FPTOTAL  DS    H                                                        10218000
APTOTAL  DS    H                                                        10219000
IPTOTAL  DS    H                                                        10220000
BPTOTAL  DS    H                                                        10221000
MSF#     DS    H                                                        10222000
CMBLK#   DS    H                                                        10223000
CMENTVAL DS    H                                                        10224000
CMORGVAL DS    H                                                        10225000
CMCOVAL  DS    H                                                        10226000
CMENTMSK DS    H                                                        10227000
MSCTBL   DS    H                                                        10228000
SCLMSF#  DS    H                                                        10229000
MSFL#    DS    H                                                        10230000
MSFX#    DS    H                                                        10231000
MSFY#    DS    H                                                        10232000
MSFZ#    DS    H                                                        10233000
CTGSEQ#  DS    H                                                        10234000
LZYXADDR DS    H                                                        10235000
CHUNK#   DS    H                                                        10236000
CUBE#    DS    H                                                        10237000
XPOSCUBE DS    H                                                        10238000
YPOSCUBE DS    H                                                        10239000
CUBEBIT  DS    H                                                        10240000
CUBEBYTE DS    H                                                        10241000
BLKPOS#  DS    H                                                        10242000
XINCREAS DS    H                                                        10243000
SETRC    DS    H                                                        10244000
TESTRC   DS    H                                                        10245000
WORK3333 DS    FL1                                                      10246000
LISTLN   DS    FL1                                                      10247000
@TS00001 DS    CL95                                                     10248000
CICHR    DS    CL5                                                      10249000
         DS    CL2                                                      10250000
SAVEID   DS    CL12                                                     10251000
         ORG   SAVEID                                                   10252000
SAVEADDR DS    AL4                                                      10253000
SAVECHR  DS    CL5                                                      10254000
SAVEENT# DS    FL1                                                      10255000
SAVEREC# DS    FL2                                                      10256000
         ORG   SAVEID+12                                                10257000
INTARRAY DS    BL6                                                      10258000
         ORG   INTARRAY                                                 10259000
@NM00119 DS    BL1                                                      10260000
         ORG   @NM00119+0                                               10261000
ACTINTF  DS    BL1                                                      10262000
DONEINTF EQU   @NM00119+0                                               10263000
@NM00120 EQU   @NM00119+0                                               10264000
         ORG   INTARRAY+6                                               10265000
STAGEDEV DS    BL1                                                      10266000
VP1STHIT DS    BL1                                                      10267000
MATCHED  DS    BL1                                                      10268000
MVSHARED DS    BL1                                                      10269000
ENDFLAG  DS    BL1                                                      10270000
ERRFLAG  DS    BL1                                                      10271000
MSFFLAG  DS    BL1                                                      10272000
VVATCHR  DS    2CL5                                                     10273000
ACTIVSA  DS    2BL1                                                     10274000
         DS    CL1                                                      10275000
MNTCOUNT DS    30H                                                      10276000
FPCOUNT  DS    8H                                                       10277000
APCOUNT  DS    8H                                                       10278000
IPCOUNT  DS    8H                                                       10279000
BPCOUNT  DS    8H                                                       10280000
CMCHR    DS    16CL5                                                    10281000
MSFXLOW  DS    4H                                                       10282000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                10283000
@ENDDATD EQU   *                                                        10284000
IDCCH02  CSECT                                                          10285000
         DS    0F                                                       10286000
@SIZDATD DC    AL1(0)                                                   10287000
         DC    AL3(@ENDDATD-@DATD)                                      10288000
@CV01494 DC    V(IDCCH03)                                               10289000
@CV01495 DC    V(IDCCH04)                                               10290000
         DS    0D                                                       10291000
DUMMYPTR DC    F'-1'                                                    10292000
MASK8191 DC    XL2'1FFF'                                                10293000
XVALMASK DC    XL2'00FF'                                                10294000
YVALMASK DC    XL2'1F00'                                                10295000
ZVALMASK DC    XL2'2000'                                                10296000
SDGTBLID DC    XL1'10'                                                  10297000
MVTBLID  DC    XL1'20'                                                  10298000
SCLTBLID DC    XL1'30'                                                  10299000
VITBLID  DC    XL1'40'                                                  10300000
TVLTBLID DC    XL1'50'                                                  10301000
VMXTBLID DC    XL1'60'                                                  10302000
CFGTBLID DC    XL1'70'                                                  10303000
CMTBLID  DC    XL1'90'                                                  10304000
VVATBLID DC    XL1'A0'                                                  10305000
MASK3    DC    XL1'03'                                                  10306000
MASK7    DC    XL1'07'                                                  10307000
MASK15   DC    XL1'0F'                                                  10308000
MASK31   DC    XL1'1F'                                                  10309000
MASK63   DC    XL1'3F'                                                  10310000
MASK3333 DC    XL1'08'                                                  10311000
FLIPMASK DC    XL1'FF'                                                  10312000
LASTCUBE DC    XL1'FF'                                                  10313000
@CC01503 DC    C'CH2A'                                                  10314000
@CC01546 DC    C'CH2X'                                                  10315000
@CC01550 DC    C'CH2E'                                                  10316000
@CC01559 DC    C'CH2Y'                                                  10317000
@CC01563 DC    C'CH2F'                                                  10318000
@CC01569 DC    C'CH2G'                                                  10319000
@CC01576 DC    C'CH2H'                                                  10320000
@CC01586 DC    C'CH2J'                                                  10321000
@CC01593 DC    C'CH2K'                                                  10322000
@CC01604 DC    C'CH2L'                                                  10323000
@CC01610 DC    C'CH2M'                                                  10324000
@CC01617 DC    C'CH2N'                                                  10325000
@CC01628 DC    C'CH2P'                                                  10326000
@CC01634 DC    C'CH2Q'                                                  10327000
@CC01641 DC    C'CH2R'                                                  10328000
@CC01651 DC    C'CH2S'                                                  10329000
@CC01659 DC    C'CH2T'                                                  10330000
@CC01674 DC    C'CH2U'                                                  10331000
@CC01690 DC    C'CH2V'                                                  10332000
@CC01696 DC    C'CH2W'                                                  10333000
@CC01343 DC    C'YES'                                                   10334000
@CC01345 DC    C'NO '                                                   10335000
@CB01703 DC    X'0000'                                                  10336000
ALL      DC    CL3'ALL'                                                 10337000
FORMAT   DC    CL4'FORM'                                                10338000
HSECOND  DC    CL4'HSEC'                                                10339000
CLOCK    DC    CL4'KLOK'                                                10340000
SETZERO  DC    CL4'ZERO'                                                10341000
SETBLANK DC    CL4'BLNK'                                                10342000
NOSET    DC    CL4'NSET'                                                10343000
OVERRIDE DC    CL4'OVRD'                                                10344000
ACQUIRE  DC    CL8'ACQUIRE '                                            10345000
RELINQ   DC    CL8'RELINQ  '                                            10346000
MOUNT    DC    CL8'MOUNT   '                                            10347000
DEMOUNT  DC    CL8'DEMOUNT '                                            10348000
DEFINE   DC    CL8'DEFINE  '                                            10349000
MOVE     DC    CL8'MOVE    '                                            10350000
TRACEQ   DC    CL8'TRACEQ  '                                            10351000
COPYTABL DC    CL8'COPYTABL'                                            10352000
COPYCRTG DC    CL8'COPYCRTG'                                            10353000
COPYVOL  DC    CL8'COPYVOL '                                            10354000
VVIC     DC    CL8'VVIC    '                                            10355000
TUNE     DC    CL8'TUNE    '                                            10356000
NAMES    DC    CL4'NAME'                                                10357000
UNIT     DC    CL4'UNIT'                                                10358000
SHR      DC    CL4'SHR '                                                10359000
EXCL     DC    CL4'EXCL'                                                10360000
NOWAIT   DC    CL4'NWAI'                                                10361000
WAIT     DC    CL4'WAIT'                                                10362000
MODID    DC    CL4'CH02'                                                10363000
FIXAREA  DS    CL1024                                                   10364000
         ORG   FIXAREA                                                  10365000
@NM00111 DS    CL256                                                    10366000
         ORG   @NM00111                                                 10367000
@NM00112 DC    256X'00'                                                 10368000
         ORG   FIXAREA+256                                              10369000
@NM00113 DS    CL256                                                    10370000
         ORG   @NM00113                                                 10371000
@NM00114 DC    256X'00'                                                 10372000
         ORG   FIXAREA+512                                              10373000
@NM00115 DS    CL256                                                    10374000
         ORG   @NM00115                                                 10375000
@NM00116 DC    256X'00'                                                 10376000
         ORG   FIXAREA+768                                              10377000
@NM00117 DS    CL256                                                    10378000
         ORG   @NM00117                                                 10379000
@NM00118 DC    256X'00'                                                 10380000
         ORG   FIXAREA+1024                                             10381000
BITMASK  DC    X'80'                                                    10382000
         DC    X'40'                                                    10383000
         DC    X'20'                                                    10384000
         DC    X'10'                                                    10385000
         DC    X'08'                                                    10386000
         DC    X'04'                                                    10387000
         DC    X'02'                                                    10388000
         DC    X'01'                                                    10389000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       10390000
@01      EQU   01                                                       10391000
@02      EQU   02                                                       10392000
@03      EQU   03                                                       10393000
@04      EQU   04                                                       10394000
@05      EQU   05                                                       10395000
@06      EQU   06                                                       10396000
@07      EQU   07                                                       10397000
@08      EQU   08                                                       10398000
@09      EQU   09                                                       10399000
@10      EQU   10                                                       10400000
@11      EQU   11                                                       10401000
@12      EQU   12                                                       10402000
@13      EQU   13                                                       10403000
@14      EQU   14                                                       10404000
@15      EQU   15                                                       10405000
REG11    EQU   @11                                                      10406000
REG12    EQU   @12                                                      10407000
REG10    EQU   @10                                                      10408000
REG9     EQU   @09                                                      10409000
REG8     EQU   @08                                                      10410000
REG7     EQU   @07                                                      10411000
REG6     EQU   @06                                                      10412000
REG0     EQU   @00                                                      10413000
REG1     EQU   @01                                                      10414000
REG13    EQU   @13                                                      10415000
REG14    EQU   @14                                                      10416000
REG15    EQU   @15                                                      10417000
REG2     EQU   @02                                                      10418000
REG3     EQU   @03                                                      10419000
REG4     EQU   @04                                                      10420000
REG5     EQU   @05                                                      10421000
RTNREG   EQU   @15                                                      10422000
IDCSAEP0 EQU   0                                                        10423000
TRACE1   EQU   0                                                        10424000
OLDERID1 EQU   TRACE1                                                   10425000
TRACE2   EQU   0                                                        10426000
OLDERID2 EQU   TRACE2                                                   10427000
NEWID2   EQU   TRACE2+95                                                10428000
NEWERID2 EQU   5                                                        10429000
CIRAGL   EQU   0                                                        10430000
CIRTYPE  EQU   CIRAGL                                                   10431000
ALLAGL   EQU   0                                                        10432000
ALLSTS   EQU   ALLAGL+24                                                10433000
ALLDSP   EQU   ALLAGL+25                                                10434000
ALLORG   EQU   ALLAGL+26                                                10435000
ALLOPT   EQU   ALLAGL+28                                                10436000
UNITABL  EQU   0                                                        10437000
UNITADR  EQU   UNITABL+4                                                10438000
@NM00010 EQU   UNITADR                                                  10439000
UNITSTAT EQU   UNITABL+6                                                10440000
IOCSTR   EQU   0                                                        10441000
IOCDSO   EQU   IOCSTR+16                                                10442000
IOCRFM   EQU   IOCSTR+17                                                10443000
IOCMAC   EQU   IOCSTR+18                                                10444000
IOCMAC2  EQU   IOCSTR+19                                                10445000
IOCCHP   EQU   IOCSTR+20                                                10446000
IOCMSG   EQU   IOCSTR+21                                                10447000
IOCRBA   EQU   IOCSTR+40                                                10448000
IOCTTR   EQU   IOCRBA                                                   10449000
IOCMEM   EQU   IOCSTR+44                                                10450000
IOCNWM   EQU   IOCSTR+48                                                10451000
OPNAGL   EQU   0                                                        10452000
OPNOPT   EQU   OPNAGL                                                   10453000
OPNRFM   EQU   OPNAGL+1                                                 10454000
OPNTYP   EQU   OPNAGL+2                                                 10455000
OPNMOD   EQU   OPNAGL+3                                                 10456000
OPNDEV   EQU   OPNAGL+24                                                10457000
OPNDSO   EQU   OPNAGL+41                                                10458000
OPNOPT2  EQU   OPNAGL+42                                                10459000
IOINFOPT EQU   0                                                        10460000
UVOLLIST EQU   0                                                        10461000
UVOLENT  EQU   UVOLLIST+2                                               10462000
DARGLIST EQU   0                                                        10463000
DARGSTID EQU   DARGLIST+8                                               10464000
DARGARY  EQU   DARGLIST+20                                              10465000
DARGINS  EQU   DARGARY                                                  10466000
DARGINL  EQU   DARGARY+2                                                10467000
FMTLIST  EQU   0                                                        10468000
FMTFLGS  EQU   FMTLIST                                                  10469000
FMTSPF   EQU   FMTLIST+2                                                10470000
FMTRFNO  EQU   FMTSPF                                                   10471000
FMTILEN  EQU   FMTRFNO                                                  10472000
FMTIOFF  EQU   FMTLIST+4                                                10473000
FMTTRBC  EQU   FMTIOFF                                                  10474000
FMTSTO   EQU   FMTTRBC                                                  10475000
FMTOCOL  EQU   FMTLIST+6                                                10476000
FMTCNVF  EQU   FMTLIST+10                                               10477000
ERCNVTAB EQU   0                                                        10478000
ERTYPE   EQU   ERCNVTAB                                                 10479000
EROPER   EQU   ERCNVTAB+1                                               10480000
EROSOPER EQU   ERCNVTAB+2                                               10481000
IDCDB010 EQU   0                                                        10482000
DMPITM   EQU   0                                                        10483000
DMPARY   EQU   0                                                        10484000
VADWORD1 EQU   0                                                        10485000
VADRUA   EQU   VADWORD1+2                                               10486000
VADWORD2 EQU   0                                                        10487000
VADRPNUM EQU   VADWORD2                                                 10488000
VADLUA   EQU   VADWORD2+1                                               10489000
VADFLAGS EQU   VADWORD2+3                                               10490000
VVITBYT1 EQU   0                                                        10491000
VVITBYT2 EQU   0                                                        10492000
PST      EQU   0                                                        10493000
LTR      EQU   0                                                        10494000
LTRRUA   EQU   LTR                                                      10495000
VTABLER1 EQU   0                                                        10496000
@NM00038 EQU   VTABLER1+8                                               10497000
VTTBLCHR EQU   VTABLER1+16                                              10498000
VTSDGID  EQU   VTABLER1+80                                              10499000
VTUCB    EQU   VTABLER1+144                                             10500000
VTFLAGS  EQU   VTUCB                                                    10501000
VTTRCCHR EQU   VTABLER1+220                                             10502000
VTLRUCW  EQU   VTABLER1+236                                             10503000
VTRVPAGE EQU   VTABLER1+240                                             10504000
RPM      EQU   0                                                        10505000
RPMFLAGS EQU   RPM                                                      10506000
RPMACT   EQU   RPMFLAGS                                                 10507000
RPMINACT EQU   RPMFLAGS                                                 10508000
RPMBND   EQU   RPMFLAGS                                                 10509000
RPMVBND  EQU   RPMFLAGS                                                 10510000
RPMIOERR EQU   RPMFLAGS                                                 10511000
RPMMSCT  EQU   RPMFLAGS                                                 10512000
RPMNA    EQU   RPMFLAGS                                                 10513000
RPMVPNUM EQU   RPM+1                                                    10514000
RPMMVT   EQU   RPM+2                                                    10515000
PAB      EQU   0                                                        10516000
PABFTOT  EQU   PAB                                                      10517000
PABATOT  EQU   PAB+2                                                    10518000
PABITOT  EQU   PAB+4                                                    10519000
PABBTOT  EQU   PAB+6                                                    10520000
PABUPDEL EQU   PAB+9                                                    10521000
PABUPTH  EQU   PAB+10                                                   10522000
PABLODEL EQU   PAB+13                                                   10523000
PABLOTH  EQU   PAB+14                                                   10524000
PABSA    EQU   PAB+16                                                   10525000
PABVLDSA EQU   PABSA                                                    10526000
PAB3333  EQU   PABSA                                                    10527000
@NM00048 EQU   PAB+32                                                   10528000
PABFCNT  EQU   @NM00048                                                 10529000
PABACNT  EQU   @NM00048+1                                               10530000
PABICNT  EQU   @NM00048+2                                               10531000
PABBCNT  EQU   @NM00048+3                                               10532000
PABFMAP  EQU   PAB+64                                                   10533000
PABAMAP  EQU   PAB+128                                                  10534000
@NM00049 EQU   PAB+192                                                  10535000
PABFLAGS EQU   @NM00049                                                 10536000
PABDEX   EQU   PABFLAGS                                                 10537000
PABVARV  EQU   PABFLAGS                                                 10538000
PABVARR  EQU   PABFLAGS                                                 10539000
PABVBND  EQU   PABFLAGS                                                 10540000
PABVARN  EQU   PABFLAGS                                                 10541000
PAB2M11  EQU   PABFLAGS                                                 10542000
PABRINTF EQU   @NM00049+1                                               10543000
PABORUA  EQU   @NM00049+2                                               10544000
PABRUA   EQU   @NM00049+3                                               10545000
DVB      EQU   0                                                        10546000
DVBNEXT  EQU   DVB                                                      10547000
DVBMVT   EQU   DVB+4                                                    10548000
LPB      EQU   0                                                        10549000
LPBNEXT  EQU   LPB                                                      10550000
LPBMVT   EQU   LPB+4                                                    10551000
VMX      EQU   0                                                        10552000
VMXFLAGS EQU   VMX                                                      10553000
VMXVALID EQU   VMXFLAGS                                                 10554000
VMXMVT   EQU   VMX+2                                                    10555000
VVAT     EQU   0                                                        10556000
VVATVVA  EQU   VVAT                                                     10557000
CBMAP    EQU   0                                                        10558000
CBMDRIVE EQU   CBMAP+8                                                  10559000
MERECORD EQU   0                                                        10560000
@NM00055 EQU   MERECORD                                                 10561000
MEFLAGS  EQU   @NM00055                                                 10562000
MEMNTCNT EQU   @NM00055+2                                               10563000
@NM00057 EQU   MERECORD+128                                             10564000
MVCTLBLK EQU   0                                                        10565000
MVIDXBLK EQU   0                                                        10566000
MVIFLAGS EQU   MVIDXBLK                                                 10567000
@NM00060 EQU   MVIDXBLK+8                                               10568000
MVENTRY  EQU   0                                                        10569000
MVVOLID  EQU   MVENTRY                                                  10570000
MVVFLAGS EQU   MVENTRY+6                                                10571000
MVSECVOL EQU   MVVFLAGS                                                 10572000
MVEXCVOL EQU   MVVFLAGS                                                 10573000
MVBNDVOL EQU   MVVFLAGS                                                 10574000
MVWRTINH EQU   MVVFLAGS                                                 10575000
MVLZYX1  EQU   MVENTRY+8                                                10576000
MVLZYX2  EQU   MVENTRY+10                                               10577000
MVMFLAGS EQU   MVENTRY+12                                               10578000
MVMNTVOL EQU   MVMFLAGS                                                 10579000
MVREMNT  EQU   MVMFLAGS                                                 10580000
MVPINCNT EQU   MVENTRY+13                                               10581000
MVRESRVE EQU   MVENTRY+14                                               10582000
MVSA2RSV EQU   MVRESRVE                                                 10583000
MVSDG    EQU   MVENTRY+15                                               10584000
MV3333   EQU   MVENTRY+16                                               10585000
MVVAMSG  EQU   MVENTRY+17                                               10586000
@NM00069 EQU   MVENTRY+20                                               10587000
MVSA     EQU   @NM00069                                                 10588000
MVVLDSA  EQU   MVSA                                                     10589000
MVACTB   EQU   MVSA                                                     10590000
MVACTC   EQU   MVSA                                                     10591000
MVACTD   EQU   MVSA                                                     10592000
MVCPUIDS EQU   @NM00069+1                                               10593000
MVVVA    EQU   @NM00069+4                                               10594000
MVVUAS   EQU   @NM00069+5                                               10595000
@NM00071 EQU   MVENTRY+52                                               10596000
MVLOGDEV EQU   @NM00071                                                 10597000
MVPINACT EQU   MVLOGDEV                                                 10598000
MVBNDCNT EQU   @NM00071+1                                               10599000
MVRPNUM  EQU   @NM00071+2                                               10600000
MVCYLMAP EQU   @NM00071+3                                               10601000
MVCPUID  EQU   0                                                        10602000
MVVUA    EQU   0                                                        10603000
SCCTLFLD EQU   0                                                        10604000
SCCOMLEN EQU   SCCTLFLD                                                 10605000
SCCFLAGS EQU   SCCOMLEN                                                 10606000
SCTRKPTR EQU   SCCTLFLD+4                                               10607000
SCENTRY  EQU   0                                                        10608000
SCCSN    EQU   SCENTRY+4                                                10609000
SCLZYX   EQU   SCENTRY+16                                               10610000
VICTLFLD EQU   0                                                        10611000
VICFLAGS EQU   VICTLFLD                                                 10612000
VITRKPTR EQU   VICTLFLD+4                                               10613000
VIENTRY  EQU   0                                                        10614000
VIVOLID  EQU   VIENTRY                                                  10615000
VIVFLAGS EQU   VIENTRY+6                                                10616000
VISECVOL EQU   VIVFLAGS                                                 10617000
VIEXCVOL EQU   VIVFLAGS                                                 10618000
VIBNDVOL EQU   VIVFLAGS                                                 10619000
VIWRTINH EQU   VIVFLAGS                                                 10620000
VILZYX1  EQU   VIENTRY+8                                                10621000
VILZYX2  EQU   VIENTRY+10                                               10622000
TVCTLFLD EQU   0                                                        10623000
TVCOMLEN EQU   TVCTLFLD                                                 10624000
TVCFLAGS EQU   TVCOMLEN                                                 10625000
TVTRKPTR EQU   TVCTLFLD+4                                               10626000
TVENTRY  EQU   0                                                        10627000
TVLZYX1  EQU   TVENTRY                                                  10628000
TVLZYX2  EQU   TVENTRY+2                                                10629000
TVCSN    EQU   TVENTRY+4                                                10630000
TVVOLID  EQU   TVENTRY+16                                               10631000
TVVFLAGS EQU   TVENTRY+22                                               10632000
CIENTRY  EQU   0                                                        10633000
CICSCNCT EQU   CIENTRY                                                  10634000
CISACHNL EQU   CIENTRY+2                                                10635000
@NM00086 EQU   0                                                        10636000
CICPUID  EQU   @NM00086                                                 10637000
CICUCHL  EQU   @NM00086+1                                               10638000
MICTABLE EQU   0                                                        10639000
@NM00088 EQU   MICTABLE                                                 10640000
MICFLAG1 EQU   @NM00088+6                                               10641000
MICFLAG2 EQU   @NM00088+7                                               10642000
CDBLOCK  EQU   0                                                        10643000
@NM00092 EQU   CDBLOCK                                                  10644000
CDBSDG   EQU   @NM00092                                                 10645000
CDBCNFIG EQU   CDBSDG                                                   10646000
CDBINUSE EQU   CDBCNFIG                                                 10647000
CDB3333  EQU   CDBCNFIG                                                 10648000
CDBPATHS EQU   @NM00092+1                                               10649000
CDBMVTP  EQU   @NM00092+2                                               10650000
CMCTLBLK EQU   0                                                        10651000
CMCPTRS  EQU   CMCTLBLK+22                                              10652000
CMENTRY  EQU   0                                                        10653000
IVAD     EQU   0                                                        10654000
IVADVVA  EQU   IVAD                                                     10655000
IVADFLG  EQU   IVAD+1                                                   10656000
IVVIT    EQU   0                                                        10657000
IVVI1    EQU   IVVIT                                                    10658000
IVVIWI   EQU   IVVI1                                                    10659000
IVVISHR  EQU   IVVI1                                                    10660000
IVVI2    EQU   IVVIT+1                                                  10661000
IVVIRSVD EQU   IVVI2                                                    10662000
IPST     EQU   0                                                        10663000
IPSTVVA  EQU   IPST                                                     10664000
IPSTVP   EQU   IPST+1                                                   10665000
ILTR     EQU   0                                                        10666000
ILTRRUA  EQU   ILTR                                                     10667000
CCHHRTBL EQU   0                                                        10668000
TBLCCHHR EQU   CCHHRTBL+2                                               10669000
MVTDBCHR EQU   CCHHRTBL+62                                              10670000
ENTRYARG EQU   0                                                        10671000
RDOPTION EQU   ENTRYARG                                                 10672000
GETNEXT  EQU   RDOPTION                                                 10673000
BUFFER2  EQU   RDOPTION                                                 10674000
TABLEID  EQU   ENTRYARG+1                                               10675000
TBLFLAGS EQU   ENTRYARG+2                                               10676000
TBLPARTS EQU   ENTRYARG+3                                               10677000
RPMFLAG  EQU   TBLPARTS                                                 10678000
PABFLAG  EQU   TBLPARTS                                                 10679000
DVBFLAG  EQU   TBLPARTS                                                 10680000
LPBFLAG  EQU   TBLPARTS                                                 10681000
CIFLAG   EQU   TBLPARTS                                                 10682000
CDBFLAG  EQU   TBLPARTS                                                 10683000
ENTRYID  EQU   ENTRYARG+4                                               10684000
TBLADDR  EQU   ENTRYID                                                  10685000
PREVCHR  EQU   ENTRYID+4                                                10686000
SANUM    EQU   ENTRYARG+16                                              10687000
SDGNUM   EQU   ENTRYARG+18                                              10688000
INTFID   EQU   ENTRYARG+20                                              10689000
VVADDR   EQU   ENTRYARG+22                                              10690000
DEVICEID EQU   ENTRYARG+24                                              10691000
CELLBLK  EQU   ENTRYARG+26                                              10692000
MSFID    EQU   ENTRYARG+28                                              10693000
VOLID    EQU   ENTRYARG+30                                              10694000
BYTE#    EQU   ENTRYARG+48                                              10695000
BIT#     EQU   ENTRYARG+50                                              10696000
GETRC    EQU   ENTRYARG+52                                              10697000
MSGARG   EQU   0                                                        10698000
MSGTYPE  EQU   MSGARG                                                   10699000
INCNMSG  EQU   MSGTYPE                                                  10700000
DUPLMSG  EQU   MSGTYPE                                                  10701000
SUMSMSG  EQU   MSGTYPE                                                  10702000
MTCHMSG  EQU   MSGTYPE                                                  10703000
MSGNRSET EQU   MSGTYPE+3                                                10704000
TBLTYPE  EQU   MSGARG+4                                                 10705000
MVTTBL   EQU   TBLTYPE                                                  10706000
VITBL    EQU   TBLTYPE                                                  10707000
TVLTBL   EQU   TBLTYPE                                                  10708000
SCLTBL   EQU   TBLTYPE                                                  10709000
MSVITBL  EQU   TBLTYPE                                                  10710000
CMTBL    EQU   TBLTYPE                                                  10711000
VADTBL   EQU   TBLTYPE                                                  10712000
PSTTBL   EQU   TBLTYPE+1                                                10713000
LTRTBL   EQU   TBLTYPE+1                                                10714000
VVITTBL  EQU   TBLTYPE+1                                                10715000
PABTBL   EQU   TBLTYPE+1                                                10716000
DVBTBL   EQU   TBLTYPE+1                                                10717000
LPBTBL   EQU   TBLTYPE+1                                                10718000
RPMTBL   EQU   TBLTYPE+1                                                10719000
VMXTBL   EQU   TBLTYPE+1                                                10720000
VVATTBL  EQU   TBLTYPE+2                                                10721000
CITBL    EQU   TBLTYPE+2                                                10722000
CDBTBL   EQU   TBLTYPE+2                                                10723000
METBL    EQU   TBLTYPE+2                                                10724000
CBMTBL   EQU   TBLTYPE+2                                                10725000
VTSTBL   EQU   TBLTYPE+2                                                10726000
TBLNRSET EQU   TBLTYPE+3                                                10727000
FLDTYPE1 EQU   MSGARG+12                                                10728000
VSSFLD   EQU   FLDTYPE1                                                 10729000
VESFLD   EQU   FLDTYPE1                                                 10730000
VBSFLD   EQU   FLDTYPE1                                                 10731000
VRSFLD   EQU   FLDTYPE1                                                 10732000
WISFLD   EQU   FLDTYPE1                                                 10733000
MSFFLD   EQU   FLDTYPE1                                                 10734000
VSNFLD   EQU   FLDTYPE1                                                 10735000
VVAFLD   EQU   FLDTYPE1+1                                               10736000
VPFLD    EQU   FLDTYPE1+1                                               10737000
RUAFLD   EQU   FLDTYPE1+1                                               10738000
SAFLD    EQU   FLDTYPE1+1                                               10739000
FPASFLD  EQU   FLDTYPE1+1                                               10740000
FPCFLD   EQU   FLDTYPE1+1                                               10741000
APCFLD   EQU   FLDTYPE1+1                                               10742000
IPCFLD   EQU   FLDTYPE1+2                                               10743000
BPCFLD   EQU   FLDTYPE1+2                                               10744000
MVTPFLD  EQU   FLDTYPE1+2                                               10745000
CAFLD    EQU   FLDTYPE1+2                                               10746000
COSFLD   EQU   FLDTYPE1+2                                               10747000
CPUFLD   EQU   FLDTYPE1+2                                               10748000
SDGFLD   EQU   FLDTYPE1+2                                               10749000
L3AFLD   EQU   FLDTYPE1+2                                               10750000
CSNFLD   EQU   FLDTYPE1+3                                               10751000
LRUDFLD  EQU   FLDTYPE1+3                                               10752000
MVFLD    EQU   FLDTYPE1+3                                               10753000
VUAFLD   EQU   FLDTYPE1+3                                               10754000
BPASFLD  EQU   FLDTYPE1+3                                               10755000
DVSFLD   EQU   FLDTYPE1+3                                               10756000
DOSFLD   EQU   FLDTYPE1+3                                               10757000
IUSFLD   EQU   FLDTYPE1+3                                               10758000
FLDTYPE2 EQU   MSGARG+16                                                10759000
APSFLD   EQU   FLDTYPE2                                                 10760000
VSHSFLD  EQU   FLDTYPE2                                                 10761000
RPFLD    EQU   FLDTYPE2                                                 10762000
APASFLD  EQU   FLDTYPE2                                                 10763000
IPASFLD  EQU   FLDTYPE2                                                 10764000
FPFLD    EQU   FLDTYPE2                                                 10765000
APFLD    EQU   FLDTYPE2                                                 10766000
IPFLD    EQU   FLDTYPE2                                                 10767000
BPFLD    EQU   FLDTYPE2+1                                               10768000
TBLINDEX EQU   MSGARG+20                                                10769000
KEYINDEX EQU   TBLINDEX                                                 10770000
CSNINDEX EQU   KEYINDEX                                                 10771000
XYZINDEX EQU   CSNINDEX                                                 10772000
SAINDEX  EQU   CSNINDEX+3                                               10773000
INFINDEX EQU   CSNINDEX+4                                               10774000
VUAINDEX EQU   CSNINDEX+5                                               10775000
VVAINDEX EQU   CSNINDEX+6                                               10776000
LUAINDEX EQU   CSNINDEX+7                                               10777000
RPINDEX  EQU   CSNINDEX+8                                               10778000
SDGINDEX EQU   CSNINDEX+9                                               10779000
MSFINDEX EQU   KEYINDEX+12                                              10780000
VSNINDEX EQU   TBLINDEX+13                                              10781000
CHRINDEX EQU   TBLINDEX+19                                              10782000
FLDVALUE EQU   MSGARG+68                                                10783000
FLDCHAR  EQU   FLDVALUE                                                 10784000
FLDNUM   EQU   FLDCHAR                                                  10785000
VICHKFF  EQU   0                                                        10786000
TVLCHKFF EQU   0                                                        10787000
MVTCHKFF EQU   0                                                        10788000
CDBCOT   EQU   0                                                        10789000
CDBCHKFF EQU   0                                                        10790000
VVACOT   EQU   0                                                        10791000
VVACHKFF EQU   0                                                        10792000
VMXCOT   EQU   0                                                        10793000
VMXCHKFF EQU   0                                                        10794000
RPMCOT   EQU   0                                                        10795000
RPMCHKFF EQU   0                                                        10796000
DVBCOT   EQU   0                                                        10797000
DVBCHKFF EQU   0                                                        10798000
LPBCOT   EQU   0                                                        10799000
LPBCHKFF EQU   0                                                        10800000
VVICOT   EQU   0                                                        10801000
VVICHKFF EQU   VVICOT                                                   10802000
VADCOT   EQU   0                                                        10803000
VADCHKFF EQU   VADCOT                                                   10804000
PSTCOT   EQU   0                                                        10805000
PSTCHKFF EQU   PSTCOT                                                   10806000
MOVEAREA EQU   0                                                        10807000
CMBLOCK  EQU   0                                                        10808000
CMCOBLK  EQU   0                                                        10809000
CMCOENT  EQU   0                                                        10810000
AMSTP011 EQU   0                                                        10811000
AMSTP041 EQU   0                                                        10812000
AMSTP042 EQU   0                                                        10813000
AMSTP043 EQU   0                                                        10814000
AMSTP044 EQU   0                                                        10815000
DMPTRM   EQU   0                                                        10816000
IDCIOCL0 EQU   0                                                        10817000
IDCIOCO0 EQU   0                                                        10818000
IDCIOGT0 EQU   0                                                        10819000
IDCIOIT0 EQU   0                                                        10820000
IDCIOOP0 EQU   0                                                        10821000
IDCIOPO0 EQU   0                                                        10822000
IDCIOPT0 EQU   0                                                        10823000
IDCIOSI0 EQU   0                                                        10824000
IDCIOST0 EQU   0                                                        10825000
IDCIOTM0 EQU   0                                                        10826000
IDCIOVY0 EQU   0                                                        10827000
IDCIO050 EQU   0                                                        10828000
IDCSAAL0 EQU   0                                                        10829000
IDCSACA0 EQU   0                                                        10830000
IDCSACL0 EQU   0                                                        10831000
IDCSACR0 EQU   0                                                        10832000
IDCSADE0 EQU   0                                                        10833000
IDCSADL0 EQU   0                                                        10834000
IDCSADQ0 EQU   0                                                        10835000
IDCSAFP0 EQU   0                                                        10836000
IDCSAFS0 EQU   0                                                        10837000
IDCSAGP0 EQU   0                                                        10838000
IDCSAGS0 EQU   0                                                        10839000
IDCSAID0 EQU   0                                                        10840000
IDCSALC0 EQU   0                                                        10841000
IDCSALD0 EQU   0                                                        10842000
IDCSALK0 EQU   0                                                        10843000
IDCSANQ0 EQU   0                                                        10844000
IDCSAPR0 EQU   0                                                        10845000
IDCSAPT0 EQU   0                                                        10846000
IDCSAQL0 EQU   0                                                        10847000
IDCSARC0 EQU   0                                                        10848000
IDCSARV0 EQU   0                                                        10849000
IDCSASC0 EQU   0                                                        10850000
IDCSASI0 EQU   0                                                        10851000
IDCSASN0 EQU   0                                                        10852000
IDCSASS0 EQU   0                                                        10853000
IDCSAST0 EQU   0                                                        10854000
IDCSATI0 EQU   0                                                        10855000
IDCSAUC0 EQU   0                                                        10856000
IDCSAWO0 EQU   0                                                        10857000
IDCSA060 EQU   0                                                        10858000
IDCST010 EQU   0                                                        10859000
IDCTPER0 EQU   0                                                        10860000
LISTTEST EQU   0                                                        10861000
NEWERID1 EQU   5                                                        10862000
GDTTBL   EQU   0                                                        10863000
GDTTR1   EQU   GDTTBL+8                                                 10864000
GDTTR2   EQU   GDTTBL+12                                                10865000
GDTDBG   EQU   GDTTBL+40                                                10866000
GDTSTC   EQU   GDTTBL+44                                                10867000
GDTPRT   EQU   GDTTBL+48                                                10868000
GDTESS   EQU   GDTTBL+52                                                10869000
GDTESA   EQU   GDTTBL+56                                                10870000
GDTRST   EQU   GDTTBL+60                                                10871000
GDTRES   EQU   GDTTBL+64                                                10872000
GDTCAL   EQU   GDTTBL+68                                                10873000
GDTGSP   EQU   GDTTBL+72                                                10874000
GDTFSP   EQU   GDTTBL+76                                                10875000
GDTGPL   EQU   GDTTBL+80                                                10876000
GDTFPL   EQU   GDTTBL+84                                                10877000
GDTLOD   EQU   GDTTBL+88                                                10878000
GDTDEL   EQU   GDTTBL+92                                                10879000
GDTPRL   EQU   GDTTBL+96                                                10880000
GDTEPL   EQU   GDTTBL+100                                               10881000
GDTTIM   EQU   GDTTBL+104                                               10882000
GDTIIO   EQU   GDTTBL+108                                               10883000
GDTTIO   EQU   GDTTBL+112                                               10884000
GDTOPN   EQU   GDTTBL+124                                               10885000
GDTCLS   EQU   GDTTBL+128                                               10886000
GDTGET   EQU   GDTTBL+132                                               10887000
GDTPUT   EQU   GDTTBL+136                                               10888000
GDTPOS   EQU   GDTTBL+140                                               10889000
GDTCPY   EQU   GDTTBL+144                                               10890000
GDTCAT   EQU   GDTTBL+148                                               10891000
GDTSNP   EQU   GDTTBL+164                                               10892000
GDTVFY   EQU   GDTTBL+172                                               10893000
GDTUID   EQU   GDTTBL+192                                               10894000
GDTPMT   EQU   GDTTBL+196                                               10895000
GDTCIR   EQU   GDTTBL+200                                               10896000
GDTLNK   EQU   GDTTBL+204                                               10897000
GDTALC   EQU   GDTTBL+208                                               10898000
GDTDLC   EQU   GDTTBL+212                                               10899000
GDTQAL   EQU   GDTTBL+216                                               10900000
GDTSTW   EQU   GDTTBL+220                                               10901000
GDTSSC   EQU   GDTTBL+224                                               10902000
GDTENQ   EQU   GDTTBL+228                                               10903000
GDTRSV   EQU   GDTTBL+232                                               10904000
GDTDEQ   EQU   GDTTBL+236                                               10905000
GDTSFO   EQU   GDTTBL+240                                               10906000
GDTWTO   EQU   GDTTBL+244                                               10907000
GDTSCR   EQU   GDTTBL+248                                               10908000
GDTUNT   EQU   GDTTBL+252                                               10909000
GDTRCT   EQU   GDTTBL+256                                               10910000
GDTIFO   EQU   GDTTBL+260                                               10911000
GDTEXP   EQU   GDTTBL+264                                               10912000
GDTSTA   EQU   GDTTBL+268                                               10913000
GDTERR   EQU   GDTTBL+272                                               10914000
GDTUNC   EQU   GDTTBL+276                                               10915000
GDTLOC   EQU   GDTTBL+280                                               10916000
CDALIST  EQU   0                                                        10917000
IVADPTR  EQU   CDALIST                                                  10918000
IVVITPTR EQU   CDALIST+64                                               10919000
IPSTPTR  EQU   CDALIST+128                                              10920000
ILTRPTR  EQU   CDALIST+192                                              10921000
IMERPTR  EQU   CDALIST+256                                              10922000
CCHHRPTR EQU   CDALIST+260                                              10923000
EARGPTR  EQU   CDALIST+264                                              10924000
MARGPTR  EQU   CDALIST+268                                              10925000
VICOPTR  EQU   CDALIST+272                                              10926000
TVLCOPTR EQU   CDALIST+276                                              10927000
MVTCOPTR EQU   CDALIST+280                                              10928000
CMCOPTR  EQU   CDALIST+284                                              10929000
CDBCOPTR EQU   CDALIST+348                                              10930000
VVACOPTR EQU   CDALIST+352                                              10931000
VMXCOPTR EQU   CDALIST+356                                              10932000
RPMCOPTR EQU   CDALIST+360                                              10933000
DVBCOPTR EQU   CDALIST+364                                              10934000
LPBCOPTR EQU   CDALIST+368                                              10935000
VVICOPTR EQU   CDALIST+372                                              10936000
VADCOPTR EQU   CDALIST+436                                              10937000
PSTCOPTR EQU   CDALIST+500                                              10938000
VVATADDR EQU   CDALIST+564                                              10939000
CBMADDR  EQU   CDALIST+568                                              10940000
CIADDR   EQU   CDALIST+572                                              10941000
CMBUFPTR EQU   CDALIST+580                                              10942000
VLDSSID  EQU   CDALIST+738                                              10943000
MSFVLCNT EQU   CDALIST+770                                              10944000
VLDMSFID EQU   CDALIST+772                                              10945000
@NM00109 EQU   CDALIST+780                                              10946000
MSCCHK   EQU   @NM00109                                                 10947000
SACHK    EQU   @NM00109                                                 10948000
MSVICHK  EQU   @NM00109                                                 10949000
LASTCOND EQU   0                                                        10950000
*                                      START UNREFERENCED COMPONENTS    10951000
@NM00110 EQU   @NM00109                                                 10952000
VLDSAID  EQU   CDALIST+706                                              10953000
SAVLDCNT EQU   CDALIST+704                                              10954000
BDATAPTR EQU   CDALIST+700                                              10955000
FMTAPTR  EQU   CDALIST+696                                              10956000
TEXTAPTR EQU   CDALIST+692                                              10957000
MSGAPTR  EQU   CDALIST+688                                              10958000
MSVIAPTR EQU   CDALIST+684                                              10959000
RVVIPTR  EQU   CDALIST+680                                              10960000
CHRADDR2 EQU   CDALIST+676                                              10961000
CHRADDR1 EQU   CDALIST+672                                              10962000
WCSBFPTR EQU   CDALIST+668                                              10963000
EXARGPTR EQU   CDALIST+664                                              10964000
RWCSPTR  EQU   CDALIST+660                                              10965000
MVCBADDR EQU   CDALIST+576                                              10966000
GDTECT   EQU   GDTTBL+188                                               10967000
GDTPSB   EQU   GDTTBL+184                                               10968000
GDTUPT   EQU   GDTTBL+180                                               10969000
GDTCMB   EQU   GDTTBL+176                                               10970000
GDTSPR   EQU   GDTTBL+168                                               10971000
@NM00001 EQU   GDTTBL+160                                               10972000
GDTABH   EQU   GDTTBL+156                                               10973000
GDTABT   EQU   GDTTBL+152                                               10974000
GDTTOH   EQU   GDTTBL+120                                               10975000
GDTRIP   EQU   GDTTBL+116                                               10976000
GDTIOH   EQU   GDTTBL+36                                                10977000
GDTSAH   EQU   GDTTBL+32                                                10978000
GDTTPH   EQU   GDTTBL+28                                                10979000
GDTRIH   EQU   GDTTBL+24                                                10980000
GDTSTH   EQU   GDTTBL+20                                                10981000
GDTDBH   EQU   GDTTBL+16                                                10982000
GDTPRM   EQU   GDTTBL+4                                                 10983000
GDTHDR   EQU   GDTTBL                                                   10984000
@NM00108 EQU   CSNINDEX+11                                              10985000
@NM00107 EQU   CSNINDEX+10                                              10986000
CPUINDEX EQU   CSNINDEX+2                                               10987000
@NM00106 EQU   FLDTYPE2+1                                               10988000
MIFLD    EQU   FLDTYPE1+1                                               10989000
VMSFLD   EQU   FLDTYPE1                                                 10990000
@NM00105 EQU   TBLTYPE+2                                                10991000
MICTTBL  EQU   TBLTYPE                                                  10992000
@NM00104 EQU   MSGTYPE                                                  10993000
SEQ1CSN  EQU   ENTRYARG+36                                              10994000
RECNUM   EQU   ENTRYID+10                                               10995000
ENTNUM   EQU   ENTRYID+9                                                10996000
RECREC   EQU   PREVCHR+4                                                10997000
RECHEAD  EQU   PREVCHR+2                                                10998000
RECCYL   EQU   PREVCHR                                                  10999000
@NM00103 EQU   TBLPARTS                                                 11000000
MICTFLAG EQU   TBLPARTS                                                 11001000
@NM00102 EQU   TBLFLAGS                                                 11002000
TCHRFLAG EQU   TBLFLAGS                                                 11003000
CBMFLAG  EQU   TBLFLAGS                                                 11004000
MEFLAG   EQU   TBLFLAGS                                                 11005000
@NM00101 EQU   RDOPTION                                                 11006000
MVTDBR   EQU   MVTDBCHR+4                                               11007000
MVTDBHH  EQU   MVTDBCHR+2                                               11008000
MVTDBCC  EQU   MVTDBCHR                                                 11009000
@NM00100 EQU   TBLCCHHR+5                                               11010000
TBLR     EQU   TBLCCHHR+4                                               11011000
TBLHH    EQU   TBLCCHHR+2                                               11012000
TBLCC    EQU   TBLCCHHR                                                 11013000
CCOFFSET EQU   CCHHRTBL                                                 11014000
ILTRM11  EQU   ILTRRUA                                                  11015000
@NM00099 EQU   IVVI2                                                    11016000
IVVIINTF EQU   IVVI2                                                    11017000
@NM00098 EQU   IVVI2                                                    11018000
IVVI1STR EQU   IVVI1                                                    11019000
@NM00097 EQU   IVVI1                                                    11020000
@NM00096 EQU   IVADFLG                                                  11021000
IVADWI   EQU   IVADFLG                                                  11022000
@NM00095 EQU   IVADFLG                                                  11023000
CMX3Z1   EQU   CMENTRY                                                  11024000
CMX3Z0   EQU   CMENTRY                                                  11025000
CMX2Z1   EQU   CMENTRY                                                  11026000
CMX2Z0   EQU   CMENTRY                                                  11027000
CMX1Z1   EQU   CMENTRY                                                  11028000
CMX1Z0   EQU   CMENTRY                                                  11029000
CMX0Z1   EQU   CMENTRY                                                  11030000
CMX0Z0   EQU   CMENTRY                                                  11031000
CMCFLAGS EQU   CMCTLBLK                                                 11032000
CDBSA2D  EQU   CDBPATHS                                                 11033000
CDBSA2C  EQU   CDBPATHS                                                 11034000
CDBSA2B  EQU   CDBPATHS                                                 11035000
@NM00094 EQU   CDBPATHS                                                 11036000
CDBSA1D  EQU   CDBPATHS                                                 11037000
CDBSA1C  EQU   CDBPATHS                                                 11038000
CDBSA1B  EQU   CDBPATHS                                                 11039000
@NM00093 EQU   CDBPATHS                                                 11040000
CDBNOSHR EQU   CDBCNFIG                                                 11041000
MICAINTF EQU   MICFLAG2                                                 11042000
@NM00091 EQU   MICFLAG2                                                 11043000
MICCMB   EQU   MICFLAG2                                                 11044000
MICCURMP EQU   MICFLAG2                                                 11045000
MICVALID EQU   MICFLAG2                                                 11046000
MICINTF  EQU   MICFLAG1                                                 11047000
@NM00090 EQU   MICFLAG1                                                 11048000
MICAPATH EQU   MICFLAG1                                                 11049000
MICPOTMP EQU   MICFLAG1                                                 11050000
@NM00089 EQU   MICFLAG1                                                 11051000
MICMPCPU EQU   @NM00088+5                                               11052000
MICMFID  EQU   @NM00088                                                 11053000
CICHL    EQU   CICUCHL                                                  11054000
@NM00087 EQU   CICUCHL                                                  11055000
CICU     EQU   CICUCHL                                                  11056000
@NM00085 EQU   CIENTRY+1                                                11057000
CIMSF3   EQU   CICSCNCT                                                 11058000
CIMSF2   EQU   CICSCNCT                                                 11059000
CIMSF1   EQU   CICSCNCT                                                 11060000
CIMSF0   EQU   CICSCNCT                                                 11061000
@NM00084 EQU   CICSCNCT                                                 11062000
CIMSF    EQU   CICSCNCT                                                 11063000
@NM00083 EQU   TVENTRY+23                                               11064000
@NM00082 EQU   TVVFLAGS                                                 11065000
TVWRTINH EQU   TVVFLAGS                                                 11066000
TVBNDVOL EQU   TVVFLAGS                                                 11067000
TVSCRCTG EQU   TVVFLAGS                                                 11068000
TVEXCVOL EQU   TVVFLAGS                                                 11069000
TVSECVOL EQU   TVVFLAGS                                                 11070000
@NM00081 EQU   TVVFLAGS                                                 11071000
TVCECTG  EQU   TVVFLAGS                                                 11072000
TVREC    EQU   TVTRKPTR+3                                               11073000
TVHEAD   EQU   TVTRKPTR+2                                               11074000
TVCYL    EQU   TVTRKPTR+1                                               11075000
@NM00080 EQU   TVTRKPTR                                                 11076000
TVENTNUM EQU   TVCTLFLD+3                                               11077000
TVENTMAX EQU   TVCTLFLD+2                                               11078000
TVENTLEN EQU   TVCTLFLD+1                                               11079000
TVLSTTRK EQU   TVCFLAGS                                                 11080000
TVENDTRK EQU   TVCFLAGS                                                 11081000
TVLSTACT EQU   TVCFLAGS                                                 11082000
TVLSTBLK EQU   TVCFLAGS                                                 11083000
@NM00079 EQU   VIENTRY+7                                                11084000
@NM00078 EQU   VIVFLAGS                                                 11085000
VISCRCTG EQU   VIVFLAGS                                                 11086000
@NM00077 EQU   VIVFLAGS                                                 11087000
VICECTG  EQU   VIVFLAGS                                                 11088000
VIREC    EQU   VITRKPTR+3                                               11089000
VIHEAD   EQU   VITRKPTR+2                                               11090000
VICYL    EQU   VITRKPTR+1                                               11091000
@NM00076 EQU   VITRKPTR                                                 11092000
VIENTNUM EQU   VICTLFLD+3                                               11093000
VIENTMAX EQU   VICTLFLD+2                                               11094000
VIENTLEN EQU   VICTLFLD+1                                               11095000
VIOFBLK  EQU   VICFLAGS                                                 11096000
VIAREA   EQU   VICFLAGS                                                 11097000
VIUSEBLK EQU   VICFLAGS                                                 11098000
VILSTTRK EQU   VICFLAGS                                                 11099000
VIENDTRK EQU   VICFLAGS                                                 11100000
VILSTACT EQU   VICFLAGS                                                 11101000
VILSTBLK EQU   VICFLAGS                                                 11102000
@NM00075 EQU   SCENTRY+18                                               11103000
@NM00074 EQU   SCENTRY                                                  11104000
SCREC    EQU   SCTRKPTR+3                                               11105000
SCHEAD   EQU   SCTRKPTR+2                                               11106000
SCCYL    EQU   SCTRKPTR+1                                               11107000
@NM00073 EQU   SCTRKPTR                                                 11108000
SCENTNUM EQU   SCCTLFLD+3                                               11109000
SCENTMAX EQU   SCCTLFLD+2                                               11110000
SCENTLEN EQU   SCCTLFLD+1                                               11111000
SCLSTTRK EQU   SCCFLAGS                                                 11112000
SCENDTRK EQU   SCCFLAGS                                                 11113000
SCLSTACT EQU   SCCFLAGS                                                 11114000
SCLSTBLK EQU   SCCFLAGS                                                 11115000
MVVUAI#  EQU   MVVUA                                                    11116000
@NM00072 EQU   MVLOGDEV                                                 11117000
MVDSTGC2 EQU   MVLOGDEV                                                 11118000
MVDSTGC1 EQU   MVLOGDEV                                                 11119000
@NM00070 EQU   MVENTRY+44                                               11120000
MVPFI    EQU   MVENTRY+36                                               11121000
@NM00068 EQU   MVENTRY+18                                               11122000
@NM00067 EQU   MVVAMSG                                                  11123000
MVINTFD  EQU   MVVAMSG                                                  11124000
MVINTFC  EQU   MVVAMSG                                                  11125000
MVINTFB  EQU   MVVAMSG                                                  11126000
MVINTFA  EQU   MVVAMSG                                                  11127000
@NM00066 EQU   MVRESRVE                                                 11128000
@NM00065 EQU   MVRESRVE                                                 11129000
@NM00064 EQU   MVMFLAGS                                                 11130000
MVMNTBND EQU   MVMFLAGS                                                 11131000
MVMNTEXC EQU   MVMFLAGS                                                 11132000
@NM00063 EQU   MVENTRY+7                                                11133000
@NM00062 EQU   MVVFLAGS                                                 11134000
MVSCRCTG EQU   MVVFLAGS                                                 11135000
@NM00061 EQU   MVVFLAGS                                                 11136000
MVCECTG  EQU   MVVFLAGS                                                 11137000
MVMVTPTR EQU   @NM00060+6                                               11138000
MVIVOLID EQU   @NM00060                                                 11139000
@NM00059 EQU   MVIDXBLK+4                                               11140000
MVENTNUM EQU   MVIDXBLK+3                                               11141000
MVENTMAX EQU   MVIDXBLK+2                                               11142000
MVENTLEN EQU   MVIDXBLK+1                                               11143000
@NM00058 EQU   MVIFLAGS                                                 11144000
MVLSTBLK EQU   MVIFLAGS                                                 11145000
MVOFBLK  EQU   MVIFLAGS                                                 11146000
MVOFOUT  EQU   MVIFLAGS                                                 11147000
MVCTLBIT EQU   MVCTLBLK                                                 11148000
MEUCBCNT EQU   @NM00057+2                                               11149000
MEDRVCNT EQU   @NM00057+1                                               11150000
MELRUCNT EQU   @NM00057                                                 11151000
@NM00056 EQU   MERECORD+120                                             11152000
MEVOCNT  EQU   @NM00055+1                                               11153000
MEMVD2   EQU   MEFLAGS                                                  11154000
MEMVI2   EQU   MEFLAGS                                                  11155000
MEMVD1   EQU   MEFLAGS                                                  11156000
MEMVI1   EQU   MEFLAGS                                                  11157000
MEVOD2   EQU   MEFLAGS                                                  11158000
MEVOI2   EQU   MEFLAGS                                                  11159000
MEVOD1   EQU   MEFLAGS                                                  11160000
MEVOI1   EQU   MEFLAGS                                                  11161000
CBMMSF   EQU   CBMAP+39                                                 11162000
CBMFLAGS EQU   CBMAP+38                                                 11163000
CBMDRC   EQU   CBMAP+6                                                  11164000
CBMSA    EQU   CBMAP+4                                                  11165000
CBMDRD   EQU   CBMAP                                                    11166000
@NM00054 EQU   VMX+1                                                    11167000
@NM00053 EQU   VMXFLAGS                                                 11168000
LPBPFI   EQU   LPBMVT                                                   11169000
LPBMSFID EQU   LPBMVT                                                   11170000
@NM00052 EQU   LPB+2                                                    11171000
LPBCURR  EQU   LPB+1                                                    11172000
DVBPFI   EQU   DVBMVT                                                   11173000
DVBMSFID EQU   DVBMVT                                                   11174000
@NM00051 EQU   DVB+2                                                    11175000
DVBCURR  EQU   DVB+1                                                    11176000
PABORUAV EQU   PABORUA                                                  11177000
PABSA2D  EQU   PABRINTF                                                 11178000
PABSA2C  EQU   PABRINTF                                                 11179000
PABSA2B  EQU   PABRINTF                                                 11180000
@NM00050 EQU   PABRINTF                                                 11181000
PABSA1D  EQU   PABRINTF                                                 11182000
PABSA1C  EQU   PABRINTF                                                 11183000
PABSA1B  EQU   PABRINTF                                                 11184000
PABRAI   EQU   PABRINTF                                                 11185000
PABMSCT  EQU   PABFLAGS                                                 11186000
PABMOD11 EQU   PABFLAGS                                                 11187000
@NM00047 EQU   PAB+24                                                   11188000
PABSRZ   EQU   PAB+23                                                   11189000
PABSRY   EQU   PAB+22                                                   11190000
PABSRX   EQU   PAB+21                                                   11191000
PABSRW   EQU   PAB+20                                                   11192000
@NM00046 EQU   PAB+18                                                   11193000
@NM00045 EQU   PABSA                                                    11194000
@NM00044 EQU   PAB+12                                                   11195000
PABPPD   EQU   PAB+8                                                    11196000
@NM00043 EQU   RPMFLAGS                                                 11197000
VTVOLPFX EQU   VTABLER1+252                                             11198000
@NM00042 EQU   VTRVPAGE+4                                               11199000
VT20TO27 EQU   VTRVPAGE+3                                               11200000
VT18TO1F EQU   VTRVPAGE+2                                               11201000
VT10TO17 EQU   VTRVPAGE+1                                               11202000
VT08TO0F EQU   VTRVPAGE                                                 11203000
VTLRUIOS EQU   VTLRUCW+2                                                11204000
VTLRUTIM EQU   VTLRUCW+1                                                11205000
VTLRUCLK EQU   VTLRUCW                                                  11206000
VTTRCR   EQU   VTTRCCHR+3                                               11207000
VTTRCH   EQU   VTTRCCHR+2                                               11208000
VTTRCC   EQU   VTTRCCHR+1                                               11209000
VTXY     EQU   VTTRCCHR                                                 11210000
@NM00041 EQU   VTABLER1+160                                             11211000
VTSADDR  EQU   VTUCB+6                                                  11212000
VTPADDR  EQU   VTUCB+4                                                  11213000
VTPOST   EQU   VTUCB+3                                                  11214000
VTACTIVE EQU   VTUCB+2                                                  11215000
VTWORK   EQU   VTUCB+1                                                  11216000
VTSBUSY  EQU   VTFLAGS                                                  11217000
VTSREADY EQU   VTFLAGS                                                  11218000
VTSONLIN EQU   VTFLAGS                                                  11219000
VTSVALID EQU   VTFLAGS                                                  11220000
VTPBUSY  EQU   VTFLAGS                                                  11221000
VTPREADY EQU   VTFLAGS                                                  11222000
VTPONLIN EQU   VTFLAGS                                                  11223000
VTPVALID EQU   VTFLAGS                                                  11224000
VTLRU1   EQU   VTSDGID+3                                                11225000
VTLRU0   EQU   VTSDGID+2                                                11226000
VTL33331 EQU   VTSDGID+1                                                11227000
VTL33330 EQU   VTSDGID                                                  11228000
VTTBLR   EQU   VTTBLCHR+3                                               11229000
VTTBLH   EQU   VTTBLCHR+2                                               11230000
VTTBLC   EQU   VTTBLCHR+1                                               11231000
@NM00040 EQU   VTTBLCHR                                                 11232000
@NM00039 EQU   @NM00038+2                                               11233000
VTIMPLS  EQU   @NM00038                                                 11234000
VTPACKID EQU   VTABLER1                                                 11235000
LTRMOD11 EQU   LTRRUA                                                   11236000
PSTCYLW  EQU   PST+3                                                    11237000
PSTCYLV  EQU   PST+2                                                    11238000
PSTVPNUM EQU   PST+1                                                    11239000
PSTVVA   EQU   PST                                                      11240000
VVITPCDD EQU   VVITBYT2                                                 11241000
VVITPCDC EQU   VVITBYT2                                                 11242000
VVITPCDB EQU   VVITBYT2                                                 11243000
VVITRSVD EQU   VVITBYT2                                                 11244000
VVITINTF EQU   VVITBYT2                                                 11245000
VVITVVB  EQU   VVITBYT2                                                 11246000
VVITCC   EQU   VVITBYT2                                                 11247000
VVITVVS  EQU   VVITBYT1                                                 11248000
VVITVVWI EQU   VVITBYT1                                                 11249000
VVITFR   EQU   VVITBYT1                                                 11250000
VVITNBM  EQU   VVITBYT1                                                 11251000
VVITDEDD EQU   VVITBYT1                                                 11252000
VVITDEDC EQU   VVITBYT1                                                 11253000
VVITDEDB EQU   VVITBYT1                                                 11254000
VVITDEDA EQU   VVITBYT1                                                 11255000
VADRM    EQU   VADFLAGS                                                 11256000
VADVSI   EQU   VADFLAGS                                                 11257000
VADRDED  EQU   VADFLAGS                                                 11258000
VADRB    EQU   VADFLAGS                                                 11259000
VADRR    EQU   VADFLAGS                                                 11260000
VADVWI   EQU   VADFLAGS                                                 11261000
VADVWG   EQU   VADFLAGS                                                 11262000
VADVRW   EQU   VADFLAGS                                                 11263000
VADPOH   EQU   VADWORD2+2                                               11264000
VADUDE   EQU   VADLUA                                                   11265000
VADMOD11 EQU   VADRPNUM                                                 11266000
VADLINK  EQU   VADWORD1+3                                               11267000
VADUCS   EQU   VADRUA                                                   11268000
VADCCR   EQU   VADRUA                                                   11269000
VADEDI   EQU   VADRUA                                                   11270000
VADVVA   EQU   VADWORD1+1                                               11271000
VADVFM   EQU   VADWORD1                                                 11272000
@NM00037 EQU   DMPARY+15                                                11273000
DMPARYTP EQU   DMPARY+14                                                11274000
DMPARYEX EQU   DMPARY+12                                                11275000
DMPARYIC EQU   DMPARY+10                                                11276000
DMPARYSZ EQU   DMPARY+8                                                 11277000
DMPARYNM EQU   DMPARY                                                   11278000
@NM00036 EQU   DMPITM+15                                                11279000
DMPITMTP EQU   DMPITM+14                                                11280000
DMPITMLN EQU   DMPITM+12                                                11281000
DMPITMPT EQU   DMPITM+8                                                 11282000
DMPITMNM EQU   DMPITM                                                   11283000
@NM00035 EQU   ERCNVTAB+24                                              11284000
ERCPLPT  EQU   ERCNVTAB+20                                              11285000
ERCATRC  EQU   ERCNVTAB+16                                              11286000
ERDSNM   EQU   ERCNVTAB+12                                              11287000
@NM00034 EQU   ERCNVTAB+4                                               11288000
@NM00033 EQU   ERCNVTAB+3                                               11289000
@NM00032 EQU   EROSOPER                                                 11290000
EROSUCDX EQU   EROSOPER                                                 11291000
EROSCATL EQU   EROSOPER                                                 11292000
@NM00031 EQU   EROPER                                                   11293000
ERCATAL  EQU   EROPER                                                   11294000
ERCATDL  EQU   EROPER                                                   11295000
ERCATDE  EQU   EROPER                                                   11296000
ERCATLC  EQU   EROPER                                                   11297000
@NM00030 EQU   ERTYPE                                                   11298000
EROSCAT  EQU   ERTYPE                                                   11299000
ERCATLG  EQU   ERTYPE                                                   11300000
@NM00029 EQU   FMTCNVF+1                                                11301000
FMTAR    EQU   FMTCNVF+1                                                11302000
FMTBS    EQU   FMTCNVF+1                                                11303000
FMTSS    EQU   FMTCNVF+1                                                11304000
FMTAL    EQU   FMTCNVF+1                                                11305000
FMTZS    EQU   FMTCNVF+1                                                11306000
@NM00028 EQU   FMTCNVF                                                  11307000
FMTPU    EQU   FMTCNVF                                                  11308000
FMTBD    EQU   FMTCNVF                                                  11309000
FMTBHD   EQU   FMTCNVF                                                  11310000
FMTBHA   EQU   FMTCNVF                                                  11311000
FMTBH    EQU   FMTCNVF                                                  11312000
FMTOLEN  EQU   FMTLIST+8                                                11313000
FMTRIO   EQU   FMTOCOL                                                  11314000
FMTSPT   EQU   FMTSTO                                                   11315000
FMTSTL   EQU   FMTILEN                                                  11316000
@NM00027 EQU   FMTFLGS+1                                                11317000
FMTHDF   EQU   FMTFLGS                                                  11318000
FMTDFF   EQU   FMTFLGS                                                  11319000
FMTSTF   EQU   FMTFLGS                                                  11320000
FMTREPF  EQU   FMTFLGS                                                  11321000
FMTBDF   EQU   FMTFLGS                                                  11322000
FMTIDF   EQU   FMTFLGS                                                  11323000
FMTSCF   EQU   FMTFLGS                                                  11324000
FMTEOLF  EQU   FMTFLGS                                                  11325000
DARGDTM  EQU   DARGARY+4                                                11326000
DARGPCT  EQU   DARGINL                                                  11327000
DARGREP  EQU   DARGINS                                                  11328000
@NM00026 EQU   DARGLIST+19                                              11329000
DARGIND  EQU   DARGLIST+18                                              11330000
DARGRETL EQU   DARGLIST+16                                              11331000
DARGCNT  EQU   DARGLIST+14                                              11332000
DARGILP  EQU   DARGLIST+12                                              11333000
DARGSENT EQU   DARGSTID+3                                               11334000
DARGSMOD EQU   DARGSTID                                                 11335000
DARGRETP EQU   DARGLIST+4                                               11336000
DARGDBP  EQU   DARGLIST                                                 11337000
UVOLVOL  EQU   UVOLENT+4                                                11338000
UVOLDEV  EQU   UVOLENT                                                  11339000
UVOLCNT  EQU   UVOLLIST                                                 11340000
@NM00025 EQU   IOINFOPT                                                 11341000
IOINFTMS EQU   IOINFOPT                                                 11342000
IOINFSUP EQU   IOINFOPT                                                 11343000
IOINFDSN EQU   IOINFOPT                                                 11344000
IOINFVOL EQU   IOINFOPT                                                 11345000
IOINFDVT EQU   IOINFOPT                                                 11346000
OPNVOL   EQU   OPNAGL+44                                                11347000
@NM00024 EQU   OPNAGL+43                                                11348000
@NM00023 EQU   OPNOPT2                                                  11349000
OPNOPTJM EQU   OPNOPT2                                                  11350000
@NM00022 EQU   OPNOPT2                                                  11351000
OPNOPTAS EQU   OPNOPT2                                                  11352000
@NM00021 EQU   OPNDSO                                                   11353000
OPNDSOPO EQU   OPNDSO                                                   11354000
OPNDSOIS EQU   OPNDSO                                                   11355000
OPNDSOPS EQU   OPNDSO                                                   11356000
OPNDSOAM EQU   OPNDSO                                                   11357000
OPNKYL   EQU   OPNAGL+40                                                11358000
OPNBLK   EQU   OPNAGL+36                                                11359000
OPNREC   EQU   OPNAGL+32                                                11360000
OPNDEVIX EQU   OPNDEV+4                                                 11361000
OPNDEVDT EQU   OPNDEV                                                   11362000
OPNCBP   EQU   OPNAGL+20                                                11363000
OPNDSN   EQU   OPNAGL+16                                                11364000
OPNPWA   EQU   OPNAGL+12                                                11365000
OPNDDN   EQU   OPNAGL+8                                                 11366000
OPNIOC   EQU   OPNAGL+4                                                 11367000
OPNMODRP EQU   OPNMOD                                                   11368000
OPNMODUB EQU   OPNMOD                                                   11369000
OPNMODRS EQU   OPNMOD                                                   11370000
OPNMODAX EQU   OPNMOD                                                   11371000
OPNMODRR EQU   OPNMOD                                                   11372000
OPNMODRC EQU   OPNMOD                                                   11373000
OPNMODAC EQU   OPNMOD                                                   11374000
OPNMODPD EQU   OPNMOD                                                   11375000
@NM00020 EQU   OPNTYP                                                   11376000
OPNTYPRV EQU   OPNTYP                                                   11377000
OPNTYPEX EQU   OPNTYP                                                   11378000
OPNTYPRA EQU   OPNTYP                                                   11379000
OPNTYPXM EQU   OPNTYP                                                   11380000
OPNTYPCI EQU   OPNTYP                                                   11381000
OPNTYPSO EQU   OPNTYP                                                   11382000
OPNTYPSI EQU   OPNTYP                                                   11383000
@NM00019 EQU   OPNRFM                                                   11384000
OPNRFMBK EQU   OPNRFM                                                   11385000
OPNRFMSF EQU   OPNRFM                                                   11386000
OPNRFMUN EQU   OPNRFM                                                   11387000
OPNRFMVR EQU   OPNRFM                                                   11388000
OPNRFMFX EQU   OPNRFM                                                   11389000
OPNOPTSK EQU   OPNOPT                                                   11390000
OPNOPTDR EQU   OPNOPT                                                   11391000
OPNOPTCR EQU   OPNOPT                                                   11392000
OPNOPTKS EQU   OPNOPT                                                   11393000
OPNOPTBK EQU   OPNOPT                                                   11394000
OPNOPTUP EQU   OPNOPT                                                   11395000
OPNOPTOT EQU   OPNOPT                                                   11396000
OPNOPTIN EQU   OPNOPT                                                   11397000
IOCEXT   EQU   IOCSTR+64                                                11398000
IOCREL   EQU   IOCSTR+60                                                11399000
IOCWORK  EQU   IOCSTR+56                                                11400000
IOCRRN   EQU   IOCSTR+52                                                11401000
IOCPNM   EQU   IOCNWM+2                                                 11402000
IOCPTL   EQU   IOCNWM                                                   11403000
IOCKYA   EQU   IOCMEM                                                   11404000
IOCVRC   EQU   IOCTTR                                                   11405000
IOCCBP   EQU   IOCSTR+36                                                11406000
IOCDSN   EQU   IOCSTR+32                                                11407000
IOCHURBA EQU   IOCSTR+28                                                11408000
IOCVOLSR EQU   IOCSTR+22                                                11409000
@NM00018 EQU   IOCMSG                                                   11410000
IOCMSGAE EQU   IOCMSG                                                   11411000
IOCMSGCE EQU   IOCMSG                                                   11412000
IOCMSGOE EQU   IOCMSG                                                   11413000
IOCMSGOP EQU   IOCMSG                                                   11414000
@NM00017 EQU   IOCMSG                                                   11415000
IOCCHPSY EQU   IOCCHP                                                   11416000
IOCCHPAS EQU   IOCCHP                                                   11417000
IOCCHPBK EQU   IOCCHP                                                   11418000
IOCCHPCR EQU   IOCCHP                                                   11419000
IOCCHPKS EQU   IOCCHP                                                   11420000
IOCCHPSK EQU   IOCCHP                                                   11421000
IOCCHPDR EQU   IOCCHP                                                   11422000
IOCCHPSQ EQU   IOCCHP                                                   11423000
@NM00016 EQU   IOCMAC2                                                  11424000
IOCMACPA EQU   IOCMAC2                                                  11425000
@NM00015 EQU   IOCMAC2                                                  11426000
IOCMACCP EQU   IOCMAC2                                                  11427000
IOCMACRR EQU   IOCMAC2                                                  11428000
IOCMACAS EQU   IOCMAC2                                                  11429000
IOCMACSK EQU   IOCMAC2                                                  11430000
@NM00014 EQU   IOCMAC                                                   11431000
IOCMACCC EQU   IOCMAC                                                   11432000
IOCMACDR EQU   IOCMAC                                                   11433000
IOCMACBK EQU   IOCMAC                                                   11434000
IOCMACCR EQU   IOCMAC                                                   11435000
IOCMACUP EQU   IOCMAC                                                   11436000
IOCMACOT EQU   IOCMAC                                                   11437000
IOCMACIN EQU   IOCMAC                                                   11438000
@NM00013 EQU   IOCRFM                                                   11439000
IOCRFMBK EQU   IOCRFM                                                   11440000
IOCRFMSF EQU   IOCRFM                                                   11441000
IOCRFMUN EQU   IOCRFM                                                   11442000
IOCRFMVR EQU   IOCRFM                                                   11443000
IOCRFMFX EQU   IOCRFM                                                   11444000
@NM00012 EQU   IOCDSO                                                   11445000
IOCDSOPO EQU   IOCDSO                                                   11446000
IOCDSOIS EQU   IOCDSO                                                   11447000
IOCDSOPS EQU   IOCDSO                                                   11448000
IOCDSOAM EQU   IOCDSO                                                   11449000
IOCRKP   EQU   IOCSTR+13                                                11450000
IOCKYL   EQU   IOCSTR+12                                                11451000
IOCTRN   EQU   IOCSTR+8                                                 11452000
IOCDLN   EQU   IOCSTR+4                                                 11453000
IOCDAD   EQU   IOCSTR                                                   11454000
UNITVTOC EQU   UNITABL+7                                                11455000
@NM00011 EQU   UNITSTAT                                                 11456000
UNITUSHR EQU   UNITSTAT                                                 11457000
UNITXSHR EQU   UNITSTAT                                                 11458000
UNITISHR EQU   UNITSTAT                                                 11459000
UNITUA   EQU   @NM00010+1                                               11460000
UNITCHA  EQU   @NM00010                                                 11461000
UNITUCB  EQU   UNITABL                                                  11462000
ALLUNCNT EQU   ALLAGL+30                                                11463000
ALLVLCNT EQU   ALLAGL+29                                                11464000
@NM00009 EQU   ALLOPT                                                   11465000
ALLOPTUN EQU   ALLOPT                                                   11466000
ALLOPTPV EQU   ALLOPT                                                   11467000
ALLOPTDS EQU   ALLOPT                                                   11468000
ALLOPTVL EQU   ALLOPT                                                   11469000
@NM00008 EQU   ALLORG+1                                                 11470000
ALLORGVS EQU   ALLORG+1                                                 11471000
@NM00007 EQU   ALLORG+1                                                 11472000
ALLORGGS EQU   ALLORG+1                                                 11473000
ALLORGUN EQU   ALLORG                                                   11474000
ALLORGPO EQU   ALLORG                                                   11475000
ALLORGMQ EQU   ALLORG                                                   11476000
ALLORGCQ EQU   ALLORG                                                   11477000
ALLORGCX EQU   ALLORG                                                   11478000
ALLORGDA EQU   ALLORG                                                   11479000
ALLORGPS EQU   ALLORG                                                   11480000
ALLORGIS EQU   ALLORG                                                   11481000
ALLDSPUN EQU   ALLDSP                                                   11482000
ALLDSPCG EQU   ALLDSP                                                   11483000
ALLDSPDE EQU   ALLDSP                                                   11484000
ALLDSPKP EQU   ALLDSP                                                   11485000
@NM00006 EQU   ALLDSP                                                   11486000
ALLSTSOD EQU   ALLSTS                                                   11487000
ALLSTSMD EQU   ALLSTS                                                   11488000
ALLSTSNW EQU   ALLSTS                                                   11489000
ALLSTSSR EQU   ALLSTS                                                   11490000
@NM00005 EQU   ALLSTS                                                   11491000
ALLPWD   EQU   ALLAGL+20                                                11492000
ALLVLP   EQU   ALLAGL+16                                                11493000
ALLULP   EQU   ALLAGL+12                                                11494000
ALLDDN   EQU   ALLAGL+4                                                 11495000
ALLDSN   EQU   ALLAGL                                                   11496000
CIRPID   EQU   CIRAGL+28                                                11497000
CIRPWD   EQU   CIRAGL+24                                                11498000
CIRCAT   EQU   CIRAGL+20                                                11499000
CIRWKP   EQU   CIRAGL+16                                                11500000
CIRTLR   EQU   CIRAGL+12                                                11501000
CIRHDR   EQU   CIRAGL+8                                                 11502000
CIRTLN   EQU   CIRAGL+6                                                 11503000
CIRHLN   EQU   CIRAGL+4                                                 11504000
@NM00004 EQU   CIRAGL+1                                                 11505000
@NM00003 EQU   CIRTYPE                                                  11506000
CIRTYPAQ EQU   CIRTYPE                                                  11507000
CIRTYP1Q EQU   CIRTYPE                                                  11508000
NEWID1   EQU   TRACE1+95                                                11509000
CALLID   EQU   OLDERID1+90                                              11510000
@NM00002 EQU   OLDERID1                                                 11511000
*                                      END UNREFERENCED COMPONENTS      11512000
@RT00388 EQU   @EL00001                                                 11513000
@RT00418 EQU   @EL00001                                                 11514000
@RT00421 EQU   @EL00001                                                 11515000
@RT00648 EQU   @EL00002                                                 11516000
@RF00651 EQU   @RC00619                                                 11517000
@RC00713 EQU   @RC00712                                                 11518000
@RT00776 EQU   @EL00002                                                 11519000
@RF00811 EQU   @EL00003                                                 11520000
@RT00823 EQU   @EL00003                                                 11521000
@RT00829 EQU   @EL00003                                                 11522000
@RT00832 EQU   @EL00003                                                 11523000
@RF00837 EQU   @RC00826                                                 11524000
@RF00836 EQU   @RC00826                                                 11525000
@RT00851 EQU   @EL00003                                                 11526000
@RC00868 EQU   @EL00004                                                 11527000
@RT00976 EQU   @RC00974                                                 11528000
@RC01112 EQU   @RC01111                                                 11529000
@RT01167 EQU   @RC01165                                                 11530000
@RT01340 EQU   @EL00007                                                 11531000
@RT01343 EQU   @EL00007                                                 11532000
@RC01329 EQU   @EL00007                                                 11533000
@RF01345 EQU   @EL00007                                                 11534000
@RF01448 EQU   @RC01439                                                 11535000
@RC01552 EQU   @RC01551                                                 11536000
@RC01556 EQU   @RC01555                                                 11537000
@RC01631 EQU   @EL00010                                                 11538000
@RF01681 EQU   @EL00010                                                 11539000
@RF01777 EQU   @RC01774                                                 11540000
@RF01974 EQU   @EL00012                                                 11541000
@RT02034 EQU   @EL00013                                                 11542000
@RF02036 EQU   @EL00013                                                 11543000
@PB00014 EQU   @PB00015                                                 11544000
@RF01652 EQU   @RC01631                                                 11545000
@PB00013 EQU   @PB00014                                                 11546000
@PB00012 EQU   @PB00013                                                 11547000
@PB00011 EQU   @PB00012                                                 11548000
@PB00010 EQU   @PB00011                                                 11549000
@PB00009 EQU   @PB00010                                                 11550000
@PB00008 EQU   @PB00009                                                 11551000
@PB00007 EQU   @PB00008                                                 11552000
@PB00006 EQU   @PB00007                                                 11553000
@PB00005 EQU   @PB00006                                                 11554000
@PB00004 EQU   @PB00005                                                 11555000
@PB00003 EQU   @PB00004                                                 11556000
@PB00002 EQU   @PB00003                                                 11557000
@ENDDATA EQU   *                                                        11558000
         END   IDCCH02,(C'PLS1411',0603,77297)                          11559000
