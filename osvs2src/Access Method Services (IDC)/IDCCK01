         TITLE '******* IDCCK01:  CHECKPOINT LIST UTILITY (CHKLIST) FSR*00001000
               R *******'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCK01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCK01   75.012'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @11,0                                               0002 00021000
@PSTART  LA    @12,4095(,@11)                                      0002 00022000
         USING @PSTART,@11                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @10,@01                                             0002 00027000
         USING @DATD,@10                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @10,8(,@13)                                         0002 00031000
         LR    @13,@10                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*        /************************************************************/ 00034000
*        /*                                                          */ 00035000
*        /* GLOBAL INITIALIZATIONS                                   */ 00036000
*        /*                                                          */ 00037000
*        /************************************************************/ 00038000
*                                                                  0201 00039000
*        OLDERID2 = NEWERID2;                                      0201 00040000
         L     @15,@PC00001                                        0201 00041000
         L     @15,GDTTR2(,@15)                                    0201 00042000
         MVC   @TS00001(95),NEWERID2(@15)                          0201 00043000
         MVC   OLDERID2(95,@15),@TS00001                           0201 00044000
*        NEWID2 = 'CKCK';                                          0202 00045000
*                                                                  0202 00046000
         MVC   NEWID2(4,@15),@CC00753                              0202 00047000
*        DDSTRU = ADDR(DARGAREA);                                  0203 00048000
         LA    @15,DARGAREA                                        0203 00049000
         ST    @15,DDSTRU                                          0203 00050000
*        DARGLIST = ZEROAREA;                                      0204 00051000
         MVC   DARGLIST(20,@15),ZEROAREA                           0204 00052000
*        SETRC = 0;                                                0205 00053000
         SLR   @15,@15                                             0205 00054000
         STH   @15,SETRC                                           0205 00055000
*        EOF = 0;                                                  0206 00056000
         STH   @15,EOF                                             0206 00057000
*        CHRFND = NO;                                              0207 00058000
         NI    CHRFND,B'01111111'                                  0207 00059000
*        NEEDCHR = YES;                                            0208 00060000
         OI    NEEDCHR,B'10000000'                                 0208 00061000
*        SYSID = ZEROAREA;                                         0209 00062000
*                                                                  0209 00063000
         MVC   SYSID(1),ZEROAREA                                   0209 00064000
*        /************************************************************/ 00065000
*        /*                                                          */ 00066000
*        /* PERFORM HOUSKEEPING FUCTIONS:                            */ 00067000
*        /*    OPEN ALTERNATE OUTPUT IF SPECIFIED                    */ 00068000
*        /*    OPEN CHECKPOINT DATA SET INPUT                        */ 00069000
*        /*    SET UP HEADER LINES FOR TEXT PROCESSOR                */ 00070000
*        /*                                                          */ 00071000
*        /************************************************************/ 00072000
*                                                                  0210 00073000
*        CALL HSKGPROC;                                            0210 00074000
         BAL   @14,HSKGPROC                                        0210 00075000
*        RESPECIFY RTNREG RSTD;                                    0211 00076000
*        TESTRC = RTNREG;                                          0212 00077000
         LR    TESTRC,RTNREG                                       0212 00078000
*        RESPECIFY RTNREG UNRSTD;                                  0213 00079000
*        SETRC = MAX(SETRC,TESTRC);                                0214 00080000
*                                                                  0214 00081000
         LH    @02,SETRC                                           0214 00082000
         CR    @02,TESTRC                                          0214 00083000
         BNL   *+6                                                      00084000
         LR    @02,TESTRC                                          0214 00085000
         STH   @02,SETRC                                           0214 00086000
*        /************************************************************/ 00087000
*        /*                                                          */ 00088000
*        /* BUILD CHECKID TABLE IF NO TERMINAL ERROR HAS OCCURED.    */ 00089000
*        /* SET IDCOUNT TO CHKIDCNT WHEN CHECKID WAS SPECIFIED       */ 00090000
*        /* OR TO -1 IF CHECKID WAS NOT SPECIFIED (ALL ENTRIES ARE   */ 00091000
*        /* TO BE PROCESSED)                                         */ 00092000
*        /*                                                          */ 00093000
*        /************************************************************/ 00094000
*                                                                  0215 00095000
*        IF SETRC < LASTCC12                                       0215 00096000
*          THEN                                                    0215 00097000
*                                                                  0215 00098000
         C     @02,@CF00536                                        0215 00099000
         BNL   @RF00215                                            0215 00100000
*MAINCNTL:   DO;                                                   0216 00101000
*                                                                  0216 00102000
MAINCNTL DS    0H                                                  0217 00103000
*              CALL BUILDTAB (IDTABPTR,                            0217 00104000
*                             IDEOTPTR);                           0217 00105000
         LA    @15,IDTABPTR                                        0217 00106000
         ST    @15,@AL00001                                        0217 00107000
         LA    @15,IDEOTPTR                                        0217 00108000
         ST    @15,@AL00001+4                                      0217 00109000
         LA    @01,@AL00001                                        0217 00110000
         BAL   @14,BUILDTAB                                        0217 00111000
*              RESPECIFY RTNREG RSTD;                              0218 00112000
*              TESTRC = RTNREG;                                    0219 00113000
         LR    TESTRC,RTNREG                                       0219 00114000
*              RESPECIFY RTNREG UNRSTD;                            0220 00115000
*              SETRC = MAX(SETRC,TESTRC);                          0221 00116000
         LH    @02,SETRC                                           0221 00117000
         CR    @02,TESTRC                                          0221 00118000
         BNL   *+6                                                      00119000
         LR    @02,TESTRC                                          0221 00120000
         STH   @02,SETRC                                           0221 00121000
*              /******************************************************/ 00122000
*              /*                                                    */ 00123000
*              /* IF NO TERMINAL ERROR HAS OCCURED, PREPARE THE      */ 00124000
*              /* CHECKPOINT LIST UTILITY REPORT OF TAPE DATA        */ 00125000
*              /* SETS OPEN AT THE TIME OF EACH USER-SELECTED        */ 00126000
*              /* CHECKPOINT                                         */ 00127000
*              /*                                                    */ 00128000
*              /******************************************************/ 00129000
*                                                                  0222 00130000
*              IF SETRC < LASTCC12                                 0222 00131000
*                THEN                                              0222 00132000
*                                                                  0222 00133000
         C     @02,@CF00536                                        0222 00134000
         BNL   @RF00222                                            0222 00135000
*DOCKLST:         DO;                                              0223 00136000
*                                                                  0223 00137000
DOCKLST  DS    0H                                                  0224 00138000
*                  DO WHILE(IDCOUNT ^= 0 & EOF = 0);               0224 00139000
*                                                                  0224 00140000
         B     @DE00224                                            0224 00141000
@DL00224 DS    0H                                                  0225 00142000
*                    IF GDTDBG = NULLPTR                           0225 00143000
*                      THEN;                                       0225 00144000
         L     @02,@PC00001                                        0225 00145000
         L     @02,GDTDBG(,@02)                                    0225 00146000
         LTR   @02,@02                                             0225 00147000
         BZ    @RT00225                                            0225 00148000
*                      ELSE                                        0227 00149000
*                        CALL IDCDB010 (GDTTBL,'CK10');            0227 00150000
*                                                                  0227 00151000
         L     @02,@PC00001                                        0227 00152000
         ST    @02,@AL00001                                        0227 00153000
         LA    @15,@CC00762                                        0227 00154000
         ST    @15,@AL00001+4                                      0227 00155000
         MVI   @AL00001+4,X'80'                                    0227 00156000
         L     @15,GDTDBG(,@02)                                    0227 00157000
         LA    @01,@AL00001                                        0227 00158000
         BALR  @14,@15                                             0227 00159000
*                    /************************************************/ 00160000
*                    /*                                              */ 00161000
*                    /* READ USER-SELECTED CHR AND DECREMENT IDCOUNT */ 00162000
*                    /* WHEN USER-SELECTED CHR IS FOUND              */ 00163000
*                    /*                                              */ 00164000
*                    /************************************************/ 00165000
*                                                                  0228 00166000
*                    CALL CHRPROC (SYSID,                          0228 00167000
*                                  NEEDCHR,                        0228 00168000
*                                  CHRFND,                         0228 00169000
*                                  EOF);                           0228 00170000
*                                                                  0228 00171000
@RT00225 LA    @02,SYSID                                           0228 00172000
         ST    @02,@AL00001                                        0228 00173000
         LA    @02,NEEDCHR                                         0228 00174000
         ST    @02,@AL00001+4                                      0228 00175000
         LA    @02,CHRFND                                          0228 00176000
         ST    @02,@AL00001+8                                      0228 00177000
         LA    @02,EOF                                             0228 00178000
         ST    @02,@AL00001+12                                     0228 00179000
         LA    @01,@AL00001                                        0228 00180000
         BAL   @14,CHRPROC                                         0228 00181000
*                    IF GDTDBG = NULLPTR                           0229 00182000
*                      THEN;                                       0229 00183000
         L     @02,@PC00001                                        0229 00184000
         L     @02,GDTDBG(,@02)                                    0229 00185000
         LTR   @02,@02                                             0229 00186000
         BZ    @RT00229                                            0229 00187000
*                      ELSE                                        0231 00188000
*                        CALL IDCDB010 (GDTTBL,'CK20');            0231 00189000
*                                                                  0231 00190000
         L     @02,@PC00001                                        0231 00191000
         ST    @02,@AL00001                                        0231 00192000
         LA    @15,@CC00764                                        0231 00193000
         ST    @15,@AL00001+4                                      0231 00194000
         MVI   @AL00001+4,X'80'                                    0231 00195000
         L     @15,GDTDBG(,@02)                                    0231 00196000
         LA    @01,@AL00001                                        0231 00197000
         BALR  @14,@15                                             0231 00198000
*                    /************************************************/ 00199000
*                    /*                                              */ 00200000
*                    /* IF EOF HAS NOT OCCURED, PROCESS DSDRS, IF    */ 00201000
*                    /* EOF HAS OCCURED, PERFORM EXIT PROCESSING     */ 00202000
*                    /*                                              */ 00203000
*                    /************************************************/ 00204000
*                                                                  0232 00205000
*                    IF EOF ^= EOFCOND                             0232 00206000
*                      THEN                                        0232 00207000
@RT00229 CLC   EOF(2),@CH00213                                     0232 00208000
         BE    @RF00232                                            0232 00209000
*                        DO;                                       0233 00210000
*                                                                  0233 00211000
*                          CALL DSDRPROC (NEEDCHR,EOF);            0234 00212000
         LA    @02,NEEDCHR                                         0234 00213000
         ST    @02,@AL00001                                        0234 00214000
         LA    @02,EOF                                             0234 00215000
         ST    @02,@AL00001+4                                      0234 00216000
         LA    @01,@AL00001                                        0234 00217000
         BAL   @14,DSDRPROC                                        0234 00218000
*                          RESPECIFY RTNREG RSTD;                  0235 00219000
*                          TESTRC = RTNREG;                        0236 00220000
         LR    TESTRC,RTNREG                                       0236 00221000
*                          RESPECIFY RTNREG UNRSTD;                0237 00222000
*                          SETRC = MAX(SETRC,TESTRC);              0238 00223000
*                                                                  0238 00224000
         LH    @02,SETRC                                           0238 00225000
         CR    @02,TESTRC                                          0238 00226000
         BNL   *+6                                                      00227000
         LR    @02,TESTRC                                          0238 00228000
         STH   @02,SETRC                                           0238 00229000
*                        END;                                      0239 00230000
*                      ELSE;                                       0240 00231000
@RF00232 DS    0H                                                  0241 00232000
*                  END;                                            0241 00233000
@DE00224 SLR   @02,@02                                             0241 00234000
         L     @01,IDTABPTR                                        0241 00235000
         CH    @02,IDCOUNT(,@01)                                   0241 00236000
         BE    @DC00224                                            0241 00237000
         CH    @02,EOF                                             0241 00238000
         BE    @DL00224                                            0241 00239000
@DC00224 DS    0H                                                  0242 00240000
*                  /**************************************************/ 00241000
*                  /*                                                */ 00242000
*                  /* IF CHRFND = NO, THEN NO CHRS WERE FOUND ON THE */ 00243000
*                  /* CHECKPOINT DATA SET. PRINT MESSAGE WITH UPRINT.*/ 00244000
*                  /* SET RETURN CODE TO 4.                          */ 00245000
*                  /*                                                */ 00246000
*                  /**************************************************/ 00247000
*                                                                  0242 00248000
*                  IF CHRFND = NO                                  0242 00249000
*                    THEN                                          0242 00250000
         TM    CHRFND,B'10000000'                                  0242 00251000
         BNZ   @RF00242                                            0242 00252000
*                      DO;                                         0243 00253000
*                        DARGSMOD = CK0ID;                         0244 00254000
         L     @02,DDSTRU                                          0244 00255000
         MVC   DARGSMOD(3,@02),@CC00609                            0244 00256000
*                        DARGSENT = CKST09;                        0245 00257000
*                                                                  0245 00258000
         MVI   DARGSENT(@02),X'09'                                 0245 00259000
*                        CALL AMSTP011 (GDTTBL,                    0246 00260000
*                                PRTFILE,                          0246 00261000
*                                DDSTRU);                          0246 00262000
         L     @02,@PC00001                                        0246 00263000
         ST    @02,@AL00001                                        0246 00264000
         LA    @15,@CF00111                                        0246 00265000
         ST    @15,@AL00001+4                                      0246 00266000
         LA    @15,DDSTRU                                          0246 00267000
         ST    @15,@AL00001+8                                      0246 00268000
         MVI   @AL00001+8,X'80'                                    0246 00269000
         L     @15,GDTPRT(,@02)                                    0246 00270000
         LA    @01,@AL00001                                        0246 00271000
         BALR  @14,@15                                             0246 00272000
*                        RESPECIFY RTNREG RSTD;                    0247 00273000
*                        TESTRC = RTNREG;                          0248 00274000
         LR    TESTRC,RTNREG                                       0248 00275000
*                        RESPECIFY RTNREG UNRSTD;                  0249 00276000
*                        SETRC = MAX(SETRC,TESTRC);                0250 00277000
         LH    @02,SETRC                                           0250 00278000
         CR    @02,TESTRC                                          0250 00279000
         BNL   *+6                                                      00280000
         LR    @02,TESTRC                                          0250 00281000
         STH   @02,SETRC                                           0250 00282000
*                        DARGLIST = ZEROAREA;      /* CLEAR DARGLIST */ 00283000
         L     @01,DDSTRU                                          0251 00284000
         MVC   DARGLIST(20,@01),ZEROAREA                           0251 00285000
*                        SETRC = MAX(SETRC,LASTCC04);              0252 00286000
*                                                                  0252 00287000
         LA    @03,4                                               0252 00288000
         CR    @02,@03                                             0252 00289000
         BNL   *+6                                                      00290000
         LR    @02,@03                                             0252 00291000
         STH   @02,SETRC                                           0252 00292000
*                      END;                                        0253 00293000
*                    ELSE;                                         0254 00294000
*                                                                  0254 00295000
@RF00242 DS    0H                                                  0255 00296000
*                  /**************************************************/ 00297000
*                  /*                                                */ 00298000
*                  /* IF IDCOUNT IS GREATER THAN ZERO, THEN SOME     */ 00299000
*                  /* SELECTED CHECKIDS WERE NOT FOUND. LIST THEM    */ 00300000
*                  /* AND SET LASTCC TO 4                            */ 00301000
*                  /*                                                */ 00302000
*                  /**************************************************/ 00303000
*                                                                  0255 00304000
*                  IF IDCOUNT > 0                                  0255 00305000
*                    THEN                                          0255 00306000
         L     @15,IDTABPTR                                        0255 00307000
         LH    @14,IDCOUNT(,@15)                                   0255 00308000
         LTR   @14,@14                                             0255 00309000
         BNP   @RF00255                                            0255 00310000
*                      DO;                                         0256 00311000
*                        IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);    0257 00312000
         AL    @15,@CF00147                                        0257 00313000
         LR    IDTABWKP,@15                                        0257 00314000
*                        DARGSMOD = CK0ID;                         0258 00315000
         L     @03,DDSTRU                                          0258 00316000
         MVC   DARGSMOD(3,@03),@CC00609                            0258 00317000
*                        DARGSENT = CKST05;                        0259 00318000
*                                                                  0259 00319000
         MVI   DARGSENT(@03),X'05'                                 0259 00320000
*                        /********************************************/ 00321000
*                        /*                                          */ 00322000
*                        /* SEARCH CHECKID TABLE FOR ENTRIES WHICH   */ 00323000
*                        /* HAVE NOT BEEN FOUND AND PRINT WITH UPRINT*/ 00324000
*                        /*                                          */ 00325000
*                        /********************************************/ 00326000
*                                                                  0260 00327000
*                        DO WHILE(IDTABWKP < IDEOTPTR);            0260 00328000
         B     @DE00260                                            0260 00329000
@DL00260 DS    0H                                                  0261 00330000
*                          IF IDFOUND = NO                         0261 00331000
*                            THEN                                  0261 00332000
         TM    IDFOUND(IDTABWKP),B'10000000'                       0261 00333000
         BNZ   @RF00261                                            0261 00334000
*                              DO;                                 0262 00335000
*                                DARGDBP = ADDR(IDCHKID);          0263 00336000
         L     @15,DDSTRU                                          0263 00337000
         LA    @14,IDCHKID(,IDTABWKP)                              0263 00338000
         ST    @14,DARGDBP(,@15)                                   0263 00339000
*                                DARGILP = LENGTH(IDCHKID);        0264 00340000
*                                                                  0264 00341000
         MVC   DARGILP(2,@15),@CH00465                             0264 00342000
*                                CALL AMSTP011 (GDTTBL,            0265 00343000
*                                        PRTFILE,                  0265 00344000
*                                        DDSTRU);                  0265 00345000
         L     @15,@PC00001                                        0265 00346000
         ST    @15,@AL00001                                        0265 00347000
         LA    @14,@CF00111                                        0265 00348000
         ST    @14,@AL00001+4                                      0265 00349000
         LA    @14,DDSTRU                                          0265 00350000
         ST    @14,@AL00001+8                                      0265 00351000
         MVI   @AL00001+8,X'80'                                    0265 00352000
         L     @15,GDTPRT(,@15)                                    0265 00353000
         LA    @01,@AL00001                                        0265 00354000
         BALR  @14,@15                                             0265 00355000
*                                RESPECIFY RTNREG RSTD;            0266 00356000
*                                TESTRC = RTNREG;                  0267 00357000
         LR    TESTRC,RTNREG                                       0267 00358000
*                                RESPECIFY RTNREG UNRSTD;          0268 00359000
*                                SETRC = MAX(SETRC,TESTRC);        0269 00360000
         LH    @15,SETRC                                           0269 00361000
         CR    @15,TESTRC                                          0269 00362000
         BNL   *+6                                                      00363000
         LR    @15,TESTRC                                          0269 00364000
         STH   @15,SETRC                                           0269 00365000
*                                /* SET LASTCC TO 4                  */ 00366000
*                                SETRC = MAX(SETRC,LASTCC04);      0270 00367000
*                                                                  0270 00368000
         LA    @03,4                                               0270 00369000
         CR    @15,@03                                             0270 00370000
         BNL   *+6                                                      00371000
         LR    @15,@03                                             0270 00372000
         STH   @15,SETRC                                           0270 00373000
*                              END;                                0271 00374000
*                            ELSE;                                 0272 00375000
@RF00261 DS    0H                                                  0273 00376000
*                          IDTABWKP = IDTABWKP + LENGTH(IDTABLE);  0273 00377000
         AL    IDTABWKP,@CF00893                                   0273 00378000
*                        END;                                      0274 00379000
@DE00260 C     IDTABWKP,IDEOTPTR                                   0274 00380000
         BL    @DL00260                                            0274 00381000
*                        DARGLIST = ZEROAREA;                      0275 00382000
         L     @01,DDSTRU                                          0275 00383000
         MVC   DARGLIST(20,@01),ZEROAREA                           0275 00384000
*                      END;                                        0276 00385000
*                                                                  0276 00386000
*                    ELSE;                                         0277 00387000
*                                                                  0277 00388000
@RF00255 DS    0H                                                  0278 00389000
*                 END DOCKLST;                                     0278 00390000
*                                                                  0278 00391000
*                ELSE;                 /* PAIRS 'THEN' AFTER BUILDTAB*/ 00392000
*                                                                  0279 00393000
@RF00222 DS    0H                                                  0280 00394000
*            END MAINCNTL;                                         0280 00395000
*                                                                  0280 00396000
*          ELSE;                  /* PAIRS 'THEN' AT 'MAINCNTL' LABEL*/ 00397000
@RF00215 DS    0H                                                  0282 00398000
*        /************************************************************/ 00399000
*        /*                                                          */ 00400000
*        /* PERFORM EXIT PROCESSING - CLOSE OPENED FILES (UCLOSE)    */ 00401000
*        /* AND FREE ACQUIRED SPACE (UFPOOL). PRINT APPROPRIATE      */ 00402000
*        /* TERMINATION MESSAGE.                                     */ 00403000
*        /*                                                          */ 00404000
*        /************************************************************/ 00405000
*                                                                  0282 00406000
*        /************************************************************/ 00407000
*        /*                                                          */ 00408000
*        /* CLOSE THE CHECKPOINT DATA SET                            */ 00409000
*        /* IF ERROR OCCURS IN CLOSE, LASTCC IS SET TO 8             */ 00410000
*        /*                                                          */ 00411000
*        /************************************************************/ 00412000
*                                                                  0282 00413000
*        CALL IDCIOCL0 (GDTTBL,                                    0282 00414000
*                INIOCP);                                          0282 00415000
         L     @02,@PC00001                                        0282 00416000
         ST    @02,@AL00001                                        0282 00417000
         LA    @15,INIOCP                                          0282 00418000
         ST    @15,@AL00001+4                                      0282 00419000
         MVI   @AL00001+4,X'80'                                    0282 00420000
         L     @15,GDTCLS(,@02)                                    0282 00421000
         LA    @01,@AL00001                                        0282 00422000
         BALR  @14,@15                                             0282 00423000
*        RESPECIFY RTNREG RSTD;                                    0283 00424000
*        TESTRC = RTNREG;                                          0284 00425000
         LR    TESTRC,RTNREG                                       0284 00426000
*        RESPECIFY RTNREG UNRSTD;                                  0285 00427000
*        IF TESTRC ^= 0                                            0286 00428000
*          THEN                                                    0286 00429000
         LTR   TESTRC,TESTRC                                       0286 00430000
         BZ    @RF00286                                            0286 00431000
*            SETRC = MAX(SETRC,LASTCC08);                          0287 00432000
         LH    @15,SETRC                                           0287 00433000
         LA    @14,8                                               0287 00434000
         CR    @15,@14                                             0287 00435000
         BNL   *+6                                                      00436000
         LR    @15,@14                                             0287 00437000
         STH   @15,SETRC                                           0287 00438000
*          ELSE;                                                   0288 00439000
*                                                                  0288 00440000
@RF00286 DS    0H                                                  0289 00441000
*        /************************************************************/ 00442000
*        /*                                                          */ 00443000
*        /* SELECT APPROPRIATE END OF JOB MESSAGE AND SET UP DARGLIST*/ 00444000
*        /* PRINT WITH UPRINT.                                       */ 00445000
*        /*                                                          */ 00446000
*        /************************************************************/ 00447000
*                                                                  0289 00448000
*        IF SETRC < LASTCC12                                       0289 00449000
*          THEN                                                    0289 00450000
         LH    @15,SETRC                                           0289 00451000
         C     @15,@CF00536                                        0289 00452000
         BNL   @RF00289                                            0289 00453000
*            DO;                                                   0290 00454000
*              DARGSMOD = UV0ID;                                   0291 00455000
         L     @15,DDSTRU                                          0291 00456000
         MVC   DARGSMOD(3,@15),@CC00604                            0291 00457000
*              DARGSENT = UVMSG01;                                 0292 00458000
         MVI   DARGSENT(@15),X'01'                                 0292 00459000
*              DARGDBP = ADDR(SETRC);                              0293 00460000
         LA    @14,SETRC                                           0293 00461000
         ST    @14,DARGDBP(,@15)                                   0293 00462000
*              DARGILP = LENGTH(SETRC);                            0294 00463000
         MVC   DARGILP(2,@15),@CH00147                             0294 00464000
*            END;                                                  0295 00465000
*          ELSE                                                    0296 00466000
*            DO;                                                   0296 00467000
         B     @RC00289                                            0296 00468000
@RF00289 DS    0H                                                  0297 00469000
*              DARGSMOD = UV0ID;                                   0297 00470000
         L     @15,DDSTRU                                          0297 00471000
         MVC   DARGSMOD(3,@15),@CC00604                            0297 00472000
*              DARGSENT = UVMSG03;                                 0298 00473000
         MVI   DARGSENT(@15),X'03'                                 0298 00474000
*              DARGDBP = ADDR(SETRC);                              0299 00475000
         LA    @14,SETRC                                           0299 00476000
         ST    @14,DARGDBP(,@15)                                   0299 00477000
*              DARGILP = LENGTH(SETRC);                            0300 00478000
         MVC   DARGILP(2,@15),@CH00147                             0300 00479000
*            END;                                                  0301 00480000
*                                                                  0301 00481000
*        CALL AMSTP011 (GDTTBL,                                    0302 00482000
*                PRTFILE,                                          0302 00483000
*                DDSTRU);                                          0302 00484000
@RC00289 L     @15,@PC00001                                        0302 00485000
         ST    @15,@AL00001                                        0302 00486000
         LA    @14,@CF00111                                        0302 00487000
         ST    @14,@AL00001+4                                      0302 00488000
         LA    @14,DDSTRU                                          0302 00489000
         ST    @14,@AL00001+8                                      0302 00490000
         MVI   @AL00001+8,X'80'                                    0302 00491000
         L     @15,GDTPRT(,@15)                                    0302 00492000
         LA    @01,@AL00001                                        0302 00493000
         BALR  @14,@15                                             0302 00494000
*        /************************************************************/ 00495000
*        /*                                                          */ 00496000
*        /* CLOSE USERS OUTPUT DATA SET IF IT IS NOT THE DEFAULT     */ 00497000
*        /* AMS DATA SET. THE OUTPUT FILE IS CLOSED HERE TO ALLOW    */ 00498000
*        /* FOR FINAL MESSAGES IF ERROR OCCURS IN CLOSE, LASTCC      */ 00499000
*        /* IS SET TO 8                                              */ 00500000
*        /*                                                          */ 00501000
*        /************************************************************/ 00502000
*                                                                  0303 00503000
*        IF ADDR(OFILE) ^= NULLPTR & OUTIOCP ^= PRTFILE            0303 00504000
*          THEN                                                    0303 00505000
         SLR   @15,@15                                             0303 00506000
         L     @14,@PC00001+4                                      0303 00507000
         C     @15,FDTPTR+4(,@14)                                  0303 00508000
         BE    @RF00303                                            0303 00509000
         C     @15,OUTIOCP                                         0303 00510000
         BE    @RF00303                                            0303 00511000
*            DO;                                                   0304 00512000
*                                                                  0304 00513000
*              CALL IDCIOCL0 (GDTTBL,                              0305 00514000
*                      OUTIOCP);                                   0305 00515000
         L     @02,@PC00001                                        0305 00516000
         ST    @02,@AL00001                                        0305 00517000
         LA    @15,OUTIOCP                                         0305 00518000
         ST    @15,@AL00001+4                                      0305 00519000
         MVI   @AL00001+4,X'80'                                    0305 00520000
         L     @15,GDTCLS(,@02)                                    0305 00521000
         LA    @01,@AL00001                                        0305 00522000
         BALR  @14,@15                                             0305 00523000
*              RESPECIFY RTNREG RSTD;                              0306 00524000
*              TESTRC = RTNREG;                                    0307 00525000
         LR    TESTRC,RTNREG                                       0307 00526000
*              RESPECIFY RTNREG UNRSTD;                            0308 00527000
*              IF TESTRC ^= 0                                      0309 00528000
*                THEN                                              0309 00529000
         LTR   TESTRC,TESTRC                                       0309 00530000
         BZ    @RF00309                                            0309 00531000
*                  SETRC = MAX(SETRC,LASTCC08);                    0310 00532000
         LH    @15,SETRC                                           0310 00533000
         LA    @14,8                                               0310 00534000
         CR    @15,@14                                             0310 00535000
         BNL   *+6                                                      00536000
         LR    @15,@14                                             0310 00537000
         STH   @15,SETRC                                           0310 00538000
*                ELSE;                                             0311 00539000
*                                                                  0311 00540000
@RF00309 DS    0H                                                  0312 00541000
*            END;                                                  0312 00542000
*          ELSE;                                                   0313 00543000
*                                                                  0313 00544000
@RF00303 DS    0H                                                  0314 00545000
*        /************************************************************/ 00546000
*        /*                                                          */ 00547000
*        /* FREE ALL STORAGE OBTAINED BY CHKLIST. SET FINAL CONDITION*/ 00548000
*        /* CODE AND EXIT (UEPIL).                                   */ 00549000
*        /*                                                          */ 00550000
*        /************************************************************/ 00551000
*                                                                  0314 00552000
*        CALL IDCSAFP0 (GDTTBL,                                    0314 00553000
*                GPID00,                                           0314 00554000
*                ALL);                                             0314 00555000
         MVC   @AL00001+4(8),@AL00314                              0314 00556000
         L     @15,@PC00001                                        0314 00557000
         ST    @15,@AL00001                                        0314 00558000
         L     @15,GDTFPL(,@15)                                    0314 00559000
         LA    @01,@AL00001                                        0314 00560000
         BALR  @14,@15                                             0314 00561000
*        LASTCC = SETRC;                                           0315 00562000
*                                                                  0315 00563000
         L     @15,@PC00001+8                                      0315 00564000
         LH    @14,SETRC                                           0315 00565000
         STH   @14,LASTCC(,@15)                                    0315 00566000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0316 00567000
*                                                                  0316 00568000
         L     @14,@PC00001                                        0316 00569000
         ST    @14,@AL00001                                        0316 00570000
         LA    @09,MODID                                           0316 00571000
         ST    @09,@AL00001+4                                      0316 00572000
         ST    @15,@AL00001+8                                      0316 00573000
         MVI   @AL00001+8,X'80'                                    0316 00574000
         L     @15,GDTEPL(,@14)                                    0316 00575000
         LA    @01,@AL00001                                        0316 00576000
         BALR  @14,@15                                             0316 00577000
*        /************************************************************/ 00578000
*        /*                                                          */ 00579000
*        /* PROCEDURE - HSKGPROC                                     */ 00580000
*        /*                                                          */ 00581000
*        /* FUNCTION - TO OPEN THE ALTERNATE OUTPUT FILE IF SPECIFIED*/ 00582000
*        /*            TO OPEN THE CHECKPOINT DATA SET FOR INPUT     */ 00583000
*        /*            TO ESTABLISH CHKLIST REPORT SUBTITLES         */ 00584000
*        /*                                                          */ 00585000
*        /* INPUT - CHKLIST COMMAND STATEMENT DATA                   */ 00586000
*        /*                                                          */ 00587000
*        /* OUTPUT - RETURN CODE TO SIGNIFY STATUS OF FUNCTIONS      */ 00588000
*        /*          RCOR - FUNCTIONS WERE SUCCESSFUL                */ 00589000
*        /*          LASTCC12 - OPEN ERROR                           */ 00590000
*        /*                                                          */ 00591000
*        /************************************************************/ 00592000
*                                                                  0317 00593000
*HSKGPROC:                                                         0317 00594000
*        PROCEDURE;                                                0317 00595000
*                                                                  0317 00596000
@EL00001 L     @13,4(,@13)                                         0317 00597000
@EF00001 L     @00,@SIZDATD                                        0317 00598000
         LR    @01,@10                                             0317 00599000
         FREEMAIN R,LV=(0),A=(1)                                        00600000
@ER00001 LM    @14,@12,12(@13)                                     0317 00601000
         BR    @14                                                 0317 00602000
HSKGPROC STM   @14,@12,@SA00002                                    0317 00603000
*        /************************************************************/ 00604000
*        /*                                                          */ 00605000
*        /* SET UP OPEN ARGUMENT LIST FOR ALTERNATE OUTPUT DATA SET  */ 00606000
*        /* IF SPECIFIED. IF OMITTED, THE STANDARD SYSPRINT FILE IS  */ 00607000
*        /* USED. OUTPUT FILE IS OPENED IMMEDIATELY TO ALLOW FOR     */ 00608000
*        /* SUBSEQUENT DIAGNOSTICS.                                  */ 00609000
*        /*                                                          */ 00610000
*        /************************************************************/ 00611000
*                                                                  0318 00612000
*        OLDERID2 = NEWERID2;                                      0318 00613000
         L     @15,@PC00001                                        0318 00614000
         L     @14,GDTTR2(,@15)                                    0318 00615000
         MVC   @TS00001(95),NEWERID2(@14)                          0318 00616000
         MVC   OLDERID2(95,@14),@TS00001                           0318 00617000
*        NEWID2 = 'CKHS';                                          0319 00618000
*                                                                  0319 00619000
         MVC   NEWID2(4,@14),@CC00769                              0319 00620000
*        IF ADDR(OFILE) ^= NULLPTR                                 0320 00621000
*          THEN                                                    0320 00622000
         L     @14,@PC00001+4                                      0320 00623000
         L     @14,FDTPTR+4(,@14)                                  0320 00624000
         LTR   @14,@14                                             0320 00625000
         BZ    @RF00320                                            0320 00626000
*            DO;                                                   0321 00627000
*              OTARGLST = ZEROAREA;                                0322 00628000
         MVC   OTARGLST(48),ZEROAREA                               0322 00629000
*              OPNPTR = ADDR(OTARGLST);                            0323 00630000
         LA    OPNPTR,OTARGLST                                     0323 00631000
*              OPNOPTOT = ON;                                      0324 00632000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0324 00633000
*              OPNMODAC = ON;                                      0325 00634000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0325 00635000
*              OPNIOC = ADDR(OUTIOCP);                             0326 00636000
         LA    @09,OUTIOCP                                         0326 00637000
         ST    @09,OPNIOC(,OPNPTR)                                 0326 00638000
*              OPNDDN = ADDR(OFILEVAL);                            0327 00639000
*                                                                  0327 00640000
         LA    @14,OFILEVAL(,@14)                                  0327 00641000
         ST    @14,OPNDDN(,OPNPTR)                                 0327 00642000
*              CALL IDCIOOP0 (GDTTBL,                              0328 00643000
*                     OTARGLST);                                   0328 00644000
         ST    @15,@AL00001                                        0328 00645000
         LA    @02,OTARGLST                                        0328 00646000
         ST    @02,@AL00001+4                                      0328 00647000
         MVI   @AL00001+4,X'80'                                    0328 00648000
         L     @15,GDTOPN(,@15)                                    0328 00649000
         LA    @01,@AL00001                                        0328 00650000
         BALR  @14,@15                                             0328 00651000
*              RESPECIFY RTNREG RSTD;                              0329 00652000
*              TESTRC = RTNREG;                                    0330 00653000
         LR    TESTRC,RTNREG                                       0330 00654000
*              RESPECIFY RTNREG UNRSTD;                            0331 00655000
*              IF TESTRC ^= 0                                      0332 00656000
*                THEN                                              0332 00657000
*                                                                  0332 00658000
         SLR   @02,@02                                             0332 00659000
         CR    TESTRC,@02                                          0332 00660000
         BE    @RF00332                                            0332 00661000
*                  /**************************************************/ 00662000
*                  /*                                                */ 00663000
*                  /* IF OPEN FOR ALTERNATE OUTPUT FILE FAILS  THE   */ 00664000
*                  /* DEFAULT SYSPRINT IS USED                       */ 00665000
*                  /*                                                */ 00666000
*                  /**************************************************/ 00667000
*                                                                  0333 00668000
*                  DO;                                             0333 00669000
*                    OUTIOCP = PRTFILE;                            0334 00670000
         ST    @02,OUTIOCP                                         0334 00671000
*                    SETRC = MAX(SETRC,LASTCC04);                  0335 00672000
         LH    @15,SETRC                                           0335 00673000
         LA    @14,4                                               0335 00674000
         CR    @15,@14                                             0335 00675000
         BNL   *+6                                                      00676000
         LR    @15,@14                                             0335 00677000
         STH   @15,SETRC                                           0335 00678000
*                  END;                                            0336 00679000
*                ELSE;                                             0337 00680000
@RF00332 DS    0H                                                  0338 00681000
*            END;                                                  0338 00682000
*                                                                  0338 00683000
*          ELSE                                                    0339 00684000
*            OUTIOCP = PRTFILE;        /* USE AMS SYSPRINT FILE      */ 00685000
         B     @RC00320                                            0339 00686000
@RF00320 SLR   @15,@15                                             0339 00687000
         ST    @15,OUTIOCP                                         0339 00688000
*        /************************************************************/ 00689000
*        /*                                                          */ 00690000
*        /* SET UP OPEN ARGUMENT LIST FOR THE CHECKPOINT DATA SET    */ 00691000
*        /* USED FOR INPUT. IT IS SET UP FOR UNDEFINED RECORDS       */ 00692000
*        /* AND MAXIMUM BLOCKSIZE ONE LARGER THAN LENGTH OF CHR AND  */ 00693000
*        /* DSDRS. IF PREVIOUS OPEN FAILED,TERMINATE                 */ 00694000
*        /*                                                          */ 00695000
*        /************************************************************/ 00696000
*                                                                  0340 00697000
*        INIOCP = NULLPTR;                                         0340 00698000
@RC00320 SLR   @15,@15                                             0340 00699000
         ST    @15,INIOCP                                          0340 00700000
*        INARGLST = ZEROAREA;                                      0341 00701000
         MVC   INARGLST(48),ZEROAREA                               0341 00702000
*        OPNPTR = ADDR(INARGLST);                                  0342 00703000
         LA    OPNPTR,INARGLST                                     0342 00704000
*        OPNOPTIN = ON;                                            0343 00705000
*        OPNOPTBK = ON;                                            0344 00706000
         OI    OPNOPTIN(OPNPTR),B'10010000'                        0344 00707000
*        OPNRFMUN = ON;                                            0345 00708000
         OI    OPNRFMUN(OPNPTR),B'00100000'                        0345 00709000
*        OPNDSOPS = ON;                                            0346 00710000
         OI    OPNDSOPS(OPNPTR),B'01000000'                        0346 00711000
*        OPNIOC = ADDR(INIOCP);                                    0347 00712000
         LA    @15,INIOCP                                          0347 00713000
         ST    @15,OPNIOC(,OPNPTR)                                 0347 00714000
*        OPNDDN = ADDR(IFILEVAL);                                  0348 00715000
         L     @15,@PC00001+4                                      0348 00716000
         L     @01,FDTPTR(,@15)                                    0348 00717000
         LA    @15,IFILEVAL(,@01)                                  0348 00718000
         ST    @15,OPNDDN(,OPNPTR)                                 0348 00719000
*        OPNBLK = LENGTH(CHKPTREC) + 1; /*MAXIMUM BLOCK LENGTH PLUS 1*/ 00720000
*                                                                  0349 00721000
         MVC   OPNBLK(4,OPNPTR),@CF00895                           0349 00722000
*        CALL IDCIOOP0 (GDTTBL,                                    0350 00723000
*               INARGLST);                                         0350 00724000
         L     @02,@PC00001                                        0350 00725000
         ST    @02,@AL00001                                        0350 00726000
         LA    @15,INARGLST                                        0350 00727000
         ST    @15,@AL00001+4                                      0350 00728000
         MVI   @AL00001+4,X'80'                                    0350 00729000
         L     @15,GDTOPN(,@02)                                    0350 00730000
         LA    @01,@AL00001                                        0350 00731000
         BALR  @14,@15                                             0350 00732000
*        RESPECIFY RTNREG RSTD;                                    0351 00733000
*        TESTRC = RTNREG;                                          0352 00734000
         LR    TESTRC,RTNREG                                       0352 00735000
*        RESPECIFY RTNREG UNRSTD;                                  0353 00736000
*        IF TESTRC ^= 0                                            0354 00737000
*          THEN                                                    0354 00738000
         LTR   TESTRC,TESTRC                                       0354 00739000
         BZ    @RF00354                                            0354 00740000
*            RETURN CODE (LASTCC12);                               0355 00741000
         LA    @15,12                                              0355 00742000
         L     @14,@SA00002                                        0355 00743000
         LM    @00,@12,@SA00002+8                                  0355 00744000
         BR    @14                                                 0355 00745000
*          ELSE                                                    0356 00746000
*            DO;                                                   0356 00747000
@RF00354 DS    0H                                                  0357 00748000
*              IOCSPTR = INIOCP;                                   0357 00749000
         L     @15,INIOCP                                          0357 00750000
         ST    @15,IOCSPTR                                         0357 00751000
*              SUBDSNAM = IOCDSN->INFDSNAM;      /*SAVE DSNAME       */ 00752000
         L     @01,IOCDSN(,@15)                                    0358 00753000
         MVC   SUBDSNAM(44),INFDSNAM(@01)                          0358 00754000
*            END;                                                  0359 00755000
*        /************************************************************/ 00756000
*        /*                                                          */ 00757000
*        /* ESTABLISH SUBTITLE LINES BY READING THEM WITH UPRINT  AND*/ 00758000
*        /* INITIALIZE AMS TEXT PROCESSOR WITH UESTA. TERMINATE IF   */ 00759000
*        /* THERE IS PREVIOUS ERROR                                  */ 00760000
*        /************************************************************/ 00761000
*                                                                  0360 00762000
*        DARGSMOD = CK0ID;                                         0360 00763000
         L     @02,DDSTRU                                          0360 00764000
         MVC   DARGSMOD(3,@02),@CC00609                            0360 00765000
*        DARGSENT = CKST01;                                        0361 00766000
         MVI   DARGSENT(@02),X'01'                                 0361 00767000
*        DARGRETP = ADDR(SUBLNBUF);                                0362 00768000
         LA    @15,SUBLNBUF                                        0362 00769000
         ST    @15,DARGRETP(,@02)                                  0362 00770000
*        DARGRETL = LENGTH(SUBLNBUF);                              0363 00771000
*                                                                  0363 00772000
         MVC   DARGRETL(2,@02),@CH00896                            0363 00773000
*        /************************************************************/ 00774000
*        /*                                                          */ 00775000
*        /*       UPRINT TO GET HEADERS                USAVERC       */ 00776000
*        /*                                                          */ 00777000
*        /************************************************************/ 00778000
*                                                                  0364 00779000
*        CALL AMSTP011 (GDTTBL,                                    0364 00780000
*                OUTIOCP,                                          0364 00781000
*                DDSTRU);                                          0364 00782000
         L     @02,@PC00001                                        0364 00783000
         ST    @02,@AL00001                                        0364 00784000
         LA    @15,OUTIOCP                                         0364 00785000
         ST    @15,@AL00001+4                                      0364 00786000
         LA    @15,DDSTRU                                          0364 00787000
         ST    @15,@AL00001+8                                      0364 00788000
         MVI   @AL00001+8,X'80'                                    0364 00789000
         L     @15,GDTPRT(,@02)                                    0364 00790000
         LA    @01,@AL00001                                        0364 00791000
         BALR  @14,@15                                             0364 00792000
*        RESPECIFY RTNREG RSTD;                                    0365 00793000
*        TESTRC = RTNREG;                                          0366 00794000
         LR    TESTRC,RTNREG                                       0366 00795000
*        RESPECIFY RTNREG UNRSTD;                                  0367 00796000
*        SETRC = MAX(SETRC,TESTRC);                                0368 00797000
         LH    @02,SETRC                                           0368 00798000
         CR    @02,TESTRC                                          0368 00799000
         BNL   *+6                                                      00800000
         LR    @02,TESTRC                                          0368 00801000
         STH   @02,SETRC                                           0368 00802000
*        DARGLIST = ZEROAREA;          /*CLEAR DARGLIST              */ 00803000
*                                                                  0369 00804000
         L     @02,DDSTRU                                          0369 00805000
         MVC   DARGLIST(20,@02),ZEROAREA                           0369 00806000
*        /************************************************************/ 00807000
*        /*                                                          */ 00808000
*        /* SET UP PRINT CONTROL ARGUMENT LIST                       */ 00809000
*        /*                                                          */ 00810000
*        /************************************************************/ 00811000
*                                                                  0370 00812000
*        CARRC1 = 2;                   /* SET FIRST LINE CARR CNTL   */ 00813000
         MVI   CARRC1,X'02'                                        0370 00814000
*        SUBLNDS = SUBDSNAM;           /* MOVE IN DSNAME             */ 00815000
         MVC   SUBLNDS(44),SUBDSNAM                                0371 00816000
*        PCARG = ZEROAREA;                                         0372 00817000
         MVC   PCARG(33),ZEROAREA                                  0372 00818000
*        PCSTLP = ADDR(SUBLINES);                                  0373 00819000
         LA    @02,SUBLINES                                        0373 00820000
         ST    @02,PCSTLP                                          0373 00821000
*        PCSTLC = 2;                                               0374 00822000
*                                                                  0374 00823000
         MVC   PCSTLC(2),@CH00147                                  0374 00824000
*        /************************************************************/ 00825000
*        /*                                                          */ 00826000
*        /*       UESTA TO SET UP HEADERS              USAVERC       */ 00827000
*        /*                                                          */ 00828000
*        /************************************************************/ 00829000
*                                                                  0375 00830000
*        CALL AMSTP042 (GDTTBL,                                    0375 00831000
*               OUTIOCP,                                           0375 00832000
*               PCARG);                                            0375 00833000
         L     @02,@PC00001                                        0375 00834000
         ST    @02,@AL00001                                        0375 00835000
         LA    @15,OUTIOCP                                         0375 00836000
         ST    @15,@AL00001+4                                      0375 00837000
         LA    @15,PCARG                                           0375 00838000
         ST    @15,@AL00001+8                                      0375 00839000
         L     @15,GDTESA(,@02)                                    0375 00840000
         LA    @01,@AL00001                                        0375 00841000
         BALR  @14,@15                                             0375 00842000
*        RESPECIFY RTNREG RSTD;                                    0376 00843000
*        TESTRC = RTNREG;                                          0377 00844000
         LR    TESTRC,RTNREG                                       0377 00845000
*        RESPECIFY RTNREG UNRSTD;                                  0378 00846000
*        SETRC = MAX(SETRC,TESTRC);                                0379 00847000
*                                                                  0379 00848000
         LH    @02,SETRC                                           0379 00849000
         CR    @02,TESTRC                                          0379 00850000
         BNL   *+6                                                      00851000
         LR    @02,TESTRC                                          0379 00852000
         STH   @02,SETRC                                           0379 00853000
*        RETURN CODE (0);                                          0380 00854000
         SLR   @15,@15                                             0380 00855000
         L     @14,@SA00002                                        0380 00856000
         LM    @00,@12,@SA00002+8                                  0380 00857000
         BR    @14                                                 0380 00858000
*        END HSKGPROC;                                             0381 00859000
*        /************************************************************/ 00860000
*        /*                                                          */ 00861000
*        /* PROCEDURE - BUILDTAB (BDTABPTR,BDEOTPTR)                 */ 00862000
*        /*                                                          */ 00863000
*        /* FUNCTION - TO ACQUIRE SPACE FOR AND BUILD THE CHECKID    */ 00864000
*        /*            TABLE. WHEN CHECKIDS ARE NOT SPECIFIED, SPACE */ 00865000
*        /*            IS ACQUIRED FOR THE IDCOUNT AND IT IS SET     */ 00866000
*        /*            TO NEGATIVE ONE TO SHOW USER WANTS ALL IDS    */ 00867000
*        /*            PROCESSED.                                    */ 00868000
*        /*                                                          */ 00869000
*        /* INPUT - COMMAND STATEMENT DATA                           */ 00870000
*        /*                                                          */ 00871000
*        /* OUTPUT - CHECKID TABLE PTR AND CHECKID TABLE             */ 00872000
*        /*          THE IDCOUNT FIELD OF THE CHECKID TABLE IS SET   */ 00873000
*        /*          EQUAL TO CHKIDCNT IF CHECKID IS SPECIFIED OR TO */ 00874000
*        /*          -1 IF CHECKID IS NOT SPECIFIED                  */ 00875000
*        /*          IDCOUNT IS USED BY IDCCK01 TO CONTROL CHKLIST   */ 00876000
*        /*          PROCESSING                                      */ 00877000
*        /*                                                          */ 00878000
*        /************************************************************/ 00879000
*                                                                  0382 00880000
*BUILDTAB:                                                         0382 00881000
*        PROCEDURE (BDTABPTR,                                      0382 00882000
*                   BDEOTPTR);                                     0382 00883000
*                                                                  0382 00884000
BUILDTAB STM   @14,@12,@SA00003                                    0382 00885000
         MVC   @PC00003(8),0(@01)                                  0382 00886000
*        /************************************************************/ 00887000
*        /*                                                          */ 00888000
*        /* PARAMETERS THAT CAN BE MODIFIED                          */ 00889000
*        /*                                                          */ 00890000
*        /************************************************************/ 00891000
*                                                                  0383 00892000
*        DCL BDTABPTR  PTR(31);                  /*TABLE POINTER     */ 00893000
*        DCL BDEOTPTR  PTR(31);                  /*END OF TABLE PTR  */ 00894000
*        /************************************************************/ 00895000
*        /*                                                          */ 00896000
*        /* COMPUTE SPACE REQUIRED FOR THE CHECKID TABLE, AND BUILD  */ 00897000
*        /* THE TABLE. CHECK THE TABLE FOR DUPLICATE ENTRIES. IF AN  */ 00898000
*        /* ENTRY IS DUPLICATED, REMOVE THE DUPLICATE, AND ISSUE     */ 00899000
*        /* A MESSAGE. TERMINATE ON PREVIOUS ERROR CONDITION.        */ 00900000
*        /*                                                          */ 00901000
*        /************************************************************/ 00902000
*                                                                  0385 00903000
*        OLDERID2 = NEWERID2;                                      0385 00904000
         L     @15,@PC00001                                        0385 00905000
         L     @15,GDTTR2(,@15)                                    0385 00906000
         MVC   @TS00001(95),NEWERID2(@15)                          0385 00907000
         MVC   OLDERID2(95,@15),@TS00001                           0385 00908000
*        NEWID2 = 'CKBD';                                          0386 00909000
*                                                                  0386 00910000
         MVC   NEWID2(4,@15),@CC00777                              0386 00911000
*        IF ADDR(CHKID) ^= NULLPTR                                 0387 00912000
*          THEN                                                    0387 00913000
         L     @15,@PC00001+4                                      0387 00914000
         L     @15,FDTPTR+8(,@15)                                  0387 00915000
         LTR   @15,@15                                             0387 00916000
         BZ    @RF00387                                            0387 00917000
*            GPLEN = LENGTH(IDCOUNT) + LENGTH(IDTABLE) * CHKIDCNT; 0388 00918000
         LH    @15,CHKIDCNT(,@15)                                  0388 00919000
         MH    @15,@CH00893                                        0388 00920000
         AL    @15,@CF00147                                        0388 00921000
         ST    @15,GPLEN                                           0388 00922000
*          ELSE                                                    0389 00923000
*            GPLEN = LENGTH(IDCOUNT);                              0389 00924000
*                                                                  0389 00925000
         B     @RC00387                                            0389 00926000
@RF00387 MVC   GPLEN(4),@CF00147                                   0389 00927000
*        /************************************************************/ 00928000
*        /*                                                          */ 00929000
*        /*       UGPOOL FOR CHECKID TABLE            USAVERC        */ 00930000
*        /*                                                          */ 00931000
*        /************************************************************/ 00932000
*                                                                  0390 00933000
*        CALL IDCSAGP0 (GDTTBL,                                    0390 00934000
*                GPLEN,                                            0390 00935000
*                IDTABPTR,                                         0390 00936000
*                GPID00,                                           0390 00937000
*                SETZERO);                                         0390 00938000
@RC00387 L     @02,@PC00001                                        0390 00939000
         ST    @02,@AL00001                                        0390 00940000
         LA    @15,GPLEN                                           0390 00941000
         ST    @15,@AL00001+4                                      0390 00942000
         LA    @15,IDTABPTR                                        0390 00943000
         ST    @15,@AL00001+8                                      0390 00944000
         LA    @15,@CC00568                                        0390 00945000
         ST    @15,@AL00001+12                                     0390 00946000
         LA    @15,SETZERO                                         0390 00947000
         ST    @15,@AL00001+16                                     0390 00948000
         MVI   @AL00001+16,X'80'                                   0390 00949000
         L     @15,GDTGPL(,@02)                                    0390 00950000
         LA    @01,@AL00001                                        0390 00951000
         BALR  @14,@15                                             0390 00952000
*        RESPECIFY RTNREG RSTD;                                    0391 00953000
*        TESTRC = RTNREG;                                          0392 00954000
         LR    TESTRC,RTNREG                                       0392 00955000
*        RESPECIFY RTNREG UNRSTD;                                  0393 00956000
*        IF TESTRC ^= 0                                            0394 00957000
*          THEN                                                    0394 00958000
         LTR   TESTRC,TESTRC                                       0394 00959000
         BZ    @RF00394                                            0394 00960000
*            DO;                                                   0395 00961000
*                                                                  0395 00962000
*              /******************************************************/ 00963000
*              /*                                                    */ 00964000
*              /* PRINT INSUFFICIENT STORAGE MESSAGE AND             */ 00965000
*              /* TERMINATE  UPRINT                                  */ 00966000
*              /*                                                    */ 00967000
*              /******************************************************/ 00968000
*                                                                  0396 00969000
*                    DARGSMOD = UV0ID;                             0396 00970000
         L     @15,DDSTRU                                          0396 00971000
         MVC   DARGSMOD(3,@15),@CC00604                            0396 00972000
*                    DARGSENT = UVMSG04;                           0397 00973000
*                                                                  0397 00974000
         MVI   DARGSENT(@15),X'04'                                 0397 00975000
*              CALL AMSTP011 (GDTTBL,                              0398 00976000
*                      PRTFILE,                                    0398 00977000
*                      DDSTRU);                                    0398 00978000
*                                                                  0398 00979000
         L     @15,@PC00001                                        0398 00980000
         ST    @15,@AL00001                                        0398 00981000
         LA    @14,@CF00111                                        0398 00982000
         ST    @14,@AL00001+4                                      0398 00983000
         LA    @14,DDSTRU                                          0398 00984000
         ST    @14,@AL00001+8                                      0398 00985000
         MVI   @AL00001+8,X'80'                                    0398 00986000
         L     @15,GDTPRT(,@15)                                    0398 00987000
         LA    @01,@AL00001                                        0398 00988000
         BALR  @14,@15                                             0398 00989000
*              RETURN CODE (LASTCC12);                             0399 00990000
*                                                                  0399 00991000
         LA    @15,12                                              0399 00992000
         L     @14,@SA00003                                        0399 00993000
         LM    @00,@12,@SA00003+8                                  0399 00994000
         BR    @14                                                 0399 00995000
*            END;                                                  0400 00996000
*          ELSE                                                    0401 00997000
*            IDEOTPTR = IDTABPTR + GPLEN;   /*NOTE END OF TABLE      */ 00998000
@RF00394 L     @15,IDTABPTR                                        0401 00999000
         AL    @15,GPLEN                                           0401 01000000
         ST    @15,IDEOTPTR                                        0401 01001000
*        /************************************************************/ 01002000
*        /*                                                          */ 01003000
*        /* IF USER HAS SELECTED CHKIDS, BUILD CHECKID TABLE AND     */ 01004000
*        /* CHECK FOR DUPLICATES.                                    */ 01005000
*        /*                                                          */ 01006000
*        /************************************************************/ 01007000
*                                                                  0402 01008000
*        IF ADDR(CHKID) ^= NULLPTR                                 0402 01009000
*          THEN                                                    0402 01010000
         L     @15,@PC00001+4                                      0402 01011000
         L     @15,FDTPTR+8(,@15)                                  0402 01012000
         LTR   @15,@15                                             0402 01013000
         BZ    @RF00402                                            0402 01014000
*BLDTAB:     DO;                                                   0403 01015000
BLDTAB   DS    0H                                                  0404 01016000
*              IDCOUNT = CHKIDCNT;                                 0404 01017000
         L     @03,IDTABPTR                                        0404 01018000
         L     @15,@PC00001+4                                      0404 01019000
         L     @01,FDTPTR+8(,@15)                                  0404 01020000
         LH    @15,CHKIDCNT(,@01)                                  0404 01021000
         STH   @15,IDCOUNT(,@03)                                   0404 01022000
*              IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);              0405 01023000
*                                                                  0405 01024000
         AL    @03,@CF00147                                        0405 01025000
         LR    IDTABWKP,@03                                        0405 01026000
*              /******************************************************/ 01027000
*              /*                                                    */ 01028000
*              /* BUILD THE TABLE                                    */ 01029000
*              /*                                                    */ 01030000
*              /******************************************************/ 01031000
*                                                                  0406 01032000
*              DO I = 1 TO IDCOUNT;                                0406 01033000
         LA    I,1                                                 0406 01034000
         B     @DE00406                                            0406 01035000
@DL00406 DS    0H                                                  0407 01036000
*                IDFOUND = NO;                                     0407 01037000
         NI    IDFOUND(IDTABWKP),B'01111111'                       0407 01038000
*                IDCHKID = CHKIDVAL(I);                            0408 01039000
         LR    @05,I                                               0408 01040000
         MH    @05,@CH00897                                        0408 01041000
         L     @03,@PC00001+4                                      0408 01042000
         L     @03,FDTPTR+8(,@03)                                  0408 01043000
         ALR   @03,@05                                             0408 01044000
         AL    @03,@CF00905                                        0408 01045000
         MVC   IDCHKID(16,IDTABWKP),CHKIDVAL-3(@03)                0408 01046000
*                IDTABWKP = IDTABWKP + LENGTH(IDTABLE);            0409 01047000
         AL    IDTABWKP,@CF00893                                   0409 01048000
*              END;                                                0410 01049000
*                                                                  0410 01050000
         AL    I,@CF00213                                          0410 01051000
@DE00406 L     @05,IDTABPTR                                        0410 01052000
         CH    I,IDCOUNT(,@05)                                     0410 01053000
         BNH   @DL00406                                            0410 01054000
*              /******************************************************/ 01055000
*              /*                                                    */ 01056000
*              /* LOOK FOR DUPLICATE ENTRIES, REMOVE THE DUPLICATE   */ 01057000
*              /* FROM THE TABLE, LEAVING THE FIRST FOUND IN THE     */ 01058000
*              /* TABLE, AND ISSUE MESSAGE WITH UPRINT               */ 01059000
*              /*                                                    */ 01060000
*              /******************************************************/ 01061000
*                                                                  0411 01062000
*              IF IDCOUNT > 1                                      0411 01063000
*                THEN                  /*CHK FOR DUPS FOR IDCOUNT > 1*/ 01064000
         L     @01,IDTABPTR                                        0411 01065000
         LH    @15,IDCOUNT(,@01)                                   0411 01066000
         C     @15,@CF00213                                        0411 01067000
         BNH   @RF00411                                            0411 01068000
*CHKDUPS:          DO;                                             0412 01069000
CHKDUPS  DS    0H                                                  0413 01070000
*                    IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);        0413 01071000
*                                                                  0413 01072000
         LA    IDTABWKP,2                                          0413 01073000
         AL    IDTABWKP,IDTABPTR                                   0413 01074000
*                    /************************************************/ 01075000
*                    /*                                              */ 01076000
*                    /* LOOK FOR DUPLICATES BY MATCHING EACH TABLE   */ 01077000
*                    /* ENTRY AGAINST EACH SUBSEQUENT TABLE ENTRY    */ 01078000
*                    /*                                              */ 01079000
*                    /************************************************/ 01080000
*                                                                  0414 01081000
*CHKTAB1:            DO I = 1 TO IDCOUNT - 1;                      0414 01082000
CHKTAB1  LA    I,1                                                 0414 01083000
         B     @DE00414                                            0414 01084000
@DL00414 DS    0H                                                  0415 01085000
*                      IF IDFOUND = NO                             0415 01086000
*                        THEN                                      0415 01087000
         TM    IDFOUND(IDTABWKP),B'10000000'                       0415 01088000
         BNZ   @RF00415                                            0415 01089000
*                          DO;                                     0416 01090000
*                            IDNXTPTR = IDTABWKP + LENGTH(IDTABLE);     01091000
*                                                                  0417 01092000
         LA    IDNXTPTR,17                                         0417 01093000
         ALR   IDNXTPTR,IDTABWKP                                   0417 01094000
*                            /****************************************/ 01095000
*                            /*                                      */ 01096000
*                            /* MATCH ENTRY AGAINST EACH FOLLOWING   */ 01097000
*                            /* TABLE ENTRY                          */ 01098000
*                            /*                                      */ 01099000
*                            /****************************************/ 01100000
*                                                                  0418 01101000
*CHKTAB2:                    DO J = I TO IDCOUNT - 1;              0418 01102000
CHKTAB2  LR    J,I                                                 0418 01103000
         B     @DE00418                                            0418 01104000
@DL00418 DS    0H                                                  0419 01105000
*                              IF IDNXTPTR->IDFOUND ^= YES         0419 01106000
*                                THEN                              0419 01107000
         TM    IDFOUND(IDNXTPTR),B'10000000'                       0419 01108000
         BO    @RF00419                                            0419 01109000
*                                  IF IDCHKID = IDNXTPTR->IDCHKID  0420 01110000
*                                    THEN                          0420 01111000
*                                                                  0420 01112000
         CLC   IDCHKID(16,IDTABWKP),IDCHKID(IDNXTPTR)              0420 01113000
         BNE   @RF00420                                            0420 01114000
*                                      /******************************/ 01115000
*                                      /*                            */ 01116000
*                                      /*     * MARK ENTRY AS FOUND  */ 01117000
*                                      /*       AND PRINT WITH UPRINT*/ 01118000
*                                      /*                            */ 01119000
*                                      /******************************/ 01120000
*                                                                  0421 01121000
*                                      DO;                         0421 01122000
*                                        IDNXTPTR->IDFOUND = YES;  0422 01123000
         OI    IDFOUND(IDNXTPTR),B'10000000'                       0422 01124000
*                                        DARGSMOD = CK0ID;         0423 01125000
         L     @07,DDSTRU                                          0423 01126000
         MVC   DARGSMOD(3,@07),@CC00609                            0423 01127000
*                                        DARGSENT = CKST07;        0424 01128000
         MVI   DARGSENT(@07),X'07'                                 0424 01129000
*                                        DARGDBP = ADDR(IDCHKID);  0425 01130000
         LA    @15,IDCHKID(,IDTABWKP)                              0425 01131000
         ST    @15,DARGDBP(,@07)                                   0425 01132000
*                                        DARGILP = LENGTH(IDCHKID);     01133000
*                                                                  0426 01134000
         MVC   DARGILP(2,@07),@CH00465                             0426 01135000
*                                        CALL AMSTP011 (GDTTBL,    0427 01136000
*                                                OUTIOCP,          0427 01137000
*                                                DDSTRU);          0427 01138000
         L     @07,@PC00001                                        0427 01139000
         ST    @07,@AL00001                                        0427 01140000
         LA    @15,OUTIOCP                                         0427 01141000
         ST    @15,@AL00001+4                                      0427 01142000
         LA    @15,DDSTRU                                          0427 01143000
         ST    @15,@AL00001+8                                      0427 01144000
         MVI   @AL00001+8,X'80'                                    0427 01145000
         L     @15,GDTPRT(,@07)                                    0427 01146000
         LA    @01,@AL00001                                        0427 01147000
         BALR  @14,@15                                             0427 01148000
*                                        RESPECIFY RTNREG RSTD;    0428 01149000
*                                        TESTRC = RTNREG;          0429 01150000
         LR    TESTRC,RTNREG                                       0429 01151000
*                                        RESPECIFY RTNREG UNRSTD;  0430 01152000
*                                        SETRC = MAX(SETRC,TESTRC);     01153000
*                                                                  0431 01154000
         LH    @07,SETRC                                           0431 01155000
         CR    @07,TESTRC                                          0431 01156000
         BNL   *+6                                                      01157000
         LR    @07,TESTRC                                          0431 01158000
         STH   @07,SETRC                                           0431 01159000
*                                      END;                        0432 01160000
*                                    ELSE;                         0433 01161000
@RF00420 DS    0H                                                  0434 01162000
*                                ELSE;                             0434 01163000
*                                                                  0434 01164000
@RF00419 DS    0H                                                  0435 01165000
*                              IDNXTPTR = IDNXTPTR + LENGTH(IDTABLE);   01166000
*                                                                  0435 01167000
         AL    IDNXTPTR,@CF00893                                   0435 01168000
*                            END CHKTAB2;        /* END INNER LOOP   */ 01169000
*                                                                  0436 01170000
         AL    J,@CF00213                                          0436 01171000
@DE00418 L     @07,IDTABPTR                                        0436 01172000
         LH    @07,IDCOUNT(,@07)                                   0436 01173000
         BCTR  @07,0                                               0436 01174000
         CR    J,@07                                               0436 01175000
         BNH   @DL00418                                            0436 01176000
*                          END;                                    0437 01177000
*                        ELSE;                                     0438 01178000
*                                                                  0438 01179000
@RF00415 DS    0H                                                  0439 01180000
*                      IDTABWKP = IDTABWKP + LENGTH(IDTABLE);      0439 01181000
*                                                                  0439 01182000
         AL    IDTABWKP,@CF00893                                   0439 01183000
*                    END CHKTAB1;                /* END OUTER LOOP   */ 01184000
*                                                                  0440 01185000
         AL    I,@CF00213                                          0440 01186000
@DE00414 L     @05,IDTABPTR                                        0440 01187000
         LH    @05,IDCOUNT(,@05)                                   0440 01188000
         BCTR  @05,0                                               0440 01189000
         CR    I,@05                                               0440 01190000
         BNH   @DL00414                                            0440 01191000
*                  END CHKDUPS;                                    0441 01192000
*                                                                  0441 01193000
*                ELSE;                 /*BYPASS DUP CHK FOR IDCOUNT=1*/ 01194000
*                                                                  0442 01195000
@RF00411 DS    0H                                                  0443 01196000
*            END BLDTAB;                                           0443 01197000
*                                                                  0443 01198000
*          /**********************************************************/ 01199000
*          /*                                                        */ 01200000
*          /* WHEN NO CHECKIDS ARE SPECIFIED, IDCOUNT IS SET TO -1   */ 01201000
*          /*                                                        */ 01202000
*          /**********************************************************/ 01203000
*                                                                  0444 01204000
*          ELSE                                                    0444 01205000
*            IDCOUNT = -1;                                         0444 01206000
*                                                                  0444 01207000
         B     @RC00402                                            0444 01208000
@RF00402 L     @01,IDTABPTR                                        0444 01209000
         MVC   IDCOUNT(2,@01),@CH00786                             0444 01210000
*        RETURN CODE (0);                                          0445 01211000
@RC00402 SLR   @15,@15                                             0445 01212000
         L     @14,@SA00003                                        0445 01213000
         LM    @00,@12,@SA00003+8                                  0445 01214000
         BR    @14                                                 0445 01215000
*        END BUILDTAB;                                             0446 01216000
*        /************************************************************/ 01217000
*        /*                                                          */ 01218000
*        /* PROCEDURE - CHRPROC (CPSYSID,CPNEEDCH,CPCHRFND,CPEOF)    */ 01219000
*        /*                                                          */ 01220000
*        /* FUNCTION - TO PROCESS THE USER-SELECTED                  */ 01221000
*        /*            CHR RECORDS FROM THE CHECKPOINT DATA SET. IF  */ 01222000
*        /*            IDCOUNT IS NEGATIVE, ALL CHRS ARE CONSIDERED  */ 01223000
*        /*            AS USER-SELECTED.                             */ 01224000
*        /*                                                          */ 01225000
*        /* INPUT - CHECKID TABLE                                    */ 01226000
*        /*                                                          */ 01227000
*        /* OUTPUT - CHRSYSID (VS1 OR VS2)                           */ 01228000
*        /*          IDCOUNT IS DECREASED BY 1 WHEN USER-SELECTED    */ 01229000
*        /*              CHR IS FOUND                                */ 01230000
*        /*          CPEOF (EOF) IS SET TO 1 WHEN END OF FILE OCCURS */ 01231000
*        /*          CHECKPOINT IDENTIFIER DETAIL LINE               */ 01232000
*        /*                                                          */ 01233000
*        /************************************************************/ 01234000
*                                                                  0447 01235000
*CHRPROC:                                                          0447 01236000
*        PROCEDURE (CPSYSID,                                       0447 01237000
*                   CPNEEDCH,                                      0447 01238000
*                   CPCHRFND,                                      0447 01239000
*                   CPEOF);                                        0447 01240000
*                                                                  0447 01241000
CHRPROC  STM   @14,@02,@SA00004                                    0447 01242000
         STM   @04,@12,@SA00004+20                                 0447 01243000
         MVC   @PC00004(16),0(@01)                                 0447 01244000
*        /************************************************************/ 01245000
*        /*                                                          */ 01246000
*        /* PARAMETERS THAT CAN BE MODIFIED                          */ 01247000
*        /*                                                          */ 01248000
*        /************************************************************/ 01249000
*                                                                  0448 01250000
*        DCL CPSYSID   CHAR(1);                                    0448 01251000
*              /* CPSYSID (SYSID) IDENTIFIES THE SYSTEM ON WHICH THE */ 01252000
*              /*    CHECKPOINT WAS TAKEN                            */ 01253000
*        DCL CPNEEDCH  BIT(1)  BDY(BYTE);                          0449 01254000
*              /* CPNEEDCH (NEEDCHR) INDICATES WHETHER A CHR IS      */ 01255000
*              /*    ALREADY IN THE BUFFER OR A READ IS NEEDED       */ 01256000
*        DCL CPCHRFND  BIT(1)  BDY(BYTE);                          0450 01257000
*              /* CPCHRFND (CHRFND) IS TURNED ON WHEN A CHR IS FOUND */ 01258000
*        DCL CPEOF     FIXED(15);                                  0451 01259000
*              /* CPEOF (EOF) END OF FILE CONTROL VARIABLE           */ 01260000
*                                                                  0452 01261000
*        /************************************************************/ 01262000
*        /*                                                          */ 01263000
*        /* LOCAL VARIABLE                                           */ 01264000
*        /*                                                          */ 01265000
*        /************************************************************/ 01266000
*                                                                  0452 01267000
*        DCL USERSPEC  BIT(1) BDY(BYTE);                           0452 01268000
*        /************************************************************/ 01269000
*        /*                                                          */ 01270000
*        /* SET UP CONTROL SWITCH AND CHECKID TABLE WORK PTR         */ 01271000
*        /*                                                          */ 01272000
*        /************************************************************/ 01273000
*                                                                  0453 01274000
*        OLDERID2 = NEWERID2;                                      0453 01275000
         L     @02,@PC00001                                        0453 01276000
         L     @02,GDTTR2(,@02)                                    0453 01277000
         MVC   @TS00001(95),NEWERID2(@02)                          0453 01278000
         MVC   OLDERID2(95,@02),@TS00001                           0453 01279000
*        NEWID2 = 'CKCP';                                          0454 01280000
*                                                                  0454 01281000
         MVC   NEWID2(4,@02),@CC00799                              0454 01282000
*        USERSPEC = NO;                                            0455 01283000
         NI    USERSPEC,B'01111111'                                0455 01284000
*        /************************************************************/ 01285000
*        /*                                                          */ 01286000
*        /* LOOK FOR USER SPECIFIED CHR UNTIL ONE IS FOUND OR        */ 01287000
*        /* END OF FILE OCCURS.                                      */ 01288000
*        /*                                                          */ 01289000
*        /************************************************************/ 01290000
*                                                                  0456 01291000
*CHRPRC: DO WHILE (USERSPEC = NO & CPEOF = 0);                     0456 01292000
*                                                                  0456 01293000
CHRPRC   B     @DE00456                                            0456 01294000
@DL00456 DS    0H                                                  0457 01295000
*          /**********************************************************/ 01296000
*          /*                                                        */ 01297000
*          /* BYPASS READ IF CHR IS IN THE BUFFER, AND RESET         */ 01298000
*          /* CPNEEDCH. CPCHRFND IS SET TO YES SINCE INDEED ONE      */ 01299000
*          /* WAS FOUND.                                             */ 01300000
*          /*                                                        */ 01301000
*          /**********************************************************/ 01302000
*                                                                  0457 01303000
*          IF CPNEEDCH = YES                                       0457 01304000
*            THEN                                                  0457 01305000
         L     @02,@PC00004+4                                      0457 01306000
         TM    CPNEEDCH(@02),B'10000000'                           0457 01307000
         BNO   @RF00457                                            0457 01308000
*              CALL GETCHR (CPCHRFND,                              0458 01309000
*                           CPEOF);                                0458 01310000
         L     @02,@PC00004+8                                      0458 01311000
         ST    @02,@AL00001                                        0458 01312000
         L     @02,@PC00004+12                                     0458 01313000
         ST    @02,@AL00001+4                                      0458 01314000
         LA    @01,@AL00001                                        0458 01315000
         BAL   @14,GETCHR                                          0458 01316000
*            ELSE                                                  0459 01317000
*              DO;                /* SET SWITCHES                    */ 01318000
         B     @RC00457                                            0459 01319000
@RF00457 DS    0H                                                  0460 01320000
*                CPNEEDCH = YES;                                   0460 01321000
         L     @02,@PC00004+4                                      0460 01322000
         OI    CPNEEDCH(@02),B'10000000'                           0460 01323000
*                CPCHRFND = YES;                                   0461 01324000
         L     @02,@PC00004+8                                      0461 01325000
         OI    CPCHRFND(@02),B'10000000'                           0461 01326000
*              END;                                                0462 01327000
*                                                                  0462 01328000
*          IF CPEOF = 0                                            0463 01329000
*            THEN                                                  0463 01330000
*                                                                  0463 01331000
@RC00457 L     @02,@PC00004+12                                     0463 01332000
         LH    @02,CPEOF(,@02)                                     0463 01333000
         LTR   @02,@02                                             0463 01334000
         BNZ   @RF00463                                            0463 01335000
*DOCHRPC:     DO;                                                  0464 01336000
*                                                                  0464 01337000
DOCHRPC  DS    0H                                                  0465 01338000
*              IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);              0465 01339000
         L     @15,IDTABPTR                                        0465 01340000
         LA    IDTABWKP,2                                          0465 01341000
         ALR   IDTABWKP,@15                                        0465 01342000
*              IF IDCOUNT < 0          /* USER SELECTS ALL CHECKIDS  */ 01343000
*                THEN                                              0466 01344000
         LH    @15,IDCOUNT(,@15)                                   0466 01345000
         LTR   @15,@15                                             0466 01346000
         BNM   @RF00466                                            0466 01347000
*                  USERSPEC = YES;                                 0467 01348000
         OI    USERSPEC,B'10000000'                                0467 01349000
*                ELSE                                              0468 01350000
*                                                                  0468 01351000
*                  /**************************************************/ 01352000
*                  /*                                                */ 01353000
*                  /* SEARCH THE CHECKID TABLE FOR A MATCHING ENTRY  */ 01354000
*                  /* TO THE CHECKID OF THE CHR. SET USERSPEC = YES  */ 01355000
*                  /* IF A MATCH IS FOUND.                           */ 01356000
*                  /*                                                */ 01357000
*                  /**************************************************/ 01358000
*                                                                  0468 01359000
*CHKTAB:           DO WHILE (USERSPEC = NO & IDTABWKP < IDEOTPTR); 0468 01360000
         B     @RC00466                                            0468 01361000
@RF00466 DS    0H                                                  0468 01362000
CHKTAB   B     @DE00468                                            0468 01363000
@DL00468 DS    0H                                                  0469 01364000
*                    IF IDCHKID = CHRCHKID                         0469 01365000
*                      THEN                                        0469 01366000
*                                                                  0469 01367000
         L     @01,IOCSPTR                                         0469 01368000
         L     @15,IOCDAD(,@01)                                    0469 01369000
         CLC   IDCHKID(16,IDTABWKP),CHRCHKID(@15)                  0469 01370000
         BNE   @RF00469                                            0469 01371000
*                        DO;                                       0470 01372000
*                          USERSPEC = YES;                         0471 01373000
         OI    USERSPEC,B'10000000'                                0471 01374000
*                          IF IDFOUND = YES                        0472 01375000
*                            THEN                                  0472 01376000
*                                                                  0472 01377000
         TM    IDFOUND(IDTABWKP),B'10000000'                       0472 01378000
         BNO   @RF00472                                            0472 01379000
*                              DO;     /*PRINT DUPLICATE CHKPT ENTRY */ 01380000
*                                DARGSMOD = CK0ID;                 0474 01381000
         L     @14,DDSTRU                                          0474 01382000
         MVC   DARGSMOD(3,@14),@CC00609                            0474 01383000
*                                DARGSENT = CKST08;                0475 01384000
         MVI   DARGSENT(@14),X'08'                                 0475 01385000
*                                DARGDBP  = ADDR(CHRCHKID);        0476 01386000
         LA    @15,CHRCHKID(,@15)                                  0476 01387000
         ST    @15,DARGDBP(,@14)                                   0476 01388000
*                                DARGILP  = LENGTH(CHRCHKID);      0477 01389000
*                                                                  0477 01390000
         MVC   DARGILP(2,@14),@CH00465                             0477 01391000
*                                CALL AMSTP011 (GDTTBL,            0478 01392000
*                                        PRTFILE,                  0478 01393000
*                                        DDSTRU);                  0478 01394000
         L     @15,@PC00001                                        0478 01395000
         ST    @15,@AL00001                                        0478 01396000
         LA    @14,@CF00111                                        0478 01397000
         ST    @14,@AL00001+4                                      0478 01398000
         LA    @14,DDSTRU                                          0478 01399000
         ST    @14,@AL00001+8                                      0478 01400000
         MVI   @AL00001+8,X'80'                                    0478 01401000
         L     @15,GDTPRT(,@15)                                    0478 01402000
         LA    @01,@AL00001                                        0478 01403000
         BALR  @14,@15                                             0478 01404000
*                                RESPECIFY RTNREG RSTD;            0479 01405000
*                                TESTRC = RTNREG;                  0480 01406000
         LR    TESTRC,RTNREG                                       0480 01407000
*                                RESPECIFY RTNREG UNRSTD;          0481 01408000
*                                SETRC = MAX(SETRC,TESTRC);        0482 01409000
         LH    @15,SETRC                                           0482 01410000
         CR    @15,TESTRC                                          0482 01411000
         BNL   *+6                                                      01412000
         LR    @15,TESTRC                                          0482 01413000
         STH   @15,SETRC                                           0482 01414000
*                                DARGLIST = ZEROAREA;              0483 01415000
         L     @01,DDSTRU                                          0483 01416000
         MVC   DARGLIST(20,@01),ZEROAREA                           0483 01417000
*                              END;                                0484 01418000
*                                                                  0484 01419000
*                            ELSE                                  0485 01420000
*                              DO;     /*MARK TABLE ENTRY AS FOUND   */ 01421000
         B     @RC00472                                            0485 01422000
@RF00472 DS    0H                                                  0486 01423000
*                                IDFOUND = YES;                    0486 01424000
         OI    IDFOUND(IDTABWKP),B'10000000'                       0486 01425000
*                                IDCOUNT = IDCOUNT - 1;            0487 01426000
         L     @15,IDTABPTR                                        0487 01427000
         LH    @14,IDCOUNT(,@15)                                   0487 01428000
         BCTR  @14,0                                               0487 01429000
         STH   @14,IDCOUNT(,@15)                                   0487 01430000
*                              END;                                0488 01431000
*                        END;                                      0489 01432000
*                      ELSE;                                       0490 01433000
*                                                                  0490 01434000
@RF00469 DS    0H                                                  0491 01435000
*                    IDTABWKP = IDTABWKP + LENGTH(IDTABLE);        0491 01436000
*                                                                  0491 01437000
@RC00469 AL    IDTABWKP,@CF00893                                   0491 01438000
*                  END CHKTAB;                                     0492 01439000
@DE00468 TM    USERSPEC,B'10000000'                                0492 01440000
         BNZ   @DC00468                                            0492 01441000
         C     IDTABWKP,IDEOTPTR                                   0492 01442000
         BL    @DL00468                                            0492 01443000
@DC00468 DS    0H                                                  0493 01444000
*              /******************************************************/ 01445000
*              /*                                                    */ 01446000
*              /* IF THIS CHR IS TO BE PROCESSED, LIST THE CHECKED   */ 01447000
*              /* AND EXTRACT THE SYSTEM ID FROM THE CHR             */ 01448000
*              /*                                                    */ 01449000
*              /******************************************************/ 01450000
*                                                                  0493 01451000
*              IF USERSPEC = YES                                   0493 01452000
*                THEN                                              0493 01453000
@RC00466 TM    USERSPEC,B'10000000'                                0493 01454000
         BNO   @RF00493                                            0493 01455000
*                  DO;                                             0494 01456000
*                                                                  0494 01457000
*                    CPSYSID = CHRSYSID;    /*EXTRACT SYSID          */ 01458000
*                                                                  0495 01459000
         L     @02,@PC00004                                        0495 01460000
         L     @01,IOCSPTR                                         0495 01461000
         L     @15,IOCDAD(,@01)                                    0495 01462000
         MVC   CPSYSID(1,@02),CHRSYSID(@15)                        0495 01463000
*                    DARGSMOD = CK0ID;      /* PRINT CHECKID         */ 01464000
         L     @02,DDSTRU                                          0496 01465000
         MVC   DARGSMOD(3,@02),@CC00609                            0496 01466000
*                    DARGSENT = CKST02;                            0497 01467000
         MVI   DARGSENT(@02),X'02'                                 0497 01468000
*                    DARGDBP  = ADDR(CHRCHKID);                    0498 01469000
         LA    @15,CHRCHKID(,@15)                                  0498 01470000
         ST    @15,DARGDBP(,@02)                                   0498 01471000
*                    DARGILP  = LENGTH(CHRCHKID);                  0499 01472000
*                                                                  0499 01473000
         MVC   DARGILP(2,@02),@CH00465                             0499 01474000
*                    CALL AMSTP011 (GDTTBL,                        0500 01475000
*                            OUTIOCP,                              0500 01476000
*                            DDSTRU);                              0500 01477000
         L     @02,@PC00001                                        0500 01478000
         ST    @02,@AL00001                                        0500 01479000
         LA    @15,OUTIOCP                                         0500 01480000
         ST    @15,@AL00001+4                                      0500 01481000
         LA    @15,DDSTRU                                          0500 01482000
         ST    @15,@AL00001+8                                      0500 01483000
         MVI   @AL00001+8,X'80'                                    0500 01484000
         L     @15,GDTPRT(,@02)                                    0500 01485000
         LA    @01,@AL00001                                        0500 01486000
         BALR  @14,@15                                             0500 01487000
*                    RESPECIFY RTNREG RSTD;                        0501 01488000
*                    TESTRC = RTNREG;                              0502 01489000
         LR    TESTRC,RTNREG                                       0502 01490000
*                    RESPECIFY RTNREG UNRSTD;                      0503 01491000
*                    SETRC = MAX(SETRC,TESTRC);                    0504 01492000
         LH    @02,SETRC                                           0504 01493000
         CR    @02,TESTRC                                          0504 01494000
         BNL   *+6                                                      01495000
         LR    @02,TESTRC                                          0504 01496000
         STH   @02,SETRC                                           0504 01497000
*                    DARGLIST = ZEROAREA;                          0505 01498000
*                                                                  0505 01499000
         L     @02,DDSTRU                                          0505 01500000
         MVC   DARGLIST(20,@02),ZEROAREA                           0505 01501000
*                  END;                                            0506 01502000
*                ELSE;                                             0507 01503000
*                                                                  0507 01504000
@RF00493 DS    0H                                                  0508 01505000
*             END DOCHRPC;                                         0508 01506000
*                                                                  0508 01507000
*            ELSE;             /*PAIRS 'THEN' AT 'DOCHRPC'           */ 01508000
*                                                                  0509 01509000
@RF00463 DS    0H                                                  0510 01510000
*        END CHRPRC;                                               0510 01511000
*                                                                  0510 01512000
@DE00456 TM    USERSPEC,B'10000000'                                0510 01513000
         BNZ   @DC00456                                            0510 01514000
         L     @02,@PC00004+12                                     0510 01515000
         LH    @02,CPEOF(,@02)                                     0510 01516000
         LTR   @02,@02                                             0510 01517000
         BZ    @DL00456                                            0510 01518000
@DC00456 DS    0H                                                  0511 01519000
*        RETURN CODE (0);                                          0511 01520000
         SLR   @15,@15                                             0511 01521000
         L     @14,@SA00004                                        0511 01522000
         LM    @00,@02,@SA00004+8                                  0511 01523000
         LM    @04,@12,@SA00004+20                                 0511 01524000
         BR    @14                                                 0511 01525000
*        END CHRPROC;                                              0512 01526000
*        /************************************************************/ 01527000
*        /*                                                          */ 01528000
*        /* PROCEDURE - GETCHR (GCCHRFND,GCEOF)                      */ 01529000
*        /*                                                          */ 01530000
*        /* FUNCTION - TO READ THE CHECKPOINT DATA SET UNTIL A       */ 01531000
*        /*            CHR IS FOUND OR END-OF-FILE OCCURS            */ 01532000
*        /*                                                          */ 01533000
*        /* INPUT - CHECKPOINT DATA SET                              */ 01534000
*        /*                                                          */ 01535000
*        /* OUTPUT - POINTER TO CHR RECORD (IN IOCSTR)               */ 01536000
*        /*          GCCHRFND (CHRFND) INDICATOR THAT CHR FOUND      */ 01537000
*        /*          GCEOF (EOF) END OF FILE INDICATOR               */ 01538000
*        /*                                                          */ 01539000
*        /************************************************************/ 01540000
*                                                                  0513 01541000
*GETCHR:                                                           0513 01542000
*        PROCEDURE (GCCHRFND,                                      0513 01543000
*                   GCEOF);                                        0513 01544000
*                                                                  0513 01545000
GETCHR   STM   @14,@02,@SA00005                                    0513 01546000
         STM   @04,@12,@SA00005+20                                 0513 01547000
         MVC   @PC00005(8),0(@01)                                  0513 01548000
*        /************************************************************/ 01549000
*        /*                                                          */ 01550000
*        /* PARAMETERS THAT CAN BE MODIFIED                          */ 01551000
*        /*                                                          */ 01552000
*        /************************************************************/ 01553000
*                                                                  0514 01554000
*        DCL GCCHRFND  BIT(1) BDY(BYTE);                           0514 01555000
*              /* GCCHRFND (CHRFND) IS TURNED ON WHEN A CHR IS FOUND */ 01556000
*        DCL GCEOF     FIXED(15);                                  0515 01557000
*              /* GCEOF (EOF) IS SET TO 1 AT END OF FILE             */ 01558000
*                                                                  0516 01559000
*        /************************************************************/ 01560000
*        /*                                                          */ 01561000
*        /* LOCAL VARIABLES                                          */ 01562000
*        /*                                                          */ 01563000
*        /************************************************************/ 01564000
*                                                                  0516 01565000
*        DCL GCSTOP    BIT(1) BDY(BYTE);    /*READ CONTROL SWITCH    */ 01566000
*        /************************************************************/ 01567000
*        /*                                                          */ 01568000
*        /* INITIALIZE CONTROL SWITCH                                */ 01569000
*        /*                                                          */ 01570000
*        /************************************************************/ 01571000
*                                                                  0517 01572000
*        OLDERID2 = NEWERID2;                                      0517 01573000
         L     @02,@PC00001                                        0517 01574000
         L     @02,GDTTR2(,@02)                                    0517 01575000
         MVC   @TS00001(95),NEWERID2(@02)                          0517 01576000
         MVC   OLDERID2(95,@02),@TS00001                           0517 01577000
*        NEWID2 = 'CKGC';                                          0518 01578000
*                                                                  0518 01579000
         MVC   NEWID2(4,@02),@CC00815                              0518 01580000
*        GCSTOP = NO;                                              0519 01581000
*                                                                  0519 01582000
         NI    GCSTOP,B'01111111'                                  0519 01583000
*        /************************************************************/ 01584000
*        /*                                                          */ 01585000
*        /* READ CHECKPOINT DATASET UNTIL A CHR IS FOUND OR          */ 01586000
*        /* END OF FILE OCCURS                                       */ 01587000
*        /*                                                          */ 01588000
*        /************************************************************/ 01589000
*                                                                  0520 01590000
*GETCH:  DO WHILE (GCSTOP = NO & GCEOF = 0);                       0520 01591000
*                                                                  0520 01592000
GETCH    B     @DE00520                                            0520 01593000
@DL00520 DS    0H                                                  0521 01594000
*          /**********************************************************/ 01595000
*          /*                                                        */ 01596000
*          /* READ CHECKPOINT DATA SET                               */ 01597000
*          /*                                                        */ 01598000
*          /**********************************************************/ 01599000
*                                                                  0521 01600000
*          IOCDLN = LENGTH(CHKPTREC) + 1;                          0521 01601000
*                                                                  0521 01602000
         L     @02,IOCSPTR                                         0521 01603000
         MVC   IOCDLN(4,@02),@CF00895                              0521 01604000
*          CALL IDCIOGT0 (GDTTBL,                                  0522 01605000
*                INIOCP);                                          0522 01606000
         L     @02,@PC00001                                        0522 01607000
         ST    @02,@AL00001                                        0522 01608000
         LA    @15,INIOCP                                          0522 01609000
         ST    @15,@AL00001+4                                      0522 01610000
         MVI   @AL00001+4,X'80'                                    0522 01611000
         L     @15,GDTGET(,@02)                                    0522 01612000
         LA    @01,@AL00001                                        0522 01613000
         BALR  @14,@15                                             0522 01614000
*          RESPECIFY RTNREG RSTD;                                  0523 01615000
*          TESTRC = RTNREG;                                        0524 01616000
         LR    TESTRC,RTNREG                                       0524 01617000
*          RESPECIFY RTNREG UNRSTD;                                0525 01618000
*                                                                  0525 01619000
*          IF TESTRC = 4                                           0526 01620000
*            THEN                                                  0526 01621000
         C     TESTRC,@CF00041                                     0526 01622000
         BNE   @RF00526                                            0526 01623000
*              DO;                     /*ON I/O ERROR SET EOF COND   */ 01624000
*                GCEOF = EOFCOND;                                  0528 01625000
         L     @02,@PC00005+4                                      0528 01626000
         MVC   GCEOF(2,@02),@CH00213                               0528 01627000
*                RETURN CODE (LASTCC12);                           0529 01628000
         LA    @15,12                                              0529 01629000
         L     @14,@SA00005                                        0529 01630000
         LM    @00,@02,@SA00005+8                                  0529 01631000
         LM    @04,@12,@SA00005+20                                 0529 01632000
         BR    @14                                                 0529 01633000
*              END;                                                0530 01634000
*            ELSE;                                                 0531 01635000
*                                                                  0531 01636000
@RF00526 DS    0H                                                  0532 01637000
*          IF TESTRC = 16              /*CHECK FOR END OF FILE       */ 01638000
*            THEN                                                  0532 01639000
         C     TESTRC,@CF00465                                     0532 01640000
         BNE   @RF00532                                            0532 01641000
*              GCEOF = EOFCOND;        /*SET EOFCOND AND DROP TO END */ 01642000
         L     @02,@PC00005+4                                      0533 01643000
         MVC   GCEOF(2,@02),@CH00213                               0533 01644000
*                                      /*OF THIS LOOP                */ 01645000
*            ELSE                                                  0534 01646000
*                                                                  0534 01647000
*              /******************************************************/ 01648000
*              /*                                                    */ 01649000
*              /* THE RECORD IS A CHR IF IT HAS THE FOLLOWING ID:    */ 01650000
*              /* '$$/%@/$ CHR %@/$//%' AND IS 400 BYTES LONG        */ 01651000
*              /*                                                    */ 01652000
*              /******************************************************/ 01653000
*                                                                  0534 01654000
*              IF IOCDLN   = LENGTH(CHR)  &                        0534 01655000
*                 CHRIDENT = CHRID                                 0534 01656000
*                THEN                                              0534 01657000
*                                                                  0534 01658000
         B     @RC00532                                            0534 01659000
@RF00532 L     @02,IOCSPTR                                         0534 01660000
         CLC   IOCDLN(4,@02),@CF00894                              0534 01661000
         BNE   @RF00534                                            0534 01662000
         L     @02,IOCDAD(,@02)                                    0534 01663000
         CLC   CHRIDENT(19,@02),@CC00644                           0534 01664000
         BNE   @RF00534                                            0534 01665000
*                  DO;                                             0535 01666000
*                    GCCHRFND = YES;   /*NOTE THAT DATA SET HAD A CHR*/ 01667000
         L     @02,@PC00005                                        0536 01668000
         OI    GCCHRFND(@02),B'10000000'                           0536 01669000
*                    GCSTOP   = YES;   /*STOP THE LOOP               */ 01670000
         OI    GCSTOP,B'10000000'                                  0537 01671000
*                  END;                                            0538 01672000
*                                                                  0538 01673000
*                ELSE;                                             0539 01674000
@RF00534 DS    0H                                                  0540 01675000
*        END GETCH;                                                0540 01676000
*                                                                  0540 01677000
@RC00532 DS    0H                                                  0540 01678000
@DE00520 TM    GCSTOP,B'10000000'                                  0540 01679000
         BNZ   @DC00520                                            0540 01680000
         L     @02,@PC00005+4                                      0540 01681000
         LH    @02,GCEOF(,@02)                                     0540 01682000
         LTR   @02,@02                                             0540 01683000
         BZ    @DL00520                                            0540 01684000
@DC00520 DS    0H                                                  0541 01685000
*        RETURN CODE (0);                                          0541 01686000
         SLR   @15,@15                                             0541 01687000
         L     @14,@SA00005                                        0541 01688000
         LM    @00,@02,@SA00005+8                                  0541 01689000
         LM    @04,@12,@SA00005+20                                 0541 01690000
         BR    @14                                                 0541 01691000
*        END GETCHR;                                               0542 01692000
*        /************************************************************/ 01693000
*        /*                                                          */ 01694000
*        /* PROCEDURE - DSDRPROC (DPNEEDCH,DPEOF)                    */ 01695000
*        /*                                                          */ 01696000
*        /* FUNCTION - TO PREPARE AND PRINT INFORMATION REGARDING    */ 01697000
*        /*            OPEN TAPE DATA SETS FOR THE CURRENT CHECKPOINT*/ 01698000
*        /*            ENTRY.                                        */ 01699000
*        /*                                                          */ 01700000
*        /*            INVOKES - GETNEXT     FOR NEXT LOGICAL RECORD */ 01701000
*        /*                      DSDRVOLS    WHEN ADDITIONAL VOLUMES */ 01702000
*        /*                                  ARE PRESENT             */ 01703000
*        /*                      DSDRLIST    TO LIST VOLUMES         */ 01704000
*        /*                                                          */ 01705000
*        /* INPUT - THE SYSID                                        */ 01706000
*        /*         CHECKPOINT DATA SET                              */ 01707000
*        /*                                                          */ 01708000
*        /* OUTPUT - TAPE DATA SET DETAIL LINE                       */ 01709000
*        /*          VOLUME INFO DETAIL LINES                        */ 01710000
*        /*              DETAIL LINES APPEAR ON OUTPUT PRINT FILE    */ 01711000
*        /*          NEEDCHR CONTROL INFO                            */ 01712000
*        /*          DPEOF (EOF) END OF FILE INDICATOR               */ 01713000
*        /*                                                          */ 01714000
*        /************************************************************/ 01715000
*                                                                  0543 01716000
*DSDRPROC:                                                         0543 01717000
*        PROCEDURE (DPNEEDCH,                                      0543 01718000
*                   DPEOF);                                        0543 01719000
*                                                                  0543 01720000
DSDRPROC STM   @14,@12,@SA00006                                    0543 01721000
         MVC   @PC00006(8),0(@01)                                  0543 01722000
*        /************************************************************/ 01723000
*        /*                                                          */ 01724000
*        /* PARAMETERS THAT CAN BE MODIFIED                          */ 01725000
*        /*                                                          */ 01726000
*        /************************************************************/ 01727000
*                                                                  0544 01728000
*        DCL DPNEEDCH  BIT(1) BDY(BYTE);    /*NEEDCHR SWITCH         */ 01729000
*        DCL DPEOF     FIXED(15);           /*END-OF-FILE VARIABLE   */ 01730000
*                                                                  0545 01731000
*        /************************************************************/ 01732000
*        /*                                                          */ 01733000
*        /* LOCAL VARIABLES                                          */ 01734000
*        /*                                                          */ 01735000
*        /************************************************************/ 01736000
*                                                                  0546 01737000
*        DCL LOGRECP   PTR(31);             /*LOGICAL RECORD POINTER */ 01738000
*        DCL SIZE      FIXED(31);           /*SIZE OF LAST RECORD    */ 01739000
*        DCL DSDR1LNG  FIXED(31);           /*LENGTH OF DSDR-1       */ 01740000
*        DCL DSDR1FND  BIT(1) BDY(BYTE);    /*SW FOR TAPE DSDR FOUND */ 01741000
*        DCL VLSQMSG   BIT(1) BDY(BYTE);    /*SW FOR VOLSEQ ERR MSG  */ 01742000
*        DCL GETNXTSW  BIT(1) BDY(BYTE);    /*SW FOR GET NXT LOGREC  */ 01743000
*        DCL NVOLS     FIXED(15);           /*NUMBER OF VOLUMES      */ 01744000
*        DCL VOLSEQ    FIXED(15);           /*VOLUME SEQUENCE NUMBER */ 01745000
*        /************************************************************/ 01746000
*        /*                                                          */ 01747000
*        /* INITIALIZE DSDR1LNG FOR VS1 OR VS2 AND CONTROL VARIABLES */ 01748000
*        /*                                                          */ 01749000
*        /************************************************************/ 01750000
*                                                                  0554 01751000
*        OLDERID2 = NEWERID2;                                      0554 01752000
         L     @02,@PC00001                                        0554 01753000
         L     @02,GDTTR2(,@02)                                    0554 01754000
         MVC   @TS00001(95),NEWERID2(@02)                          0554 01755000
         MVC   OLDERID2(95,@02),@TS00001                           0554 01756000
*        NEWID2 = 'CKDP';                                          0555 01757000
*                                                                  0555 01758000
         MVC   NEWID2(4,@02),@CC00833                              0555 01759000
*        IF SYSIDVS1 = '1'B                                        0556 01760000
*          THEN                                                    0556 01761000
         TM    SYSIDVS1,B'00100000'                                0556 01762000
         BNO   @RF00556                                            0556 01763000
*            DSDR1LNG = VS1DSDR1;                                  0557 01764000
         LA    DSDR1LNG,191                                        0557 01765000
*          ELSE                                                    0558 01766000
*            DSDR1LNG = VS2DSDR1;                                  0558 01767000
*                                                                  0558 01768000
         B     @RC00556                                            0558 01769000
@RF00556 LA    DSDR1LNG,195                                        0558 01770000
*        SIZE = 0;                                                 0559 01771000
@RC00556 SLR   @04,@04                                             0559 01772000
         ST    @04,SIZE                                            0559 01773000
*        LOGRECP = NULLPTR;                                        0560 01774000
         ST    @04,LOGRECP                                         0560 01775000
*        DSDR1FND = NO;                                            0561 01776000
         NI    DSDR1FND,B'01111111'                                0561 01777000
*        GETNXTSW = YES;                                           0562 01778000
*                                                                  0562 01779000
         OI    GETNXTSW,B'10000000'                                0562 01780000
*        /************************************************************/ 01781000
*        /*                                                          */ 01782000
*        /* PROCESS DSDR RECORDS UNTIL END OF FILE OR END OF ENTRY   */ 01783000
*        /*                                                          */ 01784000
*        /************************************************************/ 01785000
*                                                                  0563 01786000
*START:  DO WHILE (DPEOF = 0);                                     0563 01787000
*                                                                  0563 01788000
START    B     @DE00563                                            0563 01789000
@DL00563 DS    0H                                                  0564 01790000
*          /**********************************************************/ 01791000
*          /*                                                         * 01792000
*          /* GETNXTSW IS SET TO NO BY DSDRVOLS WHEN A DSDR2 IS      */ 01793000
*          /* EXPECTED BUT NOT FOUND. IT PREVENTS BYPASSING A GOOD   */ 01794000
*          /* CHECKPOINT DATA SET RECORD ALREADY IN A BUFFER         */ 01795000
*          /*                                                        */ 01796000
*          /**********************************************************/ 01797000
*                                                                  0564 01798000
*          IF GETNXTSW = YES                                       0564 01799000
*            THEN                                                  0564 01800000
         TM    GETNXTSW,B'10000000'                                0564 01801000
         BNO   @RF00564                                            0564 01802000
*              DO;                                                 0565 01803000
*                CALL GETNEXT (LOGRECP,                            0566 01804000
*                              SIZE,                               0566 01805000
*                              DPNEEDCH,                           0566 01806000
*                              DPEOF);                             0566 01807000
         LA    @04,LOGRECP                                         0566 01808000
         ST    @04,@AL00001                                        0566 01809000
         LA    @04,SIZE                                            0566 01810000
         ST    @04,@AL00001+4                                      0566 01811000
         L     @04,@PC00006                                        0566 01812000
         ST    @04,@AL00001+8                                      0566 01813000
         L     @04,@PC00006+4                                      0566 01814000
         ST    @04,@AL00001+12                                     0566 01815000
         LA    @01,@AL00001                                        0566 01816000
         BAL   @14,GETNEXT                                         0566 01817000
*                RESPECIFY RTNREG RSTD;                            0567 01818000
*                TESTRC = RTNREG;                                  0568 01819000
         LR    TESTRC,RTNREG                                       0568 01820000
*                RESPECIFY RTNREG UNRSTD;                          0569 01821000
*                SETRC = MAX(SETRC,TESTRC);                        0570 01822000
         LH    @04,SETRC                                           0570 01823000
         CR    @04,TESTRC                                          0570 01824000
         BNL   *+6                                                      01825000
         LR    @04,TESTRC                                          0570 01826000
         STH   @04,SETRC                                           0570 01827000
*              END;                                                0571 01828000
*            ELSE                                                  0572 01829000
*              GETNXTSW = YES;                                     0572 01830000
*                                                                  0572 01831000
         B     @RC00564                                            0572 01832000
@RF00564 OI    GETNXTSW,B'10000000'                                0572 01833000
*          /**********************************************************/ 01834000
*          /*                                                        */ 01835000
*          /*  IF NEXT LOGICAL RECORD IS AVAILABLE (NEITHER END OF   */ 01836000
*          /*  FILE OR END OF ENTRY OCCURED) PROCEDE.                */ 01837000
*          /* IN THE SEARCH FOR DSDR1 RECORDS, DDNT BLOCKS (VS2 ONLY)*/ 01838000
*          /* ARE BYPASSED, AND NEW BLOCKS ARE READ WHEN EITHER THE  */ 01839000
*          /* END-OF-BLOCK OR END-OF-DSDRS IS FOUND. TYPE 3 DSDR     */ 01840000
*          /* RECORDS OR NON-DSDR RECORDS WILL TRIGGER END-OF-ENTRY. */ 01841000
*          /*                                                        */ 01842000
*          /**********************************************************/ 01843000
*          IF DPEOF = 0                                            0573 01844000
*            THEN                                                  0573 01845000
*                                                                  0573 01846000
@RC00564 L     @04,@PC00006+4                                      0573 01847000
         LH    @04,DPEOF(,@04)                                     0573 01848000
         LTR   @04,@04                                             0573 01849000
         BNZ   @RF00573                                            0573 01850000
*NOEOF:        DO;                                                 0574 01851000
*                                                                  0574 01852000
NOEOF    DS    0H                                                  0575 01853000
*                IF GDTDBG = NULLPTR                               0575 01854000
*                  THEN;                                           0575 01855000
         L     @04,@PC00001                                        0575 01856000
         L     @04,GDTDBG(,@04)                                    0575 01857000
         LTR   @04,@04                                             0575 01858000
         BZ    @RT00575                                            0575 01859000
*                  ELSE                                            0577 01860000
*                    CALL IDCDB010 (GDTTBL,'CK30');                0577 01861000
*                                                                  0577 01862000
         L     @04,@PC00001                                        0577 01863000
         ST    @04,@AL00001                                        0577 01864000
         LA    @02,@CC00839                                        0577 01865000
         ST    @02,@AL00001+4                                      0577 01866000
         MVI   @AL00001+4,X'80'                                    0577 01867000
         L     @15,GDTDBG(,@04)                                    0577 01868000
         LA    @01,@AL00001                                        0577 01869000
         BALR  @14,@15                                             0577 01870000
*                DSDR1PTR = LOGRECP;        /*GET ADDRESSABILITY     */ 01871000
@RT00575 L     DSDR1PTR,LOGRECP                                    0578 01872000
*                IF DSDRTYPE ^= DSDR1                              0579 01873000
*                  THEN                                            0579 01874000
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00673                       0579 01875000
         BE    @RF00579                                            0579 01876000
*                    DO;                                           0580 01877000
*                      IF DSDRTYPE = DSDREOB |                     0581 01878000
*                         DSDRTYPE = DDNT    |                     0581 01879000
*                         DSDRTYPE = DSDREND                       0581 01880000
*                        THEN                    /*END OF BLOCK-GET  */ 01881000
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00677                       0581 01882000
         BE    @RT00581                                            0581 01883000
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00671                       0581 01884000
         BE    @RT00581                                            0581 01885000
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00679                       0581 01886000
         BNE   @RF00581                                            0581 01887000
@RT00581 DS    0H                                                  0582 01888000
*                          LOGRECP = NULLPTR;    /*NEXT BLOCK        */ 01889000
         SLR   @04,@04                                             0582 01890000
         ST    @04,LOGRECP                                         0582 01891000
*                        ELSE                                      0583 01892000
*                          IF DSDRTYPE = DSDR2                     0583 01893000
*                            THEN                                  0583 01894000
         B     @RC00581                                            0583 01895000
@RF00581 CLC   DSDRTYPE(2,DSDR1PTR),@CB00675                       0583 01896000
         BNE   @RF00583                                            0583 01897000
*                              SIZE = LENGTH(DSDR2REC);            0584 01898000
         MVC   SIZE(4),@CF00718                                    0584 01899000
*                            ELSE                                  0585 01900000
*                              DO;                                 0585 01901000
         B     @RC00583                                            0585 01902000
@RF00583 DS    0H                                                  0586 01903000
*                                DPEOF = EOECOND;                  0586 01904000
         L     @04,@PC00006+4                                      0586 01905000
         MVC   DPEOF(2,@04),@CH00147                               0586 01906000
*                                LOGRECP = NULLPTR;                0587 01907000
         SLR   @04,@04                                             0587 01908000
         ST    @04,LOGRECP                                         0587 01909000
*                              END;                                0588 01910000
*                    END;                                          0589 01911000
*                                                                  0589 01912000
*                  ELSE                                            0590 01913000
*                                                                  0590 01914000
*                    /************************************************/ 01915000
*                    /*                                              */ 01916000
*                    /* TYPE 1 DSDR PROCESSING:                      */ 01917000
*                    /*    EXTRACT DSNAME, DDNAME, UNIT TYPE, NUMBER */ 01918000
*                    /*    OF TRACKS, VOLUME SEQUENCE NUMBER, AND    */ 01919000
*                    /*    THE FIRST FIVE VOLUME SERIAL NUMBERS FROM */ 01920000
*                    /*    THE DSDR1.  IF A DSDR2 (JFCBX) IS NEEDED  */ 01921000
*                    /*    CALL DSDRVOLS FOR REQUIRED PROCESSING.    */ 01922000
*                    /*                                              */ 01923000
*                    /************************************************/ 01924000
*                                                                  0590 01925000
*DSDR1PC:            DO;                                           0590 01926000
         B     @RC00579                                            0590 01927000
@RF00579 DS    0H                                                  0590 01928000
DSDR1PC  DS    0H                                                  0591 01929000
*                      SIZE = DSDR1LNG;                            0591 01930000
         ST    DSDR1LNG,SIZE                                       0591 01931000
*                      IF UCBTBYT3 = TAPECODE                      0592 01932000
*                        THEN                                      0592 01933000
         CLI   UCBTBYT3(DSDR1PTR),X'80'                            0592 01934000
         BNE   @RF00592                                            0592 01935000
*DSDR1TP:                  DO;         /*FOR TAPE DSDR1 PROCESS INFO */ 01936000
*                                                                  0593 01937000
DSDR1TP  DS    0H                                                  0594 01938000
*                            IF GDTDBG = NULLPTR                   0594 01939000
*                              THEN;                               0594 01940000
         L     @04,@PC00001                                        0594 01941000
         L     @04,GDTDBG(,@04)                                    0594 01942000
         LTR   @04,@04                                             0594 01943000
         BZ    @RT00594                                            0594 01944000
*                              ELSE                                0596 01945000
*                                CALL IDCDB010 (GDTTBL,'CK40');    0596 01946000
*                                                                  0596 01947000
         L     @04,@PC00001                                        0596 01948000
         ST    @04,@AL00001                                        0596 01949000
         LA    @03,@CC00844                                        0596 01950000
         ST    @03,@AL00001+4                                      0596 01951000
         MVI   @AL00001+4,X'80'                                    0596 01952000
         L     @15,GDTDBG(,@04)                                    0596 01953000
         LA    @01,@AL00001                                        0596 01954000
         BALR  @14,@15                                             0596 01955000
*                            /****************************************/ 01956000
*                            /*                                      */ 01957000
*                            /* EXTRACT DATA SET INFO AND LIST. SAVE */ 01958000
*                            /* DDNAME FOR POSSIBLE ERROR MSGS       */ 01959000
*                            /*                                      */ 01960000
*                            /****************************************/ 01961000
*                                                                  0597 01962000
*                            DSDR1FND = YES;                       0597 01963000
@RT00594 OI    DSDR1FND,B'10000000'                                0597 01964000
*                            TDSNAME = JFCBDSNM;                   0598 01965000
         MVC   TDSNAME(44),JFCBDSNM(DSDR1PTR)                      0598 01966000
*                            TDDNAME = DSDRDDNM;                   0599 01967000
         MVC   TDDNAME(8),DSDRDDNM(DSDR1PTR)                       0599 01968000
*                            MSGDDNAM = DSDRDDNM;                  0600 01969000
         MVC   MSGDDNAM(8),DSDRDDNM(DSDR1PTR)                      0600 01970000
*                            IF UCBTBYT4 = U2400 /* DECODE UNIT TYPE */ 01971000
*                              THEN                                0601 01972000
         CLI   UCBTBYT4(DSDR1PTR),X'01'                            0601 01973000
         BNE   @RF00601                                            0601 01974000
*                                TUNIT = T2400;                    0602 01975000
         MVC   TUNIT(4),@CC00661                                   0602 01976000
*                              ELSE                                0603 01977000
*                                IF UCBTBYT4 = U3400               0603 01978000
*                                  THEN                            0603 01979000
         B     @RC00601                                            0603 01980000
@RF00601 CLI   UCBTBYT4(DSDR1PTR),X'03'                            0603 01981000
         BNE   @RF00603                                            0603 01982000
*                                    TUNIT = T3400;                0604 01983000
         MVC   TUNIT(4),@CC00663                                   0604 01984000
*                                 ELSE                             0605 01985000
*                                    TUNIT = FILLER;  /*UNKNOWN UNIT */ 01986000
         B     @RC00603                                            0605 01987000
@RF00603 MVC   TUNIT(4),@CC00665                                   0605 01988000
*                            IF UCB7TRK = '1'B                     0606 01989000
*                              THEN                                0606 01990000
@RC00603 DS    0H                                                  0606 01991000
@RC00601 TM    UCB7TRK(DSDR1PTR),B'10000000'                       0606 01992000
         BNO   @RF00606                                            0606 01993000
*                                TTRK = STRK;    /* 7 TRK            */ 01994000
         MVC   TTRK(5),@CC00659                                    0607 01995000
*                              ELSE                                0608 01996000
*                                TTRK = NTRK;    /* 9 TRK            */ 01997000
*                                                                  0608 01998000
         B     @RC00606                                            0608 01999000
@RF00606 MVC   TTRK(5),@CC00657                                    0608 02000000
*                            IF SYSIDVS1 = '1'B  /*GET VOLSEQ        */ 02001000
*                              THEN                                0609 02002000
@RC00606 TM    SYSIDVS1,B'00100000'                                0609 02003000
         BNO   @RF00609                                            0609 02004000
*                                DO;                               0610 02005000
*                                  TVLSQ = VS1DVLSQ;               0611 02006000
         SLR   @04,@04                                             0611 02007000
         IC    @04,VS1DVLSQ(,DSDR1PTR)                             0611 02008000
         STC   @04,TVLSQ                                           0611 02009000
*                                  VOLSEQ = VS1DVLSQ;              0612 02010000
         STH   @04,VOLSEQ                                          0612 02011000
*                                END;                              0613 02012000
*                              ELSE                                0614 02013000
*                                DO;                               0614 02014000
         B     @RC00609                                            0614 02015000
@RF00609 DS    0H                                                  0615 02016000
*                                  TVLSQ = VS2DVLSQ;               0615 02017000
         SLR   @04,@04                                             0615 02018000
         IC    @04,VS2DVLSQ(,DSDR1PTR)                             0615 02019000
         STC   @04,TVLSQ                                           0615 02020000
*                                  VOLSEQ = VS2DVLSQ;              0616 02021000
         STH   @04,VOLSEQ                                          0616 02022000
*                                END;                              0617 02023000
*                                                                  0617 02024000
*                            NVOLS = JFCBNVOL;   /*GET NUM OF VOLUMES*/ 02025000
@RC00609 SLR   @04,@04                                             0618 02026000
         IC    @04,JFCBNVOL(,DSDR1PTR)                             0618 02027000
         STH   @04,NVOLS                                           0618 02028000
*                            TNVOL = JFCBNVOL;                     0619 02029000
         STC   @04,TNVOL                                           0619 02030000
*                            IF NVOLS < VOLSEQ                     0620 02031000
*                              THEN                                0620 02032000
         CH    @04,VOLSEQ                                          0620 02033000
         BNL   @RF00620                                            0620 02034000
*                                VLSQMSG = YES;  /*SET SW FOR ERR MSG*/ 02035000
         OI    VLSQMSG,B'10000000'                                 0621 02036000
*                              ELSE                                0622 02037000
*                                VLSQMSG = NO;                     0622 02038000
         B     @RC00620                                            0622 02039000
@RF00620 NI    VLSQMSG,B'01111111'                                 0622 02040000
*                            /****************************************/ 02041000
*                            /*                                      */ 02042000
*                            /* PRINT DATA SET INFO                  */ 02043000
*                            /*                                      */ 02044000
*                            /****************************************/ 02045000
*                                                                  0623 02046000
*                            DARGSMOD = CK0ID;                     0623 02047000
@RC00620 L     @04,DDSTRU                                          0623 02048000
         MVC   DARGSMOD(3,@04),@CC00609                            0623 02049000
*                            DARGSENT = CKST03;                    0624 02050000
         MVI   DARGSENT(@04),X'03'                                 0624 02051000
*                            DARGDBP  = ADDR(TDSINFO);             0625 02052000
         LA    @15,TDSINFO                                         0625 02053000
         ST    @15,DARGDBP(,@04)                                   0625 02054000
*                            DARGILP  = LENGTH(TDSINFO);           0626 02055000
*                                                                  0626 02056000
         MVC   DARGILP(2,@04),@CH00898                             0626 02057000
*                            CALL AMSTP011 (GDTTBL,                0627 02058000
*                                    OUTIOCP,                      0627 02059000
*                                    DDSTRU);                      0627 02060000
         L     @04,@PC00001                                        0627 02061000
         ST    @04,@AL00001                                        0627 02062000
         LA    @15,OUTIOCP                                         0627 02063000
         ST    @15,@AL00001+4                                      0627 02064000
         LA    @15,DDSTRU                                          0627 02065000
         ST    @15,@AL00001+8                                      0627 02066000
         MVI   @AL00001+8,X'80'                                    0627 02067000
         L     @15,GDTPRT(,@04)                                    0627 02068000
         LA    @01,@AL00001                                        0627 02069000
         BALR  @14,@15                                             0627 02070000
*                            RESPECIFY RTNREG RSTD;                0628 02071000
*                            TESTRC = RTNREG;                      0629 02072000
         LR    TESTRC,RTNREG                                       0629 02073000
*                            RESPECIFY RTNREG UNRSTD;              0630 02074000
*                            SETRC = MAX(SETRC,TESTRC);            0631 02075000
*                                                                  0631 02076000
         LH    @04,SETRC                                           0631 02077000
         CR    @04,TESTRC                                          0631 02078000
         BNL   *+6                                                      02079000
         LR    @04,TESTRC                                          0631 02080000
         STH   @04,SETRC                                           0631 02081000
*                            /****************************************/ 02082000
*                            /*                                      */ 02083000
*                            /* EXTRACT VOLUME INFO FROM DSDR1 AND   */ 02084000
*                            /* PRINT THE 5 (MAX) VOLUMES FROM THE   */ 02085000
*                            /* DSDR1                                */ 02086000
*                            /* WHEN NO VOLUMES ARE IN THE JFCB THE  */ 02087000
*                            /* PRINT BLOCK IS BYPASSED. NO VOLUMES  */ 02088000
*                            /* IS INDICATED BY '00'X OR 'FF'X IN THE*/ 02089000
*                            /* JFCB.                                */ 02090000
*                            /*                                      */ 02091000
*                            /****************************************/ 02092000
*                                                                  0632 02093000
*                            IF NVOLS     > 0     &   /*BYPASS NO VOL*/ 02094000
*                               JVOLBYT1(1) ^= '00'X &             0632 02095000
*                               JVOLBYT1(1) ^= 'FF'X               0632 02096000
*                              THEN                                0632 02097000
*                                                                  0632 02098000
         LH    @04,NVOLS                                           0632 02099000
         LTR   @04,@04                                             0632 02100000
         BNP   @RF00632                                            0632 02101000
         CLI   JVOLBYT1(DSDR1PTR),X'00'                            0632 02102000
         BE    @RF00632                                            0632 02103000
         CLI   JVOLBYT1(DSDR1PTR),X'FF'                            0632 02104000
         BE    @RF00632                                            0632 02105000
*GETVOLS:                        DO;                               0633 02106000
GETVOLS  DS    0H                                                  0634 02107000
*                                  TVOLINFO = BLANKS;              0634 02108000
         MVC   TVOLINFO(35),BLANKS                                 0634 02109000
*                                  DO I = 1 TO PVOLLIM             0635 02110000
*                                           WHILE(NVOLS > 0);      0635 02111000
         LA    I,1                                                 0635 02112000
@DL00635 LH    @03,NVOLS                                           0635 02113000
         LTR   @03,@03                                             0635 02114000
         BNP   @DC00635                                            0635 02115000
*                                    TVOL(I) = JFCBVOL(I);         0636 02116000
         LR    @15,I                                               0636 02117000
         MH    @15,@CH00617                                        0636 02118000
         LA    @14,TVOL-7(@15)                                     0636 02119000
         LR    @15,I                                               0636 02120000
         MH    @15,@CH00150                                        0636 02121000
         ALR   @15,DSDR1PTR                                        0636 02122000
         MVC   0(6,@14),JFCBVOL-6(@15)                             0636 02123000
*                                    NVOLS = NVOLS - 1;            0637 02124000
         BCTR  @03,0                                               0637 02125000
         STH   @03,NVOLS                                           0637 02126000
*                                  END;                            0638 02127000
*                                                                  0638 02128000
         AL    I,@CF00213                                          0638 02129000
         C     I,@CF00266                                          0638 02130000
         BNH   @DL00635                                            0638 02131000
@DC00635 DS    0H                                                  0639 02132000
*                                  CALL DSDRLIST (VOLSEQ);         0639 02133000
*                                                                  0639 02134000
         LA    @04,VOLSEQ                                          0639 02135000
         ST    @04,@AL00001                                        0639 02136000
         LA    @01,@AL00001                                        0639 02137000
         BAL   @14,DSDRLIST                                        0639 02138000
*                                  /**********************************/ 02139000
*                                  /*                                */ 02140000
*                                  /* IF REMAINING VOLUME ARE TO BE  */ 02141000
*                                  /* PRINTED AND A DSDR2 EXISTS,    */ 02142000
*                                  /* THEN PROCESS THE ADDITIONAL    */ 02143000
*                                  /* VOLUMES                        */ 02144000
*                                  /*                                */ 02145000
*                                  /**********************************/ 02146000
*                                                                  0640 02147000
*                                  IF NVOLS     > 0 &              0640 02148000
*                                     JFCBEXAD ^= 0                0640 02149000
*                                    THEN                          0640 02150000
         LH    @04,NVOLS                                           0640 02151000
         LTR   @04,@04                                             0640 02152000
         BNP   @RF00640                                            0640 02153000
         ICM   @04,7,JFCBEXAD(DSDR1PTR)                            0640 02154000
         BZ    @RF00640                                            0640 02155000
*                                     DO;                          0641 02156000
*                                                                  0641 02157000
*                                      /******************************/ 02158000
*                                      /*                            */ 02159000
*                                      /* CALL DSDRVOLS TO HANDLE THE*/ 02160000
*                                      /* DSDR2 RECORDS              */ 02161000
*                                      /*                            */ 02162000
*                                      /******************************/ 02163000
*                                                                  0642 02164000
*                                      CALL DSDRVOLS (NVOLS,       0642 02165000
*                                                     VOLSEQ,      0642 02166000
*                                                     SIZE,        0642 02167000
*                                                     LOGRECP,     0642 02168000
*                                                     DPNEEDCH,    0642 02169000
*                                                     GETNXTSW,    0642 02170000
*                                                     DPEOF);      0642 02171000
         LA    @04,NVOLS                                           0642 02172000
         ST    @04,@AL00001                                        0642 02173000
         LA    @04,VOLSEQ                                          0642 02174000
         ST    @04,@AL00001+4                                      0642 02175000
         LA    @04,SIZE                                            0642 02176000
         ST    @04,@AL00001+8                                      0642 02177000
         LA    @04,LOGRECP                                         0642 02178000
         ST    @04,@AL00001+12                                     0642 02179000
         L     @04,@PC00006                                        0642 02180000
         ST    @04,@AL00001+16                                     0642 02181000
         LA    @04,GETNXTSW                                        0642 02182000
         ST    @04,@AL00001+20                                     0642 02183000
         L     @04,@PC00006+4                                      0642 02184000
         ST    @04,@AL00001+24                                     0642 02185000
         LA    @01,@AL00001                                        0642 02186000
         BAL   @14,DSDRVOLS                                        0642 02187000
*                                      RESPECIFY RTNREG RSTD;      0643 02188000
*                                      TESTRC = RTNREG;            0644 02189000
         LR    TESTRC,RTNREG                                       0644 02190000
*                                      RESPECIFY RTNREG UNRSTD;    0645 02191000
*                                      SETRC = MAX(SETRC,TESTRC);  0646 02192000
         LH    @04,SETRC                                           0646 02193000
         CR    @04,TESTRC                                          0646 02194000
         BNL   *+6                                                      02195000
         LR    @04,TESTRC                                          0646 02196000
         STH   @04,SETRC                                           0646 02197000
*                                     END;                         0647 02198000
*                                                                  0647 02199000
*                                    ELSE;                         0648 02200000
*                                                                  0648 02201000
@RF00640 DS    0H                                                  0649 02202000
*                                END GETVOLS;                      0649 02203000
*                                                                  0649 02204000
*                              ELSE;                               0650 02205000
*                                                                  0650 02206000
@RF00632 DS    0H                                                  0651 02207000
*                            /****************************************/ 02208000
*                            /*                                      */ 02209000
*                            /* PRINT VOLSEQ ERR MSG IF NEEDED       */ 02210000
*                            /* SET LASTCC4                          */ 02211000
*                            /*                                      */ 02212000
*                            /****************************************/ 02213000
*                                                                  0651 02214000
*                            IF VLSQMSG = YES                      0651 02215000
*                              THEN                                0651 02216000
*                                                                  0651 02217000
         TM    VLSQMSG,B'10000000'                                 0651 02218000
         BNO   @RF00651                                            0651 02219000
*                                DO;                               0652 02220000
*                                  DARGSMOD = CK0ID;               0653 02221000
         L     @04,DDSTRU                                          0653 02222000
         MVC   DARGSMOD(3,@04),@CC00609                            0653 02223000
*                                  DARGSENT = CKST12;              0654 02224000
         MVI   DARGSENT(@04),X'0C'                                 0654 02225000
*                                  DARGDBP  = ADDR(MSGDDNAM);      0655 02226000
         LA    @02,MSGDDNAM                                        0655 02227000
         ST    @02,DARGDBP(,@04)                                   0655 02228000
*                                  DARGILP  = LENGTH(MSGDDNAM);    0656 02229000
*                                                                  0656 02230000
         MVC   DARGILP(2,@04),@CH00173                             0656 02231000
*                                  CALL AMSTP011 (GDTTBL,          0657 02232000
*                                          OUTIOCP,                0657 02233000
*                                          DDSTRU);                0657 02234000
         L     @04,@PC00001                                        0657 02235000
         ST    @04,@AL00001                                        0657 02236000
         LA    @02,OUTIOCP                                         0657 02237000
         ST    @02,@AL00001+4                                      0657 02238000
         LA    @02,DDSTRU                                          0657 02239000
         ST    @02,@AL00001+8                                      0657 02240000
         MVI   @AL00001+8,X'80'                                    0657 02241000
         L     @15,GDTPRT(,@04)                                    0657 02242000
         LA    @01,@AL00001                                        0657 02243000
         BALR  @14,@15                                             0657 02244000
*                                  RESPECIFY RTNREG RSTD;          0658 02245000
*                                  TESTRC = RTNREG;                0659 02246000
         LR    TESTRC,RTNREG                                       0659 02247000
*                                  RESPECIFY RTNREG UNRSTD;        0660 02248000
*                                                                  0660 02249000
*                                  /* SET RETURN CODE FROM PRINT     */ 02250000
*                                  SETRC = MAX(SETRC,TESTRC);      0661 02251000
*                                                                  0661 02252000
         LH    @04,SETRC                                           0661 02253000
         CR    @04,TESTRC                                          0661 02254000
         BNL   *+6                                                      02255000
         LR    @04,TESTRC                                          0661 02256000
         STH   @04,SETRC                                           0661 02257000
*                                  DARGLIST = ZEROAREA;            0662 02258000
*                                                                  0662 02259000
         L     @02,DDSTRU                                          0662 02260000
         MVC   DARGLIST(20,@02),ZEROAREA                           0662 02261000
*                                  /* SET ERROR CODE LASTCC04        */ 02262000
*                                  SETRC = MAX(SETRC,LASTCC04);    0663 02263000
*                                                                  0663 02264000
         LA    @02,4                                               0663 02265000
         CR    @04,@02                                             0663 02266000
         BNL   *+6                                                      02267000
         LR    @04,@02                                             0663 02268000
         STH   @04,SETRC                                           0663 02269000
*                                END;                              0664 02270000
*                              ELSE;                               0665 02271000
*                                                                  0665 02272000
@RF00651 DS    0H                                                  0666 02273000
*                          END DSDR1TP;                            0666 02274000
*                                                                  0666 02275000
*                        ELSE;         /*DSDR1 NOT FOR TAPE-LOOP     */ 02276000
*                                                                  0667 02277000
@RF00592 DS    0H                                                  0668 02278000
*                    END DSDR1PC;                                  0668 02279000
*                                                                  0668 02280000
*              END NOEOF;                                          0669 02281000
*                                                                  0669 02282000
*            ELSE;                     /* DPEOF NOT EQUAL 0          */ 02283000
*                                                                  0670 02284000
@RF00573 DS    0H                                                  0671 02285000
*        END START;                                                0671 02286000
*                                                                  0671 02287000
@RC00573 DS    0H                                                  0671 02288000
@DE00563 L     @04,@PC00006+4                                      0671 02289000
         LH    @04,DPEOF(,@04)                                     0671 02290000
         LTR   @04,@04                                             0671 02291000
         BZ    @DL00563                                            0671 02292000
*        /************************************************************/ 02293000
*        /*                                                          */ 02294000
*        /* IF NO TAPE DATA SETS WERE FOUND FOR THIS CHECKPOINT      */ 02295000
*        /* PRINT A MESSAGE TO INFORM THE USER                       */ 02296000
*        /*                                                          */ 02297000
*        /************************************************************/ 02298000
*                                                                  0672 02299000
*        IF DSDR1FND = NO                                          0672 02300000
*          THEN                                                    0672 02301000
         TM    DSDR1FND,B'10000000'                                0672 02302000
         BNZ   @RF00672                                            0672 02303000
*            DO;                                                   0673 02304000
*              DARGSMOD = CK0ID;                                   0674 02305000
         L     @02,DDSTRU                                          0674 02306000
         MVC   DARGSMOD(3,@02),@CC00609                            0674 02307000
*              DARGSENT = CKST06;                                  0675 02308000
*                                                                  0675 02309000
         MVI   DARGSENT(@02),X'06'                                 0675 02310000
*              CALL AMSTP011 (GDTTBL,                              0676 02311000
*                      OUTIOCP,                                    0676 02312000
*                      DDSTRU);                                    0676 02313000
         L     @02,@PC00001                                        0676 02314000
         ST    @02,@AL00001                                        0676 02315000
         LA    @15,OUTIOCP                                         0676 02316000
         ST    @15,@AL00001+4                                      0676 02317000
         LA    @15,DDSTRU                                          0676 02318000
         ST    @15,@AL00001+8                                      0676 02319000
         MVI   @AL00001+8,X'80'                                    0676 02320000
         L     @15,GDTPRT(,@02)                                    0676 02321000
         LA    @01,@AL00001                                        0676 02322000
         BALR  @14,@15                                             0676 02323000
*              RESPECIFY RTNREG RSTD;                              0677 02324000
*              TESTRC = RTNREG;                                    0678 02325000
         LR    TESTRC,RTNREG                                       0678 02326000
*              RESPECIFY RTNREG UNRSTD;                            0679 02327000
*              SETRC = MAX(SETRC,TESTRC);                          0680 02328000
         LH    @02,SETRC                                           0680 02329000
         CR    @02,TESTRC                                          0680 02330000
         BNL   *+6                                                      02331000
         LR    @02,TESTRC                                          0680 02332000
         STH   @02,SETRC                                           0680 02333000
*              DARGLIST = ZEROAREA;                                0681 02334000
*                                                                  0681 02335000
         L     @01,DDSTRU                                          0681 02336000
         MVC   DARGLIST(20,@01),ZEROAREA                           0681 02337000
*            END;                                                  0682 02338000
*          ELSE;                                                   0683 02339000
*                                                                  0683 02340000
@RF00672 DS    0H                                                  0684 02341000
*        /************************************************************/ 02342000
*        /*                                                          */ 02343000
*        /* RESET DPEOF TO ZERO IF END OF ENTRY WAS REPORTED         */ 02344000
*        /*                                                          */ 02345000
*        /************************************************************/ 02346000
*                                                                  0684 02347000
*        IF DPEOF = EOECOND                                        0684 02348000
*          THEN                                                    0684 02349000
         L     @15,@PC00006+4                                      0684 02350000
         CLC   DPEOF(2,@15),@CH00147                               0684 02351000
         BNE   @RF00684                                            0684 02352000
*            DPEOF = 0;                                            0685 02353000
         SLR   @14,@14                                             0685 02354000
         STH   @14,DPEOF(,@15)                                     0685 02355000
*          ELSE;                                                   0686 02356000
*                                                                  0686 02357000
@RF00684 DS    0H                                                  0687 02358000
*        RETURN CODE (0);                                          0687 02359000
         SLR   @15,@15                                             0687 02360000
         L     @14,@SA00006                                        0687 02361000
         LM    @00,@12,@SA00006+8                                  0687 02362000
         BR    @14                                                 0687 02363000
*        END DSDRPROC;                                             0688 02364000
*        /************************************************************/ 02365000
*        /*                                                          */ 02366000
*        /* PROCEDURE - DSDRVOLS (DVNVOLS,                           */ 02367000
*        /*                       DVVOLSEQ,                          */ 02368000
*        /*                       DVSIZE,                            */ 02369000
*        /*                       DVLOGRCP,                          */ 02370000
*        /*                       DVNEEDCH,                          */ 02371000
*        /*                       DVGETNXT,                          */ 02372000
*        /*                       DVEOF)                             */ 02373000
*        /*                                                          */ 02374000
*        /* FUNCTION - TO PREPARE AND PRINT VOLUME INFORMATION       */ 02375000
*        /*            FROM THE JFCBX IN THE DSDR2 RECORDS OF THE    */ 02376000
*        /*            CHECKPOINT DATA SET.                          */ 02377000
*        /*                                                          */ 02378000
*        /* INPUT - CHECKPOINT DATA SET                              */ 02379000
*        /*         VOLUME SEQ NUMBER                                */ 02380000
*        /*         NUMBER OF VOLUMES                                */ 02381000
*        /*                                                          */ 02382000
*        /* OUTPUT - VOLUMES DETAIL LINE FOR ADDITIONAL VOLUMES      */ 02383000
*        /*          CHR READ SWITCH ( NEEDCHR )                     */ 02384000
*        /*          DSDR READ SWITCH ( GETNXTSW )                   */ 02385000
*        /*          END OF FILE INDICATOR ( EOF )                   */ 02386000
*        /*                                                          */ 02387000
*        /************************************************************/ 02388000
*                                                                  0689 02389000
*DSDRVOLS:                                                         0689 02390000
*        PROCEDURE (DVNVOLS,                                       0689 02391000
*                   DVVOLSEQ,                                      0689 02392000
*                   DVSIZE,                                        0689 02393000
*                   DVLOGRCP,                                      0689 02394000
*                   DVNEEDCH,                                      0689 02395000
*                   DVGETNXT,                                      0689 02396000
*                   DVEOF);                                        0689 02397000
*                                                                  0689 02398000
DSDRVOLS STM   @14,@12,@SA00007                                    0689 02399000
         MVC   @PC00007(28),0(@01)                                 0689 02400000
*        /************************************************************/ 02401000
*        /*                                                          */ 02402000
*        /* PARAMETERS THAT CAN BE MODIFIED OR ARE REQUIRED          */ 02403000
*        /* FROM ANOTHER INTERNAL ROUTINE                            */ 02404000
*        /*                                                          */ 02405000
*        /************************************************************/ 02406000
*                                                                  0690 02407000
*        DCL DVNVOLS  FIXED(15); /* NUMBER OF VOLUMES ( NVOLS )      */ 02408000
*        DCL DVVOLSEQ FIXED(15); /* VOLUME SEQUENCE NUMBER ( VOLSEQ )*/ 02409000
*        DCL DVSIZE   FIXED(31); /* LENGTH OF LAST LOGICAL REC (SIZE)*/ 02410000
*        DCL DVLOGRCP PTR(31);   /* LOGICAL RECORD POINTER (LOGRECP) */ 02411000
*        DCL DVNEEDCH BIT(1) BDY(BYTE); /* CHR READ SWITCH (NEEDCHR) */ 02412000
*        DCL DVGETNXT BIT(1) BDY(BYTE); /* DSDR READ SWITCH(GETNXTSW)*/ 02413000
*        DCL DVEOF    FIXED(15); /* END OF FILE INDICATOR ( EOF )    */ 02414000
*                                                                  0696 02415000
*        /************************************************************/ 02416000
*        /*                                                          */ 02417000
*        /* LOCAL VARIABLES                                          */ 02418000
*        /*                                                          */ 02419000
*        /************************************************************/ 02420000
*                                                                  0697 02421000
*        DCL NEEDD2  BIT(1)  BDY(BYTE);                            0697 02422000
*        /************************************************************/ 02423000
*        /*                                                          */ 02424000
*        /* INITIALIZE CONTROL SWITCH                                */ 02425000
*        /*                                                          */ 02426000
*        /************************************************************/ 02427000
*                                                                  0698 02428000
*        OLDERID2 = NEWERID2;                                      0698 02429000
         L     @02,@PC00001                                        0698 02430000
         L     @02,GDTTR2(,@02)                                    0698 02431000
         MVC   @TS00001(95),NEWERID2(@02)                          0698 02432000
         MVC   OLDERID2(95,@02),@TS00001                           0698 02433000
*        NEWID2 = 'CKDV';                                          0699 02434000
*                                                                  0699 02435000
         MVC   NEWID2(4,@02),@CC00867                              0699 02436000
*        NEEDD2 = YES;                                             0700 02437000
*                                                                  0700 02438000
         OI    NEEDD2,B'10000000'                                  0700 02439000
*        /************************************************************/ 02440000
*        /*                                                          */ 02441000
*        /* GET NEXT RECORD - SHOULD BE DSDR2. IF NOT PRINT          */ 02442000
*        /* ERROR MESSAGE & RETURN.                                  */ 02443000
*        /*                                                          */ 02444000
*        /************************************************************/ 02445000
*                                                                  0701 02446000
*DVOLS:  DO WHILE(NEEDD2 = YES);                                   0701 02447000
*                                                                  0701 02448000
DVOLS    B     @DE00701                                            0701 02449000
@DL00701 DS    0H                                                  0702 02450000
*          CALL GETNEXT (DVLOGRCP,     /*GET NEXT LOGICAL RECORD     */ 02451000
*                        DVSIZE,                                   0702 02452000
*                        DVNEEDCH,                                 0702 02453000
*                        DVEOF);                                   0702 02454000
*                                                                  0702 02455000
         L     @02,@PC00007+12                                     0702 02456000
         ST    @02,@AL00001                                        0702 02457000
         L     @02,@PC00007+8                                      0702 02458000
         ST    @02,@AL00001+4                                      0702 02459000
         L     @02,@PC00007+16                                     0702 02460000
         ST    @02,@AL00001+8                                      0702 02461000
         L     @02,@PC00007+24                                     0702 02462000
         ST    @02,@AL00001+12                                     0702 02463000
         LA    @01,@AL00001                                        0702 02464000
         BAL   @14,GETNEXT                                         0702 02465000
*          IF DVEOF = 0          &                                 0703 02466000
*            DVLOGRCP->DSDR2TYP = DSDR2                            0703 02467000
*            THEN                                                  0703 02468000
*                                                                  0703 02469000
         L     @02,@PC00007+24                                     0703 02470000
         LH    @02,DVEOF(,@02)                                     0703 02471000
         LTR   @02,@02                                             0703 02472000
         BNZ   @RF00703                                            0703 02473000
         L     @02,@PC00007+12                                     0703 02474000
         L     @02,DVLOGRCP(,@02)                                  0703 02475000
         CLC   DSDR2TYP(2,@02),@CB00675                            0703 02476000
         BNE   @RF00703                                            0703 02477000
*        /************************************************************/ 02478000
*        /*                                                          */ 02479000
*        /* PROCESS VOLUMES FROM DSDR2  - JFCBX                      */ 02480000
*        /* 15 (MAX) VOLUME SERIAL NUMBERS CAN BE CONTAINED IN THE   */ 02481000
*        /* JFCBX.  THEY ARE PRINTED 5 PER LINE FOR A MAXIMUM OF     */ 02482000
*        /* FIVE LINES.                                              */ 02483000
*        /*                                                          */ 02484000
*        /************************************************************/ 02485000
*                                                                  0704 02486000
*PROCD2:       DO;                                                 0704 02487000
*                                                                  0704 02488000
PROCD2   DS    0H                                                  0705 02489000
*                IF GDTDBG = NULLPTR                               0705 02490000
*                  THEN;                                           0705 02491000
         L     @02,@PC00001                                        0705 02492000
         L     @02,GDTDBG(,@02)                                    0705 02493000
         LTR   @02,@02                                             0705 02494000
         BZ    @RT00705                                            0705 02495000
*                  ELSE                                            0707 02496000
*                    CALL IDCDB010 (GDTTBL,'CK50');                0707 02497000
*                                                                  0707 02498000
         L     @02,@PC00001                                        0707 02499000
         ST    @02,@AL00001                                        0707 02500000
         LA    @15,@CC00872                                        0707 02501000
         ST    @15,@AL00001+4                                      0707 02502000
         MVI   @AL00001+4,X'80'                                    0707 02503000
         L     @15,GDTDBG(,@02)                                    0707 02504000
         LA    @01,@AL00001                                        0707 02505000
         BALR  @14,@15                                             0707 02506000
*                DSDR2PTR = DVLOGRCP;                              0708 02507000
@RT00705 L     @15,@PC00007+12                                     0708 02508000
         L     DSDR2PTR,DVLOGRCP(,@15)                             0708 02509000
*                DVSIZE = LENGTH(DSDR2REC);                        0709 02510000
         L     @15,@PC00007+8                                      0709 02511000
         MVC   DVSIZE(4,@15),@CF00718                              0709 02512000
*                DO I = 1 TO MAXLINE WHILE (DVNVOLS > 0);          0710 02513000
         LA    I,1                                                 0710 02514000
@DL00710 L     @05,@PC00007                                        0710 02515000
         LH    @05,DVNVOLS(,@05)                                   0710 02516000
         LTR   @05,@05                                             0710 02517000
         BNP   @DC00710                                            0710 02518000
*                  TVOLINFO = BLANKS;                              0711 02519000
*                                                                  0711 02520000
         MVC   TVOLINFO(35),BLANKS                                 0711 02521000
*                  /**************************************************/ 02522000
*                  /*                                                */ 02523000
*                  /* MOVE TO TVOL(J) THE JFCBXVOL DETERMINED BY     */ 02524000
*                  /* 5 * (I - 1) + J. THAT IS, THE JTH VOL IN THE   */ 02525000
*                  /* ITH GROUP OF 5 VOLS IN THE JFCBX.              */ 02526000
*                  /*                                                */ 02527000
*                  /**************************************************/ 02528000
*                                                                  0712 02529000
*                  DO J = 1 TO PVOLLIM WHILE (DVNVOLS > 0);        0712 02530000
         LA    J,1                                                 0712 02531000
@DL00712 L     @07,@PC00007                                        0712 02532000
         LH    @05,DVNVOLS(,@07)                                   0712 02533000
         LTR   @05,@05                                             0712 02534000
         BNP   @DC00712                                            0712 02535000
*                    TVOL(J) = JFXVOL((I-1)*5 + J);                0713 02536000
         LR    @03,J                                               0713 02537000
         MH    @03,@CH00617                                        0713 02538000
         LA    @01,TVOL-7(@03)                                     0713 02539000
         LR    @03,I                                               0713 02540000
         BCTR  @03,0                                               0713 02541000
         MH    @03,@CH00266                                        0713 02542000
         ALR   @03,J                                               0713 02543000
         MH    @03,@CH00150                                        0713 02544000
         ALR   @03,DSDR2PTR                                        0713 02545000
         MVC   0(6,@01),JFXVOL-6(@03)                              0713 02546000
*                    DVNVOLS = DVNVOLS - 1;                        0714 02547000
         BCTR  @05,0                                               0714 02548000
         STH   @05,DVNVOLS(,@07)                                   0714 02549000
*                  END;                                            0715 02550000
*                                                                  0715 02551000
         AL    J,@CF00213                                          0715 02552000
         C     J,@CF00266                                          0715 02553000
         BNH   @DL00712                                            0715 02554000
@DC00712 DS    0H                                                  0716 02555000
*                  CALL DSDRLIST (DVVOLSEQ);                       0716 02556000
*                                                                  0716 02557000
         L     @05,@PC00007+4                                      0716 02558000
         ST    @05,@AL00001                                        0716 02559000
         LA    @01,@AL00001                                        0716 02560000
         BAL   @14,DSDRLIST                                        0716 02561000
*                END;                                              0717 02562000
*                                                                  0717 02563000
         AL    I,@CF00213                                          0717 02564000
         C     I,@CF00156                                          0717 02565000
         BNH   @DL00710                                            0717 02566000
@DC00710 DS    0H                                                  0718 02567000
*                /****************************************************/ 02568000
*                /*                                                  */ 02569000
*                /* IF ALL VOLS HAVE BEEN PRINTED, SET THE           */ 02570000
*                /* CONTROL SWITCH TO STOP PROCESSING.               */ 02571000
*                /*                                                  */ 02572000
*                /****************************************************/ 02573000
*                                                                  0718 02574000
*                IF DVNVOLS ^> 0 |                                 0718 02575000
*                   JFCBXNXT = NULLPTR                             0718 02576000
*                  THEN                                            0718 02577000
         SLR   @15,@15                                             0718 02578000
         L     @14,@PC00007                                        0718 02579000
         CH    @15,DVNVOLS(,@14)                                   0718 02580000
         BNL   @RT00718                                            0718 02581000
         ICM   @14,15,JFCBXNXT(DSDR2PTR)                           0718 02582000
         CR    @15,@14                                             0718 02583000
         BNE   @RF00718                                            0718 02584000
@RT00718 DS    0H                                                  0719 02585000
*                    NEEDD2 = NO;                                  0719 02586000
         NI    NEEDD2,B'01111111'                                  0719 02587000
*                  ELSE;                                           0720 02588000
*                                                                  0720 02589000
@RF00718 DS    0H                                                  0721 02590000
*              END PROCD2;                                         0721 02591000
*                                                                  0721 02592000
*            ELSE                                                  0722 02593000
*                                                                  0722 02594000
*              /******************************************************/ 02595000
*              /*                                                    */ 02596000
*              /* WHEN END OF FILE, END OF ENTRY OR A NON-DSDR2      */ 02597000
*              /* RECORD OCCURS, PRINT ERROR MESSAGE AND SET         */ 02598000
*              /* THE RETURN CODE TO 4                               */ 02599000
*              /*                                                    */ 02600000
*              /******************************************************/ 02601000
*                                                                  0722 02602000
*              DO;                                                 0722 02603000
         B     @RC00703                                            0722 02604000
@RF00703 DS    0H                                                  0723 02605000
*                DVGETNXT = NO;                                    0723 02606000
         L     @02,@PC00007+20                                     0723 02607000
         NI    DVGETNXT(@02),B'01111111'                           0723 02608000
*                DARGSMOD = CK0ID;                                 0724 02609000
         L     @02,DDSTRU                                          0724 02610000
         MVC   DARGSMOD(3,@02),@CC00609                            0724 02611000
*                DARGSENT = CKST10;                                0725 02612000
         MVI   DARGSENT(@02),X'0A'                                 0725 02613000
*                DARGDBP  = ADDR(MSGDDNAM);                        0726 02614000
         LA    @15,MSGDDNAM                                        0726 02615000
         ST    @15,DARGDBP(,@02)                                   0726 02616000
*                DARGILP  = LENGTH(MSGDDNAM);                      0727 02617000
*                                                                  0727 02618000
         MVC   DARGILP(2,@02),@CH00173                             0727 02619000
*                CALL AMSTP011 (GDTTBL,                            0728 02620000
*                        OUTIOCP,                                  0728 02621000
*                        DDSTRU);                                  0728 02622000
         L     @02,@PC00001                                        0728 02623000
         ST    @02,@AL00001                                        0728 02624000
         LA    @15,OUTIOCP                                         0728 02625000
         ST    @15,@AL00001+4                                      0728 02626000
         LA    @15,DDSTRU                                          0728 02627000
         ST    @15,@AL00001+8                                      0728 02628000
         MVI   @AL00001+8,X'80'                                    0728 02629000
         L     @15,GDTPRT(,@02)                                    0728 02630000
         LA    @01,@AL00001                                        0728 02631000
         BALR  @14,@15                                             0728 02632000
*                SETRC = MAX(SETRC,TESTRC);                        0729 02633000
*                                                                  0729 02634000
         LH    @02,SETRC                                           0729 02635000
         CR    @02,TESTRC                                          0729 02636000
         BNL   *+6                                                      02637000
         LR    @02,TESTRC                                          0729 02638000
         STH   @02,SETRC                                           0729 02639000
*                RETURN CODE (LASTCC04);                           0730 02640000
         LA    @15,4                                               0730 02641000
         L     @14,@SA00007                                        0730 02642000
         LM    @00,@12,@SA00007+8                                  0730 02643000
         BR    @14                                                 0730 02644000
*              END;                                                0731 02645000
*                                                                  0731 02646000
*        END DVOLS;                                                0732 02647000
*                                                                  0732 02648000
@RC00703 DS    0H                                                  0732 02649000
@DE00701 TM    NEEDD2,B'10000000'                                  0732 02650000
         BO    @DL00701                                            0732 02651000
*        RETURN CODE (0);                                          0733 02652000
         SLR   @15,@15                                             0733 02653000
         L     @14,@SA00007                                        0733 02654000
         LM    @00,@12,@SA00007+8                                  0733 02655000
         BR    @14                                                 0733 02656000
*        END DSDRVOLS;                                             0734 02657000
*        /************************************************************/ 02658000
*        /*                                                          */ 02659000
*        /* PROCEDURE - GETNEXT (GNLOGRCP,GNSIZE,GNNEEDCH,GNEOF)     */ 02660000
*        /*                                                          */ 02661000
*        /* FUNCTION - TO OBTAIN THE NEXT SEQUENTIAL LOGICAL RECORD  */ 02662000
*        /*            FROM THE CHECKPOINT DATA SET. THE LOGICAL     */ 02663000
*        /*            RECORD POINTER IS SET TO THE ADDRESS OF THE   */ 02664000
*        /*            LOGICAL RECORD.                               */ 02665000
*        /*                                                          */ 02666000
*        /* INPUT - CHECKPOINT DATA SET                              */ 02667000
*        /*         SIZE OF THE PREVIOUS RECORD                      */ 02668000
*        /*                                                          */ 02669000
*        /* OUTPUT - ADDRESS OF LOGICAL RECORD                       */ 02670000
*        /*          CHR READ SWITCH (NEEDCHR)                       */ 02671000
*        /*          END OF FILE INDICATOR                           */ 02672000
*        /*          LOGICAL RECORD POINTER                          */ 02673000
*        /*                                                          */ 02674000
*        /************************************************************/ 02675000
*                                                                  0735 02676000
*GETNEXT:                                                          0735 02677000
*        PROCEDURE (GNLOGRCP,                                      0735 02678000
*                   GNSIZE,                                        0735 02679000
*                   GNNEEDCH,                                      0735 02680000
*                   GNEOF);                                        0735 02681000
*                                                                  0735 02682000
GETNEXT  STM   @14,@02,@SA00008                                    0735 02683000
         STM   @04,@12,@SA00008+20                                 0735 02684000
         MVC   @PC00008(16),0(@01)                                 0735 02685000
*        /************************************************************/ 02686000
*        /*                                                          */ 02687000
*        /* PARAMETERS THAT CAN BE MODIFIED, OR ARE REQUIRED FROM    */ 02688000
*        /* CALLING PROGRAM                                          */ 02689000
*        /*                                                          */ 02690000
*        /************************************************************/ 02691000
*                                                                  0736 02692000
*        DCL GNLOGRCP  PTR(31);   /* LOGICAL RECORD POINTER          */ 02693000
*        DCL GNSIZE    FIXED(31); /* SIZE OF LAST LOGICAL RECORD     */ 02694000
*        DCL GNNEEDCH  BIT(1) BDY(BYTE); /*CHR READ SWITCH (NEEDCHR) */ 02695000
*        DCL GNEOF     FIXED(15); /* END OF FILE INDICATOR ( EOF )   */ 02696000
*        /************************************************************/ 02697000
*        /*                                                          */ 02698000
*        /* BYPASS READ IF CURRENT RECORD IS FIRST OF BLOCK, AND     */ 02699000
*        /* INCREMENT LOGICAL RECORD POINTER BY THE SIZE OF THE      */ 02700000
*        /* CURRENT RECORD TO POINT TO THE SECOND BLOCK              */ 02701000
*        /*                                                          */ 02702000
*        /************************************************************/ 02703000
*                                                                  0740 02704000
*        OLDERID2 = NEWERID2;                                      0740 02705000
         L     @02,@PC00001                                        0740 02706000
         L     @02,GDTTR2(,@02)                                    0740 02707000
         MVC   @TS00001(95),NEWERID2(@02)                          0740 02708000
         MVC   OLDERID2(95,@02),@TS00001                           0740 02709000
*        NEWID2 = 'CKGN';                                          0741 02710000
*                                                                  0741 02711000
         MVC   NEWID2(4,@02),@CC00884                              0741 02712000
*        IF GNLOGRCP = IOCDAD                                      0742 02713000
*          THEN                                                    0742 02714000
         L     @02,@PC00008                                        0742 02715000
         L     @15,GNLOGRCP(,@02)                                  0742 02716000
         L     @14,IOCSPTR                                         0742 02717000
         C     @15,IOCDAD(,@14)                                    0742 02718000
         BNE   @RF00742                                            0742 02719000
*            GNLOGRCP = GNLOGRCP + GNSIZE;  /*INCREMENT PTR BY SIZE  */ 02720000
         L     @14,@PC00008+4                                      0743 02721000
         AL    @15,GNSIZE(,@14)                                    0743 02722000
         ST    @15,GNLOGRCP(,@02)                                  0743 02723000
*                                           /*DROP TO END OF PROGRAM */ 02724000
*          ELSE                                                    0744 02725000
*                                                                  0744 02726000
*GETNXT:     DO;                                                   0744 02727000
         B     @RC00742                                            0744 02728000
@RF00742 DS    0H                                                  0744 02729000
GETNXT   DS    0H                                                  0745 02730000
*              IOCDLN = LENGTH(CHKPTREC);                          0745 02731000
*                                                                  0745 02732000
         L     @02,IOCSPTR                                         0745 02733000
         MVC   IOCDLN(4,@02),@CF00894                              0745 02734000
*              CALL IDCIOGT0 (GDTTBL,       /*READ NEXT BLOCK        */ 02735000
*                    INIOCP);                                      0746 02736000
         L     @02,@PC00001                                        0746 02737000
         ST    @02,@AL00001                                        0746 02738000
         LA    @15,INIOCP                                          0746 02739000
         ST    @15,@AL00001+4                                      0746 02740000
         MVI   @AL00001+4,X'80'                                    0746 02741000
         L     @15,GDTGET(,@02)                                    0746 02742000
         LA    @01,@AL00001                                        0746 02743000
         BALR  @14,@15                                             0746 02744000
*              RESPECIFY RTNREG RSTD;                              0747 02745000
*              TESTRC = RTNREG;                                    0748 02746000
         LR    TESTRC,RTNREG                                       0748 02747000
*              RESPECIFY RTNREG UNRSTD;                            0749 02748000
*                                                                  0749 02749000
*              IF TESTRC ^= 0                                      0750 02750000
*                THEN                                              0750 02751000
         LTR   TESTRC,TESTRC                                       0750 02752000
         BZ    @RF00750                                            0750 02753000
*                  IF TESTRC = 16           /*CHECK FOR EOF          */ 02754000
*                    THEN                                          0751 02755000
         C     TESTRC,@CF00465                                     0751 02756000
         BNE   @RF00751                                            0751 02757000
*                      DO;                  /*PRINT UNEXPECTED EOF   */ 02758000
*                        GNEOF = EOFCOND;   /*MSG RETURN LASTCC04    */ 02759000
         L     @02,@PC00008+12                                     0753 02760000
         MVC   GNEOF(2,@02),@CH00213                               0753 02761000
*                        DARGSMOD = CK0ID;                         0754 02762000
         L     @02,DDSTRU                                          0754 02763000
         MVC   DARGSMOD(3,@02),@CC00609                            0754 02764000
*                        DARGSENT = CKST11;                        0755 02765000
*                                                                  0755 02766000
         MVI   DARGSENT(@02),X'0B'                                 0755 02767000
*                        CALL AMSTP011 (GDTTBL,                    0756 02768000
*                                PRTFILE,                          0756 02769000
*                                DDSTRU);                          0756 02770000
*                                                                  0756 02771000
         L     @02,@PC00001                                        0756 02772000
         ST    @02,@AL00001                                        0756 02773000
         LA    @15,@CF00111                                        0756 02774000
         ST    @15,@AL00001+4                                      0756 02775000
         LA    @15,DDSTRU                                          0756 02776000
         ST    @15,@AL00001+8                                      0756 02777000
         MVI   @AL00001+8,X'80'                                    0756 02778000
         L     @15,GDTPRT(,@02)                                    0756 02779000
         LA    @01,@AL00001                                        0756 02780000
         BALR  @14,@15                                             0756 02781000
*                        RETURN CODE (LASTCC04);                   0757 02782000
         LA    @15,4                                               0757 02783000
         L     @14,@SA00008                                        0757 02784000
         LM    @00,@02,@SA00008+8                                  0757 02785000
         LM    @04,@12,@SA00008+20                                 0757 02786000
         BR    @14                                                 0757 02787000
*                      END;                                        0758 02788000
*                    ELSE                   /*SET RETURN CODE 12 FOR */ 02789000
*                      DO;                  /*I/O ERROR              */ 02790000
@RF00751 DS    0H                                                  0760 02791000
*                        GNEOF = EOFCOND;                          0760 02792000
         L     @02,@PC00008+12                                     0760 02793000
         MVC   GNEOF(2,@02),@CH00213                               0760 02794000
*                        RETURN CODE (LASTCC12);                   0761 02795000
         LA    @15,12                                              0761 02796000
         L     @14,@SA00008                                        0761 02797000
         LM    @00,@02,@SA00008+8                                  0761 02798000
         LM    @04,@12,@SA00008+20                                 0761 02799000
         BR    @14                                                 0761 02800000
*                      END;                                        0762 02801000
*                ELSE                                              0763 02802000
*                                                                  0763 02803000
*                  /**************************************************/ 02804000
*                  /*                                                */ 02805000
*                  /* WHEN READ IS OK, LOOK FOR END OF ENTRY. IF A   */ 02806000
*                  /* POTENTIAL CHR IS FOUND, SET NEEDCHR TO YES.    */ 02807000
*                  /*                                                */ 02808000
*                  /**************************************************/ 02809000
*                                                                  0763 02810000
*                  IF IOCDLN = LENGTH(CHKPTREC)                    0763 02811000
*                    THEN                                          0763 02812000
@RF00750 L     @02,IOCSPTR                                         0763 02813000
         CLC   IOCDLN(4,@02),@CF00894                              0763 02814000
         BNE   @RF00763                                            0763 02815000
*                      IF RECTYPE ^= DDNT  &                       0764 02816000
*                         RECTYPE ^= DSDR1 &                       0764 02817000
*                         RECTYPE ^= DSDR2 &                       0764 02818000
*                         CHRIDENT ^= CHRID                        0764 02819000
*                        THEN                                      0764 02820000
         L     @02,IOCDAD(,@02)                                    0764 02821000
         CLC   RECTYPE(2,@02),@CB00671                             0764 02822000
         BE    @RF00764                                            0764 02823000
         CLC   RECTYPE(2,@02),@CB00673                             0764 02824000
         BE    @RF00764                                            0764 02825000
         CLC   RECTYPE(2,@02),@CB00675                             0764 02826000
         BE    @RF00764                                            0764 02827000
         CLC   CHRIDENT(19,@02),@CC00644                           0764 02828000
         BE    @RF00764                                            0764 02829000
*                            GNEOF = EOECOND;    /*SET END OF ENTRY  */ 02830000
         L     @02,@PC00008+12                                     0765 02831000
         MVC   GNEOF(2,@02),@CH00147                               0765 02832000
*                        ELSE               /* CHECK FOR CHR         */ 02833000
*                          DO;                                     0766 02834000
         B     @RC00764                                            0766 02835000
@RF00764 DS    0H                                                  0767 02836000
*                            IF CHRIDENT = CHRID                   0767 02837000
*                              THEN              /*REC IS POSSIBL CHR*/ 02838000
         L     @02,IOCSPTR                                         0767 02839000
         L     @02,IOCDAD(,@02)                                    0767 02840000
         CLC   CHRIDENT(19,@02),@CC00644                           0767 02841000
         BNE   @RF00767                                            0767 02842000
*                                DO;                               0768 02843000
*                                  GNEOF = EOECOND; /*SET EOE        */ 02844000
         L     @02,@PC00008+12                                     0769 02845000
         MVC   GNEOF(2,@02),@CH00147                               0769 02846000
*                                  GNNEEDCH = NO;                  0770 02847000
         L     @02,@PC00008+8                                      0770 02848000
         NI    GNNEEDCH(@02),B'01111111'                           0770 02849000
*                                END;                              0771 02850000
*                              ELSE          /* GOOD REC-SET PTR     */ 02851000
*                                GNLOGRCP = IOCDAD;                0772 02852000
         B     @RC00767                                            0772 02853000
@RF00767 L     @02,@PC00008                                        0772 02854000
         L     @01,IOCSPTR                                         0772 02855000
         L     @15,IOCDAD(,@01)                                    0772 02856000
         ST    @15,GNLOGRCP(,@02)                                  0772 02857000
*                          END;                                    0773 02858000
*                    ELSE                                          0774 02859000
*                      GNEOF = EOECOND;     /*WRONG LENGTH MEANS EOE */ 02860000
*                                                                  0774 02861000
         B     @RC00763                                            0774 02862000
@RF00763 L     @02,@PC00008+12                                     0774 02863000
         MVC   GNEOF(2,@02),@CH00147                               0774 02864000
*            END GETNXT;                                           0775 02865000
*                                                                  0775 02866000
@RC00763 DS    0H                                                  0776 02867000
*        RETURN CODE (0);                                          0776 02868000
@RC00742 SLR   @15,@15                                             0776 02869000
         L     @14,@SA00008                                        0776 02870000
         LM    @00,@02,@SA00008+8                                  0776 02871000
         LM    @04,@12,@SA00008+20                                 0776 02872000
         BR    @14                                                 0776 02873000
*        END GETNEXT;                                              0777 02874000
*        /************************************************************/ 02875000
*        /*                                                          */ 02876000
*        /* PROCEDURE - DSDRLIST (DLVOLSEQ)                          */ 02877000
*        /*                                                          */ 02878000
*        /* FUNCTION - TO DETERMINE IF THE VOLUME MOUNTED AT THE TIME*/ 02879000
*        /*            OF A CHECKPOINT IS IN THE LINE TO BE PRINTED. */ 02880000
*        /*            IF SO AN ASTERISK IS PLACED TO THE RIGT OF    */ 02881000
*        /*            THAT VOLUME.                                  */ 02882000
*        /*                                                          */ 02883000
*        /* INPUT - VOLUME SEQUENCE NUMBER                           */ 02884000
*        /*         VOLUME PRINT BUFFER                              */ 02885000
*        /*                                                          */ 02886000
*        /* OUTPUT - VOLUME DETAIL LINE                              */ 02887000
*        /*                                                          */ 02888000
*        /************************************************************/ 02889000
*                                                                  0778 02890000
*DSDRLIST:                                                         0778 02891000
*        PROCEDURE (DLVOLSEQ);                                     0778 02892000
*                                                                  0778 02893000
DSDRLIST STM   @14,@02,@SA00009                                    0778 02894000
         STM   @04,@12,@SA00009+20                                 0778 02895000
         MVC   @PC00009(4),0(@01)                                  0778 02896000
*        /************************************************************/ 02897000
*        /*                                                          */ 02898000
*        /* PARAMETERS THAT CAN BE MODIFIED                          */ 02899000
*        /*                                                          */ 02900000
*        /************************************************************/ 02901000
*                                                                  0779 02902000
*        DCL DLVOLSEQ FIXED(15);                                   0779 02903000
*        /************************************************************/ 02904000
*        /*                                                          */ 02905000
*        /* IF THE VOLSEQ IS GREATER THAN ZERO AND LESS THAN OR      */ 02906000
*        /* EQUAL TO FIVE, THE CURRENT VOLUME IS MARKED WITH AN      */ 02907000
*        /* ASTERISK IF A VOLUME IS IN THE BUFFER. VOLSEQ IS SET     */ 02908000
*        /* TO ZERO.                                                 */ 02909000
*        /************************************************************/ 02910000
*                                                                  0780 02911000
*        OLDERID2 = NEWERID2;                                      0780 02912000
         L     @15,@PC00001                                        0780 02913000
         L     @15,GDTTR2(,@15)                                    0780 02914000
         MVC   @TS00001(95),NEWERID2(@15)                          0780 02915000
         MVC   OLDERID2(95,@15),@TS00001                           0780 02916000
*        NEWID2 = 'CKDL';                                          0781 02917000
*                                                                  0781 02918000
         MVC   NEWID2(4,@15),@CC00892                              0781 02919000
*        IF DLVOLSEQ >  0       &                                  0782 02920000
*           DLVOLSEQ <= PVOLLIM                                    0782 02921000
*          THEN                                                    0782 02922000
         L     @15,@PC00009                                        0782 02923000
         LH    @15,DLVOLSEQ(,@15)                                  0782 02924000
         LTR   @15,@15                                             0782 02925000
         BNP   @RF00782                                            0782 02926000
         C     @15,@CF00266                                        0782 02927000
         BH    @RF00782                                            0782 02928000
*            DO;                                                   0783 02929000
*              IF TVOL(DLVOLSEQ) ^= BLANKS                         0784 02930000
*                THEN                                              0784 02931000
         MH    @15,@CH00617                                        0784 02932000
         LA    @14,TVOL-7(@15)                                     0784 02933000
         CLC   0(6,@14),BLANKS                                     0784 02934000
         BE    @RF00784                                            0784 02935000
*                  TASTER(DLVOLSEQ) = ASTER;                       0785 02936000
         LA    @14,TASTER-7(@15)                                   0785 02937000
         MVI   0(@14),C'*'                                         0785 02938000
*                ELSE;                                             0786 02939000
@RF00784 DS    0H                                                  0787 02940000
*              DLVOLSEQ = 0;                                       0787 02941000
         L     @15,@PC00009                                        0787 02942000
         SLR   @14,@14                                             0787 02943000
         STH   @14,DLVOLSEQ(,@15)                                  0787 02944000
*            END;                                                  0788 02945000
*          ELSE                                                    0789 02946000
*                                                                  0789 02947000
*            /********************************************************/ 02948000
*            /*                                                      */ 02949000
*            /* SUBTRACT PRINT LIMIT (5) FROM VOLSEQ                 */ 02950000
*            /*                                                      */ 02951000
*            /********************************************************/ 02952000
*                                                                  0789 02953000
*            IF DLVOLSEQ > PVOLLIM                                 0789 02954000
*              THEN                                                0789 02955000
         B     @RC00782                                            0789 02956000
@RF00782 LA    @15,5                                               0789 02957000
         L     @14,@PC00009                                        0789 02958000
         LH    @09,DLVOLSEQ(,@14)                                  0789 02959000
         CR    @09,@15                                             0789 02960000
         BNH   @RF00789                                            0789 02961000
*                DLVOLSEQ = DLVOLSEQ - PVOLLIM;                    0790 02962000
         SLR   @09,@15                                             0790 02963000
         STH   @09,DLVOLSEQ(,@14)                                  0790 02964000
*              ELSE;                                               0791 02965000
*                                                                  0791 02966000
@RF00789 DS    0H                                                  0792 02967000
*        /************************************************************/ 02968000
*        /*                                                          */ 02969000
*        /* PRINT VOLUME DETAIL LINE         UPRINT                  */ 02970000
*        /*                                                          */ 02971000
*        /************************************************************/ 02972000
*                                                                  0792 02973000
*        DARGSMOD = CK0ID;                                         0792 02974000
@RC00782 L     @02,DDSTRU                                          0792 02975000
         MVC   DARGSMOD(3,@02),@CC00609                            0792 02976000
*        DARGSENT = CKST04;                                        0793 02977000
         MVI   DARGSENT(@02),X'04'                                 0793 02978000
*        DARGDBP  = ADDR(TVOLINFO);                                0794 02979000
         LA    @15,TVOLINFO                                        0794 02980000
         ST    @15,DARGDBP(,@02)                                   0794 02981000
*        DARGILP  = LENGTH(TVOLINFO);                              0795 02982000
*                                                                  0795 02983000
         MVC   DARGILP(2,@02),@CH00899                             0795 02984000
*        CALL AMSTP011 (GDTTBL,                                    0796 02985000
*                OUTIOCP,                                          0796 02986000
*                DDSTRU);                                          0796 02987000
         L     @02,@PC00001                                        0796 02988000
         ST    @02,@AL00001                                        0796 02989000
         LA    @15,OUTIOCP                                         0796 02990000
         ST    @15,@AL00001+4                                      0796 02991000
         LA    @15,DDSTRU                                          0796 02992000
         ST    @15,@AL00001+8                                      0796 02993000
         MVI   @AL00001+8,X'80'                                    0796 02994000
         L     @15,GDTPRT(,@02)                                    0796 02995000
         LA    @01,@AL00001                                        0796 02996000
         BALR  @14,@15                                             0796 02997000
*        RESPECIFY RTNREG RSTD;                                    0797 02998000
*        TESTRC = RTNREG;                                          0798 02999000
         LR    TESTRC,RTNREG                                       0798 03000000
*        RESPECIFY RTNREG UNRSTD;                                  0799 03001000
*        SETRC = MAX(SETRC,TESTRC);                                0800 03002000
         LH    @02,SETRC                                           0800 03003000
         CR    @02,TESTRC                                          0800 03004000
         BNL   *+6                                                      03005000
         LR    @02,TESTRC                                          0800 03006000
         STH   @02,SETRC                                           0800 03007000
*        DARGLIST = ZEROAREA;                                      0801 03008000
*                                                                  0801 03009000
         L     @02,DDSTRU                                          0801 03010000
         MVC   DARGLIST(20,@02),ZEROAREA                           0801 03011000
*        RETURN CODE (0);                                          0802 03012000
         SLR   @15,@15                                             0802 03013000
         L     @14,@SA00009                                        0802 03014000
         LM    @00,@02,@SA00009+8                                  0802 03015000
         LM    @04,@12,@SA00009+20                                 0802 03016000
         BR    @14                                                 0802 03017000
*        END DSDRLIST;                                             0803 03018000
*                                                                  0803 03019000
*        END IDCCK01                                               0804 03020000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 03021000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 03022000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 03023000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 03024000
*/*%INCLUDE SYSLIB  (IDCCSCK )                                        * 03025000
*;                                                                 0804 03026000
@DATA    DS    0H                                                       03027000
@CH00150 DC    H'6'                                                     03028000
@CH00617 DC    H'7'                                                     03029000
@CH00173 DC    H'8'                                                     03030000
@CH00897 DC    H'18'                                                    03031000
@CH00899 DC    H'35'                                                    03032000
@CH00898 DC    H'63'                                                    03033000
@CH00896 DC    H'241'                                                   03034000
@CH00786 DC    H'-1'                                                    03035000
         DS    0F                                                       03036000
@AL00314 DC    A(@CC00568)             LIST WITH   2 ARGUMENT(S)        03037000
         DC    AL1(X'80')                                               03038000
         DC    AL3(ALL)                                                 03039000
@DATD    DSECT                                                          03040000
         DS    0F                                                       03041000
@SA00001 DS    18F                                                      03042000
@PC00001 DS    3F                                                       03043000
@SA00002 DS    15F                                                      03044000
@SA00003 DS    15F                                                      03045000
@PC00003 DS    2F                                                       03046000
@SA00004 DS    14F                                                      03047000
@PC00004 DS    4F                                                       03048000
@SA00006 DS    15F                                                      03049000
@PC00006 DS    2F                                                       03050000
@SA00005 DS    14F                                                      03051000
@PC00005 DS    2F                                                       03052000
@SA00008 DS    14F                                                      03053000
@PC00008 DS    4F                                                       03054000
@SA00009 DS    14F                                                      03055000
@PC00009 DS    1F                                                       03056000
@SA00007 DS    15F                                                      03057000
@PC00007 DS    7F                                                       03058000
@AL00001 DS    7A                                                       03059000
IDCCK01  CSECT                                                          03060000
         DS    0F                                                       03061000
@CF00111 DC    F'0'                                                     03062000
@CF00213 DC    F'1'                                                     03063000
@CH00213 EQU   @CF00213+2                                               03064000
@CF00147 DC    F'2'                                                     03065000
@CH00147 EQU   @CF00147+2                                               03066000
@CF00156 DC    F'3'                                                     03067000
@CF00041 DC    F'4'                                                     03068000
@CF00266 DC    F'5'                                                     03069000
@CH00266 EQU   @CF00266+2                                               03070000
@CF00536 DC    F'12'                                                    03071000
@CF00465 DC    F'16'                                                    03072000
@CH00465 EQU   @CF00465+2                                               03073000
@CF00893 DC    F'17'                                                    03074000
@CH00893 EQU   @CF00893+2                                               03075000
@CF00718 DC    F'178'                                                   03076000
@CF00894 DC    F'400'                                                   03077000
@CF00895 DC    F'401'                                                   03078000
@CF00905 DC    F'-15'                                                   03079000
@DATD    DSECT                                                          03080000
         DS    0D                                                       03081000
LISTSCAN DS    A                                                        03082000
IOCSPTR  DS    A                                                        03083000
DDSTRU   DS    A                                                        03084000
FSADDR   DS    A                                                        03085000
DMPINDEX DS    A                                                        03086000
GPLEN    DS    F                                                        03087000
INIOCP   DS    A                                                        03088000
OUTIOCP  DS    A                                                        03089000
IDTABPTR DS    A                                                        03090000
IDEOTPTR DS    A                                                        03091000
LOGRECP  DS    A                                                        03092000
SIZE     DS    F                                                        03093000
LISTPTR  DS    A                                                        03094000
SETRC    DS    H                                                        03095000
EOF      DS    H                                                        03096000
NVOLS    DS    H                                                        03097000
VOLSEQ   DS    H                                                        03098000
LISTLN   DS    FL1                                                      03099000
@TS00001 DS    CL95                                                     03100000
INARGLST DS    BL48                                                     03101000
OTARGLST DS    BL48                                                     03102000
PCARG    DS    CL33                                                     03103000
         ORG   PCARG                                                    03104000
PCMTLP   DS    AL4                                                      03105000
PCSTLP   DS    AL4                                                      03106000
PCFLP    DS    AL4                                                      03107000
PCPCP    DS    AL4                                                      03108000
PCPNL    DS    FL2                                                      03109000
PCPTL    DS    FL2                                                      03110000
PCPDL    DS    FL2                                                      03111000
PCMTLC   DS    FL2                                                      03112000
PCSTLC   DS    FL2                                                      03113000
PCFLC    DS    FL2                                                      03114000
PCLW     DS    FL2                                                      03115000
PCPD     DS    FL2                                                      03116000
PCDSC    DS    AL1                                                      03117000
         ORG   PCARG+33                                                 03118000
SUBLINES DS    CL242                                                    03119000
         ORG   SUBLINES                                                 03120000
CARRC1   DS    CL1                                                      03121000
SUBLNBUF DS    CL241                                                    03122000
         ORG   SUBLNBUF                                                 03123000
@NM00034 DS    CL51                                                     03124000
SUBLNDS  DS    CL44                                                     03125000
@NM00035 DS    CL25                                                     03126000
CARRC2   DS    CL1                                                      03127000
@NM00036 DS    CL120                                                    03128000
         ORG   SUBLINES+242                                             03129000
SUBDSNAM DS    CL44                                                     03130000
         DS    CL1                                                      03131000
DARGAREA DS    CL20                                                     03132000
TDSINFO  DS    CL63                                                     03133000
         ORG   TDSINFO                                                  03134000
TDSNAME  DS    CL44                                                     03135000
TDDNAME  DS    CL8                                                      03136000
TUNIT    DS    CL4                                                      03137000
TTRK     DS    CL5                                                      03138000
TVLSQ    DS    FL1                                                      03139000
TNVOL    DS    FL1                                                      03140000
         ORG   TDSINFO+63                                               03141000
TVOLINFO DS    CL35                                                     03142000
         ORG   TVOLINFO                                                 03143000
TVOLS    DS    CL7                                                      03144000
         ORG   TVOLS+0                                                  03145000
TVOL     DS    CL6                                                      03146000
TASTER   DS    CL1                                                      03147000
         ORG   TVOLINFO+35                                              03148000
SYSID    DS    CL1                                                      03149000
         ORG   SYSID                                                    03150000
@NM00053 DS    BL1                                                      03151000
SYSIDVS1 EQU   SYSID+0                                                  03152000
SYSIDVS2 EQU   SYSID+0                                                  03153000
@NM00054 EQU   SYSID+0                                                  03154000
         ORG   SYSID+1                                                  03155000
CHRFND   DS    BL1                                                      03156000
MSGDDNAM DS    CL8                                                      03157000
NEEDCHR  DS    BL1                                                      03158000
USERSPEC DS    BL1                                                      03159000
GCSTOP   DS    BL1                                                      03160000
DSDR1FND DS    BL1                                                      03161000
VLSQMSG  DS    BL1                                                      03162000
GETNXTSW DS    BL1                                                      03163000
NEEDD2   DS    BL1                                                      03164000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03165000
@ENDDATD EQU   *                                                        03166000
IDCCK01  CSECT                                                          03167000
         DS    0F                                                       03168000
@SIZDATD DC    AL1(0)                                                   03169000
         DC    AL3(@ENDDATD-@DATD)                                      03170000
         DS    0D                                                       03171000
@CC00644 DC    C'$$/%@/$ CHR %@/$//%'                                   03172000
@CC00657 DC    C'-9TRK'                                                 03173000
@CC00659 DC    C'-7TRK'                                                 03174000
@CC00568 DC    C'CK00'                                                  03175000
@CC00661 DC    C'2400'                                                  03176000
@CC00663 DC    C'3400'                                                  03177000
@CC00665 DC    C'****'                                                  03178000
@CC00753 DC    C'CKCK'                                                  03179000
@CC00762 DC    C'CK10'                                                  03180000
@CC00764 DC    C'CK20'                                                  03181000
@CC00769 DC    C'CKHS'                                                  03182000
@CC00777 DC    C'CKBD'                                                  03183000
@CC00799 DC    C'CKCP'                                                  03184000
@CC00815 DC    C'CKGC'                                                  03185000
@CC00833 DC    C'CKDP'                                                  03186000
@CC00839 DC    C'CK30'                                                  03187000
@CC00844 DC    C'CK40'                                                  03188000
@CC00867 DC    C'CKDV'                                                  03189000
@CC00872 DC    C'CK50'                                                  03190000
@CC00884 DC    C'CKGN'                                                  03191000
@CC00892 DC    C'CKDL'                                                  03192000
@CC00604 DC    C'UV0'                                                   03193000
@CC00609 EQU   @CC00568                                                 03194000
@CB00671 DC    X'0001'                                                  03195000
@CB00673 DC    X'0000'                                                  03196000
@CB00675 DC    X'0004'                                                  03197000
@CB00677 DC    X'0014'                                                  03198000
@CB00679 DC    X'0010'                                                  03199000
ALL      DC    CL3'ALL'                                                 03200000
FORMAT   DC    CL4'FORM'                                                03201000
HSECOND  DC    CL4'HSEC'                                                03202000
CLOCK    DC    CL4'KLOK'                                                03203000
SETZERO  DC    CL4'ZERO'                                                03204000
SETBLANK DC    CL4'BLNK'                                                03205000
NOSET    DC    CL4'NSET'                                                03206000
OVERRIDE DC    CL4'OVRD'                                                03207000
ACQUIRE  DC    CL8'ACQUIRE '                                            03208000
RELINQ   DC    CL8'RELINQ  '                                            03209000
MOUNT    DC    CL8'MOUNT   '                                            03210000
DEMOUNT  DC    CL8'DEMOUNT '                                            03211000
DEFINE   DC    CL8'DEFINE  '                                            03212000
MOVE     DC    CL8'MOVE    '                                            03213000
TRACEQ   DC    CL8'TRACEQ  '                                            03214000
COPYTABL DC    CL8'COPYTABL'                                            03215000
COPYCRTG DC    CL8'COPYCRTG'                                            03216000
COPYVOL  DC    CL8'COPYVOL '                                            03217000
VVIC     DC    CL8'VVIC    '                                            03218000
TUNE     DC    CL8'TUNE    '                                            03219000
NAMES    DC    CL4'NAME'                                                03220000
UNIT     DC    CL4'UNIT'                                                03221000
SHR      DC    CL4'SHR '                                                03222000
EXCL     DC    CL4'EXCL'                                                03223000
NOWAIT   DC    CL4'NWAI'                                                03224000
WAIT     DC    CL4'WAIT'                                                03225000
MODID    DC    CL4'CK01'                                                03226000
FIXAREA  DS    CL256                                                    03227000
         ORG   FIXAREA                                                  03228000
@NM00033 DC    256X'00'                                                 03229000
         ORG   FIXAREA+256                                              03230000
BLANKS   DS    CL256                                                    03231000
         ORG   BLANKS                                                   03232000
@NM00039 DC    256CL1' '                                                03233000
         ORG   BLANKS+256                                               03234000
ZEROAREA DS    CL256                                                    03235000
         ORG   ZEROAREA                                                 03236000
@NM00040 DC    256X'00'                                                 03237000
         ORG   ZEROAREA+256                                             03238000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03239000
@01      EQU   01                                                       03240000
@02      EQU   02                                                       03241000
@03      EQU   03                                                       03242000
@04      EQU   04                                                       03243000
@05      EQU   05                                                       03244000
@06      EQU   06                                                       03245000
@07      EQU   07                                                       03246000
@08      EQU   08                                                       03247000
@09      EQU   09                                                       03248000
@10      EQU   10                                                       03249000
@11      EQU   11                                                       03250000
@12      EQU   12                                                       03251000
@13      EQU   13                                                       03252000
@14      EQU   14                                                       03253000
@15      EQU   15                                                       03254000
DSDR1LNG EQU   @05                                                      03255000
J        EQU   @06                                                      03256000
I        EQU   @04                                                      03257000
DSDR2PTR EQU   @02                                                      03258000
DSDR1PTR EQU   @02                                                      03259000
IDNXTPTR EQU   @05                                                      03260000
IDTABWKP EQU   @02                                                      03261000
OPNPTR   EQU   @02                                                      03262000
TESTRC   EQU   @03                                                      03263000
REG11    EQU   @11                                                      03264000
REG12    EQU   @12                                                      03265000
RTNREG   EQU   @15                                                      03266000
REG0     EQU   @00                                                      03267000
REG1     EQU   @01                                                      03268000
REG10    EQU   @10                                                      03269000
REG13    EQU   @13                                                      03270000
REG14    EQU   @14                                                      03271000
REG15    EQU   @15                                                      03272000
REG2     EQU   @02                                                      03273000
REG3     EQU   @03                                                      03274000
REG4     EQU   @04                                                      03275000
REG5     EQU   @05                                                      03276000
REG6     EQU   @06                                                      03277000
REG7     EQU   @07                                                      03278000
REG8     EQU   @08                                                      03279000
REG9     EQU   @09                                                      03280000
IDCSAEP0 EQU   0                                                        03281000
IDCSAGP0 EQU   0                                                        03282000
IDCSAFP0 EQU   0                                                        03283000
TRACE1   EQU   0                                                        03284000
OLDERID1 EQU   TRACE1                                                   03285000
TRACE2   EQU   0                                                        03286000
OLDERID2 EQU   TRACE2                                                   03287000
NEWID2   EQU   TRACE2+95                                                03288000
NEWERID2 EQU   5                                                        03289000
CIRAGL   EQU   0                                                        03290000
CIRTYPE  EQU   CIRAGL                                                   03291000
ALLAGL   EQU   0                                                        03292000
ALLSTS   EQU   ALLAGL+24                                                03293000
ALLDSP   EQU   ALLAGL+25                                                03294000
ALLORG   EQU   ALLAGL+26                                                03295000
ALLOPT   EQU   ALLAGL+28                                                03296000
UNITABL  EQU   0                                                        03297000
UNITADR  EQU   UNITABL+4                                                03298000
@NM00010 EQU   UNITADR                                                  03299000
UNITSTAT EQU   UNITABL+6                                                03300000
IDCIOOP0 EQU   0                                                        03301000
IDCIOCL0 EQU   0                                                        03302000
IDCIOGT0 EQU   0                                                        03303000
IOCSTR   EQU   0                                                        03304000
IOCDAD   EQU   IOCSTR                                                   03305000
IOCDLN   EQU   IOCSTR+4                                                 03306000
IOCDSO   EQU   IOCSTR+16                                                03307000
IOCRFM   EQU   IOCSTR+17                                                03308000
IOCMAC   EQU   IOCSTR+18                                                03309000
IOCMAC2  EQU   IOCSTR+19                                                03310000
IOCCHP   EQU   IOCSTR+20                                                03311000
IOCMSG   EQU   IOCSTR+21                                                03312000
IOCDSN   EQU   IOCSTR+32                                                03313000
IOCRBA   EQU   IOCSTR+40                                                03314000
IOCTTR   EQU   IOCRBA                                                   03315000
IOCMEM   EQU   IOCSTR+44                                                03316000
IOCNWM   EQU   IOCSTR+48                                                03317000
OPNAGL   EQU   0                                                        03318000
OPNOPT   EQU   OPNAGL                                                   03319000
OPNOPTIN EQU   OPNOPT                                                   03320000
OPNOPTOT EQU   OPNOPT                                                   03321000
OPNOPTBK EQU   OPNOPT                                                   03322000
OPNRFM   EQU   OPNAGL+1                                                 03323000
OPNRFMUN EQU   OPNRFM                                                   03324000
OPNTYP   EQU   OPNAGL+2                                                 03325000
OPNMOD   EQU   OPNAGL+3                                                 03326000
OPNMODAC EQU   OPNMOD                                                   03327000
OPNIOC   EQU   OPNAGL+4                                                 03328000
OPNDDN   EQU   OPNAGL+8                                                 03329000
OPNDEV   EQU   OPNAGL+24                                                03330000
OPNBLK   EQU   OPNAGL+36                                                03331000
OPNDSO   EQU   OPNAGL+41                                                03332000
OPNDSOPS EQU   OPNDSO                                                   03333000
OPNOPT2  EQU   OPNAGL+42                                                03334000
IOINFOPT EQU   0                                                        03335000
UVOLLIST EQU   0                                                        03336000
UVOLENT  EQU   UVOLLIST+2                                               03337000
AMSTP011 EQU   0                                                        03338000
AMSTP042 EQU   0                                                        03339000
DARGLIST EQU   0                                                        03340000
DARGDBP  EQU   DARGLIST                                                 03341000
DARGRETP EQU   DARGLIST+4                                               03342000
DARGSTID EQU   DARGLIST+8                                               03343000
DARGSMOD EQU   DARGSTID                                                 03344000
DARGSENT EQU   DARGSTID+3                                               03345000
DARGILP  EQU   DARGLIST+12                                              03346000
DARGRETL EQU   DARGLIST+16                                              03347000
DARGARY  EQU   DARGLIST+20                                              03348000
DARGINS  EQU   DARGARY                                                  03349000
DARGINL  EQU   DARGARY+2                                                03350000
FMTLIST  EQU   0                                                        03351000
FMTFLGS  EQU   FMTLIST                                                  03352000
FMTSPF   EQU   FMTLIST+2                                                03353000
FMTRFNO  EQU   FMTSPF                                                   03354000
FMTILEN  EQU   FMTRFNO                                                  03355000
FMTIOFF  EQU   FMTLIST+4                                                03356000
FMTTRBC  EQU   FMTIOFF                                                  03357000
FMTSTO   EQU   FMTTRBC                                                  03358000
FMTOCOL  EQU   FMTLIST+6                                                03359000
FMTCNVF  EQU   FMTLIST+10                                               03360000
IDCDB010 EQU   0                                                        03361000
DMPITM   EQU   0                                                        03362000
DMPARY   EQU   0                                                        03363000
IFILE    EQU   0                                                        03364000
IFILEVAL EQU   IFILE+1                                                  03365000
OFILE    EQU   0                                                        03366000
OFILEVAL EQU   OFILE+1                                                  03367000
CHKID    EQU   0                                                        03368000
CHKIDCNT EQU   CHKID                                                    03369000
@NM00032 EQU   CHKID+2                                                  03370000
CHKIDVAL EQU   @NM00032+1                                               03371000
INFDSNAM EQU   0                                                        03372000
IDCOUNT  EQU   0                                                        03373000
IDTABLE  EQU   0                                                        03374000
@NM00037 EQU   IDTABLE                                                  03375000
IDFOUND  EQU   @NM00037                                                 03376000
IDCHKID  EQU   IDTABLE+1                                                03377000
CHR      EQU   0                                                        03378000
CHRCHKID EQU   CHR+4                                                    03379000
CHRSYSID EQU   CHR+60                                                   03380000
CHRIDENT EQU   CHR+61                                                   03381000
DSDR1REC EQU   0                                                        03382000
DSDRTYPE EQU   DSDR1REC                                                 03383000
DSDRJFCB EQU   DSDR1REC+2                                               03384000
JFCBDSNM EQU   DSDRJFCB                                                 03385000
JFCBNVOL EQU   DSDRJFCB+117                                             03386000
JFCBVOLS EQU   DSDRJFCB+118                                             03387000
JFCBVOL  EQU   JFCBVOLS                                                 03388000
JVOLBYT1 EQU   JFCBVOL                                                  03389000
JFCBEXAD EQU   DSDRJFCB+149                                             03390000
DSDRDDNM EQU   DSDR1REC+178                                             03391000
DSDRUCBT EQU   DSDR1REC+186                                             03392000
UCBTBYT2 EQU   DSDRUCBT+1                                               03393000
UCB7TRK  EQU   UCBTBYT2                                                 03394000
UCBTBYT3 EQU   DSDRUCBT+2                                               03395000
UCBTBYT4 EQU   DSDRUCBT+3                                               03396000
VS1DVLSQ EQU   DSDR1REC+190                                             03397000
VS2DVLSQ EQU   DSDR1REC+194                                             03398000
DSDR2REC EQU   0                                                        03399000
DSDR2TYP EQU   DSDR2REC                                                 03400000
JFCBX    EQU   DSDR2REC+2                                               03401000
JFCBXVOL EQU   JFCBX+4                                                  03402000
JFXVOL   EQU   JFCBXVOL                                                 03403000
JFCBXNXT EQU   JFCBX+172                                                03404000
CHKPTREC EQU   0                                                        03405000
RECTYPE  EQU   CHKPTREC                                                 03406000
AMSTP041 EQU   0                                                        03407000
AMSTP043 EQU   0                                                        03408000
AMSTP044 EQU   0                                                        03409000
DMPTRM   EQU   0                                                        03410000
IDCIOCO0 EQU   0                                                        03411000
IDCIOIT0 EQU   0                                                        03412000
IDCIOPO0 EQU   0                                                        03413000
IDCIOPT0 EQU   0                                                        03414000
IDCIOSI0 EQU   0                                                        03415000
IDCIOST0 EQU   0                                                        03416000
IDCIOTM0 EQU   0                                                        03417000
IDCIOVY0 EQU   0                                                        03418000
IDCIO050 EQU   0                                                        03419000
IDCSAAL0 EQU   0                                                        03420000
IDCSACA0 EQU   0                                                        03421000
IDCSACL0 EQU   0                                                        03422000
IDCSACR0 EQU   0                                                        03423000
IDCSADE0 EQU   0                                                        03424000
IDCSADL0 EQU   0                                                        03425000
IDCSADQ0 EQU   0                                                        03426000
IDCSAFS0 EQU   0                                                        03427000
IDCSAGS0 EQU   0                                                        03428000
IDCSAID0 EQU   0                                                        03429000
IDCSALD0 EQU   0                                                        03430000
IDCSALK0 EQU   0                                                        03431000
IDCSANQ0 EQU   0                                                        03432000
IDCSAPR0 EQU   0                                                        03433000
IDCSAPT0 EQU   0                                                        03434000
IDCSAQL0 EQU   0                                                        03435000
IDCSARC0 EQU   0                                                        03436000
IDCSARV0 EQU   0                                                        03437000
IDCSASC0 EQU   0                                                        03438000
IDCSASI0 EQU   0                                                        03439000
IDCSASN0 EQU   0                                                        03440000
IDCSASS0 EQU   0                                                        03441000
IDCSAST0 EQU   0                                                        03442000
IDCSATI0 EQU   0                                                        03443000
IDCSAWO0 EQU   0                                                        03444000
IDCSA060 EQU   0                                                        03445000
IDCST010 EQU   0                                                        03446000
LISTTEST EQU   0                                                        03447000
NEWERID1 EQU   5                                                        03448000
GDTTBL   EQU   0                                                        03449000
GDTTR1   EQU   GDTTBL+8                                                 03450000
GDTTR2   EQU   GDTTBL+12                                                03451000
GDTDBG   EQU   GDTTBL+40                                                03452000
GDTSTC   EQU   GDTTBL+44                                                03453000
GDTPRT   EQU   GDTTBL+48                                                03454000
GDTESS   EQU   GDTTBL+52                                                03455000
GDTESA   EQU   GDTTBL+56                                                03456000
GDTRST   EQU   GDTTBL+60                                                03457000
GDTRES   EQU   GDTTBL+64                                                03458000
GDTCAL   EQU   GDTTBL+68                                                03459000
GDTGSP   EQU   GDTTBL+72                                                03460000
GDTFSP   EQU   GDTTBL+76                                                03461000
GDTGPL   EQU   GDTTBL+80                                                03462000
GDTFPL   EQU   GDTTBL+84                                                03463000
GDTLOD   EQU   GDTTBL+88                                                03464000
GDTDEL   EQU   GDTTBL+92                                                03465000
GDTPRL   EQU   GDTTBL+96                                                03466000
GDTEPL   EQU   GDTTBL+100                                               03467000
GDTTIM   EQU   GDTTBL+104                                               03468000
GDTIIO   EQU   GDTTBL+108                                               03469000
GDTTIO   EQU   GDTTBL+112                                               03470000
GDTOPN   EQU   GDTTBL+124                                               03471000
GDTCLS   EQU   GDTTBL+128                                               03472000
GDTGET   EQU   GDTTBL+132                                               03473000
GDTPUT   EQU   GDTTBL+136                                               03474000
GDTPOS   EQU   GDTTBL+140                                               03475000
GDTCPY   EQU   GDTTBL+144                                               03476000
GDTCAT   EQU   GDTTBL+148                                               03477000
GDTSNP   EQU   GDTTBL+164                                               03478000
GDTVFY   EQU   GDTTBL+172                                               03479000
GDTUID   EQU   GDTTBL+192                                               03480000
GDTPMT   EQU   GDTTBL+196                                               03481000
GDTCIR   EQU   GDTTBL+200                                               03482000
GDTLNK   EQU   GDTTBL+204                                               03483000
GDTALC   EQU   GDTTBL+208                                               03484000
GDTDLC   EQU   GDTTBL+212                                               03485000
GDTQAL   EQU   GDTTBL+216                                               03486000
GDTSTW   EQU   GDTTBL+220                                               03487000
GDTSSC   EQU   GDTTBL+224                                               03488000
GDTENQ   EQU   GDTTBL+228                                               03489000
GDTRSV   EQU   GDTTBL+232                                               03490000
GDTDEQ   EQU   GDTTBL+236                                               03491000
GDTSFO   EQU   GDTTBL+240                                               03492000
GDTWTO   EQU   GDTTBL+244                                               03493000
GDTSCR   EQU   GDTTBL+248                                               03494000
GDTUNT   EQU   GDTTBL+252                                               03495000
GDTRCT   EQU   GDTTBL+256                                               03496000
GDTIFO   EQU   GDTTBL+260                                               03497000
GDTEXP   EQU   GDTTBL+264                                               03498000
GDTSTA   EQU   GDTTBL+268                                               03499000
FDTTBL   EQU   0                                                        03500000
FDTPTR   EQU   FDTTBL+8                                                 03501000
LASTCC   EQU   0                                                        03502000
BDTABPTR EQU   0                                                        03503000
BDEOTPTR EQU   0                                                        03504000
CPSYSID  EQU   0                                                        03505000
CPNEEDCH EQU   0                                                        03506000
CPCHRFND EQU   0                                                        03507000
CPEOF    EQU   0                                                        03508000
GCCHRFND EQU   0                                                        03509000
GCEOF    EQU   0                                                        03510000
DPNEEDCH EQU   0                                                        03511000
DPEOF    EQU   0                                                        03512000
DVNVOLS  EQU   0                                                        03513000
DVVOLSEQ EQU   0                                                        03514000
DVSIZE   EQU   0                                                        03515000
DVLOGRCP EQU   0                                                        03516000
DVNEEDCH EQU   0                                                        03517000
DVGETNXT EQU   0                                                        03518000
DVEOF    EQU   0                                                        03519000
GNLOGRCP EQU   0                                                        03520000
GNSIZE   EQU   0                                                        03521000
GNNEEDCH EQU   0                                                        03522000
GNEOF    EQU   0                                                        03523000
DLVOLSEQ EQU   0                                                        03524000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03525000
FDTVERB  EQU   FDTTBL                                                   03526000
GDTECT   EQU   GDTTBL+188                                               03527000
GDTPSB   EQU   GDTTBL+184                                               03528000
GDTUPT   EQU   GDTTBL+180                                               03529000
GDTCMB   EQU   GDTTBL+176                                               03530000
GDTSPR   EQU   GDTTBL+168                                               03531000
@NM00001 EQU   GDTTBL+160                                               03532000
GDTABH   EQU   GDTTBL+156                                               03533000
GDTABT   EQU   GDTTBL+152                                               03534000
GDTTOH   EQU   GDTTBL+120                                               03535000
GDTRIP   EQU   GDTTBL+116                                               03536000
GDTIOH   EQU   GDTTBL+36                                                03537000
GDTSAH   EQU   GDTTBL+32                                                03538000
GDTTPH   EQU   GDTTBL+28                                                03539000
GDTRIH   EQU   GDTTBL+24                                                03540000
GDTSTH   EQU   GDTTBL+20                                                03541000
GDTDBH   EQU   GDTTBL+16                                                03542000
GDTPRM   EQU   GDTTBL+4                                                 03543000
GDTHDR   EQU   GDTTBL                                                   03544000
@NM00052 EQU   CHKPTREC+2                                               03545000
@NM00051 EQU   JFCBX+94                                                 03546000
@NM00050 EQU   JFCBX                                                    03547000
@NM00049 EQU   DSDR1REC+191                                             03548000
@NM00048 EQU   UCBTBYT2                                                 03549000
UCBTBYT1 EQU   DSDRUCBT                                                 03550000
@NM00047 EQU   DSDRJFCB+152                                             03551000
JFCBEXTL EQU   DSDRJFCB+148                                             03552000
@NM00046 EQU   JFCBVOL+1                                                03553000
@NM00045 EQU   DSDRJFCB+44                                              03554000
@NM00044 EQU   CHR+80                                                   03555000
@NM00043 EQU   CHR+20                                                   03556000
@NM00042 EQU   CHR+2                                                    03557000
@NM00041 EQU   CHR                                                      03558000
@NM00038 EQU   @NM00037                                                 03559000
CHKIDLEN EQU   @NM00032                                                 03560000
OFILELEN EQU   OFILE                                                    03561000
IFILELEN EQU   IFILE                                                    03562000
@NM00031 EQU   DMPARY+15                                                03563000
DMPARYTP EQU   DMPARY+14                                                03564000
DMPARYEX EQU   DMPARY+12                                                03565000
DMPARYIC EQU   DMPARY+10                                                03566000
DMPARYSZ EQU   DMPARY+8                                                 03567000
DMPARYNM EQU   DMPARY                                                   03568000
@NM00030 EQU   DMPITM+15                                                03569000
DMPITMTP EQU   DMPITM+14                                                03570000
DMPITMLN EQU   DMPITM+12                                                03571000
DMPITMPT EQU   DMPITM+8                                                 03572000
DMPITMNM EQU   DMPITM                                                   03573000
@NM00029 EQU   FMTCNVF+1                                                03574000
FMTBS    EQU   FMTCNVF+1                                                03575000
FMTSS    EQU   FMTCNVF+1                                                03576000
FMTAL    EQU   FMTCNVF+1                                                03577000
FMTZS    EQU   FMTCNVF+1                                                03578000
@NM00028 EQU   FMTCNVF                                                  03579000
FMTPU    EQU   FMTCNVF                                                  03580000
FMTBD    EQU   FMTCNVF                                                  03581000
FMTBHD   EQU   FMTCNVF                                                  03582000
FMTBHA   EQU   FMTCNVF                                                  03583000
FMTBH    EQU   FMTCNVF                                                  03584000
FMTOLEN  EQU   FMTLIST+8                                                03585000
FMTRIO   EQU   FMTOCOL                                                  03586000
FMTSPT   EQU   FMTSTO                                                   03587000
FMTSTL   EQU   FMTILEN                                                  03588000
@NM00027 EQU   FMTFLGS+1                                                03589000
FMTHDF   EQU   FMTFLGS                                                  03590000
FMTDFF   EQU   FMTFLGS                                                  03591000
FMTSTF   EQU   FMTFLGS                                                  03592000
FMTREPF  EQU   FMTFLGS                                                  03593000
FMTBDF   EQU   FMTFLGS                                                  03594000
FMTIDF   EQU   FMTFLGS                                                  03595000
FMTSCF   EQU   FMTFLGS                                                  03596000
FMTEOLF  EQU   FMTFLGS                                                  03597000
DARGDTM  EQU   DARGARY+4                                                03598000
DARGPCT  EQU   DARGINL                                                  03599000
DARGREP  EQU   DARGINS                                                  03600000
@NM00026 EQU   DARGLIST+19                                              03601000
DARGIND  EQU   DARGLIST+18                                              03602000
DARGCNT  EQU   DARGLIST+14                                              03603000
UVOLVOL  EQU   UVOLENT+4                                                03604000
UVOLDEV  EQU   UVOLENT                                                  03605000
UVOLCNT  EQU   UVOLLIST                                                 03606000
@NM00025 EQU   IOINFOPT                                                 03607000
IOINFTMS EQU   IOINFOPT                                                 03608000
IOINFSUP EQU   IOINFOPT                                                 03609000
IOINFDSN EQU   IOINFOPT                                                 03610000
IOINFVOL EQU   IOINFOPT                                                 03611000
IOINFDVT EQU   IOINFOPT                                                 03612000
OPNVOL   EQU   OPNAGL+44                                                03613000
@NM00024 EQU   OPNAGL+43                                                03614000
@NM00023 EQU   OPNOPT2                                                  03615000
OPNOPTJM EQU   OPNOPT2                                                  03616000
@NM00022 EQU   OPNOPT2                                                  03617000
OPNOPTAS EQU   OPNOPT2                                                  03618000
@NM00021 EQU   OPNDSO                                                   03619000
OPNDSOPO EQU   OPNDSO                                                   03620000
OPNDSOIS EQU   OPNDSO                                                   03621000
OPNDSOAM EQU   OPNDSO                                                   03622000
OPNKYL   EQU   OPNAGL+40                                                03623000
OPNREC   EQU   OPNAGL+32                                                03624000
OPNDEVIX EQU   OPNDEV+4                                                 03625000
OPNDEVDT EQU   OPNDEV                                                   03626000
OPNCBP   EQU   OPNAGL+20                                                03627000
OPNDSN   EQU   OPNAGL+16                                                03628000
OPNPWA   EQU   OPNAGL+12                                                03629000
OPNMODRP EQU   OPNMOD                                                   03630000
OPNMODUB EQU   OPNMOD                                                   03631000
OPNMODRS EQU   OPNMOD                                                   03632000
OPNMODAX EQU   OPNMOD                                                   03633000
OPNMODRR EQU   OPNMOD                                                   03634000
OPNMODRC EQU   OPNMOD                                                   03635000
OPNMODPD EQU   OPNMOD                                                   03636000
@NM00020 EQU   OPNTYP                                                   03637000
OPNTYPRV EQU   OPNTYP                                                   03638000
OPNTYPEX EQU   OPNTYP                                                   03639000
OPNTYPRA EQU   OPNTYP                                                   03640000
OPNTYPXM EQU   OPNTYP                                                   03641000
OPNTYPCI EQU   OPNTYP                                                   03642000
OPNTYPSO EQU   OPNTYP                                                   03643000
OPNTYPSI EQU   OPNTYP                                                   03644000
@NM00019 EQU   OPNRFM                                                   03645000
OPNRFMBK EQU   OPNRFM                                                   03646000
OPNRFMSF EQU   OPNRFM                                                   03647000
OPNRFMVR EQU   OPNRFM                                                   03648000
OPNRFMFX EQU   OPNRFM                                                   03649000
OPNOPTSK EQU   OPNOPT                                                   03650000
OPNOPTDR EQU   OPNOPT                                                   03651000
OPNOPTCR EQU   OPNOPT                                                   03652000
OPNOPTKS EQU   OPNOPT                                                   03653000
OPNOPTUP EQU   OPNOPT                                                   03654000
IOCEXT   EQU   IOCSTR+64                                                03655000
IOCREL   EQU   IOCSTR+60                                                03656000
IOCWORK  EQU   IOCSTR+56                                                03657000
IOCRRN   EQU   IOCSTR+52                                                03658000
IOCPNM   EQU   IOCNWM+2                                                 03659000
IOCPTL   EQU   IOCNWM                                                   03660000
IOCKYA   EQU   IOCMEM                                                   03661000
IOCVRC   EQU   IOCTTR                                                   03662000
IOCCBP   EQU   IOCSTR+36                                                03663000
IOCHURBA EQU   IOCSTR+28                                                03664000
IOCVOLSR EQU   IOCSTR+22                                                03665000
@NM00018 EQU   IOCMSG                                                   03666000
IOCMSGAE EQU   IOCMSG                                                   03667000
IOCMSGCE EQU   IOCMSG                                                   03668000
IOCMSGOE EQU   IOCMSG                                                   03669000
IOCMSGOP EQU   IOCMSG                                                   03670000
@NM00017 EQU   IOCMSG                                                   03671000
IOCCHPSY EQU   IOCCHP                                                   03672000
IOCCHPAS EQU   IOCCHP                                                   03673000
IOCCHPBK EQU   IOCCHP                                                   03674000
IOCCHPCR EQU   IOCCHP                                                   03675000
IOCCHPKS EQU   IOCCHP                                                   03676000
IOCCHPSK EQU   IOCCHP                                                   03677000
IOCCHPDR EQU   IOCCHP                                                   03678000
IOCCHPSQ EQU   IOCCHP                                                   03679000
@NM00016 EQU   IOCMAC2                                                  03680000
IOCMACPA EQU   IOCMAC2                                                  03681000
@NM00015 EQU   IOCMAC2                                                  03682000
IOCMACCP EQU   IOCMAC2                                                  03683000
IOCMACRR EQU   IOCMAC2                                                  03684000
IOCMACAS EQU   IOCMAC2                                                  03685000
IOCMACSK EQU   IOCMAC2                                                  03686000
@NM00014 EQU   IOCMAC                                                   03687000
IOCMACCC EQU   IOCMAC                                                   03688000
IOCMACDR EQU   IOCMAC                                                   03689000
IOCMACBK EQU   IOCMAC                                                   03690000
IOCMACCR EQU   IOCMAC                                                   03691000
IOCMACUP EQU   IOCMAC                                                   03692000
IOCMACOT EQU   IOCMAC                                                   03693000
IOCMACIN EQU   IOCMAC                                                   03694000
@NM00013 EQU   IOCRFM                                                   03695000
IOCRFMBK EQU   IOCRFM                                                   03696000
IOCRFMSF EQU   IOCRFM                                                   03697000
IOCRFMUN EQU   IOCRFM                                                   03698000
IOCRFMVR EQU   IOCRFM                                                   03699000
IOCRFMFX EQU   IOCRFM                                                   03700000
@NM00012 EQU   IOCDSO                                                   03701000
IOCDSOPO EQU   IOCDSO                                                   03702000
IOCDSOIS EQU   IOCDSO                                                   03703000
IOCDSOPS EQU   IOCDSO                                                   03704000
IOCDSOAM EQU   IOCDSO                                                   03705000
IOCRKP   EQU   IOCSTR+13                                                03706000
IOCKYL   EQU   IOCSTR+12                                                03707000
IOCTRN   EQU   IOCSTR+8                                                 03708000
UNITVTOC EQU   UNITABL+7                                                03709000
@NM00011 EQU   UNITSTAT                                                 03710000
UNITXSHR EQU   UNITSTAT                                                 03711000
UNITISHR EQU   UNITSTAT                                                 03712000
UNITUA   EQU   @NM00010+1                                               03713000
UNITCHA  EQU   @NM00010                                                 03714000
UNITUCB  EQU   UNITABL                                                  03715000
ALLUNCNT EQU   ALLAGL+30                                                03716000
ALLVLCNT EQU   ALLAGL+29                                                03717000
@NM00009 EQU   ALLOPT                                                   03718000
ALLOPTPV EQU   ALLOPT                                                   03719000
ALLOPTDS EQU   ALLOPT                                                   03720000
ALLOPTVL EQU   ALLOPT                                                   03721000
@NM00008 EQU   ALLORG+1                                                 03722000
ALLORGVS EQU   ALLORG+1                                                 03723000
@NM00007 EQU   ALLORG+1                                                 03724000
ALLORGGS EQU   ALLORG+1                                                 03725000
ALLORGUN EQU   ALLORG                                                   03726000
ALLORGPO EQU   ALLORG                                                   03727000
ALLORGMQ EQU   ALLORG                                                   03728000
ALLORGCQ EQU   ALLORG                                                   03729000
ALLORGCX EQU   ALLORG                                                   03730000
ALLORGDA EQU   ALLORG                                                   03731000
ALLORGPS EQU   ALLORG                                                   03732000
ALLORGIS EQU   ALLORG                                                   03733000
ALLDSPUN EQU   ALLDSP                                                   03734000
ALLDSPCG EQU   ALLDSP                                                   03735000
ALLDSPDE EQU   ALLDSP                                                   03736000
ALLDSPKP EQU   ALLDSP                                                   03737000
@NM00006 EQU   ALLDSP                                                   03738000
ALLSTSOD EQU   ALLSTS                                                   03739000
ALLSTSMD EQU   ALLSTS                                                   03740000
ALLSTSNW EQU   ALLSTS                                                   03741000
ALLSTSSR EQU   ALLSTS                                                   03742000
@NM00005 EQU   ALLSTS                                                   03743000
ALLPWD   EQU   ALLAGL+20                                                03744000
ALLVLP   EQU   ALLAGL+16                                                03745000
ALLULP   EQU   ALLAGL+12                                                03746000
ALLDDN   EQU   ALLAGL+4                                                 03747000
ALLDSN   EQU   ALLAGL                                                   03748000
CIRPID   EQU   CIRAGL+28                                                03749000
CIRPWD   EQU   CIRAGL+24                                                03750000
CIRCAT   EQU   CIRAGL+20                                                03751000
CIRWKP   EQU   CIRAGL+16                                                03752000
CIRTLR   EQU   CIRAGL+12                                                03753000
CIRHDR   EQU   CIRAGL+8                                                 03754000
CIRTLN   EQU   CIRAGL+6                                                 03755000
CIRHLN   EQU   CIRAGL+4                                                 03756000
@NM00004 EQU   CIRAGL+1                                                 03757000
@NM00003 EQU   CIRTYPE                                                  03758000
CIRTYPAQ EQU   CIRTYPE                                                  03759000
CIRTYP1Q EQU   CIRTYPE                                                  03760000
NEWID1   EQU   TRACE1+95                                                03761000
CALLID   EQU   OLDERID1+90                                              03762000
@NM00002 EQU   OLDERID1                                                 03763000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03764000
@RC00472 EQU   @RC00469                                                 03765000
@RC00579 EQU   @RC00573                                                 03766000
@RC00764 EQU   @RC00763                                                 03767000
@RC00767 EQU   @RC00763                                                 03768000
@PB00009 EQU   @EL00001                                                 03769000
@RC00583 EQU   @RC00579                                                 03770000
@RC00581 EQU   @RC00579                                                 03771000
@PB00008 EQU   @PB00009                                                 03772000
@PB00007 EQU   @PB00008                                                 03773000
@PB00006 EQU   @PB00007                                                 03774000
@PB00005 EQU   @PB00006                                                 03775000
@PB00004 EQU   @PB00005                                                 03776000
@PB00003 EQU   @PB00004                                                 03777000
@PB00002 EQU   @PB00003                                                 03778000
@ENDDATA EQU   *                                                        03779000
         END   IDCCK01,(C'PLS0502',0602,75012)                          03780000
