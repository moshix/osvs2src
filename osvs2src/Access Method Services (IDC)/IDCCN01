         TITLE '**** IDCCN01:  CONVERTV FUNCTION SUPPORT ROUTINE ****  *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCN01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCN01   76.342'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @03,0                                               0002 00021000
@PSTART  LA    @04,4095(,@03)                                      0002 00022000
         LA    @05,4095(,@04)                                      0002 00023000
         LA    @06,4095(,@05)                                      0002 00024000
         USING @PSTART,@03                                         0002 00025000
         USING @PSTART+4095,@04                                    0002 00026000
         USING @PSTART+8190,@05                                    0002 00027000
         USING @PSTART+12285,@06                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @12,@01                                             0002 00031000
         USING @DATD,@12                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @12,8(,@13)                                         0002 00035000
         LR    @13,@12                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0323 00038000
*/********************************************************** @Y30LB34*/ 00039000
*/*                                                          @Y30LB34*/ 00040000
*/*  THIS IS THE BEGINNING OF THE MAIN PROCEDURE - IDCCN01   @Y30LB34*/ 00041000
*/*                                                          @Y30LB34*/ 00042000
*/*  FUNCTION - CALLS PROCEDURES TO RETRIEVE SOURCE AND      @Y30LB34*/ 00043000
*/*             TARGET VOLUME INFORMATION.                   @Y30LB34*/ 00044000
*/*                                                          @Y30LB34*/ 00045000
*/*             DETERMINES APPROPRIATE PATH DEPENDING ON     @Y30LB34*/ 00046000
*/*             TYPE OF CONVERSION.  CALLS RVPROC FOR REAL   @Y30LB34*/ 00047000
*/*             TO VIRTUAL.  CALLS VRPROC FOR VIRTUAL TO     @Y30LB34*/ 00048000
*/*             REAL.                                        @Y30LB34*/ 00049000
*/*                                                          @Y30LB34*/ 00050000
*/*             IF FUNCTION IS COMPLETED WITH A CONDITION    @Y30LB34*/ 00051000
*/*             CODE LESS THAN 12, ISSUES MESSAGE IDC0001I.  @Y30LB34*/ 00052000
*/*                                                          @Y30LB34*/ 00053000
*/*             IF FUNCTION TERMINATES WITH A CONDITION      @Y30LB34*/ 00054000
*/*             CODE OF 12, ISSUES MESSAGE IDC0003I.         @Y30LB34*/ 00055000
*/*                                                          @Y30LB34*/ 00056000
*/********************************************************** @Y30LB34*/ 00057000
*                                                                  0323 00058000
*                                                                  0323 00059000
*   /*****************************************************************/ 00060000
*   /*                                                               */ 00061000
*   /* ESTABLISH A TRACE POINT AT THE BEGINNING OF THE       @Y30LB34*/ 00062000
*   /* PROCEDURE                                             @Y30LB34*/ 00063000
*   /*                                                               */ 00064000
*   /*****************************************************************/ 00065000
*                                                                  0323 00066000
*   OLDERID2=NEWERID2;                                             0323 00067000
         L     @07,@PC00001                                        0323 00068000
         L     @15,GDTTR2(,@07)                                    0323 00069000
         MVC   @TS00001(95),NEWERID2(@15)                          0323 00070000
         MVC   OLDERID2(95,@15),@TS00001                           0323 00071000
*   NEWID2='CNST';                  /*                       @Y30LB34*/ 00072000
*                                                                  0324 00073000
         MVC   NEWID2(4,@15),@CC01652                              0324 00074000
*   /*****************************************************************/ 00075000
*   /*                                                               */ 00076000
*   /* ESTABLISH ADDRESSABILITY TO DATA AREAS                @Y30LB34*/ 00077000
*   /*                                                               */ 00078000
*   /*****************************************************************/ 00079000
*                                                                  0325 00080000
*   RESPECIFY                                                      0325 00081000
*     EXCLAGL BASED(ADDR(EXCLAR));  /*                       @YD00175*/ 00082000
*   RESPECIFY                                                      0326 00083000
*     UNITABL BASED(UNITABLP);      /*                       @Y30LB34*/ 00084000
*   UNITABLP=ADDR(UNITABLA);        /*                       @Y30LB34*/ 00085000
         LA    @15,UNITABLA                                        0327 00086000
         ST    @15,UNITABLP                                        0327 00087000
*   OPNPTR=ADDR(OPNAREA);           /*                       @Y30LB34*/ 00088000
         LA    OPNPTR,OPNAREA                                      0328 00089000
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB34*/ 00090000
         LA    @15,PRINTTAB                                        0329 00091000
         ST    @15,DDSTRU                                          0329 00092000
*   CVOLPTR=ADDR(CVOLAR);           /*                       @Y30LB34*/ 00093000
         LA    @15,CVOLAR                                          0330 00094000
         ST    @15,CVOLPTR                                         0330 00095000
*   RVVIPTR=ADDR(RVVIAREA);         /*                       @Y30LB34*/ 00096000
         LA    @15,RVVIAREA                                        0331 00097000
         ST    @15,RVVIPTR                                         0331 00098000
*   BASEVPTR=ADDR(BASEVAR);         /*                       @Y30LB34*/ 00099000
         LA    @15,BASEVAR                                         0332 00100000
         ST    @15,BASEVPTR                                        0332 00101000
*   MVRPTR=ADDR(MVRAREA);           /*                       @Y30LB34*/ 00102000
         LA    @15,MVRAREA                                         0333 00103000
         ST    @15,MVRPTR                                          0333 00104000
*   COVCEPTR=ADDR(COVCEAR);         /*                       @Y30LB34*/ 00105000
         LA    @15,COVCEAR                                         0334 00106000
         ST    @15,COVCEPTR                                        0334 00107000
*   RESPECIFY                                                      0335 00108000
*     IOINFOPT BASED(ADDR(IOINFAR));/*                       @Y30LB34*/ 00109000
*   INFOPTR=ADDR(INFOAREA);         /*                       @Y30LB34*/ 00110000
         LA    @15,INFOAREA                                        0336 00111000
         ST    @15,INFOPTR                                         0336 00112000
*   RESPECIFY                                                      0337 00113000
*     MDAGL BASED(ADDR(MDAGLAR));   /*                       @Y30LB34*/ 00114000
*   RESPECIFY                                                      0338 00115000
*     PUAGL BASED(ADDR(PUAGLAR));   /*                       @Y30LB34*/ 00116000
*   RESPECIFY                                                      0339 00117000
*     CKAGL BASED(ADDR(CKAGLAR));   /*                       @Y30LB34*/ 00118000
*   RESPECIFY                                                      0340 00119000
*     VS2AGL BASED(ADDR(VS2AGLAR)); /*                       @Y30LB34*/ 00120000
*                                                                  0340 00121000
*   /*****************************************************************/ 00122000
*   /*                                                               */ 00123000
*   /* INITIALIZE PARAMETER LISTS AND DATA AREAS TO ZERO     @Y30LB34*/ 00124000
*   /*                                                               */ 00125000
*   /*****************************************************************/ 00126000
*                                                                  0341 00127000
*   UNITABLA=''B;                   /*                       @Y30LB34*/ 00128000
         XC    UNITABLA(11),UNITABLA                               0341 00129000
*   FRVS1AGL=''B;                   /*                       @Y30LB34*/ 00130000
         XC    FRVS1AGL(74),FRVS1AGL                               0342 00131000
*   TOVS1AGL=''B;                   /*                       @Y30LB34*/ 00132000
         XC    TOVS1AGL(74),TOVS1AGL                               0343 00133000
*   OPNAREA=''B;                    /*                       @Y30LB34*/ 00134000
         XC    OPNAREA(48),OPNAREA                                 0344 00135000
*   PRINTTAB=''B;                   /*                       @Y30LB34*/ 00136000
         XC    PRINTTAB(44),PRINTTAB                               0345 00137000
*   MDAGLAR=''B;                    /*                       @Y30LB34*/ 00138000
         XC    MDAGLAR(37),MDAGLAR                                 0346 00139000
*   PUAGLAR=''B;                    /*                       @Y30LB34*/ 00140000
         XC    PUAGLAR(20),PUAGLAR                                 0347 00141000
*   CKAGLAR=''B;                    /*                       @Y30LB34*/ 00142000
         XC    CKAGLAR(29),CKAGLAR                                 0348 00143000
*   VS2AGLAR=''B;                   /*                       @Y30LB34*/ 00144000
         XC    VS2AGLAR(52),VS2AGLAR                               0349 00145000
*   CVOLAR=''B;                     /*                       @Y30LB34*/ 00146000
         XC    CVOLAR(40),CVOLAR                                   0350 00147000
*   EXCLAGL=''B;                    /*                       @YD00175*/ 00148000
         LA    @15,EXCLAR                                          0351 00149000
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        0351 00150000
*   RVVIAREA=''B;                   /*                       @Y30LB34*/ 00151000
         XC    RVVIAREA(68),RVVIAREA                               0352 00152000
*   BASEVAR=''B;                    /*                       @Y30LB34*/ 00153000
         XC    BASEVAR(224),BASEVAR                                0353 00154000
*   MVRAREA=''B;                    /*                       @Y30LB34*/ 00155000
         XC    MVRAREA(88),MVRAREA                                 0354 00156000
*   COVCEAR=''B;                    /*                       @Y30LB34*/ 00157000
         XC    COVCEAR(43),COVCEAR                                 0355 00158000
*   INFOAREA=''B;                   /*                       @Y30LB34*/ 00159000
         XC    INFOAREA(54),INFOAREA                               0356 00160000
*   IOINFAR=''B;                    /*                       @Y30LB34*/ 00161000
         MVI   IOINFAR,X'00'                                       0357 00162000
*   SRCEAREA=''B;                   /*                       #Y30LB34*/ 00163000
         XC    SRCEAREA(39),SRCEAREA                               0358 00164000
*   TARGAREA=''B;                   /*                       #Y30LB34*/ 00165000
         XC    TARGAREA(49),TARGAREA                               0359 00166000
*   SWITCHES=''B;                   /*                       #Y30LB34*/ 00167000
         MVI   SWITCHES,X'00'                                      0360 00168000
*                                                                  0361 00169000
*   /*****************************************************************/ 00170000
*   /*                                                               */ 00171000
*   /* ESTABLISH A DUMP POINT AFTER INITIALIZATION OF        @Y30LB34*/ 00172000
*   /* THE PARAMETER LISTS AND DATA AREAS                    @Y30LB34*/ 00173000
*   /*                                                               */ 00174000
*   /*****************************************************************/ 00175000
*                                                                  0361 00176000
*   IF GDTDBG=NULLPTR THEN                                         0361 00177000
         L     @07,GDTDBG(,@07)                                    0361 00178000
         LTR   @07,@07                                             0361 00179000
         BZ    @RT00361                                            0361 00180000
*     ;                                                            0362 00181000
*   ELSE                                                           0363 00182000
*     CALL IDCDB010(GDTTBL,'CNBG'); /*                       @Y30LB34*/ 00183000
*                                                                  0363 00184000
         L     @07,@PC00001                                        0363 00185000
         ST    @07,@AL00001                                        0363 00186000
         LA    @15,@CC01667                                        0363 00187000
         ST    @15,@AL00001+4                                      0363 00188000
         MVI   @AL00001+4,X'80'                                    0363 00189000
         L     @15,GDTDBG(,@07)                                    0363 00190000
         LA    @01,@AL00001                                        0363 00191000
         BALR  @14,@15                                             0363 00192000
*   /*****************************************************************/ 00193000
*   /*                                                               */ 00194000
*   /* ISSUE USYSINFO TO RETRIEVE THE UNITABL TO TEST FOR    @ZA08840*/ 00195000
*   /* SHAREABLE DRIVES.                                     @ZA08840*/ 00196000
*   /*                                                               */ 00197000
*   /*****************************************************************/ 00198000
*                                                                  0364 00199000
*   CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,FFILEVAL);/*          @ZA08840*/ 00200000
@RT00361 L     @07,@PC00001                                        0364 00201000
         ST    @07,@AL00001                                        0364 00202000
         LA    @15,UNIT                                            0364 00203000
         ST    @15,@AL00001+4                                      0364 00204000
         LA    @15,UNITABLP                                        0364 00205000
         ST    @15,@AL00001+8                                      0364 00206000
         L     @15,@PC00001+4                                      0364 00207000
         L     @01,FDTPTR(,@15)                                    0364 00208000
         LA    @15,FFILEVAL(,@01)                                  0364 00209000
         ST    @15,@AL00001+12                                     0364 00210000
         MVI   @AL00001+12,X'80'                                   0364 00211000
         L     @15,GDTSFO(,@07)                                    0364 00212000
         LA    @01,@AL00001                                        0364 00213000
         BALR  @14,@15                                             0364 00214000
*   RESPECIFY                                                      0365 00215000
*     RTNREG RSTD;                                                 0365 00216000
*   TESTRC=RTNREG;                                                 0366 00217000
         STH   RTNREG,TESTRC                                       0366 00218000
*   RESPECIFY                                                      0367 00219000
*     RTNREG UNRSTD;                /*                       @ZA08840*/ 00220000
*                                                                  0367 00221000
*   /*****************************************************************/ 00222000
*   /*                                                               */ 00223000
*   /* IF USYSINFO IS UNSCCESSFUL, SET LASTCOND TO 12.       @ZA08840*/ 00224000
*   /*                                                               */ 00225000
*   /*****************************************************************/ 00226000
*                                                                  0368 00227000
*   IF TESTRC^=0 THEN                                              0368 00228000
         LH    @07,TESTRC                                          0368 00229000
         LTR   @07,@07                                             0368 00230000
         BZ    @RF00368                                            0368 00231000
*     LASTCOND=LASTCC12;            /*                       @ZA08840*/ 00232000
*                                                                  0369 00233000
         L     @07,@PC00001+8                                      0369 00234000
         MVC   LASTCOND(2,@07),@CH00567                            0369 00235000
*   /*****************************************************************/ 00236000
*   /*                                                               */ 00237000
*   /* TEST IF A SHAREABLE CONVERTIBLE DRIVE WAS SYSGEND OR A        */ 00238000
*   /* UNIPROCESSOR UNIT WAS BEING USED ON A VS2 SYSTEM. IF SO, ISSUE*/ 00239000
*   /* MESSAGE IDC3736I TO INFORM THE USER THAT CONVERTV CANNOT BE   */ 00240000
*   /* ISSUED. SET LASTCOND TO 12.                           @ZA08840*/ 00241000
*   /*                                                               */ 00242000
*   /*****************************************************************/ 00243000
*                                                                  0370 00244000
*   ELSE                                                           0370 00245000
*     IF UNITXSHR=ON|UNITUSHR=ON THEN                              0370 00246000
         B     @RC00368                                            0370 00247000
@RF00368 L     @07,UNITABLP                                        0370 00248000
         TM    UNITXSHR(@07),B'01100000'                           0370 00249000
         BZ    @RF00370                                            0370 00250000
*       DO;                         /*                       @ZA08840*/ 00251000
*         DARGSMOD=CONVMSG;         /*                       @ZA08840*/ 00252000
         L     @07,DDSTRU                                          0372 00253000
         MVC   DARGSMOD(3,@07),@CC01557                            0372 00254000
*         DARGSENT=MSG3736I;        /*                       @ZA08840*/ 00255000
         MVI   DARGSENT(@07),X'01'                                 0373 00256000
*         DARGDBP=ADDR(FFILEVAL);   /*                       @ZA08840*/ 00257000
         L     @15,@PC00001+4                                      0374 00258000
         L     @01,FDTPTR(,@15)                                    0374 00259000
         LA    @15,FFILEVAL(,@01)                                  0374 00260000
         ST    @15,DARGDBP(,@07)                                   0374 00261000
*         DARGILP=LENGTH(FFILEVAL); /*                       @ZA08840*/ 00262000
         MVC   DARGILP(2,@07),@CH00177                             0375 00263000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @ZA08840*/ 00264000
         L     @07,@PC00001                                        0376 00265000
         ST    @07,@AL00001                                        0376 00266000
         LA    @15,@CF00115                                        0376 00267000
         ST    @15,@AL00001+4                                      0376 00268000
         LA    @15,DDSTRU                                          0376 00269000
         ST    @15,@AL00001+8                                      0376 00270000
         MVI   @AL00001+8,X'80'                                    0376 00271000
         L     @15,GDTPRT(,@07)                                    0376 00272000
         LA    @01,@AL00001                                        0376 00273000
         BALR  @14,@15                                             0376 00274000
*         LASTCOND=LASTCC12;        /*                       @ZA08840*/ 00275000
         L     @07,@PC00001+8                                      0377 00276000
         MVC   LASTCOND(2,@07),@CH00567                            0377 00277000
*       END;                        /*                       @ZA08840*/ 00278000
*     ELSE                                                         0379 00279000
*       DO;                         /*                       @ZA08840*/ 00280000
*                                                                  0379 00281000
         B     @RC00370                                            0379 00282000
@RF00370 DS    0H                                                  0380 00283000
*         /***********************************************************/ 00284000
*         /*                                                         */ 00285000
*         /* RETRIEVE PRELIMINARY INFORMATION ON SOURCE AND  #Y30LB34*/ 00286000
*         /* TARGET VOLUMES                                  @Y30LB34*/ 00287000
*         /*                                                         */ 00288000
*         /***********************************************************/ 00289000
*                                                                  0380 00290000
*         CALL INFOPROC;            /*                       @Y30LB34*/ 00291000
         BAL   @14,INFOPROC                                        0380 00292000
*         RESPECIFY                                                0381 00293000
*           RTNREG RSTD;                                           0381 00294000
*         TESTRC=RTNREG;                                           0382 00295000
         STH   RTNREG,TESTRC                                       0382 00296000
*         RESPECIFY                                                0383 00297000
*           RTNREG UNRSTD;          /*                       @Y30LB34*/ 00298000
*         LASTCOND=TESTRC;          /*                       @Y30LB34*/ 00299000
         LH    @07,TESTRC                                          0384 00300000
         L     @15,@PC00001+8                                      0384 00301000
         STH   @07,LASTCOND(,@15)                                  0384 00302000
*       END;                        /*                       @ZA08840*/ 00303000
*                                                                  0385 00304000
*   /*****************************************************************/ 00305000
*   /*                                                               */ 00306000
*   /* IF A SEVERE ERROR HAS NOT OCCURRED, PERFORM           @Y30LB34*/ 00307000
*   /* CONVERSION. CALL APPROPRIATE PROCEDURE BASED ON       @Y30LB34*/ 00308000
*   /* TYPE OF CONVERSION.                                   @Y30LB34*/ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0386 00312000
*   IF LASTCOND<LASTCC12 THEN                                      0386 00313000
@RC00370 DS    0H                                                  0386 00314000
@RC00368 L     @07,@PC00001+8                                      0386 00315000
         LH    @07,LASTCOND(,@07)                                  0386 00316000
         C     @07,@CF00567                                        0386 00317000
         BNL   @RF00386                                            0386 00318000
*     DO;                           /*                       @Y30LB34*/ 00319000
*       IF CONVTYPE=RV THEN                                        0388 00320000
         TM    CONVTYPE,B'01000000'                                0388 00321000
         BNO   @RF00388                                            0388 00322000
*         CALL RVPROC;              /*                       @Y30LB34*/ 00323000
         BAL   @14,RVPROC                                          0389 00324000
*       IF CONVTYPE=VR THEN                                        0390 00325000
@RF00388 TM    CONVTYPE,B'01000000'                                0390 00326000
         BNZ   @RF00390                                            0390 00327000
*         CALL VRPROC;              /*                       @Y30LB34*/ 00328000
         BAL   @14,VRPROC                                          0391 00329000
*       RESPECIFY                                                  0392 00330000
*         RTNREG RSTD;                                             0392 00331000
@RF00390 DS    0H                                                  0393 00332000
*       TESTRC=RTNREG;                                             0393 00333000
         STH   RTNREG,TESTRC                                       0393 00334000
*       RESPECIFY                                                  0394 00335000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 00336000
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     @Y30LB34*/ 00337000
         L     @07,@PC00001+8                                      0395 00338000
         LH    @02,TESTRC                                          0395 00339000
         LH    @15,LASTCOND(,@07)                                  0395 00340000
         CR    @15,@02                                             0395 00341000
         BNL   *+6                                                      00342000
         LR    @15,@02                                             0395 00343000
         STH   @15,LASTCOND(,@07)                                  0395 00344000
*     END;                          /*                       @Y30LB34*/ 00345000
*                                                                  0397 00346000
*   /*****************************************************************/ 00347000
*   /*                                                               */ 00348000
*   /* DO TERMINATION PROCESSING                             @Y30LB34*/ 00349000
*   /*                                                               */ 00350000
*   /*****************************************************************/ 00351000
*                                                                  0397 00352000
*   IF GDTDBG=NULLPTR THEN                                         0397 00353000
@RF00386 L     @07,@PC00001                                        0397 00354000
         L     @07,GDTDBG(,@07)                                    0397 00355000
         LTR   @07,@07                                             0397 00356000
         BZ    @RT00397                                            0397 00357000
*     ;                                                            0398 00358000
*   ELSE                                                           0399 00359000
*     CALL IDCDB010(GDTTBL,'CNND'); /*                       @Y30LB34*/ 00360000
*                                                                  0399 00361000
         L     @07,@PC00001                                        0399 00362000
         ST    @07,@AL00001                                        0399 00363000
         LA    @02,@CC01671                                        0399 00364000
         ST    @02,@AL00001+4                                      0399 00365000
         MVI   @AL00001+4,X'80'                                    0399 00366000
         L     @15,GDTDBG(,@07)                                    0399 00367000
         LA    @01,@AL00001                                        0399 00368000
         BALR  @14,@15                                             0399 00369000
*   /*****************************************************************/ 00370000
*   /*                                                               */ 00371000
*   /* ISSUE COMPLETION MESSAGE                              @Y30LB34*/ 00372000
*   /*                                                               */ 00373000
*   /*****************************************************************/ 00374000
*                                                                  0400 00375000
*   IF LASTCOND<LASTCC12 THEN                                      0400 00376000
@RT00397 L     @07,@PC00001+8                                      0400 00377000
         LH    @07,LASTCOND(,@07)                                  0400 00378000
         C     @07,@CF00567                                        0400 00379000
         BNL   @RF00400                                            0400 00380000
*     DARGSENT=MSG0001I;            /*                       @Y30LB34*/ 00381000
         L     @07,DDSTRU                                          0401 00382000
         MVI   DARGSENT(@07),X'01'                                 0401 00383000
*   ELSE                                                           0402 00384000
*     DARGSENT=MSG0003I;            /*                       @Y30LB34*/ 00385000
         B     @RC00400                                            0402 00386000
@RF00400 L     @07,DDSTRU                                          0402 00387000
         MVI   DARGSENT(@07),X'03'                                 0402 00388000
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB34*/ 00389000
@RC00400 L     @07,DDSTRU                                          0403 00390000
         MVC   DARGSMOD(3,@07),@CC01553                            0403 00391000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB34*/ 00392000
         L     @02,@PC00001+8                                      0404 00393000
         ST    @02,DARGDBP(,@07)                                   0404 00394000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB34*/ 00395000
         MVC   DARGILP(2,@07),@CH00153                             0405 00396000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB34*/ 00397000
*                                                                  0406 00398000
         L     @07,@PC00001                                        0406 00399000
         ST    @07,@AL00001                                        0406 00400000
         LA    @02,@CF00115                                        0406 00401000
         ST    @02,@AL00001+4                                      0406 00402000
         LA    @02,DDSTRU                                          0406 00403000
         ST    @02,@AL00001+8                                      0406 00404000
         MVI   @AL00001+8,X'80'                                    0406 00405000
         L     @15,GDTPRT(,@07)                                    0406 00406000
         LA    @01,@AL00001                                        0406 00407000
         BALR  @14,@15                                             0406 00408000
*   /*****************************************************************/ 00409000
*   /*                                                               */ 00410000
*   /* RETURN TO THE AMS EXECUTIVE                           @Y30LB34*/ 00411000
*   /*                                                               */ 00412000
*   /*****************************************************************/ 00413000
*                                                                  0407 00414000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0407 00415000
*                                                                  0407 00416000
         L     @07,@PC00001                                        0407 00417000
         ST    @07,@AL00001                                        0407 00418000
         LA    @02,MODID                                           0407 00419000
         ST    @02,@AL00001+4                                      0407 00420000
         L     @02,@PC00001+8                                      0407 00421000
         ST    @02,@AL00001+8                                      0407 00422000
         MVI   @AL00001+8,X'80'                                    0407 00423000
         L     @15,GDTEPL(,@07)                                    0407 00424000
         LA    @01,@AL00001                                        0407 00425000
         BALR  @14,@15                                             0407 00426000
*   /*****************************************************************/ 00427000
*   /*                                                               */ 00428000
*   /*                                                       @Y30LB34*/ 00429000
*   /*                                                               */ 00430000
*   /*****************************************************************/ 00431000
*                                                                  0408 00432000
*                                                                  0408 00433000
*/********************************************************** @Y30LB34*/ 00434000
*/*                                                          @Y30LB34*/ 00435000
*/* PROCEDURE NAME - INFOPROC                                @Y30LB34*/ 00436000
*/*                                                          @Y30LB34*/ 00437000
*/* FUNCTION - RETRIEVES SOURCE AND TARGET VOLUME PROCESSING @Y30LB34*/ 00438000
*/*            INFORMATION.  BUILDS INITIAL SOURCE AND       @Y30LB34*/ 00439000
*/*            TARGET WORK AREAS.  TESTS FOR ERRORS IN       @Y30LB34*/ 00440000
*/*            JOB SETUP.                                    @Y30LB34*/ 00441000
*/*                                                          @Y30LB34*/ 00442000
*/*            PRINTS ERROR MESSAGE IDC3739I IF SOURCE       @Y30LB34*/ 00443000
*/*            TARGET VOLUMES ARE BOTH VIRTUAL OR REAL       @Y30LB34*/ 00444000
*/*                                                          @Y30LB34*/ 00445000
*/* INPUT - FUNCTION DATA TABLE, DARGLIST                    @Y30LB34*/ 00446000
*/*                                                          @Y30LB34*/ 00447000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 00448000
*/*            R. C. =  0, SUCCESSFUL COMPLETION             @Y30LB34*/ 00449000
*/*            R. C. = 12, RETURN CODE FROM SOINFO AND/OR    @Y30LB34*/ 00450000
*/*                        TAINFO, VOLUMES ARE THE SAME      @Y30LB34*/ 00451000
*/*                        TYPE                              @Y30LB34*/ 00452000
*/*                                                          @Y30LB34*/ 00453000
*/********************************************************** @Y30LB34*/ 00454000
*                                                                  0408 00455000
*INFOPROC:                                                         0408 00456000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 00457000
*                                                                  0408 00458000
@EL00001 L     @13,4(,@13)                                         0408 00459000
@EF00001 L     @00,@SIZDATD                                        0408 00460000
         LR    @01,@12                                             0408 00461000
         FREEMAIN R,LV=(0),A=(1)                                        00462000
@ER00001 LM    @14,@12,12(@13)                                     0408 00463000
         BR    @14                                                 0408 00464000
INFOPROC DS    0H                                                  0409 00465000
*   /*****************************************************************/ 00466000
*   /*                                                               */ 00467000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 00468000
*   /*                                                               */ 00469000
*   /*****************************************************************/ 00470000
*                                                                  0409 00471000
*   DCL                                                            0409 00472000
*     CC01 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   00473000
*                                      CODE SAVE AREA        @Y30LB34*/ 00474000
*                                                                  0410 00475000
*   /*****************************************************************/ 00476000
*   /*                                                               */ 00477000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 00478000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 00479000
*   /*                                                               */ 00480000
*   /*****************************************************************/ 00481000
*                                                                  0410 00482000
*   CC01=LASTCC00;                  /*                       @Y30LB34*/ 00483000
         SLR   CC01,CC01                                           0410 00484000
*   RTNREG1=REG14;                  /*                       @Y30LB34*/ 00485000
*                                                                  0411 00486000
         ST    REG14,RTNREG1                                       0411 00487000
*   /*****************************************************************/ 00488000
*   /*                                                               */ 00489000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 00490000
*   /*                                                               */ 00491000
*   /*****************************************************************/ 00492000
*                                                                  0412 00493000
*   OLDERID2=NEWERID2;                                             0412 00494000
         L     @07,@PC00001                                        0412 00495000
         L     @07,GDTTR2(,@07)                                    0412 00496000
         MVC   @TS00001(95),NEWERID2(@07)                          0412 00497000
         MVC   OLDERID2(95,@07),@TS00001                           0412 00498000
*   NEWID2='CNT1';                  /*                       @Y30LB34*/ 00499000
*                                                                  0413 00500000
         MVC   NEWID2(4,@07),@CC01676                              0413 00501000
*   /*****************************************************************/ 00502000
*   /*                                                               */ 00503000
*   /* GET SOURCE VOLUME INFORMATION                         @Y30LB34*/ 00504000
*   /*                                                               */ 00505000
*   /*****************************************************************/ 00506000
*                                                                  0414 00507000
*   CALL SOINFO;                    /*                       @Y30LB34*/ 00508000
         BAL   @14,SOINFO                                          0414 00509000
*   RESPECIFY                                                      0415 00510000
*     RTNREG RSTD;                                                 0415 00511000
*   TESTRC=RTNREG;                                                 0416 00512000
         STH   RTNREG,TESTRC                                       0416 00513000
*   RESPECIFY                                                      0417 00514000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 00515000
*   CC01=TESTRC;                    /*                       @Y30LB34*/ 00516000
*                                                                  0418 00517000
         LH    @07,TESTRC                                          0418 00518000
         LR    CC01,@07                                            0418 00519000
*   /*****************************************************************/ 00520000
*   /*                                                               */ 00521000
*   /* IF NO SEVERE ERROR OCCURRED RETRIEVING SOURCE         @Y30LB34*/ 00522000
*   /* VOLUME INFO, GET TARGET VOLUME INFORMATION            @Y30LB34*/ 00523000
*   /*                                                               */ 00524000
*   /*****************************************************************/ 00525000
*                                                                  0419 00526000
*   IF CC01<LASTCC12 THEN                                          0419 00527000
         C     CC01,@CF00567                                       0419 00528000
         BNL   @RF00419                                            0419 00529000
*     DO;                           /*                       @Y30LB34*/ 00530000
*       CALL TAINFO;                /*                       @Y30LB34*/ 00531000
         BAL   @14,TAINFO                                          0421 00532000
*       RESPECIFY                                                  0422 00533000
*         RTNREG RSTD;                                             0422 00534000
*       TESTRC=RTNREG;                                             0423 00535000
         STH   RTNREG,TESTRC                                       0423 00536000
*       RESPECIFY                                                  0424 00537000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 00538000
*       CC01=MAX(CC01,TESTRC);      /*                       @Y30LB34*/ 00539000
         LH    @08,TESTRC                                          0425 00540000
         CR    CC01,@08                                            0425 00541000
         BNL   *+6                                                      00542000
         LR    CC01,@08                                            0425 00543000
*     END;                          /*                       @Y30LB34*/ 00544000
*                                                                  0427 00545000
*   /*****************************************************************/ 00546000
*   /*                                                               */ 00547000
*   /* IF NO SEVERE ERRORS HAVE OCCURRED RETRIEVING          @Y30LB34*/ 00548000
*   /* INFORMATION, CONTINUE PROCESSING.                     @Y30LB34*/ 00549000
*   /*                                                               */ 00550000
*   /*****************************************************************/ 00551000
*                                                                  0427 00552000
*   IF CC01<LASTCC08 THEN                                          0427 00553000
@RF00419 C     CC01,@CF00177                                       0427 00554000
         BNL   @RF00427                                            0427 00555000
*     DO;                           /*                       @Y30LB34*/ 00556000
*                                                                  0428 00557000
*       /*************************************************************/ 00558000
*       /*                                                           */ 00559000
*       /* TEST FOR SAME VOLUME SERIAL NUMBERS ON            @Y30LB34*/ 00560000
*       /* SOURCE AND TARGET VOLUMES                         @Y30LB34*/ 00561000
*       /*                                                           */ 00562000
*       /*************************************************************/ 00563000
*                                                                  0429 00564000
*       IF SVOLSER=TVOLSER THEN                                    0429 00565000
         CLC   SVOLSER(6),TVOLSER                                  0429 00566000
         BNE   @RF00429                                            0429 00567000
*         SAMESER=ON;               /*                       @Y30LB34*/ 00568000
         OI    SAMESER,B'10000000'                                 0430 00569000
*       ELSE                                                       0431 00570000
*         SAMESER=OFF;              /*                       @Y30LB34*/ 00571000
*                                                                  0431 00572000
         B     @RC00429                                            0431 00573000
@RF00429 NI    SAMESER,B'01111111'                                 0431 00574000
*       /*************************************************************/ 00575000
*       /*                                                           */ 00576000
*       /* TEST VOLUME TYPES FOR TYPE OF CONVERSION          @Y30LB34*/ 00577000
*       /* IF VOLUMES ARE THE SAME TYPE PRINT                @Y30LB34*/ 00578000
*       /* MESSAGE IDC3739I, AND TERMINATE THE JOB.          @Y30LB34*/ 00579000
*       /*                                                           */ 00580000
*       /*************************************************************/ 00581000
*                                                                  0432 00582000
*       IF STYPEVOL='REAL'&TTYPEVOL='VIRT' THEN                    0432 00583000
@RC00429 CLC   STYPEVOL(4),@CC01679                                0432 00584000
         BNE   @RF00432                                            0432 00585000
         CLC   TTYPEVOL(4),@CC01680                                0432 00586000
         BNE   @RF00432                                            0432 00587000
*         CONVTYPE=RV;              /*                       @Y30LB34*/ 00588000
         OI    CONVTYPE,B'01000000'                                0433 00589000
*       ELSE                                                       0434 00590000
*         IF STYPEVOL='VIRT'&TTYPEVOL='REAL' THEN                  0434 00591000
         B     @RC00432                                            0434 00592000
@RF00432 CLC   STYPEVOL(4),@CC01680                                0434 00593000
         BNE   @RF00434                                            0434 00594000
         CLC   TTYPEVOL(4),@CC01679                                0434 00595000
         BNE   @RF00434                                            0434 00596000
*           CONVTYPE=VR;            /*                       @Y30LB34*/ 00597000
         NI    CONVTYPE,B'10111111'                                0435 00598000
*         ELSE                                                     0436 00599000
*           DO;                     /*                       @Y30LB34*/ 00600000
         B     @RC00434                                            0436 00601000
@RF00434 DS    0H                                                  0437 00602000
*             DARGSMOD=CONVMSG;     /*                       @Y30LB34*/ 00603000
         L     @08,DDSTRU                                          0437 00604000
         MVC   DARGSMOD(3,@08),@CC01557                            0437 00605000
*             DARGSENT=MSG3739I;    /*                       @Y30LB34*/ 00606000
         MVI   DARGSENT(@08),X'03'                                 0438 00607000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB34*/ 00608000
         L     @08,@PC00001                                        0439 00609000
         ST    @08,@AL00001                                        0439 00610000
         LA    @07,@CF00115                                        0439 00611000
         ST    @07,@AL00001+4                                      0439 00612000
         LA    @07,DDSTRU                                          0439 00613000
         ST    @07,@AL00001+8                                      0439 00614000
         MVI   @AL00001+8,X'80'                                    0439 00615000
         L     @15,GDTPRT(,@08)                                    0439 00616000
         LA    @01,@AL00001                                        0439 00617000
         BALR  @14,@15                                             0439 00618000
*             CC01=MAX(CC01,LASTCC12);/*                     @Y30LB34*/ 00619000
         LA    @08,12                                              0440 00620000
         CR    CC01,@08                                            0440 00621000
         BNL   *+6                                                      00622000
         LR    CC01,@08                                            0440 00623000
*           END;                    /*                       @Y30LB34*/ 00624000
*                                                                  0442 00625000
*       /*************************************************************/ 00626000
*       /*                                                           */ 00627000
*       /* INITIALIZE THE ENQ AND RESERVE RNAME FOR          @Y30LB34*/ 00628000
*       /* SOURCE AND TARGET VOLUMES                         @Y30LB34*/ 00629000
*       /*                                                           */ 00630000
*       /*************************************************************/ 00631000
*                                                                  0442 00632000
*       RENQLEN=LENGTH(RNAMERE);    /*                       @Y30LB34*/ 00633000
@RC00434 DS    0H                                                  0442 00634000
@RC00432 MVI   RENQLEN,X'14'                                       0442 00635000
*       RENQ=REALENQ;               /*                       @Y30LB34*/ 00636000
         MVC   RENQ(13),@CC01596                                   0443 00637000
*       RRESLEN=LENGTH(RNAMERR);    /*                       @Y30LB34*/ 00638000
         MVI   RRESLEN,X'14'                                       0444 00639000
*       RRES=REALRES;               /*                       @Y30LB34*/ 00640000
         MVC   RRES(13),@CC01602                                   0445 00641000
*       VENQLEN=LENGTH(RNAMEVE);    /*                       @Y30LB34*/ 00642000
         MVI   VENQLEN,X'17'                                       0446 00643000
*       VENQ=VIRTENQ;               /*                       @Y30LB34*/ 00644000
         MVC   VENQ(16),@CC01599                                   0447 00645000
*       VRESLEN=LENGTH(RNAMEVR);    /*                       @Y30LB34*/ 00646000
         MVI   VRESLEN,X'17'                                       0448 00647000
*       VRES=VIRTRES;               /*                       @Y30LB34*/ 00648000
         MVC   VRES(16),@CC01605                                   0449 00649000
*       IF STYPEVOL='REAL' THEN                                    0450 00650000
         CLC   STYPEVOL(4),@CC01679                                0450 00651000
         BNE   @RF00450                                            0450 00652000
*         DO;                       /*                       @Y30LB34*/ 00653000
*           REVOLSER=SVOLSER;       /*                       @Y30LB34*/ 00654000
         MVC   REVOLSER(6),SVOLSER                                 0452 00655000
*           RRVOLSER=SVOLSER;       /*                       @Y30LB34*/ 00656000
         MVC   RRVOLSER(6),SVOLSER                                 0453 00657000
*           VEVOLSER=TVOLSER;       /*                       @Y30LB34*/ 00658000
         MVC   VEVOLSER(6),TVOLSER                                 0454 00659000
*           VRVOLSER=TVOLSER;       /*                       @Y30LB34*/ 00660000
         MVC   VRVOLSER(6),TVOLSER                                 0455 00661000
*         END;                      /*                       @Y30LB34*/ 00662000
*       ELSE                                                       0457 00663000
*         DO;                       /*                       @Y30LB34*/ 00664000
         B     @RC00450                                            0457 00665000
@RF00450 DS    0H                                                  0458 00666000
*           REVOLSER=TVOLSER;       /*                       @Y30LB34*/ 00667000
         MVC   REVOLSER(6),TVOLSER                                 0458 00668000
*           RRVOLSER=TVOLSER;       /*                       @Y30LB34*/ 00669000
         MVC   RRVOLSER(6),TVOLSER                                 0459 00670000
*           VEVOLSER=SVOLSER;       /*                       @Y30LB34*/ 00671000
         MVC   VEVOLSER(6),SVOLSER                                 0460 00672000
*           VRVOLSER=SVOLSER;       /*                       @Y30LB34*/ 00673000
         MVC   VRVOLSER(6),SVOLSER                                 0461 00674000
*         END;                      /*                       @Y30LB34*/ 00675000
*     END;                          /*                       @Y30LB34*/ 00676000
@RC00450 DS    0H                                                  0464 00677000
*                                                                  0464 00678000
*   /*****************************************************************/ 00679000
*   /*                                                               */ 00680000
*   /* IF ERRORS OCCURRED IN SOINFO AND/OR TAINFO A          @Y30LB34*/ 00681000
*   /* RETURN CODE OF 8 WAS PASSED TO INFOPROC SO            @Y30LB34*/ 00682000
*   /* PROCESSING COULD CONTINUE. NOW THESE ERRORS           @Y30LB34*/ 00683000
*   /* SHOULD TERMIATE FURTHER PROCESSING. CHANGE            @Y30LB34*/ 00684000
*   /* RETURN CODE OF 8 TO 12.                               @Y30LB34*/ 00685000
*   /*                                                               */ 00686000
*   /*****************************************************************/ 00687000
*                                                                  0464 00688000
*   IF CC01=LASTCC08 THEN                                          0464 00689000
@RF00427 C     CC01,@CF00177                                       0464 00690000
         BNE   @RF00464                                            0464 00691000
*     CC01=LASTCC12;                /*                       @Y30LB34*/ 00692000
*                                                                  0465 00693000
         LA    CC01,12                                             0465 00694000
*   /*****************************************************************/ 00695000
*   /*                                                               */ 00696000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 00697000
*   /* RETURN TO THE MAIN PROCEDURE                          @Y30LB34*/ 00698000
*   /*                                                               */ 00699000
*   /*****************************************************************/ 00700000
*                                                                  0466 00701000
*   REG14=RTNREG1;                  /*                       @Y30LB34*/ 00702000
@RF00464 L     REG14,RTNREG1                                       0466 00703000
*   RETURN CODE(CC01);              /*                       @Y30LB34*/ 00704000
         LR    @15,CC01                                            0467 00705000
@EL00002 DS    0H                                                  0467 00706000
@EF00002 DS    0H                                                  0467 00707000
@ER00002 BR    @14                                                 0467 00708000
*   END INFOPROC;                   /*                       @Y30LB34*/ 00709000
*                                                                  0469 00710000
*/********************************************************** @Y30LB34*/ 00711000
*/*                                                          @Y30LB34*/ 00712000
*/*  PROCEDURE NAME - SOINFO                                 @Y30LB34*/ 00713000
*/*                                                          @Y30LB34*/ 00714000
*/* FUNCTION - RETRIEVES SOURCE VOLUME INFORMATION AND SAVES @Y30LB34*/ 00715000
*/*            IT IN SRCEAREA.                               @Y30LB34*/ 00716000
*/*                                                          @Y30LB34*/ 00717000
*/*            ISSUES UIOINFO FOR DEVICE TYPE AND VOLSER     @Y30LB34*/ 00718000
*/*            INFORMATION.                                  @Y30LB34*/ 00719000
*/*                                                          @Y30LB34*/ 00720000
*/*            PRINTS ERROR MESSAGE IDC3740I IF MULTIPLE     @Y30LB34*/ 00721000
*/*            VOLUME SERIAL NUMBERS ARE RETURNED BY         @Y30LB34*/ 00722000
*/*            UIOINFO                                       @Y30LB34*/ 00723000
*/*                                                          @Y30LB34*/ 00724000
*/*            ISSUES UMSSUNIT FOR VOLUME TYPE: REAL OR      @YD00175*/ 00725000
*/*            VIRTUAL                                       @YD00175*/ 00726000
*/*                                                          @Y30LB34*/ 00727000
*/*            IF VOLUME IS REAL ISSUES USYSINFO FOR REAL    @Y30LB34*/ 00728000
*/*            UNIT ADDRESS.                                 @Y30LB34*/ 00729000
*/*                                                          @Y30LB34*/ 00730000
*/* INPUT - FUNCTION DATA TABLE, IOINFOPT, CKAGL, UNITABL    @Y30LB34*/ 00731000
*/*         SRCEAREA AND DARGLIST.                           @Y30LB34*/ 00732000
*/*                                                          @Y30LB34*/ 00733000
*/* OUTPUT - INFOAREA, SRCEAREA, CKAGL, UNITABL, IOINFOPT.   @Y30LB34*/ 00734000
*/*                                                          @Y30LB34*/ 00735000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 00736000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 00737000
*/*           R. C. =  8, UNABLE TO RETRIEVE DEVTYPE AND     @Y30LB34*/ 00738000
*/*                       VOLSER,                            @Y30LB34*/ 00739000
*/*                       MORE THAN 1 VOLSER RETURNED BY     @Y30LB34*/ 00740000
*/*                       UIOINFO,                           @Y30LB34*/ 00741000
*/*                       UNABLE TO RETRIEVE VOLUME INFO,    @Y30LB34*/ 00742000
*/*                       UNABLE TO RETRIEVE REAL UNIT       @Y30LB34*/ 00743000
*/*                       ADDRESS                            @Y30LB34*/ 00744000
*/*                                                          @Y30LB34*/ 00745000
*/********************************************************** @Y30LB34*/ 00746000
*                                                                  0469 00747000
*SOINFO:                                                           0469 00748000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 00749000
*                                                                  0469 00750000
SOINFO   DS    0H                                                  0470 00751000
*   /*****************************************************************/ 00752000
*   /*                                                               */ 00753000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 00754000
*   /*                                                               */ 00755000
*   /*****************************************************************/ 00756000
*                                                                  0470 00757000
*   DCL                                                            0470 00758000
*     CC02 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   00759000
*                                      CODE SAVE AREA        @Y30LB34*/ 00760000
*                                                                  0471 00761000
*   /*****************************************************************/ 00762000
*   /*                                                               */ 00763000
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/ 00764000
*   /*                                                               */ 00765000
*   /*****************************************************************/ 00766000
*                                                                  0471 00767000
*   OLDERID2=NEWERID2;                                             0471 00768000
         L     @08,@PC00001                                        0471 00769000
         L     @15,GDTTR2(,@08)                                    0471 00770000
         MVC   @TS00001(95),NEWERID2(@15)                          0471 00771000
         MVC   OLDERID2(95,@15),@TS00001                           0471 00772000
*   NEWID2='CNT2';                  /*                       @Y30LB34*/ 00773000
*                                                                  0472 00774000
         MVC   NEWID2(4,@15),@CC01685                              0472 00775000
*   /*****************************************************************/ 00776000
*   /*                                                               */ 00777000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 00778000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 00779000
*   /*                                                               */ 00780000
*   /*****************************************************************/ 00781000
*                                                                  0473 00782000
*   CC02=LASTCC00;                  /*                       @Y30LB34*/ 00783000
         SLR   CC02,CC02                                           0473 00784000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 00785000
*                                                                  0474 00786000
         LR    RTNREG2,REG14                                       0474 00787000
*   /*****************************************************************/ 00788000
*   /*                                                               */ 00789000
*   /* INITIALIZE THE UIOINFO OPTIONS TO RETRIEVE DEVICE     @Y30LB34*/ 00790000
*   /* TYPE AND VOLSER                                       @YD00175*/ 00791000
*   /*                                                               */ 00792000
*   /*****************************************************************/ 00793000
*                                                                  0475 00794000
*   AREALEN=LENGTH(INFOAREA);       /*                       @Y30LB34*/ 00795000
         MVC   AREALEN(2),@CH01872                                 0475 00796000
*   IOINFDVT=ON;                    /*                       @Y30LB34*/ 00797000
*   IOINFVOL=ON;                    /*                       @Y30LB34*/ 00798000
*                                                                  0477 00799000
         LA    @15,IOINFAR                                         0477 00800000
         OI    IOINFDVT(@15),B'11000000'                           0477 00801000
*   /*****************************************************************/ 00802000
*   /*                                                               */ 00803000
*   /* ISSUE UIOINFO TO RETRIEVE DEVICE TYPE AND VOLSER      @Y30LB34*/ 00804000
*   /*                                                               */ 00805000
*   /*****************************************************************/ 00806000
*                                                                  0478 00807000
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,FFILEVAL);/*       @Y30LB34*/ 00808000
         ST    @08,@AL00001                                        0478 00809000
         ST    @15,@AL00001+4                                      0478 00810000
         LA    @15,INFOPTR                                         0478 00811000
         ST    @15,@AL00001+8                                      0478 00812000
         L     @15,@PC00001+4                                      0478 00813000
         L     @01,FDTPTR(,@15)                                    0478 00814000
         LA    @15,FFILEVAL(,@01)                                  0478 00815000
         ST    @15,@AL00001+12                                     0478 00816000
         MVI   @AL00001+12,X'80'                                   0478 00817000
         L     @15,GDTIFO(,@08)                                    0478 00818000
         LA    @01,@AL00001                                        0478 00819000
         BALR  @14,@15                                             0478 00820000
*   RESPECIFY                                                      0479 00821000
*     RTNREG RSTD;                                                 0479 00822000
*   TESTRC=RTNREG;                                                 0480 00823000
         STH   RTNREG,TESTRC                                       0480 00824000
*   RESPECIFY                                                      0481 00825000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 00826000
*   IF TESTRC>0 THEN                                               0482 00827000
         LH    @08,TESTRC                                          0482 00828000
         LTR   @08,@08                                             0482 00829000
         BNP   @RF00482                                            0482 00830000
*     CC02=LASTCC08;                /*                       @Y30LB34*/ 00831000
         LA    CC02,8                                              0483 00832000
*                                                                  0484 00833000
*   /*****************************************************************/ 00834000
*   /*                                                               */ 00835000
*   /* IF UIOINFO IS SUCCESSFUL SAVE INFORMATION IN          @Y30LB34*/ 00836000
*   /* SRCEAREA                                              @Y30LB34*/ 00837000
*   /*                                                               */ 00838000
*   /*****************************************************************/ 00839000
*                                                                  0484 00840000
*   ELSE                                                           0484 00841000
*     DO;                           /*                       @Y30LB34*/ 00842000
*                                                                  0484 00843000
         B     @RC00482                                            0484 00844000
@RF00482 DS    0H                                                  0485 00845000
*       /*************************************************************/ 00846000
*       /*                                                           */ 00847000
*       /* STORE DEVICE TYPE IN WORK AREA.                   @Y30LB34*/ 00848000
*       /* MAKE SURE UIOINFO ONLY RETRIEVED                  @Y30LB34*/ 00849000
*       /* ONE VOLSER. IF ONLY ONE,                          @Y30LB34*/ 00850000
*       /* SAVE IT IN SRCEAREA. IF MORE THAN                 @Y30LB34*/ 00851000
*       /* ONE, PRINT MESSAGE IDC3740I AND SET THE           @Y30LB34*/ 00852000
*       /* RETURN CODE TO 8.                                 @Y30LB34*/ 00853000
*       /*                                                           */ 00854000
*       /*************************************************************/ 00855000
*                                                                  0485 00856000
*       SDEVTYPE=DEVICE;            /*                       @Y30LB34*/ 00857000
         MVC   SDEVTYPE(4),DEVICE                                  0485 00858000
*       IF VOLLEN=LENGTH(SVOLSER) THEN                             0486 00859000
         CLC   VOLLEN(2),@CH00038                                  0486 00860000
         BNE   @RF00486                                            0486 00861000
*         SVOLSER=FIRVOL;           /*                       @Y30LB34*/ 00862000
         MVC   SVOLSER(6),FIRVOL                                   0487 00863000
*       IF VOLLEN>LENGTH(SVOLSER) THEN                             0488 00864000
@RF00486 LH    @08,VOLLEN                                          0488 00865000
         C     @08,@CF00038                                        0488 00866000
         BNH   @RF00488                                            0488 00867000
*         DO;                       /*                       @Y30LB34*/ 00868000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 00869000
         L     @08,DDSTRU                                          0490 00870000
         MVC   DARGSMOD(3,@08),@CC01557                            0490 00871000
*           DARGSENT=MSG3740I;      /*                       @Y30LB34*/ 00872000
         MVI   DARGSENT(@08),X'04'                                 0491 00873000
*           DARGDBP=ADDR(FFILEVAL); /*                       @Y30LB34*/ 00874000
         L     @15,@PC00001+4                                      0492 00875000
         L     @01,FDTPTR(,@15)                                    0492 00876000
         LA    @15,FFILEVAL(,@01)                                  0492 00877000
         ST    @15,DARGDBP(,@08)                                   0492 00878000
*           DARGILP=LENGTH(FFILEVAL);/*                      @Y30LB34*/ 00879000
         MVC   DARGILP(2,@08),@CH00177                             0493 00880000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 00881000
         L     @08,@PC00001                                        0494 00882000
         ST    @08,@AL00001                                        0494 00883000
         LA    @15,@CF00115                                        0494 00884000
         ST    @15,@AL00001+4                                      0494 00885000
         LA    @15,DDSTRU                                          0494 00886000
         ST    @15,@AL00001+8                                      0494 00887000
         MVI   @AL00001+8,X'80'                                    0494 00888000
         L     @15,GDTPRT(,@08)                                    0494 00889000
         LA    @01,@AL00001                                        0494 00890000
         BALR  @14,@15                                             0494 00891000
*           CC02=LASTCC08;          /*                       @Y30LB34*/ 00892000
         LA    CC02,8                                              0495 00893000
*         END;                      /*                       @Y30LB34*/ 00894000
*                                                                  0497 00895000
*       /*************************************************************/ 00896000
*       /*                                                           */ 00897000
*       /* INITIALIZE CKAGL TO GET VOLUME TYPE:              @YD00175*/ 00898000
*       /* VIRTUAL OR REAL                                   @YD00175*/ 00899000
*       /*                                                           */ 00900000
*       /*************************************************************/ 00901000
*                                                                  0497 00902000
*       CKUCBPTR=ADDR(SUCBADDR);    /*                       @Y30LB34*/ 00903000
@RF00488 LA    @08,CKAGLAR                                         0497 00904000
         LA    @15,SUCBADDR                                        0497 00905000
         ST    @15,CKUCBPTR(,@08)                                  0497 00906000
*       CKDDNAME=FFILEVAL;          /*                       @Y30LB34*/ 00907000
         L     @15,@PC00001+4                                      0498 00908000
         L     @01,FDTPTR(,@15)                                    0498 00909000
         MVC   CKDDNAME(8,@08),FFILEVAL(@01)                       0498 00910000
*       CKDATYPE=ADDR(STYPEVOL);    /*                       @Y30LB34*/ 00911000
         LA    @15,STYPEVOL                                        0499 00912000
         ST    @15,CKDATYPE(,@08)                                  0499 00913000
*       CKRETTYP=ON;                /*                       @Y30LB34*/ 00914000
*                                                                  0500 00915000
         OI    CKRETTYP(@08),B'01000000'                           0500 00916000
*       /*************************************************************/ 00917000
*       /*                                                           */ 00918000
*       /* ISSUE UMSSUNIT TO RETRIEVE VOLUME INFO            @Y30LB34*/ 00919000
*       /*                                                           */ 00920000
*       /*************************************************************/ 00921000
*                                                                  0501 00922000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB34*/ 00923000
         L     @15,@PC00001                                        0501 00924000
         ST    @15,@AL00001                                        0501 00925000
         LA    @14,CHECK                                           0501 00926000
         ST    @14,@AL00001+4                                      0501 00927000
         ST    @08,@AL00001+8                                      0501 00928000
         MVI   @AL00001+8,X'80'                                    0501 00929000
         L     @15,GDTUNT(,@15)                                    0501 00930000
         LA    @01,@AL00001                                        0501 00931000
         BALR  @14,@15                                             0501 00932000
*       RESPECIFY                                                  0502 00933000
*         RTNREG RSTD;                                             0502 00934000
*       TESTRC=RTNREG;                                             0503 00935000
         STH   RTNREG,TESTRC                                       0503 00936000
*       RESPECIFY                                                  0504 00937000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 00938000
*                                                                  0504 00939000
*       /*************************************************************/ 00940000
*       /*                                                           */ 00941000
*       /* IF UMSSUNIT WAS NOT SUCCESSFUL, SET THE           @YD00175*/ 00942000
*       /* CONDITION CODE TO 8                               @YD00175*/ 00943000
*       /*                                                           */ 00944000
*       /*************************************************************/ 00945000
*                                                                  0505 00946000
*       IF TESTRC>0 THEN                                           0505 00947000
         LH    @08,TESTRC                                          0505 00948000
         LTR   @08,@08                                             0505 00949000
         BNP   @RF00505                                            0505 00950000
*         CC02=LASTCC08;            /*                       @Y30LB34*/ 00951000
         LA    CC02,8                                              0506 00952000
*                                                                  0507 00953000
*       /*************************************************************/ 00954000
*       /*                                                           */ 00955000
*       /* IF UMSSUNIT IS SUCCESSFUL AND                     @Y30LB34*/ 00956000
*       /* THE VOLUME IS REAL, ISSUE USYSINFO TO RETRIEVE    @Y30LB34*/ 00957000
*       /* THE REAL UNIT ADDRESS. IF UMSSUNIT WAS NOT        @Y30LB34*/ 00958000
*       /* SUCCESSFUL STYPEVOL WILL BE ZERO                  @Y30LB34*/ 00959000
*       /*                                                           */ 00960000
*       /*************************************************************/ 00961000
*                                                                  0507 00962000
*       IF STYPEVOL='REAL' THEN                                    0507 00963000
@RF00505 CLC   STYPEVOL(4),@CC01679                                0507 00964000
         BNE   @RF00507                                            0507 00965000
*         DO;                       /*                       @Y30LB34*/ 00966000
*           CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,FFILEVAL);/*  @Y30LB34*/ 00967000
         L     @08,@PC00001                                        0509 00968000
         ST    @08,@AL00001                                        0509 00969000
         LA    @15,UNIT                                            0509 00970000
         ST    @15,@AL00001+4                                      0509 00971000
         LA    @15,UNITABLP                                        0509 00972000
         ST    @15,@AL00001+8                                      0509 00973000
         L     @15,@PC00001+4                                      0509 00974000
         L     @01,FDTPTR(,@15)                                    0509 00975000
         LA    @15,FFILEVAL(,@01)                                  0509 00976000
         ST    @15,@AL00001+12                                     0509 00977000
         MVI   @AL00001+12,X'80'                                   0509 00978000
         L     @15,GDTSFO(,@08)                                    0509 00979000
         LA    @01,@AL00001                                        0509 00980000
         BALR  @14,@15                                             0509 00981000
*           RESPECIFY                                              0510 00982000
*             RTNREG RSTD;                                         0510 00983000
*           TESTRC=RTNREG;                                         0511 00984000
         STH   RTNREG,TESTRC                                       0511 00985000
*           RESPECIFY                                              0512 00986000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 00987000
*           IF TESTRC=0 THEN                                       0513 00988000
         LH    @08,TESTRC                                          0513 00989000
         LTR   @08,@08                                             0513 00990000
         BNZ   @RF00513                                            0513 00991000
*             SUNITADR=UNITADR;     /*                       @Y30LB34*/ 00992000
         L     @08,UNITABLP                                        0514 00993000
         LH    @08,UNITADR(,@08)                                   0514 00994000
         STH   @08,SUNITADR                                        0514 00995000
*           IF TESTRC>0 THEN                                       0515 00996000
@RF00513 LH    @08,TESTRC                                          0515 00997000
         LTR   @08,@08                                             0515 00998000
         BNP   @RF00515                                            0515 00999000
*             CC02=MAX(CC02,LASTCC08);/*                     @Y30LB34*/ 01000000
         LA    @08,8                                               0516 01001000
         CR    CC02,@08                                            0516 01002000
         BNL   *+6                                                      01003000
         LR    CC02,@08                                            0516 01004000
*         END;                      /*                       @Y30LB34*/ 01005000
*                                                                  0517 01006000
@RF00515 DS    0H                                                  0518 01007000
*       /*************************************************************/ 01008000
*       /*                                                           */ 01009000
*       /* IF NO SEVERE ERROR HAS OCCURRED, PLACE THE NAME   @Y30LB34*/ 01010000
*       /* OF THE VSAM CATALOG DD IN SCATDD FOR USE IN       @Y30LB34*/ 01011000
*       /* CHEKSRCE                                          @Y30LB34*/ 01012000
*       /*                                                           */ 01013000
*       /*************************************************************/ 01014000
*                                                                  0518 01015000
*       IF CC02<LASTCC08 THEN                                      0518 01016000
@RF00507 C     CC02,@CF00177                                       0518 01017000
         BNL   @RF00518                                            0518 01018000
*         DO;                       /*                       @Y30LB34*/ 01019000
*           IF ADDR(CATDD)^=NULLPTR THEN                           0520 01020000
         L     @08,@PC00001+4                                      0520 01021000
         L     @08,FDTPTR+48(,@08)                                 0520 01022000
         LTR   @08,@08                                             0520 01023000
         BZ    @RF00520                                            0520 01024000
*             SCATDD=CATDDVAL;      /*                       @Y30LB34*/ 01025000
         MVC   SCATDD(8),CATDDVAL(@08)                             0521 01026000
*           ELSE                                                   0522 01027000
*             SCATDD=' ';           /*                       @Y30LB34*/ 01028000
         B     @RC00520                                            0522 01029000
@RF00520 MVI   SCATDD+1,C' '                                       0522 01030000
         MVC   SCATDD+2(6),SCATDD+1                                0522 01031000
         MVI   SCATDD,C' '                                         0522 01032000
*         END;                      /*                       @Y30LB34*/ 01033000
@RC00520 DS    0H                                                  0524 01034000
*     END;                          /*                       @Y30LB34*/ 01035000
*                                                                  0524 01036000
@RF00518 DS    0H                                                  0525 01037000
*   /*****************************************************************/ 01038000
*   /*                                                               */ 01039000
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/ 01040000
*   /* RETURN TO CALLER                                      #Y30LB34*/ 01041000
*   /*                                                               */ 01042000
*   /*****************************************************************/ 01043000
*                                                                  0525 01044000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 01045000
@RC00482 LR    REG14,RTNREG2                                       0525 01046000
*   RETURN CODE(CC02);              /*                       @Y30LB34*/ 01047000
         LR    @15,CC02                                            0526 01048000
@EL00003 DS    0H                                                  0526 01049000
@EF00003 DS    0H                                                  0526 01050000
@ER00003 BR    @14                                                 0526 01051000
*   END SOINFO;                     /*                       @Y30LB34*/ 01052000
*                                                                  0528 01053000
*/********************************************************** @Y30LB34*/ 01054000
*/*                                                          @Y30LB34*/ 01055000
*/*  PROCEDURE NAME - TAINFO                                 @Y30LB34*/ 01056000
*/*                                                          @Y30LB34*/ 01057000
*/* FUNCTION - RETRIEVES TARGET VOLUME INFORMATION AND SAVES @Y30LB34*/ 01058000
*/*            IT IN TARGAREA.                               @Y30LB34*/ 01059000
*/*                                                          @Y30LB34*/ 01060000
*/*            ISSUES UIOINFO FOR DEVICE TYPE AND VOLSER     @Y30LB34*/ 01061000
*/*            INFORMATION.                                  @Y30LB34*/ 01062000
*/*                                                          @Y30LB34*/ 01063000
*/*            PRINTS ERROR MESSAGE IDC3740I IF MULTIPLE     @Y30LB34*/ 01064000
*/*            VOLUME SERIAL NUMBERS ARE RETURNED BY         @Y30LB34*/ 01065000
*/*            UIOINFO                                       @Y30LB34*/ 01066000
*/*                                                          @Y30LB34*/ 01067000
*/*            ISSUES UMSSUNIT FOR VOLUME TYPE: REAL OR      @YD00175*/ 01068000
*/*            VIRTUAL.                                      @YD00175*/ 01069000
*/*                                                          @Y30LB34*/ 01070000
*/*            IF VOLUME IS REAL ISSUES USYSINFO FOR REAL    @Y30LB34*/ 01071000
*/*            UNIT ADDRESS.                                 @Y30LB34*/ 01072000
*/*                                                          @Y30LB34*/ 01073000
*/* INPUT - FUNCTION DATA TABLE, IOINFOPT, CKAGL, UNITABL    @Y30LB34*/ 01074000
*/*         TARGAREA AND DARGLIST.                           @Y30LB34*/ 01075000
*/*                                                          @Y30LB34*/ 01076000
*/* OUTPUT - INFOAREA, TARGAREA, CKAGL, UNITABL, IOINFOPT.   @Y30LB34*/ 01077000
*/*                                                          @Y30LB34*/ 01078000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 01079000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 01080000
*/*           R. C. =  8, UNABLE TO RETRIEVE DEVTYPE AND     @Y30LB34*/ 01081000
*/*                       VOLSER,                            @Y30LB34*/ 01082000
*/*                       MORE THAN 1 VOLSER RETURNED BY     @Y30LB34*/ 01083000
*/*                       UIOINFO,                           @Y30LB34*/ 01084000
*/*                       UNABLE TO RETRIEVE VOLUME INFO,    @Y30LB34*/ 01085000
*/*                       UNABLE TO RETRIEVE REAL UNIT       @Y30LB34*/ 01086000
*/*                       ADDRESS                            @Y30LB34*/ 01087000
*/*                                                          @Y30LB34*/ 01088000
*/********************************************************** @Y30LB34*/ 01089000
*                                                                  0528 01090000
*TAINFO:                                                           0528 01091000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 01092000
*                                                                  0528 01093000
TAINFO   DS    0H                                                  0529 01094000
*   /*****************************************************************/ 01095000
*   /*                                                               */ 01096000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 01097000
*   /*                                                               */ 01098000
*   /*****************************************************************/ 01099000
*                                                                  0529 01100000
*   DCL                                                            0529 01101000
*     CC03 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   01102000
*                                      CODE SAVE AREA        @Y30LB34*/ 01103000
*                                                                  0530 01104000
*   /*****************************************************************/ 01105000
*   /*                                                               */ 01106000
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/ 01107000
*   /*                                                               */ 01108000
*   /*****************************************************************/ 01109000
*                                                                  0530 01110000
*   OLDERID2=NEWERID2;                                             0530 01111000
         L     @11,@PC00001                                        0530 01112000
         L     @11,GDTTR2(,@11)                                    0530 01113000
         MVC   @TS00001(95),NEWERID2(@11)                          0530 01114000
         MVC   OLDERID2(95,@11),@TS00001                           0530 01115000
*   NEWID2='CNT3';                  /*                       @Y30LB34*/ 01116000
*                                                                  0531 01117000
         MVC   NEWID2(4,@11),@CC01691                              0531 01118000
*   /*****************************************************************/ 01119000
*   /*                                                               */ 01120000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 01121000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 01122000
*   /*                                                               */ 01123000
*   /*****************************************************************/ 01124000
*                                                                  0532 01125000
*   CC03=LASTCC00;                  /*                       @Y30LB34*/ 01126000
         SLR   @08,@08                                             0532 01127000
         LR    CC03,@08                                            0532 01128000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 01129000
*                                                                  0533 01130000
         LR    RTNREG2,REG14                                       0533 01131000
*   /*****************************************************************/ 01132000
*   /*                                                               */ 01133000
*   /* INITIALIZE THE UIOINFO OPTIONS TO RETRIEVE DEVICE     @Y30LB34*/ 01134000
*   /* TYPE AND IF VOLSER NOT SPECIFIED IN CONTROL           @Y30LB34*/ 01135000
*   /* STATEMENT, VOLSER.                                    @Y30LB34*/ 01136000
*   /*                                                               */ 01137000
*   /*****************************************************************/ 01138000
*                                                                  0534 01139000
*   IOINFAR=''B;                    /*                       @Y30LB34*/ 01140000
         MVI   IOINFAR,X'00'                                       0534 01141000
*   INFOAREA=''B;                   /*                       @Y30LB34*/ 01142000
         XC    INFOAREA(54),INFOAREA                               0535 01143000
*   AREALEN=LENGTH(INFOAREA);       /*                       @Y30LB34*/ 01144000
         MVC   AREALEN(2),@CH01872                                 0536 01145000
*   IOINFDVT=ON;                    /*                       @Y30LB34*/ 01146000
         LA    @11,IOINFAR                                         0537 01147000
         OI    IOINFDVT(@11),B'10000000'                           0537 01148000
*   IF ADDR(TVOL)=NULLPTR THEN                                     0538 01149000
         L     @15,@PC00001+4                                      0538 01150000
         C     @08,FDTPTR+12(,@15)                                 0538 01151000
         BNE   @RF00538                                            0538 01152000
*     IOINFVOL=ON;                  /*                       @Y30LB34*/ 01153000
*                                                                  0539 01154000
         OI    IOINFVOL(@11),B'01000000'                           0539 01155000
*   /*****************************************************************/ 01156000
*   /*                                                               */ 01157000
*   /* ISSUE UIOINFO TO RETRIEVE DEVICE TYPE AND VOLSER      @Y30LB34*/ 01158000
*   /*                                                               */ 01159000
*   /*****************************************************************/ 01160000
*                                                                  0540 01161000
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,TFILEVAL);/*       @Y30LB34*/ 01162000
@RF00538 L     @11,@PC00001                                        0540 01163000
         ST    @11,@AL00001                                        0540 01164000
         LA    @08,IOINFAR                                         0540 01165000
         ST    @08,@AL00001+4                                      0540 01166000
         LA    @08,INFOPTR                                         0540 01167000
         ST    @08,@AL00001+8                                      0540 01168000
         L     @08,@PC00001+4                                      0540 01169000
         L     @08,FDTPTR+4(,@08)                                  0540 01170000
         LA    @08,TFILEVAL(,@08)                                  0540 01171000
         ST    @08,@AL00001+12                                     0540 01172000
         MVI   @AL00001+12,X'80'                                   0540 01173000
         L     @15,GDTIFO(,@11)                                    0540 01174000
         LA    @01,@AL00001                                        0540 01175000
         BALR  @14,@15                                             0540 01176000
*   RESPECIFY                                                      0541 01177000
*     RTNREG RSTD;                                                 0541 01178000
*   TESTRC=RTNREG;                                                 0542 01179000
         STH   RTNREG,TESTRC                                       0542 01180000
*   RESPECIFY                                                      0543 01181000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 01182000
*   IF TESTRC>0 THEN                                               0544 01183000
         LH    @11,TESTRC                                          0544 01184000
         LTR   @11,@11                                             0544 01185000
         BNP   @RF00544                                            0544 01186000
*     CC03=LASTCC08;                /*                       @Y30LB34*/ 01187000
         LA    CC03,8                                              0545 01188000
*                                                                  0546 01189000
*   /*****************************************************************/ 01190000
*   /*                                                               */ 01191000
*   /* IF UIOINFO IS SUCCESSFUL SAVE INFORMATION IN          @Y30LB34*/ 01192000
*   /* TARGAREA                                              @Y30LB34*/ 01193000
*   /*                                                               */ 01194000
*   /*****************************************************************/ 01195000
*                                                                  0546 01196000
*   ELSE                                                           0546 01197000
*     DO;                           /*                       @Y30LB34*/ 01198000
*                                                                  0546 01199000
         B     @RC00544                                            0546 01200000
@RF00544 DS    0H                                                  0547 01201000
*       /*************************************************************/ 01202000
*       /*                                                           */ 01203000
*       /* IF UIOINFO RETRIEVED VOLSER STORE DEVICE          @Y30LB34*/ 01204000
*       /* TYPE IN WORK AREA. MAKE SURE UIOINFO              @Y30LB34*/ 01205000
*       /* ONLY RETRIEVED ONE VOLSER. IF ONLY ONE,           @Y30LB34*/ 01206000
*       /* SAVE IT IN TARGAREA. IF MORE THAN                 @Y30LB34*/ 01207000
*       /* ONE, PRINT MESSAGE IDC3740I AND SET THE           @Y30LB34*/ 01208000
*       /* RETURN CODE TO 8.                                 @Y30LB34*/ 01209000
*       /*                                                           */ 01210000
*       /*************************************************************/ 01211000
*                                                                  0547 01212000
*       IF ADDR(TVOL)=NULLPTR THEN                                 0547 01213000
         L     @11,@PC00001+4                                      0547 01214000
         L     @11,FDTPTR+12(,@11)                                 0547 01215000
         LTR   @11,@11                                             0547 01216000
         BNZ   @RF00547                                            0547 01217000
*         DO;                       /*                       @Y30LB34*/ 01218000
*           TDEVTYPE=DEVICE;        /*                       @Y30LB34*/ 01219000
         MVC   TDEVTYPE(4),DEVICE                                  0549 01220000
*           IF VOLLEN=LENGTH(TVOLSER) THEN                         0550 01221000
         CLC   VOLLEN(2),@CH00038                                  0550 01222000
         BNE   @RF00550                                            0550 01223000
*             TVOLSER=FIRVOL;       /*                       @Y30LB34*/ 01224000
         MVC   TVOLSER(6),FIRVOL                                   0551 01225000
*           IF VOLLEN>LENGTH(TVOLSER) THEN                         0552 01226000
@RF00550 LH    @11,VOLLEN                                          0552 01227000
         C     @11,@CF00038                                        0552 01228000
         BNH   @RF00552                                            0552 01229000
*             DO;                   /*                       @Y30LB34*/ 01230000
*               DARGSMOD=CONVMSG;   /*                       @Y30LB34*/ 01231000
         L     @11,DDSTRU                                          0554 01232000
         MVC   DARGSMOD(3,@11),@CC01557                            0554 01233000
*               DARGSENT=MSG3740I;  /*                       @Y30LB34*/ 01234000
         MVI   DARGSENT(@11),X'04'                                 0555 01235000
*               DARGDBP=ADDR(TFILEVAL);/*                    @Y30LB34*/ 01236000
         L     @08,@PC00001+4                                      0556 01237000
         L     @08,FDTPTR+4(,@08)                                  0556 01238000
         LA    @08,TFILEVAL(,@08)                                  0556 01239000
         ST    @08,DARGDBP(,@11)                                   0556 01240000
*               DARGILP=LENGTH(TFILEVAL);/*                  @Y30LB34*/ 01241000
         MVC   DARGILP(2,@11),@CH00177                             0557 01242000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/ 01243000
         L     @11,@PC00001                                        0558 01244000
         ST    @11,@AL00001                                        0558 01245000
         LA    @08,@CF00115                                        0558 01246000
         ST    @08,@AL00001+4                                      0558 01247000
         LA    @08,DDSTRU                                          0558 01248000
         ST    @08,@AL00001+8                                      0558 01249000
         MVI   @AL00001+8,X'80'                                    0558 01250000
         L     @15,GDTPRT(,@11)                                    0558 01251000
         LA    @01,@AL00001                                        0558 01252000
         BALR  @14,@15                                             0558 01253000
*               CC03=LASTCC08;      /*                       @Y30LB34*/ 01254000
         LA    CC03,8                                              0559 01255000
*             END;                  /*                       @Y30LB34*/ 01256000
*         END;                      /*                       @Y30LB34*/ 01257000
*                                                                  0561 01258000
*       /*************************************************************/ 01259000
*       /*                                                           */ 01260000
*       /* IF VOLSER WAS SPECIFIED IN A CONTROL              @Y30LB34*/ 01261000
*       /* STATEMENT ONLY DEVICE TYPE IS RETRIEVED           @Y30LB34*/ 01262000
*       /* FROM UIOINFO AND VOLSER IS RETRIEVED FROM         @Y30LB34*/ 01263000
*       /* THE FUNCTION DATA TABLE.                          @Y30LB34*/ 01264000
*       /*                                                           */ 01265000
*       /*************************************************************/ 01266000
*                                                                  0562 01267000
*       ELSE                                                       0562 01268000
*         DO;                       /*                       @Y30LB34*/ 01269000
         B     @RC00547                                            0562 01270000
@RF00547 DS    0H                                                  0563 01271000
*           TDEVTYPE=DEVONLY;       /*                       @Y30LB34*/ 01272000
         MVC   TDEVTYPE(4),DEVONLY                                 0563 01273000
*           TVOLSER=TVOLVAL;        /*                       @Y30LB34*/ 01274000
         L     @11,@PC00001+4                                      0564 01275000
         L     @11,FDTPTR+12(,@11)                                 0564 01276000
         MVC   TVOLSER(6),TVOLVAL(@11)                             0564 01277000
*         END;                      /*                       @Y30LB34*/ 01278000
*                                                                  0566 01279000
*       /*************************************************************/ 01280000
*       /*                                                           */ 01281000
*       /* INITIALIZE CKAGL TO RETURN VOLUME TYPE            @YD00175*/ 01282000
*       /*                                                           */ 01283000
*       /*************************************************************/ 01284000
*                                                                  0566 01285000
*       CKAGLAR=''B;                /*                       @Y30LB34*/ 01286000
@RC00547 XC    CKAGLAR(29),CKAGLAR                                 0566 01287000
*       CKUCBPTR=ADDR(TUCBADDR);    /*                       @Y30LB34*/ 01288000
         LA    @11,CKAGLAR                                         0567 01289000
         LA    @08,TUCBADDR                                        0567 01290000
         ST    @08,CKUCBPTR(,@11)                                  0567 01291000
*       CKDDNAME=TFILEVAL;          /*                       @Y30LB34*/ 01292000
         L     @08,@PC00001+4                                      0568 01293000
         L     @08,FDTPTR+4(,@08)                                  0568 01294000
         MVC   CKDDNAME(8,@11),TFILEVAL(@08)                       0568 01295000
*       CKDATYPE=ADDR(TTYPEVOL);    /*                       @Y30LB34*/ 01296000
         LA    @08,TTYPEVOL                                        0569 01297000
         ST    @08,CKDATYPE(,@11)                                  0569 01298000
*       CKRETTYP=ON;                /*                       @Y30LB34*/ 01299000
*                                                                  0570 01300000
         OI    CKRETTYP(@11),B'01000000'                           0570 01301000
*       /*************************************************************/ 01302000
*       /*                                                           */ 01303000
*       /* ISSUE UMSSUNIT TO RETRIEVE VOLUME INFO            @Y30LB34*/ 01304000
*       /*                                                           */ 01305000
*       /*************************************************************/ 01306000
*                                                                  0571 01307000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB34*/ 01308000
         L     @08,@PC00001                                        0571 01309000
         ST    @08,@AL00001                                        0571 01310000
         LA    @15,CHECK                                           0571 01311000
         ST    @15,@AL00001+4                                      0571 01312000
         ST    @11,@AL00001+8                                      0571 01313000
         MVI   @AL00001+8,X'80'                                    0571 01314000
         L     @15,GDTUNT(,@08)                                    0571 01315000
         LA    @01,@AL00001                                        0571 01316000
         BALR  @14,@15                                             0571 01317000
*       RESPECIFY                                                  0572 01318000
*         RTNREG RSTD;                                             0572 01319000
*       TESTRC=RTNREG;                                             0573 01320000
         STH   RTNREG,TESTRC                                       0573 01321000
*       RESPECIFY                                                  0574 01322000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 01323000
*                                                                  0574 01324000
*       /*************************************************************/ 01325000
*       /*                                                           */ 01326000
*       /* IF UMSSUNIT WAS NOT SUCCESSFUL, SET THE CONDITION @YD00175*/ 01327000
*       /* CODE TO 8                                         @YD00175*/ 01328000
*       /*                                                           */ 01329000
*       /*************************************************************/ 01330000
*                                                                  0575 01331000
*       IF TESTRC>0 THEN                                           0575 01332000
         LH    @11,TESTRC                                          0575 01333000
         LTR   @11,@11                                             0575 01334000
         BNP   @RF00575                                            0575 01335000
*         CC03=LASTCC08;            /*                       @Y30LB34*/ 01336000
         LA    CC03,8                                              0576 01337000
*                                                                  0577 01338000
*       /*************************************************************/ 01339000
*       /*                                                           */ 01340000
*       /* IF UMSSUNIT IS SUCCESSFUL AND                     @Y30LB34*/ 01341000
*       /* THE VOLUME IS REAL, ISSUE USYSINFO TO RETRIEVE    @Y30LB34*/ 01342000
*       /* THE REAL UNIT ADDRESS. IF UMSSUNIT WAS NOT        @Y30LB34*/ 01343000
*       /* SUCCESSFUL TTYPEVOL WILL BE ZERO                  @Y30LB34*/ 01344000
*       /*                                                           */ 01345000
*       /*************************************************************/ 01346000
*                                                                  0577 01347000
*       IF TTYPEVOL='REAL' THEN                                    0577 01348000
@RF00575 CLC   TTYPEVOL(4),@CC01679                                0577 01349000
         BNE   @RF00577                                            0577 01350000
*         DO;                       /*                       @Y30LB34*/ 01351000
*           CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,TFILEVAL);/*  @Y30LB34*/ 01352000
         L     @11,@PC00001                                        0579 01353000
         ST    @11,@AL00001                                        0579 01354000
         LA    @08,UNIT                                            0579 01355000
         ST    @08,@AL00001+4                                      0579 01356000
         LA    @08,UNITABLP                                        0579 01357000
         ST    @08,@AL00001+8                                      0579 01358000
         L     @08,@PC00001+4                                      0579 01359000
         L     @08,FDTPTR+4(,@08)                                  0579 01360000
         LA    @08,TFILEVAL(,@08)                                  0579 01361000
         ST    @08,@AL00001+12                                     0579 01362000
         MVI   @AL00001+12,X'80'                                   0579 01363000
         L     @15,GDTSFO(,@11)                                    0579 01364000
         LA    @01,@AL00001                                        0579 01365000
         BALR  @14,@15                                             0579 01366000
*           RESPECIFY                                              0580 01367000
*             RTNREG RSTD;                                         0580 01368000
*           TESTRC=RTNREG;                                         0581 01369000
         STH   RTNREG,TESTRC                                       0581 01370000
*           RESPECIFY                                              0582 01371000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 01372000
*           IF TESTRC=0 THEN                                       0583 01373000
         LH    @11,TESTRC                                          0583 01374000
         LTR   @11,@11                                             0583 01375000
         BNZ   @RF00583                                            0583 01376000
*             TUNITADR=UNITADR;     /*                       @Y30LB34*/ 01377000
         L     @11,UNITABLP                                        0584 01378000
         LH    @11,UNITADR(,@11)                                   0584 01379000
         STH   @11,TUNITADR                                        0584 01380000
*           IF TESTRC>0 THEN                                       0585 01381000
@RF00583 LH    @11,TESTRC                                          0585 01382000
         LTR   @11,@11                                             0585 01383000
         BNP   @RF00585                                            0585 01384000
*             CC03=MAX(CC03,LASTCC08);/*                     @Y30LB34*/ 01385000
         LA    @11,8                                               0586 01386000
         CR    CC03,@11                                            0586 01387000
         BNL   *+6                                                      01388000
         LR    CC03,@11                                            0586 01389000
*         END;                      /*                       @Y30LB34*/ 01390000
@RF00585 DS    0H                                                  0588 01391000
*     END;                          /*                       @Y30LB34*/ 01392000
*                                                                  0588 01393000
@RF00577 DS    0H                                                  0589 01394000
*   /*****************************************************************/ 01395000
*   /*                                                               */ 01396000
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/ 01397000
*   /* RETURN TO CALLER                                      #Y30LB34*/ 01398000
*   /*                                                               */ 01399000
*   /*****************************************************************/ 01400000
*                                                                  0589 01401000
*   REG14=RTNREG2;                  /*                       #Y30LB34*/ 01402000
@RC00544 LR    REG14,RTNREG2                                       0589 01403000
*   RETURN CODE(CC03);              /*                       #Y30LB34*/ 01404000
         LR    @15,CC03                                            0590 01405000
@EL00004 DS    0H                                                  0590 01406000
@EF00004 DS    0H                                                  0590 01407000
@ER00004 BR    @14                                                 0590 01408000
*   END TAINFO;                     /*                       #Y30LB34*/ 01409000
*                                                                  0592 01410000
*/********************************************************** #Y30LB34*/ 01411000
*/*                                                          #Y30LB34*/ 01412000
*/* PROCEDURE NAME - RVPROC                                  #Y30LB34*/ 01413000
*/*                                                          #Y30LB34*/ 01414000
*/* FUNCTION - CONTROLS THE REAL TO VIRTUAL CONVERSION       #Y30LB34*/ 01415000
*/*                                                          #Y30LB34*/ 01416000
*/*            CALLS RVINITSO TO INTERROGATE SOURCE VOLUME   #Y30LB34*/ 01417000
*/*                                                          @Y30LB34*/ 01418000
*/*            CALLS RVINITTA TO INTERROGATE TARGET VOLUME   @Y30LB34*/ 01419000
*/*                                                          @Y30LB34*/ 01420000
*/*            CALLS RVMOVE TO CONTROL THE CONVERSION OF     @Y30LB34*/ 01421000
*/*            DATA FROM REAL TO VIRTUAL                     @Y30LB34*/ 01422000
*/*                                                          @Y30LB34*/ 01423000
*/*            TESTS IF SOURCE VOLUME VTOC SHOULD BE         @Y30LB34*/ 01424000
*/*            SCRATCHED, AND, IF SO, CALLS RVSCRV           @Y30LB34*/ 01425000
*/*                                                          @Y30LB34*/ 01426000
*/*            DEQUEUES SOURCE VOLUME RESERVED IN CHEKSRCE   @Y30LB34*/ 01427000
*/*                                                          @Y30LB34*/ 01428000
*/* INPUT - FUNCTION DATA TABLE                              @Y30LB34*/ 01429000
*/*                                                          @Y30LB34*/ 01430000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 01431000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 01432000
*/*           R. C. =  4, RETURN CODE FROM RVINITSO,         @Y30LB34*/ 01433000
*/*                       RVINITTA, RVMOVE OR RVSCRV         @Y30LB34*/ 01434000
*/*           R. C. =  8, RETURN CODE FROM RVMOVE            @Y30LB34*/ 01435000
*/*           R. C. = 12, RETURN CODE FROM RVINITSO,         @Y30LB34*/ 01436000
*/*                       RVINITTA, RVMOVE OR RVSCRV         @Y30LB34*/ 01437000
*/*                                                          @Y30LB34*/ 01438000
*/********************************************************** @Y30LB34*/ 01439000
*                                                                  0592 01440000
*RVPROC:                                                           0592 01441000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 01442000
*                                                                  0592 01443000
RVPROC   DS    0H                                                  0593 01444000
*   /*****************************************************************/ 01445000
*   /*                                                               */ 01446000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 01447000
*   /*                                                               */ 01448000
*   /*****************************************************************/ 01449000
*                                                                  0593 01450000
*   DCL                                                            0593 01451000
*     CC04 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   01452000
*                                      CODE SAVE AREA        @Y30LB34*/ 01453000
*                                                                  0594 01454000
*   /*****************************************************************/ 01455000
*   /*                                                               */ 01456000
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/ 01457000
*   /*                                                               */ 01458000
*   /*****************************************************************/ 01459000
*                                                                  0594 01460000
*   OLDERID2=NEWERID2;                                             0594 01461000
         L     @07,@PC00001                                        0594 01462000
         L     @07,GDTTR2(,@07)                                    0594 01463000
         MVC   @TS00001(95),NEWERID2(@07)                          0594 01464000
         MVC   OLDERID2(95,@07),@TS00001                           0594 01465000
*   NEWID2='CNT4';                  /*                       @Y30LB34*/ 01466000
*                                                                  0595 01467000
         MVC   NEWID2(4,@07),@CC01696                              0595 01468000
*   /*****************************************************************/ 01469000
*   /*                                                               */ 01470000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 01471000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 01472000
*   /*                                                               */ 01473000
*   /*****************************************************************/ 01474000
*                                                                  0596 01475000
*   CC04=LASTCC00;                  /*                       @Y30LB34*/ 01476000
         SLR   @07,@07                                             0596 01477000
         STH   @07,CC04                                            0596 01478000
*   RTNREG1=REG14;                  /*                       @Y30LB34*/ 01479000
*                                                                  0597 01480000
         ST    REG14,RTNREG1                                       0597 01481000
*   /*****************************************************************/ 01482000
*   /*                                                               */ 01483000
*   /* CALL RVINITSO TO INTERROGATE THE REAL SOURCE VOLUME   @Y30LB34*/ 01484000
*   /*                                                               */ 01485000
*   /*****************************************************************/ 01486000
*                                                                  0598 01487000
*   CALL RVINITSO;                  /*                       @Y30LB34*/ 01488000
         BAL   @14,RVINITSO                                        0598 01489000
*   RESPECIFY                                                      0599 01490000
*     RTNREG RSTD;                                                 0599 01491000
*   TESTRC=RTNREG;                                                 0600 01492000
         STH   RTNREG,TESTRC                                       0600 01493000
*   RESPECIFY                                                      0601 01494000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 01495000
*   CC04=TESTRC;                    /*                       @Y30LB34*/ 01496000
*                                                                  0602 01497000
         LH    @07,TESTRC                                          0602 01498000
         STH   @07,CC04                                            0602 01499000
*   /*****************************************************************/ 01500000
*   /*                                                               */ 01501000
*   /* IF NO SEVERE ERRORS OCCURRED IN RVINITSO, CALL        @Y30LB34*/ 01502000
*   /* RVINITTA TO INTERROGATE THE MSS TARGET VOLUME         @Y30LB34*/ 01503000
*   /*                                                               */ 01504000
*   /*****************************************************************/ 01505000
*                                                                  0603 01506000
*   IF CC04<LASTCC12 THEN                                          0603 01507000
         C     @07,@CF00567                                        0603 01508000
         BNL   @RF00603                                            0603 01509000
*     DO;                           /*                       @Y30LB34*/ 01510000
*       CALL RVINITTA;              /*                       @Y30LB34*/ 01511000
         BAL   @14,RVINITTA                                        0605 01512000
*       RESPECIFY                                                  0606 01513000
*         RTNREG RSTD;                                             0606 01514000
*       TESTRC=RTNREG;                                             0607 01515000
         STH   RTNREG,TESTRC                                       0607 01516000
*       RESPECIFY                                                  0608 01517000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 01518000
*       CC04=MAX(CC04,TESTRC);      /*                       @Y30LB34*/ 01519000
         LH    @07,TESTRC                                          0609 01520000
         LH    @15,CC04                                            0609 01521000
         CR    @15,@07                                             0609 01522000
         BNL   *+6                                                      01523000
         LR    @15,@07                                             0609 01524000
         STH   @15,CC04                                            0609 01525000
*     END;                          /*                       @Y30LB34*/ 01526000
*                                                                  0611 01527000
*   /*****************************************************************/ 01528000
*   /*                                                               */ 01529000
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, CALL RVMOVE        @Y30LB34*/ 01530000
*   /* TO HANDLE THE DATA CONVERSION FROM REAL TO VIRTUAL    @Y30LB34*/ 01531000
*   /*                                                               */ 01532000
*   /*****************************************************************/ 01533000
*                                                                  0611 01534000
*   IF CC04<LASTCC12 THEN                                          0611 01535000
@RF00603 LH    @07,CC04                                            0611 01536000
         C     @07,@CF00567                                        0611 01537000
         BNL   @RF00611                                            0611 01538000
*     DO;                           /*                       @Y30LB34*/ 01539000
*       CALL RVMOVE;                /*                       @Y30LB34*/ 01540000
         BAL   @14,RVMOVE                                          0613 01541000
*       RESPECIFY                                                  0614 01542000
*         RTNREG RSTD;                                             0614 01543000
*       TESTRC=RTNREG;                                             0615 01544000
         STH   RTNREG,TESTRC                                       0615 01545000
*       RESPECIFY                                                  0616 01546000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 01547000
*       CC04=MAX(CC04,TESTRC);      /*                       @Y30LB34*/ 01548000
         LH    @07,TESTRC                                          0617 01549000
         LH    @15,CC04                                            0617 01550000
         CR    @15,@07                                             0617 01551000
         BNL   *+6                                                      01552000
         LR    @15,@07                                             0617 01553000
         STH   @15,CC04                                            0617 01554000
*     END;                          /*                       @Y30LB34*/ 01555000
*                                                                  0618 01556000
*   /*****************************************************************/ 01557000
*   /*                                                               */ 01558000
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, AND IF             @Y30LB34*/ 01559000
*   /* 'NOSCRATCH' WAS NOT SPECIFIED IN A CONTROL            @Y30LB34*/ 01560000
*   /* STATEMENT, CALL RVSCRV TO SCRATCH THE SOURCE          @Y30LB34*/ 01561000
*   /* VOLUME VTOC                                           @Y30LB34*/ 01562000
*   /*                                                               */ 01563000
*   /*****************************************************************/ 01564000
*                                                                  0619 01565000
*   IF CC04<LASTCC12 THEN                                          0619 01566000
@RF00611 LH    @07,CC04                                            0619 01567000
         C     @07,@CF00567                                        0619 01568000
         BNL   @RF00619                                            0619 01569000
*     IF ADDR(NSCR)=NULLPTR THEN                                   0620 01570000
         L     @07,@PC00001+4                                      0620 01571000
         L     @07,FDTPTR+36(,@07)                                 0620 01572000
         LTR   @07,@07                                             0620 01573000
         BNZ   @RF00620                                            0620 01574000
*       DO;                         /*                       @Y30LB34*/ 01575000
*         CALL RVSCRV;              /*                       @Y30LB34*/ 01576000
         BAL   @14,RVSCRV                                          0622 01577000
*         RESPECIFY                                                0623 01578000
*           RTNREG RSTD;                                           0623 01579000
*         TESTRC=RTNREG;                                           0624 01580000
         STH   RTNREG,TESTRC                                       0624 01581000
*         RESPECIFY                                                0625 01582000
*           RTNREG UNRSTD;          /*                       @Y30LB34*/ 01583000
*         CC04=MAX(CC04,TESTRC);    /*                       @Y30LB34*/ 01584000
         LH    @07,TESTRC                                          0626 01585000
         LH    @15,CC04                                            0626 01586000
         CR    @15,@07                                             0626 01587000
         BNL   *+6                                                      01588000
         LR    @15,@07                                             0626 01589000
         STH   @15,CC04                                            0626 01590000
*       END;                        /*                       @Y30LB34*/ 01591000
*                                                                  0628 01592000
*   /*****************************************************************/ 01593000
*   /*                                                               */ 01594000
*   /* IF THE SOURCE VOLUME WAS RESERVED IN CHEKSRCE,        @Y30LB34*/ 01595000
*   /* DEQUEUE THAT RESERVE AND SET OFF THE SOURCE RESERVE   @Y30LB34*/ 01596000
*   /* BIT                                                   @Y30LB34*/ 01597000
*   /*                                                               */ 01598000
*   /*****************************************************************/ 01599000
*                                                                  0628 01600000
*   IF SRES=ON THEN                                                0628 01601000
@RF00620 DS    0H                                                  0628 01602000
@RF00619 TM    SRES,B'01000000'                                    0628 01603000
         BNO   @RF00628                                            0628 01604000
*     DO;                           /*                       @Y30LB34*/ 01605000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMERR);/*               @Y30LB34*/ 01606000
         L     @07,@PC00001                                        0630 01607000
         ST    @07,@AL00001                                        0630 01608000
         LA    @15,@CC01594                                        0630 01609000
         ST    @15,@AL00001+4                                      0630 01610000
         LA    @15,RNAMERR                                         0630 01611000
         ST    @15,@AL00001+8                                      0630 01612000
         MVI   @AL00001+8,X'80'                                    0630 01613000
         L     @15,GDTDEQ(,@07)                                    0630 01614000
         LA    @01,@AL00001                                        0630 01615000
         BALR  @14,@15                                             0630 01616000
*       SRES=OFF;                   /*                       @Y30LB34*/ 01617000
         NI    SRES,B'10111111'                                    0631 01618000
*     END;                          /*                       @Y30LB34*/ 01619000
*                                                                  0632 01620000
*   /*****************************************************************/ 01621000
*   /*                                                               */ 01622000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 01623000
*   /* RETURN TO CALLING PROCEDURE                           @Y30LB34*/ 01624000
*   /*                                                               */ 01625000
*   /*****************************************************************/ 01626000
*                                                                  0633 01627000
*   REG14=RTNREG1;                  /*                       @Y30LB34*/ 01628000
@RF00628 L     REG14,RTNREG1                                       0633 01629000
*   RETURN CODE(CC04);              /*                       @Y30LB34*/ 01630000
         LH    @15,CC04                                            0634 01631000
@EL00005 DS    0H                                                  0634 01632000
@EF00005 DS    0H                                                  0634 01633000
@ER00005 BR    @14                                                 0634 01634000
*   END RVPROC;                     /*                       @Y30LB34*/ 01635000
*                                                                  0636 01636000
*/********************************************************** @Y30LB34*/ 01637000
*/*                                                          @Y30LB34*/ 01638000
*/* PROCEDURE NAME - RVINITSO                                @Y30LB34*/ 01639000
*/*                                                          @Y30LB34*/ 01640000
*/* FUNCTION - INTERROGATES THE REAL SOURCE VOLUME           @Y30LB34*/ 01641000
*/*                                                          @Y30LB34*/ 01642000
*/*            CALLS RVGETSO TO DEMOUNT THE TARGET VOLUME    @Y30LB34*/ 01643000
*/*                                                          @Y30LB34*/ 01644000
*/*            CALLS CHEKSRCE TO CHECK SOURCE VOLUME         @Y30LB34*/ 01645000
*/*                                                          @Y30LB34*/ 01646000
*/* INPUT - SAMESER                                          @Y30LB34*/ 01647000
*/*                                                          @Y30LB34*/ 01648000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 01649000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 01650000
*/*           R. C. =  4, RETURN CODE FROM CHEKSRCE          @Y30LB34*/ 01651000
*/*           R. C. = 12, RETURN CODE FROM RVGETSO OR        @Y30LB34*/ 01652000
*/*                       CHEKSRCE                           @Y30LB34*/ 01653000
*/*                                                          @Y30LB34*/ 01654000
*/********************************************************** @Y30LB34*/ 01655000
*                                                                  0636 01656000
*RVINITSO:                                                         0636 01657000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 01658000
*                                                                  0636 01659000
RVINITSO DS    0H                                                  0637 01660000
*   /*****************************************************************/ 01661000
*   /*                                                               */ 01662000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 01663000
*   /*                                                               */ 01664000
*   /*****************************************************************/ 01665000
*                                                                  0637 01666000
*   DCL                                                            0637 01667000
*     CC05 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   01668000
*                                      CODE SAVE AREA        @Y30LB34*/ 01669000
*                                                                  0638 01670000
*   /*****************************************************************/ 01671000
*   /*                                                               */ 01672000
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/ 01673000
*   /*                                                               */ 01674000
*   /*****************************************************************/ 01675000
*                                                                  0638 01676000
*   OLDERID2=NEWERID2;                                             0638 01677000
         L     @10,@PC00001                                        0638 01678000
         L     @10,GDTTR2(,@10)                                    0638 01679000
         MVC   @TS00001(95),NEWERID2(@10)                          0638 01680000
         MVC   OLDERID2(95,@10),@TS00001                           0638 01681000
*   NEWID2='CNT5';                  /*                       @Y30LB34*/ 01682000
*                                                                  0639 01683000
         MVC   NEWID2(4,@10),@CC01705                              0639 01684000
*   /*****************************************************************/ 01685000
*   /*                                                               */ 01686000
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/ 01687000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 01688000
*   /*                                                               */ 01689000
*   /*****************************************************************/ 01690000
*                                                                  0640 01691000
*   CC05=LASTCC00;                  /*                       @Y30LB34*/ 01692000
         SLR   CC05,CC05                                           0640 01693000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 01694000
*                                                                  0641 01695000
         LR    RTNREG2,REG14                                       0641 01696000
*   /*****************************************************************/ 01697000
*   /*                                                               */ 01698000
*   /* CALL RVGETSO TO INITIALIZE MOUNT/DEMOUNT PARAMETER    @Y30LB34*/ 01699000
*   /* LISTS AND IF SERIAL NUMBERS ARE THE SAME, DEMOUNT     @Y30LB34*/ 01700000
*   /* MSS TARGET VOLUME                                     @Y30LB34*/ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                                  0642 01704000
*   CALL RVGETSO;                   /*                       @Y30LB34*/ 01705000
         BAL   @14,RVGETSO                                         0642 01706000
*   RESPECIFY                                                      0643 01707000
*     RTNREG RSTD;                                                 0643 01708000
*   TESTRC=RTNREG;                                                 0644 01709000
         STH   RTNREG,TESTRC                                       0644 01710000
*   RESPECIFY                                                      0645 01711000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 01712000
*   CC05=TESTRC;                    /*                       @Y30LB34*/ 01713000
*                                                                  0646 01714000
         LH    @15,TESTRC                                          0646 01715000
         LR    CC05,@15                                            0646 01716000
*   /*****************************************************************/ 01717000
*   /*                                                               */ 01718000
*   /* IF NO SEVERE ERRORS OCCURRED, CALL CHEKSRCE TO        @Y30LB34*/ 01719000
*   /* PERFORM SECURITY CHECKING ON THE SOURCE VOLUME AND    @Y30LB34*/ 01720000
*   /* CHECK JOB SETUP WITH RESPECT TO THE SOURCE VOLUME     @Y30LB34*/ 01721000
*   /*                                                               */ 01722000
*   /*****************************************************************/ 01723000
*                                                                  0647 01724000
*   IF CC05<LASTCC12 THEN                                          0647 01725000
         C     CC05,@CF00567                                       0647 01726000
         BNL   @RF00647                                            0647 01727000
*     DO;                           /*                       @Y30LB34*/ 01728000
*       CALL CHEKSRCE;              /*                       @Y30LB34*/ 01729000
         BAL   @14,CHEKSRCE                                        0649 01730000
*       RESPECIFY                                                  0650 01731000
*         RTNREG RSTD;                                             0650 01732000
*       TESTRC=RTNREG;                                             0651 01733000
         STH   RTNREG,TESTRC                                       0651 01734000
*       RESPECIFY                                                  0652 01735000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 01736000
*       CC05=MAX(CC05,TESTRC);      /*                       @Y30LB34*/ 01737000
         LH    @10,TESTRC                                          0653 01738000
         CR    CC05,@10                                            0653 01739000
         BNL   *+6                                                      01740000
         LR    CC05,@10                                            0653 01741000
*     END;                          /*                       @Y30LB34*/ 01742000
*                                                                  0655 01743000
*   /*****************************************************************/ 01744000
*   /*                                                               */ 01745000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 01746000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 01747000
*   /*                                                               */ 01748000
*   /*****************************************************************/ 01749000
*                                                                  0655 01750000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 01751000
@RF00647 LR    REG14,RTNREG2                                       0655 01752000
*   RETURN CODE(CC05);              /*                       @Y30LB34*/ 01753000
         LR    @15,CC05                                            0656 01754000
@EL00006 DS    0H                                                  0656 01755000
@EF00006 DS    0H                                                  0656 01756000
@ER00006 BR    @14                                                 0656 01757000
*   END RVINITSO;                   /*                       @Y30LB34*/ 01758000
*                                                                  0658 01759000
*/********************************************************** @Y30LB34*/ 01760000
*/*                                                          @Y30LB34*/ 01761000
*/* PROCEDURE NAME - RVGETSO                                 @Y30LB34*/ 01762000
*/*                                                          @Y30LB34*/ 01763000
*/* FUNCTION - OBTAINS EXCLUSIVE CONTROL OF THE TARGET       @YD00175*/ 01764000
*/*            MASS STORAGE VOL PRIOR TO POSSIBLE DEMOUNT.   @YD00175*/ 01765000
*/*            INITIALIZES THE MOUNT/DEMOUNT PARM LIST FOR   @YD00175*/ 01766000
*/*            THE VIRTUAL TARGET VOLUME.                    @YD00175*/ 01767000
*/*                                                          #Y30LB34*/ 01768000
*/*            IF THE VOLUMES HAVE THE SAME VOLSERS,         #Y30LB34*/ 01769000
*/*            INITIALIZES THE POST/CLEAR PARM LIST FOR THE  #Y30LB34*/ 01770000
*/*            SOURCE VOLUME                                 @Y30LB34*/ 01771000
*/*                                                          @Y30LB34*/ 01772000
*/*            DEMOUNTS THE MSS VOLUME IF SOURCE AND         @Y30LB34*/ 01773000
*/*            TARGET SERIAL NUMBERS ARE THE SAME            @Y30LB34*/ 01774000
*/*                                                          @Y30LB34*/ 01775000
*/* INPUT - FUNCTION DATA TABLE, MDAGL, PUAGL, SRCEAREA,     @Y30LB34*/ 01776000
*/*         TARGAREA, AND SAMESER                            @Y30LB34*/ 01777000
*/*                                                          @Y30LB34*/ 01778000
*/* OUTPUT - MDAGL, PUAGL, SRCEAREA, TARGAREA                @Y30LB34*/ 01779000
*/*                                                          @Y30LB34*/ 01780000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 01781000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 01782000
*/*           R. C. = 12, UNABLE TO DEMOUNT MSS VOLUME       @Y30LB34*/ 01783000
*/*                   OR OBTAIN EXCLUSIVE CONTROL OF VOLUME  @YD00175*/ 01784000
*/*                                                          @Y30LB34*/ 01785000
*/********************************************************** @Y30LB34*/ 01786000
*                                                                  0658 01787000
*RVGETSO:                                                          0658 01788000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 01789000
*                                                                  0658 01790000
RVGETSO  DS    0H                                                  0659 01791000
*   /*****************************************************************/ 01792000
*   /*                                                               */ 01793000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 01794000
*   /*                                                               */ 01795000
*   /*****************************************************************/ 01796000
*                                                                  0659 01797000
*   DCL                                                            0659 01798000
*     CC06 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   01799000
*                                      CODE SAVE AREA        @Y30LB34*/ 01800000
*                                                                  0660 01801000
*   /*****************************************************************/ 01802000
*   /*                                                               */ 01803000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 01804000
*   /*                                                               */ 01805000
*   /*****************************************************************/ 01806000
*                                                                  0660 01807000
*   OLDERID2=NEWERID2;                                             0660 01808000
         L     @08,@PC00001                                        0660 01809000
         L     @15,GDTTR2(,@08)                                    0660 01810000
         MVC   @TS00001(95),NEWERID2(@15)                          0660 01811000
         MVC   OLDERID2(95,@15),@TS00001                           0660 01812000
*   NEWID2='CNT6';                  /*                       @Y30LB34*/ 01813000
*                                                                  0661 01814000
         MVC   NEWID2(4,@15),@CC01712                              0661 01815000
*   /*****************************************************************/ 01816000
*   /*                                                               */ 01817000
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/ 01818000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 01819000
*   /*                                                               */ 01820000
*   /*****************************************************************/ 01821000
*                                                                  0662 01822000
*   CC06=LASTCC00;                  /*                       @Y30LB34*/ 01823000
         SLR   CC06,CC06                                           0662 01824000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 01825000
*                                                                  0663 01826000
         ST    REG14,RTNREG3                                       0663 01827000
*   /*****************************************************************/ 01828000
*   /*                                                               */ 01829000
*   /* INITIALIZE THE PARAMETER LIST TO GET EXCLUSIVE        @YD00175*/ 01830000
*   /* CONTROL                                               @YD00175*/ 01831000
*   /*                                                               */ 01832000
*   /*****************************************************************/ 01833000
*                                                                  0664 01834000
*   EXCLAGL=''B;                    /*                       @YD00175*/ 01835000
         LA    @15,EXCLAR                                          0664 01836000
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        0664 01837000
*   EXCLUCBP=ADDR(TUCBADDR);        /*                       @YD00175*/ 01838000
         LA    @14,TUCBADDR                                        0665 01839000
         ST    @14,EXCLUCBP(,@15)                                  0665 01840000
*   EXCLDDP=ADDR(TFILEVAL);         /*                       @YD00175*/ 01841000
*                                                                  0666 01842000
         L     @14,@PC00001+4                                      0666 01843000
         L     @01,FDTPTR+4(,@14)                                  0666 01844000
         LA    @14,TFILEVAL(,@01)                                  0666 01845000
         ST    @14,EXCLDDP(,@15)                                   0666 01846000
*   /*****************************************************************/ 01847000
*   /*                                                               */ 01848000
*   /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL               @YD00175*/ 01849000
*   /*                                                               */ 01850000
*   /*****************************************************************/ 01851000
*                                                                  0667 01852000
*   CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*                 @YD00175*/ 01853000
         ST    @08,@AL00001                                        0667 01854000
         LA    @14,CHANGEX                                         0667 01855000
         ST    @14,@AL00001+4                                      0667 01856000
         ST    @15,@AL00001+8                                      0667 01857000
         MVI   @AL00001+8,X'80'                                    0667 01858000
         L     @15,GDTUNT(,@08)                                    0667 01859000
         LA    @01,@AL00001                                        0667 01860000
         BALR  @14,@15                                             0667 01861000
*   RESPECIFY                                                      0668 01862000
*     RTNREG RSTD;                                                 0668 01863000
*   TESTRC=RTNREG;                                                 0669 01864000
         STH   RTNREG,TESTRC                                       0669 01865000
*   RESPECIFY                                                      0670 01866000
*     RTNREG UNRSTD;                /*                       @YD00175*/ 01867000
*                                                                  0670 01868000
*   /*****************************************************************/ 01869000
*   /*                                                               */ 01870000
*   /* IF RETURN CODE FROM UMSSUNIT NOT ZERO, SET INTERNAL   @YD00175*/ 01871000
*   /* CONDITION CODE TO 12                                  @YD00175*/ 01872000
*   /*                                                               */ 01873000
*   /*****************************************************************/ 01874000
*                                                                  0671 01875000
*   IF TESTRC>0 THEN                                               0671 01876000
         LH    @08,TESTRC                                          0671 01877000
         LTR   @08,@08                                             0671 01878000
         BNP   @RF00671                                            0671 01879000
*     CC06=LASTCC12;                /*                       @YD00175*/ 01880000
*                                                                  0672 01881000
         LA    CC06,12                                             0672 01882000
*   /*****************************************************************/ 01883000
*   /*                                                               */ 01884000
*   /* INITIALIZE THE UMSSUNIT MOUNT/DEMOUNT PARM LIST       #Y30LB34*/ 01885000
*   /*                                                               */ 01886000
*   /*****************************************************************/ 01887000
*                                                                  0673 01888000
*   MDUCBPTR=ADDR(TUCBADDR);        /*                       #Y30LB34*/ 01889000
@RF00671 LA    @08,MDAGLAR                                         0673 01890000
         LA    @15,TUCBADDR                                        0673 01891000
         ST    @15,MDUCBPTR(,@08)                                  0673 01892000
*   MDDDNAME=TFILEVAL;              /*                       #Y30LB34*/ 01893000
         L     @15,@PC00001+4                                      0674 01894000
         L     @01,FDTPTR+4(,@15)                                  0674 01895000
         MVC   MDDDNAME(8,@08),TFILEVAL(@01)                       0674 01896000
*   MDLABEL=TVOLSER;                /*                       #Y30LB34*/ 01897000
         MVC   MDLABEL(6,@08),TVOLSER                              0675 01898000
*                                                                  0676 01899000
*   /*****************************************************************/ 01900000
*   /*                                                               */ 01901000
*   /* IF SOURCE AND TARGET VOLSERS ARE EQUAL, INITIALIZE    @Y30LB34*/ 01902000
*   /* THE UMSSUNIT POST/CLEAR PARM LIST AND DEMOUNT THE     @Y30LB34*/ 01903000
*   /* MSS TARGET VOLUME                                     @Y30LB34*/ 01904000
*   /*                                                               */ 01905000
*   /*****************************************************************/ 01906000
*                                                                  0676 01907000
*   IF CC06=0&SAMESER=ON THEN                                      0676 01908000
         LTR   CC06,CC06                                           0676 01909000
         BNZ   @RF00676                                            0676 01910000
         TM    SAMESER,B'10000000'                                 0676 01911000
         BNO   @RF00676                                            0676 01912000
*     DO;                           /*                       @YD00175*/ 01913000
*       PUUCBPTR=ADDR(SUCBADDR);    /*                       @Y30LB34*/ 01914000
         LA    @15,PUAGLAR                                         0678 01915000
         LA    @14,SUCBADDR                                        0678 01916000
         ST    @14,PUUCBPTR(,@15)                                  0678 01917000
*       PULABELP=ADDR(SLABEL);      /*                       @Y30LB34*/ 01918000
         LA    @14,SLABEL                                          0679 01919000
         ST    @14,PULABELP(,@15)                                  0679 01920000
*       PUTTRPTR=ADDR(SVTOCTTR);    /*                       @Y30LB34*/ 01921000
         LA    @14,SVTOCTTR                                        0680 01922000
         ST    @14,PUTTRPTR(,@15)                                  0680 01923000
*       MDPUAGL=ADDR(PUAGLAR);      /*                       @Y30LB34*/ 01924000
*                                                                  0681 01925000
         ST    @15,MDPUAGL(,@08)                                   0681 01926000
*       /*************************************************************/ 01927000
*       /*                                                           */ 01928000
*       /* ISSUE UMSSUNIT TO DEMOUNT THE MSS TARGET VOLUME   @Y30LB34*/ 01929000
*       /* IF IT IS MOUNTED. THE REAL VOLUME CAN THEN BE     @Y30LB34*/ 01930000
*       /* MOUNTED WITHOUT DUPLICATE SERIAL NUMBERS. IF THE  @Y30LB34*/ 01931000
*       /* TARGET VOLUME IS NOT MOUNTED, UMSSUNIT RETURNS A  @Y30LB34*/ 01932000
*       /* SUCCESSFUL COMPLETION CODE SAYING IT IS DEMOUNTED @Y30LB34*/ 01933000
*       /*                                                           */ 01934000
*       /*************************************************************/ 01935000
*                                                                  0682 01936000
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB34*/ 01937000
         L     @15,@PC00001                                        0682 01938000
         ST    @15,@AL00001                                        0682 01939000
         LA    @14,DEMOUNT                                         0682 01940000
         ST    @14,@AL00001+4                                      0682 01941000
         ST    @08,@AL00001+8                                      0682 01942000
         MVI   @AL00001+8,X'80'                                    0682 01943000
         L     @15,GDTUNT(,@15)                                    0682 01944000
         LA    @01,@AL00001                                        0682 01945000
         BALR  @14,@15                                             0682 01946000
*       RESPECIFY                                                  0683 01947000
*         RTNREG RSTD;                                             0683 01948000
*       TESTRC=RTNREG;                                             0684 01949000
         STH   RTNREG,TESTRC                                       0684 01950000
*       RESPECIFY                                                  0685 01951000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 01952000
*                                                                  0685 01953000
*       /*************************************************************/ 01954000
*       /*                                                           */ 01955000
*       /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE CONDITION  @Y30LB34*/ 01956000
*       /* CODE TO 12 AND TERMINATE THE COMMAND              @Y30LB34*/ 01957000
*       /*                                                           */ 01958000
*       /*************************************************************/ 01959000
*                                                                  0686 01960000
*       IF TESTRC>0 THEN                                           0686 01961000
         LH    @08,TESTRC                                          0686 01962000
         LTR   @08,@08                                             0686 01963000
         BNP   @RF00686                                            0686 01964000
*         CC06=LASTCC12;            /*                       @Y30LB34*/ 01965000
         LA    CC06,12                                             0687 01966000
*     END;                          /*                       @Y30LB34*/ 01967000
*                                                                  0688 01968000
@RF00686 DS    0H                                                  0689 01969000
*   /*****************************************************************/ 01970000
*   /*                                                               */ 01971000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 01972000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 01973000
*   /*                                                               */ 01974000
*   /*****************************************************************/ 01975000
*                                                                  0689 01976000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 01977000
@RF00676 L     REG14,RTNREG3                                       0689 01978000
*   RETURN CODE(CC06);              /*                       @Y30LB34*/ 01979000
         LR    @15,CC06                                            0690 01980000
@EL00007 DS    0H                                                  0690 01981000
@EF00007 DS    0H                                                  0690 01982000
@ER00007 BR    @14                                                 0690 01983000
*   END RVGETSO;                    /*                       @Y30LB34*/ 01984000
*                                                                  0692 01985000
*/********************************************************** @Y30LB34*/ 01986000
*/*                                                          @Y30LB34*/ 01987000
*/* PROCEDURE NAME - CHEKSRCE                                @Y30LB34*/ 01988000
*/*                                                          @Y30LB34*/ 01989000
*/* FUNCTION - PERFORMS SOURCE VOLUME CHECKING               @Y30LB34*/ 01990000
*/*                                                          @Y30LB34*/ 01991000
*/*            INITIALIZES IDCVS01 PARM LIST FOR ALL         @Y30LB34*/ 01992000
*/*            VOLUME SERVICES REQUESTS ON THE SOURCE VOLUME @Y30LB34*/ 01993000
*/*                                                          @Y30LB34*/ 01994000
*/*            CALLS VOLUME SERVICES TO PERFORM SECURITY     @Y30LB34*/ 01995000
*/*            CHECKING AND TESTING FOR VSAM OWNERSHIP       @Y30LB34*/ 01996000
*/*            AND USER CATALOG ON VOLUME                    @Y30LB34*/ 01997000
*/*                                                          @Y30LB34*/ 01998000
*/*            IF VOLUME IS VSAM, DETERMINES IF ERROR        @Y30LB34*/ 01999000
*/*            CONDITIONS EXIST IN CONTROL STATEMENTS        @Y30LB34*/ 02000000
*/*            WHICH SHOULD CAUSE TERMINATION OF THE         @Y30LB34*/ 02001000
*/*            COMMAND                                       @Y30LB34*/ 02002000
*/*                PRINTS ERROR MESSAGE IDC3741I FOR AN      @Y30LB34*/ 02003000
*/*                INVALID RECATALOG OPTION,                 @Y30LB34*/ 02004000
*/*                PRINTS ERROR MESSAGE IDC3067I FOR AN      @Y30LB34*/ 02005000
*/*                INVALID SERIAL NUMBER SPECIFIED,          @Y30LB34*/ 02006000
*/*                PRINTS ERROR MESSAGE IDC3745I FOR NOT     @Y30LB34*/ 02007000
*/*                SUPPLYING A DD NAME FOR USER CATALOG      @Y30LB34*/ 02008000
*/*                ON VOLUME,                                @Y30LB34*/ 02009000
*/*                PRINTS ERROR MESSAGE IDC3744I FOR USING   @Y30LB34*/ 02010000
*/*                A JOBCAT OR STEPCAT STATEMENT TO OPEN     @Y30LB34*/ 02011000
*/*                USER CATALOG ON VOLUME.                   @Y30LB34*/ 02012000
*/*                                                          @Y30LB34*/ 02013000
*/*            CLOSES THE VTOC OPENED BY VOLUME SERVICES     @Y30LB34*/ 02014000
*/*                                                          @YD00175*/ 02015000
*/*            GETS EXCLUSIVE CONTROL OF SOURCE VOLUME USING @YD00175*/ 02016000
*/*            UMSSUNIT MACRO                                @YD00175*/ 02017000
*/*                                                          @Y30LB34*/ 02018000
*/* INPUT - FRVS1AGL, SRCEAREA, FUNCTION DATA TABLE,         @Y30LB34*/ 02019000
*/*         DARGLIST                                         @Y30LB34*/ 02020000
*/*                                                          @Y30LB34*/ 02021000
*/* OUTPUT - INITIALIZED FRVS1AGL                            @Y30LB34*/ 02022000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 02023000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 02024000
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/ 02025000
*/*           R. C. = 12, SECURITY CHECKING FAILED,          @Y30LB34*/ 02026000
*/*                       INVALID CONTROL STATEMENT,         @YD00175*/ 02027000
*/*                       UNABLE TO OBTAIN EXCLUSIVE CONTROL @YD00175*/ 02028000
*/*                        OF SOURCE VOLUME                  @YD00175*/ 02029000
*/*                                                          @Y30LB34*/ 02030000
*/********************************************************** @Y30LB34*/ 02031000
*                                                                  0692 02032000
*CHEKSRCE:                                                         0692 02033000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 02034000
*                                                                  0692 02035000
CHEKSRCE DS    0H                                                  0693 02036000
*   /*****************************************************************/ 02037000
*   /*                                                               */ 02038000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 02039000
*   /*                                                               */ 02040000
*   /*****************************************************************/ 02041000
*                                                                  0693 02042000
*   DCL                                                            0693 02043000
*     CC07 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   02044000
*                                      CODE SAVE AREA        @Y30LB34*/ 02045000
*                                                                  0694 02046000
*   /*****************************************************************/ 02047000
*   /*                                                               */ 02048000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 02049000
*   /*                                                               */ 02050000
*   /*****************************************************************/ 02051000
*                                                                  0694 02052000
*   OLDERID2=NEWERID2;                                             0694 02053000
         L     @08,@PC00001                                        0694 02054000
         L     @08,GDTTR2(,@08)                                    0694 02055000
         MVC   @TS00001(95),NEWERID2(@08)                          0694 02056000
         MVC   OLDERID2(95,@08),@TS00001                           0694 02057000
*   NEWID2='CNT7';                  /*                       @Y30LB34*/ 02058000
*                                                                  0695 02059000
         MVC   NEWID2(4,@08),@CC01717                              0695 02060000
*   /*****************************************************************/ 02061000
*   /*                                                               */ 02062000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 02063000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 02064000
*   /*                                                               */ 02065000
*   /*****************************************************************/ 02066000
*                                                                  0696 02067000
*   CC07=LASTCC00;                  /*                       @Y30LB34*/ 02068000
         SLR   @15,@15                                             0696 02069000
         LR    CC07,@15                                            0696 02070000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 02071000
*                                                                  0697 02072000
         ST    REG14,RTNREG3                                       0697 02073000
*   /*****************************************************************/ 02074000
*   /*                                                               */ 02075000
*   /* INITIALIZE THE IDCVS01 PARM LIST FOR ALL VOLUME       @Y30LB34*/ 02076000
*   /* SERVICES REQUESTS TO THE SOURCE VOLUME                @Y30LB34*/ 02077000
*   /*                                                               */ 02078000
*   /*****************************************************************/ 02079000
*                                                                  0698 02080000
*   RESPECIFY                                                      0698 02081000
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/ 02082000
*   VSUCMAST=ON;                    /*                       @Y30LB34*/ 02083000
*   VSREAD=ON;                      /*                       @Y30LB34*/ 02084000
*   VSOPCAT=ON;                     /*                       @Y30LB34*/ 02085000
*   VSUCTEST=ON;                    /*                       @Y30LB34*/ 02086000
         LA    @08,FRVS1AGL                                        0702 02087000
         OI    VSUCMAST(@08),B'00010111'                           0702 02088000
*   VSFROMV=ON;                     /*                       @Y30LB34*/ 02089000
         OI    VSFROMV(@08),B'10000000'                            0703 02090000
*   VSVOLP=ADDR(SVOLSER);           /*                       @Y30LB34*/ 02091000
         LA    @14,SVOLSER                                         0704 02092000
         ST    @14,VSVOLP(,@08)                                    0704 02093000
*   VSFILEP=ADDR(FFILEVAL);         /*                       @Y30LB34*/ 02094000
         L     @14,@PC00001+4                                      0705 02095000
         L     @01,FDTPTR(,@14)                                    0705 02096000
         LA    @01,FFILEVAL(,@01)                                  0705 02097000
         ST    @01,VSFILEP(,@08)                                   0705 02098000
*   IF ADDR(CATN)^=NULLPTR THEN                                    0706 02099000
         L     @14,FDTPTR+44(,@14)                                 0706 02100000
         CR    @14,@15                                             0706 02101000
         BE    @RF00706                                            0706 02102000
*     DO;                           /*                       @Y30LB34*/ 02103000
*       VSCATP=ADDR(CATNVAL);       /*                       @Y30LB34*/ 02104000
         LA    @15,CATNVAL(,@14)                                   0708 02105000
         ST    @15,VSCATP(,@08)                                    0708 02106000
*       VSPSWDP=ADDR(CATNPAS);      /*                       @Y30LB34*/ 02107000
         LA    @15,CATNPAS(,@14)                                   0709 02108000
         ST    @15,VSPSWDP(,@08)                                   0709 02109000
*     END;                          /*                       @Y30LB34*/ 02110000
*   VSCATDDP=ADDR(SCATDD);          /*                       @Y30LB34*/ 02111000
@RF00706 LA    @08,FRVS1AGL                                        0711 02112000
         LA    @15,SCATDD                                          0711 02113000
         ST    @15,VSCATDDP(,@08)                                  0711 02114000
*   VSPFILEP=ADDR(PFILE);           /*                       @Y30LB34*/ 02115000
         L     @15,@PC00001+4                                      0712 02116000
         L     @15,FDTPTR+60(,@15)                                 0712 02117000
         ST    @15,VSPFILEP(,@08)                                  0712 02118000
*   IF STYPEVOL='REAL' THEN                                        0713 02119000
         CLC   STYPEVOL(4),@CC01679                                0713 02120000
         BNE   @RF00713                                            0713 02121000
*     VSREAL=ON;                    /*                       @Y30LB34*/ 02122000
         OI    VSREAL(@08),B'01000000'                             0714 02123000
*   VSUCBP=ADDR(SUCBADDR);          /*                       @Y30LB34*/ 02124000
@RF00713 LA    @08,FRVS1AGL                                        0715 02125000
         LA    @15,SUCBADDR                                        0715 02126000
         ST    @15,VSUCBP(,@08)                                    0715 02127000
*   VSDEVP=ADDR(SDEVTYPE);          /*                       @Y30LB34*/ 02128000
         LA    @15,SDEVTYPE                                        0716 02129000
         ST    @15,VSDEVP(,@08)                                    0716 02130000
*                                                                  0717 02131000
*   /*****************************************************************/ 02132000
*   /*                                                               */ 02133000
*   /* CALL VOLUME SERVICES TO PERFORM SECURITY CHECKING     @Y30LB34*/ 02134000
*   /* ON THE SOURCE VOLUME. SINCE THE VIRTUAL VOLUME        @ZA08840*/ 02135000
*   /* IS TO BE RESERVED BEFORE IT IS MOUNTED, THE           @ZA08840*/ 02136000
*   /* VSRES AND SRES BITS ARE TURNED ON.                    @ZA08840*/ 02137000
*   /*                                                               */ 02138000
*   /*****************************************************************/ 02139000
*                                                                  0717 02140000
*   IF CONVTYPE=VR THEN                                            0717 02141000
         TM    CONVTYPE,B'01000000'                                0717 02142000
         BNZ   @RF00717                                            0717 02143000
*     DO;                           /*                       @ZA08840*/ 02144000
*       VSRES=ON;                   /*                       #Y30LB34*/ 02145000
         OI    VSRES(@08),B'10000000'                              0719 02146000
*       SRES=ON;                    /*                       @ZA08840*/ 02147000
         OI    SRES,B'01000000'                                    0720 02148000
*     END;                          /*                       @ZA08840*/ 02149000
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*      #Y30LB34*/ 02150000
@RF00717 L     @08,@PC00001                                        0722 02151000
         ST    @08,@AL00001                                        0722 02152000
         LA    @15,@CC01720                                        0722 02153000
         ST    @15,@AL00001+4                                      0722 02154000
         LA    @15,SECCHECK                                        0722 02155000
         ST    @15,@AL00001+8                                      0722 02156000
         LA    @15,FRVS1AGL                                        0722 02157000
         ST    @15,@AL00001+12                                     0722 02158000
         MVI   @AL00001+12,X'80'                                   0722 02159000
         L     @15,GDTCAL(,@08)                                    0722 02160000
         LA    @01,@AL00001                                        0722 02161000
         BALR  @14,@15                                             0722 02162000
*   RESPECIFY                                                      0723 02163000
*     RTNREG RSTD;                                                 0723 02164000
*   TESTRC=RTNREG;                                                 0724 02165000
         STH   RTNREG,TESTRC                                       0724 02166000
*   RESPECIFY                                                      0725 02167000
*     RTNREG UNRSTD;                /*                       #Y30LB34*/ 02168000
*                                                                  0725 02169000
*   /*****************************************************************/ 02170000
*   /*                                                               */ 02171000
*   /* IF VOLUME SERVICES WAS UNSUCCESSFUL OR THE SECURITY   #Y30LB34*/ 02172000
*   /* CHECKING FAILED, SET THE CONDITION CODE TO 12.        #Y30LB34*/ 02173000
*   /*                                                               */ 02174000
*   /*****************************************************************/ 02175000
*                                                                  0726 02176000
*   IF TESTRC=4 THEN                                               0726 02177000
         LH    @08,TESTRC                                          0726 02178000
         C     @08,@CF00036                                        0726 02179000
         BNE   @RF00726                                            0726 02180000
*     CC07=LASTCC12;                /*                       #Y30LB34*/ 02181000
*                                                                  0727 02182000
         LA    CC07,12                                             0727 02183000
*   /*****************************************************************/ 02184000
*   /*                                                               */ 02185000
*   /* IF VOLUME SERVICES COULD NOT CLOSE A DATA SET,        #Y30LB34*/ 02186000
*   /* SET THE CONDITION CODE TO 4.                          #Y30LB34*/ 02187000
*   /*                                                               */ 02188000
*   /*****************************************************************/ 02189000
*                                                                  0728 02190000
*   IF TESTRC=8 THEN                                               0728 02191000
@RF00726 CLC   TESTRC(2),@CH00177                                  0728 02192000
         BNE   @RF00728                                            0728 02193000
*     CC07=LASTCC04;                /*                       #Y30LB34*/ 02194000
*                                                                  0729 02195000
         LA    CC07,4                                              0729 02196000
*   /*****************************************************************/ 02197000
*   /*                                                               */ 02198000
*   /* SET OFF THE VSRES RESERVE BIT.                        @ZA08840*/ 02199000
*   /*                                                               */ 02200000
*   /*****************************************************************/ 02201000
*                                                                  0730 02202000
*   VSRES=OFF;                      /*                       #Y30LB34*/ 02203000
@RF00728 LA    @08,FRVS1AGL                                        0730 02204000
         NI    VSRES(@08),B'01111111'                              0730 02205000
*                                                                  0731 02206000
*   /*****************************************************************/ 02207000
*   /*                                                               */ 02208000
*   /* TEST FOR ERRORS IN JOB SETUP FOR A VSAM VOLUME        @Y30LB34*/ 02209000
*   /* (IF A SEVERE ERROR OCCURRED IN SECURITY CHECKING,     @Y30LB34*/ 02210000
*   /* THE VSAM VOLUME FLAG WILL NOT HAVE BEEN SET ON AND    @Y30LB34*/ 02211000
*   /* THIS STEP WILL BE BYPASSED.)                          @Y30LB34*/ 02212000
*   /*                                                               */ 02213000
*   /*****************************************************************/ 02214000
*                                                                  0731 02215000
*   IF VSVSAM=ON THEN                                              0731 02216000
         TM    VSVSAM(@08),B'10000000'                             0731 02217000
         BNO   @RF00731                                            0731 02218000
*     DO;                           /*                       @Y30LB34*/ 02219000
*                                                                  0732 02220000
*       /*************************************************************/ 02221000
*       /*                                                           */ 02222000
*       /* SET VSAM BIT ON FOR SOURCE VOLUME WHICH WILL      @Y30LB34*/ 02223000
*       /* REFERENCED IN CHEKTARG                            @Y30LB34*/ 02224000
*       /*                                                           */ 02225000
*       /*************************************************************/ 02226000
*                                                                  0733 02227000
*       SVSAM=ON;                   /*                       @Y30LB34*/ 02228000
*                                                                  0733 02229000
         OI    SVSAM,B'00100000'                                   0733 02230000
*       /*************************************************************/ 02231000
*       /*                                                           */ 02232000
*       /* TEST FOR A RECATALOG OPTION OF 'NONE' FOR A       @Y30LB34*/ 02233000
*       /* VSAM VOLUME. IF FOUND, ISSUE ERROR MESSAGE        @Y30LB34*/ 02234000
*       /* IDC3741I AND SET CONDITION CODE TO 12.            @Y30LB34*/ 02235000
*       /*                                                           */ 02236000
*       /*************************************************************/ 02237000
*                                                                  0734 02238000
*       IF ADDR(NONE)^=NULLPTR THEN                                0734 02239000
         SLR   @08,@08                                             0734 02240000
         L     @15,@PC00001+4                                      0734 02241000
         C     @08,FDTPTR+28(,@15)                                 0734 02242000
         BE    @RF00734                                            0734 02243000
*         DO;                       /*                       @Y30LB34*/ 02244000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 02245000
         L     @15,DDSTRU                                          0736 02246000
         MVC   DARGSMOD(3,@15),@CC01557                            0736 02247000
*           DARGSENT=MSG3741I;      /*                       @Y30LB34*/ 02248000
         MVI   DARGSENT(@15),X'05'                                 0737 02249000
*           DARGDBP=0;              /*                       @Y30LB34*/ 02250000
         ST    @08,DARGDBP(,@15)                                   0738 02251000
*           DARGILP=0;              /*                       @Y30LB34*/ 02252000
         STH   @08,DARGILP(,@15)                                   0739 02253000
*           DARGRETP=0;             /*                       @Y30LB34*/ 02254000
         ST    @08,DARGRETP(,@15)                                  0740 02255000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 02256000
         L     @08,@PC00001                                        0741 02257000
         ST    @08,@AL00001                                        0741 02258000
         LA    @15,@CF00115                                        0741 02259000
         ST    @15,@AL00001+4                                      0741 02260000
         LA    @15,DDSTRU                                          0741 02261000
         ST    @15,@AL00001+8                                      0741 02262000
         MVI   @AL00001+8,X'80'                                    0741 02263000
         L     @15,GDTPRT(,@08)                                    0741 02264000
         LA    @01,@AL00001                                        0741 02265000
         BALR  @14,@15                                             0741 02266000
*           CC07=LASTCC12;          /*                       @Y30LB34*/ 02267000
         LA    CC07,12                                             0742 02268000
*         END;                      /*                       @Y30LB34*/ 02269000
*                                                                  0743 02270000
*       /*************************************************************/ 02271000
*       /*                                                           */ 02272000
*       /* DETERMINE IF THE VOLSER FOR THE TARGET            @Y30LB34*/ 02273000
*       /* VOL IS NOT THE SAME AS THE SOURCE VOL, ISSUE      @Y30LB34*/ 02274000
*       /* MESSAGE IDC3067I AND SET CONDITITON CODE TO 12    @Y30LB34*/ 02275000
*       /*                                                           */ 02276000
*       /*************************************************************/ 02277000
*                                                                  0744 02278000
*       IF SAMESER=OFF THEN                                        0744 02279000
@RF00734 TM    SAMESER,B'10000000'                                 0744 02280000
         BNZ   @RF00744                                            0744 02281000
*         DO;                       /*                       @Y30LB34*/ 02282000
*           DARGSMOD=COMMSG;        /*                       @Y30LB34*/ 02283000
         L     @08,DDSTRU                                          0746 02284000
         MVC   DARGSMOD(3,@08),@CC01555                            0746 02285000
*           DARGSENT=MSG3067I;      /*                       @Y30LB34*/ 02286000
         MVI   DARGSENT(@08),X'29'                                 0747 02287000
*           DARGDBP=ADDR(SVOLSER);  /*                       @Y30LB34*/ 02288000
         LA    @15,SVOLSER                                         0748 02289000
         ST    @15,DARGDBP(,@08)                                   0748 02290000
*           DARGILP=LENGTH(SVOLSER);/*                       @Y30LB34*/ 02291000
         MVC   DARGILP(2,@08),@CH00038                             0749 02292000
*           DARGRETP=0;             /*                       @Y30LB34*/ 02293000
         SLR   @15,@15                                             0750 02294000
         ST    @15,DARGRETP(,@08)                                  0750 02295000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 02296000
         L     @08,@PC00001                                        0751 02297000
         ST    @08,@AL00001                                        0751 02298000
         LA    @15,@CF00115                                        0751 02299000
         ST    @15,@AL00001+4                                      0751 02300000
         LA    @15,DDSTRU                                          0751 02301000
         ST    @15,@AL00001+8                                      0751 02302000
         MVI   @AL00001+8,X'80'                                    0751 02303000
         L     @15,GDTPRT(,@08)                                    0751 02304000
         LA    @01,@AL00001                                        0751 02305000
         BALR  @14,@15                                             0751 02306000
*           CC07=LASTCC12;          /*                       @Y30LB34*/ 02307000
         LA    CC07,12                                             0752 02308000
*         END;                      /*                       @Y30LB34*/ 02309000
*                                                                  0754 02310000
*       /*************************************************************/ 02311000
*       /*                                                           */ 02312000
*       /* TEST FOR ERRORS IN JOB SETUP FOR A USER           @Y30LB34*/ 02313000
*       /* CATALOG ON THE VOLUME.                            @Y30LB34*/ 02314000
*       /*                                                           */ 02315000
*       /*************************************************************/ 02316000
*                                                                  0754 02317000
*       IF VSUCAT=ON THEN                                          0754 02318000
@RF00744 LA    @08,FRVS1AGL                                        0754 02319000
         TM    VSUCAT(@08),B'01000000'                             0754 02320000
         BNO   @RF00754                                            0754 02321000
*         DO;                       /*                       @Y30LB34*/ 02322000
*                                                                  0755 02323000
*           /*********************************************************/ 02324000
*           /*                                                       */ 02325000
*           /* IF NO DD NAME WAS SUPPLIED OR RETURNED        @Y30LB34*/ 02326000
*           /* BY VOLUME SERVICES FOR THE USER CATALOG       @Y30LB34*/ 02327000
*           /* ON THE VOLUME, ISSUE ERROR MESSAGE            @Y30LB34*/ 02328000
*           /* IDC3745I AND SET CONDITION CODE TO 12         @Y30LB34*/ 02329000
*           /*                                                       */ 02330000
*           /*********************************************************/ 02331000
*                                                                  0756 02332000
*           IF VSCATDDP=NULLPTR|SCATDD=' ' THEN                    0756 02333000
         L     @08,VSCATDDP(,@08)                                  0756 02334000
         LTR   @08,@08                                             0756 02335000
         BZ    @RT00756                                            0756 02336000
         CLI   SCATDD,C' '                                         0756 02337000
         BNE   @RF00756                                            0756 02338000
@RT00756 DS    0H                                                  0757 02339000
*             DO;                   /*                       @ZA09518*/ 02340000
*               DARGSMOD=CONVMSG;   /*                       @Y30LB34*/ 02341000
         L     @08,DDSTRU                                          0758 02342000
         MVC   DARGSMOD(3,@08),@CC01557                            0758 02343000
*               DARGSENT=MSG3745I;  /*                       @Y30LB34*/ 02344000
         MVI   DARGSENT(@08),X'09'                                 0759 02345000
*               DARGDBP=0;          /*                       @Y30LB34*/ 02346000
         SLR   @15,@15                                             0760 02347000
         ST    @15,DARGDBP(,@08)                                   0760 02348000
*               DARGILP=0;          /*                       @Y30LB34*/ 02349000
         STH   @15,DARGILP(,@08)                                   0761 02350000
*               DARGRETP=0;         /*                       @Y30LB34*/ 02351000
         ST    @15,DARGRETP(,@08)                                  0762 02352000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/ 02353000
         L     @08,@PC00001                                        0763 02354000
         ST    @08,@AL00001                                        0763 02355000
         LA    @15,@CF00115                                        0763 02356000
         ST    @15,@AL00001+4                                      0763 02357000
         LA    @15,DDSTRU                                          0763 02358000
         ST    @15,@AL00001+8                                      0763 02359000
         MVI   @AL00001+8,X'80'                                    0763 02360000
         L     @15,GDTPRT(,@08)                                    0763 02361000
         LA    @01,@AL00001                                        0763 02362000
         BALR  @14,@15                                             0763 02363000
*               CC07=LASTCC12;      /*                       @Y30LB34*/ 02364000
         LA    CC07,12                                             0764 02365000
*             END;                  /*                       @Y30LB34*/ 02366000
*                                                                  0765 02367000
*           /*********************************************************/ 02368000
*           /*                                                       */ 02369000
*           /* IF A DD NAME WAS SUPPLIED OR RETURNED         @Y30LB34*/ 02370000
*           /* BY VOLUME SERVICES FOR THE USER CATALOG       @Y30LB34*/ 02371000
*           /* ON THE VOLUME, DETERMINE IF IT IS JOBCAT      @Y30LB34*/ 02372000
*           /* OR STEPCAT. IF SO, ISSUE ERROR MESSAGE        @Y30LB34*/ 02373000
*           /* IDC3744I AND SET CONDITION CODE TO 12         @Y30LB34*/ 02374000
*           /*                                                       */ 02375000
*           /*********************************************************/ 02376000
*                                                                  0766 02377000
*           ELSE                                                   0766 02378000
*             IF SCATDD='JOBCAT  '|SCATDD='STEPCAT ' THEN          0766 02379000
         B     @RC00756                                            0766 02380000
@RF00756 CLC   SCATDD(8),@CC01721                                  0766 02381000
         BE    @RT00766                                            0766 02382000
         CLC   SCATDD(8),@CC01722                                  0766 02383000
         BNE   @RF00766                                            0766 02384000
@RT00766 DS    0H                                                  0767 02385000
*               DO;                 /*                       @Y30LB34*/ 02386000
*                 DARGSMOD=CONVMSG; /*                       @Y30LB34*/ 02387000
         L     @08,DDSTRU                                          0768 02388000
         MVC   DARGSMOD(3,@08),@CC01557                            0768 02389000
*                 DARGSENT=MSG3744I;/*                       @Y30LB34*/ 02390000
         MVI   DARGSENT(@08),X'08'                                 0769 02391000
*                 DARGDBP=0;        /*                       @Y30LB34*/ 02392000
         SLR   @15,@15                                             0770 02393000
         ST    @15,DARGDBP(,@08)                                   0770 02394000
*                 DARGILP=0;        /*                       @Y30LB34*/ 02395000
         STH   @15,DARGILP(,@08)                                   0771 02396000
*                 DARGRETP=0;       /*                       @Y30LB34*/ 02397000
         ST    @15,DARGRETP(,@08)                                  0772 02398000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB34*/ 02399000
         L     @08,@PC00001                                        0773 02400000
         ST    @08,@AL00001                                        0773 02401000
         LA    @15,@CF00115                                        0773 02402000
         ST    @15,@AL00001+4                                      0773 02403000
         LA    @15,DDSTRU                                          0773 02404000
         ST    @15,@AL00001+8                                      0773 02405000
         MVI   @AL00001+8,X'80'                                    0773 02406000
         L     @15,GDTPRT(,@08)                                    0773 02407000
         LA    @01,@AL00001                                        0773 02408000
         BALR  @14,@15                                             0773 02409000
*                 CC07=LASTCC12;    /*                       @Y30LB34*/ 02410000
         LA    CC07,12                                             0774 02411000
*               END;                /*                       @Y30LB34*/ 02412000
*         END;                      /*                       @Y30LB34*/ 02413000
@RF00766 DS    0H                                                  0776 02414000
@RC00756 DS    0H                                                  0777 02415000
*     END;                          /*                       @Y30LB34*/ 02416000
@RF00754 DS    0H                                                  0778 02417000
*                                                                  0778 02418000
*   /*****************************************************************/ 02419000
*   /*                                                               */ 02420000
*   /* IF THE VTOC WAS OPENED BY VOLUME SERVICES, CLOSE IT   @Y30LB34*/ 02421000
*   /* AND RESET THE IOCSTR POINTER TO 0.                    @Y30LB34*/ 02422000
*   /*                                                               */ 02423000
*   /*****************************************************************/ 02424000
*                                                                  0778 02425000
*   IF VSIOP^=NULLPTR THEN                                         0778 02426000
@RF00731 LA    @08,FRVS1AGL                                        0778 02427000
         L     @15,VSIOP(,@08)                                     0778 02428000
         LTR   @15,@15                                             0778 02429000
         BZ    @RF00778                                            0778 02430000
*     DO;                           /*                       @Y30LB34*/ 02431000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB34*/ 02432000
         L     @15,@PC00001                                        0780 02433000
         ST    @15,@AL00001                                        0780 02434000
         LA    @08,VSIOP(,@08)                                     0780 02435000
         ST    @08,@AL00001+4                                      0780 02436000
         MVI   @AL00001+4,X'80'                                    0780 02437000
         L     @15,GDTCLS(,@15)                                    0780 02438000
         LA    @01,@AL00001                                        0780 02439000
         BALR  @14,@15                                             0780 02440000
*       RESPECIFY                                                  0781 02441000
*         RTNREG RSTD;                                             0781 02442000
*       TESTRC=RTNREG;                                             0782 02443000
         STH   RTNREG,TESTRC                                       0782 02444000
*       RESPECIFY                                                  0783 02445000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 02446000
*       CC07=MAX(CC07,TESTRC);      /*                       @Y30LB34*/ 02447000
         LH    @08,TESTRC                                          0784 02448000
         CR    CC07,@08                                            0784 02449000
         BNL   *+6                                                      02450000
         LR    CC07,@08                                            0784 02451000
*       VSIOP=NULLPTR;              /*                       @Y30LB34*/ 02452000
         LA    @08,FRVS1AGL                                        0785 02453000
         SLR   @15,@15                                             0785 02454000
         ST    @15,VSIOP(,@08)                                     0785 02455000
*     END;                          /*                       @Y30LB34*/ 02456000
*                                                                  0787 02457000
*   /*****************************************************************/ 02458000
*   /*                                                               */ 02459000
*   /* IF NO ERRORS SO FAR, GET EXCLUSIVE CONTROL OF VOLUME  @YD00175*/ 02460000
*   /*                                                               */ 02461000
*   /*****************************************************************/ 02462000
*                                                                  0787 02463000
*   IF CC07<LASTCC12 THEN                                          0787 02464000
@RF00778 C     CC07,@CF00567                                       0787 02465000
         BNL   @RF00787                                            0787 02466000
*     DO;                           /*                       @YD00175*/ 02467000
*                                                                  0788 02468000
*       /*************************************************************/ 02469000
*       /*                                                           */ 02470000
*       /* SET UP PARAMETER LIST                             @YD00175*/ 02471000
*       /*                                                           */ 02472000
*       /*************************************************************/ 02473000
*                                                                  0789 02474000
*       EXCLAGL=EXCLAGL&&EXCLAGL;   /*                       @YD00175*/ 02475000
         LA    @08,EXCLAR                                          0789 02476000
         XC    EXCLAGL(23,@08),EXCLAGL(@08)                        0789 02477000
*       EXCLUCBP=ADDR(SUCBADDR);    /*                       @YD00175*/ 02478000
         LA    @15,SUCBADDR                                        0790 02479000
         ST    @15,EXCLUCBP(,@08)                                  0790 02480000
*       EXCLDDP=ADDR(FFILEVAL);     /*                       @YD00175*/ 02481000
*                                                                  0791 02482000
         L     @15,@PC00001+4                                      0791 02483000
         L     @01,FDTPTR(,@15)                                    0791 02484000
         LA    @15,FFILEVAL(,@01)                                  0791 02485000
         ST    @15,EXCLDDP(,@08)                                   0791 02486000
*       /*************************************************************/ 02487000
*       /*                                                           */ 02488000
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/ 02489000
*       /*                                                           */ 02490000
*       /*************************************************************/ 02491000
*                                                                  0792 02492000
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/ 02493000
         L     @15,@PC00001                                        0792 02494000
         ST    @15,@AL00001                                        0792 02495000
         LA    @14,CHANGEX                                         0792 02496000
         ST    @14,@AL00001+4                                      0792 02497000
         ST    @08,@AL00001+8                                      0792 02498000
         MVI   @AL00001+8,X'80'                                    0792 02499000
         L     @15,GDTUNT(,@15)                                    0792 02500000
         LA    @01,@AL00001                                        0792 02501000
         BALR  @14,@15                                             0792 02502000
*       RESPECIFY                                                  0793 02503000
*         RTNREG RSTD;                                             0793 02504000
*       TESTRC=RTNREG;                                             0794 02505000
         STH   RTNREG,TESTRC                                       0794 02506000
*       RESPECIFY                                                  0795 02507000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 02508000
*                                                                  0795 02509000
*       /*************************************************************/ 02510000
*       /*                                                           */ 02511000
*       /* IF EXCLUSIVE CONTROL NO OBTAINED, SET RETURN CODE @YD00175*/ 02512000
*       /*                                                           */ 02513000
*       /*************************************************************/ 02514000
*                                                                  0796 02515000
*       IF TESTRC>0 THEN                                           0796 02516000
         LH    @08,TESTRC                                          0796 02517000
         LTR   @08,@08                                             0796 02518000
         BNP   @RF00796                                            0796 02519000
*         CC07=LASTCC12;            /*                       @YD00175*/ 02520000
         LA    CC07,12                                             0797 02521000
*     END;                          /*                       @YD00175*/ 02522000
*                                                                  0798 02523000
@RF00796 DS    0H                                                  0799 02524000
*   /*****************************************************************/ 02525000
*   /*                                                               */ 02526000
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/ 02527000
*   /* RETURN TO CALLER                                      #Y30LB34*/ 02528000
*   /*                                                               */ 02529000
*   /*****************************************************************/ 02530000
*                                                                  0799 02531000
*   REG14=RTNREG3;                  /*                       #Y30LB34*/ 02532000
@RF00787 L     REG14,RTNREG3                                       0799 02533000
*   RETURN CODE(CC07);              /*                       #Y30LB34*/ 02534000
         LR    @15,CC07                                            0800 02535000
@EL00008 DS    0H                                                  0800 02536000
@EF00008 DS    0H                                                  0800 02537000
@ER00008 BR    @14                                                 0800 02538000
*   END CHEKSRCE;                   /*                       #Y30LB34*/ 02539000
*                                                                  0802 02540000
*/********************************************************** #Y30LB34*/ 02541000
*/*                                                          #Y30LB34*/ 02542000
*/* PROCEDURE NAME - RVINITTA                                #Y30LB34*/ 02543000
*/*                                                          #Y30LB34*/ 02544000
*/* FUNCTION - INTERROGATES THE MSS TARGET VOLUME            #Y30LB34*/ 02545000
*/*                                                          #Y30LB34*/ 02546000
*/*            ENQUEUES THE TARGET VOLUME                    #Y30LB34*/ 02547000
*/*                                                          #Y30LB34*/ 02548000
*/*            CALLS RVGETTA TO ACCESS THE MSVC BASE VOLUME  #Y30LB34*/ 02549000
*/*            RECORD TO RETRIEVE VOLUME INFORMATION         #Y30LB34*/ 02550000
*/*                                                          #Y30LB34*/ 02551000
*/*            MOUNTS THE TARGET VOLUME IF SOURCE AND        #Y30LB34*/ 02552000
*/*            TARGET VOLSERS ARE THE SAME                   @Y30LB34*/ 02553000
*/*                                                          @Y30LB34*/ 02554000
*/*            CALLS CHEKTARG TO CHECK THE TARGET VOLUME     @Y30LB34*/ 02555000
*/*                                                          @Y30LB34*/ 02556000
*/*            DEQUEUES TARGET VOLUME RESERVED IN CHEKTARG   @Y30LB34*/ 02557000
*/*                                                          @Y30LB34*/ 02558000
*/*            DEMOUNTS THE TARGET VOLUME IF IT WAS MOUNTED  @Y30LB34*/ 02559000
*/*            ABOVE                                         @Y30LB34*/ 02560000
*/*                                                          @Y30LB34*/ 02561000
*/*            IF A SEVERE ERROR HAS OCCURRED, DEQUEUES      @Y30LB34*/ 02562000
*/*            TARGET VOLUME ENQUEUED IN THIS PROCEDURE      @Y30LB34*/ 02563000
*/*                                                          @Y30LB34*/ 02564000
*/* INPUT - TARGAREA, MDAGL, PUAGL                           @Y30LB34*/ 02565000
*/*                                                          @Y30LB34*/ 02566000
*/* OUTPUT - TARGAREA                                        @Y30LB34*/ 02567000
*/*                                                          @Y30LB34*/ 02568000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 02569000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 02570000
*/*           R. C. =  4, RETURN CODE FROM CHEKTARG          @Y30LB34*/ 02571000
*/*           R. C. = 12, UNABLE TO MOUNT VOLUME,            @Y30LB34*/ 02572000
*/*                       UNABLE TO DEMOUNT VOLUME,          @Y30LB34*/ 02573000
*/*                       RETURN CODE FROM RVGETTA OR        @Y30LB34*/ 02574000
*/*                       CHEKTARG                           @Y30LB34*/ 02575000
*/*                                                          @Y30LB34*/ 02576000
*/********************************************************** @Y30LB34*/ 02577000
*                                                                  0802 02578000
*RVINITTA:                                                         0802 02579000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 02580000
*                                                                  0802 02581000
RVINITTA DS    0H                                                  0803 02582000
*   /*****************************************************************/ 02583000
*   /*                                                               */ 02584000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 02585000
*   /*                                                               */ 02586000
*   /*****************************************************************/ 02587000
*                                                                  0803 02588000
*   DCL                                                            0803 02589000
*     CC08 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   02590000
*                                      CODE SAVE AREA        @Y30LB34*/ 02591000
*                                                                  0804 02592000
*   /*****************************************************************/ 02593000
*   /*                                                               */ 02594000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 02595000
*   /*                                                               */ 02596000
*   /*****************************************************************/ 02597000
*                                                                  0804 02598000
*   OLDERID2=NEWERID2;                                             0804 02599000
         L     @08,@PC00001                                        0804 02600000
         L     @15,GDTTR2(,@08)                                    0804 02601000
         MVC   @TS00001(95),NEWERID2(@15)                          0804 02602000
         MVC   OLDERID2(95,@15),@TS00001                           0804 02603000
*   NEWID2='CNT8';                  /*                       @Y30LB34*/ 02604000
*                                                                  0805 02605000
         MVC   NEWID2(4,@15),@CC01727                              0805 02606000
*   /*****************************************************************/ 02607000
*   /*                                                               */ 02608000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 02609000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 02610000
*   /*                                                               */ 02611000
*   /*****************************************************************/ 02612000
*                                                                  0806 02613000
*   CC08=LASTCC00;                  /*                       @Y30LB34*/ 02614000
         SLR   CC08,CC08                                           0806 02615000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 02616000
*                                                                  0807 02617000
         LR    RTNREG2,REG14                                       0807 02618000
*   /*****************************************************************/ 02619000
*   /*                                                               */ 02620000
*   /* ENQUEUE THE MSS TARGET VOLUME AND SET THE BIT ON IN   @Y30LB34*/ 02621000
*   /* TARGAREA                                              @Y30LB34*/ 02622000
*   /*                                                               */ 02623000
*   /*****************************************************************/ 02624000
*                                                                  0808 02625000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,QNAME,RNAMEVE);/*         @Y30LB34*/ 02626000
         MVC   @AL00001+4(12),@AL00808                             0808 02627000
         ST    @08,@AL00001                                        0808 02628000
         LA    @09,RNAMEVE                                         0808 02629000
         ST    @09,@AL00001+16                                     0808 02630000
         MVI   @AL00001+16,X'80'                                   0808 02631000
         L     @15,GDTENQ(,@08)                                    0808 02632000
         LA    @01,@AL00001                                        0808 02633000
         BALR  @14,@15                                             0808 02634000
*   TENQ=ON;                        /*                       @Y30LB34*/ 02635000
*                                                                  0809 02636000
         OI    TENQ,B'10000000'                                    0809 02637000
*   /*****************************************************************/ 02638000
*   /*                                                               */ 02639000
*   /* CALL RVGETTA TO ACCESS THE MSVC BASE VOLUME RECORD    @Y30LB34*/ 02640000
*   /* AND VERIFY THE TARGET VOLUME'S USABILITY              @Y30LB34*/ 02641000
*   /*                                                               */ 02642000
*   /*****************************************************************/ 02643000
*                                                                  0810 02644000
*   CALL RVGETTA;                   /*                       @Y30LB34*/ 02645000
         BAL   @14,RVGETTA                                         0810 02646000
*   RESPECIFY                                                      0811 02647000
*     RTNREG RSTD;                                                 0811 02648000
*   TESTRC=RTNREG;                                                 0812 02649000
         STH   RTNREG,TESTRC                                       0812 02650000
*   RESPECIFY                                                      0813 02651000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 02652000
*   CC08=TESTRC;                    /*                       @Y30LB34*/ 02653000
         LH    @15,TESTRC                                          0814 02654000
         LR    CC08,@15                                            0814 02655000
*                                                                  0815 02656000
*   /*****************************************************************/ 02657000
*   /*                                                               */ 02658000
*   /* IF NO SEVERE ERROR OCCURRED IN RVGETTA AND IF THE     @Y30LB34*/ 02659000
*   /* NOVTOCCK FLAG IS NOT ON AND THE VOLSERS ARE THE       @Y30LB34*/ 02660000
*   /* SAME, MOUNT THE TARGET VOLUME. SET THE BIT ON TO      @Y30LB34*/ 02661000
*   /* CLEAR THE SOURCE UCB BEFORE THE MOUNT.                @Y30LB34*/ 02662000
*   /*                                                               */ 02663000
*   /*****************************************************************/ 02664000
*                                                                  0815 02665000
*   IF CC08<LASTCC12&NOVTOCCK=OFF&SAMESER=ON THEN                  0815 02666000
         C     CC08,@CF00567                                       0815 02667000
         BNL   @RF00815                                            0815 02668000
         TM    NOVTOCCK,B'00100000'                                0815 02669000
         BNZ   @RF00815                                            0815 02670000
         TM    SAMESER,B'10000000'                                 0815 02671000
         BNO   @RF00815                                            0815 02672000
*     DO;                           /*                       @Y30LB34*/ 02673000
*       MDCLEAR=ON;                 /*                       @Y30LB34*/ 02674000
         LA    @08,MDAGLAR                                         0817 02675000
         OI    MDCLEAR(@08),B'01000000'                            0817 02676000
*       CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                 @Y30LB34*/ 02677000
         L     @15,@PC00001                                        0818 02678000
         ST    @15,@AL00001                                        0818 02679000
         LA    @14,MOUNT                                           0818 02680000
         ST    @14,@AL00001+4                                      0818 02681000
         ST    @08,@AL00001+8                                      0818 02682000
         MVI   @AL00001+8,X'80'                                    0818 02683000
         L     @15,GDTUNT(,@15)                                    0818 02684000
         LA    @01,@AL00001                                        0818 02685000
         BALR  @14,@15                                             0818 02686000
*       RESPECIFY                                                  0819 02687000
*         RTNREG RSTD;                                             0819 02688000
*       TESTRC=RTNREG;                                             0820 02689000
         STH   RTNREG,TESTRC                                       0820 02690000
*       RESPECIFY                                                  0821 02691000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 02692000
*       MDCLEAR=OFF;                /*                       @Y30LB34*/ 02693000
*                                                                  0822 02694000
         LA    @08,MDAGLAR                                         0822 02695000
         NI    MDCLEAR(@08),B'10111111'                            0822 02696000
*       /*************************************************************/ 02697000
*       /*                                                           */ 02698000
*       /* IF UMSSUNIT IS UNSUCCESSFUL, SET CONDITION        @Y30LB34*/ 02699000
*       /* CODE TO 12.                                       @Y30LB34*/ 02700000
*       /*                                                           */ 02701000
*       /*************************************************************/ 02702000
*                                                                  0823 02703000
*       IF TESTRC>0 THEN                                           0823 02704000
         LH    @08,TESTRC                                          0823 02705000
         LTR   @08,@08                                             0823 02706000
         BNP   @RF00823                                            0823 02707000
*         CC08=LASTCC12;            /*                       @Y30LB34*/ 02708000
         LA    CC08,12                                             0824 02709000
*     END;                          /*                       @Y30LB34*/ 02710000
@RF00823 DS    0H                                                  0826 02711000
*                                                                  0826 02712000
*   /*****************************************************************/ 02713000
*   /*                                                               */ 02714000
*   /* IF NO SEVERE ERROR HAS OCCURRED, CHECK TARGET         @Y30LB34*/ 02715000
*   /* VOLUME AND PREPARE FOR DATA CONVERSION.               @Y30LB34*/ 02716000
*   /*                                                               */ 02717000
*   /*****************************************************************/ 02718000
*                                                                  0826 02719000
*   IF CC08<LASTCC12 THEN                                          0826 02720000
@RF00815 C     CC08,@CF00567                                       0826 02721000
         BNL   @RF00826                                            0826 02722000
*     DO;                           /*                       @Y30LB34*/ 02723000
*                                                                  0827 02724000
*       /*************************************************************/ 02725000
*       /*                                                           */ 02726000
*       /* CALL CHEKTARG TO INITIALIZE THE VOLUME            @Y30LB34*/ 02727000
*       /* SERVICES PARM LIST, PERFORM SECURITY CHECKING     @Y30LB34*/ 02728000
*       /* AND RETRIEVE VTOC INFORMATION                     @Y30LB34*/ 02729000
*       /*                                                           */ 02730000
*       /*************************************************************/ 02731000
*                                                                  0828 02732000
*       CALL CHEKTARG;              /*                       @Y30LB34*/ 02733000
         BAL   @14,CHEKTARG                                        0828 02734000
*       RESPECIFY                                                  0829 02735000
*         RTNREG RSTD;                                             0829 02736000
*       TESTRC=RTNREG;                                             0830 02737000
         STH   RTNREG,TESTRC                                       0830 02738000
*       RESPECIFY                                                  0831 02739000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 02740000
*       CC08=MAX(CC08,TESTRC);      /*                       @Y30LB34*/ 02741000
*                                                                  0832 02742000
         LH    @08,TESTRC                                          0832 02743000
         CR    CC08,@08                                            0832 02744000
         BNL   *+6                                                      02745000
         LR    CC08,@08                                            0832 02746000
*       /*************************************************************/ 02747000
*       /*                                                           */ 02748000
*       /* IF THE TARGET VOLUME WAS RESERVED IN CHEKTARG     @Y30LB34*/ 02749000
*       /* DEQUEUE THAT RESERVE AND SET OFF THE TARGET       @Y30LB34*/ 02750000
*       /* RESERVE BIT                                       @Y30LB34*/ 02751000
*       /*                                                           */ 02752000
*       /*************************************************************/ 02753000
*                                                                  0833 02754000
*       IF TRES=ON THEN                                            0833 02755000
         TM    TRES,B'01000000'                                    0833 02756000
         BNO   @RF00833                                            0833 02757000
*         DO;                       /*                       @Y30LB34*/ 02758000
*           CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*           @Y30LB34*/ 02759000
         L     @08,@PC00001                                        0835 02760000
         ST    @08,@AL00001                                        0835 02761000
         LA    @15,@CC01594                                        0835 02762000
         ST    @15,@AL00001+4                                      0835 02763000
         LA    @15,RNAMEVR                                         0835 02764000
         ST    @15,@AL00001+8                                      0835 02765000
         MVI   @AL00001+8,X'80'                                    0835 02766000
         L     @15,GDTDEQ(,@08)                                    0835 02767000
         LA    @01,@AL00001                                        0835 02768000
         BALR  @14,@15                                             0835 02769000
*           TRES=OFF;               /*                       @Y30LB34*/ 02770000
         NI    TRES,B'10111111'                                    0836 02771000
*         END;                      /*                       @Y30LB34*/ 02772000
*                                                                  0837 02773000
*       /*************************************************************/ 02774000
*       /*                                                           */ 02775000
*       /* IF NO SEVERE ERROR HAS OCCURRED OR IF THE         @Y30LB34*/ 02776000
*       /* VOLUME WAS MOUNTED EARLIER IN THIS PROCEDURE      @Y30LB34*/ 02777000
*       /* AND A SEVERE ERROR HAS OCCURRED SINCE THEN,       @Y30LB34*/ 02778000
*       /* DEMOUNT THE MSS TARGET VOLUME. SET THE BIT        @Y30LB34*/ 02779000
*       /* ON TO POST THE SOURCE UCB AFTER DEMOUNT IF IT     @Y30LB34*/ 02780000
*       /* WAS CLEARED EARLIER. SINCE THE DEMOUNT MUST       @Y30LB34*/ 02781000
*       /* BE COMPLETED BEFORE THE DATA COPY CAN TAKE        @Y30LB34*/ 02782000
*       /* PLACE, SET THE BIT ON TO WAIT FOR COMPLETION      @Y30LB34*/ 02783000
*       /* FOR THE DEMOUNT BEFORE PROCEEDING                 @Y30LB34*/ 02784000
*       /*                                                           */ 02785000
*       /*************************************************************/ 02786000
*                                                                  0838 02787000
*       IF CC08<LASTCC12|(SAMESER=ON&NOVTOCCK=OFF) THEN            0838 02788000
@RF00833 C     CC08,@CF00567                                       0838 02789000
         BL    @RT00838                                            0838 02790000
         TM    SAMESER,B'10000000'                                 0838 02791000
         BNO   @RF00838                                            0838 02792000
         TM    NOVTOCCK,B'00100000'                                0838 02793000
         BNZ   @RF00838                                            0838 02794000
@RT00838 DS    0H                                                  0839 02795000
*         DO;                       /*                       @Y30LB34*/ 02796000
*           IF SAMESER=ON&NOVTOCCK=OFF THEN                        0840 02797000
         TM    SAMESER,B'10000000'                                 0840 02798000
         BNO   @RF00840                                            0840 02799000
         TM    NOVTOCCK,B'00100000'                                0840 02800000
         BNZ   @RF00840                                            0840 02801000
*             MDPOST=ON;            /*                       @Y30LB34*/ 02802000
         LA    @08,MDAGLAR                                         0841 02803000
         OI    MDPOST(@08),B'00100000'                             0841 02804000
*           MDWAIT=ON;              /*                       @Y30LB34*/ 02805000
@RF00840 LA    @08,MDAGLAR                                         0842 02806000
         OI    MDWAIT(@08),B'00010000'                             0842 02807000
*           CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*           @Y30LB34*/ 02808000
         L     @15,@PC00001                                        0843 02809000
         ST    @15,@AL00001                                        0843 02810000
         LA    @14,DEMOUNT                                         0843 02811000
         ST    @14,@AL00001+4                                      0843 02812000
         ST    @08,@AL00001+8                                      0843 02813000
         MVI   @AL00001+8,X'80'                                    0843 02814000
         L     @15,GDTUNT(,@15)                                    0843 02815000
         LA    @01,@AL00001                                        0843 02816000
         BALR  @14,@15                                             0843 02817000
*           RESPECIFY                                              0844 02818000
*             RTNREG RSTD;                                         0844 02819000
*           TESTRC=RTNREG;                                         0845 02820000
         STH   RTNREG,TESTRC                                       0845 02821000
*           RESPECIFY                                              0846 02822000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 02823000
*           MDPOST=OFF;             /*                       @Y30LB34*/ 02824000
*           MDWAIT=OFF;             /*                       @Y30LB34*/ 02825000
*                                                                  0848 02826000
         LA    @08,MDAGLAR                                         0848 02827000
         NI    MDPOST(@08),B'11001111'                             0848 02828000
*           /*********************************************************/ 02829000
*           /*                                                       */ 02830000
*           /* IF UMSSUNIT WAS UNSUCCESSFUL SET CONDITION    @Y30LB34*/ 02831000
*           /* CODE TO 12                                    @Y30LB34*/ 02832000
*           /*                                                       */ 02833000
*           /*********************************************************/ 02834000
*                                                                  0849 02835000
*           IF TESTRC>0 THEN                                       0849 02836000
         LH    @08,TESTRC                                          0849 02837000
         LTR   @08,@08                                             0849 02838000
         BNP   @RF00849                                            0849 02839000
*             CC08=LASTCC12;        /*                       @Y30LB34*/ 02840000
         LA    CC08,12                                             0850 02841000
*         END;                      /*                       @Y30LB34*/ 02842000
@RF00849 DS    0H                                                  0852 02843000
*     END;                          /*                       @Y30LB34*/ 02844000
@RF00838 DS    0H                                                  0853 02845000
*                                                                  0853 02846000
*   /*****************************************************************/ 02847000
*   /*                                                               */ 02848000
*   /* IF A SEVERE ERROR HAS OCCURRED, DEQUEUE THE TARGET    @Y30LB34*/ 02849000
*   /* VOLUME ENQUEUE BEFORE TERMINATING THE JOB             @Y30LB34*/ 02850000
*   /*                                                               */ 02851000
*   /*****************************************************************/ 02852000
*                                                                  0853 02853000
*   IF CC08=LASTCC12 THEN                                          0853 02854000
@RF00826 C     CC08,@CF00567                                       0853 02855000
         BNE   @RF00853                                            0853 02856000
*     IF TENQ=ON THEN                                              0854 02857000
         TM    TENQ,B'10000000'                                    0854 02858000
         BNO   @RF00854                                            0854 02859000
*       DO;                         /*                       @Y30LB34*/ 02860000
*         CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVE);/*             @Y30LB34*/ 02861000
         L     @08,@PC00001                                        0856 02862000
         ST    @08,@AL00001                                        0856 02863000
         LA    @15,@CC01594                                        0856 02864000
         ST    @15,@AL00001+4                                      0856 02865000
         LA    @15,RNAMEVE                                         0856 02866000
         ST    @15,@AL00001+8                                      0856 02867000
         MVI   @AL00001+8,X'80'                                    0856 02868000
         L     @15,GDTDEQ(,@08)                                    0856 02869000
         LA    @01,@AL00001                                        0856 02870000
         BALR  @14,@15                                             0856 02871000
*         TENQ=OFF;                 /*                       @Y30LB34*/ 02872000
         NI    TENQ,B'01111111'                                    0857 02873000
*       END;                        /*                       @Y30LB34*/ 02874000
*                                                                  0858 02875000
*   /*****************************************************************/ 02876000
*   /*                                                               */ 02877000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 02878000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 02879000
*   /*                                                               */ 02880000
*   /*****************************************************************/ 02881000
*                                                                  0859 02882000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 02883000
@RF00854 DS    0H                                                  0859 02884000
@RF00853 LR    REG14,RTNREG2                                       0859 02885000
*   RETURN CODE(CC08);              /*                       @Y30LB34*/ 02886000
         LR    @15,CC08                                            0860 02887000
@EL00009 DS    0H                                                  0860 02888000
@EF00009 DS    0H                                                  0860 02889000
@ER00009 BR    @14                                                 0860 02890000
*   END RVINITTA;                   /*                       @Y30LB34*/ 02891000
*                                                                  0862 02892000
*/********************************************************** @Y30LB34*/ 02893000
*/*                                                          @Y30LB34*/ 02894000
*/* PROCEDURE NAME - RVGETTA                                 @Y30LB34*/ 02895000
*/*                                                          @Y30LB34*/ 02896000
*/* FUNCTION - INITIALIZES THE MSVC PARM LIST TO RETRIEVE    @Y30LB34*/ 02897000
*/*            THE BASE VOLUME RECORD OF THE MSS VOLUME      @Y30LB34*/ 02898000
*/*                                                          @Y30LB34*/ 02899000
*/*            ISSUES USSC TO RETRIEVE THE BASE VOLUME       @Y30LB34*/ 02900000
*/*            RECORD                                        @Y30LB34*/ 02901000
*/*                IF USSC IS NOT SUCCESSFUL, CALLS SSCMSG   @Y30LB34*/ 02902000
*/*                TO PRINT MESSAGE,                         @Y30LB34*/ 02903000
*/*                PRINTS ERROR MESSAGE IDC2080I IF THE BASE @Y30LB34*/ 02904000
*/*                VOLUME RECORD COULD NOT BE RETRIEVED      @Y30LB34*/ 02905000
*/*                                                          @Y30LB34*/ 02906000
*/*            DETERMINES IF VOLUME IS INACTIVE.  IF SO,     @Y30LB34*/ 02907000
*/*            PRINTS MESSAGE IDC3074I                       @Y30LB34*/ 02908000
*/*                                                          @Y30LB34*/ 02909000
*/*            DETERMINES IF ANY RECOVERY FLAGS ARE ON, AND, @Y30LB34*/ 02910000
*/*            IF SO, WHICH ONES                             @Y30LB34*/ 02911000
*/*                IF INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/ 02912000
*/*                PRINTS ERROR MESSAGE IDC3097I,            @Y30LB34*/ 02913000
*/*                IF VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/ 02914000
*/*                PRINTS ERROR MESSAGE IDC3095I,            @Y30LB34*/ 02915000
*/*                IF INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/ 02916000
*/*                PREVENTS EMPTY VTOC CHECKING IN CHEKTARG  @Y30LB34*/ 02917000
*/*                                                          @Y30LB34*/ 02918000
*/*            RETRIEVES OWNER INFORMATION                   @Y30LB34*/ 02919000
*/*                                                          @Y30LB34*/ 02920000
*/* INPUT - TARGAREA, RVVI, DARGLIST                         @Y30LB34*/ 02921000
*/*                                                          @Y30LB34*/ 02922000
*/* OUTPUT - RVVI, TARGAREA                                  @Y30LB34*/ 02923000
*/*                                                          @Y30LB34*/ 02924000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 02925000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 02926000
*/*           R. C. = 12, UNABLE TO RETRIEVE BASE VOLUME     @Y30LB34*/ 02927000
*/*                       RECORD,                            @Y30LB34*/ 02928000
*/*                       INVALID RECOVERY FLAGS ON IN BASE  @Y30LB34*/ 02929000
*/*                       VOLUME RECORD,                     @Y30LB34*/ 02930000
*/*                       VOLUME NOT ACTIVE                  @Y30LB34*/ 02931000
*/*                                                          @Y30LB34*/ 02932000
*/********************************************************** @Y30LB34*/ 02933000
*                                                                  0862 02934000
*RVGETTA:                                                          0862 02935000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 02936000
*                                                                  0862 02937000
RVGETTA  DS    0H                                                  0863 02938000
*   /*****************************************************************/ 02939000
*   /*                                                               */ 02940000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 02941000
*   /*                                                               */ 02942000
*   /*****************************************************************/ 02943000
*                                                                  0863 02944000
*   DCL                                                            0863 02945000
*     CC09 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   02946000
*                                      CODE SAVE AREA        @Y30LB34*/ 02947000
*                                                                  0864 02948000
*   /*****************************************************************/ 02949000
*   /*                                                               */ 02950000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 02951000
*   /*                                                               */ 02952000
*   /*****************************************************************/ 02953000
*                                                                  0864 02954000
*   OLDERID2=NEWERID2;                                             0864 02955000
         L     @08,@PC00001                                        0864 02956000
         L     @15,GDTTR2(,@08)                                    0864 02957000
         MVC   @TS00001(95),NEWERID2(@15)                          0864 02958000
         MVC   OLDERID2(95,@15),@TS00001                           0864 02959000
*   NEWID2='CNT9';                  /*                       @Y30LB34*/ 02960000
*                                                                  0865 02961000
         MVC   NEWID2(4,@15),@CC01734                              0865 02962000
*   /*****************************************************************/ 02963000
*   /*                                                               */ 02964000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 02965000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 02966000
*   /*                                                               */ 02967000
*   /*****************************************************************/ 02968000
*                                                                  0866 02969000
*   CC09=LASTCC00;                  /*                       @Y30LB34*/ 02970000
         SLR   @15,@15                                             0866 02971000
         LR    CC09,@15                                            0866 02972000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 02973000
*                                                                  0867 02974000
         ST    REG14,RTNREG3                                       0867 02975000
*   /*****************************************************************/ 02976000
*   /*                                                               */ 02977000
*   /* INITIALIZE RVVI PARM LIST FOR RETRIEVING A BASE       @Y30LB34*/ 02978000
*   /* VOLUME RECORD                                         @Y30LB34*/ 02979000
*   /*                                                               */ 02980000
*   /*****************************************************************/ 02981000
*                                                                  0868 02982000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB34*/ 02983000
         L     @14,RVVIPTR                                         0868 02984000
         LH    @11,RVVLEN                                          0868 02985000
         ST    @11,RVVLNGTH(,@14)                                  0868 02986000
*   RVVCODE=RVVOP;                  /*                       @Y30LB34*/ 02987000
         MVI   RVVCODE(@14),X'87'                                  0869 02988000
*   RVVOLUME=TVOLSER;               /*                       @Y30LB34*/ 02989000
         MVC   RVVOLUME(6,@14),TVOLSER                             0870 02990000
*   RVVRDR=ON;                      /*                       @Y30LB34*/ 02991000
         OI    RVVRDR(@14),B'10000000'                             0871 02992000
*   RVVBVRCD=ON;                    /*                       @Y30LB34*/ 02993000
         OI    RVVBVRCD(@14),B'10000000'                           0872 02994000
*   RVVBUFLN=LENGTH(BASEVAR);       /*                       @Y30LB34*/ 02995000
         MVC   RVVBUFLN(2,@14),@CH01875                            0873 02996000
*   RVVRTBUF=ADDR(BASEVAR);         /*                       @Y30LB34*/ 02997000
         LA    @11,BASEVAR                                         0874 02998000
         ST    @11,RVVRTBUF(,@14)                                  0874 02999000
*   RVVSVOL=ON;                     /*                       @Y30LB34*/ 03000000
         OI    RVVSVOL(@14),B'00000001'                            0875 03001000
*                                                                  0876 03002000
*   /*****************************************************************/ 03003000
*   /*                                                               */ 03004000
*   /* ISSUE USSC TO ISSUE ICBVVIC TO RETRIEVE THE BASE      @Y30LB34*/ 03005000
*   /* VOLUME RECORD FOR THE TARGET VOLUME                   @Y30LB34*/ 03006000
*   /*                                                               */ 03007000
*   /*****************************************************************/ 03008000
*                                                                  0876 03009000
*   USSCREG0=0;                     /*                       @Y30LB34*/ 03010000
         ST    @15,USSCREG0                                        0876 03011000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,USSCREG0);/*           @Y30LB34*/ 03012000
         ST    @08,@AL00001                                        0877 03013000
         LA    @15,VVIC                                            0877 03014000
         ST    @15,@AL00001+4                                      0877 03015000
         LA    @15,RVVIPTR                                         0877 03016000
         ST    @15,@AL00001+8                                      0877 03017000
         LA    @15,USSCREG0                                        0877 03018000
         ST    @15,@AL00001+12                                     0877 03019000
         MVI   @AL00001+12,X'80'                                   0877 03020000
         L     @15,GDTSSC(,@08)                                    0877 03021000
         LA    @01,@AL00001                                        0877 03022000
         BALR  @14,@15                                             0877 03023000
*   RESPECIFY                                                      0878 03024000
*     RTNREG RSTD;                                                 0878 03025000
*   TESTRC=RTNREG;                                                 0879 03026000
         STH   RTNREG,TESTRC                                       0879 03027000
*   RESPECIFY                                                      0880 03028000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 03029000
*                                                                  0880 03030000
*   /*****************************************************************/ 03031000
*   /*                                                               */ 03032000
*   /* IF USSC WAS UNSUCCESSFUL, CALL SSCMSG TO PRINT        @Y30LB34*/ 03033000
*   /* THE USSC MESSAGE, PRINT MESSAGE IDC2080I, AND         @Y30LB34*/ 03034000
*   /* SET THE CONDITION CODE TO 12                          @Y30LB34*/ 03035000
*   /*                                                               */ 03036000
*   /*****************************************************************/ 03037000
*                                                                  0881 03038000
*   IF TESTRC>0 THEN                                               0881 03039000
         LH    @08,TESTRC                                          0881 03040000
         LTR   @08,@08                                             0881 03041000
         BNP   @RF00881                                            0881 03042000
*     DO;                           /*                       @Y30LB34*/ 03043000
*       CALL SSCMSG(USSCREG0);      /*                       @Y30LB34*/ 03044000
         LA    @15,USSCREG0                                        0883 03045000
         ST    @15,@AL00001                                        0883 03046000
         LA    @01,@AL00001                                        0883 03047000
         BAL   @14,SSCMSG                                          0883 03048000
*       CC09=LASTCC12;              /*                       @Y30LB34*/ 03049000
         LA    CC09,12                                             0884 03050000
*       DARGSMOD=COMMSG;            /*                       @Y30LB34*/ 03051000
         L     @08,DDSTRU                                          0885 03052000
         MVC   DARGSMOD(3,@08),@CC01555                            0885 03053000
*       DARGSENT=MSG2080I;          /*                       @Y30LB34*/ 03054000
         MVI   DARGSENT(@08),X'1A'                                 0886 03055000
*       DARGDBP=ADDR(TVOLSER);      /*                       @Y30LB34*/ 03056000
         LA    @15,TVOLSER                                         0887 03057000
         ST    @15,DARGDBP(,@08)                                   0887 03058000
*       DARGILP=LENGTH(TVOLSER);    /*                       @Y30LB34*/ 03059000
         MVC   DARGILP(2,@08),@CH00038                             0888 03060000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 03061000
         SLR   @15,@15                                             0889 03062000
         ST    @15,DARGRETP(,@08)                                  0889 03063000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 03064000
         L     @08,@PC00001                                        0890 03065000
         ST    @08,@AL00001                                        0890 03066000
         LA    @15,@CF00115                                        0890 03067000
         ST    @15,@AL00001+4                                      0890 03068000
         LA    @15,DDSTRU                                          0890 03069000
         ST    @15,@AL00001+8                                      0890 03070000
         MVI   @AL00001+8,X'80'                                    0890 03071000
         L     @15,GDTPRT(,@08)                                    0890 03072000
         LA    @01,@AL00001                                        0890 03073000
         BALR  @14,@15                                             0890 03074000
*     END;                          /*                       @Y30LB34*/ 03075000
*                                                                  0891 03076000
*   /*****************************************************************/ 03077000
*   /*                                                               */ 03078000
*   /* IF USSC WAS SUCCESSFUL, CHECK BASE VOLUME RECORD      @Y30LB34*/ 03079000
*   /*                                                               */ 03080000
*   /*****************************************************************/ 03081000
*                                                                  0892 03082000
*   ELSE                                                           0892 03083000
*     DO;                           /*                       @Y30LB34*/ 03084000
         B     @RC00881                                            0892 03085000
@RF00881 DS    0H                                                  0893 03086000
*                                                                  0893 03087000
*       /*************************************************************/ 03088000
*       /*                                                           */ 03089000
*       /* TEST FOR AN ACTIVE VOLUME. IF NOT, PRINT          @Y30LB34*/ 03090000
*       /* ERROR MESSAGE IDC3074I AND SET CONDITION CODE     @Y30LB34*/ 03091000
*       /* TO 12.                                            @Y30LB34*/ 03092000
*       /*                                                           */ 03093000
*       /*************************************************************/ 03094000
*                                                                  0893 03095000
*       IF BASINAC=ON THEN                                         0893 03096000
         L     @08,BASEVPTR                                        0893 03097000
         TM    BASINAC(@08),B'00000100'                            0893 03098000
         BNO   @RF00893                                            0893 03099000
*         DO;                       /*                       @Y30LB34*/ 03100000
*           CC09=LASTCC12;          /*                       @Y30LB34*/ 03101000
         LA    CC09,12                                             0895 03102000
*           DARGSMOD=COMMSG;        /*                       @Y30LB34*/ 03103000
         L     @08,DDSTRU                                          0896 03104000
         MVC   DARGSMOD(3,@08),@CC01555                            0896 03105000
*           DARGSENT=MSG3074I;      /*                       @Y30LB34*/ 03106000
         MVI   DARGSENT(@08),X'20'                                 0897 03107000
*           DARGDBP=ADDR(TVOLSER);  /*                       @Y30LB34*/ 03108000
         LA    @15,TVOLSER                                         0898 03109000
         ST    @15,DARGDBP(,@08)                                   0898 03110000
*           DARGILP=LENGTH(TVOLSER);/*                       @Y30LB34*/ 03111000
         MVC   DARGILP(2,@08),@CH00038                             0899 03112000
*           DARGRETP=0;             /*                       @Y30LB34*/ 03113000
         SLR   @15,@15                                             0900 03114000
         ST    @15,DARGRETP(,@08)                                  0900 03115000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 03116000
         L     @08,@PC00001                                        0901 03117000
         ST    @08,@AL00001                                        0901 03118000
         LA    @15,@CF00115                                        0901 03119000
         ST    @15,@AL00001+4                                      0901 03120000
         LA    @15,DDSTRU                                          0901 03121000
         ST    @15,@AL00001+8                                      0901 03122000
         MVI   @AL00001+8,X'80'                                    0901 03123000
         L     @15,GDTPRT(,@08)                                    0901 03124000
         LA    @01,@AL00001                                        0901 03125000
         BALR  @14,@15                                             0901 03126000
*         END;                      /*                       @Y30LB34*/ 03127000
*                                                                  0902 03128000
*       /*************************************************************/ 03129000
*       /*                                                           */ 03130000
*       /* IF VOLUME IS ACTIVE, TEST RECOVERY FLAGS          @Y30LB34*/ 03131000
*       /*                                                           */ 03132000
*       /*************************************************************/ 03133000
*                                                                  0903 03134000
*       ELSE                                                       0903 03135000
*         DO;                       /*                       @Y30LB34*/ 03136000
*                                                                  0903 03137000
         B     @RC00893                                            0903 03138000
@RF00893 DS    0H                                                  0904 03139000
*           /*********************************************************/ 03140000
*           /*                                                       */ 03141000
*           /* IF THE INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/ 03142000
*           /* PRINT ERROR MESSAGE IDC3097I AND SET          @Y30LB34*/ 03143000
*           /* CONDITION CODE TO 12                          @Y30LB34*/ 03144000
*           /*                                                       */ 03145000
*           /*********************************************************/ 03146000
*                                                                  0904 03147000
*           IF BASIVCRE=ON THEN                                    0904 03148000
         L     @08,BASEVPTR                                        0904 03149000
         TM    BASIVCRE(@08),B'10000000'                           0904 03150000
         BNO   @RF00904                                            0904 03151000
*             DO;                   /*                       @Y30LB34*/ 03152000
*               CC09=LASTCC12;      /*                       @Y30LB34*/ 03153000
         LA    CC09,12                                             0906 03154000
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/ 03155000
         L     @08,DDSTRU                                          0907 03156000
         MVC   DARGSMOD(3,@08),@CC01555                            0907 03157000
*               DARGSENT=MSG3097T;  /*                       @Y30LB34*/ 03158000
         MVI   DARGSENT(@08),X'04'                                 0908 03159000
*               DARGDBP=ADDR(TVOLSER);/*                     @Y30LB34*/ 03160000
         LA    @15,TVOLSER                                         0909 03161000
         ST    @15,DARGDBP(,@08)                                   0909 03162000
*               DARGILP=LENGTH(TVOLSER);/*                   @Y30LB34*/ 03163000
         MVC   DARGILP(2,@08),@CH00038                             0910 03164000
*               DARGRETP=0;         /*                       @Y30LB34*/ 03165000
         SLR   @15,@15                                             0911 03166000
         ST    @15,DARGRETP(,@08)                                  0911 03167000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/ 03168000
         L     @08,@PC00001                                        0912 03169000
         ST    @08,@AL00001                                        0912 03170000
         LA    @15,@CF00115                                        0912 03171000
         ST    @15,@AL00001+4                                      0912 03172000
         LA    @15,DDSTRU                                          0912 03173000
         ST    @15,@AL00001+8                                      0912 03174000
         MVI   @AL00001+8,X'80'                                    0912 03175000
         L     @15,GDTPRT(,@08)                                    0912 03176000
         LA    @01,@AL00001                                        0912 03177000
         BALR  @14,@15                                             0912 03178000
*             END;                  /*                       @Y30LB34*/ 03179000
*                                                                  0914 03180000
*           /*********************************************************/ 03181000
*           /*                                                       */ 03182000
*           /* IF THE VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/ 03183000
*           /* PRINT ERROR MESSAGE IDC3095I AND SET          @Y30LB34*/ 03184000
*           /* CONDITION CODE TO 12                          @Y30LB34*/ 03185000
*           /*                                                       */ 03186000
*           /*********************************************************/ 03187000
*                                                                  0914 03188000
*           ELSE                                                   0914 03189000
*             IF BASVSMIS=ON THEN                                  0914 03190000
         B     @RC00904                                            0914 03191000
@RF00904 L     @08,BASEVPTR                                        0914 03192000
         TM    BASVSMIS(@08),B'00100000'                           0914 03193000
         BNO   @RF00914                                            0914 03194000
*               DO;                 /*                       @Y30LB34*/ 03195000
*                 CC09=LASTCC12;    /*                       @Y30LB34*/ 03196000
         LA    CC09,12                                             0916 03197000
*                 DARGSMOD=COMMSG;  /*                       @Y30LB34*/ 03198000
         L     @08,DDSTRU                                          0917 03199000
         MVC   DARGSMOD(3,@08),@CC01555                            0917 03200000
*                 DARGSENT=MSG3095T;/*                       @Y30LB34*/ 03201000
         MVI   DARGSENT(@08),X'0A'                                 0918 03202000
*                 DARGDBP=ADDR(TVOLSER);/*                   @Y30LB34*/ 03203000
         LA    @15,TVOLSER                                         0919 03204000
         ST    @15,DARGDBP(,@08)                                   0919 03205000
*                 DARGILP=LENGTH(TVOLSER);/*                 @Y30LB34*/ 03206000
         MVC   DARGILP(2,@08),@CH00038                             0920 03207000
*                 DARGRETP=0;       /*                       @Y30LB34*/ 03208000
         SLR   @15,@15                                             0921 03209000
         ST    @15,DARGRETP(,@08)                                  0921 03210000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB34*/ 03211000
         L     @08,@PC00001                                        0922 03212000
         ST    @08,@AL00001                                        0922 03213000
         LA    @15,@CF00115                                        0922 03214000
         ST    @15,@AL00001+4                                      0922 03215000
         LA    @15,DDSTRU                                          0922 03216000
         ST    @15,@AL00001+8                                      0922 03217000
         MVI   @AL00001+8,X'80'                                    0922 03218000
         L     @15,GDTPRT(,@08)                                    0922 03219000
         LA    @01,@AL00001                                        0922 03220000
         BALR  @14,@15                                             0922 03221000
*               END;                /*                       @Y30LB34*/ 03222000
*                                                                  0923 03223000
*           /*********************************************************/ 03224000
*           /*                                                       */ 03225000
*           /* IF THE INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/ 03226000
*           /* SET THE BIT TO OMIT EMPTY VTOC CHECKING       @Y30LB34*/ 03227000
*           /*                                                       */ 03228000
*           /*********************************************************/ 03229000
*                                                                  0924 03230000
*             ELSE                                                 0924 03231000
*               IF BASIVCPY=ON THEN                                0924 03232000
         B     @RC00914                                            0924 03233000
@RF00914 L     @08,BASEVPTR                                        0924 03234000
         TM    BASIVCPY(@08),B'01000000'                           0924 03235000
         BNO   @RF00924                                            0924 03236000
*                 NOVTOCCK=ON;      /*                       @Y30LB34*/ 03237000
         OI    NOVTOCCK,B'00100000'                                0925 03238000
*         END;                      /*                       @Y30LB34*/ 03239000
@RF00924 DS    0H                                                  0926 03240000
@RC00914 DS    0H                                                  0926 03241000
@RC00904 DS    0H                                                  0927 03242000
*     END;                          /*                       @Y30LB34*/ 03243000
@RC00893 DS    0H                                                  0928 03244000
*                                                                  0928 03245000
*   /*****************************************************************/ 03246000
*   /*                                                               */ 03247000
*   /* IF NO SEVERE ERRORS WERE ENCOUNTERED, RETRIEVE        @Y30LB34*/ 03248000
*   /* OWNER INFORMATION AND SAVE IT IN THE TARGET VOLUME    @Y30LB34*/ 03249000
*   /* WORK AREA. THIS IS DONE SINCE THE LABEL MAY HAVE      @Y30LB34*/ 03250000
*   /* BEEN OVERLAYED IN A PREVIOUSLY UNSUCCESSFUL CONVERT   @Y30LB34*/ 03251000
*   /* ATTEMPT.                                              @Y30LB34*/ 03252000
*   /*                                                               */ 03253000
*   /*****************************************************************/ 03254000
*                                                                  0928 03255000
*   IF CC09<LASTCC12 THEN                                          0928 03256000
@RC00881 C     CC09,@CF00567                                       0928 03257000
         BNL   @RF00928                                            0928 03258000
*     TOWNER=BASOWNER;              /*                       @Y30LB34*/ 03259000
*                                                                  0929 03260000
         L     @08,BASEVPTR                                        0929 03261000
         MVC   TOWNER(10),BASOWNER(@08)                            0929 03262000
*   /*****************************************************************/ 03263000
*   /*                                                               */ 03264000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 03265000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 03266000
*   /*                                                               */ 03267000
*   /*****************************************************************/ 03268000
*                                                                  0930 03269000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 03270000
@RF00928 L     REG14,RTNREG3                                       0930 03271000
*   RETURN CODE(CC09);              /*                       @Y30LB34*/ 03272000
         LR    @15,CC09                                            0931 03273000
@EL00010 DS    0H                                                  0931 03274000
@EF00010 DS    0H                                                  0931 03275000
@ER00010 BR    @14                                                 0931 03276000
*   END RVGETTA;                    /*                       @Y30LB34*/ 03277000
*                                                                  0933 03278000
*/********************************************************** @Y30LB34*/ 03279000
*/*                                                          @Y30LB34*/ 03280000
*/* PROCEDURE NAME - CHEKTARG                                @Y30LB34*/ 03281000
*/*                                                          @Y30LB34*/ 03282000
*/* FUNCTION - PERFORMS TARGET VOLUME CHECKING               @Y30LB34*/ 03283000
*/*                                                          @Y30LB34*/ 03284000
*/*            INITIALIZES VOLUME SERVICES PARM LIST FOR ALL @Y30LB34*/ 03285000
*/*            VOLUME SERVICES REQUESTS ON THE TARGET VOLUME @Y30LB34*/ 03286000
*/*                                                          @Y30LB34*/ 03287000
*/*            IF VTOC CHECKING IS NOT TO BE OMITTED, CALLS  @Y30LB34*/ 03288000
*/*            VOLUME SERVICES TO PERFORM SECURITY CHECKING  @Y30LB34*/ 03289000
*/*            FOR AN EMPTY VTOC AND RETRIEVE ALTERNATE      @Y30LB34*/ 03290000
*/*            TRACK INFROMATION                             @Y30LB34*/ 03291000
*/*                                                          @Y30LB34*/ 03292000
*/*            CLOSES THE VTOC OPENED BY VOLUME SERVICES     @Y30LB34*/ 03293000
*/*                                                          @Y30LB34*/ 03294000
*/* INPUT - TOVS1AGL, TARGAREA, FUNCTION DATA TABLE,         @Y30LB34*/ 03295000
*/*         DARGLIST                                         @Y30LB34*/ 03296000
*/*                                                          @Y30LB34*/ 03297000
*/* OUTPUT - INITIALIZED TOVS1AGL                            @Y30LB34*/ 03298000
*/*                                                          @Y30LB34*/ 03299000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 03300000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 03301000
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/ 03302000
*/*           R. C. = 12, SECURITY CHECKING FAILED,          @Y30LB34*/ 03303000
*/*                       UNABLE TO RETRIEVE ALTERNATE       @Y30LB34*/ 03304000
*/*                       TRACK INFORMATION                  @Y30LB34*/ 03305000
*/*                                                          @Y30LB34*/ 03306000
*/********************************************************** @Y30LB34*/ 03307000
*                                                                  0933 03308000
*CHEKTARG:                                                         0933 03309000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 03310000
*                                                                  0933 03311000
CHEKTARG DS    0H                                                  0934 03312000
*   /*****************************************************************/ 03313000
*   /*                                                               */ 03314000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 03315000
*   /*                                                               */ 03316000
*   /*****************************************************************/ 03317000
*                                                                  0934 03318000
*   DCL                                                            0934 03319000
*     CC10 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   03320000
*                                      CODE SAVE AREA        @Y30LB34*/ 03321000
*                                                                  0935 03322000
*   /*****************************************************************/ 03323000
*   /*                                                               */ 03324000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 03325000
*   /*                                                               */ 03326000
*   /*****************************************************************/ 03327000
*                                                                  0935 03328000
*   OLDERID2=NEWERID2;                                             0935 03329000
         L     @08,@PC00001                                        0935 03330000
         L     @08,GDTTR2(,@08)                                    0935 03331000
         MVC   @TS00001(95),NEWERID2(@08)                          0935 03332000
         MVC   OLDERID2(95,@08),@TS00001                           0935 03333000
*   NEWID2='CNTA';                  /*                       @Y30LB34*/ 03334000
*                                                                  0936 03335000
         MVC   NEWID2(4,@08),@CC01740                              0936 03336000
*   /*****************************************************************/ 03337000
*   /*                                                               */ 03338000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 03339000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 03340000
*   /*                                                               */ 03341000
*   /*****************************************************************/ 03342000
*                                                                  0937 03343000
*   CC10=LASTCC00;                  /*                       @Y30LB34*/ 03344000
         SLR   CC10,CC10                                           0937 03345000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 03346000
*                                                                  0938 03347000
         ST    REG14,RTNREG3                                       0938 03348000
*   /*****************************************************************/ 03349000
*   /*                                                               */ 03350000
*   /* INITIALIZE THE IDCVS01 PARM LIST FOR ALL VOLUME       @Y30LB34*/ 03351000
*   /* SERVICES REQUESTS ON THE TARGET VOLUME                @Y30LB34*/ 03352000
*   /*                                                               */ 03353000
*   /*****************************************************************/ 03354000
*                                                                  0939 03355000
*   RESPECIFY                                                      0939 03356000
*     VS1AGL BASED(ADDR(TOVS1AGL)); /*                       @Y30LB34*/ 03357000
*   VSNOVSAM=ON;                    /*                       @Y30LB34*/ 03358000
*   VSNONONV=ON;                    /*                       @Y30LB34*/ 03359000
         LA    @08,TOVS1AGL                                        0941 03360000
         OI    VSNOVSAM(@08),B'10100000'                           0941 03361000
*   VSALTTRK=ON;                    /*                       @Y30LB34*/ 03362000
         OI    VSALTTRK(@08),B'01000000'                           0942 03363000
*   IF SVSAM=ON THEN                                               0943 03364000
         TM    SVSAM,B'00100000'                                   0943 03365000
         BNO   @RF00943                                            0943 03366000
*     VSTIME=ON;                    /*                       @Y30LB34*/ 03367000
         OI    VSTIME(@08),B'10000000'                             0944 03368000
*   VSDEVICE=ON;                    /*                       @Y30LB34*/ 03369000
@RF00943 LA    @08,TOVS1AGL                                        0945 03370000
         OI    VSDEVICE(@08),B'10000000'                           0945 03371000
*   IF SAMESER=OFF THEN                                            0946 03372000
         TM    SAMESER,B'10000000'                                 0946 03373000
         BNZ   @RF00946                                            0946 03374000
*     VSSERIAL=ON;                  /*                       @Y30LB34*/ 03375000
         OI    VSSERIAL(@08),B'01000000'                           0947 03376000
*   IF ADDR(LIST)^=NULLPTR THEN                                    0948 03377000
@RF00946 L     @08,@PC00001+4                                      0948 03378000
         L     @08,FDTPTR+52(,@08)                                 0948 03379000
         LTR   @08,@08                                             0948 03380000
         BZ    @RF00948                                            0948 03381000
*     VSLIST=ON;                    /*                       @Y30LB34*/ 03382000
         LA    @08,TOVS1AGL                                        0949 03383000
         OI    VSLIST(@08),B'00100000'                             0949 03384000
*   VSTOV=ON;                       /*                       @Y30LB34*/ 03385000
@RF00948 LA    @08,TOVS1AGL                                        0950 03386000
         OI    VSTOV(@08),B'01000000'                              0950 03387000
*   VSVOLP=ADDR(TVOLSER);           /*                       @Y30LB34*/ 03388000
         LA    @15,TVOLSER                                         0951 03389000
         ST    @15,VSVOLP(,@08)                                    0951 03390000
*   VSFILEP=ADDR(TFILEVAL);         /*                       @Y30LB34*/ 03391000
         L     @14,@PC00001+4                                      0952 03392000
         L     @01,FDTPTR+4(,@14)                                  0952 03393000
         LA    @14,TFILEVAL(,@01)                                  0952 03394000
         ST    @14,VSFILEP(,@08)                                   0952 03395000
*   VSNUMATP=ADDR(TNUMAT);          /*                       @Y30LB34*/ 03396000
         LA    @14,TNUMAT                                          0953 03397000
         ST    @14,VSNUMATP(,@08)                                  0953 03398000
*   VSNXTATP=ADDR(TNXTAT);          /*                       @Y30LB34*/ 03399000
         LA    @14,TNXTAT                                          0954 03400000
         ST    @14,VSNXTATP(,@08)                                  0954 03401000
*   VSSERP=ADDR(TVOLSER);           /*                       @Y30LB34*/ 03402000
         ST    @15,VSSERP(,@08)                                    0955 03403000
*   VSDEVP=ADDR(TDEVTYPE);          /*                       @Y30LB34*/ 03404000
         LA    @15,TDEVTYPE                                        0956 03405000
         ST    @15,VSDEVP(,@08)                                    0956 03406000
*   VSOSERP=ADDR(SVOLSER);          /*                       @Y30LB34*/ 03407000
         LA    @15,SVOLSER                                         0957 03408000
         ST    @15,VSOSERP(,@08)                                   0957 03409000
*   VSODEVP=ADDR(SDEVTYPE);         /*                       @Y30LB34*/ 03410000
         LA    @15,SDEVTYPE                                        0958 03411000
         ST    @15,VSODEVP(,@08)                                   0958 03412000
*   IF TTYPEVOL='REAL' THEN                                        0959 03413000
         CLC   TTYPEVOL(4),@CC01679                                0959 03414000
         BNE   @RF00959                                            0959 03415000
*     VSREAL=ON;                    /*                       @Y30LB34*/ 03416000
         OI    VSREAL(@08),B'01000000'                             0960 03417000
*   VSUCBP=ADDR(TUCBADDR);          /*                       @Y30LB34*/ 03418000
@RF00959 LA    @08,TOVS1AGL                                        0961 03419000
         LA    @15,TUCBADDR                                        0961 03420000
         ST    @15,VSUCBP(,@08)                                    0961 03421000
*                                                                  0962 03422000
*   /*****************************************************************/ 03423000
*   /*                                                               */ 03424000
*   /* IF THE NOVTOCCK FLAG IS OFF, CHECK AND RETREIVE       @Y30LB34*/ 03425000
*   /* INFORMATION FROM THE TARGET VOLUME VTOC               @Y30LB34*/ 03426000
*   /*                                                               */ 03427000
*   /*****************************************************************/ 03428000
*                                                                  0962 03429000
*   IF NOVTOCCK=OFF THEN                                           0962 03430000
         TM    NOVTOCCK,B'00100000'                                0962 03431000
         BNZ   @RF00962                                            0962 03432000
*     DO;                           /*                       @Y30LB34*/ 03433000
*                                                                  0963 03434000
*       /*************************************************************/ 03435000
*       /*                                                           */ 03436000
*       /* CALL VOLUME SERVICES TO VERIFY AN EMPTY VTOC      @Y30LB34*/ 03437000
*       /* ON THE TARGET VOLUME. SINCE THE VOLUME IS TO      @Y30LB34*/ 03438000
*       /* BE RESERVED AT THE TIME IT IS MOUNTED, THE        @Y30LB34*/ 03439000
*       /* VSRES AND TRES BITS ARE TURNED ON.                @ZA08840*/ 03440000
*       /*                                                           */ 03441000
*       /*************************************************************/ 03442000
*                                                                  0964 03443000
*       IF CONVTYPE=RV THEN                                        0964 03444000
         TM    CONVTYPE,B'01000000'                                0964 03445000
         BNO   @RF00964                                            0964 03446000
*         DO;                       /*                       @ZA08840*/ 03447000
*           VSRES=ON;               /*                       @Y30LB34*/ 03448000
         OI    VSRES(@08),B'10000000'                              0966 03449000
*           TRES=ON;                /*                       @ZA08840*/ 03450000
         OI    TRES,B'01000000'                                    0967 03451000
*         END;                      /*                       @ZA08840*/ 03452000
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*  @Y30LB34*/ 03453000
@RF00964 L     @08,@PC00001                                        0969 03454000
         ST    @08,@AL00001                                        0969 03455000
         LA    @15,@CC01720                                        0969 03456000
         ST    @15,@AL00001+4                                      0969 03457000
         LA    @15,SECCHECK                                        0969 03458000
         ST    @15,@AL00001+8                                      0969 03459000
         LA    @15,TOVS1AGL                                        0969 03460000
         ST    @15,@AL00001+12                                     0969 03461000
         MVI   @AL00001+12,X'80'                                   0969 03462000
         L     @15,GDTCAL(,@08)                                    0969 03463000
         LA    @01,@AL00001                                        0969 03464000
         BALR  @14,@15                                             0969 03465000
*       RESPECIFY                                                  0970 03466000
*         RTNREG RSTD;                                             0970 03467000
*       TESTRC=RTNREG;                                             0971 03468000
         STH   RTNREG,TESTRC                                       0971 03469000
*       RESPECIFY                                                  0972 03470000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 03471000
*                                                                  0972 03472000
*       /*************************************************************/ 03473000
*       /*                                                           */ 03474000
*       /* IF VOLUME SERVICES WAS UNSUCCESSFUL OR THE        @Y30LB34*/ 03475000
*       /* VTOC WAS NOT EMPTY, SET THE CONDITION CODE TO     @Y30LB34*/ 03476000
*       /* 12.                                               @Y30LB34*/ 03477000
*       /*                                                           */ 03478000
*       /*************************************************************/ 03479000
*                                                                  0973 03480000
*       IF TESTRC=4 THEN                                           0973 03481000
         LH    @08,TESTRC                                          0973 03482000
         C     @08,@CF00036                                        0973 03483000
         BNE   @RF00973                                            0973 03484000
*         CC10=LASTCC12;            /*                       @Y30LB34*/ 03485000
*                                                                  0974 03486000
         LA    CC10,12                                             0974 03487000
*       /*************************************************************/ 03488000
*       /*                                                           */ 03489000
*       /* IF VOLUME SERVICES COULD NOT CLOSE A DATA SET     @Y30LB34*/ 03490000
*       /* SET THEN CONDITION CODE TO 4                      @Y30LB34*/ 03491000
*       /*                                                           */ 03492000
*       /*************************************************************/ 03493000
*                                                                  0975 03494000
*       IF TESTRC=8 THEN                                           0975 03495000
@RF00973 CLC   TESTRC(2),@CH00177                                  0975 03496000
         BNE   @RF00975                                            0975 03497000
*         CC10=LASTCC04;            /*                       @Y30LB34*/ 03498000
         LA    CC10,4                                              0976 03499000
*                                                                  0977 03500000
*       /*************************************************************/ 03501000
*       /*                                                           */ 03502000
*       /* RESET VSRES RESERVE BIT OFF.                      @ZA08840*/ 03503000
*       /*                                                           */ 03504000
*       /*************************************************************/ 03505000
*                                                                  0977 03506000
*       VSRES=OFF;                  /*                       @Y30LB34*/ 03507000
*                                                                  0977 03508000
@RF00975 LA    @08,TOVS1AGL                                        0977 03509000
         NI    VSRES(@08),B'01111111'                              0977 03510000
*       /*************************************************************/ 03511000
*       /*                                                           */ 03512000
*       /* IF THE VTOC WAS OPENED BY VOLUME SERVICES,        @Y30LB34*/ 03513000
*       /* CLOSE IT AND RESET IOCSPTR TO ZERO.               @Y30LB34*/ 03514000
*       /*                                                           */ 03515000
*       /*************************************************************/ 03516000
*                                                                  0978 03517000
*       IF VSIOP^=NULLPTR THEN                                     0978 03518000
         L     @15,VSIOP(,@08)                                     0978 03519000
         LTR   @15,@15                                             0978 03520000
         BZ    @RF00978                                            0978 03521000
*         DO;                       /*                       @Y30LB34*/ 03522000
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB34*/ 03523000
         L     @15,@PC00001                                        0980 03524000
         ST    @15,@AL00001                                        0980 03525000
         LA    @08,VSIOP(,@08)                                     0980 03526000
         ST    @08,@AL00001+4                                      0980 03527000
         MVI   @AL00001+4,X'80'                                    0980 03528000
         L     @15,GDTCLS(,@15)                                    0980 03529000
         LA    @01,@AL00001                                        0980 03530000
         BALR  @14,@15                                             0980 03531000
*           RESPECIFY                                              0981 03532000
*             RTNREG RSTD;                                         0981 03533000
*           TESTRC=RTNREG;                                         0982 03534000
         STH   RTNREG,TESTRC                                       0982 03535000
*           RESPECIFY                                              0983 03536000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 03537000
*           VSIOP=NULLPTR;          /*                       @Y30LB34*/ 03538000
         LA    @08,TOVS1AGL                                        0984 03539000
         SLR   @15,@15                                             0984 03540000
         ST    @15,VSIOP(,@08)                                     0984 03541000
*           CC10=MAX(CC10,TESTRC);  /*                       @Y30LB34*/ 03542000
         LH    @08,TESTRC                                          0985 03543000
         CR    CC10,@08                                            0985 03544000
         BNL   *+6                                                      03545000
         LR    CC10,@08                                            0985 03546000
*         END;                      /*                       @Y30LB34*/ 03547000
*                                                                  0986 03548000
*       /*************************************************************/ 03549000
*       /*                                                           */ 03550000
*       /* IF THE EMPTY VTOC CHECK WAS SUCCESSFUL, CALL      @Y30LB34*/ 03551000
*       /* VOLUME SERVICES TO RETRIEVE THE VOLUME'S          @Y30LB34*/ 03552000
*       /* ALTERNATE TRACK INFORMATION TO BE SAVED AND       @Y30LB34*/ 03553000
*       /* RESTORED AFTER THE CONVERSION.                    @Y30LB34*/ 03554000
*       /*                                                           */ 03555000
*       /*************************************************************/ 03556000
*                                                                  0987 03557000
*       IF CC10<LASTCC12 THEN                                      0987 03558000
@RF00978 C     CC10,@CF00567                                       0987 03559000
         BNL   @RF00987                                            0987 03560000
*         DO;                       /*                       @Y30LB34*/ 03561000
*           CALL IDCSACL0(GDTTBL,'IDCVS01 ',GETVTOC,VS1AGL);/*     0989 03562000
*                                                            @Y30LB34*/ 03563000
         L     @08,@PC00001                                        0989 03564000
         ST    @08,@AL00001                                        0989 03565000
         LA    @15,@CC01720                                        0989 03566000
         ST    @15,@AL00001+4                                      0989 03567000
         LA    @15,GETVTOC                                         0989 03568000
         ST    @15,@AL00001+8                                      0989 03569000
         LA    @15,TOVS1AGL                                        0989 03570000
         ST    @15,@AL00001+12                                     0989 03571000
         MVI   @AL00001+12,X'80'                                   0989 03572000
         L     @15,GDTCAL(,@08)                                    0989 03573000
         LA    @01,@AL00001                                        0989 03574000
         BALR  @14,@15                                             0989 03575000
*           RESPECIFY                                              0990 03576000
*             RTNREG RSTD;                                         0990 03577000
*           TESTRC=RTNREG;                                         0991 03578000
         STH   RTNREG,TESTRC                                       0991 03579000
*           RESPECIFY                                              0992 03580000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 03581000
*                                                                  0992 03582000
*           /*********************************************************/ 03583000
*           /*                                                       */ 03584000
*           /* IF NO SERVICE WAS PERFORMED, RESET            @Y30LB34*/ 03585000
*           /* CONDITION CODE TO 12.                         @Y30LB34*/ 03586000
*           /*                                                       */ 03587000
*           /*********************************************************/ 03588000
*                                                                  0993 03589000
*           IF TESTRC>0 THEN                                       0993 03590000
         LH    @08,TESTRC                                          0993 03591000
         LTR   @08,@08                                             0993 03592000
         BNP   @RF00993                                            0993 03593000
*             CC10=LASTCC12;        /*                       @Y30LB34*/ 03594000
         LA    CC10,12                                             0994 03595000
*         END;                      /*                       @Y30LB34*/ 03596000
@RF00993 DS    0H                                                  0996 03597000
*                                                                  0996 03598000
*       /*************************************************************/ 03599000
*       /*                                                           */ 03600000
*       /* IF THE VTOC WAS OPENED BY VOLUME SERVICES,        @Y30LB34*/ 03601000
*       /* CLOSE IT AND RESET IOCSPTR TO ZERO.               @Y30LB34*/ 03602000
*       /*                                                           */ 03603000
*       /*************************************************************/ 03604000
*                                                                  0996 03605000
*       IF VSIOP^=NULLPTR THEN                                     0996 03606000
@RF00987 LA    @08,TOVS1AGL                                        0996 03607000
         L     @15,VSIOP(,@08)                                     0996 03608000
         LTR   @15,@15                                             0996 03609000
         BZ    @RF00996                                            0996 03610000
*         DO;                       /*                       @Y30LB34*/ 03611000
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB34*/ 03612000
         L     @15,@PC00001                                        0998 03613000
         ST    @15,@AL00001                                        0998 03614000
         LA    @08,VSIOP(,@08)                                     0998 03615000
         ST    @08,@AL00001+4                                      0998 03616000
         MVI   @AL00001+4,X'80'                                    0998 03617000
         L     @15,GDTCLS(,@15)                                    0998 03618000
         LA    @01,@AL00001                                        0998 03619000
         BALR  @14,@15                                             0998 03620000
*           RESPECIFY                                              0999 03621000
*             RTNREG RSTD;                                         0999 03622000
*           TESTRC=RTNREG;                                         1000 03623000
         STH   RTNREG,TESTRC                                       1000 03624000
*           RESPECIFY                                              1001 03625000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 03626000
*           VSIOP=NULLPTR;          /*                       @Y30LB34*/ 03627000
         LA    @08,TOVS1AGL                                        1002 03628000
         SLR   @15,@15                                             1002 03629000
         ST    @15,VSIOP(,@08)                                     1002 03630000
*           CC10=MAX(CC10,TESTRC);  /*                       @Y30LB34*/ 03631000
         LH    @08,TESTRC                                          1003 03632000
         CR    CC10,@08                                            1003 03633000
         BNL   *+6                                                      03634000
         LR    CC10,@08                                            1003 03635000
*         END;                      /*                       @Y30LB34*/ 03636000
*     END;                          /*                       @Y30LB34*/ 03637000
*                                                                  1005 03638000
@RF00996 DS    0H                                                  1006 03639000
*   /*****************************************************************/ 03640000
*   /*                                                               */ 03641000
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/ 03642000
*   /* RETURN TO CALLER                                      #Y30LB34*/ 03643000
*   /*                                                               */ 03644000
*   /*****************************************************************/ 03645000
*                                                                  1006 03646000
*   REG14=RTNREG3;                  /*                       #Y30LB34*/ 03647000
@RF00962 L     REG14,RTNREG3                                       1006 03648000
*   RETURN CODE(CC10);              /*                       #Y30LB34*/ 03649000
         LR    @15,CC10                                            1007 03650000
@EL00011 DS    0H                                                  1007 03651000
@EF00011 DS    0H                                                  1007 03652000
@ER00011 BR    @14                                                 1007 03653000
*   END CHEKTARG;                   /*                       #Y30LB34*/ 03654000
*                                                                  1009 03655000
*/********************************************************** #Y30LB34*/ 03656000
*/*                                                          #Y30LB34*/ 03657000
*/* PROCEDURE NAME - RVMOVE                                  #Y30LB34*/ 03658000
*/*                                                          #Y30LB34*/ 03659000
*/* FUNCTION - CONTROLS THE DATA CONVERSION PROCESS WHICH    #Y30LB34*/ 03660000
*/*            CONSISTS OF THREE OPERATIONS:                 #Y30LB34*/ 03661000
*/*                1)  COPY VOLUME,                          #Y30LB34*/ 03662000
*/*                2)  UPDATE TARGET VOLUME VTOC,            #Y30LB34*/ 03663000
*/*                3)  RECATALOG DATA SETS.  (THIS IS ONLY   @Y30LB34*/ 03664000
*/*                    ESSENTIAL FOR VSAM VOLUMES.)          @Y30LB34*/ 03665000
*/*                     IF ANY OF THESE OPERATIONS IS NOT    @Y30LB34*/ 03666000
*/*                     COMPLETED, PRINTS MESSAGE IDC0737I   @Y30LB34*/ 03667000
*/*                     TO NOTIFY TERMINATION OF PROCESSING  @Y30LB34*/ 03668000
*/*                                                          @Y30LB34*/ 03669000
*/*            CALLS RVMOVDAT TO COPY THE DATA FROM REAL TO  @Y30LB34*/ 03670000
*/*            VIRTUAL                                       @Y30LB34*/ 03671000
*/*                                                          @Y30LB34*/ 03672000
*/*            MOUNTS THE MSS TARGET VOLUME AND CALLS        @Y30LB34*/ 03673000
*/*            UPDVTOC TO UPDATE THE VTOC                    @Y30LB34*/ 03674000
*/*                                                          @Y30LB34*/ 03675000
*/*            CALLS RECATCTL TO DETERMINE WHAT RECATALOGING @Y30LB34*/ 03676000
*/*            IS TO BE DONE AND REQUESTS VSAM RECATALOGING  @Y30LB34*/ 03677000
*/*            IF NECESSARY                                  @Y30LB34*/ 03678000
*/*                                                          @Y30LB34*/ 03679000
*/*            CALLS RVCLEAR TO CLEAR RECOVERY FLAGS AT THE  @Y30LB34*/ 03680000
*/*            APPROPRIATE TIME                              @Y30LB34*/ 03681000
*/*                                                          @Y30LB34*/ 03682000
*/*            IF NON-VSAM RECATALOGING IS TO BE DONE,       @Y30LB34*/ 03683000
*/*            REQUESTS VOLUME SERVICES TO RECATALOG NON-    @Y30LB34*/ 03684000
*/*            VSAM DATA SETS NOT ALREADY RECATALOGED        @Y30LB34*/ 03685000
*/*                PRINTS MESSAGE IDC0748I NOTIFYING         @Y30LB34*/ 03686000
*/*                NON-VSAM DATA SETS RECATALOGED            @Y30LB34*/ 03687000
*/*                                                          @Y30LB34*/ 03688000
*/*            DEQUEUES TARGET VOLUME RESERVED IN UPDVTOC    @Y30LB34*/ 03689000
*/*                                                          @Y30LB34*/ 03690000
*/*            DEMOUNTS TARGET VOLUME IF VOLSERS ARE EQUAL   @Y30LB34*/ 03691000
*/*                                                          @Y30LB34*/ 03692000
*/*            DEQUEUES TARGET VOLUME ENQUEUED IN RVINITTA   @Y30LB34*/ 03693000
*/*                                                          @Y30LB34*/ 03694000
*/* INPUT - SAMESER, MDAGL, PUAGL, VS1AGL, TARGAREA          @Y30LB34*/ 03695000
*/*                                                          @Y30LB34*/ 03696000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 03697000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 03698000
*/*           R. C. =  4, RETURN CODE FROM UPDVTOC           @Y30LB34*/ 03699000
*/*           R. C. =  8, RETURN CODE FROM UPDVTOC,          @Y30LB34*/ 03700000
*/*                       UNABLE TO RECATALOG NON-VSAM DATA  @Y30LB34*/ 03701000
*/*                       SETS,                              @Y30LB34*/ 03702000
*/*                       UNABLE TO MOUNT VOLUME,            @Y30LB34*/ 03703000
*/*                       UNABLE TO DEMOUNT VOLUME           @Y30LB34*/ 03704000
*/*           R. C. = 12, RETURN CODE FROM RVMOVDAT,         @Y30LB34*/ 03705000
*/*                       UPDVTOC, RVCLEAR, OR RECATCTL      @Y30LB34*/ 03706000
*/*                       UNABLE TO MOUNT VOLUME             @Y30LB34*/ 03707000
*/*                                                          @Y30LB34*/ 03708000
*/********************************************************** @Y30LB34*/ 03709000
*                                                                  1009 03710000
*RVMOVE:                                                           1009 03711000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 03712000
*                                                                  1009 03713000
RVMOVE   DS    0H                                                  1010 03714000
*   /*****************************************************************/ 03715000
*   /*                                                               */ 03716000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 03717000
*   /*                                                               */ 03718000
*   /*****************************************************************/ 03719000
*                                                                  1010 03720000
*   DCL                                                            1010 03721000
*     CC11 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   03722000
*                                      CODE SAVE AREA        @Y30LB34*/ 03723000
*                                                                  1011 03724000
*   /*****************************************************************/ 03725000
*   /*                                                               */ 03726000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 03727000
*   /*                                                               */ 03728000
*   /*****************************************************************/ 03729000
*                                                                  1011 03730000
*   OLDERID2=NEWERID2;                                             1011 03731000
         L     @11,@PC00001                                        1011 03732000
         L     @11,GDTTR2(,@11)                                    1011 03733000
         MVC   @TS00001(95),NEWERID2(@11)                          1011 03734000
         MVC   OLDERID2(95,@11),@TS00001                           1011 03735000
*   NEWID2='CNTB';                  /*                       @Y30LB34*/ 03736000
*                                                                  1012 03737000
         MVC   NEWID2(4,@11),@CC01747                              1012 03738000
*   /*****************************************************************/ 03739000
*   /*                                                               */ 03740000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 03741000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 03742000
*   /*                                                               */ 03743000
*   /*****************************************************************/ 03744000
*                                                                  1013 03745000
*   CC11=LASTCC00;                  /*                       @Y30LB34*/ 03746000
         SLR   CC11,CC11                                           1013 03747000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 03748000
*                                                                  1014 03749000
         LR    RTNREG2,REG14                                       1014 03750000
*   /*****************************************************************/ 03751000
*   /*                                                               */ 03752000
*   /* CALL RVMOVDAT TO COPY THE DATA FROM THE REAL VOLUME   @Y30LB34*/ 03753000
*   /* TO THE MSS VOLUME                                     @Y30LB34*/ 03754000
*   /*                                                               */ 03755000
*   /*****************************************************************/ 03756000
*                                                                  1015 03757000
*   CALL RVMOVDAT;                  /*                       @Y30LB34*/ 03758000
         BAL   @14,RVMOVDAT                                        1015 03759000
*   RESPECIFY                                                      1016 03760000
*     RTNREG RSTD;                                                 1016 03761000
*   TESTRC=RTNREG;                                                 1017 03762000
         STH   RTNREG,TESTRC                                       1017 03763000
*   RESPECIFY                                                      1018 03764000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 03765000
*   CC11=TESTRC;                    /*                       @Y30LB34*/ 03766000
         LH    @15,TESTRC                                          1019 03767000
         LR    CC11,@15                                            1019 03768000
*                                                                  1020 03769000
*   /*****************************************************************/ 03770000
*   /*                                                               */ 03771000
*   /* IF NO SEVERE ERROR OCCURRED IN RVMOVDAT, DETERMINE    @Y30LB34*/ 03772000
*   /* IF RECOVERY FLAG CAN BE CLEARED                       @Y30LB34*/ 03773000
*   /*                                                               */ 03774000
*   /*****************************************************************/ 03775000
*                                                                  1020 03776000
*   IF CC11<LASTCC12 THEN                                          1020 03777000
         C     CC11,@CF00567                                       1020 03778000
         BNL   @RF01020                                            1020 03779000
*     DO;                           /*                       @Y30LB34*/ 03780000
*                                                                  1021 03781000
*       /*************************************************************/ 03782000
*       /*                                                           */ 03783000
*       /* IF THE VOLUME IS NOT VSAM AND NO SERIAL NUMBER    @Y30LB34*/ 03784000
*       /* UPDATING NEEDS TO BE DONE, CALL RVCLEAR TO        @Y30LB34*/ 03785000
*       /* CLEAR THE RECOVERY FLAG                           @Y30LB34*/ 03786000
*       /*                                                           */ 03787000
*       /*************************************************************/ 03788000
*                                                                  1022 03789000
*       RESPECIFY                                                  1022 03790000
*         VS1AGL BASED(ADDR(FRVS1AGL));/*                    @Y30LB34*/ 03791000
*       IF SAMESER=ON&VSVSAM=OFF THEN                              1023 03792000
         TM    SAMESER,B'10000000'                                 1023 03793000
         BNO   @RF01023                                            1023 03794000
         LA    @11,FRVS1AGL                                        1023 03795000
         TM    VSVSAM(@11),B'10000000'                             1023 03796000
         BNZ   @RF01023                                            1023 03797000
*         DO;                       /*                       @Y30LB34*/ 03798000
*           CALL RVCLEAR;           /*                       @Y30LB34*/ 03799000
         BAL   @14,RVCLEAR                                         1025 03800000
*           RESPECIFY                                              1026 03801000
*             RTNREG RSTD;                                         1026 03802000
*           TESTRC=RTNREG;                                         1027 03803000
         STH   RTNREG,TESTRC                                       1027 03804000
*           RESPECIFY                                              1028 03805000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 03806000
*           CC11=MAX(CC11,TESTRC);  /*                       @Y30LB34*/ 03807000
         LH    @11,TESTRC                                          1029 03808000
         CR    CC11,@11                                            1029 03809000
         BNL   *+6                                                      03810000
         LR    CC11,@11                                            1029 03811000
*         END;                      /*                       @Y30LB34*/ 03812000
*     END;                          /*                       @Y30LB34*/ 03813000
*                                                                  1031 03814000
@RF01023 DS    0H                                                  1032 03815000
*   /*****************************************************************/ 03816000
*   /*                                                               */ 03817000
*   /* IF NO SEVERE ERROR HAS OCCURRED, MOUNT THE TARGET     @Y30LB34*/ 03818000
*   /* VOLUME. IF THE SOURCE AND TARGET VOLSERS ARE          @Y30LB34*/ 03819000
*   /* EQUAL, CLEAR THE SOURCE UCB BEFORE MOUNT.             @Y30LB34*/ 03820000
*   /*                                                               */ 03821000
*   /*****************************************************************/ 03822000
*                                                                  1032 03823000
*   IF CC11<LASTCC12 THEN                                          1032 03824000
@RF01020 C     CC11,@CF00567                                       1032 03825000
         BNL   @RF01032                                            1032 03826000
*     DO;                           /*                       @Y30LB34*/ 03827000
*       IF SAMESER=ON THEN                                         1034 03828000
         TM    SAMESER,B'10000000'                                 1034 03829000
         BNO   @RF01034                                            1034 03830000
*         MDCLEAR=ON;               /*                       @Y30LB34*/ 03831000
         LA    @11,MDAGLAR                                         1035 03832000
         OI    MDCLEAR(@11),B'01000000'                            1035 03833000
*       CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                 @Y30LB34*/ 03834000
@RF01034 L     @11,@PC00001                                        1036 03835000
         ST    @11,@AL00001                                        1036 03836000
         LA    @15,MOUNT                                           1036 03837000
         ST    @15,@AL00001+4                                      1036 03838000
         LA    @15,MDAGLAR                                         1036 03839000
         ST    @15,@AL00001+8                                      1036 03840000
         MVI   @AL00001+8,X'80'                                    1036 03841000
         L     @15,GDTUNT(,@11)                                    1036 03842000
         LA    @01,@AL00001                                        1036 03843000
         BALR  @14,@15                                             1036 03844000
*       RESPECIFY                                                  1037 03845000
*         RTNREG RSTD;                                             1037 03846000
*       TESTRC=RTNREG;                                             1038 03847000
         STH   RTNREG,TESTRC                                       1038 03848000
*       RESPECIFY                                                  1039 03849000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 03850000
*       MDCLEAR=OFF;                /*                       @Y30LB34*/ 03851000
         LA    @11,MDAGLAR                                         1040 03852000
         NI    MDCLEAR(@11),B'10111111'                            1040 03853000
*                                                                  1041 03854000
*       /*************************************************************/ 03855000
*       /*                                                           */ 03856000
*       /* IF THE MOUNT IS UNSUCCESSFUL, SET AN              @Y30LB34*/ 03857000
*       /* APPROPRIATE CONDITION CODE                        @Y30LB34*/ 03858000
*       /*                                                           */ 03859000
*       /*************************************************************/ 03860000
*                                                                  1041 03861000
*       IF TESTRC>0 THEN                                           1041 03862000
         LH    @11,TESTRC                                          1041 03863000
         LTR   @11,@11                                             1041 03864000
         BNP   @RF01041                                            1041 03865000
*         DO;                       /*                       @Y30LB34*/ 03866000
*                                                                  1042 03867000
*           /*********************************************************/ 03868000
*           /*                                                       */ 03869000
*           /* IF THE SERIAL NUMBER DOES NOT HAVE TO         @Y30LB34*/ 03870000
*           /* BE UPDATED AND NO VSAM RECATALOGING           @Y30LB34*/ 03871000
*           /* IS NECESSARY, THE MAJOR FUNCTION IS           @Y30LB34*/ 03872000
*           /* COMPLETE                                      @Y30LB34*/ 03873000
*           /*                                                       */ 03874000
*           /*********************************************************/ 03875000
*                                                                  1043 03876000
*           IF SAMESER=ON&VSVSAM=OFF THEN                          1043 03877000
         TM    SAMESER,B'10000000'                                 1043 03878000
         BNO   @RF01043                                            1043 03879000
         LA    @15,FRVS1AGL                                        1043 03880000
         TM    VSVSAM(@15),B'10000000'                             1043 03881000
         BNZ   @RF01043                                            1043 03882000
*             DO;                   /*                       @Y30LB34*/ 03883000
*               CC11=LASTCC08;      /*                       @Y30LB34*/ 03884000
         LA    CC11,8                                              1045 03885000
*               MSGSW=ON;           /*                       @Y30LB34*/ 03886000
         OI    MSGSW,B'00001000'                                   1046 03887000
*             END;                  /*                       @Y30LB34*/ 03888000
*                                                                  1047 03889000
*           /*********************************************************/ 03890000
*           /*                                                       */ 03891000
*           /* THE MAJOR FUNCTION IS NOT COMPLETE            @Y30LB34*/ 03892000
*           /*                                                       */ 03893000
*           /*********************************************************/ 03894000
*                                                                  1048 03895000
*           ELSE                                                   1048 03896000
*             CC11=LASTCC12;        /*                       @Y30LB34*/ 03897000
         B     @RC01043                                            1048 03898000
@RF01043 LA    CC11,12                                             1048 03899000
*         END;                      /*                       @Y30LB34*/ 03900000
*                                                                  1050 03901000
*       /*************************************************************/ 03902000
*       /*                                                           */ 03903000
*       /* IF UMSSUNIT HAS MOUNTED THE MSS VOLUME,           @Y30LB34*/ 03904000
*       /* CONTINUE PROCESSING.                              @Y30LB34*/ 03905000
*       /*                                                           */ 03906000
*       /*************************************************************/ 03907000
*                                                                  1050 03908000
*       ELSE                                                       1050 03909000
*         DO;                       /*                       @Y30LB34*/ 03910000
*                                                                  1050 03911000
         B     @RC01041                                            1050 03912000
@RF01041 DS    0H                                                  1051 03913000
*           /*********************************************************/ 03914000
*           /*                                                       */ 03915000
*           /* CALL UPDVTOC TO UPDATE THE TARGET VOLUME VTOC @Y30LB34*/ 03916000
*           /*                                                       */ 03917000
*           /*********************************************************/ 03918000
*                                                                  1051 03919000
*           CALL UPDVTOC;           /*                       @Y30LB34*/ 03920000
         BAL   @14,UPDVTOC                                         1051 03921000
*           RESPECIFY                                              1052 03922000
*             RTNREG RSTD;                                         1052 03923000
*           TESTRC=RTNREG;                                         1053 03924000
         STH   RTNREG,TESTRC                                       1053 03925000
*           RESPECIFY                                              1054 03926000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 03927000
*           CC11=MAX(CC11,TESTRC);  /*                       @Y30LB34*/ 03928000
*                                                                  1055 03929000
         LH    @11,TESTRC                                          1055 03930000
         CR    CC11,@11                                            1055 03931000
         BNL   *+6                                                      03932000
         LR    CC11,@11                                            1055 03933000
*           /*********************************************************/ 03934000
*           /*                                                       */ 03935000
*           /* IF NO SEVERE ERROR OCCURRED IN UPDVTOC,       @Y30LB34*/ 03936000
*           /* DETERMINE IF THE RECOVERY FLAG CAN BE CLEARED @Y30LB34*/ 03937000
*           /*                                                       */ 03938000
*           /*********************************************************/ 03939000
*                                                                  1056 03940000
*           IF CC11<LASTCC12 THEN                                  1056 03941000
         C     CC11,@CF00567                                       1056 03942000
         BNL   @RF01056                                            1056 03943000
*             DO;                   /*                       @Y30LB34*/ 03944000
*                                                                  1057 03945000
*               /*****************************************************/ 03946000
*               /*                                                   */ 03947000
*               /* IF THE VOLUME IS NOT VSAM AND THE SERIAL  @Y30LB34*/ 03948000
*               /* NUMBER HAS BEEN UPDATED, CALL RVCLEAR TO  @Y30LB34*/ 03949000
*               /* CLEAR THE RECOVERY FLAG                   @Y30LB34*/ 03950000
*               /*                                                   */ 03951000
*               /*****************************************************/ 03952000
*                                                                  1058 03953000
*               IF SAMESER=OFF&VSVSAM=OFF THEN                     1058 03954000
         TM    SAMESER,B'10000000'                                 1058 03955000
         BNZ   @RF01058                                            1058 03956000
         LA    @11,FRVS1AGL                                        1058 03957000
         TM    VSVSAM(@11),B'10000000'                             1058 03958000
         BNZ   @RF01058                                            1058 03959000
*                 DO;               /*                       @Y30LB34*/ 03960000
*                   CALL RVCLEAR;   /*                       @Y30LB34*/ 03961000
         BAL   @14,RVCLEAR                                         1060 03962000
*                   RESPECIFY                                      1061 03963000
*                     RTNREG RSTD;                                 1061 03964000
*                   TESTRC=RTNREG;                                 1062 03965000
         STH   RTNREG,TESTRC                                       1062 03966000
*                   RESPECIFY                                      1063 03967000
*                     RTNREG UNRSTD;/*                       @Y30LB34*/ 03968000
*                   CC11=MAX(CC11,TESTRC);/*                 @Y30LB34*/ 03969000
         LH    @11,TESTRC                                          1064 03970000
         CR    CC11,@11                                            1064 03971000
         BNL   *+6                                                      03972000
         LR    CC11,@11                                            1064 03973000
*                 END;              /*                       @Y30LB34*/ 03974000
*             END;                  /*                       @Y30LB34*/ 03975000
@RF01058 DS    0H                                                  1067 03976000
*                                                                  1067 03977000
*           /*********************************************************/ 03978000
*           /*                                                       */ 03979000
*           /* IF NO SEVERE ERROR HAS OCCURRED, CALL         @Y30LB34*/ 03980000
*           /* RECATCTL TO CONTROL THE RECATALOGING TO BE    @Y30LB34*/ 03981000
*           /* DONE                                          @Y30LB34*/ 03982000
*           /*                                                       */ 03983000
*           /*********************************************************/ 03984000
*                                                                  1067 03985000
*           IF CC11<LASTCC12 THEN                                  1067 03986000
@RF01056 C     CC11,@CF00567                                       1067 03987000
         BNL   @RF01067                                            1067 03988000
*             DO;                   /*                       @Y30LB34*/ 03989000
*               CALL RECATCTL;      /*                       @Y30LB34*/ 03990000
         BAL   @14,RECATCTL                                        1069 03991000
*               RESPECIFY                                          1070 03992000
*                 RTNREG RSTD;                                     1070 03993000
*               TESTRC=RTNREG;                                     1071 03994000
         STH   RTNREG,TESTRC                                       1071 03995000
*               RESPECIFY                                          1072 03996000
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/ 03997000
*               CC11=MAX(CC11,TESTRC);/*                     @Y30LB34*/ 03998000
         LH    @11,TESTRC                                          1073 03999000
         CR    CC11,@11                                            1073 04000000
         BNL   *+6                                                      04001000
         LR    CC11,@11                                            1073 04002000
*             END;                  /*                       @Y30LB34*/ 04003000
*                                                                  1074 04004000
*           /*********************************************************/ 04005000
*           /*                                                       */ 04006000
*           /* IF NO SEVERE ERROR HAS OCCURRED AND IF THE    @Y30LB34*/ 04007000
*           /* VOLUME IS VSAM, CALL RVCLEAR TO CLEAR         @Y30LB34*/ 04008000
*           /* THE RECOVERY FLAG.                            @Y30LB34*/ 04009000
*           /*                                                       */ 04010000
*           /*********************************************************/ 04011000
*                                                                  1075 04012000
*           IF CC11<LASTCC12&VSVSAM=ON THEN                        1075 04013000
@RF01067 C     CC11,@CF00567                                       1075 04014000
         BNL   @RF01075                                            1075 04015000
         LA    @11,FRVS1AGL                                        1075 04016000
         TM    VSVSAM(@11),B'10000000'                             1075 04017000
         BNO   @RF01075                                            1075 04018000
*             DO;                   /*                       @Y30LB34*/ 04019000
*               CALL RVCLEAR;       /*                       @Y30LB34*/ 04020000
         BAL   @14,RVCLEAR                                         1077 04021000
*               RESPECIFY                                          1078 04022000
*                 RTNREG RSTD;                                     1078 04023000
*               TESTRC=RTNREG;                                     1079 04024000
         STH   RTNREG,TESTRC                                       1079 04025000
*               RESPECIFY                                          1080 04026000
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/ 04027000
*               CC11=MAX(CC11,TESTRC);/*                     @Y30LB34*/ 04028000
         LH    @11,TESTRC                                          1081 04029000
         CR    CC11,@11                                            1081 04030000
         BNL   *+6                                                      04031000
         LR    CC11,@11                                            1081 04032000
*             END;                  /*                       @Y30LB34*/ 04033000
*                                                                  1083 04034000
*           /*********************************************************/ 04035000
*           /*                                                       */ 04036000
*           /* IF NO SEVERE ERROR HAS OCCURRED AND THE NON-  @Y30LB34*/ 04037000
*           /* VSAM DATA SETS ARE TO BE RECATALOGED, CALL    @Y30LB34*/ 04038000
*           /* VOLUME SERVICES TO HANDLE IT                  @Y30LB34*/ 04039000
*           /*                                                       */ 04040000
*           /*********************************************************/ 04041000
*                                                                  1083 04042000
*           IF CC11<LASTCC12&NONVSAM=ON THEN                       1083 04043000
@RF01075 C     CC11,@CF00567                                       1083 04044000
         BNL   @RF01083                                            1083 04045000
         TM    NONVSAM,B'00010000'                                 1083 04046000
         BNO   @RF01083                                            1083 04047000
*             DO;                   /*                       @Y30LB34*/ 04048000
*               RESPECIFY                                          1085 04049000
*                 VS1AGL BASED(ADDR(TOVS1AGL));/*            @Y30LB34*/ 04050000
*               CALL IDCSACL0(GDTTBL,'IDCVS01 ',RECATLG,VS1AGL);/* 1086 04051000
*                                                            @YM02865*/ 04052000
         L     @11,@PC00001                                        1086 04053000
         ST    @11,@AL00001                                        1086 04054000
         LA    @15,@CC01720                                        1086 04055000
         ST    @15,@AL00001+4                                      1086 04056000
         LA    @15,RECATLG                                         1086 04057000
         ST    @15,@AL00001+8                                      1086 04058000
         LA    @15,TOVS1AGL                                        1086 04059000
         ST    @15,@AL00001+12                                     1086 04060000
         MVI   @AL00001+12,X'80'                                   1086 04061000
         L     @15,GDTCAL(,@11)                                    1086 04062000
         LA    @01,@AL00001                                        1086 04063000
         BALR  @14,@15                                             1086 04064000
*               RESPECIFY                                          1087 04065000
*                 RTNREG RSTD;                                     1087 04066000
*               TESTRC=RTNREG;                                     1088 04067000
         STH   RTNREG,TESTRC                                       1088 04068000
*               RESPECIFY                                          1089 04069000
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/ 04070000
*                                                                  1089 04071000
*               /*****************************************************/ 04072000
*               /*                                                   */ 04073000
*               /* IF VOLUME SERVICES WAS UNSUCCESSFUL, SET  @Y30LB34*/ 04074000
*               /* CONDITION CODE TO 8.                      @Y30LB34*/ 04075000
*               /*                                                   */ 04076000
*               /*****************************************************/ 04077000
*                                                                  1090 04078000
*               IF TESTRC>0 THEN                                   1090 04079000
         LH    @11,TESTRC                                          1090 04080000
         LTR   @11,@11                                             1090 04081000
         BNP   @RF01090                                            1090 04082000
*                 CC11=LASTCC08;    /*                       @Y30LB34*/ 04083000
*                                                                  1091 04084000
         LA    CC11,8                                              1091 04085000
*               /*****************************************************/ 04086000
*               /*                                                   */ 04087000
*               /* IF VOLUME SERVICES WAS SUCCESSFUL, PRINT  @Y30LB34*/ 04088000
*               /* MESSAGE IDC0748I NOTIFYING THAT NON-VSAM  @Y30LB34*/ 04089000
*               /* DATA SETS ARE RECATALOGED                 @Y30LB34*/ 04090000
*               /*                                                   */ 04091000
*               /*****************************************************/ 04092000
*                                                                  1092 04093000
*               ELSE                                               1092 04094000
*                 DO;               /*                       @Y30LB34*/ 04095000
         B     @RC01090                                            1092 04096000
@RF01090 DS    0H                                                  1093 04097000
*                   DARGSMOD=CONVMSG;/*                      @Y30LB34*/ 04098000
         L     @11,DDSTRU                                          1093 04099000
         MVC   DARGSMOD(3,@11),@CC01557                            1093 04100000
*                   DARGSENT=MSG0748I;/*                     @Y30LB34*/ 04101000
         MVI   DARGSENT(@11),X'0C'                                 1094 04102000
*                   DARGDBP=0;      /*                       @Y30LB34*/ 04103000
         SLR   @15,@15                                             1095 04104000
         ST    @15,DARGDBP(,@11)                                   1095 04105000
*                   DARGILP=0;      /*                       @Y30LB34*/ 04106000
         STH   @15,DARGILP(,@11)                                   1096 04107000
*                   DARGRETP=0;     /*                       @Y30LB34*/ 04108000
         ST    @15,DARGRETP(,@11)                                  1097 04109000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB34*/ 04110000
         L     @11,@PC00001                                        1098 04111000
         ST    @11,@AL00001                                        1098 04112000
         LA    @15,@CF00115                                        1098 04113000
         ST    @15,@AL00001+4                                      1098 04114000
         LA    @15,DDSTRU                                          1098 04115000
         ST    @15,@AL00001+8                                      1098 04116000
         MVI   @AL00001+8,X'80'                                    1098 04117000
         L     @15,GDTPRT(,@11)                                    1098 04118000
         LA    @01,@AL00001                                        1098 04119000
         BALR  @14,@15                                             1098 04120000
*                 END;              /*                       #Y30LB34*/ 04121000
*                                                                  1099 04122000
*               /*****************************************************/ 04123000
*               /*                                                   */ 04124000
*               /* IF THE VTOC WAS OPENED BY VOLUME SERVICES @ZM32896*/ 04125000
*               /* CLOSE IT AND SET THE IOCSTR PTR TO 0.     @ZM32896*/ 04126000
*               /*                                                   */ 04127000
*               /*****************************************************/ 04128000
*                                                                  1100 04129000
*               IF VSIOP^=NULLPTR THEN                             1100 04130000
@RC01090 LA    @11,TOVS1AGL                                        1100 04131000
         L     @15,VSIOP(,@11)                                     1100 04132000
         LTR   @15,@15                                             1100 04133000
         BZ    @RF01100                                            1100 04134000
*                 DO;               /*                       @ZM32896*/ 04135000
*                   CALL IDCIOCL0(GDTTBL,VSIOP);/*           @ZM32896*/ 04136000
         L     @15,@PC00001                                        1102 04137000
         ST    @15,@AL00001                                        1102 04138000
         LA    @11,VSIOP(,@11)                                     1102 04139000
         ST    @11,@AL00001+4                                      1102 04140000
         MVI   @AL00001+4,X'80'                                    1102 04141000
         L     @15,GDTCLS(,@15)                                    1102 04142000
         LA    @01,@AL00001                                        1102 04143000
         BALR  @14,@15                                             1102 04144000
*                   RESPECIFY                                      1103 04145000
*                     RTNREG RSTD;                                 1103 04146000
*                   TESTRC=RTNREG;                                 1104 04147000
         STH   RTNREG,TESTRC                                       1104 04148000
*                   RESPECIFY                                      1105 04149000
*                     RTNREG UNRSTD;/*                       @ZM32896*/ 04150000
*                   CC11=MAX(CC11,TESTRC);/*                 @ZM32896*/ 04151000
         LH    @11,TESTRC                                          1106 04152000
         CR    CC11,@11                                            1106 04153000
         BNL   *+6                                                      04154000
         LR    CC11,@11                                            1106 04155000
*                   VSIOP=NULLPTR;  /*                       @ZM32896*/ 04156000
         LA    @11,TOVS1AGL                                        1107 04157000
         SLR   @15,@15                                             1107 04158000
         ST    @15,VSIOP(,@11)                                     1107 04159000
*                 END;              /*                       @ZM32896*/ 04160000
*             END;                  /*                       #Y30LB34*/ 04161000
@RF01100 DS    0H                                                  1110 04162000
*                                                                  1110 04163000
*           /*********************************************************/ 04164000
*           /*                                                       */ 04165000
*           /* IF THE TARGET VOLUME WAS RESERVED IN UPDVTOC, #Y30LB34*/ 04166000
*           /* RELEASE THAT RESERVE AND SET OFF THE TARGET   #Y30LB34*/ 04167000
*           /* RESERVE BIT                                   #Y30LB34*/ 04168000
*           /*                                                       */ 04169000
*           /*********************************************************/ 04170000
*                                                                  1110 04171000
*           IF TRES=ON THEN                                        1110 04172000
@RF01083 TM    TRES,B'01000000'                                    1110 04173000
         BNO   @RF01110                                            1110 04174000
*             DO;                   /*                       #Y30LB34*/ 04175000
*               CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*       #Y30LB34*/ 04176000
         L     @11,@PC00001                                        1112 04177000
         ST    @11,@AL00001                                        1112 04178000
         LA    @15,@CC01594                                        1112 04179000
         ST    @15,@AL00001+4                                      1112 04180000
         LA    @15,RNAMEVR                                         1112 04181000
         ST    @15,@AL00001+8                                      1112 04182000
         MVI   @AL00001+8,X'80'                                    1112 04183000
         L     @15,GDTDEQ(,@11)                                    1112 04184000
         LA    @01,@AL00001                                        1112 04185000
         BALR  @14,@15                                             1112 04186000
*               TRES=OFF;           /*                       #Y30LB34*/ 04187000
         NI    TRES,B'10111111'                                    1113 04188000
*             END;                  /*                       #Y30LB34*/ 04189000
*                                                                  1114 04190000
*           /*********************************************************/ 04191000
*           /*                                                       */ 04192000
*           /* DEMOUNT THE TARGET VOLUME IF THE SOURCE AND   #Y30LB34*/ 04193000
*           /* TARGET VOLSERS ARE EQUAL. POST THE SOURCE UCB #Y30LB34*/ 04194000
*           /* AFTER DEMOUNT.                                #Y30LB34*/ 04195000
*           /*                                                       */ 04196000
*           /*********************************************************/ 04197000
*                                                                  1115 04198000
*           IF SAMESER=ON THEN                                     1115 04199000
@RF01110 TM    SAMESER,B'10000000'                                 1115 04200000
         BNO   @RF01115                                            1115 04201000
*             DO;                   /*                       #Y30LB34*/ 04202000
*               MDPOST=ON;          /*                       #Y30LB34*/ 04203000
*               MDWAIT=ON;          /*                       #Y30LB34*/ 04204000
         LA    @11,MDAGLAR                                         1118 04205000
         OI    MDPOST(@11),B'00110000'                             1118 04206000
*               CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*       #Y30LB34*/ 04207000
         L     @15,@PC00001                                        1119 04208000
         ST    @15,@AL00001                                        1119 04209000
         LA    @14,DEMOUNT                                         1119 04210000
         ST    @14,@AL00001+4                                      1119 04211000
         ST    @11,@AL00001+8                                      1119 04212000
         MVI   @AL00001+8,X'80'                                    1119 04213000
         L     @15,GDTUNT(,@15)                                    1119 04214000
         LA    @01,@AL00001                                        1119 04215000
         BALR  @14,@15                                             1119 04216000
*               RESPECIFY                                          1120 04217000
*                 RTNREG RSTD;                                     1120 04218000
*               TESTRC=RTNREG;                                     1121 04219000
         STH   RTNREG,TESTRC                                       1121 04220000
*               RESPECIFY                                          1122 04221000
*                 RTNREG UNRSTD;    /*                       @Y30LB34*/ 04222000
*                                                                  1123 04223000
*               /*****************************************************/ 04224000
*               /*                                                   */ 04225000
*               /* IF UMSSUNIT IS UNSUCCESSFUL SET           @Y30LB34*/ 04226000
*               /* APPROPRIATE CONDITION CODE                @Y30LB34*/ 04227000
*               /*                                                   */ 04228000
*               /*****************************************************/ 04229000
*                                                                  1123 04230000
*               IF TESTRC>0 THEN                                   1123 04231000
         LH    @11,TESTRC                                          1123 04232000
         SLR   @15,@15                                             1123 04233000
         CR    @11,@15                                             1123 04234000
         BNH   @RF01123                                            1123 04235000
*                 DO;               /*                       @Y30LB34*/ 04236000
*                                                                  1124 04237000
*                   /*************************************************/ 04238000
*                   /*                                               */ 04239000
*                   /* IF 'NOSCRATCH' WAS SPECIFIED ALL      @Y30LB34*/ 04240000
*                   /* FUNCTION IS COMPLETE                  @Y30LB34*/ 04241000
*                   /*                                               */ 04242000
*                   /*************************************************/ 04243000
*                                                                  1125 04244000
*                   IF ADDR(NSCR)^=NULLPTR THEN                    1125 04245000
         L     @11,@PC00001+4                                      1125 04246000
         C     @15,FDTPTR+36(,@11)                                 1125 04247000
         BE    @RF01125                                            1125 04248000
*                     CC11=MAX(CC11,LASTCC04);/*             @Y30LB34*/ 04249000
*                                                                  1126 04250000
         LA    @11,4                                               1126 04251000
         CR    CC11,@11                                            1126 04252000
         BNL   *+6                                                      04253000
         LR    CC11,@11                                            1126 04254000
*                   /*************************************************/ 04255000
*                   /*                                               */ 04256000
*                   /* IF SOURCE VOLUME WAS TO BE SCRATCHED, @Y30LB34*/ 04257000
*                   /* MAJOR FUNCTION MAY BE COMPLETE. END   @Y30LB34*/ 04258000
*                   /* WITH CONDITION CODE OF 8 OR GREATER   @Y30LB34*/ 04259000
*                   /*                                               */ 04260000
*                   /*************************************************/ 04261000
*                                                                  1127 04262000
*                   ELSE                                           1127 04263000
*                     CC11=MAX(CC11,LASTCC08);/*             @Y30LB34*/ 04264000
         B     @RC01125                                            1127 04265000
@RF01125 LA    @11,8                                               1127 04266000
         CR    CC11,@11                                            1127 04267000
         BNL   *+6                                                      04268000
         LR    CC11,@11                                            1127 04269000
*                 END;              /*                       @Y30LB34*/ 04270000
*                                                                  1128 04271000
@RC01125 DS    0H                                                  1129 04272000
*               /*****************************************************/ 04273000
*               /*                                                   */ 04274000
*               /* SET OFF POST AND WAIT BITS                @Y30LB34*/ 04275000
*               /*                                                   */ 04276000
*               /*****************************************************/ 04277000
*                                                                  1129 04278000
*               MDPOST=OFF;         /*                       @Y30LB34*/ 04279000
@RF01123 DS    0H                                                  1130 04280000
*               MDWAIT=OFF;         /*                       @Y30LB34*/ 04281000
         LA    @11,MDAGLAR                                         1130 04282000
         NI    MDPOST(@11),B'11001111'                             1130 04283000
*             END;                  /*                       @Y30LB34*/ 04284000
*         END;                      /*                       @Y30LB34*/ 04285000
@RF01115 DS    0H                                                  1133 04286000
*     END;                          /*                       @Y30LB34*/ 04287000
@RC01041 DS    0H                                                  1134 04288000
*                                                                  1134 04289000
*   /*****************************************************************/ 04290000
*   /*                                                               */ 04291000
*   /* IF A SEVERE ERROR OCCURRED DURING THIS PROCEDURE      @Y30LB34*/ 04292000
*   /* PRINT MESSAGE IDC0737I TO NOTIFY WHERE PROCESSING     @Y30LB34*/ 04293000
*   /* TERMINATED                                            @Y30LB34*/ 04294000
*   /*                                                               */ 04295000
*   /*****************************************************************/ 04296000
*                                                                  1134 04297000
*   IF(CC11=LASTCC12)|MSGSW=ON THEN                                1134 04298000
@RF01032 C     CC11,@CF00567                                       1134 04299000
         BE    @RT01134                                            1134 04300000
         TM    MSGSW,B'00001000'                                   1134 04301000
         BNO   @RF01134                                            1134 04302000
@RT01134 DS    0H                                                  1135 04303000
*     DO;                           /*                       @Y30LB34*/ 04304000
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/ 04305000
         L     @11,DDSTRU                                          1136 04306000
         MVC   DARGSMOD(3,@11),@CC01557                            1136 04307000
*       DARGSENT=MSG0737I;          /*                       @Y30LB34*/ 04308000
         MVI   DARGSENT(@11),X'02'                                 1137 04309000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 04310000
         SLR   @15,@15                                             1138 04311000
         ST    @15,DARGDBP(,@11)                                   1138 04312000
*       DARGILP=0;                  /*                       @Y30LB34*/ 04313000
         STH   @15,DARGILP(,@11)                                   1139 04314000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 04315000
         ST    @15,DARGRETP(,@11)                                  1140 04316000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 04317000
         L     @11,@PC00001                                        1141 04318000
         ST    @11,@AL00001                                        1141 04319000
         LA    @15,@CF00115                                        1141 04320000
         ST    @15,@AL00001+4                                      1141 04321000
         LA    @15,DDSTRU                                          1141 04322000
         ST    @15,@AL00001+8                                      1141 04323000
         MVI   @AL00001+8,X'80'                                    1141 04324000
         L     @15,GDTPRT(,@11)                                    1141 04325000
         LA    @01,@AL00001                                        1141 04326000
         BALR  @14,@15                                             1141 04327000
*     END;                          /*                       @Y30LB34*/ 04328000
*                                                                  1142 04329000
*   /*****************************************************************/ 04330000
*   /*                                                               */ 04331000
*   /* IF THE TARGET VOLUME WAS ENQUEUED IN RVINITTA,        @Y30LB34*/ 04332000
*   /* RELEASE THAT ENQUEUE AND SET OFF THE TARGET ENQ BIT   @Y30LB34*/ 04333000
*   /*                                                               */ 04334000
*   /*****************************************************************/ 04335000
*                                                                  1143 04336000
*   IF TENQ=ON THEN                                                1143 04337000
@RF01134 TM    TENQ,B'10000000'                                    1143 04338000
         BNO   @RF01143                                            1143 04339000
*     DO;                           /*                       @Y30LB34*/ 04340000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVE);/*               @Y30LB34*/ 04341000
         L     @11,@PC00001                                        1145 04342000
         ST    @11,@AL00001                                        1145 04343000
         LA    @15,@CC01594                                        1145 04344000
         ST    @15,@AL00001+4                                      1145 04345000
         LA    @15,RNAMEVE                                         1145 04346000
         ST    @15,@AL00001+8                                      1145 04347000
         MVI   @AL00001+8,X'80'                                    1145 04348000
         L     @15,GDTDEQ(,@11)                                    1145 04349000
         LA    @01,@AL00001                                        1145 04350000
         BALR  @14,@15                                             1145 04351000
*       TENQ=OFF;                   /*                       @Y30LB34*/ 04352000
         NI    TENQ,B'01111111'                                    1146 04353000
*     END;                          /*                       @Y30LB34*/ 04354000
*                                                                  1147 04355000
*   /*****************************************************************/ 04356000
*   /*                                                               */ 04357000
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/ 04358000
*   /* RETURN TO CALLER                                      #Y30LB34*/ 04359000
*   /*                                                               */ 04360000
*   /*****************************************************************/ 04361000
*                                                                  1148 04362000
*   REG14=RTNREG2;                  /*                       #Y30LB34*/ 04363000
@RF01143 LR    REG14,RTNREG2                                       1148 04364000
*   RETURN CODE(CC11);              /*                       #Y30LB34*/ 04365000
         LR    @15,CC11                                            1149 04366000
@EL00012 DS    0H                                                  1149 04367000
@EF00012 DS    0H                                                  1149 04368000
@ER00012 BR    @14                                                 1149 04369000
*   END RVMOVE;                     /*                       #Y30LB34*/ 04370000
*                                                                  1151 04371000
*/********************************************************** #Y30LB34*/ 04372000
*/*                                                          #Y30LB34*/ 04373000
*/* PROCEDURE NAME - RVMOVDAT                                #Y30LB34*/ 04374000
*/*                                                          #Y30LB34*/ 04375000
*/* FUNCTION - MOVES THE DATA FROM REAL TO VIRTUAL           #Y30LB34*/ 04376000
*/*                                                          @Y30LB34*/ 04377000
*/*            INITIALIZES ICBCOVC PARM LIST FOR DASD TO     @Y30LB34*/ 04378000
*/*            CARTRIDGE                                     @Y30LB34*/ 04379000
*/*                                                          @Y30LB34*/ 04380000
*/*            INITIALIZES IEZCOVCE PARM LIST FOR THE MSVC   @Y30LB34*/ 04381000
*/*            EXTENSION TO ICBCOVC                          @Y30LB34*/ 04382000
*/*                                                          @Y30LB34*/ 04383000
*/*            ISSUES USSC TO ISSUE ICBCOVC TO COPY THE DATA @Y30LB34*/ 04384000
*/*                IF THE COPY COULD NOT START, ISSUES ERROR @Y30LB34*/ 04385000
*/*                MESSAGE IDC3082I,                         @Y30LB34*/ 04386000
*/*                IF THE COPY ENCOUNTERED AN ERROR AFTER IT @Y30LB34*/ 04387000
*/*                PARTIALLY COMPLETED, ISSUES ERROR MESSAGE @Y30LB34*/ 04388000
*/*                IDC3071I,                                 @Y30LB34*/ 04389000
*/*                IF THE COPY WAS SUCCESSFUL, ISSUES        @Y30LB34*/ 04390000
*/*                MESSAGE IDC0743I.                         @Y30LB34*/ 04391000
*/*                                                          @Y30LB34*/ 04392000
*/* INPUT = ICBCOVC, IEZCOVCE, TARGAREA, SRCEAREA, FRVS1AGL, @Y30LB34*/ 04393000
*/*         DARGLIST                                         @Y30LB34*/ 04394000
*/*                                                          @Y30LB34*/ 04395000
*/* OUTPUT - ICBCOVC, IEZCOVCE                               @Y30LB34*/ 04396000
*/*                                                          @Y30LB34*/ 04397000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 04398000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 04399000
*/*           R. C. = 12, UNABLE TO CONVERT VOLUME           @Y30LB34*/ 04400000
*/*                                                          @Y30LB34*/ 04401000
*/********************************************************** @Y30LB34*/ 04402000
*                                                                  1151 04403000
*RVMOVDAT:                                                         1151 04404000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 04405000
*                                                                  1151 04406000
RVMOVDAT DS    0H                                                  1152 04407000
*   /*****************************************************************/ 04408000
*   /*                                                               */ 04409000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 04410000
*   /*                                                               */ 04411000
*   /*****************************************************************/ 04412000
*                                                                  1152 04413000
*   DCL                                                            1152 04414000
*     CC12 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   04415000
*                                      CODE SAVE AREA        @Y30LB34*/ 04416000
*                                                                  1153 04417000
*   /*****************************************************************/ 04418000
*   /*                                                               */ 04419000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 04420000
*   /*                                                               */ 04421000
*   /*****************************************************************/ 04422000
*                                                                  1153 04423000
*   OLDERID2=NEWERID2;                                             1153 04424000
         L     @08,@PC00001                                        1153 04425000
         L     @15,GDTTR2(,@08)                                    1153 04426000
         MVC   @TS00001(95),NEWERID2(@15)                          1153 04427000
         MVC   OLDERID2(95,@15),@TS00001                           1153 04428000
*   NEWID2='CNTC';                  /*                       @Y30LB34*/ 04429000
*                                                                  1154 04430000
         MVC   NEWID2(4,@15),@CC01760                              1154 04431000
*   /*****************************************************************/ 04432000
*   /*                                                               */ 04433000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 04434000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 04435000
*   /*                                                               */ 04436000
*   /*****************************************************************/ 04437000
*                                                                  1155 04438000
*   CC12=LASTCC00;                  /*                       @Y30LB34*/ 04439000
         SLR   CC12,CC12                                           1155 04440000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 04441000
*                                                                  1156 04442000
         ST    REG14,RTNREG3                                       1156 04443000
*   /*****************************************************************/ 04444000
*   /*                                                               */ 04445000
*   /* INITIALIZE THE ICBCOVC PARM LIST                      @Y30LB34*/ 04446000
*   /*                                                               */ 04447000
*   /*****************************************************************/ 04448000
*                                                                  1157 04449000
*   CVODASCR=ON;                    /*                       @Y30LB34*/ 04450000
         L     @15,CVOLPTR                                         1157 04451000
         OI    CVODASCR(@15),B'10000000'                           1157 04452000
*   CVOLRUA=SUNITADR;               /*                       @Y30LB34*/ 04453000
         LH    @14,SUNITADR                                        1158 04454000
         STH   @14,CVOLRUA(,@15)                                   1158 04455000
*   CVOLID=TVOLSER;                 /*                       @Y30LB34*/ 04456000
         MVC   CVOLID(6,@15),TVOLSER                               1159 04457000
*   CVOLVEXT=COVCEPTR;              /*                       @Y30LB34*/ 04458000
*                                                                  1160 04459000
         L     @14,COVCEPTR                                        1160 04460000
         ST    @14,CVOLVEXT(,@15)                                  1160 04461000
*   /*****************************************************************/ 04462000
*   /*                                                               */ 04463000
*   /* INITIALIZE THE IEZCOVCE PARM LIST                     @Y30LB34*/ 04464000
*   /*                                                               */ 04465000
*   /*****************************************************************/ 04466000
*                                                                  1161 04467000
*   COVICOPY=ON;                    /*                       @Y30LB34*/ 04468000
         OI    COVICOPY(@14),B'10000000'                           1161 04469000
*   COVSRCVY=ON;                    /*                       @Y30LB34*/ 04470000
         OI    COVSRCVY(@14),B'10000000'                           1162 04471000
*   COVLNGTH=COVLEN;                /*                       @Y30LB34*/ 04472000
*                                                                  1163 04473000
         LH    @15,COVLEN                                          1163 04474000
         ST    @15,COVLNGTH(,@14)                                  1163 04475000
*   /*****************************************************************/ 04476000
*   /*                                                               */ 04477000
*   /* ISSUE THE USSC MACRO TO ISSUE ICBCOVC WHICH WILL      @Y30LB34*/ 04478000
*   /* COPY THE DATA FROM THE REAL VOLUME TO THE MSS         @Y30LB34*/ 04479000
*   /* VOLUME                                                @Y30LB34*/ 04480000
*   /*                                                               */ 04481000
*   /*****************************************************************/ 04482000
*                                                                  1164 04483000
*   CALL IDCSASS0(GDTTBL,COPYVOL,CVOLPTR,USSCREG0,USSCECB);/*      1164 04484000
*                                                            @Y30LB34*/ 04485000
         ST    @08,@AL00001                                        1164 04486000
         LA    @15,COPYVOL                                         1164 04487000
         ST    @15,@AL00001+4                                      1164 04488000
         LA    @15,CVOLPTR                                         1164 04489000
         ST    @15,@AL00001+8                                      1164 04490000
         LA    @15,USSCREG0                                        1164 04491000
         ST    @15,@AL00001+12                                     1164 04492000
         LA    @15,USSCECB                                         1164 04493000
         ST    @15,@AL00001+16                                     1164 04494000
         MVI   @AL00001+16,X'80'                                   1164 04495000
         L     @15,GDTSSC(,@08)                                    1164 04496000
         LA    @01,@AL00001                                        1164 04497000
         BALR  @14,@15                                             1164 04498000
*   RESPECIFY                                                      1165 04499000
*     RTNREG RSTD;                                                 1165 04500000
*   TESTRC=RTNREG;                                                 1166 04501000
         STH   RTNREG,TESTRC                                       1166 04502000
*   RESPECIFY                                                      1167 04503000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 04504000
*                                                                  1167 04505000
*   /*****************************************************************/ 04506000
*   /*                                                               */ 04507000
*   /* ANALYZE THE RETURN CODE FROM USSC                     @Y30LB34*/ 04508000
*   /*                                                       @Y30LB34*/ 04509000
*   /*                                                       @Y30LB34*/ 04510000
*   /* IF IT WAS SUCCESSFUL PRINT MESSAGE IDC0743I           @Y30LB34*/ 04511000
*   /* NOTIFYING A SUCCESSFUL COPY                           @Y30LB34*/ 04512000
*   /*                                                               */ 04513000
*   /*****************************************************************/ 04514000
*                                                                  1168 04515000
*   IF TESTRC=0|TESTRC=12 THEN                                     1168 04516000
         LH    @08,TESTRC                                          1168 04517000
         LTR   @08,@08                                             1168 04518000
         BZ    @RT01168                                            1168 04519000
         C     @08,@CF00567                                        1168 04520000
         BNE   @RF01168                                            1168 04521000
@RT01168 DS    0H                                                  1169 04522000
*     DO;                           /*                       @Y30LB34*/ 04523000
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/ 04524000
         L     @08,DDSTRU                                          1170 04525000
         MVC   DARGSMOD(3,@08),@CC01557                            1170 04526000
*       DARGSENT=MSG0743I;          /*                       @Y30LB34*/ 04527000
         MVI   DARGSENT(@08),X'07'                                 1171 04528000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 04529000
         SLR   @15,@15                                             1172 04530000
         ST    @15,DARGDBP(,@08)                                   1172 04531000
*       DARGILP=0;                  /*                       @Y30LB34*/ 04532000
         STH   @15,DARGILP(,@08)                                   1173 04533000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 04534000
         ST    @15,DARGRETP(,@08)                                  1174 04535000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 04536000
         L     @08,@PC00001                                        1175 04537000
         ST    @08,@AL00001                                        1175 04538000
         LA    @15,@CF00115                                        1175 04539000
         ST    @15,@AL00001+4                                      1175 04540000
         LA    @15,DDSTRU                                          1175 04541000
         ST    @15,@AL00001+8                                      1175 04542000
         MVI   @AL00001+8,X'80'                                    1175 04543000
         L     @15,GDTPRT(,@08)                                    1175 04544000
         LA    @01,@AL00001                                        1175 04545000
         BALR  @14,@15                                             1175 04546000
*     END;                          /*                       @Y30LB34*/ 04547000
*                                                                  1176 04548000
*   /*****************************************************************/ 04549000
*   /*                                                               */ 04550000
*   /* IF IT WAS NOT SUCCESSFUL DETERMINE TYPE OF ERROR      @Y30LB34*/ 04551000
*   /*                                                               */ 04552000
*   /*****************************************************************/ 04553000
*                                                                  1177 04554000
*   ELSE                                                           1177 04555000
*     DO;                           /*                       @Y30LB34*/ 04556000
         B     @RC01168                                            1177 04557000
@RF01168 DS    0H                                                  1178 04558000
*       CC12=LASTCC12;              /*                       @Y30LB34*/ 04559000
*                                                                  1178 04560000
         LA    CC12,12                                             1178 04561000
*       /*************************************************************/ 04562000
*       /*                                                           */ 04563000
*       /* IF USSC FAILED PRINT ERROR MESSAGES               @Y30LB34*/ 04564000
*       /*                                                           */ 04565000
*       /*************************************************************/ 04566000
*                                                                  1179 04567000
*       IF TESTRC=4 THEN                                           1179 04568000
         CLC   TESTRC(2),@CH00036                                  1179 04569000
         BNE   @RF01179                                            1179 04570000
*         DO;                       /*                       @Y30LB34*/ 04571000
*                                                                  1180 04572000
*           /*********************************************************/ 04573000
*           /*                                                       */ 04574000
*           /* CALL SSCMSG TO PRINT USSC ERROR MESSAGE       @Y30LB34*/ 04575000
*           /*                                                       */ 04576000
*           /*********************************************************/ 04577000
*                                                                  1181 04578000
*           CALL SSCMSG(USSCREG0,USSCECB);/*                 @Y30LB34*/ 04579000
         LA    @08,USSCREG0                                        1181 04580000
         ST    @08,@AL00001                                        1181 04581000
         LA    @08,USSCECB                                         1181 04582000
         ST    @08,@AL00001+4                                      1181 04583000
         LA    @01,@AL00001                                        1181 04584000
         BAL   @14,SSCMSG                                          1181 04585000
*                                                                  1182 04586000
*           /*********************************************************/ 04587000
*           /*                                                       */ 04588000
*           /* IF THE REASON CODE IS NOT ZERO SIGNIFYING     @Y30LB34*/ 04589000
*           /* THE COPY WAS NOT STARTED ISSUE MESSAGE        @Y30LB34*/ 04590000
*           /* IDC3082I.                                     @Y30LB34*/ 04591000
*           /*                                                       */ 04592000
*           /*********************************************************/ 04593000
*                                                                  1182 04594000
*           IF USSCREG0^=0 THEN                                    1182 04595000
         L     @08,USSCREG0                                        1182 04596000
         LTR   @08,@08                                             1182 04597000
         BZ    @RF01182                                            1182 04598000
*             DO;                   /*                       @Y30LB34*/ 04599000
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/ 04600000
         L     @08,DDSTRU                                          1184 04601000
         MVC   DARGSMOD(3,@08),@CC01555                            1184 04602000
*               DARGSENT=MSG3082I;  /*                       @Y30LB34*/ 04603000
         MVI   DARGSENT(@08),X'18'                                 1185 04604000
*             END;                  /*                       @Y30LB34*/ 04605000
*                                                                  1186 04606000
*           /*********************************************************/ 04607000
*           /*                                                       */ 04608000
*           /* IF THE REASON CODE IS ZERO SIGNIFYING THE     @Y30LB34*/ 04609000
*           /* COPY WAS STARTED BUT DID NOT COMPLETE,        @Y30LB34*/ 04610000
*           /* ISSUE ERROR MESSAGE IDC3071I.                 @Y30LB34*/ 04611000
*           /*                                                       */ 04612000
*           /*********************************************************/ 04613000
*                                                                  1187 04614000
*           ELSE                                                   1187 04615000
*             DO;                   /*                       @Y30LB34*/ 04616000
         B     @RC01182                                            1187 04617000
@RF01182 DS    0H                                                  1188 04618000
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/ 04619000
         L     @08,DDSTRU                                          1188 04620000
         MVC   DARGSMOD(3,@08),@CC01555                            1188 04621000
*               DARGSENT=MSG3071I;  /*                       @Y30LB34*/ 04622000
         MVI   DARGSENT(@08),X'23'                                 1189 04623000
*             END;                  /*                       @Y30LB34*/ 04624000
*           DARGDBP=0;              /*                       @Y30LB34*/ 04625000
@RC01182 SLR   @08,@08                                             1191 04626000
         L     @15,DDSTRU                                          1191 04627000
         ST    @08,DARGDBP(,@15)                                   1191 04628000
*           DARGILP=0;              /*                       @Y30LB34*/ 04629000
         STH   @08,DARGILP(,@15)                                   1192 04630000
*           DARGRETP=0;             /*                       @Y30LB34*/ 04631000
         ST    @08,DARGRETP(,@15)                                  1193 04632000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 04633000
         L     @08,@PC00001                                        1194 04634000
         ST    @08,@AL00001                                        1194 04635000
         LA    @15,@CF00115                                        1194 04636000
         ST    @15,@AL00001+4                                      1194 04637000
         LA    @15,DDSTRU                                          1194 04638000
         ST    @15,@AL00001+8                                      1194 04639000
         MVI   @AL00001+8,X'80'                                    1194 04640000
         L     @15,GDTPRT(,@08)                                    1194 04641000
         LA    @01,@AL00001                                        1194 04642000
         BALR  @14,@15                                             1194 04643000
*         END;                      /*                       @Y30LB34*/ 04644000
*     END;                          /*                       @Y30LB34*/ 04645000
*                                                                  1196 04646000
@RF01179 DS    0H                                                  1197 04647000
*   /*****************************************************************/ 04648000
*   /*                                                               */ 04649000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 04650000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 04651000
*   /*                                                               */ 04652000
*   /*****************************************************************/ 04653000
*                                                                  1197 04654000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 04655000
@RC01168 L     REG14,RTNREG3                                       1197 04656000
*   RETURN CODE(CC12);              /*                       @Y30LB34*/ 04657000
         LR    @15,CC12                                            1198 04658000
@EL00013 DS    0H                                                  1198 04659000
@EF00013 DS    0H                                                  1198 04660000
@ER00013 BR    @14                                                 1198 04661000
*   END RVMOVDAT;                   /*                       @Y30LB34*/ 04662000
*                                                                  1200 04663000
*/********************************************************** @Y30LB34*/ 04664000
*/*                                                          @Y30LB34*/ 04665000
*/* PROCEDURE NAME - UPDVTOC                                 @Y30LB34*/ 04666000
*/*                                                          @Y30LB34*/ 04667000
*/* FUNCTION - UPDATES TARGET VOLUME VTOC AND LABEL AFTER    @Y30LB34*/ 04668000
*/*            DATA HAS BEEN COPIED                          @Y30LB34*/ 04669000
*/*                                                          @Y30LB34*/ 04670000
*/*            CALLS VOLUME SERVICES TO UPDATE THE ALTERNATE @Y30LB34*/ 04671000
*/*            TRACK INFORMATION AND, IF THE VOLUME IS VSAM, @Y30LB34*/ 04672000
*/*            THE TIMESTAMP                                 @Y30LB34*/ 04673000
*/*                                                          @Y30LB34*/ 04674000
*/*            CLOSES THE VTOC AFTER VOLUME SERVICES OPENS   @Y30LB34*/ 04675000
*/*            IT                                            @Y30LB34*/ 04676000
*/*                                                          @Y30LB34*/ 04677000
*/*            INITIALIZES THE IDCVS02 PARM LIST FOR LABEL   @Y30LB34*/ 04678000
*/*            UPDATING                                      @Y30LB34*/ 04679000
*/*                                                          @Y30LB34*/ 04680000
*/*            CALLS VOLUME SERVICES TO UPDATE THE LABEL     @Y30LB34*/ 04681000
*/*            WITH THE ORIGINAL OWNER OF THE VOLUME AND     @Y30LB34*/ 04682000
*/*            IF THE VOLSERS ARE NOT EQUAL, UPDATES THE     @Y30LB34*/ 04683000
*/*            VOLUME SERIAL NUMBER                          @Y30LB34*/ 04684000
*/*                                                          @Y30LB34*/ 04685000
*/*            IF THE VTOC AND LABEL ARE SUCCESSFULLY        @Y30LB34*/ 04686000
*/*            UPDATED, PRINTS MESSAGE IDC0747I              @Y30LB34*/ 04687000
*/*                                                          @Y30LB34*/ 04688000
*/* INPUT - TOVS1AGL,TARGAREA, VS2AGL, FDTTBL, DARGLIST      @Y30LB34*/ 04689000
*/*                                                          @Y30LB34*/ 04690000
*/* OUTPUT - INITIALIZED VS2AGL                              @Y30LB34*/ 04691000
*/*                                                          @Y30LB34*/ 04692000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 04693000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 04694000
*/*           R. C. =  4, UNABLE TO UPDATE VTOC,             @Y30LB34*/ 04695000
*/*                       UNABLE TO CLOSE VTOC               @Y30LB34*/ 04696000
*/*           R. C. =  8, UNABLE TO UPDATE OWNER DATA        @Y30LB34*/ 04697000
*/*           R. C. = 12, UNABLE TO UPDATE VOLUME SERIAL     @Y30LB34*/ 04698000
*/*                       NUMBER                             @Y30LB34*/ 04699000
*/*                                                          @Y30LB34*/ 04700000
*/********************************************************** @Y30LB34*/ 04701000
*                                                                  1200 04702000
*UPDVTOC:                                                          1200 04703000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 04704000
*                                                                  1200 04705000
UPDVTOC  DS    0H                                                  1201 04706000
*   /*****************************************************************/ 04707000
*   /*                                                               */ 04708000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 04709000
*   /*                                                               */ 04710000
*   /*****************************************************************/ 04711000
*                                                                  1201 04712000
*   DCL                                                            1201 04713000
*     CC13 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   04714000
*                                      CODE SAVE AREA        @Y30LB34*/ 04715000
*                                                                  1202 04716000
*   /*****************************************************************/ 04717000
*   /*                                                               */ 04718000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 04719000
*   /*                                                               */ 04720000
*   /*****************************************************************/ 04721000
*                                                                  1202 04722000
*   OLDERID2=NEWERID2;                                             1202 04723000
         L     @08,@PC00001                                        1202 04724000
         L     @15,GDTTR2(,@08)                                    1202 04725000
         MVC   @TS00001(95),NEWERID2(@15)                          1202 04726000
         MVC   OLDERID2(95,@15),@TS00001                           1202 04727000
*   NEWID2='CNTD';                  /*                       @Y30LB34*/ 04728000
*                                                                  1203 04729000
         MVC   NEWID2(4,@15),@CC01765                              1203 04730000
*   /*****************************************************************/ 04731000
*   /*                                                               */ 04732000
*   /* SAVE REGISTER 14                                      @Y30LB34*/ 04733000
*   /*                                                               */ 04734000
*   /*****************************************************************/ 04735000
*                                                                  1204 04736000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 04737000
*                                                                  1204 04738000
         ST    REG14,RTNREG3                                       1204 04739000
*   /*****************************************************************/ 04740000
*   /*                                                               */ 04741000
*   /* CALL VOLUME SERVICES TO RESTORE THE ORIGINAL          @Y30LB34*/ 04742000
*   /* ALTERNATE TRACK INFORMATION IN THE VTOC               @Y30LB34*/ 04743000
*   /* AND UPDATE THE VSAM TIMESTAMP                         @Y30LB34*/ 04744000
*   /*                                                               */ 04745000
*   /*****************************************************************/ 04746000
*                                                                  1205 04747000
*   RESPECIFY                                                      1205 04748000
*     VS1AGL BASED(ADDR(TOVS1AGL)); /*                       @Y30LB34*/ 04749000
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',PUTVTOC,VS1AGL);/*       @Y30LB34*/ 04750000
         ST    @08,@AL00001                                        1206 04751000
         LA    @15,@CC01720                                        1206 04752000
         ST    @15,@AL00001+4                                      1206 04753000
         LA    @15,PUTVTOC                                         1206 04754000
         ST    @15,@AL00001+8                                      1206 04755000
         LA    @15,TOVS1AGL                                        1206 04756000
         ST    @15,@AL00001+12                                     1206 04757000
         MVI   @AL00001+12,X'80'                                   1206 04758000
         L     @15,GDTCAL(,@08)                                    1206 04759000
         LA    @01,@AL00001                                        1206 04760000
         BALR  @14,@15                                             1206 04761000
*   RESPECIFY                                                      1207 04762000
*     RTNREG RSTD;                                                 1207 04763000
*   TESTRC=RTNREG;                                                 1208 04764000
         STH   RTNREG,TESTRC                                       1208 04765000
*   RESPECIFY                                                      1209 04766000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 04767000
*                                                                  1209 04768000
*   /*****************************************************************/ 04769000
*   /*                                                               */ 04770000
*   /* SET CONDITION CODE FROM VOLUME SERVICES               @Y30LB34*/ 04771000
*   /*                                                               */ 04772000
*   /*****************************************************************/ 04773000
*                                                                  1210 04774000
*   CC13=TESTRC;                    /*                       @Y30LB34*/ 04775000
         LH    @15,TESTRC                                          1210 04776000
         LR    CC13,@15                                            1210 04777000
*                                                                  1211 04778000
*   /*****************************************************************/ 04779000
*   /*                                                               */ 04780000
*   /* IF THE VTOC WAS OPENED BY VOLUME SERVICES, CLOSE IT   @Y30LB34*/ 04781000
*   /* AND SET THE IOCSTR POINTER TO ZERO                    @Y30LB34*/ 04782000
*   /*                                                               */ 04783000
*   /*****************************************************************/ 04784000
*                                                                  1211 04785000
*   IF VSIOP^=NULLPTR THEN                                         1211 04786000
         LA    @08,TOVS1AGL                                        1211 04787000
         L     @15,VSIOP(,@08)                                     1211 04788000
         LTR   @15,@15                                             1211 04789000
         BZ    @RF01211                                            1211 04790000
*     DO;                           /*                       @Y30LB34*/ 04791000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB34*/ 04792000
         L     @15,@PC00001                                        1213 04793000
         ST    @15,@AL00001                                        1213 04794000
         LA    @08,VSIOP(,@08)                                     1213 04795000
         ST    @08,@AL00001+4                                      1213 04796000
         MVI   @AL00001+4,X'80'                                    1213 04797000
         L     @15,GDTCLS(,@15)                                    1213 04798000
         LA    @01,@AL00001                                        1213 04799000
         BALR  @14,@15                                             1213 04800000
*       RESPECIFY                                                  1214 04801000
*         RTNREG RSTD;                                             1214 04802000
*       TESTRC=RTNREG;                                             1215 04803000
         STH   RTNREG,TESTRC                                       1215 04804000
*       RESPECIFY                                                  1216 04805000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 04806000
*       VSIOP=NULLPTR;              /*                       @Y30LB34*/ 04807000
         LA    @08,TOVS1AGL                                        1217 04808000
         SLR   @15,@15                                             1217 04809000
         ST    @15,VSIOP(,@08)                                     1217 04810000
*       CC13=MAX(CC13,TESTRC);      /*                       @Y30LB34*/ 04811000
         LH    @08,TESTRC                                          1218 04812000
         CR    CC13,@08                                            1218 04813000
         BNL   *+6                                                      04814000
         LR    CC13,@08                                            1218 04815000
*     END;                          /*                       @Y30LB34*/ 04816000
*                                                                  1219 04817000
*   /*****************************************************************/ 04818000
*   /*                                                               */ 04819000
*   /* INITIALIZE THE IDCVS02 PARM LIST TO UPDATE THE        @Y30LB34*/ 04820000
*   /* OWNER AND IF THE VOLSERS ARE NOT THE SAME,            @Y30LB34*/ 04821000
*   /* UPDATE THE VOLSER                                     @Y30LB34*/ 04822000
*   /*                                                               */ 04823000
*   /*****************************************************************/ 04824000
*                                                                  1220 04825000
*   VSUCBPTR=ADDR(TUCBADDR);        /*                       @Y30LB34*/ 04826000
@RF01211 LA    @08,VS2AGLAR                                        1220 04827000
         LA    @15,TUCBADDR                                        1220 04828000
         ST    @15,VSUCBPTR(,@08)                                  1220 04829000
*   VSDDNAME=TFILEVAL;              /*                       @Y30LB34*/ 04830000
         L     @15,@PC00001+4                                      1221 04831000
         L     @01,FDTPTR+4(,@15)                                  1221 04832000
         MVC   VSDDNAME(8,@08),TFILEVAL(@01)                       1221 04833000
*   VSOWNPTR=ADDR(TOWNER);          /*                       @Y30LB34*/ 04834000
         LA    @15,TOWNER                                          1222 04835000
         ST    @15,VSOWNPTR(,@08)                                  1222 04836000
*   VSOWNER=ON;                     /*                       @Y30LB34*/ 04837000
         OI    VSOWNER(@08),B'10000000'                            1223 04838000
*   IF SAMESER=OFF THEN                                            1224 04839000
         TM    SAMESER,B'10000000'                                 1224 04840000
         BNZ   @RF01224                                            1224 04841000
*     DO;                           /*                       @Y30LB34*/ 04842000
*       VSVOLPTR=ADDR(TVOLSER);     /*                       @Y30LB34*/ 04843000
         LA    @15,TVOLSER                                         1226 04844000
         ST    @15,VSVOLPTR(,@08)                                  1226 04845000
*       VSVOLSER=ON;                /*                       @Y30LB34*/ 04846000
         OI    VSVOLSER(@08),B'01000000'                           1227 04847000
*     END;                          /*                       @Y30LB34*/ 04848000
*   VSVOLUME=TVOLSER;               /*                       @Y30LB34*/ 04849000
@RF01224 LA    @08,VS2AGLAR                                        1229 04850000
         MVC   VSVOLUME(6,@08),TVOLSER                             1229 04851000
*   VS2TOV=ON;                      /*                       @Y30LB34*/ 04852000
*                                                                  1230 04853000
         OI    VS2TOV(@08),B'10000000'                             1230 04854000
*   /*****************************************************************/ 04855000
*   /*                                                               */ 04856000
*   /* CALL VOLUME SERVICES TO RESTORE THE ORIGINAL          @Y30LB34*/ 04857000
*   /* OWNER IN THE LABEL AND, IF NECESSARY, UPDATE          @Y30LB34*/ 04858000
*   /* THE VOLSER                                            @Y30LB34*/ 04859000
*   /*                                                               */ 04860000
*   /*****************************************************************/ 04861000
*                                                                  1231 04862000
*   CALL IDCSACL0(GDTTBL,'IDCVS02 ',PUTLABEL,VS2AGL);/*      @Y30LB34*/ 04863000
         L     @15,@PC00001                                        1231 04864000
         ST    @15,@AL00001                                        1231 04865000
         LA    @14,@CC01768                                        1231 04866000
         ST    @14,@AL00001+4                                      1231 04867000
         LA    @14,PUTLABEL                                        1231 04868000
         ST    @14,@AL00001+8                                      1231 04869000
         ST    @08,@AL00001+12                                     1231 04870000
         MVI   @AL00001+12,X'80'                                   1231 04871000
         L     @15,GDTCAL(,@15)                                    1231 04872000
         LA    @01,@AL00001                                        1231 04873000
         BALR  @14,@15                                             1231 04874000
*   RESPECIFY                                                      1232 04875000
*     RTNREG RSTD;                                                 1232 04876000
*   TESTRC=RTNREG;                                                 1233 04877000
         STH   RTNREG,TESTRC                                       1233 04878000
*   RESPECIFY                                                      1234 04879000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 04880000
*                                                                  1235 04881000
*   /*****************************************************************/ 04882000
*   /*                                                               */ 04883000
*   /* IF THE LABEL UPDATING WAS NOT SUCCESSFUL,             @Y30LB34*/ 04884000
*   /* DETERMINE THE SEVERITY OF THE ERROR                   @Y30LB34*/ 04885000
*   /*                                                               */ 04886000
*   /*****************************************************************/ 04887000
*                                                                  1235 04888000
*   IF TESTRC>0 THEN                                               1235 04889000
         LH    @08,TESTRC                                          1235 04890000
         LTR   @08,@08                                             1235 04891000
         BNP   @RF01235                                            1235 04892000
*     DO;                           /*                       @Y30LB34*/ 04893000
*                                                                  1236 04894000
*       /*************************************************************/ 04895000
*       /*                                                           */ 04896000
*       /* IF THE SERIAL NUMBER NEEDED UPDATING,             @Y30LB34*/ 04897000
*       /* THE VOLUME IS UNUSABLE. SET THE                   @Y30LB34*/ 04898000
*       /* CONDITION CODE TO 12.                             @Y30LB34*/ 04899000
*       /*                                                           */ 04900000
*       /*************************************************************/ 04901000
*                                                                  1237 04902000
*       IF SAMESER=OFF THEN                                        1237 04903000
         TM    SAMESER,B'10000000'                                 1237 04904000
         BNZ   @RF01237                                            1237 04905000
*         CC13=LASTCC12;            /*                       @Y30LB34*/ 04906000
*                                                                  1238 04907000
         LA    CC13,12                                             1238 04908000
*       /*************************************************************/ 04909000
*       /*                                                           */ 04910000
*       /* IF ONLY THE OWNER NEEDED UPDATING, THE            @Y30LB34*/ 04911000
*       /* VOLUME IS USABLE. SET THE CONDITION               @Y30LB34*/ 04912000
*       /* CODE TO 8.                                        @Y30LB34*/ 04913000
*       /*                                                           */ 04914000
*       /*************************************************************/ 04915000
*                                                                  1239 04916000
*       ELSE                                                       1239 04917000
*         CC13=LASTCC08;            /*                       @Y30LB34*/ 04918000
         B     @RC01237                                            1239 04919000
@RF01237 LA    CC13,8                                              1239 04920000
*     END;                          /*                       @Y30LB34*/ 04921000
*                                                                  1240 04922000
@RC01237 DS    0H                                                  1241 04923000
*   /*****************************************************************/ 04924000
*   /*                                                               */ 04925000
*   /* IF NO SEVERE ERRORS OCCURRED IN THE UPDATE PROCESS,   @Y30LB34*/ 04926000
*   /* PRINT MESSAGE IDC0747I.                               @Y30LB34*/ 04927000
*   /*                                                               */ 04928000
*   /*****************************************************************/ 04929000
*                                                                  1241 04930000
*   IF CC13<LASTCC08 THEN                                          1241 04931000
@RF01235 C     CC13,@CF00177                                       1241 04932000
         BNL   @RF01241                                            1241 04933000
*     DO;                           /*                       @Y30LB34*/ 04934000
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/ 04935000
         L     @08,DDSTRU                                          1243 04936000
         MVC   DARGSMOD(3,@08),@CC01557                            1243 04937000
*       DARGSENT=MSG0747I;          /*                       @Y30LB34*/ 04938000
         MVI   DARGSENT(@08),X'0B'                                 1244 04939000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 04940000
         SLR   @15,@15                                             1245 04941000
         ST    @15,DARGDBP(,@08)                                   1245 04942000
*       DARGILP=0;                  /*                       @Y30LB34*/ 04943000
         STH   @15,DARGILP(,@08)                                   1246 04944000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 04945000
         ST    @15,DARGRETP(,@08)                                  1247 04946000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 04947000
         L     @08,@PC00001                                        1248 04948000
         ST    @08,@AL00001                                        1248 04949000
         LA    @15,@CF00115                                        1248 04950000
         ST    @15,@AL00001+4                                      1248 04951000
         LA    @15,DDSTRU                                          1248 04952000
         ST    @15,@AL00001+8                                      1248 04953000
         MVI   @AL00001+8,X'80'                                    1248 04954000
         L     @15,GDTPRT(,@08)                                    1248 04955000
         LA    @01,@AL00001                                        1248 04956000
         BALR  @14,@15                                             1248 04957000
*     END;                          /*                       @Y30LB34*/ 04958000
*                                                                  1250 04959000
*   /*****************************************************************/ 04960000
*   /*                                                               */ 04961000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 04962000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 04963000
*   /*                                                               */ 04964000
*   /*****************************************************************/ 04965000
*                                                                  1250 04966000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 04967000
@RF01241 L     REG14,RTNREG3                                       1250 04968000
*   RETURN CODE(CC13);              /*                       @Y30LB34*/ 04969000
         LR    @15,CC13                                            1251 04970000
@EL00014 DS    0H                                                  1251 04971000
@EF00014 DS    0H                                                  1251 04972000
@ER00014 BR    @14                                                 1251 04973000
*   END UPDVTOC;                    /*                       @Y30LB34*/ 04974000
*                                                                  1253 04975000
*/********************************************************** @Y30LB34*/ 04976000
*/*                                                          @Y30LB34*/ 04977000
*/* PROCEDURE NAME - RVCLEAR                                 @Y30LB34*/ 04978000
*/*                                                          @Y30LB34*/ 04979000
*/* FUNCTION - CLEARS THE RECOVERY FLAG FROM THE BASE VOLUME @Y30LB34*/ 04980000
*/*            RECORD                                        @Y30LB34*/ 04981000
*/*                                                          @Y30LB34*/ 04982000
*/*            INITIALIZES THE MVR PARAMETER LIST TO SET OFF @Y30LB34*/ 04983000
*/*            THE INCOMPLETE-COPY-OPERATION FLAG            @Y30LB34*/ 04984000
*/*                                                          @Y30LB34*/ 04985000
*/*            ISSUES USSC TO ISSUE THE ICBVVIC MACRO WHICH  @Y30LB34*/ 04986000
*/*            SETS OFF THE FLAG IN THE BASE VOLUME RECORD   @Y30LB34*/ 04987000
*/*                IF USSC IS NOT SUCCESSFUL, CALLS SSCMSG   @Y30LB34*/ 04988000
*/*                TO PRINT ANY MESSAGES ISSUED BY USSC,     @Y30LB34*/ 04989000
*/*                PRINTS ERROR MESSAGE IDC3066I IF UNABLE   @Y30LB34*/ 04990000
*/*                TO CLEAR FLAG FROM RECORD                 @Y30LB34*/ 04991000
*/*                                                          @Y30LB34*/ 04992000
*/* INPUT - MVR, TARGAREA, DARGLIST                          @Y30LB34*/ 04993000
*/*                                                          @Y30LB34*/ 04994000
*/* OUTPUT - INITIALIZED MVR                                 @Y30LB34*/ 04995000
*/*                                                          @Y30LB34*/ 04996000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 04997000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 04998000
*/*           R. C. = 12, UNABLE TO CLEAR INCOMPLETE-COPY    @Y30LB34*/ 04999000
*/*                       FLAG                               @Y30LB34*/ 05000000
*/*                                                          @Y30LB34*/ 05001000
*/********************************************************** @Y30LB34*/ 05002000
*                                                                  1253 05003000
*RVCLEAR:                                                          1253 05004000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 05005000
*                                                                  1253 05006000
RVCLEAR  DS    0H                                                  1254 05007000
*   /*****************************************************************/ 05008000
*   /*                                                               */ 05009000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 05010000
*   /*                                                               */ 05011000
*   /*****************************************************************/ 05012000
*                                                                  1254 05013000
*   DCL                                                            1254 05014000
*     CC14 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   05015000
*                                      CODE SAVE AREA        @Y30LB34*/ 05016000
*                                                                  1255 05017000
*   /*****************************************************************/ 05018000
*   /*                                                               */ 05019000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 05020000
*   /*                                                               */ 05021000
*   /*****************************************************************/ 05022000
*                                                                  1255 05023000
*   OLDERID2=NEWERID2;                                             1255 05024000
         L     @11,@PC00001                                        1255 05025000
         L     @08,GDTTR2(,@11)                                    1255 05026000
         MVC   @TS00001(95),NEWERID2(@08)                          1255 05027000
         MVC   OLDERID2(95,@08),@TS00001                           1255 05028000
*   NEWID2='CNTE';                  /*                       @Y30LB34*/ 05029000
*                                                                  1256 05030000
         MVC   NEWID2(4,@08),@CC01773                              1256 05031000
*   /*****************************************************************/ 05032000
*   /*                                                               */ 05033000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 05034000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 05035000
*   /*                                                               */ 05036000
*   /*****************************************************************/ 05037000
*                                                                  1257 05038000
*   CC14=LASTCC00;                  /*                       @Y30LB34*/ 05039000
         SLR   @15,@15                                             1257 05040000
         LR    CC14,@15                                            1257 05041000
*   RTNREG4=REG14;                  /*                       @Y30LB34*/ 05042000
*                                                                  1258 05043000
         ST    REG14,RTNREG4                                       1258 05044000
*   /*****************************************************************/ 05045000
*   /*                                                               */ 05046000
*   /* INITIALIZE THE MVR PARM LIST TO SET OFF THE           @Y30LB34*/ 05047000
*   /* INCOMPLETE-COPY-OPERATION FLAG                        @Y30LB34*/ 05048000
*   /*                                                               */ 05049000
*   /*****************************************************************/ 05050000
*                                                                  1259 05051000
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB34*/ 05052000
         L     @08,MVRPTR                                          1259 05053000
         LH    @14,MVRLEN                                          1259 05054000
         ST    @14,MVRLNGTH(,@08)                                  1259 05055000
*   MVROPCD=MVROP;                  /*                       @Y30LB34*/ 05056000
         MVI   MVROPCD(@08),X'85'                                  1260 05057000
*   MVRCICPY=ON;                    /*                       @ZM30738*/ 05058000
         OI    MVRCICPY(@08),B'01000000'                           1261 05059000
*   MVRFLBAS=ON;                    /*                       @ZM30758*/ 05060000
         OI    MVRFLBAS(@08),B'00100000'                           1262 05061000
*   MVRBVOL=TVOLSER;                /*                       @Y30LB34*/ 05062000
*                                                                  1263 05063000
         MVC   MVRBVOL(6,@08),TVOLSER                              1263 05064000
*   /*****************************************************************/ 05065000
*   /*                                                               */ 05066000
*   /* ISSUE USSC TO ISSUE THE ICBVVIC MACRO TO CLEAR THE    @Y30LB34*/ 05067000
*   /* FLAG                                                  @Y30LB34*/ 05068000
*   /*                                                               */ 05069000
*   /*****************************************************************/ 05070000
*                                                                  1264 05071000
*   USSCREG0=0;                     /*                       @Y30LB34*/ 05072000
         ST    @15,USSCREG0                                        1264 05073000
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,USSCREG0);/*            @Y30LB34*/ 05074000
         ST    @11,@AL00001                                        1265 05075000
         LA    @08,VVIC                                            1265 05076000
         ST    @08,@AL00001+4                                      1265 05077000
         LA    @08,MVRPTR                                          1265 05078000
         ST    @08,@AL00001+8                                      1265 05079000
         LA    @08,USSCREG0                                        1265 05080000
         ST    @08,@AL00001+12                                     1265 05081000
         MVI   @AL00001+12,X'80'                                   1265 05082000
         L     @15,GDTSSC(,@11)                                    1265 05083000
         LA    @01,@AL00001                                        1265 05084000
         BALR  @14,@15                                             1265 05085000
*   RESPECIFY                                                      1266 05086000
*     RTNREG RSTD;                                                 1266 05087000
*   TESTRC=RTNREG;                                                 1267 05088000
         STH   RTNREG,TESTRC                                       1267 05089000
*   RESPECIFY                                                      1268 05090000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 05091000
*                                                                  1269 05092000
*   /*****************************************************************/ 05093000
*   /*                                                               */ 05094000
*   /* IF USSC WAS NOT SUCCESSFUL, CALL SSCMSG TO PRINT      @Y30LB34*/ 05095000
*   /* THE MESSAGE FROM USSC, PRINT ERROR MESSAGE IDC3066I   @Y30LB34*/ 05096000
*   /* AND SET CONDITION CODE TO 12                          @Y30LB34*/ 05097000
*   /*                                                               */ 05098000
*   /*****************************************************************/ 05099000
*                                                                  1269 05100000
*   IF TESTRC>0 THEN                                               1269 05101000
         LH    @11,TESTRC                                          1269 05102000
         LTR   @11,@11                                             1269 05103000
         BNP   @RF01269                                            1269 05104000
*     DO;                           /*                       @Y30LB34*/ 05105000
*       CALL SSCMSG(USSCREG0);      /*                       @Y30LB34*/ 05106000
         LA    @11,USSCREG0                                        1271 05107000
         ST    @11,@AL00001                                        1271 05108000
         LA    @01,@AL00001                                        1271 05109000
         BAL   @14,SSCMSG                                          1271 05110000
*       DARGSMOD=COMMSG;            /*                       @Y30LB34*/ 05111000
         L     @11,DDSTRU                                          1272 05112000
         MVC   DARGSMOD(3,@11),@CC01555                            1272 05113000
*       DARGSENT=MSG3066I;          /*                       @Y30LB34*/ 05114000
         MVI   DARGSENT(@11),X'2C'                                 1273 05115000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 05116000
         SLR   @08,@08                                             1274 05117000
         ST    @08,DARGDBP(,@11)                                   1274 05118000
*       DARGILP=0;                  /*                       @Y30LB34*/ 05119000
         STH   @08,DARGILP(,@11)                                   1275 05120000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 05121000
         ST    @08,DARGRETP(,@11)                                  1276 05122000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 05123000
         L     @11,@PC00001                                        1277 05124000
         ST    @11,@AL00001                                        1277 05125000
         LA    @08,@CF00115                                        1277 05126000
         ST    @08,@AL00001+4                                      1277 05127000
         LA    @08,DDSTRU                                          1277 05128000
         ST    @08,@AL00001+8                                      1277 05129000
         MVI   @AL00001+8,X'80'                                    1277 05130000
         L     @15,GDTPRT(,@11)                                    1277 05131000
         LA    @01,@AL00001                                        1277 05132000
         BALR  @14,@15                                             1277 05133000
*       CC14=LASTCC12;              /*                       @Y30LB34*/ 05134000
         LA    CC14,12                                             1278 05135000
*     END;                          /*                       @Y30LB34*/ 05136000
*                                                                  1279 05137000
*   /*****************************************************************/ 05138000
*   /*                                                               */ 05139000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 05140000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 05141000
*   /*                                                               */ 05142000
*   /*****************************************************************/ 05143000
*                                                                  1280 05144000
*   REG14=RTNREG4;                  /*                       @Y30LB34*/ 05145000
@RF01269 L     REG14,RTNREG4                                       1280 05146000
*   RETURN CODE(CC14);              /*                       @Y30LB34*/ 05147000
         LR    @15,CC14                                            1281 05148000
@EL00015 DS    0H                                                  1281 05149000
@EF00015 DS    0H                                                  1281 05150000
@ER00015 BR    @14                                                 1281 05151000
*   END RVCLEAR;                    /*                       @Y30LB34*/ 05152000
*                                                                  1283 05153000
*/********************************************************** @Y30LB34*/ 05154000
*/*                                                          @Y30LB34*/ 05155000
*/* PROCEDURE NAME - RECATCTL                                @Y30LB34*/ 05156000
*/*                                                          @Y30LB34*/ 05157000
*/* FUNCTION - CONTROLS RECATALOGING TO BE DONE              @Y30LB34*/ 05158000
*/*                                                          @Y30LB34*/ 05159000
*/*            DETERMINES WHAT RECATALOGING IS TO BE DONE.   @Y30LB34*/ 05160000
*/*            SETS FLAG TO ALLOW VSAM AND/OR NON-VSAM       @Y30LB34*/ 05161000
*/*            RECATALOGING.                                 @Y30LB34*/ 05162000
*/*                PRINTS WARNING MESSAGE IDC1742I IF THE    @Y30LB34*/ 05163000
*/*                VSAM CATALOG OPTION WAS REQUESTED FOR A   @Y30LB34*/ 05164000
*/*                NON-VSAM VOLUME                           @Y30LB34*/ 05165000
*/*                                                          @Y30LB34*/ 05166000
*/*            CALLS RCATVSAM, IF THE VOLUME IS VSAM, TO     @Y30LB34*/ 05167000
*/*            RECATALOG THE DATA SETS IN THE VSAM CATALOG   @Y30LB34*/ 05168000
*/*            OWNING THE VOLUME                             @Y30LB34*/ 05169000
*/*                                                          @Y30LB34*/ 05170000
*/* INPUT - FUNCTION DATA TABLE, FRVS1AGL, DARGLIST          @Y30LB34*/ 05171000
*/*                                                          @Y30LB34*/ 05172000
*/* OUTPUT - RETRUN CODE IN REGISTER 15                      @Y30LB34*/ 05173000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 05174000
*/*           R. C. =  4, RETURN CODE FROM RCATVSAM          @Y30LB34*/ 05175000
*/*           R. C. = 12, RETURN CODE FROM RCATVSAM          @Y30LB34*/ 05176000
*/*                                                          @Y30LB34*/ 05177000
*/********************************************************** @Y30LB34*/ 05178000
*                                                                  1283 05179000
*RECATCTL:                                                         1283 05180000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 05181000
*                                                                  1283 05182000
RECATCTL DS    0H                                                  1284 05183000
*   /*****************************************************************/ 05184000
*   /*                                                               */ 05185000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 05186000
*   /*                                                               */ 05187000
*   /*****************************************************************/ 05188000
*                                                                  1284 05189000
*   DCL                                                            1284 05190000
*     CC15 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   05191000
*                                      CODE SAVE AREA        @Y30LB34*/ 05192000
*                                                                  1285 05193000
*   /*****************************************************************/ 05194000
*   /*                                                               */ 05195000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 05196000
*   /*                                                               */ 05197000
*   /*****************************************************************/ 05198000
*                                                                  1285 05199000
*   OLDERID2=NEWERID2;                                             1285 05200000
         L     @15,@PC00001                                        1285 05201000
         L     @15,GDTTR2(,@15)                                    1285 05202000
         MVC   @TS00001(95),NEWERID2(@15)                          1285 05203000
         MVC   OLDERID2(95,@15),@TS00001                           1285 05204000
*   NEWID2='CNTF';                  /*                       @Y30LB34*/ 05205000
*                                                                  1286 05206000
         MVC   NEWID2(4,@15),@CC01778                              1286 05207000
*   /*****************************************************************/ 05208000
*   /*                                                               */ 05209000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 05210000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 05211000
*   /*                                                               */ 05212000
*   /*****************************************************************/ 05213000
*                                                                  1287 05214000
*   CC15=LASTCC00;                  /*                       @Y30LB34*/ 05215000
         SLR   @15,@15                                             1287 05216000
         STH   @15,CC15                                            1287 05217000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 05218000
*                                                                  1288 05219000
         ST    REG14,RTNREG3                                       1288 05220000
*   /*****************************************************************/ 05221000
*   /*                                                               */ 05222000
*   /* ESTABLISH ADDRESSABILITY TO FRVS1AGL                  @Y30LB34*/ 05223000
*   /*                                                               */ 05224000
*   /*****************************************************************/ 05225000
*                                                                  1289 05226000
*   RESPECIFY                                                      1289 05227000
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/ 05228000
*                                                                  1289 05229000
*   /*****************************************************************/ 05230000
*   /*                                                               */ 05231000
*   /* TEST FOR THE 'VSAMCATALOG' PARAMETER                  @Y30LB34*/ 05232000
*   /*                                                               */ 05233000
*   /*****************************************************************/ 05234000
*                                                                  1290 05235000
*   IF ADDR(VCAT)^=NULLPTR THEN                                    1290 05236000
         L     @14,@PC00001+4                                      1290 05237000
         C     @15,FDTPTR+24(,@14)                                 1290 05238000
         BE    @RF01290                                            1290 05239000
*     DO;                           /*                       @Y30LB34*/ 05240000
*                                                                  1291 05241000
*       /*************************************************************/ 05242000
*       /*                                                           */ 05243000
*       /* CHECK TO MAKE SURE VOLUME IS VSAM, AND IF SO,     @Y30LB34*/ 05244000
*       /* SET VSAM FLAG                                     @Y30LB34*/ 05245000
*       /*                                                           */ 05246000
*       /*************************************************************/ 05247000
*                                                                  1292 05248000
*       IF VSVSAM=ON THEN                                          1292 05249000
         LA    @15,FRVS1AGL                                        1292 05250000
         TM    VSVSAM(@15),B'10000000'                             1292 05251000
         BNO   @RF01292                                            1292 05252000
*         VSAM=ON;                  /*                       @Y30LB34*/ 05253000
         OI    VSAM,B'00100000'                                    1293 05254000
*                                                                  1294 05255000
*       /*************************************************************/ 05256000
*       /*                                                           */ 05257000
*       /* IF NOT, PRINT WARNING MESSAGE IDC1742I, SET       @Y30LB34*/ 05258000
*       /* CONDITION CODE TO 4, AND DON'T SET VSAM FLAG      @Y30LB34*/ 05259000
*       /*                                                           */ 05260000
*       /*************************************************************/ 05261000
*                                                                  1294 05262000
*       ELSE                                                       1294 05263000
*         DO;                       /*                       @Y30LB34*/ 05264000
         B     @RC01292                                            1294 05265000
@RF01292 DS    0H                                                  1295 05266000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 05267000
         L     @15,DDSTRU                                          1295 05268000
         MVC   DARGSMOD(3,@15),@CC01557                            1295 05269000
*           DARGSENT=MSG1742I;      /*                       @Y30LB34*/ 05270000
         MVI   DARGSENT(@15),X'06'                                 1296 05271000
*           DARGDBP=0;              /*                       @Y30LB34*/ 05272000
         SLR   @14,@14                                             1297 05273000
         ST    @14,DARGDBP(,@15)                                   1297 05274000
*           DARGILP=0;              /*                       @Y30LB34*/ 05275000
         STH   @14,DARGILP(,@15)                                   1298 05276000
*           DARGRETP=0;             /*                       @Y30LB34*/ 05277000
         ST    @14,DARGRETP(,@15)                                  1299 05278000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 05279000
         L     @15,@PC00001                                        1300 05280000
         ST    @15,@AL00001                                        1300 05281000
         LA    @14,@CF00115                                        1300 05282000
         ST    @14,@AL00001+4                                      1300 05283000
         LA    @14,DDSTRU                                          1300 05284000
         ST    @14,@AL00001+8                                      1300 05285000
         MVI   @AL00001+8,X'80'                                    1300 05286000
         L     @15,GDTPRT(,@15)                                    1300 05287000
         LA    @01,@AL00001                                        1300 05288000
         BALR  @14,@15                                             1300 05289000
*           CC15=LASTCC04;          /*                       @Y30LB34*/ 05290000
         MVC   CC15(2),@CH00036                                    1301 05291000
*         END;                      /*                       @Y30LB34*/ 05292000
*     END;                          /*                       @Y30LB34*/ 05293000
*                                                                  1303 05294000
@RC01292 DS    0H                                                  1304 05295000
*   /*****************************************************************/ 05296000
*   /*                                                               */ 05297000
*   /* TEST FOR THE 'ALL' PARAMETER                          @Y30LB34*/ 05298000
*   /*                                                               */ 05299000
*   /*****************************************************************/ 05300000
*                                                                  1304 05301000
*   IF ADDR(ALLC)^=NULLPTR THEN                                    1304 05302000
@RF01290 L     @15,@PC00001+4                                      1304 05303000
         L     @15,FDTPTR+20(,@15)                                 1304 05304000
         LTR   @15,@15                                             1304 05305000
         BZ    @RF01304                                            1304 05306000
*     DO;                           /*                       @Y30LB34*/ 05307000
*                                                                  1305 05308000
*       /*************************************************************/ 05309000
*       /*                                                           */ 05310000
*       /* IF THE VOLUME IS VSAM SET THE VSAM FLAG. SET      @Y30LB34*/ 05311000
*       /* THE NONVSAM FLAG.                                 @Y30LB34*/ 05312000
*       /*                                                           */ 05313000
*       /*************************************************************/ 05314000
*                                                                  1306 05315000
*       IF VSVSAM=ON THEN                                          1306 05316000
         LA    @15,FRVS1AGL                                        1306 05317000
         TM    VSVSAM(@15),B'10000000'                             1306 05318000
         BNO   @RF01306                                            1306 05319000
*         VSAM=ON;                  /*                       @Y30LB34*/ 05320000
         OI    VSAM,B'00100000'                                    1307 05321000
*       NONVSAM=ON;                 /*                       @Y30LB34*/ 05322000
@RF01306 OI    NONVSAM,B'00010000'                                 1308 05323000
*     END;                          /*                       @Y30LB34*/ 05324000
*                                                                  1309 05325000
*   /*****************************************************************/ 05326000
*   /*                                                               */ 05327000
*   /* IF NO PARM WAS SPECIFIED AND THE VOLUME IS VSAM,      @Y30LB34*/ 05328000
*   /* APPLY THE DEFAULT OF RECATALOGING THE VSAM DATA       @Y30LB34*/ 05329000
*   /* SETS                                                  @Y30LB34*/ 05330000
*   /*                                                               */ 05331000
*   /*****************************************************************/ 05332000
*                                                                  1310 05333000
*   ELSE                                                           1310 05334000
*     IF VSVSAM=ON&VSAM=OFF THEN                                   1310 05335000
         B     @RC01304                                            1310 05336000
@RF01304 LA    @15,FRVS1AGL                                        1310 05337000
         TM    VSVSAM(@15),B'10000000'                             1310 05338000
         BNO   @RF01310                                            1310 05339000
         TM    VSAM,B'00100000'                                    1310 05340000
         BNZ   @RF01310                                            1310 05341000
*       VSAM=ON;                    /*                       @Y30LB34*/ 05342000
         OI    VSAM,B'00100000'                                    1311 05343000
*                                                                  1312 05344000
*   /*****************************************************************/ 05345000
*   /*                                                               */ 05346000
*   /* IF THE 'NONE' PARM OR NO PARM WAS SPECIFIED AND THE   @Y30LB34*/ 05347000
*   /* VOLUME IS NOT VSAM THEN NO FLAGS WILL BE SET TO       @Y30LB34*/ 05348000
*   /* PREVENT ANY RECATALOGING TO BE DONE                   @Y30LB34*/ 05349000
*   /*                                                       @Y30LB34*/ 05350000
*   /*                                                       @Y30LB34*/ 05351000
*   /* IF THE VSAM FLAG IS ON CALL RCATVSAM TO PERFORM       @Y30LB34*/ 05352000
*   /* VSAM RECATALOGING                                     @Y30LB34*/ 05353000
*   /*                                                               */ 05354000
*   /*****************************************************************/ 05355000
*                                                                  1312 05356000
*   IF VSAM=ON THEN                                                1312 05357000
@RF01310 DS    0H                                                  1312 05358000
@RC01304 TM    VSAM,B'00100000'                                    1312 05359000
         BNO   @RF01312                                            1312 05360000
*     DO;                           /*                       @Y30LB34*/ 05361000
*       CALL RCATVSAM;              /*                       @Y30LB34*/ 05362000
         BAL   @14,RCATVSAM                                        1314 05363000
*       RESPECIFY                                                  1315 05364000
*         RTNREG RSTD;                                             1315 05365000
*       TESTRC=RTNREG;                                             1316 05366000
         STH   RTNREG,TESTRC                                       1316 05367000
*       RESPECIFY                                                  1317 05368000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 05369000
*       CC15=MAX(CC15,TESTRC);      /*                       @Y30LB34*/ 05370000
         LH    @15,TESTRC                                          1318 05371000
         LH    @14,CC15                                            1318 05372000
         CR    @14,@15                                             1318 05373000
         BNL   *+6                                                      05374000
         LR    @14,@15                                             1318 05375000
         STH   @14,CC15                                            1318 05376000
*     END;                          /*                       @Y30LB34*/ 05377000
*                                                                  1319 05378000
*   /*****************************************************************/ 05379000
*   /*                                                               */ 05380000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 05381000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 05382000
*   /*                                                               */ 05383000
*   /*****************************************************************/ 05384000
*                                                                  1320 05385000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 05386000
@RF01312 L     REG14,RTNREG3                                       1320 05387000
*   RETURN CODE(CC15);              /*                       @Y30LB34*/ 05388000
         LH    @15,CC15                                            1321 05389000
@EL00016 DS    0H                                                  1321 05390000
@EF00016 DS    0H                                                  1321 05391000
@ER00016 BR    @14                                                 1321 05392000
*   END RECATCTL;                   /*                       @Y30LB34*/ 05393000
*                                                                  1323 05394000
*/********************************************************** @Y30LB34*/ 05395000
*/*                                                          @Y30LB34*/ 05396000
*/* PROCEDURE NAME - RCATVSAM                                @Y30LB34*/ 05397000
*/*                                                          @Y30LB34*/ 05398000
*/* FUNCTION - RECATALOGS DATA SETS IN THE VSAM CATALOG      @Y30LB34*/ 05399000
*/*            OWNING THE VOLUME                             @Y30LB34*/ 05400000
*/*                                                          @Y30LB34*/ 05401000
*/*            IF THE USER CATALOG IS ON THE CONVERTED       @Y30LB34*/ 05402000
*/*            VOLUME, OPENS THAT CATALOG WITH A MODIFIED    @Y30LB34*/ 05403000
*/*            JFCB                                          @Y30LB34*/ 05404000
*/*                                                          @Y30LB34*/ 05405000
*/*            IF A CATALOG DD NAME WAS SUPPLIED IN A        @Y30LB34*/ 05406000
*/*            CONTROL STATEMENT AND THE USER CATALOG IS     @Y30LB34*/ 05407000
*/*            NOT ON THE VOLUME, OPENS THE CATALOG          @Y30LB34*/ 05408000
*/*                                                          @Y30LB34*/ 05409000
*/*            PRINTS ERROR MESSAGE IDC3010I IF THE CATALOG  @ZM34301*/ 05410000
*/*            CANNOT BE OPENED                              @Y30LB34*/ 05411000
*/*                                                          @Y30LB34*/ 05412000
*/*            INITIALIZES THE CATALOG PARAMETER LIST AND    @Y30LB34*/ 05413000
*/*            AND THE FIELD PARAMETER LISTS FOR UCATLG      @Y30LB34*/ 05414000
*/*                                                          @Y30LB34*/ 05415000
*/*            ISSUES UCATLG TO RECATALOG ALL DATA SETS IN   @Y30LB34*/ 05416000
*/*            THE VSAM CATALOG                              @Y30LB34*/ 05417000
*/*                PRINTS MESSAGE IDC0746I IF THE DATA SETS  @Y30LB34*/ 05418000
*/*                ARE RECATALOGED,                          @Y30LB34*/ 05419000
*/*                PRINTS ERROR MESSAGE IDC3009I IF UCATLG   @Y30LB34*/ 05420000
*/*                WAS UNSUCCESSFUL AND RETURNED A REASON    @Y30LB34*/ 05421000
*/*                CODE IN THE CATALOG PARM LIST,            @Y30LB34*/ 05422000
*/*                PRINTS ERROR MESSAGE IDC3007I IF UCATLG   @Y30LB34*/ 05423000
*/*                WAS UNSUCCESSFUL AND NO REASON CODE WAS   @Y30LB34*/ 05424000
*/*                RETURNED                                  @Y30LB34*/ 05425000
*/*                                                          @Y30LB34*/ 05426000
*/*            CLOSES THE CATALOG IF CONVERTV OPENED IT      @Y30LB34*/ 05427000
*/*                                                          @Y30LB34*/ 05428000
*/* INPUT - FUNCTION DATA TABLE, TARGAREA, FRVS1AGL, OPNAGL  @Y30LB34*/ 05429000
*/*          CTGPL, CTGFL, DARGLIST                          @Y30LB34*/ 05430000
*/*                                                          @Y30LB34*/ 05431000
*/* OUTPUT - INITIALIZED OPNAGL, CTGPL AND CTGFLS            @Y30LB34*/ 05432000
*/*                                                          @Y30LB34*/ 05433000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 05434000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 05435000
*/*           R. C. =  4, UNABLE TO CLOSE CATALOG            @Y30LB34*/ 05436000
*/*           R. C. = 12, UNABLE TO OPEN CATALOG,            @Y30LB34*/ 05437000
*/*                       UNABLE TO RECATALOG VSAM DATA SETS @Y30LB34*/ 05438000
*/*                                                          @Y30LB34*/ 05439000
*/********************************************************** @Y30LB34*/ 05440000
*                                                                  1323 05441000
*RCATVSAM:                                                         1323 05442000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 05443000
*                                                                  1323 05444000
RCATVSAM DS    0H                                                  1324 05445000
*   /*****************************************************************/ 05446000
*   /*                                                               */ 05447000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 05448000
*   /*                                                               */ 05449000
*   /*****************************************************************/ 05450000
*                                                                  1324 05451000
*   DCL                                                            1324 05452000
*     CC16 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   05453000
*                                      CODE SAVE AREA        @Y30LB34*/ 05454000
*   DCL                                                            1325 05455000
*     DEVLNGTH FIXED(31) CONSTANT(4);/* DEVICE LENGTH        @Y30LB34*/ 05456000
*   DCL                                                            1326 05457000
*     VOLLNGTH FIXED(31) CONSTANT(6);/* VOLSER LENGTH        @Y30LB34*/ 05458000
*   DCL                                                            1327 05459000
*     UPDATE BIT(8) CONSTANT('00'X);/* CTGFL CODE            @Y30LB34*/ 05460000
*   DCL                                                            1328 05461000
*     EQUAL BIT(8) CONSTANT('80'X); /* CTGFL CODE            @Y30LB34*/ 05462000
*                                                                  1328 05463000
*   /*****************************************************************/ 05464000
*   /*                                                               */ 05465000
*   /* POINTERS AND AREAS FOR UCATLG                         @Y30LB34*/ 05466000
*   /*                                                               */ 05467000
*   /*****************************************************************/ 05468000
*                                                                  1329 05469000
*   DCL                                                            1329 05470000
*     CTGPLPTR PTR(31);             /* POINTER TO CTGPL      @Y30LB34*/ 05471000
*   DCL                                                            1330 05472000
*     CTGFLPTR PTR(31);             /* POINTER TO CTGFL      @Y30LB34*/ 05473000
*   DCL                                                            1331 05474000
*     CTGPLAR CHAR(LENGTH(CTGPL)+LENGTH(CTGFIELD)) BDY(WORD);/* AREA    05475000
*                                      FOR CTGPL             @Y30LB34*/ 05476000
*   DCL                                                            1332 05477000
*     CTGFLAR1 CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT)) BDY(WORD);/* AREA   05478000
*                                      FOR FIRST CTGFL       @Y30LB34*/ 05479000
*   DCL                                                            1333 05480000
*     CTGFLAR2 CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT)) BDY(WORD);/* AREA   05481000
*                                      FOR SECOND CTGFL      @Y30LB34*/ 05482000
*   DCL                                                            1334 05483000
*     CTGFLAR3 CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT)) BDY(WORD);/* AREA   05484000
*                                      FOR THIRD CTGFL       @Y30LB34*/ 05485000
*                                                                  1335 05486000
*   /*****************************************************************/ 05487000
*   /*                                                               */ 05488000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 05489000
*   /*                                                               */ 05490000
*   /*****************************************************************/ 05491000
*                                                                  1335 05492000
*   OLDERID2=NEWERID2;                                             1335 05493000
         L     @08,@PC00001                                        1335 05494000
         L     @08,GDTTR2(,@08)                                    1335 05495000
         MVC   @TS00001(95),NEWERID2(@08)                          1335 05496000
         MVC   OLDERID2(95,@08),@TS00001                           1335 05497000
*   NEWID2='CNTG';                  /*                       @Y30LB34*/ 05498000
*                                                                  1336 05499000
         MVC   NEWID2(4,@08),@CC01794                              1336 05500000
*   /*****************************************************************/ 05501000
*   /*                                                               */ 05502000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 05503000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 05504000
*   /*                                                               */ 05505000
*   /*****************************************************************/ 05506000
*                                                                  1337 05507000
*   CC16=LASTCC00;                  /*                       @Y30LB34*/ 05508000
         SLR   @08,@08                                             1337 05509000
         STH   @08,CC16                                            1337 05510000
*   RTNREG4=REG14;                  /*                       @Y30LB34*/ 05511000
*                                                                  1338 05512000
         ST    REG14,RTNREG4                                       1338 05513000
*   /*****************************************************************/ 05514000
*   /*                                                               */ 05515000
*   /* ESTABLISH ADDRESSABILITY TO CATALOG DATA AREAS        @Y30LB34*/ 05516000
*   /*                                                               */ 05517000
*   /*****************************************************************/ 05518000
*                                                                  1339 05519000
*   CTGPLPTR=ADDR(CTGPLAR);         /*                       @Y30LB34*/ 05520000
         LA    @15,CTGPLAR                                         1339 05521000
         ST    @15,CTGPLPTR                                        1339 05522000
*   CTGFLPTR=ADDR(CTGFLAR1);        /*                       @Y30LB34*/ 05523000
*                                                                  1340 05524000
         LA    CTGFLPTR,CTGFLAR1                                   1340 05525000
*   /*****************************************************************/ 05526000
*   /*                                                               */ 05527000
*   /* INITIALIZE DATA AREAS TO ZERO                         @Y30LB34*/ 05528000
*   /*                                                               */ 05529000
*   /*****************************************************************/ 05530000
*                                                                  1341 05531000
*   CTGPLAR=''B;                    /*                       @Y30LB34*/ 05532000
         XC    CTGPLAR(32),CTGPLAR                                 1341 05533000
*   CTGFLAR1=''B;                   /*                       @Y30LB34*/ 05534000
         XC    CTGFLAR1(24),CTGFLAR1                               1342 05535000
*   CTGFLAR2=''B;                   /*                       @Y30LB34*/ 05536000
         XC    CTGFLAR2(24),CTGFLAR2                               1343 05537000
*   CTGFLAR3=''B;                   /*                       @Y30LB34*/ 05538000
         XC    CTGFLAR3(24),CTGFLAR3                               1344 05539000
*   IOCSPTR=NULLPTR;                /*                       @Y30LB34*/ 05540000
*                                                                  1345 05541000
         ST    @08,IOCSPTR                                         1345 05542000
*   /*****************************************************************/ 05543000
*   /*                                                               */ 05544000
*   /* INITIALIZE VOLSER COUNT TO 1                          @Y30LB34*/ 05545000
*   /*                                                               */ 05546000
*   /*****************************************************************/ 05547000
*                                                                  1346 05548000
*   TCOUNT=ONE;                     /*                       @Y30LB34*/ 05549000
         MVI   TCOUNT,X'01'                                        1346 05550000
*                                                                  1347 05551000
*   /*****************************************************************/ 05552000
*   /*                                                               */ 05553000
*   /* IF THE VSAM USER CATALOG IS ON THE CONVERTED VOLUME   @Y30LB34*/ 05554000
*   /* OPNAGL IS INITIALIZED TO OPEN THE CATALOG WITH A      @Y30LB34*/ 05555000
*   /* MODIFIED JFCB. THE DD STATEMENT OF THE TARGET         @Y30LB34*/ 05556000
*   /* VOLUME IS USED SINCE THE USER CATALOG IS NOW ON       @Y30LB34*/ 05557000
*   /* THAT UNIT. THE CATALOG NAME AND VOLUME SERIAL         @Y30LB34*/ 05558000
*   /* NUMBER ARE SPECIFIED VIA THE OPEN.                    @Y30LB34*/ 05559000
*   /*                                                               */ 05560000
*   /*****************************************************************/ 05561000
*                                                                  1347 05562000
*   RESPECIFY                                                      1347 05563000
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/ 05564000
*   IF VSUCAT=ON THEN                                              1348 05565000
         LA    @15,FRVS1AGL                                        1348 05566000
         TM    VSUCAT(@15),B'01000000'                             1348 05567000
         BNO   @RF01348                                            1348 05568000
*     DO;                           /*                       @Y30LB34*/ 05569000
*       OPNTYPCI=ON;                /*                       @Y30LB34*/ 05570000
         OI    OPNTYPCI(OPNPTR),B'00100000'                        1350 05571000
*       OPNOPTJM=ON;                /*                       @Y30LB34*/ 05572000
         OI    OPNOPTJM(OPNPTR),B'00100000'                        1351 05573000
*       OPNIOC=ADDR(IOCSPTR);       /*                       @Y30LB34*/ 05574000
         LA    @15,IOCSPTR                                         1352 05575000
         ST    @15,OPNIOC(,OPNPTR)                                 1352 05576000
*       OPNOPTUP=ON;                /*                       @Y30LB34*/ 05577000
         OI    OPNOPTUP(OPNPTR),B'00100000'                        1353 05578000
*       OPNDDN=ADDR(TFILEVAL);      /*                       @ZM30744*/ 05579000
         L     @15,@PC00001+4                                      1354 05580000
         L     @01,FDTPTR+4(,@15)                                  1354 05581000
         LA    @14,TFILEVAL(,@01)                                  1354 05582000
         ST    @14,OPNDDN(,OPNPTR)                                 1354 05583000
*       OPNDSN=ADDR(CATNVAL);       /*                       @Y30LB34*/ 05584000
         L     @15,FDTPTR+44(,@15)                                 1355 05585000
         LA    @14,CATNVAL(,@15)                                   1355 05586000
         ST    @14,OPNDSN(,OPNPTR)                                 1355 05587000
*       OPNVOL=ADDR(TVOLCNT);       /*                       @Y30LB34*/ 05588000
         LA    @14,TVOLCNT                                         1356 05589000
         ST    @14,OPNVOL(,OPNPTR)                                 1356 05590000
*       OPNMODRC=ON;                /*                       @Y30LB34*/ 05591000
         OI    OPNMODRC(OPNPTR),B'00100000'                        1357 05592000
*       OPNDSOAM=ON;                /*                       @ZM30985*/ 05593000
         OI    OPNDSOAM(OPNPTR),B'10000000'                        1358 05594000
*       IF ADDR(CATN)^=NULLPTR THEN                                1359 05595000
         CR    @15,@08                                             1359 05596000
         BE    @RF01359                                            1359 05597000
*         OPNPWA=ADDR(CATNPAS);     /*                       @Y30LB34*/ 05598000
         LA    @08,CATNPAS(,@15)                                   1360 05599000
         ST    @08,OPNPWA(,OPNPTR)                                 1360 05600000
*     END;                          /*                       @Y30LB34*/ 05601000
*                                                                  1361 05602000
*   /*****************************************************************/ 05603000
*   /*                                                               */ 05604000
*   /* IF THE VSAM USER CATALOG IS NOT ON THE CONVERTED      @Y30LB34*/ 05605000
*   /* VOLUME BUT A DD NAME WAS SUPPLIED,                    @Y30LB34*/ 05606000
*   /* INITIALIZE OPNAGL TO OPEN THE                         @Y30LB34*/ 05607000
*   /* CATALOG WITH A REGULAR OPEN.                          @Y30LB34*/ 05608000
*   /*                                                               */ 05609000
*   /*****************************************************************/ 05610000
*                                                                  1362 05611000
*   ELSE                                                           1362 05612000
*     IF ADDR(CATDD)^=NULLPTR THEN                                 1362 05613000
         B     @RC01348                                            1362 05614000
@RF01348 SLR   @08,@08                                             1362 05615000
         L     @15,@PC00001+4                                      1362 05616000
         C     @08,FDTPTR+48(,@15)                                 1362 05617000
         BE    @RF01362                                            1362 05618000
*       DO;                         /*                       @Y30LB34*/ 05619000
*         OPNOPTUP=ON;              /*                       @Y30LB34*/ 05620000
         OI    OPNOPTUP(OPNPTR),B'00100000'                        1364 05621000
*         OPNTYPCI=ON;              /*                       @Y30LB34*/ 05622000
         OI    OPNTYPCI(OPNPTR),B'00100000'                        1365 05623000
*         OPNIOC=ADDR(IOCSPTR);     /*                       @Y30LB34*/ 05624000
         LA    @14,IOCSPTR                                         1366 05625000
         ST    @14,OPNIOC(,OPNPTR)                                 1366 05626000
*         OPNDDN=ADDR(SCATDD);      /*                       @Y30LB34*/ 05627000
         LA    @14,SCATDD                                          1367 05628000
         ST    @14,OPNDDN(,OPNPTR)                                 1367 05629000
*         OPNMODRC=ON;              /*                       @Y30LB34*/ 05630000
         OI    OPNMODRC(OPNPTR),B'00100000'                        1368 05631000
*         IF ADDR(CATN)^=NULLPTR THEN                              1369 05632000
         L     @15,FDTPTR+44(,@15)                                 1369 05633000
         CR    @15,@08                                             1369 05634000
         BE    @RF01369                                            1369 05635000
*           OPNPWA=ADDR(CATNPAS);   /*                       @Y30LB34*/ 05636000
         LA    @08,CATNPAS(,@15)                                   1370 05637000
         ST    @08,OPNPWA(,OPNPTR)                                 1370 05638000
*       END;                        /*                       @Y30LB34*/ 05639000
@RF01369 DS    0H                                                  1372 05640000
*                                                                  1372 05641000
*   /*****************************************************************/ 05642000
*   /*                                                               */ 05643000
*   /* IF OPNAGL WAS INITIALIZED THEN OPEN THE CATALOG       @Y30LB34*/ 05644000
*   /* AND SET THE FLAG SAYING CONVERTV DID THE OPEN         @Y30LB34*/ 05645000
*   /*                                                               */ 05646000
*   /*****************************************************************/ 05647000
*                                                                  1372 05648000
*   IF OPNTYPCI=ON THEN                                            1372 05649000
@RF01362 DS    0H                                                  1372 05650000
@RC01348 TM    OPNTYPCI(OPNPTR),B'00100000'                        1372 05651000
         BNO   @RF01372                                            1372 05652000
*     DO;                           /*                       @Y30LB34*/ 05653000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Y30LB34*/ 05654000
         L     @08,@PC00001                                        1374 05655000
         ST    @08,@AL00001                                        1374 05656000
         ST    OPNPTR,@AL00001+4                                   1374 05657000
         MVI   @AL00001+4,X'80'                                    1374 05658000
         L     @15,GDTOPN(,@08)                                    1374 05659000
         LA    @01,@AL00001                                        1374 05660000
         BALR  @14,@15                                             1374 05661000
*       RESPECIFY                                                  1375 05662000
*         RTNREG RSTD;                                             1375 05663000
*       TESTRC=RTNREG;                                             1376 05664000
         STH   RTNREG,TESTRC                                       1376 05665000
*       RESPECIFY                                                  1377 05666000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 05667000
*                                                                  1377 05668000
*       /*************************************************************/ 05669000
*       /*                                                           */ 05670000
*       /* IF THE RETURN CODE FROM OPEN IS NOT ZERO,         @Y30LB34*/ 05671000
*       /* DETERMINE IF OPEN WAS PARTIALLY SUCCESSFUL AND    @Y30LB34*/ 05672000
*       /* CONTINUATION IS POSSIBLE                          @Y30LB34*/ 05673000
*       /*                                                           */ 05674000
*       /*************************************************************/ 05675000
*                                                                  1378 05676000
*       IF TESTRC>0 THEN                                           1378 05677000
         LH    @08,TESTRC                                          1378 05678000
         LTR   @08,@08                                             1378 05679000
         BNP   @RF01378                                            1378 05680000
*         DO;                       /*                       @Y30LB34*/ 05681000
*                                                                  1379 05682000
*           /*********************************************************/ 05683000
*           /*                                                       */ 05684000
*           /* CATALOG WAS OPENED, SET CONDITION CODE TO 4   @Y30LB34*/ 05685000
*           /* AND CONTINUE                                  @Y30LB34*/ 05686000
*           /*                                                       */ 05687000
*           /*********************************************************/ 05688000
*                                                                  1380 05689000
*           IF IOCMSGOP=ON THEN                                    1380 05690000
         L     @08,IOCSPTR                                         1380 05691000
         TM    IOCMSGOP(@08),B'00100000'                           1380 05692000
         BNO   @RF01380                                            1380 05693000
*             CC16=LASTCC04;        /*                       @Y30LB34*/ 05694000
*                                                                  1381 05695000
         MVC   CC16(2),@CH00036                                    1381 05696000
*           /*********************************************************/ 05697000
*           /*                                                       */ 05698000
*           /* IF THE CATALOG WAS NOT OPENED SET CONDITION   @Y30LB34*/ 05699000
*           /* CODE TO 12 AND PRINT MSG: UNABLE TO OPEN      @ZM34301*/ 05700000
*           /* (CATALOG NAME)                                @ZM34301*/ 05701000
*           /*                                                       */ 05702000
*           /*********************************************************/ 05703000
*                                                                  1382 05704000
*           ELSE                    /*                       @ZM34301*/ 05705000
*             DO;                   /*                       @ZM34301*/ 05706000
         B     @RC01380                                            1382 05707000
@RF01380 DS    0H                                                  1383 05708000
*               DARGSMOD=UNIVMSG;   /*                       @ZM34301*/ 05709000
         L     @08,DDSTRU                                          1383 05710000
         MVC   DARGSMOD(3,@08),@CC01553                            1383 05711000
*               DARGSENT=MSG3010I;  /*                       @ZM34301*/ 05712000
         MVI   DARGSENT(@08),X'0B'                                 1384 05713000
*               DARGDBP=ADDR(CATNVAL);/*                     @ZM34301*/ 05714000
         L     @15,@PC00001+4                                      1385 05715000
         L     @01,FDTPTR+44(,@15)                                 1385 05716000
         LA    @15,CATNVAL(,@01)                                   1385 05717000
         ST    @15,DARGDBP(,@08)                                   1385 05718000
*               DARGILP=LENGTH(CATNVAL);/*                   @ZM34301*/ 05719000
         MVC   DARGILP(2,@08),@CH00608                             1386 05720000
*               DARGRETP=0;         /*                       @ZM34301*/ 05721000
         SLR   @15,@15                                             1387 05722000
         ST    @15,DARGRETP(,@08)                                  1387 05723000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @ZM34301*/ 05724000
         L     @08,@PC00001                                        1388 05725000
         ST    @08,@AL00001                                        1388 05726000
         LA    @15,@CF00115                                        1388 05727000
         ST    @15,@AL00001+4                                      1388 05728000
         LA    @15,DDSTRU                                          1388 05729000
         ST    @15,@AL00001+8                                      1388 05730000
         MVI   @AL00001+8,X'80'                                    1388 05731000
         L     @15,GDTPRT(,@08)                                    1388 05732000
         LA    @01,@AL00001                                        1388 05733000
         BALR  @14,@15                                             1388 05734000
*               CC16=LASTCC12;      /*                       @ZM34301*/ 05735000
         MVC   CC16(2),@CH00567                                    1389 05736000
*             END;                  /*                       @ZM34301*/ 05737000
*         END;                      /*                       @ZM34301*/ 05738000
@RC01380 DS    0H                                                  1392 05739000
*     END;                          /*                       @Y30LB34*/ 05740000
@RF01378 DS    0H                                                  1393 05741000
*                                                                  1393 05742000
*   /*****************************************************************/ 05743000
*   /*                                                               */ 05744000
*   /* IF NO SEVERE ERRORS OCCURRED IN OPENING THE CATALOG   @Y30LB34*/ 05745000
*   /* OR CONVERTV DID NOT OPEN THE CATALOG, CONTINUE WITH   @Y30LB34*/ 05746000
*   /* RECATALOGING THE VSAM DATA SETS                       @Y30LB34*/ 05747000
*   /*                                                               */ 05748000
*   /*****************************************************************/ 05749000
*                                                                  1393 05750000
*   IF CC16<LASTCC12 THEN                                          1393 05751000
@RF01372 LH    @08,CC16                                            1393 05752000
         C     @08,@CF00567                                        1393 05753000
         BNL   @RF01393                                            1393 05754000
*     DO;                           /*                       @Y30LB34*/ 05755000
*                                                                  1394 05756000
*       /*************************************************************/ 05757000
*       /*                                                           */ 05758000
*       /* INITIALIZE THE CATALOG PARAMETER LIST AND A       @Y30LB34*/ 05759000
*       /* CHAIN OF THREE FIELD PARAMETER LISTS              @Y30LB34*/ 05760000
*       /*                                                           */ 05761000
*       /*************************************************************/ 05762000
*                                                                  1395 05763000
*       CTGNAME=ON;                 /*                       @Y30LB34*/ 05764000
         L     @08,CTGPLPTR                                        1395 05765000
         OI    CTGNAME(@08),B'00000100'                            1395 05766000
*       CTGFUNC=CTGCMS;             /*                       @Y30LB34*/ 05767000
         NI    CTGFUNC(@08),B'10011111'                            1396 05768000
         OI    CTGFUNC(@08),B'10000000'                            1396 05769000
*       CTGAM0=ON;                  /*                       @Y30LB34*/ 05770000
         OI    CTGAM0(@08),B'00000001'                             1397 05771000
*       CTGENT=ADDR(CNVOLAR);       /*                       @ZM00735*/ 05772000
         LA    @15,CNVOLAR                                         1398 05773000
         ST    @15,CTGENT(,@08)                                    1398 05774000
*       CNVOLAR=''B;                /* CLEAR AREA            @ZM00735*/ 05775000
         XC    CNVOLAR(44),CNVOLAR                                 1399 05776000
*       CNVOLAR(1:6)=TVOLSER;       /* AND INSERT VOLSER     @ZM00735*/ 05777000
         MVC   CNVOLAR(6),TVOLSER                                  1400 05778000
*       CTGDDNM=ADDR(TFILEVAL);     /*                       @ZM31016*/ 05779000
         L     @15,@PC00001+4                                      1401 05780000
         L     @01,FDTPTR+4(,@15)                                  1401 05781000
         LA    @15,TFILEVAL(,@01)                                  1401 05782000
         ST    @15,CTGDDNM(,@08)                                   1401 05783000
*       IF IOCSPTR^=NULLPTR THEN    /*                       @ZM31016*/ 05784000
         L     @15,IOCSPTR                                         1402 05785000
         LTR   @15,@15                                             1402 05786000
         BZ    @RF01402                                            1402 05787000
*         CTGCAT=ADDR(IOCCBP);      /*                       @ZM00734*/ 05788000
         LA    @15,IOCCBP(,@15)                                    1403 05789000
         ST    @15,CTGCAT(,@08)                                    1403 05790000
*       ELSE                                                       1404 05791000
*         IF ADDR(CATN)^=NULLPTR THEN                              1404 05792000
         B     @RC01402                                            1404 05793000
@RF01402 L     @08,@PC00001+4                                      1404 05794000
         L     @08,FDTPTR+44(,@08)                                 1404 05795000
         LTR   @08,@08                                             1404 05796000
         BZ    @RF01404                                            1404 05797000
*           DO;                     /*                       @Y30LB34*/ 05798000
*             CTGCNAME=ON;          /*                       @Y30LB34*/ 05799000
         L     @15,CTGPLPTR                                        1406 05800000
         OI    CTGCNAME(@15),B'00000010'                           1406 05801000
*             CTGCAT=ADDR(CATNVAL); /*                       @ZM00735*/ 05802000
         LA    @08,CATNVAL(,@08)                                   1407 05803000
         ST    @08,CTGCAT(,@15)                                    1407 05804000
*           END;                    /*                       @Y30LB34*/ 05805000
*       CTGOPTNS=CTGCNVTV;          /*                       @Y30LB34*/ 05806000
@RF01404 DS    0H                                                  1409 05807000
@RC01402 L     @08,CTGPLPTR                                        1409 05808000
         NI    CTGOPTNS(@08),B'00110111'                           1409 05809000
         OI    CTGOPTNS(@08),B'00110000'                           1409 05810000
*       CTGNOFLD=1;                 /*                       @ZM30990*/ 05811000
         MVI   CTGNOFLD(@08),X'01'                                 1410 05812000
*       CTGFIELD(1)=ADDR(CTGFLAR1); /*                       @Y30LB34*/ 05813000
*                                                                  1411 05814000
         LA    @15,CTGFLAR1                                        1411 05815000
         ST    @15,CTGFIELD(,@08)                                  1411 05816000
*       /*************************************************************/ 05817000
*       /*                                                           */ 05818000
*       /* INITIALIZE FIRST FPL TO UPDATE THE DEVICE TYPE    @Y30LB34*/ 05819000
*       /* IN CATALOG                                        @Y30LB34*/ 05820000
*       /*                                                           */ 05821000
*       /*************************************************************/ 05822000
*                                                                  1412 05823000
*       CTGFLDNO=1;                 /*                       @XM30990*/ 05824000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1412 05825000
*       CTGFLDCD=UPDATE;            /*                       @Y30LB34*/ 05826000
         MVI   CTGFLDCD(CTGFLPTR),X'00'                            1413 05827000
*       CTGFLCHN=ADDR(CTGFLAR2);    /*                       @Y30LB34*/ 05828000
         LA    @08,CTGFLAR2                                        1414 05829000
         ST    @08,CTGFLCHN(,CTGFLPTR)                             1414 05830000
*       CTGFLNG(1)=DEVLNGTH;        /*                       @Y30LB34*/ 05831000
         LA    @15,4                                               1415 05832000
         ST    @15,CTGFLNG(,CTGFLPTR)                              1415 05833000
*       CTGFLPT(1)=ADDR(TDEVTYPE);  /*                       @Y30LB34*/ 05834000
         LA    @14,TDEVTYPE                                        1416 05835000
         ST    @14,CTGFLPT(,CTGFLPTR)                              1416 05836000
*       CTGFLDNM=ADDR(CNDEVTYP);    /*                       @ZM00735*/ 05837000
         LA    @14,CNDEVTYP                                        1417 05838000
         ST    @14,CTGFLDNM(,CTGFLPTR)                             1417 05839000
*       CTGFLPTR=ADDR(CTGFLAR2);    /*                       @Y30LB34*/ 05840000
         LR    CTGFLPTR,@08                                        1418 05841000
*                                                                  1419 05842000
*       /*************************************************************/ 05843000
*       /*                                                           */ 05844000
*       /* INITIALIZE SECOND FPL TO VERIFY THAT THE          @Y30LB34*/ 05845000
*       /* VOLSER IN CATALOG ENTRY MATCHES ORIGINAL          @Y30LB34*/ 05846000
*       /* TARGET VOLSER BEFORE UPDATING THE DEVICE TYPE     @Y30LB34*/ 05847000
*       /*                                                           */ 05848000
*       /*************************************************************/ 05849000
*                                                                  1419 05850000
*       CTGFLDNO=1;                 /*                       @XM30990*/ 05851000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1419 05852000
*       CTGFLDCD=EQUAL;             /*                       @Y30LB34*/ 05853000
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            1420 05854000
*       CTGFLCHN=ADDR(CTGFLAR3);    /*                       @Y30LB34*/ 05855000
         LA    @08,CTGFLAR3                                        1421 05856000
         ST    @08,CTGFLCHN(,CTGFLPTR)                             1421 05857000
*       CTGFLNG(1)=VOLLNGTH;        /*                       @Y30LB34*/ 05858000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00038                        1422 05859000
*       CTGFLPT(1)=ADDR(TVOLSER);   /*                       @Y30LB34*/ 05860000
         LA    @01,TVOLSER                                         1423 05861000
         ST    @01,CTGFLPT(,CTGFLPTR)                              1423 05862000
*       CTGFLDNM=ADDR(CNVOLSER);    /*                       @ZM00735*/ 05863000
         LA    @01,CNVOLSER                                        1424 05864000
         ST    @01,CTGFLDNM(,CTGFLPTR)                             1424 05865000
*       CTGFLPTR=ADDR(CTGFLAR3);    /*                       @Y30LB34*/ 05866000
*                                                                  1425 05867000
         LR    CTGFLPTR,@08                                        1425 05868000
*       /*************************************************************/ 05869000
*       /*                                                           */ 05870000
*       /* INITIALIZE THIRD FPL TO VERIFY THAT THE DEVICE    @Y30LB34*/ 05871000
*       /* TYPE IN CATALOG ENTRY MATCHES ORIGINAL TARGET     @Y30LB34*/ 05872000
*       /* DEVICE TYPE BEFORE UPDATING IT                    @Y30LB34*/ 05873000
*       /*                                                           */ 05874000
*       /*************************************************************/ 05875000
*                                                                  1426 05876000
*       CTGFLDNO=1;                 /*                       @XM30990*/ 05877000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1426 05878000
*       CTGFLDCD=EQUAL;             /*                       @Y30LB34*/ 05879000
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            1427 05880000
*       CTGFLCHN=NULLPTR;           /*                       @Y30LB34*/ 05881000
         SLR   @08,@08                                             1428 05882000
         ST    @08,CTGFLCHN(,CTGFLPTR)                             1428 05883000
*       CTGFLNG(1)=DEVLNGTH;        /*                       @Y30LB34*/ 05884000
         ST    @15,CTGFLNG(,CTGFLPTR)                              1429 05885000
*       CTGFLPT(1)=ADDR(SDEVTYPE);  /*                       @Y30LB34*/ 05886000
         LA    @08,SDEVTYPE                                        1430 05887000
         ST    @08,CTGFLPT(,CTGFLPTR)                              1430 05888000
*       CTGFLDNM=ADDR(CNDEVTYP);    /*                       @ZM00735*/ 05889000
         ST    @14,CTGFLDNM(,CTGFLPTR)                             1431 05890000
*                                                                  1432 05891000
*       /*************************************************************/ 05892000
*       /*                                                           */ 05893000
*       /* ISSUE UCATLG TO CONVERT THE VSAM CATALOG ENTRIES  @Y30LB34*/ 05894000
*       /* REFLECT THEIR CURRENT VOLSER AND DEVICE TYPE      @Y30LB34*/ 05895000
*       /*                                                           */ 05896000
*       /*************************************************************/ 05897000
*                                                                  1432 05898000
*       CALL IDCSACA0(GDTTBL,CTGPLPTR);/*                    @Y30LB34*/ 05899000
         L     @15,@PC00001                                        1432 05900000
         ST    @15,@AL00001                                        1432 05901000
         LA    @14,CTGPLPTR                                        1432 05902000
         ST    @14,@AL00001+4                                      1432 05903000
         L     @15,GDTCAT(,@15)                                    1432 05904000
         LA    @01,@AL00001                                        1432 05905000
         BALR  @14,@15                                             1432 05906000
*       RESPECIFY                                                  1433 05907000
*         RTNREG RSTD;                                             1433 05908000
*       TESTRC=RTNREG;                                             1434 05909000
         STH   RTNREG,TESTRC                                       1434 05910000
*       RESPECIFY                                                  1435 05911000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 05912000
*                                                                  1435 05913000
*       /*************************************************************/ 05914000
*       /*                                                           */ 05915000
*       /* IF CATALOG WAS SUCCESSFUL PRINT MESSAGE           @Y30LB34*/ 05916000
*       /* IDC0746I NOTIFYING THE VSAM RECATALOGING IS       @Y30LB34*/ 05917000
*       /* COMPLETE                                          @Y30LB34*/ 05918000
*       /*                                                           */ 05919000
*       /*************************************************************/ 05920000
*                                                                  1436 05921000
*       IF TESTRC=0 THEN                                           1436 05922000
         LH    @15,TESTRC                                          1436 05923000
         SLR   @14,@14                                             1436 05924000
         CR    @15,@14                                             1436 05925000
         BNE   @RF01436                                            1436 05926000
*         DO;                       /*                       @Y30LB34*/ 05927000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 05928000
         L     @15,DDSTRU                                          1438 05929000
         MVC   DARGSMOD(3,@15),@CC01557                            1438 05930000
*           DARGSENT=MSG0746I;      /*                       @Y30LB34*/ 05931000
         MVI   DARGSENT(@15),X'0A'                                 1439 05932000
*           DARGDBP=0;              /*                       @Y30LB34*/ 05933000
         ST    @14,DARGDBP(,@15)                                   1440 05934000
*           DARGILP=0;              /*                       @Y30LB34*/ 05935000
         STH   @14,DARGILP(,@15)                                   1441 05936000
*           DARGRETP=0;             /*                       @Y30LB34*/ 05937000
         ST    @14,DARGRETP(,@15)                                  1442 05938000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 05939000
         L     @15,@PC00001                                        1443 05940000
         ST    @15,@AL00001                                        1443 05941000
         LA    @14,@CF00115                                        1443 05942000
         ST    @14,@AL00001+4                                      1443 05943000
         LA    @14,DDSTRU                                          1443 05944000
         ST    @14,@AL00001+8                                      1443 05945000
         MVI   @AL00001+8,X'80'                                    1443 05946000
         L     @15,GDTPRT(,@15)                                    1443 05947000
         LA    @01,@AL00001                                        1443 05948000
         BALR  @14,@15                                             1443 05949000
*         END;                      /*                       @Y30LB34*/ 05950000
*                                                                  1445 05951000
*       /*************************************************************/ 05952000
*       /*                                                           */ 05953000
*       /* IF CATALOG WAS NOT SUCCESSFUL DETERMINE WHAT      @Y30LB34*/ 05954000
*       /* INFORMATION WAS RETURNED AND PRINT APPROPRIATE    @Y30LB34*/ 05955000
*       /* MESSAGE                                           @Y30LB34*/ 05956000
*       /*                                                           */ 05957000
*       /*************************************************************/ 05958000
*                                                                  1445 05959000
*       ELSE                                                       1445 05960000
*         DO;                       /*                       @Y30LB34*/ 05961000
         B     @RC01436                                            1445 05962000
@RF01436 DS    0H                                                  1446 05963000
*           CC16=LASTCC12;          /*                       @Y30LB34*/ 05964000
*                                                                  1446 05965000
         MVC   CC16(2),@CH00567                                    1446 05966000
*           /*********************************************************/ 05967000
*           /*                                                       */ 05968000
*           /* IF CMS RETURNED INFORMATION IN FEEDBACK       @Y30LB34*/ 05969000
*           /* AREA PRINT MESSAGE IDC3009I                   @Y30LB34*/ 05970000
*           /*                                                       */ 05971000
*           /*********************************************************/ 05972000
*                                                                  1447 05973000
*           IF CTGFDBK^=NULLPTR THEN                               1447 05974000
         L     @15,CTGPLPTR                                        1447 05975000
         LH    @14,CTGFDBK(,@15)                                   1447 05976000
         N     @14,@CF01899                                        1447 05977000
         LTR   @14,@14                                             1447 05978000
         BZ    @RF01447                                            1447 05979000
*             DO;                   /*                       @Y30LB34*/ 05980000
*               DARGSMOD=UNIVMSG;   /*                       @Y30LB34*/ 05981000
         L     @14,DDSTRU                                          1449 05982000
         MVC   DARGSMOD(3,@14),@CC01553                            1449 05983000
*               DARGSENT=MSG3009I;  /*                       @Y30LB34*/ 05984000
         MVI   DARGSENT(@14),X'0A'                                 1450 05985000
*               DARGRETP=0;         /*                       @Y30LB34*/ 05986000
         SLR   @09,@09                                             1451 05987000
         ST    @09,DARGRETP(,@14)                                  1451 05988000
*               DARGCNT=3;          /*                       @Y30LB34*/ 05989000
         LA    @09,3                                               1452 05990000
         STH   @09,DARGCNT(,@14)                                   1452 05991000
*               DARGINS(1)=1;       /*                       @Y30LB34*/ 05992000
         MVC   DARGINS(2,@14),@CH00217                             1453 05993000
*               DARGINL(1)=LENGTH(TESTRC);/*                 @Y30LB34*/ 05994000
         LA    @08,2                                               1454 05995000
         STH   @08,DARGINL(,@14)                                   1454 05996000
*               DARGDTM(1)=ADDR(TESTRC);/*                   @Y30LB34*/ 05997000
         LA    @01,TESTRC                                          1455 05998000
         ST    @01,DARGDTM(,@14)                                   1455 05999000
*               DARGINS(2)=2;       /*                       @Y30LB34*/ 06000000
         STH   @08,DARGINS+8(,@14)                                 1456 06001000
*               DARGINL(2)=LENGTH(CTGFDBK);/*                @Y30LB34*/ 06002000
         STH   @08,DARGINL+8(,@14)                                 1457 06003000
*               DARGDTM(2)=ADDR(CTGFDBK);/*                  @Y30LB34*/ 06004000
         LA    @01,CTGFDBK(,@15)                                   1458 06005000
         ST    @01,DARGDTM+8(,@14)                                 1458 06006000
*               DARGINS(3)=3;       /*                       @Y30LB34*/ 06007000
         STH   @09,DARGINS+16(,@14)                                1459 06008000
*               DARGINL(3)=2;       /*                       @Y30LB34*/ 06009000
         STH   @08,DARGINL+16(,@14)                                1460 06010000
*               DARGDTM(3)=ADDR(CTGFBFLG);/*                 @Y30LB34*/ 06011000
         LA    @15,CTGFBFLG(,@15)                                  1461 06012000
         ST    @15,DARGDTM+16(,@14)                                1461 06013000
*             END;                  /*                       @Y30LB34*/ 06014000
*                                                                  1462 06015000
*           /*********************************************************/ 06016000
*           /*                                                       */ 06017000
*           /* IF CMS DID NOT RETURN INFORMATION IN          @Y30LB34*/ 06018000
*           /* FEEDBACK AREA PRINT MESSAGE IDC3007I          @Y30LB34*/ 06019000
*           /*                                                       */ 06020000
*           /*********************************************************/ 06021000
*                                                                  1463 06022000
*           ELSE                                                   1463 06023000
*             DO;                   /*                       @Y30LB34*/ 06024000
         B     @RC01447                                            1463 06025000
@RF01447 DS    0H                                                  1464 06026000
*               DARGSMOD=UNIVMSG;   /*                       @Y30LB34*/ 06027000
         L     @15,DDSTRU                                          1464 06028000
         MVC   DARGSMOD(3,@15),@CC01553                            1464 06029000
*               DARGSENT=MSG3007I;  /*                       @Y30LB34*/ 06030000
         MVI   DARGSENT(@15),X'07'                                 1465 06031000
*               DARGDBP=ADDR(TESTRC);/*                      @Y30LB34*/ 06032000
         LA    @14,TESTRC                                          1466 06033000
         ST    @14,DARGDBP(,@15)                                   1466 06034000
*               DARGILP=LENGTH(TESTRC);/*                    @Y30LB34*/ 06035000
         MVC   DARGILP(2,@15),@CH00153                             1467 06036000
*               DARGRETP=0;         /*                       @Y30LB34*/ 06037000
         SLR   @14,@14                                             1468 06038000
         ST    @14,DARGRETP(,@15)                                  1468 06039000
*             END;                  /*                       @Y30LB34*/ 06040000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 06041000
@RC01447 L     @15,@PC00001                                        1470 06042000
         ST    @15,@AL00001                                        1470 06043000
         LA    @14,@CF00115                                        1470 06044000
         ST    @14,@AL00001+4                                      1470 06045000
         LA    @14,DDSTRU                                          1470 06046000
         ST    @14,@AL00001+8                                      1470 06047000
         MVI   @AL00001+8,X'80'                                    1470 06048000
         L     @15,GDTPRT(,@15)                                    1470 06049000
         LA    @01,@AL00001                                        1470 06050000
         BALR  @14,@15                                             1470 06051000
*                                                                  1471 06052000
*           /*********************************************************/ 06053000
*           /*                                                       */ 06054000
*           /* PRINT MESSAGE IDC3738I NOTIFYING              @Y30LB34*/ 06055000
*           /* UNSUCCESSFUL VSAM RECATALOGING                @Y30LB34*/ 06056000
*           /*                                                       */ 06057000
*           /*********************************************************/ 06058000
*                                                                  1471 06059000
*           PRINTTAB=''B;           /*                       @Y30LB34*/ 06060000
         XC    PRINTTAB(44),PRINTTAB                               1471 06061000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 06062000
         L     @15,DDSTRU                                          1472 06063000
         MVC   DARGSMOD(3,@15),@CC01557                            1472 06064000
*           DARGSENT=MSG3738I;      /*                       @Y30LB34*/ 06065000
         MVI   DARGSENT(@15),X'0E'                                 1473 06066000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 06067000
         L     @15,@PC00001                                        1474 06068000
         ST    @15,@AL00001                                        1474 06069000
         LA    @14,@CF00115                                        1474 06070000
         ST    @14,@AL00001+4                                      1474 06071000
         LA    @14,DDSTRU                                          1474 06072000
         ST    @14,@AL00001+8                                      1474 06073000
         MVI   @AL00001+8,X'80'                                    1474 06074000
         L     @15,GDTPRT(,@15)                                    1474 06075000
         LA    @01,@AL00001                                        1474 06076000
         BALR  @14,@15                                             1474 06077000
*         END;                      /*                       @Y30LB34*/ 06078000
*     END;                          /*                       @Y30LB34*/ 06079000
@RC01436 DS    0H                                                  1477 06080000
*                                                                  1477 06081000
*   /*****************************************************************/ 06082000
*   /*                                                               */ 06083000
*   /* ISSUE UCLOSE TO CLOSE THE CATALOG                     @Y30LB34*/ 06084000
*   /*                                                               */ 06085000
*   /*****************************************************************/ 06086000
*                                                                  1477 06087000
*   IF IOCSPTR^=NULLPTR THEN                                       1477 06088000
@RF01393 L     @15,IOCSPTR                                         1477 06089000
         LTR   @15,@15                                             1477 06090000
         BZ    @RF01477                                            1477 06091000
*     DO;                           /*                       @Y30LB34*/ 06092000
*       CALL IDCIOCL0(GDTTBL,IOCSPTR);/*                     @Y30LB34*/ 06093000
         L     @15,@PC00001                                        1479 06094000
         ST    @15,@AL00001                                        1479 06095000
         LA    @14,IOCSPTR                                         1479 06096000
         ST    @14,@AL00001+4                                      1479 06097000
         MVI   @AL00001+4,X'80'                                    1479 06098000
         L     @15,GDTCLS(,@15)                                    1479 06099000
         LA    @01,@AL00001                                        1479 06100000
         BALR  @14,@15                                             1479 06101000
*       RESPECIFY                                                  1480 06102000
*         RTNREG RSTD;                                             1480 06103000
*       TESTRC=RTNREG;                                             1481 06104000
         STH   RTNREG,TESTRC                                       1481 06105000
*       RESPECIFY                                                  1482 06106000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 06107000
*       CC16=MAX(CC16,TESTRC);      /*                       @Y30LB34*/ 06108000
         LH    @15,TESTRC                                          1483 06109000
         LH    @14,CC16                                            1483 06110000
         CR    @14,@15                                             1483 06111000
         BNL   *+6                                                      06112000
         LR    @14,@15                                             1483 06113000
         STH   @14,CC16                                            1483 06114000
*     END;                          /*                       @Y30LB34*/ 06115000
*                                                                  1484 06116000
*   /*****************************************************************/ 06117000
*   /*                                                               */ 06118000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 06119000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 06120000
*   /*                                                               */ 06121000
*   /*****************************************************************/ 06122000
*                                                                  1485 06123000
*   REG14=RTNREG4;                  /*                       @Y30LB34*/ 06124000
@RF01477 L     REG14,RTNREG4                                       1485 06125000
*   RETURN CODE(CC16);              /*                       @Y30LB34*/ 06126000
         LH    @15,CC16                                            1486 06127000
@EL00017 DS    0H                                                  1486 06128000
@EF00017 DS    0H                                                  1486 06129000
@ER00017 BR    @14                                                 1486 06130000
*   END RCATVSAM;                   /*                       @Y30LB34*/ 06131000
*                                                                  1488 06132000
*/********************************************************** @Y30LB34*/ 06133000
*/*                                                          @Y30LB34*/ 06134000
*/* PROCEDURE NAME - RVSCRV                                  @Y30LB34*/ 06135000
*/*                                                          @Y30LB34*/ 06136000
*/* FUNCTION - CALLS VOLUME SERVICES TO SCRATCH THE VTOC ON  @Y30LB34*/ 06137000
*/*            THEN SOURCE VOLUME                            @Y30LB34*/ 06138000
*/*                                                          @Y30LB34*/ 06139000
*/*            CLOSES THE VTOC                               @Y30LB34*/ 06140000
*/*                                                          @Y30LB34*/ 06141000
*/*            PRINTS MESSAGE IDC0749I IF THE VTOC IS        @Y30LB34*/ 06142000
*/*            SCRATCHED                                     @Y30LB34*/ 06143000
*/*                                                          @Y30LB34*/ 06144000
*/* INPUT - FRVS1AGL, DARGLIST                               @Y30LB34*/ 06145000
*/*                                                          @Y30LB34*/ 06146000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 06147000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 06148000
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/ 06149000
*/*           R. C. =  8, UNABLE TO SCRATCH VTOC             @Y30LB34*/ 06150000
*/*                                                          @Y30LB34*/ 06151000
*/********************************************************** @Y30LB34*/ 06152000
*                                                                  1488 06153000
*RVSCRV:                                                           1488 06154000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 06155000
*                                                                  1488 06156000
RVSCRV   DS    0H                                                  1489 06157000
*   /*****************************************************************/ 06158000
*   /*                                                               */ 06159000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 06160000
*   /*                                                               */ 06161000
*   /*****************************************************************/ 06162000
*                                                                  1489 06163000
*   DCL                                                            1489 06164000
*     CC17 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   06165000
*                                      CODE SAVE AREA        @Y30LB34*/ 06166000
*                                                                  1490 06167000
*   /*****************************************************************/ 06168000
*   /*                                                               */ 06169000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 06170000
*   /*                                                               */ 06171000
*   /*****************************************************************/ 06172000
*                                                                  1490 06173000
*   OLDERID2=NEWERID2;                                             1490 06174000
         L     @08,@PC00001                                        1490 06175000
         L     @15,GDTTR2(,@08)                                    1490 06176000
         MVC   @TS00001(95),NEWERID2(@15)                          1490 06177000
         MVC   OLDERID2(95,@15),@TS00001                           1490 06178000
*   NEWID2='CNTH';                  /*                       @Y30LB34*/ 06179000
*                                                                  1491 06180000
         MVC   NEWID2(4,@15),@CC01801                              1491 06181000
*   /*****************************************************************/ 06182000
*   /*                                                               */ 06183000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 06184000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 06185000
*   /*                                                               */ 06186000
*   /*****************************************************************/ 06187000
*                                                                  1492 06188000
*   CC17=LASTCC00;                  /*                       @Y30LB34*/ 06189000
         SLR   CC17,CC17                                           1492 06190000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 06191000
*                                                                  1493 06192000
         LR    RTNREG2,REG14                                       1493 06193000
*   /*****************************************************************/ 06194000
*   /*                                                               */ 06195000
*   /* CALL VOLUME SERVICES TO SCRATCH THE SOURCE VOLUME     @Y30LB34*/ 06196000
*   /* VTOC                                                  @Y30LB34*/ 06197000
*   /*                                                               */ 06198000
*   /*****************************************************************/ 06199000
*                                                                  1494 06200000
*   RESPECIFY                                                      1494 06201000
*     VS1AGL BASED(ADDR(FRVS1AGL)); /*                       @Y30LB34*/ 06202000
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',SCRVTOC,VS1AGL);/*       @Y30LB34*/ 06203000
         ST    @08,@AL00001                                        1495 06204000
         LA    @15,@CC01720                                        1495 06205000
         ST    @15,@AL00001+4                                      1495 06206000
         LA    @15,SCRVTOC                                         1495 06207000
         ST    @15,@AL00001+8                                      1495 06208000
         LA    @15,FRVS1AGL                                        1495 06209000
         ST    @15,@AL00001+12                                     1495 06210000
         MVI   @AL00001+12,X'80'                                   1495 06211000
         L     @15,GDTCAL(,@08)                                    1495 06212000
         LA    @01,@AL00001                                        1495 06213000
         BALR  @14,@15                                             1495 06214000
*   RESPECIFY                                                      1496 06215000
*     RTNREG RSTD;                                                 1496 06216000
*   TESTRC=RTNREG;                                                 1497 06217000
         STH   RTNREG,TESTRC                                       1497 06218000
*   RESPECIFY                                                      1498 06219000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 06220000
*                                                                  1498 06221000
*   /*****************************************************************/ 06222000
*   /*                                                               */ 06223000
*   /* IF VOLUME SERVICES WAS UNABLE TO SCRATCH THE VTOC     @Y30LB34*/ 06224000
*   /* SET CONDITION CODE TO 8                               @Y30LB34*/ 06225000
*   /*                                                               */ 06226000
*   /*****************************************************************/ 06227000
*                                                                  1499 06228000
*   IF TESTRC>0 THEN                                               1499 06229000
         LH    @08,TESTRC                                          1499 06230000
         LTR   @08,@08                                             1499 06231000
         BNP   @RF01499                                            1499 06232000
*     CC17=LASTCC08;                /*                       @Y30LB34*/ 06233000
         LA    CC17,8                                              1500 06234000
*                                                                  1501 06235000
*   /*****************************************************************/ 06236000
*   /*                                                               */ 06237000
*   /* IF VOLUME SERVICES OPENED THE VTOC, CLOSE IT          @Y30LB34*/ 06238000
*   /* AND SET THE IOCSTR POINTER TO 0                       @Y30LB34*/ 06239000
*   /*                                                               */ 06240000
*   /*****************************************************************/ 06241000
*                                                                  1501 06242000
*   IF VSIOP^=NULLPTR THEN                                         1501 06243000
@RF01499 LA    @08,FRVS1AGL                                        1501 06244000
         L     @15,VSIOP(,@08)                                     1501 06245000
         LTR   @15,@15                                             1501 06246000
         BZ    @RF01501                                            1501 06247000
*     DO;                           /*                       @Y30LB34*/ 06248000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB34*/ 06249000
         L     @15,@PC00001                                        1503 06250000
         ST    @15,@AL00001                                        1503 06251000
         LA    @08,VSIOP(,@08)                                     1503 06252000
         ST    @08,@AL00001+4                                      1503 06253000
         MVI   @AL00001+4,X'80'                                    1503 06254000
         L     @15,GDTCLS(,@15)                                    1503 06255000
         LA    @01,@AL00001                                        1503 06256000
         BALR  @14,@15                                             1503 06257000
*       RESPECIFY                                                  1504 06258000
*         RTNREG RSTD;                                             1504 06259000
*       TESTRC=RTNREG;                                             1505 06260000
         STH   RTNREG,TESTRC                                       1505 06261000
*       RESPECIFY                                                  1506 06262000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 06263000
*       CC17=MAX(CC17,TESTRC);      /*                       @Y30LB34*/ 06264000
         LH    @08,TESTRC                                          1507 06265000
         CR    CC17,@08                                            1507 06266000
         BNL   *+6                                                      06267000
         LR    CC17,@08                                            1507 06268000
*       VSIOP=NULLPTR;              /*                       @Y30LB34*/ 06269000
         LA    @08,FRVS1AGL                                        1508 06270000
         SLR   @15,@15                                             1508 06271000
         ST    @15,VSIOP(,@08)                                     1508 06272000
*     END;                          /*                       @Y30LB34*/ 06273000
*                                                                  1509 06274000
*   /*****************************************************************/ 06275000
*   /*                                                               */ 06276000
*   /* IF THE VTOC WAS SCRATCHED, PRINT MESSAGE IDC0749I     @Y30LB34*/ 06277000
*   /* NOTIFYING THE USER                                    @Y30LB34*/ 06278000
*   /*                                                               */ 06279000
*   /*****************************************************************/ 06280000
*                                                                  1510 06281000
*   IF CC17<LASTCC08 THEN                                          1510 06282000
@RF01501 C     CC17,@CF00177                                       1510 06283000
         BNL   @RF01510                                            1510 06284000
*     DO;                           /*                       @Y30LB34*/ 06285000
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/ 06286000
         L     @08,DDSTRU                                          1512 06287000
         MVC   DARGSMOD(3,@08),@CC01557                            1512 06288000
*       DARGSENT=MSG0749I;          /*                       @Y30LB34*/ 06289000
         MVI   DARGSENT(@08),X'0D'                                 1513 06290000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 06291000
         SLR   @15,@15                                             1514 06292000
         ST    @15,DARGDBP(,@08)                                   1514 06293000
*       DARGILP=0;                  /*                       @Y30LB34*/ 06294000
         STH   @15,DARGILP(,@08)                                   1515 06295000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 06296000
         ST    @15,DARGRETP(,@08)                                  1516 06297000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 06298000
         L     @08,@PC00001                                        1517 06299000
         ST    @08,@AL00001                                        1517 06300000
         LA    @15,@CF00115                                        1517 06301000
         ST    @15,@AL00001+4                                      1517 06302000
         LA    @15,DDSTRU                                          1517 06303000
         ST    @15,@AL00001+8                                      1517 06304000
         MVI   @AL00001+8,X'80'                                    1517 06305000
         L     @15,GDTPRT(,@08)                                    1517 06306000
         LA    @01,@AL00001                                        1517 06307000
         BALR  @14,@15                                             1517 06308000
*     END;                          /*                       @Y30LB34*/ 06309000
*                                                                  1518 06310000
*   /*****************************************************************/ 06311000
*   /*                                                               */ 06312000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 06313000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 06314000
*   /*                                                               */ 06315000
*   /*****************************************************************/ 06316000
*                                                                  1519 06317000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 06318000
@RF01510 LR    REG14,RTNREG2                                       1519 06319000
*   RETURN CODE(CC17);              /*                       @Y30LB34*/ 06320000
         LR    @15,CC17                                            1520 06321000
@EL00018 DS    0H                                                  1520 06322000
@EF00018 DS    0H                                                  1520 06323000
@ER00018 BR    @14                                                 1520 06324000
*   END RVSCRV;                     /*                       @Y30LB34*/ 06325000
*                                                                  1522 06326000
*/********************************************************** @Y30LB34*/ 06327000
*/*                                                          @Y30LB34*/ 06328000
*/* PROCEDURE NAME - VRPROC                                  @Y30LB34*/ 06329000
*/*                                                          @Y30LB34*/ 06330000
*/* FUNCTION - CONTROLS THE VIRTUAL TO REAL CONVERSION       @Y30LB34*/ 06331000
*/*                                                          @Y30LB34*/ 06332000
*/*            ENQUEUES THE SOURCE VOLUME                    @Y30LB34*/ 06333000
*/*                                                          @Y30LB34*/ 06334000
*/*            CALLS VRINITSO TO INTERROGATE SOURCE VOLUME   @Y30LB34*/ 06335000
*/*                                                          @Y30LB34*/ 06336000
*/*            CALLS VRINITTA TO INTERROGATE TARGET VOLUME   @Y30LB34*/ 06337000
*/*                                                          @Y30LB34*/ 06338000
*/*            CALLS VRMOVE TO CONTROL THE CONVERSION OF     @Y30LB34*/ 06339000
*/*            DATA FROM VIRTUAL TO REAL                     @Y30LB34*/ 06340000
*/*                                                          @Y30LB34*/ 06341000
*/*            TESTS IF SOURCE VOLUME VTOC SHOULD BE         @Y30LB34*/ 06342000
*/*            SCRATCHED, AND, IF SO, CALLS VRSCRV           @Y30LB34*/ 06343000
*/*                                                          @Y30LB34*/ 06344000
*/*            DEQUEUES TARGET VOLUME RESERVED IN CHEKTARG   @Y30LB34*/ 06345000
*/*                                                          @Y30LB34*/ 06346000
*/*            DEQUEUES SOURCE VOLUME ENQUEUED ABOVE         @Y30LB34*/ 06347000
*/*                                                          @Y30LB34*/ 06348000
*/* INPUT - FUNCTION DATA TABLE                              @Y30LB34*/ 06349000
*/*                                                          @Y30LB34*/ 06350000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 06351000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 06352000
*/*           R. C. =  4, RETURN CODE FROM VRINITTA          @Y30LB34*/ 06353000
*/*           R. C. = 12, RETURN CODE FROM VRINITSO,         @Y30LB34*/ 06354000
*/*                       VRINITTA, VRMOVE OR VRSCRV         @Y30LB34*/ 06355000
*/*                                                          @Y30LB34*/ 06356000
*/********************************************************** @Y30LB34*/ 06357000
*                                                                  1522 06358000
*VRPROC:                                                           1522 06359000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 06360000
*                                                                  1522 06361000
VRPROC   DS    0H                                                  1523 06362000
*   /*****************************************************************/ 06363000
*   /*                                                               */ 06364000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 06365000
*   /*                                                               */ 06366000
*   /*****************************************************************/ 06367000
*                                                                  1523 06368000
*   DCL                                                            1523 06369000
*     CC18 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   06370000
*                                      CODE SAVE AREA        @Y30LB34*/ 06371000
*                                                                  1524 06372000
*   /*****************************************************************/ 06373000
*   /*                                                               */ 06374000
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/ 06375000
*   /*                                                               */ 06376000
*   /*****************************************************************/ 06377000
*                                                                  1524 06378000
*   OLDERID2=NEWERID2;                                             1524 06379000
         L     @07,@PC00001                                        1524 06380000
         L     @15,GDTTR2(,@07)                                    1524 06381000
         MVC   @TS00001(95),NEWERID2(@15)                          1524 06382000
         MVC   OLDERID2(95,@15),@TS00001                           1524 06383000
*   NEWID2='CNTI';                  /*                       @Y30LB34*/ 06384000
*                                                                  1525 06385000
         MVC   NEWID2(4,@15),@CC01808                              1525 06386000
*   /*****************************************************************/ 06387000
*   /*                                                               */ 06388000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 06389000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 06390000
*   /*                                                               */ 06391000
*   /*****************************************************************/ 06392000
*                                                                  1526 06393000
*   CC18=LASTCC00;                  /*                       @Y30LB34*/ 06394000
         SLR   @15,@15                                             1526 06395000
         STH   @15,CC18                                            1526 06396000
*   RTNREG1=REG14;                  /*                       @Y30LB34*/ 06397000
*                                                                  1527 06398000
         ST    REG14,RTNREG1                                       1527 06399000
*   /*****************************************************************/ 06400000
*   /*                                                               */ 06401000
*   /* ENQUEUE THE SOURCE VOLUME AND SET ON THE SOURCE ENQ   @Y30LB34*/ 06402000
*   /* BIT                                                   @Y30LB34*/ 06403000
*   /*                                                               */ 06404000
*   /*****************************************************************/ 06405000
*                                                                  1528 06406000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,QNAME,RNAMEVE);/*         @Y30LB34*/ 06407000
         MVC   @AL00001+4(12),@AL01528                             1528 06408000
         ST    @07,@AL00001                                        1528 06409000
         LA    @15,RNAMEVE                                         1528 06410000
         ST    @15,@AL00001+16                                     1528 06411000
         MVI   @AL00001+16,X'80'                                   1528 06412000
         L     @15,GDTENQ(,@07)                                    1528 06413000
         LA    @01,@AL00001                                        1528 06414000
         BALR  @14,@15                                             1528 06415000
*   SENQ=ON;                        /*                       @Y30LB34*/ 06416000
*                                                                  1529 06417000
         OI    SENQ,B'10000000'                                    1529 06418000
*   /*****************************************************************/ 06419000
*   /*                                                               */ 06420000
*   /* CALL VRINITSO TO INTERROGATE THE VIRT SOURCE VOLUME   @Y30LB34*/ 06421000
*   /*                                                               */ 06422000
*   /*****************************************************************/ 06423000
*                                                                  1530 06424000
*   CALL VRINITSO;                  /*                       @Y30LB34*/ 06425000
         BAL   @14,VRINITSO                                        1530 06426000
*   RESPECIFY                                                      1531 06427000
*     RTNREG RSTD;                                                 1531 06428000
*   TESTRC=RTNREG;                                                 1532 06429000
         STH   RTNREG,TESTRC                                       1532 06430000
*   RESPECIFY                                                      1533 06431000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 06432000
*   CC18=TESTRC;                    /*                       @Y30LB34*/ 06433000
         LH    @07,TESTRC                                          1534 06434000
         STH   @07,CC18                                            1534 06435000
*                                                                  1535 06436000
*   /*****************************************************************/ 06437000
*   /*                                                               */ 06438000
*   /* IF NO SEVERE ERRORS OCCURRED IN VRINITSO, CALL        @Y30LB34*/ 06439000
*   /* VRINITTA TO INTERROGATE THE REAL TARGET VOLUME        @Y30LB34*/ 06440000
*   /*                                                               */ 06441000
*   /*****************************************************************/ 06442000
*                                                                  1535 06443000
*   IF CC18<LASTCC12 THEN                                          1535 06444000
         C     @07,@CF00567                                        1535 06445000
         BNL   @RF01535                                            1535 06446000
*     DO;                           /*                       @Y30LB34*/ 06447000
*       CALL VRINITTA;              /*                       @Y30LB34*/ 06448000
         BAL   @14,VRINITTA                                        1537 06449000
*       RESPECIFY                                                  1538 06450000
*         RTNREG RSTD;                                             1538 06451000
*       TESTRC=RTNREG;                                             1539 06452000
         STH   RTNREG,TESTRC                                       1539 06453000
*       RESPECIFY                                                  1540 06454000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 06455000
*       CC18=MAX(CC18,TESTRC);      /*                       @Y30LB34*/ 06456000
         LH    @07,TESTRC                                          1541 06457000
         LH    @15,CC18                                            1541 06458000
         CR    @15,@07                                             1541 06459000
         BNL   *+6                                                      06460000
         LR    @15,@07                                             1541 06461000
         STH   @15,CC18                                            1541 06462000
*     END;                          /*                       @Y30LB34*/ 06463000
*                                                                  1542 06464000
*   /*****************************************************************/ 06465000
*   /*                                                               */ 06466000
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, CALL VRMOVE        @Y30LB34*/ 06467000
*   /* TO HANDLE THE DATA CONVERSION FROM VIRTUAL TO REAL    @Y30LB34*/ 06468000
*   /*                                                               */ 06469000
*   /*****************************************************************/ 06470000
*                                                                  1543 06471000
*   IF CC18<LASTCC12 THEN                                          1543 06472000
@RF01535 LH    @07,CC18                                            1543 06473000
         C     @07,@CF00567                                        1543 06474000
         BNL   @RF01543                                            1543 06475000
*     DO;                           /*                       @Y30LB34*/ 06476000
*       CALL VRMOVE;                /*                       @Y30LB34*/ 06477000
         BAL   @14,VRMOVE                                          1545 06478000
*       RESPECIFY                                                  1546 06479000
*         RTNREG RSTD;                                             1546 06480000
*       TESTRC=RTNREG;                                             1547 06481000
         STH   RTNREG,TESTRC                                       1547 06482000
*       RESPECIFY                                                  1548 06483000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 06484000
*       CC18=MAX(CC18,TESTRC);      /*                       @Y30LB34*/ 06485000
         LH    @07,TESTRC                                          1549 06486000
         LH    @02,CC18                                            1549 06487000
         CR    @02,@07                                             1549 06488000
         BNL   *+6                                                      06489000
         LR    @02,@07                                             1549 06490000
         STH   @02,CC18                                            1549 06491000
*     END;                          /*                       @Y30LB34*/ 06492000
*                                                                  1550 06493000
*   /*****************************************************************/ 06494000
*   /*                                                               */ 06495000
*   /* IF NO SEVERE ERRORS HAVE OCCURRED, AND IF             @Y30LB34*/ 06496000
*   /* 'NOSCRATCH' WAS NOT SPECIFIED IN A CONTROL            @Y30LB34*/ 06497000
*   /* STATEMENT, CALL VRSCRV TO SCRATCH THE SOURCE          @Y30LB34*/ 06498000
*   /* VOLUME VTOC                                           @Y30LB34*/ 06499000
*   /*                                                               */ 06500000
*   /*****************************************************************/ 06501000
*                                                                  1551 06502000
*   IF CC18<LASTCC12 THEN                                          1551 06503000
@RF01543 LH    @07,CC18                                            1551 06504000
         C     @07,@CF00567                                        1551 06505000
         BNL   @RF01551                                            1551 06506000
*     IF ADDR(NSCR)=NULLPTR THEN                                   1552 06507000
         L     @07,@PC00001+4                                      1552 06508000
         L     @07,FDTPTR+36(,@07)                                 1552 06509000
         LTR   @07,@07                                             1552 06510000
         BNZ   @RF01552                                            1552 06511000
*       DO;                         /*                       @Y30LB34*/ 06512000
*         CALL VRSCRV;              /*                       @Y30LB34*/ 06513000
         BAL   @14,VRSCRV                                          1554 06514000
*         RESPECIFY                                                1555 06515000
*           RTNREG RSTD;                                           1555 06516000
*         TESTRC=RTNREG;                                           1556 06517000
         STH   RTNREG,TESTRC                                       1556 06518000
*         RESPECIFY                                                1557 06519000
*           RTNREG UNRSTD;          /*                       @Y30LB34*/ 06520000
*         CC18=MAX(CC18,TESTRC);    /*                       @Y30LB34*/ 06521000
         LH    @07,TESTRC                                          1558 06522000
         LH    @02,CC18                                            1558 06523000
         CR    @02,@07                                             1558 06524000
         BNL   *+6                                                      06525000
         LR    @02,@07                                             1558 06526000
         STH   @02,CC18                                            1558 06527000
*       END;                        /*                       @Y30LB34*/ 06528000
*                                                                  1560 06529000
*   /*****************************************************************/ 06530000
*   /*                                                               */ 06531000
*   /* IF THE TARGET VOLUME IS STILL RESERVED FROM           @Y30LB34*/ 06532000
*   /* CHEKTARG, IMPLYING THE COMMAND IS TERMINATING WITH    @Y30LB34*/ 06533000
*   /* A RETURN CODE OF 12, RELEASE THAT RESERVE AND SET     @Y30LB34*/ 06534000
*   /* OFF THE TARGET RESERVE BIT                            @Y30LB34*/ 06535000
*   /*                                                               */ 06536000
*   /*****************************************************************/ 06537000
*                                                                  1560 06538000
*   IF TRES=ON THEN                                                1560 06539000
@RF01552 DS    0H                                                  1560 06540000
@RF01551 TM    TRES,B'01000000'                                    1560 06541000
         BNO   @RF01560                                            1560 06542000
*     DO;                           /*                       @Y30LB34*/ 06543000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMERR);/*               @Y30LB34*/ 06544000
         L     @07,@PC00001                                        1562 06545000
         ST    @07,@AL00001                                        1562 06546000
         LA    @02,@CC01594                                        1562 06547000
         ST    @02,@AL00001+4                                      1562 06548000
         LA    @02,RNAMERR                                         1562 06549000
         ST    @02,@AL00001+8                                      1562 06550000
         MVI   @AL00001+8,X'80'                                    1562 06551000
         L     @15,GDTDEQ(,@07)                                    1562 06552000
         LA    @01,@AL00001                                        1562 06553000
         BALR  @14,@15                                             1562 06554000
*       TRES=OFF;                   /*                       @Y30LB34*/ 06555000
         NI    TRES,B'10111111'                                    1563 06556000
*     END;                          /*                       @Y30LB34*/ 06557000
*                                                                  1564 06558000
*   /*****************************************************************/ 06559000
*   /*                                                               */ 06560000
*   /* IF THE SOURCE VOLUME WAS ENQUEUED AT THE BEGINNING    @Y30LB34*/ 06561000
*   /* OF THIS PROCEDURE, DEQUEUE THAT ENQUEUE AND SET OFF   @Y30LB34*/ 06562000
*   /* THE SOURCE ENQ BIT                                    @Y30LB34*/ 06563000
*   /*                                                               */ 06564000
*   /*****************************************************************/ 06565000
*                                                                  1565 06566000
*   IF SENQ=ON THEN                                                1565 06567000
@RF01560 TM    SENQ,B'10000000'                                    1565 06568000
         BNO   @RF01565                                            1565 06569000
*     DO;                           /*                       @Y30LB34*/ 06570000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVE);/*               @Y30LB34*/ 06571000
         L     @07,@PC00001                                        1567 06572000
         ST    @07,@AL00001                                        1567 06573000
         LA    @02,@CC01594                                        1567 06574000
         ST    @02,@AL00001+4                                      1567 06575000
         LA    @02,RNAMEVE                                         1567 06576000
         ST    @02,@AL00001+8                                      1567 06577000
         MVI   @AL00001+8,X'80'                                    1567 06578000
         L     @15,GDTDEQ(,@07)                                    1567 06579000
         LA    @01,@AL00001                                        1567 06580000
         BALR  @14,@15                                             1567 06581000
*       SENQ=OFF;                   /*                       @Y30LB34*/ 06582000
         NI    SENQ,B'01111111'                                    1568 06583000
*     END;                          /*                       @Y30LB34*/ 06584000
*                                                                  1569 06585000
*   /*****************************************************************/ 06586000
*   /*                                                               */ 06587000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 06588000
*   /* RETURN TO CALLING PROCEDURE                           @Y30LB34*/ 06589000
*   /*                                                               */ 06590000
*   /*****************************************************************/ 06591000
*                                                                  1570 06592000
*   REG14=RTNREG1;                  /*                       @Y30LB34*/ 06593000
@RF01565 L     REG14,RTNREG1                                       1570 06594000
*   RETURN CODE(CC18);              /*                       @Y30LB34*/ 06595000
         LH    @15,CC18                                            1571 06596000
@EL00019 DS    0H                                                  1571 06597000
@EF00019 DS    0H                                                  1571 06598000
@ER00019 BR    @14                                                 1571 06599000
*   END VRPROC;                     /*                       @Y30LB34*/ 06600000
*                                                                  1573 06601000
*/********************************************************** @Y30LB34*/ 06602000
*/*                                                          @Y30LB34*/ 06603000
*/* PROCEDURE NAME - VRINITSO                                @Y30LB34*/ 06604000
*/*                                                          @Y30LB34*/ 06605000
*/* FUNCTION - INTERROGATES THE MSS SOURCE VOLUME            @Y30LB34*/ 06606000
*/*                                                          @Y30LB34*/ 06607000
*/*            CALLS VRGETSO TO ACCESS THE MSVC BASE VOLUME  @Y30LB34*/ 06608000
*/*            RECORD TO RETRIEVE VOLUME INFORMATION, AND    @Y30LB34*/ 06609000
*/*            TO MOUNT THE SOURCE VOLUME                    @Y30LB34*/ 06610000
*/*                                                          @Y30LB34*/ 06611000
*/*            CALLS CHEKSRCE TO CHECK SOURCE VOLUME         @Y30LB34*/ 06612000
*/*                                                          @Y30LB34*/ 06613000
*/*            ISSUES USYSINFO TO RETRIEVE VTOC TTR AFTER    @Y30LB34*/ 06614000
*/*            VOLUME IS MOUNTED                             @Y30LB34*/ 06615000
*/*                                                          @Y30LB34*/ 06616000
*/*            DEQUEUES THE SOURCE VOLUME RESERVED IN        @Y30LB34*/ 06617000
*/*            CHEKSRCE                                      @Y30LB34*/ 06618000
*/*                                                          @Y30LB34*/ 06619000
*/*            DEMOUNTS THE SOURCE VOLUME MOUNTED IN VRGETSO @Y30LB34*/ 06620000
*/*                                                          @Y30LB34*/ 06621000
*/* INPUT - MDAGL, PUAGL                                     @Y30LB34*/ 06622000
*/*                                                          @Y30LB34*/ 06623000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 06624000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 06625000
*/*           R. C. =  4, RETURN CODE FROM CHEKSRCE          @Y30LB34*/ 06626000
*/*           R. C. = 12, RETURN CODE FROM VRGETSO OR        @Y30LB34*/ 06627000
*/*                       CHEKSRCE,                          @Y30LB34*/ 06628000
*/*                       UNABLE TO DEMOUNT VOLUME           @Y30LB34*/ 06629000
*/*                                                          @Y30LB34*/ 06630000
*/********************************************************** @Y30LB34*/ 06631000
*                                                                  1573 06632000
*VRINITSO:                                                         1573 06633000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 06634000
*                                                                  1573 06635000
VRINITSO DS    0H                                                  1574 06636000
*   /*****************************************************************/ 06637000
*   /*                                                               */ 06638000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 06639000
*   /*                                                               */ 06640000
*   /*****************************************************************/ 06641000
*                                                                  1574 06642000
*   DCL                                                            1574 06643000
*     CC19 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   06644000
*                                      CODE SAVE AREA        @Y30LB34*/ 06645000
*                                                                  1575 06646000
*   /*****************************************************************/ 06647000
*   /*                                                               */ 06648000
*   /* ESTABLISH TRACE POINT AT BEGINNING OF PROCEDURE       @Y30LB34*/ 06649000
*   /*                                                               */ 06650000
*   /*****************************************************************/ 06651000
*                                                                  1575 06652000
*   OLDERID2=NEWERID2;                                             1575 06653000
         L     @11,@PC00001                                        1575 06654000
         L     @11,GDTTR2(,@11)                                    1575 06655000
         MVC   @TS00001(95),NEWERID2(@11)                          1575 06656000
         MVC   OLDERID2(95,@11),@TS00001                           1575 06657000
*   NEWID2='CNTJ';                  /*                       @Y30LB34*/ 06658000
*                                                                  1576 06659000
         MVC   NEWID2(4,@11),@CC01817                              1576 06660000
*   /*****************************************************************/ 06661000
*   /*                                                               */ 06662000
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/ 06663000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 06664000
*   /*                                                               */ 06665000
*   /*****************************************************************/ 06666000
*                                                                  1577 06667000
*   CC19=LASTCC00;                  /*                       @Y30LB34*/ 06668000
         SLR   CC19,CC19                                           1577 06669000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 06670000
         LR    RTNREG2,REG14                                       1578 06671000
*                                                                  1579 06672000
*   /*****************************************************************/ 06673000
*   /*                                                               */ 06674000
*   /* CALL VRGETSO TO RETRIEVE INFORMATION FROM THE BASE    @Y30LB34*/ 06675000
*   /* VOLUME RECORD AND MOUNT THE SOURCE VOLUME IF THE      @Y30LB34*/ 06676000
*   /* SOURCE AND TARGET VOLSERS ARE THE SAME                @Y30LB34*/ 06677000
*   /*                                                               */ 06678000
*   /*****************************************************************/ 06679000
*                                                                  1579 06680000
*   CALL VRGETSO;                   /*                       @Y30LB34*/ 06681000
         BAL   @14,VRGETSO                                         1579 06682000
*   RESPECIFY                                                      1580 06683000
*     RTNREG RSTD;                                                 1580 06684000
*   TESTRC=RTNREG;                                                 1581 06685000
         STH   RTNREG,TESTRC                                       1581 06686000
*   RESPECIFY                                                      1582 06687000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 06688000
*   CC19=TESTRC;                    /*                       @Y30LB34*/ 06689000
*                                                                  1583 06690000
         LH    @15,TESTRC                                          1583 06691000
         LR    CC19,@15                                            1583 06692000
*   /*****************************************************************/ 06693000
*   /*                                                               */ 06694000
*   /* IF NO SEVERE ERRORS OCCURRED, CONTINUE PROCESSING     @Y30LB34*/ 06695000
*   /* SOURCE VOLUME                                         @Y30LB34*/ 06696000
*   /*                                                               */ 06697000
*   /*****************************************************************/ 06698000
*                                                                  1584 06699000
*   IF CC19<LASTCC12 THEN                                          1584 06700000
         C     CC19,@CF00567                                       1584 06701000
         BNL   @RF01584                                            1584 06702000
*     DO;                           /*                       @Y30LB34*/ 06703000
*                                                                  1585 06704000
*       /*************************************************************/ 06705000
*       /*                                                           */ 06706000
*       /* CALL CHEKSRCE TO PERFORM SECURITY CHECKING ON THE @Y30LB34*/ 06707000
*       /* SOURCE VOLUME AND CHECK JOB SETUP WITH RESPECT TO @Y30LB34*/ 06708000
*       /* THE SOURCE VOLUME                                 @Y30LB34*/ 06709000
*       /*                                                           */ 06710000
*       /*************************************************************/ 06711000
*                                                                  1586 06712000
*       CALL CHEKSRCE;              /*                       @Y30LB34*/ 06713000
         BAL   @14,CHEKSRCE                                        1586 06714000
*       RESPECIFY                                                  1587 06715000
*         RTNREG RSTD;                                             1587 06716000
*       TESTRC=RTNREG;                                             1588 06717000
         STH   RTNREG,TESTRC                                       1588 06718000
*       RESPECIFY                                                  1589 06719000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 06720000
*       CC19=MAX(CC19,TESTRC);      /*                       @Y30LB34*/ 06721000
         LH    @11,TESTRC                                          1590 06722000
         CR    CC19,@11                                            1590 06723000
         BNL   *+6                                                      06724000
         LR    CC19,@11                                            1590 06725000
*                                                                  1591 06726000
*       /*************************************************************/ 06727000
*       /*                                                           */ 06728000
*       /* IF NO SEVERE ERROR OCCURRED ISSUE USYSINFO TO     @Y30LB34*/ 06729000
*       /* GET THE VTOC TTR OF THE MOUNTED VOLUME. THIS WILL @Y30LB34*/ 06730000
*       /* BE SAVED AND USED TO FIND THE VTOC ON THE TARGET  @Y30LB34*/ 06731000
*       /* VOLUME AFTER THE CONVERSION                       @Y30LB34*/ 06732000
*       /*                                                           */ 06733000
*       /*************************************************************/ 06734000
*                                                                  1591 06735000
*       IF CC19<LASTCC12 THEN                                      1591 06736000
         C     CC19,@CF00567                                       1591 06737000
         BNL   @RF01591                                            1591 06738000
*         DO;                       /*                       @Y30LB34*/ 06739000
*           UNITABLA=''B;           /*                       @Y30LB34*/ 06740000
         XC    UNITABLA(11),UNITABLA                               1593 06741000
*           CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,FFILEVAL);/*  @Y30LB34*/ 06742000
         L     @11,@PC00001                                        1594 06743000
         ST    @11,@AL00001                                        1594 06744000
         LA    @15,UNIT                                            1594 06745000
         ST    @15,@AL00001+4                                      1594 06746000
         LA    @15,UNITABLP                                        1594 06747000
         ST    @15,@AL00001+8                                      1594 06748000
         L     @15,@PC00001+4                                      1594 06749000
         L     @01,FDTPTR(,@15)                                    1594 06750000
         LA    @15,FFILEVAL(,@01)                                  1594 06751000
         ST    @15,@AL00001+12                                     1594 06752000
         MVI   @AL00001+12,X'80'                                   1594 06753000
         L     @15,GDTSFO(,@11)                                    1594 06754000
         LA    @01,@AL00001                                        1594 06755000
         BALR  @14,@15                                             1594 06756000
*           RESPECIFY                                              1595 06757000
*             RTNREG RSTD;                                         1595 06758000
*           TESTRC=RTNREG;                                         1596 06759000
         STH   RTNREG,TESTRC                                       1596 06760000
*           RESPECIFY                                              1597 06761000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 06762000
*                                                                  1597 06763000
*           /*********************************************************/ 06764000
*           /*                                                       */ 06765000
*           /* IF USYSINFO IS SUCCESSFUL SAVE THE TTR ADDRESS        */ 06766000
*           /*                                               @Y30LB34*/ 06767000
*           /*                                                       */ 06768000
*           /*********************************************************/ 06769000
*                                                                  1598 06770000
*           IF TESTRC=LASTCC00 THEN                                1598 06771000
         LH    @11,TESTRC                                          1598 06772000
         LTR   @11,@11                                             1598 06773000
         BNZ   @RF01598                                            1598 06774000
*             SVTOCTTR=UNITVTOC;    /*                       @Y30LB34*/ 06775000
*                                                                  1599 06776000
         L     @11,UNITABLP                                        1599 06777000
         MVC   SVTOCTTR(4),UNITVTOC(@11)                           1599 06778000
*           /*********************************************************/ 06779000
*           /*                                                       */ 06780000
*           /* IF USYSINFO IS UNSUCCESSFUL SET THE CONDITION @Y30LB34*/ 06781000
*           /* CODE TO 12                                    @Y30LB34*/ 06782000
*           /*                                                       */ 06783000
*           /*********************************************************/ 06784000
*                                                                  1600 06785000
*           ELSE                                                   1600 06786000
*             CC19=LASTCC12;        /*                       @Y30LB34*/ 06787000
         B     @RC01598                                            1600 06788000
@RF01598 LA    CC19,12                                             1600 06789000
*         END;                      /*                       @Y30LB34*/ 06790000
*                                                                  1601 06791000
@RC01598 DS    0H                                                  1602 06792000
*       /*************************************************************/ 06793000
*       /*                                                           */ 06794000
*       /* IF THE SOURCE VOLUME WAS RESERVED IN CHEKSRCE,    @Y30LB34*/ 06795000
*       /* RELEASE THAT RESERVE AND SET OFF THE SOURCE       @Y30LB34*/ 06796000
*       /* RESERVE BIT                                       @Y30LB34*/ 06797000
*       /*                                                           */ 06798000
*       /*************************************************************/ 06799000
*                                                                  1602 06800000
*       IF SRES=ON THEN                                            1602 06801000
@RF01591 TM    SRES,B'01000000'                                    1602 06802000
         BNO   @RF01602                                            1602 06803000
*         DO;                       /*                       @Y30LB34*/ 06804000
*           CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*           @Y30LB34*/ 06805000
         L     @11,@PC00001                                        1604 06806000
         ST    @11,@AL00001                                        1604 06807000
         LA    @15,@CC01594                                        1604 06808000
         ST    @15,@AL00001+4                                      1604 06809000
         LA    @15,RNAMEVR                                         1604 06810000
         ST    @15,@AL00001+8                                      1604 06811000
         MVI   @AL00001+8,X'80'                                    1604 06812000
         L     @15,GDTDEQ(,@11)                                    1604 06813000
         LA    @01,@AL00001                                        1604 06814000
         BALR  @14,@15                                             1604 06815000
*           SRES=OFF;               /*                       @Y30LB34*/ 06816000
         NI    SRES,B'10111111'                                    1605 06817000
*         END;                      /*                       @Y30LB34*/ 06818000
*                                                                  1607 06819000
*       /*************************************************************/ 06820000
*       /*                                                           */ 06821000
*       /* IF NO SEVERE ERROR HAS OCCURRED, ISSUE UMSSUNIT   @Y30LB34*/ 06822000
*       /* TO DEMOUNT SOURCE VOLUME. IF SOURCE AND TARGET    @Y30LB34*/ 06823000
*       /* VOLSERS ARE THE SAME, SET THE BIT ON TO POST THE  @Y30LB34*/ 06824000
*       /* TARGET UCB AFTER DEMOUNT. SET THE WAIT BIT ON     @Y30LB34*/ 06825000
*       /* TO WAIT UNTIL THE DEMOUNT IS COMPLETE BEFORE THE  @Y30LB34*/ 06826000
*       /* COPY BEGINS                                       @Y30LB34*/ 06827000
*       /*                                                           */ 06828000
*       /*************************************************************/ 06829000
*                                                                  1607 06830000
*       IF CC19<LASTCC12 THEN                                      1607 06831000
@RF01602 C     CC19,@CF00567                                       1607 06832000
         BNL   @RF01607                                            1607 06833000
*         DO;                       /*                       @Y30LB34*/ 06834000
*           IF SAMESER=ON THEN                                     1609 06835000
         TM    SAMESER,B'10000000'                                 1609 06836000
         BNO   @RF01609                                            1609 06837000
*             MDPOST=ON;            /*                       @Y30LB34*/ 06838000
         LA    @11,MDAGLAR                                         1610 06839000
         OI    MDPOST(@11),B'00100000'                             1610 06840000
*           MDWAIT=ON;              /*                       @Y30LB34*/ 06841000
@RF01609 LA    @11,MDAGLAR                                         1611 06842000
         OI    MDWAIT(@11),B'00010000'                             1611 06843000
*           CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*           @Y30LB34*/ 06844000
         L     @15,@PC00001                                        1612 06845000
         ST    @15,@AL00001                                        1612 06846000
         LA    @14,DEMOUNT                                         1612 06847000
         ST    @14,@AL00001+4                                      1612 06848000
         ST    @11,@AL00001+8                                      1612 06849000
         MVI   @AL00001+8,X'80'                                    1612 06850000
         L     @15,GDTUNT(,@15)                                    1612 06851000
         LA    @01,@AL00001                                        1612 06852000
         BALR  @14,@15                                             1612 06853000
*           RESPECIFY                                              1613 06854000
*             RTNREG RSTD;                                         1613 06855000
*           TESTRC=RTNREG;                                         1614 06856000
         STH   RTNREG,TESTRC                                       1614 06857000
*           RESPECIFY                                              1615 06858000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 06859000
*           MDPOST=OFF;             /*                       @Y30LB34*/ 06860000
*           MDWAIT=OFF;             /*                       @Y30LB34*/ 06861000
*                                                                  1617 06862000
         LA    @11,MDAGLAR                                         1617 06863000
         NI    MDPOST(@11),B'11001111'                             1617 06864000
*           /*********************************************************/ 06865000
*           /*                                                       */ 06866000
*           /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE        @Y30LB34*/ 06867000
*           /* CONDITION CODE TO 12                          @Y30LB34*/ 06868000
*           /*                                                       */ 06869000
*           /*********************************************************/ 06870000
*                                                                  1618 06871000
*           IF TESTRC>0 THEN                                       1618 06872000
         LH    @11,TESTRC                                          1618 06873000
         LTR   @11,@11                                             1618 06874000
         BNP   @RF01618                                            1618 06875000
*             CC19=LASTCC12;        /*                       @Y30LB34*/ 06876000
         LA    CC19,12                                             1619 06877000
*         END;                      /*                       @Y30LB34*/ 06878000
@RF01618 DS    0H                                                  1621 06879000
*     END;                          /*                       @Y30LB34*/ 06880000
*                                                                  1621 06881000
@RF01607 DS    0H                                                  1622 06882000
*   /*****************************************************************/ 06883000
*   /*                                                               */ 06884000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 06885000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 06886000
*   /*                                                               */ 06887000
*   /*****************************************************************/ 06888000
*                                                                  1622 06889000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 06890000
@RF01584 LR    REG14,RTNREG2                                       1622 06891000
*   RETURN CODE(CC19);              /*                       @Y30LB34*/ 06892000
         LR    @15,CC19                                            1623 06893000
@EL00020 DS    0H                                                  1623 06894000
@EF00020 DS    0H                                                  1623 06895000
@ER00020 BR    @14                                                 1623 06896000
*   END VRINITSO;                   /*                       @Y30LB34*/ 06897000
*                                                                  1625 06898000
*/********************************************************** @Y30LB34*/ 06899000
*/*                                                          @Y30LB34*/ 06900000
*/* PROCEDURE NAME - VRGETSO                                 @Y30LB34*/ 06901000
*/*                                                          @Y30LB34*/ 06902000
*/* FUNCTION - INITIALIZES THE MSVC PARM LIST TO RETRIEVE    @Y30LB34*/ 06903000
*/*            THE BASE VOLUME RECORD OF THE MSS VOLUME      @Y30LB34*/ 06904000
*/*                                                          @Y30LB34*/ 06905000
*/*            ISSUES USSC TO RETRIEVE THE BASE VOLUME       @Y30LB34*/ 06906000
*/*            RECORD                                        @Y30LB34*/ 06907000
*/*                IF USSC IS NOT SUCCESSFUL, CALLS SSCMSG   @Y30LB34*/ 06908000
*/*                TO PRINT MESSAGE ISSUED BY USSC,          @Y30LB34*/ 06909000
*/*                PRINTS ERROR MESSAGE IDC2080 IF THE BASE  @Y30LB34*/ 06910000
*/*                VOLUME RECORD COULD NOT BE RETRIEVED      @Y30LB34*/ 06911000
*/*                                                          @Y30LB34*/ 06912000
*/*            DETERMINES IF VOLUME IS INACTIVE.  IF SO,     @Y30LB34*/ 06913000
*/*            PRINTS MESSAGE IDC3074I                       @Y30LB34*/ 06914000
*/*                                                          @Y30LB34*/ 06915000
*/*            DETERMINES IF ANY RECOVERY FLAGS ARE ON, AND, @Y30LB34*/ 06916000
*/*            IF SO, WHICH ONES                             @Y30LB34*/ 06917000
*/*                IF INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/ 06918000
*/*                PRINTS ERROR MESSAGE IDC3097I,            @Y30LB34*/ 06919000
*/*                IF VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/ 06920000
*/*                PRINTS ERROR MESSAGE IDC3095I,            @Y30LB34*/ 06921000
*/*                IF INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/ 06922000
*/*                PRINTS ERROR MESSAGE IDC3096I.            @Y30LB34*/ 06923000
*/*                                                          @YD00175*/ 06924000
*/*            OBTAINS EXCLUSIVE CONTROL OF TARGET REAL      @YD00175*/ 06925000
*/*            VOLUME                                        @YD00175*/ 06926000
*/*                                                          @Y30LB34*/ 06927000
*/*            INITIALIZES THE MOUNT/DEMOUNT PARM LIST FOR   @Y30LB34*/ 06928000
*/*            THE VIRTUAL TARGET VOLUME                     @Y30LB34*/ 06929000
*/*                                                          @Y30LB34*/ 06930000
*/*            IF THE VOLUMES HAVE THE SAME VOLSERS,         @Y30LB34*/ 06931000
*/*            INITIALIZES THE POST/CLEAR PARM LIST FOR THE  @Y30LB34*/ 06932000
*/*            SOURCE VOLUME                                 @Y30LB34*/ 06933000
*/*                                                          @Y30LB34*/ 06934000
*/*            MOUNTS THE MSS VOLUME IF SOURCE AND TARGET    @Y30LB34*/ 06935000
*/*            VOLSERS ARE EQUAL                             @Y30LB34*/ 06936000
*/*                                                          @Y30LB34*/ 06937000
*/* INPUT - FUNCTION DATA TABLE, MDAGL, PUAGL, SRCEAREA,     @Y30LB34*/ 06938000
*/*         TARGAREA, AND SAMESER                            @Y30LB34*/ 06939000
*/*                                                          @Y30LB34*/ 06940000
*/* OUTPUT - MDAGL, PUAGL, SRCEAREA, TARGAREA, RVVI, UNITABL @Y30LB34*/ 06941000
*/*          DARGLIST                                        @Y30LB34*/ 06942000
*/*                                                          @Y30LB34*/ 06943000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 06944000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 06945000
*/*           R. C. = 12, UNABLE TO MOUNT MSS VOLUME,        @Y30LB34*/ 06946000
*/*                       UNABLE TO RETRIEVE BASE VOLUME     @Y30LB34*/ 06947000
*/*                       RECORD,                            @Y30LB34*/ 06948000
*/*                       INVALID RECOVERY FLAG ON IN BASE   @Y30LB34*/ 06949000
*/*                       VOLUME RECORD,                     @Y30LB34*/ 06950000
*/*                       VOLUME NOT ACTIVE,                 @Y30LB34*/ 06951000
*/*                       UNABLE TO RETRIEVE VTOC TTR        @Y30LB34*/ 06952000
*/*                       UNABLE TO GET EXCLUSIVE CONTROL    @YD00175*/ 06953000
*/*                        OF TARGET VOLUME                  @YD00175*/ 06954000
*/*                                                          #Y30LB34*/ 06955000
*/********************************************************** #Y30LB34*/ 06956000
*                                                                  1625 06957000
*VRGETSO:                                                          1625 06958000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 06959000
*                                                                  1625 06960000
VRGETSO  DS    0H                                                  1626 06961000
*   /*****************************************************************/ 06962000
*   /*                                                               */ 06963000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 06964000
*   /*                                                               */ 06965000
*   /*****************************************************************/ 06966000
*                                                                  1626 06967000
*   DCL                                                            1626 06968000
*     CC20 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   06969000
*                                      CODE SAVE AREA        @Y30LB34*/ 06970000
*                                                                  1627 06971000
*   /*****************************************************************/ 06972000
*   /*                                                               */ 06973000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 06974000
*   /*                                                               */ 06975000
*   /*****************************************************************/ 06976000
*                                                                  1627 06977000
*   OLDERID2=NEWERID2;                                             1627 06978000
         L     @08,@PC00001                                        1627 06979000
         L     @15,GDTTR2(,@08)                                    1627 06980000
         MVC   @TS00001(95),NEWERID2(@15)                          1627 06981000
         MVC   OLDERID2(95,@15),@TS00001                           1627 06982000
*   NEWID2='CNTK';                  /*                       @Y30LB34*/ 06983000
*                                                                  1628 06984000
         MVC   NEWID2(4,@15),@CC01823                              1628 06985000
*   /*****************************************************************/ 06986000
*   /*                                                               */ 06987000
*   /* INITIALIZE INTERNAL CONDITION CODE AREA               @Y30LB34*/ 06988000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 06989000
*   /*                                                               */ 06990000
*   /*****************************************************************/ 06991000
*                                                                  1629 06992000
*   CC20=LASTCC00;                  /*                       @Y30LB34*/ 06993000
         SLR   CC20,CC20                                           1629 06994000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 06995000
*                                                                  1630 06996000
         ST    REG14,RTNREG3                                       1630 06997000
*   /*****************************************************************/ 06998000
*   /*                                                               */ 06999000
*   /* INITIALIZE RVVI PARM LIST FOR RETRIEVING A BASE       @Y30LB34*/ 07000000
*   /* VOLUME RECORD                                         @Y30LB34*/ 07001000
*   /*                                                               */ 07002000
*   /*****************************************************************/ 07003000
*                                                                  1631 07004000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB34*/ 07005000
         L     @15,RVVIPTR                                         1631 07006000
         LH    @14,RVVLEN                                          1631 07007000
         ST    @14,RVVLNGTH(,@15)                                  1631 07008000
*   RVVCODE=RVVOP;                  /*                       @Y30LB34*/ 07009000
         MVI   RVVCODE(@15),X'87'                                  1632 07010000
*   RVVOLUME=SVOLSER;               /*                       @Y30LB34*/ 07011000
         MVC   RVVOLUME(6,@15),SVOLSER                             1633 07012000
*   RVVRDR=ON;                      /*                       @Y30LB34*/ 07013000
         OI    RVVRDR(@15),B'10000000'                             1634 07014000
*   RVVBVRCD=ON;                    /*                       @Y30LB34*/ 07015000
         OI    RVVBVRCD(@15),B'10000000'                           1635 07016000
*   RVVBUFLN=LENGTH(BASEVAR);       /*                       @Y30LB34*/ 07017000
         MVC   RVVBUFLN(2,@15),@CH01875                            1636 07018000
*   RVVRTBUF=ADDR(BASEVAR);         /*                       @Y30LB34*/ 07019000
         LA    @14,BASEVAR                                         1637 07020000
         ST    @14,RVVRTBUF(,@15)                                  1637 07021000
*                                                                  1638 07022000
*   /*****************************************************************/ 07023000
*   /*                                                               */ 07024000
*   /* ISSUE USSC TO ISSUE ICBVVIC TO RETRIEVE THE BASE      @Y30LB34*/ 07025000
*   /* VOLUME RECORD FOR THE SOURCE VOLUME                   @Y30LB34*/ 07026000
*   /*                                                               */ 07027000
*   /*****************************************************************/ 07028000
*                                                                  1638 07029000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,USSCREG0);/*           @Y30LB34*/ 07030000
         ST    @08,@AL00001                                        1638 07031000
         LA    @15,VVIC                                            1638 07032000
         ST    @15,@AL00001+4                                      1638 07033000
         LA    @15,RVVIPTR                                         1638 07034000
         ST    @15,@AL00001+8                                      1638 07035000
         LA    @15,USSCREG0                                        1638 07036000
         ST    @15,@AL00001+12                                     1638 07037000
         MVI   @AL00001+12,X'80'                                   1638 07038000
         L     @15,GDTSSC(,@08)                                    1638 07039000
         LA    @01,@AL00001                                        1638 07040000
         BALR  @14,@15                                             1638 07041000
*   RESPECIFY                                                      1639 07042000
*     RTNREG RSTD;                                                 1639 07043000
*   TESTRC=RTNREG;                                                 1640 07044000
         STH   RTNREG,TESTRC                                       1640 07045000
*   RESPECIFY                                                      1641 07046000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 07047000
*                                                                  1641 07048000
*   /*****************************************************************/ 07049000
*   /*                                                               */ 07050000
*   /* IF USSC WAS UNSUCCESSFUL, CALL SSCMSG TO PRINT        @Y30LB34*/ 07051000
*   /* THE USSC MESSAGE, PRINT MESSAGE IDC2080I, AND         @Y30LB34*/ 07052000
*   /* SET THE CONDITION CODE TO 12                          @Y30LB34*/ 07053000
*   /*                                                               */ 07054000
*   /*****************************************************************/ 07055000
*                                                                  1642 07056000
*   IF TESTRC>0 THEN                                               1642 07057000
         LH    @08,TESTRC                                          1642 07058000
         LTR   @08,@08                                             1642 07059000
         BNP   @RF01642                                            1642 07060000
*     DO;                           /*                       @Y30LB34*/ 07061000
*       CALL SSCMSG(USSCREG0);      /*                       @Y30LB34*/ 07062000
         LA    @15,USSCREG0                                        1644 07063000
         ST    @15,@AL00001                                        1644 07064000
         LA    @01,@AL00001                                        1644 07065000
         BAL   @14,SSCMSG                                          1644 07066000
*       CC20=LASTCC12;              /*                       @Y30LB34*/ 07067000
         LA    CC20,12                                             1645 07068000
*       DARGSMOD=COMMSG;            /*                       @Y30LB34*/ 07069000
         L     @08,DDSTRU                                          1646 07070000
         MVC   DARGSMOD(3,@08),@CC01555                            1646 07071000
*       DARGSENT=MSG2080I;          /*                       @Y30LB34*/ 07072000
         MVI   DARGSENT(@08),X'1A'                                 1647 07073000
*       DARGDBP=ADDR(SVOLSER);      /*                       @Y30LB34*/ 07074000
         LA    @15,SVOLSER                                         1648 07075000
         ST    @15,DARGDBP(,@08)                                   1648 07076000
*       DARGILP=LENGTH(SVOLSER);    /*                       @Y30LB34*/ 07077000
         MVC   DARGILP(2,@08),@CH00038                             1649 07078000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 07079000
         SLR   @15,@15                                             1650 07080000
         ST    @15,DARGRETP(,@08)                                  1650 07081000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 07082000
         L     @08,@PC00001                                        1651 07083000
         ST    @08,@AL00001                                        1651 07084000
         LA    @15,@CF00115                                        1651 07085000
         ST    @15,@AL00001+4                                      1651 07086000
         LA    @15,DDSTRU                                          1651 07087000
         ST    @15,@AL00001+8                                      1651 07088000
         MVI   @AL00001+8,X'80'                                    1651 07089000
         L     @15,GDTPRT(,@08)                                    1651 07090000
         LA    @01,@AL00001                                        1651 07091000
         BALR  @14,@15                                             1651 07092000
*     END;                          /*                       @Y30LB34*/ 07093000
*                                                                  1652 07094000
*   /*****************************************************************/ 07095000
*   /*                                                               */ 07096000
*   /* IF USSC WAS SUCCESSFUL, CHECK BASE VOLUME RECORD      @Y30LB34*/ 07097000
*   /*                                                               */ 07098000
*   /*****************************************************************/ 07099000
*                                                                  1653 07100000
*   ELSE                                                           1653 07101000
*     DO;                           /*                       @Y30LB34*/ 07102000
         B     @RC01642                                            1653 07103000
@RF01642 DS    0H                                                  1654 07104000
*                                                                  1654 07105000
*       /*************************************************************/ 07106000
*       /*                                                           */ 07107000
*       /* TEST FOR AN ACTIVE VOLUME. IF NOT, PRINT          @Y30LB34*/ 07108000
*       /* ERROR MESSAGE IDC3074I AND SET CONDITION CODE     @Y30LB34*/ 07109000
*       /* TO 12.                                            @Y30LB34*/ 07110000
*       /*                                                           */ 07111000
*       /*************************************************************/ 07112000
*                                                                  1654 07113000
*       IF BASINAC=ON THEN                                         1654 07114000
         L     @08,BASEVPTR                                        1654 07115000
         TM    BASINAC(@08),B'00000100'                            1654 07116000
         BNO   @RF01654                                            1654 07117000
*         DO;                       /*                       @Y30LB34*/ 07118000
*           CC20=LASTCC12;          /*                       @Y30LB34*/ 07119000
         LA    CC20,12                                             1656 07120000
*           DARGSMOD=COMMSG;        /*                       @Y30LB34*/ 07121000
         L     @08,DDSTRU                                          1657 07122000
         MVC   DARGSMOD(3,@08),@CC01555                            1657 07123000
*           DARGSENT=MSG3074I;      /*                       @Y30LB34*/ 07124000
         MVI   DARGSENT(@08),X'20'                                 1658 07125000
*           DARGDBP=ADDR(SVOLSER);  /*                       @Y30LB34*/ 07126000
         LA    @15,SVOLSER                                         1659 07127000
         ST    @15,DARGDBP(,@08)                                   1659 07128000
*           DARGILP=LENGTH(SVOLSER);/*                       @Y30LB34*/ 07129000
         MVC   DARGILP(2,@08),@CH00038                             1660 07130000
*           DARGRETP=0;             /*                       @Y30LB34*/ 07131000
         SLR   @15,@15                                             1661 07132000
         ST    @15,DARGRETP(,@08)                                  1661 07133000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 07134000
         L     @08,@PC00001                                        1662 07135000
         ST    @08,@AL00001                                        1662 07136000
         LA    @15,@CF00115                                        1662 07137000
         ST    @15,@AL00001+4                                      1662 07138000
         LA    @15,DDSTRU                                          1662 07139000
         ST    @15,@AL00001+8                                      1662 07140000
         MVI   @AL00001+8,X'80'                                    1662 07141000
         L     @15,GDTPRT(,@08)                                    1662 07142000
         LA    @01,@AL00001                                        1662 07143000
         BALR  @14,@15                                             1662 07144000
*         END;                      /*                       @Y30LB34*/ 07145000
*                                                                  1663 07146000
*       /*************************************************************/ 07147000
*       /*                                                           */ 07148000
*       /* IF VOLUME IS ACTIVE, TEST RECOVERY FLAGS          @Y30LB34*/ 07149000
*       /*                                                           */ 07150000
*       /*************************************************************/ 07151000
*                                                                  1664 07152000
*       ELSE                                                       1664 07153000
*         DO;                       /*                       @Y30LB34*/ 07154000
*                                                                  1664 07155000
         B     @RC01654                                            1664 07156000
@RF01654 DS    0H                                                  1665 07157000
*           /*********************************************************/ 07158000
*           /*                                                       */ 07159000
*           /* IF THE INCOMPLETE-VOLUME-CREATION FLAG IS ON, @Y30LB34*/ 07160000
*           /* PRINT ERROR MESSAGE IDC3097I AND SET          @Y30LB34*/ 07161000
*           /* CONDITION CODE TO 12                          @Y30LB34*/ 07162000
*           /*                                                       */ 07163000
*           /*********************************************************/ 07164000
*                                                                  1665 07165000
*           IF BASIVCRE=ON THEN                                    1665 07166000
         L     @08,BASEVPTR                                        1665 07167000
         TM    BASIVCRE(@08),B'10000000'                           1665 07168000
         BNO   @RF01665                                            1665 07169000
*             DO;                   /*                       @Y30LB34*/ 07170000
*               CC20=LASTCC12;      /*                       @Y30LB34*/ 07171000
         LA    CC20,12                                             1667 07172000
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/ 07173000
         L     @08,DDSTRU                                          1668 07174000
         MVC   DARGSMOD(3,@08),@CC01555                            1668 07175000
*               DARGSENT=MSG3097F;  /*                       @Y30LB34*/ 07176000
         MVI   DARGSENT(@08),X'05'                                 1669 07177000
*               DARGDBP=ADDR(SVOLSER);/*                     @Y30LB34*/ 07178000
         LA    @15,SVOLSER                                         1670 07179000
         ST    @15,DARGDBP(,@08)                                   1670 07180000
*               DARGILP=LENGTH(SVOLSER);/*                   @Y30LB34*/ 07181000
         MVC   DARGILP(2,@08),@CH00038                             1671 07182000
*               DARGRETP=0;         /*                       @Y30LB34*/ 07183000
         SLR   @15,@15                                             1672 07184000
         ST    @15,DARGRETP(,@08)                                  1672 07185000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB34*/ 07186000
         L     @08,@PC00001                                        1673 07187000
         ST    @08,@AL00001                                        1673 07188000
         LA    @15,@CF00115                                        1673 07189000
         ST    @15,@AL00001+4                                      1673 07190000
         LA    @15,DDSTRU                                          1673 07191000
         ST    @15,@AL00001+8                                      1673 07192000
         MVI   @AL00001+8,X'80'                                    1673 07193000
         L     @15,GDTPRT(,@08)                                    1673 07194000
         LA    @01,@AL00001                                        1673 07195000
         BALR  @14,@15                                             1673 07196000
*             END;                  /*                       @Y30LB34*/ 07197000
*                                                                  1675 07198000
*           /*********************************************************/ 07199000
*           /*                                                       */ 07200000
*           /* IF THE VOLUME-SERIAL-MISMATCH FLAG IS ON,     @Y30LB34*/ 07201000
*           /* PRINT ERROR MESSAGE IDC3095I AND SET          @Y30LB34*/ 07202000
*           /* CONDITION CODE TO 12                          @Y30LB34*/ 07203000
*           /*                                                       */ 07204000
*           /*********************************************************/ 07205000
*                                                                  1675 07206000
*           ELSE                                                   1675 07207000
*             IF BASVSMIS=ON THEN                                  1675 07208000
         B     @RC01665                                            1675 07209000
@RF01665 L     @08,BASEVPTR                                        1675 07210000
         TM    BASVSMIS(@08),B'00100000'                           1675 07211000
         BNO   @RF01675                                            1675 07212000
*               DO;                 /*                       @Y30LB34*/ 07213000
*                 CC20=LASTCC12;    /*                       @Y30LB34*/ 07214000
         LA    CC20,12                                             1677 07215000
*                 DARGSMOD=COMMSG;  /*                       @Y30LB34*/ 07216000
         L     @08,DDSTRU                                          1678 07217000
         MVC   DARGSMOD(3,@08),@CC01555                            1678 07218000
*                 DARGSENT=MSG3095F;/*                       @Y30LB34*/ 07219000
         MVI   DARGSENT(@08),X'0B'                                 1679 07220000
*                 DARGDBP=ADDR(SVOLSER);/*                   @Y30LB34*/ 07221000
         LA    @15,SVOLSER                                         1680 07222000
         ST    @15,DARGDBP(,@08)                                   1680 07223000
*                 DARGILP=LENGTH(SVOLSER);/*                 @Y30LB34*/ 07224000
         MVC   DARGILP(2,@08),@CH00038                             1681 07225000
*                 DARGRETP=0;       /*                       @Y30LB34*/ 07226000
         SLR   @15,@15                                             1682 07227000
         ST    @15,DARGRETP(,@08)                                  1682 07228000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB34*/ 07229000
         L     @08,@PC00001                                        1683 07230000
         ST    @08,@AL00001                                        1683 07231000
         LA    @15,@CF00115                                        1683 07232000
         ST    @15,@AL00001+4                                      1683 07233000
         LA    @15,DDSTRU                                          1683 07234000
         ST    @15,@AL00001+8                                      1683 07235000
         MVI   @AL00001+8,X'80'                                    1683 07236000
         L     @15,GDTPRT(,@08)                                    1683 07237000
         LA    @01,@AL00001                                        1683 07238000
         BALR  @14,@15                                             1683 07239000
*               END;                /*                       @Y30LB34*/ 07240000
*                                                                  1684 07241000
*           /*********************************************************/ 07242000
*           /*                                                       */ 07243000
*           /* IF THE INCOMPLETE-COPY-OPERATION FLAG IS ON,  @Y30LB34*/ 07244000
*           /* PRINT ERROR MESSAGE IDC3096I AND SET          @Y30LB34*/ 07245000
*           /* CONDITION CODE TO 12                          @Y30LB34*/ 07246000
*           /*                                                       */ 07247000
*           /*********************************************************/ 07248000
*                                                                  1685 07249000
*             ELSE                                                 1685 07250000
*               IF BASIVCPY=ON THEN                                1685 07251000
         B     @RC01675                                            1685 07252000
@RF01675 L     @08,BASEVPTR                                        1685 07253000
         TM    BASIVCPY(@08),B'01000000'                           1685 07254000
         BNO   @RF01685                                            1685 07255000
*                 DO;               /*                       @Y30LB34*/ 07256000
*                   CC20=LASTCC12;  /*                       @Y30LB34*/ 07257000
         LA    CC20,12                                             1687 07258000
*                   DARGSMOD=COMMSG;/*                       @Y30LB34*/ 07259000
         L     @08,DDSTRU                                          1688 07260000
         MVC   DARGSMOD(3,@08),@CC01555                            1688 07261000
*                   DARGSENT=MSG3096I;/*                     @Y30LB34*/ 07262000
         MVI   DARGSENT(@08),X'08'                                 1689 07263000
*                   DARGDBP=ADDR(SVOLSER);/*                 @Y30LB34*/ 07264000
         LA    @15,SVOLSER                                         1690 07265000
         ST    @15,DARGDBP(,@08)                                   1690 07266000
*                   DARGILP=LENGTH(SVOLSER);/*               @Y30LB34*/ 07267000
         MVC   DARGILP(2,@08),@CH00038                             1691 07268000
*                   DARGRETP=0;     /*                       @Y30LB34*/ 07269000
         SLR   @15,@15                                             1692 07270000
         ST    @15,DARGRETP(,@08)                                  1692 07271000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Y30LB34*/ 07272000
         L     @08,@PC00001                                        1693 07273000
         ST    @08,@AL00001                                        1693 07274000
         LA    @15,@CF00115                                        1693 07275000
         ST    @15,@AL00001+4                                      1693 07276000
         LA    @15,DDSTRU                                          1693 07277000
         ST    @15,@AL00001+8                                      1693 07278000
         MVI   @AL00001+8,X'80'                                    1693 07279000
         L     @15,GDTPRT(,@08)                                    1693 07280000
         LA    @01,@AL00001                                        1693 07281000
         BALR  @14,@15                                             1693 07282000
*                 END;              /*                       @Y30LB34*/ 07283000
*         END;                      /*                       @Y30LB34*/ 07284000
@RF01685 DS    0H                                                  1695 07285000
@RC01675 DS    0H                                                  1695 07286000
@RC01665 DS    0H                                                  1696 07287000
*     END;                          /*                       @Y30LB34*/ 07288000
@RC01654 DS    0H                                                  1697 07289000
*                                                                  1697 07290000
*   /*****************************************************************/ 07291000
*   /*                                                               */ 07292000
*   /* IF NO SEVERE ERROR OCCURRED IN RETRIEVING AND         @Y30LB34*/ 07293000
*   /* INTERROGATING THE BASE VOLUME RECORD,                 @YD00175*/ 07294000
*   /* OBTAIN EXCLUSIVE USE OF TARGET VOLUME                 @YD00175*/ 07295000
*   /*                                                               */ 07296000
*   /*****************************************************************/ 07297000
*                                                                  1697 07298000
*   IF CC20<LASTCC12 THEN                                          1697 07299000
@RC01642 C     CC20,@CF00567                                       1697 07300000
         BNL   @RF01697                                            1697 07301000
*     DO;                           /*                       @Y30LB34*/ 07302000
*                                                                  1698 07303000
*       /*************************************************************/ 07304000
*       /*                                                           */ 07305000
*       /* SET UP EXCLUSIVE CONTROL PARM LIST                @YD00175*/ 07306000
*       /*                                                           */ 07307000
*       /*************************************************************/ 07308000
*                                                                  1699 07309000
*       EXCLAGL=''B;                /*                       @YD00175*/ 07310000
         LA    @08,EXCLAR                                          1699 07311000
         XC    EXCLAGL(23,@08),EXCLAGL(@08)                        1699 07312000
*       EXCLUCBP=ADDR(TUCBADDR);    /*                       @YD00175*/ 07313000
         LA    @15,TUCBADDR                                        1700 07314000
         ST    @15,EXCLUCBP(,@08)                                  1700 07315000
*       EXCLDDP=ADDR(TFILEVAL);     /*                       @YD00175*/ 07316000
*                                                                  1701 07317000
         L     @15,@PC00001+4                                      1701 07318000
         L     @01,FDTPTR+4(,@15)                                  1701 07319000
         LA    @15,TFILEVAL(,@01)                                  1701 07320000
         ST    @15,EXCLDDP(,@08)                                   1701 07321000
*       /*************************************************************/ 07322000
*       /*                                                           */ 07323000
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/ 07324000
*       /*                                                           */ 07325000
*       /*************************************************************/ 07326000
*                                                                  1702 07327000
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/ 07328000
         L     @15,@PC00001                                        1702 07329000
         ST    @15,@AL00001                                        1702 07330000
         LA    @14,CHANGEX                                         1702 07331000
         ST    @14,@AL00001+4                                      1702 07332000
         ST    @08,@AL00001+8                                      1702 07333000
         MVI   @AL00001+8,X'80'                                    1702 07334000
         L     @15,GDTUNT(,@15)                                    1702 07335000
         LA    @01,@AL00001                                        1702 07336000
         BALR  @14,@15                                             1702 07337000
*       RESPECIFY                                                  1703 07338000
*         RTNREG RSTD;                                             1703 07339000
*       TESTRC=RTNREG;                                             1704 07340000
         STH   RTNREG,TESTRC                                       1704 07341000
*       RESPECIFY                                                  1705 07342000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 07343000
*                                                                  1705 07344000
*       /*************************************************************/ 07345000
*       /*                                                           */ 07346000
*       /* IF RETURN CODE IS NOT ZERO, SET INTERNAL CONDITION        */ 07347000
*       /*                                                   @YD00175*/ 07348000
*       /* CODE TO 12                                        @YD00175*/ 07349000
*       /*                                                           */ 07350000
*       /*************************************************************/ 07351000
*                                                                  1706 07352000
*       IF TESTRC>0 THEN                                           1706 07353000
         LH    @08,TESTRC                                          1706 07354000
         LTR   @08,@08                                             1706 07355000
         BNP   @RF01706                                            1706 07356000
*         CC20=LASTCC12;            /*                       @YD00175*/ 07357000
         LA    CC20,12                                             1707 07358000
*     END;                          /*                       @YD00175*/ 07359000
@RF01706 DS    0H                                                  1709 07360000
*                                                                  1709 07361000
*   /*****************************************************************/ 07362000
*   /*                                                               */ 07363000
*   /* IF NO ERRORS, PREPARE TO USE SOURCE VOLUME            @YD00175*/ 07364000
*   /*                                                               */ 07365000
*   /*****************************************************************/ 07366000
*                                                                  1709 07367000
*   IF CC20<LASTCC12 THEN                                          1709 07368000
@RF01697 C     CC20,@CF00567                                       1709 07369000
         BNL   @RF01709                                            1709 07370000
*     DO;                           /*                       @YD00175*/ 07371000
*                                                                  1710 07372000
*       /*************************************************************/ 07373000
*       /*                                                           */ 07374000
*       /* INITIALIZE THE UMSSUNIT MOUNT/DEMOUNT PARM LIST   #Y30LB34*/ 07375000
*       /*                                                           */ 07376000
*       /*************************************************************/ 07377000
*                                                                  1711 07378000
*       MDUCBPTR=ADDR(SUCBADDR);    /*                       #Y30LB34*/ 07379000
         LA    @08,MDAGLAR                                         1711 07380000
         LA    @15,SUCBADDR                                        1711 07381000
         ST    @15,MDUCBPTR(,@08)                                  1711 07382000
*       MDDDNAME=FFILEVAL;          /*                       #Y30LB34*/ 07383000
         L     @15,@PC00001+4                                      1712 07384000
         L     @01,FDTPTR(,@15)                                    1712 07385000
         MVC   MDDDNAME(8,@08),FFILEVAL(@01)                       1712 07386000
*       MDLABEL=SVOLSER;            /*                       #Y30LB34*/ 07387000
*                                                                  1713 07388000
         MVC   MDLABEL(6,@08),SVOLSER                              1713 07389000
*       /*************************************************************/ 07390000
*       /*                                                           */ 07391000
*       /* IF SOURCE AND TARGET VOLSERS ARE EQUAL,           #Y30LB34*/ 07392000
*       /* INITIALIZE THE UMSSUNIT POST/CLEAR PARM LIST      #Y30LB34*/ 07393000
*       /*                                                           */ 07394000
*       /*************************************************************/ 07395000
*                                                                  1714 07396000
*       IF SAMESER=ON THEN                                         1714 07397000
         TM    SAMESER,B'10000000'                                 1714 07398000
         BNO   @RF01714                                            1714 07399000
*         DO;                       /*                       #Y30LB34*/ 07400000
*           PUUCBPTR=ADDR(TUCBADDR);/*                       #Y30LB34*/ 07401000
         LA    @15,PUAGLAR                                         1716 07402000
         LA    @14,TUCBADDR                                        1716 07403000
         ST    @14,PUUCBPTR(,@15)                                  1716 07404000
*           PULABELP=ADDR(TLABEL);  /*                       #Y30LB34*/ 07405000
         LA    @14,TLABEL                                          1717 07406000
         ST    @14,PULABELP(,@15)                                  1717 07407000
*           PUTTRPTR=ADDR(TVTOCTTR);/*                       #YM02856*/ 07408000
         LA    @14,TVTOCTTR                                        1718 07409000
         ST    @14,PUTTRPTR(,@15)                                  1718 07410000
*           MDPUAGL=ADDR(PUAGLAR);  /*                       #Y30LB34*/ 07411000
*                                                                  1719 07412000
         ST    @15,MDPUAGL(,@08)                                   1719 07413000
*           /*********************************************************/ 07414000
*           /*                                                       */ 07415000
*           /* ISSUE UMSSUNIT TO MOUNT THE MSS SOURCE VOLUME #Y30LB34*/ 07416000
*           /* IF THE VOLSERS ARE THE SAME. SET THE BIT ON   #Y30LB34*/ 07417000
*           /* TO CLEAR THE TARGET UCB BEFORE MOUNT          @Y30LB34*/ 07418000
*           /*                                                       */ 07419000
*           /*********************************************************/ 07420000
*                                                                  1720 07421000
*           MDCLEAR=ON;             /*                       @Y30LB34*/ 07422000
         OI    MDCLEAR(@08),B'01000000'                            1720 07423000
*           CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*             @Y30LB34*/ 07424000
         L     @15,@PC00001                                        1721 07425000
         ST    @15,@AL00001                                        1721 07426000
         LA    @14,MOUNT                                           1721 07427000
         ST    @14,@AL00001+4                                      1721 07428000
         ST    @08,@AL00001+8                                      1721 07429000
         MVI   @AL00001+8,X'80'                                    1721 07430000
         L     @15,GDTUNT(,@15)                                    1721 07431000
         LA    @01,@AL00001                                        1721 07432000
         BALR  @14,@15                                             1721 07433000
*           RESPECIFY                                              1722 07434000
*             RTNREG RSTD;                                         1722 07435000
*           TESTRC=RTNREG;                                         1723 07436000
         STH   RTNREG,TESTRC                                       1723 07437000
*           RESPECIFY                                              1724 07438000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 07439000
*           MDCLEAR=OFF;            /*                       @Y30LB34*/ 07440000
         LA    @08,MDAGLAR                                         1725 07441000
         NI    MDCLEAR(@08),B'10111111'                            1725 07442000
*                                                                  1726 07443000
*           /*********************************************************/ 07444000
*           /*                                                       */ 07445000
*           /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE        @Y30LB34*/ 07446000
*           /* CONDITION CODE TO 12 AND TERMINATE THE        @Y30LB34*/ 07447000
*           /* COMMAND                                       @Y30LB34*/ 07448000
*           /*                                                       */ 07449000
*           /*********************************************************/ 07450000
*                                                                  1726 07451000
*           IF TESTRC>0 THEN                                       1726 07452000
         LH    @08,TESTRC                                          1726 07453000
         LTR   @08,@08                                             1726 07454000
         BNP   @RF01726                                            1726 07455000
*             CC20=LASTCC12;        /*                       @Y30LB34*/ 07456000
         LA    CC20,12                                             1727 07457000
*         END;                      /*                       @Y30LB34*/ 07458000
@RF01726 DS    0H                                                  1729 07459000
*     END;                          /*                       @Y30LB34*/ 07460000
*                                                                  1729 07461000
@RF01714 DS    0H                                                  1730 07462000
*   /*****************************************************************/ 07463000
*   /*                                                               */ 07464000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 07465000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 07466000
*   /*                                                               */ 07467000
*   /*****************************************************************/ 07468000
*                                                                  1730 07469000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 07470000
@RF01709 L     REG14,RTNREG3                                       1730 07471000
*   RETURN CODE(CC20);              /*                       @Y30LB34*/ 07472000
         LR    @15,CC20                                            1731 07473000
@EL00021 DS    0H                                                  1731 07474000
@EF00021 DS    0H                                                  1731 07475000
@ER00021 BR    @14                                                 1731 07476000
*   END VRGETSO;                    /*                       @Y30LB34*/ 07477000
*                                                                  1733 07478000
*/********************************************************** @Y30LB34*/ 07479000
*/*                                                          @Y30LB34*/ 07480000
*/* PROCEDURE NAME - VRINITTA                                @Y30LB34*/ 07481000
*/*                                                          @Y30LB34*/ 07482000
*/* FUNCTION - INTERROGATES THE TARGET VOLUME                @Y30LB34*/ 07483000
*/*                                                          @Y30LB34*/ 07484000
*/*            INITIALIZES THE VOLUME SERVICES PARM LIST     @Y30LB34*/ 07485000
*/*            FOR RETRIEVING LABEL INFORMATION              @Y30LB34*/ 07486000
*/*                                                          @Y30LB34*/ 07487000
*/*            CALLS VOLUME SERVICES TO RETRIEVE THE OWNER   @Y30LB34*/ 07488000
*/*            FROM THE LABEL                                @Y30LB34*/ 07489000
*/*                                                          @Y30LB34*/ 07490000
*/*            CALLS CHEKTARG TO CHECK THE TARGET VOLUME     @Y30LB34*/ 07491000
*/*                                                          @Y30LB34*/ 07492000
*/* INPUT - TARGAREA, VS2AGL                                 @Y30LB34*/ 07493000
*/*                                                          @Y30LB34*/ 07494000
*/* OUTPUT - INITIALIZED VS2AGL                              @Y30LB34*/ 07495000
*/*                                                          @Y30LB34*/ 07496000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 07497000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 07498000
*/*           R. C. =  4, RETURN CODE FROM CHEKTARG,         @Y30LB34*/ 07499000
*/*                       UNABLE TO CLOSE VTOC               @Y30LB34*/ 07500000
*/*           R. C. = 12, UNABLE TO RETRIEVE OWNER,          @Y30LB34*/ 07501000
*/*                       RETURN CODE FROM VRGETTA OR        @Y30LB34*/ 07502000
*/*                       CHEKTARG                           @Y30LB34*/ 07503000
*/*                                                          @Y30LB34*/ 07504000
*/********************************************************** @Y30LB34*/ 07505000
*                                                                  1733 07506000
*VRINITTA:                                                         1733 07507000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 07508000
*                                                                  1733 07509000
VRINITTA DS    0H                                                  1734 07510000
*   /*****************************************************************/ 07511000
*   /*                                                               */ 07512000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 07513000
*   /*                                                               */ 07514000
*   /*****************************************************************/ 07515000
*                                                                  1734 07516000
*   DCL                                                            1734 07517000
*     CC21 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   07518000
*                                      CODE SAVE AREA        @Y30LB34*/ 07519000
*                                                                  1735 07520000
*   /*****************************************************************/ 07521000
*   /*                                                               */ 07522000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 07523000
*   /*                                                               */ 07524000
*   /*****************************************************************/ 07525000
*                                                                  1735 07526000
*   OLDERID2=NEWERID2;                                             1735 07527000
         L     @10,@PC00001                                        1735 07528000
         L     @15,GDTTR2(,@10)                                    1735 07529000
         MVC   @TS00001(95),NEWERID2(@15)                          1735 07530000
         MVC   OLDERID2(95,@15),@TS00001                           1735 07531000
*   NEWID2='CNTL';                  /*                       @Y30LB34*/ 07532000
*                                                                  1736 07533000
         MVC   NEWID2(4,@15),@CC01828                              1736 07534000
*   /*****************************************************************/ 07535000
*   /*                                                               */ 07536000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 07537000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 07538000
*   /*                                                               */ 07539000
*   /*****************************************************************/ 07540000
*                                                                  1737 07541000
*   CC21=LASTCC00;                  /*                       @Y30LB34*/ 07542000
         SLR   CC21,CC21                                           1737 07543000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 07544000
*                                                                  1738 07545000
         LR    RTNREG2,REG14                                       1738 07546000
*   /*****************************************************************/ 07547000
*   /*                                                               */ 07548000
*   /* INITIALIZE IDCVS02 TO RETRIEVE THE OWNER FROM THE     @Y30LB34*/ 07549000
*   /* LABEL                                                 @Y30LB34*/ 07550000
*   /*                                                               */ 07551000
*   /*****************************************************************/ 07552000
*                                                                  1739 07553000
*   VSUCBPTR=ADDR(TUCBADDR);        /*                       @Y30LB34*/ 07554000
         LA    @15,VS2AGLAR                                        1739 07555000
         LA    @14,TUCBADDR                                        1739 07556000
         ST    @14,VSUCBPTR(,@15)                                  1739 07557000
*   VSDDNAME=TFILEVAL;              /*                       @Y30LB34*/ 07558000
         L     @14,@PC00001+4                                      1740 07559000
         L     @01,FDTPTR+4(,@14)                                  1740 07560000
         MVC   VSDDNAME(8,@15),TFILEVAL(@01)                       1740 07561000
*   VSOWNPTR=ADDR(TOWNER);          /*                       @Y30LB34*/ 07562000
         LA    @14,TOWNER                                          1741 07563000
         ST    @14,VSOWNPTR(,@15)                                  1741 07564000
*   VSOWNER=ON;                     /*                       @Y30LB34*/ 07565000
         OI    VSOWNER(@15),B'10000000'                            1742 07566000
*   VSVOLUME=TVOLSER;               /*                       @Y30LB34*/ 07567000
*                                                                  1743 07568000
         MVC   VSVOLUME(6,@15),TVOLSER                             1743 07569000
*   /*****************************************************************/ 07570000
*   /*                                                               */ 07571000
*   /* CALL VOLUME SERVICES TO RETRIEVE THE OWNER            @Y30LB34*/ 07572000
*   /*                                                               */ 07573000
*   /*****************************************************************/ 07574000
*                                                                  1744 07575000
*   CALL IDCSACL0(GDTTBL,'IDCVS02 ',GETLABEL,VS2AGL);/*      @Y30LB34*/ 07576000
         ST    @10,@AL00001                                        1744 07577000
         LA    @14,@CC01768                                        1744 07578000
         ST    @14,@AL00001+4                                      1744 07579000
         LA    @14,GETLABEL                                        1744 07580000
         ST    @14,@AL00001+8                                      1744 07581000
         ST    @15,@AL00001+12                                     1744 07582000
         MVI   @AL00001+12,X'80'                                   1744 07583000
         L     @15,GDTCAL(,@10)                                    1744 07584000
         LA    @01,@AL00001                                        1744 07585000
         BALR  @14,@15                                             1744 07586000
*   RESPECIFY                                                      1745 07587000
*     RTNREG RSTD;                                                 1745 07588000
*   TESTRC=RTNREG;                                                 1746 07589000
         STH   RTNREG,TESTRC                                       1746 07590000
*   RESPECIFY                                                      1747 07591000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 07592000
*                                                                  1747 07593000
*   /*****************************************************************/ 07594000
*   /*                                                               */ 07595000
*   /* IF VOLUME SERVICES IS UNSUCCESSFUL, SET CONDITION     @Y30LB34*/ 07596000
*   /* CODE TO 12                                            @Y30LB34*/ 07597000
*   /*                                                               */ 07598000
*   /*****************************************************************/ 07599000
*                                                                  1748 07600000
*   IF TESTRC=4 THEN                                               1748 07601000
         LH    @10,TESTRC                                          1748 07602000
         C     @10,@CF00036                                        1748 07603000
         BNE   @RF01748                                            1748 07604000
*     CC21=LASTCC12;                /*                       @Y30LB34*/ 07605000
*                                                                  1749 07606000
         LA    CC21,12                                             1749 07607000
*   /*****************************************************************/ 07608000
*   /*                                                               */ 07609000
*   /* IF VOLUME SERVICES CANNOT CLOSE THE VTOC SET          @Y30LB34*/ 07610000
*   /* CONDITION CODE TO 4                                   @Y30LB34*/ 07611000
*   /*                                                               */ 07612000
*   /*****************************************************************/ 07613000
*                                                                  1750 07614000
*   IF TESTRC=8 THEN                                               1750 07615000
@RF01748 CLC   TESTRC(2),@CH00177                                  1750 07616000
         BNE   @RF01750                                            1750 07617000
*     CC21=LASTCC04;                /*                       @Y30LB34*/ 07618000
*                                                                  1751 07619000
         LA    CC21,4                                              1751 07620000
*   /*****************************************************************/ 07621000
*   /*                                                               */ 07622000
*   /* IF NO SEVERE ERROR HAS OCCURRED, CHECK TARGET         @Y30LB34*/ 07623000
*   /* VOLUME AND PREPARE FOR DATA CONVERSION.               @Y30LB34*/ 07624000
*   /*                                                               */ 07625000
*   /*****************************************************************/ 07626000
*                                                                  1752 07627000
*   IF CC21<LASTCC12 THEN                                          1752 07628000
@RF01750 C     CC21,@CF00567                                       1752 07629000
         BNL   @RF01752                                            1752 07630000
*     DO;                           /*                       @Y30LB34*/ 07631000
*                                                                  1753 07632000
*       /*************************************************************/ 07633000
*       /*                                                           */ 07634000
*       /* CALL CHEKTARG TO INITIALIZE THE VOLUME            @Y30LB34*/ 07635000
*       /* SERVICES PARM LIST, PERFORM SECURITY CHECKING     @Y30LB34*/ 07636000
*       /* AND RETRIEVE VTOC INFORMATION                     @Y30LB34*/ 07637000
*       /*                                                           */ 07638000
*       /*************************************************************/ 07639000
*                                                                  1754 07640000
*       CALL CHEKTARG;              /*                       @Y30LB34*/ 07641000
         BAL   @14,CHEKTARG                                        1754 07642000
*       RESPECIFY                                                  1755 07643000
*         RTNREG RSTD;                                             1755 07644000
*       TESTRC=RTNREG;                                             1756 07645000
         STH   RTNREG,TESTRC                                       1756 07646000
*       RESPECIFY                                                  1757 07647000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 07648000
*       CC21=MAX(CC21,TESTRC);      /*                       @Y30LB34*/ 07649000
         LH    @10,TESTRC                                          1758 07650000
         CR    CC21,@10                                            1758 07651000
         BNL   *+6                                                      07652000
         LR    CC21,@10                                            1758 07653000
*     END;                          /*                       @Y30LB34*/ 07654000
*                                                                  1759 07655000
*   /*****************************************************************/ 07656000
*   /*                                                               */ 07657000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 07658000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 07659000
*   /*                                                               */ 07660000
*   /*****************************************************************/ 07661000
*                                                                  1760 07662000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 07663000
@RF01752 LR    REG14,RTNREG2                                       1760 07664000
*   RETURN CODE(CC21);              /*                       @Y30LB34*/ 07665000
         LR    @15,CC21                                            1761 07666000
@EL00022 DS    0H                                                  1761 07667000
@EF00022 DS    0H                                                  1761 07668000
@ER00022 BR    @14                                                 1761 07669000
*   END VRINITTA;                   /*                       @Y30LB34*/ 07670000
*                                                                  1763 07671000
*/********************************************************** @Y30LB34*/ 07672000
*/*                                                          @Y30LB34*/ 07673000
*/* PROCEDURE NAME - VRMOVE                                  @Y30LB34*/ 07674000
*/*                                                          @Y30LB34*/ 07675000
*/* FUNCTION - CONTROLS THE DATA CONVERSION PROCESS WHICH    @Y30LB34*/ 07676000
*/*            CONSISTS OF THREE OPERATIONS:                 @Y30LB34*/ 07677000
*/*                1)  COPY VOLUME,                          @Y30LB34*/ 07678000
*/*                2)  UPDATE TARGET VOLUME VTOC,            @Y30LB34*/ 07679000
*/*                3)  RECATALOG DATA SETS.  (THIS IS ONLY   @Y30LB34*/ 07680000
*/*                    ESSENTIAL FOR VSAM VOLUMES.)          @Y30LB34*/ 07681000
*/*                     IF ANY OF THESE OPERATIONS IS NOT    @Y30LB34*/ 07682000
*/*                     COMPLETED, PRINTS MESSAGE IDC0737I   @Y30LB34*/ 07683000
*/*                     TO NOTIFY TERMINATION OF PROCESSING  @Y30LB34*/ 07684000
*/*                                                          @Y30LB34*/ 07685000
*/*            CALLS VRMOVDAT TO COPY THE DATA FROM VIRTUAL  @Y30LB34*/ 07686000
*/*            TO REAL                                       @Y30LB34*/ 07687000
*/*                                                          @Y30LB34*/ 07688000
*/*            CALLS UPDVTOC TO UPDATE THE VTOC              @Y30LB34*/ 07689000
*/*                                                          @Y30LB34*/ 07690000
*/*            CALLS RECATCTL TO DETERMINE WHAT RECATALOGING @Y30LB34*/ 07691000
*/*            IS TO BE DONE AND REQUESTS VSAM RECATALOGING  @Y30LB34*/ 07692000
*/*            IF NECESSARY                                  @Y30LB34*/ 07693000
*/*                                                          @Y30LB34*/ 07694000
*/*            IF NON-VSAM RECATALOGING IS TO BE DONE,       @Y30LB34*/ 07695000
*/*            REQUESTS VOLUME SERVICES TO RECATALOG NON-    @Y30LB34*/ 07696000
*/*            VSAM DATA SETS NOT ALREADY RECATALOGED        @Y30LB34*/ 07697000
*/*                PRINTS MESSAGE IDC0748I NOTIFYING         @Y30LB34*/ 07698000
*/*                NON-VSAM DATA SETS RECATALOGED            @Y30LB34*/ 07699000
*/*                                                          @Y30LB34*/ 07700000
*/*            DEQUEUES TARGET VOLUME RESERVED IN CHEKTARG   @Y30LB34*/ 07701000
*/*                                                          @Y30LB34*/ 07702000
*/* INPUT - TARGAREA                                         @Y30LB34*/ 07703000
*/*                                                          @Y30LB34*/ 07704000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 07705000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 07706000
*/*           R. C. =  8, UNABLE TO RECATALOG NON-VSAM DATA  @Y30LB34*/ 07707000
*/*                       SETS,                              @Y30LB34*/ 07708000
*/*           R. C. = 12, RETURN CODE FROM VRMOVDAT,         @Y30LB34*/ 07709000
*/*                       UPDVTOC, OR RECATCTL               @Y30LB34*/ 07710000
*/*                                                          @Y30LB34*/ 07711000
*/********************************************************** @Y30LB34*/ 07712000
*                                                                  1763 07713000
*VRMOVE:                                                           1763 07714000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 07715000
*                                                                  1763 07716000
VRMOVE   DS    0H                                                  1764 07717000
*   /*****************************************************************/ 07718000
*   /*                                                               */ 07719000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 07720000
*   /*                                                               */ 07721000
*   /*****************************************************************/ 07722000
*                                                                  1764 07723000
*   DCL                                                            1764 07724000
*     CC22 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   07725000
*                                      CODE SAVE AREA        @Y30LB34*/ 07726000
*                                                                  1765 07727000
*   /*****************************************************************/ 07728000
*   /*                                                               */ 07729000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 07730000
*   /*                                                               */ 07731000
*   /*****************************************************************/ 07732000
*                                                                  1765 07733000
*   OLDERID2=NEWERID2;                                             1765 07734000
         L     @10,@PC00001                                        1765 07735000
         L     @10,GDTTR2(,@10)                                    1765 07736000
         MVC   @TS00001(95),NEWERID2(@10)                          1765 07737000
         MVC   OLDERID2(95,@10),@TS00001                           1765 07738000
*   NEWID2='CNTM';                  /*                       @Y30LB34*/ 07739000
*                                                                  1766 07740000
         MVC   NEWID2(4,@10),@CC01833                              1766 07741000
*   /*****************************************************************/ 07742000
*   /*                                                               */ 07743000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 07744000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 07745000
*   /*                                                               */ 07746000
*   /*****************************************************************/ 07747000
*                                                                  1767 07748000
*   CC22=LASTCC00;                  /*                       @Y30LB34*/ 07749000
         SLR   CC22,CC22                                           1767 07750000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 07751000
         LR    RTNREG2,REG14                                       1768 07752000
*                                                                  1769 07753000
*   /*****************************************************************/ 07754000
*   /*                                                               */ 07755000
*   /* CALL VRMOVDAT TO COPY THE DATA FROM THE MSS VOLUME    @Y30LB34*/ 07756000
*   /* TO THE REAL VOLUME                                    @Y30LB34*/ 07757000
*   /*                                                               */ 07758000
*   /*****************************************************************/ 07759000
*                                                                  1769 07760000
*   CALL VRMOVDAT;                  /*                       @Y30LB34*/ 07761000
         BAL   @14,VRMOVDAT                                        1769 07762000
*   RESPECIFY                                                      1770 07763000
*     RTNREG RSTD;                                                 1770 07764000
*   TESTRC=RTNREG;                                                 1771 07765000
         STH   RTNREG,TESTRC                                       1771 07766000
*   RESPECIFY                                                      1772 07767000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 07768000
*   CC22=TESTRC;                    /*                       @Y30LB34*/ 07769000
*                                                                  1773 07770000
         LH    @15,TESTRC                                          1773 07771000
         LR    CC22,@15                                            1773 07772000
*   /*****************************************************************/ 07773000
*   /*                                                               */ 07774000
*   /* IF NO SEVERE ERROR OCCURRED IN VRMOVDAT,              @Y30LB34*/ 07775000
*   /* CALL UPDVTOC TO UPDATE THE TARGET VOLUME VTOC         @Y30LB34*/ 07776000
*   /*                                                               */ 07777000
*   /*****************************************************************/ 07778000
*                                                                  1774 07779000
*   IF CC22<LASTCC12 THEN                                          1774 07780000
         C     CC22,@CF00567                                       1774 07781000
         BNL   @RF01774                                            1774 07782000
*     DO;                           /*                       @Y30LB34*/ 07783000
*       CALL UPDVTOC;               /*                       @Y30LB34*/ 07784000
         BAL   @14,UPDVTOC                                         1776 07785000
*       RESPECIFY                                                  1777 07786000
*         RTNREG RSTD;                                             1777 07787000
*       TESTRC=RTNREG;                                             1778 07788000
         STH   RTNREG,TESTRC                                       1778 07789000
*       RESPECIFY                                                  1779 07790000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 07791000
*       CC22=MAX(CC22,TESTRC);      /*                       @Y30LB34*/ 07792000
         LH    @10,TESTRC                                          1780 07793000
         CR    CC22,@10                                            1780 07794000
         BNL   *+6                                                      07795000
         LR    CC22,@10                                            1780 07796000
*     END;                          /*                       @Y30LB34*/ 07797000
*                                                                  1781 07798000
*   /*****************************************************************/ 07799000
*   /*                                                               */ 07800000
*   /* IF NO SEVERE ERROR HAS OCCURRED, CALL                 @Y30LB34*/ 07801000
*   /* RECATCTL TO CONTROL THE RECATALOGING TO BE            @Y30LB34*/ 07802000
*   /* DONE                                                  @Y30LB34*/ 07803000
*   /*                                                               */ 07804000
*   /*****************************************************************/ 07805000
*                                                                  1782 07806000
*   IF CC22<LASTCC12 THEN                                          1782 07807000
@RF01774 C     CC22,@CF00567                                       1782 07808000
         BNL   @RF01782                                            1782 07809000
*     DO;                           /*                       @Y30LB34*/ 07810000
*       CALL RECATCTL;              /*                       @Y30LB34*/ 07811000
         BAL   @14,RECATCTL                                        1784 07812000
*       RESPECIFY                                                  1785 07813000
*         RTNREG RSTD;                                             1785 07814000
*       TESTRC=RTNREG;                                             1786 07815000
         STH   RTNREG,TESTRC                                       1786 07816000
*       RESPECIFY                                                  1787 07817000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 07818000
*       CC22=MAX(CC22,TESTRC);      /*                       @Y30LB34*/ 07819000
         LH    @10,TESTRC                                          1788 07820000
         CR    CC22,@10                                            1788 07821000
         BNL   *+6                                                      07822000
         LR    CC22,@10                                            1788 07823000
*     END;                          /*                       @Y30LB34*/ 07824000
*                                                                  1790 07825000
*   /*****************************************************************/ 07826000
*   /*                                                               */ 07827000
*   /* IF NO SEVERE ERROR HAS OCCURRED AND THE NON-          @Y30LB34*/ 07828000
*   /* VSAM DATA SETS ARE TO BE RECATALOGED, CALL            @Y30LB34*/ 07829000
*   /* VOLUME SERVICES TO HANDLE IT                          @Y30LB34*/ 07830000
*   /*                                                               */ 07831000
*   /*****************************************************************/ 07832000
*                                                                  1790 07833000
*   IF CC22<LASTCC12&NONVSAM=ON THEN                               1790 07834000
@RF01782 C     CC22,@CF00567                                       1790 07835000
         BNL   @RF01790                                            1790 07836000
         TM    NONVSAM,B'00010000'                                 1790 07837000
         BNO   @RF01790                                            1790 07838000
*     DO;                           /*                       @Y30LB34*/ 07839000
*       RESPECIFY                                                  1792 07840000
*         VS1AGL BASED(ADDR(TOVS1AGL));/*                    @Y30LB34*/ 07841000
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',RECATLG,VS1AGL);/*   @YM02865*/ 07842000
         L     @10,@PC00001                                        1793 07843000
         ST    @10,@AL00001                                        1793 07844000
         LA    @02,@CC01720                                        1793 07845000
         ST    @02,@AL00001+4                                      1793 07846000
         LA    @02,RECATLG                                         1793 07847000
         ST    @02,@AL00001+8                                      1793 07848000
         LA    @02,TOVS1AGL                                        1793 07849000
         ST    @02,@AL00001+12                                     1793 07850000
         MVI   @AL00001+12,X'80'                                   1793 07851000
         L     @15,GDTCAL(,@10)                                    1793 07852000
         LA    @01,@AL00001                                        1793 07853000
         BALR  @14,@15                                             1793 07854000
*       RESPECIFY                                                  1794 07855000
*         RTNREG RSTD;                                             1794 07856000
*       TESTRC=RTNREG;                                             1795 07857000
         STH   RTNREG,TESTRC                                       1795 07858000
*       RESPECIFY                                                  1796 07859000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 07860000
*                                                                  1796 07861000
*       /*************************************************************/ 07862000
*       /*                                                           */ 07863000
*       /* IF VOLUME SERVICES WAS UNSUCCESSFUL, SET          @Y30LB34*/ 07864000
*       /* CONDITION CODE TO 8.                              @Y30LB34*/ 07865000
*       /*                                                           */ 07866000
*       /*************************************************************/ 07867000
*                                                                  1797 07868000
*       IF TESTRC>0 THEN                                           1797 07869000
         LH    @10,TESTRC                                          1797 07870000
         LTR   @10,@10                                             1797 07871000
         BNP   @RF01797                                            1797 07872000
*         CC22=LASTCC08;            /*                       @Y30LB34*/ 07873000
*                                                                  1798 07874000
         LA    CC22,8                                              1798 07875000
*       /*************************************************************/ 07876000
*       /*                                                           */ 07877000
*       /* IF VOLUME SERVICES WAS SUCCESSFUL, PRINT          @Y30LB34*/ 07878000
*       /* MESSAGE IDC0748I NOTIFYING THE NON-VSAM DATA      @Y30LB34*/ 07879000
*       /* SETS ARE RECATALOGED                              @Y30LB34*/ 07880000
*       /*                                                           */ 07881000
*       /*************************************************************/ 07882000
*                                                                  1799 07883000
*       ELSE                                                       1799 07884000
*         DO;                       /*                       @Y30LB34*/ 07885000
         B     @RC01797                                            1799 07886000
@RF01797 DS    0H                                                  1800 07887000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 07888000
         L     @10,DDSTRU                                          1800 07889000
         MVC   DARGSMOD(3,@10),@CC01557                            1800 07890000
*           DARGSENT=MSG0748I;      /*                       @Y30LB34*/ 07891000
         MVI   DARGSENT(@10),X'0C'                                 1801 07892000
*           DARGDBP=0;              /*                       @Y30LB34*/ 07893000
         SLR   @02,@02                                             1802 07894000
         ST    @02,DARGDBP(,@10)                                   1802 07895000
*           DARGILP=0;              /*                       @Y30LB34*/ 07896000
         STH   @02,DARGILP(,@10)                                   1803 07897000
*           DARGRETP=0;             /*                       @Y30LB34*/ 07898000
         ST    @02,DARGRETP(,@10)                                  1804 07899000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 07900000
         L     @10,@PC00001                                        1805 07901000
         ST    @10,@AL00001                                        1805 07902000
         LA    @02,@CF00115                                        1805 07903000
         ST    @02,@AL00001+4                                      1805 07904000
         LA    @02,DDSTRU                                          1805 07905000
         ST    @02,@AL00001+8                                      1805 07906000
         MVI   @AL00001+8,X'80'                                    1805 07907000
         L     @15,GDTPRT(,@10)                                    1805 07908000
         LA    @01,@AL00001                                        1805 07909000
         BALR  @14,@15                                             1805 07910000
*         END;                      /*                       #Y30LB34*/ 07911000
*                                                                  1806 07912000
*       /*************************************************************/ 07913000
*       /*                                                           */ 07914000
*       /* IF THE VTOC WAS OPENED BY VOLUME SERVICES         @ZM32896*/ 07915000
*       /* CLOSE IT AND SET THE IOCSTR PTR TO 0.             @ZM32896*/ 07916000
*       /*                                                           */ 07917000
*       /*************************************************************/ 07918000
*                                                                  1807 07919000
*       IF VSIOP^=NULLPTR THEN                                     1807 07920000
@RC01797 LA    @10,TOVS1AGL                                        1807 07921000
         L     @02,VSIOP(,@10)                                     1807 07922000
         LTR   @02,@02                                             1807 07923000
         BZ    @RF01807                                            1807 07924000
*         DO;                       /*                       @ZM32896*/ 07925000
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @ZM32896*/ 07926000
         L     @02,@PC00001                                        1809 07927000
         ST    @02,@AL00001                                        1809 07928000
         LA    @10,VSIOP(,@10)                                     1809 07929000
         ST    @10,@AL00001+4                                      1809 07930000
         MVI   @AL00001+4,X'80'                                    1809 07931000
         L     @15,GDTCLS(,@02)                                    1809 07932000
         LA    @01,@AL00001                                        1809 07933000
         BALR  @14,@15                                             1809 07934000
*           RESPECIFY                                              1810 07935000
*             RTNREG RSTD;                                         1810 07936000
*           TESTRC=RTNREG;                                         1811 07937000
         STH   RTNREG,TESTRC                                       1811 07938000
*           RESPECIFY                                              1812 07939000
*             RTNREG UNRSTD;        /*                       @ZM32896*/ 07940000
*           CC22=MAX(CC22,TESTRC);  /*                       @ZM32896*/ 07941000
         LH    @10,TESTRC                                          1813 07942000
         CR    CC22,@10                                            1813 07943000
         BNL   *+6                                                      07944000
         LR    CC22,@10                                            1813 07945000
*           VSIOP=NULLPTR;          /*                       @ZM32896*/ 07946000
         LA    @10,TOVS1AGL                                        1814 07947000
         SLR   @02,@02                                             1814 07948000
         ST    @02,VSIOP(,@10)                                     1814 07949000
*         END;                      /*                       @ZM32896*/ 07950000
*     END;                          /*                       #Y30LB34*/ 07951000
@RF01807 DS    0H                                                  1817 07952000
*                                                                  1817 07953000
*   /*****************************************************************/ 07954000
*   /*                                                               */ 07955000
*   /* IF A SEVERE ERROR OCCURRED DURING THIS PROCEDURE      @Y30LB34*/ 07956000
*   /* PRINT MESSAGE IDC0737I TO NOTIFY WHERE PROCESSING     @Y30LB34*/ 07957000
*   /* TERMINATED                                            @Y30LB34*/ 07958000
*   /*                                                               */ 07959000
*   /*****************************************************************/ 07960000
*                                                                  1817 07961000
*   IF(CC22=LASTCC12) THEN                                         1817 07962000
@RF01790 C     CC22,@CF00567                                       1817 07963000
         BNE   @RF01817                                            1817 07964000
*     DO;                           /*                       @Y30LB34*/ 07965000
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/ 07966000
         L     @10,DDSTRU                                          1819 07967000
         MVC   DARGSMOD(3,@10),@CC01557                            1819 07968000
*       DARGSENT=MSG0737I;          /*                       @Y30LB34*/ 07969000
         MVI   DARGSENT(@10),X'02'                                 1820 07970000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 07971000
         SLR   @02,@02                                             1821 07972000
         ST    @02,DARGDBP(,@10)                                   1821 07973000
*       DARGILP=0;                  /*                       @Y30LB34*/ 07974000
         STH   @02,DARGILP(,@10)                                   1822 07975000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 07976000
         ST    @02,DARGRETP(,@10)                                  1823 07977000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 07978000
         L     @10,@PC00001                                        1824 07979000
         ST    @10,@AL00001                                        1824 07980000
         LA    @02,@CF00115                                        1824 07981000
         ST    @02,@AL00001+4                                      1824 07982000
         LA    @02,DDSTRU                                          1824 07983000
         ST    @02,@AL00001+8                                      1824 07984000
         MVI   @AL00001+8,X'80'                                    1824 07985000
         L     @15,GDTPRT(,@10)                                    1824 07986000
         LA    @01,@AL00001                                        1824 07987000
         BALR  @14,@15                                             1824 07988000
*     END;                          /*                       @Y30LB34*/ 07989000
*                                                                  1825 07990000
*   /*****************************************************************/ 07991000
*   /*                                                               */ 07992000
*   /* IF THE TARGET VOLUME WAS RESERVED IN CHEKTARG,        @Y30LB34*/ 07993000
*   /* RELEASE THAT RESERVE AND SET OFF THE TARGET RESERVE   @Y30LB34*/ 07994000
*   /* BIT                                                   @Y30LB34*/ 07995000
*   /*                                                               */ 07996000
*   /*****************************************************************/ 07997000
*                                                                  1826 07998000
*   IF TRES=ON THEN                                                1826 07999000
@RF01817 TM    TRES,B'01000000'                                    1826 08000000
         BNO   @RF01826                                            1826 08001000
*     DO;                           /*                       @Y30LB34*/ 08002000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAMERR);/*               @Y30LB34*/ 08003000
         L     @10,@PC00001                                        1828 08004000
         ST    @10,@AL00001                                        1828 08005000
         LA    @02,@CC01594                                        1828 08006000
         ST    @02,@AL00001+4                                      1828 08007000
         LA    @02,RNAMERR                                         1828 08008000
         ST    @02,@AL00001+8                                      1828 08009000
         MVI   @AL00001+8,X'80'                                    1828 08010000
         L     @15,GDTDEQ(,@10)                                    1828 08011000
         LA    @01,@AL00001                                        1828 08012000
         BALR  @14,@15                                             1828 08013000
*       TRES=OFF;                   /*                       @Y30LB34*/ 08014000
         NI    TRES,B'10111111'                                    1829 08015000
*     END;                          /*                       @Y30LB34*/ 08016000
*                                                                  1830 08017000
*   /*****************************************************************/ 08018000
*   /*                                                               */ 08019000
*   /* RESTORE REGISTER 14 AND                               #Y30LB34*/ 08020000
*   /* RETURN TO CALLER                                      #Y30LB34*/ 08021000
*   /*                                                               */ 08022000
*   /*****************************************************************/ 08023000
*                                                                  1831 08024000
*   REG14=RTNREG2;                  /*                       #Y30LB34*/ 08025000
@RF01826 LR    REG14,RTNREG2                                       1831 08026000
*   RETURN CODE(CC22);              /*                       #Y30LB34*/ 08027000
         LR    @15,CC22                                            1832 08028000
@EL00023 DS    0H                                                  1832 08029000
@EF00023 DS    0H                                                  1832 08030000
@ER00023 BR    @14                                                 1832 08031000
*   END VRMOVE;                     /*                       #Y30LB34*/ 08032000
*                                                                  1834 08033000
*/********************************************************** @Y30LB34*/ 08034000
*/*                                                          @Y30LB34*/ 08035000
*/* PROCEDURE NAME - VRMOVDAT                                @Y30LB34*/ 08036000
*/*                                                          @Y30LB34*/ 08037000
*/* FUNCTION - MOVES THE DATA FROM VIRTUAL TO REAL           @Y30LB34*/ 08038000
*/*                                                          @Y30LB34*/ 08039000
*/*            INITIALIZES ICBCOVC PARM LIST FOR CARTRIDGE   @Y30LB34*/ 08040000
*/*            TO DASD                                       @Y30LB34*/ 08041000
*/*                                                          @Y30LB34*/ 08042000
*/*            INITIALIZES IEZCOVCE PARM LIST FOR THE MSVC   @Y30LB34*/ 08043000
*/*            EXTENSION TO ICBCOVC                          @Y30LB34*/ 08044000
*/*                                                          @Y30LB34*/ 08045000
*/*            ISSUES USSC TO ISSUE ICBCOVC TO COPY THE DATA @Y30LB34*/ 08046000
*/*                IF THE COPY COULD NOT START, ISSUES ERROR @Y30LB34*/ 08047000
*/*                MESSAGE IDC3082I,                         @Y30LB34*/ 08048000
*/*                IF THE COPY ENCOUNTERED AN ERROR AFTER IT @Y30LB34*/ 08049000
*/*                PARTIALLY COMPLETED, ISSUES ERROR MESSAGE @Y30LB34*/ 08050000
*/*                IDC3071I,                                 @Y30LB34*/ 08051000
*/*                IF THE COPY WAS SUCCESSFUL, ISSUES        @Y30LB34*/ 08052000
*/*                MESSAGE IDC0743I.                         @Y30LB34*/ 08053000
*/*                                                          @Y30LB34*/ 08054000
*/*           POSTS THE NEW TTR OF THE VTOC IN THE UCB       @Y30LB34*/ 08055000
*/*                                                          @Y30LB34*/ 08056000
*/* INPUT = ICBCOVC, IEZCOVCE, TARGAREA, SRCEAREA, PUAGL,    @Y30LB34*/ 08057000
*/*         DARGLIST, UNITABL                                @Y30LB34*/ 08058000
*/*                                                          @Y30LB34*/ 08059000
*/* OUTPUT - ICBCOVC, IEZCOVCE                               @Y30LB34*/ 08060000
*/*                                                          @Y30LB34*/ 08061000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 08062000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 08063000
*/*           R. C. = 12, UNABLE TO CONVERT VOLUME,          @Y30LB34*/ 08064000
*/*                       UNABLE TO POST REAL VOLUME UCB     @Y30LB34*/ 08065000
*/*                                                          @Y30LB34*/ 08066000
*/********************************************************** @Y30LB34*/ 08067000
*                                                                  1834 08068000
*VRMOVDAT:                                                         1834 08069000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 08070000
*                                                                  1834 08071000
VRMOVDAT DS    0H                                                  1835 08072000
*   /*****************************************************************/ 08073000
*   /*                                                               */ 08074000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 08075000
*   /*                                                               */ 08076000
*   /*****************************************************************/ 08077000
*                                                                  1835 08078000
*   DCL                                                            1835 08079000
*     CC23 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   08080000
*                                      CODE SAVE AREA        @Y30LB34*/ 08081000
*                                                                  1836 08082000
*   /*****************************************************************/ 08083000
*   /*                                                               */ 08084000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 08085000
*   /*                                                               */ 08086000
*   /*****************************************************************/ 08087000
*                                                                  1836 08088000
*   OLDERID2=NEWERID2;                                             1836 08089000
         L     @08,@PC00001                                        1836 08090000
         L     @15,GDTTR2(,@08)                                    1836 08091000
         MVC   @TS00001(95),NEWERID2(@15)                          1836 08092000
         MVC   OLDERID2(95,@15),@TS00001                           1836 08093000
*   NEWID2='CNTN';                  /*                       @Y30LB34*/ 08094000
*                                                                  1837 08095000
         MVC   NEWID2(4,@15),@CC01841                              1837 08096000
*   /*****************************************************************/ 08097000
*   /*                                                               */ 08098000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 08099000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 08100000
*   /*                                                               */ 08101000
*   /*****************************************************************/ 08102000
*                                                                  1838 08103000
*   CC23=LASTCC00;                  /*                       @Y30LB34*/ 08104000
         SLR   CC23,CC23                                           1838 08105000
*   RTNREG3=REG14;                  /*                       @Y30LB34*/ 08106000
*                                                                  1839 08107000
         ST    REG14,RTNREG3                                       1839 08108000
*   /*****************************************************************/ 08109000
*   /*                                                               */ 08110000
*   /* INITIALIZE THE ICBCOVC PARM LIST                      @Y30LB34*/ 08111000
*   /*                                                               */ 08112000
*   /*****************************************************************/ 08113000
*                                                                  1840 08114000
*   CVOCRDAS=ON;                    /*                       @Y30LB34*/ 08115000
         L     @15,CVOLPTR                                         1840 08116000
         OI    CVOCRDAS(@15),B'01000000'                           1840 08117000
*   CVOLID=SVOLSER;                 /*                       @Y30LB34*/ 08118000
         MVC   CVOLID(6,@15),SVOLSER                               1841 08119000
*   CVOLRUA=TUNITADR;               /*                       @Y30LB34*/ 08120000
         LH    @14,TUNITADR                                        1842 08121000
         STH   @14,CVOLRUA(,@15)                                   1842 08122000
*                                                                  1843 08123000
*   /*****************************************************************/ 08124000
*   /*                                                               */ 08125000
*   /* ISSUE THE USSC MACRO TO ISSUE ICBCOVC WHICH WILL      @Y30LB34*/ 08126000
*   /* COPY THE DATA FROM THE MSS VOLUME TO THE REAL         @Y30LB34*/ 08127000
*   /* VOLUME                                                @Y30LB34*/ 08128000
*   /*                                                               */ 08129000
*   /*****************************************************************/ 08130000
*                                                                  1843 08131000
*   CALL IDCSASS0(GDTTBL,COPYVOL,CVOLPTR,USSCREG0,USSCECB);/*      1843 08132000
*                                                            @Y30LB34*/ 08133000
         ST    @08,@AL00001                                        1843 08134000
         LA    @15,COPYVOL                                         1843 08135000
         ST    @15,@AL00001+4                                      1843 08136000
         LA    @15,CVOLPTR                                         1843 08137000
         ST    @15,@AL00001+8                                      1843 08138000
         LA    @15,USSCREG0                                        1843 08139000
         ST    @15,@AL00001+12                                     1843 08140000
         LA    @15,USSCECB                                         1843 08141000
         ST    @15,@AL00001+16                                     1843 08142000
         MVI   @AL00001+16,X'80'                                   1843 08143000
         L     @15,GDTSSC(,@08)                                    1843 08144000
         LA    @01,@AL00001                                        1843 08145000
         BALR  @14,@15                                             1843 08146000
*   RESPECIFY                                                      1844 08147000
*     RTNREG RSTD;                                                 1844 08148000
*   TESTRC=RTNREG;                                                 1845 08149000
         STH   RTNREG,TESTRC                                       1845 08150000
*   RESPECIFY                                                      1846 08151000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 08152000
*                                                                  1846 08153000
*   /*****************************************************************/ 08154000
*   /*                                                               */ 08155000
*   /* ANALYZE THE RETURN CODE FROM USSC                     @Y30LB34*/ 08156000
*   /*                                                       @Y30LB34*/ 08157000
*   /*                                                       @Y30LB34*/ 08158000
*   /* IF IT WAS SUCCESSFUL PRINT MESSAGE IDC0743I           @Y30LB34*/ 08159000
*   /* NOTIFYING A SUCCESSFUL COPY                           @Y30LB34*/ 08160000
*   /*                                                               */ 08161000
*   /*****************************************************************/ 08162000
*                                                                  1847 08163000
*   IF TESTRC=0 THEN                                               1847 08164000
         LH    @08,TESTRC                                          1847 08165000
         SLR   @15,@15                                             1847 08166000
         CR    @08,@15                                             1847 08167000
         BNE   @RF01847                                            1847 08168000
*     DO;                           /*                       @Y30LB34*/ 08169000
*       DARGSMOD=CONVMSG;           /*                       @Y30LB34*/ 08170000
         L     @08,DDSTRU                                          1849 08171000
         MVC   DARGSMOD(3,@08),@CC01557                            1849 08172000
*       DARGSENT=MSG0743I;          /*                       @Y30LB34*/ 08173000
         MVI   DARGSENT(@08),X'07'                                 1850 08174000
*       DARGDBP=0;                  /*                       @Y30LB34*/ 08175000
         ST    @15,DARGDBP(,@08)                                   1851 08176000
*       DARGILP=0;                  /*                       @Y30LB34*/ 08177000
         STH   @15,DARGILP(,@08)                                   1852 08178000
*       DARGRETP=0;                 /*                       @Y30LB34*/ 08179000
         ST    @15,DARGRETP(,@08)                                  1853 08180000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 08181000
         L     @08,@PC00001                                        1854 08182000
         ST    @08,@AL00001                                        1854 08183000
         LA    @15,@CF00115                                        1854 08184000
         ST    @15,@AL00001+4                                      1854 08185000
         LA    @15,DDSTRU                                          1854 08186000
         ST    @15,@AL00001+8                                      1854 08187000
         MVI   @AL00001+8,X'80'                                    1854 08188000
         L     @15,GDTPRT(,@08)                                    1854 08189000
         LA    @01,@AL00001                                        1854 08190000
         BALR  @14,@15                                             1854 08191000
*     END;                          /*                       @Y30LB34*/ 08192000
*                                                                  1855 08193000
*   /*****************************************************************/ 08194000
*   /*                                                               */ 08195000
*   /* IF IT WAS NOT SUCCESSFUL DETERMINE TYPE OF ERROR      @Y30LB34*/ 08196000
*   /*                                                               */ 08197000
*   /*****************************************************************/ 08198000
*                                                                  1856 08199000
*   ELSE                                                           1856 08200000
*     DO;                           /*                       @Y30LB34*/ 08201000
*                                                                  1856 08202000
         B     @RC01847                                            1856 08203000
@RF01847 DS    0H                                                  1857 08204000
*       /*************************************************************/ 08205000
*       /*                                                           */ 08206000
*       /* SET CONDITION CODE TO 12                          @Y30LB34*/ 08207000
*       /*                                                           */ 08208000
*       /*************************************************************/ 08209000
*                                                                  1857 08210000
*       CC23=LASTCC12;              /*                       @Y30LB34*/ 08211000
         LA    CC23,12                                             1857 08212000
*                                                                  1858 08213000
*       /*************************************************************/ 08214000
*       /*                                                           */ 08215000
*       /* IF USSC FAILED PRINT ERROR MESSAGES               @Y30LB34*/ 08216000
*       /*                                                           */ 08217000
*       /*************************************************************/ 08218000
*                                                                  1858 08219000
*       IF TESTRC=4 THEN                                           1858 08220000
         CLC   TESTRC(2),@CH00036                                  1858 08221000
         BNE   @RF01858                                            1858 08222000
*         DO;                       /*                       @Y30LB34*/ 08223000
*                                                                  1859 08224000
*           /*********************************************************/ 08225000
*           /*                                                       */ 08226000
*           /* CALL SSCMSG TO PRINT USSC ERROR MESSAGE       @Y30LB34*/ 08227000
*           /*                                                       */ 08228000
*           /*********************************************************/ 08229000
*                                                                  1860 08230000
*           CALL SSCMSG(USSCREG0,USSCECB);/*                 @Y30LB34*/ 08231000
*                                                                  1860 08232000
         LA    @08,USSCREG0                                        1860 08233000
         ST    @08,@AL00001                                        1860 08234000
         LA    @08,USSCECB                                         1860 08235000
         ST    @08,@AL00001+4                                      1860 08236000
         LA    @01,@AL00001                                        1860 08237000
         BAL   @14,SSCMSG                                          1860 08238000
*           /*********************************************************/ 08239000
*           /*                                                       */ 08240000
*           /* IF THE REASON CODE IS NOT ZERO SIGNIFYING     @Y30LB34*/ 08241000
*           /* THE COPY WAS NOT STARTED ISSUE MESSAGE        @Y30LB34*/ 08242000
*           /* IDC3082I.                                     @Y30LB34*/ 08243000
*           /*                                                       */ 08244000
*           /*********************************************************/ 08245000
*                                                                  1861 08246000
*           IF USSCREG0^=0 THEN                                    1861 08247000
         L     @08,USSCREG0                                        1861 08248000
         LTR   @08,@08                                             1861 08249000
         BZ    @RF01861                                            1861 08250000
*             DO;                   /*                       @Y30LB34*/ 08251000
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/ 08252000
         L     @08,DDSTRU                                          1863 08253000
         MVC   DARGSMOD(3,@08),@CC01555                            1863 08254000
*               DARGSENT=MSG3082I;  /*                       @Y30LB34*/ 08255000
         MVI   DARGSENT(@08),X'18'                                 1864 08256000
*             END;                  /*                       @Y30LB34*/ 08257000
*                                                                  1865 08258000
*           /*********************************************************/ 08259000
*           /*                                                       */ 08260000
*           /* IF THE REASON CODE IS ZERO SIGNIFYING THE     @Y30LB34*/ 08261000
*           /* COPY WAS STARTED BUT DID NOT COMPLETE,        @Y30LB34*/ 08262000
*           /* ISSUE ERROR MESSAGE IDC3071I.                 @Y30LB34*/ 08263000
*           /*                                                       */ 08264000
*           /*********************************************************/ 08265000
*                                                                  1866 08266000
*           ELSE                                                   1866 08267000
*             DO;                   /*                       @Y30LB34*/ 08268000
         B     @RC01861                                            1866 08269000
@RF01861 DS    0H                                                  1867 08270000
*               DARGSMOD=COMMSG;    /*                       @Y30LB34*/ 08271000
         L     @08,DDSTRU                                          1867 08272000
         MVC   DARGSMOD(3,@08),@CC01555                            1867 08273000
*               DARGSENT=MSG3071I;  /*                       @Y30LB34*/ 08274000
         MVI   DARGSENT(@08),X'23'                                 1868 08275000
*             END;                  /*                       @Y30LB34*/ 08276000
*           DARGDBP=0;              /*                       @Y30LB34*/ 08277000
@RC01861 SLR   @08,@08                                             1870 08278000
         L     @15,DDSTRU                                          1870 08279000
         ST    @08,DARGDBP(,@15)                                   1870 08280000
*           DARGILP=0;              /*                       @Y30LB34*/ 08281000
         STH   @08,DARGILP(,@15)                                   1871 08282000
*           DARGRETP=0;             /*                       @Y30LB34*/ 08283000
         ST    @08,DARGRETP(,@15)                                  1872 08284000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 08285000
         L     @08,@PC00001                                        1873 08286000
         ST    @08,@AL00001                                        1873 08287000
         LA    @15,@CF00115                                        1873 08288000
         ST    @15,@AL00001+4                                      1873 08289000
         LA    @15,DDSTRU                                          1873 08290000
         ST    @15,@AL00001+8                                      1873 08291000
         MVI   @AL00001+8,X'80'                                    1873 08292000
         L     @15,GDTPRT(,@08)                                    1873 08293000
         LA    @01,@AL00001                                        1873 08294000
         BALR  @14,@15                                             1873 08295000
*         END;                      /*                       @Y30LB34*/ 08296000
*     END;                          /*                       @Y30LB34*/ 08297000
@RF01858 DS    0H                                                  1876 08298000
*                                                                  1876 08299000
*   /*****************************************************************/ 08300000
*   /*                                                               */ 08301000
*   /* IF NO SEVERE ERROR HAS OCCURRED COPYING THE VOLUME,   @Y30LB34*/ 08302000
*   /* PREPARE TARGET VOLUME FOR VTOC UPDATING               @Y30LB34*/ 08303000
*   /*                                                               */ 08304000
*   /*****************************************************************/ 08305000
*                                                                  1876 08306000
*   IF CC23<LASTCC12 THEN                                          1876 08307000
@RC01847 C     CC23,@CF00567                                       1876 08308000
         BNL   @RF01876                                            1876 08309000
*     DO;                           /*                       @Y30LB34*/ 08310000
*                                                                  1877 08311000
*       /*************************************************************/ 08312000
*       /*                                                           */ 08313000
*       /* SINCE THE TARGET VOLUME VTOC MAY HAVE BEEN        @Y30LB34*/ 08314000
*       /* RELOCATED, POST THE UCB WITH THE SOURCE VTOC TTR  @Y30LB34*/ 08315000
*       /* THAT WAS RETRIEVED AND SAVED IN VRGETSO           @Y30LB34*/ 08316000
*       /*                                                           */ 08317000
*       /*************************************************************/ 08318000
*                                                                  1878 08319000
*       PUUCBPTR=ADDR(TUCBADDR);    /*                       @YM02880*/ 08320000
         LA    @08,PUAGLAR                                         1878 08321000
         LA    @15,TUCBADDR                                        1878 08322000
         ST    @15,PUUCBPTR(,@08)                                  1878 08323000
*       PUTTRPTR=ADDR(SVTOCTTR);    /*                       @Y30LB34*/ 08324000
         LA    @15,SVTOCTTR                                        1879 08325000
         ST    @15,PUTTRPTR(,@08)                                  1879 08326000
*       PULABELP=ADDR(TLABEL);      /*                       @Y30LB34*/ 08327000
         LA    @15,TLABEL                                          1880 08328000
         ST    @15,PULABELP(,@08)                                  1880 08329000
*       CALL IDCSA060(GDTTBL,POSTUCB,PUAGL);/*               @Y30LB34*/ 08330000
         L     @15,@PC00001                                        1881 08331000
         ST    @15,@AL00001                                        1881 08332000
         LA    @14,POSTUCB                                         1881 08333000
         ST    @14,@AL00001+4                                      1881 08334000
         ST    @08,@AL00001+8                                      1881 08335000
         MVI   @AL00001+8,X'80'                                    1881 08336000
         L     @15,GDTUNT(,@15)                                    1881 08337000
         LA    @01,@AL00001                                        1881 08338000
         BALR  @14,@15                                             1881 08339000
*       RESPECIFY                                                  1882 08340000
*         RTNREG RSTD;                                             1882 08341000
*       TESTRC=RTNREG;                                             1883 08342000
         STH   RTNREG,TESTRC                                       1883 08343000
*       RESPECIFY                                                  1884 08344000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 08345000
*                                                                  1884 08346000
*       /*************************************************************/ 08347000
*       /*                                                           */ 08348000
*       /* IF THE POST IS UNSUCCESSFUL, SET THE CONDITION    @Y30LB34*/ 08349000
*       /* CODE TO 12                                        @Y30LB34*/ 08350000
*       /*                                                           */ 08351000
*       /*************************************************************/ 08352000
*                                                                  1885 08353000
*       IF TESTRC>0 THEN                                           1885 08354000
         LH    @08,TESTRC                                          1885 08355000
         LTR   @08,@08                                             1885 08356000
         BNP   @RF01885                                            1885 08357000
*         CC23=LASTCC12;            /*                       @Y30LB34*/ 08358000
         LA    CC23,12                                             1886 08359000
*     END;                          /*                       @Y30LB34*/ 08360000
*                                                                  1887 08361000
@RF01885 DS    0H                                                  1888 08362000
*   /*****************************************************************/ 08363000
*   /*                                                               */ 08364000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 08365000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 08366000
*   /*                                                               */ 08367000
*   /*****************************************************************/ 08368000
*                                                                  1888 08369000
*   REG14=RTNREG3;                  /*                       @Y30LB34*/ 08370000
@RF01876 L     REG14,RTNREG3                                       1888 08371000
*   RETURN CODE(CC23);              /*                       @Y30LB34*/ 08372000
         LR    @15,CC23                                            1889 08373000
@EL00024 DS    0H                                                  1889 08374000
@EF00024 DS    0H                                                  1889 08375000
@ER00024 BR    @14                                                 1889 08376000
*   END VRMOVDAT;                   /*                       @Y30LB34*/ 08377000
*                                                                  1891 08378000
*/********************************************************** @Y30LB34*/ 08379000
*/*                                                          @Y30LB34*/ 08380000
*/* PROCEDURE NAME - VRSCRV                                  @Y30LB34*/ 08381000
*/*                                                          @Y30LB34*/ 08382000
*/* FUNCTION - MOUNTS THE SOURCE VOLUME IF THE SOURCE AND    @Y30LB34*/ 08383000
*/*            TARGET SERIAL NUMBERS ARE THE SAME            @Y30LB34*/ 08384000
*/*                                                          @Y30LB34*/ 08385000
*/*            CALLS VOLUME SERVICES TO SCRATCH THE VTOC ON  @Y30LB34*/ 08386000
*/*            THEN SOURCE VOLUME                            @Y30LB34*/ 08387000
*/*                                                          @Y30LB34*/ 08388000
*/*            CLOSES THE VTOC                               @Y30LB34*/ 08389000
*/*                                                          @Y30LB34*/ 08390000
*/*            PRINTS MESSAGE IDC0749I IF THE VTOC IS        @Y30LB34*/ 08391000
*/*            SCRATCHED                                     @Y30LB34*/ 08392000
*/*                                                          @Y30LB34*/ 08393000
*/*            DEQUEUES THE SOURCE VOLUME RESERVE            @Y30LB34*/ 08394000
*/*                                                          @Y30LB34*/ 08395000
*/*            DEMOUNTS THE SOURCE VOLUME IF THE SOURCE AND  @Y30LB34*/ 08396000
*/*            TARGET SERIAL NUMBERS ARE THE SAME            @Y30LB34*/ 08397000
*/*                                                          @Y30LB34*/ 08398000
*/* INPUT - FRVS1AGL, DARGLIST, MDAGL, PUAGL                 @Y30LB34*/ 08399000
*/*                                                          @Y30LB34*/ 08400000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 08401000
*/*           R. C. =  0, SUCCESSFUL COMPLETION              @Y30LB34*/ 08402000
*/*           R. C. =  4, UNABLE TO CLOSE VTOC               @Y30LB34*/ 08403000
*/*           R. C. =  8, UNABLE TO SCRATCH VTOC,            @Y30LB34*/ 08404000
*/*                       UNABLE TO MOUNT VOLUME,            @Y30LB34*/ 08405000
*/*                       UNABLE TO DEMOUNT VOLUME           @Y30LB34*/ 08406000
*/*                                                          @Y30LB34*/ 08407000
*/********************************************************** @Y30LB34*/ 08408000
*                                                                  1891 08409000
*VRSCRV:                                                           1891 08410000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB34*/ 08411000
*                                                                  1891 08412000
VRSCRV   DS    0H                                                  1892 08413000
*   /*****************************************************************/ 08414000
*   /*                                                               */ 08415000
*   /* LOCAL DECLARATIONS                                    @Y30LB34*/ 08416000
*   /*                                                               */ 08417000
*   /*****************************************************************/ 08418000
*                                                                  1892 08419000
*   DCL                                                            1892 08420000
*     CC24 FIXED(15);               /* INTERNAL CONDITION    @Y30LB34   08421000
*                                      CODE SAVE AREA        @Y30LB34*/ 08422000
*                                                                  1893 08423000
*   /*****************************************************************/ 08424000
*   /*                                                               */ 08425000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 08426000
*   /*                                                               */ 08427000
*   /*****************************************************************/ 08428000
*                                                                  1893 08429000
*   OLDERID2=NEWERID2;                                             1893 08430000
         L     @08,@PC00001                                        1893 08431000
         L     @02,GDTTR2(,@08)                                    1893 08432000
         MVC   @TS00001(95),NEWERID2(@02)                          1893 08433000
         MVC   OLDERID2(95,@02),@TS00001                           1893 08434000
*   NEWID2='CNTO';                  /*                       @Y30LB34*/ 08435000
*                                                                  1894 08436000
         MVC   NEWID2(4,@02),@CC01846                              1894 08437000
*   /*****************************************************************/ 08438000
*   /*                                                               */ 08439000
*   /* INITIALIZE THE INTERNAL CONDITION CODE TO ZERO        @Y30LB34*/ 08440000
*   /* AND SAVE REGISTER 14                                  @Y30LB34*/ 08441000
*   /*                                                               */ 08442000
*   /*****************************************************************/ 08443000
*                                                                  1895 08444000
*   CC24=LASTCC00;                  /*                       @Y30LB34*/ 08445000
         SLR   CC24,CC24                                           1895 08446000
*   RTNREG2=REG14;                  /*                       @Y30LB34*/ 08447000
*                                                                  1896 08448000
         LR    RTNREG2,REG14                                       1896 08449000
*   /*****************************************************************/ 08450000
*   /*                                                               */ 08451000
*   /* ISSUE UMSSUNIT TO MOUNT THE MSS SOURCE VOLUME         @Y30LB34*/ 08452000
*   /* IF THE VOLSERS ARE THE SAME. SET THE BIT ON TO        @Y30LB34*/ 08453000
*   /* CLEAR THE TARGET UCB BEFORE MOUNT                     @Y30LB34*/ 08454000
*   /*                                                               */ 08455000
*   /*****************************************************************/ 08456000
*                                                                  1897 08457000
*   IF SAMESER=ON THEN                                             1897 08458000
         TM    SAMESER,B'10000000'                                 1897 08459000
         BNO   @RF01897                                            1897 08460000
*     DO;                           /*                       @Y30LB34*/ 08461000
*       MDCLEAR=ON;                 /*                       @Y30LB34*/ 08462000
         LA    @02,MDAGLAR                                         1899 08463000
         OI    MDCLEAR(@02),B'01000000'                            1899 08464000
*       CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                 @Y30LB34*/ 08465000
         ST    @08,@AL00001                                        1900 08466000
         LA    @15,MOUNT                                           1900 08467000
         ST    @15,@AL00001+4                                      1900 08468000
         ST    @02,@AL00001+8                                      1900 08469000
         MVI   @AL00001+8,X'80'                                    1900 08470000
         L     @15,GDTUNT(,@08)                                    1900 08471000
         LA    @01,@AL00001                                        1900 08472000
         BALR  @14,@15                                             1900 08473000
*       RESPECIFY                                                  1901 08474000
*         RTNREG RSTD;                                             1901 08475000
*       TESTRC=RTNREG;                                             1902 08476000
         STH   RTNREG,TESTRC                                       1902 08477000
*       RESPECIFY                                                  1903 08478000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 08479000
*       MDCLEAR=OFF;                /*                       @Y30LB34*/ 08480000
*                                                                  1904 08481000
         LA    @08,MDAGLAR                                         1904 08482000
         NI    MDCLEAR(@08),B'10111111'                            1904 08483000
*       /*************************************************************/ 08484000
*       /*                                                           */ 08485000
*       /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE CONDITION  @Y30LB34*/ 08486000
*       /* CODE TO 8                                         @Y30LB34*/ 08487000
*       /*                                                           */ 08488000
*       /*************************************************************/ 08489000
*                                                                  1905 08490000
*       IF TESTRC>0 THEN                                           1905 08491000
         LH    @08,TESTRC                                          1905 08492000
         LTR   @08,@08                                             1905 08493000
         BNP   @RF01905                                            1905 08494000
*         CC24=LASTCC08;            /*                       @Y30LB34*/ 08495000
         LA    CC24,8                                              1906 08496000
*     END;                          /*                       @Y30LB34*/ 08497000
@RF01905 DS    0H                                                  1908 08498000
*                                                                  1908 08499000
*   /*****************************************************************/ 08500000
*   /*                                                               */ 08501000
*   /* IF NO SEVERE ERROR OCCURRED MOUNTING THE VOLUME       @Y30LB34*/ 08502000
*   /* PROCEED WITH COMPLETION PROCESSING OF THE SOURCE      @Y30LB34*/ 08503000
*   /* VOLUME                                                @Y30LB34*/ 08504000
*   /*                                                               */ 08505000
*   /*****************************************************************/ 08506000
*                                                                  1908 08507000
*   IF CC24<LASTCC08 THEN                                          1908 08508000
@RF01897 C     CC24,@CF00177                                       1908 08509000
         BNL   @RF01908                                            1908 08510000
*     DO;                           /*                       @Y30LB34*/ 08511000
*                                                                  1909 08512000
*       /*************************************************************/ 08513000
*       /*                                                           */ 08514000
*       /* CALL VOLUME SERVICES TO SCRATCH THE SOURCE VOLUME @Y30LB34*/ 08515000
*       /* VTOC                                              @Y30LB34*/ 08516000
*       /*                                                           */ 08517000
*       /*************************************************************/ 08518000
*                                                                  1910 08519000
*       RESPECIFY                                                  1910 08520000
*         VS1AGL BASED(ADDR(FRVS1AGL));/*                    @Y30LB34*/ 08521000
*                                                                  1910 08522000
*       /*************************************************************/ 08523000
*       /*                                                           */ 08524000
*       /* IF THE REQUEST IS VIRTUAL TO REAL, RESERVE TO VOLUME.     */ 08525000
*       /*                                                   @ZA08840*/ 08526000
*       /*                                                           */ 08527000
*       /*************************************************************/ 08528000
*                                                                  1911 08529000
*       IF CONVTYPE=VR THEN         /*                       @ZA08840*/ 08530000
         TM    CONVTYPE,B'01000000'                                1911 08531000
         BNZ   @RF01911                                            1911 08532000
*         VSRES=ON;                 /*                       @Y30LB34*/ 08533000
         LA    @08,FRVS1AGL                                        1912 08534000
         OI    VSRES(@08),B'10000000'                              1912 08535000
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',SCRVTOC,VS1AGL);/*   @Y30LB34*/ 08536000
@RF01911 L     @08,@PC00001                                        1913 08537000
         ST    @08,@AL00001                                        1913 08538000
         LA    @02,@CC01720                                        1913 08539000
         ST    @02,@AL00001+4                                      1913 08540000
         LA    @02,SCRVTOC                                         1913 08541000
         ST    @02,@AL00001+8                                      1913 08542000
         LA    @02,FRVS1AGL                                        1913 08543000
         ST    @02,@AL00001+12                                     1913 08544000
         MVI   @AL00001+12,X'80'                                   1913 08545000
         L     @15,GDTCAL(,@08)                                    1913 08546000
         LA    @01,@AL00001                                        1913 08547000
         BALR  @14,@15                                             1913 08548000
*       RESPECIFY                                                  1914 08549000
*         RTNREG RSTD;                                             1914 08550000
*       TESTRC=RTNREG;                                             1915 08551000
         STH   RTNREG,TESTRC                                       1915 08552000
*       RESPECIFY                                                  1916 08553000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 08554000
*       VSRES=OFF;                  /*                       @Y30LB34*/ 08555000
*                                                                  1917 08556000
         LA    @08,FRVS1AGL                                        1917 08557000
         NI    VSRES(@08),B'01111111'                              1917 08558000
*       /*************************************************************/ 08559000
*       /*                                                           */ 08560000
*       /* IF VOLUME SERVICES WAS UNABLE TO SCRATCH THE VTOC @Y30LB34*/ 08561000
*       /* SET CONDITION CODE TO 8                           @Y30LB34*/ 08562000
*       /*                                                           */ 08563000
*       /*************************************************************/ 08564000
*                                                                  1918 08565000
*       IF TESTRC>0 THEN                                           1918 08566000
         LH    @08,TESTRC                                          1918 08567000
         LTR   @08,@08                                             1918 08568000
         BNP   @RF01918                                            1918 08569000
*         CC24=LASTCC08;            /*                       @Y30LB34*/ 08570000
         LA    CC24,8                                              1919 08571000
*                                                                  1920 08572000
*       /*************************************************************/ 08573000
*       /*                                                           */ 08574000
*       /* IF VOLUME SERVICES OPENED THE VTOC, CLOSE IT      @Y30LB34*/ 08575000
*       /* AND SET THE IOCSTR POINTER TO 0                   @Y30LB34*/ 08576000
*       /*                                                           */ 08577000
*       /*************************************************************/ 08578000
*                                                                  1920 08579000
*       IF VSIOP^=NULLPTR THEN                                     1920 08580000
@RF01918 LA    @08,FRVS1AGL                                        1920 08581000
         L     @02,VSIOP(,@08)                                     1920 08582000
         LTR   @02,@02                                             1920 08583000
         BZ    @RF01920                                            1920 08584000
*         DO;                       /*                       @Y30LB34*/ 08585000
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB34*/ 08586000
         L     @02,@PC00001                                        1922 08587000
         ST    @02,@AL00001                                        1922 08588000
         LA    @08,VSIOP(,@08)                                     1922 08589000
         ST    @08,@AL00001+4                                      1922 08590000
         MVI   @AL00001+4,X'80'                                    1922 08591000
         L     @15,GDTCLS(,@02)                                    1922 08592000
         LA    @01,@AL00001                                        1922 08593000
         BALR  @14,@15                                             1922 08594000
*           RESPECIFY                                              1923 08595000
*             RTNREG RSTD;                                         1923 08596000
*           TESTRC=RTNREG;                                         1924 08597000
         STH   RTNREG,TESTRC                                       1924 08598000
*           RESPECIFY                                              1925 08599000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 08600000
*           CC24=MAX(CC24,TESTRC);  /*                       @Y30LB34*/ 08601000
         LH    @08,TESTRC                                          1926 08602000
         CR    CC24,@08                                            1926 08603000
         BNL   *+6                                                      08604000
         LR    CC24,@08                                            1926 08605000
*           VSIOP=NULLPTR;          /*                       @Y30LB34*/ 08606000
         LA    @08,FRVS1AGL                                        1927 08607000
         SLR   @02,@02                                             1927 08608000
         ST    @02,VSIOP(,@08)                                     1927 08609000
*         END;                      /*                       @Y30LB34*/ 08610000
*                                                                  1928 08611000
*       /*************************************************************/ 08612000
*       /*                                                           */ 08613000
*       /* IF THE VTOC WAS SCRATCHED, PRINT MESSAGE IDC0749I @Y30LB34*/ 08614000
*       /* NOTIFYING THE USER                                @Y30LB34*/ 08615000
*       /*                                                           */ 08616000
*       /*************************************************************/ 08617000
*                                                                  1929 08618000
*       IF CC24<LASTCC08 THEN                                      1929 08619000
@RF01920 C     CC24,@CF00177                                       1929 08620000
         BNL   @RF01929                                            1929 08621000
*         DO;                       /*                       @Y30LB34*/ 08622000
*           DARGSMOD=CONVMSG;       /*                       @Y30LB34*/ 08623000
         L     @08,DDSTRU                                          1931 08624000
         MVC   DARGSMOD(3,@08),@CC01557                            1931 08625000
*           DARGSENT=MSG0749I;      /*                       @Y30LB34*/ 08626000
         MVI   DARGSENT(@08),X'0D'                                 1932 08627000
*           DARGDBP=0;              /*                       @Y30LB34*/ 08628000
         SLR   @02,@02                                             1933 08629000
         ST    @02,DARGDBP(,@08)                                   1933 08630000
*           DARGILP=0;              /*                       @Y30LB34*/ 08631000
         STH   @02,DARGILP(,@08)                                   1934 08632000
*           DARGRETP=0;             /*                       @Y30LB34*/ 08633000
         ST    @02,DARGRETP(,@08)                                  1935 08634000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 08635000
         L     @08,@PC00001                                        1936 08636000
         ST    @08,@AL00001                                        1936 08637000
         LA    @02,@CF00115                                        1936 08638000
         ST    @02,@AL00001+4                                      1936 08639000
         LA    @02,DDSTRU                                          1936 08640000
         ST    @02,@AL00001+8                                      1936 08641000
         MVI   @AL00001+8,X'80'                                    1936 08642000
         L     @15,GDTPRT(,@08)                                    1936 08643000
         LA    @01,@AL00001                                        1936 08644000
         BALR  @14,@15                                             1936 08645000
*         END;                      /*                       @Y30LB34*/ 08646000
*                                                                  1937 08647000
*       /*************************************************************/ 08648000
*       /*                                                           */ 08649000
*       /* IF THE SOURCE VOLUME WAS RESERVED ABOVE, RELEASE  @Y30LB34*/ 08650000
*       /* THAT RESERVE AND SET OFF THE SOURCE RESERVE BIT   @Y30LB34*/ 08651000
*       /*                                                           */ 08652000
*       /*************************************************************/ 08653000
*                                                                  1938 08654000
*       IF SRES=ON THEN                                            1938 08655000
@RF01929 TM    SRES,B'01000000'                                    1938 08656000
         BNO   @RF01938                                            1938 08657000
*         DO;                       /*                       @Y30LB34*/ 08658000
*           CALL IDCSADQ0(GDTTBL,QNAME,RNAMEVR);/*           @Y30LB34*/ 08659000
         L     @08,@PC00001                                        1940 08660000
         ST    @08,@AL00001                                        1940 08661000
         LA    @02,@CC01594                                        1940 08662000
         ST    @02,@AL00001+4                                      1940 08663000
         LA    @02,RNAMEVR                                         1940 08664000
         ST    @02,@AL00001+8                                      1940 08665000
         MVI   @AL00001+8,X'80'                                    1940 08666000
         L     @15,GDTDEQ(,@08)                                    1940 08667000
         LA    @01,@AL00001                                        1940 08668000
         BALR  @14,@15                                             1940 08669000
*           SRES=OFF;               /*                       @Y30LB34*/ 08670000
         NI    SRES,B'10111111'                                    1941 08671000
*         END;                      /*                       @Y30LB34*/ 08672000
*                                                                  1943 08673000
*       /*************************************************************/ 08674000
*       /*                                                           */ 08675000
*       /* DEMOUNT THE SOURCE VOLUME IF SOURCE AND TARGET    @ZM34313*/ 08676000
*       /* VOLSERS ARE THE SAME. SET THE BIT ON TO POST THE  @Y30LB34*/ 08677000
*       /* TARGET UCB AFTER DEMOUNT. (DELAYED RESPONSE)      @ZM34313*/ 08678000
*       /*                                                           */ 08679000
*       /*************************************************************/ 08680000
*                                                                  1943 08681000
*       IF SAMESER=ON THEN                                         1943 08682000
@RF01938 TM    SAMESER,B'10000000'                                 1943 08683000
         BNO   @RF01943                                            1943 08684000
*         DO;                       /*                       @Y30LB34*/ 08685000
*           MDPOST=ON;              /*                       @Y30LB34*/ 08686000
*           MDWAIT=ON;              /*                       @ZM34313*/ 08687000
         LA    @08,MDAGLAR                                         1946 08688000
         OI    MDPOST(@08),B'00110000'                             1946 08689000
*           CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*           @Y30LB34*/ 08690000
         L     @02,@PC00001                                        1947 08691000
         ST    @02,@AL00001                                        1947 08692000
         LA    @15,DEMOUNT                                         1947 08693000
         ST    @15,@AL00001+4                                      1947 08694000
         ST    @08,@AL00001+8                                      1947 08695000
         MVI   @AL00001+8,X'80'                                    1947 08696000
         L     @15,GDTUNT(,@02)                                    1947 08697000
         LA    @01,@AL00001                                        1947 08698000
         BALR  @14,@15                                             1947 08699000
*           RESPECIFY                                              1948 08700000
*             RTNREG RSTD;                                         1948 08701000
*           TESTRC=RTNREG;                                         1949 08702000
         STH   RTNREG,TESTRC                                       1949 08703000
*           RESPECIFY                                              1950 08704000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 08705000
*           MDPOST=OFF;             /*                       @Y30LB34*/ 08706000
*                                                                  1951 08707000
         LA    @08,MDAGLAR                                         1951 08708000
         NI    MDPOST(@08),B'11011111'                             1951 08709000
*           /*********************************************************/ 08710000
*           /*                                                       */ 08711000
*           /* IF UMSSUNIT IS NOT SUCCESSFUL, SET THE        @Y30LB34*/ 08712000
*           /* CONDITION CODE TO 8                           @Y30LB34*/ 08713000
*           /*                                                       */ 08714000
*           /*********************************************************/ 08715000
*                                                                  1952 08716000
*           IF TESTRC>0 THEN                                       1952 08717000
         LH    @08,TESTRC                                          1952 08718000
         LTR   @08,@08                                             1952 08719000
         BNP   @RF01952                                            1952 08720000
*             CC24=LASTCC08;        /*                       @Y30LB34*/ 08721000
         LA    CC24,8                                              1953 08722000
*         END;                      /*                       @Y30LB34*/ 08723000
@RF01952 DS    0H                                                  1955 08724000
*     END;                          /*                       @Y30LB34*/ 08725000
*                                                                  1955 08726000
@RF01943 DS    0H                                                  1956 08727000
*   /*****************************************************************/ 08728000
*   /*                                                               */ 08729000
*   /* RESTORE REGISTER 14 AND                               @Y30LB34*/ 08730000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 08731000
*   /*                                                               */ 08732000
*   /*****************************************************************/ 08733000
*                                                                  1956 08734000
*   REG14=RTNREG2;                  /*                       @Y30LB34*/ 08735000
@RF01908 LR    REG14,RTNREG2                                       1956 08736000
*   RETURN CODE(CC24);              /*                       @Y30LB34*/ 08737000
         LR    @15,CC24                                            1957 08738000
@EL00025 DS    0H                                                  1957 08739000
@EF00025 DS    0H                                                  1957 08740000
@ER00025 BR    @14                                                 1957 08741000
*   END VRSCRV;                     /*                       @Y30LB34*/ 08742000
*                                                                  1959 08743000
*/***********************************************************@Y30LB39*/ 08744000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 08745000
*/*                                                          @Y30LB39*/ 08746000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 08747000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 08748000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 08749000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 08750000
*/*                                                          @Y30LB39*/ 08751000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 08752000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 08753000
*/*   IN SSECBCD.                                            @Y30LB39*/ 08754000
*/*                                                          @Y30LB39*/ 08755000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 08756000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 08757000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 08758000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 08759000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 08760000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 08761000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 08762000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 08763000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 08764000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 08765000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 08766000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 08767000
*/*                                                          @Y30LB39*/ 08768000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 08769000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 08770000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 08771000
*/*                                                          @Y30LB39*/ 08772000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 08773000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 08774000
*/*                                                          @Y30LB39*/ 08775000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 08776000
*/*                                                          @Y30LB39*/ 08777000
*/***********************************************************@Y30LB39*/ 08778000
*                                                                  1959 08779000
*                                   /*                       @Y30LB39*/ 08780000
*SSCMSG:                                                           1959 08781000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 08782000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   08783000
*                                                            @Y30LB39*/ 08784000
SSCMSG   STM   @14,@12,@SA00026                                    1959 08785000
         MVC   @PC00026(8),0(@01)                                  1959 08786000
*                                   /*                       @Y30LB39*/ 08787000
*                                                                  1960 08788000
*   /*****************************************************************/ 08789000
*   /*                                                               */ 08790000
*   /*                                                       @Y30LB39*/ 08791000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 08792000
*   /*                                                       @Y30LB39*/ 08793000
*   /*                                                               */ 08794000
*   /*****************************************************************/ 08795000
*                                                                  1960 08796000
*                                   /*                       @Y30LB39   08797000
*                                                            @Y30LB39*/ 08798000
*                                                                  1960 08799000
*   /*****************************************************************/ 08800000
*   /*                                                               */ 08801000
*   /*                                                       @Y30LB39*/ 08802000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 08803000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 08804000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 08805000
*   /*                                                       @Y30LB39*/ 08806000
*   /*                                                               */ 08807000
*   /*****************************************************************/ 08808000
*                                                                  1960 08809000
*                                   /*                       @Y30LB39*/ 08810000
*   DCL                                                            1960 08811000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 08812000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 08813000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 08814000
*   DCL                                                            1961 08815000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   08816000
*                                                            @Y30LB39   08817000
*                                                            @Y30LB39*/ 08818000
*                                                                  1961 08819000
*   /*****************************************************************/ 08820000
*   /*                                                               */ 08821000
*   /*                                                       @Y30LB39*/ 08822000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 08823000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 08824000
*   /*                                                       @Y30LB39*/ 08825000
*   /*                                                               */ 08826000
*   /*****************************************************************/ 08827000
*                                                                  1962 08828000
*                                   /*                       @Y30LB39*/ 08829000
*   DCL                                                            1962 08830000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 08831000
*   DCL                                                            1963 08832000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   08833000
*                                                            @Y30LB39*/ 08834000
*                                                                  1963 08835000
*   /*****************************************************************/ 08836000
*   /*                                                               */ 08837000
*   /*                                                       @Y30LB39*/ 08838000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 08839000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 08840000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 08841000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 08842000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 08843000
*   /*                                                       @Y30LB39*/ 08844000
*   /*                                                               */ 08845000
*   /*****************************************************************/ 08846000
*                                                                  1964 08847000
*                                   /*                       @Y30LB39*/ 08848000
*   DECLARE                                                        1964 08849000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   08850000
*                                                            @Y30LB39*/ 08851000
*                                                                  1964 08852000
*   /*****************************************************************/ 08853000
*   /*                                                               */ 08854000
*   /*                                                       @Y30LB39*/ 08855000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 08856000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 08857000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 08858000
*   /* IDCTSCM0.                                             @Y30LB39*/ 08859000
*   /*                                                       @Y30LB39*/ 08860000
*   /*                                                               */ 08861000
*   /*****************************************************************/ 08862000
*                                                                  1965 08863000
*                                   /*                       @Y30LB39*/ 08864000
*   DECLARE                                                        1965 08865000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   08866000
*                                                            @Y30LB39*/ 08867000
*                                                                  1965 08868000
*   /*****************************************************************/ 08869000
*   /*                                                               */ 08870000
*   /*                                                       @Y30LB39*/ 08871000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 08872000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 08873000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 08874000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 08875000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 08876000
*   /*                                                       @Y30LB39*/ 08877000
*   /*                                                               */ 08878000
*   /*****************************************************************/ 08879000
*                                                                  1966 08880000
*                                   /*                       @Y30LB39*/ 08881000
*   DECLARE                                                        1966 08882000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 08883000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   08884000
*                                                            @Y30LB39*/ 08885000
*                                                                  1966 08886000
*   /*****************************************************************/ 08887000
*   /*                                                               */ 08888000
*   /*                                                       @Y30LB39*/ 08889000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 08890000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 08891000
*   /*                                                       @Y30LB39*/ 08892000
*   /*                                                               */ 08893000
*   /*****************************************************************/ 08894000
*                                                                  1967 08895000
*                                   /*                       @Y30LB39*/ 08896000
*   DECLARE                                                        1967 08897000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   08898000
*                                                            @Y30LB39*/ 08899000
*                                                                  1967 08900000
*   /*****************************************************************/ 08901000
*   /*                                                               */ 08902000
*   /*                                                       @Y30LB39*/ 08903000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 08904000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 08905000
*   /*                                                       @Y30LB39*/ 08906000
*   /*                                                               */ 08907000
*   /*****************************************************************/ 08908000
*                                                                  1968 08909000
*                                   /*                       @Y30LB39*/ 08910000
*   DECLARE                                                        1968 08911000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   08912000
*                                                            @Y30LB39*/ 08913000
*                                   /*                       @Y30LB39*/ 08914000
*                                                                  1969 08915000
*   /*****************************************************************/ 08916000
*   /*                                                               */ 08917000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 08918000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 08919000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 08920000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 08921000
*   /*                                                       @Y30LB39*/ 08922000
*   /*                                                               */ 08923000
*   /*****************************************************************/ 08924000
*                                                                  1969 08925000
*                                   /*                       @Y30LB39*/ 08926000
*   OLDERID2=NEWERID2;                                             1969 08927000
         L     @07,@PC00001                                        1969 08928000
         L     @02,GDTTR2(,@07)                                    1969 08929000
         MVC   @TS00001(95),NEWERID2(@02)                          1969 08930000
         MVC   OLDERID2(95,@02),@TS00001                           1969 08931000
*   NEWID2='SSAA';                  /*                       @Y30LB39   08932000
*                                                            @Y30LB39*/ 08933000
*                                                                  1970 08934000
         MVC   NEWID2(4,@02),@CC01869                              1970 08935000
*   /*****************************************************************/ 08936000
*   /*                                                               */ 08937000
*   /*                                                       @Y30LB39*/ 08938000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 08939000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 08940000
*   /*                                                       @Y30LB39*/ 08941000
*   /*                                                               */ 08942000
*   /*****************************************************************/ 08943000
*                                                                  1971 08944000
*                                   /*                       @Y30LB39*/ 08945000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   08946000
*                                                            @Y30LB39*/ 08947000
*                                                                  1971 08948000
         LA    @02,SSDRGLT                                         1971 08949000
         ST    @02,SSDLPTR                                         1971 08950000
*   /*****************************************************************/ 08951000
*   /*                                                               */ 08952000
*   /*                                                       @Y30LB39*/ 08953000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 08954000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 08955000
*   /*                                                       @Y30LB39*/ 08956000
*   /*                                                               */ 08957000
*   /*****************************************************************/ 08958000
*                                                                  1972 08959000
*                                   /*                       @Y30LB39*/ 08960000
*   IF SSRCODE>0 THEN                                              1972 08961000
         L     @15,@PC00026                                        1972 08962000
         L     @15,SSRCODE(,@15)                                   1972 08963000
         LTR   @15,@15                                             1972 08964000
         BNP   @RF01972                                            1972 08965000
*     DO;                           /*                       @Y30LB39   08966000
*                                                            @Y30LB39*/ 08967000
*                                                                  1973 08968000
*       /*************************************************************/ 08969000
*       /*                                                           */ 08970000
*       /*                                                   @Y30LB39*/ 08971000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 08972000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 08973000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 08974000
*       /* CODES.                                            @Y30LB39*/ 08975000
*       /*                                                   @Y30LB39*/ 08976000
*       /*                                                           */ 08977000
*       /*************************************************************/ 08978000
*                                                                  1974 08979000
*                                   /*                       @Y30LB39*/ 08980000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08981000
         XC    SSDRGLT(20),SSDRGLT                                 1974 08982000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 08983000
         LA    @09,SSINXLST                                        1975 08984000
         ST    @09,DARGRETP(,@02)                                  1975 08985000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 08986000
         MVC   DARGSMOD(3,@02),SSMODSS0                            1976 08987000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 08988000
         MVI   DARGSENT(@02),X'01'                                 1977 08989000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   08990000
*                                                            @Y30LB39*/ 08991000
*                                                                  1978 08992000
         MVC   DARGRETL(2,@02),@CH01877                            1978 08993000
*       /*************************************************************/ 08994000
*       /*                                                           */ 08995000
*       /*                                                   @Y30LB39*/ 08996000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 08997000
*       /* ARRAY.                                            @Y30LB39*/ 08998000
*       /*                                                   @Y30LB39*/ 08999000
*       /*                                                           */ 09000000
*       /*************************************************************/ 09001000
*                                                                  1979 09002000
*                                   /*                       @Y30LB39*/ 09003000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   09004000
*                                                            @Y30LB39*/ 09005000
*                                                                  1979 09006000
         ST    @07,@AL00001                                        1979 09007000
         LA    @09,@CF00115                                        1979 09008000
         ST    @09,@AL00001+4                                      1979 09009000
         LA    @09,SSDLPTR                                         1979 09010000
         ST    @09,@AL00001+8                                      1979 09011000
         MVI   @AL00001+8,X'80'                                    1979 09012000
         L     @15,GDTPRT(,@07)                                    1979 09013000
         LA    @01,@AL00001                                        1979 09014000
         BALR  @14,@15                                             1979 09015000
*       /*************************************************************/ 09016000
*       /*                                                           */ 09017000
*       /*                                                   @Y30LB39*/ 09018000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 09019000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 09020000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 09021000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 09022000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 09023000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 09024000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 09025000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 09026000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 09027000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 09028000
*       /* REASON CODE.                                      @Y30LB39*/ 09029000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 09030000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 09031000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 09032000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 09033000
*       /*                                                   @Y30LB39*/ 09034000
*       /*                                                           */ 09035000
*       /*************************************************************/ 09036000
*                                                                  1980 09037000
*                                   /*                       @Y30LB39*/ 09038000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 09039000
         LA    ENTRYNUM,1                                          1980 09040000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1981 09041000
@DL01981 DS    0H                                                  1982 09042000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 09043000
         AL    ENTRYNUM,@CF00217                                   1982 09044000
*       END;                        /*                       @Y30LB39   09045000
*                                                            @Y30LB39*/ 09046000
*                                                                  1983 09047000
@DE01981 L     @09,@PC00026                                        1983 09048000
         LR    @07,ENTRYNUM                                        1983 09049000
         ALR   @07,@07                                             1983 09050000
         LH    @07,SSARRAY-2(@07)                                  1983 09051000
         CH    @07,SSRHALF(,@09)                                   1983 09052000
         BE    @DC01981                                            1983 09053000
         SLR   @02,@02                                             1983 09054000
         CR    @07,@02                                             1983 09055000
         BNE   @DL01981                                            1983 09056000
@DC01981 DS    0H                                                  1984 09057000
*       /*************************************************************/ 09058000
*       /*                                                           */ 09059000
*       /*                                                   @Y30LB39*/ 09060000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 09061000
*       /*                                                   @Y30LB39*/ 09062000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 09063000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 09064000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 09065000
*       /* CODE OR                                           @Y30LB39*/ 09066000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 09067000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 09068000
*       /*                                                   @Y30LB39*/ 09069000
*       /*                                                           */ 09070000
*       /*************************************************************/ 09071000
*                                                                  1984 09072000
*                                   /*                       @Y30LB39*/ 09073000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 09074000
         XC    SSDRGLT(20),SSDRGLT                                 1984 09075000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 09076000
         L     @15,SSDLPTR                                         1985 09077000
         MVC   DARGSMOD(3,@15),SSMODSS0                            1985 09078000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 09079000
         STC   ENTRYNUM,DARGSENT(,@15)                             1986 09080000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 09081000
         CR    @07,@02                                             1987 09082000
         BNE   @RF01987                                            1987 09083000
*         DO;                       /*                       @Y30LB39*/ 09084000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 09085000
         ST    @09,DARGDBP(,@15)                                   1989 09086000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 09087000
         MVC   DARGILP(2,@15),@CH00036                             1990 09088000
*         END;                      /*                       @Y30LB39*/ 09089000
*     END;                          /*                       @Y30LB39*/ 09090000
*                                   /*                       @Y30LB39*/ 09091000
*                                                                  1993 09092000
*   /*****************************************************************/ 09093000
*   /*                                                               */ 09094000
*   /*                                                       @Y30LB39*/ 09095000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 09096000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 09097000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 09098000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 09099000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 09100000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 09101000
*   /* POST CODE.                                            @Y30LB39*/ 09102000
*   /*                                                       @Y30LB39*/ 09103000
*   /*                                                               */ 09104000
*   /*****************************************************************/ 09105000
*                                                                  1993 09106000
*                                   /*                       @Y30LB39*/ 09107000
*   ELSE                            /*                       @Y30LB39*/ 09108000
*     DO;                           /*                       @Y30LB39*/ 09109000
         B     @RC01972                                            1993 09110000
@RF01972 DS    0H                                                  1994 09111000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 09112000
         XC    SSDRGLT(20),SSDRGLT                                 1994 09113000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 09114000
         L     @07,SSDLPTR                                         1995 09115000
         MVC   DARGSMOD(3,@07),SSMODCM0                            1995 09116000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 09117000
         MVC   DARGSENT(1,@07),SSMSGNUM                            1996 09118000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 09119000
         L     @02,@PC00026+4                                      1997 09120000
         ST    @02,DARGDBP(,@07)                                   1997 09121000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 09122000
         MVC   DARGILP(2,@07),@CH00217                             1998 09123000
*     END;                          /*                       @Y30LB39   09124000
*                                                            @Y30LB39*/ 09125000
*                                                                  1999 09126000
*   /*****************************************************************/ 09127000
*   /*                                                               */ 09128000
*   /*                                                       @Y30LB39*/ 09129000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 09130000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 09131000
*   /*                                                       @Y30LB39*/ 09132000
*   /*                                                               */ 09133000
*   /*****************************************************************/ 09134000
*                                                                  2000 09135000
*                                   /*                       @Y30LB39*/ 09136000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   09137000
*                                                            @Y30LB39*/ 09138000
*                                                                  2000 09139000
@RC01972 L     @07,@PC00001                                        2000 09140000
         ST    @07,@AL00001                                        2000 09141000
         LA    @02,@CF00115                                        2000 09142000
         ST    @02,@AL00001+4                                      2000 09143000
         LA    @02,SSDLPTR                                         2000 09144000
         ST    @02,@AL00001+8                                      2000 09145000
         MVI   @AL00001+8,X'80'                                    2000 09146000
         L     @15,GDTPRT(,@07)                                    2000 09147000
         LA    @01,@AL00001                                        2000 09148000
         BALR  @14,@15                                             2000 09149000
*   /*****************************************************************/ 09150000
*   /*                                                               */ 09151000
*   /*                                                       @Y30LB39*/ 09152000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 09153000
*   /*                                                       @Y30LB39*/ 09154000
*   /*                                                               */ 09155000
*   /*****************************************************************/ 09156000
*                                                                  2001 09157000
*                                   /*                       @Y30LB39   09158000
*                                                            @Y30LB39*/ 09159000
*   RETURN CODE(0);                 /*                       @Y30LB39   09160000
*                                                            @Y30LB39*/ 09161000
         SLR   @15,@15                                             2001 09162000
         L     @14,@SA00026                                        2001 09163000
         LM    @00,@12,@SA00026+8                                  2001 09164000
         BR    @14                                                 2001 09165000
*   END SSCMSG;                     /*                       @Y30LB39*/ 09166000
*   END IDCCN01                     /*                       @Y30LB34*/ 09167000
*                                                                  2003 09168000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 09169000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 09170000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 09171000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 09172000
*/*%INCLUDE SYSLIB  (IDCCSCN )                                       */ 09173000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 09174000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 09175000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 09176000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 09177000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */ 09178000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */ 09179000
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */ 09180000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 09181000
*                                                                  2003 09182000
*       ;                                                          2003 09183000
@DATA    DS    0H                                                       09184000
@CH00153 DC    H'2'                                                     09185000
@CH00608 DC    H'44'                                                    09186000
@CH01872 DC    H'54'                                                    09187000
@CH01877 DC    H'120'                                                   09188000
@CH01875 DC    H'224'                                                   09189000
         DS    0F                                                       09190000
@AL00808 EQU   *                       LIST WITH   3 ARGUMENT(S)        09191000
@AL01528 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        09192000
         DC    A(WAIT)                                                  09193000
         DC    A(@CC01594)                                              09194000
@DATD    DSECT                                                          09195000
         DS    0F                                                       09196000
@SA00001 DS    18F                                                      09197000
@PC00001 DS    3F                                                       09198000
@SA00026 DS    15F                                                      09199000
@PC00026 DS    2F                                                       09200000
@AL00001 DS    5A                                                       09201000
IDCCN01  CSECT                                                          09202000
         DS    0F                                                       09203000
@CF00115 DC    F'0'                                                     09204000
@CF00217 DC    F'1'                                                     09205000
@CH00217 EQU   @CF00217+2                                               09206000
@CF00036 DC    F'4'                                                     09207000
@CH00036 EQU   @CF00036+2                                               09208000
@CF00038 DC    F'6'                                                     09209000
@CH00038 EQU   @CF00038+2                                               09210000
@CF00177 DC    F'8'                                                     09211000
@CH00177 EQU   @CF00177+2                                               09212000
@CF00567 DC    F'12'                                                    09213000
@CH00567 EQU   @CF00567+2                                               09214000
@CF01899 DC    XL4'0000FFFF'                                            09215000
@DATD    DSECT                                                          09216000
         DS    0D                                                       09217000
LISTSCAN DS    A                                                        09218000
IOCSPTR  DS    A                                                        09219000
DDSTRU   DS    A                                                        09220000
FSADDR   DS    A                                                        09221000
ERCNVADR DS    A                                                        09222000
DMPINDEX DS    A                                                        09223000
CCMSGPTR DS    A                                                        09224000
CMMSGPTR DS    A                                                        09225000
CTMSGPTR DS    A                                                        09226000
ELEMENT  DS    F                                                        09227000
RVVIPTR  DS    A                                                        09228000
BASEVPTR DS    A                                                        09229000
MVRPTR   DS    A                                                        09230000
CTGPLPTR DS    A                                                        09231000
CVOLPTR  DS    A                                                        09232000
COVCEPTR DS    A                                                        09233000
USSCREG0 DS    F                                                        09234000
UNITABLP DS    A                                                        09235000
INFOPTR  DS    A                                                        09236000
RTNREG1  DS    A                                                        09237000
RTNREG3  DS    A                                                        09238000
RTNREG4  DS    A                                                        09239000
SSDLPTR  DS    A                                                        09240000
LISTPTR  DS    A                                                        09241000
TESTRC   DS    H                                                        09242000
CC04     DS    H                                                        09243000
CC15     DS    H                                                        09244000
CC16     DS    H                                                        09245000
CC18     DS    H                                                        09246000
SETRC    DS    H                                                        09247000
LISTLN   DS    FL1                                                      09248000
@TS00001 DS    CL95                                                     09249000
PRINTTAB DS    CL44                                                     09250000
USSCECB  DS    CL1                                                      09251000
RNAMERE  DS    CL20                                                     09252000
         ORG   RNAMERE                                                  09253000
RENQLEN  DS    FL1                                                      09254000
RENQNAM  DS    CL19                                                     09255000
         ORG   RENQNAM                                                  09256000
REVOLSER DS    CL6                                                      09257000
RENQ     DS    CL13                                                     09258000
         ORG   RNAMERE+20                                               09259000
RNAMERR  DS    CL20                                                     09260000
         ORG   RNAMERR                                                  09261000
RRESLEN  DS    FL1                                                      09262000
RRESNAM  DS    CL19                                                     09263000
         ORG   RRESNAM                                                  09264000
RRVOLSER DS    CL6                                                      09265000
RRES     DS    CL13                                                     09266000
         ORG   RNAMERR+20                                               09267000
RNAMEVE  DS    CL23                                                     09268000
         ORG   RNAMEVE                                                  09269000
VENQLEN  DS    FL1                                                      09270000
VENQNAM  DS    CL22                                                     09271000
         ORG   VENQNAM                                                  09272000
VEVOLSER DS    CL6                                                      09273000
VENQ     DS    CL16                                                     09274000
         ORG   RNAMEVE+23                                               09275000
RNAMEVR  DS    CL23                                                     09276000
         ORG   RNAMEVR                                                  09277000
VRESLEN  DS    FL1                                                      09278000
VRESNAM  DS    CL22                                                     09279000
         ORG   VRESNAM                                                  09280000
VRVOLSER DS    CL6                                                      09281000
VRES     DS    CL16                                                     09282000
         ORG   RNAMEVR+23                                               09283000
         DS    CL1                                                      09284000
UNITABLA DS    CL11                                                     09285000
IOINFAR  DS    CL1                                                      09286000
INFOAREA DS    CL54                                                     09287000
         ORG   INFOAREA                                                 09288000
AREALEN  DS    CL2                                                      09289000
DATALEN  DS    CL2                                                      09290000
VOLLIST  DS    CL2                                                      09291000
         ORG   VOLLIST                                                  09292000
DEVLST   DS    CL2                                                      09293000
         ORG   INFOAREA+6                                               09294000
VOLLEN   DS    FL2                                                      09295000
FIRVOL   DS    CL6                                                      09296000
         ORG   FIRVOL                                                   09297000
DEVONLY  DS    CL4                                                      09298000
         ORG   INFOAREA+14                                              09299000
DEVLIST  DS    CL2                                                      09300000
DEVLEN   DS    FL2                                                      09301000
DEVICE   DS    CL4                                                      09302000
DEVBLK   DS    CL4                                                      09303000
DEVTRK   DS    CL4                                                      09304000
SPACE    DS    CL24                                                     09305000
         ORG   INFOAREA+54                                              09306000
         DS    CL2                                                      09307000
VS1ARGS  DS    CL150                                                    09308000
         ORG   VS1ARGS                                                  09309000
FRVS1AGL DS    CL74                                                     09310000
         DS    CL2                                                      09311000
TOVS1AGL DS    CL74                                                     09312000
         ORG   VS1ARGS+150                                              09313000
         DS    CL2                                                      09314000
VS2AGLAR DS    CL52                                                     09315000
OPNAREA  DS    BL48                                                     09316000
MDAGLAR  DS    CL37                                                     09317000
         DS    CL3                                                      09318000
PUAGLAR  DS    CL20                                                     09319000
CKAGLAR  DS    CL29                                                     09320000
         DS    CL3                                                      09321000
EXCLAR   DS    CL23                                                     09322000
         DS    CL1                                                      09323000
CVOLAR   DS    CL40                                                     09324000
RVVIAREA DS    CL68                                                     09325000
BASEVAR  DS    CL224                                                    09326000
MVRAREA  DS    CL88                                                     09327000
COVCEAR  DS    CL43                                                     09328000
CNVOLAR  DS    CL44                                                     09329000
         DS    CL1                                                      09330000
SRCEAREA DS    CL39                                                     09331000
         ORG   SRCEAREA                                                 09332000
SLABEL   DS    CL6                                                      09333000
SVOLSER  DS    CL6                                                      09334000
SDEVTYPE DS    CL4                                                      09335000
SUCBADDR DS    AL4                                                      09336000
SVTOCTTR DS    CL4                                                      09337000
STYPEVOL DS    CL4                                                      09338000
SUNITADR DS    FL2                                                      09339000
SCATDD   DS    CL8                                                      09340000
SRCEBITS DS    CL1                                                      09341000
         ORG   SRCEBITS                                                 09342000
SENQ     DS    BL1                                                      09343000
SRES     EQU   SRCEBITS+0                                               09344000
SVSAM    EQU   SRCEBITS+0                                               09345000
@NM00122 EQU   SRCEBITS+0                                               09346000
         ORG   SRCEAREA+39                                              09347000
         DS    CL1                                                      09348000
TARGAREA DS    CL49                                                     09349000
         ORG   TARGAREA                                                 09350000
TLABEL   DS    CL6                                                      09351000
TVOLCNT  DS    CL7                                                      09352000
         ORG   TVOLCNT                                                  09353000
TCOUNT   DS    FL1                                                      09354000
TVOLSER  DS    CL6                                                      09355000
         ORG   TARGAREA+13                                              09356000
@NM00123 DS    CL1                                                      09357000
TUNITADR DS    FL2                                                      09358000
TDEVTYPE DS    CL4                                                      09359000
TUCBADDR DS    AL4                                                      09360000
TVTOCTTR DS    CL4                                                      09361000
TTYPEVOL DS    CL4                                                      09362000
TOWNER   DS    CL10                                                     09363000
TNUMAT   DS    CL2                                                      09364000
TNXTAT   DS    CL4                                                      09365000
TARGBITS DS    CL1                                                      09366000
         ORG   TARGBITS                                                 09367000
TENQ     DS    BL1                                                      09368000
TRES     EQU   TARGBITS+0                                               09369000
NOVTOCCK EQU   TARGBITS+0                                               09370000
@NM00124 EQU   TARGBITS+0                                               09371000
         ORG   TARGAREA+49                                              09372000
         DS    CL3                                                      09373000
SWITCHES DS    CL1                                                      09374000
         ORG   SWITCHES                                                 09375000
SAMESER  DS    BL1                                                      09376000
CONVTYPE EQU   SWITCHES+0                                               09377000
VSAM     EQU   SWITCHES+0                                               09378000
NONVSAM  EQU   SWITCHES+0                                               09379000
MSGSW    EQU   SWITCHES+0                                               09380000
@NM00125 EQU   SWITCHES+0                                               09381000
         ORG   SWITCHES+1                                               09382000
         DS    CL3                                                      09383000
CTGPLAR  DS    CL32                                                     09384000
CTGFLAR1 DS    CL24                                                     09385000
CTGFLAR2 DS    CL24                                                     09386000
CTGFLAR3 DS    CL24                                                     09387000
SSDRGLT  DS    CL20                                                     09388000
SSINXLST DS    CL120                                                    09389000
         ORG   SSINXLST                                                 09390000
SSARRAY  DS    60H                                                      09391000
         ORG   SSINXLST+120                                             09392000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09393000
@ENDDATD EQU   *                                                        09394000
IDCCN01  CSECT                                                          09395000
         DS    0F                                                       09396000
@SIZDATD DC    AL1(0)                                                   09397000
         DC    AL3(@ENDDATD-@DATD)                                      09398000
         DS    0D                                                       09399000
RVVLEN   DC    AL2(68)                                                  09400000
MVRLEN   DC    AL2(88)                                                  09401000
COVLEN   DC    AL2(43)                                                  09402000
SSMSGNUM DC    AL1(56)                                                  09403000
@CC01599 DC    C'.VIRTUAL.ENQUEUE'                                      09404000
@CC01605 DC    C'.VIRTUAL.RESERVE'                                      09405000
@CC01596 DC    C'.REAL.ENQUEUE'                                         09406000
@CC01602 DC    C'.REAL.RESERVE'                                         09407000
@CC01594 DC    C'SYSZAMS '                                              09408000
@CC01720 DC    C'IDCVS01 '                                              09409000
@CC01721 DC    C'JOBCAT  '                                              09410000
@CC01722 DC    C'STEPCAT '                                              09411000
@CC01768 DC    C'IDCVS02 '                                              09412000
@CC01652 DC    C'CNST'                                                  09413000
@CC01667 DC    C'CNBG'                                                  09414000
@CC01671 DC    C'CNND'                                                  09415000
@CC01676 DC    C'CNT1'                                                  09416000
@CC01679 DC    C'REAL'                                                  09417000
@CC01680 DC    C'VIRT'                                                  09418000
@CC01685 DC    C'CNT2'                                                  09419000
@CC01691 DC    C'CNT3'                                                  09420000
@CC01696 DC    C'CNT4'                                                  09421000
@CC01705 DC    C'CNT5'                                                  09422000
@CC01712 DC    C'CNT6'                                                  09423000
@CC01717 DC    C'CNT7'                                                  09424000
@CC01727 DC    C'CNT8'                                                  09425000
@CC01734 DC    C'CNT9'                                                  09426000
@CC01740 DC    C'CNTA'                                                  09427000
@CC01747 DC    C'CNTB'                                                  09428000
@CC01760 DC    C'CNTC'                                                  09429000
@CC01765 DC    C'CNTD'                                                  09430000
@CC01773 DC    C'CNTE'                                                  09431000
@CC01778 DC    C'CNTF'                                                  09432000
@CC01794 DC    C'CNTG'                                                  09433000
@CC01801 DC    C'CNTH'                                                  09434000
@CC01808 DC    C'CNTI'                                                  09435000
@CC01817 DC    C'CNTJ'                                                  09436000
@CC01823 DC    C'CNTK'                                                  09437000
@CC01828 DC    C'CNTL'                                                  09438000
@CC01833 DC    C'CNTM'                                                  09439000
@CC01841 DC    C'CNTN'                                                  09440000
@CC01846 DC    C'CNTO'                                                  09441000
@CC01869 DC    C'SSAA'                                                  09442000
@CC01553 DC    C'UV0'                                                   09443000
@CC01555 DC    C'CM0'                                                   09444000
@CC01557 DC    C'CN0'                                                   09445000
ALL      DC    CL3'ALL'                                                 09446000
FORMAT   DC    CL4'FORM'                                                09447000
HSECOND  DC    CL4'HSEC'                                                09448000
CLOCK    DC    CL4'KLOK'                                                09449000
SETZERO  DC    CL4'ZERO'                                                09450000
SETBLANK DC    CL4'BLNK'                                                09451000
NOSET    DC    CL4'NSET'                                                09452000
OVERRIDE DC    CL4'OVRD'                                                09453000
ACQUIRE  DC    CL8'ACQUIRE '                                            09454000
RELINQ   DC    CL8'RELINQ  '                                            09455000
MOUNT    DC    CL8'MOUNT   '                                            09456000
DEMOUNT  DC    CL8'DEMOUNT '                                            09457000
DEFINE   DC    CL8'DEFINE  '                                            09458000
MOVE     DC    CL8'MOVE    '                                            09459000
TRACEQ   DC    CL8'TRACEQ  '                                            09460000
COPYTABL DC    CL8'COPYTABL'                                            09461000
COPYCRTG DC    CL8'COPYCRTG'                                            09462000
COPYVOL  DC    CL8'COPYVOL '                                            09463000
VVIC     DC    CL8'VVIC    '                                            09464000
TUNE     DC    CL8'TUNE    '                                            09465000
NAMES    DC    CL4'NAME'                                                09466000
UNIT     DC    CL4'UNIT'                                                09467000
SHR      DC    CL4'SHR '                                                09468000
EXCL     DC    CL4'EXCL'                                                09469000
NOWAIT   DC    CL4'NWAI'                                                09470000
WAIT     DC    CL4'WAIT'                                                09471000
SECCHECK DC    CL8'SECCHECK'                                            09472000
SCRVTOC  DC    CL8'SCRVTOC '                                            09473000
GETVTOC  DC    CL8'GETVTOC '                                            09474000
PUTVTOC  DC    CL8'PUTVTOC '                                            09475000
RECATLG  DC    CL8'RECATLG '                                            09476000
INITVOL  DC    CL8'INITVOL '                                            09477000
CHECK    DC    CL8'CHECK   '                                            09478000
POSTUCB  DC    CL8'POSTUCB '                                            09479000
GET      DC    CL8'GET     '                                            09480000
PUT      DC    CL8'PUT     '                                            09481000
CLOSE    DC    CL8'CLOSE   '                                            09482000
OPEN     DC    CL8'OPEN    '                                            09483000
RVOPENR  DC    CL8'OPENR   '                                            09484000
RVRDCNT  DC    CL8'READCNT '                                            09485000
RVREADKD DC    CL8'READKD  '                                            09486000
RVSPACCR DC    CL8'SPACCR  '                                            09487000
RVFWRITE DC    CL8'FWRITE  '                                            09488000
RVWRITER DC    CL8'WRITEREC'                                            09489000
PUTLABEL DC    CL8'PUTLABEL'                                            09490000
GETLABEL DC    CL8'GETLABEL'                                            09491000
CANCEL   DC    CL8'CANCEL  '                                            09492000
SET      DC    CL8'SET     '                                            09493000
SELECTX  DC    CL8'SELECTX '                                            09494000
CHANGEX  DC    CL8'CHANGEX '                                            09495000
SELECTDD DC    CL8'SELECTDD'                                            09496000
SELECTDS DC    CL8'SELECTDS'                                            09497000
TBLREST  DC    CL8'TBLREST '                                            09498000
NULLIFYC DC    CL8'NULLIFYC'                                            09499000
RDMSC    DC    CL8'RDMSC   '                                            09500000
RDMSCTBL DC    CL8'RDMSCTBL'                                            09501000
RDCARTLB DC    CL8'RDCARTLB'                                            09502000
AUDITCEL DC    CL8'AUDITCEL'                                            09503000
RDSTGAD  DC    CL8'RDSTGAD '                                            09504000
MODID    DC    CL4'CN01'                                                09505000
         DS    CL3                                                      09506000
FIXAREA  DS    CL624                                                    09507000
         ORG   FIXAREA                                                  09508000
@NM00118 DS    CL624                                                    09509000
         ORG   @NM00118                                                 09510000
@NM00119 DC    208X'00'                                                 09511000
@NM00120 DC    208X'00'                                                 09512000
@NM00121 DC    208X'00'                                                 09513000
         ORG   FIXAREA+624                                              09514000
CNDEVTYP DC    CL8'DEVTYP  '                                            09515000
CNVOLSER DC    CL8'VOLSER  '                                            09516000
SSMODSS0 DC    CL3'SS0'                                                 09517000
SSMODCM0 DC    CL3'CM0'                                                 09518000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       09519000
@01      EQU   01                                                       09520000
@02      EQU   02                                                       09521000
@03      EQU   03                                                       09522000
@04      EQU   04                                                       09523000
@05      EQU   05                                                       09524000
@06      EQU   06                                                       09525000
@07      EQU   07                                                       09526000
@08      EQU   08                                                       09527000
@09      EQU   09                                                       09528000
@10      EQU   10                                                       09529000
@11      EQU   11                                                       09530000
@12      EQU   12                                                       09531000
@13      EQU   13                                                       09532000
@14      EQU   14                                                       09533000
@15      EQU   15                                                       09534000
ENTRYNUM EQU   @08                                                      09535000
CC24     EQU   @09                                                      09536000
CC23     EQU   @09                                                      09537000
CC22     EQU   @11                                                      09538000
CC21     EQU   @11                                                      09539000
CC20     EQU   @09                                                      09540000
CC19     EQU   @10                                                      09541000
CC17     EQU   @09                                                      09542000
CC14     EQU   @09                                                      09543000
CC13     EQU   @09                                                      09544000
CC12     EQU   @09                                                      09545000
CC11     EQU   @10                                                      09546000
CC10     EQU   @10                                                      09547000
CC09     EQU   @09                                                      09548000
CC08     EQU   @09                                                      09549000
CC07     EQU   @09                                                      09550000
CC06     EQU   @09                                                      09551000
CC05     EQU   @11                                                      09552000
CC03     EQU   @10                                                      09553000
CC02     EQU   @09                                                      09554000
CC01     EQU   @09                                                      09555000
RTNREG2  EQU   @07                                                      09556000
CTGFLPTR EQU   @09                                                      09557000
OPNPTR   EQU   @02                                                      09558000
RTNREG   EQU   @15                                                      09559000
REG14    EQU   @14                                                      09560000
CVOLR1   EQU   @01                                                      09561000
REG0     EQU   @00                                                      09562000
REG1     EQU   @01                                                      09563000
REG10    EQU   @10                                                      09564000
REG11    EQU   @11                                                      09565000
REG12    EQU   @12                                                      09566000
REG13    EQU   @13                                                      09567000
REG15    EQU   @15                                                      09568000
REG2     EQU   @02                                                      09569000
REG3     EQU   @03                                                      09570000
REG4     EQU   @04                                                      09571000
REG5     EQU   @05                                                      09572000
REG6     EQU   @06                                                      09573000
REG7     EQU   @07                                                      09574000
REG8     EQU   @08                                                      09575000
REG9     EQU   @09                                                      09576000
IDCSACL0 EQU   0                                                        09577000
IDCSAEP0 EQU   0                                                        09578000
IDCSACA0 EQU   0                                                        09579000
IDCSASS0 EQU   0                                                        09580000
IDCSANQ0 EQU   0                                                        09581000
IDCSADQ0 EQU   0                                                        09582000
IDCSASI0 EQU   0                                                        09583000
IDCSA060 EQU   0                                                        09584000
TRACE1   EQU   0                                                        09585000
OLDERID1 EQU   TRACE1                                                   09586000
TRACE2   EQU   0                                                        09587000
OLDERID2 EQU   TRACE2                                                   09588000
NEWID2   EQU   TRACE2+95                                                09589000
NEWERID2 EQU   5                                                        09590000
CIRAGL   EQU   0                                                        09591000
CIRTYPE  EQU   CIRAGL                                                   09592000
ALLAGL   EQU   0                                                        09593000
ALLSTS   EQU   ALLAGL+24                                                09594000
ALLDSP   EQU   ALLAGL+25                                                09595000
ALLORG   EQU   ALLAGL+26                                                09596000
ALLOPT   EQU   ALLAGL+28                                                09597000
UNITABL  EQU   0                                                        09598000
UNITADR  EQU   UNITABL+4                                                09599000
@NM00010 EQU   UNITADR                                                  09600000
UNITSTAT EQU   UNITABL+6                                                09601000
UNITXSHR EQU   UNITSTAT                                                 09602000
UNITUSHR EQU   UNITSTAT                                                 09603000
UNITVTOC EQU   UNITABL+7                                                09604000
IDCIOOP0 EQU   0                                                        09605000
IDCIOCL0 EQU   0                                                        09606000
IDCIOSI0 EQU   0                                                        09607000
IOCSTR   EQU   0                                                        09608000
IOCDSO   EQU   IOCSTR+16                                                09609000
IOCRFM   EQU   IOCSTR+17                                                09610000
IOCMAC   EQU   IOCSTR+18                                                09611000
IOCMAC2  EQU   IOCSTR+19                                                09612000
IOCCHP   EQU   IOCSTR+20                                                09613000
IOCMSG   EQU   IOCSTR+21                                                09614000
IOCMSGOP EQU   IOCMSG                                                   09615000
IOCCBP   EQU   IOCSTR+36                                                09616000
IOCRBA   EQU   IOCSTR+40                                                09617000
IOCTTR   EQU   IOCRBA                                                   09618000
IOCMEM   EQU   IOCSTR+44                                                09619000
IOCNWM   EQU   IOCSTR+48                                                09620000
OPNAGL   EQU   0                                                        09621000
OPNOPT   EQU   OPNAGL                                                   09622000
OPNOPTUP EQU   OPNOPT                                                   09623000
OPNRFM   EQU   OPNAGL+1                                                 09624000
OPNTYP   EQU   OPNAGL+2                                                 09625000
OPNTYPCI EQU   OPNTYP                                                   09626000
OPNMOD   EQU   OPNAGL+3                                                 09627000
OPNMODRC EQU   OPNMOD                                                   09628000
OPNIOC   EQU   OPNAGL+4                                                 09629000
OPNDDN   EQU   OPNAGL+8                                                 09630000
OPNPWA   EQU   OPNAGL+12                                                09631000
OPNDSN   EQU   OPNAGL+16                                                09632000
OPNDEV   EQU   OPNAGL+24                                                09633000
OPNDSO   EQU   OPNAGL+41                                                09634000
OPNDSOAM EQU   OPNDSO                                                   09635000
OPNOPT2  EQU   OPNAGL+42                                                09636000
OPNOPTJM EQU   OPNOPT2                                                  09637000
OPNVOL   EQU   OPNAGL+44                                                09638000
IOINFOPT EQU   0                                                        09639000
IOINFDVT EQU   IOINFOPT                                                 09640000
IOINFVOL EQU   IOINFOPT                                                 09641000
UVOLLIST EQU   0                                                        09642000
UVOLENT  EQU   UVOLLIST+2                                               09643000
AMSTP011 EQU   0                                                        09644000
DARGLIST EQU   0                                                        09645000
DARGDBP  EQU   DARGLIST                                                 09646000
DARGRETP EQU   DARGLIST+4                                               09647000
DARGSTID EQU   DARGLIST+8                                               09648000
DARGSMOD EQU   DARGSTID                                                 09649000
DARGSENT EQU   DARGSTID+3                                               09650000
DARGILP  EQU   DARGLIST+12                                              09651000
DARGCNT  EQU   DARGLIST+14                                              09652000
DARGRETL EQU   DARGLIST+16                                              09653000
DARGARY  EQU   DARGLIST+20                                              09654000
DARGINS  EQU   DARGARY                                                  09655000
DARGINL  EQU   DARGARY+2                                                09656000
DARGDTM  EQU   DARGARY+4                                                09657000
FMTLIST  EQU   0                                                        09658000
FMTFLGS  EQU   FMTLIST                                                  09659000
FMTSPF   EQU   FMTLIST+2                                                09660000
FMTRFNO  EQU   FMTSPF                                                   09661000
FMTILEN  EQU   FMTRFNO                                                  09662000
FMTIOFF  EQU   FMTLIST+4                                                09663000
FMTTRBC  EQU   FMTIOFF                                                  09664000
FMTSTO   EQU   FMTTRBC                                                  09665000
FMTOCOL  EQU   FMTLIST+6                                                09666000
FMTCNVF  EQU   FMTLIST+10                                               09667000
ERCNVTAB EQU   0                                                        09668000
ERTYPE   EQU   ERCNVTAB                                                 09669000
EROPER   EQU   ERCNVTAB+1                                               09670000
EROSOPER EQU   ERCNVTAB+2                                               09671000
IDCDB010 EQU   0                                                        09672000
DMPITM   EQU   0                                                        09673000
DMPARY   EQU   0                                                        09674000
FFILE    EQU   0                                                        09675000
FFILEVAL EQU   FFILE+1                                                  09676000
TFILE    EQU   0                                                        09677000
TFILEVAL EQU   TFILE+1                                                  09678000
TVOL     EQU   0                                                        09679000
TVOLVAL  EQU   TVOL+1                                                   09680000
ALLC     EQU   0                                                        09681000
VCAT     EQU   0                                                        09682000
NONE     EQU   0                                                        09683000
NSCR     EQU   0                                                        09684000
CATN     EQU   0                                                        09685000
CATNPAS  EQU   CATN+1                                                   09686000
CATNFLG  EQU   CATN+10                                                  09687000
CATNVAL  EQU   CATN+21                                                  09688000
CATDD    EQU   0                                                        09689000
CATDDVAL EQU   CATDD+1                                                  09690000
LIST     EQU   0                                                        09691000
PFILE    EQU   0                                                        09692000
@NM00038 EQU   PFILE+2                                                  09693000
CCMSG    EQU   0                                                        09694000
CMMSG    EQU   0                                                        09695000
CMVOLFLG EQU   CMMSG+6                                                  09696000
CTMSG    EQU   0                                                        09697000
CTARRAY  EQU   CTMSG+4                                                  09698000
MDAGL    EQU   0                                                        09699000
MDUCBPTR EQU   MDAGL+8                                                  09700000
MDDDNAME EQU   MDAGL+12                                                 09701000
MDPUAGL  EQU   MDAGL+20                                                 09702000
MDLABEL  EQU   MDAGL+24                                                 09703000
MDFLAGS  EQU   MDAGL+30                                                 09704000
MDCLEAR  EQU   MDFLAGS                                                  09705000
MDPOST   EQU   MDFLAGS                                                  09706000
MDWAIT   EQU   MDFLAGS                                                  09707000
MDVTOC   EQU   MDAGL+32                                                 09708000
PUAGL    EQU   0                                                        09709000
PUUCBPTR EQU   PUAGL+8                                                  09710000
PUTTRPTR EQU   PUAGL+12                                                 09711000
PULABELP EQU   PUAGL+16                                                 09712000
CKAGL    EQU   0                                                        09713000
CKUCBPTR EQU   CKAGL+8                                                  09714000
CKDDNAME EQU   CKAGL+12                                                 09715000
CKDATYPE EQU   CKAGL+20                                                 09716000
CKFLAGS  EQU   CKAGL+28                                                 09717000
CKRETTYP EQU   CKFLAGS                                                  09718000
EXCLAGL  EQU   0                                                        09719000
EXCLUCBP EQU   EXCLAGL+8                                                09720000
EXCLDDP  EQU   EXCLAGL+12                                               09721000
EXCLFLAG EQU   EXCLAGL+22                                               09722000
EXOARG   EQU   0                                                        09723000
EXOPT    EQU   EXOARG+32                                                09724000
EXFLG    EQU   EXOARG+33                                                09725000
EXGARG   EQU   0                                                        09726000
EXWRARG  EQU   0                                                        09727000
EXRWCHR  EQU   EXWRARG+26                                               09728000
EXSPACE  EQU   EXWRARG+36                                               09729000
EXPARG   EQU   0                                                        09730000
EXPDATA  EQU   EXPARG+12                                                09731000
EXPDATAB EQU   0                                                        09732000
EXPARRAY EQU   EXPDATAB+4                                               09733000
VS2AGL   EQU   0                                                        09734000
VSUCBPTR EQU   VS2AGL+8                                                 09735000
VSOWNPTR EQU   VS2AGL+16                                                09736000
VSVOLPTR EQU   VS2AGL+20                                                09737000
VSLABOPT EQU   VS2AGL+28                                                09738000
VSOWNER  EQU   VSLABOPT                                                 09739000
VSVOLSER EQU   VSLABOPT                                                 09740000
VSVOLUME EQU   VS2AGL+29                                                09741000
VS2MSG   EQU   VS2AGL+35                                                09742000
VS2TOV   EQU   VS2MSG                                                   09743000
VS2RESOP EQU   VS2AGL+36                                                09744000
VSDDNAME EQU   VS2AGL+37                                                09745000
VS1AGL   EQU   0                                                        09746000
VSUCBP   EQU   VS1AGL+8                                                 09747000
VSVOLP   EQU   VS1AGL+12                                                09748000
VSFILEP  EQU   VS1AGL+16                                                09749000
VSIOP    EQU   VS1AGL+20                                                09750000
VSNUMATP EQU   VS1AGL+24                                                09751000
VSNXTATP EQU   VS1AGL+28                                                09752000
VSCATP   EQU   VS1AGL+32                                                09753000
VSCATDDP EQU   VS1AGL+40                                                09754000
VSPSWDP  EQU   VS1AGL+44                                                09755000
VSPFILEP EQU   VS1AGL+48                                                09756000
VSSERP   EQU   VS1AGL+52                                                09757000
VSDEVP   EQU   VS1AGL+56                                                09758000
VSOSERP  EQU   VS1AGL+60                                                09759000
VSODEVP  EQU   VS1AGL+64                                                09760000
VSSECOPT EQU   VS1AGL+68                                                09761000
VSNOVSAM EQU   VSSECOPT                                                 09762000
VSNONONV EQU   VSSECOPT                                                 09763000
VSREAD   EQU   VSSECOPT                                                 09764000
VSUCTEST EQU   VSSECOPT                                                 09765000
VSOPCAT  EQU   VSSECOPT                                                 09766000
VSUCMAST EQU   VSSECOPT                                                 09767000
VSVTOPT  EQU   VS1AGL+69                                                09768000
VSTIME   EQU   VSVTOPT                                                  09769000
VSALTTRK EQU   VSVTOPT                                                  09770000
VSCATOPT EQU   VS1AGL+70                                                09771000
VSDEVICE EQU   VSCATOPT                                                 09772000
VSSERIAL EQU   VSCATOPT                                                 09773000
VSLIST   EQU   VSCATOPT                                                 09774000
VSRETURN EQU   VS1AGL+71                                                09775000
VSVSAM   EQU   VSRETURN                                                 09776000
VSUCAT   EQU   VSRETURN                                                 09777000
VSMSG    EQU   VS1AGL+72                                                09778000
VSFROMV  EQU   VSMSG                                                    09779000
VSTOV    EQU   VSMSG                                                    09780000
VSRESOPT EQU   VS1AGL+73                                                09781000
VSRES    EQU   VSRESOPT                                                 09782000
VSREAL   EQU   VSRESOPT                                                 09783000
RCTAGL   EQU   0                                                        09784000
RCTOPT   EQU   RCTAGL+8                                                 09785000
STAEPARM EQU   0                                                        09786000
STARCVY  EQU   STAEPARM+52                                              09787000
STARETRY EQU   STAEPARM+53                                              09788000
VOLLABEL EQU   0                                                        09789000
SV82LIST EQU   0                                                        09790000
@NM00073 EQU   SV82LIST+4                                               09791000
SV82DCBP EQU   @NM00073                                                 09792000
@NM00074 EQU   SV82LIST+12                                              09793000
SV82WRKP EQU   @NM00074                                                 09794000
SRTAGL   EQU   0                                                        09795000
LCTINFO  EQU   0                                                        09796000
LCTFLAGS EQU   LCTINFO+32                                               09797000
UCTAGL   EQU   0                                                        09798000
UCTFLAGS EQU   UCTAGL+68                                                09799000
SELAGL   EQU   0                                                        09800000
SELFLAGS EQU   SELAGL+22                                                09801000
DATESAGL EQU   0                                                        09802000
DATESOPT EQU   DATESAGL+20                                              09803000
VS3AGL   EQU   0                                                        09804000
VS3FLAGS EQU   VS3AGL+58                                                09805000
VSDVTOC  EQU   0                                                        09806000
VSDSTAT  EQU   0                                                        09807000
VSDSFLG1 EQU   VSDSTAT+16                                               09808000
VSDFLG2  EQU   VSDSTAT+17                                               09809000
VSDSCR   EQU   0                                                        09810000
VSDSCRFL EQU   VSDSCR+4                                                 09811000
VSDUSAGE EQU   0                                                        09812000
VSDDORG  EQU   VSDUSAGE+9                                               09813000
VSDALLOC EQU   VSDUSAGE+10                                              09814000
VSDUSEF  EQU   VSDUSAGE+11                                              09815000
VSDDSORG EQU   VSDUSAGE+16                                              09816000
VSDBLOCK EQU   0                                                        09817000
VSDSPACE EQU   VSDBLOCK+12                                              09818000
VSDARRAY EQU   VSDBLOCK+16                                              09819000
VSDVARY  EQU   VSDARRAY+48                                              09820000
RVVI     EQU   0                                                        09821000
RVVLNGTH EQU   RVVI                                                     09822000
RVVOPCOD EQU   RVVI+4                                                   09823000
RVVCODE  EQU   RVVOPCOD                                                 09824000
RVVOLUME EQU   RVVI+8                                                   09825000
RVVBUFLN EQU   RVVI+30                                                  09826000
RVVRTBUF EQU   RVVI+32                                                  09827000
RVVFLAGA EQU   RVVI+58                                                  09828000
RVVRMODE EQU   RVVFLAGA                                                 09829000
RVVRDR   EQU   RVVRMODE                                                 09830000
RVVCHAIN EQU   RVVFLAGA+1                                               09831000
RVVRDRCD EQU   RVVFLAGA+2                                               09832000
RVVBVRCD EQU   RVVRDRCD                                                 09833000
RVVRTEST EQU   RVVFLAGA+3                                               09834000
RVVCPYTP EQU   RVVFLAGA+4                                               09835000
RVVSPEC  EQU   RVVFLAGA+5                                               09836000
RVVSVOL  EQU   RVVSPEC                                                  09837000
BASEV    EQU   0                                                        09838000
BASNAME  EQU   BASEV                                                    09839000
BASID    EQU   BASNAME+11                                               09840000
BASFLAGA EQU   BASEV+14                                                 09841000
BASTYPE  EQU   BASFLAGA                                                 09842000
BASINAC  EQU   BASFLAGA+2                                               09843000
BASRCVYF EQU   BASEV+20                                                 09844000
BASSATIA EQU   BASRCVYF                                                 09845000
BASIVCRE EQU   BASSATIA                                                 09846000
BASIVCPY EQU   BASSATIA                                                 09847000
BASVSMIS EQU   BASSATIA                                                 09848000
BASMISCF EQU   BASRCVYF+2                                               09849000
BASLIB1  EQU   BASEV+36                                                 09850000
BASLID1  EQU   BASLIB1                                                  09851000
BASLIB2  EQU   BASEV+49                                                 09852000
BASLID2  EQU   BASLIB2                                                  09853000
BASKLCPY EQU   BASEV+76                                                 09854000
BASCOPID EQU   BASKLCPY+11                                              09855000
BASOWNER EQU   BASEV+134                                                09856000
MVR      EQU   0                                                        09857000
MVRLNGTH EQU   MVR                                                      09858000
MVRCODE  EQU   MVR+4                                                    09859000
MVROPCD  EQU   MVRCODE                                                  09860000
MVRFLAGA EQU   MVR+8                                                    09861000
MVRFLBAS EQU   MVRFLAGA                                                 09862000
MVRCICPY EQU   MVRFLAGA+2                                               09863000
MVRBVOL  EQU   MVR+12                                                   09864000
CTGPL    EQU   0                                                        09865000
CTGOPTN1 EQU   CTGPL                                                    09866000
CTGNAME  EQU   CTGOPTN1                                                 09867000
CTGCNAME EQU   CTGOPTN1                                                 09868000
CTGOPTN2 EQU   CTGPL+1                                                  09869000
CTGEXT   EQU   CTGOPTN2                                                 09870000
CTGERASE EQU   CTGOPTN2                                                 09871000
CTGSMF   EQU   CTGERASE                                                 09872000
CTGREL   EQU   CTGSMF                                                   09873000
CTGPURG  EQU   CTGOPTN2                                                 09874000
CTGVMNT  EQU   CTGPURG                                                  09875000
CTGOPTN3 EQU   CTGPL+2                                                  09876000
CTGFUNC  EQU   CTGOPTN3                                                 09877000
CTGAM0   EQU   CTGOPTN3                                                 09878000
CTGOPTN4 EQU   CTGPL+3                                                  09879000
CTGENT   EQU   CTGPL+4                                                  09880000
CTGCAT   EQU   CTGPL+8                                                  09881000
CTGDSORG EQU   CTGPL+16                                                 09882000
CTGOPTNS EQU   CTGDSORG                                                 09883000
CTGNOFLD EQU   CTGPL+19                                                 09884000
CTGDDNM  EQU   CTGPL+20                                                 09885000
CTGNEWNM EQU   CTGDDNM                                                  09886000
CTGFDBK  EQU   CTGNEWNM                                                 09887000
CTGFBFLG EQU   CTGNEWNM+2                                               09888000
CTGJSCB  EQU   CTGPL+24                                                 09889000
CTGFIELD EQU   CTGPL+28                                                 09890000
CTGFL    EQU   0                                                        09891000
CTGFLDNO EQU   CTGFL                                                    09892000
CTGFLDCD EQU   CTGFL+1                                                  09893000
CTGFLDRE EQU   CTGFL+3                                                  09894000
CTGFLDNM EQU   CTGFL+8                                                  09895000
CTGFLCHN EQU   CTGFL+12                                                 09896000
CTGFLDAT EQU   CTGFL+16                                                 09897000
CTGFLNG  EQU   CTGFLDAT                                                 09898000
CTGFLPT  EQU   CTGFLDAT+4                                               09899000
CVOLLST  EQU   0                                                        09900000
CVOLFLG  EQU   CVOLLST+6                                                09901000
CVODASCR EQU   CVOLFLG                                                  09902000
CVOCRDAS EQU   CVOLFLG                                                  09903000
CVOLID   EQU   CVOLLST+8                                                09904000
CVOLRUA  EQU   CVOLLST+32                                               09905000
CVOLVEXT EQU   CVOLLST+36                                               09906000
COVCE    EQU   0                                                        09907000
COVLNGTH EQU   COVCE                                                    09908000
COVFLAGA EQU   COVCE+34                                                 09909000
COVFLAGB EQU   COVCE+35                                                 09910000
COVSETFL EQU   COVFLAGB                                                 09911000
COVSRCVY EQU   COVSETFL                                                 09912000
COVRECFL EQU   COVFLAGB+1                                               09913000
COVICOPY EQU   COVRECFL                                                 09914000
COVTYPE  EQU   COVFLAGB+2                                               09915000
AMSTP041 EQU   0                                                        09916000
AMSTP042 EQU   0                                                        09917000
AMSTP043 EQU   0                                                        09918000
AMSTP044 EQU   0                                                        09919000
CAT      EQU   0                                                        09920000
DMPTRM   EQU   0                                                        09921000
IDCIOCO0 EQU   0                                                        09922000
IDCIOGT0 EQU   0                                                        09923000
IDCIOIT0 EQU   0                                                        09924000
IDCIOPO0 EQU   0                                                        09925000
IDCIOPT0 EQU   0                                                        09926000
IDCIOST0 EQU   0                                                        09927000
IDCIOTM0 EQU   0                                                        09928000
IDCIOVY0 EQU   0                                                        09929000
IDCIO050 EQU   0                                                        09930000
IDCSAAL0 EQU   0                                                        09931000
IDCSACR0 EQU   0                                                        09932000
IDCSADE0 EQU   0                                                        09933000
IDCSADL0 EQU   0                                                        09934000
IDCSAFP0 EQU   0                                                        09935000
IDCSAFS0 EQU   0                                                        09936000
IDCSAGP0 EQU   0                                                        09937000
IDCSAGS0 EQU   0                                                        09938000
IDCSAID0 EQU   0                                                        09939000
IDCSALC0 EQU   0                                                        09940000
IDCSALD0 EQU   0                                                        09941000
IDCSALK0 EQU   0                                                        09942000
IDCSAPR0 EQU   0                                                        09943000
IDCSAPT0 EQU   0                                                        09944000
IDCSAQL0 EQU   0                                                        09945000
IDCSARC0 EQU   0                                                        09946000
IDCSARV0 EQU   0                                                        09947000
IDCSASC0 EQU   0                                                        09948000
IDCSASN0 EQU   0                                                        09949000
IDCSAST0 EQU   0                                                        09950000
IDCSATI0 EQU   0                                                        09951000
IDCSAUC0 EQU   0                                                        09952000
IDCSAWO0 EQU   0                                                        09953000
IDCST010 EQU   0                                                        09954000
IDCTPER0 EQU   0                                                        09955000
LISTTEST EQU   0                                                        09956000
NEWERID1 EQU   5                                                        09957000
NLIST    EQU   0                                                        09958000
RECAT    EQU   0                                                        09959000
SCR      EQU   0                                                        09960000
GDTTBL   EQU   0                                                        09961000
GDTTR1   EQU   GDTTBL+8                                                 09962000
GDTTR2   EQU   GDTTBL+12                                                09963000
GDTDBG   EQU   GDTTBL+40                                                09964000
GDTSTC   EQU   GDTTBL+44                                                09965000
GDTPRT   EQU   GDTTBL+48                                                09966000
GDTESS   EQU   GDTTBL+52                                                09967000
GDTESA   EQU   GDTTBL+56                                                09968000
GDTRST   EQU   GDTTBL+60                                                09969000
GDTRES   EQU   GDTTBL+64                                                09970000
GDTCAL   EQU   GDTTBL+68                                                09971000
GDTGSP   EQU   GDTTBL+72                                                09972000
GDTFSP   EQU   GDTTBL+76                                                09973000
GDTGPL   EQU   GDTTBL+80                                                09974000
GDTFPL   EQU   GDTTBL+84                                                09975000
GDTLOD   EQU   GDTTBL+88                                                09976000
GDTDEL   EQU   GDTTBL+92                                                09977000
GDTPRL   EQU   GDTTBL+96                                                09978000
GDTEPL   EQU   GDTTBL+100                                               09979000
GDTTIM   EQU   GDTTBL+104                                               09980000
GDTIIO   EQU   GDTTBL+108                                               09981000
GDTTIO   EQU   GDTTBL+112                                               09982000
GDTOPN   EQU   GDTTBL+124                                               09983000
GDTCLS   EQU   GDTTBL+128                                               09984000
GDTGET   EQU   GDTTBL+132                                               09985000
GDTPUT   EQU   GDTTBL+136                                               09986000
GDTPOS   EQU   GDTTBL+140                                               09987000
GDTCPY   EQU   GDTTBL+144                                               09988000
GDTCAT   EQU   GDTTBL+148                                               09989000
GDTSNP   EQU   GDTTBL+164                                               09990000
GDTVFY   EQU   GDTTBL+172                                               09991000
GDTUID   EQU   GDTTBL+192                                               09992000
GDTPMT   EQU   GDTTBL+196                                               09993000
GDTCIR   EQU   GDTTBL+200                                               09994000
GDTLNK   EQU   GDTTBL+204                                               09995000
GDTALC   EQU   GDTTBL+208                                               09996000
GDTDLC   EQU   GDTTBL+212                                               09997000
GDTQAL   EQU   GDTTBL+216                                               09998000
GDTSTW   EQU   GDTTBL+220                                               09999000
GDTSSC   EQU   GDTTBL+224                                               10000000
GDTENQ   EQU   GDTTBL+228                                               10001000
GDTRSV   EQU   GDTTBL+232                                               10002000
GDTDEQ   EQU   GDTTBL+236                                               10003000
GDTSFO   EQU   GDTTBL+240                                               10004000
GDTWTO   EQU   GDTTBL+244                                               10005000
GDTSCR   EQU   GDTTBL+248                                               10006000
GDTUNT   EQU   GDTTBL+252                                               10007000
GDTRCT   EQU   GDTTBL+256                                               10008000
GDTIFO   EQU   GDTTBL+260                                               10009000
GDTEXP   EQU   GDTTBL+264                                               10010000
GDTSTA   EQU   GDTTBL+268                                               10011000
GDTERR   EQU   GDTTBL+272                                               10012000
GDTUNC   EQU   GDTTBL+276                                               10013000
GDTLOC   EQU   GDTTBL+280                                               10014000
FDTTBL   EQU   0                                                        10015000
FDTPTR   EQU   FDTTBL+8                                                 10016000
LASTCOND EQU   0                                                        10017000
SSRCODE  EQU   0                                                        10018000
SSRHALF  EQU   SSRCODE+2                                                10019000
SSECBCD  EQU   0                                                        10020000
@NM00109 EQU   CTGDDNM                                                  10021000
CTGPROB  EQU   @NM00109                                                 10022000
CTGREASN EQU   CTGPROB+2                                                10023000
*                                      START UNREFERENCED COMPONENTS    10024000
CTGREAS2 EQU   CTGREASN+1                                               10025000
CTGREAS1 EQU   CTGREASN                                                 10026000
CTGMODID EQU   CTGPROB                                                  10027000
@NM00126 EQU   SSRCODE                                                  10028000
FDTVERB  EQU   FDTTBL                                                   10029000
GDTECT   EQU   GDTTBL+188                                               10030000
GDTPSB   EQU   GDTTBL+184                                               10031000
GDTUPT   EQU   GDTTBL+180                                               10032000
GDTCMB   EQU   GDTTBL+176                                               10033000
GDTSPR   EQU   GDTTBL+168                                               10034000
@NM00001 EQU   GDTTBL+160                                               10035000
GDTABH   EQU   GDTTBL+156                                               10036000
GDTABT   EQU   GDTTBL+152                                               10037000
GDTTOH   EQU   GDTTBL+120                                               10038000
GDTRIP   EQU   GDTTBL+116                                               10039000
GDTIOH   EQU   GDTTBL+36                                                10040000
GDTSAH   EQU   GDTTBL+32                                                10041000
GDTTPH   EQU   GDTTBL+28                                                10042000
GDTRIH   EQU   GDTTBL+24                                                10043000
GDTSTH   EQU   GDTTBL+20                                                10044000
GDTDBH   EQU   GDTTBL+16                                                10045000
GDTPRM   EQU   GDTTBL+4                                                 10046000
GDTHDR   EQU   GDTTBL                                                   10047000
@NM00117 EQU   COVCE+39                                                 10048000
@NM00116 EQU   COVFLAGB+3                                               10049000
@NM00115 EQU   COVTYPE                                                  10050000
COVREUSE EQU   COVTYPE                                                  10051000
COVSAM   EQU   COVTYPE                                                  10052000
@NM00114 EQU   COVRECFL                                                 10053000
COVLAMIS EQU   COVRECFL                                                 10054000
COVCREAT EQU   COVRECFL                                                 10055000
@NM00113 EQU   COVSETFL                                                 10056000
COVCRCVY EQU   COVSETFL                                                 10057000
@NM00112 EQU   COVFLAGA                                                 10058000
COVSPDES EQU   COVFLAGA                                                 10059000
COVDESCR EQU   COVCE+4                                                  10060000
CVOLRES2 EQU   CVOLLST+34                                               10061000
CVOLCSN  EQU   CVOLLST+20                                               10062000
CVOLECB  EQU   CVOLLST+16                                               10063000
CVOLASID EQU   CVOLLST+14                                               10064000
@NM00111 EQU   CVOLFLG                                                  10065000
CVOCRCRV EQU   CVOLFLG                                                  10066000
CVOCRCR  EQU   CVOLFLG                                                  10067000
CVOLRES1 EQU   CVOLLST+5                                                10068000
CVOLOPCD EQU   CVOLLST+4                                                10069000
CVOLLEN  EQU   CVOLLST                                                  10070000
CTGFLDWA EQU   CTGFL+4                                                  10071000
CTGFLDTS EQU   CTGFLDRE                                                 10072000
@NM00110 EQU   CTGFLDRE                                                 10073000
CTGFLDGC EQU   CTGFL+2                                                  10074000
CTGPSWD  EQU   CTGJSCB                                                  10075000
@NM00108 EQU   CTGFBFLG                                                 10076000
CTGNGDSN EQU   CTGFBFLG                                                 10077000
CTGGDGB  EQU   CTGFBFLG                                                 10078000
CTGKEEP  EQU   CTGFBFLG                                                 10079000
CTGPAR   EQU   CTGFBFLG                                                 10080000
CTGTYPE  EQU   CTGPL+18                                                 10081000
@NM00107 EQU   CTGDSORG                                                 10082000
CTGWKA   EQU   CTGPL+12                                                 10083000
CTGCVOL  EQU   CTGCAT                                                   10084000
CTGFVT   EQU   CTGENT                                                   10085000
@NM00106 EQU   CTGOPTN4                                                 10086000
CTGBYPMT EQU   CTGOPTN4                                                 10087000
@NM00105 EQU   CTGOPTN4                                                 10088000
CTGDOCAT EQU   CTGOPTN4                                                 10089000
CTGLBASE EQU   CTGOPTN4                                                 10090000
CTGNUM   EQU   CTGOPTN3                                                 10091000
CTGSRH   EQU   CTGOPTN3                                                 10092000
CTGGDGL  EQU   CTGOPTN3                                                 10093000
CTGSUPLT EQU   CTGOPTN3                                                 10094000
@NM00104 EQU   CTGOPTN2                                                 10095000
CTGSCR   EQU   CTGOPTN2                                                 10096000
CTGOVRID EQU   CTGOPTN2                                                 10097000
CTGDISC  EQU   CTGOPTN2                                                 10098000
CTGGTNXT EQU   CTGOPTN2                                                 10099000
CTGRCATN EQU   CTGVMNT                                                  10100000
CTGGTALL EQU   CTGREL                                                   10101000
CTGNSVS  EQU   CTGEXT                                                   10102000
CTGGENLD EQU   CTGOPTN1                                                 10103000
CTGREAD  EQU   CTGOPTN1                                                 10104000
CTGUPD   EQU   CTGOPTN1                                                 10105000
CTGCI    EQU   CTGOPTN1                                                 10106000
CTGMAST  EQU   CTGOPTN1                                                 10107000
CTGBYPSS EQU   CTGOPTN1                                                 10108000
@NM00103 EQU   MVR+82                                                   10109000
MVRLABEL EQU   MVR+76                                                   10110000
MVRBLNK1 EQU   MVR+75                                                   10111000
MVRBKUPN EQU   MVR+74                                                   10112000
MVRCSN   EQU   MVR+62                                                   10113000
MVRTO    EQU   MVR+58                                                   10114000
MVRDES   EQU   MVR+28                                                   10115000
MVRGROUP EQU   MVR+20                                                   10116000
MVRFOR   EQU   MVR+18                                                   10117000
@NM00102 EQU   MVRFLAGA+2                                               10118000
MVRCIVCF EQU   MVRFLAGA+2                                               10119000
MVRCLMIS EQU   MVRFLAGA+1                                               10120000
MVRSLMIS EQU   MVRFLAGA+1                                               10121000
MVRNEXPD EQU   MVRFLAGA+1                                               10122000
MVRNDESC EQU   MVRFLAGA+1                                               10123000
MVRBKUP  EQU   MVRFLAGA+1                                               10124000
MVRNGRP  EQU   MVRFLAGA+1                                               10125000
MVRRSTD  EQU   MVRFLAGA+1                                               10126000
MVRGEN   EQU   MVRFLAGA+1                                               10127000
MVRFLLAB EQU   MVRFLAGA                                                 10128000
MVRFLBK  EQU   MVRFLAGA                                                 10129000
MVRFLCSN EQU   MVRFLAGA                                                 10130000
MVRFLTO  EQU   MVRFLAGA                                                 10131000
MVRFLDES EQU   MVRFLAGA                                                 10132000
MVRFLGRO EQU   MVRFLAGA                                                 10133000
MVRFLFOR EQU   MVRFLAGA                                                 10134000
@NM00101 EQU   MVRCODE+1                                                10135000
@NM00100 EQU   BASEV+192                                                10136000
BASXPDT2 EQU   BASEV+188                                                10137000
BASGROUP EQU   BASEV+180                                                10138000
BASRECOV EQU   BASEV+174                                                10139000
BASDEST  EQU   BASEV+144                                                10140000
BASDESCR EQU   BASEV+104                                                10141000
BASDTREM EQU   BASEV+100                                                10142000
BASEXPDT EQU   BASEV+96                                                 10143000
BASDLMTD EQU   BASEV+92                                                 10144000
BASRES6  EQU   BASEV+89                                                 10145000
BASCOPNO EQU   BASCOPID+1                                               10146000
BASCOPBK EQU   BASCOPID                                                 10147000
BASCOPSN EQU   BASKLCPY+5                                               10148000
BASCOPV  EQU   BASKLCPY                                                 10149000
BASFREXT EQU   BASEV+72                                                 10150000
BASLEXT  EQU   BASEV+70                                                 10151000
BASFRESP EQU   BASEV+68                                                 10152000
@NM00099 EQU   BASEV+65                                                 10153000
BASBKLMT EQU   BASEV+64                                                 10154000
BASNBKUP EQU   BASEV+63                                                 10155000
BASNCOPY EQU   BASEV+62                                                 10156000
BASNEXTV EQU   BASEV+56                                                 10157000
BASPREV  EQU   BASEV+50                                                 10158000
BAS2BIT2 EQU   BASLID2                                                  10159000
BAS2BIT1 EQU   BASLID2                                                  10160000
BASRES5  EQU   BASLIB2                                                  10161000
BASCSN2  EQU   BASEV+37                                                 10162000
BAS1BIT2 EQU   BASLID1                                                  10163000
BAS1BIT1 EQU   BASLID1                                                  10164000
BASRES4  EQU   BASLIB1                                                  10165000
BASCSN1  EQU   BASEV+24                                                 10166000
BASRES3  EQU   BASMISCF                                                 10167000
BASHOLD  EQU   BASMISCF                                                 10168000
BASRES8  EQU   BASSATIA                                                 10169000
BASCPUID EQU   BASEV+18                                                 10170000
@NM00098 EQU   BASFLAGA+3                                               10171000
BASLAST  EQU   BASFLAGA+3                                               10172000
BASFIRST EQU   BASFLAGA+3                                               10173000
BASREASS EQU   BASFLAGA+3                                               10174000
BASRONLY EQU   BASFLAGA+3                                               10175000
BASDAERA EQU   BASFLAGA+3                                               10176000
BASEXCL  EQU   BASFLAGA+2                                               10177000
BASBIND  EQU   BASFLAGA+2                                               10178000
BASRSTD  EQU   BASFLAGA+2                                               10179000
BASGENUS EQU   BASFLAGA+2                                               10180000
BASGRPV  EQU   BASFLAGA+2                                               10181000
BASNOCPY EQU   BASFLAGA+2                                               10182000
BASDLSF  EQU   BASFLAGA+2                                               10183000
BASRES2  EQU   BASTYPE                                                  10184000
BASBASVR EQU   BASTYPE                                                  10185000
BASRES1  EQU   BASTYPE                                                  10186000
BASRES7  EQU   BASEV+13                                                 10187000
BASZERO  EQU   BASID+1                                                  10188000
BASBLANK EQU   BASID                                                    10189000
BASSERNO EQU   BASNAME+5                                                10190000
BASEVKEY EQU   BASNAME                                                  10191000
@NM00097 EQU   RVVI+64                                                  10192000
RVVSDUP  EQU   RVVSPEC                                                  10193000
RVVSCPY  EQU   RVVSPEC                                                  10194000
RVVSCSN  EQU   RVVSPEC                                                  10195000
RVVSSEQ  EQU   RVVSPEC                                                  10196000
RVVSDTE  EQU   RVVSPEC                                                  10197000
RVVSEXP  EQU   RVVSPEC                                                  10198000
RVVSGRP  EQU   RVVSPEC                                                  10199000
@NM00096 EQU   RVVCPYTP                                                 10200000
RVVCPLHD EQU   RVVCPYTP                                                 10201000
RVVLCOPY EQU   RVVCPYTP                                                 10202000
RVVOBKUP EQU   RVVCPYTP                                                 10203000
RVVLBKUP EQU   RVVCPYTP                                                 10204000
RVVBPLHD EQU   RVVRTEST                                                 10205000
RVVDVOL  EQU   RVVRTEST                                                 10206000
RVVACTV  EQU   RVVRTEST                                                 10207000
RVVINACT EQU   RVVRTEST                                                 10208000
RVVRSTD  EQU   RVVRTEST                                                 10209000
RVVGSVOL EQU   RVVRTEST                                                 10210000
RVVTHOLD EQU   RVVRTEST                                                 10211000
RVVEXPDT EQU   RVVRTEST                                                 10212000
RVVALL   EQU   RVVRDRCD                                                 10213000
RVVCPURC EQU   RVVRDRCD                                                 10214000
RVVCIRCD EQU   RVVRDRCD                                                 10215000
RVVRUNKN EQU   RVVRDRCD                                                 10216000
RVVDUPRC EQU   RVVRDRCD                                                 10217000
RVVCPYRC EQU   RVVRDRCD                                                 10218000
RVVGRPRC EQU   RVVRDRCD                                                 10219000
@NM00095 EQU   RVVCHAIN                                                 10220000
RVVNGVOL EQU   RVVCHAIN                                                 10221000
RVVGPVOL EQU   RVVCHAIN                                                 10222000
@NM00094 EQU   RVVRMODE                                                 10223000
RVVRDCH  EQU   RVVRMODE                                                 10224000
RVVRDNR  EQU   RVVRMODE                                                 10225000
RVVDUPID EQU   RVVI+57                                                  10226000
RVVCPYID EQU   RVVI+56                                                  10227000
RVVRDCSN EQU   RVVI+44                                                  10228000
RVVRDSEQ EQU   RVVI+43                                                  10229000
RVVBLNK1 EQU   RVVI+42                                                  10230000
RVVCDATE EQU   RVVI+38                                                  10231000
RVVEXPIR EQU   RVVI+36                                                  10232000
@NM00093 EQU   RVVI+28                                                  10233000
RVVAREA  EQU   RVVI+24                                                  10234000
RVVARLN  EQU   RVVI+22                                                  10235000
RVVGROUP EQU   RVVI+14                                                  10236000
@NM00092 EQU   RVVOPCOD+1                                               10237000
VSDDSN   EQU   VSDARRAY+4                                               10238000
VSDVOLCT EQU   VSDARRAY                                                 10239000
VSDFMT0  EQU   VSDBLOCK+8                                               10240000
VSDVTOCS EQU   VSDBLOCK+4                                               10241000
VSDELEM  EQU   VSDBLOCK                                                 10242000
VSDFREE  EQU   VSDUSAGE+24                                              10243000
VSDALLC  EQU   VSDUSAGE+19                                              10244000
VSDDSOR3 EQU   VSDDSORG+2                                               10245000
@NM00091 EQU   VSDDSORG                                                 10246000
VSDSCAL  EQU   VSDUSAGE+12                                              10247000
@NM00090 EQU   VSDUSEF                                                  10248000
VSDCALFR EQU   VSDUSEF                                                  10249000
@NM00089 EQU   VSDALLOC                                                 10250000
VSDABSTR EQU   VSDALLOC                                                 10251000
VSDABLK  EQU   VSDALLOC                                                 10252000
VSDATRK  EQU   VSDALLOC                                                 10253000
VSDACYL  EQU   VSDALLOC                                                 10254000
@NM00088 EQU   VSDDORG                                                  10255000
VSDOU    EQU   VSDDORG                                                  10256000
VSDOIS   EQU   VSDDORG                                                  10257000
VSDODA   EQU   VSDDORG                                                  10258000
VSDOUN   EQU   VSDDORG                                                  10259000
VSDOPS   EQU   VSDDORG                                                  10260000
VSDOPO   EQU   VSDDORG                                                  10261000
VSDEXTS  EQU   VSDUSAGE+8                                               10262000
VSDSECAL EQU   VSDUSAGE+4                                               10263000
VSDFTRK  EQU   VSDUSAGE+2                                               10264000
VSDTRKS  EQU   VSDUSAGE                                                 10265000
@NM00087 EQU   VSDSCR+5                                                 10266000
@NM00086 EQU   VSDSCRFL                                                 10267000
VSDVSAM  EQU   VSDSCRFL                                                 10268000
VSDCATLC EQU   VSDSCRFL                                                 10269000
VSDACBPT EQU   VSDSCR                                                   10270000
VSDPRTC  EQU   VSDSTAT+25                                               10271000
VSDCAT   EQU   VSDSTAT+22                                               10272000
VSDEXP   EQU   VSDSTAT+20                                               10273000
VSDCRE   EQU   VSDSTAT+18                                               10274000
@NM00085 EQU   VSDFLG2                                                  10275000
VSDERROR EQU   VSDFLG2                                                  10276000
VSDPROT  EQU   VSDFLG2                                                  10277000
VSDPWW   EQU   VSDFLG2                                                  10278000
VSDPWR   EQU   VSDFLG2                                                  10279000
@NM00084 EQU   VSDSFLG1                                                 10280000
VSDCVSAM EQU   VSDSFLG1                                                 10281000
VSDCATLG EQU   VSDSFLG1                                                 10282000
VSDVSAME EQU   VSDSFLG1                                                 10283000
VSDVSAMC EQU   VSDSFLG1                                                 10284000
VSDVTOCE EQU   VSDSFLG1                                                 10285000
VSDVTOCC EQU   VSDSFLG1                                                 10286000
VSDOWNER EQU   VSDSTAT+8                                                10287000
VSDEXPIR EQU   VSDSTAT+4                                                10288000
VSDCREAT EQU   VSDSTAT                                                  10289000
VSDFRCCL EQU   VSDVTOC+21                                               10290000
@NM00083 EQU   VSDVTOC+20                                               10291000
VSDFREXT EQU   VSDVTOC+16                                               10292000
@NM00082 EQU   VSDVTOC+15                                               10293000
VSDFRTRK EQU   VSDVTOC+11                                               10294000
@NM00081 EQU   VSDVTOC+10                                               10295000
VSDFRCYL EQU   VSDVTOC+6                                                10296000
@NM00080 EQU   VSDVTOC                                                  10297000
@NM00079 EQU   VS3FLAGS                                                 10298000
VS3SYSNM EQU   VS3FLAGS                                                 10299000
VS3UNCAT EQU   VS3FLAGS                                                 10300000
VS3SCR   EQU   VS3FLAGS                                                 10301000
VS3USAGE EQU   VS3FLAGS                                                 10302000
VS3STAT  EQU   VS3FLAGS                                                 10303000
VS3DD    EQU   VS3AGL+50                                                10304000
VS3VOL   EQU   VS3AGL+44                                                10305000
VS3POOL  EQU   VS3AGL+40                                                10306000
VS3DEV   EQU   VS3AGL+36                                                10307000
VS3UCBP  EQU   VS3AGL+32                                                10308000
VS3CREAT EQU   VS3AGL+28                                                10309000
VS3EXPIR EQU   VS3AGL+24                                                10310000
VS3AST   EQU   VS3AGL+22                                                10311000
VS3LEVLN EQU   VS3AGL+20                                                10312000
VS3LEVP  EQU   VS3AGL+16                                                10313000
VS3EXDSP EQU   VS3AGL+12                                                10314000
VS3LISTP EQU   VS3AGL+8                                                 10315000
VS3HEAD  EQU   VS3AGL                                                   10316000
@NM00078 EQU   DATESOPT                                                 10317000
DATDAYOP EQU   DATESOPT                                                 10318000
DATDTEOP EQU   DATESOPT                                                 10319000
DATSUB   EQU   DATESOPT                                                 10320000
DATADD   EQU   DATESOPT                                                 10321000
DATRETRN EQU   DATESAGL+16                                              10322000
DATDAYS  EQU   DATESAGL+12                                              10323000
DATDATE  EQU   DATESAGL+8                                               10324000
DATHEAD  EQU   DATESAGL                                                 10325000
@NM00077 EQU   SELFLAGS                                                 10326000
SELVOL   EQU   SELAGL+16                                                10327000
SELDDNP  EQU   SELAGL+12                                                10328000
SELUCBP  EQU   SELAGL+8                                                 10329000
SELHEAD  EQU   SELAGL                                                   10330000
@NM00076 EQU   UCTFLAGS                                                 10331000
UCTVSCAT EQU   UCTFLAGS                                                 10332000
UCTDD    EQU   UCTAGL+60                                                10333000
UCTVOLP  EQU   UCTAGL+56                                                10334000
UCTACBP  EQU   UCTAGL+52                                                10335000
UCTDSN   EQU   UCTAGL+8                                                 10336000
UCTHEAD  EQU   UCTAGL                                                   10337000
@NM00075 EQU   LCTFLAGS                                                 10338000
LCTVSCAT EQU   LCTFLAGS                                                 10339000
LCTOWNER EQU   LCTINFO+24                                               10340000
LCTEXPIR EQU   LCTINFO+20                                               10341000
LCTCREAT EQU   LCTINFO+16                                               10342000
LCTACBP  EQU   LCTINFO+12                                               10343000
LCTMULVC EQU   LCTINFO+8                                                10344000
LCTHEAD  EQU   LCTINFO                                                  10345000
SRTWORKP EQU   SRTAGL+28                                                10346000
SRTFLDLN EQU   SRTAGL+24                                                10347000
SRTPOSIT EQU   SRTAGL+20                                                10348000
SRTLEN   EQU   SRTAGL+16                                                10349000
SRTNUM   EQU   SRTAGL+12                                                10350000
SRTADDR  EQU   SRTAGL+8                                                 10351000
SRTHEAD  EQU   SRTAGL                                                   10352000
SV82DEBP EQU   SV82WRKP                                                 10353000
SV82TTRP EQU   SV82LIST+8                                               10354000
SV82VOLP EQU   SV82DCBP                                                 10355000
SV82UCBP EQU   SV82LIST+1                                               10356000
SV82CODE EQU   SV82LIST                                                 10357000
VOLRESV3 EQU   VOLLABEL+55                                              10358000
VOLOWNER EQU   VOLLABEL+45                                              10359000
VOLRESV1 EQU   VOLLABEL+20                                              10360000
VOLVTOC  EQU   VOLLABEL+15                                              10361000
VOLSECTY EQU   VOLLABEL+14                                              10362000
VOLSERNO EQU   VOLLABEL+8                                               10363000
VOLNO    EQU   VOLLABEL+7                                               10364000
VOLLABI  EQU   VOLLABEL+4                                               10365000
VOLKEY   EQU   VOLLABEL                                                 10366000
STAVTTR  EQU   STAEPARM+54                                              10367000
@NM00072 EQU   STARETRY                                                 10368000
STAVTOC  EQU   STARETRY                                                 10369000
STAOFF   EQU   STARETRY                                                 10370000
STAIO05  EQU   STARETRY                                                 10371000
@NM00071 EQU   STARCVY                                                  10372000
STACLEAR EQU   STARCVY                                                  10373000
STAVPOST EQU   STARCVY                                                  10374000
STAVENQ  EQU   STARCVY                                                  10375000
STAVDMNT EQU   STARCVY                                                  10376000
STAVMNT  EQU   STARCVY                                                  10377000
STATCB   EQU   STAEPARM+48                                              10378000
STARTADD EQU   STAEPARM+44                                              10379000
STAEXSAV EQU   STAEPARM+40                                              10380000
STARTSAV EQU   STAEPARM+36                                              10381000
STARTTR  EQU   STAEPARM+32                                              10382000
@NM00070 EQU   STAEPARM+30                                              10383000
STARVOL  EQU   STAEPARM+24                                              10384000
STARUCB  EQU   STAEPARM+20                                              10385000
@NM00069 EQU   STAEPARM+18                                              10386000
STAVVOL  EQU   STAEPARM+12                                              10387000
STAVUCB  EQU   STAEPARM+8                                               10388000
STAHEAD  EQU   STAEPARM                                                 10389000
RCTDSET  EQU   RCTAGL+32                                                10390000
RCTNVOL  EQU   RCTAGL+26                                                10391000
RCTOVOL  EQU   RCTAGL+20                                                10392000
RCTNDEV  EQU   RCTAGL+16                                                10393000
RCTODEV  EQU   RCTAGL+12                                                10394000
@NM00068 EQU   RCTAGL+10                                                10395000
@NM00067 EQU   RCTOPT                                                   10396000
RCTVOL   EQU   RCTOPT                                                   10397000
RCTDEV   EQU   RCTOPT                                                   10398000
RCTHEAD  EQU   RCTAGL                                                   10399000
@NM00066 EQU   VSRESOPT                                                 10400000
@NM00065 EQU   VSMSG                                                    10401000
@NM00064 EQU   VSRETURN                                                 10402000
@NM00063 EQU   VSCATOPT                                                 10403000
@NM00062 EQU   VSVTOPT                                                  10404000
VSVSFLAG EQU   VSVTOPT                                                  10405000
VSWRITE  EQU   VSSECOPT                                                 10406000
VSMASTER EQU   VSSECOPT                                                 10407000
VSACBP   EQU   VS1AGL+36                                                10408000
VSHEAD   EQU   VS1AGL                                                   10409000
VSVTOCPT EQU   VS2AGL+48                                                10410000
@NM00061 EQU   VS2AGL+45                                                10411000
@NM00060 EQU   VS2RESOP                                                 10412000
VS2REAL  EQU   VS2RESOP                                                 10413000
VS2RES   EQU   VS2RESOP                                                 10414000
@NM00059 EQU   VS2MSG                                                   10415000
@NM00058 EQU   VSLABOPT                                                 10416000
VSNOVTOC EQU   VSLABOPT                                                 10417000
VSIOBKPT EQU   VS2AGL+24                                                10418000
VSVTOCSZ EQU   VS2AGL+12                                                10419000
VS2HEAD  EQU   VS2AGL                                                   10420000
EXPDATAL EQU   EXPARRAY+6                                               10421000
@NM00057 EQU   EXPARRAY+5                                               10422000
EXPKEYLN EQU   EXPARRAY+4                                               10423000
EXPDATAP EQU   EXPARRAY                                                 10424000
EXPRECNO EQU   EXPDATAB                                                 10425000
EXPCCHHR EQU   EXPARG+16                                                10426000
EXPCTLBK EQU   EXPARG+8                                                 10427000
EXPHEAD  EQU   EXPARG                                                   10428000
EXRWFUN  EQU   EXWRARG+46                                               10429000
@NM00056 EQU   EXSPACE+8                                                10430000
@NM00055 EQU   EXSPACE+6                                                10431000
@NM00054 EQU   EXSPACE+4                                                10432000
@NM00053 EQU   EXSPACE+1                                                10433000
@NM00052 EQU   EXSPACE                                                  10434000
EXRWKDLN EQU   EXWRARG+32                                               10435000
@NM00051 EQU   EXWRARG+31                                               10436000
EXRECNUM EQU   EXRWCHR+4                                                10437000
EXHH     EQU   EXRWCHR+2                                                10438000
EXCC     EQU   EXRWCHR                                                  10439000
EXCCWCNT EQU   EXWRARG+24                                               10440000
EXLOCPTR EQU   EXWRARG+20                                               10441000
EXRWDARE EQU   EXWRARG+16                                               10442000
EXRWIOAR EQU   EXWRARG+12                                               10443000
EXRWCTBL EQU   EXWRARG+8                                                10444000
EXRWRES  EQU   EXWRARG                                                  10445000
EXGDATAL EQU   EXGARG+30                                                10446000
@NM00050 EQU   EXGARG+29                                                10447000
EXGKEYLN EQU   EXGARG+28                                                10448000
EXGDATAP EQU   EXGARG+24                                                10449000
EXGRECNO EQU   EXGARG+20                                                10450000
EXGCCHH2 EQU   EXGARG+16                                                10451000
EXGCCHH1 EQU   EXGARG+12                                                10452000
EXGCTLBK EQU   EXGARG+8                                                 10453000
EXGHEAD  EQU   EXGARG                                                   10454000
EXOVTH   EQU   EXFLG                                                    10455000
EXORVT   EQU   EXFLG                                                    10456000
EXORDS   EQU   EXFLG                                                    10457000
EXOSPK   EQU   EXFLG                                                    10458000
EXORVS   EQU   EXFLG                                                    10459000
@NM00049 EQU   EXFLG                                                    10460000
EXOREAD  EQU   EXFLG                                                    10461000
@NM00048 EQU   EXOPT                                                    10462000
EXOREP   EQU   EXOPT                                                    10463000
EXOVTOC  EQU   EXOPT                                                    10464000
EXONEW   EQU   EXOPT                                                    10465000
EXOPASS  EQU   EXOPT                                                    10466000
EXOLAB   EQU   EXOPT                                                    10467000
EXOTAB   EQU   EXOPT                                                    10468000
EXOCTLBK EQU   EXOARG+28                                                10469000
EXOEXT   EQU   EXOARG+24                                                10470000
EXOUCB   EQU   EXOARG+20                                                10471000
EXOVSN   EQU   EXOARG+16                                                10472000
EXODSN   EQU   EXOARG+12                                                10473000
EXODDN   EQU   EXOARG+8                                                 10474000
EXOHEAD  EQU   EXOARG                                                   10475000
@NM00047 EQU   EXCLFLAG                                                 10476000
EXCLMNT  EQU   EXCLFLAG                                                 10477000
EXCLVOL  EQU   EXCLAGL+16                                               10478000
EXCLHEAD EQU   EXCLAGL                                                  10479000
@NM00046 EQU   CKFLAGS                                                  10480000
CKDMTABL EQU   CKFLAGS                                                  10481000
CKTESTVT EQU   CKFLAGS                                                  10482000
CKLABELP EQU   CKAGL+24                                                 10483000
CKHEAD   EQU   CKAGL                                                    10484000
PUHEAD   EQU   PUAGL                                                    10485000
MDR      EQU   MDVTOC+4                                                 10486000
MDHH     EQU   MDVTOC+2                                                 10487000
MDCC     EQU   MDVTOC                                                   10488000
@NM00045 EQU   MDAGL+31                                                 10489000
MDVTOCTR EQU   MDFLAGS                                                  10490000
MDFORCE  EQU   MDFLAGS                                                  10491000
MDDEQ    EQU   MDFLAGS                                                  10492000
MDENQ    EQU   MDFLAGS                                                  10493000
MDNEWVOL EQU   MDFLAGS                                                  10494000
MDHEAD   EQU   MDAGL                                                    10495000
CTTBLRR  EQU   CTARRAY+3                                                10496000
CTTBLHH  EQU   CTARRAY+2                                                10497000
CTTBLCC  EQU   CTARRAY+1                                                10498000
CTTBLID  EQU   CTARRAY                                                  10499000
CTREALH  EQU   CTMSG+3                                                  10500000
CTREALCC EQU   CTMSG+1                                                  10501000
@NM00044 EQU   CTMSG                                                    10502000
CMCSN2   EQU   CMMSG+28                                                 10503000
CMCSN1   EQU   CMMSG+16                                                 10504000
CMNUMCRT EQU   CMMSG+15                                                 10505000
@NM00043 EQU   CMMSG+14                                                 10506000
CMNEWVOL EQU   CMMSG+8                                                  10507000
@NM00042 EQU   CMMSG+7                                                  10508000
@NM00041 EQU   CMVOLFLG                                                 10509000
CMRONLY  EQU   CMVOLFLG                                                 10510000
CMBIND   EQU   CMVOLFLG                                                 10511000
CMSCRCRT EQU   CMVOLFLG                                                 10512000
CMEXCL   EQU   CMVOLFLG                                                 10513000
CMDERAS  EQU   CMVOLFLG                                                 10514000
CMSCRVOL EQU   CMVOLFLG                                                 10515000
CMCECART EQU   CMVOLFLG                                                 10516000
CMOLDVOL EQU   CMMSG                                                    10517000
CCOLDCSN EQU   CCMSG+24                                                 10518000
CCNEWCSN EQU   CCMSG+12                                                 10519000
@NM00040 EQU   CCMSG+10                                                 10520000
CCVOL    EQU   CCMSG+4                                                  10521000
@NM00039 EQU   CCMSG+2                                                  10522000
CCEJCODE EQU   CCMSG+1                                                  10523000
CCPSTCDE EQU   CCMSG                                                    10524000
PFILEVAL EQU   @NM00038+1                                               10525000
PFILELEN EQU   @NM00038                                                 10526000
PFILECNT EQU   PFILE                                                    10527000
CATDDLEN EQU   CATDD                                                    10528000
CATNLEN  EQU   CATN+20                                                  10529000
CATNMEM  EQU   CATN+12                                                  10530000
CATNMLN  EQU   CATN+11                                                  10531000
CATNFUQ  EQU   CATNFLG                                                  10532000
CATNPOS  EQU   CATN+9                                                   10533000
CATNPLN  EQU   CATN                                                     10534000
TVOLLEN  EQU   TVOL                                                     10535000
TFILELEN EQU   TFILE                                                    10536000
FFILELEN EQU   FFILE                                                    10537000
@NM00037 EQU   DMPARY+15                                                10538000
DMPARYTP EQU   DMPARY+14                                                10539000
DMPARYEX EQU   DMPARY+12                                                10540000
DMPARYIC EQU   DMPARY+10                                                10541000
DMPARYSZ EQU   DMPARY+8                                                 10542000
DMPARYNM EQU   DMPARY                                                   10543000
@NM00036 EQU   DMPITM+15                                                10544000
DMPITMTP EQU   DMPITM+14                                                10545000
DMPITMLN EQU   DMPITM+12                                                10546000
DMPITMPT EQU   DMPITM+8                                                 10547000
DMPITMNM EQU   DMPITM                                                   10548000
@NM00035 EQU   ERCNVTAB+24                                              10549000
ERCPLPT  EQU   ERCNVTAB+20                                              10550000
ERCATRC  EQU   ERCNVTAB+16                                              10551000
ERDSNM   EQU   ERCNVTAB+12                                              10552000
@NM00034 EQU   ERCNVTAB+4                                               10553000
@NM00033 EQU   ERCNVTAB+3                                               10554000
@NM00032 EQU   EROSOPER                                                 10555000
EROSUCDX EQU   EROSOPER                                                 10556000
EROSCATL EQU   EROSOPER                                                 10557000
@NM00031 EQU   EROPER                                                   10558000
ERCATAL  EQU   EROPER                                                   10559000
ERCATDL  EQU   EROPER                                                   10560000
ERCATDE  EQU   EROPER                                                   10561000
ERCATLC  EQU   EROPER                                                   10562000
@NM00030 EQU   ERTYPE                                                   10563000
EROSCAT  EQU   ERTYPE                                                   10564000
ERCATLG  EQU   ERTYPE                                                   10565000
@NM00029 EQU   FMTCNVF+1                                                10566000
FMTAR    EQU   FMTCNVF+1                                                10567000
FMTBS    EQU   FMTCNVF+1                                                10568000
FMTSS    EQU   FMTCNVF+1                                                10569000
FMTAL    EQU   FMTCNVF+1                                                10570000
FMTZS    EQU   FMTCNVF+1                                                10571000
@NM00028 EQU   FMTCNVF                                                  10572000
FMTPU    EQU   FMTCNVF                                                  10573000
FMTBD    EQU   FMTCNVF                                                  10574000
FMTBHD   EQU   FMTCNVF                                                  10575000
FMTBHA   EQU   FMTCNVF                                                  10576000
FMTBH    EQU   FMTCNVF                                                  10577000
FMTOLEN  EQU   FMTLIST+8                                                10578000
FMTRIO   EQU   FMTOCOL                                                  10579000
FMTSPT   EQU   FMTSTO                                                   10580000
FMTSTL   EQU   FMTILEN                                                  10581000
@NM00027 EQU   FMTFLGS+1                                                10582000
FMTHDF   EQU   FMTFLGS                                                  10583000
FMTDFF   EQU   FMTFLGS                                                  10584000
FMTSTF   EQU   FMTFLGS                                                  10585000
FMTREPF  EQU   FMTFLGS                                                  10586000
FMTBDF   EQU   FMTFLGS                                                  10587000
FMTIDF   EQU   FMTFLGS                                                  10588000
FMTSCF   EQU   FMTFLGS                                                  10589000
FMTEOLF  EQU   FMTFLGS                                                  10590000
DARGPCT  EQU   DARGINL                                                  10591000
DARGREP  EQU   DARGINS                                                  10592000
@NM00026 EQU   DARGLIST+19                                              10593000
DARGIND  EQU   DARGLIST+18                                              10594000
UVOLVOL  EQU   UVOLENT+4                                                10595000
UVOLDEV  EQU   UVOLENT                                                  10596000
UVOLCNT  EQU   UVOLLIST                                                 10597000
@NM00025 EQU   IOINFOPT                                                 10598000
IOINFTMS EQU   IOINFOPT                                                 10599000
IOINFSUP EQU   IOINFOPT                                                 10600000
IOINFDSN EQU   IOINFOPT                                                 10601000
@NM00024 EQU   OPNAGL+43                                                10602000
@NM00023 EQU   OPNOPT2                                                  10603000
@NM00022 EQU   OPNOPT2                                                  10604000
OPNOPTAS EQU   OPNOPT2                                                  10605000
@NM00021 EQU   OPNDSO                                                   10606000
OPNDSOPO EQU   OPNDSO                                                   10607000
OPNDSOIS EQU   OPNDSO                                                   10608000
OPNDSOPS EQU   OPNDSO                                                   10609000
OPNKYL   EQU   OPNAGL+40                                                10610000
OPNBLK   EQU   OPNAGL+36                                                10611000
OPNREC   EQU   OPNAGL+32                                                10612000
OPNDEVIX EQU   OPNDEV+4                                                 10613000
OPNDEVDT EQU   OPNDEV                                                   10614000
OPNCBP   EQU   OPNAGL+20                                                10615000
OPNMODRP EQU   OPNMOD                                                   10616000
OPNMODUB EQU   OPNMOD                                                   10617000
OPNMODRS EQU   OPNMOD                                                   10618000
OPNMODAX EQU   OPNMOD                                                   10619000
OPNMODRR EQU   OPNMOD                                                   10620000
OPNMODAC EQU   OPNMOD                                                   10621000
OPNMODPD EQU   OPNMOD                                                   10622000
@NM00020 EQU   OPNTYP                                                   10623000
OPNTYPRV EQU   OPNTYP                                                   10624000
OPNTYPEX EQU   OPNTYP                                                   10625000
OPNTYPRA EQU   OPNTYP                                                   10626000
OPNTYPXM EQU   OPNTYP                                                   10627000
OPNTYPSO EQU   OPNTYP                                                   10628000
OPNTYPSI EQU   OPNTYP                                                   10629000
@NM00019 EQU   OPNRFM                                                   10630000
OPNRFMBK EQU   OPNRFM                                                   10631000
OPNRFMSF EQU   OPNRFM                                                   10632000
OPNRFMUN EQU   OPNRFM                                                   10633000
OPNRFMVR EQU   OPNRFM                                                   10634000
OPNRFMFX EQU   OPNRFM                                                   10635000
OPNOPTSK EQU   OPNOPT                                                   10636000
OPNOPTDR EQU   OPNOPT                                                   10637000
OPNOPTCR EQU   OPNOPT                                                   10638000
OPNOPTKS EQU   OPNOPT                                                   10639000
OPNOPTBK EQU   OPNOPT                                                   10640000
OPNOPTOT EQU   OPNOPT                                                   10641000
OPNOPTIN EQU   OPNOPT                                                   10642000
IOCEXT   EQU   IOCSTR+64                                                10643000
IOCREL   EQU   IOCSTR+60                                                10644000
IOCWORK  EQU   IOCSTR+56                                                10645000
IOCRRN   EQU   IOCSTR+52                                                10646000
IOCPNM   EQU   IOCNWM+2                                                 10647000
IOCPTL   EQU   IOCNWM                                                   10648000
IOCKYA   EQU   IOCMEM                                                   10649000
IOCVRC   EQU   IOCTTR                                                   10650000
IOCDSN   EQU   IOCSTR+32                                                10651000
IOCHURBA EQU   IOCSTR+28                                                10652000
IOCVOLSR EQU   IOCSTR+22                                                10653000
@NM00018 EQU   IOCMSG                                                   10654000
IOCMSGAE EQU   IOCMSG                                                   10655000
IOCMSGCE EQU   IOCMSG                                                   10656000
IOCMSGOE EQU   IOCMSG                                                   10657000
@NM00017 EQU   IOCMSG                                                   10658000
IOCCHPSY EQU   IOCCHP                                                   10659000
IOCCHPAS EQU   IOCCHP                                                   10660000
IOCCHPBK EQU   IOCCHP                                                   10661000
IOCCHPCR EQU   IOCCHP                                                   10662000
IOCCHPKS EQU   IOCCHP                                                   10663000
IOCCHPSK EQU   IOCCHP                                                   10664000
IOCCHPDR EQU   IOCCHP                                                   10665000
IOCCHPSQ EQU   IOCCHP                                                   10666000
@NM00016 EQU   IOCMAC2                                                  10667000
IOCMACPA EQU   IOCMAC2                                                  10668000
@NM00015 EQU   IOCMAC2                                                  10669000
IOCMACCP EQU   IOCMAC2                                                  10670000
IOCMACRR EQU   IOCMAC2                                                  10671000
IOCMACAS EQU   IOCMAC2                                                  10672000
IOCMACSK EQU   IOCMAC2                                                  10673000
@NM00014 EQU   IOCMAC                                                   10674000
IOCMACCC EQU   IOCMAC                                                   10675000
IOCMACDR EQU   IOCMAC                                                   10676000
IOCMACBK EQU   IOCMAC                                                   10677000
IOCMACCR EQU   IOCMAC                                                   10678000
IOCMACUP EQU   IOCMAC                                                   10679000
IOCMACOT EQU   IOCMAC                                                   10680000
IOCMACIN EQU   IOCMAC                                                   10681000
@NM00013 EQU   IOCRFM                                                   10682000
IOCRFMBK EQU   IOCRFM                                                   10683000
IOCRFMSF EQU   IOCRFM                                                   10684000
IOCRFMUN EQU   IOCRFM                                                   10685000
IOCRFMVR EQU   IOCRFM                                                   10686000
IOCRFMFX EQU   IOCRFM                                                   10687000
@NM00012 EQU   IOCDSO                                                   10688000
IOCDSOPO EQU   IOCDSO                                                   10689000
IOCDSOIS EQU   IOCDSO                                                   10690000
IOCDSOPS EQU   IOCDSO                                                   10691000
IOCDSOAM EQU   IOCDSO                                                   10692000
IOCRKP   EQU   IOCSTR+13                                                10693000
IOCKYL   EQU   IOCSTR+12                                                10694000
IOCTRN   EQU   IOCSTR+8                                                 10695000
IOCDLN   EQU   IOCSTR+4                                                 10696000
IOCDAD   EQU   IOCSTR                                                   10697000
@NM00011 EQU   UNITSTAT                                                 10698000
UNITISHR EQU   UNITSTAT                                                 10699000
UNITUA   EQU   @NM00010+1                                               10700000
UNITCHA  EQU   @NM00010                                                 10701000
UNITUCB  EQU   UNITABL                                                  10702000
ALLUNCNT EQU   ALLAGL+30                                                10703000
ALLVLCNT EQU   ALLAGL+29                                                10704000
@NM00009 EQU   ALLOPT                                                   10705000
ALLOPTUN EQU   ALLOPT                                                   10706000
ALLOPTPV EQU   ALLOPT                                                   10707000
ALLOPTDS EQU   ALLOPT                                                   10708000
ALLOPTVL EQU   ALLOPT                                                   10709000
@NM00008 EQU   ALLORG+1                                                 10710000
ALLORGVS EQU   ALLORG+1                                                 10711000
@NM00007 EQU   ALLORG+1                                                 10712000
ALLORGGS EQU   ALLORG+1                                                 10713000
ALLORGUN EQU   ALLORG                                                   10714000
ALLORGPO EQU   ALLORG                                                   10715000
ALLORGMQ EQU   ALLORG                                                   10716000
ALLORGCQ EQU   ALLORG                                                   10717000
ALLORGCX EQU   ALLORG                                                   10718000
ALLORGDA EQU   ALLORG                                                   10719000
ALLORGPS EQU   ALLORG                                                   10720000
ALLORGIS EQU   ALLORG                                                   10721000
ALLDSPUN EQU   ALLDSP                                                   10722000
ALLDSPCG EQU   ALLDSP                                                   10723000
ALLDSPDE EQU   ALLDSP                                                   10724000
ALLDSPKP EQU   ALLDSP                                                   10725000
@NM00006 EQU   ALLDSP                                                   10726000
ALLSTSOD EQU   ALLSTS                                                   10727000
ALLSTSMD EQU   ALLSTS                                                   10728000
ALLSTSNW EQU   ALLSTS                                                   10729000
ALLSTSSR EQU   ALLSTS                                                   10730000
@NM00005 EQU   ALLSTS                                                   10731000
ALLPWD   EQU   ALLAGL+20                                                10732000
ALLVLP   EQU   ALLAGL+16                                                10733000
ALLULP   EQU   ALLAGL+12                                                10734000
ALLDDN   EQU   ALLAGL+4                                                 10735000
ALLDSN   EQU   ALLAGL                                                   10736000
CIRPID   EQU   CIRAGL+28                                                10737000
CIRPWD   EQU   CIRAGL+24                                                10738000
CIRCAT   EQU   CIRAGL+20                                                10739000
CIRWKP   EQU   CIRAGL+16                                                10740000
CIRTLR   EQU   CIRAGL+12                                                10741000
CIRHDR   EQU   CIRAGL+8                                                 10742000
CIRTLN   EQU   CIRAGL+6                                                 10743000
CIRHLN   EQU   CIRAGL+4                                                 10744000
@NM00004 EQU   CIRAGL+1                                                 10745000
@NM00003 EQU   CIRTYPE                                                  10746000
CIRTYPAQ EQU   CIRTYPE                                                  10747000
CIRTYP1Q EQU   CIRTYPE                                                  10748000
NEWID1   EQU   TRACE1+95                                                10749000
CALLID   EQU   OLDERID1+90                                              10750000
@NM00002 EQU   OLDERID1                                                 10751000
*                                      END UNREFERENCED COMPONENTS      10752000
@RF00552 EQU   @RC00547                                                 10753000
@RC01043 EQU   @RC01041                                                 10754000
@RF01359 EQU   @RC01348                                                 10755000
@RF01987 EQU   @RC01972                                                 10756000
@PB00026 EQU   @EL00001                                                 10757000
@PB00025 EQU   @PB00026                                                 10758000
@PB00024 EQU   @PB00025                                                 10759000
@PB00023 EQU   @PB00024                                                 10760000
@PB00022 EQU   @PB00023                                                 10761000
@PB00021 EQU   @PB00022                                                 10762000
@PB00020 EQU   @PB00021                                                 10763000
@PB00019 EQU   @PB00020                                                 10764000
@PB00018 EQU   @PB00019                                                 10765000
@PB00017 EQU   @PB00018                                                 10766000
@PB00016 EQU   @PB00017                                                 10767000
@PB00015 EQU   @PB00016                                                 10768000
@PB00014 EQU   @PB00015                                                 10769000
@PB00013 EQU   @PB00014                                                 10770000
@PB00012 EQU   @PB00013                                                 10771000
@PB00011 EQU   @PB00012                                                 10772000
@PB00010 EQU   @PB00011                                                 10773000
@PB00009 EQU   @PB00010                                                 10774000
@PB00008 EQU   @PB00009                                                 10775000
@PB00007 EQU   @PB00008                                                 10776000
@PB00006 EQU   @PB00007                                                 10777000
@PB00005 EQU   @PB00006                                                 10778000
@PB00004 EQU   @PB00005                                                 10779000
@PB00003 EQU   @PB00004                                                 10780000
@PB00002 EQU   @PB00003                                                 10781000
@ENDDATA EQU   *                                                        10782000
         END   IDCCN01,(C'PLS2128',0603,76342)                          10783000
