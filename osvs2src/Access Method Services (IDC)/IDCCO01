         TITLE '*********** IDCCO01:  COPYV FUNCTION SUPPORT ROUTINE ***00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCO01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCO01   76.339'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @08,0                                               0002 00021000
@PSTART  LA    @10,4095(,@08)                                      0002 00022000
         LA    @12,4095(,@10)                                      0002 00023000
         USING @PSTART,@08                                         0002 00024000
         USING @PSTART+4095,@10                                    0002 00025000
         USING @PSTART+8190,@12                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @11,@01                                             0002 00029000
         USING @DATD,@11                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @11,8(,@13)                                         0002 00033000
         LR    @13,@11                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
*                                                            @Y30LB39*/ 00036000
*                                                                  0265 00037000
*   /*****************************************************************/ 00038000
*   /*                                                               */ 00039000
*   /*                                                       @Y30LB39*/ 00040000
*   /* THIS IS CENTRAL SECTION OF THE COPYV ROUTINE.         @Y30LB39*/ 00041000
*   /* IT PERFORMS INITIALIZATION AND TERMINATION            @Y30LB39*/ 00042000
*   /* FUNCTIONS AND ROUTES CONTROL TO SUB-PROCEDURES.       @Y30LB39*/ 00043000
*   /* THE EXIT FROM IDCCO01 OCCURS FROM HERE.               @Y30LB39*/ 00044000
*   /*                                                       @Y30LB39*/ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0265 00048000
*                                   /*                       @Y30LB39   00049000
*                                                            @Y30LB39*/ 00050000
*                                                                  0265 00051000
*   /*****************************************************************/ 00052000
*   /*                                                               */ 00053000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 00054000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 00055000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 00056000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 00057000
*   /*                                                       @Y30LB39*/ 00058000
*   /*                                                               */ 00059000
*   /*****************************************************************/ 00060000
*                                                                  0265 00061000
*                                   /*                       @Y30LB39*/ 00062000
*   OLDERID2=NEWERID2;                                             0265 00063000
         L     @09,@PC00001                                        0265 00064000
         L     @15,GDTTR2(,@09)                                    0265 00065000
         MVC   @TS00001(95),NEWERID2(@15)                          0265 00066000
         MVC   OLDERID2(95,@15),@TS00001                           0265 00067000
*   NEWID2='CO01';                  /*                       @Y30LB39   00068000
*                                                            @Y30LB39   00069000
*                                                            @Y30LB39*/ 00070000
*                                                                  0266 00071000
         MVC   NEWID2(4,@15),@CC01492                              0266 00072000
*   /*****************************************************************/ 00073000
*   /*                                                               */ 00074000
*   /*                                                       @Y30LB39*/ 00075000
*   /* DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA          @Y30LB39*/ 00076000
*   /* PRIOR TO SERVICING COPYV UTILITY REQUEST              @Y30LB39*/ 00077000
*   /*                                                       @Y30LB39*/ 00078000
*   /*                                                               */ 00079000
*   /*****************************************************************/ 00080000
*                                                                  0267 00081000
*                                   /*                       @Y30LB39*/ 00082000
*   IF GDTDBG=NULLPTR THEN                                         0267 00083000
         L     @09,GDTDBG(,@09)                                    0267 00084000
         LTR   @09,@09                                             0267 00085000
         BZ    @RT00267                                            0267 00086000
*     ;                                                            0268 00087000
*   ELSE                                                           0269 00088000
*     CALL IDCDB010(GDTTBL,'COBG'); /*                       @Y30LB39   00089000
*                                                            @Y30LB39*/ 00090000
*                                                                  0269 00091000
         L     @09,@PC00001                                        0269 00092000
         ST    @09,@AL00001                                        0269 00093000
         LA    @15,@CC01602                                        0269 00094000
         ST    @15,@AL00001+4                                      0269 00095000
         MVI   @AL00001+4,X'80'                                    0269 00096000
         L     @15,GDTDBG(,@09)                                    0269 00097000
         LA    @01,@AL00001                                        0269 00098000
         BALR  @14,@15                                             0269 00099000
*   /*****************************************************************/ 00100000
*   /*                                                               */ 00101000
*   /*                                                       @Y30LB39*/ 00102000
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB39*/ 00103000
*   /*                                                       @Y30LB39*/ 00104000
*   /*                                                               */ 00105000
*   /*****************************************************************/ 00106000
*                                                                  0270 00107000
*                                   /*                       @Y30LB39*/ 00108000
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB39*/ 00109000
@RT00267 LA    @09,PRINTTAB                                        0270 00110000
         ST    @09,DDSTRU                                          0270 00111000
*   PRINTTAB=''B;                   /*                       @Y30LB39   00112000
*                                                            @Y30LB39*/ 00113000
*                                                                  0271 00114000
         XC    PRINTTAB(44),PRINTTAB                               0271 00115000
*   /*****************************************************************/ 00116000
*   /*                                                               */ 00117000
*   /*                                                       @Y30LB39*/ 00118000
*   /* THE NEXT SECTION OF CODE ESTABLISHES ADDRESS-         @Y30LB39*/ 00119000
*   /* ABILITY TO THE VARIOUS ARGUMENT AND PARAMETER         @Y30LB39*/ 00120000
*   /* LISTS WHICH ARE USED BY IDCCO01 IN SERVICING          @Y30LB39*/ 00121000
*   /* THE COPYV FSR REQUEST.                                @Y30LB39*/ 00122000
*   /*                                                       @Y30LB39*/ 00123000
*   /*                                                               */ 00124000
*   /*****************************************************************/ 00125000
*                                                                  0272 00126000
*                                   /*                       @Y30LB39*/ 00127000
*   RFY                                                            0272 00128000
*     ALLAGL BASED(ADDR(ALLAGLBF)); /*                       @Y30LB39*/ 00129000
*   RFY                                                            0273 00130000
*     CKAGL BASED(ADDR(CKAGLBUF));  /*                       @Y30LB39*/ 00131000
*   RFY                                                            0274 00132000
*     VS1AGL BASED(ADDR(VS1AGLBF)); /*                       @Y30LB39*/ 00133000
*   RFY                                                            0275 00134000
*     MDAGL BASED(ADDR(MDAGLBUF));  /*                       @Y30LB39*/ 00135000
*   RFY                                                            0276 00136000
*     EXCLAGL BASED(ADDR(EXCLAGLB));/*                       @ZD00175*/ 00137000
*   DEFVEPTR=ADDR(DEFVEBUF);        /*                       @Y30LB39*/ 00138000
         LA    @09,DEFVEBUF                                        0277 00139000
         ST    @09,DEFVEPTR                                        0277 00140000
*   COVCEPTR=ADDR(COVCEBUF);        /*                       @Y30LB39*/ 00141000
         LA    @09,COVCEBUF                                        0278 00142000
         ST    @09,COVCEPTR                                        0278 00143000
*   MVRPTR=ADDR(MVRBUFR);           /*                       @Y30LB39*/ 00144000
         LA    @09,MVRBUFR                                         0279 00145000
         ST    @09,MVRPTR                                          0279 00146000
*   RVVIPTR=ADDR(RVVIBUFR);         /*                       @Y30LB39*/ 00147000
         LA    @09,RVVIBUFR                                        0280 00148000
         ST    @09,RVVIPTR                                         0280 00149000
*   DEFVPTR=ADDR(DEFLISTB);         /*                       @Y30LB39*/ 00150000
         LA    @09,DEFLISTB                                        0281 00151000
         ST    @09,DEFVPTR                                         0281 00152000
*   COVCPTR=ADDR(COVLISTB);         /*                       @Y30LB39*/ 00153000
         LA    @09,COVLISTB                                        0282 00154000
         ST    @09,COVCPTR                                         0282 00155000
*   BASEVPTR=ADDR(BASVOLBD);        /*                       @Y30LB39*/ 00156000
         LA    BASEVPTR,BASVOLBD                                   0283 00157000
*   COPYVPTR=ADDR(COPVOLBD);        /*                       @Y30LB39   00158000
*                                                            @Y30LB39*/ 00159000
*                                                                  0284 00160000
         LA    COPYVPTR,COPVOLBD                                   0284 00161000
*   /*****************************************************************/ 00162000
*   /*                                                               */ 00163000
*   /*                                                       @Y30LB39*/ 00164000
*   /* SET THE INTERNAL TABLE USED BY THIS MODULE            @Y30LB39*/ 00165000
*   /* TO ZEROES. ALL FLAGS ARE THEREBY INITIALIZED          @Y30LB39*/ 00166000
*   /* TO OFF.                                               @Y30LB39*/ 00167000
*   /*                                                       @Y30LB39*/ 00168000
*   /*                                                               */ 00169000
*   /*****************************************************************/ 00170000
*                                                                  0285 00171000
*                                   /*                       @Y30LB39*/ 00172000
*   COPYVTBL=''B;                   /*                       @Y30LB39*/ 00173000
         XC    COPYVTBL(54),COPYVTBL                               0285 00174000
*   COPYVTBC='COPYVTBL';            /*                       @Y30LB39   00175000
*                                                            @Y30LB39*/ 00176000
*                                                                  0286 00177000
         MVC   COPYVTBC(8),@CC01614                                0286 00178000
*   /*****************************************************************/ 00179000
*   /*                                                               */ 00180000
*   /*                                                       @Y30LB39*/ 00181000
*   /* SET UP KEYWORD PARAMETERS FOR UENQ MACRO              @Y30LB39*/ 00182000
*   /* TO ENQUEUE ON THE VOLUME SERIAL NUMBER                @Y30LB39*/ 00183000
*   /*                                                       @Y30LB39*/ 00184000
*   /*                                                               */ 00185000
*   /*****************************************************************/ 00186000
*                                                                  0287 00187000
*                                   /*                       @Y30LB39*/ 00188000
*   RNAMLNTH=LENGTH(RNAMCHAR);      /*                       @Y30LB39*/ 00189000
         MVI   RNAMLNTH,X'16'                                      0287 00190000
*   RNAMCHAR(1:6)=VOLVAL;           /*                       @Y30LB39*/ 00191000
         L     @09,@PC00001+4                                      0288 00192000
         L     @09,FDTPTR(,@09)                                    0288 00193000
         MVC   RNAMCHAR(6),VOLVAL(@09)                             0288 00194000
*   RNAMCHAR(7:22)='.VIRTUAL.ENQUEUE';/*                     @Y30LB39   00195000
*                                                            @Y30LB39*/ 00196000
*                                                                  0289 00197000
         MVC   RNAMCHAR+6(16),@CC01615                             0289 00198000
*   /*****************************************************************/ 00199000
*   /*                                                               */ 00200000
*   /*                                                       @Y30LB39*/ 00201000
*   /* ISSUE UENQ MACRO TO ENQUEUE ON THE VOLUME SERIAL      @Y30LB39*/ 00202000
*   /* NUMBER TO INSURE THAT THE VOLUME RECORD IS NOT        @Y30LB39*/ 00203000
*   /* UPDATED DURING COPYV PROCESSING.                      @Y30LB39*/ 00204000
*   /*                                                       @Y30LB39*/ 00205000
*   /*                                                               */ 00206000
*   /*****************************************************************/ 00207000
*                                                                  0290 00208000
*                                   /*                       @Y30LB39*/ 00209000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,'SYSZAMS ',MINORNAM);/*   @Y30LB39*/ 00210000
         MVC   @AL00001+4(12),@AL00290                             0290 00211000
         L     @09,@PC00001                                        0290 00212000
         ST    @09,@AL00001                                        0290 00213000
         LA    @07,MINORNAM                                        0290 00214000
         ST    @07,@AL00001+16                                     0290 00215000
         MVI   @AL00001+16,X'80'                                   0290 00216000
         L     @15,GDTENQ(,@09)                                    0290 00217000
         LA    @01,@AL00001                                        0290 00218000
         BALR  @14,@15                                             0290 00219000
*                                   /*                       @Y30LB39*/ 00220000
*                                                                  0291 00221000
*   /*****************************************************************/ 00222000
*   /*                                                               */ 00223000
*   /*                                                       @Y30LB39*/ 00224000
*   /* CALL SUBROUTINE FVOLRTN TO VERIFY THAT THE            @Y30LB39*/ 00225000
*   /* SOURCE VOLUME IS ACTIVE AND USABLE                    @Y30LB39*/ 00226000
*   /*                                                       @Y30LB39*/ 00227000
*   /*                                                               */ 00228000
*   /*****************************************************************/ 00229000
*                                                                  0291 00230000
*                                   /*                       @Y30LB39*/ 00231000
*   CALL FVOLRTN;                   /*                       @Y30LB39*/ 00232000
         BAL   @14,FVOLRTN                                         0291 00233000
*   RESPECIFY                                                      0292 00234000
*     RTNREG RSTD;                                                 0292 00235000
*   TESTRC=RTNREG;                                                 0293 00236000
         LR    TESTRC,RTNREG                                       0293 00237000
*   RESPECIFY                                                      0294 00238000
*     RTNREG UNRSTD;                /*                       @Y30LB39*/ 00239000
*   LASTCOND=TESTRC;                /*                       @Y30LB39   00240000
*                                                            @Y30LB39*/ 00241000
*                                                                  0295 00242000
         L     @09,@PC00001+8                                      0295 00243000
         STH   TESTRC,LASTCOND(,@09)                               0295 00244000
*   /*****************************************************************/ 00245000
*   /*                                                               */ 00246000
*   /*                                                       @Y30LB39*/ 00247000
*   /* DISCONTINUE PROCESSING AND PROCEED TO ISSUE           @Y30LB39*/ 00248000
*   /* DEQUEUE IF CONDITION CODE GREATER THAN EIGHT          @Y30LB39*/ 00249000
*   /*                                                       @Y30LB39*/ 00250000
*   /*                                                               */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0296 00253000
*                                   /*                       @Y30LB39*/ 00254000
*   IF LASTCOND^>LASTCC08 THEN      /*                       @Y30LB39*/ 00255000
         L     @09,@PC00001+8                                      0296 00256000
         LH    @09,LASTCOND(,@09)                                  0296 00257000
         C     @09,@CF00179                                        0296 00258000
         BH    @RF00296                                            0296 00259000
*     DO;                           /*                       @Y30LB39   00260000
*                                                            @Y30LB39*/ 00261000
*                                                                  0297 00262000
*       /*************************************************************/ 00263000
*       /*                                                           */ 00264000
*       /*                                                   @Y30LB39*/ 00265000
*       /* CALL SUBROUTINE TVOLRTN TO DIRECT THE SELECTION   @Y30LB39*/ 00266000
*       /* OF THE TARGET VOLUME                              @Y30LB39*/ 00267000
*       /*                                                   @Y30LB39*/ 00268000
*       /*                                                           */ 00269000
*       /*************************************************************/ 00270000
*                                                                  0298 00271000
*                                   /*                       @Y30LB39*/ 00272000
*       CALL TVOLRTN;               /*                       @Y30LB39*/ 00273000
         BAL   @14,TVOLRTN                                         0298 00274000
*       RESPECIFY                                                  0299 00275000
*         RTNREG RSTD;                                             0299 00276000
*       TESTRC=RTNREG;                                             0300 00277000
         LR    TESTRC,RTNREG                                       0300 00278000
*       RESPECIFY                                                  0301 00279000
*         RTNREG UNRSTD;            /*                       @Y30LB39*/ 00280000
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     @Y30LB39   00281000
*                                                            @Y30LB39*/ 00282000
*                                                                  0302 00283000
         L     @09,@PC00001+8                                      0302 00284000
         LH    @07,LASTCOND(,@09)                                  0302 00285000
         CR    @07,TESTRC                                          0302 00286000
         BNL   *+6                                                      00287000
         LR    @07,TESTRC                                          0302 00288000
         STH   @07,LASTCOND(,@09)                                  0302 00289000
*       /*************************************************************/ 00290000
*       /*                                                           */ 00291000
*       /*                                                   @Y30LB39*/ 00292000
*       /* DISCONTINUE PROCESSING AND PROCEED TO             @Y30LB39*/ 00293000
*       /* ISSUE DEQUEUE IF CONDITION CODE GREATER           @Y30LB39*/ 00294000
*       /* THAN EIGHT.                                       @Y30LB39*/ 00295000
*       /*                                                   @Y30LB39*/ 00296000
*       /*                                                           */ 00297000
*       /*************************************************************/ 00298000
*                                                                  0303 00299000
*                                   /*                       @Y30LB39*/ 00300000
*       IF LASTCOND^>LASTCC08 THEN  /*                       @Y30LB39*/ 00301000
         C     @07,@CF00179                                        0303 00302000
         BH    @RF00303                                            0303 00303000
*         DO;                       /*                       @Y30LB39   00304000
*                                                            @Y30LB39*/ 00305000
*                                                                  0304 00306000
*           /*********************************************************/ 00307000
*           /*                                                       */ 00308000
*           /*                                               @Y30LB39*/ 00309000
*           /* CALL FILERTN TO CHECK IF FILE IS SPECI-       @Y30LB39*/ 00310000
*           /* FIED AND WHETHER THE ALLOCATED UNIT IS        @Y30LB39*/ 00311000
*           /* VIRTUAL. IF FILE IS NOT SPECIFIED,            @ZD00175*/ 00312000
*           /* FILERTN WILL DYNAMICALLY ALLOCATE SUCH        @ZD00175*/ 00313000
*           /* A UNIT.                                       @ZD00175*/ 00314000
*           /*                                               @Y30LB39*/ 00315000
*           /*                                                       */ 00316000
*           /*********************************************************/ 00317000
*                                                                  0305 00318000
*                                   /*                       @Y30LB39*/ 00319000
*           CALL FILERTN;           /*                       @Y30LB39*/ 00320000
         BAL   @14,FILERTN                                         0305 00321000
*           RESPECIFY                                              0306 00322000
*             RTNREG RSTD;                                         0306 00323000
*           TESTRC=RTNREG;                                         0307 00324000
         LR    TESTRC,RTNREG                                       0307 00325000
*           RESPECIFY                                              0308 00326000
*             RTNREG UNRSTD;        /*                       @Y30LB39*/ 00327000
*           LASTCOND=MAX(LASTCOND,TESTRC);/*                 @Y30LB39*/ 00328000
         L     @09,@PC00001+8                                      0309 00329000
         LH    @07,LASTCOND(,@09)                                  0309 00330000
         CR    @07,TESTRC                                          0309 00331000
         BNL   *+6                                                      00332000
         LR    @07,TESTRC                                          0309 00333000
         STH   @07,LASTCOND(,@09)                                  0309 00334000
*           IF LASTCOND^>LASTCC08 THEN/*                     @Y30LB39*/ 00335000
         C     @07,@CF00179                                        0310 00336000
         BH    @RF00310                                            0310 00337000
*             DO;                   /*                       @Y30LB39   00338000
*                                                            @Y30LB39*/ 00339000
*                                                                  0311 00340000
*               /*****************************************************/ 00341000
*               /*                                                   */ 00342000
*               /*                                           @Y30LB39*/ 00343000
*               /* CALL VSRTN TO VERIFY PASSWORDS OF         @Y30LB39*/ 00344000
*               /* PROTECTED DATA SETS, TO UPDATE THE        @ZD00175*/ 00345000
*               /* VSAM TIMESTAMP AND TO CHANGE THE          @ZD00175*/ 00346000
*               /* THE ALLOCATION TO EXCLUSIVE.              @ZD00175*/ 00347000
*               /*                                           @Y30LB39*/ 00348000
*               /*                                                   */ 00349000
*               /*****************************************************/ 00350000
*                                                                  0312 00351000
*                                   /*                       @Y30LB39*/ 00352000
*               CALL VSRTN;         /*                       @Y30LB39*/ 00353000
         BAL   @14,VSRTN                                           0312 00354000
*               RESPECIFY                                          0313 00355000
*                 RTNREG RSTD;                                     0313 00356000
*               TESTRC=RTNREG;                                     0314 00357000
         LR    TESTRC,RTNREG                                       0314 00358000
*               RESPECIFY                                          0315 00359000
*                 RTNREG UNRSTD;    /*                       @Y30LB39*/ 00360000
*               LASTCOND=MAX(LASTCOND,TESTRC);/*             @Y30LB39*/ 00361000
         L     @09,@PC00001+8                                      0316 00362000
         LH    @07,LASTCOND(,@09)                                  0316 00363000
         CR    @07,TESTRC                                          0316 00364000
         BNL   *+6                                                      00365000
         LR    @07,TESTRC                                          0316 00366000
         STH   @07,LASTCOND(,@09)                                  0316 00367000
*               IF LASTCOND^>LASTCC08 THEN/*                 @Y30LB39*/ 00368000
         C     @07,@CF00179                                        0317 00369000
         BH    @RF00317                                            0317 00370000
*                 DO;               /*                       @Y30LB39   00371000
*                                                            @Y30LB39*/ 00372000
*                                                                  0318 00373000
*                   /*************************************************/ 00374000
*                   /*                                               */ 00375000
*                   /*                                       @Y30LB39*/ 00376000
*                   /* CALL WORKRTN TO DIRECT THE            @Y30LB39*/ 00377000
*                   /* CREATION OF A NEW TARGET VOLUME       @Y30LB39*/ 00378000
*                   /* PLUS THE COPY, RELABEL, AND           @Y30LB39*/ 00379000
*                   /* EJECT OPERATIONS.                     @Y30LB39*/ 00380000
*                   /*                                       @Y30LB39*/ 00381000
*                   /*                                               */ 00382000
*                   /*************************************************/ 00383000
*                                                                  0319 00384000
*                                   /*                       @Y30LB39*/ 00385000
*                   CALL WORKRTN;   /*                       @Y30LB39*/ 00386000
         BAL   @14,WORKRTN                                         0319 00387000
*                   RESPECIFY                                      0320 00388000
*                     RTNREG RSTD;                                 0320 00389000
*                   TESTRC=RTNREG;                                 0321 00390000
         LR    TESTRC,RTNREG                                       0321 00391000
*                   RESPECIFY                                      0322 00392000
*                     RTNREG UNRSTD;/*                       @Y30LB39*/ 00393000
*                   LASTCOND=MAX(LASTCOND,TESTRC);/*         @Y30LB39*/ 00394000
         L     @09,@PC00001+8                                      0323 00395000
         LH    @07,LASTCOND(,@09)                                  0323 00396000
         CR    @07,TESTRC                                          0323 00397000
         BNL   *+6                                                      00398000
         LR    @07,TESTRC                                          0323 00399000
         STH   @07,LASTCOND(,@09)                                  0323 00400000
*                 END;              /*                       @Y30LB39*/ 00401000
*             END;                  /*                       @Y30LB39*/ 00402000
@RF00317 DS    0H                                                  0326 00403000
*           IF LASTCOND^>LASTCC08 THEN/*                     @Y30LB39*/ 00404000
@RF00310 L     @09,@PC00001+8                                      0326 00405000
         LH    @09,LASTCOND(,@09)                                  0326 00406000
         C     @09,@CF00179                                        0326 00407000
         BH    @RF00326                                            0326 00408000
*             IF REUSEFLG=ON&ADDR(BKUP)^=NULLPTR THEN              0327 00409000
         TM    REUSEFLG,B'10000000'                                0327 00410000
         BNO   @RF00327                                            0327 00411000
         L     @09,@PC00001+4                                      0327 00412000
         L     @09,FDTPTR+4(,@09)                                  0327 00413000
         LTR   @09,@09                                             0327 00414000
         BZ    @RF00327                                            0327 00415000
*               DO;                 /*                       @Y30LB39   00416000
*                                                            @Y30LB39*/ 00417000
*                                                                  0328 00418000
*                 /***************************************************/ 00419000
*                 /*                                                 */ 00420000
*                 /*                                         @Y30LB39*/ 00421000
*                 /* CALL SCRRTN TO DETERMINE IF THE         @Y30LB39*/ 00422000
*                 /* BACKUP LIMIT HAS BEEN EXCEEDED.         @Y30LB39*/ 00423000
*                 /* IF THAT IS THE CASE, SCRATCH            @Y30LB39*/ 00424000
*                 /* THE OLDEST BACKUP COPIES.               @Y30LB39*/ 00425000
*                 /*                                         @Y30LB39*/ 00426000
*                 /*                                                 */ 00427000
*                 /***************************************************/ 00428000
*                                                                  0329 00429000
*                                   /*                       @Y30LB39*/ 00430000
*                 CALL SCRRTN;      /*                       @Y30LB39*/ 00431000
         BAL   @14,SCRRTN                                          0329 00432000
*                 RESPECIFY                                        0330 00433000
*                   RTNREG RSTD;                                   0330 00434000
*                 TESTRC=RTNREG;                                   0331 00435000
         LR    TESTRC,RTNREG                                       0331 00436000
*                 RESPECIFY                                        0332 00437000
*                   RTNREG UNRSTD;  /*                       @Y30LB39*/ 00438000
*                 LASTCOND=MAX(LASTCOND,TESTRC);/*           @Y30LB39*/ 00439000
         L     @09,@PC00001+8                                      0333 00440000
         LH    @02,LASTCOND(,@09)                                  0333 00441000
         CR    @02,TESTRC                                          0333 00442000
         BNL   *+6                                                      00443000
         LR    @02,TESTRC                                          0333 00444000
         STH   @02,LASTCOND(,@09)                                  0333 00445000
*               END;                /*                       @Y30LB39   00446000
*                                                            @Y30LB39*/ 00447000
*                                                                  0334 00448000
*           /*********************************************************/ 00449000
*           /*                                                       */ 00450000
*           /*                                               @Y30LB39*/ 00451000
*           /* CHECK TO SEE IF THE RETURN CODE               @Y30LB39*/ 00452000
*           /* TO THE EXECUTIVE SHOULD BE AT                 @Y30LB39*/ 00453000
*           /* LEAST FOUR.                                   @Y30LB39*/ 00454000
*           /*                                               @Y30LB39*/ 00455000
*           /*                                                       */ 00456000
*           /*********************************************************/ 00457000
*                                                                  0335 00458000
*                                   /*                       @Y30LB39*/ 00459000
*           IF LASTCOND=0&IOERRFLG=ON THEN/*                 @Y30LB39*/ 00460000
@RF00327 DS    0H                                                  0335 00461000
@RF00326 L     @09,@PC00001+8                                      0335 00462000
         LH    @15,LASTCOND(,@09)                                  0335 00463000
         LTR   @15,@15                                             0335 00464000
         BNZ   @RF00335                                            0335 00465000
         TM    IOERRFLG,B'10000000'                                0335 00466000
         BNO   @RF00335                                            0335 00467000
*             LASTCOND=LASTCC04;    /*                       @Y30LB39*/ 00468000
         MVC   LASTCOND(2,@09),@CH00042                            0336 00469000
*         END;                      /*                       @Y30LB39*/ 00470000
@RF00335 DS    0H                                                  0338 00471000
*     END;                          /*                       @Y30LB39*/ 00472000
@RF00303 DS    0H                                                  0339 00473000
*                                   /*                       @Y30LB39*/ 00474000
*                                                                  0339 00475000
*   /*****************************************************************/ 00476000
*   /*                                                               */ 00477000
*   /*                                                       @Y30LB39*/ 00478000
*   /* ISSUE DEQUEUE MACRO TO RELEASE ENQUEUE SET AT         @Y30LB39*/ 00479000
*   /* BEGINNING OF PROGRAM.                                 @Y30LB39*/ 00480000
*   /*                                                       @Y30LB39*/ 00481000
*   /*                                                               */ 00482000
*   /*****************************************************************/ 00483000
*                                                                  0339 00484000
*                                   /*                       @Y30LB39*/ 00485000
*   RNAMCHAR(7:22)='.VIRTUAL.ENQUEUE';/*                     @ZA05138*/ 00486000
@RF00296 MVC   RNAMCHAR+6(16),@CC01615                             0339 00487000
*   CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*             @Y30LB39   00488000
*                                                            @Y30LB39*/ 00489000
*                                                                  0340 00490000
         L     @09,@PC00001                                        0340 00491000
         ST    @09,@AL00001                                        0340 00492000
         LA    @15,@CC01617                                        0340 00493000
         ST    @15,@AL00001+4                                      0340 00494000
         LA    @15,MINORNAM                                        0340 00495000
         ST    @15,@AL00001+8                                      0340 00496000
         MVI   @AL00001+8,X'80'                                    0340 00497000
         L     @15,GDTDEQ(,@09)                                    0340 00498000
         LA    @01,@AL00001                                        0340 00499000
         BALR  @14,@15                                             0340 00500000
*   /*****************************************************************/ 00501000
*   /*                                                               */ 00502000
*   /*                                                       @Y30LB39*/ 00503000
*   /* ISSUE UPRINT TO PRINT THE APPROPRIATE                 @Y30LB39*/ 00504000
*   /* COMPLETION MESSAGE.                                   @Y30LB39*/ 00505000
*   /* MESSAGE IDC0003I IF CONDITION CODE GREATER            @Y30LB39*/ 00506000
*   /* THAN EIGHT                                            @Y30LB39*/ 00507000
*   /* MESSAGE IDC0001I IF CONDITION CODE LESS THAN          @Y30LB39*/ 00508000
*   /* TWELVE                                                @Y30LB39*/ 00509000
*   /*                                                       @Y30LB39*/ 00510000
*   /*                                                               */ 00511000
*   /*****************************************************************/ 00512000
*                                                                  0341 00513000
*                                   /*                       @Y30LB39*/ 00514000
*   DARGLIST=''B;                   /*                       @Y30LB39*/ 00515000
         L     @09,DDSTRU                                          0341 00516000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0341 00517000
*   IF LASTCOND>LASTCC08 THEN       /*                       @Y30LB39*/ 00518000
         L     @15,@PC00001+8                                      0342 00519000
         LH    @15,LASTCOND(,@15)                                  0342 00520000
         C     @15,@CF00179                                        0342 00521000
         BNH   @RF00342                                            0342 00522000
*     DARGSENT=MSG3003I;            /*                       @Y30LB39*/ 00523000
         MVI   DARGSENT(@09),X'03'                                 0343 00524000
*   ELSE                            /*                       @Y30LB39*/ 00525000
*     IF LASTCOND<LASTCC12 THEN     /*                       @Y30LB39*/ 00526000
         B     @RC00342                                            0344 00527000
@RF00342 L     @09,@PC00001+8                                      0344 00528000
         LH    @09,LASTCOND(,@09)                                  0344 00529000
         C     @09,@CF00567                                        0344 00530000
         BNL   @RF00344                                            0344 00531000
*       DARGSENT=MSG0001I;          /*                       @Y30LB39*/ 00532000
         L     @09,DDSTRU                                          0345 00533000
         MVI   DARGSENT(@09),X'01'                                 0345 00534000
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB39*/ 00535000
@RF00344 DS    0H                                                  0346 00536000
@RC00342 L     @09,DDSTRU                                          0346 00537000
         MVC   DARGSMOD(3,@09),@CC01552                            0346 00538000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB39*/ 00539000
         L     @15,@PC00001+8                                      0347 00540000
         ST    @15,DARGDBP(,@09)                                   0347 00541000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB39   00542000
*                                                            @Y30LB39*/ 00543000
         MVC   DARGILP(2,@09),@CH00153                             0348 00544000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB39   00545000
*                                                            @Y30LB39   00546000
*                                                            @Y30LB39*/ 00547000
*                                                                  0349 00548000
         L     @09,@PC00001                                        0349 00549000
         ST    @09,@AL00001                                        0349 00550000
         LA    @15,@CF00115                                        0349 00551000
         ST    @15,@AL00001+4                                      0349 00552000
         LA    @15,DDSTRU                                          0349 00553000
         ST    @15,@AL00001+8                                      0349 00554000
         MVI   @AL00001+8,X'80'                                    0349 00555000
         L     @15,GDTPRT(,@09)                                    0349 00556000
         LA    @01,@AL00001                                        0349 00557000
         BALR  @14,@15                                             0349 00558000
*   /*****************************************************************/ 00559000
*   /*                                                               */ 00560000
*   /*                                                       @Y30LB39*/ 00561000
*   /* DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA          @Y30LB39*/ 00562000
*   /* PRIOR TO RETURNING TO EXECUTIVE ROUTINE.              @Y30LB39*/ 00563000
*   /*                                                       @Y30LB39*/ 00564000
*   /*                                                               */ 00565000
*   /*****************************************************************/ 00566000
*                                                                  0350 00567000
*                                   /*                       @Y30LB39*/ 00568000
*   IF GDTDBG=NULLPTR THEN                                         0350 00569000
         L     @09,@PC00001                                        0350 00570000
         L     @09,GDTDBG(,@09)                                    0350 00571000
         LTR   @09,@09                                             0350 00572000
         BZ    @RT00350                                            0350 00573000
*     ;                                                            0351 00574000
*   ELSE                                                           0352 00575000
*     CALL IDCDB010(GDTTBL,'COND'); /*                       @Y30LB39   00576000
*                                                            @Y30LB39*/ 00577000
         L     @09,@PC00001                                        0352 00578000
         ST    @09,@AL00001                                        0352 00579000
         LA    @15,@CC01624                                        0352 00580000
         ST    @15,@AL00001+4                                      0352 00581000
         MVI   @AL00001+4,X'80'                                    0352 00582000
         L     @15,GDTDBG(,@09)                                    0352 00583000
         LA    @01,@AL00001                                        0352 00584000
         BALR  @14,@15                                             0352 00585000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0353 00586000
*                                                                  0353 00587000
@RT00350 L     @09,@PC00001                                        0353 00588000
         ST    @09,@AL00001                                        0353 00589000
         LA    @15,MODID                                           0353 00590000
         ST    @15,@AL00001+4                                      0353 00591000
         L     @15,@PC00001+8                                      0353 00592000
         ST    @15,@AL00001+8                                      0353 00593000
         MVI   @AL00001+8,X'80'                                    0353 00594000
         L     @15,GDTEPL(,@09)                                    0353 00595000
         LA    @01,@AL00001                                        0353 00596000
         BALR  @14,@15                                             0353 00597000
*   /*****************************************************************/ 00598000
*   /*                                                               */ 00599000
*   /*                                                       @Y30LB39*/ 00600000
*   /*                                                               */ 00601000
*   /*****************************************************************/ 00602000
*                                                                  0354 00603000
*                                                                  0354 00604000
*   /*****************************************************************/ 00605000
*   /*                                                               */ 00606000
*   /*                                                       @Y30LB39*/ 00607000
*   /* PROCEDURE NAME - FVOLRTN                              @Y30LB39*/ 00608000
*   /*                                                       @Y30LB39*/ 00609000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 00610000
*   /* CALL RVVIRTN SO THAT RVVIRTN CAN PROCEED TO           @Y30LB39*/ 00611000
*   /* RETRIEVE A BASE VOLUME RECORD PRIOR TO FURTHER        @Y30LB39*/ 00612000
*   /* PROCESSING BY COPYV FSR.                              @Y30LB39*/ 00613000
*   /* FVOLRTN MERELY REQUESTS THE RECORD BE                 @Y30LB39*/ 00614000
*   /* RETRIEVED AND THEN VERIFIES THAT THE VOLUME           @Y30LB39*/ 00615000
*   /* IS ACTIVE AND USUABLE BY TESTING DATA FROM            @Y30LB39*/ 00616000
*   /* THE RECORD.                                           @Y30LB39*/ 00617000
*   /* IF RECORD IS NOT RETRIEVED, A CODE OF                 @Y30LB39*/ 00618000
*   /* TWELVE IS SET. IF THE RECORD IS RETRIEVED,            @Y30LB39*/ 00619000
*   /* BUT THE VOLUME IS INACTIVE OR UNUSABLE BECAUSE        @Y30LB39*/ 00620000
*   /* THERE WAS AN INCOMPLETE CREATE, INCOMPLETE            @Y30LB39*/ 00621000
*   /* COPY, OR A VOLUME SERIAL MISMATCH, THEN THE           @Y30LB39*/ 00622000
*   /* CONDITION CODE WILL ALSO BE SET TO TWELVE.            @Y30LB39*/ 00623000
*   /* OTHERWISE, THE CONDITION CODE IS SET TO ZERO          @Y30LB39*/ 00624000
*   /* TO SHOW THAT THE BASE VOLUME RECORD WAS               @Y30LB39*/ 00625000
*   /* SUCCESSFULLY RETRIEVED.                               @Y30LB39*/ 00626000
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/ 00627000
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/ 00628000
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/ 00629000
*   /* IDC3074I IF VOLUME IS INACTIVE                        @Y30LB39*/ 00630000
*   /* IDC3095I IF THERE WAS A VOLSER MISMATCH               @Y30LB39*/ 00631000
*   /* IDC3096I IF THERE WAS AN INCOMPLETE COPY              @Y30LB39*/ 00632000
*   /* IDC3097I IF THERE WASN AN INCOMPLETE CREATE           @Y30LB39*/ 00633000
*   /*                                                       @Y30LB39*/ 00634000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 00635000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 00636000
*   /* BUFFER FOR BASE VOLUME RECORD                         @Y30LB39*/ 00637000
*   /* DARGLIST                                              @Y30LB39*/ 00638000
*   /*                                                       @Y30LB39*/ 00639000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 00640000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 00641000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 00642000
*   /* 12 - BASE RECORD WAS NOT RETRIEVED OR WAS             @Y30LB39*/ 00643000
*   /* UNUSABLE.                                             @Y30LB39*/ 00644000
*   /*                                                       @Y30LB39*/ 00645000
*   /*                                                               */ 00646000
*   /*****************************************************************/ 00647000
*                                                                  0354 00648000
*FVOLRTN:                                                          0354 00649000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 00650000
*                                                                  0354 00651000
@EL00001 L     @13,4(,@13)                                         0354 00652000
@EF00001 L     @00,@SIZDATD                                        0354 00653000
         LR    @01,@11                                             0354 00654000
         FREEMAIN R,LV=(0),A=(1)                                        00655000
@ER00001 LM    @14,@12,12(@13)                                     0354 00656000
         BR    @14                                                 0354 00657000
FVOLRTN  DS    0H                                                  0355 00658000
*   /*****************************************************************/ 00659000
*   /*                                                               */ 00660000
*   /*                                                       @Y30LB39*/ 00661000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 00662000
*   /*                                                       @Y30LB39*/ 00663000
*   /*                                                               */ 00664000
*   /*****************************************************************/ 00665000
*                                                                  0355 00666000
*                                   /*                       @Y30LB39*/ 00667000
*   DCL                                                            0355 00668000
*     FVOLRC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 00669000
*                                   /*                       @Y30LB39*/ 00670000
*                                                                  0356 00671000
*   /*****************************************************************/ 00672000
*   /*                                                               */ 00673000
*   /*                                                       @Y30LB39*/ 00674000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 00675000
*   /*                                                       @Y30LB39*/ 00676000
*   /*                                                               */ 00677000
*   /*****************************************************************/ 00678000
*                                                                  0356 00679000
*                                   /*                       @Y30LB39*/ 00680000
*   RETADDR1=REG14;                 /*                       @Y30LB39   00681000
*                                                            @Y30LB39*/ 00682000
*                                                                  0356 00683000
         ST    REG14,RETADDR1                                      0356 00684000
*   /*****************************************************************/ 00685000
*   /*                                                               */ 00686000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 00687000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 00688000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 00689000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 00690000
*   /*                                                       @Y30LB39*/ 00691000
*   /*                                                               */ 00692000
*   /*****************************************************************/ 00693000
*                                                                  0357 00694000
*                                   /*                       @Y30LB39*/ 00695000
*   OLDERID2=NEWERID2;                                             0357 00696000
         L     @09,@PC00001                                        0357 00697000
         L     @09,GDTTR2(,@09)                                    0357 00698000
         MVC   @TS00001(95),NEWERID2(@09)                          0357 00699000
         MVC   OLDERID2(95,@09),@TS00001                           0357 00700000
*   NEWID2='COFV';                  /*                       @Y30LB39   00701000
*                                                            @Y30LB39*/ 00702000
*                                                                  0358 00703000
         MVC   NEWID2(4,@09),@CC01629                              0358 00704000
*   /*****************************************************************/ 00705000
*   /*                                                               */ 00706000
*   /*                                                       @Y30LB39*/ 00707000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 00708000
*   /*                                                       @Y30LB39*/ 00709000
*   /*                                                               */ 00710000
*   /*****************************************************************/ 00711000
*                                                                  0359 00712000
*                                   /*                       @Y30LB39*/ 00713000
*   FVOLRC=LASTCC00;                /*                       @Y30LB39   00714000
*                                                            @Y30LB39*/ 00715000
*                                                                  0359 00716000
         SLR   FVOLRC,FVOLRC                                       0359 00717000
*   /*****************************************************************/ 00718000
*   /*                                                               */ 00719000
*   /*                                                       @Y30LB39*/ 00720000
*   /* SET THE RECORD TYPE TO BE READ PRIOR TO CALLING       @Y30LB39*/ 00721000
*   /* RVVIRTN. IN THIS CALL, THE RECORD TO                  @Y30LB39*/ 00722000
*   /* BE READ IS THE BASE VOLUME RECORD.                    @Y30LB39*/ 00723000
*   /*                                                       @Y30LB39*/ 00724000
*   /*                                                               */ 00725000
*   /*****************************************************************/ 00726000
*                                                                  0360 00727000
*                                   /*                       @Y30LB39*/ 00728000
*   RECTYPE=BASECHAR;               /*                       @Y30LB39   00729000
*                                                            @Y30LB39*/ 00730000
         MVC   RECTYPE(4),BASECHAR                                 0360 00731000
*   CALL RVVIRTN;                   /*                       @Y30LB39*/ 00732000
         BAL   @14,RVVIRTN                                         0361 00733000
*   RESPECIFY                                                      0362 00734000
*     RTNREG RSTD;                                                 0362 00735000
*   TESTRC=RTNREG;                                                 0363 00736000
         LR    TESTRC,RTNREG                                       0363 00737000
*   RESPECIFY                                                      0364 00738000
*     RTNREG UNRSTD;                /*                       @Y30LB39*/ 00739000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/ 00740000
         LTR   TESTRC,TESTRC                                       0365 00741000
         BZ    @RF00365                                            0365 00742000
*     FVOLRC=LASTCC12;              /*                       @Y30LB39   00743000
*                                                            @Y30LB39*/ 00744000
*                                                                  0366 00745000
         LA    FVOLRC,12                                           0366 00746000
*   /*****************************************************************/ 00747000
*   /*                                                               */ 00748000
*   /*                                                       @Y30LB39*/ 00749000
*   /* CHECK RETURN CODE                                     @Y30LB39*/ 00750000
*   /*                                                       @Y30LB39*/ 00751000
*   /*                                                               */ 00752000
*   /*****************************************************************/ 00753000
*                                                                  0367 00754000
*                                   /*                       @Y30LB39*/ 00755000
*   IF FVOLRC=LASTCC00 THEN         /*                       @Y30LB39*/ 00756000
@RF00365 C     FVOLRC,@CF00115                                     0367 00757000
         BNE   @RF00367                                            0367 00758000
*     DO;                           /*                       @Y30LB39*/ 00759000
*       IF BASINAC=ON THEN          /*                       @Y30LB39*/ 00760000
         TM    BASINAC(BASEVPTR),B'00000100'                       0369 00761000
         BNO   @RF00369                                            0369 00762000
*         DO;                       /*                       @Y30LB39   00763000
*                                                            @Y30LB39*/ 00764000
*                                                                  0370 00765000
*           /*********************************************************/ 00766000
*           /*                                                       */ 00767000
*           /*                                               @Y30LB39*/ 00768000
*           /* THE VOLUME IS INACTIVE, SO                    @Y30LB39*/ 00769000
*           /* SET THE CONDITION CODE TO TWELVE AND          @Y30LB39*/ 00770000
*           /* ISSUE MESSAGE IDC3074I                        @Y30LB39*/ 00771000
*           /*                                               @Y30LB39*/ 00772000
*           /*                                                       */ 00773000
*           /*********************************************************/ 00774000
*                                                                  0371 00775000
*                                   /*                       @Y30LB39*/ 00776000
*           FVOLRC=LASTCC12;        /*                       @Y30LB39*/ 00777000
         LA    FVOLRC,12                                           0371 00778000
*           DARGLIST=''B;           /*                       @Y30LB39*/ 00779000
         L     @09,DDSTRU                                          0372 00780000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0372 00781000
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/ 00782000
         MVC   DARGSMOD(3,@09),@CC01550                            0373 00783000
*           DARGSENT=MSG3074I;      /*                       @Y30LB39*/ 00784000
         MVI   DARGSENT(@09),X'20'                                 0374 00785000
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB39*/ 00786000
         L     @04,@PC00001+4                                      0375 00787000
         L     @04,FDTPTR(,@04)                                    0375 00788000
         LA    @15,VOLVAL(,@04)                                    0375 00789000
         ST    @15,DARGDBP(,@09)                                   0375 00790000
*           DARGILP=VOLLEN;         /*                       @Y30LB39   00791000
*                                                            @Y30LB39*/ 00792000
         SLR   @15,@15                                             0376 00793000
         IC    @15,VOLLEN(,@04)                                    0376 00794000
         STH   @15,DARGILP(,@09)                                   0376 00795000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39   00796000
*                                                            @Y30LB39*/ 00797000
         L     @09,@PC00001                                        0377 00798000
         ST    @09,@AL00001                                        0377 00799000
         LA    @04,@CF00115                                        0377 00800000
         ST    @04,@AL00001+4                                      0377 00801000
         LA    @04,DDSTRU                                          0377 00802000
         ST    @04,@AL00001+8                                      0377 00803000
         MVI   @AL00001+8,X'80'                                    0377 00804000
         L     @15,GDTPRT(,@09)                                    0377 00805000
         LA    @01,@AL00001                                        0377 00806000
         BALR  @14,@15                                             0377 00807000
*         END;                      /*                       @Y30LB39*/ 00808000
*       IF BASSATIA^=NULLPTR THEN   /*                       @Y30LB39*/ 00809000
@RF00369 LH    @09,BASSATIA(,BASEVPTR)                             0379 00810000
         N     @09,@CF01914                                        0379 00811000
         LTR   @09,@09                                             0379 00812000
         BZ    @RF00379                                            0379 00813000
*         DO;                       /*                       @Y30LB39   00814000
*                                                            @Y30LB39*/ 00815000
*                                                                  0380 00816000
*           /*********************************************************/ 00817000
*           /*                                                       */ 00818000
*           /*                                               @Y30LB39*/ 00819000
*           /* THE VOLUME IS UNUSABLE, SO SET THE            @Y30LB39*/ 00820000
*           /* CONDITION CODE TO TWELVE AND ISSUE            @Y30LB39*/ 00821000
*           /* MESSAGE IDC3097I IF THERE WAS AN              @Y30LB39*/ 00822000
*           /* INCOMPLETE CREATE                             @Y30LB39*/ 00823000
*           /* MESSAGE IDC3096I IF THERE WAS AN              @Y30LB39*/ 00824000
*           /* INCOMPELTE COPY                               @Y30LB39*/ 00825000
*           /* MESSAGE IDC3095I IF THERE WAS A               @Y30LB39*/ 00826000
*           /* VOLUME SERIAL MISMATCH.                       @Y30LB39*/ 00827000
*           /*                                               @Y30LB39*/ 00828000
*           /*                                                       */ 00829000
*           /*********************************************************/ 00830000
*                                                                  0381 00831000
*                                   /*                       @Y30LB39*/ 00832000
*           FVOLRC=LASTCC12;        /*                       @Y30LB39*/ 00833000
         LA    FVOLRC,12                                           0381 00834000
*           DARGLIST=''B;           /*                       @Y30LB39*/ 00835000
         L     @09,DDSTRU                                          0382 00836000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0382 00837000
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB39*/ 00838000
         L     @04,@PC00001+4                                      0383 00839000
         L     @04,FDTPTR(,@04)                                    0383 00840000
         LA    @15,VOLVAL(,@04)                                    0383 00841000
         ST    @15,DARGDBP(,@09)                                   0383 00842000
*           DARGILP=VOLLEN;         /*                       @Y30LB39*/ 00843000
         SLR   @15,@15                                             0384 00844000
         IC    @15,VOLLEN(,@04)                                    0384 00845000
         STH   @15,DARGILP(,@09)                                   0384 00846000
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/ 00847000
         MVC   DARGSMOD(3,@09),@CC01550                            0385 00848000
*           IF BASIVCRE=ON THEN     /*                       @Y30LB39*/ 00849000
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0386 00850000
         BNO   @RF00386                                            0386 00851000
*             DARGSENT=MSG3097I;    /*                       @Y30LB39*/ 00852000
         MVI   DARGSENT(@09),X'03'                                 0387 00853000
*           ELSE                    /*                       @Y30LB39*/ 00854000
*             IF BASIVCPY=ON THEN   /*                       @Y30LB39*/ 00855000
         B     @RC00386                                            0388 00856000
@RF00386 TM    BASIVCPY(BASEVPTR),B'01000000'                      0388 00857000
         BNO   @RF00388                                            0388 00858000
*               DARGSENT=MSG3096I;  /*                       @Y30LB39*/ 00859000
         L     @09,DDSTRU                                          0389 00860000
         MVI   DARGSENT(@09),X'06'                                 0389 00861000
*             ELSE                  /*                       @Y30LB39*/ 00862000
*               IF BASVSMIS=ON THEN /*                       @Y30LB39*/ 00863000
         B     @RC00388                                            0390 00864000
@RF00388 TM    BASVSMIS(BASEVPTR),B'00100000'                      0390 00865000
         BNO   @RF00390                                            0390 00866000
*                 DARGSENT=MSG3095I;/*                       @Y30LB39   00867000
*                                                            @Y30LB39*/ 00868000
         L     @09,DDSTRU                                          0391 00869000
         MVI   DARGSENT(@09),X'09'                                 0391 00870000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39   00871000
*                                                            @Y30LB39*/ 00872000
@RF00390 DS    0H                                                  0392 00873000
@RC00388 DS    0H                                                  0392 00874000
@RC00386 L     @09,@PC00001                                        0392 00875000
         ST    @09,@AL00001                                        0392 00876000
         LA    @04,@CF00115                                        0392 00877000
         ST    @04,@AL00001+4                                      0392 00878000
         LA    @04,DDSTRU                                          0392 00879000
         ST    @04,@AL00001+8                                      0392 00880000
         MVI   @AL00001+8,X'80'                                    0392 00881000
         L     @15,GDTPRT(,@09)                                    0392 00882000
         LA    @01,@AL00001                                        0392 00883000
         BALR  @14,@15                                             0392 00884000
*         END;                      /*                       @Y30LB39*/ 00885000
*     END;                          /*                       @Y30LB39   00886000
*                                                            @Y30LB39*/ 00887000
*                                                                  0394 00888000
@RF00379 DS    0H                                                  0395 00889000
*   /*****************************************************************/ 00890000
*   /*                                                               */ 00891000
*   /*                                                       @Y30LB39*/ 00892000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 00893000
*   /*                                                       @Y30LB39*/ 00894000
*   /*                                                               */ 00895000
*   /*****************************************************************/ 00896000
*                                                                  0395 00897000
*                                   /*                       @Y30LB39*/ 00898000
*   REG14=RETADDR1;                 /*                       @Y30LB39   00899000
*                                                            @Y30LB39*/ 00900000
*                                                                  0395 00901000
@RF00367 L     REG14,RETADDR1                                      0395 00902000
*   /*****************************************************************/ 00903000
*   /*                                                               */ 00904000
*   /*                                                       @Y30LB39*/ 00905000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 00906000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 00907000
*   /*                                                       @Y30LB39*/ 00908000
*   /*                                                               */ 00909000
*   /*****************************************************************/ 00910000
*                                                                  0396 00911000
*                                   /*                       @Y30LB39*/ 00912000
*   RETURN CODE(FVOLRC);            /*                       @Y30LB39*/ 00913000
         LR    @15,FVOLRC                                          0396 00914000
@EL00002 DS    0H                                                  0396 00915000
@EF00002 DS    0H                                                  0396 00916000
@ER00002 BR    @14                                                 0396 00917000
*   END FVOLRTN;                    /*                       @Y30LB39*/ 00918000
*                                                                  0398 00919000
*   /*****************************************************************/ 00920000
*   /*                                                               */ 00921000
*   /*                                                       @Y30LB39*/ 00922000
*   /* PROCEDURE NAME - TVOLRTN                              @Y30LB39*/ 00923000
*   /*                                                       @Y30LB39*/ 00924000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 00925000
*   /* SELECT A TARGET VOLUME AND READ THE RECORD FOR        @Y30LB39*/ 00926000
*   /* FOR THIS VOLUME. A CALL IS MADE TO TVOLRTN            @Y30LB39*/ 00927000
*   /* TO SEE IF CARTRIDGES OF AN EXISTING COPY CAN BE       @Y30LB39*/ 00928000
*   /* REUSED OR CALLS CKCSNLEN IF THE USER HAS SPCFD        @Y30LB39*/ 00929000
*   /* CARTRIDGES TO BE USED. IT IS POSSIBLE FOR A           @Y30LB39*/ 00930000
*   /* MESSAGE TO BE ISSUED BY CKCSNLEN WHICH CHECKS         @Y30LB39*/ 00931000
*   /* THE CARTRIDGE SERIALS NUMBERS AND ADJUSTS THE         @Y30LB39*/ 00932000
*   /* LENGTH, IF NECESSARY.                                 @Y30LB39*/ 00933000
*   /* IF THE USER HAS NOT SPECIFIED THE                     @Y30LB39*/ 00934000
*   /* CARTRIDGES TO BE USED, THEN SCRATCH CARTRIDGES        @Y30LB39*/ 00935000
*   /* WILL BE SELECTED DURING LATER PROCESSING.             @Y30LB39*/ 00936000
*   /* THIS ROUTINE ALSO CALLS SSCMSG ROUTINE TO             @Y30LB39*/ 00937000
*   /* PRINT A MESSAGE CONTAINING THE MSS REASON CODE,       @Y30LB39*/ 00938000
*   /* IF THE READ FAILED.                                   @Y30LB39*/ 00939000
*   /*                                                       @Y30LB39*/ 00940000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 00941000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 00942000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 00943000
*   /*                                                       @Y30LB39*/ 00944000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 00945000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 00946000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 00947000
*   /* 12 - IF EITHER OF THE CARTRIDGES TO BE USED           @Y30LB39*/ 00948000
*   /* WAS INCORRECTLY SPECIFIED OR                          @Y30LB39*/ 00949000
*   /* IT WAS DETERMINED THAT CARTRIDGES                     @Y30LB39*/ 00950000
*   /* OF AN EXISTING COPY WERE NOT AVAILABLE.               @Y30LB39*/ 00951000
*   /*                                                       @Y30LB39*/ 00952000
*   /*                                                               */ 00953000
*   /*****************************************************************/ 00954000
*                                                                  0398 00955000
*TVOLRTN:                                                          0398 00956000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 00957000
*                                                                  0398 00958000
TVOLRTN  DS    0H                                                  0399 00959000
*   /*****************************************************************/ 00960000
*   /*                                                               */ 00961000
*   /*                                                       @Y30LB39*/ 00962000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 00963000
*   /*                                                       @Y30LB39*/ 00964000
*   /*                                                               */ 00965000
*   /*****************************************************************/ 00966000
*                                                                  0399 00967000
*                                   /*                       @Y30LB39*/ 00968000
*   DCL                                                            0399 00969000
*     TVOLRC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 00970000
*   DCL                                                            0400 00971000
*     CSN1RC FIXED(8);              /* RETURN CODE           @Y30LB39   00972000
*                                      FROM CKCSNLEN         @Y30LB39*/ 00973000
*   DCL                                                            0401 00974000
*     CSN2RC FIXED(8);              /* RETURN CODE           @Y30LB39   00975000
*                                      FROM CKCSNLEN         @Y30LB39*/ 00976000
*                                   /*                       @Y30LB39*/ 00977000
*                                                                  0402 00978000
*   /*****************************************************************/ 00979000
*   /*                                                               */ 00980000
*   /*                                                       @Y30LB39*/ 00981000
*   /* SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE         @Y30LB39*/ 00982000
*   /*                                                       @Y30LB39*/ 00983000
*   /*                                                               */ 00984000
*   /*****************************************************************/ 00985000
*                                                                  0402 00986000
*                                   /*                       @Y30LB39*/ 00987000
*   RETADDR1=REG14;                 /*                       @Y30LB39   00988000
*                                                            @Y30LB39*/ 00989000
*                                                                  0402 00990000
         ST    REG14,RETADDR1                                      0402 00991000
*   /*****************************************************************/ 00992000
*   /*                                                               */ 00993000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 00994000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 00995000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 00996000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 00997000
*   /*                                                       @Y30LB39*/ 00998000
*   /*                                                               */ 00999000
*   /*****************************************************************/ 01000000
*                                                                  0403 01001000
*                                   /*                       @Y30LB39*/ 01002000
*   OLDERID2=NEWERID2;                                             0403 01003000
         L     @09,@PC00001                                        0403 01004000
         L     @09,GDTTR2(,@09)                                    0403 01005000
         MVC   @TS00001(95),NEWERID2(@09)                          0403 01006000
         MVC   OLDERID2(95,@09),@TS00001                           0403 01007000
*   NEWID2='COTV';                  /*                       @Y30LB39   01008000
*                                                            @Y30LB39*/ 01009000
*                                                                  0404 01010000
         MVC   NEWID2(4,@09),@CC01637                              0404 01011000
*   /*****************************************************************/ 01012000
*   /*                                                               */ 01013000
*   /*                                                       @Y30LB39*/ 01014000
*   /* SET CONDITION CODE AND RETURN CODES TO ZERO           @Y30LB39*/ 01015000
*   /*                                                       @Y30LB39*/ 01016000
*   /*                                                               */ 01017000
*   /*****************************************************************/ 01018000
*                                                                  0405 01019000
*                                   /*                       @Y30LB39*/ 01020000
*   TVOLRC=LASTCC00;                /*                       @Y30LB39*/ 01021000
         MVI   TVOLRC,X'00'                                        0405 01022000
*   CSN1RC=LASTCC00;                /*                       @Y30LB39*/ 01023000
         SLR   @09,@09                                             0406 01024000
         LR    CSN1RC,@09                                          0406 01025000
*   CSN2RC=LASTCC00;                /*                       @Y30LB39   01026000
*                                                            @Y30LB39*/ 01027000
*                                                                  0407 01028000
         LR    CSN2RC,@09                                          0407 01029000
*   /*****************************************************************/ 01030000
*   /*                                                               */ 01031000
*   /*                                                       @Y30LB39*/ 01032000
*   /* IF THE BASE VOLUME RECORD INDICATES THAT AT           @Y30LB39*/ 01033000
*   /* LEAST ONE COPY EXISTS, CALL REUSERTN TO               @Y30LB39*/ 01034000
*   /* DETERMINE IF THE CARTRIDGES OF AN EXISTING            @Y30LB39*/ 01035000
*   /* COPY CAN BE REUSED.                                   @Y30LB39*/ 01036000
*   /*                                                       @Y30LB39*/ 01037000
*   /*                                                               */ 01038000
*   /*****************************************************************/ 01039000
*                                                                  0408 01040000
*                                   /*                       @Y30LB39*/ 01041000
*   IF BASNCOPY>0 THEN              /*                       @Y30LB39*/ 01042000
         CLI   BASNCOPY(BASEVPTR),0                                0408 01043000
         BNH   @RF00408                                            0408 01044000
*     DO;                           /*                       @Y30LB39*/ 01045000
*       CALL REUSERTN;              /*                       @Y30LB39*/ 01046000
         BAL   @14,REUSERTN                                        0410 01047000
*       RESPECIFY                                                  0411 01048000
*         RTNREG RSTD;                                             0411 01049000
*       TESTRC=RTNREG;                                             0412 01050000
         LR    TESTRC,RTNREG                                       0412 01051000
*       RESPECIFY                                                  0413 01052000
*         RTNREG UNRSTD;            /*                       @Y30LB39*/ 01053000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 01054000
         LTR   TESTRC,TESTRC                                       0414 01055000
         BZ    @RF00414                                            0414 01056000
*         TVOLRC=LASTCC12;          /*                       @Y30LB39*/ 01057000
         MVI   TVOLRC,X'0C'                                        0415 01058000
*     END;                          /*                       @Y30LB39   01059000
*                                                            @Y30LB39*/ 01060000
*                                                                  0416 01061000
@RF00414 DS    0H                                                  0417 01062000
*   /*****************************************************************/ 01063000
*   /*                                                               */ 01064000
*   /*                                                       @Y30LB39*/ 01065000
*   /* IF RETURN CODE FROM REUSERTN IS ZERO                  @Y30LB39*/ 01066000
*   /* THEN CONTINUE PROCESSING                              @Y30LB39*/ 01067000
*   /*                                                       @Y30LB39*/ 01068000
*   /*                                                               */ 01069000
*   /*****************************************************************/ 01070000
*                                                                  0417 01071000
*                                   /*                       @Y30LB39*/ 01072000
*   IF TVOLRC=0 THEN                /*                       @Y30LB39   01073000
*                                                            @Y30LB39*/ 01074000
*                                                                  0417 01075000
@RF00408 CLI   TVOLRC,0                                            0417 01076000
         BNE   @RF00417                                            0417 01077000
*     /***************************************************************/ 01078000
*     /*                                                             */ 01079000
*     /*                                                     @Y30LB39*/ 01080000
*     /* IF AN EXISTING COPY CAN BE REUSED                   @Y30LB39*/ 01081000
*     /* AS THE TARGET VOLUME THEN FALL THRU TO              @Y30LB39*/ 01082000
*     /* EXIT THIS ROUTINE                                   @Y30LB39*/ 01083000
*     /*                                                     @Y30LB39*/ 01084000
*     /*                                                             */ 01085000
*     /***************************************************************/ 01086000
*                                                                  0418 01087000
*                                   /*                       @Y30LB39*/ 01088000
*     IF REUSEFLG=OFF THEN          /*                       @Y30LB39   01089000
*                                                            @Y30LB39*/ 01090000
*                                                                  0418 01091000
         TM    REUSEFLG,B'10000000'                                0418 01092000
         BNZ   @RF00418                                            0418 01093000
*       /*************************************************************/ 01094000
*       /*                                                           */ 01095000
*       /*                                                   @Y30LB39*/ 01096000
*       /* IF CART IS NOT SPECIFED, SCRATCH                  @Y30LB39*/ 01097000
*       /* CARTRIDGES ARE TO BE RANDOMLY SELECTED            @Y30LB39*/ 01098000
*       /* WHEN CREATING A NEW TARGET VOLUME.                @Y30LB39*/ 01099000
*       /* IF THIS IS THE CASE, THEN EXIT VIA LAST           @Y30LB39*/ 01100000
*       /* STEP.                                             @Y30LB39*/ 01101000
*       /*                                                   @Y30LB39*/ 01102000
*       /*                                                           */ 01103000
*       /*************************************************************/ 01104000
*                                                                  0419 01105000
*                                   /*                       @Y30LB39*/ 01106000
*       IF ADDR(CART)^=NULLPTR THEN /*                       @Y30LB39*/ 01107000
         L     @09,@PC00001+4                                      0419 01108000
         L     @07,FDTPTR+8(,@09)                                  0419 01109000
         LTR   @07,@07                                             0419 01110000
         BZ    @RF00419                                            0419 01111000
*         DO;                       /*                       @Y30LB39   01112000
*                                                            @Y30LB39*/ 01113000
*                                                                  0420 01114000
*           /*********************************************************/ 01115000
*           /*                                                       */ 01116000
*           /*                                               @Y30LB39*/ 01117000
*           /* FOR EACH CARTRIDGE SERIAL NUMBER,             @Y30LB39*/ 01118000
*           /* CALL CKCSNLEN TO VALIDATE THE                 @Y30LB39*/ 01119000
*           /* LENGTH AND ADJUST TO 12 BYTES, IF             @Y30LB39*/ 01120000
*           /* NECESSARY.                                    @Y30LB39*/ 01121000
*           /*                                               @Y30LB39*/ 01122000
*           /*                                                       */ 01123000
*           /*********************************************************/ 01124000
*                                                                  0421 01125000
*                                   /*                       @Y30LB39*/ 01126000
*           CSN1AREA=CSN1VAL;       /*                       @Y30LB39*/ 01127000
         L     @07,FDTPTR+12(,@09)                                 0421 01128000
         MVC   CSN1AREA(12),CSN1VAL(@07)                           0421 01129000
*           CSN2AREA=CSN2VAL;       /*                       @Y30LB39*/ 01130000
         L     @09,FDTPTR+16(,@09)                                 0422 01131000
         MVC   CSN2AREA(12),CSN2VAL(@09)                           0422 01132000
*           CALL CKCSNLEN(CSN1AREA,CSN1LEN);/*               @Y30LB39*/ 01133000
         LA    @09,CSN1AREA                                        0423 01134000
         ST    @09,@AL00001                                        0423 01135000
         ST    @07,@AL00001+4                                      0423 01136000
         LA    @01,@AL00001                                        0423 01137000
         BAL   @14,CKCSNLEN                                        0423 01138000
*           RESPECIFY                                              0424 01139000
*             RTNREG RSTD;                                         0424 01140000
*           TESTRC=RTNREG;                                         0425 01141000
         LR    TESTRC,RTNREG                                       0425 01142000
*           RESPECIFY                                              0426 01143000
*             RTNREG UNRSTD;        /*                       @Y30LB39*/ 01144000
*           CSN1RC=TESTRC;          /*                       @Y30LB39*/ 01145000
         LR    CSN1RC,TESTRC                                       0427 01146000
*           CALL CKCSNLEN(CSN2AREA,CSN2LEN);/*               @Y30LB39*/ 01147000
         LA    @09,CSN2AREA                                        0428 01148000
         ST    @09,@AL00001                                        0428 01149000
         L     @09,@PC00001+4                                      0428 01150000
         L     @09,FDTPTR+16(,@09)                                 0428 01151000
         ST    @09,@AL00001+4                                      0428 01152000
         LA    @01,@AL00001                                        0428 01153000
         BAL   @14,CKCSNLEN                                        0428 01154000
*           RESPECIFY                                              0429 01155000
*             RTNREG RSTD;                                         0429 01156000
*           TESTRC=RTNREG;                                         0430 01157000
         LR    TESTRC,RTNREG                                       0430 01158000
*           RESPECIFY                                              0431 01159000
*             RTNREG UNRSTD;        /*                       @Y30LB39*/ 01160000
*           CSN2RC=TESTRC;          /*                       @Y30LB39   01161000
*                                                            @Y30LB39*/ 01162000
*                                                                  0432 01163000
         LR    CSN2RC,TESTRC                                       0432 01164000
*           /*********************************************************/ 01165000
*           /*                                                       */ 01166000
*           /*                                               @Y30LB39*/ 01167000
*           /* IF CKCSNLEN RETURN CODE IS NOT                @Y30LB39*/ 01168000
*           /* ZERO FOR BOTH CARTRIDGE SERIAL                @Y30LB39*/ 01169000
*           /* NUMBERS CHECKED OUT, A CSN LENGTH             @Y30LB39*/ 01170000
*           /* WAS INVALID AND THE APPROPRIATE               @Y30LB39*/ 01171000
*           /* MESSAGE WAS ISSUED BY CKCSNLEN.               @Y30LB39*/ 01172000
*           /*                                               @Y30LB39*/ 01173000
*           /*                                                       */ 01174000
*           /*********************************************************/ 01175000
*                                                                  0433 01176000
*                                   /*                       @Y30LB39*/ 01177000
*           IF CSN1RC^=0|CSN2RC^=0 THEN/*                    @Y30LB39*/ 01178000
         SLR   @09,@09                                             0433 01179000
         CR    CSN1RC,@09                                          0433 01180000
         BNE   @RT00433                                            0433 01181000
         CR    CSN2RC,@09                                          0433 01182000
         BE    @RF00433                                            0433 01183000
@RT00433 DS    0H                                                  0434 01184000
*             TVOLRC=LASTCC12;      /*                       @Y30LB39*/ 01185000
         MVI   TVOLRC,X'0C'                                        0434 01186000
*         END;                      /*                       @Y30LB39   01187000
*                                                            @Y30LB39*/ 01188000
*                                                                  0435 01189000
@RF00433 DS    0H                                                  0436 01190000
*   /*****************************************************************/ 01191000
*   /*                                                               */ 01192000
*   /*                                                       @Y30LB39*/ 01193000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 01194000
*   /*                                                       @Y30LB39*/ 01195000
*   /*                                                               */ 01196000
*   /*****************************************************************/ 01197000
*                                                                  0436 01198000
*                                   /*                       @Y30LB39*/ 01199000
*   REG14=RETADDR1;                 /*                       @Y30LB39   01200000
*                                                            @Y30LB39*/ 01201000
*                                                                  0436 01202000
@RF00419 DS    0H                                                  0436 01203000
@RF00418 DS    0H                                                  0436 01204000
@RF00417 L     REG14,RETADDR1                                      0436 01205000
*   /*****************************************************************/ 01206000
*   /*                                                               */ 01207000
*   /*                                                       @Y30LB39*/ 01208000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 01209000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 01210000
*   /*                                                       @Y30LB39*/ 01211000
*   /*                                                               */ 01212000
*   /*****************************************************************/ 01213000
*                                                                  0437 01214000
*                                   /*                       @Y30LB39*/ 01215000
*   RETURN CODE(TVOLRC);            /*                       @Y30LB39*/ 01216000
         SLR   @15,@15                                             0437 01217000
         IC    @15,TVOLRC                                          0437 01218000
@EL00003 DS    0H                                                  0437 01219000
@EF00003 DS    0H                                                  0437 01220000
@ER00003 BR    @14                                                 0437 01221000
*   END TVOLRTN;                    /*                       @Y30LB39*/ 01222000
*                                                                  0439 01223000
*   /*****************************************************************/ 01224000
*   /*                                                               */ 01225000
*   /*                                                       @Y30LB39*/ 01226000
*   /* PROCEDURE NAME - REUSERTN                             @Y30LB39*/ 01227000
*   /*                                                       @Y30LB39*/ 01228000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 01229000
*   /* CHECK TO SEE IF VOLUME CAN BE REUSED.                 @Y30LB39*/ 01230000
*   /* CALLS RVVIRTN TO RETRIEVE LATEST COPY RECORD.         @Y30LB39*/ 01231000
*   /* A CHECK IS MADE TO SEE IF RETRIEVE WAS OKAY, IF       @Y30LB39*/ 01232000
*   /* NOT, CODE IS SET TO FOUR AND AN IMMEDIATE             @Y30LB39*/ 01233000
*   /* RETURN TO THE CALLING ROUTINE IS EFFECTED.            @Y30LB39*/ 01234000
*   /* OTHERWISE, PROCESSING CONTINUES BY CHECKING TO        @Y30LB39*/ 01235000
*   /* SEE IF THE COPY IS INCOMPLETE, IN WHICH CASE          @Y30LB39*/ 01236000
*   /* THE REUSE FLAG IS TURNED ON AND THE CARTRIDGES        @Y30LB39*/ 01237000
*   /* TO BE REUSED ARE PLACED IN THE COPYV INTERNAL         @Y30LB39*/ 01238000
*   /* TABLE. IF BACKUP HAS BEEN SPECIFIED AND LATEST        @Y30LB39*/ 01239000
*   /* COPY CANNOT BE REUSED, THEN MSVC IS CALLED TO         @Y30LB39*/ 01240000
*   /* RETRIEVE OLDEST BACKUP COPY RECORD. CHECK IS          @Y30LB39*/ 01241000
*   /* MADE TO DETERMINE IF THE CARTRIDGES OF A BACKUP       @Y30LB39*/ 01242000
*   /* TO BE REUSED ARE OUT OF MASS STORAGE FACILITY.        @Y30LB39*/ 01243000
*   /* THERE ARE NO MESSAGES ISSUED BY THIS SUB-             @Y30LB39*/ 01244000
*   /* PROCEDURE.                                            @Y30LB39*/ 01245000
*   /*                                                       @Y30LB39*/ 01246000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 01247000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 01248000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 01249000
*   /* FORMAT OF A COPY VOLUME RECORD                        @Y30LB39*/ 01250000
*   /*                                                       @Y30LB39*/ 01251000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 01252000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 01253000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 01254000
*   /* 4 - COPY RECORD COULT NOT BE RETRIEVED OR             @Y30LB39*/ 01255000
*   /* OLDEST BACKUP COULD NOT BE RETRIEVED,                 @Y30LB39*/ 01256000
*   /* COPYVTBL IS UPDATED.                                  @Y30LB39*/ 01257000
*   /*                                                       @Y30LB39*/ 01258000
*   /*                                                               */ 01259000
*   /*****************************************************************/ 01260000
*                                                                  0439 01261000
*REUSERTN:                                                         0439 01262000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 01263000
*                                                                  0439 01264000
REUSERTN DS    0H                                                  0440 01265000
*   /*****************************************************************/ 01266000
*   /*                                                               */ 01267000
*   /*                                                       @Y30LB39*/ 01268000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 01269000
*   /*                                                       @Y30LB39*/ 01270000
*   /*                                                               */ 01271000
*   /*****************************************************************/ 01272000
*                                                                  0440 01273000
*                                   /*                       @Y30LB39*/ 01274000
*   DCL                                                            0440 01275000
*     REUSERC FIXED(8);             /* RETURN CODE           @Y30LB39   01276000
*                                                            @Y30LB39*/ 01277000
*                                   /*                       @Y30LB39*/ 01278000
*                                                                  0441 01279000
*   /*****************************************************************/ 01280000
*   /*                                                               */ 01281000
*   /*                                                       @Y30LB39*/ 01282000
*   /* SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE         @Y30LB39*/ 01283000
*   /*                                                       @Y30LB39*/ 01284000
*   /*                                                               */ 01285000
*   /*****************************************************************/ 01286000
*                                                                  0441 01287000
*                                   /*                       @Y30LB39*/ 01288000
*   RETADDR2=REG14;                 /*                       @Y30LB39   01289000
*                                                            @Y30LB39*/ 01290000
*                                                                  0441 01291000
         LR    RETADDR2,REG14                                      0441 01292000
*   /*****************************************************************/ 01293000
*   /*                                                               */ 01294000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 01295000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 01296000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 01297000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 01298000
*   /*                                                       @Y30LB39*/ 01299000
*   /*                                                               */ 01300000
*   /*****************************************************************/ 01301000
*                                                                  0442 01302000
*                                   /*                       @Y30LB39*/ 01303000
*   OLDERID2=NEWERID2;                                             0442 01304000
         L     @07,@PC00001                                        0442 01305000
         L     @07,GDTTR2(,@07)                                    0442 01306000
         MVC   @TS00001(95),NEWERID2(@07)                          0442 01307000
         MVC   OLDERID2(95,@07),@TS00001                           0442 01308000
*   NEWID2='CORE';                  /*                       @Y30LB39   01309000
*                                                            @Y30LB39*/ 01310000
*                                                                  0443 01311000
         MVC   NEWID2(4,@07),@CC01644                              0443 01312000
*   /*****************************************************************/ 01313000
*   /*                                                               */ 01314000
*   /*                                                       @Y30LB39*/ 01315000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 01316000
*   /*                                                       @Y30LB39*/ 01317000
*   /*                                                               */ 01318000
*   /*****************************************************************/ 01319000
*                                                                  0444 01320000
*                                   /*                       @Y30LB39*/ 01321000
*   REUSERC=LASTCC00;               /*                       @Y30LB39   01322000
*                                                            @Y30LB39*/ 01323000
*                                                                  0444 01324000
         SLR   REUSERC,REUSERC                                     0444 01325000
*   /*****************************************************************/ 01326000
*   /*                                                               */ 01327000
*   /*                                                       @Y30LB39*/ 01328000
*   /* SET THE RECORD TYPE IN THE INTERNAL TABLE AND         @Y30LB39*/ 01329000
*   /* CALL RVVIRTN TO READ THE LATEST COPY RECORD.          @Y30LB39*/ 01330000
*   /* IF THE RETURN CODE FROM RVVIRTN IS NOT ZERO,          @Y30LB39*/ 01331000
*   /* EXIT THIS ROUTINE AFTER SETTING CONDITION             @Y30LB39*/ 01332000
*   /* CODE TO FOUR.                                         @Y30LB39*/ 01333000
*   /*                                                       @Y30LB39*/ 01334000
*   /*                                                               */ 01335000
*   /*****************************************************************/ 01336000
*                                                                  0445 01337000
*                                   /*                       @Y30LB39*/ 01338000
*   RECTYPE=COPYCHAR;               /*                       @Y30LB39*/ 01339000
         MVC   RECTYPE(4),COPYCHAR                                 0445 01340000
*   CALL RVVIRTN;                   /*                       @Y30LB39*/ 01341000
         BAL   @14,RVVIRTN                                         0446 01342000
*   RESPECIFY                                                      0447 01343000
*     RTNREG RSTD;                                                 0447 01344000
*   TESTRC=RTNREG;                                                 0448 01345000
         LR    TESTRC,RTNREG                                       0448 01346000
*   RESPECIFY                                                      0449 01347000
*     RTNREG UNRSTD;                /*                       @Y30LB39*/ 01348000
*                                   /*                       @Y30LB39*/ 01349000
*                                                                  0450 01350000
*   /*****************************************************************/ 01351000
*   /*                                                               */ 01352000
*   /*                                                       @Y30LB39*/ 01353000
*   /* CHECK RETURN CODE                                     @Y30LB39*/ 01354000
*   /*                                                       @Y30LB39*/ 01355000
*   /*                                                               */ 01356000
*   /*****************************************************************/ 01357000
*                                                                  0450 01358000
*                                   /*                       @Y30LB39*/ 01359000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/ 01360000
         LTR   TESTRC,TESTRC                                       0450 01361000
         BZ    @RF00450                                            0450 01362000
*     REUSERC=LASTCC04;             /*                       @Y30LB39*/ 01363000
         LA    REUSERC,4                                           0451 01364000
*   IF REUSERC=0 THEN               /*                       @Y30LB39   01365000
*                                                            @Y30LB39*/ 01366000
*                                                                  0452 01367000
@RF00450 SLR   @07,@07                                             0452 01368000
         CR    REUSERC,@07                                         0452 01369000
         BNE   @RF00452                                            0452 01370000
*     /***************************************************************/ 01371000
*     /*                                                             */ 01372000
*     /*                                                     @Y30LB39*/ 01373000
*     /* IF THE CARTRIDGES CAN BE REUSED BECAUSE             @Y30LB39*/ 01374000
*     /* THE LATEST COPY IS MARKED INCOMPLETE, DROP          @Y30LB39*/ 01375000
*     /* THRU TO THE CORRESPONDING ELSE CLAUSE               @Y30LB39*/ 01376000
*     /* TO SAVE THE CSN'S AND COPYDATE FROM RECORD.         @Y30LB39*/ 01377000
*     /*                                                     @Y30LB39*/ 01378000
*     /*                                                             */ 01379000
*     /***************************************************************/ 01380000
*                                                                  0453 01381000
*                                   /*                       @Y30LB39*/ 01382000
*     IF COPSATIA=NULLPTR THEN      /*                       @Y30LB39   01383000
*                                                            @Y30LB39*/ 01384000
*                                                                  0453 01385000
         LH    @15,COPSATIA(,COPYVPTR)                             0453 01386000
         N     @15,@CF01914                                        0453 01387000
         LTR   @15,@15                                             0453 01388000
         BNZ   @RF00453                                            0453 01389000
*       /*************************************************************/ 01390000
*       /*                                                           */ 01391000
*       /* SINCE THERE IS NO INCOMPLETE-COPY VOLUME          @Y30LB39*/ 01392000
*       /* TO BE REUSED, DETERMINE WHETHER THE OLDEST BACKUP COPY    */ 01393000
*       /* VOLUME SHOULD BE REUSED.                          @Y30LB39*/ 01394000
*       /*                                                           */ 01395000
*       /*************************************************************/ 01396000
*                                                                  0454 01397000
*                                   /*                       @Y30LB39*/ 01398000
*       IF ADDR(BKUP)^=NULLPTR THEN /*                       @Y30LB39*/ 01399000
         L     @15,@PC00001+4                                      0454 01400000
         C     @07,FDTPTR+4(,@15)                                  0454 01401000
         BE    @RF00454                                            0454 01402000
*         DO;                       /*                       @Y30LB39   01403000
*                                                            @Y30LB39*/ 01404000
*                                                                  0455 01405000
*           /*********************************************************/ 01406000
*           /*                                                       */ 01407000
*           /*                                               @Y30LB39*/ 01408000
*           /* IF THE NUMBER OF CURRENT BACKUPS HAS          @Y30LB39*/ 01409000
*           /* REACHED OR EXCEEDED THE BACKUP LIMIT,         @Y30LB39*/ 01410000
*           /* THEN REUSE THE OLDEST BACKUP.                 @Y30LB39*/ 01411000
*           /* CALL RVVIRTN TO RETRIEVE THE OLDEST           @Y30LB39*/ 01412000
*           /* BACKUP COPY RECORD. IF THE RETURN             @Y30LB39*/ 01413000
*           /* CODE IS NOT ZERO, THEN SET CONDITION          @Y30LB39*/ 01414000
*           /* CODE TO FOUR AND EXIT THIS ROUTINE.           @Y30LB39*/ 01415000
*           /*                                               @Y30LB39*/ 01416000
*           /*                                                       */ 01417000
*           /*********************************************************/ 01418000
*                                                                  0456 01419000
*                                   /*                       @Y30LB39*/ 01420000
*           IF BASNBKUP=>BASBKLMT THEN/*                     @Y30LB39*/ 01421000
         CLC   BASNBKUP(1,BASEVPTR),BASBKLMT(BASEVPTR)             0456 01422000
         BL    @RF00456                                            0456 01423000
*             DO;                   /*                       @Y30LB39*/ 01424000
*               RECTYPE=BKUPCHAR;   /*                       @Y30LB39*/ 01425000
         MVC   RECTYPE(4),BKUPCHAR                                 0458 01426000
*               CALL RVVIRTN;       /*                       @Y30LB39*/ 01427000
         BAL   @14,RVVIRTN                                         0459 01428000
*               RESPECIFY                                          0460 01429000
*                 RTNREG RSTD;                                     0460 01430000
*               TESTRC=RTNREG;                                     0461 01431000
         LR    TESTRC,RTNREG                                       0461 01432000
*               RESPECIFY                                          0462 01433000
*                 RTNREG UNRSTD;    /*                       @Y30LB39*/ 01434000
*               IF TESTRC^=0 THEN   /*                       @Y30LB39*/ 01435000
         LTR   TESTRC,TESTRC                                       0463 01436000
         BZ    @RF00463                                            0463 01437000
*                 REUSERC=LASTCC04; /*                       @Y30LB39   01438000
*                                                            @Y30LB39*/ 01439000
*                                                                  0464 01440000
         LA    REUSERC,4                                           0464 01441000
*               /*****************************************************/ 01442000
*               /*                                                   */ 01443000
*               /*                                           @Y30LB39*/ 01444000
*               /* CALL OBKUPRTN TO DETERMINE IF EITHER      @Y30LB39*/ 01445000
*               /* CARTRIDGE OF THE BACKUP COPY IS OUT OF    @Y30LB39*/ 01446000
*               /* MASS STORAGE FACILITY. IF THE RETURN      @Y30LB39*/ 01447000
*               /* CODE IS NON-ZERO, RETURN TO CALLER        @Y30LB39*/ 01448000
*               /* WITH A CONDITION CODE OF FOUR.            @Y30LB39*/ 01449000
*               /*                                           @Y30LB39*/ 01450000
*               /*                                                   */ 01451000
*               /*****************************************************/ 01452000
*                                                                  0465 01453000
*                                   /*                       @Y30LB39*/ 01454000
*               IF REUSERC=0 THEN   /*                       @Y30LB39*/ 01455000
@RF00463 C     REUSERC,@CF00115                                    0465 01456000
         BNE   @RF00465                                            0465 01457000
*                 DO;               /*                       @Y30LB39*/ 01458000
*                   CALL OBKUPRTN;  /*                       @Y30LB39*/ 01459000
         BAL   @14,OBKUPRTN                                        0467 01460000
*                   RESPECIFY                                      0468 01461000
*                     RTNREG RSTD;                                 0468 01462000
*                   TESTRC=RTNREG;                                 0469 01463000
         LR    TESTRC,RTNREG                                       0469 01464000
*                   RESPECIFY                                      0470 01465000
*                     RTNREG UNRSTD;/*                       @Y30LB39*/ 01466000
*                   IF TESTRC^=0 THEN/*                      @Y30LB39*/ 01467000
         LTR   TESTRC,TESTRC                                       0471 01468000
         BZ    @RF00471                                            0471 01469000
*                     REUSERC=LASTCC04;/*                    @Y30LB39*/ 01470000
         LA    REUSERC,4                                           0472 01471000
*                 END;              /*                       @Y30LB39   01472000
*                                                            @Y30LB39*/ 01473000
*                                                                  0473 01474000
@RF00471 DS    0H                                                  0474 01475000
*               /*****************************************************/ 01476000
*               /*                                                   */ 01477000
*               /*                                           @Y30LB39*/ 01478000
*               /* SINCE AN EXISTING COPY CAN BE USED,       @Y30LB39*/ 01479000
*               /* SET REUSEFLG ON. SAVE THE CARTRIDGE       @Y30LB39*/ 01480000
*               /* SERIAL NUMBERS IN THE INTERNAL TABLE      @Y30LB39*/ 01481000
*               /* ALONG WITH THE COPY DATE FROM THE         @Y30LB39*/ 01482000
*               /* COPY RECORD. THE CARTRIDGE SERIAL         @Y30LB39*/ 01483000
*               /* NUMBERS WILL BE NEEDED IN THE COPY        @Y30LB39*/ 01484000
*               /* OPERATION. THEY ARE SAVED IN THE          @Y30LB39*/ 01485000
*               /* INTERNAL TABLE SINCE ONE OF SEVERAL       @Y30LB39*/ 01486000
*               /* ROUTINES DETERMINE THE ACTUAL CSN'S       @Y30LB39*/ 01487000
*               /* USED FOR THE TARGET VOLUME.               @Y30LB39*/ 01488000
*               /*                                           @Y30LB39*/ 01489000
*               /*                                                   */ 01490000
*               /*****************************************************/ 01491000
*                                                                  0474 01492000
*                                   /*                       @Y30LB39*/ 01493000
*               IF REUSERC=0 THEN   /*                       @Y30LB39*/ 01494000
@RF00465 C     REUSERC,@CF00115                                    0474 01495000
         BNE   @RF00474                                            0474 01496000
*                 DO;               /*                       @Y30LB39*/ 01497000
*                   REUSEFLG=ON;    /*                       @Y30LB39*/ 01498000
         OI    REUSEFLG,B'10000000'                                0476 01499000
*                   CSN1AREA=COPCSN1;/*                      @Y30LB39*/ 01500000
         MVC   CSN1AREA(12),COPCSN1(COPYVPTR)                      0477 01501000
*                   CSN2AREA=COPCSN2;/*                      @Y30LB39*/ 01502000
         MVC   CSN2AREA(12),COPCSN2(COPYVPTR)                      0478 01503000
*                   NEWCDATE=COPDATE;/*                      @Y30LB39*/ 01504000
         MVC   NEWCDATE(4),COPDATE(COPYVPTR)                       0479 01505000
*                 END;              /*                       @Y30LB39*/ 01506000
*             END;                  /*                       @Y30LB39*/ 01507000
*                                                                  0481 01508000
*           /*********************************************************/ 01509000
*           /*                                                       */ 01510000
*           /* THE BACKUP PARM IS SPECIFIED BUT THE          @Y30LB39*/ 01511000
*           /* BACKUP LIMIT HAS NOT BEEN REACHED. EXIT FROM THIS PROC*/ 01512000
*           /* SINCE A NEW COPY VOLUME WILL BE CREATED FROM SCRATCH  */ 01513000
*           /* CARTRIDGES.                                   @Y30LB39*/ 01514000
*           /*                                                       */ 01515000
*           /*********************************************************/ 01516000
*                                                                  0482 01517000
*           ELSE                                                   0482 01518000
*             ;                     /*                       @Y30LB39*/ 01519000
@RF00456 DS    0H                                                  0483 01520000
*         END;                      /*                       @Y30LB39*/ 01521000
*                                                                  0483 01522000
*   /*****************************************************************/ 01523000
*   /*                                                               */ 01524000
*   /*                                                       @Y30LB39*/ 01525000
*   /* BACKUP IS NOT SPECIFIED. EXIT FROM THIS               @Y30LB39*/ 01526000
*   /* PROCEDURE. IT HAS BEEN DETERMINED THAT                @Y30LB39*/ 01527000
*   /* AN INCOMPLETE COPY DOES NOT EXIST THAT                @Y30LB39*/ 01528000
*   /* CAN BE REUSED AS THE TARGET VOLUME.                   @Y30LB39*/ 01529000
*   /* SINCE THE NEW COPY IS NOT DESIRED FOR BKUP            @Y30LB39*/ 01530000
*   /* PURPOSES, NO CHECK IS MADE TO DETERMINE               @Y30LB39*/ 01531000
*   /* WHETHER THE OLDEST BACKUP SHOULD BE REUSED            @Y30LB39*/ 01532000
*   /* AS THE TARGET VOLUME.                                 @Y30LB39*/ 01533000
*   /*                                                       @Y30LB39*/ 01534000
*   /*                                                               */ 01535000
*   /*****************************************************************/ 01536000
*                                                                  0484 01537000
*       ELSE                                                       0484 01538000
*         ;                         /*                       @Y30LB39*/ 01539000
@RF00454 DS    0H                                                  0485 01540000
*     ELSE                          /*                       #Y30LB39*/ 01541000
*       DO;                         /*                       @Y30LB39*/ 01542000
         B     @RC00453                                            0485 01543000
@RF00453 DS    0H                                                  0486 01544000
*         REUSEFLG=ON;              /*                       @Y30LB39*/ 01545000
         OI    REUSEFLG,B'10000000'                                0486 01546000
*         CSN1AREA=COPCSN1;         /*                       @Y30LB39*/ 01547000
         MVC   CSN1AREA(12),COPCSN1(COPYVPTR)                      0487 01548000
*         CSN2AREA=COPCSN2;         /*                       @Y30LB39*/ 01549000
         MVC   CSN2AREA(12),COPCSN2(COPYVPTR)                      0488 01550000
*         NEWCDATE=COPDATE;         /*                       @Y30LB39*/ 01551000
         MVC   NEWCDATE(4),COPDATE(COPYVPTR)                       0489 01552000
*       END;                        /*                       @Y30LB39   01553000
*                                                            @Y30LB39*/ 01554000
*                                                                  0490 01555000
*   /*****************************************************************/ 01556000
*   /*                                                               */ 01557000
*   /*                                                       @Y30LB39*/ 01558000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 01559000
*   /*                                                       @Y30LB39*/ 01560000
*   /*                                                               */ 01561000
*   /*****************************************************************/ 01562000
*                                                                  0491 01563000
*                                   /*                       @Y30LB39*/ 01564000
*   REG14=RETADDR2;                 /*                       @Y30LB39   01565000
*                                                            @Y30LB39*/ 01566000
*                                                                  0491 01567000
@RC00453 DS    0H                                                  0491 01568000
@RF00452 LR    REG14,RETADDR2                                      0491 01569000
*   /*****************************************************************/ 01570000
*   /*                                                               */ 01571000
*   /*                                                       @Y30LB39*/ 01572000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 01573000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 01574000
*   /*                                                       @Y30LB39*/ 01575000
*   /*                                                               */ 01576000
*   /*****************************************************************/ 01577000
*                                                                  0492 01578000
*                                   /*                       @Y30LB39*/ 01579000
*   RETURN CODE(REUSERC);           /*                       @Y30LB39*/ 01580000
         LR    @15,REUSERC                                         0492 01581000
@EL00004 DS    0H                                                  0492 01582000
@EF00004 DS    0H                                                  0492 01583000
@ER00004 BR    @14                                                 0492 01584000
*   END REUSERTN;                   /*                       @Y30LB39*/ 01585000
*                                                                  0494 01586000
*   /*****************************************************************/ 01587000
*   /*                                                               */ 01588000
*   /*                                                       @Y30LB39*/ 01589000
*   /* PROCEDURE NAME - OBKUPRTN                             @Y30LB39*/ 01590000
*   /*                                                       @Y30LB39*/ 01591000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 01592000
*   /* DETERMINE IF BOTH CARTRIDGES OF THE BACKUP            @Y30LB39*/ 01593000
*   /* COPY TO BE REUSED ARE IN THE MASS STORAGE             @Y30LB39*/ 01594000
*   /* FACILITY.                                             @Y30LB39*/ 01595000
*   /* IF BOTH CARTRIDGES ARE IN THE MASS STORAGE            @Y30LB39*/ 01596000
*   /* FACILITY, THEN CONTROL MERELY RETURNS TO              @Y30LB39*/ 01597000
*   /* THE CALLER. OTHERWISE, SERIES OF MESSAGES ARE         @Y30LB39*/ 01598000
*   /* ISSUED TO NOTIFY THE USER WHICH CARTRIDGES WERE       @Y30LB39*/ 01599000
*   /* NOT AVAILABLE FOR THE COPY OPERATION.                 @Y30LB39*/ 01600000
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/ 01601000
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/ 01602000
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/ 01603000
*   /* IDC3702I TO SAY TARGET CAN NOT BE USED                @Y30LB39*/ 01604000
*   /* IDC2076I TO IDENTIFY MISSING CARTRIDGE(S)             @Y30LB39*/ 01605000
*   /* IDC0098I TO GIVE LOCATION OF VOLUME                   @Y30LB39*/ 01606000
*   /*                                                       @Y30LB39*/ 01607000
*   /* INPUT - FDTTBL AND DARGLIST                           @Y30LB39*/ 01608000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 01609000
*   /*                                                       @Y30LB39*/ 01610000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 01611000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 01612000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 01613000
*   /* 4 - ONE OR BOTH OF CARTRIDGES WAS OUT OF              @Y30LB39*/ 01614000
*   /* THE MASS STORAGE FACILITY.                            @Y30LB39*/ 01615000
*   /* COPYVTBL IS UPDATED.                                  @Y30LB39*/ 01616000
*   /*                                                       @Y30LB39*/ 01617000
*   /*                                                               */ 01618000
*   /*****************************************************************/ 01619000
*                                                                  0494 01620000
*OBKUPRTN:                                                         0494 01621000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 01622000
*                                                                  0494 01623000
OBKUPRTN DS    0H                                                  0495 01624000
*   /*****************************************************************/ 01625000
*   /*                                                               */ 01626000
*   /*                                                       @Y30LB39*/ 01627000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 01628000
*   /*                                                       @Y30LB39*/ 01629000
*   /*                                                               */ 01630000
*   /*****************************************************************/ 01631000
*                                                                  0495 01632000
*                                   /*                       @Y30LB39*/ 01633000
*   DCL                                                            0495 01634000
*     OBKUPRC FIXED(8);             /* RETURN CODE           @Y30LB39*/ 01635000
*                                   /*                       @Y30LB39*/ 01636000
*                                                                  0496 01637000
*   /*****************************************************************/ 01638000
*   /*                                                               */ 01639000
*   /*                                                       @Y30LB39*/ 01640000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 01641000
*   /*                                                       @Y30LB39*/ 01642000
*   /*                                                               */ 01643000
*   /*****************************************************************/ 01644000
*                                                                  0496 01645000
*                                   /*                       @Y30LB39*/ 01646000
*   RETADDR3=REG14;                 /*                       @Y30LB39   01647000
*                                                            @Y30LB39*/ 01648000
*                                                                  0496 01649000
         ST    REG14,RETADDR3                                      0496 01650000
*   /*****************************************************************/ 01651000
*   /*                                                               */ 01652000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 01653000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 01654000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 01655000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 01656000
*   /*                                                       @Y30LB39*/ 01657000
*   /*                                                               */ 01658000
*   /*****************************************************************/ 01659000
*                                                                  0497 01660000
*                                   /*                       @Y30LB39*/ 01661000
*   OLDERID2=NEWERID2;                                             0497 01662000
         L     @07,@PC00001                                        0497 01663000
         L     @07,GDTTR2(,@07)                                    0497 01664000
         MVC   @TS00001(95),NEWERID2(@07)                          0497 01665000
         MVC   OLDERID2(95,@07),@TS00001                           0497 01666000
*   NEWID2='COBK';                  /*                       @Y30LB39   01667000
*                                                            @Y30LB39*/ 01668000
*                                                                  0498 01669000
         MVC   NEWID2(4,@07),@CC01650                              0498 01670000
*   /*****************************************************************/ 01671000
*   /*                                                               */ 01672000
*   /*                                                       @Y30LB39*/ 01673000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 01674000
*   /*                                                       @Y30LB39*/ 01675000
*   /*                                                               */ 01676000
*   /*****************************************************************/ 01677000
*                                                                  0499 01678000
*                                   /*                       @Y30LB39*/ 01679000
*   OBKUPRC=LASTCC00;               /*                       @Y30LB39   01680000
*                                                            @Y30LB39*/ 01681000
*                                                                  0499 01682000
         SLR   OBKUPRC,OBKUPRC                                     0499 01683000
*   /*****************************************************************/ 01684000
*   /*                                                               */ 01685000
*   /*                                                       @Y30LB39*/ 01686000
*   /* IF EITHER CARTRIDGE IS OUT OF THE                     @Y30LB39*/ 01687000
*   /* MASS STORAGE FACILITY, THEN SET CONDITION             @Y30LB39*/ 01688000
*   /* CODE TO FOUR AND ISSUE EXPLANATORY                    @Y30LB39*/ 01689000
*   /* MESSAGES.                                             @Y30LB39*/ 01690000
*   /*                                                       @Y30LB39*/ 01691000
*   /*                                                               */ 01692000
*   /*****************************************************************/ 01693000
*                                                                  0500 01694000
*                                   /*                       @Y30LB39*/ 01695000
*   IF COPLIB1=HEXFF|COPLIB2=HEXFF THEN/*                    @Y30LB39*/ 01696000
         CLC   COPLIB1(1,COPYVPTR),HEXFF                           0500 01697000
         BE    @RT00500                                            0500 01698000
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0500 01699000
         BNE   @RF00500                                            0500 01700000
@RT00500 DS    0H                                                  0501 01701000
*     DO;                           /*                       @Y30LB39*/ 01702000
*       OBKUPRC=LASTCC04;           /*                       @Y30LB39*/ 01703000
         LA    @07,4                                               0502 01704000
         LR    OBKUPRC,@07                                         0502 01705000
*       DARGLIST=''B;               /*                       @Y30LB39   01706000
*                                                            @Y30LB39*/ 01707000
*                                                                  0503 01708000
         L     @02,DDSTRU                                          0503 01709000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0503 01710000
*       /*************************************************************/ 01711000
*       /*                                                           */ 01712000
*       /*                                                   @Y30LB39*/ 01713000
*       /* ISSUE UPRINT FOR MESSAGE IDC3702I                 @Y30LB39*/ 01714000
*       /* INSERT COPY DATE FROM COPY RECORD.                @Y30LB39*/ 01715000
*       /*                                                   @Y30LB39*/ 01716000
*       /*                                                           */ 01717000
*       /*************************************************************/ 01718000
*                                                                  0504 01719000
*                                   /*                       @Y30LB39*/ 01720000
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/ 01721000
         MVC   DARGSMOD(3,@02),@CC01548                            0504 01722000
*       DARGSENT=MSG3702I;          /*                       @Y30LB39*/ 01723000
         MVI   DARGSENT(@02),X'03'                                 0505 01724000
*       DARGDBP=ADDR(COPDATE);      /*                       @Y30LB39*/ 01725000
         LA    @15,COPDATE(,COPYVPTR)                              0506 01726000
         ST    @15,DARGDBP(,@02)                                   0506 01727000
*       DARGILP=LENGTH(COPDATE);    /*                       @Y30LB39   01728000
*                                                            @Y30LB39*/ 01729000
         STH   @07,DARGILP(,@02)                                   0507 01730000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   01731000
*                                                            @Y30LB39*/ 01732000
*                                                                  0508 01733000
         L     @07,@PC00001                                        0508 01734000
         ST    @07,@AL00001                                        0508 01735000
         LA    @02,@CF00115                                        0508 01736000
         ST    @02,@AL00001+4                                      0508 01737000
         LA    @02,DDSTRU                                          0508 01738000
         ST    @02,@AL00001+8                                      0508 01739000
         MVI   @AL00001+8,X'80'                                    0508 01740000
         L     @15,GDTPRT(,@07)                                    0508 01741000
         LA    @01,@AL00001                                        0508 01742000
         BALR  @14,@15                                             0508 01743000
*       /*************************************************************/ 01744000
*       /*                                                           */ 01745000
*       /*                                                   @Y30LB39*/ 01746000
*       /* ISSUE UPRINT FOR SECONDARY MESSAGE                @Y30LB39*/ 01747000
*       /* IDC2076I. INSERT FROM THE COPY                    @Y30LB39*/ 01748000
*       /* RECORD ONE OR BOTH CSNS AND THE                   @Y30LB39*/ 01749000
*       /* COPY DATE.                                        @Y30LB39*/ 01750000
*       /*                                                   @Y30LB39*/ 01751000
*       /*                                                           */ 01752000
*       /*************************************************************/ 01753000
*                                                                  0509 01754000
*                                   /*                       @Y30LB39*/ 01755000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 01756000
         L     @07,DDSTRU                                          0509 01757000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0509 01758000
*       DARGSMOD=COMNMSG;           /*                       @Y30LB39*/ 01759000
         MVC   DARGSMOD(3,@07),@CC01550                            0510 01760000
*       DARGSENT=MSG2076I;          /*                       @Y30LB39*/ 01761000
         MVI   DARGSENT(@07),X'1E'                                 0511 01762000
*       IF COPLIB1=HEXFF&COPLIB2=HEXFF THEN/*                @Y30LB39*/ 01763000
         CLC   COPLIB1(1,COPYVPTR),HEXFF                           0512 01764000
         BNE   @RF00512                                            0512 01765000
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0512 01766000
         BNE   @RF00512                                            0512 01767000
*         DARGCNT=BOTHCSNS;         /*                       @Y30LB39*/ 01768000
         MVC   DARGCNT(2,@07),@CH00153                             0513 01769000
*       ELSE                        /*                       @Y30LB39*/ 01770000
*         DARGCNT=ONECSN;           /*                       @Y30LB39*/ 01771000
         B     @RC00512                                            0514 01772000
@RF00512 L     @07,DDSTRU                                          0514 01773000
         MVC   DARGCNT(2,@07),@CH00219                             0514 01774000
*       IF DARGCNT=BOTHCSNS THEN    /*                       @Y30LB39*/ 01775000
@RC00512 L     @07,DDSTRU                                          0515 01776000
         CLC   DARGCNT(2,@07),@CH00153                             0515 01777000
         BNE   @RF00515                                            0515 01778000
*         DO;                       /*                       @Y30LB39*/ 01779000
*           DARGILP=LENGTH(COPCSN1);/*                       @Y30LB39*/ 01780000
         LA    @02,12                                              0517 01781000
         STH   @02,DARGILP(,@07)                                   0517 01782000
*           DARGDBP=ADDR(COPCSN1);  /*                       @Y30LB39*/ 01783000
         LA    @15,COPCSN1(,COPYVPTR)                              0518 01784000
         ST    @15,DARGDBP(,@07)                                   0518 01785000
*           DARGINS(1)=ONECSN;      /*                       @Y30LB39*/ 01786000
         MVC   DARGINS(2,@07),@CH00219                             0519 01787000
*           DARGINL(1)=LENGTH(COPCSN2);/*                    @Y30LB39*/ 01788000
         STH   @02,DARGINL(,@07)                                   0520 01789000
*           DARGDTM(1)=ADDR(COPCSN2);/*                      @Y30LB39*/ 01790000
         LA    @02,COPCSN2(,COPYVPTR)                              0521 01791000
         ST    @02,DARGDTM(,@07)                                   0521 01792000
*         END;                      /*                       @Y30LB39*/ 01793000
*       ELSE                        /*                       @Y30LB39*/ 01794000
*         IF COPLIB1=HEXFF THEN     /*                       @Y30LB39*/ 01795000
         B     @RC00515                                            0523 01796000
@RF00515 CLC   COPLIB1(1,COPYVPTR),HEXFF                           0523 01797000
         BNE   @RF00523                                            0523 01798000
*           DO;                     /*                       @Y30LB39*/ 01799000
*             DARGILP=LENGTH(COPCSN1);/*                     @Y30LB39*/ 01800000
         L     @07,DDSTRU                                          0525 01801000
         MVC   DARGILP(2,@07),@CH00567                             0525 01802000
*             DARGDBP=ADDR(COPCSN1);/*                       @Y30LB39*/ 01803000
         LA    @02,COPCSN1(,COPYVPTR)                              0526 01804000
         ST    @02,DARGDBP(,@07)                                   0526 01805000
*           END;                    /*                       @Y30LB39*/ 01806000
*         ELSE                      /*                       @Y30LB39*/ 01807000
*           DO;                     /*                       @Y30LB39*/ 01808000
         B     @RC00523                                            0528 01809000
@RF00523 DS    0H                                                  0529 01810000
*             DARGILP=LENGTH(COPCSN2);/*                     @Y30LB39*/ 01811000
         L     @07,DDSTRU                                          0529 01812000
         MVC   DARGILP(2,@07),@CH00567                             0529 01813000
*             DARGDBP=ADDR(COPCSN2);/*                       @Y30LB39*/ 01814000
         LA    @02,COPCSN2(,COPYVPTR)                              0530 01815000
         ST    @02,DARGDBP(,@07)                                   0530 01816000
*           END;                    /*                       @Y30LB39*/ 01817000
*       IF DARGCNT=ONECSN THEN      /*                       @Y30LB39*/ 01818000
@RC00523 DS    0H                                                  0532 01819000
@RC00515 L     @07,DDSTRU                                          0532 01820000
         CLC   DARGCNT(2,@07),@CH00219                             0532 01821000
         BNE   @RF00532                                            0532 01822000
*         DO;                       /*                       @Y30LB39*/ 01823000
*           DARGINS(ONECSN)=2;      /*                       @Y30LB39*/ 01824000
         MVC   DARGINS(2,@07),@CH00153                             0534 01825000
*           DARGINL(ONECSN)=LENGTH(COPDATE);/*               @Y30LB39*/ 01826000
         MVC   DARGINL(2,@07),@CH00042                             0535 01827000
*           DARGDTM(ONECSN)=ADDR(COPDATE);/*                 @Y30LB39*/ 01828000
         LA    @02,COPDATE(,COPYVPTR)                              0536 01829000
         ST    @02,DARGDTM(,@07)                                   0536 01830000
*         END;                      /*                       @Y30LB39*/ 01831000
*       ELSE                        /*                       @Y30LB39*/ 01832000
*         DO;                       /*                       @Y30LB39*/ 01833000
         B     @RC00532                                            0538 01834000
@RF00532 DS    0H                                                  0539 01835000
*           DARGINS(DARGCNT)=DARGCNT;/*                      @Y30LB39*/ 01836000
         L     @07,DDSTRU                                          0539 01837000
         LH    @02,DARGCNT(,@07)                                   0539 01838000
         LR    @15,@02                                             0539 01839000
         SLA   @15,3                                               0539 01840000
         STH   @02,DARGINS-8(@15,@07)                              0539 01841000
*           DARGINL(DARGCNT)=LENGTH(COPDATE);/*              @Y30LB39*/ 01842000
         LA    @02,4                                               0540 01843000
         STH   @02,DARGINL-8(@15,@07)                              0540 01844000
*           DARGDTM(DARGCNT)=ADDR(COPDATE);/*                @Y30LB39*/ 01845000
         LA    @02,COPDATE(,COPYVPTR)                              0541 01846000
         ST    @02,DARGDTM-8(@15,@07)                              0541 01847000
*         END;                      /*                       @Y30LB39   01848000
*                                                            @Y30LB39*/ 01849000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   01850000
*                                                            @Y30LB39*/ 01851000
*                                                                  0543 01852000
@RC00532 L     @07,@PC00001                                        0543 01853000
         ST    @07,@AL00001                                        0543 01854000
         LA    @02,@CF00115                                        0543 01855000
         ST    @02,@AL00001+4                                      0543 01856000
         LA    @02,DDSTRU                                          0543 01857000
         ST    @02,@AL00001+8                                      0543 01858000
         MVI   @AL00001+8,X'80'                                    0543 01859000
         L     @15,GDTPRT(,@07)                                    0543 01860000
         LA    @01,@AL00001                                        0543 01861000
         BALR  @14,@15                                             0543 01862000
*       /*************************************************************/ 01863000
*       /*                                                           */ 01864000
*       /*                                                   @Y30LB39*/ 01865000
*       /* IF COPDEST IS NOT BLANK, ISSUE UPRINT             @Y30LB39*/ 01866000
*       /* FOR SECONDARY MESSAGE IDC0098I INSERT             @Y30LB39*/ 01867000
*       /* THE LOCATION DATA FROM THE COPY RECORD.           @Y30LB39*/ 01868000
*       /*                                                   @Y30LB39*/ 01869000
*       /*                                                           */ 01870000
*       /*************************************************************/ 01871000
*                                                                  0544 01872000
*                                   /*                       @Y30LB39*/ 01873000
*       IF COPDEST^=THIRTYBK THEN   /*                       @Y30LB39*/ 01874000
         CLC   COPDEST(30,COPYVPTR),THIRTYBK                       0544 01875000
         BE    @RF00544                                            0544 01876000
*         DO;                       /*                       @Y30LB39*/ 01877000
*           DARGLIST=''B;           /*                       @Y30LB39*/ 01878000
         L     @07,DDSTRU                                          0546 01879000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0546 01880000
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/ 01881000
         MVC   DARGSMOD(3,@07),@CC01550                            0547 01882000
*           DARGSENT=MSG0098I;      /*                       @Y30LB39*/ 01883000
         MVI   DARGSENT(@07),X'02'                                 0548 01884000
*           DARGDBP=ADDR(COPDEST);  /*                       @Y30LB39*/ 01885000
         LA    @02,COPDEST(,COPYVPTR)                              0549 01886000
         ST    @02,DARGDBP(,@07)                                   0549 01887000
*           DARGILP=LENGTH(COPDEST);/*                       @Y30LB39   01888000
*                                                            @Y30LB39*/ 01889000
         MVC   DARGILP(2,@07),@CH01085                             0550 01890000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39   01891000
*                                                            @Y30LB39*/ 01892000
         L     @07,@PC00001                                        0551 01893000
         ST    @07,@AL00001                                        0551 01894000
         LA    @02,@CF00115                                        0551 01895000
         ST    @02,@AL00001+4                                      0551 01896000
         LA    @02,DDSTRU                                          0551 01897000
         ST    @02,@AL00001+8                                      0551 01898000
         MVI   @AL00001+8,X'80'                                    0551 01899000
         L     @15,GDTPRT(,@07)                                    0551 01900000
         LA    @01,@AL00001                                        0551 01901000
         BALR  @14,@15                                             0551 01902000
*         END;                      /*                       @Y30LB39*/ 01903000
*     END;                          /*                       @Y30LB39*/ 01904000
*   ELSE                            /*                       @Y30LB39   01905000
*                                                            @Y30LB39*/ 01906000
*                                                                  0554 01907000
*     /***************************************************************/ 01908000
*     /*                                                             */ 01909000
*     /*                                                     @Y30LB39*/ 01910000
*     /* THE CONDITION CODE IS ZERO SO SET FLAG              @Y30LB39*/ 01911000
*     /* ON INDICATING THAT CARTRIDGES CAN BE REUSED.        @Y30LB39*/ 01912000
*     /*                                                     @Y30LB39*/ 01913000
*     /*                                                             */ 01914000
*     /***************************************************************/ 01915000
*                                                                  0554 01916000
*                                   /*                       @Y30LB39*/ 01917000
*     OBKUPFLG=ON;                  /*                       @Y30LB39   01918000
*                                                            @Y30LB39*/ 01919000
*                                                                  0554 01920000
         B     @RC00500                                            0554 01921000
@RF00500 OI    OBKUPFLG,B'01000000'                                0554 01922000
*   /*****************************************************************/ 01923000
*   /*                                                               */ 01924000
*   /*                                                       @Y30LB39*/ 01925000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 01926000
*   /*                                                       @Y30LB39*/ 01927000
*   /*                                                               */ 01928000
*   /*****************************************************************/ 01929000
*                                                                  0555 01930000
*                                   /*                       @Y30LB39*/ 01931000
*   REG14=RETADDR3;                 /*                       @Y30LB39   01932000
*                                                            @Y30LB39*/ 01933000
*                                                                  0555 01934000
@RC00500 L     REG14,RETADDR3                                      0555 01935000
*   /*****************************************************************/ 01936000
*   /*                                                               */ 01937000
*   /*                                                       @Y30LB39*/ 01938000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 01939000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 01940000
*   /*                                                       @Y30LB39*/ 01941000
*   /*                                                               */ 01942000
*   /*****************************************************************/ 01943000
*                                                                  0556 01944000
*                                   /*                       @Y30LB39*/ 01945000
*   RETURN CODE(OBKUPRC);           /*                       @Y30LB39*/ 01946000
         LR    @15,OBKUPRC                                         0556 01947000
@EL00005 DS    0H                                                  0556 01948000
@EF00005 DS    0H                                                  0556 01949000
@ER00005 BR    @14                                                 0556 01950000
*   END OBKUPRTN;                   /*                       @Y30LB39*/ 01951000
*                                                                  0558 01952000
*   /*****************************************************************/ 01953000
*   /*                                                               */ 01954000
*   /*                                                       @Y30LB39*/ 01955000
*   /* PROCEDURE NAME - FILERTN                              @Y30LB39*/ 01956000
*   /*                                                       @Y30LB39*/ 01957000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 01958000
*   /* PROCESS UNIT ALLOCATION AND INSURE THAT UNIT          @Y30LB39*/ 01959000
*   /* ALLOCATED IS VIRTUAL.                                 @ZD00175*/ 01960000
*   /* IF THE USER HAD SPECIFED A FILE NAME, THEN            @Y30LB39*/ 01961000
*   /* A CHECK IS MERELY MADE TO INSURE THAT THE             @ZD00175*/ 01962000
*   /* UNIT IS VIRTUAL. OTHERWISE, A CHECK IS MADE           @ZD00175*/ 01963000
*   /* TO DETERMINE IF THE VOL IS ALREADY ALLOCATED          @ZD00175*/ 01964000
*   /* EXCLUSIVELY TO THIS TASK AND CAN BE REASSIGNED,       @ZD00175*/ 01965000
*   /* OR A VIRTUAL UNIT IS DYNAMICALLY ALLOCATED.           @ZD00175*/ 01966000
*   /*                                                       @Y30LB39*/ 01967000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 01968000
*   /* ALLOCATION ARGUMENT LIST                              @Y30LB39*/ 01969000
*   /* EXCLUSIVE ARGUMENT LIST                               @ZD00175*/ 01970000
*   /*                                                       @Y30LB39*/ 01971000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 01972000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 01973000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 01974000
*   /* 12 - IF DYNAMIC ALLOCATION FAILED OR IF               @Y30LB39*/ 01975000
*   /* NO UNIT IS AVAILABLE,OR IF THE VIRTUAL                @ZD00175*/ 01976000
*   /* UNIT CHECK FAILED. COPYVTBL IS UPDATED.               @ZD00175*/ 01977000
*   /*                                                       @Y30LB39*/ 01978000
*   /*                                                               */ 01979000
*   /*****************************************************************/ 01980000
*                                                                  0558 01981000
*FILERTN:                                                          0558 01982000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 01983000
*                                                                  0558 01984000
FILERTN  DS    0H                                                  0559 01985000
*   /*****************************************************************/ 01986000
*   /*                                                               */ 01987000
*   /*                                                       @Y30LB39*/ 01988000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 01989000
*   /*                                                       @Y30LB39*/ 01990000
*   /*                                                               */ 01991000
*   /*****************************************************************/ 01992000
*                                                                  0559 01993000
*                                   /*                       @Y30LB39*/ 01994000
*   DCL                                                            0559 01995000
*     FILERC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 01996000
*                                   /*                       @Y30LB39*/ 01997000
*                                                                  0560 01998000
*   /*****************************************************************/ 01999000
*   /*                                                               */ 02000000
*   /*                                                       @Y30LB39*/ 02001000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 02002000
*   /*                                                       @Y30LB39*/ 02003000
*   /*                                                               */ 02004000
*   /*****************************************************************/ 02005000
*                                                                  0560 02006000
*                                   /*                       @Y30LB39*/ 02007000
*   RETADDR1=REG14;                 /*                       @Y30LB39   02008000
*                                                            @Y30LB39*/ 02009000
*                                                                  0560 02010000
         ST    REG14,RETADDR1                                      0560 02011000
*   /*****************************************************************/ 02012000
*   /*                                                               */ 02013000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 02014000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 02015000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 02016000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 02017000
*   /*                                                       @Y30LB39*/ 02018000
*   /*                                                               */ 02019000
*   /*****************************************************************/ 02020000
*                                                                  0561 02021000
*                                   /*                       @Y30LB39*/ 02022000
*   OLDERID2=NEWERID2;                                             0561 02023000
         L     @09,@PC00001                                        0561 02024000
         L     @09,GDTTR2(,@09)                                    0561 02025000
         MVC   @TS00001(95),NEWERID2(@09)                          0561 02026000
         MVC   OLDERID2(95,@09),@TS00001                           0561 02027000
*   NEWID2='COFI';                  /*                       @Y30LB39   02028000
*                                                            @Y30LB39*/ 02029000
*                                                                  0562 02030000
         MVC   NEWID2(4,@09),@CC01655                              0562 02031000
*   /*****************************************************************/ 02032000
*   /*                                                               */ 02033000
*   /*                                                       @Y30LB39*/ 02034000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 02035000
*   /*                                                       @Y30LB39*/ 02036000
*   /*                                                               */ 02037000
*   /*****************************************************************/ 02038000
*                                                                  0563 02039000
*                                   /*                       @Y30LB39*/ 02040000
*   FILERC=LASTCC00;                /*                       @Y30LB39   02041000
*                                                            @Y30LB39*/ 02042000
*                                                                  0563 02043000
         SLR   @09,@09                                             0563 02044000
         LR    FILERC,@09                                          0563 02045000
*   /*****************************************************************/ 02046000
*   /*                                                               */ 02047000
*   /*                                                       @Y30LB39*/ 02048000
*   /* THE DDNAME FOR THE ALLOCATED UNIT IS                  @Y30LB39*/ 02049000
*   /* SAVED IN THE COMMON INTERNAL TABLE.                   @Y30LB39*/ 02050000
*   /* IF FILE IS SPECIFIED, THE DDNAME IS OBTAINED          @Y30LB39*/ 02051000
*   /* FROM FILEVAL.                                         @Y30LB39*/ 02052000
*   /*                                                       @Y30LB39*/ 02053000
*   /*                                                               */ 02054000
*   /*****************************************************************/ 02055000
*                                                                  0564 02056000
*                                   /*                       @Y30LB39*/ 02057000
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Y30LB39*/ 02058000
         L     @07,@PC00001+4                                      0564 02059000
         L     @07,FDTPTR+56(,@07)                                 0564 02060000
         CR    @07,@09                                             0564 02061000
         BE    @RF00564                                            0564 02062000
*     CUNITDDN=FILEVAL;             /*                       @Y30LB39*/ 02063000
         MVC   CUNITDDN(8),FILEVAL(@07)                            0565 02064000
*   ELSE                            /*                       @Y30LB39*/ 02065000
*     DO;                           /*                       @Y30LB39   02066000
*                                                            @Y30LB39*/ 02067000
*                                                                  0566 02068000
         B     @RC00564                                            0566 02069000
@RF00564 DS    0H                                                  0567 02070000
*       /*************************************************************/ 02071000
*       /*                                                           */ 02072000
*       /*                                                   @ZD00175*/ 02073000
*       /* DETERMINE WHETHER THE VOL TO BE COPIED IS         @ZD00175*/ 02074000
*       /* ALREADY ALLOCATED EXCLUSIVELY TO THE JOB          @ZD00175*/ 02075000
*       /* STEP AND A UNIT IS AVAILABLE FOR REUSE.           @ZD00175*/ 02076000
*       /*                                                   @ZD00175*/ 02077000
*       /*                                                           */ 02078000
*       /*************************************************************/ 02079000
*                                                                  0567 02080000
*       EXCLAGL=''B;                /*                       @ZD00175*/ 02081000
         LA    @09,EXCLAGLB                                        0567 02082000
         XC    EXCLAGL(23,@09),EXCLAGL(@09)                        0567 02083000
*       EXCLUCBP=ADDR(CUNITUCB);    /*                       @ZD00175*/ 02084000
         LA    @07,CUNITUCB                                        0568 02085000
         ST    @07,EXCLUCBP(,@09)                                  0568 02086000
*       EXCLDDP=ADDR(CUNITDDN);     /*                       @ZD00175*/ 02087000
         LA    @07,CUNITDDN                                        0569 02088000
         ST    @07,EXCLDDP(,@09)                                   0569 02089000
*       EXCLVOL=VOLVAL;             /*                       @ZD00175*/ 02090000
*                                                                  0570 02091000
         L     @07,@PC00001+4                                      0570 02092000
         L     @07,FDTPTR(,@07)                                    0570 02093000
         MVC   EXCLVOL(6,@09),VOLVAL(@07)                          0570 02094000
*       /*************************************************************/ 02095000
*       /*                                                           */ 02096000
*       /*                                                   @ZD00175*/ 02097000
*       /* INVOKE THE SYSTEM ADAPTER, IDCSA06, T0            @ZD00175*/ 02098000
*       /* SELECT A UNIT ALREADY EXCLUSIVELY ALLOCATED       @ZD00175*/ 02099000
*       /* TO THE VOLUME AND JOB STEP.                       @ZD00175*/ 02100000
*       /*                                                   @ZD00175*/ 02101000
*       /*                                                           */ 02102000
*       /*************************************************************/ 02103000
*                                                                  0571 02104000
*       CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*             @ZD00175*/ 02105000
         L     @07,@PC00001                                        0571 02106000
         ST    @07,@AL00001                                        0571 02107000
         LA    @02,SELECTX                                         0571 02108000
         ST    @02,@AL00001+4                                      0571 02109000
         ST    @09,@AL00001+8                                      0571 02110000
         MVI   @AL00001+8,X'80'                                    0571 02111000
         L     @15,GDTUNT(,@07)                                    0571 02112000
         LA    @01,@AL00001                                        0571 02113000
         BALR  @14,@15                                             0571 02114000
*       RESPECIFY                                                  0572 02115000
*         RTNREG RSTD;                                             0572 02116000
*       TESTRC=RTNREG;                                             0573 02117000
         LR    TESTRC,RTNREG                                       0573 02118000
*       RESPECIFY                                                  0574 02119000
*         RTNREG UNRSTD;            /*                       @ZD00175*/ 02120000
*                                                                  0575 02121000
*       /*************************************************************/ 02122000
*       /*                                                           */ 02123000
*       /*                                                   @ZD00175*/ 02124000
*       /* IF THE DDNAME AND UCB ADDRESS ARE NOT             @ZD00175*/ 02125000
*       /* RETURNED BY IDCSA06, THE VOLUME IS NOT AL-        @ZD00175*/ 02126000
*       /* READY ALLOCATED EXCLUSIVELY TO THIS TASK.         @ZD00175*/ 02127000
*       /* DYNAMICALLY ALLOCATE THE VOLUME FOR SHARED        @ZD00175*/ 02128000
*       /* USE.                                              @ZD00175*/ 02129000
*       /*                                                   @ZD00175*/ 02130000
*       /*                                                           */ 02131000
*       /*************************************************************/ 02132000
*                                                                  0575 02133000
*       IF TESTRC=0 THEN                                           0575 02134000
         SLR   @09,@09                                             0575 02135000
         CR    TESTRC,@09                                          0575 02136000
         BNE   @RF00575                                            0575 02137000
*         IF CUNITUCB=NULLPTR THEN                                 0576 02138000
         C     @09,CUNITUCB                                        0576 02139000
         BNE   @RF00576                                            0576 02140000
*           DO;                     /*                       @ZD00175*/ 02141000
*                                                                  0577 02142000
*             /*******************************************************/ 02143000
*             /*                                                     */ 02144000
*             /*                                             @ZD00175*/ 02145000
*             /* FILE WAS NOT SPECIFIED SO INITIALIZE THE    #Y30LB39*/ 02146000
*             /* ARGUMENT LIST TO DYNAMICALLY ALLOCATE A     #Y30LB39*/ 02147000
*             /* VIRTUAL UNIT, 3330V, FOR SHARED USE         @ZD00175*/ 02148000
*             /* AND TO MOUNT THE SOURCE VOLUME              #Y30LB39*/ 02149000
*             /*                                             @Y30LB39*/ 02150000
*             /*                                                     */ 02151000
*             /*******************************************************/ 02152000
*                                                                  0578 02153000
*                                   /*                       @Y30LB39*/ 02154000
*             ALLAGL=''B;           /*                       @Y30LB39*/ 02155000
         LA    @07,ALLAGLBF                                        0578 02156000
         XC    ALLAGL(31,@07),ALLAGL(@07)                          0578 02157000
*             ALLOPTVL=ON;          /*                       @Y30LB39*/ 02158000
         OI    ALLOPTVL(@07),B'10000000'                           0579 02159000
*             UNITNUM=UNITCNT;      /*                       @Y30LB39*/ 02160000
         LA    @15,1                                               0580 02161000
         STH   @15,UNITNUM                                         0580 02162000
*             UNITLNTH=TYPELNTH;    /*                       @Y30LB39*/ 02163000
         MVC   UNITLNTH(2),@CH00286                                0581 02164000
*             UNITTYPE='3330V';     /*                       @Y30LB39*/ 02165000
         MVC   UNITTYPE(5),@CC01656                                0582 02166000
*             ALLULP=ADDR(UNITLIST);/*                       @Y30LB39*/ 02167000
         LA    @14,UNITLIST                                        0583 02168000
         ST    @14,ALLULP(,@07)                                    0583 02169000
*             VOLNUMBR=UNITCNT;     /*                       @Y30LB39*/ 02170000
         STH   @15,VOLNUMBR                                        0584 02171000
*             VOLLENTH=VOLLEN;      /*                       @Y30LB39*/ 02172000
         L     @15,@PC00001+4                                      0585 02173000
         L     @15,FDTPTR(,@15)                                    0585 02174000
         SLR   @14,@14                                             0585 02175000
         IC    @14,VOLLEN(,@15)                                    0585 02176000
         STH   @14,VOLLENTH                                        0585 02177000
*             VOLSERNM=VOLVAL;      /*                       @Y30LB39*/ 02178000
         MVC   VOLSERNM(6),VOLVAL(@15)                             0586 02179000
*             ALLVLP=ADDR(VOLSERLT);/*                       @Y30LB39*/ 02180000
         LA    @15,VOLSERLT                                        0587 02181000
         ST    @15,ALLVLP(,@07)                                    0587 02182000
*             ALLVLCNT=VOLUMCNT;    /*                       @Y30LB39*/ 02183000
         MVI   ALLVLCNT(@07),X'01'                                 0588 02184000
*             ALLUNCNT=UNITCNT;     /*                       @Y30LB39*/ 02185000
         MVI   ALLUNCNT(@07),X'01'                                 0589 02186000
*             ALLOPTPV=ON;          /*                       @Y30LB39   02187000
*                                                            @Y30LB39*/ 02188000
*                                                                  0590 02189000
         OI    ALLOPTPV(@07),B'00100000'                           0590 02190000
*             /*******************************************************/ 02191000
*             /*                                                     */ 02192000
*             /*                                             @Y30LB39*/ 02193000
*             /* DUMP ALLOCATION ARGUMENT LIST PRIOR TO      @Y30LB39*/ 02194000
*             /* INVOKING DYNAMIC ALLOCATION ROUTINE.        @Y30LB39*/ 02195000
*             /*                                             @Y30LB39*/ 02196000
*             /*                                                     */ 02197000
*             /*******************************************************/ 02198000
*                                                                  0591 02199000
*                                   /*                       @Y30LB39*/ 02200000
*             IF GDTDBG=NULLPTR THEN                               0591 02201000
         L     @07,@PC00001                                        0591 02202000
         C     @09,GDTDBG(,@07)                                    0591 02203000
         BE    @RT00591                                            0591 02204000
*               ;                                                  0592 02205000
*             ELSE                                                 0593 02206000
*               DO;                                                0593 02207000
*                 DMPINDEX=ADDR(DUMPLIST);/*                 @Y30LB39*/ 02208000
         LA    DMPINDEX,DUMPLIST                                   0594 02209000
*                 DMPITMNM='ALLAGLBF';                             0595 02210000
         MVC   DMPITMNM(8,DMPINDEX),@CC01657                       0595 02211000
*                 DMPITMPT=ADDR(ALLAGLBF);                         0596 02212000
         LA    @09,ALLAGLBF                                        0596 02213000
         ST    @09,DMPITMPT(,DMPINDEX)                             0596 02214000
*                 DMPITMLN=LENGTH(ALLAGLBF);                       0597 02215000
         MVC   DMPITMLN(2,DMPINDEX),@CH00044                       0597 02216000
*                 DMPITMTP='H';                                    0598 02217000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0598 02218000
*                 DMPINDEX=DMPINDEX+DMPELEMT;                      0599 02219000
         AL    DMPINDEX,@CF00474                                   0599 02220000
*                 DMPTRM=DMPTRMVL;                                 0600 02221000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0600 02222000
*               END;                /*                       @Y30LB39   02223000
*                                                            @Y30LB39*/ 02224000
*             IF GDTDBG=NULLPTR THEN                               0602 02225000
@RT00591 L     @09,@PC00001                                        0602 02226000
         L     @09,GDTDBG(,@09)                                    0602 02227000
         LTR   @09,@09                                             0602 02228000
         BZ    @RT00602                                            0602 02229000
*               ;                                                  0603 02230000
*             ELSE                                                 0604 02231000
*               CALL IDCDB010(GDTTBL,'COAA',ADDR(DUMPLIST));/*     0604 02232000
*                                                            @Y30LB39   02233000
*                                                            @Y30LB39*/ 02234000
         L     @09,@PC00001                                        0604 02235000
         ST    @09,@AL00001                                        0604 02236000
         LA    @07,@CC01659                                        0604 02237000
         ST    @07,@AL00001+4                                      0604 02238000
         LA    @07,DUMPLIST                                        0604 02239000
         ST    @07,@AFTEMPS                                        0604 02240000
         LA    @07,@AFTEMPS                                        0604 02241000
         ST    @07,@AL00001+8                                      0604 02242000
         MVI   @AL00001+8,X'80'                                    0604 02243000
         L     @15,GDTDBG(,@09)                                    0604 02244000
         LA    @01,@AL00001                                        0604 02245000
         BALR  @14,@15                                             0604 02246000
*             CALL IDCSAAL0(GDTTBL,ALLAGL);/*                @Y30LB39   02247000
*                                                            @Y30LB39*/ 02248000
@RT00602 L     @09,@PC00001                                        0605 02249000
         ST    @09,@AL00001                                        0605 02250000
         LA    @07,ALLAGLBF                                        0605 02251000
         ST    @07,@AL00001+4                                      0605 02252000
         MVI   @AL00001+4,X'80'                                    0605 02253000
         L     @15,GDTALC(,@09)                                    0605 02254000
         LA    @01,@AL00001                                        0605 02255000
         BALR  @14,@15                                             0605 02256000
*             RESPECIFY                                            0606 02257000
*               RTNREG RSTD;                                       0606 02258000
*             TESTRC=RTNREG;                                       0607 02259000
         LR    TESTRC,RTNREG                                       0607 02260000
*             RESPECIFY                                            0608 02261000
*               RTNREG UNRSTD;      /*                       @Y30LB39   02262000
*                                                            @Y30LB39*/ 02263000
*                                                                  0608 02264000
*             /*******************************************************/ 02265000
*             /*                                                     */ 02266000
*             /*                                             @Y30LB39*/ 02267000
*             /* IF UALLOC RETURN CODE IS NOT ZERO, DYNAMIC  @Y30LB39*/ 02268000
*             /* ALLOCATION FAILED. THE UALLOC FUNCTION      @Y30LB39*/ 02269000
*             /* ISSUED THE APPROPRIATE MESSAGE.             @Y30LB39*/ 02270000
*             /* SET THE CONDITION CODE TO 12 PRIOR          @Y30LB39*/ 02271000
*             /* TO RETURNING TO CALLER.                     @Y30LB39*/ 02272000
*             /*                                             @Y30LB39*/ 02273000
*             /*                                                     */ 02274000
*             /*******************************************************/ 02275000
*                                                                  0609 02276000
*                                   /*                       @Y30LB39*/ 02277000
*             IF TESTRC^=0 THEN     /*                       @Y30LB39*/ 02278000
         LTR   TESTRC,TESTRC                                       0609 02279000
         BZ    @RF00609                                            0609 02280000
*               FILERC=LASTCC12;    /*                       @Y30LB39*/ 02281000
         LA    FILERC,12                                           0610 02282000
*             IF FILERC=0 THEN      /*                       @Y30LB39*/ 02283000
@RF00609 C     FILERC,@CF00115                                     0611 02284000
         BNE   @RF00611                                            0611 02285000
*               DO;                 /*                       @Y30LB39   02286000
*                                                            @Y30LB39*/ 02287000
*                                                                  0612 02288000
*                 /***************************************************/ 02289000
*                 /*                                                 */ 02290000
*                 /*                                         @Y30LB39*/ 02291000
*                 /* SET THE ALLOCFLG ON TO INDICATE THAT    @Y30LB39*/ 02292000
*                 /* DYNAMIC ALLOCATION WAS DONE.            @ZD00175*/ 02293000
*                 /*                                         @Y30LB39*/ 02294000
*                 /*                                                 */ 02295000
*                 /***************************************************/ 02296000
*                                                                  0613 02297000
*                                   /*                       @Y30LB39*/ 02298000
*                 ALLOCFLG=ON;      /*                       @Y30LB39   02299000
*                                                            @Y30LB39*/ 02300000
*                                                                  0613 02301000
         OI    ALLOCFLG,B'00100000'                                0613 02302000
*                 /***************************************************/ 02303000
*                 /*                                                 */ 02304000
*                 /*                                         @Y30LB39*/ 02305000
*                 /* SAVE DDNAME OF DYNAMICALLY ALLOCATED    @Y30LB39*/ 02306000
*                 /* UNIT NAME IN THE COPYV INTERNAL TABLE.  @Y30LB39*/ 02307000
*                 /*                                         @Y30LB39*/ 02308000
*                 /*                                                 */ 02309000
*                 /***************************************************/ 02310000
*                                                                  0614 02311000
*                                   /*                       @Y30LB39*/ 02312000
*                 CUNITDDN=ALLDDN;  /*                       @Y30LB39*/ 02313000
         LA    @09,ALLAGLBF                                        0614 02314000
         MVC   CUNITDDN(8),ALLDDN(@09)                             0614 02315000
*               END;                /*                       @ZD00175*/ 02316000
*           END;                    /*                       @ZD00175*/ 02317000
*                                                                  0617 02318000
*       /*************************************************************/ 02319000
*       /*                                                           */ 02320000
*       /*                                                   @ZD00175*/ 02321000
*       /* USE THE DDNAME AND UCB ADDRESS RETURNED BY        @ZD00175*/ 02322000
*       /* IDCSA06, SINCE THE VOL IS ALREADY ALLOCATED       @ZD00175*/ 02323000
*       /* EXCLUSIVELY TO THIS TASK.                         @ZD00175*/ 02324000
*       /*                                                   @ZD00175*/ 02325000
*       /*                                                           */ 02326000
*       /*************************************************************/ 02327000
*                                                                  0617 02328000
*         ELSE                                                     0617 02329000
*           ;                       /*                       @ZD00175*/ 02330000
*                                                                  0617 02331000
@RF00576 DS    0H                                                  0618 02332000
*       /*************************************************************/ 02333000
*       /*                                                           */ 02334000
*       /*                                                   @ZD00175*/ 02335000
*       /* IF NO UNIT IS AVAILABLE FOR THE VOLUME,           @ZD00175*/ 02336000
*       /* IDCSA06 ISSUED THE APPROPRIATE MESSAGE. SET       @ZD00175*/ 02337000
*       /* THE CONDITION CODE TO 12 PRIOR TO RETURNING       @ZD00175*/ 02338000
*       /* TO THE CALLER.                                    @ZD00175*/ 02339000
*       /*                                                   @ZD00175*/ 02340000
*       /*                                                           */ 02341000
*       /*************************************************************/ 02342000
*                                                                  0618 02343000
*       ELSE                                                       0618 02344000
*         FILERC=LASTCC12;          /*                       @ZD00175*/ 02345000
         B     @RC00575                                            0618 02346000
@RF00575 LA    FILERC,12                                           0618 02347000
*     END;                          /*                       @ZD00175*/ 02348000
@RC00575 DS    0H                                                  0620 02349000
*                                   /*                       #Y30LB39*/ 02350000
*                                                                  0620 02351000
*   /*****************************************************************/ 02352000
*   /*                                                               */ 02353000
*   /*                                                       @Y30LB39*/ 02354000
*   /* CHECK RETURN CODE                                     @Y30LB39*/ 02355000
*   /*                                                       @Y30LB39*/ 02356000
*   /*                                                               */ 02357000
*   /*****************************************************************/ 02358000
*                                                                  0620 02359000
*                                   /*                       @Y30LB39*/ 02360000
*   IF FILERC=0 THEN                /*                       @Y30LB39*/ 02361000
@RC00564 SLR   @09,@09                                             0620 02362000
         CR    FILERC,@09                                          0620 02363000
         BNE   @RF00620                                            0620 02364000
*     DO;                           /*                       @Y30LB39   02365000
*                                                            @Y30LB39*/ 02366000
*                                                                  0621 02367000
*       /*************************************************************/ 02368000
*       /*                                                           */ 02369000
*       /*                                                   @Y30LB39*/ 02370000
*       /* INITIALIZE CKAGL AND ISSUE UMSSUNIT MACRO         @Y30LB39*/ 02371000
*       /* TO VERIFY THAT THE DEVICE ALLOCATED IS            @Y30LB39*/ 02372000
*       /* VIRTUAL.                                          @ZD00175*/ 02373000
*       /*                                                   @Y30LB39*/ 02374000
*       /*                                                           */ 02375000
*       /*************************************************************/ 02376000
*                                                                  0622 02377000
*                                   /*                       @Y30LB39*/ 02378000
*       CKAGL=''B;                  /*                       @Y30LB39*/ 02379000
         LA    @07,CKAGLBUF                                        0622 02380000
         XC    CKAGL(29,@07),CKAGL(@07)                            0622 02381000
*       CKUCBPTR=ADDR(CUNITUCB);    /*                       @Y30LB39*/ 02382000
         LA    @15,CUNITUCB                                        0623 02383000
         ST    @15,CKUCBPTR(,@07)                                  0623 02384000
*       CKDDNAME=CUNITDDN;          /*                       @Y30LB39*/ 02385000
         MVC   CKDDNAME(8,@07),CUNITDDN                            0624 02386000
*       CKTESTVT=ON;                /*                       @Y30LB39   02387000
*                                                            @Y30LB39*/ 02388000
*                                                                  0625 02389000
         OI    CKTESTVT(@07),B'10000000'                           0625 02390000
*       /*************************************************************/ 02391000
*       /*                                                           */ 02392000
*       /*                                                   @Y30LB39*/ 02393000
*       /* DUMP CHECK ARGUMENT LIST PRIOR TO                 @Y30LB39*/ 02394000
*       /* INVOKING CHECK ALLOCATION ROUTINE.                @Y30LB39*/ 02395000
*       /*                                                   @Y30LB39*/ 02396000
*       /*                                                           */ 02397000
*       /*************************************************************/ 02398000
*                                                                  0626 02399000
*                                   /*                       @Y30LB39*/ 02400000
*       IF GDTDBG=NULLPTR THEN                                     0626 02401000
         L     @07,@PC00001                                        0626 02402000
         C     @09,GDTDBG(,@07)                                    0626 02403000
         BE    @RT00626                                            0626 02404000
*         ;                                                        0627 02405000
*       ELSE                                                       0628 02406000
*         DO;                                                      0628 02407000
*           DMPINDEX=ADDR(DUMPLIST);/*                       @Y30LB39*/ 02408000
         LA    DMPINDEX,DUMPLIST                                   0629 02409000
*           DMPITMNM='CKAGLBUF';                                   0630 02410000
         MVC   DMPITMNM(8,DMPINDEX),@CC01660                       0630 02411000
*           DMPITMPT=ADDR(CKAGLBUF);                               0631 02412000
         LA    @09,CKAGLBUF                                        0631 02413000
         ST    @09,DMPITMPT(,DMPINDEX)                             0631 02414000
*           DMPITMLN=LENGTH(CKAGLBUF);                             0632 02415000
         MVC   DMPITMLN(2,DMPINDEX),@CH00847                       0632 02416000
*           DMPITMTP='H';                                          0633 02417000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0633 02418000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0634 02419000
         AL    DMPINDEX,@CF00474                                   0634 02420000
*           DMPTRM=DMPTRMVL;                                       0635 02421000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0635 02422000
*         END;                      /*                       @Y30LB39   02423000
*                                                            @Y30LB39*/ 02424000
*       IF GDTDBG=NULLPTR THEN                                     0637 02425000
@RT00626 L     @09,@PC00001                                        0637 02426000
         L     @09,GDTDBG(,@09)                                    0637 02427000
         LTR   @09,@09                                             0637 02428000
         BZ    @RT00637                                            0637 02429000
*         ;                                                        0638 02430000
*       ELSE                                                       0639 02431000
*         CALL IDCDB010(GDTTBL,'COBB',ADDR(DUMPLIST));/*     @Y30LB39   02432000
*                                                            @Y30LB39*/ 02433000
         L     @09,@PC00001                                        0639 02434000
         ST    @09,@AL00001                                        0639 02435000
         LA    @07,@CC01661                                        0639 02436000
         ST    @07,@AL00001+4                                      0639 02437000
         LA    @07,DUMPLIST                                        0639 02438000
         ST    @07,@AFTEMPS                                        0639 02439000
         LA    @07,@AFTEMPS                                        0639 02440000
         ST    @07,@AL00001+8                                      0639 02441000
         MVI   @AL00001+8,X'80'                                    0639 02442000
         L     @15,GDTDBG(,@09)                                    0639 02443000
         LA    @01,@AL00001                                        0639 02444000
         BALR  @14,@15                                             0639 02445000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB39   02446000
*                                                            @Y30LB39*/ 02447000
@RT00637 L     @09,@PC00001                                        0640 02448000
         ST    @09,@AL00001                                        0640 02449000
         LA    @07,CHECK                                           0640 02450000
         ST    @07,@AL00001+4                                      0640 02451000
         LA    @07,CKAGLBUF                                        0640 02452000
         ST    @07,@AL00001+8                                      0640 02453000
         MVI   @AL00001+8,X'80'                                    0640 02454000
         L     @15,GDTUNT(,@09)                                    0640 02455000
         LA    @01,@AL00001                                        0640 02456000
         BALR  @14,@15                                             0640 02457000
*       RESPECIFY                                                  0641 02458000
*         RTNREG RSTD;                                             0641 02459000
*       TESTRC=RTNREG;                                             0642 02460000
         LR    TESTRC,RTNREG                                       0642 02461000
*       RESPECIFY                                                  0643 02462000
*         RTNREG UNRSTD;            /*                       @Y30LB39   02463000
*                                                            @Y30LB39*/ 02464000
*                                                                  0643 02465000
*       /*************************************************************/ 02466000
*       /*                                                           */ 02467000
*       /*                                                   @Y30LB39*/ 02468000
*       /* IF UMSSUNIT RETURN CODE IS NOT ZERO, AN           @Y30LB39*/ 02469000
*       /* APPROPRIATE MESSAGE WAS ISSUED BY THE             @Y30LB39*/ 02470000
*       /* CHECK FUNCTION. MERELY SET THE CONDITION          @Y30LB39*/ 02471000
*       /* CODE TO TWELVE PRIOR TO RETURNING TO CALLER       @Y30LB39*/ 02472000
*       /*                                                   @Y30LB39*/ 02473000
*       /*                                                           */ 02474000
*       /*************************************************************/ 02475000
*                                                                  0644 02476000
*                                   /*                       @Y30LB39*/ 02477000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 02478000
         LTR   TESTRC,TESTRC                                       0644 02479000
         BZ    @RF00644                                            0644 02480000
*         FILERC=LASTCC12;          /*                       @Y30LB39*/ 02481000
         LA    FILERC,12                                           0645 02482000
*     END;                          /*                       @Y30LB39   02483000
*                                                            @Y30LB39*/ 02484000
*                                                                  0646 02485000
@RF00644 DS    0H                                                  0647 02486000
*   /*****************************************************************/ 02487000
*   /*                                                               */ 02488000
*   /*                                                       @Y30LB39*/ 02489000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 02490000
*   /*                                                       @Y30LB39*/ 02491000
*   /*                                                               */ 02492000
*   /*****************************************************************/ 02493000
*                                                                  0647 02494000
*                                   /*                       @Y30LB39*/ 02495000
*   REG14=RETADDR1;                 /*                       @Y30LB39   02496000
*                                                            @Y30LB39*/ 02497000
*                                                                  0647 02498000
@RF00620 L     REG14,RETADDR1                                      0647 02499000
*   /*****************************************************************/ 02500000
*   /*                                                               */ 02501000
*   /*                                                       @Y30LB39*/ 02502000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 02503000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 02504000
*   /*                                                       @Y30LB39*/ 02505000
*   /*                                                               */ 02506000
*   /*****************************************************************/ 02507000
*                                                                  0648 02508000
*                                   /*                       @Y30LB39*/ 02509000
*   RETURN CODE(FILERC);            /*                       @Y30LB39*/ 02510000
         LR    @15,FILERC                                          0648 02511000
@EL00006 DS    0H                                                  0648 02512000
@EF00006 DS    0H                                                  0648 02513000
@ER00006 BR    @14                                                 0648 02514000
*   END FILERTN;                    /*                       @Y30LB39*/ 02515000
*                                                                  0650 02516000
*   /*****************************************************************/ 02517000
*   /*                                                               */ 02518000
*   /*                                                       @Y30LB39*/ 02519000
*   /* PROCEDURE NAME - VSRTN                                @Y30LB39*/ 02520000
*   /*                                                       @Y30LB39*/ 02521000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 02522000
*   /* CHECK PASSWORDS, UPDATE THE VSAM TIMESTAMP, AND       @ZD00175*/ 02523000
*   /* CHANGE VOL ALLOCATION FROM SHARED TO EXCLUSIVE.       @ZD00175*/ 02524000
*   /* IDCVS01 IS CALLED TO CHECK THE PASSWORD AND TO        @ZD00175*/ 02525000
*   /* UPDATE THE TIMESTAMP. IDCSA06 IS CALLED TO IN-        @ZD00175*/ 02526000
*   /* SURE EXCLUSIVE CONTROL OF THE VOLUME. IF THE          @ZD00175*/ 02527000
*   /* PASSWORD DATA SET COULD NOT BE CLOSED, PROCESS-       @ZD00175*/ 02528000
*   /* ING CONTINUES AFTER SETTING CONDITION CODE TO         @ZD00175*/ 02529000
*   /* FOUR. IF THE PASSWORD CHECK FAILED ALTOGETHER         @Y30LB39*/ 02530000
*   /* OR IF THE UPDATING OF THE TIMESTAMP FAILED            @Y30LB39*/ 02531000
*   /* OR IF THE VOL CANNOT BE OBTAINED FOR EXCLUSIVE        @ZD00175*/ 02532000
*   /* CONTROL THEN A DEQUEUE IS ISSUED SINCE THE COPY       @ZD00175*/ 02533000
*   /* OPERATION WILL NOT BE ABLE TO BE COMPLETED.           @Y30LB39*/ 02534000
*   /* THERE ARE NO MESSAGES ISSUED BY THIS                  @Y30LB39*/ 02535000
*   /* SUBPROCEDURE.                                         @Y30LB39*/ 02536000
*   /*                                                       @Y30LB39*/ 02537000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 02538000
*   /* SECURITY ARGUMENT LIST                                @Y30LB39*/ 02539000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 02540000
*   /* EXCLUSIVE ARGUMENT LIST                               @ZD00175*/ 02541000
*   /*                                                       @Y30LB39*/ 02542000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 02543000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 02544000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 02545000
*   /* 4 - PASSWORD PROTECTED DATA SET COULD NOT             @Y30LB39*/ 02546000
*   /* BE CLOSED OR UCLOSE FAILED (IF ISSUED).               @Y30LB39*/ 02547000
*   /* 12 - COPY OPERATION CAN NOT BE PERFORMED              @Y30LB39*/ 02548000
*   /* BECAUSE THE PASSWORD CHECK FAILED OR                  @Y30LB39*/ 02549000
*   /* TIMESTAMP COULD NOT BE UPDATED. OR THE                @ZD00175*/ 02550000
*   /* VOL COULD NOT BE OBTAINED FOR EXCLUSIVE               @ZD00175*/ 02551000
*   /* CONTROL. COPYVTBL MAY BE UPDATED.                     @ZD00175*/ 02552000
*   /*                                                       @Y30LB39*/ 02553000
*   /*                                                               */ 02554000
*   /*****************************************************************/ 02555000
*                                                                  0650 02556000
*VSRTN:                                                            0650 02557000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 02558000
*                                                                  0650 02559000
VSRTN    DS    0H                                                  0651 02560000
*   /*****************************************************************/ 02561000
*   /*                                                               */ 02562000
*   /*                                                       @Y30LB39*/ 02563000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 02564000
*   /*                                                       @Y30LB39*/ 02565000
*   /*                                                               */ 02566000
*   /*****************************************************************/ 02567000
*                                                                  0651 02568000
*                                   /*                       @Y30LB39*/ 02569000
*   DCL                                                            0651 02570000
*     VSRC FIXED(8);                /* RETURN CODE           @Y30LB39*/ 02571000
*   DCL                                                            0652 02572000
*     VOLSERV CHAR(8) CONSTANT('IDCVS01 ');/*                @Y30LB39   02573000
*                                      CHARACTER STRING      @Y30LB39   02574000
*                                      USED TO IDENTIFY      @Y30LB39   02575000
*                                      EXTERNAL ROUTINE.     @Y30LB39   02576000
*                                                            @Y30LB39*/ 02577000
*                                   /*                       @Y30LB39*/ 02578000
*                                                                  0653 02579000
*   /*****************************************************************/ 02580000
*   /*                                                               */ 02581000
*   /*                                                       @Y30LB39*/ 02582000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 02583000
*   /*                                                       @Y30LB39*/ 02584000
*   /*                                                               */ 02585000
*   /*****************************************************************/ 02586000
*                                                                  0653 02587000
*                                   /*                       @Y30LB39*/ 02588000
*   RETADDR1=REG14;                 /*                       @Y30LB39   02589000
*                                                            @Y30LB39*/ 02590000
*                                                                  0653 02591000
         ST    REG14,RETADDR1                                      0653 02592000
*   /*****************************************************************/ 02593000
*   /*                                                               */ 02594000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 02595000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 02596000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 02597000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 02598000
*   /*                                                       @Y30LB39*/ 02599000
*   /*                                                               */ 02600000
*   /*****************************************************************/ 02601000
*                                                                  0654 02602000
*                                   /*                       @Y30LB39*/ 02603000
*   OLDERID2=NEWERID2;                                             0654 02604000
         L     @09,@PC00001                                        0654 02605000
         L     @09,GDTTR2(,@09)                                    0654 02606000
         MVC   @TS00001(95),NEWERID2(@09)                          0654 02607000
         MVC   OLDERID2(95,@09),@TS00001                           0654 02608000
*   NEWID2='COVS';                  /*                       @Y30LB39   02609000
*                                                            @Y30LB39*/ 02610000
*                                                                  0655 02611000
         MVC   NEWID2(4,@09),@CC01668                              0655 02612000
*   /*****************************************************************/ 02613000
*   /*                                                               */ 02614000
*   /*                                                       @Y30LB39*/ 02615000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 02616000
*   /*                                                       @Y30LB39*/ 02617000
*   /*                                                               */ 02618000
*   /*****************************************************************/ 02619000
*                                                                  0656 02620000
*                                   /*                       @Y30LB39*/ 02621000
*   VSRC=LASTCC00;                  /*                       @Y30LB39   02622000
*                                                            @Y30LB39*/ 02623000
*                                                                  0656 02624000
         SLR   @09,@09                                             0656 02625000
         LR    VSRC,@09                                            0656 02626000
*   /*****************************************************************/ 02627000
*   /*                                                               */ 02628000
*   /*                                                       @Y30LB39*/ 02629000
*   /* INITIALIZE VS1AGL AND REQUEST IDCVS01 TO ISSUE        @Y30LB39*/ 02630000
*   /* A RESERVE BEFORE MAKING THE PASSWORD CHECK.           @Y30LB39*/ 02631000
*   /*                                                       @Y30LB39*/ 02632000
*   /*                                                               */ 02633000
*   /*****************************************************************/ 02634000
*                                                                  0657 02635000
*                                   /*                       @Y30LB39*/ 02636000
*   VS1AGL=''B;                     /*                       @Y30LB39*/ 02637000
         LA    @07,VS1AGLBF                                        0657 02638000
         XC    VS1AGL(74,@07),VS1AGL(@07)                          0657 02639000
*   VSRES=ON;                       /*                       @Y30LB39*/ 02640000
         OI    VSRES(@07),B'10000000'                              0658 02641000
*   VSUCBP=ADDR(CUNITUCB);          /*                       @Y30LB39*/ 02642000
         LA    @15,CUNITUCB                                        0659 02643000
         ST    @15,VSUCBP(,@07)                                    0659 02644000
*   VSMASTER=ON;                    /*                       @Y30LB39*/ 02645000
         OI    VSMASTER(@07),B'01000000'                           0660 02646000
*   IF ADDR(CAT)^=NULLPTR THEN      /*                       @Y30LB39*/ 02647000
         L     @15,@PC00001+4                                      0661 02648000
         C     @09,FDTPTR+44(,@15)                                 0661 02649000
         BE    @RF00661                                            0661 02650000
*     DO;                           /*                       @Y30LB39*/ 02651000
*       VSCATP=ADDR(CATNMVAL);      /*                       @Y30LB39*/ 02652000
         L     @01,FDTPTR+48(,@15)                                 0663 02653000
         LA    @14,CATNMVAL(,@01)                                  0663 02654000
         ST    @14,VSCATP(,@07)                                    0663 02655000
*       IF ADDR(CATDN)^=NULLPTR THEN/*                       @Y30LB39*/ 02656000
         L     @15,FDTPTR+52(,@15)                                 0664 02657000
         CR    @15,@09                                             0664 02658000
         BE    @RF00664                                            0664 02659000
*         VSCATDDP=ADDR(CATDNVAL);  /*                       @Y30LB39*/ 02660000
         LA    @09,CATDNVAL(,@15)                                  0665 02661000
         ST    @09,VSCATDDP(,@07)                                  0665 02662000
*       IF CATNMPLN^=0 THEN         /*                       @Y30LB39*/ 02663000
@RF00664 L     @09,@PC00001+4                                      0666 02664000
         L     @09,FDTPTR+48(,@09)                                 0666 02665000
         CLI   CATNMPLN(@09),0                                     0666 02666000
         BE    @RF00666                                            0666 02667000
*         VSPSWDP=ADDR(CATNMPAS);   /*                       @Y30LB39*/ 02668000
         LA    @07,VS1AGLBF                                        0667 02669000
         LA    @09,CATNMPAS(,@09)                                  0667 02670000
         ST    @09,VSPSWDP(,@07)                                   0667 02671000
*     END;                          /*                       @Y30LB39*/ 02672000
@RF00666 DS    0H                                                  0669 02673000
*   VSREAD=ON;                      /*                       @ZD00175*/ 02674000
@RF00661 LA    @09,VS1AGLBF                                        0669 02675000
         OI    VSREAD(@09),B'00010000'                             0669 02676000
*   VSVOLP=ADDR(VOLVAL);            /*                       @ZD00175*/ 02677000
         L     @07,@PC00001+4                                      0670 02678000
         L     @01,FDTPTR(,@07)                                    0670 02679000
         LA    @15,VOLVAL(,@01)                                    0670 02680000
         ST    @15,VSVOLP(,@09)                                    0670 02681000
*   VSFILEP=ADDR(CUNITDDN);         /*                       @ZD00175*/ 02682000
         LA    @15,CUNITDDN                                        0671 02683000
         ST    @15,VSFILEP(,@09)                                   0671 02684000
*   VSPFILEP=ADDR(PFILE);           /*                       @Y30LB39   02685000
*                                                            @Y30LB39*/ 02686000
*                                                                  0672 02687000
         L     @07,FDTPTR+64(,@07)                                 0672 02688000
         ST    @07,VSPFILEP(,@09)                                  0672 02689000
*   /*****************************************************************/ 02690000
*   /*                                                               */ 02691000
*   /*                                                       @Y30LB39*/ 02692000
*   /* ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL              @Y30LB39*/ 02693000
*   /* TO PROVIDE A FULL REGION DUMP.                        @Y30LB39*/ 02694000
*   /*                                                       @Y30LB39*/ 02695000
*   /*                                                               */ 02696000
*   /*****************************************************************/ 02697000
*                                                                  0673 02698000
*                                   /*                       @Y30LB39*/ 02699000
*   IF GDTDBG=NULLPTR THEN                                         0673 02700000
         L     @09,@PC00001                                        0673 02701000
         L     @09,GDTDBG(,@09)                                    0673 02702000
         LTR   @09,@09                                             0673 02703000
         BZ    @RT00673                                            0673 02704000
*     ;                                                            0674 02705000
*   ELSE                                                           0675 02706000
*     CALL IDCDB010(GDTTBL,'COCH'); /*                       @Y30LB39   02707000
*                                                            @Y30LB39*/ 02708000
         L     @09,@PC00001                                        0675 02709000
         ST    @09,@AL00001                                        0675 02710000
         LA    @07,@CC01669                                        0675 02711000
         ST    @07,@AL00001+4                                      0675 02712000
         MVI   @AL00001+4,X'80'                                    0675 02713000
         L     @15,GDTDBG(,@09)                                    0675 02714000
         LA    @01,@AL00001                                        0675 02715000
         BALR  @14,@15                                             0675 02716000
*   CALL IDCSACL0(GDTTBL,VOLSERV,SECCHECK,VS1AGL);/*         @Y30LB39   02717000
*                                                            @Y30LB39*/ 02718000
@RT00673 L     @09,@PC00001                                        0676 02719000
         ST    @09,@AL00001                                        0676 02720000
         LA    @07,@CC01667                                        0676 02721000
         ST    @07,@AL00001+4                                      0676 02722000
         LA    @07,SECCHECK                                        0676 02723000
         ST    @07,@AL00001+8                                      0676 02724000
         LA    @07,VS1AGLBF                                        0676 02725000
         ST    @07,@AL00001+12                                     0676 02726000
         MVI   @AL00001+12,X'80'                                   0676 02727000
         L     @15,GDTCAL(,@09)                                    0676 02728000
         LA    @01,@AL00001                                        0676 02729000
         BALR  @14,@15                                             0676 02730000
*   RESPECIFY                                                      0677 02731000
*     RTNREG RSTD;                                                 0677 02732000
*   TESTRC=RTNREG;                                                 0678 02733000
         LR    TESTRC,RTNREG                                       0678 02734000
*   RESPECIFY                                                      0679 02735000
*     RTNREG UNRSTD;                /*                       @Y30LB39*/ 02736000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39   02737000
*                                                            @Y30LB39*/ 02738000
*                                                                  0680 02739000
         LTR   TESTRC,TESTRC                                       0680 02740000
         BZ    @RF00680                                            0680 02741000
*     /***************************************************************/ 02742000
*     /*                                                             */ 02743000
*     /*                                                     @Y30LB39*/ 02744000
*     /* RETURN CODE IS NOT ZERO. IF RETURN CODE             @Y30LB39*/ 02745000
*     /* IS EIGHT THEN A PASSWORD PROTECTED DATA SET         @Y30LB39*/ 02746000
*     /* COULD NOT BE CLOSED, SO SET CONDITION CODE TO       @Y30LB39*/ 02747000
*     /* FOUR.                                               @Y30LB39*/ 02748000
*     /*                                                     @Y30LB39*/ 02749000
*     /*                                                             */ 02750000
*     /***************************************************************/ 02751000
*                                                                  0681 02752000
*                                   /*                       @Y30LB39*/ 02753000
*     IF TESTRC=8 THEN              /*                       @Y30LB39*/ 02754000
         C     TESTRC,@CF00179                                     0681 02755000
         BNE   @RF00681                                            0681 02756000
*       VSRC=LASTCC04;              /*                       @Y30LB39*/ 02757000
         LA    VSRC,4                                              0682 02758000
*     ELSE                          /*                       @Y30LB39   02759000
*                                                            @Y30LB39*/ 02760000
*                                                                  0683 02761000
*       /*************************************************************/ 02762000
*       /*                                                           */ 02763000
*       /*                                                   @Y30LB39*/ 02764000
*       /* RETURN CODE IS FOUR, SECURITY CHECK               @Y30LB39*/ 02765000
*       /* FAILED AND CONDITION CODE MUST BE SET TO 12       @Y30LB39*/ 02766000
*       /*                                                   @Y30LB39*/ 02767000
*       /*                                                           */ 02768000
*       /*************************************************************/ 02769000
*                                                                  0683 02770000
*                                   /*                       @Y30LB39*/ 02771000
*       VSRC=LASTCC12;              /*                       @Y30LB39   02772000
*                                                            @Y30LB39*/ 02773000
*                                                                  0683 02774000
         B     @RC00681                                            0683 02775000
@RF00681 LA    VSRC,12                                             0683 02776000
*   /*****************************************************************/ 02777000
*   /*                                                               */ 02778000
*   /*                                                       @Y30LB39*/ 02779000
*   /* FOLLOWING SECCHECK CALL TO IDCVS01                    @Y30LB39*/ 02780000
*   /* ISSUE UCLOSE FOR VTOC IF VSIOP IS NOT ZERO.           @Y30LB39*/ 02781000
*   /*                                                       @Y30LB39*/ 02782000
*   /*                                                               */ 02783000
*   /*****************************************************************/ 02784000
*                                                                  0684 02785000
*                                   /*                       @Y30LB39*/ 02786000
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB39*/ 02787000
@RC00681 DS    0H                                                  0684 02788000
@RF00680 LA    @09,VS1AGLBF                                        0684 02789000
         L     @07,VSIOP(,@09)                                     0684 02790000
         LTR   @07,@07                                             0684 02791000
         BZ    @RF00684                                            0684 02792000
*     DO;                           /*                       @Y30LB39   02793000
*                                                            @Y30LB39*/ 02794000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB39   02795000
*                                                            @Y30LB39*/ 02796000
         L     @07,@PC00001                                        0686 02797000
         ST    @07,@AL00001                                        0686 02798000
         LA    @09,VSIOP(,@09)                                     0686 02799000
         ST    @09,@AL00001+4                                      0686 02800000
         MVI   @AL00001+4,X'80'                                    0686 02801000
         L     @15,GDTCLS(,@07)                                    0686 02802000
         LA    @01,@AL00001                                        0686 02803000
         BALR  @14,@15                                             0686 02804000
*       RESPECIFY                                                  0687 02805000
*         RTNREG RSTD;                                             0687 02806000
*       TESTRC=RTNREG;                                             0688 02807000
         LR    TESTRC,RTNREG                                       0688 02808000
*       RESPECIFY                                                  0689 02809000
*         RTNREG UNRSTD;            /*                       @Y30LB39*/ 02810000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 02811000
         LTR   TESTRC,TESTRC                                       0690 02812000
         BZ    @RF00690                                            0690 02813000
*         VSRC=MAX(VSRC,LASTCC04);  /*                       @Y30LB39*/ 02814000
         LA    @09,4                                               0691 02815000
         CR    VSRC,@09                                            0691 02816000
         BNL   *+6                                                      02817000
         LR    VSRC,@09                                            0691 02818000
*       VSIOP=NULLPTR;              /*                       @Y30LB39*/ 02819000
@RF00690 LA    @09,VS1AGLBF                                        0692 02820000
         SLR   @07,@07                                             0692 02821000
         ST    @07,VSIOP(,@09)                                     0692 02822000
*     END;                          /*                       @Y30LB39*/ 02823000
*                                                                  0693 02824000
*   /*****************************************************************/ 02825000
*   /*                                                               */ 02826000
*   /*                                                       @Y30LB39*/ 02827000
*   /* IF THE CONDITION CODE IS NOT GREATER THAN             @Y30LB39*/ 02828000
*   /* EIGHT, IT IS OKAY TO UPDATE THE VSAM                  @Y30LB39*/ 02829000
*   /* TIMESTAMP.                                            @Y30LB39*/ 02830000
*   /*                                                       @Y30LB39*/ 02831000
*   /*                                                               */ 02832000
*   /*****************************************************************/ 02833000
*                                                                  0694 02834000
*                                   /*                       @Y30LB39*/ 02835000
*   IF VSRC^>LASTCC08 THEN          /*                       @Y30LB39   02836000
*                                                            @Y30LB39*/ 02837000
*                                                                  0694 02838000
@RF00684 C     VSRC,@CF00179                                       0694 02839000
         BH    @RF00694                                            0694 02840000
*     /***************************************************************/ 02841000
*     /*                                                             */ 02842000
*     /*                                                     @Y30LB39*/ 02843000
*     /* IF THE VOLUME IS VSAM THEN CALL IDCVS01 TO          @Y30LB39*/ 02844000
*     /* UPDATE THE FORMAT 4 TIMESTAMP. SET THE              @Y30LB39*/ 02845000
*     /* RESERVE OPTION BIT OFF FOR THIS CALL TO             @Y30LB39*/ 02846000
*     /* IDCVS01 BECAUSE THE RESERVE SET DURING              @Y30LB39*/ 02847000
*     /* THE FIRST CALL TO IDCVS01 IS STILL IN EFFECT.       @Y30LB39*/ 02848000
*     /*                                                     @Y30LB39*/ 02849000
*     /*                                                             */ 02850000
*     /***************************************************************/ 02851000
*                                                                  0695 02852000
*                                   /*                       @Y30LB39*/ 02853000
*     IF VSVSAM=ON THEN             /*                       @Y30LB39*/ 02854000
         LA    @09,VS1AGLBF                                        0695 02855000
         TM    VSVSAM(@09),B'10000000'                             0695 02856000
         BNO   @RF00695                                            0695 02857000
*       DO;                         /*                       @Y30LB39*/ 02858000
*         VSTIME=ON;                /*                       @Y30LB39*/ 02859000
         OI    VSTIME(@09),B'10000000'                             0697 02860000
*         VSRES=OFF;                /*                       @Y30LB39   02861000
*                                                            @Y30LB39*/ 02862000
*                                                                  0698 02863000
         NI    VSRES(@09),B'01111111'                              0698 02864000
*         /***********************************************************/ 02865000
*         /*                                                         */ 02866000
*         /*                                                 @Y30LB39*/ 02867000
*         /* ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL        @Y30LB39*/ 02868000
*         /* TO PROVIDE A FULL REGION DUMP.                  @Y30LB39*/ 02869000
*         /*                                                 @Y30LB39*/ 02870000
*         /*                                                         */ 02871000
*         /***********************************************************/ 02872000
*                                                                  0699 02873000
*                                   /*                       @Y30LB39*/ 02874000
*         IF GDTDBG=NULLPTR THEN                                   0699 02875000
         L     @09,@PC00001                                        0699 02876000
         L     @09,GDTDBG(,@09)                                    0699 02877000
         LTR   @09,@09                                             0699 02878000
         BZ    @RT00699                                            0699 02879000
*           ;                                                      0700 02880000
*         ELSE                                                     0701 02881000
*           CALL IDCDB010(GDTTBL,'COPT');/*                  @Y30LB39   02882000
*                                                            @Y30LB39*/ 02883000
         L     @09,@PC00001                                        0701 02884000
         ST    @09,@AL00001                                        0701 02885000
         LA    @07,@CC01670                                        0701 02886000
         ST    @07,@AL00001+4                                      0701 02887000
         MVI   @AL00001+4,X'80'                                    0701 02888000
         L     @15,GDTDBG(,@09)                                    0701 02889000
         LA    @01,@AL00001                                        0701 02890000
         BALR  @14,@15                                             0701 02891000
*         CALL IDCSACL0(GDTTBL,VOLSERV,PUTVTOC,VS1AGL);/*    @Y30LB39   02892000
*                                                            @Y30LB39*/ 02893000
@RT00699 L     @09,@PC00001                                        0702 02894000
         ST    @09,@AL00001                                        0702 02895000
         LA    @07,@CC01667                                        0702 02896000
         ST    @07,@AL00001+4                                      0702 02897000
         LA    @07,PUTVTOC                                         0702 02898000
         ST    @07,@AL00001+8                                      0702 02899000
         LA    @07,VS1AGLBF                                        0702 02900000
         ST    @07,@AL00001+12                                     0702 02901000
         MVI   @AL00001+12,X'80'                                   0702 02902000
         L     @15,GDTCAL(,@09)                                    0702 02903000
         LA    @01,@AL00001                                        0702 02904000
         BALR  @14,@15                                             0702 02905000
*         RESPECIFY                                                0703 02906000
*           RTNREG RSTD;                                           0703 02907000
*         TESTRC=RTNREG;                                           0704 02908000
         LR    TESTRC,RTNREG                                       0704 02909000
*         RESPECIFY                                                0705 02910000
*           RTNREG UNRSTD;          /*                       @Y30LB39*/ 02911000
*         IF TESTRC^=0 THEN         /*                       @Y30LB39*/ 02912000
         LTR   TESTRC,TESTRC                                       0706 02913000
         BZ    @RF00706                                            0706 02914000
*           VSRC=LASTCC12;          /*                       @Y30LB39*/ 02915000
         LA    VSRC,12                                             0707 02916000
*       END;                        /*                       @Y30LB39*/ 02917000
@RF00706 DS    0H                                                  0709 02918000
*                                   /*                       @Y30LB39*/ 02919000
*                                                                  0709 02920000
*   /*****************************************************************/ 02921000
*   /*                                                               */ 02922000
*   /*                                                       @Y30LB39*/ 02923000
*   /* ISSUE UCLOSE FOR VTOC IF VSIOP IS NOT ZERO.           @Y30LB39*/ 02924000
*   /*                                                       @Y30LB39*/ 02925000
*   /*                                                               */ 02926000
*   /*****************************************************************/ 02927000
*                                                                  0709 02928000
*                                   /*                       @Y30LB39*/ 02929000
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB39*/ 02930000
@RF00695 DS    0H                                                  0709 02931000
@RF00694 LA    @09,VS1AGLBF                                        0709 02932000
         L     @07,VSIOP(,@09)                                     0709 02933000
         LTR   @07,@07                                             0709 02934000
         BZ    @RF00709                                            0709 02935000
*     DO;                           /*                       @Y30LB39   02936000
*                                                            @Y30LB39*/ 02937000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB39   02938000
*                                                            @Y30LB39*/ 02939000
         L     @07,@PC00001                                        0711 02940000
         ST    @07,@AL00001                                        0711 02941000
         LA    @09,VSIOP(,@09)                                     0711 02942000
         ST    @09,@AL00001+4                                      0711 02943000
         MVI   @AL00001+4,X'80'                                    0711 02944000
         L     @15,GDTCLS(,@07)                                    0711 02945000
         LA    @01,@AL00001                                        0711 02946000
         BALR  @14,@15                                             0711 02947000
*       RESPECIFY                                                  0712 02948000
*         RTNREG RSTD;                                             0712 02949000
*       TESTRC=RTNREG;                                             0713 02950000
         LR    TESTRC,RTNREG                                       0713 02951000
*       RESPECIFY                                                  0714 02952000
*         RTNREG UNRSTD;            /*                       @Y30LB39*/ 02953000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 02954000
         LTR   TESTRC,TESTRC                                       0715 02955000
         BZ    @RF00715                                            0715 02956000
*         VSRC=MAX(VSRC,LASTCC04);  /*                       @Y30LB39*/ 02957000
         LA    @09,4                                               0716 02958000
         CR    VSRC,@09                                            0716 02959000
         BNL   *+6                                                      02960000
         LR    VSRC,@09                                            0716 02961000
*     END;                          /*                       @Y30LB39   02962000
*                                                            @Y30LB39*/ 02963000
*                                                                  0717 02964000
@RF00715 DS    0H                                                  0718 02965000
*   /*****************************************************************/ 02966000
*   /*                                                               */ 02967000
*   /*                                                       @ZD00175*/ 02968000
*   /* BEFORE PERFORMING THE COPY OPERATION,                 @ZD00175*/ 02969000
*   /* INITIALIZE THE EXCLAGL AND CALL IDCSA06 TO            @ZD00175*/ 02970000
*   /* INSURE THAT THE UNIT AND VOLUME MOUNTED ON            @ZD00175*/ 02971000
*   /* IT ARE ALLOCATED TO THIS TASK FOR EXCLUSIVE           @ZD00175*/ 02972000
*   /* CONTROL WITHIN THE OPERATING SYSTEM. MAKE             @ZD00175*/ 02973000
*   /* THIS CHECK IF THE UNIT WAS ALLOCATED DYNAM-           @ZD00175*/ 02974000
*   /* ICALLY OR VIA THE FILE PARAMETER.                     @ZD00175*/ 02975000
*   /*                                                       @ZD00175*/ 02976000
*   /*                                                               */ 02977000
*   /*****************************************************************/ 02978000
*                                                                  0718 02979000
*   IF VSRC<LASTCC12&(ADDR(FILE)^=NULLPTR|ALLOCFLG=ON) THEN        0718 02980000
@RF00709 C     VSRC,@CF00567                                       0718 02981000
         BNL   @RF00718                                            0718 02982000
         L     @09,@PC00001+4                                      0718 02983000
         L     @09,FDTPTR+56(,@09)                                 0718 02984000
         LTR   @09,@09                                             0718 02985000
         BNZ   @RT00718                                            0718 02986000
         TM    ALLOCFLG,B'00100000'                                0718 02987000
         BNO   @RF00718                                            0718 02988000
@RT00718 DS    0H                                                  0719 02989000
*     DO;                           /*                       @ZD00175*/ 02990000
*       EXCLAGL=''B;                /*                       @ZD00175*/ 02991000
         LA    @09,EXCLAGLB                                        0720 02992000
         XC    EXCLAGL(23,@09),EXCLAGL(@09)                        0720 02993000
*       EXCLUCBP=ADDR(CUNITUCB);    /*                       @ZD00175*/ 02994000
         LA    @07,CUNITUCB                                        0721 02995000
         ST    @07,EXCLUCBP(,@09)                                  0721 02996000
*       EXCLDDP=ADDR(CUNITDDN);     /*                       @ZD00175*/ 02997000
*                                                                  0722 02998000
         LA    @07,CUNITDDN                                        0722 02999000
         ST    @07,EXCLDDP(,@09)                                   0722 03000000
*       /*************************************************************/ 03001000
*       /*                                                           */ 03002000
*       /*                                                   @ZD00175*/ 03003000
*       /* TAKE A FULL REGION DUMP PRIOR TO THE EXTER-       @ZD00175*/ 03004000
*       /* NAL CALL TO IDCSA06.                              @ZD00175*/ 03005000
*       /*                                                   @ZD00175*/ 03006000
*       /*                                                           */ 03007000
*       /*************************************************************/ 03008000
*                                                                  0723 03009000
*       IF GDTDBG=NULLPTR THEN                                     0723 03010000
         L     @09,@PC00001                                        0723 03011000
         L     @09,GDTDBG(,@09)                                    0723 03012000
         LTR   @09,@09                                             0723 03013000
         BZ    @RT00723                                            0723 03014000
*         ;                                                        0724 03015000
*       ELSE                                                       0725 03016000
*         CALL IDCDB010(GDTTBL,'COII');/*                    @ZD00175*/ 03017000
         L     @09,@PC00001                                        0725 03018000
         ST    @09,@AL00001                                        0725 03019000
         LA    @07,@CC01671                                        0725 03020000
         ST    @07,@AL00001+4                                      0725 03021000
         MVI   @AL00001+4,X'80'                                    0725 03022000
         L     @15,GDTDBG(,@09)                                    0725 03023000
         LA    @01,@AL00001                                        0725 03024000
         BALR  @14,@15                                             0725 03025000
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @ZD00175*/ 03026000
@RT00723 L     @09,@PC00001                                        0726 03027000
         ST    @09,@AL00001                                        0726 03028000
         LA    @07,CHANGEX                                         0726 03029000
         ST    @07,@AL00001+4                                      0726 03030000
         LA    @07,EXCLAGLB                                        0726 03031000
         ST    @07,@AL00001+8                                      0726 03032000
         MVI   @AL00001+8,X'80'                                    0726 03033000
         L     @15,GDTUNT(,@09)                                    0726 03034000
         LA    @01,@AL00001                                        0726 03035000
         BALR  @14,@15                                             0726 03036000
*       RESPECIFY                                                  0727 03037000
*         RTNREG RSTD;                                             0727 03038000
*       TESTRC=RTNREG;                                             0728 03039000
         LR    TESTRC,RTNREG                                       0728 03040000
*       RESPECIFY                                                  0729 03041000
*         RTNREG UNRSTD;            /*                       @ZD00175*/ 03042000
*                                                                  0729 03043000
*       /*************************************************************/ 03044000
*       /*                                                           */ 03045000
*       /*                                                   @ZD00175*/ 03046000
*       /* IF THE REQUEST TO CHANGE THE VOL ALLOCATION       @ZD00175*/ 03047000
*       /* FROM SHARED TO EXCLUSIVE FAILED, RETURN TO        @ZD00175*/ 03048000
*       /* THE CALLER AND DO NOT PERFORM THE COPY.           @ZD00175*/ 03049000
*       /*                                                   @ZD00175*/ 03050000
*       /*                                                           */ 03051000
*       /*************************************************************/ 03052000
*                                                                  0730 03053000
*       IF TESTRC^=0 THEN                                          0730 03054000
         LTR   TESTRC,TESTRC                                       0730 03055000
         BZ    @RF00730                                            0730 03056000
*         VSRC=LASTCC12;            /*                       @ZD00175*/ 03057000
         LA    VSRC,12                                             0731 03058000
*     END;                          /*                       @ZD00175*/ 03059000
*                                                                  0732 03060000
@RF00730 DS    0H                                                  0733 03061000
*   /*****************************************************************/ 03062000
*   /*                                                               */ 03063000
*   /*                                                       #Y30LB39*/ 03064000
*   /* CHECK RETURN CODE                                     #Y30LB39*/ 03065000
*   /*                                                       #Y30LB39*/ 03066000
*   /*                                                               */ 03067000
*   /*****************************************************************/ 03068000
*                                                                  0733 03069000
*                                   /*                       @Y30LB39*/ 03070000
*   IF VSRC>LASTCC08 THEN           /*                       @Y30LB39   03071000
*                                                            @Y30LB39*/ 03072000
*                                                                  0733 03073000
@RF00718 C     VSRC,@CF00179                                       0733 03074000
         BNH   @RF00733                                            0733 03075000
*     /***************************************************************/ 03076000
*     /*                                                             */ 03077000
*     /*                                                     @Y30LB39*/ 03078000
*     /* IF THE CONDITION CODE IS GREATER THAN EIGHT,        @Y30LB39*/ 03079000
*     /* THEN THE COPY OPERATION CANNOT BE PERFORMED.        @Y30LB39*/ 03080000
*     /* ISSUE UDEQ TO RELEASE THE RESERVE SET BY            @Y30LB39*/ 03081000
*     /* IDCVS01.                                            @Y30LB39*/ 03082000
*     /*                                                     @Y30LB39*/ 03083000
*     /*                                                             */ 03084000
*     /***************************************************************/ 03085000
*                                                                  0734 03086000
*                                   /*                       @Y30LB39*/ 03087000
*     RNAMCHAR(7:22)='.VIRTUAL.RESERVE';/*                   @ZA05138*/ 03088000
         MVC   RNAMCHAR+6(16),@CC01672                             0734 03089000
*   CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*             @Y30LB39   03090000
*                                                            @Y30LB39*/ 03091000
*                                                                  0735 03092000
@RF00733 L     @09,@PC00001                                        0735 03093000
         ST    @09,@AL00001                                        0735 03094000
         LA    @07,@CC01617                                        0735 03095000
         ST    @07,@AL00001+4                                      0735 03096000
         LA    @07,MINORNAM                                        0735 03097000
         ST    @07,@AL00001+8                                      0735 03098000
         MVI   @AL00001+8,X'80'                                    0735 03099000
         L     @15,GDTDEQ(,@09)                                    0735 03100000
         LA    @01,@AL00001                                        0735 03101000
         BALR  @14,@15                                             0735 03102000
*   /*****************************************************************/ 03103000
*   /*                                                               */ 03104000
*   /*                                                       @Y30LB39*/ 03105000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 03106000
*   /*                                                       @Y30LB39*/ 03107000
*   /*                                                               */ 03108000
*   /*****************************************************************/ 03109000
*                                                                  0736 03110000
*                                   /*                       @Y30LB39*/ 03111000
*   REG14=RETADDR1;                 /*                       @Y30LB39   03112000
*                                                            @Y30LB39*/ 03113000
*                                                                  0736 03114000
         L     REG14,RETADDR1                                      0736 03115000
*   /*****************************************************************/ 03116000
*   /*                                                               */ 03117000
*   /*                                                       @Y30LB39*/ 03118000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 03119000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 03120000
*   /*                                                       @Y30LB39*/ 03121000
*   /*                                                               */ 03122000
*   /*****************************************************************/ 03123000
*                                                                  0737 03124000
*                                   /*                       @Y30LB39*/ 03125000
*   RETURN CODE(VSRC);              /*                       @Y30LB39*/ 03126000
         LR    @15,VSRC                                            0737 03127000
@EL00007 DS    0H                                                  0737 03128000
@EF00007 DS    0H                                                  0737 03129000
@ER00007 BR    @14                                                 0737 03130000
*   END VSRTN;                      /*                       @Y30LB39*/ 03131000
*                                                                  0739 03132000
*   /*****************************************************************/ 03133000
*   /*                                                               */ 03134000
*   /*                                                       @Y30LB39*/ 03135000
*   /* PROCEDURE NAME - WORKRTN                              @Y30LB39*/ 03136000
*   /*                                                       @Y30LB39*/ 03137000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 03138000
*   /* DIRECT THE COPY OPERATION.                            @Y30LB39*/ 03139000
*   /* IF CARTRIDGES CAN NOT BE REUSED, THEN A CALL          @Y30LB39*/ 03140000
*   /* IS MADE TO CRVRTN TO CREATE A NEW                     @Y30LB39*/ 03141000
*   /* TARGET VOLUME FROM SCRATCH CARTRIDGES.                @Y30LB39*/ 03142000
*   /* PROVIDING THAT EVERYTHING IS STILL OKAY AT THIS       @Y30LB39*/ 03143000
*   /* POINT, THEN THE SOURCE VOLUME IS DEMOUNTED            @Y30LB39*/ 03144000
*   /* BY DMNTRTN SUB-PROCEDURE.                             @Y30LB39*/ 03145000
*   /* THE SOURCE VOLUME IS COPIED AND IF THE RETURN         @Y30LB39*/ 03146000
*   /* CODE FROM THE COPYRTN SUBPROCEDURE IS OK, THEN        @Y30LB39*/ 03147000
*   /* THE OWNER INFORMATION IS UPDATED BY LABELRTN.         @Y30LB39*/ 03148000
*   /* IF THE COPY IS TO BE EJECTED, THEN A CALL             @Y30LB39*/ 03149000
*   /* IS MADE TO THE VOLUME EJECT ROUTINE(VOLEXIT).         @Y30LB39*/ 03150000
*   /* IF VSAM USER CATALOG MAY BE ON THE SOURCE             @ZD00175*/ 03151000
*   /* VOLUME, IDCSA06 IS CALLED TO REMOUNT THE VOLUME.@ZD00175      */ 03152000
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/ 03153000
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/ 03154000
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/ 03155000
*   /* IDC3706I IF TARGET WAS AN INCOMPLETE COPY VOL.        @Y30LB39*/ 03156000
*   /* IDC3709I IF OLDEST BACKUP WAS SELECTED AS             @Y30LB39*/ 03157000
*   /* TARGET VOLUME.                                        @Y30LB39*/ 03158000
*   /*                                                       @Y30LB39*/ 03159000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 03160000
*   /* DYNAMIC ARGUMENT LIST (DARGLIST)                      @Y30LB39*/ 03161000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 03162000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 03163000
*   /* FORMAT OF A COPY VOLUME RECORD                        @Y30LB39*/ 03164000
*   /* MOUNT ARGUMENT LIST                                   @ZM00175*/ 03165000
*   /*                                                       @Y30LB39*/ 03166000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 03167000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 03168000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 03169000
*   /* AND COPYVTBL MAY BE UPDATED.                          @Y30LB39*/ 03170000
*   /* 4 - IF VOLUME LABEL INFORMATION COULD NOT             @Y30LB39*/ 03171000
*   /* BE UPDATED OR VOLUME COULD NOT BE                     @ZD00175*/ 03172000
*   /* REMOUNTED AFTER SUCCESSFUL COPY.                      @ZD00175*/ 03173000
*   /* 8 - IF UNABLE TO EJECT CARTRIDGES FROM MASS           @Y30LB39*/ 03174000
*   /* STORAGE FACILITY.                                     @Y30LB39*/ 03175000
*   /* 12 - IF UNABLE TO CREATE A NEW TARGET VOLUME          @Y30LB39*/ 03176000
*   /* FROM SCRATCH CARTRIDGES OR UNABLE TO                  @Y30LB39*/ 03177000
*   /* DEMOUNT SOURCE VOLUME OR UNABLE TO COPY               @Y30LB39*/ 03178000
*   /* SOURCE VOLUMM.                                        @Y30LB39*/ 03179000
*   /* COPYVTBL MAY BE UPDATED.                              @Y30LB39*/ 03180000
*   /*                                                       @Y30LB39*/ 03181000
*   /*                                                               */ 03182000
*   /*****************************************************************/ 03183000
*                                                                  0739 03184000
*WORKRTN:                                                          0739 03185000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 03186000
*                                                                  0739 03187000
WORKRTN  DS    0H                                                  0740 03188000
*   /*****************************************************************/ 03189000
*   /*                                                               */ 03190000
*   /*                                                       @Y30LB39*/ 03191000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 03192000
*   /*                                                       @Y30LB39*/ 03193000
*   /*                                                               */ 03194000
*   /*****************************************************************/ 03195000
*                                                                  0740 03196000
*                                   /*                       @Y30LB39*/ 03197000
*   DCL                                                            0740 03198000
*     SAVEFLG BIT(1) BDY(BYTE);     /* PARAMETER SET         @Y30LB39   03199000
*                                      WHEN (IF) CALLING     @Y30LB39   03200000
*                                      ROUTING VOLEXIT       @Y30LB39*/ 03201000
*   DCL                                                            0741 03202000
*     WORKRC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 03203000
*   DCL                                                            0742 03204000
*     DATAVALU CHAR(30) BDY(BYTE);  /* PARAMETER SET         @Y30LB39   03205000
*                                      WHEN (IF) CALLING     @Y30LB39   03206000
*                                      ROUTINE VOLEXIT       @Y30LB39*/ 03207000
*                                   /*                       @Y30LB39*/ 03208000
*                                                                  0743 03209000
*   /*****************************************************************/ 03210000
*   /*                                                               */ 03211000
*   /*                                                       @Y30LB39*/ 03212000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 03213000
*   /*                                                       @Y30LB39*/ 03214000
*   /*                                                               */ 03215000
*   /*****************************************************************/ 03216000
*                                                                  0743 03217000
*                                   /*                       @Y30LB39*/ 03218000
*   RETADDR1=REG14;                 /*                       @Y30LB39   03219000
*                                                            @Y30LB39*/ 03220000
*                                                                  0743 03221000
         ST    REG14,RETADDR1                                      0743 03222000
*   /*****************************************************************/ 03223000
*   /*                                                               */ 03224000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 03225000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 03226000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 03227000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 03228000
*   /*                                                       @Y30LB39*/ 03229000
*   /*                                                               */ 03230000
*   /*****************************************************************/ 03231000
*                                                                  0744 03232000
*                                   /*                       @Y30LB39*/ 03233000
*   OLDERID2=NEWERID2;                                             0744 03234000
         L     @09,@PC00001                                        0744 03235000
         L     @09,GDTTR2(,@09)                                    0744 03236000
         MVC   @TS00001(95),NEWERID2(@09)                          0744 03237000
         MVC   OLDERID2(95,@09),@TS00001                           0744 03238000
*   NEWID2='COWK';                  /*                       @Y30LB39   03239000
*                                                            @Y30LB39*/ 03240000
*                                                                  0745 03241000
         MVC   NEWID2(4,@09),@CC01680                              0745 03242000
*   /*****************************************************************/ 03243000
*   /*                                                               */ 03244000
*   /*                                                       @Y30LB39*/ 03245000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 03246000
*   /*                                                       @Y30LB39*/ 03247000
*   /*                                                               */ 03248000
*   /*****************************************************************/ 03249000
*                                                                  0746 03250000
*                                   /*                       @Y30LB39*/ 03251000
*   WORKRC=LASTCC00;                /*                       @Y30LB39   03252000
*                                                            @Y30LB39*/ 03253000
*                                                                  0746 03254000
         SLR   WORKRC,WORKRC                                       0746 03255000
*   /*****************************************************************/ 03256000
*   /*                                                               */ 03257000
*   /*                                                       @Y30LB39*/ 03258000
*   /* IF AN EXISTING VOLUME CANNOT BE REUSED,               @Y30LB39*/ 03259000
*   /* THEN CALL CRVRTN TO                                   @Y30LB39*/ 03260000
*   /* CREATE A NEW TARGET VOLUME FROM SCRATCH               @Y30LB39*/ 03261000
*   /* CARTRIDGES. IF THE RETURN CODE IS NOT ZERO,           @Y30LB39*/ 03262000
*   /* SET THE CONDITION CODE TO 12 AND EXIT ROUTINE.        @Y30LB39*/ 03263000
*   /*                                                       @Y30LB39*/ 03264000
*   /*                                                               */ 03265000
*   /*****************************************************************/ 03266000
*                                                                  0747 03267000
*                                   /*                       @Y30LB39*/ 03268000
*   IF REUSEFLG=OFF THEN            /*                       @Y30LB39*/ 03269000
         TM    REUSEFLG,B'10000000'                                0747 03270000
         BNZ   @RF00747                                            0747 03271000
*     DO;                           /*                       @Y30LB39*/ 03272000
*       CALL CRVRTN;                /*                       @Y30LB39*/ 03273000
         BAL   @14,CRVRTN                                          0749 03274000
*       RESPECIFY                                                  0750 03275000
*         RTNREG RSTD;                                             0750 03276000
*       TESTRC=RTNREG;                                             0751 03277000
         LR    TESTRC,RTNREG                                       0751 03278000
*       RESPECIFY                                                  0752 03279000
*         RTNREG UNRSTD;            /*                       @Y30LB39*/ 03280000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 03281000
         LTR   TESTRC,TESTRC                                       0753 03282000
         BZ    @RF00753                                            0753 03283000
*         WORKRC=LASTCC12;          /*                       @Y30LB39*/ 03284000
         LA    WORKRC,12                                           0754 03285000
*     END;                          /*                       @Y30LB39*/ 03286000
@RF00753 DS    0H                                                  0756 03287000
*                                   /*                       @Y30LB39*/ 03288000
*                                                                  0756 03289000
*   /*****************************************************************/ 03290000
*   /*                                                               */ 03291000
*   /*                                                       @Y30LB39*/ 03292000
*   /* CHECK RETURN CODE                                     @Y30LB39*/ 03293000
*   /*                                                       @Y30LB39*/ 03294000
*   /*                                                               */ 03295000
*   /*****************************************************************/ 03296000
*                                                                  0756 03297000
*                                   /*                       @Y30LB39*/ 03298000
*   IF WORKRC=0 THEN                /*                       @Y30LB39*/ 03299000
@RF00747 C     WORKRC,@CF00115                                     0756 03300000
         BNE   @RF00756                                            0756 03301000
*     DO;                           /*                       @Y30LB39   03302000
*                                                            @Y30LB39*/ 03303000
*                                                                  0757 03304000
*       /*************************************************************/ 03305000
*       /*                                                           */ 03306000
*       /*                                                   @Y30LB39*/ 03307000
*       /* CALL DMNTRTN TO DEMOUNT THE SOURCE VOLUME.        @Y30LB39*/ 03308000
*       /* NOT DEMOUNTING THE SOURCE VOLUME UNTIL            @Y30LB39*/ 03309000
*       /* IMMIDIATELY PRIOR TO THE COPY OPERATION           @Y30LB39*/ 03310000
*       /* REDUCES THE EXPOSURE OF ANOTHER SYSTEM            @Y30LB39*/ 03311000
*       /* MOUNTING THE VOLUME BEFORE COPYV PERFORMS         @Y30LB39*/ 03312000
*       /* THE COPY.                                         @Y30LB39*/ 03313000
*       /*                                                   @Y30LB39*/ 03314000
*       /*                                                           */ 03315000
*       /*************************************************************/ 03316000
*                                                                  0758 03317000
*                                   /*                       @Y30LB39*/ 03318000
*       CALL DMNTRTN;               /*                       @Y30LB39*/ 03319000
         BAL   @14,DMNTRTN                                         0758 03320000
*       RESPECIFY                                                  0759 03321000
*         RTNREG RSTD;                                             0759 03322000
*       TESTRC=RTNREG;                                             0760 03323000
         LR    TESTRC,RTNREG                                       0760 03324000
*       RESPECIFY                                                  0761 03325000
*         RTNREG UNRSTD;            /*                       @Y30LB39*/ 03326000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 03327000
         LTR   TESTRC,TESTRC                                       0762 03328000
         BZ    @RF00762                                            0762 03329000
*         DO;                       /*                       @Y30LB39   03330000
*                                                            @Y30LB39*/ 03331000
*                                                                  0763 03332000
*           /*********************************************************/ 03333000
*           /*                                                       */ 03334000
*           /*                                               @Y30LB39*/ 03335000
*           /* AFTER SETTING THE CONDITION CODE TO 12,       @Y30LB39*/ 03336000
*           /* SET THE MESSAGE IDC0009I IF THE               @Y30LB39*/ 03337000
*           /* OBKUPFLG IS ON (THIS MEANS THAT THE           @Y30LB39*/ 03338000
*           /* OLDEST BACKUP WAS SELECTED AS THE             @Y30LB39*/ 03339000
*           /* TARGET VOLUME.                                @Y30LB39*/ 03340000
*           /* OTHERWISE, SET THE MESSAGE IDC0006I           @Y30LB39*/ 03341000
*           /* SINCE THE TARGET IS AN INCOMPLETE COPY        @Y30LB39*/ 03342000
*           /* VOLUME. ISSUE UPRINT FOR THE APPROPRI-        @Y30LB39*/ 03343000
*           /* ATE SECONDARY MESSAGE.                        @Y30LB39*/ 03344000
*           /*                                               @Y30LB39*/ 03345000
*           /*                                                       */ 03346000
*           /*********************************************************/ 03347000
*                                                                  0764 03348000
*                                   /*                       @Y30LB39*/ 03349000
*           WORKRC=LASTCC12;        /*                       @Y30LB39*/ 03350000
         LA    WORKRC,12                                           0764 03351000
*           DARGLIST=''B;           /*                       @Y30LB39*/ 03352000
         L     @09,DDSTRU                                          0765 03353000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      0765 03354000
*           DARGSMOD=COPYMSG;       /*                       @Y30LB39*/ 03355000
         MVC   DARGSMOD(3,@09),@CC01548                            0766 03356000
*           IF OBKUPFLG=ON THEN     /*                       @Y30LB39*/ 03357000
         TM    OBKUPFLG,B'01000000'                                0767 03358000
         BNO   @RF00767                                            0767 03359000
*             DARGSENT=MSG3709I;    /*                       @Y30LB39*/ 03360000
         MVI   DARGSENT(@09),X'0A'                                 0768 03361000
*           ELSE                    /*                       @Y30LB39*/ 03362000
*             DARGSENT=MSG3706I;    /*                       @Y30LB39*/ 03363000
         B     @RC00767                                            0769 03364000
@RF00767 L     @09,DDSTRU                                          0769 03365000
         MVI   DARGSENT(@09),X'07'                                 0769 03366000
*           DARGDBP=ADDR(CSN1AREA); /*                       @Y30LB39*/ 03367000
@RC00767 L     @09,DDSTRU                                          0770 03368000
         LA    @04,CSN1AREA                                        0770 03369000
         ST    @04,DARGDBP(,@09)                                   0770 03370000
*           DARGILP=LENGTH(CSN1AREA);/*                      @Y30LB39*/ 03371000
         LA    @04,12                                              0771 03372000
         STH   @04,DARGILP(,@09)                                   0771 03373000
*           DARGCNT=CSN2INST;       /*                       @Y30LB39*/ 03374000
         LA    @15,1                                               0772 03375000
         STH   @15,DARGCNT(,@09)                                   0772 03376000
*           DARGINS(1)=CSN2INST;    /*                       @Y30LB39*/ 03377000
         STH   @15,DARGINS(,@09)                                   0773 03378000
*           DARGINL(1)=LENGTH(CSN2AREA);/*                   @Y30LB39*/ 03379000
         STH   @04,DARGINL(,@09)                                   0774 03380000
*           DARGDTM(1)=ADDR(CSN2AREA);/*                     @Y30LB39   03381000
*                                                            @Y30LB39*/ 03382000
         LA    @04,CSN2AREA                                        0775 03383000
         ST    @04,DARGDTM(,@09)                                   0775 03384000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39   03385000
*                                                            @Y30LB39*/ 03386000
         L     @09,@PC00001                                        0776 03387000
         ST    @09,@AL00001                                        0776 03388000
         LA    @04,@CF00115                                        0776 03389000
         ST    @04,@AL00001+4                                      0776 03390000
         LA    @04,DDSTRU                                          0776 03391000
         ST    @04,@AL00001+8                                      0776 03392000
         MVI   @AL00001+8,X'80'                                    0776 03393000
         L     @15,GDTPRT(,@09)                                    0776 03394000
         LA    @01,@AL00001                                        0776 03395000
         BALR  @14,@15                                             0776 03396000
*         END;                      /*                       @Y30LB39*/ 03397000
*       IF WORKRC=0 THEN            /*                       @Y30LB39*/ 03398000
@RF00762 C     WORKRC,@CF00115                                     0778 03399000
         BNE   @RF00778                                            0778 03400000
*         DO;                       /*                       @Y30LB39   03401000
*                                                            @Y30LB39*/ 03402000
*                                                                  0779 03403000
*           /*********************************************************/ 03404000
*           /*                                                       */ 03405000
*           /*                                               @Y30LB39*/ 03406000
*           /* CALL COPYRTN TO COPY THE SOURCE VOLUME.       @Y30LB39*/ 03407000
*           /* IF THE RETURN CODE IS NOT ZERO, EXIT          @Y30LB39*/ 03408000
*           /* THIS ROUTINE.                                 @Y30LB39*/ 03409000
*           /*                                               @Y30LB39*/ 03410000
*           /*                                                       */ 03411000
*           /*********************************************************/ 03412000
*                                                                  0780 03413000
*                                   /*                       @Y30LB39*/ 03414000
*           CALL COPYRTN;           /*                       @Y30LB39*/ 03415000
         BAL   @14,COPYRTN                                         0780 03416000
*           RESPECIFY                                              0781 03417000
*             RTNREG RSTD;                                         0781 03418000
*           TESTRC=RTNREG;                                         0782 03419000
         LR    TESTRC,RTNREG                                       0782 03420000
*           RESPECIFY                                              0783 03421000
*             RTNREG UNRSTD;        /*                       @Y30LB39*/ 03422000
*           IF TESTRC^=0 THEN       /*                       @Y30LB39*/ 03423000
         LTR   TESTRC,TESTRC                                       0784 03424000
         BZ    @RF00784                                            0784 03425000
*             WORKRC=LASTCC12;      /*                       @Y30LB39*/ 03426000
         LA    WORKRC,12                                           0785 03427000
*           ELSE                    /*                       @ZD00175*/ 03428000
*             DO;                   /*                       @ZD00175   03429000
*                                                            @Y30LB39*/ 03430000
*                                                                  0786 03431000
         B     @RC00784                                            0786 03432000
@RF00784 DS    0H                                                  0787 03433000
*               /*****************************************************/ 03434000
*               /*                                                   */ 03435000
*               /*                                           @Y30LB39*/ 03436000
*               /* CALL LABELRTN IF REUSEFLG BIT IS ON AND   @Y30LB39*/ 03437000
*               /* THE OWNER MUST BE UPDATED. THIS MIS-      @Y30LB39*/ 03438000
*               /* MATCH BETWEEN COPY AND BASE VOLUME        @Y30LB39*/ 03439000
*               /* OWNERS OCCURED IF THE COPY WAS MADE TO    @Y30LB39*/ 03440000
*               /* AN EXISTING COPY VOLUME. THE LABELRTN     @Y30LB39*/ 03441000
*               /* WILL UPDATE THE OWNER IN THE CARTRIDGE    @Y30LB39*/ 03442000
*               /* LABELS AND INVENTORY RECORD TO AGREE      @Y30LB39*/ 03443000
*               /* WITH THE VOLUME LABEL.                    @Y30LB39*/ 03444000
*               /*                                           @Y30LB39*/ 03445000
*               /*                                                   */ 03446000
*               /*****************************************************/ 03447000
*                                                                  0787 03448000
*                                   /*                       @Y30LB39*/ 03449000
*               IF REUSEFLG=ON&BASOWNER^=COPOWNER THEN/*     @Y30LB39*/ 03450000
         TM    REUSEFLG,B'10000000'                                0787 03451000
         BNO   @RF00787                                            0787 03452000
         CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            0787 03453000
         BE    @RF00787                                            0787 03454000
*                 DO;               /*                       @Y30LB39*/ 03455000
*                   CALL LABELRTN;  /*                       @Y30LB39*/ 03456000
         BAL   @14,LABELRTN                                        0789 03457000
*                   RESPECIFY                                      0790 03458000
*                     RTNREG RSTD;                                 0790 03459000
*                   TESTRC=RTNREG;                                 0791 03460000
         LR    TESTRC,RTNREG                                       0791 03461000
*                   RESPECIFY                                      0792 03462000
*                     RTNREG UNRSTD;/*                       @Y30LB39*/ 03463000
*                   IF TESTRC^=0 THEN/*                      @Y30LB39*/ 03464000
         LTR   TESTRC,TESTRC                                       0793 03465000
         BZ    @RF00793                                            0793 03466000
*                     WORKRC=LASTCC04;/*                     @Y30LB39*/ 03467000
         LA    WORKRC,4                                            0794 03468000
*                 END;              /*                       @Y30LB39   03469000
*                                                            @Y30LB39*/ 03470000
*                                                                  0795 03471000
@RF00793 DS    0H                                                  0796 03472000
*               /*****************************************************/ 03473000
*               /*                                                   */ 03474000
*               /*                                           @Y30LB39*/ 03475000
*               /* CALL VOLEXIT, IF EJECT IS SPECIFIED,      @Y30LB39*/ 03476000
*               /* TO EJECT THE COPY FROM THE MASS STORAGE   @Y30LB39*/ 03477000
*               /* FACILITY.                                 @Y30LB39*/ 03478000
*               /*                                           @Y30LB39*/ 03479000
*               /*                                                   */ 03480000
*               /*****************************************************/ 03481000
*                                                                  0796 03482000
*                                   /*                       @Y30LB39*/ 03483000
*               IF ADDR(EJECT)^=NULLPTR THEN/*               @Y30LB39*/ 03484000
@RF00787 SLR   @09,@09                                             0796 03485000
         L     @04,@PC00001+4                                      0796 03486000
         C     @09,FDTPTR+24(,@04)                                 0796 03487000
         BE    @RF00796                                            0796 03488000
*                 DO;               /*                       @Y30LB39*/ 03489000
*                   IF ADDR(REC)^=NULLPTR THEN/*             @Y30LB39*/ 03490000
         C     @09,FDTPTR+32(,@04)                                 0798 03491000
         BE    @RF00798                                            0798 03492000
*                     SAVEFLG=ON;   /*                       @Y30LB39*/ 03493000
         OI    SAVEFLG,B'10000000'                                 0799 03494000
*                   ELSE            /*                       @Y30LB39*/ 03495000
*                     SAVEFLG=OFF;  /*                       @Y30LB39*/ 03496000
         B     @RC00798                                            0800 03497000
@RF00798 NI    SAVEFLG,B'01111111'                                 0800 03498000
*                   IF ADDR(LOC)^=NULLPTR THEN/*             @Y30LB39*/ 03499000
@RC00798 L     @09,@PC00001+4                                      0801 03500000
         L     @09,FDTPTR+40(,@09)                                 0801 03501000
         LTR   @09,@09                                             0801 03502000
         BZ    @RF00801                                            0801 03503000
*                     DATAVALU=LOCVAL;/*                     @Y30LB39*/ 03504000
         MVC   DATAVALU(30),LOCVAL(@09)                            0802 03505000
*                   ELSE            /*                       @Y30LB39*/ 03506000
*                     DATAVALU=BLNKAREA;/*                   @Y30LB39*/ 03507000
         B     @RC00801                                            0803 03508000
@RF00801 MVI   DATAVALU+1,C' '                                     0803 03509000
         MVC   DATAVALU+2(28),DATAVALU+1                           0803 03510000
         MVC   DATAVALU(1),BLNKAREA                                0803 03511000
*                   CALL VOLEXIT(CSN1AREA,VOLVAL,IOERRFLG,SAVEFLG, 0804 03512000
*                       DATAVALU);  /*                       @Y30LB39*/ 03513000
@RC00801 LA    @09,CSN1AREA                                        0804 03514000
         ST    @09,@AL00001                                        0804 03515000
         L     @09,@PC00001+4                                      0804 03516000
         L     @09,FDTPTR(,@09)                                    0804 03517000
         LA    @09,VOLVAL(,@09)                                    0804 03518000
         ST    @09,@AL00001+4                                      0804 03519000
         LA    @09,IOERRFLG                                        0804 03520000
         ST    @09,@AL00001+8                                      0804 03521000
         LA    @09,SAVEFLG                                         0804 03522000
         ST    @09,@AL00001+12                                     0804 03523000
         LA    @09,DATAVALU                                        0804 03524000
         ST    @09,@AL00001+16                                     0804 03525000
         LA    @01,@AL00001                                        0804 03526000
         BAL   @14,VOLEXIT                                         0804 03527000
*                   RESPECIFY                                      0805 03528000
*                     RTNREG RSTD;                                 0805 03529000
*                   TESTRC=RTNREG;                                 0806 03530000
         LR    TESTRC,RTNREG                                       0806 03531000
*                   RESPECIFY                                      0807 03532000
*                     RTNREG UNRSTD;/*                       @Y30LB39*/ 03533000
*                   IF TESTRC^=0 THEN/*                      @Y30LB39*/ 03534000
         LTR   TESTRC,TESTRC                                       0808 03535000
         BZ    @RF00808                                            0808 03536000
*                     WORKRC=LASTCC08;/*                     @Y30LB39*/ 03537000
         LA    WORKRC,8                                            0809 03538000
*                 END;              /*                       @Y30LB39*/ 03539000
@RF00808 DS    0H                                                  0811 03540000
*             END;                  /*                       @Y30LB39*/ 03541000
@RF00796 DS    0H                                                  0812 03542000
*                                                                  0812 03543000
*           /*********************************************************/ 03544000
*           /*                                                       */ 03545000
*           /*                                               @ZD00175*/ 03546000
*           /* MOUNT THE SOURCE VOLUME. THE SECURITY         @XD00175*/ 03547000
*           /* CHECK DONE BY IDCVS01 MAY HAVE RESULTED IN    @XD00175*/ 03548000
*           /* DYNAMIC ALLOCATION OF A VSAM PRIVATE CATALOG. @ZD00175*/ 03549000
*           /* THEREFORE THE VOLUME MUST REMAIN MOUNTED      @ZD00175*/ 03550000
*           /* AT EOJ SINCE THE VSAM PRIVATE CATALOG IS STILL        */ 03551000
*           /*                                               @ZD00175*/ 03552000
*           /* OPEN.                                         @ZD00175*/ 03553000
*           /*                                               @ZD00175*/ 03554000
*           /*                                               @ZD00175*/ 03555000
*           /* MOUNT THE VOLUME. NOTE THAT MDAGL WAS         @ZD00175*/ 03556000
*           /* INITIALIZED IN THE DMNTRTN PROCEDURE.         @ZD00175*/ 03557000
*           /*                                               @ZD00175*/ 03558000
*           /*                                                       */ 03559000
*           /*********************************************************/ 03560000
*                                                                  0812 03561000
*           MDWAIT=OFF;             /*                       @ZD00175*/ 03562000
@RC00784 LA    @09,MDAGLBUF                                        0812 03563000
         NI    MDWAIT(@09),B'11101111'                             0812 03564000
*           IF GDTDBG=NULLPTR THEN                                 0813 03565000
         L     @09,@PC00001                                        0813 03566000
         L     @09,GDTDBG(,@09)                                    0813 03567000
         LTR   @09,@09                                             0813 03568000
         BZ    @RT00813                                            0813 03569000
*             ;                                                    0814 03570000
*           ELSE                                                   0815 03571000
*             CALL IDCDB010(GDTTBL,'COJJ');/*                @ZD00175*/ 03572000
         L     @09,@PC00001                                        0815 03573000
         ST    @09,@AL00001                                        0815 03574000
         LA    @04,@CC01686                                        0815 03575000
         ST    @04,@AL00001+4                                      0815 03576000
         MVI   @AL00001+4,X'80'                                    0815 03577000
         L     @15,GDTDBG(,@09)                                    0815 03578000
         LA    @01,@AL00001                                        0815 03579000
         BALR  @14,@15                                             0815 03580000
*           CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*             @ZD00175*/ 03581000
@RT00813 L     @09,@PC00001                                        0816 03582000
         ST    @09,@AL00001                                        0816 03583000
         LA    @04,MOUNT                                           0816 03584000
         ST    @04,@AL00001+4                                      0816 03585000
         LA    @04,MDAGLBUF                                        0816 03586000
         ST    @04,@AL00001+8                                      0816 03587000
         MVI   @AL00001+8,X'80'                                    0816 03588000
         L     @15,GDTUNT(,@09)                                    0816 03589000
         LA    @01,@AL00001                                        0816 03590000
         BALR  @14,@15                                             0816 03591000
*           RESPECIFY                                              0817 03592000
*             RTNREG RSTD;                                         0817 03593000
*           TESTRC=RTNREG;                                         0818 03594000
         LR    TESTRC,RTNREG                                       0818 03595000
*           RESPECIFY                                              0819 03596000
*             RTNREG UNRSTD;        /*                       @ZD00175*/ 03597000
*                                                                  0819 03598000
*           /*********************************************************/ 03599000
*           /*                                                       */ 03600000
*           /*                                               @ZD00175*/ 03601000
*           /* IF THE VOLUME CANNOT BE REMOUNTED, SET AN     @ZD00175*/ 03602000
*           /* ERROR CODE AND CONTINUE PROCESSING.           @ZD00175*/ 03603000
*           /*                                               @ZD00175*/ 03604000
*           /*                                                       */ 03605000
*           /*********************************************************/ 03606000
*                                                                  0820 03607000
*           IF TESTRC^=0 THEN                                      0820 03608000
         LTR   TESTRC,TESTRC                                       0820 03609000
         BZ    @RF00820                                            0820 03610000
*             WORKRC=MAX(WORKRC,LASTCC04);/*                 @ZD00175*/ 03611000
         LA    @09,4                                               0821 03612000
         CR    WORKRC,@09                                          0821 03613000
         BNL   *+6                                                      03614000
         LR    WORKRC,@09                                          0821 03615000
*         END;                      /*                       @ZD00175*/ 03616000
@RF00820 DS    0H                                                  0823 03617000
*     END;                          /*                       #Y30LB39   03618000
*                                                            #Y30LB39*/ 03619000
*                                                                  0823 03620000
@RF00778 DS    0H                                                  0824 03621000
*   /*****************************************************************/ 03622000
*   /*                                                               */ 03623000
*   /*                                                       #Y30LB39*/ 03624000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 03625000
*   /*                                                       @Y30LB39*/ 03626000
*   /*                                                               */ 03627000
*   /*****************************************************************/ 03628000
*                                                                  0824 03629000
*                                   /*                       @Y30LB39*/ 03630000
*   REG14=RETADDR1;                 /*                       @Y30LB39   03631000
*                                                            @Y30LB39*/ 03632000
*                                                                  0824 03633000
@RF00756 L     REG14,RETADDR1                                      0824 03634000
*   /*****************************************************************/ 03635000
*   /*                                                               */ 03636000
*   /*                                                       @Y30LB39*/ 03637000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 03638000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 03639000
*   /*                                                       @Y30LB39*/ 03640000
*   /*                                                               */ 03641000
*   /*****************************************************************/ 03642000
*                                                                  0825 03643000
*                                   /*                       @Y30LB39*/ 03644000
*   RETURN CODE(WORKRC);            /*                       @Y30LB39*/ 03645000
         LR    @15,WORKRC                                          0825 03646000
@EL00008 DS    0H                                                  0825 03647000
@EF00008 DS    0H                                                  0825 03648000
@ER00008 BR    @14                                                 0825 03649000
*   END WORKRTN;                    /*                       @Y30LB39*/ 03650000
*                                                                  0827 03651000
*   /*****************************************************************/ 03652000
*   /*                                                               */ 03653000
*   /*                                                       @Y30LB39*/ 03654000
*   /* PROCEDURE NAME - CRVRTN                               @Y30LB39*/ 03655000
*   /*                                                       @Y30LB39*/ 03656000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 03657000
*   /* CREATE VIA THE MSSC DEFINE ORDER A NEW TARGET         @Y30LB39*/ 03658000
*   /* VOLUME FOR THE COPY OPERATION.                        @Y30LB39*/ 03659000
*   /* IF THE DEFINE GOES OKAY, THEN A CHECK IS MADE         @Y30LB39*/ 03660000
*   /* TO SEE IF THE CARTRIDGES HAD BEEN RANDOMLY            @Y30LB39*/ 03661000
*   /* SELECTED. IF THEY HAD BEEN, THEN THE CARTRIDGE        @Y30LB39*/ 03662000
*   /* SERIAL NUMBERS ARE SAVED IN THE COPYV INTERNAL        @Y30LB39*/ 03663000
*   /* TABLE FOR USE BY A LATER SUB-PROCEDURE.               @Y30LB39*/ 03664000
*   /* IF THE DEFINE DOES NOT GO OKAY, THEN                  @Y30LB39*/ 03665000
*   /* MESSAGE IDC3708I IS                                   @Y30LB39*/ 03666000
*   /* ISSUED.                                               @Y30LB39*/ 03667000
*   /* ALSO CALLS SSCMSG TO OUTPUT APPROPRIATE REASON        @Y30LB39*/ 03668000
*   /* CODE IF THE DEFINE ORDER FAILED.                      @Y30LB39*/ 03669000
*   /*                                                       @Y30LB39*/ 03670000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 03671000
*   /* DYNAMIC ARGUMENT LIST(DARGLIST)                       @Y30LB39*/ 03672000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 03673000
*   /* MSSC DEFINE VOLUME PARAMETER LIST                     @Y30LB39*/ 03674000
*   /* EXTENDED ICBDEFV PARM LIST FOR MSVC                   @Y30LB39*/ 03675000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 03676000
*   /*                                                       @Y30LB39*/ 03677000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 03678000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 03679000
*   /* 0 - PROCESSING COMPLETED NORMALLY AND                 @Y30LB39*/ 03680000
*   /* COPYVTBL UPDATED                                      @Y30LB39*/ 03681000
*   /* 4 - DEFINE FAILED, VOLUME NOT CREATED                 @Y30LB39*/ 03682000
*   /*                                                       @Y30LB39*/ 03683000
*   /*                                                               */ 03684000
*   /*****************************************************************/ 03685000
*                                                                  0827 03686000
*CRVRTN:                                                           0827 03687000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 03688000
*                                                                  0827 03689000
CRVRTN   DS    0H                                                  0828 03690000
*   /*****************************************************************/ 03691000
*   /*                                                               */ 03692000
*   /*                                                       @Y30LB39*/ 03693000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 03694000
*   /*                                                       @Y30LB39*/ 03695000
*   /*                                                               */ 03696000
*   /*****************************************************************/ 03697000
*                                                                  0828 03698000
*                                   /*                       @Y30LB39*/ 03699000
*   DCL                                                            0828 03700000
*     CRVRC FIXED(8);               /* RETURN CODE           @Y30LB39*/ 03701000
*                                   /*                       @Y30LB39*/ 03702000
*                                                                  0829 03703000
*   /*****************************************************************/ 03704000
*   /*                                                               */ 03705000
*   /*                                                       @Y30LB39*/ 03706000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 03707000
*   /*                                                       @Y30LB39*/ 03708000
*   /*                                                               */ 03709000
*   /*****************************************************************/ 03710000
*                                                                  0829 03711000
*                                   /*                       @Y30LB39*/ 03712000
*   RETADDR2=REG14;                 /*                       @Y30LB39   03713000
*                                                            @Y30LB39*/ 03714000
*                                                                  0829 03715000
         LR    RETADDR2,REG14                                      0829 03716000
*   /*****************************************************************/ 03717000
*   /*                                                               */ 03718000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 03719000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 03720000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 03721000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 03722000
*   /*                                                       @Y30LB39*/ 03723000
*   /*                                                               */ 03724000
*   /*****************************************************************/ 03725000
*                                                                  0830 03726000
*                                   /*                       @Y30LB39*/ 03727000
*   OLDERID2=NEWERID2;                                             0830 03728000
         L     @15,@PC00001                                        0830 03729000
         L     @15,GDTTR2(,@15)                                    0830 03730000
         MVC   @TS00001(95),NEWERID2(@15)                          0830 03731000
         MVC   OLDERID2(95,@15),@TS00001                           0830 03732000
*   NEWID2='COCR';                  /*                       @Y30LB39   03733000
*                                                            @Y30LB39*/ 03734000
*                                                                  0831 03735000
         MVC   NEWID2(4,@15),@CC01691                              0831 03736000
*   /*****************************************************************/ 03737000
*   /*                                                               */ 03738000
*   /*                                                       @Y30LB39*/ 03739000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 03740000
*   /*                                                       @Y30LB39*/ 03741000
*   /*                                                               */ 03742000
*   /*****************************************************************/ 03743000
*                                                                  0832 03744000
*                                   /*                       @Y30LB39*/ 03745000
*   CRVRC=LASTCC00;                 /*                       @Y30LB39   03746000
*                                                            @Y30LB39*/ 03747000
*                                                                  0832 03748000
         SLR   CRVRC,CRVRC                                         0832 03749000
*   /*****************************************************************/ 03750000
*   /*                                                               */ 03751000
*   /*                                                       @Y30LB39*/ 03752000
*   /* INITIALIZE THE MSVC EXTENSION LIST FOR DEFINING       @Y30LB39*/ 03753000
*   /* A VOLUME                                              @Y30LB39*/ 03754000
*   /*                                                       @Y30LB39*/ 03755000
*   /*                                                               */ 03756000
*   /*****************************************************************/ 03757000
*                                                                  0833 03758000
*                                   /*                       @Y30LB39*/ 03759000
*   DEFVE=''B;                      /*                       @Y30LB39*/ 03760000
         L     @15,DEFVEPTR                                        0833 03761000
         XC    DEFVE(64,@15),DEFVE(@15)                            0833 03762000
*   DEFLNGTH=DEFLEN;                /*                       @Y30LB39*/ 03763000
         LH    @14,DEFLEN                                          0834 03764000
         ST    @14,DEFLNGTH(,@15)                                  0834 03765000
*   DEFDESCR=DESCRVAL;              /*                       @Y30LB39*/ 03766000
         L     @14,@PC00001+4                                      0835 03767000
         L     @01,FDTPTR+20(,@14)                                 0835 03768000
         MVC   DEFDESCR(30,@15),DESCRVAL(@01)                      0835 03769000
*   DEFPDESC=ON;                    /*                       @Y30LB39*/ 03770000
         OI    DEFPDESC(@15),B'00010000'                           0836 03771000
*   DEFCOPY=ON;                     /*                       @Y30LB39*/ 03772000
         OI    DEFCOPY(@15),B'00010000'                            0837 03773000
*   DEFSRCVY=ON;                    /*                       @Y30LB39*/ 03774000
         OI    DEFSRCVY(@15),B'10000000'                           0838 03775000
*   DEFICOPY=ON;                    /*                       @Y30LB39   03776000
*                                                            @Y30LB39*/ 03777000
*                                                                  0839 03778000
         OI    DEFICOPY(@15),B'10000000'                           0839 03779000
*   /*****************************************************************/ 03780000
*   /*                                                               */ 03781000
*   /*                                                       @Y30LB39*/ 03782000
*   /* INITIALIZE THE MSVC LIST FOR DEFINING A VOLUME        @Y30LB39*/ 03783000
*   /* THE MSS MOUNTING CHARACTERISTICS ARE OBTAINED         @Y30LB39*/ 03784000
*   /* FROM THE SOURCE VOLUME RECORD.                        @Y30LB39*/ 03785000
*   /*                                                       @Y30LB39*/ 03786000
*   /*                                                               */ 03787000
*   /*****************************************************************/ 03788000
*                                                                  0840 03789000
*                                   /*                       @Y30LB39*/ 03790000
*   DEFLIST=''B;                    /*                       @Y30LB39*/ 03791000
         L     @15,DEFVPTR                                         0840 03792000
         XC    DEFLIST(132,@15),DEFLIST(@15)                       0840 03793000
*   DEFVCR=ON;                      /*                       @Y30LB39*/ 03794000
         OI    DEFVCR(@15),B'10000000'                             0841 03795000
*   DEFVLIB=MSFVAL;                 /*                       @Y30LB39*/ 03796000
         L     @01,FDTPTR+60(,@14)                                 0842 03797000
         MVC   DEFVLIB(1,@15),MSFVAL+3(@01)                        0842 03798000
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB39*/ 03799000
         L     @01,FDTPTR(,@14)                                    0843 03800000
         MVC   DEFVOLD(6,@15),VOLVAL(@01)                          0843 03801000
*   IF BASDAERA=ON THEN             /*                       @Y30LB39*/ 03802000
         TM    BASDAERA(BASEVPTR),B'10000000'                      0844 03803000
         BNO   @RF00844                                            0844 03804000
*     DEFVSEC=ON;                   /*                       @Y30LB39*/ 03805000
         OI    DEFVSEC(@15),B'00100000'                            0845 03806000
*   IF BASEXCL=ON THEN              /*                       @Y30LB39*/ 03807000
@RF00844 TM    BASEXCL(BASEVPTR),B'00000001'                       0846 03808000
         BNO   @RF00846                                            0846 03809000
*     DEFVEXCL=ON;                  /*                       @Y30LB39*/ 03810000
         L     @01,DEFVPTR                                         0847 03811000
         OI    DEFVEXCL(@01),B'00010000'                           0847 03812000
*   IF BASBIND=ON THEN              /*                       @Y30LB39*/ 03813000
@RF00846 TM    BASBIND(BASEVPTR),B'00000010'                       0848 03814000
         BNO   @RF00848                                            0848 03815000
*     DEFVBIND=ON;                  /*                       @Y30LB39*/ 03816000
         L     @01,DEFVPTR                                         0849 03817000
         OI    DEFVBIND(@01),B'00000100'                           0849 03818000
*   IF BASRONLY=ON THEN             /*                       @Y30LB39*/ 03819000
@RF00848 TM    BASRONLY(BASEVPTR),B'01000000'                      0850 03820000
         BNO   @RF00850                                            0850 03821000
*     DEFVWINH=ON;                  /*                       @Y30LB39*/ 03822000
         L     @01,DEFVPTR                                         0851 03823000
         OI    DEFVWINH(@01),B'00000010'                           0851 03824000
*   DEFVCSN1=CSN1AREA;              /*                       @Y30LB39*/ 03825000
@RF00850 L     @15,DEFVPTR                                         0852 03826000
         MVC   DEFVCSN1(12,@15),CSN1AREA                           0852 03827000
*   DEFVCSN2=CSN2AREA;              /*                       @Y30LB39*/ 03828000
         MVC   DEFVCSN2(12,@15),CSN2AREA                           0853 03829000
*   DEFVDATA=BLNKAREA;              /*                       @Y30LB39*/ 03830000
         MVI   DEFVDATA+1(@15),C' '                                0854 03831000
         MVC   DEFVDATA+2(70,@15),DEFVDATA+1(@15)                  0854 03832000
         MVC   DEFVDATA(1,@15),BLNKAREA                            0854 03833000
*   DEFOWNID=BASOWNER;              /*                       @Y30LB39*/ 03834000
         MVI   DEFOWNID+10(@15),C' '                               0855 03835000
         MVC   DEFOWNID+11(3,@15),DEFOWNID+10(@15)                 0855 03836000
         MVC   DEFOWNID(10,@15),BASOWNER(BASEVPTR)                 0855 03837000
*   DEFTLAB='T';                    /*                       @Y30LB39*/ 03838000
         MVI   DEFTLAB(@15),C'T'                                   0856 03839000
*   DEFVVEXT=DEFVEPTR;              /*                       @Y30LB39   03840000
*                                                            @Y30LB39*/ 03841000
*                                                                  0857 03842000
         L     @14,DEFVEPTR                                        0857 03843000
         ST    @14,DEFVVEXT(,@15)                                  0857 03844000
*   /*****************************************************************/ 03845000
*   /*                                                               */ 03846000
*   /*                                                       @Y30LB39*/ 03847000
*   /* ISSUE USSC TO CREATE A NEW VOLUME AFTER DUMPING       @ZD00175*/ 03848000
*   /* DEFLIST AND DEFVE.                                    @Y30LB39*/ 03849000
*   /*                                                       @Y30LB39*/ 03850000
*   /*                                                               */ 03851000
*   /*****************************************************************/ 03852000
*                                                                  0858 03853000
*                                   /*                       @Y30LB39*/ 03854000
*   IF GDTDBG=NULLPTR THEN                                         0858 03855000
         L     @15,@PC00001                                        0858 03856000
         L     @15,GDTDBG(,@15)                                    0858 03857000
         LTR   @15,@15                                             0858 03858000
         BZ    @RT00858                                            0858 03859000
*     ;                                                            0859 03860000
*   ELSE                                                           0860 03861000
*     DO;                                                          0860 03862000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/ 03863000
         LA    DMPINDEX,DUMPLIST                                   0861 03864000
*       DMPITMNM='DEFLISTB';                                       0862 03865000
         MVC   DMPITMNM(8,DMPINDEX),@CC01693                       0862 03866000
*       DMPITMPT=ADDR(DEFLISTB);                                   0863 03867000
         LA    @03,DEFLISTB                                        0863 03868000
         ST    @03,DMPITMPT(,DMPINDEX)                             0863 03869000
*       DMPITMLN=LENGTH(DEFLISTB);                                 0864 03870000
         MVC   DMPITMLN(2,DMPINDEX),@CH01906                       0864 03871000
*       DMPITMTP='H';                                              0865 03872000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0865 03873000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0866 03874000
         LA    @03,16                                              0866 03875000
         ALR   DMPINDEX,@03                                        0866 03876000
*       DMPITMNM='DEFVEBUF';                                       0867 03877000
         MVC   DMPITMNM(8,DMPINDEX),@CC01694                       0867 03878000
*       DMPITMPT=ADDR(DEFVEBUF);                                   0868 03879000
         LA    @15,DEFVEBUF                                        0868 03880000
         ST    @15,DMPITMPT(,DMPINDEX)                             0868 03881000
*       DMPITMLN=LENGTH(DEFVEBUF);                                 0869 03882000
         MVC   DMPITMLN(2,DMPINDEX),@CH01905                       0869 03883000
*       DMPITMTP='H';                                              0870 03884000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0870 03885000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0871 03886000
         ALR   DMPINDEX,@03                                        0871 03887000
*       DMPTRM=DMPTRMVL;                                           0872 03888000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0872 03889000
*     END;                          /*                       @Y30LB39   03890000
*                                                            @Y30LB39*/ 03891000
*   IF GDTDBG=NULLPTR THEN                                         0874 03892000
@RT00858 L     @15,@PC00001                                        0874 03893000
         L     @15,GDTDBG(,@15)                                    0874 03894000
         LTR   @15,@15                                             0874 03895000
         BZ    @RT00874                                            0874 03896000
*     ;                                                            0875 03897000
*   ELSE                                                           0876 03898000
*     CALL IDCDB010(GDTTBL,'COCC',ADDR(DUMPLIST));/*         @Y30LB39   03899000
*                                                            @Y30LB39*/ 03900000
         L     @15,@PC00001                                        0876 03901000
         ST    @15,@AL00001                                        0876 03902000
         LA    @14,@CC01695                                        0876 03903000
         ST    @14,@AL00001+4                                      0876 03904000
         LA    @14,DUMPLIST                                        0876 03905000
         ST    @14,@AFTEMPS+4                                      0876 03906000
         LA    @14,@AFTEMPS+4                                      0876 03907000
         ST    @14,@AL00001+8                                      0876 03908000
         MVI   @AL00001+8,X'80'                                    0876 03909000
         L     @15,GDTDBG(,@15)                                    0876 03910000
         LA    @01,@AL00001                                        0876 03911000
         BALR  @14,@15                                             0876 03912000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBBYTE,CMMSGPTR);/*     03913000
*                                                            @Y30LB39*/ 03914000
@RT00874 L     @02,@PC00001                                        0877 03915000
         ST    @02,@AL00001                                        0877 03916000
         LA    @15,DEFINE                                          0877 03917000
         ST    @15,@AL00001+4                                      0877 03918000
         LA    @15,DEFVPTR                                         0877 03919000
         ST    @15,@AL00001+8                                      0877 03920000
         LA    @15,REASON                                          0877 03921000
         ST    @15,@AL00001+12                                     0877 03922000
         LA    @15,ECBBYTE                                         0877 03923000
         ST    @15,@AL00001+16                                     0877 03924000
         LA    @15,CMMSGPTR                                        0877 03925000
         ST    @15,@AL00001+20                                     0877 03926000
         MVI   @AL00001+20,X'80'                                   0877 03927000
         L     @15,GDTSSC(,@02)                                    0877 03928000
         LA    @01,@AL00001                                        0877 03929000
         BALR  @14,@15                                             0877 03930000
*   RESPECIFY                                                      0878 03931000
*     RTNREG RSTD;                                                 0878 03932000
*   TESTRC=RTNREG;                                                 0879 03933000
         LR    TESTRC,RTNREG                                       0879 03934000
*   RESPECIFY                                                      0880 03935000
*     RTNREG UNRSTD;                /*                       @Y30LB39   03936000
*                                                            @Y30LB39*/ 03937000
*                                                                  0880 03938000
*   /*****************************************************************/ 03939000
*   /*                                                               */ 03940000
*   /*                                                       @Y30LB39*/ 03941000
*   /* IF MSVC RETURNS A RETURN CODE OF TWELVE,              @Y30LB39*/ 03942000
*   /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN            @Y30LB39*/ 03943000
*   /* I-O ERROR PREVENTED THE UPDATING OF THE               @Y30LB39*/ 03944000
*   /* MS INVENTORY. THIS RETURN CODE SHOULD BE              @Y30LB39*/ 03945000
*   /* TREATED AS A RETURN CODE OF ZERO, EXCEPT              @Y30LB39*/ 03946000
*   /* THAT THE FINAL CODE TO THE EXECUTIVE                  @Y30LB39*/ 03947000
*   /* SHOULD BE AT LEAST FOUR. THAT IS THE                  @Y30LB39*/ 03948000
*   /* REASON FOR SETTING IOERRFLG ON.                       @Y30LB39*/ 03949000
*   /*                                                       @Y30LB39*/ 03950000
*   /*                                                               */ 03951000
*   /*****************************************************************/ 03952000
*                                                                  0881 03953000
*                                   /*                       @Y30LB39*/ 03954000
*   IF TESTRC=12 THEN               /*                       @Y30LB39*/ 03955000
         C     TESTRC,@CF00567                                     0881 03956000
         BNE   @RF00881                                            0881 03957000
*     DO;                           /*                       @Y30LB39*/ 03958000
*       TESTRC=LASTCC00;            /*                       @Y30LB39*/ 03959000
         SLR   TESTRC,TESTRC                                       0883 03960000
*       IOERRFLG=ON;                /*                       @Y30LB39*/ 03961000
         OI    IOERRFLG,B'10000000'                                0884 03962000
*     END;                          /*                       @Y30LB39*/ 03963000
*                                   /*                       @Y30LB39*/ 03964000
*                                                                  0886 03965000
*   /*****************************************************************/ 03966000
*   /*                                                               */ 03967000
*   /*                                                       @Y30LB39*/ 03968000
*   /* CHECK RETURN CODE                                     @Y30LB39*/ 03969000
*   /*                                                       @Y30LB39*/ 03970000
*   /*                                                               */ 03971000
*   /*****************************************************************/ 03972000
*                                                                  0886 03973000
*                                   /*                       @Y30LB39*/ 03974000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/ 03975000
@RF00881 LTR   TESTRC,TESTRC                                       0886 03976000
         BZ    @RF00886                                            0886 03977000
*     DO;                           /*                       @Y30LB39   03978000
*                                                            @Y30LB39*/ 03979000
*                                                                  0887 03980000
*       /*************************************************************/ 03981000
*       /*                                                           */ 03982000
*       /*                                                   @Y30LB39*/ 03983000
*       /* USSC RETURN CODE IS NOT ZERO. SET CONDITION       @Y30LB39*/ 03984000
*       /* CODE TO FOUR PRIOR TO PUTTING OUT MESSAGES.       @Y30LB39*/ 03985000
*       /*                                                   @Y30LB39*/ 03986000
*       /*                                                           */ 03987000
*       /*************************************************************/ 03988000
*                                                                  0888 03989000
*                                   /*                       @Y30LB39*/ 03990000
*       CRVRC=LASTCC04;             /*                       @Y30LB39   03991000
*                                                            @Y30LB39*/ 03992000
*                                                                  0888 03993000
         LA    @02,4                                               0888 03994000
         LR    CRVRC,@02                                           0888 03995000
*       /*************************************************************/ 03996000
*       /*                                                           */ 03997000
*       /*                                                   @Y30LB39*/ 03998000
*       /* IF THE DEFINE ORDER FAILED,                       @Y30LB39*/ 03999000
*       /* CALL SSCMSG TO OUTPUT APPROPRIATE REASON          @Y30LB39*/ 04000000
*       /* CODE MESSAGE.                                     @Y30LB39*/ 04001000
*       /*                                                   @Y30LB39*/ 04002000
*       /*                                                           */ 04003000
*       /*************************************************************/ 04004000
*                                                                  0889 04005000
*                                   /*                       @Y30LB39*/ 04006000
*       IF TESTRC=LASTCC04 THEN     /*                       @Y30LB39   04007000
*                                                            @Y30LB39*/ 04008000
         CR    TESTRC,@02                                          0889 04009000
         BNE   @RF00889                                            0889 04010000
*         CALL SSCMSG(REASON,ECBBYTE);/*                     @Y30LB39   04011000
*                                                            @Y30LB39   04012000
*                                                            @Y30LB39*/ 04013000
*                                                                  0890 04014000
         LA    @15,REASON                                          0890 04015000
         ST    @15,@AL00001                                        0890 04016000
         LA    @15,ECBBYTE                                         0890 04017000
         ST    @15,@AL00001+4                                      0890 04018000
         LA    @01,@AL00001                                        0890 04019000
         BAL   @14,SSCMSG                                          0890 04020000
*       /*************************************************************/ 04021000
*       /*                                                           */ 04022000
*       /*                                                   @Y30LB39*/ 04023000
*       /* ISSUE UPRINT TO OUTPUT SECONDARY MESSAGE          @Y30LB39*/ 04024000
*       /* IDC3708I.                                         @Y30LB39*/ 04025000
*       /*                                                   @Y30LB39*/ 04026000
*       /*                                                           */ 04027000
*       /*************************************************************/ 04028000
*                                                                  0891 04029000
*                                   /*                       @Y30LB39*/ 04030000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 04031000
@RF00889 L     @15,DDSTRU                                          0891 04032000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0891 04033000
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/ 04034000
         MVC   DARGSMOD(3,@15),@CC01548                            0892 04035000
*       DARGSENT=MSG3708I;          /*                       @Y30LB39   04036000
*                                                            @Y30LB39*/ 04037000
         MVI   DARGSENT(@15),X'09'                                 0893 04038000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   04039000
*                                                            @Y30LB39*/ 04040000
*                                                                  0894 04041000
         L     @15,@PC00001                                        0894 04042000
         ST    @15,@AL00001                                        0894 04043000
         LA    @14,@CF00115                                        0894 04044000
         ST    @14,@AL00001+4                                      0894 04045000
         LA    @14,DDSTRU                                          0894 04046000
         ST    @14,@AL00001+8                                      0894 04047000
         MVI   @AL00001+8,X'80'                                    0894 04048000
         L     @15,GDTPRT(,@15)                                    0894 04049000
         LA    @01,@AL00001                                        0894 04050000
         BALR  @14,@15                                             0894 04051000
*       /*************************************************************/ 04052000
*       /*                                                           */ 04053000
*       /*                                                   @Y30LB39*/ 04054000
*       /* ISSUE UDEQ TO RELEASE RESERVE SETUP BY            @Y30LB39*/ 04055000
*       /* IDCVS01 IN SUBROUTINE VSRTN.                      @Y30LB39*/ 04056000
*       /*                                                   @Y30LB39*/ 04057000
*       /*                                                           */ 04058000
*       /*************************************************************/ 04059000
*                                                                  0895 04060000
*                                   /*                       @Y30LB39*/ 04061000
*       RNAMCHAR(7:22)='.VIRTUAL.RESERVE';/*                 @ZA05138*/ 04062000
         MVC   RNAMCHAR+6(16),@CC01672                             0895 04063000
*       CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*         @Y30LB39   04064000
*                                                            @Y30LB39*/ 04065000
         L     @15,@PC00001                                        0896 04066000
         ST    @15,@AL00001                                        0896 04067000
         LA    @14,@CC01617                                        0896 04068000
         ST    @14,@AL00001+4                                      0896 04069000
         LA    @14,MINORNAM                                        0896 04070000
         ST    @14,@AL00001+8                                      0896 04071000
         MVI   @AL00001+8,X'80'                                    0896 04072000
         L     @15,GDTDEQ(,@15)                                    0896 04073000
         LA    @01,@AL00001                                        0896 04074000
         BALR  @14,@15                                             0896 04075000
*     END;                          /*                       @Y30LB39*/ 04076000
*   ELSE                            /*                       @Y30LB39*/ 04077000
*     DO;                           /*                       @Y30LB39   04078000
*                                                            @Y30LB39*/ 04079000
*                                                                  0898 04080000
         B     @RC00886                                            0898 04081000
@RF00886 DS    0H                                                  0899 04082000
*       /*************************************************************/ 04083000
*       /*                                                           */ 04084000
*       /*                                                   @Y30LB39*/ 04085000
*       /* SET UP ADDRESSABILITY TO DEFINE MESSAGE           @Y30LB39*/ 04086000
*       /* STRUCTURE.                                        @Y30LB39*/ 04087000
*       /*                                                   @Y30LB39*/ 04088000
*       /*                                                           */ 04089000
*       /*************************************************************/ 04090000
*                                                                  0899 04091000
*                                   /*                       @Y30LB39*/ 04092000
*       RFY                                                        0899 04093000
*         CMMSG BASED(CMMSGPTR+4);  /*                       @Y30LB39   04094000
*                                                            @Y30LB39*/ 04095000
*                                                                  0899 04096000
*       /*************************************************************/ 04097000
*       /*                                                           */ 04098000
*       /*                                                   @Y30LB39*/ 04099000
*       /* IF THE CARTRIDGES HAD BEEN RANDOMLY               @Y30LB39*/ 04100000
*       /* SELECTED, THEN SAVE THE CSN1 AND CSN2 FROM        @Y30LB39*/ 04101000
*       /* THE DEFINE MESSAGE AREA.                          @Y30LB39*/ 04102000
*       /*                                                   @Y30LB39*/ 04103000
*       /*                                                           */ 04104000
*       /*************************************************************/ 04105000
*                                                                  0900 04106000
*                                   /*                       @Y30LB39*/ 04107000
*       IF CSN1AREA=TWLVZERO&CSN2AREA=TWLVZERO THEN                0900 04108000
         CLC   CSN1AREA(12),TWLVZERO                               0900 04109000
         BNE   @RF00900                                            0900 04110000
         CLC   CSN2AREA(12),TWLVZERO                               0900 04111000
         BNE   @RF00900                                            0900 04112000
*         DO;                       /*                       @Y30LB39*/ 04113000
*           CSN1AREA=CMCSN1;        /*                       @Y30LB39*/ 04114000
         LA    @15,4                                               0902 04115000
         AL    @15,CMMSGPTR                                        0902 04116000
         MVC   CSN1AREA(12),CMCSN1(@15)                            0902 04117000
*           CSN2AREA=CMCSN2;        /*                       @Y30LB39*/ 04118000
         MVC   CSN2AREA(12),CMCSN2(@15)                            0903 04119000
*         END;                      /*                       @Y30LB39   04120000
*                                                            @Y30LB39*/ 04121000
*                                                                  0904 04122000
*       /*************************************************************/ 04123000
*       /*                                                           */ 04124000
*       /*                                                   @Y30LB39*/ 04125000
*       /* ISSUE UFSPACE TO RELEASE MESSAGE STORAGE          @Y30LB39*/ 04126000
*       /* AREA.                                             @Y30LB39*/ 04127000
*       /*                                                   @Y30LB39*/ 04128000
*       /*                                                           */ 04129000
*       /*************************************************************/ 04130000
*                                                                  0905 04131000
*                                   /*                       @Y30LB39*/ 04132000
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB39   04133000
*                                                            @Y30LB39*/ 04134000
@RF00900 L     @15,@PC00001                                        0905 04135000
         ST    @15,@AL00001                                        0905 04136000
         LA    @14,CMMSGPTR                                        0905 04137000
         ST    @14,@AL00001+4                                      0905 04138000
         L     @15,GDTFSP(,@15)                                    0905 04139000
         LA    @01,@AL00001                                        0905 04140000
         BALR  @14,@15                                             0905 04141000
*     END;                          /*                       @Y30LB39   04142000
*                                                            @Y30LB39*/ 04143000
*                                                                  0906 04144000
*   /*****************************************************************/ 04145000
*   /*                                                               */ 04146000
*   /*                                                       @Y30LB39*/ 04147000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 04148000
*   /*                                                       @Y30LB39*/ 04149000
*   /*                                                               */ 04150000
*   /*****************************************************************/ 04151000
*                                                                  0907 04152000
*                                   /*                       @Y30LB39*/ 04153000
*   REG14=RETADDR2;                 /*                       @Y30LB39   04154000
*                                                            @Y30LB39*/ 04155000
*                                                                  0907 04156000
@RC00886 LR    REG14,RETADDR2                                      0907 04157000
*   /*****************************************************************/ 04158000
*   /*                                                               */ 04159000
*   /*                                                       @Y30LB39*/ 04160000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 04161000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 04162000
*   /*                                                       @Y30LB39*/ 04163000
*   /*                                                               */ 04164000
*   /*****************************************************************/ 04165000
*                                                                  0908 04166000
*                                   /*                       @Y30LB39*/ 04167000
*   RETURN CODE(CRVRC);             /*                       @Y30LB39*/ 04168000
         LR    @15,CRVRC                                           0908 04169000
@EL00009 DS    0H                                                  0908 04170000
@EF00009 DS    0H                                                  0908 04171000
@ER00009 BR    @14                                                 0908 04172000
*   END CRVRTN;                     /*                       @Y30LB39*/ 04173000
*                                                                  0910 04174000
*   /*****************************************************************/ 04175000
*   /*                                                               */ 04176000
*   /*                                                       @Y30LB39*/ 04177000
*   /* PROCEDURE NAME - DMNTRTN                              @Y30LB39*/ 04178000
*   /*                                                       @Y30LB39*/ 04179000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 04180000
*   /* DEMOUNT THE SOURCE VOLUME BEFORE COPYING.             @Y30LB39*/ 04181000
*   /* AFTER THE ARGUMENT LIST IS INITIALIZED, THEN          @Y30LB39*/ 04182000
*   /* MSVC IS INVOKED TO DEMOUNT THE SOURCE VOLUME,         @Y30LB39*/ 04183000
*   /* A DEQUEUE IS ISSUED TO RELEASE THE RESERVE            @Y30LB39*/ 04184000
*   /* SET EARLIER BY IDCVS01 IN VSRTN.                      @Y30LB39*/ 04185000
*   /* THERE ARE NO MESSAGES ISSUED BY THIS ROUTINE.         @Y30LB39*/ 04186000
*   /*                                                       @Y30LB39*/ 04187000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 04188000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 04189000
*   /*                                                       @Y30LB39*/ 04190000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 04191000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 04192000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 04193000
*   /* 4 - IF THE DEMOUNT FAILED.                            @Y30LB39*/ 04194000
*   /*                                                       @Y30LB39*/ 04195000
*   /*                                                               */ 04196000
*   /*****************************************************************/ 04197000
*                                                                  0910 04198000
*DMNTRTN:                                                          0910 04199000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 04200000
*                                                                  0910 04201000
DMNTRTN  DS    0H                                                  0911 04202000
*   /*****************************************************************/ 04203000
*   /*                                                               */ 04204000
*   /*                                                       @Y30LB39*/ 04205000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 04206000
*   /*                                                       @Y30LB39*/ 04207000
*   /*                                                               */ 04208000
*   /*****************************************************************/ 04209000
*                                                                  0911 04210000
*                                   /*                       @Y30LB39*/ 04211000
*   DCL                                                            0911 04212000
*     DMNTRC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 04213000
*                                   /*                       @Y30LB39*/ 04214000
*                                                                  0912 04215000
*   /*****************************************************************/ 04216000
*   /*                                                               */ 04217000
*   /*                                                       @Y30LB39*/ 04218000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 04219000
*   /*                                                       @Y30LB39*/ 04220000
*   /*                                                               */ 04221000
*   /*****************************************************************/ 04222000
*                                                                  0912 04223000
*                                   /*                       @Y30LB39*/ 04224000
*   RETADDR2=REG14;                 /*                       @Y30LB39   04225000
*                                                            @Y30LB39*/ 04226000
*                                                                  0912 04227000
         LR    RETADDR2,REG14                                      0912 04228000
*   /*****************************************************************/ 04229000
*   /*                                                               */ 04230000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 04231000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 04232000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 04233000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 04234000
*   /*                                                       @Y30LB39*/ 04235000
*   /*                                                               */ 04236000
*   /*****************************************************************/ 04237000
*                                                                  0913 04238000
*                                   /*                       @Y30LB39*/ 04239000
*   OLDERID2=NEWERID2;                                             0913 04240000
         L     @15,@PC00001                                        0913 04241000
         L     @14,GDTTR2(,@15)                                    0913 04242000
         MVC   @TS00001(95),NEWERID2(@14)                          0913 04243000
         MVC   OLDERID2(95,@14),@TS00001                           0913 04244000
*   NEWID2='CODM';                  /*                       @Y30LB39   04245000
*                                                            @Y30LB39*/ 04246000
*                                                                  0914 04247000
         MVC   NEWID2(4,@14),@CC01703                              0914 04248000
*   /*****************************************************************/ 04249000
*   /*                                                               */ 04250000
*   /*                                                       @Y30LB39*/ 04251000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 04252000
*   /*                                                       @Y30LB39*/ 04253000
*   /*                                                               */ 04254000
*   /*****************************************************************/ 04255000
*                                                                  0915 04256000
*                                   /*                       @Y30LB39*/ 04257000
*   DMNTRC=LASTCC00;                /*                       @Y30LB39   04258000
*                                                            @Y30LB39*/ 04259000
*                                                                  0915 04260000
         SLR   DMNTRC,DMNTRC                                       0915 04261000
*   /*****************************************************************/ 04262000
*   /*                                                               */ 04263000
*   /*                                                       @Y30LB39*/ 04264000
*   /* INITIALIZE THE ARGUMENT LIST. NOTE THE WAIT           @Y30LB39*/ 04265000
*   /* OPTION IS SET TO INSURE THE VOLUME IS DE-             @Y30LB39*/ 04266000
*   /* MOUNTED BEFORE THE COPY OPERATION.                    @Y30LB39*/ 04267000
*   /*                                                       @Y30LB39*/ 04268000
*   /*                                                               */ 04269000
*   /*****************************************************************/ 04270000
*                                                                  0916 04271000
*                                   /*                       @Y30LB39*/ 04272000
*   MDAGL=''B;                      /*                       @Y30LB39*/ 04273000
         LA    @14,MDAGLBUF                                        0916 04274000
         XC    MDAGL(37,@14),MDAGL(@14)                            0916 04275000
*   MDDDNAME=CUNITDDN;              /*                       @Y30LB39*/ 04276000
         MVC   MDDDNAME(8,@14),CUNITDDN                            0917 04277000
*   MDLABEL=VOLVAL;                 /*                       @Y30LB39*/ 04278000
         L     @03,@PC00001+4                                      0918 04279000
         L     @01,FDTPTR(,@03)                                    0918 04280000
         MVC   MDLABEL(6,@14),VOLVAL(@01)                          0918 04281000
*   MDUCBPTR=ADDR(CUNITUCB);        /*                       @Y30LB39*/ 04282000
         LA    @03,CUNITUCB                                        0919 04283000
         ST    @03,MDUCBPTR(,@14)                                  0919 04284000
*   MDWAIT=ON;                      /*                       @Y30LB39   04285000
*                                                            @Y30LB39*/ 04286000
*                                                                  0920 04287000
         OI    MDWAIT(@14),B'00010000'                             0920 04288000
*   /*****************************************************************/ 04289000
*   /*                                                               */ 04290000
*   /*                                                       @ZA05125*/ 04291000
*   /* ISSUE THE UDEQ TO RELEASE THE RESERVE SET BY          @ZA05125*/ 04292000
*   /* IDCVS01 IN VSRTN SUBROUTINE.                          @ZA05125*/ 04293000
*   /*                                                       @ZA05125*/ 04294000
*   /*                                                               */ 04295000
*   /*****************************************************************/ 04296000
*                                                                  0921 04297000
*                                   /*                       @ZA05125*/ 04298000
*   RNAMCHAR(7:22)='.VIRTUAL.RESERVE';/*                     @ZA05138*/ 04299000
         MVC   RNAMCHAR+6(16),@CC01672                             0921 04300000
*   CALL IDCSADQ0(GDTTBL,'SYSZAMS ',MINORNAM);/*             @ZA05125   04301000
*                                                            @ZA05125*/ 04302000
*                                                                  0922 04303000
         ST    @15,@AL00001                                        0922 04304000
         LA    @14,@CC01617                                        0922 04305000
         ST    @14,@AL00001+4                                      0922 04306000
         LA    @14,MINORNAM                                        0922 04307000
         ST    @14,@AL00001+8                                      0922 04308000
         MVI   @AL00001+8,X'80'                                    0922 04309000
         L     @15,GDTDEQ(,@15)                                    0922 04310000
         LA    @01,@AL00001                                        0922 04311000
         BALR  @14,@15                                             0922 04312000
*   /*****************************************************************/ 04313000
*   /*                                                               */ 04314000
*   /*                                                       @Y30LB39*/ 04315000
*   /* ISSUE UMSSUNIT MACRO TO DEMOUNT THE SOURCE            @Y30LB39*/ 04316000
*   /* VOLUME AFTER DUMPING THE DEMOUNT ARGUMENT LIST        @Y30LB39*/ 04317000
*   /*                                                       @Y30LB39*/ 04318000
*   /*                                                               */ 04319000
*   /*****************************************************************/ 04320000
*                                                                  0923 04321000
*                                   /*                       @Y30LB39*/ 04322000
*   IF GDTDBG=NULLPTR THEN                                         0923 04323000
         L     @15,@PC00001                                        0923 04324000
         L     @15,GDTDBG(,@15)                                    0923 04325000
         LTR   @15,@15                                             0923 04326000
         BZ    @RT00923                                            0923 04327000
*     ;                                                            0924 04328000
*   ELSE                                                           0925 04329000
*     DO;                                                          0925 04330000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/ 04331000
         LA    DMPINDEX,DUMPLIST                                   0926 04332000
*       DMPITMNM='MDAGLBUF';                                       0927 04333000
         MVC   DMPITMNM(8,DMPINDEX),@CC01704                       0927 04334000
*       DMPITMPT=ADDR(MDAGLBUF);                                   0928 04335000
         LA    @03,MDAGLBUF                                        0928 04336000
         ST    @03,DMPITMPT(,DMPINDEX)                             0928 04337000
*       DMPITMLN=LENGTH(MDAGLBUF);                                 0929 04338000
         MVC   DMPITMLN(2,DMPINDEX),@CH01907                       0929 04339000
*       DMPITMTP='H';                                              0930 04340000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0930 04341000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0931 04342000
         AL    DMPINDEX,@CF00474                                   0931 04343000
*       DMPTRM=DMPTRMVL;                                           0932 04344000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0932 04345000
*     END;                          /*                       @Y30LB39   04346000
*                                                            @Y30LB39*/ 04347000
*   IF GDTDBG=NULLPTR THEN                                         0934 04348000
@RT00923 L     @15,@PC00001                                        0934 04349000
         L     @15,GDTDBG(,@15)                                    0934 04350000
         LTR   @15,@15                                             0934 04351000
         BZ    @RT00934                                            0934 04352000
*     ;                                                            0935 04353000
*   ELSE                                                           0936 04354000
*     CALL IDCDB010(GDTTBL,'CODD',ADDR(DUMPLIST));/*         @Y30LB39   04355000
*                                                            @Y30LB39*/ 04356000
         L     @15,@PC00001                                        0936 04357000
         ST    @15,@AL00001                                        0936 04358000
         LA    @14,@CC01705                                        0936 04359000
         ST    @14,@AL00001+4                                      0936 04360000
         LA    @14,DUMPLIST                                        0936 04361000
         ST    @14,@AFTEMPS+8                                      0936 04362000
         LA    @14,@AFTEMPS+8                                      0936 04363000
         ST    @14,@AL00001+8                                      0936 04364000
         MVI   @AL00001+8,X'80'                                    0936 04365000
         L     @15,GDTDBG(,@15)                                    0936 04366000
         LA    @01,@AL00001                                        0936 04367000
         BALR  @14,@15                                             0936 04368000
*   CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*                   @Y30LB39   04369000
*                                                            @Y30LB39*/ 04370000
@RT00934 L     @02,@PC00001                                        0937 04371000
         ST    @02,@AL00001                                        0937 04372000
         LA    @15,DEMOUNT                                         0937 04373000
         ST    @15,@AL00001+4                                      0937 04374000
         LA    @15,MDAGLBUF                                        0937 04375000
         ST    @15,@AL00001+8                                      0937 04376000
         MVI   @AL00001+8,X'80'                                    0937 04377000
         L     @15,GDTUNT(,@02)                                    0937 04378000
         LA    @01,@AL00001                                        0937 04379000
         BALR  @14,@15                                             0937 04380000
*   RESPECIFY                                                      0938 04381000
*     RTNREG RSTD;                                                 0938 04382000
*   TESTRC=RTNREG;                                                 0939 04383000
         LR    TESTRC,RTNREG                                       0939 04384000
*   RESPECIFY                                                      0940 04385000
*     RTNREG UNRSTD;                /*                       @Y30LB39   04386000
*                                                            @Y30LB39*/ 04387000
*                                                                  0940 04388000
*   /*****************************************************************/ 04389000
*   /*                                                               */ 04390000
*   /*                                                       @Y30LB39*/ 04391000
*   /* IF THE RETURN CODE IS NOT ZERO, SET THE               @Y30LB39*/ 04392000
*   /* CONDITION CODE TO FOUR INDICATING THAT A              @Y30LB39*/ 04393000
*   /* COPY CANNOT BE TAKEN OF A MOUNTED VOLUME.             @Y30LB39*/ 04394000
*   /*                                                       @Y30LB39*/ 04395000
*   /*                                                               */ 04396000
*   /*****************************************************************/ 04397000
*                                                                  0941 04398000
*                                   /*                       @Y30LB39*/ 04399000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/ 04400000
         LTR   TESTRC,TESTRC                                       0941 04401000
         BZ    @RF00941                                            0941 04402000
*     DMNTRC=LASTCC04;              /*                       @Y30LB39*/ 04403000
*                                                                  0942 04404000
         LA    DMNTRC,4                                            0942 04405000
*   /*****************************************************************/ 04406000
*   /*                                                               */ 04407000
*   /*                                                       @Y30LB39*/ 04408000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 04409000
*   /*                                                       @Y30LB39*/ 04410000
*   /*                                                               */ 04411000
*   /*****************************************************************/ 04412000
*                                                                  0943 04413000
*                                   /*                       @Y30LB39*/ 04414000
*   REG14=RETADDR2;                 /*                       @Y30LB39   04415000
*                                                            @Y30LB39*/ 04416000
*                                                                  0943 04417000
@RF00941 LR    REG14,RETADDR2                                      0943 04418000
*   /*****************************************************************/ 04419000
*   /*                                                               */ 04420000
*   /*                                                       @Y30LB39*/ 04421000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 04422000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 04423000
*   /*                                                       @Y30LB39*/ 04424000
*   /*                                                               */ 04425000
*   /*****************************************************************/ 04426000
*                                                                  0944 04427000
*                                   /*                       @Y30LB39*/ 04428000
*   RETURN CODE(DMNTRC);            /*                       @Y30LB39*/ 04429000
         LR    @15,DMNTRC                                          0944 04430000
@EL00010 DS    0H                                                  0944 04431000
@EF00010 DS    0H                                                  0944 04432000
@ER00010 BR    @14                                                 0944 04433000
*   END DMNTRTN;                    /*                       @Y30LB39*/ 04434000
*                                                                  0946 04435000
*   /*****************************************************************/ 04436000
*   /*                                                               */ 04437000
*   /*                                                       @Y30LB39*/ 04438000
*   /* PROCEDURE NAME - COPYRTN                              @Y30LB39*/ 04439000
*   /*                                                       @Y30LB39*/ 04440000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 04441000
*   /* COPY THE SOURCE VOLUME.                               @Y30LB39*/ 04442000
*   /* MSC IS USED TO COPY THE SOURCE VOLUME TO AN           @Y30LB39*/ 04443000
*   /* INACTIVE COPY VOLUME.                                 @Y30LB39*/ 04444000
*   /* THE DATE TO BE INSERTED IN THE SUCCESSFUL COPY        @Y30LB39*/ 04445000
*   /* MESSAGE IS OBTAINED IMMEDIATELY PRIOR TO              @Y30LB39*/ 04446000
*   /* CALLING MSC TO COPY THE VOLUME.                       @Y30LB39*/ 04447000
*   /* IF THE COPY OPERATION COMPLETES NORMALLY,             @Y30LB39*/ 04448000
*   /* THEN MESSAGE IDC0703I IS OUTPUTED WITH                @Y30LB39*/ 04449000
*   /* THE DATE OF COPY AND THE SERIAL NUMBERS               @Y30LB39*/ 04450000
*   /* OF THE TWO CARTRIDGES USED.                           @Y30LB39*/ 04451000
*   /* OTHERWISE, MESSAGE IDC3709I IS ISSUED IF              @Y30LB39*/ 04452000
*   /* THE I/O DID NOT COMPLETE NORMALLY OR                  @Y30LB39*/ 04453000
*   /* MESSAGE IDC3706I IS ISSUED IF BACKUP COPIES           @Y30LB39*/ 04454000
*   /* CARTRIDGES WERE USED.                                 @Y30LB39*/ 04455000
*   /* IF CARTRIDGES WERE REUSED, THEN MESSAGE               @Y30LB39*/ 04456000
*   /* IDC0704I IS ISSUED IF OLDEST BACKUP COPY              @Y30LB39*/ 04457000
*   /* CARTRIDGES WERE REUSED. OTHERWISE, MESSAGE            @Y30LB39*/ 04458000
*   /* IDC0705I IS ISSUED IF OLDEST BACKUP COPIES            @Y30LB39*/ 04459000
*   /* WERE NOT REUSED. ALSO SSCMSG IS CALLED TO             @Y30LB39*/ 04460000
*   /* OUTPUT THE APPROPRIATE REASON CODE IF THE COPY        @Y30LB39*/ 04461000
*   /* OPERATION FAILED.                                     @Y30LB39*/ 04462000
*   /*                                                       @Y30LB39*/ 04463000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 04464000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 04465000
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/ 04466000
*   /* VSIAGL                                                @Y30LB39*/ 04467000
*   /*                                                       @Y30LB39*/ 04468000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 04469000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 04470000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 04471000
*   /* 4 - COPY WAS UNSUCCESSFUL.                            @Y30LB39*/ 04472000
*   /* COPYVTBL IS UPDATED.                                  @Y30LB39*/ 04473000
*   /*                                                       @Y30LB39*/ 04474000
*   /*                                                               */ 04475000
*   /*****************************************************************/ 04476000
*                                                                  0946 04477000
*COPYRTN:                                                          0946 04478000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 04479000
*                                                                  0946 04480000
COPYRTN  DS    0H                                                  0947 04481000
*   /*****************************************************************/ 04482000
*   /*                                                               */ 04483000
*   /*                                                       @Y30LB39*/ 04484000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 04485000
*   /*                                                       @Y30LB39*/ 04486000
*   /*                                                               */ 04487000
*   /*****************************************************************/ 04488000
*                                                                  0947 04489000
*                                   /*                       @Y30LB39*/ 04490000
*   DCL                                                            0947 04491000
*     COPYRC FIXED(8);              /*                       @Y30LB39*/ 04492000
*   DCL                                                            0948 04493000
*     TIMEAREA CHAR(8) BDY(WORD);   /*                       @Y30LB39*/ 04494000
*                                   /*                       @Y30LB39*/ 04495000
*                                                                  0949 04496000
*   /*****************************************************************/ 04497000
*   /*                                                               */ 04498000
*   /*                                                       @Y30LB39*/ 04499000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 04500000
*   /*                                                       @Y30LB39*/ 04501000
*   /*                                                               */ 04502000
*   /*****************************************************************/ 04503000
*                                                                  0949 04504000
*                                   /*                       @Y30LB39*/ 04505000
*   RETADDR2=REG14;                 /*                       @Y30LB39   04506000
*                                                            @Y30LB39*/ 04507000
*                                                                  0949 04508000
         LR    RETADDR2,REG14                                      0949 04509000
*   /*****************************************************************/ 04510000
*   /*                                                               */ 04511000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 04512000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 04513000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 04514000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 04515000
*   /*                                                       @Y30LB39*/ 04516000
*   /*                                                               */ 04517000
*   /*****************************************************************/ 04518000
*                                                                  0950 04519000
*                                   /*                       @Y30LB39*/ 04520000
*   OLDERID2=NEWERID2;                                             0950 04521000
         L     @15,@PC00001                                        0950 04522000
         L     @15,GDTTR2(,@15)                                    0950 04523000
         MVC   @TS00001(95),NEWERID2(@15)                          0950 04524000
         MVC   OLDERID2(95,@15),@TS00001                           0950 04525000
*   NEWID2='COCP';                  /*                       @Y30LB39   04526000
*                                                            @Y30LB39*/ 04527000
*                                                                  0951 04528000
         MVC   NEWID2(4,@15),@CC01711                              0951 04529000
*   /*****************************************************************/ 04530000
*   /*                                                               */ 04531000
*   /*                                                       @Y30LB39*/ 04532000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 04533000
*   /*                                                       @Y30LB39*/ 04534000
*   /*                                                               */ 04535000
*   /*****************************************************************/ 04536000
*                                                                  0952 04537000
*                                   /*                       @Y30LB39*/ 04538000
*   COPYRC=LASTCC00;                /*                       @Y30LB39   04539000
*                                                            @Y30LB39*/ 04540000
*                                                                  0952 04541000
         SLR   COPYRC,COPYRC                                       0952 04542000
*   /*****************************************************************/ 04543000
*   /*                                                               */ 04544000
*   /*                                                       @Y30LB39*/ 04545000
*   /* INITIALIZE THE MSSC COVCE PARAMETER LIST              @Y30LB39*/ 04546000
*   /*                                                       @Y30LB39*/ 04547000
*   /*                                                               */ 04548000
*   /*****************************************************************/ 04549000
*                                                                  0953 04550000
*                                   /*                       @Y30LB39*/ 04551000
*   COVCE=''B;                      /*                       @Y30LB39*/ 04552000
         L     @15,COVCEPTR                                        0953 04553000
         XC    COVCE(43,@15),COVCE(@15)                            0953 04554000
*   COVLNGTH=COVLEN;                /*                       @Y30LB39*/ 04555000
         LH    @14,COVLEN                                          0954 04556000
         ST    @14,COVLNGTH(,@15)                                  0954 04557000
*   COVDESCR=DESCRVAL;              /*                       @Y30LB39*/ 04558000
         L     @14,@PC00001+4                                      0955 04559000
         L     @01,FDTPTR+20(,@14)                                 0955 04560000
         MVC   COVDESCR(30,@15),DESCRVAL(@01)                      0955 04561000
*   COVSPDES=ON;                    /*                       @Y30LB39   04562000
*                                                            @Y30LB39*/ 04563000
*                                                                  0956 04564000
         OI    COVSPDES(@15),B'10000000'                           0956 04565000
*   /*****************************************************************/ 04566000
*   /*                                                               */ 04567000
*   /*                                                       @Y30LB39*/ 04568000
*   /* IF THE REUSE FLAG IS ON, THEN SET THE RECOVERY        @Y30LB39*/ 04569000
*   /* FLAGS ON. NOTE THAT IF THE REUSE FLAG IS OFF,         @Y30LB39*/ 04570000
*   /* THESE RECOVERY FLAGS HAVE BEEN SET DURING THE         @Y30LB39*/ 04571000
*   /* CREATE OPERATION.                                     @Y30LB39*/ 04572000
*   /*                                                       @Y30LB39*/ 04573000
*   /*                                                               */ 04574000
*   /*****************************************************************/ 04575000
*                                                                  0957 04576000
*                                   /*                       @Y30LB39*/ 04577000
*   IF REUSEFLG=ON THEN             /*                       @Y30LB39*/ 04578000
         TM    REUSEFLG,B'10000000'                                0957 04579000
         BNO   @RF00957                                            0957 04580000
*     DO;                           /*                       @Y30LB39*/ 04581000
*       COVSRCVY=ON;                /*                       @Y30LB39*/ 04582000
         OI    COVSRCVY(@15),B'10000000'                           0959 04583000
*       COVICOPY=ON;                /*                       @Y30LB39*/ 04584000
         OI    COVICOPY(@15),B'10000000'                           0960 04585000
*       COVREUSE=ON;                /*                       @Y30LB39*/ 04586000
         OI    COVREUSE(@15),B'01000000'                           0961 04587000
*     END;                          /*                       @Y30LB39*/ 04588000
*   IF VSVSAM=ON THEN               /*                       @Y30LB39*/ 04589000
@RF00957 LA    @15,VS1AGLBF                                        0963 04590000
         TM    VSVSAM(@15),B'10000000'                             0963 04591000
         BNO   @RF00963                                            0963 04592000
*     COVSAM=ON;                    /*                       @Y30LB39*/ 04593000
         L     @01,COVCEPTR                                        0964 04594000
         OI    COVSAM(@01),B'10000000'                             0964 04595000
*                                   /*                       @Y30LB39*/ 04596000
*                                                                  0965 04597000
*   /*****************************************************************/ 04598000
*   /*                                                               */ 04599000
*   /*                                                       @Y30LB39*/ 04600000
*   /* INITIALIZE THE MSSC COVLIST PARAMETER LIST            @Y30LB39*/ 04601000
*   /*                                                       @Y30LB39*/ 04602000
*   /*                                                               */ 04603000
*   /*****************************************************************/ 04604000
*                                                                  0965 04605000
*                                   /*                       @Y30LB39*/ 04606000
*   COVLIST=''B;                    /*                       @Y30LB39*/ 04607000
@RF00963 L     @15,COVCPTR                                         0965 04608000
         XC    COVLIST(40,@15),COVLIST(@15)                        0965 04609000
*   CVOCRCR=ON;                     /*                       @Y30LB39*/ 04610000
         OI    CVOCRCR(@15),B'00100000'                            0966 04611000
*   CVOLID=VOLVAL;                  /*                       @Y30LB39*/ 04612000
         L     @14,@PC00001+4                                      0967 04613000
         L     @01,FDTPTR(,@14)                                    0967 04614000
         MVC   CVOLID(6,@15),VOLVAL(@01)                           0967 04615000
*   CVOLCSN=CSN1AREA;               /*                       @Y30LB39*/ 04616000
         MVC   CVOLCSN(12,@15),CSN1AREA                            0968 04617000
*   CVOLVEXT=COVCEPTR;              /*                       @Y30LB39   04618000
*                                                            @Y30LB39*/ 04619000
*                                                                  0969 04620000
         L     @14,COVCEPTR                                        0969 04621000
         ST    @14,CVOLVEXT(,@15)                                  0969 04622000
*   /*****************************************************************/ 04623000
*   /*                                                               */ 04624000
*   /*                                                       @Y30LB39*/ 04625000
*   /* ISSUE UTIME MACRO TO OBTAIN DATE IN THE FORM          @Y30LB39*/ 04626000
*   /* YYDDD TO BE INSERTED IN THE COPY MESSAGE. NOTE        @Y30LB39*/ 04627000
*   /* THAT COPY DATE IS OBTAINED IMMEDIATELY BEFORE         @Y30LB39*/ 04628000
*   /* COPY OPERATION SINCE MSVC WILL ALSO CALCULATE         @Y30LB39*/ 04629000
*   /* AND RECORD THE COPY DATE IMMEDIATELY BEFORE THE       @Y30LB39*/ 04630000
*   /* COPY OPERATION. COPYV USES UTIME MACRO RATHER         @Y30LB39*/ 04631000
*   /* THAN READING THE LATEST COPY RECORD FOLLOWING         @Y30LB39*/ 04632000
*   /* COPY OPERATION BECAUSE THE NEWLY RECORDED COPY        @Y30LB39*/ 04633000
*   /* RECORD MAY NOT NECESSARILY BE ONE RETRIEVED.          @Y30LB39*/ 04634000
*   /*                                                       @Y30LB39*/ 04635000
*   /*                                                               */ 04636000
*   /*****************************************************************/ 04637000
*                                                                  0970 04638000
*                                   /*                       @Y30LB39*/ 04639000
*   CALL IDCSATI0(GDTTBL,TIMEAREA,NEWCDATE);/*               @Y30LB39   04640000
*                                                            @Y30LB39*/ 04641000
*                                                                  0970 04642000
         L     @15,@PC00001                                        0970 04643000
         ST    @15,@AL00001                                        0970 04644000
         LA    @14,TIMEAREA                                        0970 04645000
         ST    @14,@AL00001+4                                      0970 04646000
         LA    @14,NEWCDATE                                        0970 04647000
         ST    @14,@AL00001+8                                      0970 04648000
         MVI   @AL00001+8,X'80'                                    0970 04649000
         L     @15,GDTTIM(,@15)                                    0970 04650000
         LA    @01,@AL00001                                        0970 04651000
         BALR  @14,@15                                             0970 04652000
*   /*****************************************************************/ 04653000
*   /*                                                               */ 04654000
*   /*                                                       @Y30LB39*/ 04655000
*   /* ISSUE USSC MACRO TO COPY THE SOURCE VOLUME            @Y30LB39*/ 04656000
*   /* TO AN INACTIVE COPY VOLUME AFTER DUMPING              @Y30LB39*/ 04657000
*   /* PARAMETER LISTS.                                      @Y30LB39*/ 04658000
*   /*                                                       @Y30LB39*/ 04659000
*   /*                                                               */ 04660000
*   /*****************************************************************/ 04661000
*                                                                  0971 04662000
*                                   /*                       @Y30LB39*/ 04663000
*   IF GDTDBG=NULLPTR THEN                                         0971 04664000
         L     @15,@PC00001                                        0971 04665000
         L     @15,GDTDBG(,@15)                                    0971 04666000
         LTR   @15,@15                                             0971 04667000
         BZ    @RT00971                                            0971 04668000
*     ;                                                            0972 04669000
*   ELSE                                                           0973 04670000
*     DO;                                                          0973 04671000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/ 04672000
         LA    DMPINDEX,DUMPLIST                                   0974 04673000
*       DMPITMNM='COVLISTB';                                       0975 04674000
         MVC   DMPITMNM(8,DMPINDEX),@CC01712                       0975 04675000
*       DMPITMPT=ADDR(COVLISTB);                                   0976 04676000
         LA    @03,COVLISTB                                        0976 04677000
         ST    @03,DMPITMPT(,DMPINDEX)                             0976 04678000
*       DMPITMLN=LENGTH(COVLISTB);                                 0977 04679000
         MVC   DMPITMLN(2,DMPINDEX),@CH01588                       0977 04680000
*       DMPITMTP='H';                                              0978 04681000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0978 04682000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0979 04683000
         LA    @03,16                                              0979 04684000
         ALR   DMPINDEX,@03                                        0979 04685000
*       DMPITMNM='COVCEBUF';                                       0980 04686000
         MVC   DMPITMNM(8,DMPINDEX),@CC01713                       0980 04687000
*       DMPITMPT=ADDR(COVCEBUF);                                   0981 04688000
         LA    @15,COVCEBUF                                        0981 04689000
         ST    @15,DMPITMPT(,DMPINDEX)                             0981 04690000
*       DMPITMLN=LENGTH(COVCEBUF);                                 0982 04691000
         MVC   DMPITMLN(2,DMPINDEX),@CH01908                       0982 04692000
*       DMPITMTP='H';                                              0983 04693000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0983 04694000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0984 04695000
         ALR   DMPINDEX,@03                                        0984 04696000
*       DMPTRM=DMPTRMVL;                                           0985 04697000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0985 04698000
*     END;                          /*                       @Y30LB39   04699000
*                                                            @Y30LB39*/ 04700000
*   IF GDTDBG=NULLPTR THEN                                         0987 04701000
@RT00971 L     @15,@PC00001                                        0987 04702000
         L     @15,GDTDBG(,@15)                                    0987 04703000
         LTR   @15,@15                                             0987 04704000
         BZ    @RT00987                                            0987 04705000
*     ;                                                            0988 04706000
*   ELSE                                                           0989 04707000
*     CALL IDCDB010(GDTTBL,'COEE',ADDR(DUMPLIST));/*         @Y30LB39   04708000
*                                                            @Y30LB39*/ 04709000
         L     @15,@PC00001                                        0989 04710000
         ST    @15,@AL00001                                        0989 04711000
         LA    @14,@CC01714                                        0989 04712000
         ST    @14,@AL00001+4                                      0989 04713000
         LA    @14,DUMPLIST                                        0989 04714000
         ST    @14,@AFTEMPS+12                                     0989 04715000
         LA    @14,@AFTEMPS+12                                     0989 04716000
         ST    @14,@AL00001+8                                      0989 04717000
         MVI   @AL00001+8,X'80'                                    0989 04718000
         L     @15,GDTDBG(,@15)                                    0989 04719000
         LA    @01,@AL00001                                        0989 04720000
         BALR  @14,@15                                             0989 04721000
*   CALL IDCSASS0(GDTTBL,COPYVOL,COVCPTR,REASON,ECBBYTE);/*  @Y30LB39   04722000
*                                                            @Y30LB39*/ 04723000
@RT00987 L     @02,@PC00001                                        0990 04724000
         ST    @02,@AL00001                                        0990 04725000
         LA    @15,COPYVOL                                         0990 04726000
         ST    @15,@AL00001+4                                      0990 04727000
         LA    @15,COVCPTR                                         0990 04728000
         ST    @15,@AL00001+8                                      0990 04729000
         LA    @15,REASON                                          0990 04730000
         ST    @15,@AL00001+12                                     0990 04731000
         LA    @15,ECBBYTE                                         0990 04732000
         ST    @15,@AL00001+16                                     0990 04733000
         MVI   @AL00001+16,X'80'                                   0990 04734000
         L     @15,GDTSSC(,@02)                                    0990 04735000
         LA    @01,@AL00001                                        0990 04736000
         BALR  @14,@15                                             0990 04737000
*   RESPECIFY                                                      0991 04738000
*     RTNREG RSTD;                                                 0991 04739000
*   TESTRC=RTNREG;                                                 0992 04740000
         LR    TESTRC,RTNREG                                       0992 04741000
*   RESPECIFY                                                      0993 04742000
*     RTNREG UNRSTD;                /*                       @Y30LB39   04743000
*                                                            @Y30LB39*/ 04744000
*                                                                  0993 04745000
*   /*****************************************************************/ 04746000
*   /*                                                               */ 04747000
*   /*                                                       @Y30LB39*/ 04748000
*   /* IF MSVC RETURNS A RETURN CODE OF TWELVE,              @Y30LB39*/ 04749000
*   /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN            @Y30LB39*/ 04750000
*   /* I-O ERROR PREVENTED THE UPDATING OF THE               @Y30LB39*/ 04751000
*   /* MSV INVENTORY. THIS RETURN CODE SHOULD BE             @Y30LB39*/ 04752000
*   /* TREATED AS A RETURN CODE OF ZERO, EXCEPT              @Y30LB39*/ 04753000
*   /* THAT THE FINAL CODE TO THE EXECUTIVE                  @Y30LB39*/ 04754000
*   /* SHOULD BE AT LEAST FOUR. THAT IS THE                  @Y30LB39*/ 04755000
*   /* REASON FOR SETTING IOERRFLG ON.                       @Y30LB39*/ 04756000
*   /*                                                       @Y30LB39*/ 04757000
*   /*                                                               */ 04758000
*   /*****************************************************************/ 04759000
*                                                                  0994 04760000
*                                   /*                       @Y30LB39*/ 04761000
*   IF TESTRC=12 THEN               /*                       @Y30LB39*/ 04762000
         C     TESTRC,@CF00567                                     0994 04763000
         BNE   @RF00994                                            0994 04764000
*     DO;                           /*                       @Y30LB39*/ 04765000
*       TESTRC=LASTCC00;            /*                       @Y30LB39*/ 04766000
         SLR   TESTRC,TESTRC                                       0996 04767000
*       IOERRFLG=ON;                /*                       @Y30LB39*/ 04768000
         OI    IOERRFLG,B'10000000'                                0997 04769000
*     END;                          /*                       @Y30LB39   04770000
*                                                            @Y30LB39*/ 04771000
*                                                                  0998 04772000
*   /*****************************************************************/ 04773000
*   /*                                                               */ 04774000
*   /*                                                       @Y30LB39*/ 04775000
*   /* IF USSC RETURN CODE IS ZERO, ISSUE UPRINT             @Y30LB39*/ 04776000
*   /* FOR MESSAGE IDC0703I AND IDENTIFY THE COPY            @Y30LB39*/ 04777000
*   /* VOLUME.                                               @Y30LB39*/ 04778000
*   /*                                                       @Y30LB39*/ 04779000
*   /*                                                               */ 04780000
*   /*****************************************************************/ 04781000
*                                                                  0999 04782000
*                                   /*                       @Y30LB39*/ 04783000
*   IF TESTRC=0 THEN                /*                       @Y30LB39*/ 04784000
@RF00994 LTR   TESTRC,TESTRC                                       0999 04785000
         BNZ   @RF00999                                            0999 04786000
*     DO;                           /*                       @Y30LB39*/ 04787000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 04788000
         L     @15,DDSTRU                                          1001 04789000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1001 04790000
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/ 04791000
         MVC   DARGSMOD(3,@15),@CC01548                            1002 04792000
*       DARGSENT=MSG0703I;          /*                       @Y30LB39*/ 04793000
         MVI   DARGSENT(@15),X'04'                                 1003 04794000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB39*/ 04795000
         L     @14,@PC00001+4                                      1004 04796000
         L     @14,FDTPTR(,@14)                                    1004 04797000
         LA    @03,VOLVAL(,@14)                                    1004 04798000
         ST    @03,DARGDBP(,@15)                                   1004 04799000
*       DARGILP=VOLLEN;             /*                       @Y30LB39*/ 04800000
         SLR   @03,@03                                             1005 04801000
         IC    @03,VOLLEN(,@14)                                    1005 04802000
         STH   @03,DARGILP(,@15)                                   1005 04803000
*       DARGCNT=THREE;              /*                       @Y30LB39*/ 04804000
         LA    @14,3                                               1006 04805000
         STH   @14,DARGCNT(,@15)                                   1006 04806000
*       DARGINS(1)=FIRSTCSN;        /*                       @Y30LB39*/ 04807000
         MVC   DARGINS(2,@15),@CH00219                             1007 04808000
*       DARGINL(1)=LENGTH(CSN1AREA);/*                       @Y30LB39*/ 04809000
         LA    @03,12                                              1008 04810000
         STH   @03,DARGINL(,@15)                                   1008 04811000
*       DARGDTM(1)=ADDR(CSN1AREA);  /*                       @Y30LB39*/ 04812000
         LA    @02,CSN1AREA                                        1009 04813000
         ST    @02,DARGDTM(,@15)                                   1009 04814000
*       DARGINS(2)=SECONDCN;        /*                       @Y30LB39*/ 04815000
         MVC   DARGINS+8(2,@15),@CH00153                           1010 04816000
*       DARGINL(2)=LENGTH(CSN2AREA);/*                       @Y30LB39*/ 04817000
         STH   @03,DARGINL+8(,@15)                                 1011 04818000
*       DARGDTM(2)=ADDR(CSN2AREA);  /*                       @Y30LB39*/ 04819000
         LA    @03,CSN2AREA                                        1012 04820000
         ST    @03,DARGDTM+8(,@15)                                 1012 04821000
*       DARGINS(3)=DATE;            /*                       @Y30LB39*/ 04822000
         STH   @14,DARGINS+16(,@15)                                1013 04823000
*       DARGINL(3)=LENGTH(NEWCDATE);/*                       @Y30LB39*/ 04824000
         MVC   DARGINL+16(2,@15),@CH00042                          1014 04825000
*       DARGDTM(3)=ADDR(NEWCDATE);  /*                       @Y30LB39   04826000
*                                                            @Y30LB39*/ 04827000
         LA    @14,NEWCDATE                                        1015 04828000
         ST    @14,DARGDTM+16(,@15)                                1015 04829000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   04830000
*                                                            @Y30LB39*/ 04831000
         L     @15,@PC00001                                        1016 04832000
         ST    @15,@AL00001                                        1016 04833000
         LA    @14,@CF00115                                        1016 04834000
         ST    @14,@AL00001+4                                      1016 04835000
         LA    @14,DDSTRU                                          1016 04836000
         ST    @14,@AL00001+8                                      1016 04837000
         MVI   @AL00001+8,X'80'                                    1016 04838000
         L     @15,GDTPRT(,@15)                                    1016 04839000
         LA    @01,@AL00001                                        1016 04840000
         BALR  @14,@15                                             1016 04841000
*     END;                          /*                       @Y30LB39   04842000
*                                                            @Y30LB39*/ 04843000
*                                                                  1017 04844000
*   /*****************************************************************/ 04845000
*   /*                                                               */ 04846000
*   /*                                                       @Y30LB39*/ 04847000
*   /* RETURN CODE FROM USSC WAS NOT ZERO                    @Y30LB39*/ 04848000
*   /*                                                       @Y30LB39*/ 04849000
*   /*                                                               */ 04850000
*   /*****************************************************************/ 04851000
*                                                                  1018 04852000
*                                   /*                       @Y30LB39*/ 04853000
*   ELSE                            /*                       @Y30LB39*/ 04854000
*     DO;                           /*                       @Y30LB39   04855000
*                                                            @Y30LB39*/ 04856000
*                                                                  1018 04857000
         B     @RC00999                                            1018 04858000
@RF00999 DS    0H                                                  1019 04859000
*       /*************************************************************/ 04860000
*       /*                                                           */ 04861000
*       /*                                                   @Y30LB39*/ 04862000
*       /* SET THE CONDITION CODE TO FOUR.                   @Y30LB39*/ 04863000
*       /*                                                   @Y30LB39*/ 04864000
*       /*                                                           */ 04865000
*       /*************************************************************/ 04866000
*                                                                  1019 04867000
*                                   /*                       @Y30LB39*/ 04868000
*       COPYRC=LASTCC04;            /*                       @Y30LB39   04869000
*                                                            @Y30LB39*/ 04870000
*                                                                  1019 04871000
         LA    @02,4                                               1019 04872000
         LR    COPYRC,@02                                          1019 04873000
*       /*************************************************************/ 04874000
*       /*                                                           */ 04875000
*       /*                                                   @Y30LB39*/ 04876000
*       /* CALL SSCMSG TO OUTPUT APPROPRIATE REASON          @Y30LB39*/ 04877000
*       /* CODE MESSAGE IF USSC RETURN CODE IS FOUR,         @Y30LB39*/ 04878000
*       /* WHICH INDICATES THE MSC COPY ORDER FAILED.        @Y30LB39*/ 04879000
*       /*                                                   @Y30LB39*/ 04880000
*       /*                                                           */ 04881000
*       /*************************************************************/ 04882000
*                                                                  1020 04883000
*                                   /*                       @Y30LB39*/ 04884000
*       IF TESTRC=LASTCC04 THEN     /*                       @Y30LB39*/ 04885000
         CR    TESTRC,@02                                          1020 04886000
         BNE   @RF01020                                            1020 04887000
*         CALL SSCMSG(REASON,ECBBYTE);/*                     @Y30LB39   04888000
*                                                            @Y30LB39*/ 04889000
*                                                                  1021 04890000
         LA    @15,REASON                                          1021 04891000
         ST    @15,@AL00001                                        1021 04892000
         LA    @15,ECBBYTE                                         1021 04893000
         ST    @15,@AL00001+4                                      1021 04894000
         LA    @01,@AL00001                                        1021 04895000
         BAL   @14,SSCMSG                                          1021 04896000
*       /*************************************************************/ 04897000
*       /*                                                           */ 04898000
*       /*                                                   @Y30LB39*/ 04899000
*       /* ISSUE MESSAGE IDC3709I IF THE COPY OPERA-         @Y30LB39*/ 04900000
*       /* TION WAS NEVER STARTED AND THE TARGET             @Y30LB39*/ 04901000
*       /* VOLUME IS THE OLDEST BACKUP.                      @Y30LB39*/ 04902000
*       /* OTHERWISE, ISSUE MESSAGE IDC3706I.                @Y30LB39*/ 04903000
*       /*                                                   @Y30LB39*/ 04904000
*       /*                                                           */ 04905000
*       /*************************************************************/ 04906000
*                                                                  1022 04907000
*                                   /*                       @Y30LB39*/ 04908000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 04909000
@RF01020 L     @15,DDSTRU                                          1022 04910000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1022 04911000
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/ 04912000
         MVC   DARGSMOD(3,@15),@CC01548                            1023 04913000
*       DARGDBP=ADDR(CSN1AREA);     /*                       @Y30LB39*/ 04914000
         LA    @14,CSN1AREA                                        1024 04915000
         ST    @14,DARGDBP(,@15)                                   1024 04916000
*       DARGILP=LENGTH(CSN1AREA);   /*                       @Y30LB39*/ 04917000
         LA    @14,12                                              1025 04918000
         STH   @14,DARGILP(,@15)                                   1025 04919000
*       DARGCNT=CSN2INST;           /*                       @Y30LB39*/ 04920000
         LA    @03,1                                               1026 04921000
         STH   @03,DARGCNT(,@15)                                   1026 04922000
*       DARGINS(1)=CSN2INST;        /*                       @Y30LB39*/ 04923000
         STH   @03,DARGINS(,@15)                                   1027 04924000
*       DARGINL(1)=LENGTH(CSN2AREA);/*                       @Y30LB39*/ 04925000
         STH   @14,DARGINL(,@15)                                   1028 04926000
*       DARGDTM(1)=ADDR(CSN2AREA);  /*                       @Y30LB39*/ 04927000
         LA    @14,CSN2AREA                                        1029 04928000
         ST    @14,DARGDTM(,@15)                                   1029 04929000
*       IF ECBBYTE=ONEZERO&OBKUPFLG=ON THEN/*                @Y30LB39*/ 04930000
         CLC   ECBBYTE(1),ONEZERO                                  1030 04931000
         BNE   @RF01030                                            1030 04932000
         TM    OBKUPFLG,B'01000000'                                1030 04933000
         BNO   @RF01030                                            1030 04934000
*         DARGSENT=MSG3709I;        /*                       @Y30LB39*/ 04935000
         MVI   DARGSENT(@15),X'0A'                                 1031 04936000
*       ELSE                        /*                       @Y30LB39*/ 04937000
*         DARGSENT=MSG3706I;        /*                       @Y30LB39   04938000
*                                                            @Y30LB39*/ 04939000
         B     @RC01030                                            1032 04940000
@RF01030 L     @01,DDSTRU                                          1032 04941000
         MVI   DARGSENT(@01),X'07'                                 1032 04942000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   04943000
*                                                            @Y30LB39*/ 04944000
@RC01030 L     @15,@PC00001                                        1033 04945000
         ST    @15,@AL00001                                        1033 04946000
         LA    @14,@CF00115                                        1033 04947000
         ST    @14,@AL00001+4                                      1033 04948000
         LA    @14,DDSTRU                                          1033 04949000
         ST    @14,@AL00001+8                                      1033 04950000
         MVI   @AL00001+8,X'80'                                    1033 04951000
         L     @15,GDTPRT(,@15)                                    1033 04952000
         LA    @01,@AL00001                                        1033 04953000
         BALR  @14,@15                                             1033 04954000
*     END;                          /*                       @Y30LB39   04955000
*                                                            @Y30LB39*/ 04956000
*                                                                  1034 04957000
*   /*****************************************************************/ 04958000
*   /*                                                               */ 04959000
*   /*                                                       @Y30LB39*/ 04960000
*   /* IF REUSE FLAG IS ON, THEN ISSUE THE APPROPRIATE       @Y30LB39*/ 04961000
*   /* SECONDARY MESSAGE.                                    @Y30LB39*/ 04962000
*   /* IF OBKUPFLG IS ON, MESSAGE IDC0704I                   @Y30LB39*/ 04963000
*   /* IF OBKUPFLG IS OFF, MESSAGE IDC0605I                  @Y30LB39*/ 04964000
*   /*                                                       @Y30LB39*/ 04965000
*   /*                                                               */ 04966000
*   /*****************************************************************/ 04967000
*                                                                  1035 04968000
*                                   /*                       @Y30LB39*/ 04969000
*   IF REUSEFLG=ON THEN             /*                       @Y30LB39*/ 04970000
@RC00999 TM    REUSEFLG,B'10000000'                                1035 04971000
         BNO   @RF01035                                            1035 04972000
*     DO;                           /*                       @Y30LB39*/ 04973000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 04974000
         L     @15,DDSTRU                                          1037 04975000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1037 04976000
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/ 04977000
         MVC   DARGSMOD(3,@15),@CC01548                            1038 04978000
*       IF OBKUPFLG=ON THEN         /*                       @Y30LB39*/ 04979000
         TM    OBKUPFLG,B'01000000'                                1039 04980000
         BNO   @RF01039                                            1039 04981000
*         DO;                       /*                       @Y30LB39*/ 04982000
*           DARGSENT=MSG0704I;      /*                       @Y30LB39*/ 04983000
         MVI   DARGSENT(@15),X'05'                                 1041 04984000
*           DARGDBP=ADDR(COPDATE);  /*                       @Y30LB39*/ 04985000
         LA    @14,COPDATE(,COPYVPTR)                              1042 04986000
         ST    @14,DARGDBP(,@15)                                   1042 04987000
*           DARGILP=LENGTH(COPDATE);/*                       @Y30LB39*/ 04988000
         MVC   DARGILP(2,@15),@CH00042                             1043 04989000
*         END;                      /*                       @Y30LB39*/ 04990000
*       ELSE                        /*                       @Y30LB39*/ 04991000
*         DARGSENT=MSG0705I;        /*                       @Y30LB39   04992000
*                                                            @Y30LB39*/ 04993000
         B     @RC01039                                            1045 04994000
@RF01039 L     @01,DDSTRU                                          1045 04995000
         MVI   DARGSENT(@01),X'06'                                 1045 04996000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   04997000
*                                                            @Y30LB39*/ 04998000
@RC01039 L     @15,@PC00001                                        1046 04999000
         ST    @15,@AL00001                                        1046 05000000
         LA    @14,@CF00115                                        1046 05001000
         ST    @14,@AL00001+4                                      1046 05002000
         LA    @14,DDSTRU                                          1046 05003000
         ST    @14,@AL00001+8                                      1046 05004000
         MVI   @AL00001+8,X'80'                                    1046 05005000
         L     @15,GDTPRT(,@15)                                    1046 05006000
         LA    @01,@AL00001                                        1046 05007000
         BALR  @14,@15                                             1046 05008000
*     END;                          /*                       @Y30LB39*/ 05009000
*                                   /*                       @Y30LB39*/ 05010000
*                                                                  1048 05011000
*   /*****************************************************************/ 05012000
*   /*                                                               */ 05013000
*   /*                                                       @Y30LB39*/ 05014000
*   /* IF THE CONDITION CODE IS ZERO, THEN CONTINUE.         @Y30LB39*/ 05015000
*   /* OTHERWISE, RETURN TO CALLER.                          @Y30LB39*/ 05016000
*   /*                                                       @Y30LB39*/ 05017000
*   /*                                                               */ 05018000
*   /*****************************************************************/ 05019000
*                                                                  1048 05020000
*                                   /*                       @Y30LB39*/ 05021000
*   IF COPYRC=0 THEN                /*                       @Y30LB39*/ 05022000
@RF01035 SLR   @15,@15                                             1048 05023000
         CR    COPYRC,@15                                          1048 05024000
         BNE   @RF01048                                            1048 05025000
*     DO;                           /*                       @Y30LB39   05026000
*                                                            @Y30LB39*/ 05027000
*                                                                  1049 05028000
*       /*************************************************************/ 05029000
*       /*                                                           */ 05030000
*       /*                                                   @Y30LB39*/ 05031000
*       /* INITIALIZE MVR TO CLEAR THE INCOMPLETE            @Y30LB39*/ 05032000
*       /* FLAG FROM THE INVENTORY.                          @Y30LB39*/ 05033000
*       /*                                                   @Y30LB39*/ 05034000
*       /*                                                           */ 05035000
*       /*************************************************************/ 05036000
*                                                                  1050 05037000
*                                   /*                       @Y30LB39*/ 05038000
*       MVR=''B;                    /*                       @Y30LB39*/ 05039000
         L     @14,MVRPTR                                          1050 05040000
         XC    MVR(88,@14),MVR(@14)                                1050 05041000
*       MVRLNGTH=MVRLEN;            /*                       @Y30LB39*/ 05042000
         LH    @03,MVRLEN                                          1051 05043000
         ST    @03,MVRLNGTH(,@14)                                  1051 05044000
*       MVRCODE=MVROP;              /*                       @Y30LB39*/ 05045000
         XC    MVRCODE+1(3,@14),MVRCODE+1(@14)                     1052 05046000
         MVI   MVRCODE(@14),X'85'                                  1052 05047000
*       MVRCICPY=ON;                /*                       @Y30LB39*/ 05048000
         OI    MVRCICPY(@14),B'01000000'                           1053 05049000
*       MVRBVOL=VOLVAL;             /*                       @Y30LB39*/ 05050000
         L     @03,@PC00001+4                                      1054 05051000
         L     @01,FDTPTR(,@03)                                    1054 05052000
         MVC   MVRBVOL(6,@14),VOLVAL(@01)                          1054 05053000
*       MVRFLBAS=ON;                /*                       @Y30LB39*/ 05054000
         OI    MVRFLBAS(@14),B'00100000'                           1055 05055000
*       MVRCSN=CSN1AREA;            /*                       @Y30LB39*/ 05056000
         MVC   MVRCSN(12,@14),CSN1AREA                             1056 05057000
*       MVRFLCSN=ON;                /*                       @Y30LB39*/ 05058000
         OI    MVRFLCSN(@14),B'00000100'                           1057 05059000
*       IF ADDR(BKUP)^=NULLPTR THEN /*                       @Y30LB39*/ 05060000
         C     @15,FDTPTR+4(,@03)                                  1058 05061000
         BE    @RF01058                                            1058 05062000
*         MVRBKUP=ON;               /*                       @Y30LB39   05063000
*                                                            @Y30LB39*/ 05064000
*                                                                  1059 05065000
         OI    MVRBKUP(@14),B'00010000'                            1059 05066000
*       /*************************************************************/ 05067000
*       /*                                                           */ 05068000
*       /*                                                   @Y30LB39*/ 05069000
*       /* ISSUE USSC TO INVOKE MSVC AFTER DUMPING MVR       @Y30LB39*/ 05070000
*       /* PARAMETER LIST.                                   @Y30LB39*/ 05071000
*       /*                                                   @Y30LB39*/ 05072000
*       /*                                                           */ 05073000
*       /*************************************************************/ 05074000
*                                                                  1060 05075000
*                                   /*                       @Y30LB39*/ 05076000
*       IF GDTDBG=NULLPTR THEN                                     1060 05077000
@RF01058 L     @15,@PC00001                                        1060 05078000
         L     @15,GDTDBG(,@15)                                    1060 05079000
         LTR   @15,@15                                             1060 05080000
         BZ    @RT01060                                            1060 05081000
*         ;                                                        1061 05082000
*       ELSE                                                       1062 05083000
*         DO;                                                      1062 05084000
*           DMPINDEX=ADDR(DUMPLIST);/*                       @Y30LB39*/ 05085000
         LA    DMPINDEX,DUMPLIST                                   1063 05086000
*           DMPITMNM='MVRBUFR';                                    1064 05087000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1064 05088000
         MVC   DMPITMNM(7,DMPINDEX),@CC01715                       1064 05089000
*           DMPITMPT=ADDR(MVRBUFR);                                1065 05090000
         LA    @03,MVRBUFR                                         1065 05091000
         ST    @03,DMPITMPT(,DMPINDEX)                             1065 05092000
*           DMPITMLN=LENGTH(MVRBUFR);                              1066 05093000
         MVC   DMPITMLN(2,DMPINDEX),@CH01909                       1066 05094000
*           DMPITMTP='H';                                          1067 05095000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1067 05096000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            1068 05097000
         AL    DMPINDEX,@CF00474                                   1068 05098000
*           DMPTRM=DMPTRMVL;                                       1069 05099000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1069 05100000
*         END;                      /*                       @Y30LB39   05101000
*                                                            @Y30LB39*/ 05102000
*       IF GDTDBG=NULLPTR THEN                                     1071 05103000
@RT01060 L     @15,@PC00001                                        1071 05104000
         L     @15,GDTDBG(,@15)                                    1071 05105000
         LTR   @15,@15                                             1071 05106000
         BZ    @RT01071                                            1071 05107000
*         ;                                                        1072 05108000
*       ELSE                                                       1073 05109000
*         CALL IDCDB010(GDTTBL,'COFF',ADDR(DUMPLIST));/*     @Y30LB39   05110000
*                                                            @Y30LB39*/ 05111000
         L     @15,@PC00001                                        1073 05112000
         ST    @15,@AL00001                                        1073 05113000
         LA    @14,@CC01716                                        1073 05114000
         ST    @14,@AL00001+4                                      1073 05115000
         LA    @14,DUMPLIST                                        1073 05116000
         ST    @14,@AFTEMPS+12                                     1073 05117000
         LA    @14,@AFTEMPS+12                                     1073 05118000
         ST    @14,@AL00001+8                                      1073 05119000
         MVI   @AL00001+8,X'80'                                    1073 05120000
         L     @15,GDTDBG(,@15)                                    1073 05121000
         LA    @01,@AL00001                                        1073 05122000
         BALR  @14,@15                                             1073 05123000
*       CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASON);/*          @Y30LB39   05124000
*                                                            @Y30LB39*/ 05125000
@RT01071 L     @02,@PC00001                                        1074 05126000
         ST    @02,@AL00001                                        1074 05127000
         LA    @15,VVIC                                            1074 05128000
         ST    @15,@AL00001+4                                      1074 05129000
         LA    @15,MVRPTR                                          1074 05130000
         ST    @15,@AL00001+8                                      1074 05131000
         LA    @15,REASON                                          1074 05132000
         ST    @15,@AL00001+12                                     1074 05133000
         MVI   @AL00001+12,X'80'                                   1074 05134000
         L     @15,GDTSSC(,@02)                                    1074 05135000
         LA    @01,@AL00001                                        1074 05136000
         BALR  @14,@15                                             1074 05137000
*       RESPECIFY                                                  1075 05138000
*         RTNREG RSTD;                                             1075 05139000
*       TESTRC=RTNREG;                                             1076 05140000
         LR    TESTRC,RTNREG                                       1076 05141000
*       RESPECIFY                                                  1077 05142000
*         RTNREG UNRSTD;            /*                       @Y30LB39   05143000
*                                                            @Y30LB39*/ 05144000
*                                                                  1077 05145000
*       /*************************************************************/ 05146000
*       /*                                                           */ 05147000
*       /*                                                   @Y30LB39*/ 05148000
*       /* IF MSVC RETURNS A RETURN CODE OF TWELVE,          @Y30LB39*/ 05149000
*       /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN        @Y30LB39*/ 05150000
*       /* I-O ERROR PREVENTED THE UPDATING OF THE           @Y30LB39*/ 05151000
*       /* MS INVENTORY. THIS RETURN CODE SHOULD BE          @Y30LB39*/ 05152000
*       /* TREATED AS A RETURN CODE OF ZERO, EXCEPT          @Y30LB39*/ 05153000
*       /* THAT THE FINAL CODE TO THE EXECUTIVE              @Y30LB39*/ 05154000
*       /* SHOULD BE AT LEAST FOUR. THAT IS THE              @Y30LB39*/ 05155000
*       /* REASON FOR SETTING IOERRFLG ON.                   @Y30LB39*/ 05156000
*       /*                                                   @Y30LB39*/ 05157000
*       /*                                                           */ 05158000
*       /*************************************************************/ 05159000
*                                                                  1078 05160000
*                                   /*                       @Y30LB39*/ 05161000
*       IF TESTRC=12 THEN           /*                       @Y30LB39*/ 05162000
         C     TESTRC,@CF00567                                     1078 05163000
         BNE   @RF01078                                            1078 05164000
*         DO;                       /*                       @Y30LB39*/ 05165000
*           TESTRC=LASTCC00;        /*                       @Y30LB39*/ 05166000
         SLR   TESTRC,TESTRC                                       1080 05167000
*           IOERRFLG=ON;            /*                       @Y30LB39*/ 05168000
         OI    IOERRFLG,B'10000000'                                1081 05169000
*         END;                      /*                       @Y30LB39   05170000
*                                                            @Y30LB39*/ 05171000
*                                                                  1082 05172000
*       /*************************************************************/ 05173000
*       /*                                                           */ 05174000
*       /*                                                   @Y30LB39*/ 05175000
*       /* CHECK IF THE INCOMPLETE COPY FLAG WAS             @Y30LB39*/ 05176000
*       /* SUCCESSFULLY CLEARED FROM THE MSVI                @Y30LB39*/ 05177000
*       /*                                                   @Y30LB39*/ 05178000
*       /*                                                           */ 05179000
*       /*************************************************************/ 05180000
*                                                                  1083 05181000
*                                   /*                       @Y30LB39*/ 05182000
*       IF TESTRC^=0 THEN           /*                       @Y30LB39*/ 05183000
@RF01078 LTR   TESTRC,TESTRC                                       1083 05184000
         BZ    @RF01083                                            1083 05185000
*         DO;                       /*                       @Y30LB39   05186000
*                                                            @Y30LB39*/ 05187000
*                                                                  1084 05188000
*           /*********************************************************/ 05189000
*           /*                                                       */ 05190000
*           /*                                               @Y30LB39*/ 05191000
*           /* SET THE CONDITION CODE TO FOUR,               @Y30LB39*/ 05192000
*           /* IF MSIV NOT UPDATED                           @Y30LB39*/ 05193000
*           /*                                               @Y30LB39*/ 05194000
*           /*                                                       */ 05195000
*           /*********************************************************/ 05196000
*                                                                  1085 05197000
*                                   /*                       @Y30LB39*/ 05198000
*           COPYRC=LASTCC04;        /*                       @Y30LB39   05199000
*                                                            @Y30LB39*/ 05200000
*                                                                  1085 05201000
         LA    @02,4                                               1085 05202000
         LR    COPYRC,@02                                          1085 05203000
*           /*********************************************************/ 05204000
*           /*                                                       */ 05205000
*           /*                                               @Y30LB39*/ 05206000
*           /* CALL SSCMSG TO OUTPUT APPROPRIATE             @Y30LB39*/ 05207000
*           /* REASON CODE IF RETURN CODE IS FOUR.           @Y30LB39*/ 05208000
*           /*                                               @Y30LB39*/ 05209000
*           /*                                                       */ 05210000
*           /*********************************************************/ 05211000
*                                                                  1086 05212000
*                                   /*                       @Y30LB39*/ 05213000
*           IF TESTRC=LASTCC04 THEN /*                       @Y30LB39   05214000
*                                                            @Y30LB39*/ 05215000
         CR    TESTRC,@02                                          1086 05216000
         BNE   @RF01086                                            1086 05217000
*             CALL SSCMSG(REASON);  /*                       @Y30LB39   05218000
*                                                            @Y30LB39*/ 05219000
*                                                                  1087 05220000
         LA    @15,REASON                                          1087 05221000
         ST    @15,@AL00001                                        1087 05222000
         LA    @01,@AL00001                                        1087 05223000
         BAL   @14,SSCMSG                                          1087 05224000
*           /*********************************************************/ 05225000
*           /*                                                       */ 05226000
*           /*                                               @Y30LB39*/ 05227000
*           /* ISSUE UPRINT FOR SECONDARY MESSAGE            @Y30LB39*/ 05228000
*           /* IDC3066I.                                     @Y30LB39*/ 05229000
*           /*                                               @Y30LB39*/ 05230000
*           /*                                                       */ 05231000
*           /*********************************************************/ 05232000
*                                                                  1088 05233000
*                                   /*                       @Y30LB39*/ 05234000
*           DARGLIST=''B;           /*                       @Y30LB39*/ 05235000
@RF01086 L     @15,DDSTRU                                          1088 05236000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1088 05237000
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/ 05238000
         MVC   DARGSMOD(3,@15),@CC01550                            1089 05239000
*           DARGSENT=MSG3066I;      /*                       @Y30LB39   05240000
*                                                            @Y30LB39*/ 05241000
         MVI   DARGSENT(@15),X'2C'                                 1090 05242000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB39   05243000
*                                                            @Y30LB39*/ 05244000
         L     @15,@PC00001                                        1091 05245000
         ST    @15,@AL00001                                        1091 05246000
         LA    @14,@CF00115                                        1091 05247000
         ST    @14,@AL00001+4                                      1091 05248000
         LA    @14,DDSTRU                                          1091 05249000
         ST    @14,@AL00001+8                                      1091 05250000
         MVI   @AL00001+8,X'80'                                    1091 05251000
         L     @15,GDTPRT(,@15)                                    1091 05252000
         LA    @01,@AL00001                                        1091 05253000
         BALR  @14,@15                                             1091 05254000
*         END;                      /*                       @Y30LB39*/ 05255000
*     END;                          /*                       @Y30LB39   05256000
*                                                            @Y30LB39*/ 05257000
*                                                                  1093 05258000
@RF01083 DS    0H                                                  1094 05259000
*   /*****************************************************************/ 05260000
*   /*                                                               */ 05261000
*   /*                                                       @Y30LB39*/ 05262000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 05263000
*   /*                                                       @Y30LB39*/ 05264000
*   /*                                                               */ 05265000
*   /*****************************************************************/ 05266000
*                                                                  1094 05267000
*                                   /*                       @Y30LB39*/ 05268000
*   REG14=RETADDR2;                 /*                       @Y30LB39   05269000
*                                                            @Y30LB39*/ 05270000
*                                                                  1094 05271000
@RF01048 LR    REG14,RETADDR2                                      1094 05272000
*   /*****************************************************************/ 05273000
*   /*                                                               */ 05274000
*   /*                                                       @Y30LB39*/ 05275000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 05276000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 05277000
*   /*                                                       @Y30LB39*/ 05278000
*   /*                                                               */ 05279000
*   /*****************************************************************/ 05280000
*                                                                  1095 05281000
*                                   /*                       @Y30LB39*/ 05282000
*   RETURN CODE(COPYRC);            /*                       @Y30LB39*/ 05283000
         LR    @15,COPYRC                                          1095 05284000
@EL00011 DS    0H                                                  1095 05285000
@EF00011 DS    0H                                                  1095 05286000
@ER00011 BR    @14                                                 1095 05287000
*   END COPYRTN;                    /*                       @Y30LB39*/ 05288000
*                                                                  1097 05289000
*   /*****************************************************************/ 05290000
*   /*                                                               */ 05291000
*   /*                                                       @Y30LB39*/ 05292000
*   /* PROCEDURE NAME - LABELRTN                             @Y30LB39*/ 05293000
*   /*                                                       @Y30LB39*/ 05294000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 05295000
*   /* UPDATE THE OWNER IN THE MSV INVENTORY AND             @Y30LB39*/ 05296000
*   /* IN THE CARTRIDGE LABELS BY ISSUING THE MSC            @Y30LB39*/ 05297000
*   /* DEFINE ORDER TO RENAME THE VOLUME WITH ITS            @Y30LB39*/ 05298000
*   /* SAME SERIAL NUMBER. IF THE UPDATING OF INFOR-         @Y30LB39*/ 05299000
*   /* MATION IS NOT SUCCESSFUL, THEN MESSAGE IDC1707I       @Y30LB39*/ 05300000
*   /* IS ISSUED AND CONDITION CODE IS SET TO FOUR.          @Y30LB39*/ 05301000
*   /* ALSO CALLS SSCMSG TO ISSUE APPROPRIATE REASON         @Y30LB39*/ 05302000
*   /* CODE IF DEFINE DID NOT COMPLETE NORMALLY.             @Y30LB39*/ 05303000
*   /*                                                       @Y30LB39*/ 05304000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 05305000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 05306000
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/ 05307000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 05308000
*   /* DEFLIST                                               @Y30LB39*/ 05309000
*   /*                                                       @Y30LB39*/ 05310000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 05311000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 05312000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 05313000
*   /* 4 - IF MSSC RETURNS A NON-ZERO RETURN CODE            @Y30LB39*/ 05314000
*   /*                                                       @Y30LB39*/ 05315000
*   /*                                                               */ 05316000
*   /*****************************************************************/ 05317000
*                                                                  1097 05318000
*LABELRTN:                                                         1097 05319000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 05320000
*                                                                  1097 05321000
LABELRTN DS    0H                                                  1098 05322000
*   /*****************************************************************/ 05323000
*   /*                                                               */ 05324000
*   /*                                                       @Y30LB39*/ 05325000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 05326000
*   /*                                                       @Y30LB39*/ 05327000
*   /*                                                               */ 05328000
*   /*****************************************************************/ 05329000
*                                                                  1098 05330000
*                                   /*                       @Y30LB39*/ 05331000
*   DCL                                                            1098 05332000
*     LABLRC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 05333000
*                                   /*                       @Y30LB39*/ 05334000
*                                                                  1099 05335000
*   /*****************************************************************/ 05336000
*   /*                                                               */ 05337000
*   /*                                                       @Y30LB39*/ 05338000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 05339000
*   /*                                                       @Y30LB39*/ 05340000
*   /*                                                               */ 05341000
*   /*****************************************************************/ 05342000
*                                                                  1099 05343000
*                                   /*                       @Y30LB39*/ 05344000
*   RETADDR2=REG14;                 /*                       @Y30LB39   05345000
*                                                            @Y30LB39*/ 05346000
*                                                                  1099 05347000
         LR    RETADDR2,REG14                                      1099 05348000
*   /*****************************************************************/ 05349000
*   /*                                                               */ 05350000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 05351000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 05352000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 05353000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 05354000
*   /*                                                       @Y30LB39*/ 05355000
*   /*                                                               */ 05356000
*   /*****************************************************************/ 05357000
*                                                                  1100 05358000
*                                   /*                       @Y30LB39*/ 05359000
*   OLDERID2=NEWERID2;                                             1100 05360000
         L     @15,@PC00001                                        1100 05361000
         L     @14,GDTTR2(,@15)                                    1100 05362000
         MVC   @TS00001(95),NEWERID2(@14)                          1100 05363000
         MVC   OLDERID2(95,@14),@TS00001                           1100 05364000
*   NEWID2='COLB';                  /*                       @Y30LB39   05365000
*                                                            @Y30LB39*/ 05366000
*                                                                  1101 05367000
         MVC   NEWID2(4,@14),@CC01721                              1101 05368000
*   /*****************************************************************/ 05369000
*   /*                                                               */ 05370000
*   /*                                                       @Y30LB39*/ 05371000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 05372000
*   /*                                                       @Y30LB39*/ 05373000
*   /*                                                               */ 05374000
*   /*****************************************************************/ 05375000
*                                                                  1102 05376000
*                                   /*                       @Y30LB39*/ 05377000
*   LABLRC=LASTCC00;                /*                       @Y30LB39   05378000
*                                                            @Y30LB39*/ 05379000
*                                                                  1102 05380000
         SLR   @14,@14                                             1102 05381000
         LR    LABLRC,@14                                          1102 05382000
*   /*****************************************************************/ 05383000
*   /*                                                               */ 05384000
*   /*                                                       @Y30LB39*/ 05385000
*   /* INITIALIZE THE DEFLIST PARAMETER LIST                 @Y30LB39*/ 05386000
*   /* NOTE THAT THE VOLUME IS RENAMED TO ITSELF IN          @Y30LB39*/ 05387000
*   /* ORDER TO UPDATE THE OWNER ON THE CARTRIDGE            @Y30LB39*/ 05388000
*   /* LABELS. THE MOUNTING ATTRIBUTES ARE                   @Y30LB39*/ 05389000
*   /* NOT CHANGED.                                          @Y30LB39*/ 05390000
*   /*                                                       @Y30LB39*/ 05391000
*   /*                                                               */ 05392000
*   /*****************************************************************/ 05393000
*                                                                  1103 05394000
*                                   /*                       @Y30LB39*/ 05395000
*   DEFLIST=''B;                    /*                       @Y30LB39*/ 05396000
         L     @03,DEFVPTR                                         1103 05397000
         XC    DEFLIST(132,@03),DEFLIST(@03)                       1103 05398000
*   DEFVRNTR=ON;                    /*                       @Y30LB39*/ 05399000
         OI    DEFVRNTR(@03),B'00000100'                           1104 05400000
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB39*/ 05401000
         L     @02,@PC00001+4                                      1105 05402000
         L     @01,FDTPTR(,@02)                                    1105 05403000
         MVC   DEFVOLD(6,@03),VOLVAL(@01)                          1105 05404000
*   DEFVVFLG=HEXFF;                 /*                       @Y30LB39*/ 05405000
         MVC   DEFVVFLG(1,@03),HEXFF                               1106 05406000
*   DEFVCSN1=CSN1AREA;              /*                       @Y30LB39*/ 05407000
         MVC   DEFVCSN1(12,@03),CSN1AREA                           1107 05408000
*   DEFVDATA=''B;                   /*                       @Y30LB39*/ 05409000
         XC    DEFVDATA(72,@03),DEFVDATA(@03)                      1108 05410000
*   DEFOWNID=BASOWNER;              /*                       @Y30LB39*/ 05411000
         MVI   DEFOWNID+10(@03),C' '                               1109 05412000
         MVC   DEFOWNID+11(3,@03),DEFOWNID+10(@03)                 1109 05413000
         MVC   DEFOWNID(10,@03),BASOWNER(BASEVPTR)                 1109 05414000
*   DEFVNVOL=DEFVOLD;               /*                       @Y30LB39*/ 05415000
         MVC   DEFVNVOL(6,@03),DEFVOLD(@03)                        1110 05416000
*   DEFVVEXT=NULLPTR;               /*                       @Y30LB39*/ 05417000
         ST    @14,DEFVVEXT(,@03)                                  1111 05418000
*                                   /*                       @Y30LB39*/ 05419000
*                                                                  1112 05420000
*   /*****************************************************************/ 05421000
*   /*                                                               */ 05422000
*   /*                                                       @Y30LB39*/ 05423000
*   /* ISSUE USSC TO UPDATE THE OWNER AFTER DUMPING          @Y30LB39*/ 05424000
*   /* DEFINE PARAMETER LIST.                                @Y30LB39*/ 05425000
*   /*                                                       @Y30LB39*/ 05426000
*   /*                                                               */ 05427000
*   /*****************************************************************/ 05428000
*                                                                  1112 05429000
*                                   /*                       @Y30LB39*/ 05430000
*   IF GDTDBG=NULLPTR THEN                                         1112 05431000
         C     @14,GDTDBG(,@15)                                    1112 05432000
         BE    @RT01112                                            1112 05433000
*     ;                                                            1113 05434000
*   ELSE                                                           1114 05435000
*     DO;                                                          1114 05436000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/ 05437000
         LA    DMPINDEX,DUMPLIST                                   1115 05438000
*       DMPITMNM='DEFLISTB';                                       1116 05439000
         MVC   DMPITMNM(8,DMPINDEX),@CC01693                       1116 05440000
*       DMPITMPT=ADDR(DEFLISTB);                                   1117 05441000
         LA    @03,DEFLISTB                                        1117 05442000
         ST    @03,DMPITMPT(,DMPINDEX)                             1117 05443000
*       DMPITMLN=LENGTH(DEFLISTB);                                 1118 05444000
         MVC   DMPITMLN(2,DMPINDEX),@CH01906                       1118 05445000
*       DMPITMTP='H';                                              1119 05446000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1119 05447000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1120 05448000
         AL    DMPINDEX,@CF00474                                   1120 05449000
*       DMPTRM=DMPTRMVL;                                           1121 05450000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1121 05451000
*     END;                          /*                       @Y30LB39   05452000
*                                                            @Y30LB39*/ 05453000
*   IF GDTDBG=NULLPTR THEN                                         1123 05454000
@RT01112 L     @15,@PC00001                                        1123 05455000
         L     @15,GDTDBG(,@15)                                    1123 05456000
         LTR   @15,@15                                             1123 05457000
         BZ    @RT01123                                            1123 05458000
*     ;                                                            1124 05459000
*   ELSE                                                           1125 05460000
*     CALL IDCDB010(GDTTBL,'COGG',ADDR(DUMPLIST));/*         @Y30LB39   05461000
*                                                            @Y30LB39*/ 05462000
         L     @15,@PC00001                                        1125 05463000
         ST    @15,@AL00001                                        1125 05464000
         LA    @14,@CC01722                                        1125 05465000
         ST    @14,@AL00001+4                                      1125 05466000
         LA    @14,DUMPLIST                                        1125 05467000
         ST    @14,@AFTEMPS+16                                     1125 05468000
         LA    @14,@AFTEMPS+16                                     1125 05469000
         ST    @14,@AL00001+8                                      1125 05470000
         MVI   @AL00001+8,X'80'                                    1125 05471000
         L     @15,GDTDBG(,@15)                                    1125 05472000
         LA    @01,@AL00001                                        1125 05473000
         BALR  @14,@15                                             1125 05474000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBBYTE,CMMSGPTR);/*     05475000
*                                                            @Y30LB39*/ 05476000
@RT01123 L     @02,@PC00001                                        1126 05477000
         ST    @02,@AL00001                                        1126 05478000
         LA    @15,DEFINE                                          1126 05479000
         ST    @15,@AL00001+4                                      1126 05480000
         LA    @15,DEFVPTR                                         1126 05481000
         ST    @15,@AL00001+8                                      1126 05482000
         LA    @15,REASON                                          1126 05483000
         ST    @15,@AL00001+12                                     1126 05484000
         LA    @15,ECBBYTE                                         1126 05485000
         ST    @15,@AL00001+16                                     1126 05486000
         LA    @15,CMMSGPTR                                        1126 05487000
         ST    @15,@AL00001+20                                     1126 05488000
         MVI   @AL00001+20,X'80'                                   1126 05489000
         L     @15,GDTSSC(,@02)                                    1126 05490000
         LA    @01,@AL00001                                        1126 05491000
         BALR  @14,@15                                             1126 05492000
*   RESPECIFY                                                      1127 05493000
*     RTNREG RSTD;                                                 1127 05494000
*   TESTRC=RTNREG;                                                 1128 05495000
         LR    TESTRC,RTNREG                                       1128 05496000
*   RESPECIFY                                                      1129 05497000
*     RTNREG UNRSTD;                /*                       @Y30LB39   05498000
*                                                            @Y30LB39*/ 05499000
*                                                                  1129 05500000
*   /*****************************************************************/ 05501000
*   /*                                                               */ 05502000
*   /*                                                       @Y30LB39*/ 05503000
*   /* IF MSVC RETURNS A RETURN CODE OF TWELVE,              @Y30LB39*/ 05504000
*   /* IT MEANS THE FUNCTION WAS COMPLETED BUT AN            @Y30LB39*/ 05505000
*   /* I-O ERROR PREVENTED THE UPDATING OF THE               @Y30LB39*/ 05506000
*   /* MS INVENTORY. THIS RETURN CODE SHOULD BE              @Y30LB39*/ 05507000
*   /* TREATED AS A RETURN CODE OF ZERO, EXCEPT              @Y30LB39*/ 05508000
*   /* THAT THE FINAL CODE TO THE EXECUTIVE                  @Y30LB39*/ 05509000
*   /* SHOULD BE AT LEAST FOUR. THAT IS THE                  @Y30LB39*/ 05510000
*   /* REASON FOR SETTING IOERRFLG ON.                       @Y30LB39*/ 05511000
*   /*                                                       @Y30LB39*/ 05512000
*   /*                                                               */ 05513000
*   /*****************************************************************/ 05514000
*                                                                  1130 05515000
*                                   /*                       @Y30LB39*/ 05516000
*   IF TESTRC=12 THEN               /*                       @Y30LB39*/ 05517000
         C     TESTRC,@CF00567                                     1130 05518000
         BNE   @RF01130                                            1130 05519000
*     DO;                           /*                       @Y30LB39*/ 05520000
*       TESTRC=LASTCC00;            /*                       @Y30LB39*/ 05521000
         SLR   TESTRC,TESTRC                                       1132 05522000
*       IOERRFLG=ON;                /*                       @Y30LB39*/ 05523000
         OI    IOERRFLG,B'10000000'                                1133 05524000
*     END;                          /*                       @Y30LB39   05525000
*                                                            @Y30LB39*/ 05526000
*                                                                  1134 05527000
*   /*****************************************************************/ 05528000
*   /*                                                               */ 05529000
*   /*                                                       @Y30LB39*/ 05530000
*   /* CHECK RETURN CODE                                     @Y30LB39*/ 05531000
*   /*                                                       @Y30LB39*/ 05532000
*   /*                                                               */ 05533000
*   /*****************************************************************/ 05534000
*                                                                  1135 05535000
*                                   /*                       @Y30LB39*/ 05536000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/ 05537000
@RF01130 LTR   TESTRC,TESTRC                                       1135 05538000
         BZ    @RF01135                                            1135 05539000
*     DO;                           /*                       @Y30LB39   05540000
*                                                            @Y30LB39*/ 05541000
*                                                                  1136 05542000
*       /*************************************************************/ 05543000
*       /*                                                           */ 05544000
*       /*                                                   @Y30LB39*/ 05545000
*       /* RETURN CODE IS NOT ZERO. SET CONDITION            @Y30LB39*/ 05546000
*       /* CODE TO FOUR.                                     @Y30LB39*/ 05547000
*       /*                                                   @Y30LB39*/ 05548000
*       /*                                                           */ 05549000
*       /*************************************************************/ 05550000
*                                                                  1137 05551000
*                                   /*                       @Y30LB39*/ 05552000
*       LABLRC=LASTCC04;            /*                       @Y30LB39   05553000
*                                                            @Y30LB39*/ 05554000
*                                                                  1137 05555000
         LA    @02,4                                               1137 05556000
         LR    LABLRC,@02                                          1137 05557000
*       /*************************************************************/ 05558000
*       /*                                                           */ 05559000
*       /*                                                   @Y30LB39*/ 05560000
*       /* IF THE USSC RETURN CODE WAS FOUR,                 @Y30LB39*/ 05561000
*       /* THE RENAME REQUEST FAILED.                        @Y30LB39*/ 05562000
*       /* CALL SSCMSG TO OUTPUT THE APPROPRIATE             @Y30LB39*/ 05563000
*       /* REASON CODE.                                      @Y30LB39*/ 05564000
*       /*                                                   @Y30LB39*/ 05565000
*       /*                                                           */ 05566000
*       /*************************************************************/ 05567000
*                                                                  1138 05568000
*                                   /*                       @Y30LB39*/ 05569000
*       IF TESTRC=LASTCC04 THEN     /*                       @Y30LB39   05570000
*                                                            @Y30LB39*/ 05571000
         CR    TESTRC,@02                                          1138 05572000
         BNE   @RF01138                                            1138 05573000
*         CALL SSCMSG(REASON,ECBBYTE);/*                     @Y30LB39   05574000
*                                                            @Y30LB39*/ 05575000
*                                                                  1139 05576000
         LA    @15,REASON                                          1139 05577000
         ST    @15,@AL00001                                        1139 05578000
         LA    @15,ECBBYTE                                         1139 05579000
         ST    @15,@AL00001+4                                      1139 05580000
         LA    @01,@AL00001                                        1139 05581000
         BAL   @14,SSCMSG                                          1139 05582000
*       /*************************************************************/ 05583000
*       /*                                                           */ 05584000
*       /*                                                   @Y30LB39*/ 05585000
*       /* ISSUE UPRINT FOR SECONDARY MESSAGE IDC1707I       @Y30LB39*/ 05586000
*       /*                                                   @Y30LB39*/ 05587000
*       /*                                                           */ 05588000
*       /*************************************************************/ 05589000
*                                                                  1140 05590000
*                                   /*                       @Y30LB39*/ 05591000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 05592000
@RF01138 L     @15,DDSTRU                                          1140 05593000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1140 05594000
*       DARGSMOD=COPYMSG;           /*                       @Y30LB39*/ 05595000
         MVC   DARGSMOD(3,@15),@CC01548                            1141 05596000
*       DARGSENT=MSG1707I;          /*                       @Y30LB39*/ 05597000
         MVI   DARGSENT(@15),X'08'                                 1142 05598000
*       DARGDBP=ADDR(COPOWNER);     /*                       @Y30LB39*/ 05599000
         LA    @14,COPOWNER(,COPYVPTR)                             1143 05600000
         ST    @14,DARGDBP(,@15)                                   1143 05601000
*       DARGILP=LENGTH(COPOWNER);   /*                       @Y30LB39*/ 05602000
         MVC   DARGILP(2,@15),@CH00444                             1144 05603000
*       DARGCNT=DATEINST;           /*                       @Y30LB39*/ 05604000
         LA    @14,1                                               1145 05605000
         STH   @14,DARGCNT(,@15)                                   1145 05606000
*       DARGINS(1)=DATEINST;        /*                       @Y30LB39*/ 05607000
         STH   @14,DARGINS(,@15)                                   1146 05608000
*       DARGINL(1)=LENGTH(NEWCDATE);/*                       @Y30LB39*/ 05609000
         MVC   DARGINL(2,@15),@CH00042                             1147 05610000
*       DARGDTM(1)=ADDR(NEWCDATE);  /*                       @Y30LB39   05611000
*                                                            @Y30LB39*/ 05612000
         LA    @14,NEWCDATE                                        1148 05613000
         ST    @14,DARGDTM(,@15)                                   1148 05614000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   05615000
*                                                            @Y30LB39*/ 05616000
         L     @15,@PC00001                                        1149 05617000
         ST    @15,@AL00001                                        1149 05618000
         LA    @14,@CF00115                                        1149 05619000
         ST    @14,@AL00001+4                                      1149 05620000
         LA    @14,DDSTRU                                          1149 05621000
         ST    @14,@AL00001+8                                      1149 05622000
         MVI   @AL00001+8,X'80'                                    1149 05623000
         L     @15,GDTPRT(,@15)                                    1149 05624000
         LA    @01,@AL00001                                        1149 05625000
         BALR  @14,@15                                             1149 05626000
*     END;                          /*                       @Y30LB39*/ 05627000
*   ELSE                            /*                       @Y30LB39   05628000
*                                                            @Y30LB39*/ 05629000
*                                                                  1151 05630000
*     /***************************************************************/ 05631000
*     /*                                                             */ 05632000
*     /*                                                     @Y30LB39*/ 05633000
*     /* RETURN CODE FROM USSC WAS ZERO, SO ISSUE            @Y30LB39*/ 05634000
*     /* UFSPACE TO RELEASE THE MESSAGE STORAGE AREA.        @Y30LB39*/ 05635000
*     /*                                                     @Y30LB39*/ 05636000
*     /*                                                             */ 05637000
*     /***************************************************************/ 05638000
*                                                                  1151 05639000
*                                   /*                       @Y30LB39*/ 05640000
*     CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                      @Y30LB39   05641000
*                                                            @Y30LB39*/ 05642000
*                                                                  1151 05643000
         B     @RC01135                                            1151 05644000
@RF01135 L     @15,@PC00001                                        1151 05645000
         ST    @15,@AL00001                                        1151 05646000
         LA    @14,CMMSGPTR                                        1151 05647000
         ST    @14,@AL00001+4                                      1151 05648000
         L     @15,GDTFSP(,@15)                                    1151 05649000
         LA    @01,@AL00001                                        1151 05650000
         BALR  @14,@15                                             1151 05651000
*   /*****************************************************************/ 05652000
*   /*                                                               */ 05653000
*   /*                                                       @Y30LB39*/ 05654000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 05655000
*   /*                                                       @Y30LB39*/ 05656000
*   /*                                                               */ 05657000
*   /*****************************************************************/ 05658000
*                                                                  1152 05659000
*                                   /*                       @Y30LB39*/ 05660000
*   REG14=RETADDR2;                 /*                       @Y30LB39   05661000
*                                                            @Y30LB39*/ 05662000
*                                                                  1152 05663000
@RC01135 LR    REG14,RETADDR2                                      1152 05664000
*   /*****************************************************************/ 05665000
*   /*                                                               */ 05666000
*   /*                                                       @Y30LB39*/ 05667000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 05668000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 05669000
*   /*                                                       @Y30LB39*/ 05670000
*   /*                                                               */ 05671000
*   /*****************************************************************/ 05672000
*                                                                  1153 05673000
*                                   /*                       @Y30LB39*/ 05674000
*   RETURN CODE(LABLRC);            /*                       @Y30LB39*/ 05675000
         LR    @15,LABLRC                                          1153 05676000
@EL00012 DS    0H                                                  1153 05677000
@EF00012 DS    0H                                                  1153 05678000
@ER00012 BR    @14                                                 1153 05679000
*   END LABELRTN;                   /*                       @Y30LB39*/ 05680000
*                                                                  1155 05681000
*   /*****************************************************************/ 05682000
*   /*                                                               */ 05683000
*   /*                                                       @Y30LB39*/ 05684000
*   /* PROCEDURE NAME - SCRRTN                               @Y30LB39*/ 05685000
*   /*                                                       @Y30LB39*/ 05686000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 05687000
*   /* DETERMINE HOW MANY, IF ANY, EXCESS BACKUP             @Y30LB39*/ 05688000
*   /* COPIES ARE IN EXISTENCE. ONCE THIS DETERMINA-         @Y30LB39*/ 05689000
*   /* TION HAS BEEN MADE. THIS SUB-PROCEDURE WILL           @Y30LB39*/ 05690000
*   /* LOOP AND MAKE A CALL TO RVVIRTN TO RETRIEVE           @Y30LB39*/ 05691000
*   /* EACH BACKUP COPY AND THEN, FOR EACH BACKUP,           @Y30LB39*/ 05692000
*   /* A CALL TO ANOTHER SUBPROCEDURE, SCRCOPY, TO           @Y30LB39*/ 05693000
*   /* SCRATCH THE BACKUP.                                   @Y30LB39*/ 05694000
*   /* DURING THE PROCESSING ACCOMPLISHED BY THIS            @Y30LB39*/ 05695000
*   /* SUB-PROCEDURE, IT IS POSSIBLE FOR THE FOLLOWING       @Y30LB39*/ 05696000
*   /* MESSAGES TO BE ISSUED.                                @Y30LB39*/ 05697000
*   /* IDC0068I TO TELL USER HOW MANY BACKUP COPIES          @Y30LB39*/ 05698000
*   /* WERE IN EXCESS OF THE LIMIT.                          @Y30LB39*/ 05699000
*   /* IDC3701I IF UNABLE TO RETRIEVE BACKUP COPY.           @Y30LB39*/ 05700000
*   /* IDC2078I IF UNABLE TO SCRATCH EXCESS COPIES.          @Y30LB39*/ 05701000
*   /*                                                       @Y30LB39*/ 05702000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 05703000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 05704000
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/ 05705000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 05706000
*   /*                                                       @Y30LB39*/ 05707000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 05708000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 05709000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 05710000
*   /* 8 - IF EITHER BACKUP COPY WAS NOT RETRIEVED           @Y30LB39*/ 05711000
*   /* OR SCRATCHED.                                         @Y30LB39*/ 05712000
*   /*                                                       @Y30LB39*/ 05713000
*   /*                                                               */ 05714000
*   /*****************************************************************/ 05715000
*                                                                  1155 05716000
*SCRRTN:                                                           1155 05717000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 05718000
*                                                                  1155 05719000
SCRRTN   DS    0H                                                  1156 05720000
*   /*****************************************************************/ 05721000
*   /*                                                               */ 05722000
*   /*                                                       @Y30LB39*/ 05723000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 05724000
*   /*                                                       @Y30LB39*/ 05725000
*   /*                                                               */ 05726000
*   /*****************************************************************/ 05727000
*                                                                  1156 05728000
*                                   /*                       @Y30LB39*/ 05729000
*   DCL                                                            1156 05730000
*     SCRRC FIXED(8);               /* RETURN CODE           @Y30LB39*/ 05731000
*   DCL                                                            1157 05732000
*     OVERFLOW FIXED(8);            /* EXCESS BACKUPS        @Y30LB39*/ 05733000
*                                   /*                       @Y30LB39*/ 05734000
*                                                                  1158 05735000
*   /*****************************************************************/ 05736000
*   /*                                                               */ 05737000
*   /*                                                       @Y30LB39*/ 05738000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 05739000
*   /*                                                       @Y30LB39*/ 05740000
*   /*                                                               */ 05741000
*   /*****************************************************************/ 05742000
*                                                                  1158 05743000
*                                   /*                       @Y30LB39*/ 05744000
*   RETADDR1=REG14;                 /*                       @Y30LB39   05745000
*                                                            @Y30LB39*/ 05746000
*                                                                  1158 05747000
         ST    REG14,RETADDR1                                      1158 05748000
*   /*****************************************************************/ 05749000
*   /*                                                               */ 05750000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 05751000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 05752000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 05753000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 05754000
*   /*                                                       @Y30LB39*/ 05755000
*   /*                                                               */ 05756000
*   /*****************************************************************/ 05757000
*                                                                  1159 05758000
*                                   /*                       @Y30LB39*/ 05759000
*   OLDERID2=NEWERID2;                                             1159 05760000
         L     @09,@PC00001                                        1159 05761000
         L     @09,GDTTR2(,@09)                                    1159 05762000
         MVC   @TS00001(95),NEWERID2(@09)                          1159 05763000
         MVC   OLDERID2(95,@09),@TS00001                           1159 05764000
*   NEWID2='COSC';                  /*                       @Y30LB39   05765000
*                                                            @Y30LB39*/ 05766000
*                                                                  1160 05767000
         MVC   NEWID2(4,@09),@CC01728                              1160 05768000
*   /*****************************************************************/ 05769000
*   /*                                                               */ 05770000
*   /*                                                       @Y30LB39*/ 05771000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 05772000
*   /* INITIALIZE THE LOCAL VARIABLE WHICH WILL HAVE         @Y30LB39*/ 05773000
*   /* THE EXCESS NUMBER OF BACKUP COPIES VALUE.             @Y30LB39*/ 05774000
*   /*                                                       @Y30LB39*/ 05775000
*   /*                                                               */ 05776000
*   /*****************************************************************/ 05777000
*                                                                  1161 05778000
*                                   /*                       @Y30LB39*/ 05779000
*   SCRRC=LASTCC00;                 /*                       @Y30LB39*/ 05780000
         MVI   SCRRC,X'00'                                         1161 05781000
*   OVERFLOW=0;                     /*                       @Y30LB39   05782000
*                                                            @Y30LB39*/ 05783000
*                                                                  1162 05784000
         MVI   OVERFLOW,X'00'                                      1162 05785000
*   /*****************************************************************/ 05786000
*   /*                                                               */ 05787000
*   /*                                                       @Y30LB39*/ 05788000
*   /* DETERMINE WHETHER THE BACKUP LIMIT HAS BEEN           @Y30LB39*/ 05789000
*   /* REACHED. IF AN INCOMPLETE COPY WAS REUSED             @Y30LB39*/ 05790000
*   /* WHEN CREATING THE NEWEST BACKUP, THEN INCREASE        @Y30LB39*/ 05791000
*   /* THE NUMBER OF BACKUP VARIABLE IN THE BASE             @Y30LB39*/ 05792000
*   /* VOLUME RECORD.                                        @Y30LB39*/ 05793000
*   /*                                                       @Y30LB39*/ 05794000
*   /*                                                               */ 05795000
*   /*****************************************************************/ 05796000
*                                                                  1163 05797000
*                                   /*                       @Y30LB39*/ 05798000
*   IF REUSEFLG=ON&OBKUPFLG=OFF THEN/*                       @Y30LB39*/ 05799000
         TM    REUSEFLG,B'10000000'                                1163 05800000
         BNO   @RF01163                                            1163 05801000
         TM    OBKUPFLG,B'01000000'                                1163 05802000
         BNZ   @RF01163                                            1163 05803000
*     BASNBKUP=BASNBKUP+1;          /*                       @Y30LB39   05804000
*                                                            @Y30LB39*/ 05805000
*                                                                  1164 05806000
         LA    @09,1                                               1164 05807000
         SLR   @07,@07                                             1164 05808000
         IC    @07,BASNBKUP(,BASEVPTR)                             1164 05809000
         ALR   @09,@07                                             1164 05810000
         STC   @09,BASNBKUP(,BASEVPTR)                             1164 05811000
*   /*****************************************************************/ 05812000
*   /*                                                               */ 05813000
*   /*                                                       @Y30LB39*/ 05814000
*   /* IF THE NUMBER OF CURRENT BACKUPS IS GREATER           @Y30LB39*/ 05815000
*   /* THAN THE ALLOWABLE LIMIT, THEN CALCULATE THE          @Y30LB39*/ 05816000
*   /* EXCESS NUMBER.                                        @Y30LB39*/ 05817000
*   /*                                                       @Y30LB39*/ 05818000
*   /*                                                               */ 05819000
*   /*****************************************************************/ 05820000
*                                                                  1165 05821000
*                                   /*                       @Y30LB39*/ 05822000
*   IF BASNBKUP>BASBKLMT THEN       /*                       @Y30LB39*/ 05823000
@RF01163 CLC   BASNBKUP(1,BASEVPTR),BASBKLMT(BASEVPTR)             1165 05824000
         BNH   @RF01165                                            1165 05825000
*     OVERFLOW=BASNBKUP-BASBKLMT;   /*                       @Y30LB39*/ 05826000
         SLR   @09,@09                                             1166 05827000
         IC    @09,BASNBKUP(,BASEVPTR)                             1166 05828000
         SLR   @07,@07                                             1166 05829000
         IC    @07,BASBKLMT(,BASEVPTR)                             1166 05830000
         SLR   @09,@07                                             1166 05831000
         STC   @09,OVERFLOW                                        1166 05832000
*                                   /*                       @Y30LB39*/ 05833000
*                                                                  1167 05834000
*   /*****************************************************************/ 05835000
*   /*                                                               */ 05836000
*   /*                                                       @Y30LB39*/ 05837000
*   /* RETURN TO CALLING ROUTINE IF THE ALLOWABLE            @Y30LB39*/ 05838000
*   /* NUMBER OF BACKUPS HAS NOT BEEN EXCEEDED.              @Y30LB39*/ 05839000
*   /*                                                       @Y30LB39*/ 05840000
*   /*                                                               */ 05841000
*   /*****************************************************************/ 05842000
*                                                                  1167 05843000
*                                   /*                       @Y30LB39*/ 05844000
*   IF OVERFLOW>0 THEN              /*                       @Y30LB39*/ 05845000
@RF01165 CLI   OVERFLOW,0                                          1167 05846000
         BNH   @RF01167                                            1167 05847000
*     DO;                           /*                       @Y30LB39   05848000
*                                                            @Y30LB39*/ 05849000
*                                                                  1168 05850000
*       /*************************************************************/ 05851000
*       /*                                                           */ 05852000
*       /*                                                   @Y30LB39*/ 05853000
*       /* ISSUE UPRINT FOR MESSAGE IDC0068I TO              @Y30LB39*/ 05854000
*       /* INFORM THE FSR CALLER OF THE NUMBER               @Y30LB39*/ 05855000
*       /* OF EXCESSIVE BACKUP COPIES THAT WILL              @Y30LB39*/ 05856000
*       /* BE ERASED.                                        @Y30LB39*/ 05857000
*       /*                                                   @Y30LB39*/ 05858000
*       /*                                                           */ 05859000
*       /*************************************************************/ 05860000
*                                                                  1169 05861000
*                                   /*                       @Y30LB39*/ 05862000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 05863000
         L     @09,DDSTRU                                          1169 05864000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1169 05865000
*       DARGSMOD=COMNMSG;           /*                       @Y30LB39*/ 05866000
         MVC   DARGSMOD(3,@09),@CC01550                            1170 05867000
*       DARGSENT=MSG0068I;          /*                       @Y30LB39*/ 05868000
         MVI   DARGSENT(@09),X'28'                                 1171 05869000
*       DARGDBP=ADDR(OVERFLOW);     /*                       @Y30LB39*/ 05870000
         LA    @07,OVERFLOW                                        1172 05871000
         ST    @07,DARGDBP(,@09)                                   1172 05872000
*       DARGILP=LENGTH(OVERFLOW);   /*                       @Y30LB39   05873000
*                                                            @Y30LB39*/ 05874000
         MVC   DARGILP(2,@09),@CH00219                             1173 05875000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   05876000
*                                                            @Y30LB39*/ 05877000
*                                                                  1174 05878000
         L     @09,@PC00001                                        1174 05879000
         ST    @09,@AL00001                                        1174 05880000
         LA    @07,@CF00115                                        1174 05881000
         ST    @07,@AL00001+4                                      1174 05882000
         LA    @07,DDSTRU                                          1174 05883000
         ST    @07,@AL00001+8                                      1174 05884000
         MVI   @AL00001+8,X'80'                                    1174 05885000
         L     @15,GDTPRT(,@09)                                    1174 05886000
         LA    @01,@AL00001                                        1174 05887000
         BALR  @14,@15                                             1174 05888000
*       /*************************************************************/ 05889000
*       /*                                                           */ 05890000
*       /*                                                   @Y30LB39*/ 05891000
*       /* PROCEED TO ERASE ALL EXCESS BACKUP COPIES         @Y30LB39*/ 05892000
*       /*                                                   @Y30LB39*/ 05893000
*       /*                                                           */ 05894000
*       /*************************************************************/ 05895000
*                                                                  1175 05896000
*                                   /*                       @Y30LB39*/ 05897000
*       DO WHILE OVERFLOW^=0;       /*                       @Y30LB39*/ 05898000
         B     @DE01175                                            1175 05899000
@DL01175 DS    0H                                                  1176 05900000
*         RECTYPE=BKUPCHAR;         /*                       @Y30LB39   05901000
*                                                            @Y30LB39*/ 05902000
*                                                                  1176 05903000
         MVC   RECTYPE(4),BKUPCHAR                                 1176 05904000
*         /***********************************************************/ 05905000
*         /*                                                         */ 05906000
*         /*                                                 @Y30LB39*/ 05907000
*         /* AFTER SETTING RECORD TYPE TO BACKUP, CALL       @Y30LB39*/ 05908000
*         /* RVVIRTN TO READ THE OLDEST BACKUP.              @Y30LB39*/ 05909000
*         /*                                                 @Y30LB39*/ 05910000
*         /*                                                         */ 05911000
*         /***********************************************************/ 05912000
*                                                                  1177 05913000
*                                   /*                       @Y30LB39*/ 05914000
*         CALL RVVIRTN;             /*                       @Y30LB39*/ 05915000
         BAL   @14,RVVIRTN                                         1177 05916000
*         RESPECIFY                                                1178 05917000
*           RTNREG RSTD;                                           1178 05918000
*         TESTRC=RTNREG;                                           1179 05919000
         LR    TESTRC,RTNREG                                       1179 05920000
*         RESPECIFY                                                1180 05921000
*           RTNREG UNRSTD;          /*                       @Y30LB39*/ 05922000
*         IF TESTRC^=0 THEN         /*                       @Y30LB39*/ 05923000
         LTR   TESTRC,TESTRC                                       1181 05924000
         BZ    @RF01181                                            1181 05925000
*           DO;                     /*                       @Y30LB39   05926000
*                                                            @Y30LB39*/ 05927000
*                                                                  1182 05928000
*             /*******************************************************/ 05929000
*             /*                                                     */ 05930000
*             /*                                             @Y30LB39*/ 05931000
*             /* RETURN CODE FROM RVVIRTN IS NOT ZERO,       @Y30LB39*/ 05932000
*             /* SO SET CONDITION CODE TO EIGHT.             @Y30LB39*/ 05933000
*             /*                                             @Y30LB39*/ 05934000
*             /*                                                     */ 05935000
*             /*******************************************************/ 05936000
*                                                                  1183 05937000
*                                   /*                       @Y30LB39*/ 05938000
*             SCRRC=LASTCC08;       /*                       @Y30LB39   05939000
*                                                            @Y30LB39*/ 05940000
*                                                                  1183 05941000
         MVI   SCRRC,X'08'                                         1183 05942000
*             /*******************************************************/ 05943000
*             /*                                                     */ 05944000
*             /*                                             @Y30LB39*/ 05945000
*             /* ISSUE UPRINT FOR MESSAGE IDC3701I           @Y30LB39*/ 05946000
*             /*                                             @Y30LB39*/ 05947000
*             /*                                                     */ 05948000
*             /*******************************************************/ 05949000
*                                                                  1184 05950000
*                                   /*                       @Y30LB39*/ 05951000
*             DARGLIST=''B;         /*                       @Y30LB39*/ 05952000
         L     @09,DDSTRU                                          1184 05953000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1184 05954000
*             DARGSMOD=COPYMSG;     /*                       @Y30LB39*/ 05955000
         MVC   DARGSMOD(3,@09),@CC01548                            1185 05956000
*             DARGSENT=MSG3701I;    /*                       @Y30LB39   05957000
*                                                            @Y30LB39*/ 05958000
         MVI   DARGSENT(@09),X'02'                                 1186 05959000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB39   05960000
*                                                            @Y30LB39*/ 05961000
*                                                                  1187 05962000
         L     @09,@PC00001                                        1187 05963000
         ST    @09,@AL00001                                        1187 05964000
         LA    @07,@CF00115                                        1187 05965000
         ST    @07,@AL00001+4                                      1187 05966000
         LA    @07,DDSTRU                                          1187 05967000
         ST    @07,@AL00001+8                                      1187 05968000
         MVI   @AL00001+8,X'80'                                    1187 05969000
         L     @15,GDTPRT(,@09)                                    1187 05970000
         LA    @01,@AL00001                                        1187 05971000
         BALR  @14,@15                                             1187 05972000
*             /*******************************************************/ 05973000
*             /*                                                     */ 05974000
*             /*                                             @Y30LB39*/ 05975000
*             /* FORCE END OF DO WHILE LOOP                  @Y30LB39*/ 05976000
*             /*                                             @Y30LB39*/ 05977000
*             /*                                                     */ 05978000
*             /*******************************************************/ 05979000
*                                                                  1188 05980000
*                                   /*                       @Y30LB39*/ 05981000
*             OVERFLOW=STOPLOOP;    /*                       @Y30LB39*/ 05982000
         MVI   OVERFLOW,X'00'                                      1188 05983000
*           END;                    /*                       @Y30LB39*/ 05984000
*         IF SCRRC=0 THEN           /*                       @Y30LB39*/ 05985000
@RF01181 CLI   SCRRC,0                                             1190 05986000
         BNE   @RF01190                                            1190 05987000
*           DO;                     /*                       @Y30LB39   05988000
*                                                            @Y30LB39*/ 05989000
*                                                                  1191 05990000
*             /*******************************************************/ 05991000
*             /*                                                     */ 05992000
*             /*                                             @Y30LB39*/ 05993000
*             /* CALL SCRCOPY TO SCRATCH OLDEST BACKUP       @Y30LB39*/ 05994000
*             /* COPY WHICH WAS JUST READ IN.                @Y30LB39*/ 05995000
*             /*                                             @Y30LB39*/ 05996000
*             /*                                                     */ 05997000
*             /*******************************************************/ 05998000
*                                                                  1192 05999000
*                                   /*                       @Y30LB39*/ 06000000
*             CALL SCRCOPY(IOERRFLG);/*                      @Y30LB39   06001000
*                                                            @Y30LB39*/ 06002000
         LA    @09,IOERRFLG                                        1192 06003000
         ST    @09,@AL00001                                        1192 06004000
         LA    @01,@AL00001                                        1192 06005000
         BAL   @14,SCRCOPY                                         1192 06006000
*             RESPECIFY                                            1193 06007000
*               RTNREG RSTD;                                       1193 06008000
*             TESTRC=RTNREG;                                       1194 06009000
         LR    TESTRC,RTNREG                                       1194 06010000
*             RESPECIFY                                            1195 06011000
*               RTNREG UNRSTD;      /*                       @Y30LB39*/ 06012000
*             IF TESTRC^=0 THEN     /*                       @Y30LB39*/ 06013000
         LTR   TESTRC,TESTRC                                       1196 06014000
         BZ    @RF01196                                            1196 06015000
*               DO;                 /*                       @Y30LB39   06016000
*                                                            @Y30LB39*/ 06017000
*                                                                  1197 06018000
*                 /***************************************************/ 06019000
*                 /*                                                 */ 06020000
*                 /*                                         @Y30LB39*/ 06021000
*                 /* IF RETURN CODE IS NOT ZERO, SET         @Y30LB39*/ 06022000
*                 /* CONDITION CODE TO EIGHT.                @Y30LB39*/ 06023000
*                 /*                                         @Y30LB39*/ 06024000
*                 /*                                                 */ 06025000
*                 /***************************************************/ 06026000
*                                                                  1198 06027000
*                                   /*                       @Y30LB39*/ 06028000
*                 SCRRC=LASTCC08;   /*                       @Y30LB39   06029000
*                                                            @Y30LB39*/ 06030000
*                                                                  1198 06031000
         MVI   SCRRC,X'08'                                         1198 06032000
*                 /***************************************************/ 06033000
*                 /*                                                 */ 06034000
*                 /*                                         @Y30LB39*/ 06035000
*                 /* IF THE RETURN CODE WAS EIGHT AND        @Y30LB39*/ 06036000
*                 /* NOT ALL OF THE EXCESS BACKUP            @Y30LB39*/ 06037000
*                 /* COPIES HAVE BEEN SCRATCHED, THEN        @Y30LB39*/ 06038000
*                 /* PREPARE TO RETURN TO CALLER AFTER       @Y30LB39*/ 06039000
*                 /* ISSUING MESSAGE IDC2078I.               @Y30LB39*/ 06040000
*                 /*                                         @Y30LB39*/ 06041000
*                 /*                                                 */ 06042000
*                 /***************************************************/ 06043000
*                                                                  1199 06044000
*                                   /*                       @Y30LB39*/ 06045000
*                 IF TESTRC=LASTCC08&OVERFLOW>0 THEN               1199 06046000
         C     TESTRC,@CF00179                                     1199 06047000
         BNE   @RF01199                                            1199 06048000
         CLI   OVERFLOW,0                                          1199 06049000
         BNH   @RF01199                                            1199 06050000
*                   DO;             /*                       @Y30LB39*/ 06051000
*                     DARGLIST=''B; /*                       @Y30LB39*/ 06052000
         L     @09,DDSTRU                                          1201 06053000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1201 06054000
*                     DARGSMOD=COMNMSG;/*                    @Y30LB39*/ 06055000
         MVC   DARGSMOD(3,@09),@CC01550                            1202 06056000
*                     DARGSENT=MSG2078I;/*                   @Y30LB39*/ 06057000
         MVI   DARGSENT(@09),X'1C'                                 1203 06058000
*                     DARGDBP=ADDR(VOLVAL);/*                @Y30LB39*/ 06059000
         L     @07,@PC00001+4                                      1204 06060000
         L     @07,FDTPTR(,@07)                                    1204 06061000
         LA    @04,VOLVAL(,@07)                                    1204 06062000
         ST    @04,DARGDBP(,@09)                                   1204 06063000
*                     DARGILP=VOLLEN;/*                      @Y30LB39   06064000
*                                                            @Y30LB39*/ 06065000
         SLR   @04,@04                                             1205 06066000
         IC    @04,VOLLEN(,@07)                                    1205 06067000
         STH   @04,DARGILP(,@09)                                   1205 06068000
*                     CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      1206 06069000
*                                                            @Y30LB39   06070000
*                                                            @Y30LB39*/ 06071000
         L     @09,@PC00001                                        1206 06072000
         ST    @09,@AL00001                                        1206 06073000
         LA    @07,@CF00115                                        1206 06074000
         ST    @07,@AL00001+4                                      1206 06075000
         LA    @07,DDSTRU                                          1206 06076000
         ST    @07,@AL00001+8                                      1206 06077000
         MVI   @AL00001+8,X'80'                                    1206 06078000
         L     @15,GDTPRT(,@09)                                    1206 06079000
         LA    @01,@AL00001                                        1206 06080000
         BALR  @14,@15                                             1206 06081000
*                   END;            /*                       @Y30LB39   06082000
*                                                            @Y30LB39*/ 06083000
*                                                                  1207 06084000
*                 /***************************************************/ 06085000
*                 /*                                                 */ 06086000
*                 /*                                         @Y30LB39*/ 06087000
*                 /* FORCE END OF DO WHILE LOOP.             @Y30LB39*/ 06088000
*                 /*                                         @Y30LB39*/ 06089000
*                 /*                                                 */ 06090000
*                 /***************************************************/ 06091000
*                                                                  1208 06092000
*                                   /*                       @Y30LB39*/ 06093000
*                 OVERFLOW=STOPLOOP;/*                       @Y30LB39*/ 06094000
@RF01199 MVI   OVERFLOW,X'00'                                      1208 06095000
*               END;                /*                       @Y30LB39   06096000
*                                                            @Y30LB39*/ 06097000
*                                                                  1209 06098000
*             /*******************************************************/ 06099000
*             /*                                                     */ 06100000
*             /*                                             @Y30LB39*/ 06101000
*             /* OLDEST BACKUP HAS BEEN SUCCESSFULLY         @Y30LB39*/ 06102000
*             /* READ AND SCRATCHED. DECREMENT THE           @Y30LB39*/ 06103000
*             /* EXCESSIVE BACKUP NUMBER AND CONTINUE        @Y30LB39*/ 06104000
*             /* IF NOT ZERO.                                @Y30LB39*/ 06105000
*             /*                                             @Y30LB39*/ 06106000
*             /*                                                     */ 06107000
*             /*******************************************************/ 06108000
*                                                                  1210 06109000
*                                   /*                       @Y30LB39*/ 06110000
*             ELSE                  /*                       @Y30LB39*/ 06111000
*               OVERFLOW=OVERFLOW-1;/*                       @Y30LB39*/ 06112000
         B     @RC01196                                            1210 06113000
@RF01196 SLR   @09,@09                                             1210 06114000
         IC    @09,OVERFLOW                                        1210 06115000
         BCTR  @09,0                                               1210 06116000
         STC   @09,OVERFLOW                                        1210 06117000
*           END;                    /*                       @Y30LB39   06118000
*                                                            @Y30LB39*/ 06119000
*                                                                  1211 06120000
@RC01196 DS    0H                                                  1212 06121000
*         /***********************************************************/ 06122000
*         /*                                                         */ 06123000
*         /*                                                 @Y30LB39*/ 06124000
*         /* THE NEXT END REPRESENTS THE END OF THE          @Y30LB39*/ 06125000
*         /* DO WHILE LOOP.                                  @Y30LB39*/ 06126000
*         /*                                                 @Y30LB39*/ 06127000
*         /*                                                         */ 06128000
*         /***********************************************************/ 06129000
*                                                                  1212 06130000
*                                   /*                       @Y30LB39*/ 06131000
*       END;                        /*                       @Y30LB39*/ 06132000
@RF01190 DS    0H                                                  1212 06133000
@DE01175 CLI   OVERFLOW,0                                          1212 06134000
         BNE   @DL01175                                            1212 06135000
*     END;                          /*                       @Y30LB39   06136000
*                                                            @Y30LB39*/ 06137000
*                                                                  1213 06138000
*   /*****************************************************************/ 06139000
*   /*                                                               */ 06140000
*   /*                                                       @Y30LB39*/ 06141000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 06142000
*   /*                                                       @Y30LB39*/ 06143000
*   /*                                                               */ 06144000
*   /*****************************************************************/ 06145000
*                                                                  1214 06146000
*                                   /*                       @Y30LB39*/ 06147000
*   REG14=RETADDR1;                 /*                       @Y30LB39   06148000
*                                                            @Y30LB39*/ 06149000
*                                                                  1214 06150000
@RF01167 L     REG14,RETADDR1                                      1214 06151000
*   /*****************************************************************/ 06152000
*   /*                                                               */ 06153000
*   /*                                                       @Y30LB39*/ 06154000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 06155000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 06156000
*   /*                                                       @Y30LB39*/ 06157000
*   /*                                                               */ 06158000
*   /*****************************************************************/ 06159000
*                                                                  1215 06160000
*                                   /*                       @Y30LB39*/ 06161000
*   RETURN CODE(SCRRC);             /*                       @Y30LB39*/ 06162000
         SLR   @15,@15                                             1215 06163000
         IC    @15,SCRRC                                           1215 06164000
@EL00013 DS    0H                                                  1215 06165000
@EF00013 DS    0H                                                  1215 06166000
@ER00013 BR    @14                                                 1215 06167000
*   END SCRRTN;                     /*                       @Y30LB39*/ 06168000
*                                                                  1217 06169000
*   /*****************************************************************/ 06170000
*   /*                                                               */ 06171000
*   /*                                                       @Y30LB39*/ 06172000
*   /* PROCEDURE NAME - RVVIRTN                              @Y30LB39*/ 06173000
*   /*                                                       @Y30LB39*/ 06174000
*   /* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO         @Y30LB39*/ 06175000
*   /* RETRIEVE THE TYPE OF RECORD REQUESTED BY THE          @Y30LB39*/ 06176000
*   /* CALLER.                                               @Y30LB39*/ 06177000
*   /* ONCE THIS DETERMINATION HAS BEEN MADE BY              @Y30LB39*/ 06178000
*   /* EXAMINING THE CHARACTER TYPE SET IN THE COPYV         @Y30LB39*/ 06179000
*   /* INTERNAL TABLE, THEN THE PARAMETER LIST IS            @Y30LB39*/ 06180000
*   /* SET UP AND MSVC IS INVOKED TO RETRIEVE THE            @Y30LB39*/ 06181000
*   /* RECORD. IF THE RECORD COULD NOT BE RETRIEVED,         @Y30LB39*/ 06182000
*   /* THEN ONE OF THE FOLLOWING MESSAGES IS ISSUED.         @Y30LB39*/ 06183000
*   /* MESSAGE IDC2080I IF BASE RECORD IS NOT READ.          @Y30LB39*/ 06184000
*   /* MESSAGE IDC3700I IF COPY RECORD NOT READ.             @Y30LB39*/ 06185000
*   /* MESSAGE IDC3701I IF BACKUP RECORD NOT READ.           @Y30LB39*/ 06186000
*   /*                                                       @Y30LB39*/ 06187000
*   /* INPUT - FUNCTION DEFINITION TABLE                     @Y30LB39*/ 06188000
*   /* COPYV INTERNAL TABLE                                  @Y30LB39*/ 06189000
*   /* DYNAMIC ARGUMENT LIST                                 @Y30LB39*/ 06190000
*   /* FORMAT OF A BASE VOLUME RECORD                        @Y30LB39*/ 06191000
*   /* AND COPY VOLUME RECORD @Y30LB399                      @Y30LB39*/ 06192000
*   /* OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE          @Y30LB39*/ 06193000
*   /* FOLLOWING RETURN CODES UPON RETURNING TO CALLER       @Y30LB39*/ 06194000
*   /* 0 - PROCESSING COMPLETED NORMALLY                     @Y30LB39*/ 06195000
*   /* AND BUFFER CONTAINS RECORD.                           @Y30LB39*/ 06196000
*   /* 4 - IF MSVC COULD NOT RETRIEVE RECORD.                @Y30LB39*/ 06197000
*   /*                                                       @Y30LB39*/ 06198000
*   /*                                                               */ 06199000
*   /*****************************************************************/ 06200000
*                                                                  1217 06201000
*RVVIRTN:                                                          1217 06202000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB39*/ 06203000
*                                                                  1217 06204000
RVVIRTN  DS    0H                                                  1218 06205000
*   /*****************************************************************/ 06206000
*   /*                                                               */ 06207000
*   /*                                                       @Y30LB39*/ 06208000
*   /* LOCAL DECLARATIONS                                    @Y30LB39*/ 06209000
*   /*                                                       @Y30LB39*/ 06210000
*   /*                                                               */ 06211000
*   /*****************************************************************/ 06212000
*                                                                  1218 06213000
*                                   /*                       @Y30LB39*/ 06214000
*   DCL                                                            1218 06215000
*     RVVIRC FIXED(8);              /* RETURN CODE           @Y30LB39*/ 06216000
*                                   /*                       @Y30LB39*/ 06217000
*                                                                  1219 06218000
*   /*****************************************************************/ 06219000
*   /*                                                               */ 06220000
*   /*                                                       @Y30LB39*/ 06221000
*   /* SAVE THE ADDRESS OF THE CALLING PROCEDURE             @Y30LB39*/ 06222000
*   /*                                                       @Y30LB39*/ 06223000
*   /*                                                               */ 06224000
*   /*****************************************************************/ 06225000
*                                                                  1219 06226000
*                                   /*                       @Y30LB39*/ 06227000
*   RETADDR3=REG14;                 /*                       @Y30LB39   06228000
*                                                            @Y30LB39*/ 06229000
*                                                                  1219 06230000
         ST    REG14,RETADDR3                                      1219 06231000
*   /*****************************************************************/ 06232000
*   /*                                                               */ 06233000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 06234000
*   /* ON CONTROL WITHIN THE COPYV FSR MODULE.               @Y30LB39*/ 06235000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 06236000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 06237000
*   /*                                                       @Y30LB39*/ 06238000
*   /*                                                               */ 06239000
*   /*****************************************************************/ 06240000
*                                                                  1220 06241000
*                                   /*                       @Y30LB39*/ 06242000
*   OLDERID2=NEWERID2;                                             1220 06243000
         L     @15,@PC00001                                        1220 06244000
         L     @15,GDTTR2(,@15)                                    1220 06245000
         MVC   @TS00001(95),NEWERID2(@15)                          1220 06246000
         MVC   OLDERID2(95,@15),@TS00001                           1220 06247000
*   NEWID2='CORV';                  /*                       @Y30LB39   06248000
*                                                            @Y30LB39*/ 06249000
*                                                                  1221 06250000
         MVC   NEWID2(4,@15),@CC01734                              1221 06251000
*   /*****************************************************************/ 06252000
*   /*                                                               */ 06253000
*   /*                                                       @Y30LB39*/ 06254000
*   /* SET THE CONDITION CODE TO ZERO.                       @Y30LB39*/ 06255000
*   /*                                                       @Y30LB39*/ 06256000
*   /*                                                               */ 06257000
*   /*****************************************************************/ 06258000
*                                                                  1222 06259000
*                                   /*                       @Y30LB39*/ 06260000
*   RVVIRC=LASTCC00;                /*                       @Y30LB39   06261000
*                                                            @Y30LB39*/ 06262000
*                                                                  1222 06263000
         MVI   RVVIRC,X'00'                                        1222 06264000
*   /*****************************************************************/ 06265000
*   /*                                                               */ 06266000
*   /*                                                       @Y30LB39*/ 06267000
*   /* INITIALIZE RVVI PARAMETER LIST FOR THE TYPE OF        @Y30LB39*/ 06268000
*   /* RECORD TO BE READ. NOTE THAT ALTHOUGH THREE           @Y30LB39*/ 06269000
*   /* TYPES OF RECORDS CAN BE READ, THAT IT IS ONLY         @Y30LB39*/ 06270000
*   /* NECESSARY TO HAVE TWO RECORD BUFFERS. ONE             @Y30LB39*/ 06271000
*   /* FOR COPY AND BACKUP TYPES AND ANOTHER FOR BASE        @Y30LB39*/ 06272000
*   /* VOLUME RECORDS.                                       @Y30LB39*/ 06273000
*   /*                                                       @Y30LB39*/ 06274000
*   /*                                                               */ 06275000
*   /*****************************************************************/ 06276000
*                                                                  1223 06277000
*                                   /*                       @Y30LB39*/ 06278000
*   RVVI=''B;                       /*                       @Y30LB39*/ 06279000
         L     @15,RVVIPTR                                         1223 06280000
         XC    RVVI(68,@15),RVVI(@15)                              1223 06281000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB39*/ 06282000
         LH    @14,RVVLEN                                          1224 06283000
         ST    @14,RVVLNGTH(,@15)                                  1224 06284000
*   RVVCODE=RVVOP;                  /*                       @Y30LB39*/ 06285000
         MVI   RVVCODE(@15),X'87'                                  1225 06286000
*   RVVOLUME=VOLVAL;                /*                       @Y30LB39*/ 06287000
         L     @14,@PC00001+4                                      1226 06288000
         L     @01,FDTPTR(,@14)                                    1226 06289000
         MVC   RVVOLUME(6,@15),VOLVAL(@01)                         1226 06290000
*   RVVSVOL=ON;                     /*                       @Y30LB39*/ 06291000
         OI    RVVSVOL(@15),B'00000001'                            1227 06292000
*   RVVRDR=ON;                      /*                       @Y30LB39*/ 06293000
         OI    RVVRDR(@15),B'10000000'                             1228 06294000
*   IF RECTYPE=BASECHAR THEN        /*                       @Y30LB39*/ 06295000
         CLC   RECTYPE(4),BASECHAR                                 1229 06296000
         BNE   @RF01229                                            1229 06297000
*     DO;                           /*                       @Y30LB39*/ 06298000
*       RVVRTBUF=BASEVPTR;          /*                       @Y30LB39*/ 06299000
         ST    BASEVPTR,RVVRTBUF(,@15)                             1231 06300000
*       RVVBUFLN=LENGTH(BASEV);     /*                       @Y30LB39   06301000
*                                                            @Y30LB39*/ 06302000
*                                                                  1232 06303000
         MVC   RVVBUFLN(2,@15),@CH01910                            1232 06304000
*       /*************************************************************/ 06305000
*       /*                                                           */ 06306000
*       /*                                                   @Y30LB39*/ 06307000
*       /* SET FLAG TO SHOW THAT A BASE VOLUME               @Y30LB39*/ 06308000
*       /* RECORD IS BEING RETRIEVED.                        @Y30LB39*/ 06309000
*       /*                                                   @Y30LB39*/ 06310000
*       /*                                                           */ 06311000
*       /*************************************************************/ 06312000
*                                                                  1233 06313000
*                                   /*                       @Y30LB39*/ 06314000
*       RVVBVRCD=ON;                /*                       @Y30LB39*/ 06315000
         OI    RVVBVRCD(@15),B'10000000'                           1233 06316000
*     END;                          /*                       @Y30LB39*/ 06317000
*   ELSE                            /*                       @Y30LB39*/ 06318000
*     DO;                           /*                       @Y30LB39*/ 06319000
         B     @RC01229                                            1235 06320000
@RF01229 DS    0H                                                  1236 06321000
*       RVVRTBUF=COPYVPTR;          /*                       @Y30LB39*/ 06322000
         L     @15,RVVIPTR                                         1236 06323000
         ST    COPYVPTR,RVVRTBUF(,@15)                             1236 06324000
*       RVVBUFLN=LENGTH(COPYV);     /*                       @Y30LB39*/ 06325000
         MVC   RVVBUFLN(2,@15),@CH01911                            1237 06326000
*       RVVCPYRC=ON;                /*                       @Y30LB39*/ 06327000
         OI    RVVCPYRC(@15),B'00100000'                           1238 06328000
*       IF RECTYPE=COPYCHAR THEN    /*                       @Y30LB39   06329000
*                                                            @Y30LB39*/ 06330000
*                                                                  1239 06331000
         CLC   RECTYPE(4),COPYCHAR                                 1239 06332000
         BNE   @RF01239                                            1239 06333000
*         /***********************************************************/ 06334000
*         /*                                                         */ 06335000
*         /*                                                 @Y30LB39*/ 06336000
*         /* SET FLAG TO SHOW THAT LATEST COPY VOLUME        @Y30LB39*/ 06337000
*         /* RECORD IS BEING RETRIEVED.                      @Y30LB39*/ 06338000
*         /*                                                 @Y30LB39*/ 06339000
*         /*                                                         */ 06340000
*         /***********************************************************/ 06341000
*                                                                  1240 06342000
*                                   /*                       @Y30LB39*/ 06343000
*         RVVLCOPY=ON;              /*                       @Y30LB39*/ 06344000
         OI    RVVLCOPY(@15),B'00100000'                           1240 06345000
*       ELSE                        /*                       @Y30LB39   06346000
*                                                            @Y30LB39*/ 06347000
*                                                                  1241 06348000
*         /***********************************************************/ 06349000
*         /*                                                         */ 06350000
*         /*                                                 @Y30LB39*/ 06351000
*         /* SET FLAG TO SHOW OLDEST BACKUP VOLUME           @Y30LB39*/ 06352000
*         /* RECORD IS BEING RETRIEVED.                      @Y30LB39*/ 06353000
*         /*                                                 @Y30LB39*/ 06354000
*         /*                                                         */ 06355000
*         /***********************************************************/ 06356000
*                                                                  1241 06357000
*                                   /*                       @Y30LB39*/ 06358000
*         RVVOBKUP=ON;              /*                       @Y30LB39*/ 06359000
         B     @RC01239                                            1241 06360000
@RF01239 L     @01,RVVIPTR                                         1241 06361000
         OI    RVVOBKUP(@01),B'01000000'                           1241 06362000
*     END;                          /*                       @Y30LB39*/ 06363000
@RC01239 DS    0H                                                  1243 06364000
*                                   /*                       @Y30LB39*/ 06365000
*                                                                  1243 06366000
*   /*****************************************************************/ 06367000
*   /*                                                               */ 06368000
*   /*                                                       @Y30LB39*/ 06369000
*   /* ISSUE USSC TO READ THE SPECIFIED INVENTORY            @Y30LB39*/ 06370000
*   /* RECORD AFTER DUMPING RVVI PARAMETER LIST              @Y30LB39*/ 06371000
*   /*                                                       @Y30LB39*/ 06372000
*   /*                                                               */ 06373000
*   /*****************************************************************/ 06374000
*                                                                  1243 06375000
*                                   /*                       @Y30LB39*/ 06376000
*   IF GDTDBG=NULLPTR THEN                                         1243 06377000
@RC01229 L     @15,@PC00001                                        1243 06378000
         L     @15,GDTDBG(,@15)                                    1243 06379000
         LTR   @15,@15                                             1243 06380000
         BZ    @RT01243                                            1243 06381000
*     ;                                                            1244 06382000
*   ELSE                                                           1245 06383000
*     DO;                                                          1245 06384000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB39*/ 06385000
         LA    DMPINDEX,DUMPLIST                                   1246 06386000
*       DMPITMNM='RVVI';                                           1247 06387000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           1247 06388000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         1247 06389000
         MVC   DMPITMNM(4,DMPINDEX),@CC01735                       1247 06390000
*       DMPITMPT=ADDR(RVVI);                                       1248 06391000
         L     @03,RVVIPTR                                         1248 06392000
         ST    @03,DMPITMPT(,DMPINDEX)                             1248 06393000
*       DMPITMLN=RVVLEN;                                           1249 06394000
         LH    @03,RVVLEN                                          1249 06395000
         STH   @03,DMPITMLN(,DMPINDEX)                             1249 06396000
*       DMPITMTP='H';                                              1250 06397000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1250 06398000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB39*/ 06399000
         AL    DMPINDEX,@CF00474                                   1251 06400000
*       DMPTRM=DMPTRMVL;                                           1252 06401000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1252 06402000
*     END;                          /*                       @Y30LB39   06403000
*                                                            @Y30LB39*/ 06404000
*   IF GDTDBG=NULLPTR THEN                                         1254 06405000
@RT01243 L     @15,@PC00001                                        1254 06406000
         L     @15,GDTDBG(,@15)                                    1254 06407000
         LTR   @15,@15                                             1254 06408000
         BZ    @RT01254                                            1254 06409000
*     ;                                                            1255 06410000
*   ELSE                                                           1256 06411000
*     CALL IDCDB010(GDTTBL,'CORR',ADDR(DUMPLIST));/*         @Y30LB39   06412000
*                                                            @Y30LB39*/ 06413000
         L     @15,@PC00001                                        1256 06414000
         ST    @15,@AL00001                                        1256 06415000
         LA    @14,@CC01736                                        1256 06416000
         ST    @14,@AL00001+4                                      1256 06417000
         LA    @14,DUMPLIST                                        1256 06418000
         ST    @14,@AFTEMPS+20                                     1256 06419000
         LA    @14,@AFTEMPS+20                                     1256 06420000
         ST    @14,@AL00001+8                                      1256 06421000
         MVI   @AL00001+8,X'80'                                    1256 06422000
         L     @15,GDTDBG(,@15)                                    1256 06423000
         LA    @01,@AL00001                                        1256 06424000
         BALR  @14,@15                                             1256 06425000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASON);/*             @Y30LB39   06426000
*                                                            @Y30LB39*/ 06427000
@RT01254 L     @02,@PC00001                                        1257 06428000
         ST    @02,@AL00001                                        1257 06429000
         LA    @15,VVIC                                            1257 06430000
         ST    @15,@AL00001+4                                      1257 06431000
         LA    @15,RVVIPTR                                         1257 06432000
         ST    @15,@AL00001+8                                      1257 06433000
         LA    @15,REASON                                          1257 06434000
         ST    @15,@AL00001+12                                     1257 06435000
         MVI   @AL00001+12,X'80'                                   1257 06436000
         L     @15,GDTSSC(,@02)                                    1257 06437000
         LA    @01,@AL00001                                        1257 06438000
         BALR  @14,@15                                             1257 06439000
*   RESPECIFY                                                      1258 06440000
*     RTNREG RSTD;                                                 1258 06441000
*   TESTRC=RTNREG;                                                 1259 06442000
         LR    TESTRC,RTNREG                                       1259 06443000
*   RESPECIFY                                                      1260 06444000
*     RTNREG UNRSTD;                /*                       @Y30LB39   06445000
*                                                            @Y30LB39*/ 06446000
*                                                                  1260 06447000
*   /*****************************************************************/ 06448000
*   /*                                                               */ 06449000
*   /*                                                       @Y30LB39*/ 06450000
*   /* IF USSC RETURN CODE IS ZERO, THEN RETURN TO           @Y30LB39*/ 06451000
*   /* CALLER OF THIS SUBROUTINE.                            @Y30LB39*/ 06452000
*   /*                                                       @Y30LB39*/ 06453000
*   /*                                                               */ 06454000
*   /*****************************************************************/ 06455000
*                                                                  1261 06456000
*                                   /*                       @Y30LB39*/ 06457000
*   IF TESTRC^=0 THEN               /*                       @Y30LB39*/ 06458000
         LTR   TESTRC,TESTRC                                       1261 06459000
         BZ    @RF01261                                            1261 06460000
*     DO;                           /*                       @Y30LB39   06461000
*                                                            @Y30LB39*/ 06462000
*                                                                  1262 06463000
*       /*************************************************************/ 06464000
*       /*                                                           */ 06465000
*       /*                                                   @Y30LB39*/ 06466000
*       /* SET CONDITION CODE TO 4 AND CALL SSCMSG           @Y30LB39*/ 06467000
*       /* TO OUTPUT THE APPROPRIATE REASON CODE             @Y30LB39*/ 06468000
*       /* MESSAGE.                                          @Y30LB39*/ 06469000
*       /*                                                   @Y30LB39*/ 06470000
*       /*                                                           */ 06471000
*       /*************************************************************/ 06472000
*                                                                  1263 06473000
*                                   /*                       @Y30LB39*/ 06474000
*       RVVIRC=LASTCC04;            /*                       @Y30LB39   06475000
*                                                            @Y30LB39*/ 06476000
         MVI   RVVIRC,X'04'                                        1263 06477000
*       CALL SSCMSG(REASON);        /*                       @Y30LB39   06478000
*                                                            @Y30LB39*/ 06479000
*                                                                  1264 06480000
         LA    @15,REASON                                          1264 06481000
         ST    @15,@AL00001                                        1264 06482000
         LA    @01,@AL00001                                        1264 06483000
         BAL   @14,SSCMSG                                          1264 06484000
*       /*************************************************************/ 06485000
*       /*                                                           */ 06486000
*       /*                                                   @Y30LB39*/ 06487000
*       /* ISSUE UPRINT FOR APPROPRIATE SECONDARY            @Y30LB39*/ 06488000
*       /* MESSAGE.                                          @Y30LB39*/ 06489000
*       /* MESSAGE IDC2080I IF BASE RECORD NOT READ          @Y30LB39*/ 06490000
*       /* MESSAGE IDC3700I IF COPY RECORD NOT READ          @Y30LB39*/ 06491000
*       /* MESSAGE IDC3701I IF BACKUP RECORD NOT TEAD        @Y30LB39*/ 06492000
*       /*                                                   @Y30LB39*/ 06493000
*       /*                                                           */ 06494000
*       /*************************************************************/ 06495000
*                                                                  1265 06496000
*                                   /*                       @Y30LB39*/ 06497000
*       DARGLIST=''B;               /*                       @Y30LB39*/ 06498000
         L     @15,DDSTRU                                          1265 06499000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1265 06500000
*       IF RECTYPE=BASECHAR THEN    /*                       @Y30LB39*/ 06501000
         CLC   RECTYPE(4),BASECHAR                                 1266 06502000
         BNE   @RF01266                                            1266 06503000
*         DO;                       /*                       @Y30LB39*/ 06504000
*           DARGSMOD=COMNMSG;       /*                       @Y30LB39*/ 06505000
         MVC   DARGSMOD(3,@15),@CC01550                            1268 06506000
*           DARGSENT=MSG2080I;      /*                       @Y30LB39*/ 06507000
         MVI   DARGSENT(@15),X'1A'                                 1269 06508000
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB39*/ 06509000
         L     @14,@PC00001+4                                      1270 06510000
         L     @14,FDTPTR(,@14)                                    1270 06511000
         LA    @03,VOLVAL(,@14)                                    1270 06512000
         ST    @03,DARGDBP(,@15)                                   1270 06513000
*           DARGILP=VOLLEN;         /*                       @Y30LB39*/ 06514000
         SLR   @03,@03                                             1271 06515000
         IC    @03,VOLLEN(,@14)                                    1271 06516000
         STH   @03,DARGILP(,@15)                                   1271 06517000
*         END;                      /*                       @Y30LB39*/ 06518000
*       ELSE                        /*                       @Y30LB39*/ 06519000
*         DO;                       /*                       @Y30LB39*/ 06520000
         B     @RC01266                                            1273 06521000
@RF01266 DS    0H                                                  1274 06522000
*           DARGSMOD=COPYMSG;       /*                       @Y30LB39*/ 06523000
         L     @15,DDSTRU                                          1274 06524000
         MVC   DARGSMOD(3,@15),@CC01548                            1274 06525000
*           IF RECTYPE=COPYCHAR THEN/*                       @Y30LB39*/ 06526000
         CLC   RECTYPE(4),COPYCHAR                                 1275 06527000
         BNE   @RF01275                                            1275 06528000
*             DARGSENT=MSG3700I;    /*                       @Y30LB39*/ 06529000
         MVI   DARGSENT(@15),X'01'                                 1276 06530000
*           ELSE                    /*                       @Y30LB39*/ 06531000
*             DARGSENT=MSG3701I;    /*                       @Y30LB39*/ 06532000
         B     @RC01275                                            1277 06533000
@RF01275 L     @01,DDSTRU                                          1277 06534000
         MVI   DARGSENT(@01),X'02'                                 1277 06535000
*         END;                      /*                       @Y30LB39   06536000
*                                                            @Y30LB39*/ 06537000
@RC01275 DS    0H                                                  1279 06538000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB39   06539000
*                                                            @Y30LB39*/ 06540000
@RC01266 L     @15,@PC00001                                        1279 06541000
         ST    @15,@AL00001                                        1279 06542000
         LA    @14,@CF00115                                        1279 06543000
         ST    @14,@AL00001+4                                      1279 06544000
         LA    @14,DDSTRU                                          1279 06545000
         ST    @14,@AL00001+8                                      1279 06546000
         MVI   @AL00001+8,X'80'                                    1279 06547000
         L     @15,GDTPRT(,@15)                                    1279 06548000
         LA    @01,@AL00001                                        1279 06549000
         BALR  @14,@15                                             1279 06550000
*     END;                          /*                       @Y30LB39   06551000
*                                                            @Y30LB39*/ 06552000
*                                                                  1280 06553000
*   /*****************************************************************/ 06554000
*   /*                                                               */ 06555000
*   /*                                                       @Y30LB39*/ 06556000
*   /* RESTORE THE ADDRESS OF THE CALLING PROCEDURE          @Y30LB39*/ 06557000
*   /*                                                       @Y30LB39*/ 06558000
*   /*                                                               */ 06559000
*   /*****************************************************************/ 06560000
*                                                                  1281 06561000
*                                   /*                       @Y30LB39*/ 06562000
*   REG14=RETADDR3;                 /*                       @Y30LB39   06563000
*                                                            @Y30LB39*/ 06564000
*                                                                  1281 06565000
@RF01261 L     REG14,RETADDR3                                      1281 06566000
*   /*****************************************************************/ 06567000
*   /*                                                               */ 06568000
*   /*                                                       @Y30LB39*/ 06569000
*   /* RETURN TO CALLER WITH REGISTER 15                     @Y30LB39*/ 06570000
*   /* CONTAINING THE RETURN CODE.                           @Y30LB39*/ 06571000
*   /*                                                       @Y30LB39*/ 06572000
*   /*                                                               */ 06573000
*   /*****************************************************************/ 06574000
*                                                                  1282 06575000
*                                   /*                       @Y30LB39*/ 06576000
*   RETURN CODE(RVVIRC);            /*                       @Y30LB39*/ 06577000
         SLR   @15,@15                                             1282 06578000
         IC    @15,RVVIRC                                          1282 06579000
@EL00014 DS    0H                                                  1282 06580000
@EF00014 DS    0H                                                  1282 06581000
@ER00014 BR    @14                                                 1282 06582000
*   END RVVIRTN;                    /*                       @Y30LB39*/ 06583000
*                                                                  1284 06584000
*   /*****************************************************************/ 06585000
*   /*                                                               */ 06586000
*   /*                                                       @Y30LB39*/ 06587000
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/ 06588000
*   /* CHECK CARTRIDGE SERIAL NUMBERS.                       @Y30LB39*/ 06589000
*   /*                                                       @Y30LB39*/ 06590000
*   /*                                                               */ 06591000
*   /*****************************************************************/ 06592000
*                                                                  1284 06593000
*                                   /*                       @Y30LB39*/ 06594000
*/****************************************************************** */ 06595000
*/*                                                          @Y30LB32*/ 06596000
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/ 06597000
*/*                                                          @Y30LB32*/ 06598000
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/ 06599000
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/ 06600000
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/ 06601000
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/ 06602000
*/*             CHARACTER                                    @Y30LB32*/ 06603000
*/*                                                          @Y30LB32*/ 06604000
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/ 06605000
*/*                                                          @Y30LB32*/ 06606000
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/ 06607000
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/ 06608000
*/*                                                          @Y30LB32*/ 06609000
*/********************************************************************/ 06610000
*                                                                  1284 06611000
*CKCSNLEN:                          /*                       @Y30LB32*/ 06612000
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/ 06613000
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/ 06614000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/ 06615000
*                                                                  1284 06616000
CKCSNLEN MVC   @PC00015(8),0(@01)                                  1284 06617000
*   /*****************************************************************/ 06618000
*   /*                                                               */ 06619000
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/ 06620000
*   /*                                                               */ 06621000
*   /*****************************************************************/ 06622000
*                                                                  1285 06623000
*   DCL                                                            1285 06624000
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/ 06625000
*   DCL                                                            1286 06626000
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/ 06627000
*   DCL                                                            1287 06628000
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/ 06629000
*   DCL                                                            1288 06630000
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/ 06631000
*   DCL                                                            1289 06632000
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/ 06633000
*   DCL                                                            1290 06634000
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/ 06635000
*   DCL                                                            1291 06636000
*     CKCOND FIXED(15);                                            1291 06637000
*                                                                  1291 06638000
*   /*****************************************************************/ 06639000
*   /*                                                               */ 06640000
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/ 06641000
*   /*                                                               */ 06642000
*   /*****************************************************************/ 06643000
*                                                                  1292 06644000
*   DCL                                                            1292 06645000
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32   06646000
*                                      CSN                   @Y30LB32*/ 06647000
*   DCL                                                            1293 06648000
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32   06649000
*                                      OF CSN AGAINST        @Y30LB32*/ 06650000
*   DCL                                                            1294 06651000
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/ 06652000
*   DCL                                                            1295 06653000
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/ 06654000
*                                                                  1296 06655000
*   /*****************************************************************/ 06656000
*   /*                                                               */ 06657000
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/ 06658000
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/ 06659000
*   /*                                                               */ 06660000
*   /*****************************************************************/ 06661000
*                                                                  1296 06662000
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/ 06663000
         LR    CKRETPTR,REG14                                      1296 06664000
*   OLDERID2=NEWERID2;                                             1297 06665000
         L     @02,@PC00001                                        1297 06666000
         L     @02,GDTTR2(,@02)                                    1297 06667000
         MVC   @TS00001(95),NEWERID2(@02)                          1297 06668000
         MVC   OLDERID2(95,@02),@TS00001                           1297 06669000
*   NEWID2='CKLN';                  /*                       @Y30LB32*/ 06670000
*                                                                  1298 06671000
         MVC   NEWID2(4,@02),@CC01755                              1298 06672000
*   /*****************************************************************/ 06673000
*   /*                                                               */ 06674000
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/ 06675000
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/ 06676000
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/ 06677000
*   /*                                                               */ 06678000
*   /*****************************************************************/ 06679000
*                                                                  1299 06680000
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/ 06681000
         L     CKSAVPTR,DDSTRU                                     1299 06682000
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/ 06683000
         LA    @02,CKPRTTAB                                        1300 06684000
         ST    @02,DDSTRU                                          1300 06685000
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/ 06686000
         XC    CKPRTTAB(20),CKPRTTAB                               1301 06687000
*   CKCOND=''B;                     /*                       @Y30LB32*/ 06688000
*                                                                  1302 06689000
         SLR   CKCOND,CKCOND                                       1302 06690000
*   /*****************************************************************/ 06691000
*   /*                                                               */ 06692000
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/ 06693000
*   /* OR MORE                                               @Y30LB32*/ 06694000
*   /*                                                               */ 06695000
*   /*****************************************************************/ 06696000
*                                                                  1303 06697000
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/ 06698000
*                                                                  1303 06699000
         L     @02,@PC00015+4                                      1303 06700000
         CLI   CKLENGTH(@02),11                                    1303 06701000
         BL    @RF01303                                            1303 06702000
*     /***************************************************************/ 06703000
*     /*                                                             */ 06704000
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/ 06705000
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/ 06706000
*     /* CHARACTER                                           @Y30LB32*/ 06707000
*     /*                                                             */ 06708000
*     /***************************************************************/ 06709000
*                                                                  1304 06710000
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/ 06711000
         CLI   CKLENGTH(@02),11                                    1304 06712000
         BNE   @RF01304                                            1304 06713000
*       DO;                         /*                       @Y30LB32*/ 06714000
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/ 06715000
         MVI   CKCSNADJ+3,C' '                                     1306 06716000
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/ 06717000
         L     @02,@PC00015                                        1307 06718000
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@02)                       1307 06719000
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/ 06720000
         MVC   CKCSNVAL+3(9,@02),CKCSNADJ+3                        1308 06721000
*       END;                        /*                       @Y30LB32*/ 06722000
*     ELSE                                                         1310 06723000
*       ;                           /*                       @Y30LB32*/ 06724000
*                                                                  1310 06725000
@RF01304 DS    0H                                                  1311 06726000
*   /*****************************************************************/ 06727000
*   /*                                                               */ 06728000
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/ 06729000
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/ 06730000
*   /*                                                               */ 06731000
*   /*****************************************************************/ 06732000
*                                                                  1311 06733000
*   ELSE                            /*                       @Y30LB32*/ 06734000
*     DO;                           /*                       @Y30LB32*/ 06735000
         B     @RC01303                                            1311 06736000
@RF01303 DS    0H                                                  1312 06737000
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/ 06738000
         L     @02,DDSTRU                                          1312 06739000
         MVC   DARGSMOD(3,@02),@CC01550                            1312 06740000
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/ 06741000
         MVI   DARGSENT(@02),X'01'                                 1313 06742000
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/ 06743000
         L     @15,@PC00015                                        1314 06744000
         ST    @15,DARGDBP(,@02)                                   1314 06745000
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/ 06746000
         MVC   DARGILP(2,@02),@CH00567                             1315 06747000
*       DARGRETP=''B;               /*                       @Y30LB32*/ 06748000
         SLR   @15,@15                                             1316 06749000
         ST    @15,DARGRETP(,@02)                                  1316 06750000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 06751000
         L     @02,@PC00001                                        1317 06752000
         ST    @02,@AL00001                                        1317 06753000
         LA    @15,@CF00115                                        1317 06754000
         ST    @15,@AL00001+4                                      1317 06755000
         LA    @15,DDSTRU                                          1317 06756000
         ST    @15,@AL00001+8                                      1317 06757000
         MVI   @AL00001+8,X'80'                                    1317 06758000
         L     @15,GDTPRT(,@02)                                    1317 06759000
         LA    @01,@AL00001                                        1317 06760000
         BALR  @14,@15                                             1317 06761000
*       CKCOND=4;                   /*                       @Y30LB32*/ 06762000
         LA    CKCOND,4                                            1318 06763000
*     END;                          /*                       @Y30LB32*/ 06764000
*                                                                  1319 06765000
*   /*****************************************************************/ 06766000
*   /*                                                               */ 06767000
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/ 06768000
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/ 06769000
*   /*                                                               */ 06770000
*   /*****************************************************************/ 06771000
*                                                                  1320 06772000
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/ 06773000
@RC01303 ST    CKSAVPTR,DDSTRU                                     1320 06774000
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/ 06775000
         LR    REG14,CKRETPTR                                      1321 06776000
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/ 06777000
         LR    @15,CKCOND                                          1322 06778000
@EL00015 DS    0H                                                  1322 06779000
@EF00015 DS    0H                                                  1322 06780000
@ER00015 BR    @14                                                 1322 06781000
*   END CKCSNLEN;                   /*                       @Y30LB32*/ 06782000
*                                                                  1324 06783000
*   /*****************************************************************/ 06784000
*   /*                                                               */ 06785000
*   /*                                                       @Y30LB39*/ 06786000
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/ 06787000
*   /* EJECT AN INACTIVE VOLUME FROM LIBRARY.                @Y30LB39*/ 06788000
*   /*                                                       @Y30LB39*/ 06789000
*   /*                                                               */ 06790000
*   /*****************************************************************/ 06791000
*                                                                  1324 06792000
*                                   /*                       @Y30LB39*/ 06793000
*/********************************************************************/ 06794000
*/*                                                          @Y30LB38*/ 06795000
*/*     PROCEDURE NAME - VOLEXIT                             @Y30LB38*/ 06796000
*/*                                                          @Y30LB38*/ 06797000
*/*     FUNCTION - REMOVES A VOLUME FROM THE MSF.            @Y30LB38*/ 06798000
*/*                IF THE VOLUME IS EJECTED SUCCESSFULLY,    @Y30LB38*/ 06799000
*/*                ISSUES MESSAGE IDC0085I TO SYSPRINT AND   @Y30LB38*/ 06800000
*/*                MESSAGE IDC083E TO THE OPERATOR.  IF THE  @Y30LB38*/ 06801000
*/*                VOLUME IS NOT EJECTED SUCCESSFULLY, AN    @Y30LB38*/ 06802000
*/*                ERROR MESSAGE IS ISSUED VIA SSCMSG        @Y30LB38*/ 06803000
*/*                PROCEDURE AND MESSAGE IDC2084I IS ISSUED  @Y30LB38*/ 06804000
*/*                TO SYSPRINT.                              @Y30LB38*/ 06805000
*/*                                                          @Y30LB38*/ 06806000
*/*     INPUT - THE FOLLOWING POSITIONAL PARAMETERS ARE      @Y30LB38*/ 06807000
*/*             PASSED AS INPUT:                             @Y30LB38*/ 06808000
*/*             ARG1 = CSN OF FIRST VOLUME CARTRIDGE         @Y30LB38*/ 06809000
*/*             ARG2 = VOLUME SERIAL NUMBER                  @Y30LB38*/ 06810000
*/*             ARG3 = VVI ERROR FLAG                        @Y30LB38*/ 06811000
*/*             ARG4 = RETAIN RECORD FLAG                    @Y30LB38*/ 06812000
*/*             ARG5 = VOLUME STORAGE LOCATION               @Y30LB38*/ 06813000
*/*                                                          @Y30LB38*/ 06814000
*/*     OUTPUT - RETURN CODE IN REG15                        @Y30LB38*/ 06815000
*/*              REG15 = 00 CARTRIDGES EJECTED SUCCESSFULLY  @Y30LB38*/ 06816000
*/*              REG15 = 04 CARTRIDGES NOT EJECTED           @Y30LB38*/ 06817000
*/*                         SUCCESSFULLY                     @Y30LB38*/ 06818000
*/*              REG15 = 08 SECOND CARTRIDGE NOT EJECTED     @Y30LB38*/ 06819000
*/*                         SUCCESSFULLY                     @Y30LB38*/ 06820000
*/*                                                          @Y30LB38*/ 06821000
*/********************************************************************/ 06822000
*                                                                  1324 06823000
*VOLEXIT:                                                          1324 06824000
*   PROCEDURE(VECSN1,               /* CART SERIAL NUMBER    @Y30LB38*/ 06825000
*       VEVOLUME,                   /* VOL SERIAL NUMBER     @Y30LB38*/ 06826000
*       VEVVIERR,                   /* VVI ERROR FLAG        @Y30LB38*/ 06827000
*       VERECFLG,                   /* RETAIN RECORD FLAG    @Y30LB38*/ 06828000
*       VEVOLLOC)                   /* VOL STORAGE LOC       @Y30LB38*/ 06829000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB38*/ 06830000
VOLEXIT  MVC   @PC00016(20),0(@01)                                 1324 06831000
*                                                                  1325 06832000
*/********************************************************************/ 06833000
*/*          MACCOMP  Y30LB22          SC1DR/BL0019          @Y30LB22*/ 06834000
*/*          MACSTAT  Y30LB22          74/170/341040         @Y30LB22*/ 06835000
*/*                                                                  */ 06836000
*/*          NAME: IEZMCRTE                                  @Y30LB22*/ 06837000
*/*                                                                  */ 06838000
*/*          FUNCTION:                                       @Y30LB22*/ 06839000
*/*                  MAPS THE REQUEST BLOCK                  @Y30LB22*/ 06840000
*/*                  EXTENSION WHICH IS USED TO PASS         @Y30LB22*/ 06841000
*/*                  ADDITIONAL INFORMATION TO MASS          @Y30LB22*/ 06842000
*/*                  STORAGE VOLUME  CONTROL DURING          @Y30LB22*/ 06843000
*/*                  AN MOVE CARTRIDGE REQUEST.              @Y30LB22*/ 06844000
*/*                                                                  */ 06845000
*/*          STATUS:  CHANGE LEVEL = 0                       #Y30LB22*/ 06846000
*/*                                                          @Y30LB22*/ 06847000
*/********************************************************************/ 06848000
*                                                                  1325 06849000
*   /*****************************************************************/ 06850000
*   /*                                                               */ 06851000
*   /* CONSTANTS FOR IEZMCRTE                                @Y30LB22*/ 06852000
*   /*                                                               */ 06853000
*   /*****************************************************************/ 06854000
*                                                                  1325 06855000
*   DCL                                                            1325 06856000
*     MCRLEN FIXED(15) INIT(LENGTH(MCRTE));/* LENGTH         @Y30LB22   06857000
*                                      OF EXTENSION          @Y30LB22*/ 06858000
*                                                                  1325 06859000
*   /*****************************************************************/ 06860000
*   /*                                                               */ 06861000
*   /* MAPPING MACRO DECLARES                                @Y30LB22*/ 06862000
*   /*                                                               */ 06863000
*   /*****************************************************************/ 06864000
*                                                                  1326 06865000
*   DCL                                                            1326 06866000
*     1 MCRTE BASED(MCRTEPTR) BDY(WORD),                           1326 06867000
*      2 MCRLNGTH FIXED(31),        /* LENGTH OF EXTENSION   @Y30LB22*/ 06868000
*      2 MCRLOC CHAR(30),           /* LOCATION/DESTINATION OF VOL 1326 06869000
*                                      AFTER EJECTION        @Y30LB22*/ 06870000
*      2 MCRFLAGA BIT(8),           /* SPECIFICATION FLAGS   @Y30LB22*/ 06871000
*       3 MCRSPLOC BIT(1),          /* MCRLOC IS SPECIFIED   @Y30LB22*/ 06872000
*       3 * BIT(7),                 /* UNUSED                @Y30LB22*/ 06873000
*      2 MCRBLNK1 CHAR(1),          /* BLANK                 @Y30LB22*/ 06874000
*      2 MCRFLAGB BIT(32),          /* INDICATOR FLAGS       @Y30LB22*/ 06875000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 06876000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 06877000
*       3 MCRTYPE BIT(8),           /* MOVE CART. TYPE FLAG  @Y30LB22*/ 06878000
*        4 MCRREC BIT(1),           /* BIT 0=1, REC RETAIN   @Y30LB22   06879000
*                                      BIT 0=0, REC DELETE   @Y30LB22*/ 06880000
*        4 * BIT(7),                /* UNUSED                @Y30LB22*/ 06881000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 06882000
*      2 * CHAR(4);                 /* UNUSED                @Y30LB22*/ 06883000
*                                                                  1327 06884000
*   /*****************************************************************/ 06885000
*   /*                                                               */ 06886000
*   /* DECLARATIONS FOR VOLEXIT                              @Y30LB38*/ 06887000
*   /*                                                               */ 06888000
*   /*****************************************************************/ 06889000
*                                                                  1327 06890000
*   DCL                                                            1327 06891000
*     VEDDSTRU POINTER(31);         /* DARGLIST POINTER      @Y30LB38*/ 06892000
*   DCL                                                            1328 06893000
*     MCLSTPTR POINTER(31);         /* BASE PTR FOR MCLIST@Y30LB38   */ 06894000
*   DCL                                                            1329 06895000
*     MCRTEPTR POINTER(31);         /* PTR FOR MCLIST EXT    @Y30LB38*/ 06896000
*   DCL                                                            1330 06897000
*     VERETADR POINTER(31);         /* RETURN ADDR           @Y30LB38*/ 06898000
*   DCL                                                            1331 06899000
*     VEMSGPTR POINTER(31);         /* MESSAGE PTR AREA      @Y30LB38*/ 06900000
*   DCL                                                            1332 06901000
*     VEWTOPTR POINTER(31);         /* WTO MSG POINTER       @Y30LB38*/ 06902000
*   DCL                                                            1333 06903000
*     VECOND FIXED(15);             /* CONDITION CODE        @Y30LB38*/ 06904000
*   DCL                                                            1334 06905000
*     VEWTOLEN FIXED(15);           /* LENGTH OF WTO MSG     @Y30LB38*/ 06906000
*   DCL                                                            1335 06907000
*     VERESNCD FIXED(31);           /* RSN CODE FOR USSC     @Y30LB38*/ 06908000
*   DCL                                                            1336 06909000
*     VEECB CHAR(1);                /* ECB RETURN AREA       @Y30LB38*/ 06910000
*                                                                  1336 06911000
*   /*****************************************************************/ 06912000
*   /*                                                               */ 06913000
*   /* PARM LIST FOR UPRINT MACRO WITH MULTIPLE INSERTS      @Y30LB38*/ 06914000
*   /*                                                               */ 06915000
*   /*****************************************************************/ 06916000
*                                                                  1337 06917000
*   DCL                                                            1337 06918000
*     VELIST CHAR(LENGTH(DARGLIST)+(4*LENGTH(DARGARY)));/*   @Y30LB38*/ 06919000
*                                                                  1337 06920000
*   /*****************************************************************/ 06921000
*   /*                                                               */ 06922000
*   /* POSITIONAL PARMS FOR INPUT PARMAMETERS                @Y30LB38*/ 06923000
*   /*                                                               */ 06924000
*   /*****************************************************************/ 06925000
*                                                                  1338 06926000
*   DCL                                                            1338 06927000
*     VECSN1 CHAR(12);              /* CART SERIAL NUM       @Y30LB38*/ 06928000
*   DCL                                                            1339 06929000
*     VEVOLUME CHAR(6);             /* VOL SER NUMBER        @Y30LB38*/ 06930000
*   DCL                                                            1340 06931000
*     VEVVIERR BIT(1);              /* VVI ERROR FLAG        @Y30LB38*/ 06932000
*   DCL                                                            1341 06933000
*     VERECFLG BIT(1);              /* RETAIN REC FLAG       @Y30LB38*/ 06934000
*   DCL                                                            1342 06935000
*     VEVOLLOC CHAR(30);            /* VOL LOCATION          @Y30LB38*/ 06936000
*   DCL                                                            1343 06937000
*     VEWTOMSG CHAR(72);            /* UWTO MSG AREA         @Y30LB38*/ 06938000
*                                                                  1343 06939000
*   /*****************************************************************/ 06940000
*   /*                                                               */ 06941000
*   /* INVOKE LIST FORM OF MCLIST MACRO                      @Y30LB38*/ 06942000
*   /*                                                               */ 06943000
*   /*****************************************************************/ 06944000
*                                                                  1344 06945000
*   DCL                                                            1344 06946000
*     MCR1 REG(1) PTR;              /* ADDRESS OF REQUEST BLOCK    1344 06947000
*                                                            @Y30LB02*/ 06948000
*                                                                  1344 06949000
*   /*****************************************************************/ 06950000
*   /*                                                               */ 06951000
*   /* ********************************************************      */ 06952000
*   /*                                                       @Y30LB02*/ 06953000
*   /* MACMEAN MSSC MOVE CARTRIDGE MACRO                     @Y30LB02*/ 06954000
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/ 06955000
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/ 06956000
*   /* ********************************************************      */ 06957000
*   /*                                                       @Y30LB02*/ 06958000
*   /*                                                               */ 06959000
*   /*****************************************************************/ 06960000
*                                                                  1345 06961000
*   DCL                                                            1345 06962000
*     1 MCLIST BASED(MCLSTPTR),     /* MOVE CARTRIDGE REQUEST BLOCK     06963000
*                                                            @Y30LB02*/ 06964000
*      2 MCRTLEN FIXED(31),         /* LENGTH OF MOVE CARTRIDGE    1345 06965000
*                                      REQUEST BLK = 30 HEX  @Y30LB02*/ 06966000
*      2 MCRTOPCD FIXED(8),         /* MOVE CARTRIDGE OPCODE = 0E HEX   06967000
*                                                            @Y30LB02*/ 06968000
*      2 MCRTRES1 CHAR(1),          /* RESERVED AND ZERO     @Y30LB02*/ 06969000
*      2 MCRTFLG BIT(8),            /* ONE BYTE FLAGS AREA   @Y30LB02*/ 06970000
*       3 * BIT(2),                 /* RESERVED AND MUST BE ZERO   1345 06971000
*                                                            @Y30LB02*/ 06972000
*       3 MCRTTRAN BIT(1),          /* SOURCE WITH TRANSIENT CSN1  1345 06973000
*                                      SPECD                 @Y30LB02*/ 06974000
*       3 MCRTSCT BIT(1),           /* SOURCE WITH SCRATCH ATTRIBUTE    06975000
*                                                            @Y30LB02*/ 06976000
*       3 * BIT(4),                 /* RESERVED AND MUST BE ZERO   1345 06977000
*                                                            @Y30LB02*/ 06978000
*      2 MCRTLIB BIT(8),            /* BYTE-LIBID            @Y30LB02*/ 06979000
*       3 * BIT(6),                 /* RESERVED AND MUST BE ZERO   1345 06980000
*                                                            @Y30LB02*/ 06981000
*       3 MCRTLD BIT(2),            /* BINARY NUMBER ZERO TO THREE 1345 06982000
*                                                            @Y30LB02*/ 06983000
*      2 MCRTRES2 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/ 06984000
*      2 MCRTRES3 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/ 06985000
*      2 MCRTCSN CHAR(12),          /* CART SER NO           @Y30LB02*/ 06986000
*      2 MCRTRES4 CHAR(2),          /* RESERVED              @Y30LB02*/ 06987000
*      2 MCRTASID CHAR(2),          /* ASID AREA             @Y30LB02*/ 06988000
*      2 MCRTECB FIXED(31),         /* EVENT CONTROL BLOCK ADDRESS 1345 06989000
*                                                            @Y30LB02*/ 06990000
*      2 MCRTVEXT FIXED(31);        /* MSVC EXTENSION AREA   @Y30LB02*/ 06991000
*                                                                  1345 06992000
*   /*****************************************************************/ 06993000
*   /*                                                               */ 06994000
*   /*                                                       @Y30LB38*/ 06995000
*   /*                                                               */ 06996000
*   /*****************************************************************/ 06997000
*                                                                  1346 06998000
*                                                                  1346 06999000
*   /*****************************************************************/ 07000000
*   /*                                                               */ 07001000
*   /* DECLARE WORK AREA FOR MC LIST AND EXTENSION LIST      @Y30LB38*/ 07002000
*   /*                                                               */ 07003000
*   /*****************************************************************/ 07004000
*                                                                  1346 07005000
*   DCL                                                            1346 07006000
*     VEMCLIST CHAR(LENGTH(MCLIST));/*                       @Y30LB38*/ 07007000
*   DCL                                                            1347 07008000
*     VEEXLIST CHAR(LENGTH(MCRTE)); /*                       @Y30LB38*/ 07009000
*                                                                  1347 07010000
*   /*****************************************************************/ 07011000
*   /*                                                               */ 07012000
*   /* DECLARE WORK AREA FOR JOBNAME AND STEPNAME USED BY    @Y30LB38*/ 07013000
*   /* USYSINFO MACRO                                        @Y30LB38*/ 07014000
*   /*                                                               */ 07015000
*   /*****************************************************************/ 07016000
*                                                                  1348 07017000
*   DCL                                                            1348 07018000
*     1 VESYSIN CHAR(16),                                          1348 07019000
*      2 VEJOBNAM CHAR(8),                                         1348 07020000
*      2 VESTEPNM CHAR(8);          /*                       @Y30LB38*/ 07021000
*                                                                  1348 07022000
*   /*****************************************************************/ 07023000
*   /*                                                               */ 07024000
*   /* DECLARE ROUTING AND DESCRIPTOR CODE AREAS FOR UWTO    @Y30LB38*/ 07025000
*   /*                                                               */ 07026000
*   /*****************************************************************/ 07027000
*                                                                  1349 07028000
*   DCL                                                            1349 07029000
*     1 VEROUTCD BIT(16),                                          1349 07030000
*      2 VECD1 BIT(1),                                             1349 07031000
*      2 * BIT(15);                 /*                       @Y30LB38*/ 07032000
*   DCL                                                            1350 07033000
*     1 VEDESCCD BIT(16),                                          1350 07034000
*      2 * BIT(2),                                                 1350 07035000
*      2 VEDESC3 BIT(1),                                           1350 07036000
*      2 * BIT(12);                 /*                       @Y30LB38*/ 07037000
*                                                                  1350 07038000
*   /*****************************************************************/ 07039000
*   /*                                                               */ 07040000
*   /* DECLARE WORK AREA FOR UDUMP MACRO                     @Y30LB38*/ 07041000
*   /*                                                               */ 07042000
*   /*****************************************************************/ 07043000
*                                                                  1351 07044000
*   DCL                                                            1351 07045000
*     VEDMPSTG CHAR(17);            /*                       @Y30LB38*/ 07046000
*                                                                  1351 07047000
*   /*****************************************************************/ 07048000
*   /*                                                               */ 07049000
*   /* DECLARE STATIC MODULE ID FOR MESSAGES USED BY         @Y30LB38*/ 07050000
*   /* COMMON FSR'S                                          @Y30LB38*/ 07051000
*   /*                                                               */ 07052000
*   /*****************************************************************/ 07053000
*                                                                  1352 07054000
*   DCL                                                            1352 07055000
*     VECMOMSG CHAR(3) CONSTANT('CM0');/*                    @Y30LB38*/ 07056000
*   DCL                                                            1353 07057000
*     MSG0085I PTR(8) CONSTANT(21); /* MSG ENTRY NUMBER      @Y30LB38*/ 07058000
*   DCL                                                            1354 07059000
*     MSG2084I PTR(8) CONSTANT(22); /* MSG ENTRY NUMBER      @Y30LB38*/ 07060000
*   DCL                                                            1355 07061000
*     MSG083E PTR(8) CONSTANT(23);  /* MSG ENTRY NUMBER      @Y30LB38*/ 07062000
*                                                                  1355 07063000
*   /*****************************************************************/ 07064000
*   /*                                                               */ 07065000
*   /* VOLEXIT CONSTANTS                                     @Y30LB38*/ 07066000
*   /*                                                               */ 07067000
*   /*****************************************************************/ 07068000
*                                                                  1356 07069000
*   DCL                                                            1356 07070000
*     VEECBLEN FIXED(31) CONSTANT(4);/* LENGTH OF ECB        @Y30LB38*/ 07071000
*                                                                  1357 07072000
*   /*****************************************************************/ 07073000
*   /*                                                               */ 07074000
*   /* SAVE RETURN ADDRESS AND INITIALIZE PARAMETER LISTS    @Y30LB38*/ 07075000
*   /*                                                               */ 07076000
*   /*****************************************************************/ 07077000
*                                                                  1357 07078000
*   VERETADR=REG14;                 /*                       @Y30LB38*/ 07079000
         LR    VERETADR,REG14                                      1357 07080000
*   OLDERID2=NEWERID2;                                             1358 07081000
         L     @02,@PC00001                                        1358 07082000
         L     @02,GDTTR2(,@02)                                    1358 07083000
         MVC   @TS00001(95),NEWERID2(@02)                          1358 07084000
         MVC   OLDERID2(95,@02),@TS00001                           1358 07085000
*   NEWID2='VESR';                  /*                       @Y30LB38*/ 07086000
         MVC   NEWID2(4,@02),@CC01836                              1359 07087000
*   VELIST=''B;                     /*                       @Y30LB38*/ 07088000
         XC    VELIST(52),VELIST                                   1360 07089000
*   VEDDSTRU=ADDR(VELIST);          /*                       @Y30LB38*/ 07090000
         LA    @02,VELIST                                          1361 07091000
         ST    @02,VEDDSTRU                                        1361 07092000
*   MCLSTPTR=ADDR(VEMCLIST);        /*                       @Y30LB38*/ 07093000
         LA    @02,VEMCLIST                                        1362 07094000
         ST    @02,MCLSTPTR                                        1362 07095000
*   MCRTEPTR=ADDR(VEEXLIST);        /*                       @Y30LB38*/ 07096000
         LA    MCRTEPTR,VEEXLIST                                   1363 07097000
*   VEWTOPTR=ADDR(VEWTOMSG);        /*                       @Y30LB38*/ 07098000
         LA    @15,VEWTOMSG                                        1364 07099000
         ST    @15,VEWTOPTR                                        1364 07100000
*   MCLIST=''B;                     /*                       @Y30LB38*/ 07101000
         XC    MCLIST(48,@02),MCLIST(@02)                          1365 07102000
*   MCRTE=''B;                      /*                       @Y30LB38*/ 07103000
         XC    MCRTE(44,MCRTEPTR),MCRTE(MCRTEPTR)                  1366 07104000
*   VECOND='0'X;                    /*                       @Y30LB38*/ 07105000
*                                                                  1367 07106000
         SLR   VECOND,VECOND                                       1367 07107000
*   /*****************************************************************/ 07108000
*   /*                                                               */ 07109000
*   /* INITIALIZE MCLIST FOR USSC MACRO                      @Y30LB38*/ 07110000
*   /*                                                               */ 07111000
*   /*****************************************************************/ 07112000
*                                                                  1368 07113000
*   MCRLNGTH=MCRLEN;                /*                       @Y30LB38*/ 07114000
         LH    @15,MCRLEN                                          1368 07115000
         ST    @15,MCRLNGTH(,MCRTEPTR)                             1368 07116000
*   MCRTCSN=VECSN1;                 /*                       @Y30LB38*/ 07117000
         L     @15,@PC00016                                        1369 07118000
         MVC   MCRTCSN(12,@02),VECSN1(@15)                         1369 07119000
*   MCRTTRAN=ON;                    /*                       @Y30LB38*/ 07120000
         OI    MCRTTRAN(@02),B'00100000'                           1370 07121000
*   IF VERECFLG=ON THEN                                            1371 07122000
         L     @02,@PC00016+12                                     1371 07123000
         TM    VERECFLG(@02),B'10000000'                           1371 07124000
         BNO   @RF01371                                            1371 07125000
*     MCRREC=ON;                    /*                       @Y30LB38*/ 07126000
         OI    MCRREC(MCRTEPTR),B'10000000'                        1372 07127000
*   MCRLOC=VEVOLLOC;                /*                       @Y30LB38*/ 07128000
@RF01371 L     @02,@PC00016+16                                     1373 07129000
         MVC   MCRLOC(30,MCRTEPTR),VEVOLLOC(@02)                   1373 07130000
*   MCRTVEXT=MCRTEPTR;              /*                       @Y30LB38*/ 07131000
         L     @02,MCLSTPTR                                        1374 07132000
         ST    MCRTEPTR,MCRTVEXT(,@02)                             1374 07133000
*   MCRSPLOC=ON;                    /*                       @Y30LB38*/ 07134000
*                                                                  1375 07135000
         OI    MCRSPLOC(MCRTEPTR),B'10000000'                      1375 07136000
*   /*****************************************************************/ 07137000
*   /*                                                               */ 07138000
*   /* TAKE UDUMP OF MOVE VOLUME PARAMETER LIST (MCLIST)     @Y30LB38*/ 07139000
*   /*                                                               */ 07140000
*   /*****************************************************************/ 07141000
*                                                                  1376 07142000
*   IF GDTDBG=NULLPTR THEN                                         1376 07143000
         L     @15,@PC00001                                        1376 07144000
         L     @15,GDTDBG(,@15)                                    1376 07145000
         LTR   @15,@15                                             1376 07146000
         BZ    @RT01376                                            1376 07147000
*     ;                                                            1377 07148000
*   ELSE                                                           1378 07149000
*     DO;                                                          1378 07150000
*       DMPINDEX=ADDR(VEDMPSTG);    /*                       @Y30LB38*/ 07151000
         LA    DMPINDEX,VEDMPSTG                                   1379 07152000
*       DMPITMNM='MCLIST';                                         1380 07153000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1380 07154000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1380 07155000
         MVC   DMPITMNM(6,DMPINDEX),@CC01838                       1380 07156000
*       DMPITMPT=ADDR(MCLSTPTR);                                   1381 07157000
         LA    @03,MCLSTPTR                                        1381 07158000
         ST    @03,DMPITMPT(,DMPINDEX)                             1381 07159000
*       DMPITMLN=LENGTH(MCLIST);                                   1382 07160000
         MVC   DMPITMLN(2,DMPINDEX),@CH01146                       1382 07161000
*       DMPITMTP='H';                                              1383 07162000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1383 07163000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1384 07164000
*                                                                  1384 07165000
         AL    DMPINDEX,@CF00474                                   1384 07166000
*       /*************************************************************/ 07167000
*       /*                                                           */ 07168000
*       /*                                                   @Y30LB38*/ 07169000
*       /*                                                           */ 07170000
*       /*************************************************************/ 07171000
*                                                                  1385 07172000
*       DMPTRM=DMPTRMVL;                                           1385 07173000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1385 07174000
*     END;                          /*                       @Y30LB38*/ 07175000
*   IF GDTDBG=NULLPTR THEN                                         1387 07176000
@RT01376 L     @15,@PC00001                                        1387 07177000
         L     @15,GDTDBG(,@15)                                    1387 07178000
         LTR   @15,@15                                             1387 07179000
         BZ    @RT01387                                            1387 07180000
*     ;                                                            1388 07181000
*   ELSE                                                           1389 07182000
*     CALL IDCDB010(GDTTBL,'VEBM',ADDR(VEDMPSTG));/*         @Y30LB38*/ 07183000
*                                                                  1389 07184000
         L     @15,@PC00001                                        1389 07185000
         ST    @15,@AL00001                                        1389 07186000
         LA    @14,@CC01839                                        1389 07187000
         ST    @14,@AL00001+4                                      1389 07188000
         LA    @14,VEDMPSTG                                        1389 07189000
         ST    @14,@AFTEMPS+24                                     1389 07190000
         LA    @14,@AFTEMPS+24                                     1389 07191000
         ST    @14,@AL00001+8                                      1389 07192000
         MVI   @AL00001+8,X'80'                                    1389 07193000
         L     @15,GDTDBG(,@15)                                    1389 07194000
         LA    @01,@AL00001                                        1389 07195000
         BALR  @14,@15                                             1389 07196000
*   /*****************************************************************/ 07197000
*   /*                                                               */ 07198000
*   /* ISSUE USSC MACRO TO EJECT THE VOLUME                  @Y30LB38*/ 07199000
*   /*                                                               */ 07200000
*   /*****************************************************************/ 07201000
*                                                                  1390 07202000
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,VERESNCD,VEECB,VEMSGPTR);/* 1390 07203000
*                                                            @Y30LB38*/ 07204000
@RT01387 L     @02,@PC00001                                        1390 07205000
         ST    @02,@AL00001                                        1390 07206000
         LA    @15,MOVE                                            1390 07207000
         ST    @15,@AL00001+4                                      1390 07208000
         LA    @15,MCLSTPTR                                        1390 07209000
         ST    @15,@AL00001+8                                      1390 07210000
         LA    @15,VERESNCD                                        1390 07211000
         ST    @15,@AL00001+12                                     1390 07212000
         LA    @15,VEECB                                           1390 07213000
         ST    @15,@AL00001+16                                     1390 07214000
         LA    @15,VEMSGPTR                                        1390 07215000
         ST    @15,@AL00001+20                                     1390 07216000
         MVI   @AL00001+20,X'80'                                   1390 07217000
         L     @15,GDTSSC(,@02)                                    1390 07218000
         LA    @01,@AL00001                                        1390 07219000
         BALR  @14,@15                                             1390 07220000
*   RESPECIFY                                                      1391 07221000
*     RTNREG RSTD;                                                 1391 07222000
*   TESTRC=RTNREG;                                                 1392 07223000
         LR    TESTRC,RTNREG                                       1392 07224000
*   RESPECIFY                                                      1393 07225000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 07226000
*                                                                  1393 07227000
*   /*****************************************************************/ 07228000
*   /*                                                               */ 07229000
*   /* SET UP ADDRESSABILITY TO MESSAGE AREA FROM USSC       @Y30LB38*/ 07230000
*   /*                                                               */ 07231000
*   /*****************************************************************/ 07232000
*                                                                  1394 07233000
*   VEMSGPTR=VEMSGPTR+VEECBLEN;     /*                       @Y30LB38*/ 07234000
         LA    @02,4                                               1394 07235000
         AL    @02,VEMSGPTR                                        1394 07236000
         ST    @02,VEMSGPTR                                        1394 07237000
*                                                                  1395 07238000
*   /*****************************************************************/ 07239000
*   /*                                                               */ 07240000
*   /* IF CARTRIDGE WERE SUCCESSFULLY EJECTED; ISSUE THE     @Y30LB38*/ 07241000
*   /* APPROPRIATE MESSAGE                                   @Y30LB38*/ 07242000
*   /*                                                               */ 07243000
*   /*****************************************************************/ 07244000
*                                                                  1395 07245000
*   IF TESTRC=LASTCC00|TESTRC=LASTCC12 THEN                        1395 07246000
         LTR   TESTRC,TESTRC                                       1395 07247000
         BZ    @RT01395                                            1395 07248000
         C     TESTRC,@CF00567                                     1395 07249000
         BNE   @RF01395                                            1395 07250000
@RT01395 DS    0H                                                  1396 07251000
*     DO;                           /*                       @Y30LB38*/ 07252000
*                                                                  1396 07253000
*       /*************************************************************/ 07254000
*       /*                                                           */ 07255000
*       /* IF AN ERROR OCCURRES UPDATING INVENTORY, SET A    @Y30LB38*/ 07256000
*       /* FLAG ON FOR THE CALLER                            @Y30LB38*/ 07257000
*       /*                                                           */ 07258000
*       /*************************************************************/ 07259000
*                                                                  1397 07260000
*       IF TESTRC=LASTCC12 THEN                                    1397 07261000
         C     TESTRC,@CF00567                                     1397 07262000
         BNE   @RF01397                                            1397 07263000
*         VEVVIERR=ON;              /*                       @Y30LB38*/ 07264000
*                                                                  1398 07265000
         L     @15,@PC00016+8                                      1398 07266000
         OI    VEVVIERR(@15),B'10000000'                           1398 07267000
*       /*************************************************************/ 07268000
*       /*                                                           */ 07269000
*       /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME       */ 07270000
*       /*                                                   @Y30LB38*/ 07271000
*       /* TO BE USED IN MESSAGE IDC083E                     @Y30LB38*/ 07272000
*       /*                                                           */ 07273000
*       /*************************************************************/ 07274000
*                                                                  1399 07275000
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/*         @Y30LB38*/ 07276000
*                                                                  1399 07277000
@RF01397 L     @15,@PC00001                                        1399 07278000
         ST    @15,@AL00001                                        1399 07279000
         LA    @14,NAMES                                           1399 07280000
         ST    @14,@AL00001+4                                      1399 07281000
         LA    @14,VESYSIN                                         1399 07282000
         ST    @14,@AFTEMPS+24                                     1399 07283000
         LA    @14,@AFTEMPS+24                                     1399 07284000
         ST    @14,@AL00001+8                                      1399 07285000
         MVI   @AL00001+8,X'80'                                    1399 07286000
         L     @15,GDTSFO(,@15)                                    1399 07287000
         LA    @01,@AL00001                                        1399 07288000
         BALR  @14,@15                                             1399 07289000
*       /*************************************************************/ 07290000
*       /*                                                           */ 07291000
*       /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS        @Y30LB38*/ 07292000
*       /* FOR MESSAGE IDC083E                               @Y30LB38*/ 07293000
*       /*                                                           */ 07294000
*       /*************************************************************/ 07295000
*                                                                  1400 07296000
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/ 07297000
         L     @15,VEDDSTRU                                        1400 07298000
         MVC   DARGSMOD(3,@15),@CC01550                            1400 07299000
*       VEDDSTRU->DARGSENT=MSG083E; /*                       @Y30LB38*/ 07300000
         MVI   DARGSENT(@15),X'17'                                 1401 07301000
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/ 07302000
         L     @14,VEMSGPTR                                        1402 07303000
         LA    @03,CMCSN1(,@14)                                    1402 07304000
         ST    @03,DARGDBP(,@15)                                   1402 07305000
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/ 07306000
         LA    @03,12                                              1403 07307000
         STH   @03,DARGILP(,@15)                                   1403 07308000
*       VEDDSTRU->DARGRETP=VEWTOPTR;/*                       @Y30LB38*/ 07309000
         L     @02,VEWTOPTR                                        1404 07310000
         ST    @02,DARGRETP(,@15)                                  1404 07311000
*       VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*               @Y30LB38*/ 07312000
*                                                                  1405 07313000
         MVC   DARGRETL(2,@15),@CH01399                            1405 07314000
*       /*************************************************************/ 07315000
*       /*                                                           */ 07316000
*       /* IF BOTH CARTRIDGES WERE EJECTED, SET DARGLIST     @Y30LB38*/ 07317000
*       /* FOR FIVE INSERTS. IF NOT USE FOUR INSERTS.        @Y30LB38*/ 07318000
*       /* IF FIVE INSERTS ARE USED, THEY WILL BE CSN1, CSN2,        */ 07319000
*       /*                                                   @Y30LB38*/ 07320000
*       /* VOLUME SERIAL NUMBER, JOB NAME AND STEP NAME.     @Y30LB38*/ 07321000
*       /* IF FOUR INSERTS ARE USED CSN2 WILL BE OMMITTED.   @Y30LB38*/ 07322000
*       /*                                                           */ 07323000
*       /*************************************************************/ 07324000
*                                                                  1406 07325000
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/ 07326000
         CLI   CMNUMCRT(@14),X'F2'                                 1406 07327000
         BNE   @RF01406                                            1406 07328000
*         DO;                       /*                       @Y30LB38*/ 07329000
*           VEDDSTRU->DARGCNT='4'X; /*                       @Y30LB38*/ 07330000
         LA    @02,4                                               1408 07331000
         STH   @02,DARGCNT(,@15)                                   1408 07332000
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/ 07333000
         LA    @01,1                                               1409 07334000
         STH   @01,DARGINS(,@15)                                   1409 07335000
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/ 07336000
         STH   @03,DARGINL(,@15)                                   1410 07337000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/ 07338000
         LA    @14,CMCSN2(,@14)                                    1411 07339000
         ST    @14,DARGDTM(,@15)                                   1411 07340000
*           VEDDSTRU->DARGINS(2)='2'X;/*                     @Y30LB38*/ 07341000
         LA    @14,2                                               1412 07342000
         STH   @14,DARGINS+8(,@15)                                 1412 07343000
*           VEDDSTRU->DARGINL(2)=LENGTH(VEVOLUME);/*         @Y30LB38*/ 07344000
         MVC   DARGINL+8(2,@15),@CH00156                           1413 07345000
*           VEDDSTRU->DARGDTM(2)=ADDR(VEVOLUME);/*           @Y30LB38*/ 07346000
         L     @14,@PC00016+4                                      1414 07347000
         ST    @14,DARGDTM+8(,@15)                                 1414 07348000
*           VEDDSTRU->DARGINS(3)='3'X;/*                     @Y30LB38*/ 07349000
         LA    @14,3                                               1415 07350000
         STH   @14,DARGINS+16(,@15)                                1415 07351000
*           VEDDSTRU->DARGINL(3)=LENGTH(VEJOBNAM);/*         @Y30LB38*/ 07352000
         LA    @14,8                                               1416 07353000
         STH   @14,DARGINL+16(,@15)                                1416 07354000
*           VEDDSTRU->DARGDTM(3)=ADDR(VEJOBNAM);/*           @Y30LB38*/ 07355000
         LA    @03,VEJOBNAM                                        1417 07356000
         ST    @03,DARGDTM+16(,@15)                                1417 07357000
*           VEDDSTRU->DARGINS(4)='4'X;/*                     @Y30LB38*/ 07358000
         STH   @02,DARGINS+24(,@15)                                1418 07359000
*           VEDDSTRU->DARGINL(4)=LENGTH(VESTEPNM);/*         @Y30LB38*/ 07360000
         STH   @14,DARGINL+24(,@15)                                1419 07361000
*           VEDDSTRU->DARGDTM(4)=ADDR(VESTEPNM);/*           @Y30LB38*/ 07362000
         LA    @14,VESTEPNM                                        1420 07363000
         ST    @14,DARGDTM+24(,@15)                                1420 07364000
*         END;                      /*                       @Y30LB38*/ 07365000
*       ELSE                                                       1422 07366000
*         DO;                       /*                       @Y30LB38*/ 07367000
         B     @RC01406                                            1422 07368000
@RF01406 DS    0H                                                  1423 07369000
*           VEDDSTRU->DARGCNT='3'X; /*                       @Y30LB38*/ 07370000
         LA    @15,3                                               1423 07371000
         L     @14,VEDDSTRU                                        1423 07372000
         STH   @15,DARGCNT(,@14)                                   1423 07373000
*           VEDDSTRU->DARGINS(1)='2'X;/*                     @Y30LB38*/ 07374000
         LA    @03,2                                               1424 07375000
         STH   @03,DARGINS(,@14)                                   1424 07376000
*           VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*         @Y30LB38*/ 07377000
         MVC   DARGINL(2,@14),@CH00156                             1425 07378000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*           @Y30LB38*/ 07379000
         L     @03,@PC00016+4                                      1426 07380000
         ST    @03,DARGDTM(,@14)                                   1426 07381000
*           VEDDSTRU->DARGINS(2)='3'X;/*                     @Y30LB38*/ 07382000
         STH   @15,DARGINS+8(,@14)                                 1427 07383000
*           VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*         @Y30LB38*/ 07384000
         LA    @15,8                                               1428 07385000
         STH   @15,DARGINL+8(,@14)                                 1428 07386000
*           VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*           @Y30LB38*/ 07387000
         LA    @03,VEJOBNAM                                        1429 07388000
         ST    @03,DARGDTM+8(,@14)                                 1429 07389000
*           VEDDSTRU->DARGINS(3)='4'X;/*                     @Y30LB38*/ 07390000
         LA    @03,4                                               1430 07391000
         STH   @03,DARGINS+16(,@14)                                1430 07392000
*           VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*         @Y30LB38*/ 07393000
         STH   @15,DARGINL+16(,@14)                                1431 07394000
*           VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*           @Y30LB38*/ 07395000
         LA    @15,VESTEPNM                                        1432 07396000
         ST    @15,DARGDTM+16(,@14)                                1432 07397000
*         END;                      /*                       @Y30LB38*/ 07398000
*                                                                  1433 07399000
*       /*************************************************************/ 07400000
*       /*                                                           */ 07401000
*       /* ISSUE UPRINT MACRO TO RETRIEVE MESSAGE IDC0083I   @Y30LB38*/ 07402000
*       /*                                                           */ 07403000
*       /*************************************************************/ 07404000
*                                                                  1434 07405000
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/ 07406000
*                                                                  1434 07407000
@RC01406 L     @15,@PC00001                                        1434 07408000
         ST    @15,@AL00001                                        1434 07409000
         LA    @14,@CF00115                                        1434 07410000
         ST    @14,@AL00001+4                                      1434 07411000
         LA    @14,VEDDSTRU                                        1434 07412000
         ST    @14,@AL00001+8                                      1434 07413000
         MVI   @AL00001+8,X'80'                                    1434 07414000
         L     @15,GDTPRT(,@15)                                    1434 07415000
         LA    @01,@AL00001                                        1434 07416000
         BALR  @14,@15                                             1434 07417000
*       /*************************************************************/ 07418000
*       /*                                                           */ 07419000
*       /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR CODES       */ 07420000
*       /*                                                   @Y30LB38*/ 07421000
*       /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE IDC2083E*/ 07422000
*       /* TO THE SYSTEM OPERATOR.                           @Y30LB38*/ 07423000
*       /*                                                           */ 07424000
*       /*************************************************************/ 07425000
*                                                                  1435 07426000
*       VEWTOLEN=LENGTH(VEWTOMSG);  /*                       @Y30LB38*/ 07427000
         MVC   VEWTOLEN(2),@CH01399                                1435 07428000
*       VEROUTCD=''B;               /*                       @Y30LB38*/ 07429000
         XC    VEROUTCD(2),VEROUTCD                                1436 07430000
*       VECD1=ON;                   /*                       @Y30LB38*/ 07431000
         OI    VECD1,B'10000000'                                   1437 07432000
*       VEDESCCD=''B;               /*                       @Y30LB38*/ 07433000
         XC    VEDESCCD(2),VEDESCCD                                1438 07434000
*       VEDESC3=ON;                 /*                       @Y30LB38*/ 07435000
         OI    VEDESC3,B'00100000'                                 1439 07436000
*       CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,VEDESCCD);/*    07437000
*                                                            @Y30LB38*/ 07438000
         L     @15,@PC00001                                        1440 07439000
         ST    @15,@AL00001                                        1440 07440000
         LA    @14,VEWTOLEN                                        1440 07441000
         ST    @14,@AL00001+4                                      1440 07442000
         LA    @14,VEWTOPTR                                        1440 07443000
         ST    @14,@AL00001+8                                      1440 07444000
         LA    @14,VEROUTCD                                        1440 07445000
         ST    @14,@AL00001+12                                     1440 07446000
         LA    @14,VEDESCCD                                        1440 07447000
         ST    @14,@AL00001+16                                     1440 07448000
         MVI   @AL00001+16,X'80'                                   1440 07449000
         L     @15,GDTWTO(,@15)                                    1440 07450000
         LA    @01,@AL00001                                        1440 07451000
         BALR  @14,@15                                             1440 07452000
*                                                                  1441 07453000
*       /*************************************************************/ 07454000
*       /*                                                           */ 07455000
*       /* TEST IF BOTH SERIAL NUMBERS WERE SPECIFIED? IF    @Y30LB38*/ 07456000
*       /* YES, PUT BOTH CSN'S IN MESSAGE IDC0085I AND PRINT THE     */ 07457000
*       /* MESSAGE. IF NO, USE ONLY THE FIRST CSN.           @Y30LB38*/ 07458000
*       /*                                                           */ 07459000
*       /*************************************************************/ 07460000
*                                                                  1441 07461000
*       VELIST=''B;                 /*                       @Y30LB38*/ 07462000
         XC    VELIST(52),VELIST                                   1441 07463000
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/ 07464000
         L     @15,VEDDSTRU                                        1442 07465000
         MVC   DARGSMOD(3,@15),@CC01550                            1442 07466000
*       VEDDSTRU->DARGSENT=MSG0085I;/*                       @Y30LB38*/ 07467000
         MVI   DARGSENT(@15),X'15'                                 1443 07468000
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/ 07469000
         L     @14,VEMSGPTR                                        1444 07470000
         LA    @03,CMCSN1(,@14)                                    1444 07471000
         ST    @03,DARGDBP(,@15)                                   1444 07472000
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/ 07473000
         LA    @03,12                                              1445 07474000
         STH   @03,DARGILP(,@15)                                   1445 07475000
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/ 07476000
         CLI   CMNUMCRT(@14),X'F2'                                 1446 07477000
         BNE   @RF01446                                            1446 07478000
*         DO;                       /*                       @Y30LB38*/ 07479000
*           VEDDSTRU->DARGCNT='1'X; /*                       @Y30LB38*/ 07480000
         LA    @02,1                                               1448 07481000
         STH   @02,DARGCNT(,@15)                                   1448 07482000
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/ 07483000
         STH   @02,DARGINS(,@15)                                   1449 07484000
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/ 07485000
         STH   @03,DARGINL(,@15)                                   1450 07486000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/ 07487000
         LA    @14,CMCSN2(,@14)                                    1451 07488000
         ST    @14,DARGDTM(,@15)                                   1451 07489000
*         END;                      /*                       @Y30LB38*/ 07490000
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/ 07491000
*                                                                  1453 07492000
@RF01446 L     @15,@PC00001                                        1453 07493000
         ST    @15,@AL00001                                        1453 07494000
         LA    @14,@CF00115                                        1453 07495000
         ST    @14,@AL00001+4                                      1453 07496000
         LA    @14,VEDDSTRU                                        1453 07497000
         ST    @14,@AL00001+8                                      1453 07498000
         MVI   @AL00001+8,X'80'                                    1453 07499000
         L     @15,GDTPRT(,@15)                                    1453 07500000
         LA    @01,@AL00001                                        1453 07501000
         BALR  @14,@15                                             1453 07502000
*       /*************************************************************/ 07503000
*       /*                                                           */ 07504000
*       /* ISSUE UFSPACE MACRO TO FREE MESSAGE AREA SPACE    @Y30LB38*/ 07505000
*       /* FROM THE USSC MACRO                               @Y30LB38*/ 07506000
*       /*                                                           */ 07507000
*       /*************************************************************/ 07508000
*                                                                  1454 07509000
*       VEMSGPTR=VEMSGPTR-VEECBLEN; /*                       @Y30LB38*/ 07510000
         L     @15,VEMSGPTR                                        1454 07511000
         SL    @15,@CF00042                                        1454 07512000
         ST    @15,VEMSGPTR                                        1454 07513000
*       CALL IDCSAFS0(GDTTBL,VEMSGPTR);/*                    @Y30LB38*/ 07514000
         L     @15,@PC00001                                        1455 07515000
         ST    @15,@AL00001                                        1455 07516000
         LA    @14,VEMSGPTR                                        1455 07517000
         ST    @14,@AL00001+4                                      1455 07518000
         L     @15,GDTFSP(,@15)                                    1455 07519000
         LA    @01,@AL00001                                        1455 07520000
         BALR  @14,@15                                             1455 07521000
*     END;                          /*                       @Y30LB38*/ 07522000
*   ELSE                                                           1457 07523000
*     DO;                           /*                       @Y30LB38*/ 07524000
*                                                                  1457 07525000
         B     @RC01395                                            1457 07526000
@RF01395 DS    0H                                                  1458 07527000
*       /*************************************************************/ 07528000
*       /*                                                           */ 07529000
*       /* THE RETURN CODE FROM THE USSC MACRO WAS NOT 0 OR 12.      */ 07530000
*       /*                                                   @Y30LB38*/ 07531000
*       /* A RETURN CODE OF 8 IS CHECKED TO DETERMINE IF USSC COULD  */ 07532000
*       /* NOT GET STORAGE. IF YES, MESSAGE IDC2084I IS WRITTEN AND  */ 07533000
*       /* RETURN TO CALLER WITH CONDITION CODE 4.           @Y30LB38*/ 07534000
*       /*                                                           */ 07535000
*       /*************************************************************/ 07536000
*                                                                  1458 07537000
*       IF TESTRC=LASTCC08 THEN                                    1458 07538000
         C     TESTRC,@CF00179                                     1458 07539000
         BNE   @RF01458                                            1458 07540000
*         DO;                       /*                       @Y30LB38*/ 07541000
*           VELIST=''B;             /*                       @Y30LB38*/ 07542000
         XC    VELIST(52),VELIST                                   1460 07543000
*           VEDDSTRU->DARGSMOD=VECMOMSG;/*                   @Y30LB38*/ 07544000
         L     @15,VEDDSTRU                                        1461 07545000
         MVC   DARGSMOD(3,@15),@CC01550                            1461 07546000
*           VEDDSTRU->DARGSENT=MSG2084I;/*                   @Y30LB38*/ 07547000
         MVI   DARGSENT(@15),X'16'                                 1462 07548000
*           CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*        @Y30LB38*/ 07549000
         L     @15,@PC00001                                        1463 07550000
         ST    @15,@AL00001                                        1463 07551000
         LA    @14,@CF00115                                        1463 07552000
         ST    @14,@AL00001+4                                      1463 07553000
         LA    @14,VEDDSTRU                                        1463 07554000
         ST    @14,@AL00001+8                                      1463 07555000
         MVI   @AL00001+8,X'80'                                    1463 07556000
         L     @15,GDTPRT(,@15)                                    1463 07557000
         LA    @01,@AL00001                                        1463 07558000
         BALR  @14,@15                                             1463 07559000
*           VECOND=LASTCC04;        /*                       @Y30LB38*/ 07560000
         LA    VECOND,4                                            1464 07561000
*         END;                      /*                       @Y30LB38*/ 07562000
*       ELSE                                                       1466 07563000
*         DO;                       /*                       @Y30LB38*/ 07564000
*                                                                  1466 07565000
         B     @RC01458                                            1466 07566000
@RF01458 DS    0H                                                  1467 07567000
*           /*********************************************************/ 07568000
*           /*                                                       */ 07569000
*           /* IF THE RETURN CODE WAS NOT 8, TEST IF THE REASON      */ 07570000
*           /*                                               @Y30LB38*/ 07571000
*           /* CODE WAS '4C'X INDICATING THAT THE FIRST CARTRIDGE WAS*/ 07572000
*           /* EJECTED BUT THE SECOND WAS NOT. IF YES, ISSUE UPRINT  */ 07573000
*           /* AND UWTO MACROS TO WRITE MESSAGE IDC083E TO THE SYSTEM*/ 07574000
*           /* OPERATOR AND ISSUE UPRINT MACRO TO WRITE MESSAGE      */ 07575000
*           /* IDC0085I TO THE USER.                         @Y30LB38*/ 07576000
*           /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME   */ 07577000
*           /*                                               @Y30LB38*/ 07578000
*           /* TO BE USED IN MESSAGE IDC083E                 @Y30LB38*/ 07579000
*           /*                                                       */ 07580000
*           /*********************************************************/ 07581000
*                                                                  1467 07582000
*           IF VERESNCD='4C'X THEN                                 1467 07583000
         CLC   VERESNCD(4),@CF01845                                1467 07584000
         BNE   @RF01467                                            1467 07585000
*             DO;                   /*                       @Y30LB38*/ 07586000
*               CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/* @Y30LB38*/ 07587000
         L     @04,@PC00001                                        1469 07588000
         ST    @04,@AL00001                                        1469 07589000
         LA    @15,NAMES                                           1469 07590000
         ST    @15,@AL00001+4                                      1469 07591000
         LA    @15,VESYSIN                                         1469 07592000
         ST    @15,@AFTEMPS+24                                     1469 07593000
         LA    @15,@AFTEMPS+24                                     1469 07594000
         ST    @15,@AL00001+8                                      1469 07595000
         MVI   @AL00001+8,X'80'                                    1469 07596000
         L     @15,GDTSFO(,@04)                                    1469 07597000
         LA    @01,@AL00001                                        1469 07598000
         BALR  @14,@15                                             1469 07599000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 07600000
         L     @04,VEDDSTRU                                        1470 07601000
         MVC   DARGSMOD(3,@04),@CC01550                            1470 07602000
*               VEDDSTRU->DARGSENT=MSG083E;/*                @Y30LB38*/ 07603000
         MVI   DARGSENT(@04),X'17'                                 1471 07604000
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/ 07605000
         L     @15,@PC00016                                        1472 07606000
         ST    @15,DARGDBP(,@04)                                   1472 07607000
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/ 07608000
         MVC   DARGILP(2,@04),@CH00567                             1473 07609000
*               VEDDSTRU->DARGRETP=VEWTOPTR;/*               @Y30LB38*/ 07610000
         L     @15,VEWTOPTR                                        1474 07611000
         ST    @15,DARGRETP(,@04)                                  1474 07612000
*               VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*       @Y30LB38*/ 07613000
         MVC   DARGRETL(2,@04),@CH01399                            1475 07614000
*               VEDDSTRU->DARGCNT='3'X;/*                    @Y30LB38*/ 07615000
         LA    @15,3                                               1476 07616000
         STH   @15,DARGCNT(,@04)                                   1476 07617000
*               VEDDSTRU->DARGINS(1)='2'X;/*                 @Y30LB38*/ 07618000
         LA    @14,2                                               1477 07619000
         STH   @14,DARGINS(,@04)                                   1477 07620000
*               VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*     @Y30LB38*/ 07621000
         MVC   DARGINL(2,@04),@CH00156                             1478 07622000
*               VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*       @Y30LB38*/ 07623000
         L     @14,@PC00016+4                                      1479 07624000
         ST    @14,DARGDTM(,@04)                                   1479 07625000
*               VEDDSTRU->DARGINS(2)='3'X;/*                 @Y30LB38*/ 07626000
         STH   @15,DARGINS+8(,@04)                                 1480 07627000
*               VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*     @Y30LB38*/ 07628000
         LA    @15,8                                               1481 07629000
         STH   @15,DARGINL+8(,@04)                                 1481 07630000
*               VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*       @Y30LB38*/ 07631000
         LA    @14,VEJOBNAM                                        1482 07632000
         ST    @14,DARGDTM+8(,@04)                                 1482 07633000
*               VEDDSTRU->DARGINS(3)='4'X;/*                 @Y30LB38*/ 07634000
         LA    @14,4                                               1483 07635000
         STH   @14,DARGINS+16(,@04)                                1483 07636000
*               VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*     @Y30LB38*/ 07637000
         STH   @15,DARGINL+16(,@04)                                1484 07638000
*               VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*       @Y30LB38*/ 07639000
         LA    @15,VESTEPNM                                        1485 07640000
         ST    @15,DARGDTM+16(,@04)                                1485 07641000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 07642000
*                                                                  1486 07643000
         L     @04,@PC00001                                        1486 07644000
         ST    @04,@AL00001                                        1486 07645000
         LA    @15,@CF00115                                        1486 07646000
         ST    @15,@AL00001+4                                      1486 07647000
         LA    @15,VEDDSTRU                                        1486 07648000
         ST    @15,@AL00001+8                                      1486 07649000
         MVI   @AL00001+8,X'80'                                    1486 07650000
         L     @15,GDTPRT(,@04)                                    1486 07651000
         LA    @01,@AL00001                                        1486 07652000
         BALR  @14,@15                                             1486 07653000
*               /*****************************************************/ 07654000
*               /*                                                   */ 07655000
*               /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR     */ 07656000
*               /* CODES                                     @Y30LB38*/ 07657000
*               /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE */ 07658000
*               /* IDC083E TO THE SYSTEM OPERATOR.           @Y30LB38*/ 07659000
*               /*                                                   */ 07660000
*               /*****************************************************/ 07661000
*                                                                  1487 07662000
*               VEWTOLEN=LENGTH(VEWTOMSG);/*                 @Y30LB38*/ 07663000
         MVC   VEWTOLEN(2),@CH01399                                1487 07664000
*               VEROUTCD=''B;       /*                       @Y30LB38*/ 07665000
         XC    VEROUTCD(2),VEROUTCD                                1488 07666000
*               VECD1=ON;           /*                       @Y30LB38*/ 07667000
         OI    VECD1,B'10000000'                                   1489 07668000
*               VEDESCCD=''B;       /*                       @Y30LB38*/ 07669000
         XC    VEDESCCD(2),VEDESCCD                                1490 07670000
*               VEDESC3=ON;         /*                       @Y30LB38*/ 07671000
         OI    VEDESC3,B'00100000'                                 1491 07672000
*               CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,   1492 07673000
*                   VEDESCCD);      /*                       @Y30LB38*/ 07674000
*                                                                  1492 07675000
         L     @04,@PC00001                                        1492 07676000
         ST    @04,@AL00001                                        1492 07677000
         LA    @15,VEWTOLEN                                        1492 07678000
         ST    @15,@AL00001+4                                      1492 07679000
         LA    @15,VEWTOPTR                                        1492 07680000
         ST    @15,@AL00001+8                                      1492 07681000
         LA    @15,VEROUTCD                                        1492 07682000
         ST    @15,@AL00001+12                                     1492 07683000
         LA    @15,VEDESCCD                                        1492 07684000
         ST    @15,@AL00001+16                                     1492 07685000
         MVI   @AL00001+16,X'80'                                   1492 07686000
         L     @15,GDTWTO(,@04)                                    1492 07687000
         LA    @01,@AL00001                                        1492 07688000
         BALR  @14,@15                                             1492 07689000
*               /*****************************************************/ 07690000
*               /*                                                   */ 07691000
*               /* ISSUE UPRINT MACRO TO PRINT MESSAGE IDC0085I      */ 07692000
*               /*                                           @Y30LB38*/ 07693000
*               /*                                                   */ 07694000
*               /*****************************************************/ 07695000
*                                                                  1493 07696000
*               VELIST=''B;         /*                       @Y30LB38*/ 07697000
         XC    VELIST(52),VELIST                                   1493 07698000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 07699000
         L     @04,VEDDSTRU                                        1494 07700000
         MVC   DARGSMOD(3,@04),@CC01550                            1494 07701000
*               VEDDSTRU->DARGSENT=MSG0085I;/*               @Y30LB38*/ 07702000
         MVI   DARGSENT(@04),X'15'                                 1495 07703000
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/ 07704000
         L     @15,@PC00016                                        1496 07705000
         ST    @15,DARGDBP(,@04)                                   1496 07706000
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/ 07707000
         MVC   DARGILP(2,@04),@CH00567                             1497 07708000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 07709000
*                                                                  1498 07710000
         L     @04,@PC00001                                        1498 07711000
         ST    @04,@AL00001                                        1498 07712000
         LA    @15,@CF00115                                        1498 07713000
         ST    @15,@AL00001+4                                      1498 07714000
         LA    @15,VEDDSTRU                                        1498 07715000
         ST    @15,@AL00001+8                                      1498 07716000
         MVI   @AL00001+8,X'80'                                    1498 07717000
         L     @15,GDTPRT(,@04)                                    1498 07718000
         LA    @01,@AL00001                                        1498 07719000
         BALR  @14,@15                                             1498 07720000
*               /*****************************************************/ 07721000
*               /*                                                   */ 07722000
*               /* THE SSCMSG ROUTINE IS CALLED TO WRITE THE MSS     */ 07723000
*               /*                                           @Y30LB38*/ 07724000
*               /* MESSAGE EXPLAINING THE SECOND CARTRIDGE WAS NOT   */ 07725000
*               /* EJECTED.                                  @Y30LB38*/ 07726000
*               /*                                                   */ 07727000
*               /*****************************************************/ 07728000
*                                                                  1499 07729000
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/ 07730000
         LA    @04,VERESNCD                                        1499 07731000
         ST    @04,@AL00001                                        1499 07732000
         LA    @01,@AL00001                                        1499 07733000
         BAL   @14,SSCMSG                                          1499 07734000
*               VECOND=LASTCC08;    /*                       @Y30LB38*/ 07735000
         LA    VECOND,8                                            1500 07736000
*             END;                  /*                       @Y30LB38*/ 07737000
*           ELSE                                                   1502 07738000
*             DO;                   /*                       @Y30LB38*/ 07739000
*                                                                  1502 07740000
         B     @RC01467                                            1502 07741000
@RF01467 DS    0H                                                  1503 07742000
*               /*****************************************************/ 07743000
*               /*                                                   */ 07744000
*               /* RETURN CODE FROM USSC IS 4 INDICATING THAT        */ 07745000
*               /*                                           @Y30LB38*/ 07746000
*               /* THE CARTRIDGES WERE NOT EJECTED. THE SSCMSG       */ 07747000
*               /* ROUTINE IS CALLED TO WRITE THE MSS MESSAGE        */ 07748000
*               /* EXPLAINING THE ERROR. MESSAGE IDC2048I IS WRITTEN */ 07749000
*               /* TO THE USER WITH THE UPRINT MACRO.        @Y30LB38*/ 07750000
*               /*                                                   */ 07751000
*               /*****************************************************/ 07752000
*                                                                  1503 07753000
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/ 07754000
         LA    @04,VERESNCD                                        1503 07755000
         ST    @04,@AL00001                                        1503 07756000
         LA    @01,@AL00001                                        1503 07757000
         BAL   @14,SSCMSG                                          1503 07758000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 07759000
         L     @15,VEDDSTRU                                        1504 07760000
         MVC   DARGSMOD(3,@15),@CC01550                            1504 07761000
*               VEDDSTRU->DARGSENT=MSG2084I;/*               @Y30LB38*/ 07762000
         MVI   DARGSENT(@15),X'16'                                 1505 07763000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 07764000
         L     @15,@PC00001                                        1506 07765000
         ST    @15,@AL00001                                        1506 07766000
         LA    @14,@CF00115                                        1506 07767000
         ST    @14,@AL00001+4                                      1506 07768000
         LA    @14,VEDDSTRU                                        1506 07769000
         ST    @14,@AL00001+8                                      1506 07770000
         MVI   @AL00001+8,X'80'                                    1506 07771000
         L     @15,GDTPRT(,@15)                                    1506 07772000
         LA    @01,@AL00001                                        1506 07773000
         BALR  @14,@15                                             1506 07774000
*               VECOND=LASTCC04;    /*                       @Y30LB38*/ 07775000
         LA    VECOND,4                                            1507 07776000
*             END;                  /*                       @Y30LB38*/ 07777000
*         END;                      /*                       @Y30LB38*/ 07778000
@RC01467 DS    0H                                                  1510 07779000
*     END;                          /*                       @Y30LB38*/ 07780000
*                                                                  1510 07781000
@RC01458 DS    0H                                                  1511 07782000
*   /*****************************************************************/ 07783000
*   /*                                                               */ 07784000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 07785000
*   /*                                                               */ 07786000
*   /*****************************************************************/ 07787000
*                                                                  1511 07788000
*   REG14=VERETADR;                 /*                       @Y30LB38*/ 07789000
@RC01395 LR    REG14,VERETADR                                      1511 07790000
*   RETURN CODE(VECOND);            /*                       @Y30LB38*/ 07791000
         LR    @15,VECOND                                          1512 07792000
@EL00016 DS    0H                                                  1512 07793000
@EF00016 DS    0H                                                  1512 07794000
@ER00016 BR    @14                                                 1512 07795000
*   END VOLEXIT;                    /*                       @Y30LB38*/ 07796000
*                                                                  1514 07797000
*   /*****************************************************************/ 07798000
*   /*                                                               */ 07799000
*   /*                                                       @Y30LB39*/ 07800000
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/ 07801000
*   /* OUTPUT SSC MESSAGES.                                  @Y30LB39*/ 07802000
*   /*                                                       @Y30LB39*/ 07803000
*   /*                                                               */ 07804000
*   /*****************************************************************/ 07805000
*                                                                  1514 07806000
*                                   /*                       @Y30LB39*/ 07807000
*/***********************************************************@Y30LB39*/ 07808000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 07809000
*/*                                                          @Y30LB39*/ 07810000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 07811000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 07812000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 07813000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 07814000
*/*                                                          @Y30LB39*/ 07815000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 07816000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 07817000
*/*   IN SSECBCD.                                            @Y30LB39*/ 07818000
*/*                                                          @Y30LB39*/ 07819000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 07820000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 07821000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 07822000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 07823000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 07824000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 07825000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 07826000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 07827000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 07828000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 07829000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 07830000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 07831000
*/*                                                          @Y30LB39*/ 07832000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 07833000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 07834000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 07835000
*/*                                                          @Y30LB39*/ 07836000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 07837000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 07838000
*/*                                                          @Y30LB39*/ 07839000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 07840000
*/*                                                          @Y30LB39*/ 07841000
*/***********************************************************@Y30LB39*/ 07842000
*                                                                  1514 07843000
*                                   /*                       @Y30LB39*/ 07844000
*SSCMSG:                                                           1514 07845000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 07846000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   07847000
*                                                            @Y30LB39*/ 07848000
SSCMSG   STM   @14,@12,@SA00017                                    1514 07849000
         MVC   @PC00017(8),0(@01)                                  1514 07850000
*                                   /*                       @Y30LB39*/ 07851000
*                                                                  1515 07852000
*   /*****************************************************************/ 07853000
*   /*                                                               */ 07854000
*   /*                                                       @Y30LB39*/ 07855000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 07856000
*   /*                                                       @Y30LB39*/ 07857000
*   /*                                                               */ 07858000
*   /*****************************************************************/ 07859000
*                                                                  1515 07860000
*                                   /*                       @Y30LB39   07861000
*                                                            @Y30LB39*/ 07862000
*                                                                  1515 07863000
*   /*****************************************************************/ 07864000
*   /*                                                               */ 07865000
*   /*                                                       @Y30LB39*/ 07866000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 07867000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 07868000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 07869000
*   /*                                                       @Y30LB39*/ 07870000
*   /*                                                               */ 07871000
*   /*****************************************************************/ 07872000
*                                                                  1515 07873000
*                                   /*                       @Y30LB39*/ 07874000
*   DCL                                                            1515 07875000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 07876000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 07877000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 07878000
*   DCL                                                            1516 07879000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   07880000
*                                                            @Y30LB39   07881000
*                                                            @Y30LB39*/ 07882000
*                                                                  1516 07883000
*   /*****************************************************************/ 07884000
*   /*                                                               */ 07885000
*   /*                                                       @Y30LB39*/ 07886000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 07887000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 07888000
*   /*                                                       @Y30LB39*/ 07889000
*   /*                                                               */ 07890000
*   /*****************************************************************/ 07891000
*                                                                  1517 07892000
*                                   /*                       @Y30LB39*/ 07893000
*   DCL                                                            1517 07894000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 07895000
*   DCL                                                            1518 07896000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   07897000
*                                                            @Y30LB39*/ 07898000
*                                                                  1518 07899000
*   /*****************************************************************/ 07900000
*   /*                                                               */ 07901000
*   /*                                                       @Y30LB39*/ 07902000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 07903000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 07904000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 07905000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 07906000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 07907000
*   /*                                                       @Y30LB39*/ 07908000
*   /*                                                               */ 07909000
*   /*****************************************************************/ 07910000
*                                                                  1519 07911000
*                                   /*                       @Y30LB39*/ 07912000
*   DECLARE                                                        1519 07913000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   07914000
*                                                            @Y30LB39*/ 07915000
*                                                                  1519 07916000
*   /*****************************************************************/ 07917000
*   /*                                                               */ 07918000
*   /*                                                       @Y30LB39*/ 07919000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 07920000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 07921000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 07922000
*   /* IDCTSCM0.                                             @Y30LB39*/ 07923000
*   /*                                                       @Y30LB39*/ 07924000
*   /*                                                               */ 07925000
*   /*****************************************************************/ 07926000
*                                                                  1520 07927000
*                                   /*                       @Y30LB39*/ 07928000
*   DECLARE                                                        1520 07929000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   07930000
*                                                            @Y30LB39*/ 07931000
*                                                                  1520 07932000
*   /*****************************************************************/ 07933000
*   /*                                                               */ 07934000
*   /*                                                       @Y30LB39*/ 07935000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 07936000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 07937000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 07938000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 07939000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 07940000
*   /*                                                       @Y30LB39*/ 07941000
*   /*                                                               */ 07942000
*   /*****************************************************************/ 07943000
*                                                                  1521 07944000
*                                   /*                       @Y30LB39*/ 07945000
*   DECLARE                                                        1521 07946000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 07947000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   07948000
*                                                            @Y30LB39*/ 07949000
*                                                                  1521 07950000
*   /*****************************************************************/ 07951000
*   /*                                                               */ 07952000
*   /*                                                       @Y30LB39*/ 07953000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07954000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 07955000
*   /*                                                       @Y30LB39*/ 07956000
*   /*                                                               */ 07957000
*   /*****************************************************************/ 07958000
*                                                                  1522 07959000
*                                   /*                       @Y30LB39*/ 07960000
*   DECLARE                                                        1522 07961000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   07962000
*                                                            @Y30LB39*/ 07963000
*                                                                  1522 07964000
*   /*****************************************************************/ 07965000
*   /*                                                               */ 07966000
*   /*                                                       @Y30LB39*/ 07967000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 07968000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 07969000
*   /*                                                       @Y30LB39*/ 07970000
*   /*                                                               */ 07971000
*   /*****************************************************************/ 07972000
*                                                                  1523 07973000
*                                   /*                       @Y30LB39*/ 07974000
*   DECLARE                                                        1523 07975000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   07976000
*                                                            @Y30LB39*/ 07977000
*                                   /*                       @Y30LB39*/ 07978000
*                                                                  1524 07979000
*   /*****************************************************************/ 07980000
*   /*                                                               */ 07981000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 07982000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 07983000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 07984000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 07985000
*   /*                                                       @Y30LB39*/ 07986000
*   /*                                                               */ 07987000
*   /*****************************************************************/ 07988000
*                                                                  1524 07989000
*                                   /*                       @Y30LB39*/ 07990000
*   OLDERID2=NEWERID2;                                             1524 07991000
         L     @09,@PC00001                                        1524 07992000
         L     @15,GDTTR2(,@09)                                    1524 07993000
         MVC   @TS00001(95),NEWERID2(@15)                          1524 07994000
         MVC   OLDERID2(95,@15),@TS00001                           1524 07995000
*   NEWID2='SSAA';                  /*                       @Y30LB39   07996000
*                                                            @Y30LB39*/ 07997000
*                                                                  1525 07998000
         MVC   NEWID2(4,@15),@CC01866                              1525 07999000
*   /*****************************************************************/ 08000000
*   /*                                                               */ 08001000
*   /*                                                       @Y30LB39*/ 08002000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 08003000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 08004000
*   /*                                                       @Y30LB39*/ 08005000
*   /*                                                               */ 08006000
*   /*****************************************************************/ 08007000
*                                                                  1526 08008000
*                                   /*                       @Y30LB39*/ 08009000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   08010000
*                                                            @Y30LB39*/ 08011000
*                                                                  1526 08012000
         LA    @15,SSDRGLT                                         1526 08013000
         ST    @15,SSDLPTR                                         1526 08014000
*   /*****************************************************************/ 08015000
*   /*                                                               */ 08016000
*   /*                                                       @Y30LB39*/ 08017000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 08018000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 08019000
*   /*                                                       @Y30LB39*/ 08020000
*   /*                                                               */ 08021000
*   /*****************************************************************/ 08022000
*                                                                  1527 08023000
*                                   /*                       @Y30LB39*/ 08024000
*   IF SSRCODE>0 THEN                                              1527 08025000
         L     @14,@PC00017                                        1527 08026000
         L     @14,SSRCODE(,@14)                                   1527 08027000
         LTR   @14,@14                                             1527 08028000
         BNP   @RF01527                                            1527 08029000
*     DO;                           /*                       @Y30LB39   08030000
*                                                            @Y30LB39*/ 08031000
*                                                                  1528 08032000
*       /*************************************************************/ 08033000
*       /*                                                           */ 08034000
*       /*                                                   @Y30LB39*/ 08035000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 08036000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 08037000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 08038000
*       /* CODES.                                            @Y30LB39*/ 08039000
*       /*                                                   @Y30LB39*/ 08040000
*       /*                                                           */ 08041000
*       /*************************************************************/ 08042000
*                                                                  1529 08043000
*                                   /*                       @Y30LB39*/ 08044000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08045000
         XC    SSDRGLT(20),SSDRGLT                                 1529 08046000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 08047000
         LA    @03,SSINXLST                                        1530 08048000
         ST    @03,DARGRETP(,@15)                                  1530 08049000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 08050000
         MVC   DARGSMOD(3,@15),SSMODSS0                            1531 08051000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 08052000
         MVI   DARGSENT(@15),X'01'                                 1532 08053000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   08054000
*                                                            @Y30LB39*/ 08055000
*                                                                  1533 08056000
         MVC   DARGRETL(2,@15),@CH01912                            1533 08057000
*       /*************************************************************/ 08058000
*       /*                                                           */ 08059000
*       /*                                                   @Y30LB39*/ 08060000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 08061000
*       /* ARRAY.                                            @Y30LB39*/ 08062000
*       /*                                                   @Y30LB39*/ 08063000
*       /*                                                           */ 08064000
*       /*************************************************************/ 08065000
*                                                                  1534 08066000
*                                   /*                       @Y30LB39*/ 08067000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   08068000
*                                                            @Y30LB39*/ 08069000
*                                                                  1534 08070000
         ST    @09,@AL00001                                        1534 08071000
         LA    @03,@CF00115                                        1534 08072000
         ST    @03,@AL00001+4                                      1534 08073000
         LA    @03,SSDLPTR                                         1534 08074000
         ST    @03,@AL00001+8                                      1534 08075000
         MVI   @AL00001+8,X'80'                                    1534 08076000
         L     @15,GDTPRT(,@09)                                    1534 08077000
         LA    @01,@AL00001                                        1534 08078000
         BALR  @14,@15                                             1534 08079000
*       /*************************************************************/ 08080000
*       /*                                                           */ 08081000
*       /*                                                   @Y30LB39*/ 08082000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 08083000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 08084000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 08085000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 08086000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 08087000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 08088000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 08089000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 08090000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 08091000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 08092000
*       /* REASON CODE.                                      @Y30LB39*/ 08093000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 08094000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 08095000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 08096000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 08097000
*       /*                                                   @Y30LB39*/ 08098000
*       /*                                                           */ 08099000
*       /*************************************************************/ 08100000
*                                                                  1535 08101000
*                                   /*                       @Y30LB39*/ 08102000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 08103000
         LA    ENTRYNUM,1                                          1535 08104000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1536 08105000
@DL01536 DS    0H                                                  1537 08106000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 08107000
         AL    ENTRYNUM,@CF00219                                   1537 08108000
*       END;                        /*                       @Y30LB39   08109000
*                                                            @Y30LB39*/ 08110000
*                                                                  1538 08111000
@DE01536 L     @09,@PC00017                                        1538 08112000
         LR    @03,ENTRYNUM                                        1538 08113000
         ALR   @03,@03                                             1538 08114000
         LH    @03,SSARRAY-2(@03)                                  1538 08115000
         CH    @03,SSRHALF(,@09)                                   1538 08116000
         BE    @DC01536                                            1538 08117000
         SLR   @15,@15                                             1538 08118000
         CR    @03,@15                                             1538 08119000
         BNE   @DL01536                                            1538 08120000
@DC01536 DS    0H                                                  1539 08121000
*       /*************************************************************/ 08122000
*       /*                                                           */ 08123000
*       /*                                                   @Y30LB39*/ 08124000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 08125000
*       /*                                                   @Y30LB39*/ 08126000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 08127000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 08128000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 08129000
*       /* CODE OR                                           @Y30LB39*/ 08130000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 08131000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 08132000
*       /*                                                   @Y30LB39*/ 08133000
*       /*                                                           */ 08134000
*       /*************************************************************/ 08135000
*                                                                  1539 08136000
*                                   /*                       @Y30LB39*/ 08137000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08138000
         XC    SSDRGLT(20),SSDRGLT                                 1539 08139000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 08140000
         L     @14,SSDLPTR                                         1540 08141000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1540 08142000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 08143000
         STC   ENTRYNUM,DARGSENT(,@14)                             1541 08144000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 08145000
         CR    @03,@15                                             1542 08146000
         BNE   @RF01542                                            1542 08147000
*         DO;                       /*                       @Y30LB39*/ 08148000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 08149000
         ST    @09,DARGDBP(,@14)                                   1544 08150000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 08151000
         MVC   DARGILP(2,@14),@CH00042                             1545 08152000
*         END;                      /*                       @Y30LB39*/ 08153000
*     END;                          /*                       @Y30LB39*/ 08154000
*                                   /*                       @Y30LB39*/ 08155000
*                                                                  1548 08156000
*   /*****************************************************************/ 08157000
*   /*                                                               */ 08158000
*   /*                                                       @Y30LB39*/ 08159000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 08160000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 08161000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 08162000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 08163000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 08164000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 08165000
*   /* POST CODE.                                            @Y30LB39*/ 08166000
*   /*                                                       @Y30LB39*/ 08167000
*   /*                                                               */ 08168000
*   /*****************************************************************/ 08169000
*                                                                  1548 08170000
*                                   /*                       @Y30LB39*/ 08171000
*   ELSE                            /*                       @Y30LB39*/ 08172000
*     DO;                           /*                       @Y30LB39*/ 08173000
         B     @RC01527                                            1548 08174000
@RF01527 DS    0H                                                  1549 08175000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 08176000
         XC    SSDRGLT(20),SSDRGLT                                 1549 08177000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 08178000
         L     @09,SSDLPTR                                         1550 08179000
         MVC   DARGSMOD(3,@09),SSMODCM0                            1550 08180000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 08181000
         MVC   DARGSENT(1,@09),SSMSGNUM                            1551 08182000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 08183000
         L     @15,@PC00017+4                                      1552 08184000
         ST    @15,DARGDBP(,@09)                                   1552 08185000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 08186000
         MVC   DARGILP(2,@09),@CH00219                             1553 08187000
*     END;                          /*                       @Y30LB39   08188000
*                                                            @Y30LB39*/ 08189000
*                                                                  1554 08190000
*   /*****************************************************************/ 08191000
*   /*                                                               */ 08192000
*   /*                                                       @Y30LB39*/ 08193000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 08194000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 08195000
*   /*                                                       @Y30LB39*/ 08196000
*   /*                                                               */ 08197000
*   /*****************************************************************/ 08198000
*                                                                  1555 08199000
*                                   /*                       @Y30LB39*/ 08200000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   08201000
*                                                            @Y30LB39*/ 08202000
*                                                                  1555 08203000
@RC01527 L     @09,@PC00001                                        1555 08204000
         ST    @09,@AL00001                                        1555 08205000
         LA    @15,@CF00115                                        1555 08206000
         ST    @15,@AL00001+4                                      1555 08207000
         LA    @15,SSDLPTR                                         1555 08208000
         ST    @15,@AL00001+8                                      1555 08209000
         MVI   @AL00001+8,X'80'                                    1555 08210000
         L     @15,GDTPRT(,@09)                                    1555 08211000
         LA    @01,@AL00001                                        1555 08212000
         BALR  @14,@15                                             1555 08213000
*   /*****************************************************************/ 08214000
*   /*                                                               */ 08215000
*   /*                                                       @Y30LB39*/ 08216000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 08217000
*   /*                                                       @Y30LB39*/ 08218000
*   /*                                                               */ 08219000
*   /*****************************************************************/ 08220000
*                                                                  1556 08221000
*                                   /*                       @Y30LB39   08222000
*                                                            @Y30LB39*/ 08223000
*   RETURN CODE(0);                 /*                       @Y30LB39   08224000
*                                                            @Y30LB39*/ 08225000
         SLR   @15,@15                                             1556 08226000
         L     @14,@SA00017                                        1556 08227000
         LM    @00,@12,@SA00017+8                                  1556 08228000
         BR    @14                                                 1556 08229000
*   END SSCMSG;                     /*                       @Y30LB39*/ 08230000
*                                                                  1558 08231000
*   /*****************************************************************/ 08232000
*   /*                                                               */ 08233000
*   /*                                                       @Y30LB39*/ 08234000
*   /* THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO            @Y30LB39*/ 08235000
*   /* SCRATCH A COPY VOLUME.                                @Y30LB39*/ 08236000
*   /*                                                       @Y30LB39*/ 08237000
*   /*                                                               */ 08238000
*   /*****************************************************************/ 08239000
*                                                                  1558 08240000
*                                   /*                       @Y30LB39*/ 08241000
*/********************************************************************/ 08242000
*/*                                                          @Y30LB11*/ 08243000
*/* PROCEDURE NAME - SCRCOPY                                 @Y30LB11*/ 08244000
*/*                                                          @Y30LB11*/ 08245000
*/* FUNCTION - THE PRINCIPLE FUNCTION OF THIS ROUTINE IS TO  @Y30LB11*/ 08246000
*/*            SCRATCH AN MSS COPY VOLUME.                   @Y30LB11*/ 08247000
*/*                                                          @Y30LB11*/ 08248000
*/*            IDC0088I CARTRIDGES CSN (CSN) SCRATCHED FOR   @Y30LB11*/ 08249000
*/*            COPY YYDDD.                                   @Y30LB11*/ 08250000
*/*                                                          @Y30LB11*/ 08251000
*/*            IDC0098I ** LOCATION OF VOLUME: (LOCATION)    @Y30LB11*/ 08252000
*/*                                                          @Y30LB11*/ 08253000
*/*            IDC2076I ** CART CSN (CSN) NOT IN MSF FOR     @Y30LB11*/ 08254000
*/*            COPY YYDDD.                                   @Y30LB11*/ 08255000
*/*                                                          @Y30LB11*/ 08256000
*/*            IDC2087I ** CART CSN (CSN) NOT SCRATCHED FOR  @Y30LB11*/ 08257000
*/*            COPY YYDDD.                                   @Y30LB11*/ 08258000
*/*                                                          @Y30LB11*/ 08259000
*/* INPUT - A PARAMETER CONSISTING OF A SINGLE BYTE.  THE    @Y30LB11*/ 08260000
*/*         FIRST BIT OF THE BYTE IS SET TO '1' BY SCRCOPY   @Y30LB11*/ 08261000
*/*         AN ERROR OCCURS UPDATING THE INVENTORY.          @Y30LB11*/ 08262000
*/*                                                          @Y30LB11*/ 08263000
*/*         THE COPY RECORD MUST HAVE BEEN READ AND THE      @Y30LB11*/ 08264000
*/*         COPYV MAPPING MACRO BASED ON THE RECORD PRIOR TO @Y30LB11*/ 08265000
*/*         THE CALL TO SCRCOPY.   FURTHER, THE DEFLIST      @Y30LB11*/ 08266000
*/*         MUST HAVE BEEN INCLUDED PRIOR TO THE CALL TO     @Y30LB11*/ 08267000
*/*         SCRCOPY.                                         @Y30LB11*/ 08268000
*/*                                                          @Y30LB11*/ 08269000
*/* OUTPUT - FIRST BIT OF INPUT BYTE SET IF INVENTORY ERROR. @Y30LB11*/ 08270000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB11*/ 08271000
*/*                                                          @Y30LB11*/ 08272000
*/*          0 - CARTRIDGE OR CARTRIDGES FOR COPY VOLUME     @Y30LB11*/ 08273000
*/*              SCRATCHED SUCCESSFULLY.                     @Y30LB11*/ 08274000
*/*                                                          @Y30LB11*/ 08275000
*/*          4 - CARTRIDGES NOT IN LIBRARY, OR DSM FAILURE   @Y30LB11*/ 08276000
*/*              OCCURRED.                                   @Y30LB11*/ 08277000
*/*                                                          @Y30LB11*/ 08278000
*/*          8 - USSC UMACRO COULD NOT OBTAIN STORAGE        @Y30LB11*/ 08279000
*/*              FOR ECB/MESSAGE AREA.                       @Y30LB11*/ 08280000
*/*                                                          @Y30LB11*/ 08281000
*/********************************************************************/ 08282000
*                                                                  1558 08283000
*SCRCOPY:                           /*                       @Y30LB11*/ 08284000
*   PROCEDURE(SCINPUT);             /*                       @Y30LB11*/ 08285000
SCRCOPY  STM   @14,@12,@SA00018                                    1558 08286000
         MVC   @PC00018(4),0(@01)                                  1558 08287000
*   DCL                                                            1559 08288000
*     SCCMPTR PTR(31);              /* PTR TO ECB/MSG AREA   @Y30LB11*/ 08289000
*   DCL                                                            1560 08290000
*     SCECBCD FIXED(8);             /* SCRCOPY ECB CODE      @Y30LB11*/ 08291000
*   DCL                                                            1561 08292000
*     SCRCOND FIXED(15);            /* SCRCOPY COND CODE     @Y30LB11*/ 08293000
*   DCL                                                            1562 08294000
*     SCMSGCD PTR(31);              /* SSCMSG REASON CODE    @Y30LB11*/ 08295000
*   DCL                                                            1563 08296000
*     SCMSGPTR PTR(31);             /* MESSAGE AREA POINTER  @Y30LB11*/ 08297000
*   DCL                                                            1564 08298000
*     SCDEFLST CHAR(LENGTH(DEFLIST));/* SCRCOPY DEFLIST      @Y30LB11*/ 08299000
*   DCL                                                            1565 08300000
*     SCDEFPTR PTR(31);             /* DEFLIST POINTER       @Y30LB11*/ 08301000
*   DCL                                                            1566 08302000
*     SCDDSTRU PTR(31);             /* DARGLIST POINTER      @Y30LB11*/ 08303000
*                                                                  1566 08304000
*   /*****************************************************************/ 08305000
*   /*                                                               */ 08306000
*   /* DARGLIST WITH UP TO 3 INSERTS                         @Y30LB11*/ 08307000
*   /*                                                               */ 08308000
*   /*****************************************************************/ 08309000
*                                                                  1567 08310000
*   DCL                                                            1567 08311000
*     SCDARG CHAR(LENGTH(DARGLIST)+2*(LENGTH(DARGARY)));/*   @Y30LB11*/ 08312000
*   DCL                                                            1568 08313000
*     1 SCINPUT BIT(8),             /* PARAMETER LIST        @Y30LB11*/ 08314000
*      2 SCERRFLG BIT(1),           /* RETURNED FLAG         @Y30LB11*/ 08315000
*      2 * BIT(7);                  /* UNUSED                @Y30LB11*/ 08316000
*                                                                  1568 08317000
*   /*****************************************************************/ 08318000
*   /*                                                               */ 08319000
*   /* CONSTANT SECTION DECLARATIONS FOR SCRCOPY             @Y30LB11*/ 08320000
*   /*                                                               */ 08321000
*   /*****************************************************************/ 08322000
*                                                                  1569 08323000
*   DCL                                                            1569 08324000
*     1 SCBLANKS CHAR(30) STATIC LOCAL,/* BLANK FIELD        @Y30LB11*/ 08325000
*      2 *(30) CHAR(1) INIT((30)'40'X);/*                    @Y30LB11*/ 08326000
*   DCL                                                            1570 08327000
*     SCCSN2# FIXED(15) CONSTANT(1);/* CSN2 INSERT           @Y30LB11*/ 08328000
*   DCL                                                            1571 08329000
*     SCDATE# FIXED(15) CONSTANT(2);/* DATE INSERT           @Y30LB11*/ 08330000
*   DCL                                                            1572 08331000
*     SCECBLEN FIXED(15) CONSTANT(4);/* ECB LENGTH           @Y30LB11*/ 08332000
*   DCL                                                            1573 08333000
*     SCNOCSNS BIT(8) CONSTANT('23'X);/* NEITHER CSN FOUND   @Y30LB11*/ 08334000
*   DCL                                                            1574 08335000
*     SCNOCSN1 BIT(8) CONSTANT('26'X);/* CSN1 NOT FOUND      @Y30LB11*/ 08336000
*   DCL                                                            1575 08337000
*     SCNOCSN2 BIT(8) CONSTANT('2A'X);/* CSN2 NOT FOUND      @Y30LB11*/ 08338000
*   DCL                                                            1576 08339000
*     SCCOMMSG CHAR(3) CONSTANT('CM0');/* STATIC TEST MOD    @Y30LB11*/ 08340000
*   DCL                                                            1577 08341000
*     SCM0088I PTR(8) CONSTANT(18); /* CARTS SCRATCHED       @Y30LB11*/ 08342000
*   DCL                                                            1578 08343000
*     SCM0098I PTR(8) CONSTANT(2);  /* LOCATION OF VOLUME    @Y30LB11*/ 08344000
*   DCL                                                            1579 08345000
*     SCM2076I PTR(8) CONSTANT(30); /* CART NOT SCRATCHED    @Y30LB11*/ 08346000
*   DCL                                                            1580 08347000
*     SCM2087I PTR(8) CONSTANT(19); /* CARTS NOT IN LIBRARY  @Y30LB11*/ 08348000
*                                                                  1581 08349000
*   /*****************************************************************/ 08350000
*   /*                                                               */ 08351000
*   /* TRACE AT ENTRY TO SCRCOPY PROCEDURE                   @Y30LB11*/ 08352000
*   /*                                                               */ 08353000
*   /*****************************************************************/ 08354000
*                                                                  1581 08355000
*   OLDERID2=NEWERID2;                                             1581 08356000
         L     @09,@PC00001                                        1581 08357000
         L     @15,GDTTR2(,@09)                                    1581 08358000
         MVC   @TS00001(95),NEWERID2(@15)                          1581 08359000
         MVC   OLDERID2(95,@15),@TS00001                           1581 08360000
*   NEWID2='SCSC';                  /*                       @Y30LB11*/ 08361000
*                                                                  1582 08362000
         MVC   NEWID2(4,@15),@CC01902                              1582 08363000
*   /*****************************************************************/ 08364000
*   /*                                                               */ 08365000
*   /* INITIALIZATION CONSISTS OF ZEROING THE RETURN CODE, ZEROING   */ 08366000
*   /* THE DEFLIST, AND THE PRINT ARGUMENT LIST.             @Y30LB11*/ 08367000
*   /*                                                               */ 08368000
*   /*****************************************************************/ 08369000
*                                                                  1583 08370000
*   SCRCOND=0;                      /*                       @Y30LB11*/ 08371000
         SLR   @15,@15                                             1583 08372000
         LR    SCRCOND,@15                                         1583 08373000
*   SCDDSTRU=ADDR(SCDARG);          /*                       @Y30LB11*/ 08374000
         LA    @14,SCDARG                                          1584 08375000
         ST    @14,SCDDSTRU                                        1584 08376000
*   SCDEFPTR=ADDR(SCDEFLST);        /*                       @Y30LB11*/ 08377000
         LA    @07,SCDEFLST                                        1585 08378000
         ST    @07,SCDEFPTR                                        1585 08379000
*   SCDEFLST=''B;                   /*                       @Y30LB11*/ 08380000
         XC    SCDEFLST(132),SCDEFLST                              1586 08381000
*   SCDARG=''B;                     /*                       @Y30LB11*/ 08382000
         XC    SCDARG(36),SCDARG                                   1587 08383000
*   SCDDSTRU->DARGSMOD=SCCOMMSG;    /* COMMON MESSAGE MODULE @Y30LB11*/ 08384000
*                                                                  1588 08385000
         MVC   DARGSMOD(3,@14),@CC01550                            1588 08386000
*   /*****************************************************************/ 08387000
*   /*                                                               */ 08388000
*   /* INDICATE AN INACTIVE VOLUME IS TO BE SCRATCHED AND PICK UP THE*/ 08389000
*   /* CSN1 FROM THE COPY RECORD.                            @Y30LB11*/ 08390000
*   /*                                                               */ 08391000
*   /*****************************************************************/ 08392000
*                                                                  1589 08393000
*   SCDEFPTR->DEFVELTR=ON;          /*                       @Y30LB11*/ 08394000
         OI    DEFVELTR(@07),B'00001000'                           1589 08395000
*   SCDEFPTR->DEFVCSN1=COPCSN1;     /*                       @Y30LB11*/ 08396000
*                                                                  1590 08397000
         MVC   DEFVCSN1(12,@07),COPCSN1(COPYVPTR)                  1590 08398000
*   /*****************************************************************/ 08399000
*   /*                                                               */ 08400000
*   /* FULL REGION DUMP BEFORE EXECUTING THE ICBDEFV MACRO.  @Y30LB11*/ 08401000
*   /*                                                               */ 08402000
*   /*****************************************************************/ 08403000
*                                                                  1591 08404000
*   IF GDTDBG=NULLPTR THEN                                         1591 08405000
         C     @15,GDTDBG(,@09)                                    1591 08406000
         BE    @RT01591                                            1591 08407000
*     ;                                                            1592 08408000
*   ELSE                                                           1593 08409000
*     CALL IDCDB010(GDTTBL,'SCDF'); /*                       @Y30LB11*/ 08410000
*                                                                  1593 08411000
         L     @09,@PC00001                                        1593 08412000
         ST    @09,@AL00001                                        1593 08413000
         LA    @15,@CC01903                                        1593 08414000
         ST    @15,@AL00001+4                                      1593 08415000
         MVI   @AL00001+4,X'80'                                    1593 08416000
         L     @15,GDTDBG(,@09)                                    1593 08417000
         LA    @01,@AL00001                                        1593 08418000
         BALR  @14,@15                                             1593 08419000
*   /*****************************************************************/ 08420000
*   /*                                                               */ 08421000
*   /* THE USSC MACRO IS ISSUED TO EXECUTE THE ICBDEFV MACRO @Y30LB11*/ 08422000
*   /* TO SCRATCH THE COPY.                                  @Y30LB11*/ 08423000
*   /*                                                               */ 08424000
*   /*****************************************************************/ 08425000
*                                                                  1594 08426000
*   CALL IDCSASS0(GDTTBL,DEFINE,SCDEFPTR,SCMSGCD,SCECBCD,SCMSGPTR);/*   08427000
*                                                            @Y30LB11*/ 08428000
@RT01591 L     @09,@PC00001                                        1594 08429000
         ST    @09,@AL00001                                        1594 08430000
         LA    @02,DEFINE                                          1594 08431000
         ST    @02,@AL00001+4                                      1594 08432000
         LA    @02,SCDEFPTR                                        1594 08433000
         ST    @02,@AL00001+8                                      1594 08434000
         LA    @02,SCMSGCD                                         1594 08435000
         ST    @02,@AL00001+12                                     1594 08436000
         LA    @02,SCECBCD                                         1594 08437000
         ST    @02,@AL00001+16                                     1594 08438000
         LA    @02,SCMSGPTR                                        1594 08439000
         ST    @02,@AL00001+20                                     1594 08440000
         MVI   @AL00001+20,X'80'                                   1594 08441000
         L     @15,GDTSSC(,@09)                                    1594 08442000
         LA    @01,@AL00001                                        1594 08443000
         BALR  @14,@15                                             1594 08444000
*   RESPECIFY                                                      1595 08445000
*     RTNREG RSTD;                                                 1595 08446000
*   TESTRC=RTNREG;                                                 1596 08447000
         LR    TESTRC,RTNREG                                       1596 08448000
*   RESPECIFY                                                      1597 08449000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 08450000
*                                                                  1598 08451000
*   /*****************************************************************/ 08452000
*   /*                                                               */ 08453000
*   /* A RETURN CODE OF 0 OR 12 INDICATES THAT THE MACRO WAS EXECUTED*/ 08454000
*   /* SUCCESSFULLY.                                         @Y30LB11*/ 08455000
*   /*                                                               */ 08456000
*   /*****************************************************************/ 08457000
*                                                                  1598 08458000
*   IF TESTRC=0|TESTRC=12 THEN      /*                       @Y30LB11*/ 08459000
         LTR   TESTRC,TESTRC                                       1598 08460000
         BZ    @RT01598                                            1598 08461000
         C     TESTRC,@CF00567                                     1598 08462000
         BNE   @RF01598                                            1598 08463000
@RT01598 DS    0H                                                  1599 08464000
*     DO;                           /*                       @Y30LB11*/ 08465000
*                                                                  1599 08466000
*       /*************************************************************/ 08467000
*       /*                                                           */ 08468000
*       /* IF A RETURN CODE OF 12 IS PASSED, SCERRFLG IS SET ON TO   */ 08469000
*       /* INDICATE THAT THE INVENTORY RECORD WAS NOT UPDATED.       */ 08470000
*       /*                                                   @Y30LB11*/ 08471000
*       /*                                                           */ 08472000
*       /*************************************************************/ 08473000
*                                                                  1600 08474000
*       IF TESTRC=12 THEN           /*                       @Y30LB11*/ 08475000
         C     TESTRC,@CF00567                                     1600 08476000
         BNE   @RF01600                                            1600 08477000
*         SCERRFLG=ON;              /*                       @Y30LB11*/ 08478000
*                                                                  1601 08479000
         L     @09,@PC00018                                        1601 08480000
         OI    SCERRFLG(@09),B'10000000'                           1601 08481000
*       /*************************************************************/ 08482000
*       /*                                                           */ 08483000
*       /* THE MESSAGE: CARTRIDGES CSN (CSN) SCRATCHED FOR COPY      */ 08484000
*       /* YYDDD, IS ISSUED.                                 @Y30LB11*/ 08485000
*       /*                                                           */ 08486000
*       /*************************************************************/ 08487000
*                                                                  1602 08488000
*       SCCMPTR=SCMSGPTR+SCECBLEN;  /*                       @Y30LB11*/ 08489000
@RF01600 LA    @09,4                                               1602 08490000
         L     SCCMPTR,SCMSGPTR                                    1602 08491000
         ALR   SCCMPTR,@09                                         1602 08492000
*       SCDDSTRU->DARGSENT=SCM0088I;/*                       @Y30LB11*/ 08493000
         L     @03,SCDDSTRU                                        1603 08494000
         MVI   DARGSENT(@03),X'12'                                 1603 08495000
*       SCDDSTRU->DARGDBP=ADDR(SCCMPTR->CMCSN1);/*           @Y30LB11*/ 08496000
         LA    @15,CMCSN1(,SCCMPTR)                                1604 08497000
         ST    @15,DARGDBP(,@03)                                   1604 08498000
*       SCDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB11*/ 08499000
         LA    @15,12                                              1605 08500000
         STH   @15,DARGILP(,@03)                                   1605 08501000
*       SCDDSTRU->DARGCNT=2;        /*                       @Y30LB11*/ 08502000
         LA    @14,2                                               1606 08503000
         STH   @14,DARGCNT(,@03)                                   1606 08504000
*       SCDDSTRU->DARGINS(1)=SCCSN2#;/*                      @Y30LB11*/ 08505000
         MVC   DARGINS(2,@03),@CH00219                             1607 08506000
*       SCDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*               @Y30LB11*/ 08507000
         STH   @15,DARGINL(,@03)                                   1608 08508000
*       SCDDSTRU->DARGDTM(1)=ADDR(SCCMPTR->CMCSN2);/*        @Y30LB11*/ 08509000
         LA    @15,CMCSN2(,SCCMPTR)                                1609 08510000
         ST    @15,DARGDTM(,@03)                                   1609 08511000
*       SCDDSTRU->DARGINS(2)=SCDATE#;/*                      @Y30LB11*/ 08512000
         STH   @14,DARGINS+8(,@03)                                 1610 08513000
*       SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*              @Y30LB11*/ 08514000
         STH   @09,DARGINL+8(,@03)                                 1611 08515000
*       SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*                @Y30LB11*/ 08516000
         LA    @09,COPDATE(,COPYVPTR)                              1612 08517000
         ST    @09,DARGDTM+8(,@03)                                 1612 08518000
*       CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*            @Y30LB11*/ 08519000
*                                                                  1613 08520000
         L     @09,@PC00001                                        1613 08521000
         ST    @09,@AL00001                                        1613 08522000
         LA    @15,@CF00115                                        1613 08523000
         ST    @15,@AL00001+4                                      1613 08524000
         LA    @15,SCDDSTRU                                        1613 08525000
         ST    @15,@AL00001+8                                      1613 08526000
         MVI   @AL00001+8,X'80'                                    1613 08527000
         L     @15,GDTPRT(,@09)                                    1613 08528000
         LA    @01,@AL00001                                        1613 08529000
         BALR  @14,@15                                             1613 08530000
*       /*************************************************************/ 08531000
*       /*                                                           */ 08532000
*       /* BECAUSE THE MESSAGE AREA POINTER IS SET, AND THE ICBDEFV  */ 08533000
*       /* MACRO IS SUCCESSFUL, THE UFSPACE IS ISSUED TO FREE THE    */ 08534000
*       /* ECB/MESSAGE AREA GOTTEN BY THE ICBDEFV MACRO.     @Y30LB11*/ 08535000
*       /*                                                           */ 08536000
*       /*************************************************************/ 08537000
*                                                                  1614 08538000
*       CALL IDCSAFS0(GDTTBL,SCMSGPTR);/*                    @Y30LB11*/ 08539000
         L     @09,@PC00001                                        1614 08540000
         ST    @09,@AL00001                                        1614 08541000
         LA    @15,SCMSGPTR                                        1614 08542000
         ST    @15,@AL00001+4                                      1614 08543000
         L     @15,GDTFSP(,@09)                                    1614 08544000
         LA    @01,@AL00001                                        1614 08545000
         BALR  @14,@15                                             1614 08546000
*     END;                          /*                       @Y30LB11*/ 08547000
*                                                                  1616 08548000
*   /*****************************************************************/ 08549000
*   /*                                                               */ 08550000
*   /* A RETURN CODE OF 4 OR 8 INDICATES THAT THE MACRO WAS NOT      */ 08551000
*   /* EXECUTED SUCCESSFULLY.                                @Y30LB11*/ 08552000
*   /*                                                               */ 08553000
*   /*****************************************************************/ 08554000
*                                                                  1616 08555000
*   ELSE                            /*                       @Y30LB11*/ 08556000
*     DO;                           /*                       @Y30LB11*/ 08557000
*                                                                  1616 08558000
         B     @RC01598                                            1616 08559000
@RF01598 DS    0H                                                  1617 08560000
*       /*************************************************************/ 08561000
*       /*                                                           */ 08562000
*       /* A RETURN CODE OF 8 FROM THE ICBDEFV MACRO INDICATES THAT  */ 08563000
*       /* NO CORE WAS AVAILABLE FOR THE ECB/MESSAGE AREA. THE       */ 08564000
*       /* MESSAGE: ** CART CSN (CSN) NOT SCRATCHED COPY YYDDD, IS   */ 08565000
*       /* ISSUED AND THE RETURN CODE IS SET TO 8.           @Y30LB11*/ 08566000
*       /*                                                           */ 08567000
*       /*************************************************************/ 08568000
*                                                                  1617 08569000
*       IF TESTRC=8 THEN            /*                       @Y30LB11*/ 08570000
         C     TESTRC,@CF00179                                     1617 08571000
         BNE   @RF01617                                            1617 08572000
*         DO;                       /*                       @Y30LB11*/ 08573000
*           SCDDSTRU->DARGSENT=SCM2087I;/*                   @Y30LB11*/ 08574000
         L     @09,SCDDSTRU                                        1619 08575000
         MVI   DARGSENT(@09),X'13'                                 1619 08576000
*           SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*               @Y30LB11*/ 08577000
         LA    @15,COPCSN1(,COPYVPTR)                              1620 08578000
         ST    @15,DARGDBP(,@09)                                   1620 08579000
*           SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*             @Y30LB11*/ 08580000
         LA    @15,12                                              1621 08581000
         STH   @15,DARGILP(,@09)                                   1621 08582000
*           SCDDSTRU->DARGCNT=2;    /*                       @Y30LB11*/ 08583000
         LA    @14,2                                               1622 08584000
         STH   @14,DARGCNT(,@09)                                   1622 08585000
*           SCDDSTRU->DARGINS(1)=SCCSN2#;/*                  @Y30LB11*/ 08586000
         MVC   DARGINS(2,@09),@CH00219                             1623 08587000
*           SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*          @Y30LB11*/ 08588000
         STH   @15,DARGINL(,@09)                                   1624 08589000
*           SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*            @Y30LB11*/ 08590000
         LA    @15,COPCSN2(,COPYVPTR)                              1625 08591000
         ST    @15,DARGDTM(,@09)                                   1625 08592000
*           SCDDSTRU->DARGINS(2)=SCDATE#;/*                  @Y30LB11*/ 08593000
         STH   @14,DARGINS+8(,@09)                                 1626 08594000
*           SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*          @Y30LB11*/ 08595000
         MVC   DARGINL+8(2,@09),@CH00042                           1627 08596000
*           SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*            @Y30LB11*/ 08597000
         LA    @15,COPDATE(,COPYVPTR)                              1628 08598000
         ST    @15,DARGDTM+8(,@09)                                 1628 08599000
*           CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*        @Y30LB11*/ 08600000
*                                                                  1629 08601000
         L     @09,@PC00001                                        1629 08602000
         ST    @09,@AL00001                                        1629 08603000
         LA    @15,@CF00115                                        1629 08604000
         ST    @15,@AL00001+4                                      1629 08605000
         LA    @15,SCDDSTRU                                        1629 08606000
         ST    @15,@AL00001+8                                      1629 08607000
         MVI   @AL00001+8,X'80'                                    1629 08608000
         L     @15,GDTPRT(,@09)                                    1629 08609000
         LA    @01,@AL00001                                        1629 08610000
         BALR  @14,@15                                             1629 08611000
*           /*********************************************************/ 08612000
*           /*                                                       */ 08613000
*           /* SET THE RETURN CODE TO 8 INDICATING THAT THE USSC     */ 08614000
*           /* UMACRO COULD NOT OBTAIN STORAGE FOR THE ECB/MESSAGE   */ 08615000
*           /* AREA.                                         @Y30LB11*/ 08616000
*           /*                                                       */ 08617000
*           /*********************************************************/ 08618000
*                                                                  1630 08619000
*           SCRCOND=8;              /*                       @Y30LB11*/ 08620000
         LA    SCRCOND,8                                           1630 08621000
*         END;                      /*                       @Y30LB11*/ 08622000
*                                                                  1631 08623000
*       /*************************************************************/ 08624000
*       /*                                                           */ 08625000
*       /* A RETURN CODE OF 4 INDICATES THAT THE ICBDEFV MACRO WAS   */ 08626000
*       /* EXECUTED, BUT FAILED.                             @Y30LB11*/ 08627000
*       /*                                                           */ 08628000
*       /*************************************************************/ 08629000
*                                                                  1632 08630000
*       ELSE                        /*                       @Y30LB11*/ 08631000
*         DO;                       /*                       @Y30LB11*/ 08632000
*                                                                  1632 08633000
         B     @RC01617                                            1632 08634000
@RF01617 DS    0H                                                  1633 08635000
*           /*********************************************************/ 08636000
*           /*                                                       */ 08637000
*           /* THE SSCMSG ROUTINE IS CALLED TO PRINT COMMON MESSAGES */ 08638000
*           /* FROM IDCTSSS0 AND IDCTSSS1 AS DIRECTED BY THE REASON  */ 08639000
*           /* CODE PASSED BACK FROM THE ICBDEFV MACRO.      @Y30LB11*/ 08640000
*           /*                                                       */ 08641000
*           /*********************************************************/ 08642000
*                                                                  1633 08643000
*           CALL SSCMSG(SCMSGCD);   /*                       @Y30LB11*/ 08644000
*                                                                  1633 08645000
         LA    @09,SCMSGCD                                         1633 08646000
         ST    @09,@AL00001                                        1633 08647000
         LA    @01,@AL00001                                        1633 08648000
         BAL   @14,SSCMSG                                          1633 08649000
*           /*********************************************************/ 08650000
*           /*                                                       */ 08651000
*           /* IF EITHER OR BOTH CARTRIDGES ARE NOT IN THE MSF A     */ 08652000
*           /* MESSAGE INDICATING THAT SITUATION IS PRINTED. @Y30LB11*/ 08653000
*           /*                                                       */ 08654000
*           /*********************************************************/ 08655000
*                                                                  1634 08656000
*           IF SCMSGCD=SCNOCSN1|    /*                       @Y30LB11*/ 08657000
*               SCMSGCD=SCNOCSN2|   /*                       @Y30LB11*/ 08658000
*               SCMSGCD=SCNOCSNS THEN/*                      @Y30LB11*/ 08659000
         L     @09,SCMSGCD                                         1634 08660000
         C     @09,@CF01892                                        1634 08661000
         BE    @RT01634                                            1634 08662000
         C     @09,@CF01894                                        1634 08663000
         BE    @RT01634                                            1634 08664000
         C     @09,@CF01890                                        1634 08665000
         BNE   @RF01634                                            1634 08666000
@RT01634 DS    0H                                                  1635 08667000
*             DO;                   /*                       @Y30LB11*/ 08668000
*                                                                  1635 08669000
*               /*****************************************************/ 08670000
*               /*                                                   */ 08671000
*               /* SET UP TO ISSUE MESSAGE THAT CARTS ARE OUT OF THE */ 08672000
*               /* MSF.                                      @Y30LB11*/ 08673000
*               /*                                                   */ 08674000
*               /*****************************************************/ 08675000
*                                                                  1636 08676000
*               SCDDSTRU->DARGSENT=SCM2076I;/*               @Y30LB11*/ 08677000
*                                                                  1636 08678000
         L     @09,SCDDSTRU                                        1636 08679000
         MVI   DARGSENT(@09),X'1E'                                 1636 08680000
*               /*****************************************************/ 08681000
*               /*                                                   */ 08682000
*               /* INSERT COPYDATE FROM COPY RECORD          @Y30LB11*/ 08683000
*               /*                                                   */ 08684000
*               /*****************************************************/ 08685000
*                                                                  1637 08686000
*               SCDDSTRU->DARGINS(1)=SCDATE#;/*              @Y30LB11*/ 08687000
         LA    @04,2                                               1637 08688000
         STH   @04,DARGINS(,@09)                                   1637 08689000
*               SCDDSTRU->DARGINL(1)=LENGTH(COPDATE);/*      @Y30LB11*/ 08690000
         MVC   DARGINL(2,@09),@CH00042                             1638 08691000
*               SCDDSTRU->DARGDTM(1)=ADDR(COPDATE);/*        @Y30LB11*/ 08692000
*                                                                  1639 08693000
         LA    @15,COPDATE(,COPYVPTR)                              1639 08694000
         ST    @15,DARGDTM(,@09)                                   1639 08695000
*               /*****************************************************/ 08696000
*               /*                                                   */ 08697000
*               /* IF 2 CARTS OUT OF LIBRARY, INSERT 2 CSNS  @Y30LB11*/ 08698000
*               /*                                                   */ 08699000
*               /*****************************************************/ 08700000
*                                                                  1640 08701000
*               IF SCMSGCD=SCNOCSNS THEN                           1640 08702000
         CLC   SCMSGCD(4),@CF01890                                 1640 08703000
         BNE   @RF01640                                            1640 08704000
*                 DO;               /*                       @Y30LB11*/ 08705000
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/ 08706000
         LA    @15,COPCSN1(,COPYVPTR)                              1642 08707000
         ST    @15,DARGDBP(,@09)                                   1642 08708000
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/ 08709000
         LA    @15,12                                              1643 08710000
         STH   @15,DARGILP(,@09)                                   1643 08711000
*                   SCDDSTRU->DARGCNT=2;/*                   @Y30LB11*/ 08712000
         STH   @04,DARGCNT(,@09)                                   1644 08713000
*                   SCDDSTRU->DARGINS(2)=SCCSN2#;/*          @Y30LB11*/ 08714000
         MVC   DARGINS+8(2,@09),@CH00219                           1645 08715000
*                   SCDDSTRU->DARGINL(2)=LENGTH(COPCSN2);/*  @Y30LB11*/ 08716000
         STH   @15,DARGINL+8(,@09)                                 1646 08717000
*                   SCDDSTRU->DARGDTM(2)=ADDR(COPCSN2);/*    @Y30LB11*/ 08718000
         LA    @04,COPCSN2(,COPYVPTR)                              1647 08719000
         ST    @04,DARGDTM+8(,@09)                                 1647 08720000
*                 END;              /*                       @Y30LB11*/ 08721000
*                                                                  1648 08722000
*               /*****************************************************/ 08723000
*               /*                                                   */ 08724000
*               /* IF CSN1 OUT OF LIBRARY, INSERT CSN1       @Y30LB11*/ 08725000
*               /*                                                   */ 08726000
*               /*****************************************************/ 08727000
*                                                                  1649 08728000
*               IF SCMSGCD=SCNOCSN1 THEN                           1649 08729000
@RF01640 CLC   SCMSGCD(4),@CF01892                                 1649 08730000
         BNE   @RF01649                                            1649 08731000
*                 DO;               /*                       @Y30LB11*/ 08732000
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/ 08733000
         L     @09,SCDDSTRU                                        1651 08734000
         LA    @04,COPCSN1(,COPYVPTR)                              1651 08735000
         ST    @04,DARGDBP(,@09)                                   1651 08736000
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/ 08737000
         MVC   DARGILP(2,@09),@CH00567                             1652 08738000
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/ 08739000
         MVC   DARGCNT(2,@09),@CH00219                             1653 08740000
*                 END;              /*                       @Y30LB11*/ 08741000
*                                                                  1654 08742000
*               /*****************************************************/ 08743000
*               /*                                                   */ 08744000
*               /* IF CSN2 OUT OF LIBRARY, INSERT CSN2       @Y30LB11*/ 08745000
*               /*                                                   */ 08746000
*               /*****************************************************/ 08747000
*                                                                  1655 08748000
*               IF SCMSGCD=SCNOCSN2 THEN                           1655 08749000
@RF01649 CLC   SCMSGCD(4),@CF01894                                 1655 08750000
         BNE   @RF01655                                            1655 08751000
*                 DO;               /*                       @Y30LB11*/ 08752000
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN2);/*       @Y30LB11*/ 08753000
         L     @09,SCDDSTRU                                        1657 08754000
         LA    @04,COPCSN2(,COPYVPTR)                              1657 08755000
         ST    @04,DARGDBP(,@09)                                   1657 08756000
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN2);/*     @Y30LB11*/ 08757000
         MVC   DARGILP(2,@09),@CH00567                             1658 08758000
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/ 08759000
         MVC   DARGCNT(2,@09),@CH00219                             1659 08760000
*                 END;              /*                       @Y30LB11*/ 08761000
*                                                                  1660 08762000
*               /*****************************************************/ 08763000
*               /*                                                   */ 08764000
*               /* ISSUE THE UPRINT MACRO TO PRINT THE MESSAGE       */ 08765000
*               /*                                                   */ 08766000
*               /*****************************************************/ 08767000
*                                                                  1661 08768000
*                                   /*                       @Y30LB11*/ 08769000
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/ 08770000
*                                                                  1661 08771000
@RF01655 L     @09,@PC00001                                        1661 08772000
         ST    @09,@AL00001                                        1661 08773000
         LA    @04,@CF00115                                        1661 08774000
         ST    @04,@AL00001+4                                      1661 08775000
         LA    @04,SCDDSTRU                                        1661 08776000
         ST    @04,@AL00001+8                                      1661 08777000
         MVI   @AL00001+8,X'80'                                    1661 08778000
         L     @15,GDTPRT(,@09)                                    1661 08779000
         LA    @01,@AL00001                                        1661 08780000
         BALR  @14,@15                                             1661 08781000
*               /*****************************************************/ 08782000
*               /*                                                   */ 08783000
*               /* IF THE LOCATION OF THE VOLUME HAS BEEN DETERMINED */ 08784000
*               /* THE MESSAGE: ** LOCATION OF VOLUME: (LOCATION), IS*/ 08785000
*               /* ISSUED.                                   @Y30LB11*/ 08786000
*               /*                                                   */ 08787000
*               /*****************************************************/ 08788000
*                                                                  1662 08789000
*               IF COPDEST^=SCBLANKS THEN/*                  @Y30LB11*/ 08790000
         CLC   COPDEST(30,COPYVPTR),SCBLANKS                       1662 08791000
         BE    @RF01662                                            1662 08792000
*                 DO;               /*                       @Y30LB11*/ 08793000
*                   SCDARG=''B;     /*                       @Y30LB11*/ 08794000
         XC    SCDARG(36),SCDARG                                   1664 08795000
*                   SCDDSTRU->DARGSENT=SCM0098I;/*           @Y30LB11*/ 08796000
         L     @09,SCDDSTRU                                        1665 08797000
         MVI   DARGSENT(@09),X'02'                                 1665 08798000
*                   SCDDSTRU->DARGSMOD=SCCOMMSG;/*           @Y30LB11*/ 08799000
         MVC   DARGSMOD(3,@09),@CC01550                            1666 08800000
*                   SCDDSTRU->DARGDBP=ADDR(COPDEST);/*       @Y30LB11*/ 08801000
         LA    @04,COPDEST(,COPYVPTR)                              1667 08802000
         ST    @04,DARGDBP(,@09)                                   1667 08803000
*                   SCDDSTRU->DARGILP=LENGTH(COPDEST);/*     @Y30LB11*/ 08804000
         MVC   DARGILP(2,@09),@CH01085                             1668 08805000
*                   CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*      1669 08806000
*                                                            @Y30LB11*/ 08807000
         L     @09,@PC00001                                        1669 08808000
         ST    @09,@AL00001                                        1669 08809000
         LA    @04,@CF00115                                        1669 08810000
         ST    @04,@AL00001+4                                      1669 08811000
         LA    @04,SCDDSTRU                                        1669 08812000
         ST    @04,@AL00001+8                                      1669 08813000
         MVI   @AL00001+8,X'80'                                    1669 08814000
         L     @15,GDTPRT(,@09)                                    1669 08815000
         LA    @01,@AL00001                                        1669 08816000
         BALR  @14,@15                                             1669 08817000
*                 END;              /*                       @Y30LB11*/ 08818000
*             END;                  /*                       @Y30LB11*/ 08819000
*                                                                  1671 08820000
*           /*********************************************************/ 08821000
*           /*                                                       */ 08822000
*           /* A RETURN CODE OF 4 FROM THE ICBDEFV MACRO INDICATES   */ 08823000
*           /* THAT THE ICBDEFV MACRO FAILED. A MESSAGE INDICATING   */ 08824000
*           /* THAT COPY VOLUMES WERE NOT SCRATCHED, IS PRINTED.     */ 08825000
*           /*                                               @Y30LB11*/ 08826000
*           /*                                                       */ 08827000
*           /*********************************************************/ 08828000
*                                                                  1672 08829000
*           ELSE                                                   1672 08830000
*             DO;                   /*                       @Y30LB11*/ 08831000
         B     @RC01634                                            1672 08832000
@RF01634 DS    0H                                                  1673 08833000
*               SCDDSTRU->DARGSENT=SCM2087I;/*               @Y30LB11*/ 08834000
         L     @09,SCDDSTRU                                        1673 08835000
         MVI   DARGSENT(@09),X'13'                                 1673 08836000
*               SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*           @Y30LB11*/ 08837000
         LA    @04,COPCSN1(,COPYVPTR)                              1674 08838000
         ST    @04,DARGDBP(,@09)                                   1674 08839000
*               SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*         @Y30LB11*/ 08840000
         LA    @04,12                                              1675 08841000
         STH   @04,DARGILP(,@09)                                   1675 08842000
*               SCDDSTRU->DARGCNT=2;/*                       @Y30LB11*/ 08843000
         LA    @15,2                                               1676 08844000
         STH   @15,DARGCNT(,@09)                                   1676 08845000
*               SCDDSTRU->DARGINS(1)=SCCSN2#;/*              @Y30LB11*/ 08846000
         MVC   DARGINS(2,@09),@CH00219                             1677 08847000
*               SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*      @Y30LB11*/ 08848000
         STH   @04,DARGINL(,@09)                                   1678 08849000
*               SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*        @Y30LB11*/ 08850000
         LA    @04,COPCSN2(,COPYVPTR)                              1679 08851000
         ST    @04,DARGDTM(,@09)                                   1679 08852000
*               SCDDSTRU->DARGINS(2)=SCDATE#;/*              @Y30LB11*/ 08853000
         STH   @15,DARGINS+8(,@09)                                 1680 08854000
*               SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*      @Y30LB11*/ 08855000
         MVC   DARGINL+8(2,@09),@CH00042                           1681 08856000
*               SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*        @Y30LB11*/ 08857000
         LA    @04,COPDATE(,COPYVPTR)                              1682 08858000
         ST    @04,DARGDTM+8(,@09)                                 1682 08859000
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/ 08860000
         L     @09,@PC00001                                        1683 08861000
         ST    @09,@AL00001                                        1683 08862000
         LA    @04,@CF00115                                        1683 08863000
         ST    @04,@AL00001+4                                      1683 08864000
         LA    @04,SCDDSTRU                                        1683 08865000
         ST    @04,@AL00001+8                                      1683 08866000
         MVI   @AL00001+8,X'80'                                    1683 08867000
         L     @15,GDTPRT(,@09)                                    1683 08868000
         LA    @01,@AL00001                                        1683 08869000
         BALR  @14,@15                                             1683 08870000
*             END;                  /*                       @Y30LB11*/ 08871000
*                                                                  1684 08872000
*           /*********************************************************/ 08873000
*           /*                                                       */ 08874000
*           /* INDICATE THAT SCRCOPY FAILED WITH A RETURN CODE OF 4. */ 08875000
*           /*                                                       */ 08876000
*           /*********************************************************/ 08877000
*                                                                  1685 08878000
*                                   /*                       @Y30LB11*/ 08879000
*           SCRCOND=4;              /*                       @Y30LB11*/ 08880000
@RC01634 LA    SCRCOND,4                                           1685 08881000
*         END;                      /*                       @Y30LB11*/ 08882000
*     END;                          /*                       @Y30LB11*/ 08883000
*                                                                  1687 08884000
@RC01617 DS    0H                                                  1688 08885000
*   /*****************************************************************/ 08886000
*   /*                                                               */ 08887000
*   /* RETURN TO SCRCOPY CALLER                              @Y30LB11*/ 08888000
*   /*                                                               */ 08889000
*   /*****************************************************************/ 08890000
*                                                                  1688 08891000
*   RETURN CODE(SCRCOND);           /*                       @Y30LB11*/ 08892000
@RC01598 LR    @15,SCRCOND                                         1688 08893000
         L     @14,@SA00018                                        1688 08894000
         LM    @00,@12,@SA00018+8                                  1688 08895000
         BR    @14                                                 1688 08896000
*   END SCRCOPY;                    /*                       @Y30LB11*/ 08897000
*   END IDCCO01                     /*                       @Y30LB39*/ 08898000
*                                                                  1690 08899000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 08900000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 08901000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 08902000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 08903000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 08904000
*/*%INCLUDE SYSLIB  (IDCCSCO )                                       */ 08905000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 08906000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 08907000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 08908000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 08909000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 08910000
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */ 08911000
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */ 08912000
*/*%INCLUDE SYSLIB  (IDCDF51 )                                       */ 08913000
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */ 08914000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 08915000
*/*%INCLUDE SYSLIB  (IDCDF53 )                                       */ 08916000
*                                                                  1690 08917000
*       ;                                                          1690 08918000
@DATA    DS    0H                                                       08919000
@CH00153 DC    H'2'                                                     08920000
@CH00286 DC    H'5'                                                     08921000
@CH00156 DC    H'6'                                                     08922000
@CH00444 DC    H'10'                                                    08923000
@CH00847 DC    H'29'                                                    08924000
@CH01085 DC    H'30'                                                    08925000
@CH00044 DC    H'31'                                                    08926000
@CH01907 DC    H'37'                                                    08927000
@CH01588 DC    H'40'                                                    08928000
@CH01908 DC    H'43'                                                    08929000
@CH01146 DC    H'48'                                                    08930000
@CH01905 DC    H'64'                                                    08931000
@CH01399 DC    H'72'                                                    08932000
@CH01909 DC    H'88'                                                    08933000
@CH01912 DC    H'120'                                                   08934000
@CH01906 DC    H'132'                                                   08935000
@CH01911 DC    H'164'                                                   08936000
@CH01910 DC    H'224'                                                   08937000
         DS    0F                                                       08938000
@AL00290 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        08939000
         DC    A(WAIT)                                                  08940000
         DC    A(@CC01617)                                              08941000
@DATD    DSECT                                                          08942000
         DS    0F                                                       08943000
@SA00001 DS    18F                                                      08944000
@PC00001 DS    3F                                                       08945000
@PC00015 DS    2F                                                       08946000
@PC00016 DS    5F                                                       08947000
@SA00017 DS    15F                                                      08948000
@PC00017 DS    2F                                                       08949000
@SA00018 DS    15F                                                      08950000
@PC00018 DS    1F                                                       08951000
@AL00001 DS    6A                                                       08952000
@AFTEMPS DS    7F                                                       08953000
IDCCO01  CSECT                                                          08954000
         DS    0F                                                       08955000
@CF00115 DC    F'0'                                                     08956000
@CF00219 DC    F'1'                                                     08957000
@CH00219 EQU   @CF00219+2                                               08958000
@CF00042 DC    F'4'                                                     08959000
@CH00042 EQU   @CF00042+2                                               08960000
@CF00179 DC    F'8'                                                     08961000
@CF00567 DC    F'12'                                                    08962000
@CH00567 EQU   @CF00567+2                                               08963000
@CF00474 DC    F'16'                                                    08964000
@CF01914 DC    XL4'0000FFFF'                                            08965000
@CF01845 DC    XL4'4C'                                                  08966000
@CF01890 DC    XL4'23'                                                  08967000
@CF01892 DC    XL4'26'                                                  08968000
@CF01894 DC    XL4'2A'                                                  08969000
@DATD    DSECT                                                          08970000
         DS    0D                                                       08971000
LISTSCAN DS    A                                                        08972000
IOCSPTR  DS    A                                                        08973000
OPNPTR   DS    A                                                        08974000
DDSTRU   DS    A                                                        08975000
FSADDR   DS    A                                                        08976000
ERCNVADR DS    A                                                        08977000
CCMSGPTR DS    A                                                        08978000
CMMSGPTR DS    A                                                        08979000
CTMSGPTR DS    A                                                        08980000
ELEMENT  DS    F                                                        08981000
RVVIPTR  DS    A                                                        08982000
MVRPTR   DS    A                                                        08983000
DEFVPTR  DS    A                                                        08984000
DEFVEPTR DS    A                                                        08985000
COVCPTR  DS    A                                                        08986000
COVCEPTR DS    A                                                        08987000
REASON   DS    F                                                        08988000
RETADDR1 DS    A                                                        08989000
RETADDR3 DS    A                                                        08990000
VEDDSTRU DS    A                                                        08991000
MCLSTPTR DS    A                                                        08992000
VEMSGPTR DS    A                                                        08993000
VEWTOPTR DS    A                                                        08994000
VERESNCD DS    F                                                        08995000
SSDLPTR  DS    A                                                        08996000
SCMSGCD  DS    A                                                        08997000
SCMSGPTR DS    A                                                        08998000
SCDEFPTR DS    A                                                        08999000
SCDDSTRU DS    A                                                        09000000
LISTPTR  DS    A                                                        09001000
VEWTOLEN DS    H                                                        09002000
SETRC    DS    H                                                        09003000
ECBBYTE  DS    FL1                                                      09004000
TVOLRC   DS    FL1                                                      09005000
SCRRC    DS    FL1                                                      09006000
OVERFLOW DS    FL1                                                      09007000
RVVIRC   DS    FL1                                                      09008000
SCECBCD  DS    FL1                                                      09009000
LISTLN   DS    FL1                                                      09010000
@TS00001 DS    CL95                                                     09011000
         DS    CL2                                                      09012000
PRINTTAB DS    CL44                                                     09013000
ALLAGLBF DS    CL31                                                     09014000
         DS    CL1                                                      09015000
CKAGLBUF DS    CL29                                                     09016000
         DS    CL3                                                      09017000
VS1AGLBF DS    CL74                                                     09018000
         DS    CL2                                                      09019000
MDAGLBUF DS    CL37                                                     09020000
         DS    CL3                                                      09021000
DEFVEBUF DS    CL64                                                     09022000
COVCEBUF DS    CL43                                                     09023000
         DS    CL1                                                      09024000
MVRBUFR  DS    CL88                                                     09025000
RVVIBUFR DS    CL68                                                     09026000
DEFLISTB DS    CL132                                                    09027000
COVLISTB DS    CL40                                                     09028000
EXCLAGLB DS    CL23                                                     09029000
         DS    CL1                                                      09030000
BASVOLBD DS    CL224                                                    09031000
COPVOLBD DS    CL164                                                    09032000
COPYVTBL DS    CL54                                                     09033000
         ORG   COPYVTBL                                                 09034000
COPYVTBC DS    CL8                                                      09035000
CUNITUCB DS    AL4                                                      09036000
CUNITDDN DS    CL8                                                      09037000
RECTYPE  DS    CL4                                                      09038000
CSN1AREA DS    CL12                                                     09039000
CSN2AREA DS    CL12                                                     09040000
NEWCDATE DS    CL4                                                      09041000
COPYFLGS DS    BL2                                                      09042000
         ORG   COPYFLGS                                                 09043000
REUSEFLG DS    BL1                                                      09044000
OBKUPFLG EQU   COPYFLGS+0                                               09045000
ALLOCFLG EQU   COPYFLGS+0                                               09046000
IOERRFLG DS    BL1                                                      09047000
@NM00129 EQU   COPYFLGS+1                                               09048000
         ORG   COPYVTBL+54                                              09049000
MINORNAM DS    CL23                                                     09050000
         ORG   MINORNAM                                                 09051000
RNAMLNTH DS    FL1                                                      09052000
RNAMCHAR DS    CL22                                                     09053000
         ORG   MINORNAM+23                                              09054000
         DS    CL3                                                      09055000
UNITLIST DS    CL9                                                      09056000
         ORG   UNITLIST                                                 09057000
UNITNUM  DS    FL2                                                      09058000
UNITARAY DS    CL7                                                      09059000
         ORG   UNITARAY                                                 09060000
UNITLNTH DS    FL2                                                      09061000
UNITTYPE DS    CL5                                                      09062000
         ORG   UNITLIST+9                                               09063000
         DS    CL3                                                      09064000
VOLSERLT DS    CL10                                                     09065000
         ORG   VOLSERLT                                                 09066000
VOLNUMBR DS    FL2                                                      09067000
VOLARRAY DS    CL8                                                      09068000
         ORG   VOLARRAY                                                 09069000
VOLLENTH DS    FL2                                                      09070000
VOLSERNM DS    CL6                                                      09071000
         ORG   VOLSERLT+10                                              09072000
         DS    CL2                                                      09073000
DUMPLIST DS    CL33                                                     09074000
SAVEFLG  DS    BL1                                                      09075000
DATAVALU DS    CL30                                                     09076000
TIMEAREA DS    CL8                                                      09077000
CKCSNADJ DS    CL12                                                     09078000
CKPRTTAB DS    CL20                                                     09079000
VEECB    DS    CL1                                                      09080000
VELIST   DS    CL52                                                     09081000
VEWTOMSG DS    CL72                                                     09082000
VEMCLIST DS    CL48                                                     09083000
VEEXLIST DS    CL44                                                     09084000
VESYSIN  DS    CL16                                                     09085000
         ORG   VESYSIN                                                  09086000
VEJOBNAM DS    CL8                                                      09087000
VESTEPNM DS    CL8                                                      09088000
         ORG   VESYSIN+16                                               09089000
VEROUTCD DS    BL2                                                      09090000
         ORG   VEROUTCD                                                 09091000
VECD1    DS    BL1                                                      09092000
@NM00143 EQU   VEROUTCD+0                                               09093000
         ORG   VEROUTCD+2                                               09094000
VEDESCCD DS    BL2                                                      09095000
         ORG   VEDESCCD                                                 09096000
@NM00144 DS    BL1                                                      09097000
VEDESC3  EQU   VEDESCCD+0                                               09098000
@NM00145 EQU   VEDESCCD+0                                               09099000
         ORG   VEDESCCD+2                                               09100000
VEDMPSTG DS    CL17                                                     09101000
SSDRGLT  DS    CL20                                                     09102000
         DS    CL2                                                      09103000
SSINXLST DS    CL120                                                    09104000
         ORG   SSINXLST                                                 09105000
SSARRAY  DS    60H                                                      09106000
         ORG   SSINXLST+120                                             09107000
SCDEFLST DS    CL132                                                    09108000
SCDARG   DS    CL36                                                     09109000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09110000
@ENDDATD EQU   *                                                        09111000
IDCCO01  CSECT                                                          09112000
         DS    0F                                                       09113000
@SIZDATD DC    AL1(0)                                                   09114000
         DC    AL3(@ENDDATD-@DATD)                                      09115000
         DS    0D                                                       09116000
RVVLEN   DC    AL2(68)                                                  09117000
MVRLEN   DC    AL2(88)                                                  09118000
DEFLEN   DC    AL2(64)                                                  09119000
COVLEN   DC    AL2(43)                                                  09120000
MCRLEN   DC    AL2(44)                                                  09121000
ONEZERO  DC    AL1(0)                                                   09122000
SSMSGNUM DC    AL1(56)                                                  09123000
@CC01615 DC    C'.VIRTUAL.ENQUEUE'                                      09124000
@CC01672 DC    C'.VIRTUAL.RESERVE'                                      09125000
@CC01614 DC    C'COPYVTBL'                                              09126000
@CC01617 DC    C'SYSZAMS '                                              09127000
@CC01657 DC    C'ALLAGLBF'                                              09128000
@CC01660 DC    C'CKAGLBUF'                                              09129000
@CC01667 DC    C'IDCVS01 '                                              09130000
@CC01693 DC    C'DEFLISTB'                                              09131000
@CC01694 DC    C'DEFVEBUF'                                              09132000
@CC01704 DC    C'MDAGLBUF'                                              09133000
@CC01712 DC    C'COVLISTB'                                              09134000
@CC01713 DC    C'COVCEBUF'                                              09135000
@CC01715 DC    C'MVRBUFR'                                               09136000
@CC01838 DC    C'MCLIST'                                                09137000
@CC01656 DC    C'3330V'                                                 09138000
@CC01492 DC    C'CO01'                                                  09139000
@CC01602 DC    C'COBG'                                                  09140000
@CC01624 DC    C'COND'                                                  09141000
@CC01629 DC    C'COFV'                                                  09142000
@CC01637 DC    C'COTV'                                                  09143000
@CC01644 DC    C'CORE'                                                  09144000
@CC01650 DC    C'COBK'                                                  09145000
@CC01655 DC    C'COFI'                                                  09146000
@CC01659 DC    C'COAA'                                                  09147000
@CC01661 DC    C'COBB'                                                  09148000
@CC01668 DC    C'COVS'                                                  09149000
@CC01669 DC    C'COCH'                                                  09150000
@CC01670 DC    C'COPT'                                                  09151000
@CC01671 DC    C'COII'                                                  09152000
@CC01680 DC    C'COWK'                                                  09153000
@CC01686 DC    C'COJJ'                                                  09154000
@CC01691 DC    C'COCR'                                                  09155000
@CC01695 DC    C'COCC'                                                  09156000
@CC01703 DC    C'CODM'                                                  09157000
@CC01705 DC    C'CODD'                                                  09158000
@CC01711 DC    C'COCP'                                                  09159000
@CC01714 DC    C'COEE'                                                  09160000
@CC01716 DC    C'COFF'                                                  09161000
@CC01721 DC    C'COLB'                                                  09162000
@CC01722 DC    C'COGG'                                                  09163000
@CC01728 DC    C'COSC'                                                  09164000
@CC01734 DC    C'CORV'                                                  09165000
@CC01735 DC    C'RVVI'                                                  09166000
@CC01736 DC    C'CORR'                                                  09167000
@CC01755 DC    C'CKLN'                                                  09168000
@CC01836 DC    C'VESR'                                                  09169000
@CC01839 DC    C'VEBM'                                                  09170000
@CC01866 DC    C'SSAA'                                                  09171000
@CC01902 DC    C'SCSC'                                                  09172000
@CC01903 DC    C'SCDF'                                                  09173000
@CC01548 EQU   @CC01492                                                 09174000
@CC01550 DC    C'CM0'                                                   09175000
@CC01552 DC    C'UV0'                                                   09176000
ALL      DC    CL3'ALL'                                                 09177000
FORMAT   DC    CL4'FORM'                                                09178000
HSECOND  DC    CL4'HSEC'                                                09179000
CLOCK    DC    CL4'KLOK'                                                09180000
SETZERO  DC    CL4'ZERO'                                                09181000
SETBLANK DC    CL4'BLNK'                                                09182000
NOSET    DC    CL4'NSET'                                                09183000
OVERRIDE DC    CL4'OVRD'                                                09184000
ACQUIRE  DC    CL8'ACQUIRE '                                            09185000
RELINQ   DC    CL8'RELINQ  '                                            09186000
MOUNT    DC    CL8'MOUNT   '                                            09187000
DEMOUNT  DC    CL8'DEMOUNT '                                            09188000
DEFINE   DC    CL8'DEFINE  '                                            09189000
MOVE     DC    CL8'MOVE    '                                            09190000
TRACEQ   DC    CL8'TRACEQ  '                                            09191000
COPYTABL DC    CL8'COPYTABL'                                            09192000
COPYCRTG DC    CL8'COPYCRTG'                                            09193000
COPYVOL  DC    CL8'COPYVOL '                                            09194000
VVIC     DC    CL8'VVIC    '                                            09195000
TUNE     DC    CL8'TUNE    '                                            09196000
NAMES    DC    CL4'NAME'                                                09197000
UNIT     DC    CL4'UNIT'                                                09198000
SHR      DC    CL4'SHR '                                                09199000
EXCL     DC    CL4'EXCL'                                                09200000
NOWAIT   DC    CL4'NWAI'                                                09201000
WAIT     DC    CL4'WAIT'                                                09202000
SECCHECK DC    CL8'SECCHECK'                                            09203000
SCRVTOC  DC    CL8'SCRVTOC '                                            09204000
GETVTOC  DC    CL8'GETVTOC '                                            09205000
PUTVTOC  DC    CL8'PUTVTOC '                                            09206000
RECATLG  DC    CL8'RECATLG '                                            09207000
INITVOL  DC    CL8'INITVOL '                                            09208000
CHECK    DC    CL8'CHECK   '                                            09209000
POSTUCB  DC    CL8'POSTUCB '                                            09210000
GET      DC    CL8'GET     '                                            09211000
PUT      DC    CL8'PUT     '                                            09212000
CLOSE    DC    CL8'CLOSE   '                                            09213000
OPEN     DC    CL8'OPEN    '                                            09214000
RVOPENR  DC    CL8'OPENR   '                                            09215000
RVRDCNT  DC    CL8'READCNT '                                            09216000
RVREADKD DC    CL8'READKD  '                                            09217000
RVSPACCR DC    CL8'SPACCR  '                                            09218000
RVFWRITE DC    CL8'FWRITE  '                                            09219000
RVWRITER DC    CL8'WRITEREC'                                            09220000
PUTLABEL DC    CL8'PUTLABEL'                                            09221000
GETLABEL DC    CL8'GETLABEL'                                            09222000
CANCEL   DC    CL8'CANCEL  '                                            09223000
SET      DC    CL8'SET     '                                            09224000
SELECTX  DC    CL8'SELECTX '                                            09225000
CHANGEX  DC    CL8'CHANGEX '                                            09226000
SELECTDD DC    CL8'SELECTDD'                                            09227000
SELECTDS DC    CL8'SELECTDS'                                            09228000
TBLREST  DC    CL8'TBLREST '                                            09229000
NULLIFYC DC    CL8'NULLIFYC'                                            09230000
RDMSC    DC    CL8'RDMSC   '                                            09231000
RDMSCTBL DC    CL8'RDMSCTBL'                                            09232000
RDCARTLB DC    CL8'RDCARTLB'                                            09233000
AUDITCEL DC    CL8'AUDITCEL'                                            09234000
RDSTGAD  DC    CL8'RDSTGAD '                                            09235000
MODID    DC    CL4'CO01'                                                09236000
FIXAREA  DS    CL512                                                    09237000
         ORG   FIXAREA                                                  09238000
@NM00130 DC    256X'00'                                                 09239000
@NM00131 DC    256X'00'                                                 09240000
         ORG   FIXAREA+512                                              09241000
BASECHAR DC    CL4'BASE'                                                09242000
COPYCHAR DC    CL4'COPY'                                                09243000
BKUPCHAR DC    CL4'BKUP'                                                09244000
HEXFF    DC    X'FF'                                                    09245000
BLNKAREA DC    CL1' '                                                   09246000
THIRTYBK DS    CL30                                                     09247000
         ORG   THIRTYBK                                                 09248000
@NM00132 DC    30CL1' '                                                 09249000
         ORG   THIRTYBK+30                                              09250000
TWLVZERO DS    CL12                                                     09251000
         ORG   TWLVZERO                                                 09252000
@NM00133 DC    12X'00'                                                  09253000
         ORG   TWLVZERO+12                                              09254000
SSMODSS0 DC    CL3'SS0'                                                 09255000
SSMODCM0 DC    CL3'CM0'                                                 09256000
SCBLANKS DS    CL30                                                     09257000
         ORG   SCBLANKS                                                 09258000
@NM00148 DC    30X'40'                                                  09259000
         ORG   SCBLANKS+30                                              09260000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       09261000
@01      EQU   01                                                       09262000
@02      EQU   02                                                       09263000
@03      EQU   03                                                       09264000
@04      EQU   04                                                       09265000
@05      EQU   05                                                       09266000
@06      EQU   06                                                       09267000
@07      EQU   07                                                       09268000
@08      EQU   08                                                       09269000
@09      EQU   09                                                       09270000
@10      EQU   10                                                       09271000
@11      EQU   11                                                       09272000
@12      EQU   12                                                       09273000
@13      EQU   13                                                       09274000
@14      EQU   14                                                       09275000
@15      EQU   15                                                       09276000
SCRCOND  EQU   @04                                                      09277000
SCCMPTR  EQU   @02                                                      09278000
ENTRYNUM EQU   @02                                                      09279000
VECOND   EQU   @04                                                      09280000
VERETADR EQU   @09                                                      09281000
MCRTEPTR EQU   @03                                                      09282000
CKCOND   EQU   @03                                                      09283000
CKSAVPTR EQU   @09                                                      09284000
CKRETPTR EQU   @04                                                      09285000
LABLRC   EQU   @04                                                      09286000
COPYRC   EQU   @04                                                      09287000
DMNTRC   EQU   @04                                                      09288000
CRVRC    EQU   @04                                                      09289000
WORKRC   EQU   @07                                                      09290000
VSRC     EQU   @04                                                      09291000
FILERC   EQU   @04                                                      09292000
OBKUPRC  EQU   @03                                                      09293000
REUSERC  EQU   @04                                                      09294000
CSN2RC   EQU   @04                                                      09295000
CSN1RC   EQU   @07                                                      09296000
FVOLRC   EQU   @07                                                      09297000
RETADDR2 EQU   @09                                                      09298000
COPYVPTR EQU   @05                                                      09299000
BASEVPTR EQU   @06                                                      09300000
DMPINDEX EQU   @02                                                      09301000
TESTRC   EQU   @03                                                      09302000
REG8     EQU   @08                                                      09303000
REG10    EQU   @10                                                      09304000
REG12    EQU   @12                                                      09305000
RTNREG   EQU   @15                                                      09306000
REG14    EQU   @14                                                      09307000
CVOLR1   EQU   @01                                                      09308000
DEFVR1   EQU   @01                                                      09309000
MCR1     EQU   @01                                                      09310000
REG0     EQU   @00                                                      09311000
REG1     EQU   @01                                                      09312000
REG11    EQU   @11                                                      09313000
REG13    EQU   @13                                                      09314000
REG15    EQU   @15                                                      09315000
REG2     EQU   @02                                                      09316000
REG3     EQU   @03                                                      09317000
REG4     EQU   @04                                                      09318000
REG5     EQU   @05                                                      09319000
REG6     EQU   @06                                                      09320000
REG7     EQU   @07                                                      09321000
REG9     EQU   @09                                                      09322000
IDCSACL0 EQU   0                                                        09323000
IDCSAEP0 EQU   0                                                        09324000
IDCSAFS0 EQU   0                                                        09325000
IDCSATI0 EQU   0                                                        09326000
IDCSAAL0 EQU   0                                                        09327000
IDCSASS0 EQU   0                                                        09328000
IDCSANQ0 EQU   0                                                        09329000
IDCSADQ0 EQU   0                                                        09330000
IDCSASI0 EQU   0                                                        09331000
IDCSAWO0 EQU   0                                                        09332000
IDCSA060 EQU   0                                                        09333000
TRACE1   EQU   0                                                        09334000
OLDERID1 EQU   TRACE1                                                   09335000
TRACE2   EQU   0                                                        09336000
OLDERID2 EQU   TRACE2                                                   09337000
NEWID2   EQU   TRACE2+95                                                09338000
NEWERID2 EQU   5                                                        09339000
CIRAGL   EQU   0                                                        09340000
CIRTYPE  EQU   CIRAGL                                                   09341000
ALLAGL   EQU   0                                                        09342000
ALLDDN   EQU   ALLAGL+4                                                 09343000
ALLULP   EQU   ALLAGL+12                                                09344000
ALLVLP   EQU   ALLAGL+16                                                09345000
ALLSTS   EQU   ALLAGL+24                                                09346000
ALLDSP   EQU   ALLAGL+25                                                09347000
ALLORG   EQU   ALLAGL+26                                                09348000
ALLOPT   EQU   ALLAGL+28                                                09349000
ALLOPTVL EQU   ALLOPT                                                   09350000
ALLOPTPV EQU   ALLOPT                                                   09351000
ALLVLCNT EQU   ALLAGL+29                                                09352000
ALLUNCNT EQU   ALLAGL+30                                                09353000
UNITABL  EQU   0                                                        09354000
UNITADR  EQU   UNITABL+4                                                09355000
@NM00010 EQU   UNITADR                                                  09356000
UNITSTAT EQU   UNITABL+6                                                09357000
IDCIOCL0 EQU   0                                                        09358000
IOCSTR   EQU   0                                                        09359000
IOCDSO   EQU   IOCSTR+16                                                09360000
IOCRFM   EQU   IOCSTR+17                                                09361000
IOCMAC   EQU   IOCSTR+18                                                09362000
IOCMAC2  EQU   IOCSTR+19                                                09363000
IOCCHP   EQU   IOCSTR+20                                                09364000
IOCMSG   EQU   IOCSTR+21                                                09365000
IOCRBA   EQU   IOCSTR+40                                                09366000
IOCTTR   EQU   IOCRBA                                                   09367000
IOCMEM   EQU   IOCSTR+44                                                09368000
IOCNWM   EQU   IOCSTR+48                                                09369000
OPNAGL   EQU   0                                                        09370000
OPNOPT   EQU   OPNAGL                                                   09371000
OPNRFM   EQU   OPNAGL+1                                                 09372000
OPNTYP   EQU   OPNAGL+2                                                 09373000
OPNMOD   EQU   OPNAGL+3                                                 09374000
OPNDEV   EQU   OPNAGL+24                                                09375000
OPNDSO   EQU   OPNAGL+41                                                09376000
OPNOPT2  EQU   OPNAGL+42                                                09377000
IOINFOPT EQU   0                                                        09378000
UVOLLIST EQU   0                                                        09379000
UVOLENT  EQU   UVOLLIST+2                                               09380000
AMSTP011 EQU   0                                                        09381000
DARGLIST EQU   0                                                        09382000
DARGDBP  EQU   DARGLIST                                                 09383000
DARGRETP EQU   DARGLIST+4                                               09384000
DARGSTID EQU   DARGLIST+8                                               09385000
DARGSMOD EQU   DARGSTID                                                 09386000
DARGSENT EQU   DARGSTID+3                                               09387000
DARGILP  EQU   DARGLIST+12                                              09388000
DARGCNT  EQU   DARGLIST+14                                              09389000
DARGRETL EQU   DARGLIST+16                                              09390000
DARGARY  EQU   DARGLIST+20                                              09391000
DARGINS  EQU   DARGARY                                                  09392000
DARGINL  EQU   DARGARY+2                                                09393000
DARGDTM  EQU   DARGARY+4                                                09394000
FMTLIST  EQU   0                                                        09395000
FMTFLGS  EQU   FMTLIST                                                  09396000
FMTSPF   EQU   FMTLIST+2                                                09397000
FMTRFNO  EQU   FMTSPF                                                   09398000
FMTILEN  EQU   FMTRFNO                                                  09399000
FMTIOFF  EQU   FMTLIST+4                                                09400000
FMTTRBC  EQU   FMTIOFF                                                  09401000
FMTSTO   EQU   FMTTRBC                                                  09402000
FMTOCOL  EQU   FMTLIST+6                                                09403000
FMTCNVF  EQU   FMTLIST+10                                               09404000
ERCNVTAB EQU   0                                                        09405000
ERTYPE   EQU   ERCNVTAB                                                 09406000
EROPER   EQU   ERCNVTAB+1                                               09407000
EROSOPER EQU   ERCNVTAB+2                                               09408000
IDCDB010 EQU   0                                                        09409000
DMPITM   EQU   0                                                        09410000
DMPITMNM EQU   DMPITM                                                   09411000
DMPITMPT EQU   DMPITM+8                                                 09412000
DMPITMLN EQU   DMPITM+12                                                09413000
DMPITMTP EQU   DMPITM+14                                                09414000
DMPARY   EQU   0                                                        09415000
DMPTRM   EQU   0                                                        09416000
CCMSG    EQU   0                                                        09417000
CMMSG    EQU   0                                                        09418000
CMVOLFLG EQU   CMMSG+6                                                  09419000
CMNUMCRT EQU   CMMSG+15                                                 09420000
CMCSN1   EQU   CMMSG+16                                                 09421000
CMCSN2   EQU   CMMSG+28                                                 09422000
CTMSG    EQU   0                                                        09423000
CTARRAY  EQU   CTMSG+4                                                  09424000
MDAGL    EQU   0                                                        09425000
MDUCBPTR EQU   MDAGL+8                                                  09426000
MDDDNAME EQU   MDAGL+12                                                 09427000
MDLABEL  EQU   MDAGL+24                                                 09428000
MDFLAGS  EQU   MDAGL+30                                                 09429000
MDWAIT   EQU   MDFLAGS                                                  09430000
MDVTOC   EQU   MDAGL+32                                                 09431000
PUAGL    EQU   0                                                        09432000
CKAGL    EQU   0                                                        09433000
CKUCBPTR EQU   CKAGL+8                                                  09434000
CKDDNAME EQU   CKAGL+12                                                 09435000
CKFLAGS  EQU   CKAGL+28                                                 09436000
CKTESTVT EQU   CKFLAGS                                                  09437000
EXCLAGL  EQU   0                                                        09438000
EXCLUCBP EQU   EXCLAGL+8                                                09439000
EXCLDDP  EQU   EXCLAGL+12                                               09440000
EXCLVOL  EQU   EXCLAGL+16                                               09441000
EXCLFLAG EQU   EXCLAGL+22                                               09442000
EXOARG   EQU   0                                                        09443000
EXOPT    EQU   EXOARG+32                                                09444000
EXFLG    EQU   EXOARG+33                                                09445000
EXGARG   EQU   0                                                        09446000
EXWRARG  EQU   0                                                        09447000
EXRWCHR  EQU   EXWRARG+26                                               09448000
EXSPACE  EQU   EXWRARG+36                                               09449000
EXPARG   EQU   0                                                        09450000
EXPDATA  EQU   EXPARG+12                                                09451000
EXPDATAB EQU   0                                                        09452000
EXPARRAY EQU   EXPDATAB+4                                               09453000
VS2AGL   EQU   0                                                        09454000
VSLABOPT EQU   VS2AGL+28                                                09455000
VS2MSG   EQU   VS2AGL+35                                                09456000
VS2RESOP EQU   VS2AGL+36                                                09457000
VS1AGL   EQU   0                                                        09458000
VSUCBP   EQU   VS1AGL+8                                                 09459000
VSVOLP   EQU   VS1AGL+12                                                09460000
VSFILEP  EQU   VS1AGL+16                                                09461000
VSIOP    EQU   VS1AGL+20                                                09462000
VSCATP   EQU   VS1AGL+32                                                09463000
VSCATDDP EQU   VS1AGL+40                                                09464000
VSPSWDP  EQU   VS1AGL+44                                                09465000
VSPFILEP EQU   VS1AGL+48                                                09466000
VSSECOPT EQU   VS1AGL+68                                                09467000
VSMASTER EQU   VSSECOPT                                                 09468000
VSREAD   EQU   VSSECOPT                                                 09469000
VSVTOPT  EQU   VS1AGL+69                                                09470000
VSTIME   EQU   VSVTOPT                                                  09471000
VSCATOPT EQU   VS1AGL+70                                                09472000
VSRETURN EQU   VS1AGL+71                                                09473000
VSVSAM   EQU   VSRETURN                                                 09474000
VSMSG    EQU   VS1AGL+72                                                09475000
VSRESOPT EQU   VS1AGL+73                                                09476000
VSRES    EQU   VSRESOPT                                                 09477000
RCTAGL   EQU   0                                                        09478000
RCTOPT   EQU   RCTAGL+8                                                 09479000
STAEPARM EQU   0                                                        09480000
STARCVY  EQU   STAEPARM+52                                              09481000
STARETRY EQU   STAEPARM+53                                              09482000
VOLLABEL EQU   0                                                        09483000
SV82LIST EQU   0                                                        09484000
@NM00072 EQU   SV82LIST+4                                               09485000
SV82DCBP EQU   @NM00072                                                 09486000
@NM00073 EQU   SV82LIST+12                                              09487000
SV82WRKP EQU   @NM00073                                                 09488000
SRTAGL   EQU   0                                                        09489000
LCTINFO  EQU   0                                                        09490000
LCTFLAGS EQU   LCTINFO+32                                               09491000
UCTAGL   EQU   0                                                        09492000
UCTFLAGS EQU   UCTAGL+68                                                09493000
SELAGL   EQU   0                                                        09494000
SELFLAGS EQU   SELAGL+22                                                09495000
DATESAGL EQU   0                                                        09496000
DATESOPT EQU   DATESAGL+20                                              09497000
VS3AGL   EQU   0                                                        09498000
VS3FLAGS EQU   VS3AGL+58                                                09499000
VSDVTOC  EQU   0                                                        09500000
VSDSTAT  EQU   0                                                        09501000
VSDSFLG1 EQU   VSDSTAT+16                                               09502000
VSDFLG2  EQU   VSDSTAT+17                                               09503000
VSDSCR   EQU   0                                                        09504000
VSDSCRFL EQU   VSDSCR+4                                                 09505000
VSDUSAGE EQU   0                                                        09506000
VSDDORG  EQU   VSDUSAGE+9                                               09507000
VSDALLOC EQU   VSDUSAGE+10                                              09508000
VSDUSEF  EQU   VSDUSAGE+11                                              09509000
VSDDSORG EQU   VSDUSAGE+16                                              09510000
VSDBLOCK EQU   0                                                        09511000
VSDSPACE EQU   VSDBLOCK+12                                              09512000
VSDARRAY EQU   VSDBLOCK+16                                              09513000
VSDVARY  EQU   VSDARRAY+48                                              09514000
VOL      EQU   0                                                        09515000
VOLLEN   EQU   VOL                                                      09516000
VOLVAL   EQU   VOL+1                                                    09517000
BKUP     EQU   0                                                        09518000
CART     EQU   0                                                        09519000
CSN1     EQU   0                                                        09520000
CSN1LEN  EQU   CSN1                                                     09521000
CSN1VAL  EQU   CSN1+1                                                   09522000
CSN2     EQU   0                                                        09523000
CSN2LEN  EQU   CSN2                                                     09524000
CSN2VAL  EQU   CSN2+1                                                   09525000
DESCR    EQU   0                                                        09526000
DESCRVAL EQU   DESCR+1                                                  09527000
EJECT    EQU   0                                                        09528000
REC      EQU   0                                                        09529000
LOC      EQU   0                                                        09530000
LOCVAL   EQU   LOC+1                                                    09531000
CAT      EQU   0                                                        09532000
CATNM    EQU   0                                                        09533000
CATNMPLN EQU   CATNM                                                    09534000
CATNMPAS EQU   CATNM+1                                                  09535000
CATNMFLG EQU   CATNM+10                                                 09536000
CATNMVAL EQU   CATNM+21                                                 09537000
CATDN    EQU   0                                                        09538000
CATDNVAL EQU   CATDN+1                                                  09539000
FILE     EQU   0                                                        09540000
FILEVAL  EQU   FILE+1                                                   09541000
MSF      EQU   0                                                        09542000
MSFVAL   EQU   MSF                                                      09543000
PFILE    EQU   0                                                        09544000
@NM00091 EQU   PFILE+2                                                  09545000
RVVI     EQU   0                                                        09546000
RVVLNGTH EQU   RVVI                                                     09547000
RVVOPCOD EQU   RVVI+4                                                   09548000
RVVCODE  EQU   RVVOPCOD                                                 09549000
RVVOLUME EQU   RVVI+8                                                   09550000
RVVBUFLN EQU   RVVI+30                                                  09551000
RVVRTBUF EQU   RVVI+32                                                  09552000
RVVFLAGA EQU   RVVI+58                                                  09553000
RVVRMODE EQU   RVVFLAGA                                                 09554000
RVVRDR   EQU   RVVRMODE                                                 09555000
RVVCHAIN EQU   RVVFLAGA+1                                               09556000
RVVRDRCD EQU   RVVFLAGA+2                                               09557000
RVVBVRCD EQU   RVVRDRCD                                                 09558000
RVVCPYRC EQU   RVVRDRCD                                                 09559000
RVVRTEST EQU   RVVFLAGA+3                                               09560000
RVVCPYTP EQU   RVVFLAGA+4                                               09561000
RVVOBKUP EQU   RVVCPYTP                                                 09562000
RVVLCOPY EQU   RVVCPYTP                                                 09563000
RVVSPEC  EQU   RVVFLAGA+5                                               09564000
RVVSVOL  EQU   RVVSPEC                                                  09565000
MVR      EQU   0                                                        09566000
MVRLNGTH EQU   MVR                                                      09567000
MVRCODE  EQU   MVR+4                                                    09568000
MVRFLAGA EQU   MVR+8                                                    09569000
MVRFLBAS EQU   MVRFLAGA                                                 09570000
MVRFLCSN EQU   MVRFLAGA                                                 09571000
MVRBKUP  EQU   MVRFLAGA+1                                               09572000
MVRCICPY EQU   MVRFLAGA+2                                               09573000
MVRBVOL  EQU   MVR+12                                                   09574000
MVRCSN   EQU   MVR+62                                                   09575000
BASEV    EQU   0                                                        09576000
BASNAME  EQU   BASEV                                                    09577000
BASID    EQU   BASNAME+11                                               09578000
BASFLAGA EQU   BASEV+14                                                 09579000
BASTYPE  EQU   BASFLAGA                                                 09580000
BASINAC  EQU   BASFLAGA+2                                               09581000
BASBIND  EQU   BASFLAGA+2                                               09582000
BASEXCL  EQU   BASFLAGA+2                                               09583000
BASDAERA EQU   BASFLAGA+3                                               09584000
BASRONLY EQU   BASFLAGA+3                                               09585000
BASRCVYF EQU   BASEV+20                                                 09586000
BASSATIA EQU   BASRCVYF                                                 09587000
BASIVCRE EQU   BASSATIA                                                 09588000
BASIVCPY EQU   BASSATIA                                                 09589000
BASVSMIS EQU   BASSATIA                                                 09590000
BASMISCF EQU   BASRCVYF+2                                               09591000
BASLIB1  EQU   BASEV+36                                                 09592000
BASLID1  EQU   BASLIB1                                                  09593000
BASLIB2  EQU   BASEV+49                                                 09594000
BASLID2  EQU   BASLIB2                                                  09595000
BASNCOPY EQU   BASEV+62                                                 09596000
BASNBKUP EQU   BASEV+63                                                 09597000
BASBKLMT EQU   BASEV+64                                                 09598000
BASKLCPY EQU   BASEV+76                                                 09599000
BASCOPID EQU   BASKLCPY+11                                              09600000
BASOWNER EQU   BASEV+134                                                09601000
COPYV    EQU   0                                                        09602000
COPNAME  EQU   COPYV                                                    09603000
COPID    EQU   COPNAME+11                                               09604000
COPFLAGA EQU   COPYV+14                                                 09605000
COPTYPE  EQU   COPFLAGA                                                 09606000
COPRCVYF EQU   COPYV+20                                                 09607000
COPSATIA EQU   COPRCVYF                                                 09608000
COPMISCF EQU   COPRCVYF+2                                               09609000
COPCSN1  EQU   COPYV+24                                                 09610000
COPLIB1  EQU   COPYV+36                                                 09611000
COPLID1  EQU   COPLIB1                                                  09612000
COPCSN2  EQU   COPYV+37                                                 09613000
COPLIB2  EQU   COPYV+49                                                 09614000
COPLID2  EQU   COPLIB2                                                  09615000
COPDATE  EQU   COPYV+50                                                 09616000
COPDEST  EQU   COPYV+88                                                 09617000
COPOWNER EQU   COPYV+118                                                09618000
DEFLIST  EQU   0                                                        09619000
DEFVFLG  EQU   DEFLIST+6                                                09620000
DEFVCR   EQU   DEFVFLG                                                  09621000
DEFVELTR EQU   DEFVFLG                                                  09622000
DEFVRNTR EQU   DEFVFLG                                                  09623000
DEFVLIB  EQU   DEFLIST+7                                                09624000
DEFVOLD  EQU   DEFLIST+8                                                09625000
DEFVVFLG EQU   DEFLIST+14                                               09626000
DEFVSEC  EQU   DEFVVFLG                                                 09627000
DEFVEXCL EQU   DEFVVFLG                                                 09628000
DEFVBIND EQU   DEFVVFLG                                                 09629000
DEFVWINH EQU   DEFVVFLG                                                 09630000
DEFVNVOL EQU   DEFLIST+16                                               09631000
DEFVCSN1 EQU   DEFLIST+24                                               09632000
DEFVCSN2 EQU   DEFLIST+36                                               09633000
DEFVDATA EQU   DEFLIST+56                                               09634000
DEFOWNID EQU   DEFVDATA+29                                              09635000
DEFTLAB  EQU   DEFVDATA+71                                              09636000
DEFVVEXT EQU   DEFLIST+128                                              09637000
DEFVE    EQU   0                                                        09638000
DEFLNGTH EQU   DEFVE                                                    09639000
DEFDESCR EQU   DEFVE+12                                                 09640000
DEFFLAGA EQU   DEFVE+55                                                 09641000
DEFPDESC EQU   DEFFLAGA                                                 09642000
DEFFLAGB EQU   DEFVE+56                                                 09643000
DEFSETFL EQU   DEFFLAGB                                                 09644000
DEFSRCVY EQU   DEFSETFL                                                 09645000
DEFRECFL EQU   DEFFLAGB+1                                               09646000
DEFICOPY EQU   DEFRECFL                                                 09647000
DEFTYPFL EQU   DEFFLAGB+2                                               09648000
DEFCOPY  EQU   DEFTYPFL                                                 09649000
DEFNULFL EQU   DEFFLAGB+3                                               09650000
COVLIST  EQU   0                                                        09651000
CVOLFLG  EQU   COVLIST+6                                                09652000
CVOCRCR  EQU   CVOLFLG                                                  09653000
CVOLID   EQU   COVLIST+8                                                09654000
CVOLCSN  EQU   COVLIST+20                                               09655000
CVOLVEXT EQU   COVLIST+36                                               09656000
COVCE    EQU   0                                                        09657000
COVLNGTH EQU   COVCE                                                    09658000
COVDESCR EQU   COVCE+4                                                  09659000
COVFLAGA EQU   COVCE+34                                                 09660000
COVSPDES EQU   COVFLAGA                                                 09661000
COVFLAGB EQU   COVCE+35                                                 09662000
COVSETFL EQU   COVFLAGB                                                 09663000
COVSRCVY EQU   COVSETFL                                                 09664000
COVRECFL EQU   COVFLAGB+1                                               09665000
COVICOPY EQU   COVRECFL                                                 09666000
COVTYPE  EQU   COVFLAGB+2                                               09667000
COVSAM   EQU   COVTYPE                                                  09668000
COVREUSE EQU   COVTYPE                                                  09669000
MCRTE    EQU   0                                                        09670000
MCRLNGTH EQU   MCRTE                                                    09671000
MCRLOC   EQU   MCRTE+4                                                  09672000
MCRFLAGA EQU   MCRTE+34                                                 09673000
MCRSPLOC EQU   MCRFLAGA                                                 09674000
MCRFLAGB EQU   MCRTE+36                                                 09675000
MCRTYPE  EQU   MCRFLAGB+2                                               09676000
MCRREC   EQU   MCRTYPE                                                  09677000
MCLIST   EQU   0                                                        09678000
MCRTFLG  EQU   MCLIST+6                                                 09679000
MCRTTRAN EQU   MCRTFLG                                                  09680000
MCRTLIB  EQU   MCLIST+7                                                 09681000
MCRTCSN  EQU   MCLIST+24                                                09682000
MCRTVEXT EQU   MCLIST+44                                                09683000
AMSTP041 EQU   0                                                        09684000
AMSTP042 EQU   0                                                        09685000
AMSTP043 EQU   0                                                        09686000
AMSTP044 EQU   0                                                        09687000
IDCIOCO0 EQU   0                                                        09688000
IDCIOGT0 EQU   0                                                        09689000
IDCIOIT0 EQU   0                                                        09690000
IDCIOOP0 EQU   0                                                        09691000
IDCIOPO0 EQU   0                                                        09692000
IDCIOPT0 EQU   0                                                        09693000
IDCIOSI0 EQU   0                                                        09694000
IDCIOST0 EQU   0                                                        09695000
IDCIOTM0 EQU   0                                                        09696000
IDCIOVY0 EQU   0                                                        09697000
IDCIO050 EQU   0                                                        09698000
IDCSACA0 EQU   0                                                        09699000
IDCSACR0 EQU   0                                                        09700000
IDCSADE0 EQU   0                                                        09701000
IDCSADL0 EQU   0                                                        09702000
IDCSAFP0 EQU   0                                                        09703000
IDCSAGP0 EQU   0                                                        09704000
IDCSAGS0 EQU   0                                                        09705000
IDCSAID0 EQU   0                                                        09706000
IDCSALC0 EQU   0                                                        09707000
IDCSALD0 EQU   0                                                        09708000
IDCSALK0 EQU   0                                                        09709000
IDCSAPR0 EQU   0                                                        09710000
IDCSAPT0 EQU   0                                                        09711000
IDCSAQL0 EQU   0                                                        09712000
IDCSARC0 EQU   0                                                        09713000
IDCSARV0 EQU   0                                                        09714000
IDCSASC0 EQU   0                                                        09715000
IDCSASN0 EQU   0                                                        09716000
IDCSAST0 EQU   0                                                        09717000
IDCSAUC0 EQU   0                                                        09718000
IDCST010 EQU   0                                                        09719000
IDCTPER0 EQU   0                                                        09720000
LISTTEST EQU   0                                                        09721000
NEJCT    EQU   0                                                        09722000
NEWERID1 EQU   5                                                        09723000
NREC     EQU   0                                                        09724000
GDTTBL   EQU   0                                                        09725000
GDTTR1   EQU   GDTTBL+8                                                 09726000
GDTTR2   EQU   GDTTBL+12                                                09727000
GDTDBG   EQU   GDTTBL+40                                                09728000
GDTSTC   EQU   GDTTBL+44                                                09729000
GDTPRT   EQU   GDTTBL+48                                                09730000
GDTESS   EQU   GDTTBL+52                                                09731000
GDTESA   EQU   GDTTBL+56                                                09732000
GDTRST   EQU   GDTTBL+60                                                09733000
GDTRES   EQU   GDTTBL+64                                                09734000
GDTCAL   EQU   GDTTBL+68                                                09735000
GDTGSP   EQU   GDTTBL+72                                                09736000
GDTFSP   EQU   GDTTBL+76                                                09737000
GDTGPL   EQU   GDTTBL+80                                                09738000
GDTFPL   EQU   GDTTBL+84                                                09739000
GDTLOD   EQU   GDTTBL+88                                                09740000
GDTDEL   EQU   GDTTBL+92                                                09741000
GDTPRL   EQU   GDTTBL+96                                                09742000
GDTEPL   EQU   GDTTBL+100                                               09743000
GDTTIM   EQU   GDTTBL+104                                               09744000
GDTIIO   EQU   GDTTBL+108                                               09745000
GDTTIO   EQU   GDTTBL+112                                               09746000
GDTOPN   EQU   GDTTBL+124                                               09747000
GDTCLS   EQU   GDTTBL+128                                               09748000
GDTGET   EQU   GDTTBL+132                                               09749000
GDTPUT   EQU   GDTTBL+136                                               09750000
GDTPOS   EQU   GDTTBL+140                                               09751000
GDTCPY   EQU   GDTTBL+144                                               09752000
GDTCAT   EQU   GDTTBL+148                                               09753000
GDTSNP   EQU   GDTTBL+164                                               09754000
GDTVFY   EQU   GDTTBL+172                                               09755000
GDTUID   EQU   GDTTBL+192                                               09756000
GDTPMT   EQU   GDTTBL+196                                               09757000
GDTCIR   EQU   GDTTBL+200                                               09758000
GDTLNK   EQU   GDTTBL+204                                               09759000
GDTALC   EQU   GDTTBL+208                                               09760000
GDTDLC   EQU   GDTTBL+212                                               09761000
GDTQAL   EQU   GDTTBL+216                                               09762000
GDTSTW   EQU   GDTTBL+220                                               09763000
GDTSSC   EQU   GDTTBL+224                                               09764000
GDTENQ   EQU   GDTTBL+228                                               09765000
GDTRSV   EQU   GDTTBL+232                                               09766000
GDTDEQ   EQU   GDTTBL+236                                               09767000
GDTSFO   EQU   GDTTBL+240                                               09768000
GDTWTO   EQU   GDTTBL+244                                               09769000
GDTSCR   EQU   GDTTBL+248                                               09770000
GDTUNT   EQU   GDTTBL+252                                               09771000
GDTRCT   EQU   GDTTBL+256                                               09772000
GDTIFO   EQU   GDTTBL+260                                               09773000
GDTEXP   EQU   GDTTBL+264                                               09774000
GDTSTA   EQU   GDTTBL+268                                               09775000
GDTERR   EQU   GDTTBL+272                                               09776000
GDTUNC   EQU   GDTTBL+276                                               09777000
GDTLOC   EQU   GDTTBL+280                                               09778000
FDTTBL   EQU   0                                                        09779000
FDTPTR   EQU   FDTTBL+8                                                 09780000
LASTCOND EQU   0                                                        09781000
CKCSNVAL EQU   0                                                        09782000
CKLENGTH EQU   0                                                        09783000
VECSN1   EQU   0                                                        09784000
VEVOLUME EQU   0                                                        09785000
VEVVIERR EQU   0                                                        09786000
VERECFLG EQU   0                                                        09787000
VEVOLLOC EQU   0                                                        09788000
SSRCODE  EQU   0                                                        09789000
SSRHALF  EQU   SSRCODE+2                                                09790000
SSECBCD  EQU   0                                                        09791000
SCINPUT  EQU   0                                                        09792000
SCERRFLG EQU   SCINPUT                                                  09793000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    09794000
@NM00147 EQU   SCINPUT                                                  09795000
@NM00146 EQU   SSRCODE                                                  09796000
FDTVERB  EQU   FDTTBL                                                   09797000
GDTECT   EQU   GDTTBL+188                                               09798000
GDTPSB   EQU   GDTTBL+184                                               09799000
GDTUPT   EQU   GDTTBL+180                                               09800000
GDTCMB   EQU   GDTTBL+176                                               09801000
GDTSPR   EQU   GDTTBL+168                                               09802000
@NM00001 EQU   GDTTBL+160                                               09803000
GDTABH   EQU   GDTTBL+156                                               09804000
GDTABT   EQU   GDTTBL+152                                               09805000
GDTTOH   EQU   GDTTBL+120                                               09806000
GDTRIP   EQU   GDTTBL+116                                               09807000
GDTIOH   EQU   GDTTBL+36                                                09808000
GDTSAH   EQU   GDTTBL+32                                                09809000
GDTTPH   EQU   GDTTBL+28                                                09810000
GDTRIH   EQU   GDTTBL+24                                                09811000
GDTSTH   EQU   GDTTBL+20                                                09812000
GDTDBH   EQU   GDTTBL+16                                                09813000
GDTPRM   EQU   GDTTBL+4                                                 09814000
GDTHDR   EQU   GDTTBL                                                   09815000
MCRTECB  EQU   MCLIST+40                                                09816000
MCRTASID EQU   MCLIST+38                                                09817000
MCRTRES4 EQU   MCLIST+36                                                09818000
MCRTRES3 EQU   MCLIST+16                                                09819000
MCRTRES2 EQU   MCLIST+8                                                 09820000
MCRTLD   EQU   MCRTLIB                                                  09821000
@NM00142 EQU   MCRTLIB                                                  09822000
@NM00141 EQU   MCRTFLG                                                  09823000
MCRTSCT  EQU   MCRTFLG                                                  09824000
@NM00140 EQU   MCRTFLG                                                  09825000
MCRTRES1 EQU   MCLIST+5                                                 09826000
MCRTOPCD EQU   MCLIST+4                                                 09827000
MCRTLEN  EQU   MCLIST                                                   09828000
@NM00139 EQU   MCRTE+40                                                 09829000
@NM00138 EQU   MCRFLAGB+3                                               09830000
@NM00137 EQU   MCRTYPE                                                  09831000
@NM00136 EQU   MCRFLAGB+1                                               09832000
@NM00135 EQU   MCRFLAGB                                                 09833000
MCRBLNK1 EQU   MCRTE+35                                                 09834000
@NM00134 EQU   MCRFLAGA                                                 09835000
@NM00128 EQU   COVCE+39                                                 09836000
@NM00127 EQU   COVFLAGB+3                                               09837000
@NM00126 EQU   COVTYPE                                                  09838000
@NM00125 EQU   COVRECFL                                                 09839000
COVLAMIS EQU   COVRECFL                                                 09840000
COVCREAT EQU   COVRECFL                                                 09841000
@NM00124 EQU   COVSETFL                                                 09842000
COVCRCVY EQU   COVSETFL                                                 09843000
@NM00123 EQU   COVFLAGA                                                 09844000
CVOLRES2 EQU   COVLIST+34                                               09845000
CVOLRUA  EQU   COVLIST+32                                               09846000
CVOLECB  EQU   COVLIST+16                                               09847000
CVOLASID EQU   COVLIST+14                                               09848000
@NM00122 EQU   CVOLFLG                                                  09849000
CVOCRCRV EQU   CVOLFLG                                                  09850000
CVOCRDAS EQU   CVOLFLG                                                  09851000
CVODASCR EQU   CVOLFLG                                                  09852000
CVOLRES1 EQU   COVLIST+5                                                09853000
CVOLOPCD EQU   COVLIST+4                                                09854000
CVOLLEN  EQU   COVLIST                                                  09855000
@NM00121 EQU   DEFVE+60                                                 09856000
@NM00120 EQU   DEFNULFL                                                 09857000
DEFNEXPD EQU   DEFNULFL                                                 09858000
DEFNDESC EQU   DEFNULFL                                                 09859000
DEFNGRP  EQU   DEFNULFL                                                 09860000
@NM00119 EQU   DEFTYPFL                                                 09861000
DEFDUP   EQU   DEFTYPFL                                                 09862000
DEFRSTD  EQU   DEFTYPFL                                                 09863000
DEFGENUS EQU   DEFTYPFL                                                 09864000
@NM00118 EQU   DEFRECFL                                                 09865000
DEFLAMIS EQU   DEFRECFL                                                 09866000
DEFCREAT EQU   DEFRECFL                                                 09867000
@NM00117 EQU   DEFSETFL                                                 09868000
DEFCRCVY EQU   DEFSETFL                                                 09869000
@NM00116 EQU   DEFFLAGA                                                 09870000
DEFPBKUP EQU   DEFFLAGA                                                 09871000
DEFPTO   EQU   DEFFLAGA                                                 09872000
DEFPGRO  EQU   DEFFLAGA                                                 09873000
DEFPVLAB EQU   DEFFLAGA                                                 09874000
DEFPFOR  EQU   DEFFLAGA                                                 09875000
DEFLABEL EQU   DEFVE+49                                                 09876000
DEFBKUPN EQU   DEFVE+48                                                 09877000
DEFFOR   EQU   DEFVE+46                                                 09878000
DEFTO    EQU   DEFVE+42                                                 09879000
DEFGROUP EQU   DEFVE+4                                                  09880000
DEFR60   EQU   DEFVDATA+43                                              09881000
DEFR55   EQU   DEFVDATA+3                                               09882000
DEFACSEC EQU   DEFVDATA+2                                               09883000
DEFR50   EQU   DEFVDATA                                                 09884000
DEFVECB  EQU   DEFLIST+52                                               09885000
DEFVASID EQU   DEFLIST+50                                               09886000
@NM00115 EQU   DEFLIST+48                                               09887000
@NM00114 EQU   DEFLIST+22                                               09888000
@NM00113 EQU   DEFLIST+15                                               09889000
@NM00112 EQU   DEFVVFLG                                                 09890000
@NM00111 EQU   DEFVVFLG                                                 09891000
@NM00110 EQU   DEFVVFLG                                                 09892000
DEFVCECT EQU   DEFVVFLG                                                 09893000
DEFVLID  EQU   DEFVLIB                                                  09894000
@NM00109 EQU   DEFVLIB                                                  09895000
DEFVDACT EQU   DEFVFLG                                                  09896000
DEFVACT  EQU   DEFVFLG                                                  09897000
DEFVREP  EQU   DEFVFLG                                                  09898000
DEFVRNM  EQU   DEFVFLG                                                  09899000
DEFVELM  EQU   DEFVFLG                                                  09900000
@NM00108 EQU   DEFLIST+5                                                09901000
DEFVOPCD EQU   DEFLIST+4                                                09902000
DEFVLEN  EQU   DEFLIST                                                  09903000
@NM00107 EQU   COPYV+136                                                09904000
COPFREXT EQU   COPYV+132                                                09905000
COPLEXT  EQU   COPYV+130                                                09906000
COPFRESP EQU   COPYV+128                                                09907000
COPDESCR EQU   COPYV+58                                                 09908000
COPDTREM EQU   COPYV+54                                                 09909000
COP2BIT2 EQU   COPLID2                                                  09910000
COP2BIT1 EQU   COPLID2                                                  09911000
COPRES5  EQU   COPLIB2                                                  09912000
COP1BIT2 EQU   COPLID1                                                  09913000
COP1BIT1 EQU   COPLID1                                                  09914000
COPRES4  EQU   COPLIB1                                                  09915000
@NM00106 EQU   COPMISCF                                                 09916000
COPHOLD  EQU   COPMISCF                                                 09917000
COPRES3  EQU   COPSATIA                                                 09918000
COPVSMIS EQU   COPSATIA                                                 09919000
COPIVCPY EQU   COPSATIA                                                 09920000
COPIVCRE EQU   COPSATIA                                                 09921000
@NM00105 EQU   COPYV+18                                                 09922000
@NM00104 EQU   COPFLAGA+3                                               09923000
COPDLSPF EQU   COPFLAGA+3                                               09924000
COPRONLY EQU   COPFLAGA+3                                               09925000
COPDAERA EQU   COPFLAGA+2                                               09926000
COPEXCL  EQU   COPFLAGA+2                                               09927000
COPBIND  EQU   COPFLAGA+2                                               09928000
COPBKUP  EQU   COPFLAGA+2                                               09929000
COPRSTD  EQU   COPFLAGA+2                                               09930000
COPGENUS EQU   COPFLAGA+2                                               09931000
COPVSAM  EQU   COPFLAGA+2                                               09932000
COPGROUP EQU   COPFLAGA+2                                               09933000
COPRES2  EQU   COPTYPE                                                  09934000
COPCOPYV EQU   COPTYPE                                                  09935000
COPRES1  EQU   COPTYPE                                                  09936000
COPRES6  EQU   COPYV+13                                                 09937000
COPNO    EQU   COPID+1                                                  09938000
COPBLANK EQU   COPID                                                    09939000
COPSERNO EQU   COPNAME+5                                                09940000
COPV     EQU   COPNAME                                                  09941000
@NM00103 EQU   BASEV+192                                                09942000
BASXPDT2 EQU   BASEV+188                                                09943000
BASGROUP EQU   BASEV+180                                                09944000
BASRECOV EQU   BASEV+174                                                09945000
BASDEST  EQU   BASEV+144                                                09946000
BASDESCR EQU   BASEV+104                                                09947000
BASDTREM EQU   BASEV+100                                                09948000
BASEXPDT EQU   BASEV+96                                                 09949000
BASDLMTD EQU   BASEV+92                                                 09950000
BASRES6  EQU   BASEV+89                                                 09951000
BASCOPNO EQU   BASCOPID+1                                               09952000
BASCOPBK EQU   BASCOPID                                                 09953000
BASCOPSN EQU   BASKLCPY+5                                               09954000
BASCOPV  EQU   BASKLCPY                                                 09955000
BASFREXT EQU   BASEV+72                                                 09956000
BASLEXT  EQU   BASEV+70                                                 09957000
BASFRESP EQU   BASEV+68                                                 09958000
@NM00102 EQU   BASEV+65                                                 09959000
BASNEXTV EQU   BASEV+56                                                 09960000
BASPREV  EQU   BASEV+50                                                 09961000
BAS2BIT2 EQU   BASLID2                                                  09962000
BAS2BIT1 EQU   BASLID2                                                  09963000
BASRES5  EQU   BASLIB2                                                  09964000
BASCSN2  EQU   BASEV+37                                                 09965000
BAS1BIT2 EQU   BASLID1                                                  09966000
BAS1BIT1 EQU   BASLID1                                                  09967000
BASRES4  EQU   BASLIB1                                                  09968000
BASCSN1  EQU   BASEV+24                                                 09969000
BASRES3  EQU   BASMISCF                                                 09970000
BASHOLD  EQU   BASMISCF                                                 09971000
BASRES8  EQU   BASSATIA                                                 09972000
BASCPUID EQU   BASEV+18                                                 09973000
@NM00101 EQU   BASFLAGA+3                                               09974000
BASLAST  EQU   BASFLAGA+3                                               09975000
BASFIRST EQU   BASFLAGA+3                                               09976000
BASREASS EQU   BASFLAGA+3                                               09977000
BASRSTD  EQU   BASFLAGA+2                                               09978000
BASGENUS EQU   BASFLAGA+2                                               09979000
BASGRPV  EQU   BASFLAGA+2                                               09980000
BASNOCPY EQU   BASFLAGA+2                                               09981000
BASDLSF  EQU   BASFLAGA+2                                               09982000
BASRES2  EQU   BASTYPE                                                  09983000
BASBASVR EQU   BASTYPE                                                  09984000
BASRES1  EQU   BASTYPE                                                  09985000
BASRES7  EQU   BASEV+13                                                 09986000
BASZERO  EQU   BASID+1                                                  09987000
BASBLANK EQU   BASID                                                    09988000
BASSERNO EQU   BASNAME+5                                                09989000
BASEVKEY EQU   BASNAME                                                  09990000
@NM00100 EQU   MVR+82                                                   09991000
MVRLABEL EQU   MVR+76                                                   09992000
MVRBLNK1 EQU   MVR+75                                                   09993000
MVRBKUPN EQU   MVR+74                                                   09994000
MVRTO    EQU   MVR+58                                                   09995000
MVRDES   EQU   MVR+28                                                   09996000
MVRGROUP EQU   MVR+20                                                   09997000
MVRFOR   EQU   MVR+18                                                   09998000
@NM00099 EQU   MVRFLAGA+2                                               09999000
MVRCIVCF EQU   MVRFLAGA+2                                               10000000
MVRCLMIS EQU   MVRFLAGA+1                                               10001000
MVRSLMIS EQU   MVRFLAGA+1                                               10002000
MVRNEXPD EQU   MVRFLAGA+1                                               10003000
MVRNDESC EQU   MVRFLAGA+1                                               10004000
MVRNGRP  EQU   MVRFLAGA+1                                               10005000
MVRRSTD  EQU   MVRFLAGA+1                                               10006000
MVRGEN   EQU   MVRFLAGA+1                                               10007000
MVRFLLAB EQU   MVRFLAGA                                                 10008000
MVRFLBK  EQU   MVRFLAGA                                                 10009000
MVRFLTO  EQU   MVRFLAGA                                                 10010000
MVRFLDES EQU   MVRFLAGA                                                 10011000
MVRFLGRO EQU   MVRFLAGA                                                 10012000
MVRFLFOR EQU   MVRFLAGA                                                 10013000
@NM00098 EQU   MVRCODE+1                                                10014000
MVROPCD  EQU   MVRCODE                                                  10015000
@NM00097 EQU   RVVI+64                                                  10016000
RVVSDUP  EQU   RVVSPEC                                                  10017000
RVVSCPY  EQU   RVVSPEC                                                  10018000
RVVSCSN  EQU   RVVSPEC                                                  10019000
RVVSSEQ  EQU   RVVSPEC                                                  10020000
RVVSDTE  EQU   RVVSPEC                                                  10021000
RVVSEXP  EQU   RVVSPEC                                                  10022000
RVVSGRP  EQU   RVVSPEC                                                  10023000
@NM00096 EQU   RVVCPYTP                                                 10024000
RVVCPLHD EQU   RVVCPYTP                                                 10025000
RVVLBKUP EQU   RVVCPYTP                                                 10026000
RVVBPLHD EQU   RVVRTEST                                                 10027000
RVVDVOL  EQU   RVVRTEST                                                 10028000
RVVACTV  EQU   RVVRTEST                                                 10029000
RVVINACT EQU   RVVRTEST                                                 10030000
RVVRSTD  EQU   RVVRTEST                                                 10031000
RVVGSVOL EQU   RVVRTEST                                                 10032000
RVVTHOLD EQU   RVVRTEST                                                 10033000
RVVEXPDT EQU   RVVRTEST                                                 10034000
RVVALL   EQU   RVVRDRCD                                                 10035000
RVVCPURC EQU   RVVRDRCD                                                 10036000
RVVCIRCD EQU   RVVRDRCD                                                 10037000
RVVRUNKN EQU   RVVRDRCD                                                 10038000
RVVDUPRC EQU   RVVRDRCD                                                 10039000
RVVGRPRC EQU   RVVRDRCD                                                 10040000
@NM00095 EQU   RVVCHAIN                                                 10041000
RVVNGVOL EQU   RVVCHAIN                                                 10042000
RVVGPVOL EQU   RVVCHAIN                                                 10043000
@NM00094 EQU   RVVRMODE                                                 10044000
RVVRDCH  EQU   RVVRMODE                                                 10045000
RVVRDNR  EQU   RVVRMODE                                                 10046000
RVVDUPID EQU   RVVI+57                                                  10047000
RVVCPYID EQU   RVVI+56                                                  10048000
RVVRDCSN EQU   RVVI+44                                                  10049000
RVVRDSEQ EQU   RVVI+43                                                  10050000
RVVBLNK1 EQU   RVVI+42                                                  10051000
RVVCDATE EQU   RVVI+38                                                  10052000
RVVEXPIR EQU   RVVI+36                                                  10053000
@NM00093 EQU   RVVI+28                                                  10054000
RVVAREA  EQU   RVVI+24                                                  10055000
RVVARLN  EQU   RVVI+22                                                  10056000
RVVGROUP EQU   RVVI+14                                                  10057000
@NM00092 EQU   RVVOPCOD+1                                               10058000
PFILEVAL EQU   @NM00091+1                                               10059000
PFILELEN EQU   @NM00091                                                 10060000
PFILECNT EQU   PFILE                                                    10061000
FILELEN  EQU   FILE                                                     10062000
CATDNLEN EQU   CATDN                                                    10063000
CATNMLEN EQU   CATNM+20                                                 10064000
CATNMMEM EQU   CATNM+12                                                 10065000
CATNMMLN EQU   CATNM+11                                                 10066000
CATNMFUQ EQU   CATNMFLG                                                 10067000
CATNMPOS EQU   CATNM+9                                                  10068000
LOCLEN   EQU   LOC                                                      10069000
DESCRLEN EQU   DESCR                                                    10070000
VSDDSN   EQU   VSDARRAY+4                                               10071000
VSDVOLCT EQU   VSDARRAY                                                 10072000
VSDFMT0  EQU   VSDBLOCK+8                                               10073000
VSDVTOCS EQU   VSDBLOCK+4                                               10074000
VSDELEM  EQU   VSDBLOCK                                                 10075000
VSDFREE  EQU   VSDUSAGE+24                                              10076000
VSDALLC  EQU   VSDUSAGE+19                                              10077000
VSDDSOR3 EQU   VSDDSORG+2                                               10078000
@NM00090 EQU   VSDDSORG                                                 10079000
VSDSCAL  EQU   VSDUSAGE+12                                              10080000
@NM00089 EQU   VSDUSEF                                                  10081000
VSDCALFR EQU   VSDUSEF                                                  10082000
@NM00088 EQU   VSDALLOC                                                 10083000
VSDABSTR EQU   VSDALLOC                                                 10084000
VSDABLK  EQU   VSDALLOC                                                 10085000
VSDATRK  EQU   VSDALLOC                                                 10086000
VSDACYL  EQU   VSDALLOC                                                 10087000
@NM00087 EQU   VSDDORG                                                  10088000
VSDOU    EQU   VSDDORG                                                  10089000
VSDOIS   EQU   VSDDORG                                                  10090000
VSDODA   EQU   VSDDORG                                                  10091000
VSDOUN   EQU   VSDDORG                                                  10092000
VSDOPS   EQU   VSDDORG                                                  10093000
VSDOPO   EQU   VSDDORG                                                  10094000
VSDEXTS  EQU   VSDUSAGE+8                                               10095000
VSDSECAL EQU   VSDUSAGE+4                                               10096000
VSDFTRK  EQU   VSDUSAGE+2                                               10097000
VSDTRKS  EQU   VSDUSAGE                                                 10098000
@NM00086 EQU   VSDSCR+5                                                 10099000
@NM00085 EQU   VSDSCRFL                                                 10100000
VSDVSAM  EQU   VSDSCRFL                                                 10101000
VSDCATLC EQU   VSDSCRFL                                                 10102000
VSDACBPT EQU   VSDSCR                                                   10103000
VSDPRTC  EQU   VSDSTAT+25                                               10104000
VSDCAT   EQU   VSDSTAT+22                                               10105000
VSDEXP   EQU   VSDSTAT+20                                               10106000
VSDCRE   EQU   VSDSTAT+18                                               10107000
@NM00084 EQU   VSDFLG2                                                  10108000
VSDERROR EQU   VSDFLG2                                                  10109000
VSDPROT  EQU   VSDFLG2                                                  10110000
VSDPWW   EQU   VSDFLG2                                                  10111000
VSDPWR   EQU   VSDFLG2                                                  10112000
@NM00083 EQU   VSDSFLG1                                                 10113000
VSDCVSAM EQU   VSDSFLG1                                                 10114000
VSDCATLG EQU   VSDSFLG1                                                 10115000
VSDVSAME EQU   VSDSFLG1                                                 10116000
VSDVSAMC EQU   VSDSFLG1                                                 10117000
VSDVTOCE EQU   VSDSFLG1                                                 10118000
VSDVTOCC EQU   VSDSFLG1                                                 10119000
VSDOWNER EQU   VSDSTAT+8                                                10120000
VSDEXPIR EQU   VSDSTAT+4                                                10121000
VSDCREAT EQU   VSDSTAT                                                  10122000
VSDFRCCL EQU   VSDVTOC+21                                               10123000
@NM00082 EQU   VSDVTOC+20                                               10124000
VSDFREXT EQU   VSDVTOC+16                                               10125000
@NM00081 EQU   VSDVTOC+15                                               10126000
VSDFRTRK EQU   VSDVTOC+11                                               10127000
@NM00080 EQU   VSDVTOC+10                                               10128000
VSDFRCYL EQU   VSDVTOC+6                                                10129000
@NM00079 EQU   VSDVTOC                                                  10130000
@NM00078 EQU   VS3FLAGS                                                 10131000
VS3SYSNM EQU   VS3FLAGS                                                 10132000
VS3UNCAT EQU   VS3FLAGS                                                 10133000
VS3SCR   EQU   VS3FLAGS                                                 10134000
VS3USAGE EQU   VS3FLAGS                                                 10135000
VS3STAT  EQU   VS3FLAGS                                                 10136000
VS3DD    EQU   VS3AGL+50                                                10137000
VS3VOL   EQU   VS3AGL+44                                                10138000
VS3POOL  EQU   VS3AGL+40                                                10139000
VS3DEV   EQU   VS3AGL+36                                                10140000
VS3UCBP  EQU   VS3AGL+32                                                10141000
VS3CREAT EQU   VS3AGL+28                                                10142000
VS3EXPIR EQU   VS3AGL+24                                                10143000
VS3AST   EQU   VS3AGL+22                                                10144000
VS3LEVLN EQU   VS3AGL+20                                                10145000
VS3LEVP  EQU   VS3AGL+16                                                10146000
VS3EXDSP EQU   VS3AGL+12                                                10147000
VS3LISTP EQU   VS3AGL+8                                                 10148000
VS3HEAD  EQU   VS3AGL                                                   10149000
@NM00077 EQU   DATESOPT                                                 10150000
DATDAYOP EQU   DATESOPT                                                 10151000
DATDTEOP EQU   DATESOPT                                                 10152000
DATSUB   EQU   DATESOPT                                                 10153000
DATADD   EQU   DATESOPT                                                 10154000
DATRETRN EQU   DATESAGL+16                                              10155000
DATDAYS  EQU   DATESAGL+12                                              10156000
DATDATE  EQU   DATESAGL+8                                               10157000
DATHEAD  EQU   DATESAGL                                                 10158000
@NM00076 EQU   SELFLAGS                                                 10159000
SELVOL   EQU   SELAGL+16                                                10160000
SELDDNP  EQU   SELAGL+12                                                10161000
SELUCBP  EQU   SELAGL+8                                                 10162000
SELHEAD  EQU   SELAGL                                                   10163000
@NM00075 EQU   UCTFLAGS                                                 10164000
UCTVSCAT EQU   UCTFLAGS                                                 10165000
UCTDD    EQU   UCTAGL+60                                                10166000
UCTVOLP  EQU   UCTAGL+56                                                10167000
UCTACBP  EQU   UCTAGL+52                                                10168000
UCTDSN   EQU   UCTAGL+8                                                 10169000
UCTHEAD  EQU   UCTAGL                                                   10170000
@NM00074 EQU   LCTFLAGS                                                 10171000
LCTVSCAT EQU   LCTFLAGS                                                 10172000
LCTOWNER EQU   LCTINFO+24                                               10173000
LCTEXPIR EQU   LCTINFO+20                                               10174000
LCTCREAT EQU   LCTINFO+16                                               10175000
LCTACBP  EQU   LCTINFO+12                                               10176000
LCTMULVC EQU   LCTINFO+8                                                10177000
LCTHEAD  EQU   LCTINFO                                                  10178000
SRTWORKP EQU   SRTAGL+28                                                10179000
SRTFLDLN EQU   SRTAGL+24                                                10180000
SRTPOSIT EQU   SRTAGL+20                                                10181000
SRTLEN   EQU   SRTAGL+16                                                10182000
SRTNUM   EQU   SRTAGL+12                                                10183000
SRTADDR  EQU   SRTAGL+8                                                 10184000
SRTHEAD  EQU   SRTAGL                                                   10185000
SV82DEBP EQU   SV82WRKP                                                 10186000
SV82TTRP EQU   SV82LIST+8                                               10187000
SV82VOLP EQU   SV82DCBP                                                 10188000
SV82UCBP EQU   SV82LIST+1                                               10189000
SV82CODE EQU   SV82LIST                                                 10190000
VOLRESV3 EQU   VOLLABEL+55                                              10191000
VOLOWNER EQU   VOLLABEL+45                                              10192000
VOLRESV1 EQU   VOLLABEL+20                                              10193000
VOLVTOC  EQU   VOLLABEL+15                                              10194000
VOLSECTY EQU   VOLLABEL+14                                              10195000
VOLSERNO EQU   VOLLABEL+8                                               10196000
VOLNO    EQU   VOLLABEL+7                                               10197000
VOLLABI  EQU   VOLLABEL+4                                               10198000
VOLKEY   EQU   VOLLABEL                                                 10199000
STAVTTR  EQU   STAEPARM+54                                              10200000
@NM00071 EQU   STARETRY                                                 10201000
STAVTOC  EQU   STARETRY                                                 10202000
STAOFF   EQU   STARETRY                                                 10203000
STAIO05  EQU   STARETRY                                                 10204000
@NM00070 EQU   STARCVY                                                  10205000
STACLEAR EQU   STARCVY                                                  10206000
STAVPOST EQU   STARCVY                                                  10207000
STAVENQ  EQU   STARCVY                                                  10208000
STAVDMNT EQU   STARCVY                                                  10209000
STAVMNT  EQU   STARCVY                                                  10210000
STATCB   EQU   STAEPARM+48                                              10211000
STARTADD EQU   STAEPARM+44                                              10212000
STAEXSAV EQU   STAEPARM+40                                              10213000
STARTSAV EQU   STAEPARM+36                                              10214000
STARTTR  EQU   STAEPARM+32                                              10215000
@NM00069 EQU   STAEPARM+30                                              10216000
STARVOL  EQU   STAEPARM+24                                              10217000
STARUCB  EQU   STAEPARM+20                                              10218000
@NM00068 EQU   STAEPARM+18                                              10219000
STAVVOL  EQU   STAEPARM+12                                              10220000
STAVUCB  EQU   STAEPARM+8                                               10221000
STAHEAD  EQU   STAEPARM                                                 10222000
RCTDSET  EQU   RCTAGL+32                                                10223000
RCTNVOL  EQU   RCTAGL+26                                                10224000
RCTOVOL  EQU   RCTAGL+20                                                10225000
RCTNDEV  EQU   RCTAGL+16                                                10226000
RCTODEV  EQU   RCTAGL+12                                                10227000
@NM00067 EQU   RCTAGL+10                                                10228000
@NM00066 EQU   RCTOPT                                                   10229000
RCTVOL   EQU   RCTOPT                                                   10230000
RCTDEV   EQU   RCTOPT                                                   10231000
RCTHEAD  EQU   RCTAGL                                                   10232000
@NM00065 EQU   VSRESOPT                                                 10233000
VSREAL   EQU   VSRESOPT                                                 10234000
@NM00064 EQU   VSMSG                                                    10235000
VSTOV    EQU   VSMSG                                                    10236000
VSFROMV  EQU   VSMSG                                                    10237000
@NM00063 EQU   VSRETURN                                                 10238000
VSUCAT   EQU   VSRETURN                                                 10239000
@NM00062 EQU   VSCATOPT                                                 10240000
VSLIST   EQU   VSCATOPT                                                 10241000
VSSERIAL EQU   VSCATOPT                                                 10242000
VSDEVICE EQU   VSCATOPT                                                 10243000
@NM00061 EQU   VSVTOPT                                                  10244000
VSVSFLAG EQU   VSVTOPT                                                  10245000
VSALTTRK EQU   VSVTOPT                                                  10246000
VSUCMAST EQU   VSSECOPT                                                 10247000
VSOPCAT  EQU   VSSECOPT                                                 10248000
VSUCTEST EQU   VSSECOPT                                                 10249000
VSWRITE  EQU   VSSECOPT                                                 10250000
VSNONONV EQU   VSSECOPT                                                 10251000
VSNOVSAM EQU   VSSECOPT                                                 10252000
VSODEVP  EQU   VS1AGL+64                                                10253000
VSOSERP  EQU   VS1AGL+60                                                10254000
VSDEVP   EQU   VS1AGL+56                                                10255000
VSSERP   EQU   VS1AGL+52                                                10256000
VSACBP   EQU   VS1AGL+36                                                10257000
VSNXTATP EQU   VS1AGL+28                                                10258000
VSNUMATP EQU   VS1AGL+24                                                10259000
VSHEAD   EQU   VS1AGL                                                   10260000
VSVTOCPT EQU   VS2AGL+48                                                10261000
@NM00060 EQU   VS2AGL+45                                                10262000
VSDDNAME EQU   VS2AGL+37                                                10263000
@NM00059 EQU   VS2RESOP                                                 10264000
VS2REAL  EQU   VS2RESOP                                                 10265000
VS2RES   EQU   VS2RESOP                                                 10266000
@NM00058 EQU   VS2MSG                                                   10267000
VS2TOV   EQU   VS2MSG                                                   10268000
VSVOLUME EQU   VS2AGL+29                                                10269000
@NM00057 EQU   VSLABOPT                                                 10270000
VSNOVTOC EQU   VSLABOPT                                                 10271000
VSVOLSER EQU   VSLABOPT                                                 10272000
VSOWNER  EQU   VSLABOPT                                                 10273000
VSIOBKPT EQU   VS2AGL+24                                                10274000
VSVOLPTR EQU   VS2AGL+20                                                10275000
VSOWNPTR EQU   VS2AGL+16                                                10276000
VSVTOCSZ EQU   VS2AGL+12                                                10277000
VSUCBPTR EQU   VS2AGL+8                                                 10278000
VS2HEAD  EQU   VS2AGL                                                   10279000
EXPDATAL EQU   EXPARRAY+6                                               10280000
@NM00056 EQU   EXPARRAY+5                                               10281000
EXPKEYLN EQU   EXPARRAY+4                                               10282000
EXPDATAP EQU   EXPARRAY                                                 10283000
EXPRECNO EQU   EXPDATAB                                                 10284000
EXPCCHHR EQU   EXPARG+16                                                10285000
EXPCTLBK EQU   EXPARG+8                                                 10286000
EXPHEAD  EQU   EXPARG                                                   10287000
EXRWFUN  EQU   EXWRARG+46                                               10288000
@NM00055 EQU   EXSPACE+8                                                10289000
@NM00054 EQU   EXSPACE+6                                                10290000
@NM00053 EQU   EXSPACE+4                                                10291000
@NM00052 EQU   EXSPACE+1                                                10292000
@NM00051 EQU   EXSPACE                                                  10293000
EXRWKDLN EQU   EXWRARG+32                                               10294000
@NM00050 EQU   EXWRARG+31                                               10295000
EXRECNUM EQU   EXRWCHR+4                                                10296000
EXHH     EQU   EXRWCHR+2                                                10297000
EXCC     EQU   EXRWCHR                                                  10298000
EXCCWCNT EQU   EXWRARG+24                                               10299000
EXLOCPTR EQU   EXWRARG+20                                               10300000
EXRWDARE EQU   EXWRARG+16                                               10301000
EXRWIOAR EQU   EXWRARG+12                                               10302000
EXRWCTBL EQU   EXWRARG+8                                                10303000
EXRWRES  EQU   EXWRARG                                                  10304000
EXGDATAL EQU   EXGARG+30                                                10305000
@NM00049 EQU   EXGARG+29                                                10306000
EXGKEYLN EQU   EXGARG+28                                                10307000
EXGDATAP EQU   EXGARG+24                                                10308000
EXGRECNO EQU   EXGARG+20                                                10309000
EXGCCHH2 EQU   EXGARG+16                                                10310000
EXGCCHH1 EQU   EXGARG+12                                                10311000
EXGCTLBK EQU   EXGARG+8                                                 10312000
EXGHEAD  EQU   EXGARG                                                   10313000
EXOVTH   EQU   EXFLG                                                    10314000
EXORVT   EQU   EXFLG                                                    10315000
EXORDS   EQU   EXFLG                                                    10316000
EXOSPK   EQU   EXFLG                                                    10317000
EXORVS   EQU   EXFLG                                                    10318000
@NM00048 EQU   EXFLG                                                    10319000
EXOREAD  EQU   EXFLG                                                    10320000
@NM00047 EQU   EXOPT                                                    10321000
EXOREP   EQU   EXOPT                                                    10322000
EXOVTOC  EQU   EXOPT                                                    10323000
EXONEW   EQU   EXOPT                                                    10324000
EXOPASS  EQU   EXOPT                                                    10325000
EXOLAB   EQU   EXOPT                                                    10326000
EXOTAB   EQU   EXOPT                                                    10327000
EXOCTLBK EQU   EXOARG+28                                                10328000
EXOEXT   EQU   EXOARG+24                                                10329000
EXOUCB   EQU   EXOARG+20                                                10330000
EXOVSN   EQU   EXOARG+16                                                10331000
EXODSN   EQU   EXOARG+12                                                10332000
EXODDN   EQU   EXOARG+8                                                 10333000
EXOHEAD  EQU   EXOARG                                                   10334000
@NM00046 EQU   EXCLFLAG                                                 10335000
EXCLMNT  EQU   EXCLFLAG                                                 10336000
EXCLHEAD EQU   EXCLAGL                                                  10337000
@NM00045 EQU   CKFLAGS                                                  10338000
CKDMTABL EQU   CKFLAGS                                                  10339000
CKRETTYP EQU   CKFLAGS                                                  10340000
CKLABELP EQU   CKAGL+24                                                 10341000
CKDATYPE EQU   CKAGL+20                                                 10342000
CKHEAD   EQU   CKAGL                                                    10343000
PULABELP EQU   PUAGL+16                                                 10344000
PUTTRPTR EQU   PUAGL+12                                                 10345000
PUUCBPTR EQU   PUAGL+8                                                  10346000
PUHEAD   EQU   PUAGL                                                    10347000
MDR      EQU   MDVTOC+4                                                 10348000
MDHH     EQU   MDVTOC+2                                                 10349000
MDCC     EQU   MDVTOC                                                   10350000
@NM00044 EQU   MDAGL+31                                                 10351000
MDVTOCTR EQU   MDFLAGS                                                  10352000
MDFORCE  EQU   MDFLAGS                                                  10353000
MDDEQ    EQU   MDFLAGS                                                  10354000
MDENQ    EQU   MDFLAGS                                                  10355000
MDPOST   EQU   MDFLAGS                                                  10356000
MDCLEAR  EQU   MDFLAGS                                                  10357000
MDNEWVOL EQU   MDFLAGS                                                  10358000
MDPUAGL  EQU   MDAGL+20                                                 10359000
MDHEAD   EQU   MDAGL                                                    10360000
CTTBLRR  EQU   CTARRAY+3                                                10361000
CTTBLHH  EQU   CTARRAY+2                                                10362000
CTTBLCC  EQU   CTARRAY+1                                                10363000
CTTBLID  EQU   CTARRAY                                                  10364000
CTREALH  EQU   CTMSG+3                                                  10365000
CTREALCC EQU   CTMSG+1                                                  10366000
@NM00043 EQU   CTMSG                                                    10367000
@NM00042 EQU   CMMSG+14                                                 10368000
CMNEWVOL EQU   CMMSG+8                                                  10369000
@NM00041 EQU   CMMSG+7                                                  10370000
@NM00040 EQU   CMVOLFLG                                                 10371000
CMRONLY  EQU   CMVOLFLG                                                 10372000
CMBIND   EQU   CMVOLFLG                                                 10373000
CMSCRCRT EQU   CMVOLFLG                                                 10374000
CMEXCL   EQU   CMVOLFLG                                                 10375000
CMDERAS  EQU   CMVOLFLG                                                 10376000
CMSCRVOL EQU   CMVOLFLG                                                 10377000
CMCECART EQU   CMVOLFLG                                                 10378000
CMOLDVOL EQU   CMMSG                                                    10379000
CCOLDCSN EQU   CCMSG+24                                                 10380000
CCNEWCSN EQU   CCMSG+12                                                 10381000
@NM00039 EQU   CCMSG+10                                                 10382000
CCVOL    EQU   CCMSG+4                                                  10383000
@NM00038 EQU   CCMSG+2                                                  10384000
CCEJCODE EQU   CCMSG+1                                                  10385000
CCPSTCDE EQU   CCMSG                                                    10386000
@NM00037 EQU   DMPARY+15                                                10387000
DMPARYTP EQU   DMPARY+14                                                10388000
DMPARYEX EQU   DMPARY+12                                                10389000
DMPARYIC EQU   DMPARY+10                                                10390000
DMPARYSZ EQU   DMPARY+8                                                 10391000
DMPARYNM EQU   DMPARY                                                   10392000
@NM00036 EQU   DMPITM+15                                                10393000
@NM00035 EQU   ERCNVTAB+24                                              10394000
ERCPLPT  EQU   ERCNVTAB+20                                              10395000
ERCATRC  EQU   ERCNVTAB+16                                              10396000
ERDSNM   EQU   ERCNVTAB+12                                              10397000
@NM00034 EQU   ERCNVTAB+4                                               10398000
@NM00033 EQU   ERCNVTAB+3                                               10399000
@NM00032 EQU   EROSOPER                                                 10400000
EROSUCDX EQU   EROSOPER                                                 10401000
EROSCATL EQU   EROSOPER                                                 10402000
@NM00031 EQU   EROPER                                                   10403000
ERCATAL  EQU   EROPER                                                   10404000
ERCATDL  EQU   EROPER                                                   10405000
ERCATDE  EQU   EROPER                                                   10406000
ERCATLC  EQU   EROPER                                                   10407000
@NM00030 EQU   ERTYPE                                                   10408000
EROSCAT  EQU   ERTYPE                                                   10409000
ERCATLG  EQU   ERTYPE                                                   10410000
@NM00029 EQU   FMTCNVF+1                                                10411000
FMTAR    EQU   FMTCNVF+1                                                10412000
FMTBS    EQU   FMTCNVF+1                                                10413000
FMTSS    EQU   FMTCNVF+1                                                10414000
FMTAL    EQU   FMTCNVF+1                                                10415000
FMTZS    EQU   FMTCNVF+1                                                10416000
@NM00028 EQU   FMTCNVF                                                  10417000
FMTPU    EQU   FMTCNVF                                                  10418000
FMTBD    EQU   FMTCNVF                                                  10419000
FMTBHD   EQU   FMTCNVF                                                  10420000
FMTBHA   EQU   FMTCNVF                                                  10421000
FMTBH    EQU   FMTCNVF                                                  10422000
FMTOLEN  EQU   FMTLIST+8                                                10423000
FMTRIO   EQU   FMTOCOL                                                  10424000
FMTSPT   EQU   FMTSTO                                                   10425000
FMTSTL   EQU   FMTILEN                                                  10426000
@NM00027 EQU   FMTFLGS+1                                                10427000
FMTHDF   EQU   FMTFLGS                                                  10428000
FMTDFF   EQU   FMTFLGS                                                  10429000
FMTSTF   EQU   FMTFLGS                                                  10430000
FMTREPF  EQU   FMTFLGS                                                  10431000
FMTBDF   EQU   FMTFLGS                                                  10432000
FMTIDF   EQU   FMTFLGS                                                  10433000
FMTSCF   EQU   FMTFLGS                                                  10434000
FMTEOLF  EQU   FMTFLGS                                                  10435000
DARGPCT  EQU   DARGINL                                                  10436000
DARGREP  EQU   DARGINS                                                  10437000
@NM00026 EQU   DARGLIST+19                                              10438000
DARGIND  EQU   DARGLIST+18                                              10439000
UVOLVOL  EQU   UVOLENT+4                                                10440000
UVOLDEV  EQU   UVOLENT                                                  10441000
UVOLCNT  EQU   UVOLLIST                                                 10442000
@NM00025 EQU   IOINFOPT                                                 10443000
IOINFTMS EQU   IOINFOPT                                                 10444000
IOINFSUP EQU   IOINFOPT                                                 10445000
IOINFDSN EQU   IOINFOPT                                                 10446000
IOINFVOL EQU   IOINFOPT                                                 10447000
IOINFDVT EQU   IOINFOPT                                                 10448000
OPNVOL   EQU   OPNAGL+44                                                10449000
@NM00024 EQU   OPNAGL+43                                                10450000
@NM00023 EQU   OPNOPT2                                                  10451000
OPNOPTJM EQU   OPNOPT2                                                  10452000
@NM00022 EQU   OPNOPT2                                                  10453000
OPNOPTAS EQU   OPNOPT2                                                  10454000
@NM00021 EQU   OPNDSO                                                   10455000
OPNDSOPO EQU   OPNDSO                                                   10456000
OPNDSOIS EQU   OPNDSO                                                   10457000
OPNDSOPS EQU   OPNDSO                                                   10458000
OPNDSOAM EQU   OPNDSO                                                   10459000
OPNKYL   EQU   OPNAGL+40                                                10460000
OPNBLK   EQU   OPNAGL+36                                                10461000
OPNREC   EQU   OPNAGL+32                                                10462000
OPNDEVIX EQU   OPNDEV+4                                                 10463000
OPNDEVDT EQU   OPNDEV                                                   10464000
OPNCBP   EQU   OPNAGL+20                                                10465000
OPNDSN   EQU   OPNAGL+16                                                10466000
OPNPWA   EQU   OPNAGL+12                                                10467000
OPNDDN   EQU   OPNAGL+8                                                 10468000
OPNIOC   EQU   OPNAGL+4                                                 10469000
OPNMODRP EQU   OPNMOD                                                   10470000
OPNMODUB EQU   OPNMOD                                                   10471000
OPNMODRS EQU   OPNMOD                                                   10472000
OPNMODAX EQU   OPNMOD                                                   10473000
OPNMODRR EQU   OPNMOD                                                   10474000
OPNMODRC EQU   OPNMOD                                                   10475000
OPNMODAC EQU   OPNMOD                                                   10476000
OPNMODPD EQU   OPNMOD                                                   10477000
@NM00020 EQU   OPNTYP                                                   10478000
OPNTYPRV EQU   OPNTYP                                                   10479000
OPNTYPEX EQU   OPNTYP                                                   10480000
OPNTYPRA EQU   OPNTYP                                                   10481000
OPNTYPXM EQU   OPNTYP                                                   10482000
OPNTYPCI EQU   OPNTYP                                                   10483000
OPNTYPSO EQU   OPNTYP                                                   10484000
OPNTYPSI EQU   OPNTYP                                                   10485000
@NM00019 EQU   OPNRFM                                                   10486000
OPNRFMBK EQU   OPNRFM                                                   10487000
OPNRFMSF EQU   OPNRFM                                                   10488000
OPNRFMUN EQU   OPNRFM                                                   10489000
OPNRFMVR EQU   OPNRFM                                                   10490000
OPNRFMFX EQU   OPNRFM                                                   10491000
OPNOPTSK EQU   OPNOPT                                                   10492000
OPNOPTDR EQU   OPNOPT                                                   10493000
OPNOPTCR EQU   OPNOPT                                                   10494000
OPNOPTKS EQU   OPNOPT                                                   10495000
OPNOPTBK EQU   OPNOPT                                                   10496000
OPNOPTUP EQU   OPNOPT                                                   10497000
OPNOPTOT EQU   OPNOPT                                                   10498000
OPNOPTIN EQU   OPNOPT                                                   10499000
IOCEXT   EQU   IOCSTR+64                                                10500000
IOCREL   EQU   IOCSTR+60                                                10501000
IOCWORK  EQU   IOCSTR+56                                                10502000
IOCRRN   EQU   IOCSTR+52                                                10503000
IOCPNM   EQU   IOCNWM+2                                                 10504000
IOCPTL   EQU   IOCNWM                                                   10505000
IOCKYA   EQU   IOCMEM                                                   10506000
IOCVRC   EQU   IOCTTR                                                   10507000
IOCCBP   EQU   IOCSTR+36                                                10508000
IOCDSN   EQU   IOCSTR+32                                                10509000
IOCHURBA EQU   IOCSTR+28                                                10510000
IOCVOLSR EQU   IOCSTR+22                                                10511000
@NM00018 EQU   IOCMSG                                                   10512000
IOCMSGAE EQU   IOCMSG                                                   10513000
IOCMSGCE EQU   IOCMSG                                                   10514000
IOCMSGOE EQU   IOCMSG                                                   10515000
IOCMSGOP EQU   IOCMSG                                                   10516000
@NM00017 EQU   IOCMSG                                                   10517000
IOCCHPSY EQU   IOCCHP                                                   10518000
IOCCHPAS EQU   IOCCHP                                                   10519000
IOCCHPBK EQU   IOCCHP                                                   10520000
IOCCHPCR EQU   IOCCHP                                                   10521000
IOCCHPKS EQU   IOCCHP                                                   10522000
IOCCHPSK EQU   IOCCHP                                                   10523000
IOCCHPDR EQU   IOCCHP                                                   10524000
IOCCHPSQ EQU   IOCCHP                                                   10525000
@NM00016 EQU   IOCMAC2                                                  10526000
IOCMACPA EQU   IOCMAC2                                                  10527000
@NM00015 EQU   IOCMAC2                                                  10528000
IOCMACCP EQU   IOCMAC2                                                  10529000
IOCMACRR EQU   IOCMAC2                                                  10530000
IOCMACAS EQU   IOCMAC2                                                  10531000
IOCMACSK EQU   IOCMAC2                                                  10532000
@NM00014 EQU   IOCMAC                                                   10533000
IOCMACCC EQU   IOCMAC                                                   10534000
IOCMACDR EQU   IOCMAC                                                   10535000
IOCMACBK EQU   IOCMAC                                                   10536000
IOCMACCR EQU   IOCMAC                                                   10537000
IOCMACUP EQU   IOCMAC                                                   10538000
IOCMACOT EQU   IOCMAC                                                   10539000
IOCMACIN EQU   IOCMAC                                                   10540000
@NM00013 EQU   IOCRFM                                                   10541000
IOCRFMBK EQU   IOCRFM                                                   10542000
IOCRFMSF EQU   IOCRFM                                                   10543000
IOCRFMUN EQU   IOCRFM                                                   10544000
IOCRFMVR EQU   IOCRFM                                                   10545000
IOCRFMFX EQU   IOCRFM                                                   10546000
@NM00012 EQU   IOCDSO                                                   10547000
IOCDSOPO EQU   IOCDSO                                                   10548000
IOCDSOIS EQU   IOCDSO                                                   10549000
IOCDSOPS EQU   IOCDSO                                                   10550000
IOCDSOAM EQU   IOCDSO                                                   10551000
IOCRKP   EQU   IOCSTR+13                                                10552000
IOCKYL   EQU   IOCSTR+12                                                10553000
IOCTRN   EQU   IOCSTR+8                                                 10554000
IOCDLN   EQU   IOCSTR+4                                                 10555000
IOCDAD   EQU   IOCSTR                                                   10556000
UNITVTOC EQU   UNITABL+7                                                10557000
@NM00011 EQU   UNITSTAT                                                 10558000
UNITUSHR EQU   UNITSTAT                                                 10559000
UNITXSHR EQU   UNITSTAT                                                 10560000
UNITISHR EQU   UNITSTAT                                                 10561000
UNITUA   EQU   @NM00010+1                                               10562000
UNITCHA  EQU   @NM00010                                                 10563000
UNITUCB  EQU   UNITABL                                                  10564000
@NM00009 EQU   ALLOPT                                                   10565000
ALLOPTUN EQU   ALLOPT                                                   10566000
ALLOPTDS EQU   ALLOPT                                                   10567000
@NM00008 EQU   ALLORG+1                                                 10568000
ALLORGVS EQU   ALLORG+1                                                 10569000
@NM00007 EQU   ALLORG+1                                                 10570000
ALLORGGS EQU   ALLORG+1                                                 10571000
ALLORGUN EQU   ALLORG                                                   10572000
ALLORGPO EQU   ALLORG                                                   10573000
ALLORGMQ EQU   ALLORG                                                   10574000
ALLORGCQ EQU   ALLORG                                                   10575000
ALLORGCX EQU   ALLORG                                                   10576000
ALLORGDA EQU   ALLORG                                                   10577000
ALLORGPS EQU   ALLORG                                                   10578000
ALLORGIS EQU   ALLORG                                                   10579000
ALLDSPUN EQU   ALLDSP                                                   10580000
ALLDSPCG EQU   ALLDSP                                                   10581000
ALLDSPDE EQU   ALLDSP                                                   10582000
ALLDSPKP EQU   ALLDSP                                                   10583000
@NM00006 EQU   ALLDSP                                                   10584000
ALLSTSOD EQU   ALLSTS                                                   10585000
ALLSTSMD EQU   ALLSTS                                                   10586000
ALLSTSNW EQU   ALLSTS                                                   10587000
ALLSTSSR EQU   ALLSTS                                                   10588000
@NM00005 EQU   ALLSTS                                                   10589000
ALLPWD   EQU   ALLAGL+20                                                10590000
ALLDSN   EQU   ALLAGL                                                   10591000
CIRPID   EQU   CIRAGL+28                                                10592000
CIRPWD   EQU   CIRAGL+24                                                10593000
CIRCAT   EQU   CIRAGL+20                                                10594000
CIRWKP   EQU   CIRAGL+16                                                10595000
CIRTLR   EQU   CIRAGL+12                                                10596000
CIRHDR   EQU   CIRAGL+8                                                 10597000
CIRTLN   EQU   CIRAGL+6                                                 10598000
CIRHLN   EQU   CIRAGL+4                                                 10599000
@NM00004 EQU   CIRAGL+1                                                 10600000
@NM00003 EQU   CIRTYPE                                                  10601000
CIRTYPAQ EQU   CIRTYPE                                                  10602000
CIRTYP1Q EQU   CIRTYPE                                                  10603000
NEWID1   EQU   TRACE1+95                                                10604000
CALLID   EQU   OLDERID1+90                                              10605000
@NM00002 EQU   OLDERID1                                                 10606000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      10607000
@RC00454 EQU   @RC00453                                                 10608000
@RF00544 EQU   @RC00500                                                 10609000
@RC00576 EQU   @RC00575                                                 10610000
@RF01542 EQU   @RC01527                                                 10611000
@RF01662 EQU   @RC01634                                                 10612000
@PB00018 EQU   @EL00001                                                 10613000
@RC00456 EQU   @RC00454                                                 10614000
@RF00611 EQU   @RC00576                                                 10615000
@PB00017 EQU   @PB00018                                                 10616000
@RF00474 EQU   @RC00456                                                 10617000
@PB00016 EQU   @PB00017                                                 10618000
@PB00015 EQU   @PB00016                                                 10619000
@PB00014 EQU   @PB00015                                                 10620000
@PB00013 EQU   @PB00014                                                 10621000
@PB00012 EQU   @PB00013                                                 10622000
@PB00011 EQU   @PB00012                                                 10623000
@PB00010 EQU   @PB00011                                                 10624000
@PB00009 EQU   @PB00010                                                 10625000
@PB00008 EQU   @PB00009                                                 10626000
@PB00007 EQU   @PB00008                                                 10627000
@PB00006 EQU   @PB00007                                                 10628000
@PB00005 EQU   @PB00006                                                 10629000
@PB00004 EQU   @PB00005                                                 10630000
@PB00003 EQU   @PB00004                                                 10631000
@PB00002 EQU   @PB00003                                                 10632000
@ENDDATA EQU   *                                                        10633000
         END   IDCCO01,(C'PLS1721',0603,76339)                          10634000
