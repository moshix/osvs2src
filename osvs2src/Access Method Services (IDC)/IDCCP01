         TITLE '**************** IDCCP01: COMPARET FSR *****************00001000
               *        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCP01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCP01   76.301'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @10,0                                               0002 00021000
@PSTART  LA    @12,4095(,@10)                                      0002 00022000
         USING @PSTART,@10                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                                                  0279 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* THIS IS THE MAIN ROUTINE FOR THE COMPARET FSR ROUTINE. SET AND*/ 00037000
*   /* PRINTS THE FINAL COMPLETION MESSAGE BEFORE RETURNING TO THE   */ 00038000
*   /* AMS EXECUTIVE                                         @Z40LB65*/ 00039000
*   /*                                                               */ 00040000
*   /*****************************************************************/ 00041000
*                                                                  0279 00042000
*   IF GDTDBG=NULLPTR THEN                                         0279 00043000
         L     @08,@PC00001                                        0279 00044000
         L     @08,GDTDBG(,@08)                                    0279 00045000
         LTR   @08,@08                                             0279 00046000
         BZ    @RT00279                                            0279 00047000
*     ;                                                            0280 00048000
*   ELSE                                                           0281 00049000
*     CALL IDCDB010(GDTTBL,'CPAA'); /*                       @Z40LB65*/ 00050000
         L     @08,@PC00001                                        0281 00051000
         ST    @08,@AL00001                                        0281 00052000
         LA    @15,@CC01284                                        0281 00053000
         ST    @15,@AL00001+4                                      0281 00054000
         MVI   @AL00001+4,X'80'                                    0281 00055000
         L     @15,GDTDBG(,@08)                                    0281 00056000
         LA    @01,@AL00001                                        0281 00057000
         BALR  @14,@15                                             0281 00058000
*   OLDERID2=NEWERID2;                                             0282 00059000
@RT00279 L     @02,@PC00001                                        0282 00060000
         L     @15,GDTTR2(,@02)                                    0282 00061000
         MVC   @TS00001(95),NEWERID2(@15)                          0282 00062000
         MVC   OLDERID2(95,@15),@TS00001                           0282 00063000
*   NEWID2='CPAA';                  /*                       @Z40LB65*/ 00064000
*                                                                  0283 00065000
         MVC   NEWID2(4,@15),@CC01284                              0283 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* INITIALIZE PARAMETER LISTS AND POINTERS FOR THE       @Z40LB65*/ 00069000
*   /* UPRINT, OPEN UEXCP, UALLOC, ACQUIRE USSC, COPYTABL    @Z40LB65*/ 00070000
*   /* USSC, AND GET UEXCP MACROS.                           @Z40LB65*/ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                                  0284 00074000
*   RESPECIFY                                                      0284 00075000
*     CKAGL BASED(CKPTR);           /*                       @Z40LB65*/ 00076000
*   DDSTRU=ADDR(PRINTAB);           /*                       @Z40LB65*/ 00077000
         LA    @15,PRINTAB                                         0285 00078000
         ST    @15,DDSTRU                                          0285 00079000
*   PRINTAB=''B;                    /*                       @Z40LB65*/ 00080000
         XC    PRINTAB(20),PRINTAB                                 0286 00081000
*   DARGSMOD=CP0MSG;                /*                       @Z40LB65*/ 00082000
         MVC   DARGSMOD(3,@15),@CC01281                            0287 00083000
*   INTTBL=''B;                     /*                       @Z40LB65*/ 00084000
         XC    INTTBL(61),INTTBL                                   0288 00085000
*   EXOPTR=ADDR(EXOLIST);           /*                       @Z40LB65*/ 00086000
         LA    EXOPTR,EXOLIST                                      0289 00087000
*   RESPECIFY                                                      0290 00088000
*     EXOARG BASED(EXOPTR);         /*                       @Z40LB65*/ 00089000
*   EXOARG=''B;                     /*                       @Z40LB65*/ 00090000
         XC    EXOARG(34,EXOPTR),EXOARG(EXOPTR)                    0291 00091000
*   ALL1PTR=ADDR(ALL1LIST);         /*                       @Z40LB65*/ 00092000
         LA    ALL1PTR,ALL1LIST                                    0292 00093000
*   ALL2PTR=ADDR(ALL2LIST);         /*                       @Z40LB65*/ 00094000
         LA    ALL2PTR,ALL2LIST                                    0293 00095000
*   ALL1LIST=''B;                   /*                       @Z40LB65*/ 00096000
         XC    ALL1LIST(31),ALL1LIST                               0294 00097000
*   ALL2LIST=''B;                   /*                       @Z40LB65*/ 00098000
         XC    ALL2LIST(31),ALL2LIST                               0295 00099000
*   CKPTR=ADDR(UCBLIST);            /*                       @Z40LB65*/ 00100000
         LA    CKPTR,UCBLIST                                       0296 00101000
*   CKAGL=''B;                      /*                       @Z40LB65*/ 00102000
         XC    CKAGL(29,CKPTR),CKAGL(CKPTR)                        0297 00103000
*   ACQPTR=ADDR(ACQLST2);           /*                       @Z40LB65*/ 00104000
         LA    @15,ACQLST2                                         0298 00105000
         ST    @15,ACQPTR                                          0298 00106000
*   ACQLST1=''B;                    /*                       @Z40LB65*/ 00107000
         XC    ACQLST1(96),ACQLST1                                 0299 00108000
*   ACQLST2=''B;                    /*                       @Z40LB65*/ 00109000
         XC    ACQLST2(96),ACQLST2                                 0300 00110000
*   COTPTR=ADDR(COTBLIST);          /*                       @Z40LB65*/ 00111000
         LA    @15,COTBLIST                                        0301 00112000
         ST    @15,COTPTR                                          0301 00113000
*   COTBLIST=''B;                   /*                       @Z40LB65*/ 00114000
         XC    COTBLIST(24),COTBLIST                               0302 00115000
*   RESPECIFY                                                      0303 00116000
*     EXGARG BASED(EXGPTR);         /*                       @Z40LB65*/ 00117000
*   EXGPTR=ADDR(EXGALIST);          /*                       @Z40LB65*/ 00118000
         LA    EXGPTR,EXGALIST                                     0304 00119000
*   EXGARG=''B;                     /*                       @Z40LB65*/ 00120000
         XC    EXGARG(32,EXGPTR),EXGARG(EXGPTR)                    0305 00121000
*   NULLDDN=''B;                    /*                       @Z40LB65*/ 00122000
         XC    NULLDDN(8),NULLDDN                                  0306 00123000
*   WORKPTR1=0;                     /*                       @Z40LB65*/ 00124000
         SLR   @15,@15                                             0307 00125000
         ST    @15,WORKPTR1                                        0307 00126000
*   WORKPTR2=0;                     /*                       @Z40LB65*/ 00127000
*                                                                  0308 00128000
         ST    @15,WORKPTR2                                        0308 00129000
*   /*****************************************************************/ 00130000
*   /*                                                               */ 00131000
*   /* OBTAIN SPACE FOR TWO TRACK BUFFERS (8448 BYTES EACH)  @Z40LB65*/ 00132000
*   /* AND THE OUTPUT BUFFER (792 BYTES)                     @Z40LB65*/ 00133000
*   /*                                                               */ 00134000
*   /*****************************************************************/ 00135000
*                                                                  0309 00136000
*   CALL IDCSAGS0(GDTTBL,CORESIZE,TRKPTR1);/*                @Z40LB65*/ 00137000
         ST    @02,@AL00001                                        0309 00138000
         LA    @15,@CF01177                                        0309 00139000
         ST    @15,@AL00001+4                                      0309 00140000
         LA    @15,TRKPTR1                                         0309 00141000
         ST    @15,@AL00001+8                                      0309 00142000
         MVI   @AL00001+8,X'80'                                    0309 00143000
         L     @15,GDTGSP(,@02)                                    0309 00144000
         LA    @01,@AL00001                                        0309 00145000
         BALR  @14,@15                                             0309 00146000
*   RESPECIFY                                                      0310 00147000
*     RTNREG RSTD;                                                 0310 00148000
*   TESTRC=RTNREG;                                                 0311 00149000
         LR    TESTRC,RTNREG                                       0311 00150000
*   RESPECIFY                                                      0312 00151000
*     RTNREG UNRSTD;                /*                       @Z40LB65*/ 00152000
*   IF TESTRC^=LASTCC00 THEN                                       0313 00153000
         LTR   TESTRC,TESTRC                                       0313 00154000
         BZ    @RF00313                                            0313 00155000
*     LASTCOND=LASTCC08;            /*                       @Z40LB65*/ 00156000
         L     @06,@PC00001+8                                      0314 00157000
         MVC   LASTCOND(2,@06),@CH00178                            0314 00158000
*   ELSE                                                           0315 00159000
*     DO;                           /*                       @Z40LB65*/ 00160000
         B     @RC00313                                            0315 00161000
@RF00313 DS    0H                                                  0316 00162000
*       TRKPTR2=TRKPTR1+TRKSIZE;    /*                       @Z40LB65*/ 00163000
         L     @15,@CF01179                                        0316 00164000
         L     @14,TRKPTR1                                         0316 00165000
         ALR   @14,@15                                             0316 00166000
         ST    @14,TRKPTR2                                         0316 00167000
*       OUTPTR=TRKPTR2+TRKSIZE;     /*                       @Z40LB65*/ 00168000
*                                                                  0317 00169000
         ALR   @14,@15                                             0317 00170000
         LR    OUTPTR,@14                                          0317 00171000
*       /*************************************************************/ 00172000
*       /*                                                           */ 00173000
*       /* CALL OPENPROC TO ALLOCATE AND OPEN WORK DATA SETS,        */ 00174000
*       /*                                                   @Z40LB65*/ 00175000
*       /* AND TO INSURE THAT THEY ARE MASS STORAGE VOLUMES  @Z40LB65*/ 00176000
*       /*                                                           */ 00177000
*       /*************************************************************/ 00178000
*                                                                  0318 00179000
*       CALL OPENPROC;              /*                       @Z40LB65*/ 00180000
         BAL   @14,OPENPROC                                        0318 00181000
*       RESPECIFY                                                  0319 00182000
*         RTNREG RSTD;                                             0319 00183000
*       TESTRC=RTNREG;                                             0320 00184000
         LR    TESTRC,RTNREG                                       0320 00185000
*       RESPECIFY                                                  0321 00186000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00187000
*       IF TESTRC=LASTCC12 THEN                                    0322 00188000
         LA    @06,12                                              0322 00189000
         CR    TESTRC,@06                                          0322 00190000
         BNE   @RF00322                                            0322 00191000
*         LASTCOND=LASTCC12;        /*                       @Z40LB65*/ 00192000
         L     @05,@PC00001+8                                      0323 00193000
         STH   @06,LASTCOND(,@05)                                  0323 00194000
*     END;                          /*                       @Z40LB65*/ 00195000
*                                                                  0324 00196000
@RF00322 DS    0H                                                  0325 00197000
*   /*****************************************************************/ 00198000
*   /*                                                               */ 00199000
*   /* IF SUCCESSFUL, CALL COPYPROC TO COPY BOTH MSC TABLES  @Z40LB65*/ 00200000
*   /*                                                               */ 00201000
*   /*****************************************************************/ 00202000
*                                                                  0325 00203000
*   IF LASTCOND=LASTCC00 THEN                                      0325 00204000
@RC00313 L     @06,@PC00001+8                                      0325 00205000
         LH    @06,LASTCOND(,@06)                                  0325 00206000
         LTR   @06,@06                                             0325 00207000
         BNZ   @RF00325                                            0325 00208000
*     DO;                           /*                       @Z40LB65*/ 00209000
*       CALL COPYPROC;              /*                       @Z40LB65*/ 00210000
         BAL   @14,COPYPROC                                        0327 00211000
*       RESPECIFY                                                  0328 00212000
*         RTNREG RSTD;                                             0328 00213000
*       TESTRC=RTNREG;                                             0329 00214000
         LR    TESTRC,RTNREG                                       0329 00215000
*       RESPECIFY                                                  0330 00216000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00217000
*       IF TESTRC=LASTCC12 THEN                                    0331 00218000
         LA    @06,12                                              0331 00219000
         CR    TESTRC,@06                                          0331 00220000
         BNE   @RF00331                                            0331 00221000
*         LASTCOND=LASTCC12;        /*                       @Z40LB65*/ 00222000
         L     @05,@PC00001+8                                      0332 00223000
         STH   @06,LASTCOND(,@05)                                  0332 00224000
*     END;                          /*                       @Z40LB65*/ 00225000
*                                                                  0333 00226000
@RF00331 DS    0H                                                  0334 00227000
*   /*****************************************************************/ 00228000
*   /*                                                               */ 00229000
*   /* IF SUCCESSFUL, CALL COMPPROC TO COMPARE THE TABLES    @Z40LB65*/ 00230000
*   /*                                                               */ 00231000
*   /*****************************************************************/ 00232000
*                                                                  0334 00233000
*   IF LASTCOND=LASTCC00 THEN                                      0334 00234000
@RF00325 L     @06,@PC00001+8                                      0334 00235000
         LH    @06,LASTCOND(,@06)                                  0334 00236000
         LTR   @06,@06                                             0334 00237000
         BNZ   @RF00334                                            0334 00238000
*     DO;                           /*                       @Z40LB65*/ 00239000
*       CALL COMPPROC;              /*                       @Z40LB65*/ 00240000
         BAL   @14,COMPPROC                                        0336 00241000
*       RESPECIFY                                                  0337 00242000
*         RTNREG RSTD;                                             0337 00243000
*       TESTRC=RTNREG;                                             0338 00244000
         LR    TESTRC,RTNREG                                       0338 00245000
*       RESPECIFY                                                  0339 00246000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00247000
*       LASTCOND=TESTRC;            /*                       @Z40LB65*/ 00248000
         L     @09,@PC00001+8                                      0340 00249000
         STH   TESTRC,LASTCOND(,@09)                               0340 00250000
*     END;                          /*                       @Z40LB65*/ 00251000
*                                                                  0341 00252000
*   /*****************************************************************/ 00253000
*   /*                                                               */ 00254000
*   /* FREE THE SPACE FOR THE TRACK BUFFERS                  @Z40LB65*/ 00255000
*   /*                                                               */ 00256000
*   /*****************************************************************/ 00257000
*                                                                  0342 00258000
*   CALL IDCSAFS0(GDTTBL,TRKPTR1);  /*                       @Z40LB65*/ 00259000
*                                                                  0342 00260000
@RF00334 L     @09,@PC00001                                        0342 00261000
         ST    @09,@AL00001                                        0342 00262000
         LA    @06,TRKPTR1                                         0342 00263000
         ST    @06,@AL00001+4                                      0342 00264000
         L     @15,GDTFSP(,@09)                                    0342 00265000
         LA    @01,@AL00001                                        0342 00266000
         BALR  @14,@15                                             0342 00267000
*   /*****************************************************************/ 00268000
*   /*                                                               */ 00269000
*   /* IF ACQSW2 = ON SET UP THE SECOND ACQUIRE LIST IN ORDER TO     */ 00270000
*   /* RELINQUISH THE DATA SET SPACE. SPECIFY THE UNBIND OPTION.     */ 00271000
*   /*                                                       @ZA14727*/ 00272000
*   /*                                                               */ 00273000
*   /*****************************************************************/ 00274000
*                                                                  0343 00275000
*   IF ACQSW2=ON THEN                                              0343 00276000
         TM    ACQSW2,B'00001000'                                  0343 00277000
         BNO   @RF00343                                            0343 00278000
*     DO;                           /*                       @ZA14727*/ 00279000
*       ACQLST2=ACQLST2&&ACQLST2;   /*                       @ZA14727*/ 00280000
         XC    ACQLST2(96),ACQLST2                                 0345 00281000
*       ACQPTR=ADDR(ACQLST2);       /*                       @ZA14727*/ 00282000
         LA    @09,ACQLST2                                         0346 00283000
         ST    @09,ACQPTR                                          0346 00284000
*       ARLL=LENGTH(ACQLST2);       /*                       @ZA14727*/ 00285000
         MVC   ARLL(4,@09),@CF01205                                0347 00286000
*       AROP=4;                     /*                       @ZA14727*/ 00287000
         MVI   AROP(@09),X'04'                                     0348 00288000
*       ARBDUBD=ON;                 /*                       @ZA14727*/ 00289000
         OI    ARBDUBD(@09),B'10000000'                            0349 00290000
*       ARNMEXT=1;                  /*                       @ZA14727*/ 00291000
         MVI   ARNMEXT(@09),X'01'                                  0350 00292000
*       ARVOL=WORKVOL2;             /*                       @ZA14727*/ 00293000
         MVC   ARVOL(6,@09),WORKVOL2                               0351 00294000
*       AREXT(1,1:2)=SCYL2;         /*                       @ZA14727*/ 00295000
         MVC   AREXT(2,@09),SCYL2                                  0352 00296000
*       AREXT(1,3:4)=ECYL2;         /*                       @ZA14727*/ 00297000
         MVC   AREXT+2(2,@09),ECYL2                                0353 00298000
*     END;                          /*                       @ZA14727*/ 00299000
*                                                                  0354 00300000
*   /*****************************************************************/ 00301000
*   /*                                                               */ 00302000
*   /* IF ACQSW1 = ON SET UP THE FIRST ACQUIRE LIST IN ORDER TO      */ 00303000
*   /* RELINQUISH THE DATA SET SPACE. SPECIFY THE UNBIND OPTION.     */ 00304000
*   /*                                                       @ZA14727*/ 00305000
*   /*                                                               */ 00306000
*   /*****************************************************************/ 00307000
*                                                                  0355 00308000
*   IF ACQSW1=ON THEN                                              0355 00309000
@RF00343 TM    ACQSW1,B'00010000'                                  0355 00310000
         BNO   @RF00355                                            0355 00311000
*     DO;                           /*                       @ZA14727*/ 00312000
*       ACQLST1=ACQLST1&&ACQLST1;   /*                       @ZA14727*/ 00313000
         XC    ACQLST1(96),ACQLST1                                 0357 00314000
*       ACQPTR=ADDR(ACQLST1);       /*                       @ZA14727*/ 00315000
         LA    @09,ACQLST1                                         0358 00316000
         ST    @09,ACQPTR                                          0358 00317000
*       ARLL=LENGTH(ACQLST1);       /*                       @ZA14727*/ 00318000
         MVC   ARLL(4,@09),@CF01205                                0359 00319000
*       AROP=4;                     /*                       @ZA14727*/ 00320000
         MVI   AROP(@09),X'04'                                     0360 00321000
*       ARBDUBD=ON;                 /*                       @ZA14727*/ 00322000
         OI    ARBDUBD(@09),B'10000000'                            0361 00323000
*       ARNMEXT=1;                  /*                       @ZA14727*/ 00324000
         MVI   ARNMEXT(@09),X'01'                                  0362 00325000
*       ARVOL=WORKVOL1;             /*                       @ZA14727*/ 00326000
         MVC   ARVOL(6,@09),WORKVOL1                               0363 00327000
*       AREXT(1,1:2)=SCYL1;         /*                       @ZA14727*/ 00328000
         MVC   AREXT(2,@09),SCYL1                                  0364 00329000
*       AREXT(1,3:4)=ECYL1;         /*                       @ZA14727*/ 00330000
*                                                                  0365 00331000
         MVC   AREXT+2(2,@09),ECYL1                                0365 00332000
*       /*************************************************************/ 00333000
*       /*                                                           */ 00334000
*       /* IF BOTH SWITCHES ARE ON, CHAIN THE SECOND RELINQUISH TO   */ 00335000
*       /* THE FIRST.                                        @ZA14727*/ 00336000
*       /*                                                           */ 00337000
*       /*************************************************************/ 00338000
*                                                                  0366 00339000
*       IF ACQSW2=ON THEN           /*                       @ZA14727*/ 00340000
         TM    ACQSW2,B'00001000'                                  0366 00341000
         BNO   @RF00366                                            0366 00342000
*         ARNEDB=ADDR(ACQLST2);     /*                       @ZA14727*/ 00343000
         LA    @06,ACQLST2                                         0367 00344000
         ST    @06,ARNEDB(,@09)                                    0367 00345000
*     END;                          /*                       @ZA14727*/ 00346000
@RF00366 DS    0H                                                  0369 00347000
*/*   IF EITHER ACQUIRE SWITCH IS ON THEN WE WANT TO SET THE         */ 00348000
*/*   SWITCHES OFF AND ISSUE USSC TO RELINQUISH THE SPACE.   @ZA14727*/ 00349000
*                                                                  0369 00350000
*   IF ACQSW1=ON|ACQSW2=ON THEN     /*                       @ZA14727*/ 00351000
@RF00355 TM    ACQSW1,B'00011000'                                  0369 00352000
         BZ    @RF00369                                            0369 00353000
*     DO;                           /*                       @ZA14727*/ 00354000
*       ACQSW1=OFF;                 /*                       @ZA14727*/ 00355000
*       ACQSW2=OFF;                 /*                       @ZA14727*/ 00356000
         NI    ACQSW1,B'11100111'                                  0372 00357000
*       CALL IDCSASS0(GDTTBL,RELINQ,ACQPTR,REASONCD);/*      @ZA14727*/ 00358000
         L     @09,@PC00001                                        0373 00359000
         ST    @09,@AL00001                                        0373 00360000
         LA    @06,RELINQ                                          0373 00361000
         ST    @06,@AL00001+4                                      0373 00362000
         LA    @06,ACQPTR                                          0373 00363000
         ST    @06,@AL00001+8                                      0373 00364000
         LA    @06,REASONCD                                        0373 00365000
         ST    @06,@AL00001+12                                     0373 00366000
         MVI   @AL00001+12,X'80'                                   0373 00367000
         L     @15,GDTSSC(,@09)                                    0373 00368000
         LA    @01,@AL00001                                        0373 00369000
         BALR  @14,@15                                             0373 00370000
*       RESPECIFY                                                  0374 00371000
*         RTNREG RSTD;                                             0374 00372000
*       TESTRC=RTNREG;                                             0375 00373000
         LR    TESTRC,RTNREG                                       0375 00374000
*       RESPECIFY                                                  0376 00375000
*         RTNREG UNRSTD;            /*                       @ZA14727*/ 00376000
*       IF TESTRC^=0 THEN           /*                       @ZA14727*/ 00377000
         LTR   TESTRC,TESTRC                                       0377 00378000
         BZ    @RF00377                                            0377 00379000
*         DO;                       /*                       @ZA14727*/ 00380000
*                                                                  0378 00381000
*           /*********************************************************/ 00382000
*           /*                                                       */ 00383000
*           /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE     @ZA14727*/ 00384000
*           /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.       */ 00385000
*           /*                                               @ZA14727*/ 00386000
*           /*                                                       */ 00387000
*           /*********************************************************/ 00388000
*                                                                  0379 00389000
*           CALL SSCMSG(REASONCD);  /*                       @ZA14727*/ 00390000
         LA    @09,REASONCD                                        0379 00391000
         ST    @09,@AL00001                                        0379 00392000
         LA    @01,@AL00001                                        0379 00393000
         BAL   @14,SSCMSG                                          0379 00394000
*           LASTCOND=LASTCC04;      /*                       @ZA14727*/ 00395000
         L     @09,@PC00001+8                                      0380 00396000
         MVC   LASTCOND(2,@09),@CH00041                            0380 00397000
*         END;                      /*                       @ZA14727*/ 00398000
*     END;                          /*                       @ZA14727*/ 00399000
*                                                                  0382 00400000
@RF00377 DS    0H                                                  0383 00401000
*   /*****************************************************************/ 00402000
*   /*                                                               */ 00403000
*   /* IF WORKPTR1 IS ^= 0 THEN THE WORKDATASET1 WAS OPENED  @Z40LB65*/ 00404000
*   /* AND MUST BE CLOSED AND POSSIBLY DEALLOCATED.          @Z40LB65*/ 00405000
*   /*                                                               */ 00406000
*   /*****************************************************************/ 00407000
*                                                                  0383 00408000
*   IF WORKPTR1^=NULLPTR THEN                                      0383 00409000
@RF00369 L     @09,WORKPTR1                                        0383 00410000
         LTR   @09,@09                                             0383 00411000
         BZ    @RF00383                                            0383 00412000
*     DO;                           /*                       @Z40LB65*/ 00413000
*       CALL IDCIO050(GDTTBL,CLOSE,WORKPTR1);/*              @Z40LB65*/ 00414000
         L     @09,@PC00001                                        0385 00415000
         ST    @09,@AL00001                                        0385 00416000
         LA    @06,CLOSE                                           0385 00417000
         ST    @06,@AL00001+4                                      0385 00418000
         LA    @06,WORKPTR1                                        0385 00419000
         ST    @06,@AL00001+8                                      0385 00420000
         MVI   @AL00001+8,X'80'                                    0385 00421000
         L     @15,GDTEXP(,@09)                                    0385 00422000
         LA    @01,@AL00001                                        0385 00423000
         BALR  @14,@15                                             0385 00424000
*       RESPECIFY                                                  0386 00425000
*         RTNREG RSTD;                                             0386 00426000
*       TESTRC=RTNREG;                                             0387 00427000
         LR    TESTRC,RTNREG                                       0387 00428000
*       RESPECIFY                                                  0388 00429000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00430000
*       IF TESTRC^=0 THEN                                          0389 00431000
         LTR   TESTRC,TESTRC                                       0389 00432000
         BZ    @RF00389                                            0389 00433000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/ 00434000
         L     @09,@PC00001+8                                      0390 00435000
         LH    @06,LASTCOND(,@09)                                  0390 00436000
         LA    @15,4                                               0390 00437000
         CR    @06,@15                                             0390 00438000
         BNL   *+6                                                      00439000
         LR    @06,@15                                             0390 00440000
         STH   @06,LASTCOND(,@09)                                  0390 00441000
*     END;                          /*                       @Z40LB65*/ 00442000
@RF00389 DS    0H                                                  0392 00443000
*   IF ADDR(WDS1)^=NULLPTR&DDNAME1^=NULLDDN THEN                   0392 00444000
@RF00383 L     @09,@PC00001+4                                      0392 00445000
         L     @09,FDTPTR+16(,@09)                                 0392 00446000
         LTR   @09,@09                                             0392 00447000
         BZ    @RF00392                                            0392 00448000
         CLC   DDNAME1(8),NULLDDN                                  0392 00449000
         BE    @RF00392                                            0392 00450000
*     DO;                           /*                       @Z40LB65*/ 00451000
*       RESPECIFY                                                  0394 00452000
*         ALLAGL BASED(ALL1PTR);    /*                       @Z40LB65*/ 00453000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/ 00454000
         L     @09,@PC00001                                        0395 00455000
         ST    @09,@AL00001                                        0395 00456000
         ST    ALL1PTR,@AL00001+4                                  0395 00457000
         MVI   @AL00001+4,X'80'                                    0395 00458000
         L     @15,GDTDLC(,@09)                                    0395 00459000
         LA    @01,@AL00001                                        0395 00460000
         BALR  @14,@15                                             0395 00461000
*       RESPECIFY                                                  0396 00462000
*         RTNREG RSTD;                                             0396 00463000
*       TESTRC=RTNREG;                                             0397 00464000
         LR    TESTRC,RTNREG                                       0397 00465000
*       RESPECIFY                                                  0398 00466000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00467000
*       IF TESTRC^=0 THEN                                          0399 00468000
         LTR   TESTRC,TESTRC                                       0399 00469000
         BZ    @RF00399                                            0399 00470000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/ 00471000
         L     @09,@PC00001+8                                      0400 00472000
         LH    @15,LASTCOND(,@09)                                  0400 00473000
         LA    @14,4                                               0400 00474000
         CR    @15,@14                                             0400 00475000
         BNL   *+6                                                      00476000
         LR    @15,@14                                             0400 00477000
         STH   @15,LASTCOND(,@09)                                  0400 00478000
*     END;                          /*                       @Z40LB65*/ 00479000
*                                                                  0401 00480000
@RF00399 DS    0H                                                  0402 00481000
*   /*****************************************************************/ 00482000
*   /*                                                               */ 00483000
*   /* IF WORKPTR2 IS ^= 0 THEN THE WORKDATASET2 WAS OPENED  @Z40LB65*/ 00484000
*   /* AND MUST BE CLOSED AND POSSIBLY DEALLOCATED.          @Z40LB65*/ 00485000
*   /*                                                               */ 00486000
*   /*****************************************************************/ 00487000
*                                                                  0402 00488000
*   IF WORKPTR2^=NULLPTR THEN                                      0402 00489000
@RF00392 L     @09,WORKPTR2                                        0402 00490000
         LTR   @09,@09                                             0402 00491000
         BZ    @RF00402                                            0402 00492000
*     DO;                           /*                       @Z40LB65*/ 00493000
*       CALL IDCIO050(GDTTBL,CLOSE,WORKPTR2);/*              @Z40LB65*/ 00494000
         L     @09,@PC00001                                        0404 00495000
         ST    @09,@AL00001                                        0404 00496000
         LA    @02,CLOSE                                           0404 00497000
         ST    @02,@AL00001+4                                      0404 00498000
         LA    @02,WORKPTR2                                        0404 00499000
         ST    @02,@AL00001+8                                      0404 00500000
         MVI   @AL00001+8,X'80'                                    0404 00501000
         L     @15,GDTEXP(,@09)                                    0404 00502000
         LA    @01,@AL00001                                        0404 00503000
         BALR  @14,@15                                             0404 00504000
*       RESPECIFY                                                  0405 00505000
*         RTNREG RSTD;                                             0405 00506000
*       TESTRC=RTNREG;                                             0406 00507000
         LR    TESTRC,RTNREG                                       0406 00508000
*       RESPECIFY                                                  0407 00509000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00510000
*       IF TESTRC^=0 THEN                                          0408 00511000
         LTR   TESTRC,TESTRC                                       0408 00512000
         BZ    @RF00408                                            0408 00513000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/ 00514000
         L     @09,@PC00001+8                                      0409 00515000
         LH    @15,LASTCOND(,@09)                                  0409 00516000
         LA    @14,4                                               0409 00517000
         CR    @15,@14                                             0409 00518000
         BNL   *+6                                                      00519000
         LR    @15,@14                                             0409 00520000
         STH   @15,LASTCOND(,@09)                                  0409 00521000
*     END;                          /*                       @Z40LB65*/ 00522000
@RF00408 DS    0H                                                  0411 00523000
*   IF ADDR(WDS2)^=NULLPTR&DDNAME2^=NULLDDN THEN                   0411 00524000
@RF00402 L     @09,@PC00001+4                                      0411 00525000
         L     @09,FDTPTR+20(,@09)                                 0411 00526000
         LTR   @09,@09                                             0411 00527000
         BZ    @RF00411                                            0411 00528000
         CLC   DDNAME2(8),NULLDDN                                  0411 00529000
         BE    @RF00411                                            0411 00530000
*     DO;                           /*                       @Z40LB65*/ 00531000
*       RESPECIFY                                                  0413 00532000
*         ALLAGL BASED(ALL2PTR);    /*                       @Z40LB65*/ 00533000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/ 00534000
         L     @09,@PC00001                                        0414 00535000
         ST    @09,@AL00001                                        0414 00536000
         ST    ALL2PTR,@AL00001+4                                  0414 00537000
         MVI   @AL00001+4,X'80'                                    0414 00538000
         L     @15,GDTDLC(,@09)                                    0414 00539000
         LA    @01,@AL00001                                        0414 00540000
         BALR  @14,@15                                             0414 00541000
*       RESPECIFY                                                  0415 00542000
*         RTNREG RSTD;                                             0415 00543000
*       TESTRC=RTNREG;                                             0416 00544000
         LR    TESTRC,RTNREG                                       0416 00545000
*       RESPECIFY                                                  0417 00546000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00547000
*       IF TESTRC^=0 THEN                                          0418 00548000
         LTR   TESTRC,TESTRC                                       0418 00549000
         BZ    @RF00418                                            0418 00550000
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Z40LB65*/ 00551000
         L     @15,@PC00001+8                                      0419 00552000
         LH    @14,LASTCOND(,@15)                                  0419 00553000
         LA    @09,4                                               0419 00554000
         CR    @14,@09                                             0419 00555000
         BNL   *+6                                                      00556000
         LR    @14,@09                                             0419 00557000
         STH   @14,LASTCOND(,@15)                                  0419 00558000
*     END;                          /*                       @Z40LB65*/ 00559000
*                                                                  0420 00560000
@RF00418 DS    0H                                                  0421 00561000
*   /*****************************************************************/ 00562000
*   /*                                                               */ 00563000
*   /* PRINT THE APPROPRIATE COMPLETION MESSAGE              @Z40LB65*/ 00564000
*   /*                                                               */ 00565000
*   /*****************************************************************/ 00566000
*                                                                  0421 00567000
*   PRINTAB=''B;                    /*                       @Z40LB65*/ 00568000
@RF00411 XC    PRINTAB(20),PRINTAB                                 0421 00569000
*   DARGSMOD=UNIVMSG;               /*                       @Z40LB65*/ 00570000
         L     @15,DDSTRU                                          0422 00571000
         MVC   DARGSMOD(3,@15),@CC01279                            0422 00572000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Z40LB65*/ 00573000
         L     @14,@PC00001+8                                      0423 00574000
         ST    @14,DARGDBP(,@15)                                   0423 00575000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Z40LB65*/ 00576000
         MVC   DARGILP(2,@15),@CH00152                             0424 00577000
*   IF LASTCOND=LASTCC12 THEN       /*                       @Z40LB65*/ 00578000
         CLC   LASTCOND(2,@14),@CH00567                            0425 00579000
         BNE   @RF00425                                            0425 00580000
*     DARGSENT=MSG3003I;            /*                       @Z40LB65*/ 00581000
         MVI   DARGSENT(@15),X'03'                                 0426 00582000
*   ELSE                                                           0427 00583000
*     IF LASTCOND=LASTCC08 THEN     /*                       @Z40LB65*/ 00584000
         B     @RC00425                                            0427 00585000
@RF00425 L     @15,@PC00001+8                                      0427 00586000
         CLC   LASTCOND(2,@15),@CH00178                            0427 00587000
         BNE   @RF00427                                            0427 00588000
*       DARGSENT=MSG3004I;          /*                       @Z40LB65*/ 00589000
         L     @01,DDSTRU                                          0428 00590000
         MVI   DARGSENT(@01),X'04'                                 0428 00591000
*     ELSE                          /*                       @Z40LB65*/ 00592000
*       DARGSENT=MSG0001I;          /*                       @Z40LB65*/ 00593000
         B     @RC00427                                            0429 00594000
@RF00427 L     @01,DDSTRU                                          0429 00595000
         MVI   DARGSENT(@01),X'01'                                 0429 00596000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/ 00597000
*                                                                  0430 00598000
@RC00427 DS    0H                                                  0430 00599000
@RC00425 L     @15,@PC00001                                        0430 00600000
         ST    @15,@AL00001                                        0430 00601000
         LA    @14,@CF00114                                        0430 00602000
         ST    @14,@AL00001+4                                      0430 00603000
         LA    @14,DDSTRU                                          0430 00604000
         ST    @14,@AL00001+8                                      0430 00605000
         MVI   @AL00001+8,X'80'                                    0430 00606000
         L     @15,GDTPRT(,@15)                                    0430 00607000
         LA    @01,@AL00001                                        0430 00608000
         BALR  @14,@15                                             0430 00609000
*   /*****************************************************************/ 00610000
*   /*                                                               */ 00611000
*   /* SET UP FOR A FULL REGION DUMP AND RETURN TO AMS       @Z40LB65*/ 00612000
*   /*                                                               */ 00613000
*   /*****************************************************************/ 00614000
*                                                                  0431 00615000
*   IF GDTDBG=NULLPTR THEN                                         0431 00616000
         L     @15,@PC00001                                        0431 00617000
         L     @15,GDTDBG(,@15)                                    0431 00618000
         LTR   @15,@15                                             0431 00619000
         BZ    @RT00431                                            0431 00620000
*     ;                                                            0432 00621000
*   ELSE                                                           0433 00622000
*     CALL IDCDB010(GDTTBL,'CPAZ'); /*                       @Z40LB65*/ 00623000
         L     @15,@PC00001                                        0433 00624000
         ST    @15,@AL00001                                        0433 00625000
         LA    @14,@CC01295                                        0433 00626000
         ST    @14,@AL00001+4                                      0433 00627000
         MVI   @AL00001+4,X'80'                                    0433 00628000
         L     @15,GDTDBG(,@15)                                    0433 00629000
         LA    @01,@AL00001                                        0433 00630000
         BALR  @14,@15                                             0433 00631000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0434 00632000
*                                                                  0434 00633000
@RT00431 L     @15,@PC00001                                        0434 00634000
         ST    @15,@AL00001                                        0434 00635000
         LA    @14,MODID                                           0434 00636000
         ST    @14,@AL00001+4                                      0434 00637000
         L     @14,@PC00001+8                                      0434 00638000
         ST    @14,@AL00001+8                                      0434 00639000
         MVI   @AL00001+8,X'80'                                    0434 00640000
         L     @15,GDTEPL(,@15)                                    0434 00641000
         LA    @01,@AL00001                                        0434 00642000
         BALR  @14,@15                                             0434 00643000
*   /*****************************************************************/ 00644000
*   /*                                                               */ 00645000
*   /*                                                       @Z40LB65*/ 00646000
*   /*                                                               */ 00647000
*   /*****************************************************************/ 00648000
*                                                                  0435 00649000
*                                                                  0435 00650000
*/********************************************************************/ 00651000
*/*                                                          @Z40LB65*/ 00652000
*/*     PROCEDURE NAME - OPENPROC                            @Z40LB65*/ 00653000
*/*                                                          @Z40LB65*/ 00654000
*/*     FUNCTION - THIS ROUTINE ALLOCATES AND OPENS THE      @Z40LB65*/ 00655000
*/*                WORK DATA SETS AND INSURES THAT THEY      @Z40LB65*/ 00656000
*/*                ARE MASS STORAGE VOLUMES.                 @Z40LB65*/ 00657000
*/*                                                          @Z40LB65*/ 00658000
*/*     INPUT - FUNCTION DEFINITION TABLE                    @Z40LB65*/ 00659000
*/*                                                          @Z40LB65*/ 00660000
*/*     OUTPUT - INTTBL INITIALIZED WITH THE WORK VOLUME     @Z40LB65*/ 00661000
*/*                SERIAL NUMBER AND WITH THE START AND      @Z40LB65*/ 00662000
*/*                END CYLINDER ADDRESSES AND A RETURN CODE  @Z40LB65*/ 00663000
*/*                0 = SUCCESSFUL COMPLETION                 @Z40LB65*/ 00664000
*/*                12 = UNSUCCESSFUL COMPLETION              @Z40LB65*/ 00665000
*/*                                                          @Z40LB65*/ 00666000
*/********************************************************************/ 00667000
*                                                                  0435 00668000
*OPENPROC:                                                         0435 00669000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 00670000
*                                                                  0435 00671000
@EL00001 L     @13,4(,@13)                                         0435 00672000
@EF00001 L     @00,@SIZDATD                                        0435 00673000
         LR    @01,@11                                             0435 00674000
         FREEMAIN R,LV=(0),A=(1)                                        00675000
@ER00001 LM    @14,@12,12(@13)                                     0435 00676000
         BR    @14                                                 0435 00677000
OPENPROC STM   @14,@12,12(@13)                                     0435 00678000
         ST    @13,@SA00002+4                                      0435 00679000
         LA    @14,@SA00002                                        0435 00680000
         ST    @14,8(,@13)                                         0435 00681000
         LR    @13,@14                                             0435 00682000
*   /*****************************************************************/ 00683000
*   /*                                                               */ 00684000
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/ 00685000
*   /*                                                               */ 00686000
*   /*****************************************************************/ 00687000
*                                                                  0436 00688000
*   DCL                                                            0436 00689000
*     OPENCODE FIXED(15);           /* OPENWORK RET CODE     @Z40LB65*/ 00690000
*   DCL                                                            0437 00691000
*     IOINFO CHAR(LENGTH(IOINFOPT));/* UIOINFO FLAGS         @Z40LB65*/ 00692000
*   DCL                                                            0438 00693000
*     VOLSRPTR PTR(31);             /* PTR TO VOLSER'S       @Z40LB65   00694000
*                                      FROM UIOINFO MACRO    @Z40LB65*/ 00695000
*                                                                  0438 00696000
*   /*****************************************************************/ 00697000
*   /*                                                               */ 00698000
*   /* DECLARE WORK AREA STRUCTURE FOR RETURN OF VOLUME      @Z40LB65*/ 00699000
*   /* SERIAL NUMBERS FROM UIOINFO MACRO                     @Z40LB65*/ 00700000
*   /*                                                               */ 00701000
*   /*****************************************************************/ 00702000
*                                                                  0439 00703000
*   DCL                                                            0439 00704000
*     1 INFOAREA CHAR(38) BDY(WORD),                               0439 00705000
*      2 HEADER CHAR(4) BDY(WORD),  /* HEADER INFORMATION    @Z40LB65*/ 00706000
*       3 WORKLEN FIXED(15),        /* WORK AREA LENGTH      @Z40LB65*/ 00707000
*       3 RETNLEN FIXED(15),        /* DATA RETURNED LEN     @Z40LB65*/ 00708000
*      2 TYPE FIXED(15),            /* DATA TYPE             @Z40LB65*/ 00709000
*      2 DATALEN FIXED(15),         /* DATA LENGTH           @Z40LB65*/ 00710000
*      2 VOLAREA(5) CHAR(6);        /* VOLUME SER NUMBERS    @Z40LB65*/ 00711000
*   DCL                                                            0440 00712000
*     UCBPTR PTR(31);               /* UCB PTR FIELD         @Z40LB65*/ 00713000
*   OLDERID2=NEWERID2;                                             0441 00714000
         L     @09,@PC00001                                        0441 00715000
         L     @15,GDTTR2(,@09)                                    0441 00716000
         MVC   @TS00001(95),NEWERID2(@15)                          0441 00717000
         MVC   OLDERID2(95,@15),@TS00001                           0441 00718000
*   NEWID2='CPBA';                  /*                       @Z40LB65*/ 00719000
         MVC   NEWID2(4,@15),@CC01311                              0442 00720000
*   OPENCODE=''B;                   /*                       @Z40LB65*/ 00721000
         SLR   @15,@15                                             0443 00722000
         LR    OPENCODE,@15                                        0443 00723000
*   VOLSRPTR=ADDR(INFOAREA);        /*                       @Z40LB65*/ 00724000
         LA    @14,INFOAREA                                        0444 00725000
         ST    @14,VOLSRPTR                                        0444 00726000
*   WORKLEN=LENGTH(INFOAREA);       /*                       @Z40LB65*/ 00727000
         MVC   WORKLEN(2),@CH01303                                 0445 00728000
*   UCBPTR=''B;                     /*                       @Z40LB65*/ 00729000
         ST    @15,UCBPTR                                          0446 00730000
*   RESPECIFY                                                      0447 00731000
*     IOINFOPT BASED(ADDR(IOINFO)); /*                       @Z40LB65*/ 00732000
*   IOINFOPT=''B;                   /*                       @Z40LB65*/ 00733000
*                                                                  0448 00734000
         LA    @15,IOINFO                                          0448 00735000
         MVI   IOINFOPT(@15),X'00'                                 0448 00736000
*   /*****************************************************************/ 00737000
*   /*                                                               */ 00738000
*   /* CHECK TO SEE IF THE WDS1 PARAMETER IS SPECIFIED.      @Z40LB65*/ 00739000
*   /* THIS PARM INDICATES THAT A DSN WAS GIVEN AND THE UALLOC MACRO */ 00740000
*   /* IS ISSUED TO OBTAIN A DDNAME FOR THE DSNAME. IF NOT SPECIFIED,*/ 00741000
*   /* USE THE DDNAME FROM THE WFILE PARM.                   @Z40LB65*/ 00742000
*   /*                                                               */ 00743000
*   /*****************************************************************/ 00744000
*                                                                  0449 00745000
*   IF ADDR(WDS1)^=NULLPTR THEN                                    0449 00746000
         L     @15,@PC00001+4                                      0449 00747000
         L     @15,FDTPTR+16(,@15)                                 0449 00748000
         LTR   @15,@15                                             0449 00749000
         BZ    @RF00449                                            0449 00750000
*     DO;                           /*                       @Z40LB65*/ 00751000
*       RESPECIFY                                                  0451 00752000
*         ALLAGL BASED(ALL1PTR);    /*                       @Z40LB65*/ 00753000
*       ALLDSN=ADDR(WDS1VAL);       /*                       @Z40LB65*/ 00754000
         LA    @02,WDS1VAL(,@15)                                   0452 00755000
         ST    @02,ALLDSN(,ALL1PTR)                                0452 00756000
*       ALLSTSOD=ON;                /*                       @Z40LB65*/ 00757000
         OI    ALLSTSOD(ALL1PTR),B'00000001'                       0453 00758000
*       ALLDSPKP=ON;                /*                       @Z40LB65*/ 00759000
         OI    ALLDSPKP(ALL1PTR),B'00001000'                       0454 00760000
*       ALLOPTDS=ON;                /*                       @Z40LB65*/ 00761000
*       ALLOPTVL=OFF;               /*                       @Z40LB65*/ 00762000
         OI    ALLOPTDS(ALL1PTR),B'01000000'                       0456 00763000
         NI    ALLOPTVL(ALL1PTR),B'01111111'                       0456 00764000
*       ALLULP=ADDR(ULLIST);        /*                       @Z40LB65*/ 00765000
         LA    @02,ULLIST                                          0457 00766000
         ST    @02,ALLULP(,ALL1PTR)                                0457 00767000
*       ULCOUNT=1;                  /*                       @Z40LB65*/ 00768000
         MVC   ULCOUNT(2),@CH00218                                 0458 00769000
*       ULDEVLEN=LENGTH(ULCON);     /*                       @Z40LB65*/ 00770000
         MVC   ULDEVLEN(2),@CH00285                                0459 00771000
*       ULDEVTYP=ULCON;             /*                       @Z40LB65*/ 00772000
         MVI   ULDEVTYP+5,C' '                                     0460 00773000
         MVC   ULDEVTYP+6(2),ULDEVTYP+5                            0460 00774000
         MVC   ULDEVTYP(5),@CC01271                                0460 00775000
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/ 00776000
         ST    @09,@AL00001                                        0461 00777000
         ST    ALL1PTR,@AL00001+4                                  0461 00778000
         MVI   @AL00001+4,X'80'                                    0461 00779000
         L     @15,GDTALC(,@09)                                    0461 00780000
         LA    @01,@AL00001                                        0461 00781000
         BALR  @14,@15                                             0461 00782000
*       RESPECIFY                                                  0462 00783000
*         RTNREG RSTD;                                             0462 00784000
*       TESTRC=RTNREG;                                             0463 00785000
         LR    TESTRC,RTNREG                                       0463 00786000
*       RESPECIFY                                                  0464 00787000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00788000
*       IF TESTRC^=0 THEN                                          0465 00789000
         LTR   TESTRC,TESTRC                                       0465 00790000
         BZ    @RF00465                                            0465 00791000
*         DO;                       /*                       @Z40LB65*/ 00792000
*           OPENCODE=LASTCC12;      /*                       @Z40LB65*/ 00793000
         LA    OPENCODE,12                                         0467 00794000
*           DDNAME1=''B;            /*                       @Z40LB65*/ 00795000
         XC    DDNAME1(8),DDNAME1                                  0468 00796000
*         END;                      /*                       @Z40LB65*/ 00797000
*       ELSE                                                       0470 00798000
*         DDNAME1=ALLDDN;           /*                       @Z40LB65*/ 00799000
         B     @RC00465                                            0470 00800000
@RF00465 MVC   DDNAME1(8),ALLDDN(ALL1PTR)                          0470 00801000
*     END;                          /*                       @Z40LB65*/ 00802000
*   ELSE                                                           0472 00803000
*     DDNAME1=FILE1VAL;             /*                       @Z40LB65*/ 00804000
*                                                                  0472 00805000
         B     @RC00449                                            0472 00806000
@RF00449 L     @09,@PC00001+4                                      0472 00807000
         L     @09,FDTPTR+8(,@09)                                  0472 00808000
         MVC   DDNAME1(8),FILE1VAL(@09)                            0472 00809000
*   /*****************************************************************/ 00810000
*   /*                                                               */ 00811000
*   /* IF OPENCODE = 0 THEN ISSUE THE UIOINFO MACRO TO       @Z40LB65*/ 00812000
*   /* RETRIEVE THE VOLSER FROM THE JFCB. USE THE DDNAME PLACED IN   */ 00813000
*   /* THE DDNAME1 FIELD.                                    @Z40LB65*/ 00814000
*   /*                                                               */ 00815000
*   /*****************************************************************/ 00816000
*                                                                  0473 00817000
*   IF OPENCODE=LASTCC00 THEN                                      0473 00818000
@RC00449 LTR   OPENCODE,OPENCODE                                   0473 00819000
         BNZ   @RF00473                                            0473 00820000
*     DO;                           /*                       @Z40LB65*/ 00821000
*       IOINFVOL=ON;                /*                       @Z40LB65*/ 00822000
         LA    @09,IOINFO                                          0475 00823000
         OI    IOINFVOL(@09),B'01000000'                           0475 00824000
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,VOLSRPTR,DDNAME1);/*   @Z40LB65*/ 00825000
         L     @02,@PC00001                                        0476 00826000
         ST    @02,@AL00001                                        0476 00827000
         ST    @09,@AL00001+4                                      0476 00828000
         LA    @09,VOLSRPTR                                        0476 00829000
         ST    @09,@AL00001+8                                      0476 00830000
         LA    @09,DDNAME1                                         0476 00831000
         ST    @09,@AL00001+12                                     0476 00832000
         MVI   @AL00001+12,X'80'                                   0476 00833000
         L     @15,GDTIFO(,@02)                                    0476 00834000
         LA    @01,@AL00001                                        0476 00835000
         BALR  @14,@15                                             0476 00836000
*       RESPECIFY                                                  0477 00837000
*         RTNREG RSTD;                                             0477 00838000
*       TESTRC=RTNREG;                                             0478 00839000
         LR    TESTRC,RTNREG                                       0478 00840000
*       RESPECIFY                                                  0479 00841000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00842000
*       IF TESTRC^=0 THEN                                          0480 00843000
         LTR   TESTRC,TESTRC                                       0480 00844000
         BZ    @RF00480                                            0480 00845000
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/ 00846000
         LA    OPENCODE,12                                         0481 00847000
*       WORKVOL1=VOLAREA(1);        /*                       @Z40LB65*/ 00848000
@RF00480 MVC   WORKVOL1(6),VOLAREA                                 0482 00849000
*     END;                          /*                       @Z40LB65*/ 00850000
*                                                                  0483 00851000
*   /*****************************************************************/ 00852000
*   /*                                                               */ 00853000
*   /* IF OPENCODE = 0 THEN ISSUE UMSSUNIT MACRO TO CHECK    @Z40LB65*/ 00854000
*   /* THE WORK DATA SET FOR BEING ON A MASS STORAGE VOLUME. PRIOR TO*/ 00855000
*   /* ISSUING THE MACRO TEST IF THE DATA SET WAS ALLOCATED          */ 00856000
*   /* DYNAMICALLY. IF YES, PLACE THE VOLSER IN THE CKAGL PARM LIST  */ 00857000
*   /* SO THAT IF AN ERROR OCCURS THE VOLSER WILL BE USED INSTEAD OF */ 00858000
*   /* THE DDNAME                                            @Z40LB65*/ 00859000
*   /*                                                               */ 00860000
*   /*****************************************************************/ 00861000
*                                                                  0484 00862000
*   IF OPENCODE=LASTCC00 THEN                                      0484 00863000
@RF00473 SLR   @09,@09                                             0484 00864000
         CR    OPENCODE,@09                                        0484 00865000
         BNE   @RF00484                                            0484 00866000
*     DO;                           /*                       @Z40LB65*/ 00867000
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Z40LB65*/ 00868000
         LA    @15,UCBPTR                                          0486 00869000
         ST    @15,CKUCBPTR(,CKPTR)                                0486 00870000
*       CKDDNAME=DDNAME1;           /*                       @Z40LB65*/ 00871000
         MVC   CKDDNAME(8,CKPTR),DDNAME1                           0487 00872000
*       CKTESTVT=ON;                /*                       @Z40LB65*/ 00873000
         OI    CKTESTVT(CKPTR),B'10000000'                         0488 00874000
*       IF ADDR(WDS1)^=NULLPTR THEN                                0489 00875000
         L     @15,@PC00001+4                                      0489 00876000
         C     @09,FDTPTR+16(,@15)                                 0489 00877000
         BE    @RF00489                                            0489 00878000
*         CKLABELP=ADDR(WORKVOL1);  /*                       @Z40LB65*/ 00879000
         LA    @09,WORKVOL1                                        0490 00880000
         ST    @09,CKLABELP(,CKPTR)                                0490 00881000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB65*/ 00882000
@RF00489 L     @09,@PC00001                                        0491 00883000
         ST    @09,@AL00001                                        0491 00884000
         LA    @02,CHECK                                           0491 00885000
         ST    @02,@AL00001+4                                      0491 00886000
         ST    CKPTR,@AL00001+8                                    0491 00887000
         MVI   @AL00001+8,X'80'                                    0491 00888000
         L     @15,GDTUNT(,@09)                                    0491 00889000
         LA    @01,@AL00001                                        0491 00890000
         BALR  @14,@15                                             0491 00891000
*       RESPECIFY                                                  0492 00892000
*         RTNREG RSTD;                                             0492 00893000
*       TESTRC=RTNREG;                                             0493 00894000
         LR    TESTRC,RTNREG                                       0493 00895000
*       RESPECIFY                                                  0494 00896000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00897000
*       IF TESTRC^=0 THEN                                          0495 00898000
         LTR   TESTRC,TESTRC                                       0495 00899000
         BZ    @RF00495                                            0495 00900000
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/ 00901000
         LA    OPENCODE,12                                         0496 00902000
*     END;                          /*                       @Z40LB65*/ 00903000
*                                                                  0497 00904000
@RF00495 DS    0H                                                  0498 00905000
*   /*****************************************************************/ 00906000
*   /*                                                               */ 00907000
*   /* IF OPENCODE = 0 THEN ISSUE THE UEXCP MACRO TO OPEN    @Z40LB65*/ 00908000
*   /* WORKDATASET1. UPON RETURN FROM SUCCESSFUL OPEN OF THE DATA SET*/ 00909000
*   /* THE BEGINNING AND ENDING ADDRESS MUST BE ON A CYLINDER        */ 00910000
*   /* BOUNDARY. IF NOT, THE BEG CYLINDER ADDR IS ROUNDED UP AND THE */ 00911000
*   /* END CYL IS ROUNDED DOWN.                              @Z40LB65*/ 00912000
*   /*                                                               */ 00913000
*   /*****************************************************************/ 00914000
*                                                                  0498 00915000
*   IF OPENCODE=LASTCC00 THEN                                      0498 00916000
@RF00484 LTR   OPENCODE,OPENCODE                                   0498 00917000
         BNZ   @RF00498                                            0498 00918000
*     DO;                           /*                       @Z40LB65*/ 00919000
*       EXODDN=ADDR(DDNAME1);       /*                       @Z40LB65*/ 00920000
         LA    @09,DDNAME1                                         0500 00921000
         ST    @09,EXODDN(,EXOPTR)                                 0500 00922000
*       EXOEXT=ADDR(EXTCHRS1);      /*                       @Z40LB65*/ 00923000
         LA    @09,EXTCHRS1                                        0501 00924000
         ST    @09,EXOEXT(,EXOPTR)                                 0501 00925000
*       EXOCTLBK=ADDR(WORKPTR1);    /*                       @Z40LB65*/ 00926000
         LA    @09,WORKPTR1                                        0502 00927000
         ST    @09,EXOCTLBK(,EXOPTR)                               0502 00928000
*       EXOTAB=ON;                  /*                       @Z40LB65*/ 00929000
         OI    EXOTAB(EXOPTR),B'10000000'                          0503 00930000
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                 @Z40LB65*/ 00931000
         L     @09,@PC00001                                        0504 00932000
         ST    @09,@AL00001                                        0504 00933000
         LA    @02,OPEN                                            0504 00934000
         ST    @02,@AL00001+4                                      0504 00935000
         ST    EXOPTR,@AL00001+8                                   0504 00936000
         MVI   @AL00001+8,X'80'                                    0504 00937000
         L     @15,GDTEXP(,@09)                                    0504 00938000
         LA    @01,@AL00001                                        0504 00939000
         BALR  @14,@15                                             0504 00940000
*       RESPECIFY                                                  0505 00941000
*         RTNREG RSTD;                                             0505 00942000
*       TESTRC=RTNREG;                                             0506 00943000
         LR    TESTRC,RTNREG                                       0506 00944000
*       RESPECIFY                                                  0507 00945000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 00946000
*       IF TESTRC=0 THEN                                           0508 00947000
         LTR   TESTRC,TESTRC                                       0508 00948000
         BNZ   @RF00508                                            0508 00949000
*         DO;                       /*                       @Z40LB65*/ 00950000
*           IF STRK1^=NULL THEN                                    0510 00951000
         CLC   STRK1(2),NULL                                       0510 00952000
         BE    @RF00510                                            0510 00953000
*             SCYL1=SCYL1+1;        /*                       @Z40LB65*/ 00954000
         LA    @09,1                                               0511 00955000
         LH    @15,SCYL1                                           0511 00956000
         N     @15,@CF01444                                        0511 00957000
         ALR   @09,@15                                             0511 00958000
         STH   @09,SCYL1                                           0511 00959000
*           IF ETRK1^=NULL THEN                                    0512 00960000
@RF00510 CLC   ETRK1(2),NULL                                       0512 00961000
         BE    @RF00512                                            0512 00962000
*             ECYL1=ECYL1-1;        /*                       @Z40LB65*/ 00963000
         SLR   @09,@09                                             0513 00964000
         ICM   @09,3,ECYL1                                         0513 00965000
         BCTR  @09,0                                               0513 00966000
         STCM  @09,3,ECYL1                                         0513 00967000
*         END;                      /*                       @Z40LB65*/ 00968000
*       ELSE                                                       0515 00969000
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/ 00970000
         B     @RC00508                                            0515 00971000
@RF00508 LA    OPENCODE,12                                         0515 00972000
*     END;                          /*                       @Z40LB65*/ 00973000
*                                                                  0516 00974000
@RC00508 DS    0H                                                  0517 00975000
*   /*****************************************************************/ 00976000
*   /*                                                               */ 00977000
*   /* CHECK TO SEE IF THE WDS2 PARAMETER IS SPECIFIED.      @Z40LB65*/ 00978000
*   /* THIS PARM INDICATES THAT A DSN WAS GIVEN AND THE UALLOC MACRO */ 00979000
*   /* IS ISSUED TO OBTAIN A DDNAME FOR THE DSNAME. IF NOT SPECIFIED,*/ 00980000
*   /* USE THE DDNAME FROM THE WFILE2 PARM.                  @Z40LB65*/ 00981000
*   /*                                                               */ 00982000
*   /*****************************************************************/ 00983000
*                                                                  0517 00984000
*   IF ADDR(WDS2)^=NULLPTR THEN                                    0517 00985000
@RF00498 L     @09,@PC00001+4                                      0517 00986000
         L     @09,FDTPTR+20(,@09)                                 0517 00987000
         LTR   @09,@09                                             0517 00988000
         BZ    @RF00517                                            0517 00989000
*     DO;                           /*                       @Z40LB65*/ 00990000
*       RESPECIFY                                                  0519 00991000
*         ALLAGL BASED(ALL2PTR);    /*                       @Z40LB65*/ 00992000
*       ALLDSN=ADDR(WDS2VAL);       /*                       @Z40LB65*/ 00993000
         LA    @09,WDS2VAL(,@09)                                   0520 00994000
         ST    @09,ALLDSN(,ALL2PTR)                                0520 00995000
*       ALLSTSOD=ON;                /*                       @Z40LB65*/ 00996000
         OI    ALLSTSOD(ALL2PTR),B'00000001'                       0521 00997000
*       ALLDSPKP=ON;                /*                       @Z40LB65*/ 00998000
         OI    ALLDSPKP(ALL2PTR),B'00001000'                       0522 00999000
*       ALLOPTDS=ON;                /*                       @Z40LB65*/ 01000000
*       ALLOPTVL=OFF;               /*                       @Z40LB65*/ 01001000
         OI    ALLOPTDS(ALL2PTR),B'01000000'                       0524 01002000
         NI    ALLOPTVL(ALL2PTR),B'01111111'                       0524 01003000
*       ALLULP=ADDR(ULLIST);        /*                       @Z40LB65*/ 01004000
         LA    @09,ULLIST                                          0525 01005000
         ST    @09,ALLULP(,ALL2PTR)                                0525 01006000
*       ULCOUNT=1;                  /*                       @Z40LB65*/ 01007000
         MVC   ULCOUNT(2),@CH00218                                 0526 01008000
*       ULDEVLEN=LENGTH(ULCON);     /*                       @Z40LB65*/ 01009000
         MVC   ULDEVLEN(2),@CH00285                                0527 01010000
*       ULDEVTYP=ULCON;             /*                       @Z40LB65*/ 01011000
         MVI   ULDEVTYP+5,C' '                                     0528 01012000
         MVC   ULDEVTYP+6(2),ULDEVTYP+5                            0528 01013000
         MVC   ULDEVTYP(5),@CC01271                                0528 01014000
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/*                      @Z40LB65*/ 01015000
         L     @09,@PC00001                                        0529 01016000
         ST    @09,@AL00001                                        0529 01017000
         ST    ALL2PTR,@AL00001+4                                  0529 01018000
         MVI   @AL00001+4,X'80'                                    0529 01019000
         L     @15,GDTALC(,@09)                                    0529 01020000
         LA    @01,@AL00001                                        0529 01021000
         BALR  @14,@15                                             0529 01022000
*       RESPECIFY                                                  0530 01023000
*         RTNREG RSTD;                                             0530 01024000
*       TESTRC=RTNREG;                                             0531 01025000
         LR    TESTRC,RTNREG                                       0531 01026000
*       RESPECIFY                                                  0532 01027000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 01028000
*       IF TESTRC^=0 THEN                                          0533 01029000
         LTR   TESTRC,TESTRC                                       0533 01030000
         BZ    @RF00533                                            0533 01031000
*         DO;                       /*                       @Z40LB65*/ 01032000
*           OPENCODE=LASTCC12;      /*                       @Z40LB65*/ 01033000
         LA    OPENCODE,12                                         0535 01034000
*           DDNAME2=''B;            /*                       @Z40LB65*/ 01035000
         XC    DDNAME2(8),DDNAME2                                  0536 01036000
*         END;                      /*                       @Z40LB65*/ 01037000
*       ELSE                                                       0538 01038000
*         DDNAME2=ALLDDN;           /*                       @Z40LB65*/ 01039000
         B     @RC00533                                            0538 01040000
@RF00533 MVC   DDNAME2(8),ALLDDN(ALL2PTR)                          0538 01041000
*     END;                          /*                       @Z40LB65*/ 01042000
*   ELSE                                                           0540 01043000
*     DDNAME2=FILE2VAL;             /*                       @Z40LB65*/ 01044000
*                                                                  0540 01045000
         B     @RC00517                                            0540 01046000
@RF00517 L     @09,@PC00001+4                                      0540 01047000
         L     @09,FDTPTR+12(,@09)                                 0540 01048000
         MVC   DDNAME2(8),FILE2VAL(@09)                            0540 01049000
*   /*****************************************************************/ 01050000
*   /*                                                               */ 01051000
*   /* IF OPENCODE = 0 THEN ISSUE THE UIOINFO MACRO TO       @Z40LB65*/ 01052000
*   /* RETRIEVE THE VOLSER FROM THE JFCB. USE THE DDNAME PLACED IN   */ 01053000
*   /* THE DDNAME2 FIELD.                                    @Z40LB65*/ 01054000
*   /*                                                               */ 01055000
*   /*****************************************************************/ 01056000
*                                                                  0541 01057000
*   IF OPENCODE=LASTCC00 THEN                                      0541 01058000
@RC00517 LTR   OPENCODE,OPENCODE                                   0541 01059000
         BNZ   @RF00541                                            0541 01060000
*     DO;                           /*                       @Z40LB65*/ 01061000
*       IOINFVOL=ON;                /*                       @Z40LB65*/ 01062000
         LA    @09,IOINFO                                          0543 01063000
         OI    IOINFVOL(@09),B'01000000'                           0543 01064000
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,VOLSRPTR,DDNAME2);/*   @Z40LB65*/ 01065000
         L     @02,@PC00001                                        0544 01066000
         ST    @02,@AL00001                                        0544 01067000
         ST    @09,@AL00001+4                                      0544 01068000
         LA    @09,VOLSRPTR                                        0544 01069000
         ST    @09,@AL00001+8                                      0544 01070000
         LA    @09,DDNAME2                                         0544 01071000
         ST    @09,@AL00001+12                                     0544 01072000
         MVI   @AL00001+12,X'80'                                   0544 01073000
         L     @15,GDTIFO(,@02)                                    0544 01074000
         LA    @01,@AL00001                                        0544 01075000
         BALR  @14,@15                                             0544 01076000
*       RESPECIFY                                                  0545 01077000
*         RTNREG RSTD;                                             0545 01078000
*       TESTRC=RTNREG;                                             0546 01079000
         LR    TESTRC,RTNREG                                       0546 01080000
*       RESPECIFY                                                  0547 01081000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 01082000
*       IF TESTRC^=0 THEN                                          0548 01083000
         LTR   TESTRC,TESTRC                                       0548 01084000
         BZ    @RF00548                                            0548 01085000
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/ 01086000
         LA    OPENCODE,12                                         0549 01087000
*       WORKVOL2=VOLAREA(1);        /*                       @Z40LB65*/ 01088000
@RF00548 MVC   WORKVOL2(6),VOLAREA                                 0550 01089000
*     END;                          /*                       @Z40LB65*/ 01090000
*                                                                  0551 01091000
*   /*****************************************************************/ 01092000
*   /*                                                               */ 01093000
*   /* IF OPENCODE = 0 THEN ISSUE UMSSUNIT MACRO TO CHECK    @Z40LB65*/ 01094000
*   /* THE WORK DATA SET FOR BEING ON A MASS STORAGE VOLUME. PRIOR TO*/ 01095000
*   /* ISSUING THE MACRO TEST IF THE DATA SET WAS ALLOCATED          */ 01096000
*   /* DYNAMICALLY. IF YES, PLACE THE VOLSER IN THE CKAGL PARM LIST  */ 01097000
*   /* SO THAT IF AN ERROR OCCURS THE VOLSER WILL BE USED INSTEAD OF */ 01098000
*   /* THE DDNAME                                            @Z40LB65*/ 01099000
*   /*                                                               */ 01100000
*   /*****************************************************************/ 01101000
*                                                                  0552 01102000
*   IF OPENCODE=LASTCC00 THEN                                      0552 01103000
@RF00541 SLR   @09,@09                                             0552 01104000
         CR    OPENCODE,@09                                        0552 01105000
         BNE   @RF00552                                            0552 01106000
*     DO;                           /*                       @Z40LB65*/ 01107000
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Z40LB65*/ 01108000
         LA    @15,UCBPTR                                          0554 01109000
         ST    @15,CKUCBPTR(,CKPTR)                                0554 01110000
*       CKDDNAME=DDNAME2;           /*                       @Z40LB65*/ 01111000
         MVC   CKDDNAME(8,CKPTR),DDNAME2                           0555 01112000
*       CKTESTVT=ON;                /*                       @Z40LB65*/ 01113000
         OI    CKTESTVT(CKPTR),B'10000000'                         0556 01114000
*       IF ADDR(WDS2)^=NULLPTR THEN                                0557 01115000
         L     @15,@PC00001+4                                      0557 01116000
         C     @09,FDTPTR+20(,@15)                                 0557 01117000
         BE    @RF00557                                            0557 01118000
*         CKLABELP=ADDR(WORKVOL2);  /*                       @Z40LB65*/ 01119000
         LA    @09,WORKVOL2                                        0558 01120000
         ST    @09,CKLABELP(,CKPTR)                                0558 01121000
*       ELSE                                                       0559 01122000
*         CKLABELP=''B;             /*                       @Z40LB65*/ 01123000
         B     @RC00557                                            0559 01124000
@RF00557 SLR   @09,@09                                             0559 01125000
         ST    @09,CKLABELP(,CKPTR)                                0559 01126000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB65*/ 01127000
@RC00557 L     @09,@PC00001                                        0560 01128000
         ST    @09,@AL00001                                        0560 01129000
         LA    @02,CHECK                                           0560 01130000
         ST    @02,@AL00001+4                                      0560 01131000
         ST    CKPTR,@AL00001+8                                    0560 01132000
         MVI   @AL00001+8,X'80'                                    0560 01133000
         L     @15,GDTUNT(,@09)                                    0560 01134000
         LA    @01,@AL00001                                        0560 01135000
         BALR  @14,@15                                             0560 01136000
*       RESPECIFY                                                  0561 01137000
*         RTNREG RSTD;                                             0561 01138000
*       TESTRC=RTNREG;                                             0562 01139000
         LR    TESTRC,RTNREG                                       0562 01140000
*       RESPECIFY                                                  0563 01141000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 01142000
*       IF TESTRC^=0 THEN                                          0564 01143000
         LTR   TESTRC,TESTRC                                       0564 01144000
         BZ    @RF00564                                            0564 01145000
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/ 01146000
         LA    OPENCODE,12                                         0565 01147000
*     END;                          /*                       @Z40LB65*/ 01148000
*                                                                  0566 01149000
@RF00564 DS    0H                                                  0567 01150000
*   /*****************************************************************/ 01151000
*   /*                                                               */ 01152000
*   /* IF OPENCODE = 0 THEN ISSUE THE UEXCP MACRO TO OPEN    @Z40LB65*/ 01153000
*   /* WORKDATASET2. UPON RETURN FROM SUCCESSFUL OPEN OF THE DATA SET*/ 01154000
*   /* THE BEGINNING AND ENDING ADDRESS MUST BE ON A CYLINDER        */ 01155000
*   /* BOUNDARY. IF NOT, THE BEG CYLINDER ADDR IS ROUNDED UP AND THE */ 01156000
*   /* END CYL IS ROUNDED DOWN.                              @Z40LB65*/ 01157000
*   /*                                                               */ 01158000
*   /*****************************************************************/ 01159000
*                                                                  0567 01160000
*   IF OPENCODE=LASTCC00 THEN                                      0567 01161000
@RF00552 LTR   OPENCODE,OPENCODE                                   0567 01162000
         BNZ   @RF00567                                            0567 01163000
*     DO;                           /*                       @Z40LB65*/ 01164000
*       EXODDN=ADDR(DDNAME2);       /*                       @Z40LB65*/ 01165000
         LA    @09,DDNAME2                                         0569 01166000
         ST    @09,EXODDN(,EXOPTR)                                 0569 01167000
*       EXOEXT=ADDR(EXTCHRS2);      /*                       @Z40LB65*/ 01168000
         LA    @09,EXTCHRS2                                        0570 01169000
         ST    @09,EXOEXT(,EXOPTR)                                 0570 01170000
*       EXOCTLBK=ADDR(WORKPTR2);    /*                       @Z40LB65*/ 01171000
         LA    @09,WORKPTR2                                        0571 01172000
         ST    @09,EXOCTLBK(,EXOPTR)                               0571 01173000
*       EXOTAB=ON;                  /*                       @Z40LB65*/ 01174000
         OI    EXOTAB(EXOPTR),B'10000000'                          0572 01175000
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                 @Z40LB65*/ 01176000
         L     @09,@PC00001                                        0573 01177000
         ST    @09,@AL00001                                        0573 01178000
         LA    @05,OPEN                                            0573 01179000
         ST    @05,@AL00001+4                                      0573 01180000
         ST    EXOPTR,@AL00001+8                                   0573 01181000
         MVI   @AL00001+8,X'80'                                    0573 01182000
         L     @15,GDTEXP(,@09)                                    0573 01183000
         LA    @01,@AL00001                                        0573 01184000
         BALR  @14,@15                                             0573 01185000
*       RESPECIFY                                                  0574 01186000
*         RTNREG RSTD;                                             0574 01187000
*       TESTRC=RTNREG;                                             0575 01188000
         LR    TESTRC,RTNREG                                       0575 01189000
*       RESPECIFY                                                  0576 01190000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 01191000
*       IF TESTRC=0 THEN                                           0577 01192000
         LTR   TESTRC,TESTRC                                       0577 01193000
         BNZ   @RF00577                                            0577 01194000
*         DO;                       /*                       @Z40LB65*/ 01195000
*           IF STRK2^=NULL THEN                                    0579 01196000
         CLC   STRK2(2),NULL                                       0579 01197000
         BE    @RF00579                                            0579 01198000
*             SCYL2=SCYL2+1;        /*                       @Z40LB65*/ 01199000
         LA    @09,1                                               0580 01200000
         LH    @06,SCYL2                                           0580 01201000
         N     @06,@CF01444                                        0580 01202000
         ALR   @09,@06                                             0580 01203000
         STH   @09,SCYL2                                           0580 01204000
*           IF ETRK2^=NULL THEN                                    0581 01205000
@RF00579 CLC   ETRK2(2),NULL                                       0581 01206000
         BE    @RF00581                                            0581 01207000
*             ECYL2=ECYL2-1;        /*                       @Z40LB65*/ 01208000
         SLR   @09,@09                                             0582 01209000
         ICM   @09,3,ECYL2                                         0582 01210000
         BCTR  @09,0                                               0582 01211000
         STCM  @09,3,ECYL2                                         0582 01212000
*         END;                      /*                       @Z40LB65*/ 01213000
*       ELSE                                                       0584 01214000
*         OPENCODE=LASTCC12;        /*                       @Z40LB65*/ 01215000
         B     @RC00577                                            0584 01216000
@RF00577 LA    OPENCODE,12                                         0584 01217000
*     END;                          /*                       @Z40LB65*/ 01218000
@RC00577 DS    0H                                                  0586 01219000
*   RETURN CODE(OPENCODE);          /*                       @Z40LB65*/ 01220000
@RF00567 LR    @15,OPENCODE                                        0586 01221000
         L     @13,4(,@13)                                         0586 01222000
         L     @14,12(,@13)                                        0586 01223000
         LM    @00,@12,20(@13)                                     0586 01224000
         BR    @14                                                 0586 01225000
*   END OPENPROC;                   /*                       @Z40LB65*/ 01226000
*                                                                  0588 01227000
*/********************************************************************/ 01228000
*/*                                                          @Z40LB65*/ 01229000
*/*     PROCEDURE NAME - COPYPROC                            @Z40LB65*/ 01230000
*/*                                                          @Z40LB65*/ 01231000
*/*     FUNCTION - THIS ROUTINE BINDS THE SPACE OF THE WORK  @Z40LB65*/ 01232000
*/*                DATA SETS AND COPIES THE PRIMARY AND      @Z40LB65*/ 01233000
*/*                SECONDARY MSC TABLES TO THEM.             @Z40LB65*/ 01234000
*/*                                                          @Z40LB65*/ 01235000
*/*     INPUT - FDTTBL AND WORK AREA CALLED INTTBL           @Z40LB65*/ 01236000
*/*                                                          @Z40LB65*/ 01237000
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Z40LB65*/ 01238000
*/*              0 = SUCCESSFUL COMPLETION                   @Z40LB65*/ 01239000
*/*              12 = UNSUCCESSFUL COMPLETION                @Z40LB65*/ 01240000
*/*                                                          @Z40LB65*/ 01241000
*/********************************************************************/ 01242000
*                                                                  0588 01243000
*COPYPROC:                                                         0588 01244000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 01245000
*                                                                  0588 01246000
COPYPROC STM   @14,@12,12(@13)                                     0588 01247000
         ST    @13,@SA00003+4                                      0588 01248000
         LA    @14,@SA00003                                        0588 01249000
         ST    @14,8(,@13)                                         0588 01250000
         LR    @13,@14                                             0588 01251000
*   /*****************************************************************/ 01252000
*   /*                                                               */ 01253000
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/ 01254000
*   /*                                                               */ 01255000
*   /*****************************************************************/ 01256000
*                                                                  0589 01257000
*   DCL                                                            0589 01258000
*     COPYCODE FIXED(15);           /* COPYPROC RETURN CODE  @Z40LB65*/ 01259000
*   DCL                                                            0590 01260000
*     ECBCODE CHAR(1);              /* ECB CODE FROM USSC    @Z40LB65*/ 01261000
*   DCL                                                            0591 01262000
*     ECBLEN FIXED(31) CONSTANT(4); /* LENGTH OF ECB         @Z40LB65*/ 01263000
*                                                                  0591 01264000
*   /*****************************************************************/ 01265000
*   /*                                                               */ 01266000
*   /* DECLARE INDEXES FOR THE TABLE ENTRIES IN THE          @Z40LB65*/ 01267000
*   /* MESSAGE RETURNED FROM USSC.                           @Z40LB65*/ 01268000
*   /*                                                               */ 01269000
*   /*****************************************************************/ 01270000
*                                                                  0592 01271000
*   DCL                                                            0592 01272000
*     SDGINDEX FIXED(8) CONSTANT(1);/* SDG INDEX             @Z40LB65*/ 01273000
*   DCL                                                            0593 01274000
*     VVAINDEX FIXED(8) CONSTANT(10);/* VVA INDEX            @Z40LB65*/ 01275000
*   DCL                                                            0594 01276000
*     DOINDEX FIXED(8) CONSTANT(13);/* DIAG/OVLY INDEX       @Z40LB65*/ 01277000
*   DCL                                                            0595 01278000
*     HEX0 CHAR(2) STATIC INIT('0000'X);/* ARCOMPC CODE      @ZA14727*/ 01279000
*   OLDERID2=NEWERID2;                                             0596 01280000
         L     @05,@PC00001                                        0596 01281000
         L     @15,GDTTR2(,@05)                                    0596 01282000
         MVC   @TS00001(95),NEWERID2(@15)                          0596 01283000
         MVC   OLDERID2(95,@15),@TS00001                           0596 01284000
*   NEWID2='CPCA';                  /*                       @Z40LB65*/ 01285000
         MVC   NEWID2(4,@15),@CC01328                              0597 01286000
*   COPYCODE=''B;                   /*                       @Z40LB65*/ 01287000
*                                                                  0598 01288000
         SLR   COPYCODE,COPYCODE                                   0598 01289000
*   /*****************************************************************/ 01290000
*   /*                                                               */ 01291000
*   /* ISSUE THE USSC MACRO WITH THE ACQUIRE OPTION TO BIND  @Z40LB65*/ 01292000
*   /* THE WDS1 & WDS2 SPACE BY SPECIFYING THE BIND OPTION.  @Z40LB65*/ 01293000
*   /*                                                               */ 01294000
*   /*****************************************************************/ 01295000
*                                                                  0599 01296000
*   ARLL=LENGTH(ACQLIST);           /*                       @Z40LB65*/ 01297000
         L     @15,ACQPTR                                          0599 01298000
         MVC   ARLL(4,@15),@CF01205                                0599 01299000
*   AROP=2;                         /*                       @Z40LB65*/ 01300000
         MVI   AROP(@15),X'02'                                     0600 01301000
*   ARBDUBD=ON;                     /*                       @Z40LB65*/ 01302000
*   ARINH=ON;                       /*                       @Z40LB65*/ 01303000
         OI    ARBDUBD(@15),B'10100000'                            0602 01304000
*   ARNMEXT=1;                      /*                       @Z40LB65*/ 01305000
         MVI   ARNMEXT(@15),X'01'                                  0603 01306000
*   ARVOL=WORKVOL2;                 /*                       @Z40LB65*/ 01307000
         MVC   ARVOL(6,@15),WORKVOL2                               0604 01308000
*   AREXT(1,1:2)=SCYL2;             /*                       @Z40LB65*/ 01309000
         MVC   AREXT(2,@15),SCYL2                                  0605 01310000
*   AREXT(1,3:4)=ECYL2;             /*                       @Z40LB65*/ 01311000
*                                                                  0606 01312000
         MVC   AREXT+2(2,@15),ECYL2                                0606 01313000
*   /*****************************************************************/ 01314000
*   /*                                                               */ 01315000
*   /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        @Z40LB65*/ 01316000
*   /* USSC PARM LIST FOR WDS2 ACQUIRE                       @Z40LB65*/ 01317000
*   /*                                                               */ 01318000
*   /*****************************************************************/ 01319000
*                                                                  0607 01320000
*   IF GDTDBG=NULLPTR THEN                                         0607 01321000
         L     @05,GDTDBG(,@05)                                    0607 01322000
         LTR   @05,@05                                             0607 01323000
         BZ    @RT00607                                            0607 01324000
*     ;                                                            0608 01325000
*   ELSE                                                           0609 01326000
*     DO;                                                          0609 01327000
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Z40LB65*/ 01328000
         LA    DMPINDEX,DMPSTG                                     0610 01329000
*       DMPITMNM='ACQLST2';                                        0611 01330000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0611 01331000
         MVC   DMPITMNM(7,DMPINDEX),@CC01329                       0611 01332000
*       DMPITMPT=ADDR(ACQLST2);                                    0612 01333000
         LA    @05,ACQLST2                                         0612 01334000
         ST    @05,DMPITMPT(,DMPINDEX)                             0612 01335000
*       DMPITMLN=LENGTH(ACQLIST);                                  0613 01336000
         MVC   DMPITMLN(2,DMPINDEX),@CH01205                       0613 01337000
*       DMPITMTP='H';                                              0614 01338000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0614 01339000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Z40LB65*/ 01340000
         AL    DMPINDEX,@CF00473                                   0615 01341000
*       DMPTRM=DMPTRMVL;                                           0616 01342000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0616 01343000
*     END;                          /*                       @Z40LB65*/ 01344000
*   IF GDTDBG=NULLPTR THEN                                         0618 01345000
@RT00607 L     @05,@PC00001                                        0618 01346000
         L     @05,GDTDBG(,@05)                                    0618 01347000
         LTR   @05,@05                                             0618 01348000
         BZ    @RT00618                                            0618 01349000
*     ;                                                            0619 01350000
*   ELSE                                                           0620 01351000
*     CALL IDCDB010(GDTTBL,'CPCB',ADDR(DMPSTG));/*           @Z40LB65*/ 01352000
         L     @05,@PC00001                                        0620 01353000
         ST    @05,@AL00001                                        0620 01354000
         LA    @15,@CC01331                                        0620 01355000
         ST    @15,@AL00001+4                                      0620 01356000
         LA    @15,DMPSTG                                          0620 01357000
         ST    @15,@AFTEMPS                                        0620 01358000
         LA    @15,@AFTEMPS                                        0620 01359000
         ST    @15,@AL00001+8                                      0620 01360000
         MVI   @AL00001+8,X'80'                                    0620 01361000
         L     @15,GDTDBG(,@05)                                    0620 01362000
         LA    @01,@AL00001                                        0620 01363000
         BALR  @14,@15                                             0620 01364000
*   ACQPTR=ADDR(ACQLST1);           /*                       @Z40LB65*/ 01365000
@RT00618 LA    @05,ACQLST1                                         0621 01366000
         ST    @05,ACQPTR                                          0621 01367000
*   ARLL=LENGTH(ACQLIST);           /*                       @Z40LB65*/ 01368000
         MVC   ARLL(4,@05),@CF01205                                0622 01369000
*   AROP=2;                         /*                       @Z40LB65*/ 01370000
         MVI   AROP(@05),X'02'                                     0623 01371000
*   ARBDUBD=ON;                     /*                       @Z40LB65*/ 01372000
*   ARINH=ON;                       /*                       @Z40LB65*/ 01373000
         OI    ARBDUBD(@05),B'10100000'                            0625 01374000
*   ARNMEXT=1;                      /*                       @Z40LB65*/ 01375000
         MVI   ARNMEXT(@05),X'01'                                  0626 01376000
*   ARVOL=WORKVOL1;                 /*                       @Z40LB65*/ 01377000
         MVC   ARVOL(6,@05),WORKVOL1                               0627 01378000
*   AREXT(1,1:2)=SCYL1;             /*                       @Z40LB65*/ 01379000
         MVC   AREXT(2,@05),SCYL1                                  0628 01380000
*   AREXT(1,3:4)=ECYL1;             /*                       @Z40LB65*/ 01381000
         MVC   AREXT+2(2,@05),ECYL1                                0629 01382000
*   ARNEDB=ADDR(ACQLST2);           /*                       @Z40LB65*/ 01383000
*                                                                  0630 01384000
         LA    @15,ACQLST2                                         0630 01385000
         ST    @15,ARNEDB(,@05)                                    0630 01386000
*   /*****************************************************************/ 01387000
*   /*                                                               */ 01388000
*   /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        @Z40LB65*/ 01389000
*   /* USSC PARM LIST FOR WDS1 ACQUIRE                       @Z40LB65*/ 01390000
*   /*                                                               */ 01391000
*   /*****************************************************************/ 01392000
*                                                                  0631 01393000
*   IF GDTDBG=NULLPTR THEN                                         0631 01394000
         L     @05,@PC00001                                        0631 01395000
         L     @05,GDTDBG(,@05)                                    0631 01396000
         LTR   @05,@05                                             0631 01397000
         BZ    @RT00631                                            0631 01398000
*     ;                                                            0632 01399000
*   ELSE                                                           0633 01400000
*     DO;                                                          0633 01401000
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Z40LB65*/ 01402000
         LA    DMPINDEX,DMPSTG                                     0634 01403000
*       DMPITMNM='ACQLST1';                                        0635 01404000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0635 01405000
         MVC   DMPITMNM(7,DMPINDEX),@CC01332                       0635 01406000
*       DMPITMPT=ADDR(ACQLST1);                                    0636 01407000
         LA    @05,ACQLST1                                         0636 01408000
         ST    @05,DMPITMPT(,DMPINDEX)                             0636 01409000
*       DMPITMLN=LENGTH(ACQLIST);                                  0637 01410000
         MVC   DMPITMLN(2,DMPINDEX),@CH01205                       0637 01411000
*       DMPITMTP='H';                                              0638 01412000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0638 01413000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Z40LB65*/ 01414000
         AL    DMPINDEX,@CF00473                                   0639 01415000
*       DMPTRM=DMPTRMVL;                                           0640 01416000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0640 01417000
*     END;                          /*                       @Z40LB65*/ 01418000
*   IF GDTDBG=NULLPTR THEN                                         0642 01419000
@RT00631 L     @05,@PC00001                                        0642 01420000
         L     @05,GDTDBG(,@05)                                    0642 01421000
         LTR   @05,@05                                             0642 01422000
         BZ    @RT00642                                            0642 01423000
*     ;                                                            0643 01424000
*   ELSE                                                           0644 01425000
*     CALL IDCDB010(GDTTBL,'CPCC',ADDR(DMPSTG));/*           @Z40LB65*/ 01426000
         L     @05,@PC00001                                        0644 01427000
         ST    @05,@AL00001                                        0644 01428000
         LA    @15,@CC01333                                        0644 01429000
         ST    @15,@AL00001+4                                      0644 01430000
         LA    @15,DMPSTG                                          0644 01431000
         ST    @15,@AFTEMPS                                        0644 01432000
         LA    @15,@AFTEMPS                                        0644 01433000
         ST    @15,@AL00001+8                                      0644 01434000
         MVI   @AL00001+8,X'80'                                    0644 01435000
         L     @15,GDTDBG(,@05)                                    0644 01436000
         LA    @01,@AL00001                                        0644 01437000
         BALR  @14,@15                                             0644 01438000
*   CALL IDCSASS0(GDTTBL,ACQUIRE,ACQPTR,REASONCD);/*         @Z40LB65*/ 01439000
@RT00642 L     @05,@PC00001                                        0645 01440000
         ST    @05,@AL00001                                        0645 01441000
         LA    @02,ACQUIRE                                         0645 01442000
         ST    @02,@AL00001+4                                      0645 01443000
         LA    @02,ACQPTR                                          0645 01444000
         ST    @02,@AL00001+8                                      0645 01445000
         LA    @02,REASONCD                                        0645 01446000
         ST    @02,@AL00001+12                                     0645 01447000
         MVI   @AL00001+12,X'80'                                   0645 01448000
         L     @15,GDTSSC(,@05)                                    0645 01449000
         LA    @01,@AL00001                                        0645 01450000
         BALR  @14,@15                                             0645 01451000
*   RESPECIFY                                                      0646 01452000
*     RTNREG RSTD;                                                 0646 01453000
*   TESTRC=RTNREG;                                                 0647 01454000
         LR    TESTRC,RTNREG                                       0647 01455000
*   RESPECIFY                                                      0648 01456000
*     RTNREG UNRSTD;                /*                       @Z40LB65*/ 01457000
*   IF TESTRC=4 THEN                                               0649 01458000
         C     TESTRC,@CF00041                                     0649 01459000
         BNE   @RF00649                                            0649 01460000
*     DO;                           /*                       @Z40LB65*/ 01461000
*                                                                  0650 01462000
*       /*************************************************************/ 01463000
*       /*                                                           */ 01464000
*       /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE         @Z40LB65*/ 01465000
*       /* REASON WHY A NON-ZERO REASON CODE WAS RETURNED.   @Z40LB65*/ 01466000
*       /*                                                           */ 01467000
*       /*************************************************************/ 01468000
*                                                                  0651 01469000
*       CALL SSCMSG(REASONCD);      /*                       @Z40LB65*/ 01470000
         LA    @15,REASONCD                                        0651 01471000
         ST    @15,@AL00001                                        0651 01472000
         LA    @01,@AL00001                                        0651 01473000
         BAL   @14,SSCMSG                                          0651 01474000
*       COPYCODE=LASTCC12;          /*                       @Z40LB65*/ 01475000
*                                                                  0652 01476000
         LA    COPYCODE,12                                         0652 01477000
*       /*************************************************************/ 01478000
*       /*                                                           */ 01479000
*       /* NEXT WE CHECK WHICH (OR BOTH) ACQUIRES FAILED. WE WILL    */ 01480000
*       /* NEED TO DO RELINQUISHES TO UNBIND SPACE LATER.    @ZA14727*/ 01481000
*       /*                                                           */ 01482000
*       /*************************************************************/ 01483000
*                                                                  0653 01484000
*       ACQPTR=ADDR(ACQLST2);       /*                       @ZA14727*/ 01485000
         LA    @05,ACQLST2                                         0653 01486000
         ST    @05,ACQPTR                                          0653 01487000
*       IF ARCOMPC=HEX0 THEN        /*                       @ZA14727*/ 01488000
         CLC   ARCOMPC(2,@05),HEX0                                 0654 01489000
         BNE   @RF00654                                            0654 01490000
*         ACQSW2=ON;                /*                       @ZA14727*/ 01491000
         OI    ACQSW2,B'00001000'                                  0655 01492000
*       ACQPTR=ADDR(ACQLST1);       /*                       @ZA14727*/ 01493000
@RF00654 LA    @05,ACQLST1                                         0656 01494000
         ST    @05,ACQPTR                                          0656 01495000
*       IF ARCOMPC=HEX0 THEN        /*                       @ZA14727*/ 01496000
         CLC   ARCOMPC(2,@05),HEX0                                 0657 01497000
         BNE   @RF00657                                            0657 01498000
*         ACQSW1=ON;                /*                       @ZA14727*/ 01499000
         OI    ACQSW1,B'00010000'                                  0658 01500000
*     END;                          /*                       @X50AC65*/ 01501000
*                                                                  0659 01502000
@RF00657 DS    0H                                                  0660 01503000
*   /*****************************************************************/ 01504000
*   /*                                                               */ 01505000
*   /* IF COPYCODE = 0 INITIALIZE THE COTBLIST PARM LIST     @Z40LB65*/ 01506000
*   /* FOR THE COPYTABL ORDER OF THE USSC MACRO FOR WDS1.    @Z40LB65*/ 01507000
*   /*                                                               */ 01508000
*   /*****************************************************************/ 01509000
*                                                                  0660 01510000
*   IF COPYCODE=LASTCC00 THEN                                      0660 01511000
@RF00649 SLR   @05,@05                                             0660 01512000
         CR    COPYCODE,@05                                        0660 01513000
         BNE   @RF00660                                            0660 01514000
*     DO;                           /*                       @Z40LB65*/ 01515000
*       ACQSW1=ON;                  /*                       @ZA14727*/ 01516000
*       ACQSW2=ON;                  /*                       @ZA14727*/ 01517000
         OI    ACQSW1,B'00011000'                                  0663 01518000
*       DCOTBTID=COPYPRIM;          /*                       @Z40LB65*/ 01519000
         MVC   DCOTBTID(1),COPYPRIM                                0664 01520000
*       COTBEXTS(1:2)=SCYL1;        /*                       @Z40LB65*/ 01521000
         MVC   COTBEXTS(2),SCYL1                                   0665 01522000
*       COTBEXTS(3:4)=ECYL1;        /*                       @Z40LB65*/ 01523000
         MVC   COTBEXTS+2(2),ECYL1                                 0666 01524000
*       COTBVOL=WORKVOL1;           /*                       @Z40LB65*/ 01525000
*                                                                  0667 01526000
         MVC   COTBVOL(6),WORKVOL1                                 0667 01527000
*       /*************************************************************/ 01528000
*       /*                                                           */ 01529000
*       /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF    @Z40LB65*/ 01530000
*       /* USSC PARM LIST                                    @Z40LB65*/ 01531000
*       /*                                                           */ 01532000
*       /*************************************************************/ 01533000
*                                                                  0668 01534000
*       IF GDTDBG=NULLPTR THEN                                     0668 01535000
         L     @15,@PC00001                                        0668 01536000
         C     @05,GDTDBG(,@15)                                    0668 01537000
         BE    @RT00668                                            0668 01538000
*         ;                                                        0669 01539000
*       ELSE                                                       0670 01540000
*         DO;                                                      0670 01541000
*           DMPINDEX=ADDR(DMPSTG);  /*                       @Z40LB65*/ 01542000
         LA    DMPINDEX,DMPSTG                                     0671 01543000
*           DMPITMNM='COTBLIST';                                   0672 01544000
         MVC   DMPITMNM(8,DMPINDEX),@CC01334                       0672 01545000
*           DMPITMPT=ADDR(COTBLIST);                               0673 01546000
         LA    @05,COTBLIST                                        0673 01547000
         ST    @05,DMPITMPT(,DMPINDEX)                             0673 01548000
*           DMPITMLN=LENGTH(COTBLIST);                             0674 01549000
         MVC   DMPITMLN(2,DMPINDEX),@CH00309                       0674 01550000
*           DMPITMTP='H';                                          0675 01551000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0675 01552000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0676 01553000
         AL    DMPINDEX,@CF00473                                   0676 01554000
*           DMPTRM=DMPTRMVL;                                       0677 01555000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0677 01556000
*         END;                      /*                       @Z40LB65*/ 01557000
*       IF GDTDBG=NULLPTR THEN                                     0679 01558000
@RT00668 L     @05,@PC00001                                        0679 01559000
         L     @05,GDTDBG(,@05)                                    0679 01560000
         LTR   @05,@05                                             0679 01561000
         BZ    @RT00679                                            0679 01562000
*         ;                                                        0680 01563000
*       ELSE                                                       0681 01564000
*         CALL IDCDB010(GDTTBL,'CPCD',ADDR(DMPSTG));/*       @Z40LB65*/ 01565000
*                                                                  0681 01566000
         L     @05,@PC00001                                        0681 01567000
         ST    @05,@AL00001                                        0681 01568000
         LA    @15,@CC01335                                        0681 01569000
         ST    @15,@AL00001+4                                      0681 01570000
         LA    @15,DMPSTG                                          0681 01571000
         ST    @15,@AFTEMPS                                        0681 01572000
         LA    @15,@AFTEMPS                                        0681 01573000
         ST    @15,@AL00001+8                                      0681 01574000
         MVI   @AL00001+8,X'80'                                    0681 01575000
         L     @15,GDTDBG(,@05)                                    0681 01576000
         LA    @01,@AL00001                                        0681 01577000
         BALR  @14,@15                                             0681 01578000
*       /*************************************************************/ 01579000
*       /*                                                           */ 01580000
*       /* ISSUE THE COPY TABLE OPTION OF THE USSC MACRO TO  @Z40LB65*/ 01581000
*       /* COPY THE PRIMARY MSC TABLES TO WDS1.              @Z40LB65*/ 01582000
*       /*                                                           */ 01583000
*       /*************************************************************/ 01584000
*                                                                  0682 01585000
*       CALL IDCSASS0(GDTTBL,COPYTABL,COTPTR,REASONCD,ECBCODE,CTMSGPTR) 01586000
*           ;                                                      0682 01587000
@RT00679 L     @05,@PC00001                                        0682 01588000
         ST    @05,@AL00001                                        0682 01589000
         LA    @02,COPYTABL                                        0682 01590000
         ST    @02,@AL00001+4                                      0682 01591000
         LA    @02,COTPTR                                          0682 01592000
         ST    @02,@AL00001+8                                      0682 01593000
         LA    @02,REASONCD                                        0682 01594000
         ST    @02,@AL00001+12                                     0682 01595000
         LA    @02,ECBCODE                                         0682 01596000
         ST    @02,@AL00001+16                                     0682 01597000
         LA    @02,CTMSGPTR                                        0682 01598000
         ST    @02,@AL00001+20                                     0682 01599000
         MVI   @AL00001+20,X'80'                                   0682 01600000
         L     @15,GDTSSC(,@05)                                    0682 01601000
         LA    @01,@AL00001                                        0682 01602000
         BALR  @14,@15                                             0682 01603000
*       RESPECIFY                                                  0683 01604000
*         RTNREG RSTD;                                             0683 01605000
*       TESTRC=RTNREG;                                             0684 01606000
         LR    TESTRC,RTNREG                                       0684 01607000
*       RESPECIFY                                                  0685 01608000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 01609000
*                                                                  0685 01610000
*       /*************************************************************/ 01611000
*       /*                                                           */ 01612000
*       /* TEST THE RETURN CODE FROM USSC. IF THE RETURN     @Z40LB65*/ 01613000
*       /* CODE IS 04 CALL SSCMSG TO PRINT OUT MESSAGE TO EXPLAIN THE*/ 01614000
*       /* ERROR. IF THE RETURN CODE IS 04 OR 08 ISSUE THE UPRINT    */ 01615000
*       /* MACRO TO PRINT MESSAGE IDC31180I INDICATING THE TABLES    */ 01616000
*       /* COULD NOT BE COPIED.                              @Z40LB65*/ 01617000
*       /*                                                           */ 01618000
*       /*************************************************************/ 01619000
*                                                                  0686 01620000
*       IF TESTRC=4 THEN                                           0686 01621000
         C     TESTRC,@CF00041                                     0686 01622000
         BNE   @RF00686                                            0686 01623000
*         CALL SSCMSG(REASONCD,ECBCODE);/*                   @Z40LB65*/ 01624000
         LA    @05,REASONCD                                        0687 01625000
         ST    @05,@AL00001                                        0687 01626000
         LA    @05,ECBCODE                                         0687 01627000
         ST    @05,@AL00001+4                                      0687 01628000
         LA    @01,@AL00001                                        0687 01629000
         BAL   @14,SSCMSG                                          0687 01630000
*       IF TESTRC=4|TESTRC=8 THEN                                  0688 01631000
@RF00686 C     TESTRC,@CF00041                                     0688 01632000
         BE    @RT00688                                            0688 01633000
         C     TESTRC,@CF00178                                     0688 01634000
         BNE   @RF00688                                            0688 01635000
@RT00688 DS    0H                                                  0689 01636000
*         DO;                       /*                       @Z40LB65*/ 01637000
*           COPYCODE=LASTCC12;      /*                       @Z40LB65*/ 01638000
         LA    COPYCODE,12                                         0690 01639000
*           DARGSENT=MSG31180;      /*                       @Z40LB65*/ 01640000
         L     @05,DDSTRU                                          0691 01641000
         MVI   DARGSENT(@05),X'01'                                 0691 01642000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB65*/ 01643000
         L     @05,@PC00001                                        0692 01644000
         ST    @05,@AL00001                                        0692 01645000
         LA    @15,@CF00114                                        0692 01646000
         ST    @15,@AL00001+4                                      0692 01647000
         LA    @15,DDSTRU                                          0692 01648000
         ST    @15,@AL00001+8                                      0692 01649000
         MVI   @AL00001+8,X'80'                                    0692 01650000
         L     @15,GDTPRT(,@05)                                    0692 01651000
         LA    @01,@AL00001                                        0692 01652000
         BALR  @14,@15                                             0692 01653000
*         END;                      /*                       @Z40LB65*/ 01654000
*       ELSE                                                       0694 01655000
*         DO;                       /*                       @Z40LB65*/ 01656000
*                                                                  0694 01657000
         B     @RC00688                                            0694 01658000
@RF00688 DS    0H                                                  0695 01659000
*           /*********************************************************/ 01660000
*           /*                                                       */ 01661000
*           /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        */ 01662000
*           /*                                               @Z40LB65*/ 01663000
*           /* THE RETURNED MESSAGE AREA                     @Z40LB65*/ 01664000
*           /*                                                       */ 01665000
*           /*********************************************************/ 01666000
*                                                                  0695 01667000
*           IF GDTDBG=NULLPTR THEN                                 0695 01668000
         L     @05,@PC00001                                        0695 01669000
         L     @05,GDTDBG(,@05)                                    0695 01670000
         LTR   @05,@05                                             0695 01671000
         BZ    @RT00695                                            0695 01672000
*             ;                                                    0696 01673000
*           ELSE                                                   0697 01674000
*             DO;                                                  0697 01675000
*               DMPINDEX=ADDR(DMPSTG);/*                     @Z40LB65*/ 01676000
         LA    DMPINDEX,DMPSTG                                     0698 01677000
*               DMPITMNM='CTMSG';                                  0699 01678000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0699 01679000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0699 01680000
         MVC   DMPITMNM(5,DMPINDEX),@CC01336                       0699 01681000
*               DMPITMPT=ADDR(CTMSG);                              0700 01682000
         L     @05,CTMSGPTR                                        0700 01683000
         ST    @05,DMPITMPT(,DMPINDEX)                             0700 01684000
*               DMPITMLN=LENGTH(CTMSG)+4;                          0701 01685000
         MVC   DMPITMLN(2,DMPINDEX),@CH01208                       0701 01686000
*               DMPITMTP='H';                                      0702 01687000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0702 01688000
*               DMPINDEX=DMPINDEX+DMPELEMT;                        0703 01689000
         AL    DMPINDEX,@CF00473                                   0703 01690000
*               DMPTRM=DMPTRMVL;                                   0704 01691000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0704 01692000
*             END;                  /*                       @Z40LB65*/ 01693000
*           IF GDTDBG=NULLPTR THEN                                 0706 01694000
@RT00695 L     @05,@PC00001                                        0706 01695000
         L     @05,GDTDBG(,@05)                                    0706 01696000
         LTR   @05,@05                                             0706 01697000
         BZ    @RT00706                                            0706 01698000
*             ;                                                    0707 01699000
*           ELSE                                                   0708 01700000
*             CALL IDCDB010(GDTTBL,'CPCE',ADDR(DMPSTG));/*   @Z40LB65*/ 01701000
         L     @05,@PC00001                                        0708 01702000
         ST    @05,@AL00001                                        0708 01703000
         LA    @15,@CC01337                                        0708 01704000
         ST    @15,@AL00001+4                                      0708 01705000
         LA    @15,DMPSTG                                          0708 01706000
         ST    @15,@AFTEMPS                                        0708 01707000
         LA    @15,@AFTEMPS                                        0708 01708000
         ST    @15,@AL00001+8                                      0708 01709000
         MVI   @AL00001+8,X'80'                                    0708 01710000
         L     @15,GDTDBG(,@05)                                    0708 01711000
         LA    @01,@AL00001                                        0708 01712000
         BALR  @14,@15                                             0708 01713000
*         END;                      /*                       @Z40LB65*/ 01714000
@RT00706 DS    0H                                                  0710 01715000
*     END;                          /*                       @Z40LB65*/ 01716000
*                                                                  0710 01717000
@RC00688 DS    0H                                                  0711 01718000
*   /*****************************************************************/ 01719000
*   /*                                                               */ 01720000
*   /* IF COPYCODE = 0 RETRIEVE THE NECESSARY ADDRESSES      @Z40LB65*/ 01721000
*   /* FROM THE MESSAGE AREA AND PLACE THEM IN THE           @Z40LB65*/ 01722000
*   /* INTTBL WORK AREA.                                     @Z40LB65*/ 01723000
*   /*                                                               */ 01724000
*   /*****************************************************************/ 01725000
*                                                                  0711 01726000
*   IF COPYCODE=LASTCC00 THEN                                      0711 01727000
@RF00660 LTR   COPYCODE,COPYCODE                                   0711 01728000
         BNZ   @RF00711                                            0711 01729000
*     DO;                           /*                       @Z40LB65*/ 01730000
*       CTMSGPTR=CTMSGPTR+ECBLEN;   /*                       @Z40LB65*/ 01731000
*                                                                  0713 01732000
         LA    @05,4                                               0713 01733000
         L     @15,CTMSGPTR                                        0713 01734000
         ALR   @15,@05                                             0713 01735000
         ST    @15,CTMSGPTR                                        0713 01736000
*       /*************************************************************/ 01737000
*       /*                                                           */ 01738000
*       /* RETRIEVE THE ADDRESS FOR THE SDG RECORDS          @Z40LB65*/ 01739000
*       /*                                                           */ 01740000
*       /*************************************************************/ 01741000
*                                                                  0714 01742000
*       SDGC=CTTBLCC(SDGINDEX);     /*                       @Z40LB65*/ 01743000
         SLR   @14,@14                                             0714 01744000
         IC    @14,CTTBLCC(,@15)                                   0714 01745000
         STC   @14,SDGC                                            0714 01746000
*       SDGH=CTTBLHH(SDGINDEX);     /*                       @Z40LB65*/ 01747000
         MVC   SDGH(1),CTTBLHH(@15)                                0715 01748000
*       SDGR=CTTBLRR(SDGINDEX);     /*                       @Z40LB65*/ 01749000
*                                                                  0716 01750000
         MVC   SDGR(1),CTTBLRR(@15)                                0716 01751000
*       /*************************************************************/ 01752000
*       /*                                                           */ 01753000
*       /* RETRIEVE THE ADDRESS FOR THE VVA RECORD           @Z40LB65*/ 01754000
*       /*                                                           */ 01755000
*       /*************************************************************/ 01756000
*                                                                  0717 01757000
*       VVAC=CTTBLCC(VVAINDEX);     /*                       @Z40LB65*/ 01758000
         MVC   VVAC(1),CTTBLCC+36(@15)                             0717 01759000
*       VVAH=CTTBLHH(VVAINDEX);     /*                       @Z40LB65*/ 01760000
         MVC   VVAH(1),CTTBLHH+36(@15)                             0718 01761000
*       VVAR=CTTBLRR(VVAINDEX);     /*                       @Z40LB65*/ 01762000
*                                                                  0719 01763000
         MVC   VVAR(1),CTTBLRR+36(@15)                             0719 01764000
*       /*************************************************************/ 01765000
*       /*                                                           */ 01766000
*       /* RETRIEVE THE ADDRESS FOR THE DIAG/OVLY RECORD     @Z40LB65*/ 01767000
*       /*                                                           */ 01768000
*       /*************************************************************/ 01769000
*                                                                  0720 01770000
*       DOC=CTTBLCC(DOINDEX);       /*                       @Z40LB65*/ 01771000
         MVC   DOC(1),CTTBLCC+48(@15)                              0720 01772000
*       DOH=CTTBLHH(DOINDEX);       /*                       @Z40LB65*/ 01773000
         MVC   DOH(1),CTTBLHH+48(@15)                              0721 01774000
*       DOR=CTTBLRR(DOINDEX);       /*                       @Z40LB65*/ 01775000
*                                                                  0722 01776000
         MVC   DOR(1),CTTBLRR+48(@15)                              0722 01777000
*       /*************************************************************/ 01778000
*       /*                                                           */ 01779000
*       /* COMPUTE CYLINDER DIFFERENCE (ADDRDIF1) FROM       @Z40LB65*/ 01780000
*       /* ORIGINAL VOLUME TO THE WORK DATA SET VOLUME. THIS IS DONE */ 01781000
*       /* BY SUBTRACTING THE FIRST CYLINDER VALUE OF THE FIRST ENTRY*/ 01782000
*       /* FROM THE FIELD CTREALCC.                          @Z40LB65*/ 01783000
*       /*                                                           */ 01784000
*       /*************************************************************/ 01785000
*                                                                  0723 01786000
*       ADDRDIF1=CTREALCC-SDGC;     /*                       @Z40LB65*/ 01787000
*                                                                  0723 01788000
         LCR   @14,@14                                             0723 01789000
         SLR   @09,@09                                             0723 01790000
         ICM   @09,3,CTREALCC(@15)                                 0723 01791000
         ALR   @14,@09                                             0723 01792000
         STH   @14,ADDRDIF1                                        0723 01793000
*       /*************************************************************/ 01794000
*       /*                                                           */ 01795000
*       /* RESET MESSAGE POINTER TO POINT TO THE ECB AND     @Z40LB65*/ 01796000
*       /* ISSUE UFSPACE MACRO TO FREE UP MESSAGE AREA.      @Z40LB65*/ 01797000
*       /*                                                           */ 01798000
*       /*************************************************************/ 01799000
*                                                                  0724 01800000
*       CTMSGPTR=CTMSGPTR-ECBLEN;   /*                       @Z40LB65*/ 01801000
         SLR   @15,@05                                             0724 01802000
         ST    @15,CTMSGPTR                                        0724 01803000
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/*                    @Z40LB65*/ 01804000
         L     @05,@PC00001                                        0725 01805000
         ST    @05,@AL00001                                        0725 01806000
         LA    @15,CTMSGPTR                                        0725 01807000
         ST    @15,@AL00001+4                                      0725 01808000
         L     @15,GDTFSP(,@05)                                    0725 01809000
         LA    @01,@AL00001                                        0725 01810000
         BALR  @14,@15                                             0725 01811000
*     END;                          /*                       @Z40LB65*/ 01812000
*                                                                  0726 01813000
*   /*****************************************************************/ 01814000
*   /*                                                               */ 01815000
*   /* IF COPYCODE = 0 INITIALIZE THE COTBLIST PARM LIST     @Z40LB65*/ 01816000
*   /* FOR THE COPYTABL ORDER OF THE USSC MACRO FOR WDS2.    @Z40LB65*/ 01817000
*   /*                                                               */ 01818000
*   /*****************************************************************/ 01819000
*                                                                  0727 01820000
*   IF COPYCODE=LASTCC00 THEN                                      0727 01821000
@RF00711 SLR   @05,@05                                             0727 01822000
         CR    COPYCODE,@05                                        0727 01823000
         BNE   @RF00727                                            0727 01824000
*     DO;                           /*                       @Z40LB65*/ 01825000
*       DCOTBTID=COPYSEC;           /*                       @Z40LB65*/ 01826000
         MVC   DCOTBTID(1),COPYSEC                                 0729 01827000
*       COTBEXTS(1:2)=SCYL2;        /*                       @Z40LB65*/ 01828000
         MVC   COTBEXTS(2),SCYL2                                   0730 01829000
*       COTBEXTS(3:4)=ECYL2;        /*                       @Z40LB65*/ 01830000
         MVC   COTBEXTS+2(2),ECYL2                                 0731 01831000
*       COTBVOL=WORKVOL2;           /*                       @Z40LB65*/ 01832000
*                                                                  0732 01833000
         MVC   COTBVOL(6),WORKVOL2                                 0732 01834000
*       /*************************************************************/ 01835000
*       /*                                                           */ 01836000
*       /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF    @Z40LB65*/ 01837000
*       /* USSC PARM LIST                                    @Z40LB65*/ 01838000
*       /*                                                           */ 01839000
*       /*************************************************************/ 01840000
*                                                                  0733 01841000
*       IF GDTDBG=NULLPTR THEN                                     0733 01842000
         L     @15,@PC00001                                        0733 01843000
         C     @05,GDTDBG(,@15)                                    0733 01844000
         BE    @RT00733                                            0733 01845000
*         ;                                                        0734 01846000
*       ELSE                                                       0735 01847000
*         DO;                                                      0735 01848000
*           DMPINDEX=ADDR(DMPSTG);  /*                       @Z40LB65*/ 01849000
         LA    DMPINDEX,DMPSTG                                     0736 01850000
*           DMPITMNM='COTBLIST';                                   0737 01851000
         MVC   DMPITMNM(8,DMPINDEX),@CC01334                       0737 01852000
*           DMPITMPT=ADDR(COTBLIST);                               0738 01853000
         LA    @05,COTBLIST                                        0738 01854000
         ST    @05,DMPITMPT(,DMPINDEX)                             0738 01855000
*           DMPITMLN=LENGTH(COTBLIST);                             0739 01856000
         MVC   DMPITMLN(2,DMPINDEX),@CH00309                       0739 01857000
*           DMPITMTP='H';                                          0740 01858000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0740 01859000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0741 01860000
         AL    DMPINDEX,@CF00473                                   0741 01861000
*           DMPTRM=DMPTRMVL;                                       0742 01862000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0742 01863000
*         END;                      /*                       @Z40LB65*/ 01864000
*       IF GDTDBG=NULLPTR THEN                                     0744 01865000
@RT00733 L     @05,@PC00001                                        0744 01866000
         L     @05,GDTDBG(,@05)                                    0744 01867000
         LTR   @05,@05                                             0744 01868000
         BZ    @RT00744                                            0744 01869000
*         ;                                                        0745 01870000
*       ELSE                                                       0746 01871000
*         CALL IDCDB010(GDTTBL,'CPCF',ADDR(DMPSTG));/*       @Z40LB65*/ 01872000
*                                                                  0746 01873000
         L     @05,@PC00001                                        0746 01874000
         ST    @05,@AL00001                                        0746 01875000
         LA    @15,@CC01338                                        0746 01876000
         ST    @15,@AL00001+4                                      0746 01877000
         LA    @15,DMPSTG                                          0746 01878000
         ST    @15,@AFTEMPS                                        0746 01879000
         LA    @15,@AFTEMPS                                        0746 01880000
         ST    @15,@AL00001+8                                      0746 01881000
         MVI   @AL00001+8,X'80'                                    0746 01882000
         L     @15,GDTDBG(,@05)                                    0746 01883000
         LA    @01,@AL00001                                        0746 01884000
         BALR  @14,@15                                             0746 01885000
*       /*************************************************************/ 01886000
*       /*                                                           */ 01887000
*       /* ISSUE THE COPY TABLE OPTION OF THE USSC MACRO TO  @Z40LB65*/ 01888000
*       /* COPY THE SECONDARY MSC TABLES TO WDS2.            @Z40LB65*/ 01889000
*       /*                                                           */ 01890000
*       /*************************************************************/ 01891000
*                                                                  0747 01892000
*       CALL IDCSASS0(GDTTBL,COPYTABL,COTPTR,REASONCD,ECBCODE,CTMSGPTR) 01893000
*           ;                                                      0747 01894000
@RT00744 L     @05,@PC00001                                        0747 01895000
         ST    @05,@AL00001                                        0747 01896000
         LA    @02,COPYTABL                                        0747 01897000
         ST    @02,@AL00001+4                                      0747 01898000
         LA    @02,COTPTR                                          0747 01899000
         ST    @02,@AL00001+8                                      0747 01900000
         LA    @02,REASONCD                                        0747 01901000
         ST    @02,@AL00001+12                                     0747 01902000
         LA    @02,ECBCODE                                         0747 01903000
         ST    @02,@AL00001+16                                     0747 01904000
         LA    @02,CTMSGPTR                                        0747 01905000
         ST    @02,@AL00001+20                                     0747 01906000
         MVI   @AL00001+20,X'80'                                   0747 01907000
         L     @15,GDTSSC(,@05)                                    0747 01908000
         LA    @01,@AL00001                                        0747 01909000
         BALR  @14,@15                                             0747 01910000
*       RESPECIFY                                                  0748 01911000
*         RTNREG RSTD;                                             0748 01912000
*       TESTRC=RTNREG;                                             0749 01913000
         LR    TESTRC,RTNREG                                       0749 01914000
*       RESPECIFY                                                  0750 01915000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 01916000
*                                                                  0750 01917000
*       /*************************************************************/ 01918000
*       /*                                                           */ 01919000
*       /* TEST THE RETURN CODE FROM USSC. IF THE RETURN     @Z40LB65*/ 01920000
*       /* CODE IS 04 CALL SSCMSG TO PRINT OUT MESSAGE TO EXPLAIN THE*/ 01921000
*       /* ERROR. IF THE RETURN CODE IS 04 OR 08 ISSUE THE UPRINT    */ 01922000
*       /* MACRO TO PRINT MESSAGE IDC31181I INDICATING THE TABLES    */ 01923000
*       /* COULD NOT BE COPIED.                              @Z40LB65*/ 01924000
*       /*                                                           */ 01925000
*       /*************************************************************/ 01926000
*                                                                  0751 01927000
*       IF TESTRC=4 THEN                                           0751 01928000
         C     TESTRC,@CF00041                                     0751 01929000
         BNE   @RF00751                                            0751 01930000
*         CALL SSCMSG(REASONCD,ECBCODE);/*                   @Z40LB65*/ 01931000
         LA    @05,REASONCD                                        0752 01932000
         ST    @05,@AL00001                                        0752 01933000
         LA    @05,ECBCODE                                         0752 01934000
         ST    @05,@AL00001+4                                      0752 01935000
         LA    @01,@AL00001                                        0752 01936000
         BAL   @14,SSCMSG                                          0752 01937000
*       IF TESTRC=4|TESTRC=8 THEN                                  0753 01938000
@RF00751 C     TESTRC,@CF00041                                     0753 01939000
         BE    @RT00753                                            0753 01940000
         C     TESTRC,@CF00178                                     0753 01941000
         BNE   @RF00753                                            0753 01942000
@RT00753 DS    0H                                                  0754 01943000
*         DO;                       /*                       @Z40LB65*/ 01944000
*           COPYCODE=LASTCC12;      /*                       @Z40LB65*/ 01945000
         LA    COPYCODE,12                                         0755 01946000
*           DARGSENT=MSG31181;      /*                       @Z40LB65*/ 01947000
         L     @05,DDSTRU                                          0756 01948000
         MVI   DARGSENT(@05),X'02'                                 0756 01949000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB65*/ 01950000
         L     @05,@PC00001                                        0757 01951000
         ST    @05,@AL00001                                        0757 01952000
         LA    @15,@CF00114                                        0757 01953000
         ST    @15,@AL00001+4                                      0757 01954000
         LA    @15,DDSTRU                                          0757 01955000
         ST    @15,@AL00001+8                                      0757 01956000
         MVI   @AL00001+8,X'80'                                    0757 01957000
         L     @15,GDTPRT(,@05)                                    0757 01958000
         LA    @01,@AL00001                                        0757 01959000
         BALR  @14,@15                                             0757 01960000
*         END;                      /*                       @Z40LB65*/ 01961000
*     END;                          /*                       @Z40LB65*/ 01962000
*                                                                  0759 01963000
@RF00753 DS    0H                                                  0760 01964000
*   /*****************************************************************/ 01965000
*   /*                                                               */ 01966000
*   /* IF COPYCODE = 0 RETRIEVE THE NECESSARY ADDRESSES      @Z40LB65*/ 01967000
*   /* FROM THE MESSAGE AREA.                                @Z40LB65*/ 01968000
*   /*                                                               */ 01969000
*   /*****************************************************************/ 01970000
*                                                                  0760 01971000
*   IF COPYCODE=LASTCC00 THEN                                      0760 01972000
@RF00727 LTR   COPYCODE,COPYCODE                                   0760 01973000
         BNZ   @RF00760                                            0760 01974000
*     DO;                           /*                       @Z40LB65*/ 01975000
*       CTMSGPTR=CTMSGPTR+ECBLEN;   /*                       @Z40LB65*/ 01976000
*                                                                  0762 01977000
         LA    @05,4                                               0762 01978000
         L     @15,CTMSGPTR                                        0762 01979000
         ALR   @15,@05                                             0762 01980000
         ST    @15,CTMSGPTR                                        0762 01981000
*       /*************************************************************/ 01982000
*       /*                                                           */ 01983000
*       /* COMPUTE CYLINDER DIFFERENCE (ADDRDIF2) FROM       @Z40LB65*/ 01984000
*       /* ORIGINAL VOLUME TO THE WORK DATA SET VOLUME. THIS IS DONE */ 01985000
*       /* BY SUBTRACTING THE FIRST CYLINDER VALUE OF THE FIRST ENTRY*/ 01986000
*       /* FROM THE FIELD CTREALCC.                          @Z40LB65*/ 01987000
*       /*                                                           */ 01988000
*       /*************************************************************/ 01989000
*                                                                  0763 01990000
*       ADDRDIF2=CTREALCC-SDGC;     /*                       @Z40LB65*/ 01991000
*                                                                  0763 01992000
         SLR   @14,@14                                             0763 01993000
         ICM   @14,3,CTREALCC(@15)                                 0763 01994000
         SLR   @09,@09                                             0763 01995000
         IC    @09,SDGC                                            0763 01996000
         SLR   @14,@09                                             0763 01997000
         STH   @14,ADDRDIF2                                        0763 01998000
*       /*************************************************************/ 01999000
*       /*                                                           */ 02000000
*       /* RESET MESSAGE POINTER TO POINT TO THE ECB AND     @Z40LB65*/ 02001000
*       /* ISSUE UFSPACE MACRO TO FREE UP MESSAGE AREA.      @Z40LB65*/ 02002000
*       /*                                                           */ 02003000
*       /*************************************************************/ 02004000
*                                                                  0764 02005000
*       CTMSGPTR=CTMSGPTR-ECBLEN;   /*                       @Z40LB65*/ 02006000
         SLR   @15,@05                                             0764 02007000
         ST    @15,CTMSGPTR                                        0764 02008000
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/*                    @Z40LB65*/ 02009000
         L     @05,@PC00001                                        0765 02010000
         ST    @05,@AL00001                                        0765 02011000
         LA    @15,CTMSGPTR                                        0765 02012000
         ST    @15,@AL00001+4                                      0765 02013000
         L     @15,GDTFSP(,@05)                                    0765 02014000
         LA    @01,@AL00001                                        0765 02015000
         BALR  @14,@15                                             0765 02016000
*     END;                          /*                       @Z40LB65*/ 02017000
*   RETURN CODE(COPYCODE);          /*                       @Z40LB65*/ 02018000
@RF00760 LR    @15,COPYCODE                                        0767 02019000
         L     @13,4(,@13)                                         0767 02020000
         L     @14,12(,@13)                                        0767 02021000
         LM    @00,@12,20(@13)                                     0767 02022000
         BR    @14                                                 0767 02023000
*   END COPYPROC;                   /*                       @Z40LB65*/ 02024000
*                                                                  0769 02025000
*/********************************************************************/ 02026000
*/*                                                          @Z40LB65*/ 02027000
*/*     PROCEDURE NAME - COMPPROC                            @Z40LB65*/ 02028000
*/*                                                          @Z40LB65*/ 02029000
*/*     FUNCTION - THIS ROUTINE CAUSES TRACKS TO BE READ     @Z40LB65*/ 02030000
*/*                FROM EACH WORK DATA SET AND COMPARES      @Z40LB65*/ 02031000
*/*                THE PRIMARY AND SECONDARY RECORDS         @Z40LB65*/ 02032000
*/*                CAUSING ALL INCONSISTENCIES TO BE         @Z40LB65*/ 02033000
*/*                REPORTED.                                 @Z40LB65*/ 02034000
*/*                                                          @Z40LB65*/ 02035000
*/*     INPUT - FDTTBL AND WORK AREA CALLED INTTBL           @Z40LB65*/ 02036000
*/*                                                          @Z40LB65*/ 02037000
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Z40LB65*/ 02038000
*/*              0 = SUCCESSFUL COMPLETION                   @Z40LB65*/ 02039000
*/*              12 = UNSUCCESSFUL COMPLETION                @Z40LB65*/ 02040000
*/*                                                          @Z40LB65*/ 02041000
*/********************************************************************/ 02042000
*                                                                  0769 02043000
*COMPPROC:                                                         0769 02044000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 02045000
*                                                                  0769 02046000
COMPPROC STM   @14,@12,12(@13)                                     0769 02047000
         ST    @13,@SA00004+4                                      0769 02048000
         LA    @14,@SA00004                                        0769 02049000
         ST    @14,8(,@13)                                         0769 02050000
         LR    @13,@14                                             0769 02051000
*   /*****************************************************************/ 02052000
*   /*                                                               */ 02053000
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/ 02054000
*   /*                                                               */ 02055000
*   /*****************************************************************/ 02056000
*                                                                  0770 02057000
*   DCL                                                            0770 02058000
*     COMPCODE FIXED(15);           /* COMPPROC RETURN CODE  @Z40LB65*/ 02059000
*   OLDERID2=NEWERID2;                                             0771 02060000
         L     @08,@PC00001                                        0771 02061000
         L     @08,GDTTR2(,@08)                                    0771 02062000
         MVC   @TS00001(95),NEWERID2(@08)                          0771 02063000
         MVC   OLDERID2(95,@08),@TS00001                           0771 02064000
*   NEWID2='CPDA';                  /*                       @Z40LB65*/ 02065000
         MVC   NEWID2(4,@08),@CC01343                              0772 02066000
*   COMPCODE=''B;                   /*                       @Z40LB65*/ 02067000
         SLR   COMPCODE,COMPCODE                                   0773 02068000
*   FIRSTERR=OFF;                   /*                       @Z40LB65*/ 02069000
*                                                                  0774 02070000
         NI    FIRSTERR,B'11011111'                                0774 02071000
*   /*****************************************************************/ 02072000
*   /*                                                               */ 02073000
*   /* PROCESS 24 CYLINDERS (TRACE EXCLUDED) INDIVIDUALLY.   @Z40LB65*/ 02074000
*   /* WITHIN EACH CYLINDER PROCESS 19 TRACKS INDIVIDUALLY   @Z40LB65*/ 02075000
*   /* EXCEPT FOR TRACKS BELONGING TO TABLES NOT COMPARED.   @Z40LB65*/ 02076000
*   /* WITHIN EACH TRACK PROCESS 32 RECORDS INDIVIDUALLY.    @Z40LB65*/ 02077000
*   /*                                                               */ 02078000
*   /*****************************************************************/ 02079000
*                                                                  0775 02080000
*   DO C=SDGC TO(SDGC+23);          /*                       @Z40LB65*/ 02081000
         SLR   @08,@08                                             0775 02082000
         IC    @08,SDGC                                            0775 02083000
         B     @DE00775                                            0775 02084000
@DL00775 DS    0H                                                  0776 02085000
*     DO H=0 TO 18;                 /*                       @Z40LB65*/ 02086000
*                                                                  0776 02087000
         SLR   @08,@08                                             0776 02088000
         STC   @08,H                                               0776 02089000
@DL00776 DS    0H                                                  0777 02090000
*       /*************************************************************/ 02091000
*       /*                                                           */ 02092000
*       /* BYPASS THE MSG BUF, JOURNAL, AND SCHE Q RECORDS   @Z40LB65*/ 02093000
*       /*                                                           */ 02094000
*       /*************************************************************/ 02095000
*                                                                  0777 02096000
*       IF C=VVAC&H>VVAH THEN                                      0777 02097000
         CLC   C(1),VVAC                                           0777 02098000
         BNE   @RF00777                                            0777 02099000
         CLC   H(1),VVAH                                           0777 02100000
         BNH   @RF00777                                            0777 02101000
*         DO;                       /*                       @Z40LB65*/ 02102000
*           C=DOC;                  /*                       @Z40LB65*/ 02103000
         MVC   C(1),DOC                                            0779 02104000
*           H=DOH;                  /*                       @Z40LB65*/ 02105000
         MVC   H(1),DOH                                            0780 02106000
*         END;                      /*                       @Z40LB65*/ 02107000
*                                                                  0781 02108000
*       /*************************************************************/ 02109000
*       /*                                                           */ 02110000
*       /* CALL TRKRDR TO READ CORRESPONDING TRACKS FROM     @Z40LB65*/ 02111000
*       /* WDS1 AND WDS2.                                    @Z40LB65*/ 02112000
*       /*                                                           */ 02113000
*       /*************************************************************/ 02114000
*                                                                  0782 02115000
*       R=1;                        /*                       @Z40LB65*/ 02116000
@RF00777 MVI   R,X'01'                                             0782 02117000
*       CALL TRKRDR;                /*                       @Z40LB65*/ 02118000
         BAL   @14,TRKRDR                                          0783 02119000
*       RESPECIFY                                                  0784 02120000
*         RTNREG RSTD;                                             0784 02121000
*       TESTRC=RTNREG;                                             0785 02122000
         LR    TESTRC,RTNREG                                       0785 02123000
*       RESPECIFY                                                  0786 02124000
*         RTNREG UNRSTD;            /*                       @Z40LB65*/ 02125000
*                                                                  0786 02126000
*       /*************************************************************/ 02127000
*       /*                                                           */ 02128000
*       /* IF TRKRDR ENCOUNTERS AN I/O ERROR, PROCESSING MUST        */ 02129000
*       /*                                                   @Z40LB65*/ 02130000
*       /* TERMINATE SINCE FURTHER I/O REQUESTS FOR THAT DATA        */ 02131000
*       /*                                                   @Z40LB65*/ 02132000
*       /* SET WILL RESULT IN 'REQUEST PURGED' SYNAD ERRORS. @Z40LB65*/ 02133000
*       /*                                                           */ 02134000
*       /*************************************************************/ 02135000
*                                                                  0787 02136000
*       IF TESTRC=LASTCC12 THEN                                    0787 02137000
         LA    @08,12                                              0787 02138000
         CR    TESTRC,@08                                          0787 02139000
         BNE   @RF00787                                            0787 02140000
*         DO;                       /*                       @Z40LB65*/ 02141000
*           COMPCODE=LASTCC12;      /*                       @Z40LB65*/ 02142000
         LR    COMPCODE,@08                                        0789 02143000
*           C=SDGC+24;              /*                       @Z40LB65*/ 02144000
         LA    @08,24                                              0790 02145000
         SLR   @07,@07                                             0790 02146000
         IC    @07,SDGC                                            0790 02147000
         ALR   @08,@07                                             0790 02148000
         STC   @08,C                                               0790 02149000
*           H=19;                   /*                       @Z40LB65*/ 02150000
         MVI   H,X'13'                                             0791 02151000
*         END;                      /*                       @Z40LB65*/ 02152000
*       ELSE                                                       0793 02153000
*         DO R=1 TO 32;             /*                       @Z40LB65*/ 02154000
*                                                                  0793 02155000
         B     @RC00787                                            0793 02156000
@RF00787 LA    @08,1                                               0793 02157000
         STC   @08,R                                               0793 02158000
@DL00793 DS    0H                                                  0794 02159000
*           /*********************************************************/ 02160000
*           /*                                                       */ 02161000
*           /* LOCATE THE PROPER RECORDS                     @Z40LB65*/ 02162000
*           /*                                                       */ 02163000
*           /*********************************************************/ 02164000
*                                                                  0794 02165000
*           RECPTR1=TRKPTR1+(R-1)*RECSIZE;/*                 @Z40LB65*/ 02166000
         BCTR  @08,0                                               0794 02167000
         MH    @08,@CH01175                                        0794 02168000
         L     RECPTR1,TRKPTR1                                     0794 02169000
         ALR   RECPTR1,@08                                         0794 02170000
*           RECPTR2=TRKPTR2+(R-1)*RECSIZE;/*                 @Z40LB65*/ 02171000
*                                                                  0795 02172000
         AL    @08,TRKPTR2                                         0795 02173000
         LR    RECPTR2,@08                                         0795 02174000
*           /*********************************************************/ 02175000
*           /*                                                       */ 02176000
*           /* TEST THE CHRS FOR DISCREPANCIES               @Z40LB65*/ 02177000
*           /*                                                       */ 02178000
*           /*********************************************************/ 02179000
*                                                                  0796 02180000
*           IF PCHR^=CHR|SCHR^=CHR THEN                            0796 02181000
         CLC   PCHR(3,RECPTR1),CHR                                 0796 02182000
         BNE   @RT00796                                            0796 02183000
         CLC   SCHR(3,RECPTR2),CHR                                 0796 02184000
         BE    @RF00796                                            0796 02185000
@RT00796 DS    0H                                                  0797 02186000
*             CHRERROR=ON;          /*                       @Z40LB65*/ 02187000
         OI    CHRERROR,B'10000000'                                0797 02188000
*           ELSE                                                   0798 02189000
*             CHRERROR=OFF;         /*                       @Z40LB65*/ 02190000
*                                                                  0798 02191000
         B     @RC00796                                            0798 02192000
@RF00796 NI    CHRERROR,B'01111111'                                0798 02193000
*           /*********************************************************/ 02194000
*           /*                                                       */ 02195000
*           /* COMPARE THE PREFIXES AND RECORDS              @Z40LB65*/ 02196000
*           /*                                                       */ 02197000
*           /*********************************************************/ 02198000
*                                                                  0799 02199000
*           IF PPREFIX^=SPREFIX|PREC^=SREC THEN                    0799 02200000
@RC00796 CLC   PPREFIX(8,RECPTR1),SPREFIX(RECPTR2)                 0799 02201000
         BNE   @RT00799                                            0799 02202000
         CLC   PREC(256,RECPTR1),SREC(RECPTR2)                     0799 02203000
         BE    @RF00799                                            0799 02204000
@RT00799 DS    0H                                                  0800 02205000
*             MATCHERR=ON;          /*                       @Z40LB65*/ 02206000
         OI    MATCHERR,B'01000000'                                0800 02207000
*           ELSE                                                   0801 02208000
*             MATCHERR=OFF;         /*                       @Z40LB65*/ 02209000
*                                                                  0801 02210000
         B     @RC00799                                            0801 02211000
@RF00799 NI    MATCHERR,B'10111111'                                0801 02212000
*           /*********************************************************/ 02213000
*           /*                                                       */ 02214000
*           /* WERE THERE ANY DISCREPANCIES IN THIS RECORD?  @Z40LB65*/ 02215000
*           /*                                                       */ 02216000
*           /*********************************************************/ 02217000
*                                                                  0802 02218000
*           IF CHRERROR=ON|MATCHERR=ON THEN                        0802 02219000
@RC00799 TM    CHRERROR,B'11000000'                                0802 02220000
         BZ    @RF00802                                            0802 02221000
*             DO;                   /*                       @Z40LB65*/ 02222000
*                                                                  0803 02223000
*               /*****************************************************/ 02224000
*               /*                                                   */ 02225000
*               /* CALL HEADSET TO ESTABLISH HEADINGS ON THE @Z40LB65*/ 02226000
*               /* OCCURENCE OF THE FIRST MISMATCH.          @Z40LB65*/ 02227000
*               /*                                                   */ 02228000
*               /*****************************************************/ 02229000
*                                                                  0804 02230000
*               IF FIRSTERR=OFF THEN                               0804 02231000
         TM    FIRSTERR,B'00100000'                                0804 02232000
         BNZ   @RF00804                                            0804 02233000
*                 DO;               /*                       @Z40LB65*/ 02234000
*                   CALL HEADSET;   /*                       @Z40LB65*/ 02235000
         BAL   @14,HEADSET                                         0806 02236000
*                   FIRSTERR=ON;    /*                       @Z40LB65*/ 02237000
         OI    FIRSTERR,B'00100000'                                0807 02238000
*                 END;              /*                       @Z40LB65*/ 02239000
*                                                                  0808 02240000
*               /*****************************************************/ 02241000
*               /*                                                   */ 02242000
*               /* CALL MISMATCH TO FIND ALL INCONSISTENCIES @Z40LB65*/ 02243000
*               /*                                                   */ 02244000
*               /*****************************************************/ 02245000
*                                                                  0809 02246000
*               CALL MISMATCH;      /*                       @Z40LB65*/ 02247000
@RF00804 BAL   @14,MISMATCH                                        0809 02248000
*             END;                  /*                       @Z40LB65*/ 02249000
*         END;                      /*                       @Z40LB65*/ 02250000
@RF00802 LA    @08,1                                               0811 02251000
         SLR   @07,@07                                             0811 02252000
         IC    @07,R                                               0811 02253000
         ALR   @08,@07                                             0811 02254000
         STC   @08,R                                               0811 02255000
         C     @08,@CF00220                                        0811 02256000
         BNH   @DL00793                                            0811 02257000
*     END;                          /*                       @Z40LB65*/ 02258000
@RC00787 LA    @08,1                                               0812 02259000
         SLR   @07,@07                                             0812 02260000
         IC    @07,H                                               0812 02261000
         ALR   @08,@07                                             0812 02262000
         STC   @08,H                                               0812 02263000
         C     @08,@CF01345                                        0812 02264000
         BNH   @DL00776                                            0812 02265000
*   END;                            /*                       @Z40LB65*/ 02266000
         LA    @08,1                                               0813 02267000
         SLR   @07,@07                                             0813 02268000
         IC    @07,C                                               0813 02269000
         ALR   @08,@07                                             0813 02270000
@DE00775 STC   @08,C                                               0813 02271000
         LA    @07,23                                              0813 02272000
         SLR   @05,@05                                             0813 02273000
         IC    @05,SDGC                                            0813 02274000
         ALR   @07,@05                                             0813 02275000
         CR    @08,@07                                             0813 02276000
         BNH   @DL00775                                            0813 02277000
*   RETURN CODE(COMPCODE);          /*                       @Z40LB65*/ 02278000
         LR    @15,COMPCODE                                        0814 02279000
         L     @13,4(,@13)                                         0814 02280000
         L     @14,12(,@13)                                        0814 02281000
         LM    @00,@12,20(@13)                                     0814 02282000
         BR    @14                                                 0814 02283000
*   END COMPPROC;                   /*                       @Z40LB65*/ 02284000
*                                                                  0816 02285000
*/********************************************************************/ 02286000
*/*                                                          @Z40LB65*/ 02287000
*/*     PROCEDURE NAME - TRKRDR                              @Z40LB65*/ 02288000
*/*                                                          @Z40LB65*/ 02289000
*/*     FUNCTION - THIS ROUTINE READS A TRACK FROM EACH      @Z40LB65*/ 02290000
*/*                WORK DATA SET INTO ITS TRACK BUFFER       @Z40LB65*/ 02291000
*/*                AREA (TRKBUF1, TRKBUF2)                   @Z40LB65*/ 02292000
*/*                                                          @Z40LB65*/ 02293000
*/*     INPUT - WORK AREAS: INTTBL, TRKBUF1, TRKBUF2         @Z40LB65*/ 02294000
*/*                                                          @Z40LB65*/ 02295000
*/*     OUTPUT - INTTBL, TRKBUF1, TRKBUF2 AND RETURN CODE    @Z40LB65*/ 02296000
*/*              0 = SUCCESSFUL COMPLETION                   @Z40LB65*/ 02297000
*/*              12 = UNSUCCESSFUL COMPLETION                @Z40LB65*/ 02298000
*/*                                                          @Z40LB65*/ 02299000
*/********************************************************************/ 02300000
*                                                                  0816 02301000
*TRKRDR:                                                           0816 02302000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 02303000
*                                                                  0816 02304000
TRKRDR   STM   @14,@12,12(@13)                                     0816 02305000
         ST    @13,@SA00005+4                                      0816 02306000
         LA    @14,@SA00005                                        0816 02307000
         ST    @14,8(,@13)                                         0816 02308000
         LR    @13,@14                                             0816 02309000
*   /*****************************************************************/ 02310000
*   /*                                                               */ 02311000
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/ 02312000
*   /*                                                               */ 02313000
*   /*****************************************************************/ 02314000
*                                                                  0817 02315000
*   DCL                                                            0817 02316000
*     TRKCODE FIXED(15);            /* TRKRDR RETURN CODE    @Z40LB65*/ 02317000
*                                                                  0817 02318000
*   /*****************************************************************/ 02319000
*   /*                                                               */ 02320000
*   /* DECLARE STRUCTURES FOR SEEK ADDRESSES                 @Z40LB65*/ 02321000
*   /*                                                               */ 02322000
*   /*****************************************************************/ 02323000
*                                                                  0818 02324000
*   DCL                                                            0818 02325000
*     1 CCHHR,                      /* SEARCH CCHHR          @Z40LB65*/ 02326000
*      2 CC FIXED(15),              /* SEARCH CYLINDER       @Z40LB65*/ 02327000
*      2 HH FIXED(15),              /* SEARCH HEAD           @Z40LB65*/ 02328000
*      2 RR FIXED(8);               /* SEARCH RECORD         @Z40LB65*/ 02329000
*   DCL                                                            0819 02330000
*     1 CCHHR1,                     /* SEEK CCHHR FOR WDS1   @Z40LB65*/ 02331000
*      2 CC1 FIXED(15),             /* WDS1 SEEK CYLINDER    @Z40LB65*/ 02332000
*      2 HH1 FIXED(15),             /* WDS1 SEEK HEAD        @Z40LB65*/ 02333000
*      2 RR1 FIXED(8);              /* WDS1 SEEK RECORD      @Z40LB65*/ 02334000
*   DCL                                                            0820 02335000
*     1 CCHHR2,                     /* SEEK CCHHR FOR WDS2   @Z40LB65*/ 02336000
*      2 CC2 FIXED(15),             /* WDS2 SEEK CYLINDER    @Z40LB65*/ 02337000
*      2 HH2 FIXED(15),             /* WDS2 SEEK HEAD        @Z40LB65*/ 02338000
*      2 RR2 FIXED(8);              /* WDS2 SEEK RECORD      @Z40LB65*/ 02339000
*   OLDERID2=NEWERID2;                                             0821 02340000
         L     @02,@PC00001                                        0821 02341000
         L     @15,GDTTR2(,@02)                                    0821 02342000
         MVC   @TS00001(95),NEWERID2(@15)                          0821 02343000
         MVC   OLDERID2(95,@15),@TS00001                           0821 02344000
*   NEWID2='CPEA';                  /*                       @Z40LB65*/ 02345000
         MVC   NEWID2(4,@15),@CC01366                              0822 02346000
*   TRKCODE=''B;                    /*                       @Z40LB65*/ 02347000
*                                                                  0823 02348000
         SLR   TRKCODE,TRKCODE                                     0823 02349000
*   /*****************************************************************/ 02350000
*   /*                                                               */ 02351000
*   /* TRANSLATE CHR TO CCHHR                                @Z40LB65*/ 02352000
*   /*                                                               */ 02353000
*   /*****************************************************************/ 02354000
*                                                                  0824 02355000
*   CC=C;                           /*                       @Z40LB65*/ 02356000
         SLR   @15,@15                                             0824 02357000
         IC    @15,C                                               0824 02358000
         STH   @15,CC                                              0824 02359000
*   HH=H;                           /*                       @Z40LB65*/ 02360000
         SLR   @14,@14                                             0825 02361000
         IC    @14,H                                               0825 02362000
         STH   @14,HH                                              0825 02363000
*   RR=R;                           /*                       @Z40LB65*/ 02364000
*                                                                  0826 02365000
         MVC   RR(1),R                                             0826 02366000
*   /*****************************************************************/ 02367000
*   /*                                                               */ 02368000
*   /* PREPARE THE UEXCP ARGUMENT LIST (EXGARG) AND ISSUE    @Z40LB65*/ 02369000
*   /* THE UEXCP MACRO TO READ 1 TRACK OF DATA FROM WDS1.    @Z40LB65*/ 02370000
*   /*                                                               */ 02371000
*   /*****************************************************************/ 02372000
*                                                                  0827 02373000
*   EXGCTLBK=WORKPTR1;              /*                       @Z40LB65*/ 02374000
         L     @14,WORKPTR1                                        0827 02375000
         ST    @14,EXGCTLBK(,EXGPTR)                               0827 02376000
*   CCHHR1=CCHHR;                   /*                       @Z40LB65*/ 02377000
         MVC   CCHHR1(5),CCHHR                                     0828 02378000
*   CC1=CC+ADDRDIF1;                /*                       @Z40LB65*/ 02379000
         LH    @14,ADDRDIF1                                        0829 02380000
         N     @14,@CF01444                                        0829 02381000
         ALR   @15,@14                                             0829 02382000
         STH   @15,CC1                                             0829 02383000
*   EXGCCHH1=ADDR(CCHHR1);          /*                       @Z40LB65*/ 02384000
         LA    @15,CCHHR1                                          0830 02385000
         ST    @15,EXGCCHH1(,EXGPTR)                               0830 02386000
*   EXGCCHH2=ADDR(CCHHR);           /*                       @Z40LB65*/ 02387000
         LA    @15,CCHHR                                           0831 02388000
         ST    @15,EXGCCHH2(,EXGPTR)                               0831 02389000
*   EXGRECNO=32;                    /*                       @Z40LB65*/ 02390000
         MVC   EXGRECNO(4,EXGPTR),@CF00220                         0832 02391000
*   EXGDATAP=TRKPTR1;               /*                       @Z40LB65*/ 02392000
         L     @15,TRKPTR1                                         0833 02393000
         ST    @15,EXGDATAP(,EXGPTR)                               0833 02394000
*   EXGDATAL=RECSIZE;               /*                       @Z40LB65*/ 02395000
*                                                                  0834 02396000
         MVC   EXGDATAL(2,EXGPTR),@CH01175                         0834 02397000
*   /*****************************************************************/ 02398000
*   /*                                                               */ 02399000
*   /* ISSUE THE UEXCP MACRO TO READ IN A TRACK OF DATA      @Z40LB65*/ 02400000
*   /*                                                               */ 02401000
*   /*****************************************************************/ 02402000
*                                                                  0835 02403000
*   CALL IDCIO050(GDTTBL,GET,EXGARG);/*                      @Z40LB65*/ 02404000
         ST    @02,@AL00001                                        0835 02405000
         LA    @15,GET                                             0835 02406000
         ST    @15,@AL00001+4                                      0835 02407000
         ST    EXGPTR,@AL00001+8                                   0835 02408000
         MVI   @AL00001+8,X'80'                                    0835 02409000
         L     @15,GDTEXP(,@02)                                    0835 02410000
         LA    @01,@AL00001                                        0835 02411000
         BALR  @14,@15                                             0835 02412000
*   RESPECIFY                                                      0836 02413000
*     RTNREG RSTD;                                                 0836 02414000
*   TESTRC=RTNREG;                                                 0837 02415000
         LR    TESTRC,RTNREG                                       0837 02416000
*   RESPECIFY                                                      0838 02417000
*     RTNREG UNRSTD;                /*                       @Z40LB65*/ 02418000
*   IF TESTRC^=0 THEN                                              0839 02419000
         LTR   TESTRC,TESTRC                                       0839 02420000
         BZ    @RF00839                                            0839 02421000
*     TRKCODE=LASTCC12;             /*                       @Z40LB65*/ 02422000
*                                                                  0840 02423000
         LA    TRKCODE,12                                          0840 02424000
*   /*****************************************************************/ 02425000
*   /*                                                               */ 02426000
*   /* PREPARE THE UEXCP ARGUMENT LIST (EXGARG) AND ISSUE    @Z40LB65*/ 02427000
*   /* THE UEXCP MACRO TO READ 1 TRACK OF DATA FROM WDS2.    @Z40LB65*/ 02428000
*   /*                                                               */ 02429000
*   /*****************************************************************/ 02430000
*                                                                  0841 02431000
*   EXGCTLBK=WORKPTR2;              /*                       @Z40LB65*/ 02432000
@RF00839 L     @02,WORKPTR2                                        0841 02433000
         ST    @02,EXGCTLBK(,EXGPTR)                               0841 02434000
*   CCHHR2=CCHHR;                   /*                       @Z40LB65*/ 02435000
         MVC   CCHHR2(5),CCHHR                                     0842 02436000
*   CC2=CC+ADDRDIF2;                /*                       @Z40LB65*/ 02437000
         LH    @02,ADDRDIF2                                        0843 02438000
         N     @02,@CF01444                                        0843 02439000
         AH    @02,CC                                              0843 02440000
         STH   @02,CC2                                             0843 02441000
*   EXGCCHH1=ADDR(CCHHR2);          /*                       @Z40LB65*/ 02442000
         LA    @02,CCHHR2                                          0844 02443000
         ST    @02,EXGCCHH1(,EXGPTR)                               0844 02444000
*   EXGCCHH2=ADDR(CCHHR);           /*                       @Z40LB65*/ 02445000
         LA    @02,CCHHR                                           0845 02446000
         ST    @02,EXGCCHH2(,EXGPTR)                               0845 02447000
*   EXGRECNO=32;                    /*                       @Z40LB65*/ 02448000
         MVC   EXGRECNO(4,EXGPTR),@CF00220                         0846 02449000
*   EXGDATAP=TRKPTR2;               /*                       @Z40LB65*/ 02450000
         L     @02,TRKPTR2                                         0847 02451000
         ST    @02,EXGDATAP(,EXGPTR)                               0847 02452000
*   EXGDATAL=RECSIZE;               /*                       @Z40LB65*/ 02453000
*                                                                  0848 02454000
         MVC   EXGDATAL(2,EXGPTR),@CH01175                         0848 02455000
*   /*****************************************************************/ 02456000
*   /*                                                               */ 02457000
*   /* ISSUE THE UEXCP MACRO TO READ IN A TRACK OF DATA      @Z40LB65*/ 02458000
*   /*                                                               */ 02459000
*   /*****************************************************************/ 02460000
*                                                                  0849 02461000
*   CALL IDCIO050(GDTTBL,GET,EXGARG);/*                      @Z40LB65*/ 02462000
         L     @02,@PC00001                                        0849 02463000
         ST    @02,@AL00001                                        0849 02464000
         LA    @15,GET                                             0849 02465000
         ST    @15,@AL00001+4                                      0849 02466000
         ST    EXGPTR,@AL00001+8                                   0849 02467000
         MVI   @AL00001+8,X'80'                                    0849 02468000
         L     @15,GDTEXP(,@02)                                    0849 02469000
         LA    @01,@AL00001                                        0849 02470000
         BALR  @14,@15                                             0849 02471000
*   RESPECIFY                                                      0850 02472000
*     RTNREG RSTD;                                                 0850 02473000
*   TESTRC=RTNREG;                                                 0851 02474000
         LR    TESTRC,RTNREG                                       0851 02475000
*   RESPECIFY                                                      0852 02476000
*     RTNREG UNRSTD;                /*                       @Z40LB65*/ 02477000
*   IF TESTRC^=0 THEN                                              0853 02478000
         LTR   TESTRC,TESTRC                                       0853 02479000
         BZ    @RF00853                                            0853 02480000
*     TRKCODE=LASTCC12;             /*                       @Z40LB65*/ 02481000
         LA    TRKCODE,12                                          0854 02482000
*   RETURN CODE(TRKCODE);           /*                       @Z40LB65*/ 02483000
@RF00853 LR    @15,TRKCODE                                         0855 02484000
         L     @13,4(,@13)                                         0855 02485000
         L     @14,12(,@13)                                        0855 02486000
         LM    @00,@12,20(@13)                                     0855 02487000
         BR    @14                                                 0855 02488000
*   END TRKRDR;                     /*                       @Z40LB65*/ 02489000
*                                                                  0857 02490000
*/********************************************************************/ 02491000
*/*                                                          @Z40LB65*/ 02492000
*/*     PROCEDURE NAME - HEADSET                             @Z40LB65*/ 02493000
*/*                                                          @Z40LB65*/ 02494000
*/*     FUNCTION - THIS ROUTINE ESTABLISHES THE SUBTITLE     @Z40LB65*/ 02495000
*/*                LINE FOR THE REPORT                       @Z40LB65*/ 02496000
*/*                                                          @Z40LB65*/ 02497000
*/*     INPUT - STATIC TEXT MODULE HEADING ENTRY             @Z40LB65*/ 02498000
*/*                                                          @Z40LB65*/ 02499000
*/*     OUTPUT - COMPLETED TITLE BUFFER                      @Z40LB65*/ 02500000
*/*                                                          @Z40LB65*/ 02501000
*/********************************************************************/ 02502000
*                                                                  0857 02503000
*HEADSET:                                                          0857 02504000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 02505000
*                                                                  0857 02506000
HEADSET  STM   @14,@12,12(@13)                                     0857 02507000
         ST    @13,@SA00006+4                                      0857 02508000
         LA    @14,@SA00006                                        0857 02509000
         ST    @14,8(,@13)                                         0857 02510000
         LR    @13,@14                                             0857 02511000
*   /*****************************************************************/ 02512000
*   /*                                                               */ 02513000
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/ 02514000
*   /*                                                               */ 02515000
*   /*****************************************************************/ 02516000
*                                                                  0858 02517000
*   DCL                                                            0858 02518000
*     HEADING FIXED(8) CONSTANT(3); /* CP0 STID 3            @Z40LB65*/ 02519000
*                                                                  0858 02520000
*   /*****************************************************************/ 02521000
*   /*                                                               */ 02522000
*   /* DECLARE PCARG LIST FOR THE UESTA MACRO                @Z40LB65*/ 02523000
*   /*                                                               */ 02524000
*   /*****************************************************************/ 02525000
*                                                                  0859 02526000
*   DCL                                                            0859 02527000
*     1 PCARG,                                                     0859 02528000
*      2 PCMTLP PTR(31),            /* MAIN TITLE LINE PTR   @Z40LB65*/ 02529000
*      2 PCSTLP PTR(31),            /* SUB-TITLE LINE PTR    @Z40LB65*/ 02530000
*      2 PCFLP PTR(31),             /* FOOTING LINE PTR      @Z40LB65*/ 02531000
*      2 PCPCP PTR(31),             /*                       @Z40LB65*/ 02532000
*      2 PCPNL FIXED(15),           /* PAGE NO LOCATION      @Z40LB65*/ 02533000
*      2 PCPTL FIXED(15),           /* TIME LOCATION         @Z40LB65*/ 02534000
*      2 PCPDL FIXED(15),           /* DATE LOCATION         @Z40LB65*/ 02535000
*      2 PCMTLC FIXED(15),          /* MAIN TITLE LINE CNT   @Z40LB65*/ 02536000
*      2 PCSTLC FIXED(15),          /* SUB-TITLE LINE CNT    @Z40LB65*/ 02537000
*      2 PCFLC FIXED(15),           /* FOOTING LINE CNT      @Z40LB65*/ 02538000
*      2 PCLW FIXED(15),            /* LINE WIDTH            @Z40LB65*/ 02539000
*      2 PCPD FIXED(15),            /* PAGE DEPTH            @Z40LB65*/ 02540000
*      2 PCDSC PTR(8);              /* DEFAULT SPACE VAL     @Z40LB65*/ 02541000
*   OLDERID2=NEWERID2;                                             0860 02542000
         L     @15,@PC00001                                        0860 02543000
         L     @14,GDTTR2(,@15)                                    0860 02544000
         MVC   @TS00001(95),NEWERID2(@14)                          0860 02545000
         MVC   OLDERID2(95,@14),@TS00001                           0860 02546000
*   NEWID2='CPFA';                  /*                       @Z40LB65*/ 02547000
         MVC   NEWID2(4,@14),@CC01385                              0861 02548000
*   PCARG=''B;                      /*                       @Z40LB65*/ 02549000
*                                                                  0862 02550000
         XC    PCARG(33),PCARG                                     0862 02551000
*   /*****************************************************************/ 02552000
*   /*                                                               */ 02553000
*   /* ISSUE THE UPRINT MACRO TO READ SUBTITLE INTO TITLEBUF @Z40LB65*/ 02554000
*   /*                                                               */ 02555000
*   /*****************************************************************/ 02556000
*                                                                  0863 02557000
*   PRINTAB=''B;                    /*                       @Z40LB65*/ 02558000
         XC    PRINTAB(20),PRINTAB                                 0863 02559000
*   DARGRETP=ADDR(TITLEBUF);        /*                       @Z40LB65*/ 02560000
         L     @14,DDSTRU                                          0864 02561000
         LA    @09,TITLEBUF                                        0864 02562000
         ST    @09,DARGRETP(,@14)                                  0864 02563000
*   DARGRETL=LENGTH(TITLEBUF);      /*                       @Z40LB65*/ 02564000
         MVC   DARGRETL(2,@14),@CH01258                            0865 02565000
*   DARGSMOD=CP0MSG;                /*                       @Z40LB65*/ 02566000
         MVC   DARGSMOD(3,@14),@CC01281                            0866 02567000
*   DARGSENT=HEADING;               /*                       @Z40LB65*/ 02568000
         MVI   DARGSENT(@14),X'03'                                 0867 02569000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/ 02570000
         ST    @15,@AL00001                                        0868 02571000
         LA    @14,@CF00114                                        0868 02572000
         ST    @14,@AL00001+4                                      0868 02573000
         LA    @14,DDSTRU                                          0868 02574000
         ST    @14,@AL00001+8                                      0868 02575000
         MVI   @AL00001+8,X'80'                                    0868 02576000
         L     @15,GDTPRT(,@15)                                    0868 02577000
         LA    @01,@AL00001                                        0868 02578000
         BALR  @14,@15                                             0868 02579000
*   DARGRETP=''B;                   /*                       @Z40LB65*/ 02580000
         SLR   @15,@15                                             0869 02581000
         L     @14,DDSTRU                                          0869 02582000
         ST    @15,DARGRETP(,@14)                                  0869 02583000
*   DARGRETL=''B;                   /*                       @Z40LB65*/ 02584000
*                                                                  0870 02585000
         STH   @15,DARGRETL(,@14)                                  0870 02586000
*   /*****************************************************************/ 02587000
*   /*                                                               */ 02588000
*   /* SET UP THE PARM LIST FOR UESTA MACRO                  @Z40LB65*/ 02589000
*   /*                                                               */ 02590000
*   /*****************************************************************/ 02591000
*                                                                  0871 02592000
*   PCSTLP=ADDR(TITLEBUF);          /*                       @Z40LB65*/ 02593000
         LA    @15,TITLEBUF                                        0871 02594000
         ST    @15,PCSTLP                                          0871 02595000
*   PCSTLC=1;                       /*                       @Z40LB65*/ 02596000
*                                                                  0872 02597000
         MVC   PCSTLC(2),@CH00218                                  0872 02598000
*   /*****************************************************************/ 02599000
*   /*                                                               */ 02600000
*   /* ISSUE THE UESTA MACRO TO ESTABLISH THE TITLE          @Z40LB65*/ 02601000
*   /*                                                               */ 02602000
*   /*****************************************************************/ 02603000
*                                                                  0873 02604000
*   CALL AMSTP042(GDTTBL,PRTFILE,PCARG);/*                   @Z40LB65*/ 02605000
         L     @15,@PC00001                                        0873 02606000
         ST    @15,@AL00001                                        0873 02607000
         LA    @14,@CF00114                                        0873 02608000
         ST    @14,@AL00001+4                                      0873 02609000
         LA    @14,PCARG                                           0873 02610000
         ST    @14,@AL00001+8                                      0873 02611000
         L     @15,GDTESA(,@15)                                    0873 02612000
         LA    @01,@AL00001                                        0873 02613000
         BALR  @14,@15                                             0873 02614000
*   END HEADSET;                    /*                       @Z40LB65*/ 02615000
@EL00006 L     @13,4(,@13)                                         0874 02616000
@EF00006 DS    0H                                                  0874 02617000
@ER00006 LM    @14,@12,12(@13)                                     0874 02618000
         BR    @14                                                 0874 02619000
*                                                                  0875 02620000
*/********************************************************************/ 02621000
*/*                                                          @Z40LB65*/ 02622000
*/*     PROCEDURE NAME - MISMATCH                            @Z40LB65*/ 02623000
*/*                                                          @Z40LB65*/ 02624000
*/*     FUNCTION - THIS ROUTINE COMPARES RECORDS CHARACTER-  @Z40LB65*/ 02625000
*/*                BY-CHARACTER AND FORMATS THE RECORDS      @Z40LB65*/ 02626000
*/*                FOR PRINTING IN REPORT FORM BY REPORTER.  @Z40LB65*/ 02627000
*/*                                                          @Z40LB65*/ 02628000
*/*     INPUT - PRIMARY AND SECONDARY RECORDS                @Z40LB65*/ 02629000
*/*                                                          @Z40LB65*/ 02630000
*/*     OUTPUT - SECBUF INITIALIZED                          @Z40LB65*/ 02631000
*/*                                                          @Z40LB65*/ 02632000
*/********************************************************************/ 02633000
*                                                                  0875 02634000
*MISMATCH:                                                         0875 02635000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 02636000
MISMATCH STM   @14,@12,12(@13)                                     0875 02637000
         ST    @13,@SA00007+4                                      0875 02638000
         LA    @14,@SA00007                                        0875 02639000
         ST    @14,8(,@13)                                         0875 02640000
         LR    @13,@14                                             0875 02641000
*   OLDERID2=NEWERID2;                                             0876 02642000
         L     @08,@PC00001                                        0876 02643000
         L     @08,GDTTR2(,@08)                                    0876 02644000
         MVC   @TS00001(95),NEWERID2(@08)                          0876 02645000
         MVC   OLDERID2(95,@08),@TS00001                           0876 02646000
*   NEWID2='CPGA';                  /*                       @Z40LB65*/ 02647000
*                                                                  0877 02648000
         MVC   NEWID2(4,@08),@CC01389                              0877 02649000
*   /*****************************************************************/ 02650000
*   /*                                                               */ 02651000
*   /* FILL SECONDARY BUFFER WITH PERIODS AS IF THERE WERE   @Z40LB65*/ 02652000
*   /* NO MISMATCHES.                                        @Z40LB65*/ 02653000
*   /*                                                               */ 02654000
*   /*****************************************************************/ 02655000
*                                                                  0878 02656000
*   SECBUF(1)=PERIOD;               /*                       @Z40LB65*/ 02657000
         MVI   SECBUF,C'.'                                         0878 02658000
*   MVC(SECBUF(2:256),SECBUF(1:255));/*                      @Z40LB65*/ 02659000
         MVC   SECBUF+1(255),SECBUF                                0879 02660000
*   SECBUF(257:512)=SECBUF(1:256);  /*                       @Z40LB65*/ 02661000
         MVC   SECBUF+256(256),SECBUF                              0880 02662000
*   SECBUF(513:528)=SECBUF(1:16);   /*                       @Z40LB65*/ 02663000
*                                                                  0881 02664000
         MVC   SECBUF+512(16),SECBUF                               0881 02665000
*   /*****************************************************************/ 02666000
*   /*                                                               */ 02667000
*   /* COMPARE RECORDS CHARACTER-BY CHARACTER TO LOCATE THE  @Z40LB65*/ 02668000
*   /* MISMATCHES.                                           @Z40LB65*/ 02669000
*   /*                                                               */ 02670000
*   /*****************************************************************/ 02671000
*                                                                  0882 02672000
*   DO LOC=1 TO RECSIZE;            /*                       @Z40LB65*/ 02673000
         LA    LOC,1                                               0882 02674000
@DL00882 DS    0H                                                  0883 02675000
*     IF P(LOC)^=S(LOC) THEN                                       0883 02676000
         LR    @08,RECPTR1                                         0883 02677000
         ALR   @08,LOC                                             0883 02678000
         AL    @08,@CF01450                                        0883 02679000
         LR    @02,RECPTR2                                         0883 02680000
         ALR   @02,LOC                                             0883 02681000
         AL    @02,@CF01450                                        0883 02682000
         CLC   P(1,@08),S(@02)                                     0883 02683000
         BE    @RF00883                                            0883 02684000
*       DO;                         /*                       @Z40LB65*/ 02685000
*                                                                  0884 02686000
*         /***********************************************************/ 02687000
*         /*                                                         */ 02688000
*         /* FOR MISMATCHES TRANSLATE THE SECONDARY CHARACTER        */ 02689000
*         /*                                                 @Z40LB65*/ 02690000
*         /* TO PRINTABLE HEX AND PLACE IT IN THE SECONDARY  @Z40LB65*/ 02691000
*         /* RECORD OUTPUT BUFFER                            @Z40LB65*/ 02692000
*         /*                                                         */ 02693000
*         /***********************************************************/ 02694000
*                                                                  0885 02695000
*         SBYTEPTR=ADDR(S(LOC));    /*                       @Z40LB65*/ 02696000
         LR    SBYTEPTR,RECPTR2                                    0885 02697000
         AL    SBYTEPTR,@CF01450                                   0885 02698000
         LA    SBYTEPTR,S(LOC,SBYTEPTR)                            0885 02699000
*         HEXCHARS=''B;             /*                       @Z40LB65*/ 02700000
         XC    HEXCHARS(2),HEXCHARS                                0886 02701000
*         MVZ(HEXCHAR(1),SECBYTE);  /*                       @Z40LB65*/ 02702000
         MVZ   HEXCHAR(1),SECBYTE(SBYTEPTR)                        0887 02703000
*         SRL(HEXCHAR(1),4);        /*                       @Z40LB65*/ 02704000
         SLR   @08,@08                                             0888 02705000
         IC    @08,HEXCHAR                                         0888 02706000
         SRL   @08,4                                               0888 02707000
         STC   @08,HEXCHAR                                         0888 02708000
*         MVN(HEXCHAR(2),SECBYTE);  /*                       @Z40LB65*/ 02709000
         MVN   HEXCHAR+1(1),SECBYTE(SBYTEPTR)                      0889 02710000
*         DO NIBBLE=1 TO 2;         /*                       @Z40LB65*/ 02711000
         LA    NIBBLE,1                                            0890 02712000
@DL00890 DS    0H                                                  0891 02713000
*           IF HEXCHAR(NIBBLE)>9 THEN                              0891 02714000
         LA    @08,9                                               0891 02715000
         SLR   @15,@15                                             0891 02716000
         IC    @15,HEXCHAR-1(NIBBLE)                               0891 02717000
         CR    @15,@08                                             0891 02718000
         BNH   @RF00891                                            0891 02719000
*             HEXCHAR(NIBBLE)=ALPHA+(HEXCHAR(NIBBLE)-9);           0892 02720000
         SLR   @15,@08                                             0892 02721000
         SLR   @08,@08                                             0892 02722000
         IC    @08,ALPHA                                           0892 02723000
         ALR   @15,@08                                             0892 02724000
         STC   @15,HEXCHAR-1(NIBBLE)                               0892 02725000
*           ELSE                                                   0893 02726000
*             HEXCHAR(NIBBLE)=NUMERIC+HEXCHAR(NIBBLE);/*     @Z40LB65*/ 02727000
         B     @RC00891                                            0893 02728000
@RF00891 SLR   @08,@08                                             0893 02729000
         IC    @08,NUMERIC                                         0893 02730000
         SLR   @15,@15                                             0893 02731000
         IC    @15,HEXCHAR-1(NIBBLE)                               0893 02732000
         ALR   @08,@15                                             0893 02733000
         STC   @08,HEXCHAR-1(NIBBLE)                               0893 02734000
*         END;                      /*                       @Z40LB65*/ 02735000
@RC00891 AL    NIBBLE,@CF00218                                     0894 02736000
         CL    NIBBLE,@CF00152                                     0894 02737000
         BNH   @DL00890                                            0894 02738000
*         SECBUF(2*LOC-1:2*LOC)=HEXCHARS;/*                  @Z40LB65*/ 02739000
         LR    @08,LOC                                             0895 02740000
         ALR   @08,@08                                             0895 02741000
         LA    @02,SECBUF-2(@08)                                   0895 02742000
         MVC   0(2,@02),HEXCHARS                                   0895 02743000
*       END;                        /*                       @Z40LB65*/ 02744000
*   END;                            /*                       @Z40LB65*/ 02745000
@RF00883 AL    LOC,@CF00218                                        0897 02746000
         CL    LOC,@CF01175                                        0897 02747000
         BNH   @DL00882                                            0897 02748000
*   CALL REPORTER;                  /*                       @Z40LB65*/ 02749000
         BAL   @14,REPORTER                                        0898 02750000
*   END MISMATCH;                   /*                       @Z40LB65*/ 02751000
@EL00007 L     @13,4(,@13)                                         0899 02752000
@EF00007 DS    0H                                                  0899 02753000
@ER00007 LM    @14,@12,12(@13)                                     0899 02754000
         BR    @14                                                 0899 02755000
*                                                                  0900 02756000
*/********************************************************************/ 02757000
*/*                                                          @Z40LB65*/ 02758000
*/*     PROCEDURE NAME - REPORTER                            @Z40LB65*/ 02759000
*/*                                                          @Z40LB65*/ 02760000
*/*     FUNCTION - THIS ROUTINE PRINTS THE MISMATCHING       @Z40LB65*/ 02761000
*/*                RECORDS IN REPORT FORM.                   @Z40LB65*/ 02762000
*/*                                                          @Z40LB65*/ 02763000
*/*     INPUT - RECORD BUFFERS (PBLOCK, SECBUF, OUTBUF)      @Z40LB65*/ 02764000
*/*                                                          @Z40LB65*/ 02765000
*/*     OUTPUT - REPORT OF MISMATCHING RECORDS.              @Z40LB65*/ 02766000
*/*                                                          @Z40LB65*/ 02767000
*/********************************************************************/ 02768000
*                                                                  0900 02769000
*REPORTER:                                                         0900 02770000
*   PROCEDURE OPTIONS(SAVE,SAVEAREA);/*                      @Z40LB65*/ 02771000
*                                                                  0900 02772000
REPORTER STM   @14,@12,12(@13)                                     0900 02773000
         ST    @13,@SA00008+4                                      0900 02774000
         LA    @14,@SA00008                                        0900 02775000
         ST    @14,8(,@13)                                         0900 02776000
         LR    @13,@14                                             0900 02777000
*   /*****************************************************************/ 02778000
*   /*                                                               */ 02779000
*   /* LOCAL DECLARATIONS                                    @Z40LB65*/ 02780000
*   /*                                                               */ 02781000
*   /*****************************************************************/ 02782000
*                                                                  0901 02783000
*   DCL                                                            0901 02784000
*     CHRLINE FIXED(8) CONSTANT(4); /* CHR OUTPUT LINE       @Z40LB65*/ 02785000
*   DCL                                                            0902 02786000
*     CHRELINE FIXED(8) CONSTANT(5);/* CHR ERROR LINE        @Z40LB65*/ 02787000
*   DCL                                                            0903 02788000
*     RECORDS FIXED(8) CONSTANT(6); /* RECORD LINES          @Z40LB65*/ 02789000
*   OLDERID2=NEWERID2;                                             0904 02790000
         L     @08,@PC00001                                        0904 02791000
         L     @08,GDTTR2(,@08)                                    0904 02792000
         MVC   @TS00001(95),NEWERID2(@08)                          0904 02793000
         MVC   OLDERID2(95,@08),@TS00001                           0904 02794000
*   NEWID2='CPHA';                  /*                       @Z40LB65*/ 02795000
*                                                                  0905 02796000
         MVC   NEWID2(4,@08),@CC01406                              0905 02797000
*   /*****************************************************************/ 02798000
*   /*                                                               */ 02799000
*   /* PRINT THE PROPER CHR RECORD                           @Z40LB65*/ 02800000
*   /*                                                               */ 02801000
*   /*****************************************************************/ 02802000
*                                                                  0906 02803000
*   DARGDBP=ADDR(CHR);              /*                       @Z40LB65*/ 02804000
         L     @08,DDSTRU                                          0906 02805000
         LA    @02,CHR                                             0906 02806000
         ST    @02,DARGDBP(,@08)                                   0906 02807000
*   DARGILP=LENGTH(CHR);            /*                       @Z40LB65*/ 02808000
         MVC   DARGILP(2,@08),@CH00161                             0907 02809000
*   IF CHRERROR=ON THEN                                            0908 02810000
         TM    CHRERROR,B'10000000'                                0908 02811000
         BNO   @RF00908                                            0908 02812000
*     DARGSENT=CHRELINE;            /*                       @Z40LB65*/ 02813000
         MVI   DARGSENT(@08),X'05'                                 0909 02814000
*   ELSE                                                           0910 02815000
*     DARGSENT=CHRLINE;             /*                       @Z40LB65*/ 02816000
         B     @RC00908                                            0910 02817000
@RF00908 L     @08,DDSTRU                                          0910 02818000
         MVI   DARGSENT(@08),X'04'                                 0910 02819000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/ 02820000
*                                                                  0911 02821000
@RC00908 L     @08,@PC00001                                        0911 02822000
         ST    @08,@AL00001                                        0911 02823000
         LA    @02,@CF00114                                        0911 02824000
         ST    @02,@AL00001+4                                      0911 02825000
         LA    @02,DDSTRU                                          0911 02826000
         ST    @02,@AL00001+8                                      0911 02827000
         MVI   @AL00001+8,X'80'                                    0911 02828000
         L     @15,GDTPRT(,@08)                                    0911 02829000
         LA    @01,@AL00001                                        0911 02830000
         BALR  @14,@15                                             0911 02831000
*   /*****************************************************************/ 02832000
*   /*                                                               */ 02833000
*   /* FORMAT AND PRINT THE RECORDS THAT DID NOT MATCH       @Z40LB65*/ 02834000
*   /*                                                               */ 02835000
*   /*****************************************************************/ 02836000
*                                                                  0912 02837000
*   OPPREFIX=PPREFIX;               /*                       @Z40LB65*/ 02838000
         MVC   OPPREFIX(8,OUTPTR),PPREFIX(RECPTR1)                 0912 02839000
*   OSPREFIX=SECBUF(1:16);          /*                       @Z40LB65*/ 02840000
         MVC   OSPREFIX(16,OUTPTR),SECBUF                          0913 02841000
*   DO LINE=1 TO 8;                 /*                       @Z40LB65*/ 02842000
         LA    LINE,1                                              0914 02843000
@DL00914 DS    0H                                                  0915 02844000
*     OPLINE(LINE)=PREC(32*(LINE-1)+1:32*LINE);/*            @Z40LB65*/ 02845000
         LR    @08,LINE                                            0915 02846000
         MH    @08,@CH01205                                        0915 02847000
         ST    @08,@TF00001                                        0915 02848000
         ALR   @08,OUTPTR                                          0915 02849000
         AL    @08,@CF01451                                        0915 02850000
         MVI   OPLINE-23(@08),C' '                                 0915 02851000
         MVC   OPLINE-22(30,@08),OPLINE-23(@08)                    0915 02852000
         LR    @15,LINE                                            0915 02853000
         SLL   @15,5                                               0915 02854000
         LR    @14,LINE                                            0915 02855000
         BCTR  @14,0                                               0915 02856000
         LR    @07,@14                                             0915 02857000
         SLL   @07,5                                               0915 02858000
         SLR   @15,@07                                             0915 02859000
         BCTR  @15,0                                               0915 02860000
         ALR   @07,RECPTR1                                         0915 02861000
         EX    @15,@SM01452                                        0915 02862000
*     OSLINE(LINE)=SECBUF(64*(LINE-1)+17:64*LINE+16);/*      @Z40LB65*/ 02863000
         LR    @08,OUTPTR                                          0916 02864000
         AL    @08,@TF00001                                        0916 02865000
         AL    @08,@CF01454                                        0916 02866000
         MVI   OSLINE-55(@08),C' '                                 0916 02867000
         MVC   OSLINE-54(62,@08),OSLINE-55(@08)                    0916 02868000
         LR    @15,LINE                                            0916 02869000
         SLL   @15,6                                               0916 02870000
         SLL   @14,6                                               0916 02871000
         SLR   @15,@14                                             0916 02872000
         BCTR  @15,0                                               0916 02873000
         LA    @01,SECBUF+16(@14)                                  0916 02874000
         EX    @15,@SM01455                                        0916 02875000
*   END;                            /*                       @Z40LB65*/ 02876000
         AL    LINE,@CF00218                                       0917 02877000
         CL    LINE,@CF00178                                       0917 02878000
         BNH   @DL00914                                            0917 02879000
*   DARGDBP=ADDR(OUTBUF);           /*                       @Z40LB65*/ 02880000
         L     @08,DDSTRU                                          0918 02881000
         ST    OUTPTR,DARGDBP(,@08)                                0918 02882000
*   DARGILP=LENGTH(OUTBUF);         /*                       @Z40LB65*/ 02883000
         MVC   DARGILP(2,@08),@CH01201                             0919 02884000
*   DARGSENT=RECORDS;               /*                       @Z40LB65*/ 02885000
         MVI   DARGSENT(@08),X'06'                                 0920 02886000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB65*/ 02887000
         L     @15,@PC00001                                        0921 02888000
         ST    @15,@AL00001                                        0921 02889000
         LA    @14,@CF00114                                        0921 02890000
         ST    @14,@AL00001+4                                      0921 02891000
         LA    @14,DDSTRU                                          0921 02892000
         ST    @14,@AL00001+8                                      0921 02893000
         MVI   @AL00001+8,X'80'                                    0921 02894000
         L     @15,GDTPRT(,@15)                                    0921 02895000
         LA    @01,@AL00001                                        0921 02896000
         BALR  @14,@15                                             0921 02897000
*   END REPORTER;                   /*                       @Z40LB65*/ 02898000
@EL00008 L     @13,4(,@13)                                         0922 02899000
@EF00008 DS    0H                                                  0922 02900000
@ER00008 LM    @14,@12,12(@13)                                     0922 02901000
         BR    @14                                                 0922 02902000
*                                                                  0923 02903000
*/***********************************************************@Y30LB39*/ 02904000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 02905000
*/*                                                          @Y30LB39*/ 02906000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 02907000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 02908000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 02909000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 02910000
*/*                                                          @Y30LB39*/ 02911000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 02912000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 02913000
*/*   IN SSECBCD.                                            @Y30LB39*/ 02914000
*/*                                                          @Y30LB39*/ 02915000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 02916000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 02917000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 02918000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 02919000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 02920000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 02921000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 02922000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 02923000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 02924000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 02925000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 02926000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 02927000
*/*                                                          @Y30LB39*/ 02928000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 02929000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 02930000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 02931000
*/*                                                          @Y30LB39*/ 02932000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 02933000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 02934000
*/*                                                          @Y30LB39*/ 02935000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 02936000
*/*                                                          @Y30LB39*/ 02937000
*/***********************************************************@Y30LB39*/ 02938000
*                                                                  0923 02939000
*                                   /*                       @Y30LB39*/ 02940000
*SSCMSG:                                                           0923 02941000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 02942000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   02943000
*                                                            @Y30LB39*/ 02944000
SSCMSG   STM   @14,@12,@SA00009                                    0923 02945000
         MVC   @PC00009(8),0(@01)                                  0923 02946000
*                                   /*                       @Y30LB39*/ 02947000
*                                                                  0924 02948000
*   /*****************************************************************/ 02949000
*   /*                                                               */ 02950000
*   /*                                                       @Y30LB39*/ 02951000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 02952000
*   /*                                                       @Y30LB39*/ 02953000
*   /*                                                               */ 02954000
*   /*****************************************************************/ 02955000
*                                                                  0924 02956000
*                                   /*                       @Y30LB39   02957000
*                                                            @Y30LB39*/ 02958000
*                                                                  0924 02959000
*   /*****************************************************************/ 02960000
*   /*                                                               */ 02961000
*   /*                                                       @Y30LB39*/ 02962000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 02963000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 02964000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 02965000
*   /*                                                       @Y30LB39*/ 02966000
*   /*                                                               */ 02967000
*   /*****************************************************************/ 02968000
*                                                                  0924 02969000
*                                   /*                       @Y30LB39*/ 02970000
*   DCL                                                            0924 02971000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 02972000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 02973000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 02974000
*   DCL                                                            0925 02975000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   02976000
*                                                            @Y30LB39   02977000
*                                                            @Y30LB39*/ 02978000
*                                                                  0925 02979000
*   /*****************************************************************/ 02980000
*   /*                                                               */ 02981000
*   /*                                                       @Y30LB39*/ 02982000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 02983000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 02984000
*   /*                                                       @Y30LB39*/ 02985000
*   /*                                                               */ 02986000
*   /*****************************************************************/ 02987000
*                                                                  0926 02988000
*                                   /*                       @Y30LB39*/ 02989000
*   DCL                                                            0926 02990000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 02991000
*   DCL                                                            0927 02992000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   02993000
*                                                            @Y30LB39*/ 02994000
*                                                                  0927 02995000
*   /*****************************************************************/ 02996000
*   /*                                                               */ 02997000
*   /*                                                       @Y30LB39*/ 02998000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 02999000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 03000000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 03001000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 03002000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 03003000
*   /*                                                       @Y30LB39*/ 03004000
*   /*                                                               */ 03005000
*   /*****************************************************************/ 03006000
*                                                                  0928 03007000
*                                   /*                       @Y30LB39*/ 03008000
*   DECLARE                                                        0928 03009000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   03010000
*                                                            @Y30LB39*/ 03011000
*                                                                  0928 03012000
*   /*****************************************************************/ 03013000
*   /*                                                               */ 03014000
*   /*                                                       @Y30LB39*/ 03015000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 03016000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 03017000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 03018000
*   /* IDCTSCM0.                                             @Y30LB39*/ 03019000
*   /*                                                       @Y30LB39*/ 03020000
*   /*                                                               */ 03021000
*   /*****************************************************************/ 03022000
*                                                                  0929 03023000
*                                   /*                       @Y30LB39*/ 03024000
*   DECLARE                                                        0929 03025000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   03026000
*                                                            @Y30LB39*/ 03027000
*                                                                  0929 03028000
*   /*****************************************************************/ 03029000
*   /*                                                               */ 03030000
*   /*                                                       @Y30LB39*/ 03031000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 03032000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 03033000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 03034000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 03035000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 03036000
*   /*                                                       @Y30LB39*/ 03037000
*   /*                                                               */ 03038000
*   /*****************************************************************/ 03039000
*                                                                  0930 03040000
*                                   /*                       @Y30LB39*/ 03041000
*   DECLARE                                                        0930 03042000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 03043000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   03044000
*                                                            @Y30LB39*/ 03045000
*                                                                  0930 03046000
*   /*****************************************************************/ 03047000
*   /*                                                               */ 03048000
*   /*                                                       @Y30LB39*/ 03049000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 03050000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 03051000
*   /*                                                       @Y30LB39*/ 03052000
*   /*                                                               */ 03053000
*   /*****************************************************************/ 03054000
*                                                                  0931 03055000
*                                   /*                       @Y30LB39*/ 03056000
*   DECLARE                                                        0931 03057000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   03058000
*                                                            @Y30LB39*/ 03059000
*                                                                  0931 03060000
*   /*****************************************************************/ 03061000
*   /*                                                               */ 03062000
*   /*                                                       @Y30LB39*/ 03063000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 03064000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 03065000
*   /*                                                       @Y30LB39*/ 03066000
*   /*                                                               */ 03067000
*   /*****************************************************************/ 03068000
*                                                                  0932 03069000
*                                   /*                       @Y30LB39*/ 03070000
*   DECLARE                                                        0932 03071000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   03072000
*                                                            @Y30LB39*/ 03073000
*                                   /*                       @Y30LB39*/ 03074000
*                                                                  0933 03075000
*   /*****************************************************************/ 03076000
*   /*                                                               */ 03077000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 03078000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 03079000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 03080000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 03081000
*   /*                                                       @Y30LB39*/ 03082000
*   /*                                                               */ 03083000
*   /*****************************************************************/ 03084000
*                                                                  0933 03085000
*                                   /*                       @Y30LB39*/ 03086000
*   OLDERID2=NEWERID2;                                             0933 03087000
         L     @15,@PC00001                                        0933 03088000
         L     @14,GDTTR2(,@15)                                    0933 03089000
         MVC   @TS00001(95),NEWERID2(@14)                          0933 03090000
         MVC   OLDERID2(95,@14),@TS00001                           0933 03091000
*   NEWID2='SSAA';                  /*                       @Y30LB39   03092000
*                                                            @Y30LB39*/ 03093000
*                                                                  0934 03094000
         MVC   NEWID2(4,@14),@CC01429                              0934 03095000
*   /*****************************************************************/ 03096000
*   /*                                                               */ 03097000
*   /*                                                       @Y30LB39*/ 03098000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 03099000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 03100000
*   /*                                                       @Y30LB39*/ 03101000
*   /*                                                               */ 03102000
*   /*****************************************************************/ 03103000
*                                                                  0935 03104000
*                                   /*                       @Y30LB39*/ 03105000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   03106000
*                                                            @Y30LB39*/ 03107000
*                                                                  0935 03108000
         LA    @14,SSDRGLT                                         0935 03109000
         ST    @14,SSDLPTR                                         0935 03110000
*   /*****************************************************************/ 03111000
*   /*                                                               */ 03112000
*   /*                                                       @Y30LB39*/ 03113000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 03114000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 03115000
*   /*                                                       @Y30LB39*/ 03116000
*   /*                                                               */ 03117000
*   /*****************************************************************/ 03118000
*                                                                  0936 03119000
*                                   /*                       @Y30LB39*/ 03120000
*   IF SSRCODE>0 THEN                                              0936 03121000
         L     @09,@PC00009                                        0936 03122000
         L     @09,SSRCODE(,@09)                                   0936 03123000
         LTR   @09,@09                                             0936 03124000
         BNP   @RF00936                                            0936 03125000
*     DO;                           /*                       @Y30LB39   03126000
*                                                            @Y30LB39*/ 03127000
*                                                                  0937 03128000
*       /*************************************************************/ 03129000
*       /*                                                           */ 03130000
*       /*                                                   @Y30LB39*/ 03131000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 03132000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 03133000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 03134000
*       /* CODES.                                            @Y30LB39*/ 03135000
*       /*                                                   @Y30LB39*/ 03136000
*       /*                                                           */ 03137000
*       /*************************************************************/ 03138000
*                                                                  0938 03139000
*                                   /*                       @Y30LB39*/ 03140000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 03141000
         XC    SSDRGLT(20),SSDRGLT                                 0938 03142000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 03143000
         LA    @03,SSINXLST                                        0939 03144000
         ST    @03,DARGRETP(,@14)                                  0939 03145000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 03146000
         MVC   DARGSMOD(3,@14),SSMODSS0                            0940 03147000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 03148000
         MVI   DARGSENT(@14),X'01'                                 0941 03149000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   03150000
*                                                            @Y30LB39*/ 03151000
*                                                                  0942 03152000
         MVC   DARGRETL(2,@14),@CH01433                            0942 03153000
*       /*************************************************************/ 03154000
*       /*                                                           */ 03155000
*       /*                                                   @Y30LB39*/ 03156000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 03157000
*       /* ARRAY.                                            @Y30LB39*/ 03158000
*       /*                                                   @Y30LB39*/ 03159000
*       /*                                                           */ 03160000
*       /*************************************************************/ 03161000
*                                                                  0943 03162000
*                                   /*                       @Y30LB39*/ 03163000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   03164000
*                                                            @Y30LB39*/ 03165000
*                                                                  0943 03166000
         ST    @15,@AL00001                                        0943 03167000
         LA    @03,@CF00114                                        0943 03168000
         ST    @03,@AL00001+4                                      0943 03169000
         LA    @03,SSDLPTR                                         0943 03170000
         ST    @03,@AL00001+8                                      0943 03171000
         MVI   @AL00001+8,X'80'                                    0943 03172000
         L     @15,GDTPRT(,@15)                                    0943 03173000
         LA    @01,@AL00001                                        0943 03174000
         BALR  @14,@15                                             0943 03175000
*       /*************************************************************/ 03176000
*       /*                                                           */ 03177000
*       /*                                                   @Y30LB39*/ 03178000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 03179000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 03180000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 03181000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 03182000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 03183000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 03184000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 03185000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 03186000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 03187000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 03188000
*       /* REASON CODE.                                      @Y30LB39*/ 03189000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 03190000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 03191000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 03192000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 03193000
*       /*                                                   @Y30LB39*/ 03194000
*       /*                                                           */ 03195000
*       /*************************************************************/ 03196000
*                                                                  0944 03197000
*                                   /*                       @Y30LB39*/ 03198000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 03199000
         LA    ENTRYNUM,1                                          0944 03200000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   0945 03201000
@DL00945 DS    0H                                                  0946 03202000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 03203000
         AL    ENTRYNUM,@CF00218                                   0946 03204000
*       END;                        /*                       @Y30LB39   03205000
*                                                            @Y30LB39*/ 03206000
*                                                                  0947 03207000
@DE00945 L     @03,@PC00009                                        0947 03208000
         LR    @15,ENTRYNUM                                        0947 03209000
         ALR   @15,@15                                             0947 03210000
         LH    @15,SSARRAY-2(@15)                                  0947 03211000
         CH    @15,SSRHALF(,@03)                                   0947 03212000
         BE    @DC00945                                            0947 03213000
         SLR   @14,@14                                             0947 03214000
         CR    @15,@14                                             0947 03215000
         BNE   @DL00945                                            0947 03216000
@DC00945 DS    0H                                                  0948 03217000
*       /*************************************************************/ 03218000
*       /*                                                           */ 03219000
*       /*                                                   @Y30LB39*/ 03220000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 03221000
*       /*                                                   @Y30LB39*/ 03222000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 03223000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 03224000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 03225000
*       /* CODE OR                                           @Y30LB39*/ 03226000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 03227000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 03228000
*       /*                                                   @Y30LB39*/ 03229000
*       /*                                                           */ 03230000
*       /*************************************************************/ 03231000
*                                                                  0948 03232000
*                                   /*                       @Y30LB39*/ 03233000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 03234000
         XC    SSDRGLT(20),SSDRGLT                                 0948 03235000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 03236000
         L     @09,SSDLPTR                                         0949 03237000
         MVC   DARGSMOD(3,@09),SSMODSS0                            0949 03238000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 03239000
         STC   ENTRYNUM,DARGSENT(,@09)                             0950 03240000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 03241000
         CR    @15,@14                                             0951 03242000
         BNE   @RF00951                                            0951 03243000
*         DO;                       /*                       @Y30LB39*/ 03244000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 03245000
         ST    @03,DARGDBP(,@09)                                   0953 03246000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 03247000
         MVC   DARGILP(2,@09),@CH00041                             0954 03248000
*         END;                      /*                       @Y30LB39*/ 03249000
*     END;                          /*                       @Y30LB39*/ 03250000
*                                   /*                       @Y30LB39*/ 03251000
*                                                                  0957 03252000
*   /*****************************************************************/ 03253000
*   /*                                                               */ 03254000
*   /*                                                       @Y30LB39*/ 03255000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 03256000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 03257000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 03258000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 03259000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 03260000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 03261000
*   /* POST CODE.                                            @Y30LB39*/ 03262000
*   /*                                                       @Y30LB39*/ 03263000
*   /*                                                               */ 03264000
*   /*****************************************************************/ 03265000
*                                                                  0957 03266000
*                                   /*                       @Y30LB39*/ 03267000
*   ELSE                            /*                       @Y30LB39*/ 03268000
*     DO;                           /*                       @Y30LB39*/ 03269000
         B     @RC00936                                            0957 03270000
@RF00936 DS    0H                                                  0958 03271000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 03272000
         XC    SSDRGLT(20),SSDRGLT                                 0958 03273000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 03274000
         L     @15,SSDLPTR                                         0959 03275000
         MVC   DARGSMOD(3,@15),SSMODCM0                            0959 03276000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 03277000
         MVC   DARGSENT(1,@15),SSMSGNUM                            0960 03278000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 03279000
         L     @14,@PC00009+4                                      0961 03280000
         ST    @14,DARGDBP(,@15)                                   0961 03281000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 03282000
         MVC   DARGILP(2,@15),@CH00218                             0962 03283000
*     END;                          /*                       @Y30LB39   03284000
*                                                            @Y30LB39*/ 03285000
*                                                                  0963 03286000
*   /*****************************************************************/ 03287000
*   /*                                                               */ 03288000
*   /*                                                       @Y30LB39*/ 03289000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 03290000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 03291000
*   /*                                                       @Y30LB39*/ 03292000
*   /*                                                               */ 03293000
*   /*****************************************************************/ 03294000
*                                                                  0964 03295000
*                                   /*                       @Y30LB39*/ 03296000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   03297000
*                                                            @Y30LB39*/ 03298000
*                                                                  0964 03299000
@RC00936 L     @15,@PC00001                                        0964 03300000
         ST    @15,@AL00001                                        0964 03301000
         LA    @14,@CF00114                                        0964 03302000
         ST    @14,@AL00001+4                                      0964 03303000
         LA    @14,SSDLPTR                                         0964 03304000
         ST    @14,@AL00001+8                                      0964 03305000
         MVI   @AL00001+8,X'80'                                    0964 03306000
         L     @15,GDTPRT(,@15)                                    0964 03307000
         LA    @01,@AL00001                                        0964 03308000
         BALR  @14,@15                                             0964 03309000
*   /*****************************************************************/ 03310000
*   /*                                                               */ 03311000
*   /*                                                       @Y30LB39*/ 03312000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 03313000
*   /*                                                       @Y30LB39*/ 03314000
*   /*                                                               */ 03315000
*   /*****************************************************************/ 03316000
*                                                                  0965 03317000
*                                   /*                       @Y30LB39   03318000
*                                                            @Y30LB39*/ 03319000
*   RETURN CODE(0);                 /*                       @Y30LB39   03320000
*                                                            @Y30LB39*/ 03321000
         SLR   @15,@15                                             0965 03322000
         L     @14,@SA00009                                        0965 03323000
         LM    @00,@12,@SA00009+8                                  0965 03324000
         BR    @14                                                 0965 03325000
*   END SSCMSG;                     /*                       @Y30LB39*/ 03326000
*   END IDCCP01                     /*                       @Z40LB65*/ 03327000
*                                                                  0967 03328000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03329000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 03330000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 03331000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 03332000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 03333000
*/*%INCLUDE SYSLIB  (IDCCSCP )                                       */ 03334000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 03335000
*                                                                  0967 03336000
*       ;                                                          0967 03337000
@DATA    DS    0H                                                       03338000
@CH00161 DC    H'3'                                                     03339000
@CH00285 DC    H'5'                                                     03340000
@CH00567 DC    H'12'                                                    03341000
@CH00309 DC    H'24'                                                    03342000
@CH01303 DC    H'38'                                                    03343000
@CH01208 DC    H'64'                                                    03344000
@CH01433 DC    H'120'                                                   03345000
@CH01258 DC    H'121'                                                   03346000
@CH01201 DC    H'792'                                                   03347000
@SM01452 MVC   OPLINE-24(0,@08),PREC(@07)                               03348000
@SM01455 MVC   OSLINE-56(0,@08),0(@01)                                  03349000
@DATD    DSECT                                                          03350000
         DS    0F                                                       03351000
@SA00001 DS    18F                                                      03352000
@PC00001 DS    3F                                                       03353000
@SA00002 DS    18F                                                      03354000
@SA00003 DS    18F                                                      03355000
@SA00004 DS    18F                                                      03356000
@SA00009 DS    15F                                                      03357000
@PC00009 DS    2F                                                       03358000
@SA00005 DS    18F                                                      03359000
@SA00006 DS    18F                                                      03360000
@SA00007 DS    18F                                                      03361000
@SA00008 DS    18F                                                      03362000
@AL00001 DS    6A                                                       03363000
@TF00001 DS    F                                                        03364000
@AFTEMPS DS    1F                                                       03365000
IDCCP01  CSECT                                                          03366000
         DS    0F                                                       03367000
@CF00114 DC    F'0'                                                     03368000
@CF00218 DC    F'1'                                                     03369000
@CH00218 EQU   @CF00218+2                                               03370000
@CF00152 DC    F'2'                                                     03371000
@CH00152 EQU   @CF00152+2                                               03372000
@CF00041 DC    F'4'                                                     03373000
@CH00041 EQU   @CF00041+2                                               03374000
@CF00178 DC    F'8'                                                     03375000
@CH00178 EQU   @CF00178+2                                               03376000
@CF00473 DC    F'16'                                                    03377000
@CF01345 DC    F'18'                                                    03378000
@CF00220 DC    F'32'                                                    03379000
@CF01205 DC    F'96'                                                    03380000
@CH01205 EQU   @CF01205+2                                               03381000
@CF01175 DC    F'264'                                                   03382000
@CH01175 EQU   @CF01175+2                                               03383000
@CF01179 DC    F'8448'                                                  03384000
@CF01177 DC    F'17688'                                                 03385000
@CF01451 DC    F'-72'                                                   03386000
@CF01454 DC    F'-40'                                                   03387000
@CF01450 DC    F'-1'                                                    03388000
@CF01444 DC    XL4'0000FFFF'                                            03389000
@DATD    DSECT                                                          03390000
         DS    0D                                                       03391000
LISTSCAN DS    A                                                        03392000
IOCSPTR  DS    A                                                        03393000
OPNPTR   DS    A                                                        03394000
DDSTRU   DS    A                                                        03395000
FSADDR   DS    A                                                        03396000
ERCNVADR DS    A                                                        03397000
CCMSGPTR DS    A                                                        03398000
CMMSGPTR DS    A                                                        03399000
CTMSGPTR DS    A                                                        03400000
ELEMENT  DS    F                                                        03401000
ACQPTR   DS    A                                                        03402000
WORKPTR1 DS    A                                                        03403000
WORKPTR2 DS    A                                                        03404000
REASONCD DS    F                                                        03405000
TRKPTR1  DS    A                                                        03406000
TRKPTR2  DS    A                                                        03407000
COTPTR   DS    A                                                        03408000
VOLSRPTR DS    A                                                        03409000
UCBPTR   DS    A                                                        03410000
SSDLPTR  DS    A                                                        03411000
LISTPTR  DS    A                                                        03412000
SETRC    DS    H                                                        03413000
LISTLN   DS    FL1                                                      03414000
@TS00001 DS    CL95                                                     03415000
         DS    CL2                                                      03416000
COTBLIST DS    CL24                                                     03417000
         ORG   COTBLIST                                                 03418000
COTBLL   DS    FL4                                                      03419000
COTBOP   DS    FL1                                                      03420000
@NM00091 DS    CL1                                                      03421000
COTBFLG  DS    BL2                                                      03422000
         ORG   COTBFLG                                                  03423000
COTBTID  DS    BL1                                                      03424000
@NM00092 EQU   COTBFLG+0                                                03425000
COTBTRX  DS    BL1                                                      03426000
COTBTRY  EQU   COTBFLG+1                                                03427000
COTBTRA  EQU   COTBFLG+1                                                03428000
COTBTRI  EQU   COTBFLG+1                                                03429000
@NM00093 EQU   COTBFLG+1                                                03430000
         ORG   COTBLIST+8                                               03431000
COTBEXTS DS    CL4                                                      03432000
COTBVOL  DS    CL6                                                      03433000
COTBASID DS    CL2                                                      03434000
COTBECB  DS    FL4                                                      03435000
         ORG   COTBLIST+24                                              03436000
PRINTAB  DS    CL20                                                     03437000
HEXCHARS DS    CL2                                                      03438000
         ORG   HEXCHARS                                                 03439000
HEXCHAR  DS    2CL1                                                     03440000
         ORG   HEXCHARS+2                                               03441000
SWITCHES DS    BL1                                                      03442000
         ORG   SWITCHES                                                 03443000
CHRERROR DS    BL1                                                      03444000
MATCHERR EQU   SWITCHES+0                                               03445000
FIRSTERR EQU   SWITCHES+0                                               03446000
ACQSW1   EQU   SWITCHES+0                                               03447000
ACQSW2   EQU   SWITCHES+0                                               03448000
@NM00099 EQU   SWITCHES+0                                               03449000
         ORG   SWITCHES+1                                               03450000
SECBUF   DS    CL528                                                    03451000
CHR      DS    CL3                                                      03452000
         ORG   CHR                                                      03453000
C        DS    FL1                                                      03454000
H        DS    FL1                                                      03455000
R        DS    FL1                                                      03456000
         ORG   CHR+3                                                    03457000
INTTBL   DS    CL61                                                     03458000
         ORG   INTTBL                                                   03459000
ADDRDIF1 DS    FL2                                                      03460000
ADDRDIF2 DS    FL2                                                      03461000
DDNAME1  DS    CL8                                                      03462000
DDNAME2  DS    CL8                                                      03463000
EXTCHRS1 DS    CL10                                                     03464000
         ORG   EXTCHRS1                                                 03465000
SBDY1    DS    CL5                                                      03466000
         ORG   SBDY1                                                    03467000
SCYL1    DS    CL2                                                      03468000
STRK1    DS    CL2                                                      03469000
SREC1    DS    CL1                                                      03470000
         ORG   EXTCHRS1+5                                               03471000
EBDY1    DS    CL5                                                      03472000
         ORG   EBDY1                                                    03473000
ECYL1    DS    CL2                                                      03474000
ETRK1    DS    CL2                                                      03475000
EREC1    DS    CL1                                                      03476000
         ORG   INTTBL+30                                                03477000
WORKVOL1 DS    CL6                                                      03478000
EXTCHRS2 DS    CL10                                                     03479000
         ORG   EXTCHRS2                                                 03480000
SBDY2    DS    CL5                                                      03481000
         ORG   SBDY2                                                    03482000
SCYL2    DS    CL2                                                      03483000
STRK2    DS    CL2                                                      03484000
SREC2    DS    CL1                                                      03485000
         ORG   EXTCHRS2+5                                               03486000
EBDY2    DS    CL5                                                      03487000
         ORG   EBDY2                                                    03488000
ECYL2    DS    CL2                                                      03489000
ETRK2    DS    CL2                                                      03490000
EREC2    DS    CL1                                                      03491000
         ORG   INTTBL+46                                                03492000
WORKVOL2 DS    CL6                                                      03493000
SDGCHR   DS    CL3                                                      03494000
         ORG   SDGCHR                                                   03495000
SDGC     DS    FL1                                                      03496000
SDGH     DS    FL1                                                      03497000
SDGR     DS    FL1                                                      03498000
         ORG   INTTBL+55                                                03499000
VVACHR   DS    CL3                                                      03500000
         ORG   VVACHR                                                   03501000
VVAC     DS    FL1                                                      03502000
VVAH     DS    FL1                                                      03503000
VVAR     DS    FL1                                                      03504000
         ORG   INTTBL+58                                                03505000
DOCHR    DS    CL3                                                      03506000
         ORG   DOCHR                                                    03507000
DOC      DS    FL1                                                      03508000
DOH      DS    FL1                                                      03509000
DOR      DS    FL1                                                      03510000
         ORG   INTTBL+61                                                03511000
NULLDDN  DS    CL8                                                      03512000
         ORG   NULLDDN                                                  03513000
NULL     DS    CL2                                                      03514000
@NM00104 DS    CL6                                                      03515000
         ORG   NULLDDN+8                                                03516000
TITLEBUF DS    CL121                                                    03517000
UCBLIST  DS    CL29                                                     03518000
EXOLIST  DS    CL34                                                     03519000
ALL1LIST DS    CL31                                                     03520000
ALL2LIST DS    CL31                                                     03521000
EXGALIST DS    CL32                                                     03522000
ACQLST1  DS    CL96                                                     03523000
ACQLST2  DS    CL96                                                     03524000
         DS    CL1                                                      03525000
ULLIST   DS    CL12                                                     03526000
         ORG   ULLIST                                                   03527000
ULCOUNT  DS    FL2                                                      03528000
ULDEVLEN DS    FL2                                                      03529000
ULDEVTYP DS    CL8                                                      03530000
         ORG   ULLIST+12                                                03531000
DMPSTG   DS    CL17                                                     03532000
IOINFO   DS    CL1                                                      03533000
INFOAREA DS    CL38                                                     03534000
         ORG   INFOAREA                                                 03535000
HEADER   DS    CL4                                                      03536000
         ORG   HEADER                                                   03537000
WORKLEN  DS    FL2                                                      03538000
RETNLEN  DS    FL2                                                      03539000
         ORG   INFOAREA+4                                               03540000
TYPE     DS    FL2                                                      03541000
DATALEN  DS    FL2                                                      03542000
VOLAREA  DS    5CL6                                                     03543000
         ORG   INFOAREA+38                                              03544000
ECBCODE  DS    CL1                                                      03545000
         DS    CL1                                                      03546000
CCHHR    DS    CL5                                                      03547000
         ORG   CCHHR                                                    03548000
CC       DS    FL2                                                      03549000
HH       DS    FL2                                                      03550000
RR       DS    FL1                                                      03551000
         ORG   CCHHR+5                                                  03552000
         DS    CL1                                                      03553000
CCHHR1   DS    CL5                                                      03554000
         ORG   CCHHR1                                                   03555000
CC1      DS    FL2                                                      03556000
HH1      DS    FL2                                                      03557000
RR1      DS    FL1                                                      03558000
         ORG   CCHHR1+5                                                 03559000
         DS    CL1                                                      03560000
CCHHR2   DS    CL5                                                      03561000
         ORG   CCHHR2                                                   03562000
CC2      DS    FL2                                                      03563000
HH2      DS    FL2                                                      03564000
RR2      DS    FL1                                                      03565000
         ORG   CCHHR2+5                                                 03566000
         DS    CL3                                                      03567000
PCARG    DS    CL33                                                     03568000
         ORG   PCARG                                                    03569000
PCMTLP   DS    AL4                                                      03570000
PCSTLP   DS    AL4                                                      03571000
PCFLP    DS    AL4                                                      03572000
PCPCP    DS    AL4                                                      03573000
PCPNL    DS    FL2                                                      03574000
PCPTL    DS    FL2                                                      03575000
PCPDL    DS    FL2                                                      03576000
PCMTLC   DS    FL2                                                      03577000
PCSTLC   DS    FL2                                                      03578000
PCFLC    DS    FL2                                                      03579000
PCLW     DS    FL2                                                      03580000
PCPD     DS    FL2                                                      03581000
PCDSC    DS    AL1                                                      03582000
         ORG   PCARG+33                                                 03583000
SSDRGLT  DS    CL20                                                     03584000
         DS    CL3                                                      03585000
SSINXLST DS    CL120                                                    03586000
         ORG   SSINXLST                                                 03587000
SSARRAY  DS    60H                                                      03588000
         ORG   SSINXLST+120                                             03589000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03590000
@ENDDATD EQU   *                                                        03591000
IDCCP01  CSECT                                                          03592000
         DS    0F                                                       03593000
@SIZDATD DC    AL1(0)                                                   03594000
         DC    AL3(@ENDDATD-@DATD)                                      03595000
         DS    0D                                                       03596000
ALPHA    DC    XL1'C0'                                                  03597000
NUMERIC  DC    XL1'F0'                                                  03598000
SSMSGNUM DC    AL1(56)                                                  03599000
@CC01334 DC    C'COTBLIST'                                              03600000
@CC01329 DC    C'ACQLST2'                                               03601000
@CC01332 DC    C'ACQLST1'                                               03602000
@CC01271 DC    C'SDG00'                                                 03603000
@CC01336 DC    C'CTMSG'                                                 03604000
@CC01284 DC    C'CPAA'                                                  03605000
@CC01295 DC    C'CPAZ'                                                  03606000
@CC01311 DC    C'CPBA'                                                  03607000
@CC01328 DC    C'CPCA'                                                  03608000
@CC01331 DC    C'CPCB'                                                  03609000
@CC01333 DC    C'CPCC'                                                  03610000
@CC01335 DC    C'CPCD'                                                  03611000
@CC01337 DC    C'CPCE'                                                  03612000
@CC01338 DC    C'CPCF'                                                  03613000
@CC01343 DC    C'CPDA'                                                  03614000
@CC01366 DC    C'CPEA'                                                  03615000
@CC01385 DC    C'CPFA'                                                  03616000
@CC01389 DC    C'CPGA'                                                  03617000
@CC01406 DC    C'CPHA'                                                  03618000
@CC01429 DC    C'SSAA'                                                  03619000
@CC01279 DC    C'UV0'                                                   03620000
@CC01281 DC    C'CP0'                                                   03621000
ALL      DC    CL3'ALL'                                                 03622000
FORMAT   DC    CL4'FORM'                                                03623000
HSECOND  DC    CL4'HSEC'                                                03624000
CLOCK    DC    CL4'KLOK'                                                03625000
SETZERO  DC    CL4'ZERO'                                                03626000
SETBLANK DC    CL4'BLNK'                                                03627000
NOSET    DC    CL4'NSET'                                                03628000
OVERRIDE DC    CL4'OVRD'                                                03629000
ACQUIRE  DC    CL8'ACQUIRE '                                            03630000
RELINQ   DC    CL8'RELINQ  '                                            03631000
MOUNT    DC    CL8'MOUNT   '                                            03632000
DEMOUNT  DC    CL8'DEMOUNT '                                            03633000
DEFINE   DC    CL8'DEFINE  '                                            03634000
MOVE     DC    CL8'MOVE    '                                            03635000
TRACEQ   DC    CL8'TRACEQ  '                                            03636000
COPYTABL DC    CL8'COPYTABL'                                            03637000
COPYCRTG DC    CL8'COPYCRTG'                                            03638000
COPYVOL  DC    CL8'COPYVOL '                                            03639000
VVIC     DC    CL8'VVIC    '                                            03640000
TUNE     DC    CL8'TUNE    '                                            03641000
NAMES    DC    CL4'NAME'                                                03642000
UNIT     DC    CL4'UNIT'                                                03643000
SHR      DC    CL4'SHR '                                                03644000
EXCL     DC    CL4'EXCL'                                                03645000
NOWAIT   DC    CL4'NWAI'                                                03646000
WAIT     DC    CL4'WAIT'                                                03647000
SECCHECK DC    CL8'SECCHECK'                                            03648000
SCRVTOC  DC    CL8'SCRVTOC '                                            03649000
GETVTOC  DC    CL8'GETVTOC '                                            03650000
PUTVTOC  DC    CL8'PUTVTOC '                                            03651000
RECATLG  DC    CL8'RECATLG '                                            03652000
INITVOL  DC    CL8'INITVOL '                                            03653000
CHECK    DC    CL8'CHECK   '                                            03654000
POSTUCB  DC    CL8'POSTUCB '                                            03655000
GET      DC    CL8'GET     '                                            03656000
PUT      DC    CL8'PUT     '                                            03657000
CLOSE    DC    CL8'CLOSE   '                                            03658000
OPEN     DC    CL8'OPEN    '                                            03659000
RVOPENR  DC    CL8'OPENR   '                                            03660000
RVRDCNT  DC    CL8'READCNT '                                            03661000
RVREADKD DC    CL8'READKD  '                                            03662000
RVSPACCR DC    CL8'SPACCR  '                                            03663000
RVFWRITE DC    CL8'FWRITE  '                                            03664000
RVWRITER DC    CL8'WRITEREC'                                            03665000
PUTLABEL DC    CL8'PUTLABEL'                                            03666000
GETLABEL DC    CL8'GETLABEL'                                            03667000
CANCEL   DC    CL8'CANCEL  '                                            03668000
SET      DC    CL8'SET     '                                            03669000
SELECTX  DC    CL8'SELECTX '                                            03670000
CHANGEX  DC    CL8'CHANGEX '                                            03671000
SELECTDD DC    CL8'SELECTDD'                                            03672000
SELECTDS DC    CL8'SELECTDS'                                            03673000
TBLREST  DC    CL8'TBLREST '                                            03674000
NULLIFYC DC    CL8'NULLIFYC'                                            03675000
RDMSC    DC    CL8'RDMSC   '                                            03676000
RDMSCTBL DC    CL8'RDMSCTBL'                                            03677000
RDCARTLB DC    CL8'RDCARTLB'                                            03678000
AUDITCEL DC    CL8'AUDITCEL'                                            03679000
RDSTGAD  DC    CL8'RDSTGAD '                                            03680000
FIXAREA  DS    CL350                                                    03681000
         ORG   FIXAREA                                                  03682000
@NM00098 DC    350X'00'                                                 03683000
         ORG   FIXAREA+350                                              03684000
COPYPRIM DC    X'80'                                                    03685000
COPYSEC  DC    X'C0'                                                    03686000
MODID    DC    CL4'CP01'                                                03687000
HEX0     DC    X'0000'                                                  03688000
SSMODSS0 DC    CL3'SS0'                                                 03689000
SSMODCM0 DC    CL3'CM0'                                                 03690000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03691000
@01      EQU   01                                                       03692000
@02      EQU   02                                                       03693000
@03      EQU   03                                                       03694000
@04      EQU   04                                                       03695000
@05      EQU   05                                                       03696000
@06      EQU   06                                                       03697000
@07      EQU   07                                                       03698000
@08      EQU   08                                                       03699000
@09      EQU   09                                                       03700000
@10      EQU   10                                                       03701000
@11      EQU   11                                                       03702000
@12      EQU   12                                                       03703000
@13      EQU   13                                                       03704000
@14      EQU   14                                                       03705000
@15      EQU   15                                                       03706000
ENTRYNUM EQU   @02                                                      03707000
TRKCODE  EQU   @05                                                      03708000
COMPCODE EQU   @06                                                      03709000
COPYCODE EQU   @04                                                      03710000
OPENCODE EQU   @04                                                      03711000
NIBBLE   EQU   @02                                                      03712000
LOC      EQU   @04                                                      03713000
LINE     EQU   @02                                                      03714000
OUTPTR   EQU   @09                                                      03715000
RECPTR2  EQU   @05                                                      03716000
RECPTR1  EQU   @03                                                      03717000
SBYTEPTR EQU   @02                                                      03718000
EXGPTR   EQU   @04                                                      03719000
ALL2PTR  EQU   @08                                                      03720000
ALL1PTR  EQU   @07                                                      03721000
EXOPTR   EQU   @06                                                      03722000
CKPTR    EQU   @05                                                      03723000
DMPINDEX EQU   @02                                                      03724000
TESTRC   EQU   @03                                                      03725000
REG10    EQU   @10                                                      03726000
REG12    EQU   @12                                                      03727000
RTNREG   EQU   @15                                                      03728000
ARR1     EQU   @01                                                      03729000
COTBR1   EQU   @01                                                      03730000
REG0     EQU   @00                                                      03731000
REG1     EQU   @01                                                      03732000
REG11    EQU   @11                                                      03733000
REG13    EQU   @13                                                      03734000
REG14    EQU   @14                                                      03735000
REG15    EQU   @15                                                      03736000
REG2     EQU   @02                                                      03737000
REG3     EQU   @03                                                      03738000
REG4     EQU   @04                                                      03739000
REG5     EQU   @05                                                      03740000
REG6     EQU   @06                                                      03741000
REG7     EQU   @07                                                      03742000
REG8     EQU   @08                                                      03743000
REG9     EQU   @09                                                      03744000
IDCSAEP0 EQU   0                                                        03745000
IDCSAGS0 EQU   0                                                        03746000
IDCSAFS0 EQU   0                                                        03747000
IDCSAAL0 EQU   0                                                        03748000
IDCSADL0 EQU   0                                                        03749000
IDCSASS0 EQU   0                                                        03750000
IDCSA060 EQU   0                                                        03751000
TRACE1   EQU   0                                                        03752000
OLDERID1 EQU   TRACE1                                                   03753000
TRACE2   EQU   0                                                        03754000
OLDERID2 EQU   TRACE2                                                   03755000
NEWID2   EQU   TRACE2+95                                                03756000
NEWERID2 EQU   5                                                        03757000
CIRAGL   EQU   0                                                        03758000
CIRTYPE  EQU   CIRAGL                                                   03759000
ALLAGL   EQU   0                                                        03760000
ALLDSN   EQU   ALLAGL                                                   03761000
ALLDDN   EQU   ALLAGL+4                                                 03762000
ALLULP   EQU   ALLAGL+12                                                03763000
ALLSTS   EQU   ALLAGL+24                                                03764000
ALLSTSOD EQU   ALLSTS                                                   03765000
ALLDSP   EQU   ALLAGL+25                                                03766000
ALLDSPKP EQU   ALLDSP                                                   03767000
ALLORG   EQU   ALLAGL+26                                                03768000
ALLOPT   EQU   ALLAGL+28                                                03769000
ALLOPTVL EQU   ALLOPT                                                   03770000
ALLOPTDS EQU   ALLOPT                                                   03771000
UNITABL  EQU   0                                                        03772000
UNITADR  EQU   UNITABL+4                                                03773000
@NM00010 EQU   UNITADR                                                  03774000
UNITSTAT EQU   UNITABL+6                                                03775000
IDCIOSI0 EQU   0                                                        03776000
IDCIO050 EQU   0                                                        03777000
IOCSTR   EQU   0                                                        03778000
IOCDSO   EQU   IOCSTR+16                                                03779000
IOCRFM   EQU   IOCSTR+17                                                03780000
IOCMAC   EQU   IOCSTR+18                                                03781000
IOCMAC2  EQU   IOCSTR+19                                                03782000
IOCCHP   EQU   IOCSTR+20                                                03783000
IOCMSG   EQU   IOCSTR+21                                                03784000
IOCRBA   EQU   IOCSTR+40                                                03785000
IOCTTR   EQU   IOCRBA                                                   03786000
IOCMEM   EQU   IOCSTR+44                                                03787000
IOCNWM   EQU   IOCSTR+48                                                03788000
OPNAGL   EQU   0                                                        03789000
OPNOPT   EQU   OPNAGL                                                   03790000
OPNRFM   EQU   OPNAGL+1                                                 03791000
OPNTYP   EQU   OPNAGL+2                                                 03792000
OPNMOD   EQU   OPNAGL+3                                                 03793000
OPNDEV   EQU   OPNAGL+24                                                03794000
OPNDSO   EQU   OPNAGL+41                                                03795000
OPNOPT2  EQU   OPNAGL+42                                                03796000
IOINFOPT EQU   0                                                        03797000
IOINFVOL EQU   IOINFOPT                                                 03798000
UVOLLIST EQU   0                                                        03799000
UVOLENT  EQU   UVOLLIST+2                                               03800000
AMSTP011 EQU   0                                                        03801000
AMSTP042 EQU   0                                                        03802000
DARGLIST EQU   0                                                        03803000
DARGDBP  EQU   DARGLIST                                                 03804000
DARGRETP EQU   DARGLIST+4                                               03805000
DARGSTID EQU   DARGLIST+8                                               03806000
DARGSMOD EQU   DARGSTID                                                 03807000
DARGSENT EQU   DARGSTID+3                                               03808000
DARGILP  EQU   DARGLIST+12                                              03809000
DARGRETL EQU   DARGLIST+16                                              03810000
DARGARY  EQU   DARGLIST+20                                              03811000
DARGINS  EQU   DARGARY                                                  03812000
DARGINL  EQU   DARGARY+2                                                03813000
FMTLIST  EQU   0                                                        03814000
FMTFLGS  EQU   FMTLIST                                                  03815000
FMTSPF   EQU   FMTLIST+2                                                03816000
FMTRFNO  EQU   FMTSPF                                                   03817000
FMTILEN  EQU   FMTRFNO                                                  03818000
FMTIOFF  EQU   FMTLIST+4                                                03819000
FMTTRBC  EQU   FMTIOFF                                                  03820000
FMTSTO   EQU   FMTTRBC                                                  03821000
FMTOCOL  EQU   FMTLIST+6                                                03822000
FMTCNVF  EQU   FMTLIST+10                                               03823000
ERCNVTAB EQU   0                                                        03824000
ERTYPE   EQU   ERCNVTAB                                                 03825000
EROPER   EQU   ERCNVTAB+1                                               03826000
EROSOPER EQU   ERCNVTAB+2                                               03827000
IDCDB010 EQU   0                                                        03828000
DMPITM   EQU   0                                                        03829000
DMPITMNM EQU   DMPITM                                                   03830000
DMPITMPT EQU   DMPITM+8                                                 03831000
DMPITMLN EQU   DMPITM+12                                                03832000
DMPITMTP EQU   DMPITM+14                                                03833000
DMPARY   EQU   0                                                        03834000
DMPTRM   EQU   0                                                        03835000
CCMSG    EQU   0                                                        03836000
CMMSG    EQU   0                                                        03837000
CMVOLFLG EQU   CMMSG+6                                                  03838000
CTMSG    EQU   0                                                        03839000
CTREALCC EQU   CTMSG+1                                                  03840000
CTARRAY  EQU   CTMSG+4                                                  03841000
CTTBLCC  EQU   CTARRAY+1                                                03842000
CTTBLHH  EQU   CTARRAY+2                                                03843000
CTTBLRR  EQU   CTARRAY+3                                                03844000
MDAGL    EQU   0                                                        03845000
MDFLAGS  EQU   MDAGL+30                                                 03846000
MDVTOC   EQU   MDAGL+32                                                 03847000
PUAGL    EQU   0                                                        03848000
CKAGL    EQU   0                                                        03849000
CKUCBPTR EQU   CKAGL+8                                                  03850000
CKDDNAME EQU   CKAGL+12                                                 03851000
CKLABELP EQU   CKAGL+24                                                 03852000
CKFLAGS  EQU   CKAGL+28                                                 03853000
CKTESTVT EQU   CKFLAGS                                                  03854000
EXCLAGL  EQU   0                                                        03855000
EXCLFLAG EQU   EXCLAGL+22                                               03856000
EXOARG   EQU   0                                                        03857000
EXODDN   EQU   EXOARG+8                                                 03858000
EXOEXT   EQU   EXOARG+24                                                03859000
EXOCTLBK EQU   EXOARG+28                                                03860000
EXOPT    EQU   EXOARG+32                                                03861000
EXOTAB   EQU   EXOPT                                                    03862000
EXFLG    EQU   EXOARG+33                                                03863000
EXGARG   EQU   0                                                        03864000
EXGCTLBK EQU   EXGARG+8                                                 03865000
EXGCCHH1 EQU   EXGARG+12                                                03866000
EXGCCHH2 EQU   EXGARG+16                                                03867000
EXGRECNO EQU   EXGARG+20                                                03868000
EXGDATAP EQU   EXGARG+24                                                03869000
EXGDATAL EQU   EXGARG+30                                                03870000
EXWRARG  EQU   0                                                        03871000
EXRWCHR  EQU   EXWRARG+26                                               03872000
EXSPACE  EQU   EXWRARG+36                                               03873000
EXPARG   EQU   0                                                        03874000
EXPDATA  EQU   EXPARG+12                                                03875000
EXPDATAB EQU   0                                                        03876000
EXPARRAY EQU   EXPDATAB+4                                               03877000
VS2AGL   EQU   0                                                        03878000
VSLABOPT EQU   VS2AGL+28                                                03879000
VS2MSG   EQU   VS2AGL+35                                                03880000
VS2RESOP EQU   VS2AGL+36                                                03881000
VS1AGL   EQU   0                                                        03882000
VSSECOPT EQU   VS1AGL+68                                                03883000
VSVTOPT  EQU   VS1AGL+69                                                03884000
VSCATOPT EQU   VS1AGL+70                                                03885000
VSRETURN EQU   VS1AGL+71                                                03886000
VSMSG    EQU   VS1AGL+72                                                03887000
VSRESOPT EQU   VS1AGL+73                                                03888000
RCTAGL   EQU   0                                                        03889000
RCTOPT   EQU   RCTAGL+8                                                 03890000
STAEPARM EQU   0                                                        03891000
STARCVY  EQU   STAEPARM+52                                              03892000
STARETRY EQU   STAEPARM+53                                              03893000
VOLLABEL EQU   0                                                        03894000
SV82LIST EQU   0                                                        03895000
@NM00072 EQU   SV82LIST+4                                               03896000
SV82DCBP EQU   @NM00072                                                 03897000
@NM00073 EQU   SV82LIST+12                                              03898000
SV82WRKP EQU   @NM00073                                                 03899000
SRTAGL   EQU   0                                                        03900000
LCTINFO  EQU   0                                                        03901000
LCTFLAGS EQU   LCTINFO+32                                               03902000
UCTAGL   EQU   0                                                        03903000
UCTFLAGS EQU   UCTAGL+68                                                03904000
SELAGL   EQU   0                                                        03905000
SELFLAGS EQU   SELAGL+22                                                03906000
DATESAGL EQU   0                                                        03907000
DATESOPT EQU   DATESAGL+20                                              03908000
VS3AGL   EQU   0                                                        03909000
VS3FLAGS EQU   VS3AGL+58                                                03910000
VSDVTOC  EQU   0                                                        03911000
VSDSTAT  EQU   0                                                        03912000
VSDSFLG1 EQU   VSDSTAT+16                                               03913000
VSDFLG2  EQU   VSDSTAT+17                                               03914000
VSDSCR   EQU   0                                                        03915000
VSDSCRFL EQU   VSDSCR+4                                                 03916000
VSDUSAGE EQU   0                                                        03917000
VSDDORG  EQU   VSDUSAGE+9                                               03918000
VSDALLOC EQU   VSDUSAGE+10                                              03919000
VSDUSEF  EQU   VSDUSAGE+11                                              03920000
VSDDSORG EQU   VSDUSAGE+16                                              03921000
VSDBLOCK EQU   0                                                        03922000
VSDSPACE EQU   VSDBLOCK+12                                              03923000
VSDARRAY EQU   VSDBLOCK+16                                              03924000
VSDVARY  EQU   VSDARRAY+48                                              03925000
FILE1    EQU   0                                                        03926000
FILE1VAL EQU   FILE1+1                                                  03927000
FILE2    EQU   0                                                        03928000
FILE2VAL EQU   FILE2+1                                                  03929000
WDS1     EQU   0                                                        03930000
WDS1FLG  EQU   WDS1+10                                                  03931000
WDS1VAL  EQU   WDS1+21                                                  03932000
WDS2     EQU   0                                                        03933000
WDS2FLG  EQU   WDS2+10                                                  03934000
WDS2VAL  EQU   WDS2+21                                                  03935000
ACQLIST  EQU   0                                                        03936000
ARLL     EQU   ACQLIST                                                  03937000
AROP     EQU   ACQLIST+4                                                03938000
ARFLG    EQU   ACQLIST+6                                                03939000
ARBDUBD  EQU   ARFLG                                                    03940000
ARINH    EQU   ARFLG                                                    03941000
ARNMEXT  EQU   ACQLIST+7                                                03942000
ARVOL    EQU   ACQLIST+8                                                03943000
ARCOMPC  EQU   ACQLIST+26                                               03944000
AREXT    EQU   ACQLIST+28                                               03945000
ARNEDB   EQU   ACQLIST+92                                               03946000
SECBYTE  EQU   0                                                        03947000
PBLOCK   EQU   0                                                        03948000
PPREFIX  EQU   PBLOCK                                                   03949000
PCHR     EQU   PPREFIX+1                                                03950000
PREC     EQU   PBLOCK+8                                                 03951000
SBLOCK   EQU   0                                                        03952000
SPREFIX  EQU   SBLOCK                                                   03953000
SCHR     EQU   SPREFIX+1                                                03954000
SREC     EQU   SBLOCK+8                                                 03955000
OUTBUF   EQU   0                                                        03956000
OPPREFIX EQU   OUTBUF                                                   03957000
OSPREFIX EQU   OUTBUF+8                                                 03958000
OLINE    EQU   OUTBUF+24                                                03959000
OPLINE   EQU   OLINE                                                    03960000
OSLINE   EQU   OLINE+32                                                 03961000
AMSTP041 EQU   0                                                        03962000
AMSTP043 EQU   0                                                        03963000
AMSTP044 EQU   0                                                        03964000
IDCIOCL0 EQU   0                                                        03965000
IDCIOCO0 EQU   0                                                        03966000
IDCIOGT0 EQU   0                                                        03967000
IDCIOIT0 EQU   0                                                        03968000
IDCIOOP0 EQU   0                                                        03969000
IDCIOPO0 EQU   0                                                        03970000
IDCIOPT0 EQU   0                                                        03971000
IDCIOST0 EQU   0                                                        03972000
IDCIOTM0 EQU   0                                                        03973000
IDCIOVY0 EQU   0                                                        03974000
IDCSACA0 EQU   0                                                        03975000
IDCSACL0 EQU   0                                                        03976000
IDCSACR0 EQU   0                                                        03977000
IDCSADE0 EQU   0                                                        03978000
IDCSADQ0 EQU   0                                                        03979000
IDCSAFP0 EQU   0                                                        03980000
IDCSAGP0 EQU   0                                                        03981000
IDCSAID0 EQU   0                                                        03982000
IDCSALC0 EQU   0                                                        03983000
IDCSALD0 EQU   0                                                        03984000
IDCSALK0 EQU   0                                                        03985000
IDCSANQ0 EQU   0                                                        03986000
IDCSAPR0 EQU   0                                                        03987000
IDCSAPT0 EQU   0                                                        03988000
IDCSAQL0 EQU   0                                                        03989000
IDCSARC0 EQU   0                                                        03990000
IDCSARV0 EQU   0                                                        03991000
IDCSASC0 EQU   0                                                        03992000
IDCSASI0 EQU   0                                                        03993000
IDCSASN0 EQU   0                                                        03994000
IDCSAST0 EQU   0                                                        03995000
IDCSATI0 EQU   0                                                        03996000
IDCSAUC0 EQU   0                                                        03997000
IDCSAWO0 EQU   0                                                        03998000
IDCST010 EQU   0                                                        03999000
IDCTPER0 EQU   0                                                        04000000
LISTTEST EQU   0                                                        04001000
NEWERID1 EQU   5                                                        04002000
WDS      EQU   0                                                        04003000
WFILE    EQU   0                                                        04004000
GDTTBL   EQU   0                                                        04005000
GDTTR1   EQU   GDTTBL+8                                                 04006000
GDTTR2   EQU   GDTTBL+12                                                04007000
GDTDBG   EQU   GDTTBL+40                                                04008000
GDTSTC   EQU   GDTTBL+44                                                04009000
GDTPRT   EQU   GDTTBL+48                                                04010000
GDTESS   EQU   GDTTBL+52                                                04011000
GDTESA   EQU   GDTTBL+56                                                04012000
GDTRST   EQU   GDTTBL+60                                                04013000
GDTRES   EQU   GDTTBL+64                                                04014000
GDTCAL   EQU   GDTTBL+68                                                04015000
GDTGSP   EQU   GDTTBL+72                                                04016000
GDTFSP   EQU   GDTTBL+76                                                04017000
GDTGPL   EQU   GDTTBL+80                                                04018000
GDTFPL   EQU   GDTTBL+84                                                04019000
GDTLOD   EQU   GDTTBL+88                                                04020000
GDTDEL   EQU   GDTTBL+92                                                04021000
GDTPRL   EQU   GDTTBL+96                                                04022000
GDTEPL   EQU   GDTTBL+100                                               04023000
GDTTIM   EQU   GDTTBL+104                                               04024000
GDTIIO   EQU   GDTTBL+108                                               04025000
GDTTIO   EQU   GDTTBL+112                                               04026000
GDTOPN   EQU   GDTTBL+124                                               04027000
GDTCLS   EQU   GDTTBL+128                                               04028000
GDTGET   EQU   GDTTBL+132                                               04029000
GDTPUT   EQU   GDTTBL+136                                               04030000
GDTPOS   EQU   GDTTBL+140                                               04031000
GDTCPY   EQU   GDTTBL+144                                               04032000
GDTCAT   EQU   GDTTBL+148                                               04033000
GDTSNP   EQU   GDTTBL+164                                               04034000
GDTVFY   EQU   GDTTBL+172                                               04035000
GDTUID   EQU   GDTTBL+192                                               04036000
GDTPMT   EQU   GDTTBL+196                                               04037000
GDTCIR   EQU   GDTTBL+200                                               04038000
GDTLNK   EQU   GDTTBL+204                                               04039000
GDTALC   EQU   GDTTBL+208                                               04040000
GDTDLC   EQU   GDTTBL+212                                               04041000
GDTQAL   EQU   GDTTBL+216                                               04042000
GDTSTW   EQU   GDTTBL+220                                               04043000
GDTSSC   EQU   GDTTBL+224                                               04044000
GDTENQ   EQU   GDTTBL+228                                               04045000
GDTRSV   EQU   GDTTBL+232                                               04046000
GDTDEQ   EQU   GDTTBL+236                                               04047000
GDTSFO   EQU   GDTTBL+240                                               04048000
GDTWTO   EQU   GDTTBL+244                                               04049000
GDTSCR   EQU   GDTTBL+248                                               04050000
GDTUNT   EQU   GDTTBL+252                                               04051000
GDTRCT   EQU   GDTTBL+256                                               04052000
GDTIFO   EQU   GDTTBL+260                                               04053000
GDTEXP   EQU   GDTTBL+264                                               04054000
GDTSTA   EQU   GDTTBL+268                                               04055000
GDTERR   EQU   GDTTBL+272                                               04056000
GDTUNC   EQU   GDTTBL+276                                               04057000
GDTLOC   EQU   GDTTBL+280                                               04058000
FDTTBL   EQU   0                                                        04059000
FDTPTR   EQU   FDTTBL+8                                                 04060000
LASTCOND EQU   0                                                        04061000
SSRCODE  EQU   0                                                        04062000
SSRHALF  EQU   SSRCODE+2                                                04063000
SSECBCD  EQU   0                                                        04064000
DCOTBTID EQU   COTBTID                                                  04065000
P        EQU   PBLOCK                                                   04066000
S        EQU   SBLOCK                                                   04067000
*                                      START UNREFERENCED COMPONENTS    04068000
@NM00105 EQU   SSRCODE                                                  04069000
FDTVERB  EQU   FDTTBL                                                   04070000
GDTECT   EQU   GDTTBL+188                                               04071000
GDTPSB   EQU   GDTTBL+184                                               04072000
GDTUPT   EQU   GDTTBL+180                                               04073000
GDTCMB   EQU   GDTTBL+176                                               04074000
GDTSPR   EQU   GDTTBL+168                                               04075000
@NM00001 EQU   GDTTBL+160                                               04076000
GDTABH   EQU   GDTTBL+156                                               04077000
GDTABT   EQU   GDTTBL+152                                               04078000
GDTTOH   EQU   GDTTBL+120                                               04079000
GDTRIP   EQU   GDTTBL+116                                               04080000
GDTIOH   EQU   GDTTBL+36                                                04081000
GDTSAH   EQU   GDTTBL+32                                                04082000
GDTTPH   EQU   GDTTBL+28                                                04083000
GDTRIH   EQU   GDTTBL+24                                                04084000
GDTSTH   EQU   GDTTBL+20                                                04085000
GDTDBH   EQU   GDTTBL+16                                                04086000
GDTPRM   EQU   GDTTBL+4                                                 04087000
GDTHDR   EQU   GDTTBL                                                   04088000
@NM00103 EQU   SPREFIX+4                                                04089000
@NM00102 EQU   SPREFIX                                                  04090000
@NM00101 EQU   PPREFIX+4                                                04091000
@NM00100 EQU   PPREFIX                                                  04092000
@NM00097 EQU   AREXT                                                    04093000
@NM00096 EQU   ACQLIST+25                                               04094000
ARHOST   EQU   ACQLIST+20                                               04095000
ARECB    EQU   ACQLIST+16                                               04096000
ARASID   EQU   ACQLIST+14                                               04097000
@NM00095 EQU   ARFLG                                                    04098000
ARDRES   EQU   ARFLG                                                    04099000
@NM00094 EQU   ACQLIST+5                                                04100000
WDS2LEN  EQU   WDS2+20                                                  04101000
WDS2MEM  EQU   WDS2+12                                                  04102000
WDS2MLN  EQU   WDS2+11                                                  04103000
WDS2FUQ  EQU   WDS2FLG                                                  04104000
WDS2POS  EQU   WDS2+9                                                   04105000
WDS2PAS  EQU   WDS2+1                                                   04106000
WDS2PLN  EQU   WDS2                                                     04107000
WDS1LEN  EQU   WDS1+20                                                  04108000
WDS1MEM  EQU   WDS1+12                                                  04109000
WDS1MLN  EQU   WDS1+11                                                  04110000
WDS1FUQ  EQU   WDS1FLG                                                  04111000
WDS1POS  EQU   WDS1+9                                                   04112000
WDS1PAS  EQU   WDS1+1                                                   04113000
WDS1PLN  EQU   WDS1                                                     04114000
FILE2LEN EQU   FILE2                                                    04115000
FILE1LEN EQU   FILE1                                                    04116000
VSDDSN   EQU   VSDARRAY+4                                               04117000
VSDVOLCT EQU   VSDARRAY                                                 04118000
VSDFMT0  EQU   VSDBLOCK+8                                               04119000
VSDVTOCS EQU   VSDBLOCK+4                                               04120000
VSDELEM  EQU   VSDBLOCK                                                 04121000
VSDFREE  EQU   VSDUSAGE+24                                              04122000
VSDALLC  EQU   VSDUSAGE+19                                              04123000
VSDDSOR3 EQU   VSDDSORG+2                                               04124000
@NM00090 EQU   VSDDSORG                                                 04125000
VSDSCAL  EQU   VSDUSAGE+12                                              04126000
@NM00089 EQU   VSDUSEF                                                  04127000
VSDCALFR EQU   VSDUSEF                                                  04128000
@NM00088 EQU   VSDALLOC                                                 04129000
VSDABSTR EQU   VSDALLOC                                                 04130000
VSDABLK  EQU   VSDALLOC                                                 04131000
VSDATRK  EQU   VSDALLOC                                                 04132000
VSDACYL  EQU   VSDALLOC                                                 04133000
@NM00087 EQU   VSDDORG                                                  04134000
VSDOU    EQU   VSDDORG                                                  04135000
VSDOIS   EQU   VSDDORG                                                  04136000
VSDODA   EQU   VSDDORG                                                  04137000
VSDOUN   EQU   VSDDORG                                                  04138000
VSDOPS   EQU   VSDDORG                                                  04139000
VSDOPO   EQU   VSDDORG                                                  04140000
VSDEXTS  EQU   VSDUSAGE+8                                               04141000
VSDSECAL EQU   VSDUSAGE+4                                               04142000
VSDFTRK  EQU   VSDUSAGE+2                                               04143000
VSDTRKS  EQU   VSDUSAGE                                                 04144000
@NM00086 EQU   VSDSCR+5                                                 04145000
@NM00085 EQU   VSDSCRFL                                                 04146000
VSDVSAM  EQU   VSDSCRFL                                                 04147000
VSDCATLC EQU   VSDSCRFL                                                 04148000
VSDACBPT EQU   VSDSCR                                                   04149000
VSDPRTC  EQU   VSDSTAT+25                                               04150000
VSDCAT   EQU   VSDSTAT+22                                               04151000
VSDEXP   EQU   VSDSTAT+20                                               04152000
VSDCRE   EQU   VSDSTAT+18                                               04153000
@NM00084 EQU   VSDFLG2                                                  04154000
VSDERROR EQU   VSDFLG2                                                  04155000
VSDPROT  EQU   VSDFLG2                                                  04156000
VSDPWW   EQU   VSDFLG2                                                  04157000
VSDPWR   EQU   VSDFLG2                                                  04158000
@NM00083 EQU   VSDSFLG1                                                 04159000
VSDCVSAM EQU   VSDSFLG1                                                 04160000
VSDCATLG EQU   VSDSFLG1                                                 04161000
VSDVSAME EQU   VSDSFLG1                                                 04162000
VSDVSAMC EQU   VSDSFLG1                                                 04163000
VSDVTOCE EQU   VSDSFLG1                                                 04164000
VSDVTOCC EQU   VSDSFLG1                                                 04165000
VSDOWNER EQU   VSDSTAT+8                                                04166000
VSDEXPIR EQU   VSDSTAT+4                                                04167000
VSDCREAT EQU   VSDSTAT                                                  04168000
VSDFRCCL EQU   VSDVTOC+21                                               04169000
@NM00082 EQU   VSDVTOC+20                                               04170000
VSDFREXT EQU   VSDVTOC+16                                               04171000
@NM00081 EQU   VSDVTOC+15                                               04172000
VSDFRTRK EQU   VSDVTOC+11                                               04173000
@NM00080 EQU   VSDVTOC+10                                               04174000
VSDFRCYL EQU   VSDVTOC+6                                                04175000
@NM00079 EQU   VSDVTOC                                                  04176000
@NM00078 EQU   VS3FLAGS                                                 04177000
VS3SYSNM EQU   VS3FLAGS                                                 04178000
VS3UNCAT EQU   VS3FLAGS                                                 04179000
VS3SCR   EQU   VS3FLAGS                                                 04180000
VS3USAGE EQU   VS3FLAGS                                                 04181000
VS3STAT  EQU   VS3FLAGS                                                 04182000
VS3DD    EQU   VS3AGL+50                                                04183000
VS3VOL   EQU   VS3AGL+44                                                04184000
VS3POOL  EQU   VS3AGL+40                                                04185000
VS3DEV   EQU   VS3AGL+36                                                04186000
VS3UCBP  EQU   VS3AGL+32                                                04187000
VS3CREAT EQU   VS3AGL+28                                                04188000
VS3EXPIR EQU   VS3AGL+24                                                04189000
VS3AST   EQU   VS3AGL+22                                                04190000
VS3LEVLN EQU   VS3AGL+20                                                04191000
VS3LEVP  EQU   VS3AGL+16                                                04192000
VS3EXDSP EQU   VS3AGL+12                                                04193000
VS3LISTP EQU   VS3AGL+8                                                 04194000
VS3HEAD  EQU   VS3AGL                                                   04195000
@NM00077 EQU   DATESOPT                                                 04196000
DATDAYOP EQU   DATESOPT                                                 04197000
DATDTEOP EQU   DATESOPT                                                 04198000
DATSUB   EQU   DATESOPT                                                 04199000
DATADD   EQU   DATESOPT                                                 04200000
DATRETRN EQU   DATESAGL+16                                              04201000
DATDAYS  EQU   DATESAGL+12                                              04202000
DATDATE  EQU   DATESAGL+8                                               04203000
DATHEAD  EQU   DATESAGL                                                 04204000
@NM00076 EQU   SELFLAGS                                                 04205000
SELVOL   EQU   SELAGL+16                                                04206000
SELDDNP  EQU   SELAGL+12                                                04207000
SELUCBP  EQU   SELAGL+8                                                 04208000
SELHEAD  EQU   SELAGL                                                   04209000
@NM00075 EQU   UCTFLAGS                                                 04210000
UCTVSCAT EQU   UCTFLAGS                                                 04211000
UCTDD    EQU   UCTAGL+60                                                04212000
UCTVOLP  EQU   UCTAGL+56                                                04213000
UCTACBP  EQU   UCTAGL+52                                                04214000
UCTDSN   EQU   UCTAGL+8                                                 04215000
UCTHEAD  EQU   UCTAGL                                                   04216000
@NM00074 EQU   LCTFLAGS                                                 04217000
LCTVSCAT EQU   LCTFLAGS                                                 04218000
LCTOWNER EQU   LCTINFO+24                                               04219000
LCTEXPIR EQU   LCTINFO+20                                               04220000
LCTCREAT EQU   LCTINFO+16                                               04221000
LCTACBP  EQU   LCTINFO+12                                               04222000
LCTMULVC EQU   LCTINFO+8                                                04223000
LCTHEAD  EQU   LCTINFO                                                  04224000
SRTWORKP EQU   SRTAGL+28                                                04225000
SRTFLDLN EQU   SRTAGL+24                                                04226000
SRTPOSIT EQU   SRTAGL+20                                                04227000
SRTLEN   EQU   SRTAGL+16                                                04228000
SRTNUM   EQU   SRTAGL+12                                                04229000
SRTADDR  EQU   SRTAGL+8                                                 04230000
SRTHEAD  EQU   SRTAGL                                                   04231000
SV82DEBP EQU   SV82WRKP                                                 04232000
SV82TTRP EQU   SV82LIST+8                                               04233000
SV82VOLP EQU   SV82DCBP                                                 04234000
SV82UCBP EQU   SV82LIST+1                                               04235000
SV82CODE EQU   SV82LIST                                                 04236000
VOLRESV3 EQU   VOLLABEL+55                                              04237000
VOLOWNER EQU   VOLLABEL+45                                              04238000
VOLRESV1 EQU   VOLLABEL+20                                              04239000
VOLVTOC  EQU   VOLLABEL+15                                              04240000
VOLSECTY EQU   VOLLABEL+14                                              04241000
VOLSERNO EQU   VOLLABEL+8                                               04242000
VOLNO    EQU   VOLLABEL+7                                               04243000
VOLLABI  EQU   VOLLABEL+4                                               04244000
VOLKEY   EQU   VOLLABEL                                                 04245000
STAVTTR  EQU   STAEPARM+54                                              04246000
@NM00071 EQU   STARETRY                                                 04247000
STAVTOC  EQU   STARETRY                                                 04248000
STAOFF   EQU   STARETRY                                                 04249000
STAIO05  EQU   STARETRY                                                 04250000
@NM00070 EQU   STARCVY                                                  04251000
STACLEAR EQU   STARCVY                                                  04252000
STAVPOST EQU   STARCVY                                                  04253000
STAVENQ  EQU   STARCVY                                                  04254000
STAVDMNT EQU   STARCVY                                                  04255000
STAVMNT  EQU   STARCVY                                                  04256000
STATCB   EQU   STAEPARM+48                                              04257000
STARTADD EQU   STAEPARM+44                                              04258000
STAEXSAV EQU   STAEPARM+40                                              04259000
STARTSAV EQU   STAEPARM+36                                              04260000
STARTTR  EQU   STAEPARM+32                                              04261000
@NM00069 EQU   STAEPARM+30                                              04262000
STARVOL  EQU   STAEPARM+24                                              04263000
STARUCB  EQU   STAEPARM+20                                              04264000
@NM00068 EQU   STAEPARM+18                                              04265000
STAVVOL  EQU   STAEPARM+12                                              04266000
STAVUCB  EQU   STAEPARM+8                                               04267000
STAHEAD  EQU   STAEPARM                                                 04268000
RCTDSET  EQU   RCTAGL+32                                                04269000
RCTNVOL  EQU   RCTAGL+26                                                04270000
RCTOVOL  EQU   RCTAGL+20                                                04271000
RCTNDEV  EQU   RCTAGL+16                                                04272000
RCTODEV  EQU   RCTAGL+12                                                04273000
@NM00067 EQU   RCTAGL+10                                                04274000
@NM00066 EQU   RCTOPT                                                   04275000
RCTVOL   EQU   RCTOPT                                                   04276000
RCTDEV   EQU   RCTOPT                                                   04277000
RCTHEAD  EQU   RCTAGL                                                   04278000
@NM00065 EQU   VSRESOPT                                                 04279000
VSREAL   EQU   VSRESOPT                                                 04280000
VSRES    EQU   VSRESOPT                                                 04281000
@NM00064 EQU   VSMSG                                                    04282000
VSTOV    EQU   VSMSG                                                    04283000
VSFROMV  EQU   VSMSG                                                    04284000
@NM00063 EQU   VSRETURN                                                 04285000
VSUCAT   EQU   VSRETURN                                                 04286000
VSVSAM   EQU   VSRETURN                                                 04287000
@NM00062 EQU   VSCATOPT                                                 04288000
VSLIST   EQU   VSCATOPT                                                 04289000
VSSERIAL EQU   VSCATOPT                                                 04290000
VSDEVICE EQU   VSCATOPT                                                 04291000
@NM00061 EQU   VSVTOPT                                                  04292000
VSVSFLAG EQU   VSVTOPT                                                  04293000
VSALTTRK EQU   VSVTOPT                                                  04294000
VSTIME   EQU   VSVTOPT                                                  04295000
VSUCMAST EQU   VSSECOPT                                                 04296000
VSOPCAT  EQU   VSSECOPT                                                 04297000
VSUCTEST EQU   VSSECOPT                                                 04298000
VSWRITE  EQU   VSSECOPT                                                 04299000
VSREAD   EQU   VSSECOPT                                                 04300000
VSNONONV EQU   VSSECOPT                                                 04301000
VSMASTER EQU   VSSECOPT                                                 04302000
VSNOVSAM EQU   VSSECOPT                                                 04303000
VSODEVP  EQU   VS1AGL+64                                                04304000
VSOSERP  EQU   VS1AGL+60                                                04305000
VSDEVP   EQU   VS1AGL+56                                                04306000
VSSERP   EQU   VS1AGL+52                                                04307000
VSPFILEP EQU   VS1AGL+48                                                04308000
VSPSWDP  EQU   VS1AGL+44                                                04309000
VSCATDDP EQU   VS1AGL+40                                                04310000
VSACBP   EQU   VS1AGL+36                                                04311000
VSCATP   EQU   VS1AGL+32                                                04312000
VSNXTATP EQU   VS1AGL+28                                                04313000
VSNUMATP EQU   VS1AGL+24                                                04314000
VSIOP    EQU   VS1AGL+20                                                04315000
VSFILEP  EQU   VS1AGL+16                                                04316000
VSVOLP   EQU   VS1AGL+12                                                04317000
VSUCBP   EQU   VS1AGL+8                                                 04318000
VSHEAD   EQU   VS1AGL                                                   04319000
VSVTOCPT EQU   VS2AGL+48                                                04320000
@NM00060 EQU   VS2AGL+45                                                04321000
VSDDNAME EQU   VS2AGL+37                                                04322000
@NM00059 EQU   VS2RESOP                                                 04323000
VS2REAL  EQU   VS2RESOP                                                 04324000
VS2RES   EQU   VS2RESOP                                                 04325000
@NM00058 EQU   VS2MSG                                                   04326000
VS2TOV   EQU   VS2MSG                                                   04327000
VSVOLUME EQU   VS2AGL+29                                                04328000
@NM00057 EQU   VSLABOPT                                                 04329000
VSNOVTOC EQU   VSLABOPT                                                 04330000
VSVOLSER EQU   VSLABOPT                                                 04331000
VSOWNER  EQU   VSLABOPT                                                 04332000
VSIOBKPT EQU   VS2AGL+24                                                04333000
VSVOLPTR EQU   VS2AGL+20                                                04334000
VSOWNPTR EQU   VS2AGL+16                                                04335000
VSVTOCSZ EQU   VS2AGL+12                                                04336000
VSUCBPTR EQU   VS2AGL+8                                                 04337000
VS2HEAD  EQU   VS2AGL                                                   04338000
EXPDATAL EQU   EXPARRAY+6                                               04339000
@NM00056 EQU   EXPARRAY+5                                               04340000
EXPKEYLN EQU   EXPARRAY+4                                               04341000
EXPDATAP EQU   EXPARRAY                                                 04342000
EXPRECNO EQU   EXPDATAB                                                 04343000
EXPCCHHR EQU   EXPARG+16                                                04344000
EXPCTLBK EQU   EXPARG+8                                                 04345000
EXPHEAD  EQU   EXPARG                                                   04346000
EXRWFUN  EQU   EXWRARG+46                                               04347000
@NM00055 EQU   EXSPACE+8                                                04348000
@NM00054 EQU   EXSPACE+6                                                04349000
@NM00053 EQU   EXSPACE+4                                                04350000
@NM00052 EQU   EXSPACE+1                                                04351000
@NM00051 EQU   EXSPACE                                                  04352000
EXRWKDLN EQU   EXWRARG+32                                               04353000
@NM00050 EQU   EXWRARG+31                                               04354000
EXRECNUM EQU   EXRWCHR+4                                                04355000
EXHH     EQU   EXRWCHR+2                                                04356000
EXCC     EQU   EXRWCHR                                                  04357000
EXCCWCNT EQU   EXWRARG+24                                               04358000
EXLOCPTR EQU   EXWRARG+20                                               04359000
EXRWDARE EQU   EXWRARG+16                                               04360000
EXRWIOAR EQU   EXWRARG+12                                               04361000
EXRWCTBL EQU   EXWRARG+8                                                04362000
EXRWRES  EQU   EXWRARG                                                  04363000
@NM00049 EQU   EXGARG+29                                                04364000
EXGKEYLN EQU   EXGARG+28                                                04365000
EXGHEAD  EQU   EXGARG                                                   04366000
EXOVTH   EQU   EXFLG                                                    04367000
EXORVT   EQU   EXFLG                                                    04368000
EXORDS   EQU   EXFLG                                                    04369000
EXOSPK   EQU   EXFLG                                                    04370000
EXORVS   EQU   EXFLG                                                    04371000
@NM00048 EQU   EXFLG                                                    04372000
EXOREAD  EQU   EXFLG                                                    04373000
@NM00047 EQU   EXOPT                                                    04374000
EXOREP   EQU   EXOPT                                                    04375000
EXOVTOC  EQU   EXOPT                                                    04376000
EXONEW   EQU   EXOPT                                                    04377000
EXOPASS  EQU   EXOPT                                                    04378000
EXOLAB   EQU   EXOPT                                                    04379000
EXOUCB   EQU   EXOARG+20                                                04380000
EXOVSN   EQU   EXOARG+16                                                04381000
EXODSN   EQU   EXOARG+12                                                04382000
EXOHEAD  EQU   EXOARG                                                   04383000
@NM00046 EQU   EXCLFLAG                                                 04384000
EXCLMNT  EQU   EXCLFLAG                                                 04385000
EXCLVOL  EQU   EXCLAGL+16                                               04386000
EXCLDDP  EQU   EXCLAGL+12                                               04387000
EXCLUCBP EQU   EXCLAGL+8                                                04388000
EXCLHEAD EQU   EXCLAGL                                                  04389000
@NM00045 EQU   CKFLAGS                                                  04390000
CKDMTABL EQU   CKFLAGS                                                  04391000
CKRETTYP EQU   CKFLAGS                                                  04392000
CKDATYPE EQU   CKAGL+20                                                 04393000
CKHEAD   EQU   CKAGL                                                    04394000
PULABELP EQU   PUAGL+16                                                 04395000
PUTTRPTR EQU   PUAGL+12                                                 04396000
PUUCBPTR EQU   PUAGL+8                                                  04397000
PUHEAD   EQU   PUAGL                                                    04398000
MDR      EQU   MDVTOC+4                                                 04399000
MDHH     EQU   MDVTOC+2                                                 04400000
MDCC     EQU   MDVTOC                                                   04401000
@NM00044 EQU   MDAGL+31                                                 04402000
MDVTOCTR EQU   MDFLAGS                                                  04403000
MDFORCE  EQU   MDFLAGS                                                  04404000
MDDEQ    EQU   MDFLAGS                                                  04405000
MDENQ    EQU   MDFLAGS                                                  04406000
MDWAIT   EQU   MDFLAGS                                                  04407000
MDPOST   EQU   MDFLAGS                                                  04408000
MDCLEAR  EQU   MDFLAGS                                                  04409000
MDNEWVOL EQU   MDFLAGS                                                  04410000
MDLABEL  EQU   MDAGL+24                                                 04411000
MDPUAGL  EQU   MDAGL+20                                                 04412000
MDDDNAME EQU   MDAGL+12                                                 04413000
MDUCBPTR EQU   MDAGL+8                                                  04414000
MDHEAD   EQU   MDAGL                                                    04415000
CTTBLID  EQU   CTARRAY                                                  04416000
CTREALH  EQU   CTMSG+3                                                  04417000
@NM00043 EQU   CTMSG                                                    04418000
CMCSN2   EQU   CMMSG+28                                                 04419000
CMCSN1   EQU   CMMSG+16                                                 04420000
CMNUMCRT EQU   CMMSG+15                                                 04421000
@NM00042 EQU   CMMSG+14                                                 04422000
CMNEWVOL EQU   CMMSG+8                                                  04423000
@NM00041 EQU   CMMSG+7                                                  04424000
@NM00040 EQU   CMVOLFLG                                                 04425000
CMRONLY  EQU   CMVOLFLG                                                 04426000
CMBIND   EQU   CMVOLFLG                                                 04427000
CMSCRCRT EQU   CMVOLFLG                                                 04428000
CMEXCL   EQU   CMVOLFLG                                                 04429000
CMDERAS  EQU   CMVOLFLG                                                 04430000
CMSCRVOL EQU   CMVOLFLG                                                 04431000
CMCECART EQU   CMVOLFLG                                                 04432000
CMOLDVOL EQU   CMMSG                                                    04433000
CCOLDCSN EQU   CCMSG+24                                                 04434000
CCNEWCSN EQU   CCMSG+12                                                 04435000
@NM00039 EQU   CCMSG+10                                                 04436000
CCVOL    EQU   CCMSG+4                                                  04437000
@NM00038 EQU   CCMSG+2                                                  04438000
CCEJCODE EQU   CCMSG+1                                                  04439000
CCPSTCDE EQU   CCMSG                                                    04440000
@NM00037 EQU   DMPARY+15                                                04441000
DMPARYTP EQU   DMPARY+14                                                04442000
DMPARYEX EQU   DMPARY+12                                                04443000
DMPARYIC EQU   DMPARY+10                                                04444000
DMPARYSZ EQU   DMPARY+8                                                 04445000
DMPARYNM EQU   DMPARY                                                   04446000
@NM00036 EQU   DMPITM+15                                                04447000
@NM00035 EQU   ERCNVTAB+24                                              04448000
ERCPLPT  EQU   ERCNVTAB+20                                              04449000
ERCATRC  EQU   ERCNVTAB+16                                              04450000
ERDSNM   EQU   ERCNVTAB+12                                              04451000
@NM00034 EQU   ERCNVTAB+4                                               04452000
@NM00033 EQU   ERCNVTAB+3                                               04453000
@NM00032 EQU   EROSOPER                                                 04454000
EROSUCDX EQU   EROSOPER                                                 04455000
EROSCATL EQU   EROSOPER                                                 04456000
@NM00031 EQU   EROPER                                                   04457000
ERCATAL  EQU   EROPER                                                   04458000
ERCATDL  EQU   EROPER                                                   04459000
ERCATDE  EQU   EROPER                                                   04460000
ERCATLC  EQU   EROPER                                                   04461000
@NM00030 EQU   ERTYPE                                                   04462000
EROSCAT  EQU   ERTYPE                                                   04463000
ERCATLG  EQU   ERTYPE                                                   04464000
@NM00029 EQU   FMTCNVF+1                                                04465000
FMTAR    EQU   FMTCNVF+1                                                04466000
FMTBS    EQU   FMTCNVF+1                                                04467000
FMTSS    EQU   FMTCNVF+1                                                04468000
FMTAL    EQU   FMTCNVF+1                                                04469000
FMTZS    EQU   FMTCNVF+1                                                04470000
@NM00028 EQU   FMTCNVF                                                  04471000
FMTPU    EQU   FMTCNVF                                                  04472000
FMTBD    EQU   FMTCNVF                                                  04473000
FMTBHD   EQU   FMTCNVF                                                  04474000
FMTBHA   EQU   FMTCNVF                                                  04475000
FMTBH    EQU   FMTCNVF                                                  04476000
FMTOLEN  EQU   FMTLIST+8                                                04477000
FMTRIO   EQU   FMTOCOL                                                  04478000
FMTSPT   EQU   FMTSTO                                                   04479000
FMTSTL   EQU   FMTILEN                                                  04480000
@NM00027 EQU   FMTFLGS+1                                                04481000
FMTHDF   EQU   FMTFLGS                                                  04482000
FMTDFF   EQU   FMTFLGS                                                  04483000
FMTSTF   EQU   FMTFLGS                                                  04484000
FMTREPF  EQU   FMTFLGS                                                  04485000
FMTBDF   EQU   FMTFLGS                                                  04486000
FMTIDF   EQU   FMTFLGS                                                  04487000
FMTSCF   EQU   FMTFLGS                                                  04488000
FMTEOLF  EQU   FMTFLGS                                                  04489000
DARGDTM  EQU   DARGARY+4                                                04490000
DARGPCT  EQU   DARGINL                                                  04491000
DARGREP  EQU   DARGINS                                                  04492000
@NM00026 EQU   DARGLIST+19                                              04493000
DARGIND  EQU   DARGLIST+18                                              04494000
DARGCNT  EQU   DARGLIST+14                                              04495000
UVOLVOL  EQU   UVOLENT+4                                                04496000
UVOLDEV  EQU   UVOLENT                                                  04497000
UVOLCNT  EQU   UVOLLIST                                                 04498000
@NM00025 EQU   IOINFOPT                                                 04499000
IOINFTMS EQU   IOINFOPT                                                 04500000
IOINFSUP EQU   IOINFOPT                                                 04501000
IOINFDSN EQU   IOINFOPT                                                 04502000
IOINFDVT EQU   IOINFOPT                                                 04503000
OPNVOL   EQU   OPNAGL+44                                                04504000
@NM00024 EQU   OPNAGL+43                                                04505000
@NM00023 EQU   OPNOPT2                                                  04506000
OPNOPTJM EQU   OPNOPT2                                                  04507000
@NM00022 EQU   OPNOPT2                                                  04508000
OPNOPTAS EQU   OPNOPT2                                                  04509000
@NM00021 EQU   OPNDSO                                                   04510000
OPNDSOPO EQU   OPNDSO                                                   04511000
OPNDSOIS EQU   OPNDSO                                                   04512000
OPNDSOPS EQU   OPNDSO                                                   04513000
OPNDSOAM EQU   OPNDSO                                                   04514000
OPNKYL   EQU   OPNAGL+40                                                04515000
OPNBLK   EQU   OPNAGL+36                                                04516000
OPNREC   EQU   OPNAGL+32                                                04517000
OPNDEVIX EQU   OPNDEV+4                                                 04518000
OPNDEVDT EQU   OPNDEV                                                   04519000
OPNCBP   EQU   OPNAGL+20                                                04520000
OPNDSN   EQU   OPNAGL+16                                                04521000
OPNPWA   EQU   OPNAGL+12                                                04522000
OPNDDN   EQU   OPNAGL+8                                                 04523000
OPNIOC   EQU   OPNAGL+4                                                 04524000
OPNMODRP EQU   OPNMOD                                                   04525000
OPNMODUB EQU   OPNMOD                                                   04526000
OPNMODRS EQU   OPNMOD                                                   04527000
OPNMODAX EQU   OPNMOD                                                   04528000
OPNMODRR EQU   OPNMOD                                                   04529000
OPNMODRC EQU   OPNMOD                                                   04530000
OPNMODAC EQU   OPNMOD                                                   04531000
OPNMODPD EQU   OPNMOD                                                   04532000
@NM00020 EQU   OPNTYP                                                   04533000
OPNTYPRV EQU   OPNTYP                                                   04534000
OPNTYPEX EQU   OPNTYP                                                   04535000
OPNTYPRA EQU   OPNTYP                                                   04536000
OPNTYPXM EQU   OPNTYP                                                   04537000
OPNTYPCI EQU   OPNTYP                                                   04538000
OPNTYPSO EQU   OPNTYP                                                   04539000
OPNTYPSI EQU   OPNTYP                                                   04540000
@NM00019 EQU   OPNRFM                                                   04541000
OPNRFMBK EQU   OPNRFM                                                   04542000
OPNRFMSF EQU   OPNRFM                                                   04543000
OPNRFMUN EQU   OPNRFM                                                   04544000
OPNRFMVR EQU   OPNRFM                                                   04545000
OPNRFMFX EQU   OPNRFM                                                   04546000
OPNOPTSK EQU   OPNOPT                                                   04547000
OPNOPTDR EQU   OPNOPT                                                   04548000
OPNOPTCR EQU   OPNOPT                                                   04549000
OPNOPTKS EQU   OPNOPT                                                   04550000
OPNOPTBK EQU   OPNOPT                                                   04551000
OPNOPTUP EQU   OPNOPT                                                   04552000
OPNOPTOT EQU   OPNOPT                                                   04553000
OPNOPTIN EQU   OPNOPT                                                   04554000
IOCEXT   EQU   IOCSTR+64                                                04555000
IOCREL   EQU   IOCSTR+60                                                04556000
IOCWORK  EQU   IOCSTR+56                                                04557000
IOCRRN   EQU   IOCSTR+52                                                04558000
IOCPNM   EQU   IOCNWM+2                                                 04559000
IOCPTL   EQU   IOCNWM                                                   04560000
IOCKYA   EQU   IOCMEM                                                   04561000
IOCVRC   EQU   IOCTTR                                                   04562000
IOCCBP   EQU   IOCSTR+36                                                04563000
IOCDSN   EQU   IOCSTR+32                                                04564000
IOCHURBA EQU   IOCSTR+28                                                04565000
IOCVOLSR EQU   IOCSTR+22                                                04566000
@NM00018 EQU   IOCMSG                                                   04567000
IOCMSGAE EQU   IOCMSG                                                   04568000
IOCMSGCE EQU   IOCMSG                                                   04569000
IOCMSGOE EQU   IOCMSG                                                   04570000
IOCMSGOP EQU   IOCMSG                                                   04571000
@NM00017 EQU   IOCMSG                                                   04572000
IOCCHPSY EQU   IOCCHP                                                   04573000
IOCCHPAS EQU   IOCCHP                                                   04574000
IOCCHPBK EQU   IOCCHP                                                   04575000
IOCCHPCR EQU   IOCCHP                                                   04576000
IOCCHPKS EQU   IOCCHP                                                   04577000
IOCCHPSK EQU   IOCCHP                                                   04578000
IOCCHPDR EQU   IOCCHP                                                   04579000
IOCCHPSQ EQU   IOCCHP                                                   04580000
@NM00016 EQU   IOCMAC2                                                  04581000
IOCMACPA EQU   IOCMAC2                                                  04582000
@NM00015 EQU   IOCMAC2                                                  04583000
IOCMACCP EQU   IOCMAC2                                                  04584000
IOCMACRR EQU   IOCMAC2                                                  04585000
IOCMACAS EQU   IOCMAC2                                                  04586000
IOCMACSK EQU   IOCMAC2                                                  04587000
@NM00014 EQU   IOCMAC                                                   04588000
IOCMACCC EQU   IOCMAC                                                   04589000
IOCMACDR EQU   IOCMAC                                                   04590000
IOCMACBK EQU   IOCMAC                                                   04591000
IOCMACCR EQU   IOCMAC                                                   04592000
IOCMACUP EQU   IOCMAC                                                   04593000
IOCMACOT EQU   IOCMAC                                                   04594000
IOCMACIN EQU   IOCMAC                                                   04595000
@NM00013 EQU   IOCRFM                                                   04596000
IOCRFMBK EQU   IOCRFM                                                   04597000
IOCRFMSF EQU   IOCRFM                                                   04598000
IOCRFMUN EQU   IOCRFM                                                   04599000
IOCRFMVR EQU   IOCRFM                                                   04600000
IOCRFMFX EQU   IOCRFM                                                   04601000
@NM00012 EQU   IOCDSO                                                   04602000
IOCDSOPO EQU   IOCDSO                                                   04603000
IOCDSOIS EQU   IOCDSO                                                   04604000
IOCDSOPS EQU   IOCDSO                                                   04605000
IOCDSOAM EQU   IOCDSO                                                   04606000
IOCRKP   EQU   IOCSTR+13                                                04607000
IOCKYL   EQU   IOCSTR+12                                                04608000
IOCTRN   EQU   IOCSTR+8                                                 04609000
IOCDLN   EQU   IOCSTR+4                                                 04610000
IOCDAD   EQU   IOCSTR                                                   04611000
UNITVTOC EQU   UNITABL+7                                                04612000
@NM00011 EQU   UNITSTAT                                                 04613000
UNITUSHR EQU   UNITSTAT                                                 04614000
UNITXSHR EQU   UNITSTAT                                                 04615000
UNITISHR EQU   UNITSTAT                                                 04616000
UNITUA   EQU   @NM00010+1                                               04617000
UNITCHA  EQU   @NM00010                                                 04618000
UNITUCB  EQU   UNITABL                                                  04619000
ALLUNCNT EQU   ALLAGL+30                                                04620000
ALLVLCNT EQU   ALLAGL+29                                                04621000
@NM00009 EQU   ALLOPT                                                   04622000
ALLOPTUN EQU   ALLOPT                                                   04623000
ALLOPTPV EQU   ALLOPT                                                   04624000
@NM00008 EQU   ALLORG+1                                                 04625000
ALLORGVS EQU   ALLORG+1                                                 04626000
@NM00007 EQU   ALLORG+1                                                 04627000
ALLORGGS EQU   ALLORG+1                                                 04628000
ALLORGUN EQU   ALLORG                                                   04629000
ALLORGPO EQU   ALLORG                                                   04630000
ALLORGMQ EQU   ALLORG                                                   04631000
ALLORGCQ EQU   ALLORG                                                   04632000
ALLORGCX EQU   ALLORG                                                   04633000
ALLORGDA EQU   ALLORG                                                   04634000
ALLORGPS EQU   ALLORG                                                   04635000
ALLORGIS EQU   ALLORG                                                   04636000
ALLDSPUN EQU   ALLDSP                                                   04637000
ALLDSPCG EQU   ALLDSP                                                   04638000
ALLDSPDE EQU   ALLDSP                                                   04639000
@NM00006 EQU   ALLDSP                                                   04640000
ALLSTSMD EQU   ALLSTS                                                   04641000
ALLSTSNW EQU   ALLSTS                                                   04642000
ALLSTSSR EQU   ALLSTS                                                   04643000
@NM00005 EQU   ALLSTS                                                   04644000
ALLPWD   EQU   ALLAGL+20                                                04645000
ALLVLP   EQU   ALLAGL+16                                                04646000
CIRPID   EQU   CIRAGL+28                                                04647000
CIRPWD   EQU   CIRAGL+24                                                04648000
CIRCAT   EQU   CIRAGL+20                                                04649000
CIRWKP   EQU   CIRAGL+16                                                04650000
CIRTLR   EQU   CIRAGL+12                                                04651000
CIRHDR   EQU   CIRAGL+8                                                 04652000
CIRTLN   EQU   CIRAGL+6                                                 04653000
CIRHLN   EQU   CIRAGL+4                                                 04654000
@NM00004 EQU   CIRAGL+1                                                 04655000
@NM00003 EQU   CIRTYPE                                                  04656000
CIRTYPAQ EQU   CIRTYPE                                                  04657000
CIRTYP1Q EQU   CIRTYPE                                                  04658000
NEWID1   EQU   TRACE1+95                                                04659000
CALLID   EQU   OLDERID1+90                                              04660000
@NM00002 EQU   OLDERID1                                                 04661000
*                                      END UNREFERENCED COMPONENTS      04662000
@RC00465 EQU   @RC00449                                                 04663000
@RF00512 EQU   @RC00508                                                 04664000
@RC00533 EQU   @RC00517                                                 04665000
@RF00581 EQU   @RC00577                                                 04666000
@RF00951 EQU   @RC00936                                                 04667000
@PB00009 EQU   @EL00001                                                 04668000
@PB00008 EQU   @PB00009                                                 04669000
@PB00007 EQU   @PB00008                                                 04670000
@PB00006 EQU   @PB00007                                                 04671000
@PB00005 EQU   @PB00006                                                 04672000
@PB00004 EQU   @PB00005                                                 04673000
@PB00003 EQU   @PB00004                                                 04674000
@PB00002 EQU   @PB00003                                                 04675000
@ENDDATA EQU   *                                                        04676000
         END   IDCCP01,(C'PLS2038',0603,76301)                          04677000
