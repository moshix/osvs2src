         TITLE '*********** IDCCV01: CREATEV FUNCTION SUPPORT ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCCV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCCV01   78.164'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @11,0                                               0002 00021000
@PSTART  LA    @12,4095(,@11)                                      0002 00022000
         LA    @09,4095(,@12)                                      0002 00023000
         USING @PSTART,@11                                         0002 00024000
         USING @PSTART+4095,@12                                    0002 00025000
         USING @PSTART+8190,@09                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @10,@01                                             0002 00029000
         USING @DATD,@10                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @10,8(,@13)                                         0002 00033000
         LR    @13,@10                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
*                                                                  0289 00036000
*   /*****************************************************************/ 00037000
*   /*                                                               */ 00038000
*   /* THIS IS THE MAIN CONTROL ROUTING ROUTINE FOR CREATEV  @Y30LB32*/ 00039000
*   /* WRITES MESSAGES IDC0001I IF FUNCTION WAS COMPLETED    @Y30LB32*/ 00040000
*   /* AND IDC3003I IF FUNCTION TERMINATED. CONTROL IS       @Y30LB32*/ 00041000
*   /* RETURNED TO THE EXECUTIVE FROM THIS ROUTINE           @Y30LB32*/ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                                  0289 00045000
*   OLDERID2=NEWERID2;                                             0289 00046000
         L     @08,@PC00001                                        0289 00047000
         L     @15,GDTTR2(,@08)                                    0289 00048000
         MVC   @TS00001(95),NEWERID2(@15)                          0289 00049000
         MVC   OLDERID2(95,@15),@TS00001                           0289 00050000
*   NEWID2='CVCR';                  /*                       @Y30LB32*/ 00051000
         MVC   NEWID2(4,@15),@CC01528                              0290 00052000
*   IF GDTDBG=NULLPTR THEN                                         0291 00053000
         L     @08,GDTDBG(,@08)                                    0291 00054000
         LTR   @08,@08                                             0291 00055000
         BZ    @RT00291                                            0291 00056000
*     ;                                                            0292 00057000
*   ELSE                                                           0293 00058000
*     CALL IDCDB010(GDTTBL,'CVCV'); /*                       @Y30LB32*/ 00059000
*                                                                  0293 00060000
         L     @08,@PC00001                                        0293 00061000
         ST    @08,@AL00001                                        0293 00062000
         LA    @15,@CC01529                                        0293 00063000
         ST    @15,@AL00001+4                                      0293 00064000
         MVI   @AL00001+4,X'80'                                    0293 00065000
         L     @15,GDTDBG(,@08)                                    0293 00066000
         LA    @01,@AL00001                                        0293 00067000
         BALR  @14,@15                                             0293 00068000
*   /*****************************************************************/ 00069000
*   /*                                                               */ 00070000
*   /* INITIALIZE ICBDEFV PARM LIST AREAS TO ZEROES          @Y30LB32*/ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                                  0294 00074000
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/ 00075000
@RT00291 LA    @07,PARMLST                                         0294 00076000
         ST    @07,DEFLSTP                                         0294 00077000
*   DEFLIST=''B;                    /*                       @Y30LB32*/ 00078000
         XC    DEFLIST(132,@07),DEFLIST(@07)                       0295 00079000
*   DEFLSTP=ADDR(PARMLST2);         /*                       @Y30LB32*/ 00080000
         LA    @05,PARMLST2                                        0296 00081000
         ST    @05,DEFLSTP                                         0296 00082000
*   DEFLIST=''B;                    /*                       @Y30LB32*/ 00083000
*                                                                  0297 00084000
         XC    DEFLIST(132,@05),DEFLIST(@05)                       0297 00085000
*   /*****************************************************************/ 00086000
*   /*                                                               */ 00087000
*   /* INITIALIZE MSVC PARAMETER LISTS TO ZEROES             @Y30LB32*/ 00088000
*   /*                                                               */ 00089000
*   /*****************************************************************/ 00090000
*                                                                  0298 00091000
*   DEFVEPTR=ADDR(DEFLSTEX);        /*                       @Y30LB32*/ 00092000
         LA    DEFVEPTR,DEFLSTEX                                   0298 00093000
*   MVRPTR=ADDR(MVRLST);            /*                       @Y30LB32*/ 00094000
         LA    @05,MVRLST                                          0299 00095000
         ST    @05,MVRPTR                                          0299 00096000
*   RVVIPTR=ADDR(RVVILST);          /*                       @Y30LB32*/ 00097000
         LA    @15,RVVILST                                         0300 00098000
         ST    @15,RVVIPTR                                         0300 00099000
*   DEFVE=''B;                      /*                       @Y30LB32*/ 00100000
         XC    DEFVE(64,DEFVEPTR),DEFVE(DEFVEPTR)                  0301 00101000
*   MVR=''B;                        /*                       @Y30LB32*/ 00102000
         XC    MVR(88,@05),MVR(@05)                                0302 00103000
*   RVVI=''B;                       /*                       @Y30LB32*/ 00104000
*                                                                  0303 00105000
         XC    RVVI(68,@15),RVVI(@15)                              0303 00106000
*   /*****************************************************************/ 00107000
*   /*                                                               */ 00108000
*   /* INITIALIZE DEFVE EXTENSION LIST WITH LENGTH OF LIST   @Y30LB32*/ 00109000
*   /*                                                               */ 00110000
*   /*****************************************************************/ 00111000
*                                                                  0304 00112000
*   DEFLNGTH=DEFLEN;                /*                       @Y30LB32*/ 00113000
*                                                                  0304 00114000
         LH    @14,DEFLEN                                          0304 00115000
         ST    @14,DEFLNGTH(,DEFVEPTR)                             0304 00116000
*   /*****************************************************************/ 00117000
*   /*                                                               */ 00118000
*   /* INITIALIZE MSVC PARM LISTS WITH LENGTH AND OP CODE    @Y30LB32*/ 00119000
*   /*                                                               */ 00120000
*   /*****************************************************************/ 00121000
*                                                                  0305 00122000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB32*/ 00123000
         LH    @14,RVVLEN                                          0305 00124000
         ST    @14,RVVLNGTH(,@15)                                  0305 00125000
*   RVVCODE=RVVOP;                  /*                       @Y30LB32*/ 00126000
         MVI   RVVCODE(@15),X'87'                                  0306 00127000
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB32*/ 00128000
         LH    @15,MVRLEN                                          0307 00129000
         ST    @15,MVRLNGTH(,@05)                                  0307 00130000
*   MVROPCD=MVROP;                  /*                       @Y30LB32*/ 00131000
*                                                                  0308 00132000
         MVI   MVROPCD(@05),X'85'                                  0308 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* INITIALIZE VS2AGL, MDAGL, AND CKAGL ARGUMENT LISTS TO @Y30LB32*/ 00136000
*   /* ZEROES                                                @Y30LB32*/ 00137000
*   /*                                                               */ 00138000
*   /*****************************************************************/ 00139000
*                                                                  0309 00140000
*   RFY                                                            0309 00141000
*     VS2AGL BASED(VSAGLPTR);       /*                       @Y30LB32*/ 00142000
*   RFY                                                            0310 00143000
*     MDAGL BASED(MDAGLPTR);        /*                       @Y30LB32*/ 00144000
*   RFY                                                            0311 00145000
*     CKAGL BASED(CKAGLPTR);        /*                       @Y30LB32*/ 00146000
*   RFY                                                            0312 00147000
*     EXCLAGL BASED(ADDR(EXCLLST)); /*                       @YD00175*/ 00148000
*   VSAGLPTR=ADDR(VS2AGLST);        /*                       @Y30LB32*/ 00149000
         LA    @15,VS2AGLST                                        0313 00150000
         ST    @15,VSAGLPTR                                        0313 00151000
*   MDAGLPTR=ADDR(MDAGLLST);        /*                       @Y30LB32*/ 00152000
         LA    @14,MDAGLLST                                        0314 00153000
         ST    @14,MDAGLPTR                                        0314 00154000
*   CKAGLPTR=ADDR(CKAGLLST);        /*                       @Y30LB32*/ 00155000
         LA    CKAGLPTR,CKAGLLST                                   0315 00156000
*   VS2AGL=''B;                     /*                       #Y30LB32*/ 00157000
         XC    VS2AGL(52,@15),VS2AGL(@15)                          0316 00158000
*   MDAGL=''B;                      /*                       #Y30LB32*/ 00159000
         XC    MDAGL(37,@14),MDAGL(@14)                            0317 00160000
*   CKAGL=''B;                      /*                       #Y30LB32*/ 00161000
         XC    CKAGL(29,CKAGLPTR),CKAGL(CKAGLPTR)                  0318 00162000
*   EXCLAGL=''B;                    /*                       @YD00175*/ 00163000
*                                                                  0319 00164000
         LA    @03,EXCLLST                                         0319 00165000
         XC    EXCLAGL(23,@03),EXCLAGL(@03)                        0319 00166000
*   /*****************************************************************/ 00167000
*   /*                                                               */ 00168000
*   /* INITIALIZE DEFINE PARM LIST FIELDS TO CREATE A VOLUME @Y30LB32*/ 00169000
*   /*                                                               */ 00170000
*   /*****************************************************************/ 00171000
*                                                                  0320 00172000
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/ 00173000
         ST    @07,DEFLSTP                                         0320 00174000
*   DEFVCR=ON;                      /*                       @Y30LB32*/ 00175000
         OI    DEFVCR(@07),B'10000000'                             0321 00176000
*   DEFTLAB=TCHAR;                  /*                       @Y30LB32*/ 00177000
         MVI   DEFTLAB(@07),C'T'                                   0322 00178000
*   DEFVVEXT=DEFVEPTR;              /*                       @Y30LB32*/ 00179000
         ST    DEFVEPTR,DEFVVEXT(,@07)                             0323 00180000
*                                                                  0324 00181000
*   /*****************************************************************/ 00182000
*   /*                                                               */ 00183000
*   /* SET DEFSRCVY TO INDICATE RECOVERY FLAG IS TO BE SET   @Y30LB32*/ 00184000
*   /* AND SET DEFCREAT TO INDICATE INCOMPLETE CREATE FLAG   @Y30LB32*/ 00185000
*   /* IS TO BE SET                                          @Y30LB32*/ 00186000
*   /*                                                               */ 00187000
*   /*****************************************************************/ 00188000
*                                                                  0324 00189000
*   DEFSRCVY=ON;                    /*                       @Y30LB32*/ 00190000
         OI    DEFSRCVY(DEFVEPTR),B'10000000'                      0324 00191000
*   DEFCREAT=ON;                    /*                       @Y30LB32*/ 00192000
*                                                                  0325 00193000
         OI    DEFCREAT(DEFVEPTR),B'01000000'                      0325 00194000
*   /*****************************************************************/ 00195000
*   /*                                                               */ 00196000
*   /* INITIALIZE AREA FOR UCB ADDRESS TO ZEROES AND         @Y30LB32*/ 00197000
*   /* SET VS2AGL, MDAGL, CKAGL, AND EXCLAGL ARGUMENT        @YD00175*/ 00198000
*   /* LISTS WITH POINTER TO AREA FOR UCB ADDRESS            @YD00175*/ 00199000
*   /*                                                               */ 00200000
*   /*****************************************************************/ 00201000
*                                                                  0326 00202000
*   UCBPTR=''B;                     /*                       @Y30LB32*/ 00203000
         SLR   @07,@07                                             0326 00204000
         ST    @07,UCBPTR                                          0326 00205000
*   VSUCBPTR=ADDR(UCBPTR);          /*                       @Y30LB32*/ 00206000
         LA    @07,UCBPTR                                          0327 00207000
         ST    @07,VSUCBPTR(,@15)                                  0327 00208000
*   MDUCBPTR=ADDR(UCBPTR);          /*                       @Y30LB32*/ 00209000
         ST    @07,MDUCBPTR(,@14)                                  0328 00210000
*   CKUCBPTR=ADDR(UCBPTR);          /*                       @Y30LB32*/ 00211000
         ST    @07,CKUCBPTR(,CKAGLPTR)                             0329 00212000
*   EXCLUCBP=ADDR(UCBPTR);          /*                       @YD00175*/ 00213000
*                                                                  0330 00214000
         ST    @07,EXCLUCBP(,@03)                                  0330 00215000
*   /*****************************************************************/ 00216000
*   /*                                                               */ 00217000
*   /* INITIALIZE FLAG BITS USED BY CREATEV TO ZEROS         @Y30LB32*/ 00218000
*   /*                                                               */ 00219000
*   /*****************************************************************/ 00220000
*                                                                  0331 00221000
*   CRVFLGS=''B;                    /*                       @Y30LB32*/ 00222000
*                                                                  0331 00223000
         XC    CRVFLGS(2),CRVFLGS                                  0331 00224000
*   /*****************************************************************/ 00225000
*   /*                                                               */ 00226000
*   /* INITIALIZE THE CLEAR INCOMPLETE VOLUME CREATION FLAG  @Y30LB32*/ 00227000
*   /* IN MVR                                                @Y30LB32*/ 00228000
*   /*                                                               */ 00229000
*   /*****************************************************************/ 00230000
*                                                                  0332 00231000
*   MVRCIVCF=ON;                    /*                       @Y30LB32*/ 00232000
*                                                                  0332 00233000
         OI    MVRCIVCF(@05),B'10000000'                           0332 00234000
*   /*****************************************************************/ 00235000
*   /*                                                               */ 00236000
*   /* SET RNAME WITH LENGTH OF NAME AND WITH KEYWORD        @Y30LB32*/ 00237000
*   /* VIRTUAL TO ENQUEUE AND RESERVE VOLUMES                @ZA05119*/ 00238000
*   /*                                                               */ 00239000
*   /*****************************************************************/ 00240000
*                                                                  0333 00241000
*   RNAMELN=LENGTH(VOLSER)+LENGTH(VIRTNAME)/*                @ZA13060*/ 00242000
*       +LENGTH(TYPENAME);          /*                       @ZA13060*/ 00243000
         MVI   RNAMELN,X'16'                                       0333 00244000
*   VIRTNAME=VIRTUAL;               /*                       @Y30LB32*/ 00245000
*                                                                  0334 00246000
         MVC   VIRTNAME(8),@CC01487                                0334 00247000
*   /*****************************************************************/ 00248000
*   /*                                                               */ 00249000
*   /* SET POINTER TO DARGLIST WITH ADDRESS TO STORAGE AREA  @Y30LB32*/ 00250000
*   /* SET GROUP RECORD PTR WITH ADDRESS TO BUFFER AREA      @Y30LB32*/ 00251000
*   /*                                                               */ 00252000
*   /*****************************************************************/ 00253000
*                                                                  0335 00254000
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB32*/ 00255000
         LA    @07,PRINTTAB                                        0335 00256000
         ST    @07,DDSTRU                                          0335 00257000
*   GROUPPTR=ADDR(BUFFER);          /*                       @Y30LB32*/ 00258000
*                                                                  0336 00259000
         LA    GROUPPTR,BUFFER                                     0336 00260000
*   /*****************************************************************/ 00261000
*   /*                                                               */ 00262000
*   /* PROVIDE POINTER VALUE TO LOCATE DATA RETURNED BY      @Y30LB32*/ 00263000
*   /* DEFINE MACRO MESSAGE                                  @Y30LB32*/ 00264000
*   /*                                                               */ 00265000
*   /*****************************************************************/ 00266000
*                                                                  0337 00267000
*   RFY                                                            0337 00268000
*     CMMSG BASED(CMMSGPTR+ECBLEN); /*                       @Y30LB32*/ 00269000
*                                                                  0338 00270000
*   /*****************************************************************/ 00271000
*   /*                                                               */ 00272000
*   /* CHECK FDT TO DETERMINE IF THE GROUP PARAMETER WAS     @Y30LB32*/ 00273000
*   /* SPECIFIED, IF SPECIFIED INVOKE ROUTINE GRPPROC        @Y30LB32*/ 00274000
*   /*                                                               */ 00275000
*   /*****************************************************************/ 00276000
*                                                                  0338 00277000
*   IF(ADDR(GRP))^=NULLPTR THEN     /*                       @Y30LB32*/ 00278000
         L     @07,@PC00001+4                                      0338 00279000
         L     @07,FDTPTR+36(,@07)                                 0338 00280000
         LTR   @07,@07                                             0338 00281000
         BZ    @RF00338                                            0338 00282000
*     DO;                           /*                       @Y30LB32*/ 00283000
*       CALL GRPPROC;               /*                       @Y30LB32*/ 00284000
         BAL   @14,GRPPROC                                         0340 00285000
*       RESPECIFY                                                  0341 00286000
*         RTNREG RSTD;                                             0341 00287000
*       TESTRC=RTNREG;                                             0342 00288000
         LR    TESTRC,RTNREG                                       0342 00289000
*       RESPECIFY                                                  0343 00290000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 00291000
*     END;                          /*                       @Y30LB32*/ 00292000
*                                                                  0344 00293000
*   /*****************************************************************/ 00294000
*   /*                                                               */ 00295000
*   /* CALL ATTRIBUTE ROUTINE TO CHECK GROUP ATTRIBUTES      @Y30LB32*/ 00296000
*   /* SPECIFIED AND SET ATTRIBUTES FOR NEW VOLUME           @Y30LB32*/ 00297000
*   /*                                                               */ 00298000
*   /*****************************************************************/ 00299000
*                                                                  0345 00300000
*   ELSE                            /*                       @Y30LB32*/ 00301000
*     DO;                           /*                       @Y30LB32*/ 00302000
         B     @RC00338                                            0345 00303000
@RF00338 DS    0H                                                  0346 00304000
*       CALL ATTRBUTE;              /*                       @Y30LB32*/ 00305000
         BAL   @14,ATTRBUTE                                        0346 00306000
*       RESPECIFY                                                  0347 00307000
*         RTNREG RSTD;                                             0347 00308000
*       TESTRC=RTNREG;                                             0348 00309000
         LR    TESTRC,RTNREG                                       0348 00310000
*       RESPECIFY                                                  0349 00311000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 00312000
*     END;                          /*                       @Y30LB32*/ 00313000
*                                                                  0350 00314000
*   /*****************************************************************/ 00315000
*   /*                                                               */ 00316000
*   /* CHECK FOR ERROR RETURN CODE FROM GRPPROC OR ATTRIBUTE @Y30LB32*/ 00317000
*   /* IF ERROR CODE RETURNED SET LASTCOND                   @Y30LB32*/ 00318000
*   /*                                                               */ 00319000
*   /*****************************************************************/ 00320000
*                                                                  0351 00321000
*   IF TESTRC^=0 THEN               /*                       @Y30LB32*/ 00322000
@RC00338 LTR   TESTRC,TESTRC                                       0351 00323000
         BZ    @RF00351                                            0351 00324000
*     LASTCOND=LASTCC04;            /*                       @Y30LB32*/ 00325000
*                                                                  0352 00326000
         L     @07,@PC00001+8                                      0352 00327000
         MVC   LASTCOND(2,@07),@CH00042                            0352 00328000
*   /*****************************************************************/ 00329000
*   /*                                                               */ 00330000
*   /* CHECK THE COUNTVAL FIELD IN THE FDT TO DETERMINE      @Y30LB32*/ 00331000
*   /* NUMBER OF NEW VOLUMES TO BE CREATED. IF COUNT IS MORE @Y30LB32*/ 00332000
*   /* THEN ONE CALL CKVOLSER ROUTINE TO CHECK VOLUME SERIAL @Y30LB32*/ 00333000
*   /* FOR NUMERIC CHARACTERS                                @Y30LB32*/ 00334000
*   /*                                                               */ 00335000
*   /*****************************************************************/ 00336000
*                                                                  0353 00337000
*   IF COUNTVAL>1 THEN              /*                       @Y30LB32*/ 00338000
@RF00351 L     @07,@PC00001+4                                      0353 00339000
         L     @07,FDTPTR+8(,@07)                                  0353 00340000
         L     @07,COUNTVAL(,@07)                                  0353 00341000
         C     @07,@CF00221                                        0353 00342000
         BNH   @RF00353                                            0353 00343000
*     DO;                           /*                       @Y30LB32*/ 00344000
*       CALL CKVOLSER;              /*                       @Y30LB32*/ 00345000
         BAL   @14,CKVOLSER                                        0355 00346000
*       RESPECIFY                                                  0356 00347000
*         RTNREG RSTD;                                             0356 00348000
*       TESTRC=RTNREG;                                             0357 00349000
         LR    TESTRC,RTNREG                                       0357 00350000
*       RESPECIFY                                                  0358 00351000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 00352000
*                                                                  0358 00353000
*       /*************************************************************/ 00354000
*       /*                                                           */ 00355000
*       /* CHECK FOR ERROR RETURN CODE FROM CKVOLSER. IF     @Y30LB32*/ 00356000
*       /* ERROR CODE RETURNED SET LASTCOND                  @Y30LB32*/ 00357000
*       /*                                                           */ 00358000
*       /*************************************************************/ 00359000
*                                                                  0359 00360000
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/ 00361000
         LTR   TESTRC,TESTRC                                       0359 00362000
         BZ    @RF00359                                            0359 00363000
*         LASTCOND=LASTCC04;        /*                       @Y30LB32*/ 00364000
         L     @07,@PC00001+8                                      0360 00365000
         MVC   LASTCOND(2,@07),@CH00042                            0360 00366000
*     END;                          /*                       @Y30LB32*/ 00367000
@RF00359 DS    0H                                                  0362 00368000
*                                                                  0362 00369000
*   /*****************************************************************/ 00370000
*   /*                                                               */ 00371000
*   /* INITIALIZE CKAGL ARGUMENT LIST TO CHECK FOR A 3330    @Y30LB32*/ 00372000
*   /* VIRTUAL UCB. THE DDNAME IS ACCESSED FROM THE FDT      @YD00175*/ 00373000
*   /*                                                               */ 00374000
*   /*****************************************************************/ 00375000
*                                                                  0362 00376000
*   CKDDNAME=FILEVAL;               /*                       @Y30LB32*/ 00377000
@RF00353 L     @07,@PC00001+4                                      0362 00378000
         L     @07,FDTPTR+4(,@07)                                  0362 00379000
         MVC   CKDDNAME(8,CKAGLPTR),FILEVAL(@07)                   0362 00380000
*   CKTESTVT=ON;                    /*                       @Y30LB32*/ 00381000
*                                                                  0363 00382000
         OI    CKTESTVT(CKAGLPTR),B'10000000'                      0363 00383000
*   /*****************************************************************/ 00384000
*   /*                                                               */ 00385000
*   /* ISSUE UMSSUNIT(CHECK) TO CHECK FOR A 3330 VIRTUAL UCB @Y30LB32*/ 00386000
*   /*                                                               */ 00387000
*   /*****************************************************************/ 00388000
*                                                                  0364 00389000
*   CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                     @Y30LB32*/ 00390000
         L     @07,@PC00001                                        0364 00391000
         ST    @07,@AL00001                                        0364 00392000
         LA    @02,CHECK                                           0364 00393000
         ST    @02,@AL00001+4                                      0364 00394000
         ST    CKAGLPTR,@AL00001+8                                 0364 00395000
         MVI   @AL00001+8,X'80'                                    0364 00396000
         L     @15,GDTUNT(,@07)                                    0364 00397000
         LA    @01,@AL00001                                        0364 00398000
         BALR  @14,@15                                             0364 00399000
*   RESPECIFY                                                      0365 00400000
*     RTNREG RSTD;                                                 0365 00401000
*   TESTRC=RTNREG;                                                 0366 00402000
         LR    TESTRC,RTNREG                                       0366 00403000
*   RESPECIFY                                                      0367 00404000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 00405000
*                                                                  0367 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* CHECK FOR ERROR RETURN CODE FROM UMSSUNIT(CHECK). IF  @Y30LB32*/ 00409000
*   /* ERROR CODE IS RETURNED SET LASTCOND                   @Y30LB32*/ 00410000
*   /*                                                               */ 00411000
*   /*****************************************************************/ 00412000
*                                                                  0368 00413000
*   IF TESTRC^=0 THEN               /*                       @Y30LB32*/ 00414000
         LTR   TESTRC,TESTRC                                       0368 00415000
         BZ    @RF00368                                            0368 00416000
*     LASTCOND=LASTCC04;            /*                       @Y30LB32*/ 00417000
*                                                                  0369 00418000
         L     @15,@PC00001+8                                      0369 00419000
         MVC   LASTCOND(2,@15),@CH00042                            0369 00420000
*   /*****************************************************************/ 00421000
*   /*                                                               */ 00422000
*   /* IF NO ERRORS, GET EXCLUSIVE CONTROL OF THE VOLUME     @YD00175*/ 00423000
*   /*                                                               */ 00424000
*   /*****************************************************************/ 00425000
*                                                                  0370 00426000
*   IF LASTCOND=LASTCC00 THEN                                      0370 00427000
@RF00368 L     @15,@PC00001+8                                      0370 00428000
         LH    @15,LASTCOND(,@15)                                  0370 00429000
         LTR   @15,@15                                             0370 00430000
         BNZ   @RF00370                                            0370 00431000
*     DO;                           /*                       @YD00175*/ 00432000
*       EXCLDDP=ADDR(FILEVAL);      /*                       @YD00175*/ 00433000
*                                                                  0372 00434000
         LA    @02,EXCLLST                                         0372 00435000
         L     @15,@PC00001+4                                      0372 00436000
         L     @01,FDTPTR+4(,@15)                                  0372 00437000
         LA    @15,FILEVAL(,@01)                                   0372 00438000
         ST    @15,EXCLDDP(,@02)                                   0372 00439000
*       /*************************************************************/ 00440000
*       /*                                                           */ 00441000
*       /* ISSUE UMSSUNIT(CHANGEX) TO GET EXCLUSIVE CONTROL  @YD00175*/ 00442000
*       /*                                                           */ 00443000
*       /*************************************************************/ 00444000
*                                                                  0373 00445000
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/ 00446000
         L     @15,@PC00001                                        0373 00447000
         ST    @15,@AL00001                                        0373 00448000
         LA    @14,CHANGEX                                         0373 00449000
         ST    @14,@AL00001+4                                      0373 00450000
         ST    @02,@AL00001+8                                      0373 00451000
         MVI   @AL00001+8,X'80'                                    0373 00452000
         L     @15,GDTUNT(,@15)                                    0373 00453000
         LA    @01,@AL00001                                        0373 00454000
         BALR  @14,@15                                             0373 00455000
*       RESPECIFY                                                  0374 00456000
*         RTNREG RSTD;                                             0374 00457000
*       TESTRC=RTNREG;                                             0375 00458000
         LR    TESTRC,RTNREG                                       0375 00459000
*       RESPECIFY                                                  0376 00460000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 00461000
*       IF TESTRC>0 THEN                                           0377 00462000
         LTR   TESTRC,TESTRC                                       0377 00463000
         BNP   @RF00377                                            0377 00464000
*         LASTCOND=LASTCC04;        /*                       @YD00175*/ 00465000
         L     @15,@PC00001+8                                      0378 00466000
         MVC   LASTCOND(2,@15),@CH00042                            0378 00467000
*     END;                          /*                       @YD00175*/ 00468000
*                                                                  0379 00469000
@RF00377 DS    0H                                                  0380 00470000
*   /*****************************************************************/ 00471000
*   /*                                                               */ 00472000
*   /* CHECK CONDITION CODE EQUAL ZERO, IF ZERO CALL ACCESS  #Y30LB32*/ 00473000
*   /* ROUTINE                                               #Y30LB32*/ 00474000
*   /*                                                               */ 00475000
*   /*****************************************************************/ 00476000
*                                                                  0380 00477000
*   IF LASTCOND=LASTCC00 THEN       /*                       #Y30LB32*/ 00478000
@RF00370 L     @15,@PC00001+8                                      0380 00479000
         LH    @15,LASTCOND(,@15)                                  0380 00480000
         LTR   @15,@15                                             0380 00481000
         BNZ   @RF00380                                            0380 00482000
*     DO;                           /*                       #Y30LB32*/ 00483000
*       CALL ACCESS;                /*                       #Y30LB32*/ 00484000
*                                                                  0382 00485000
         BAL   @14,ACCESS                                          0382 00486000
*       /*************************************************************/ 00487000
*       /*                                                           */ 00488000
*       /* CALL CREATVOL ROUTINE TO CREATE NEW VOLUME        @Y30LB32*/ 00489000
*       /*                                                           */ 00490000
*       /*************************************************************/ 00491000
*                                                                  0383 00492000
*       CALL CREATVOL;              /*                       @Y30LB32*/ 00493000
         BAL   @14,CREATVOL                                        0383 00494000
*       RESPECIFY                                                  0384 00495000
*         RTNREG RSTD;                                             0384 00496000
*       TESTRC=RTNREG;                                             0385 00497000
         LR    TESTRC,RTNREG                                       0385 00498000
*       RESPECIFY                                                  0386 00499000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 00500000
*                                                                  0386 00501000
*       /*************************************************************/ 00502000
*       /*                                                           */ 00503000
*       /* CHECK FOR ERROR RETURN CODE FROM CREATVOL. IF     @Y30LB32*/ 00504000
*       /* ERROR CODE IS RETURNED SET LASTCOND               @Y30LB32*/ 00505000
*       /*                                                           */ 00506000
*       /*************************************************************/ 00507000
*                                                                  0387 00508000
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/ 00509000
         LTR   TESTRC,TESTRC                                       0387 00510000
         BZ    @RF00387                                            0387 00511000
*         LASTCOND=LASTCC04;        /*                       @Y30LB32*/ 00512000
*                                                                  0388 00513000
         L     @08,@PC00001+8                                      0388 00514000
         MVC   LASTCOND(2,@08),@CH00042                            0388 00515000
*       /*************************************************************/ 00516000
*       /*                                                           */ 00517000
*       /* CHECK CONDITION CODE TO SET FINAL CONDITION CODE  @Y30LB32*/ 00518000
*       /* IF CONDITION CODE IS NOT ZERO CHECK CREATFLG TO   @Y30LB32*/ 00519000
*       /* SEE IF ANY VOLUMES WERE CREATED                   @Y30LB32*/ 00520000
*       /*                                                           */ 00521000
*       /*************************************************************/ 00522000
*                                                                  0389 00523000
*       IF LASTCOND^=0 THEN         /*                       @Y30LB32*/ 00524000
@RF00387 L     @08,@PC00001+8                                      0389 00525000
         LH    @15,LASTCOND(,@08)                                  0389 00526000
         LTR   @15,@15                                             0389 00527000
         BZ    @RF00389                                            0389 00528000
*         DO;                       /*                       @Y30LB32*/ 00529000
*                                                                  0390 00530000
*           /*********************************************************/ 00531000
*           /*                                                       */ 00532000
*           /* CHECK CREATFLG FLAG, IF ON SET LASTCOND TO    @Y30LB32*/ 00533000
*           /* EIGHT                                         @Y30LB32*/ 00534000
*           /*                                                       */ 00535000
*           /*********************************************************/ 00536000
*                                                                  0391 00537000
*           IF CREATFLG=ON THEN     /*                       @Y30LB32*/ 00538000
         TM    CREATFLG,B'10000000'                                0391 00539000
         BNO   @RF00391                                            0391 00540000
*             LASTCOND=LASTCC08;    /*                       @Y30LB32*/ 00541000
*                                                                  0392 00542000
         MVC   LASTCOND(2,@08),@CH00181                            0392 00543000
*           /*********************************************************/ 00544000
*           /*                                                       */ 00545000
*           /* SET LASTCOND TO TWELVE IF NO VOLUMES CREATED  @Y30LB32*/ 00546000
*           /*                                                       */ 00547000
*           /*********************************************************/ 00548000
*                                                                  0393 00549000
*           ELSE                    /*                       @Y30LB32*/ 00550000
*             LASTCOND=LASTCC12;    /*                       @Y30LB32*/ 00551000
         B     @RC00391                                            0393 00552000
@RF00391 L     @08,@PC00001+8                                      0393 00553000
         MVC   LASTCOND(2,@08),@CH00606                            0393 00554000
*         END;                      /*                       @Y30LB32*/ 00555000
*                                                                  0394 00556000
*       /*************************************************************/ 00557000
*       /*                                                           */ 00558000
*       /* IF CONDITION CODE IS ZERO AND VIERRFLG IS ON THEN @ZA00067*/ 00559000
*       /* SET FINAL CONDITION CODE TO FOUR. IF ROFAIL FLAG  @ZA00067*/ 00560000
*       /* IS ON THEN SET FINAL CONDITION CODE TO EIGHT.     @ZA00067*/ 00561000
*       /*                                                           */ 00562000
*       /*************************************************************/ 00563000
*                                                                  0395 00564000
*       ELSE                        /*                       @Y30LB32*/ 00565000
*         DO;                       /*                       @ZA00067*/ 00566000
         B     @RC00389                                            0395 00567000
@RF00389 DS    0H                                                  0396 00568000
*           IF VIERRFLG=ON THEN     /*                       @ZA00067*/ 00569000
         TM    VIERRFLG,B'01000000'                                0396 00570000
         BNO   @RF00396                                            0396 00571000
*             LASTCOND=LASTCC04;    /*                       @ZA00067*/ 00572000
         L     @08,@PC00001+8                                      0397 00573000
         MVC   LASTCOND(2,@08),@CH00042                            0397 00574000
*           IF ROFAIL=ON THEN       /*                       @ZA00067*/ 00575000
@RF00396 TM    ROFAIL,B'00000010'                                  0398 00576000
         BNO   @RF00398                                            0398 00577000
*             LASTCOND=LASTCC08;    /*                       @ZA00067*/ 00578000
         L     @08,@PC00001+8                                      0399 00579000
         MVC   LASTCOND(2,@08),@CH00181                            0399 00580000
*         END;                      /*                       @ZA00067*/ 00581000
*     END;                          /*                       @Y30LB32*/ 00582000
*                                                                  0401 00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* IF CONDITION CODE WAS NOT ZERO BEFORE CALL TO         @Y30LB32*/ 00586000
*   /* ACCESS ROUTINE SET LASTCOND TO TWELVE                 @Y30LB32*/ 00587000
*   /*                                                               */ 00588000
*   /*****************************************************************/ 00589000
*                                                                  0402 00590000
*   ELSE                            /*                       @Y30LB32*/ 00591000
*     LASTCOND=LASTCC12;            /*                       @Y30LB32*/ 00592000
         B     @RC00380                                            0402 00593000
@RF00380 L     @08,@PC00001+8                                      0402 00594000
         MVC   LASTCOND(2,@08),@CH00606                            0402 00595000
*                                                                  0403 00596000
*   /*****************************************************************/ 00597000
*   /*                                                               */ 00598000
*   /* ISSUE COMPLETION MESSAGE IDC0001I IF FUNCTION WAS     @Y30LB32*/ 00599000
*   /* COMPLETE OR TERMINATING MESSAGE IDC3003I IF FUNCTION  @Y30LB32*/ 00600000
*   /* WAS NOT PERFORMED                                     @Y30LB32*/ 00601000
*   /*                                                               */ 00602000
*   /*****************************************************************/ 00603000
*                                                                  0403 00604000
*   PRINTTAB=''B;                   /*                       @Y30LB32*/ 00605000
@RC00380 XC    PRINTTAB(36),PRINTTAB                               0403 00606000
*   IF LASTCOND<LASTCC12 THEN       /*                       @Y30LB32*/ 00607000
         L     @08,@PC00001+8                                      0404 00608000
         LH    @08,LASTCOND(,@08)                                  0404 00609000
         C     @08,@CF00606                                        0404 00610000
         BNL   @RF00404                                            0404 00611000
*     DARGSENT=MSG0001I;            /*                       @Y30LB32*/ 00612000
         L     @08,DDSTRU                                          0405 00613000
         MVI   DARGSENT(@08),X'01'                                 0405 00614000
*   ELSE                            /*                       @Y30LB32*/ 00615000
*     DARGSENT=MSG3003I;            /*                       @Y30LB32*/ 00616000
         B     @RC00404                                            0406 00617000
@RF00404 L     @08,DDSTRU                                          0406 00618000
         MVI   DARGSENT(@08),X'03'                                 0406 00619000
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB32*/ 00620000
@RC00404 L     @08,DDSTRU                                          0407 00621000
         MVC   DARGSMOD(3,@08),@CC01458                            0407 00622000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB32*/ 00623000
         L     @15,@PC00001+8                                      0408 00624000
         ST    @15,DARGDBP(,@08)                                   0408 00625000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB32*/ 00626000
         MVC   DARGILP(2,@08),@CH00155                             0409 00627000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB32*/ 00628000
         L     @08,@PC00001                                        0410 00629000
         ST    @08,@AL00001                                        0410 00630000
         LA    @15,@CF00116                                        0410 00631000
         ST    @15,@AL00001+4                                      0410 00632000
         LA    @15,DDSTRU                                          0410 00633000
         ST    @15,@AL00001+8                                      0410 00634000
         MVI   @AL00001+8,X'80'                                    0410 00635000
         L     @15,GDTPRT(,@08)                                    0410 00636000
         LA    @01,@AL00001                                        0410 00637000
         BALR  @14,@15                                             0410 00638000
*   IF GDTDBG=NULLPTR THEN                                         0411 00639000
         L     @08,@PC00001                                        0411 00640000
         L     @08,GDTDBG(,@08)                                    0411 00641000
         LTR   @08,@08                                             0411 00642000
         BZ    @RT00411                                            0411 00643000
*     ;                                                            0412 00644000
*   ELSE                                                           0413 00645000
*     CALL IDCDB010(GDTTBL,'CVRP'); /*                       @Y30LB32*/ 00646000
*                                                                  0413 00647000
         L     @08,@PC00001                                        0413 00648000
         ST    @08,@AL00001                                        0413 00649000
         LA    @15,@CC01543                                        0413 00650000
         ST    @15,@AL00001+4                                      0413 00651000
         MVI   @AL00001+4,X'80'                                    0413 00652000
         L     @15,GDTDBG(,@08)                                    0413 00653000
         LA    @01,@AL00001                                        0413 00654000
         BALR  @14,@15                                             0413 00655000
*   /*****************************************************************/ 00656000
*   /*                                                               */ 00657000
*   /* RETURN CONTROL TO AMS EXECUTIVE                       @Y30LB32*/ 00658000
*   /*                                                               */ 00659000
*   /*****************************************************************/ 00660000
*                                                                  0414 00661000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0414 00662000
*                                                                  0414 00663000
@RT00411 L     @08,@PC00001                                        0414 00664000
         ST    @08,@AL00001                                        0414 00665000
         LA    @15,MODID                                           0414 00666000
         ST    @15,@AL00001+4                                      0414 00667000
         L     @15,@PC00001+8                                      0414 00668000
         ST    @15,@AL00001+8                                      0414 00669000
         MVI   @AL00001+8,X'80'                                    0414 00670000
         L     @15,GDTEPL(,@08)                                    0414 00671000
         LA    @01,@AL00001                                        0414 00672000
         BALR  @14,@15                                             0414 00673000
*   /*****************************************************************/ 00674000
*   /*                                                               */ 00675000
*   /*                                                       @Y30LB32*/ 00676000
*   /*                                                               */ 00677000
*   /*****************************************************************/ 00678000
*                                                                  0415 00679000
*                                                                  0415 00680000
*/********************************************************************/ 00681000
*/*                                                          @Y30LB32*/ 00682000
*/*  PROCEDURE NAME - GRPPROC                                @Y30LB32*/ 00683000
*/*                                                          @Y30LB32*/ 00684000
*/*  FUNCTION - CHECKS FOR GROUP ATTRIBUTES SPECIFIED        @Y30LB32*/ 00685000
*/*             ROUTES CONTROL TO ATTRBUTE OR GENPROC        @Y30LB32*/ 00686000
*/*             BASED ON GROUP ATTRIBUTE SPECIFIED OR NOT    @Y30LB32*/ 00687000
*/*             SPECIFIED                                    @Y30LB32*/ 00688000
*/*                                                          @Y30LB32*/ 00689000
*/*  INPUT - RESTRICT PARAMETER IN FDT                       @Y30LB32*/ 00690000
*/*                                                          @Y30LB32*/ 00691000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 00692000
*/*             RETURN CODE = 0 - GRPPROC SUCCESSFUL         @Y30LB32*/ 00693000
*/*             RETURN CODE = 4 - GROUP RECORD NOT READ OR   @Y30LB32*/ 00694000
*/*                               ATTRIBUTES DO NOT MATCH    @Y30LB32*/ 00695000
*/*                                                          @Y30LB32*/ 00696000
*/********************************************************************/ 00697000
*                                                                  0415 00698000
*GRPPROC:                                                          0415 00699000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 00700000
*                                                                  0415 00701000
@EL00001 L     @13,4(,@13)                                         0415 00702000
@EF00001 L     @00,@SIZDATD                                        0415 00703000
         LR    @01,@10                                             0415 00704000
         FREEMAIN R,LV=(0),A=(1)                                        00705000
@ER00001 LM    @14,@12,12(@13)                                     0415 00706000
         BR    @14                                                 0415 00707000
GRPPROC  DS    0H                                                  0416 00708000
*   /*****************************************************************/ 00709000
*   /*                                                               */ 00710000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 00711000
*   /* TO ZERO                                               @Y30LB32*/ 00712000
*   /*                                                               */ 00713000
*   /*****************************************************************/ 00714000
*                                                                  0416 00715000
*   RETADDR=REG14;                  /*                       @Y30LB32*/ 00716000
         LR    RETADDR,REG14                                       0416 00717000
*   OLDERID2=NEWERID2;                                             0417 00718000
         L     @05,@PC00001                                        0417 00719000
         L     @05,GDTTR2(,@05)                                    0417 00720000
         MVC   @TS00001(95),NEWERID2(@05)                          0417 00721000
         MVC   OLDERID2(95,@05),@TS00001                           0417 00722000
*   NEWID2='CVGP';                  /*                       @Y30LB32*/ 00723000
         MVC   NEWID2(4,@05),@CC01547                              0418 00724000
*   GRPCOND=0;                      /*                       @Y30LB32*/ 00725000
*                                                                  0419 00726000
         SLR   @05,@05                                             0419 00727000
         STH   @05,GRPCOND                                         0419 00728000
*   /*****************************************************************/ 00729000
*   /*                                                               */ 00730000
*   /* ACCESS GROUP NAME FROM FDT AND PLACE IN DEFINE PARM   @Y30LB32*/ 00731000
*   /* LIST EXTENSION DEFVE AND SPECIFY GROUP NAME SET       @Y30LB32*/ 00732000
*   /*                                                               */ 00733000
*   /*****************************************************************/ 00734000
*                                                                  0420 00735000
*   DEFGROUP=GRPVAL;                /*                       @Y30LB32*/ 00736000
         L     @15,@PC00001+4                                      0420 00737000
         L     @01,FDTPTR+36(,@15)                                 0420 00738000
         MVC   DEFGROUP(8,DEFVEPTR),GRPVAL(@01)                    0420 00739000
*   DEFPGRO=ON;                     /*                       @Y30LB32*/ 00740000
*                                                                  0421 00741000
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       0421 00742000
*   /*****************************************************************/ 00743000
*   /*                                                               */ 00744000
*   /* CHECK FDT TO DETERMINE IF RESTRICTED PARAMETER WAS    @Y30LB32*/ 00745000
*   /* SPECIFIED                                             @Y30LB32*/ 00746000
*   /*                                                               */ 00747000
*   /*****************************************************************/ 00748000
*                                                                  0422 00749000
*   IF(ADDR(RSTR))^=NULLPTR THEN    /*                       @Y30LB32*/ 00750000
         C     @05,FDTPTR+44(,@15)                                 0422 00751000
         BE    @RF00422                                            0422 00752000
*     DO;                           /*                       @Y30LB32*/ 00753000
*                                                                  0423 00754000
*       /*************************************************************/ 00755000
*       /*                                                           */ 00756000
*       /* SET FLAG IN DEFINE PARM EXTENSION LIST INDICATING @Y30LB32*/ 00757000
*       /* A RESTRICTED VOLUME IS TO BE CREATED              @Y30LB32*/ 00758000
*       /*                                                           */ 00759000
*       /*************************************************************/ 00760000
*                                                                  0424 00761000
*       DEFRSTD=ON;                 /*                       @Y30LB32*/ 00762000
*                                                                  0424 00763000
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       0424 00764000
*       /*************************************************************/ 00765000
*       /*                                                           */ 00766000
*       /* CALL ATTRIBUTE ROUTINE TO CHECK ATTRIBUTES TO BE  @Y30LB32*/ 00767000
*       /* ASSIGNED OR DEFAULTED TO FOR NEW VOLUME           @Y30LB32*/ 00768000
*       /*                                                           */ 00769000
*       /*************************************************************/ 00770000
*                                                                  0425 00771000
*       CALL ATTRBUTE;              /*                       @Y30LB32*/ 00772000
         BAL   @14,ATTRBUTE                                        0425 00773000
*     END;                          /*                       @Y30LB32*/ 00774000
*                                                                  0426 00775000
*   /*****************************************************************/ 00776000
*   /*                                                               */ 00777000
*   /* SET PARAMETERS AND CHECK ATTRIBUTES SPECIFIED TO      @Y30LB32*/ 00778000
*   /* CREATE A NEW GENERAL GROUP VOLUME                     @Y30LB32*/ 00779000
*   /*                                                               */ 00780000
*   /*****************************************************************/ 00781000
*                                                                  0427 00782000
*   ELSE                            /*                       @Y30LB32*/ 00783000
*     DO;                           /*                       @Y30LB32*/ 00784000
*                                                                  0427 00785000
         B     @RC00422                                            0427 00786000
@RF00422 DS    0H                                                  0428 00787000
*       /*************************************************************/ 00788000
*       /*                                                           */ 00789000
*       /* CALL GENPROC ROUTINE TO CHECK VOLUME ATTRIBUTES   @Y30LB32*/ 00790000
*       /* AGAINST GROUP ATTRIBUTES                          @Y30LB32*/ 00791000
*       /*                                                           */ 00792000
*       /*************************************************************/ 00793000
*                                                                  0428 00794000
*       CALL GENPROC;               /*                       @Y30LB32*/ 00795000
         BAL   @14,GENPROC                                         0428 00796000
*       RESPECIFY                                                  0429 00797000
*         RTNREG RSTD;                                             0429 00798000
*       TESTRC=RTNREG;                                             0430 00799000
         LR    TESTRC,RTNREG                                       0430 00800000
*       RESPECIFY                                                  0431 00801000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 00802000
*                                                                  0431 00803000
*       /*************************************************************/ 00804000
*       /*                                                           */ 00805000
*       /* CHECK FOR ERROR CODE FROM GENPROC ROUTINE, IF     @Y30LB32*/ 00806000
*       /* ERROR CODE RETURNED SET CONDITION CODE            @Y30LB32*/ 00807000
*       /*                                                           */ 00808000
*       /*************************************************************/ 00809000
*                                                                  0432 00810000
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/ 00811000
         LTR   TESTRC,TESTRC                                       0432 00812000
         BZ    @RF00432                                            0432 00813000
*         GRPCOND=LASTCC04;         /*                       @Y30LB32*/ 00814000
*                                                                  0433 00815000
         MVC   GRPCOND(2),@CH00042                                 0433 00816000
*       /*************************************************************/ 00817000
*       /*                                                           */ 00818000
*       /* SET FLAG TO CREATE NEW GENERAL GROUP VOLUME       @Y30LB32*/ 00819000
*       /*                                                           */ 00820000
*       /*************************************************************/ 00821000
*                                                                  0434 00822000
*       ELSE                        /*                       @Y30LB32*/ 00823000
*         DEFGENUS=ON;              /*                       @Y30LB32*/ 00824000
         B     @RC00432                                            0434 00825000
@RF00432 OI    DEFGENUS(DEFVEPTR),B'10000000'                      0434 00826000
*     END;                          /*                       @Y30LB32*/ 00827000
*                                                                  0435 00828000
@RC00432 DS    0H                                                  0436 00829000
*   /*****************************************************************/ 00830000
*   /*                                                               */ 00831000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 00832000
*   /*                                                               */ 00833000
*   /*****************************************************************/ 00834000
*                                                                  0436 00835000
*   REG14=RETADDR;                  /*                       @Y30LB32*/ 00836000
@RC00422 LR    REG14,RETADDR                                       0436 00837000
*   RETURN CODE(GRPCOND);           /*                       @Y30LB32*/ 00838000
         LH    @15,GRPCOND                                         0437 00839000
@EL00002 DS    0H                                                  0437 00840000
@EF00002 DS    0H                                                  0437 00841000
@ER00002 BR    @14                                                 0437 00842000
*   END GRPPROC;                    /*                       @Y30LB32*/ 00843000
*                                                                  0439 00844000
*/********************************************************************/ 00845000
*/*                                                          @Y30LB32*/ 00846000
*/*  PROCEDURE NAME - ATTRIBUTE                              @Y30LB32*/ 00847000
*/*                                                          @Y30LB32*/ 00848000
*/*  FUNCTION - CHECKS FOR MOUNTING ATTRIBUTES TO BE         @Y30LB32*/ 00849000
*/*             ASSIGNED TO NEW VOLUME TO BE CREATED IF      @Y30LB32*/ 00850000
*/*             ANY ATTRIBUTES ARE NOT SPECIFIED DEFAULT     @Y30LB32*/ 00851000
*/*             ATTRIBUTES ARE ASSIGNED                      @Y30LB32*/ 00852000
*/*                                                          @Y30LB32*/ 00853000
*/*  INPUT - DEFLIST,DEFINE MACRO PARM LIST                  @Y30LB32*/ 00854000
*/*          BIND, EXCL, DASD, AND RONLY KEYWORD PARAMETERS  @Y30LB32*/ 00855000
*/*          RONLYFLG FLAG TO INDICATE IF READONLY SPECIFIED @Y30LB32*/ 00856000
*/*                                                          @Y30LB32*/ 00857000
*/*  OUTPUT - DEFLIST WITH VOLUME ATTRIBUTES SPECIFIED       @Y30LB32*/ 00858000
*/*                                                          @Y30LB32*/ 00859000
*/********************************************************************/ 00860000
*                                                                  0439 00861000
*ATTRBUTE:                                                         0439 00862000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 00863000
*                                                                  0439 00864000
ATTRBUTE DS    0H                                                  0440 00865000
*   /*****************************************************************/ 00866000
*   /*                                                               */ 00867000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 00868000
*   /* TO ZERO AND SET POINTER TO DEFLIST PARM LIST          @Y30LB32*/ 00869000
*   /*                                                               */ 00870000
*   /*****************************************************************/ 00871000
*                                                                  0440 00872000
*   RETADDR1=REG14;                 /*                       @Y30LB32*/ 00873000
         ST    REG14,RETADDR1                                      0440 00874000
*   OLDERID2=NEWERID2;                                             0441 00875000
         L     @02,@PC00001                                        0441 00876000
         L     @02,GDTTR2(,@02)                                    0441 00877000
         MVC   @TS00001(95),NEWERID2(@02)                          0441 00878000
         MVC   OLDERID2(95,@02),@TS00001                           0441 00879000
*   NEWID2='CVAT';                  /*                       @Y30LB32*/ 00880000
         MVC   NEWID2(4,@02),@CC01552                              0442 00881000
*   ATTRCOND=0;                     /*                       @Y30LB32*/ 00882000
         SLR   ATTRCOND,ATTRCOND                                   0443 00883000
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/ 00884000
*                                                                  0444 00885000
         LA    @02,PARMLST                                         0444 00886000
         ST    @02,DEFLSTP                                         0444 00887000
*   /*****************************************************************/ 00888000
*   /*                                                               */ 00889000
*   /* CHECK IF BIND PARAMETER IS SPECIFIED. IF BIND IS      @Y30LB32*/ 00890000
*   /* SPECIFIED SET DEFVBIND FLAG IN DEFLIST                @Y30LB32*/ 00891000
*   /*                                                               */ 00892000
*   /*****************************************************************/ 00893000
*                                                                  0445 00894000
*   IF(ADDR(BIND))^=NULLPTR THEN    /*                       @Y30LB32*/ 00895000
         L     @15,@PC00001+4                                      0445 00896000
         L     @15,FDTPTR+48(,@15)                                 0445 00897000
         LTR   @15,@15                                             0445 00898000
         BZ    @RF00445                                            0445 00899000
*     DEFVBIND=ON;                  /*                       @Y30LB32*/ 00900000
*                                                                  0446 00901000
         OI    DEFVBIND(@02),B'00000100'                           0446 00902000
*   /*****************************************************************/ 00903000
*   /*                                                               */ 00904000
*   /* CHECK IF EXCLUSIVE PARAMETER IS SPECIFIED. IF EXCL    @Y30LB32*/ 00905000
*   /* IS SPECIFIED SET DEFVEXCL FLAG IN DEFLIST             @Y30LB32*/ 00906000
*   /*                                                               */ 00907000
*   /*****************************************************************/ 00908000
*                                                                  0447 00909000
*   IF(ADDR(EXCLU))^=NULLPTR THEN   /*                       @Y30LB32*/ 00910000
@RF00445 L     @02,@PC00001+4                                      0447 00911000
         L     @02,FDTPTR+56(,@02)                                 0447 00912000
         LTR   @02,@02                                             0447 00913000
         BZ    @RF00447                                            0447 00914000
*     DEFVEXCL=ON;                  /*                       @Y30LB32*/ 00915000
*                                                                  0448 00916000
         L     @02,DEFLSTP                                         0448 00917000
         OI    DEFVEXCL(@02),B'00010000'                           0448 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* CHECK IF DASDERASE PARAMETER IS SPECIFIED. IF DERAS   @Y30LB32*/ 00921000
*   /* IS SPECIFIED SET DEFVSEC FLAG IN DEFLIST              @Y30LB32*/ 00922000
*   /*                                                               */ 00923000
*   /*****************************************************************/ 00924000
*                                                                  0449 00925000
*   IF(ADDR(DERAS))^=NULLPTR THEN   /*                       @Y30LB32*/ 00926000
@RF00447 L     @02,@PC00001+4                                      0449 00927000
         L     @02,FDTPTR+72(,@02)                                 0449 00928000
         LTR   @02,@02                                             0449 00929000
         BZ    @RF00449                                            0449 00930000
*     DEFVSEC=ON;                   /*                       @Y30LB32*/ 00931000
*                                                                  0450 00932000
         L     @02,DEFLSTP                                         0450 00933000
         OI    DEFVSEC(@02),B'00100000'                            0450 00934000
*   /*****************************************************************/ 00935000
*   /*                                                               */ 00936000
*   /* CHECK IF READONLY PARAMETER IS SPECIFIED. IF RONLY    @Y30LB32*/ 00937000
*   /* IS SPECIFIED SET RONLYFLG INDICATING READONLY         @Y30LB32*/ 00938000
*   /* PARAMETER WAS SPECIFIED                               @Y30LB32*/ 00939000
*   /*                                                               */ 00940000
*   /*****************************************************************/ 00941000
*                                                                  0451 00942000
*   IF(ADDR(RONLY))^=NULLPTR THEN   /*                       @Y30LB32*/ 00943000
@RF00449 L     @02,@PC00001+4                                      0451 00944000
         L     @02,FDTPTR+64(,@02)                                 0451 00945000
         LTR   @02,@02                                             0451 00946000
         BZ    @RF00451                                            0451 00947000
*     RONLYFLG=ON;                  /*                       @Y30LB32*/ 00948000
*                                                                  0452 00949000
         OI    RONLYFLG,B'01000000'                                0452 00950000
*   /*****************************************************************/ 00951000
*   /*                                                               */ 00952000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 00953000
*   /*                                                               */ 00954000
*   /*****************************************************************/ 00955000
*                                                                  0453 00956000
*   REG14=RETADDR1;                 /*                       @Y30LB32*/ 00957000
@RF00451 L     REG14,RETADDR1                                      0453 00958000
*   RETURN CODE(ATTRCOND);          /*                       @Y30LB32*/ 00959000
         LR    @15,ATTRCOND                                        0454 00960000
@EL00003 DS    0H                                                  0454 00961000
@EF00003 DS    0H                                                  0454 00962000
@ER00003 BR    @14                                                 0454 00963000
*   END ATTRBUTE;                   /*                       @Y30LB32*/ 00964000
*                                                                  0456 00965000
*/********************************************************************/ 00966000
*/*                                                          @Y30LB32*/ 00967000
*/*  PROCEDURE NAME - GENPROC                                @Y30LB32*/ 00968000
*/*                                                          @Y30LB32*/ 00969000
*/*  FUNCTION - ACCESSES GROUP RECORD, COMPARES SPECIFIED    @Y30LB32*/ 00970000
*/*             VOLUME ATTRIBUTES WITH GROUP ATTRIBUTES IF   @Y30LB32*/ 00971000
*/*             SPECIFIED, IF VOLUME ATTRIBUTES NOT          @Y30LB32*/ 00972000
*/*             SPECIFIED SETS ATTRIBUTES TO MATCH GROUP     @Y30LB32*/ 00973000
*/*             ATTRIBUTES. ISSUES MESSAGE IDC2079I IF GROUP @Y30LB32*/ 00974000
*/*             RECORD COULD NOT BE READ. ISSUES MESSAGE     @Y30LB32*/ 00975000
*/*             IDC3072I IF MOUNTING ATTRIBUTES DO NOT MATCH @Y30LB32*/ 00976000
*/*                                                          @Y30LB32*/ 00977000
*/*  INPUT - PARM LIST RVVI FOR MSVC READ MACRO              @Y30LB32*/ 00978000
*/*          BIND, NBIND, EXCL, SHRD, DERAS, NDERAS, RONLY   @Y30LB32*/ 00979000
*/*          AND RW KEYWORD PARAMETERS                       @Y30LB32*/ 00980000
*/*          RONLYFLG INDICATING RONLY ATTRIBUTE SPECIFIED   @Y30LB32*/ 00981000
*/*                                                          @Y30LB32*/ 00982000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 00983000
*/*             RETURN CODE = 0 - ALL ATTRIBUTES VALID       @Y30LB32*/ 00984000
*/*             RETURN CODE = 4 - SPECIFIED ATTRIBUTES DO    @Y30LB32*/ 00985000
*/*                 NOT MATCH GROUP ATTRIBUTES               @Y30LB32*/ 00986000
*/*                               OR RECORD NOT READ         @Y30LB32*/ 00987000
*/*             RONLYFLG INDICATING VOLUME IS TO BE READONLY @Y30LB32*/ 00988000
*/*                                                          @Y30LB32*/ 00989000
*/********************************************************************/ 00990000
*                                                                  0456 00991000
*GENPROC:                                                          0456 00992000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 00993000
*                                                                  0456 00994000
GENPROC  DS    0H                                                  0457 00995000
*   /*****************************************************************/ 00996000
*   /*                                                               */ 00997000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 00998000
*   /* TO ZERO AND SET PTR TO DEFLIST                        @Y30LB32*/ 00999000
*   /*                                                               */ 01000000
*   /*****************************************************************/ 01001000
*                                                                  0457 01002000
*   RETADDR1=REG14;                 /*                       @Y30LB32*/ 01003000
         ST    REG14,RETADDR1                                      0457 01004000
*   OLDERID2=NEWERID2;                                             0458 01005000
         L     @15,@PC00001                                        0458 01006000
         L     @14,GDTTR2(,@15)                                    0458 01007000
         MVC   @TS00001(95),NEWERID2(@14)                          0458 01008000
         MVC   OLDERID2(95,@14),@TS00001                           0458 01009000
*   NEWID2='DVGN';                  /*                       @Y30LB32*/ 01010000
         MVC   NEWID2(4,@14),@CC01556                              0459 01011000
*   GENCOND=0;                      /*                       @Y30LB32*/ 01012000
         SLR   GENCOND,GENCOND                                     0460 01013000
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/ 01014000
*                                                                  0461 01015000
         LA    @14,PARMLST                                         0461 01016000
         ST    @14,DEFLSTP                                         0461 01017000
*   /*****************************************************************/ 01018000
*   /*                                                               */ 01019000
*   /* INITIALIZE RVVI PARM LIST WITH GROUP NAME, SET FLAGS  @Y30LB32*/ 01020000
*   /* TO READ A GROUP RECORD AND ZERO BUFFER AREA RECORD IS @Y30LB32*/ 01021000
*   /* RETURNED IN. ALSO SET RVVI WITH LENGTH OF BUFFER      @Y30LB32*/ 01022000
*   /* AND INITIALIZE BUFFER AREA TO ZEROES                  @Y30LB32*/ 01023000
*   /*                                                               */ 01024000
*   /*****************************************************************/ 01025000
*                                                                  0462 01026000
*   RVVGROUP=GRPVAL;                /*                       @Y30LB32*/ 01027000
         L     @14,RVVIPTR                                         0462 01028000
         L     @03,@PC00001+4                                      0462 01029000
         L     @01,FDTPTR+36(,@03)                                 0462 01030000
         MVC   RVVGROUP(8,@14),GRPVAL(@01)                         0462 01031000
*   RVVSGRP=ON;                     /*                       @Y30LB32*/ 01032000
         OI    RVVSGRP(@14),B'10000000'                            0463 01033000
*   RVVRDR=ON;                      /*                       @Y30LB32*/ 01034000
         OI    RVVRDR(@14),B'10000000'                             0464 01035000
*   RVVGRPRC=ON;                    /*                       @Y30LB32*/ 01036000
         OI    RVVGRPRC(@14),B'01000000'                           0465 01037000
*   RVVBUFLN=LENGTH(BUFFER);        /*                       @Y30LB32*/ 01038000
         MVC   RVVBUFLN(2,@14),@CH01675                            0466 01039000
*   RVVRTBUF=ADDR(BUFFER);          /*                       @Y30LB32*/ 01040000
         LA    @03,BUFFER                                          0467 01041000
         ST    @03,RVVRTBUF(,@14)                                  0467 01042000
*   BUFFER=''B;                     /*                       @Y30LB32*/ 01043000
*                                                                  0468 01044000
         XC    BUFFER(164),BUFFER                                  0468 01045000
*   /*****************************************************************/ 01046000
*   /*                                                               */ 01047000
*   /* A USSC UMACRO IS ISSUED TO ACCESS THE GROUP RECORD    @Y30LB32*/ 01048000
*   /*                                                               */ 01049000
*   /*****************************************************************/ 01050000
*                                                                  0469 01051000
*   IF GDTDBG=NULLPTR THEN                                         0469 01052000
         L     @15,GDTDBG(,@15)                                    0469 01053000
         LTR   @15,@15                                             0469 01054000
         BZ    @RT00469                                            0469 01055000
*     ;                                                            0470 01056000
*   ELSE                                                           0471 01057000
*     DO;                                                          0471 01058000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/ 01059000
         LA    DMPINDEX,DUMPAREA                                   0472 01060000
*       DMPITMNM='RVVI';                                           0473 01061000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0473 01062000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0473 01063000
         MVC   DMPITMNM(4,DMPINDEX),@CC01557                       0473 01064000
*       DMPITMPT=ADDR(RVVI);                                       0474 01065000
         L     @03,RVVIPTR                                         0474 01066000
         ST    @03,DMPITMPT(,DMPINDEX)                             0474 01067000
*       DMPITMLN=LENGTH(RVVI);                                     0475 01068000
         MVC   DMPITMLN(2,DMPINDEX),@CH01676                       0475 01069000
*       DMPITMTP='H';                                              0476 01070000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0476 01071000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0477 01072000
*                                                                  0477 01073000
         AL    DMPINDEX,@CF00508                                   0477 01074000
*       /*************************************************************/ 01075000
*       /*                                                           */ 01076000
*       /*                                                   @Y30LB32*/ 01077000
*       /*                                                           */ 01078000
*       /*************************************************************/ 01079000
*                                                                  0478 01080000
*       DMPTRM=DMPTRMVL;                                           0478 01081000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0478 01082000
*     END;                          /*                       @Y30LB32*/ 01083000
*   IF GDTDBG=NULLPTR THEN                                         0480 01084000
@RT00469 L     @15,@PC00001                                        0480 01085000
         L     @15,GDTDBG(,@15)                                    0480 01086000
         LTR   @15,@15                                             0480 01087000
         BZ    @RT00480                                            0480 01088000
*     ;                                                            0481 01089000
*   ELSE                                                           0482 01090000
*     CALL IDCDB010(GDTTBL,'CVBV',ADDR(DUMPAREA));/*         @Y30LB32*/ 01091000
         L     @15,@PC00001                                        0482 01092000
         ST    @15,@AL00001                                        0482 01093000
         LA    @14,@CC01559                                        0482 01094000
         ST    @14,@AL00001+4                                      0482 01095000
         LA    @14,DUMPAREA                                        0482 01096000
         ST    @14,@AFTEMPS                                        0482 01097000
         LA    @14,@AFTEMPS                                        0482 01098000
         ST    @14,@AL00001+8                                      0482 01099000
         MVI   @AL00001+8,X'80'                                    0482 01100000
         L     @15,GDTDBG(,@15)                                    0482 01101000
         LA    @01,@AL00001                                        0482 01102000
         BALR  @14,@15                                             0482 01103000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB32*/ 01104000
@RT00480 L     @02,@PC00001                                        0483 01105000
         ST    @02,@AL00001                                        0483 01106000
         LA    @15,VVIC                                            0483 01107000
         ST    @15,@AL00001+4                                      0483 01108000
         LA    @15,RVVIPTR                                         0483 01109000
         ST    @15,@AL00001+8                                      0483 01110000
         LA    @15,REASONCD                                        0483 01111000
         ST    @15,@AL00001+12                                     0483 01112000
         MVI   @AL00001+12,X'80'                                   0483 01113000
         L     @15,GDTSSC(,@02)                                    0483 01114000
         LA    @01,@AL00001                                        0483 01115000
         BALR  @14,@15                                             0483 01116000
*   RESPECIFY                                                      0484 01117000
*     RTNREG RSTD;                                                 0484 01118000
*   TESTRC=RTNREG;                                                 0485 01119000
         LR    TESTRC,RTNREG                                       0485 01120000
*   RESPECIFY                                                      0486 01121000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 01122000
*                                                                  0486 01123000
*   /*****************************************************************/ 01124000
*   /*                                                               */ 01125000
*   /* CHECK IF MSVC READ MACRO WAS SUCCESSFUL               @Y30LB32*/ 01126000
*   /*                                                               */ 01127000
*   /*****************************************************************/ 01128000
*                                                                  0487 01129000
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/ 01130000
         SLR   @02,@02                                             0487 01131000
         CR    TESTRC,@02                                          0487 01132000
         BNE   @RF00487                                            0487 01133000
*     DO;                           /*                       @Y30LB32*/ 01134000
*                                                                  0488 01135000
*       /*************************************************************/ 01136000
*       /*                                                           */ 01137000
*       /* CHECK IF BIND PARAMETER IS SPECIFIED. IF          @Y30LB32*/ 01138000
*       /* SPECIFIED SET FLAGS INDICATING BIND SPECIFIED     @Y30LB32*/ 01139000
*       /*                                                           */ 01140000
*       /*************************************************************/ 01141000
*                                                                  0489 01142000
*       IF(ADDR(BIND))^=NULLPTR THEN/*                       @Y30LB32*/ 01143000
         L     @03,@PC00001+4                                      0489 01144000
         C     @02,FDTPTR+48(,@03)                                 0489 01145000
         BE    @RF00489                                            0489 01146000
*         DO;                       /*                       @Y30LB32*/ 01147000
*           BNDNBND=ON;             /*                       @Y30LB32*/ 01148000
         OI    BNDNBND,B'00100000'                                 0491 01149000
*           DEFVBIND=ON;            /*                       @Y30LB32*/ 01150000
         L     @01,DEFLSTP                                         0492 01151000
         OI    DEFVBIND(@01),B'00000100'                           0492 01152000
*         END;                      /*                       @Y30LB32*/ 01153000
*                                                                  0493 01154000
*       /*************************************************************/ 01155000
*       /*                                                           */ 01156000
*       /* CHECK IF NOBIND PARAMETER WAS SPECIFIED. IF       @Y30LB32*/ 01157000
*       /* SPECIFIED SET FLAG INDICATING NOBIND SPECIFIED    @Y30LB32*/ 01158000
*       /*                                                           */ 01159000
*       /*************************************************************/ 01160000
*                                                                  0494 01161000
*       ELSE                        /*                       @Y30LB32*/ 01162000
*         IF(ADDR(NBIND))^=NULLPTR THEN/*                    @Y30LB32*/ 01163000
         B     @RC00489                                            0494 01164000
@RF00489 L     @15,@PC00001+4                                      0494 01165000
         L     @15,FDTPTR+52(,@15)                                 0494 01166000
         LTR   @15,@15                                             0494 01167000
         BZ    @RF00494                                            0494 01168000
*           BNDNBND=ON;             /*                       @Y30LB32*/ 01169000
*                                                                  0495 01170000
         OI    BNDNBND,B'00100000'                                 0495 01171000
*       /*************************************************************/ 01172000
*       /*                                                           */ 01173000
*       /* SET VOLUME ATTRIBUTE TO MATCH GROUP ATTRIBUTE     @Y30LB32*/ 01174000
*       /*                                                           */ 01175000
*       /*************************************************************/ 01176000
*                                                                  0496 01177000
*         ELSE                      /*                       @Y30LB32*/ 01178000
*           IF GROBIND=ON THEN      /*                       @Y30LB32*/ 01179000
         B     @RC00494                                            0496 01180000
@RF00494 TM    GROBIND(GROUPPTR),B'10000000'                       0496 01181000
         BNO   @RF00496                                            0496 01182000
*             DEFVBIND=ON;          /*                       @Y30LB32*/ 01183000
*                                                                  0497 01184000
         L     @01,DEFLSTP                                         0497 01185000
         OI    DEFVBIND(@01),B'00000100'                           0497 01186000
*       /*************************************************************/ 01187000
*       /*                                                           */ 01188000
*       /* CHECK IF BIND OR NOBIND PARAMETER WAS SPECIFIED   @Y30LB32*/ 01189000
*       /* IF EITHER WAS SPECIFIED COMPARE ATTRIBUTE WITH    @Y30LB32*/ 01190000
*       /* GROUP ATTRIBUTE. IF MISMATCH SET CONDITION CODE   @Y30LB32*/ 01191000
*       /*                                                           */ 01192000
*       /*************************************************************/ 01193000
*                                                                  0498 01194000
*       IF BNDNBND=ON THEN          /*                       @Y30LB32*/ 01195000
@RF00496 DS    0H                                                  0498 01196000
@RC00494 DS    0H                                                  0498 01197000
@RC00489 TM    BNDNBND,B'00100000'                                 0498 01198000
         BNO   @RF00498                                            0498 01199000
*         IF DEFVBIND=ON&GROBIND=OFF THEN/*                  @Y30LB32*/ 01200000
         L     @01,DEFLSTP                                         0499 01201000
         TM    DEFVBIND(@01),B'00000100'                           0499 01202000
         BNO   @RF00499                                            0499 01203000
         TM    GROBIND(GROUPPTR),B'10000000'                       0499 01204000
         BNZ   @RF00499                                            0499 01205000
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/ 01206000
         LA    GENCOND,4                                           0500 01207000
*         ELSE                      /*                       @Y30LB32*/ 01208000
*           IF DEFVBIND=OFF&GROBIND=ON THEN/*                @Y30LB32*/ 01209000
         B     @RC00499                                            0501 01210000
@RF00499 L     @01,DEFLSTP                                         0501 01211000
         TM    DEFVBIND(@01),B'00000100'                           0501 01212000
         BNZ   @RF00501                                            0501 01213000
         TM    GROBIND(GROUPPTR),B'10000000'                       0501 01214000
         BNO   @RF00501                                            0501 01215000
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/ 01216000
*                                                                  0502 01217000
         LA    GENCOND,4                                           0502 01218000
*       /*************************************************************/ 01219000
*       /*                                                           */ 01220000
*       /* CHECK IF EXCLUSIVE PARAMETER IS SPECIFIED. IF     @Y30LB32*/ 01221000
*       /* SPECIFIED SET FLAGS INDICATING EXCL SPECIFIED     @Y30LB32*/ 01222000
*       /*                                                           */ 01223000
*       /*************************************************************/ 01224000
*                                                                  0503 01225000
*       IF(ADDR(EXCLU))^=NULLPTR THEN/*                      @Y30LB32*/ 01226000
@RF00501 DS    0H                                                  0503 01227000
@RC00499 DS    0H                                                  0503 01228000
@RF00498 L     @15,@PC00001+4                                      0503 01229000
         L     @15,FDTPTR+56(,@15)                                 0503 01230000
         LTR   @15,@15                                             0503 01231000
         BZ    @RF00503                                            0503 01232000
*         DO;                       /*                       @Y30LB32*/ 01233000
*           EXCLSHRD=ON;            /*                       @Y30LB32*/ 01234000
         OI    EXCLSHRD,B'00010000'                                0505 01235000
*           DEFVEXCL=ON;            /*                       @Y30LB32*/ 01236000
         L     @01,DEFLSTP                                         0506 01237000
         OI    DEFVEXCL(@01),B'00010000'                           0506 01238000
*         END;                      /*                       @Y30LB32*/ 01239000
*                                                                  0507 01240000
*       /*************************************************************/ 01241000
*       /*                                                           */ 01242000
*       /* CHECK IF SHARED PARAMETER WAS SPECIFIED. IF       @Y30LB32*/ 01243000
*       /* SPECIFIED SET FLAG INDICATING SHARED SPECIFIED    @Y30LB32*/ 01244000
*       /*                                                           */ 01245000
*       /*************************************************************/ 01246000
*                                                                  0508 01247000
*       ELSE                        /*                       @Y30LB32*/ 01248000
*         IF(ADDR(SHRD))^=NULLPTR THEN/*                     @Y30LB32*/ 01249000
         B     @RC00503                                            0508 01250000
@RF00503 L     @15,@PC00001+4                                      0508 01251000
         L     @15,FDTPTR+60(,@15)                                 0508 01252000
         LTR   @15,@15                                             0508 01253000
         BZ    @RF00508                                            0508 01254000
*           EXCLSHRD=ON;            /*                       @Y30LB32*/ 01255000
*                                                                  0509 01256000
         OI    EXCLSHRD,B'00010000'                                0509 01257000
*       /*************************************************************/ 01258000
*       /*                                                           */ 01259000
*       /* SET VOLUME ATTRIBUTE TO MATCH GROUP ATTRIBUTE     @Y30LB32*/ 01260000
*       /*                                                           */ 01261000
*       /*************************************************************/ 01262000
*                                                                  0510 01263000
*         ELSE                      /*                       @Y30LB32*/ 01264000
*           IF GROEXCL=ON THEN      /*                       @Y30LB32*/ 01265000
         B     @RC00508                                            0510 01266000
@RF00508 TM    GROEXCL(GROUPPTR),B'01000000'                       0510 01267000
         BNO   @RF00510                                            0510 01268000
*             DEFVEXCL=ON;          /*                       @Y30LB32*/ 01269000
*                                                                  0511 01270000
         L     @01,DEFLSTP                                         0511 01271000
         OI    DEFVEXCL(@01),B'00010000'                           0511 01272000
*       /*************************************************************/ 01273000
*       /*                                                           */ 01274000
*       /* CHECK IF EXCLUSIVE OR SHARED PARAMETER WAS        @Y30LB32*/ 01275000
*       /* SPECIFIED IF EITHER WAS SPECIFIED, COMPARE        @Y30LB32*/ 01276000
*       /* ATTRIBUTE WITH GROUP ATTRIBUTE. IF MISMATCH, SET  @Y30LB32*/ 01277000
*       /* CONDITION CODE                                    @Y30LB32*/ 01278000
*       /*                                                           */ 01279000
*       /*************************************************************/ 01280000
*                                                                  0512 01281000
*       IF EXCLSHRD=ON THEN         /*                       @Y30LB32*/ 01282000
@RF00510 DS    0H                                                  0512 01283000
@RC00508 DS    0H                                                  0512 01284000
@RC00503 TM    EXCLSHRD,B'00010000'                                0512 01285000
         BNO   @RF00512                                            0512 01286000
*         IF DEFVEXCL=ON&GROEXCL=OFF THEN/*                  @Y30LB32*/ 01287000
         L     @01,DEFLSTP                                         0513 01288000
         TM    DEFVEXCL(@01),B'00010000'                           0513 01289000
         BNO   @RF00513                                            0513 01290000
         TM    GROEXCL(GROUPPTR),B'01000000'                       0513 01291000
         BNZ   @RF00513                                            0513 01292000
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/ 01293000
         LA    GENCOND,4                                           0514 01294000
*         ELSE                      /*                       @Y30LB32*/ 01295000
*           IF DEFVEXCL=OFF&GROEXCL=ON THEN/*                @Y30LB32*/ 01296000
         B     @RC00513                                            0515 01297000
@RF00513 L     @01,DEFLSTP                                         0515 01298000
         TM    DEFVEXCL(@01),B'00010000'                           0515 01299000
         BNZ   @RF00515                                            0515 01300000
         TM    GROEXCL(GROUPPTR),B'01000000'                       0515 01301000
         BNO   @RF00515                                            0515 01302000
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/ 01303000
*                                                                  0516 01304000
         LA    GENCOND,4                                           0516 01305000
*       /*************************************************************/ 01306000
*       /*                                                           */ 01307000
*       /* CHECK IF DASDERASE PARAMETER IS SPECIFIED. IF     @Y30LB32*/ 01308000
*       /* SPECIFIED SET FLAGS INDICATING DERAS SPECIFIED    @Y30LB32*/ 01309000
*       /*                                                           */ 01310000
*       /*************************************************************/ 01311000
*                                                                  0517 01312000
*       IF(ADDR(DERAS))^=NULLPTR THEN/*                      @Y30LB32*/ 01313000
@RF00515 DS    0H                                                  0517 01314000
@RC00513 DS    0H                                                  0517 01315000
@RF00512 L     @15,@PC00001+4                                      0517 01316000
         L     @15,FDTPTR+72(,@15)                                 0517 01317000
         LTR   @15,@15                                             0517 01318000
         BZ    @RF00517                                            0517 01319000
*         DO;                       /*                       @Y30LB32*/ 01320000
*           DERASNDE=ON;            /*                       @Y30LB32*/ 01321000
         OI    DERASNDE,B'00001000'                                0519 01322000
*           DEFVSEC=ON;             /*                       @Y30LB32*/ 01323000
         L     @01,DEFLSTP                                         0520 01324000
         OI    DEFVSEC(@01),B'00100000'                            0520 01325000
*         END;                      /*                       @Y30LB32*/ 01326000
*                                                                  0521 01327000
*       /*************************************************************/ 01328000
*       /*                                                           */ 01329000
*       /* CHECK IF NODASDERASE PARAMETER WAS SPECIFIED. IF  @Y30LB32*/ 01330000
*       /* SPECIFIED SET FLAG INDICATING NDERAS SPECIFIED    @Y30LB32*/ 01331000
*       /*                                                           */ 01332000
*       /*************************************************************/ 01333000
*                                                                  0522 01334000
*       ELSE                        /*                       @Y30LB32*/ 01335000
*         IF(ADDR(NDERS))^=NULLPTR THEN/*                    @Y30LB32*/ 01336000
         B     @RC00517                                            0522 01337000
@RF00517 L     @15,@PC00001+4                                      0522 01338000
         L     @15,FDTPTR+76(,@15)                                 0522 01339000
         LTR   @15,@15                                             0522 01340000
         BZ    @RF00522                                            0522 01341000
*           DERASNDE=ON;            /*                       @Y30LB32*/ 01342000
*                                                                  0523 01343000
         OI    DERASNDE,B'00001000'                                0523 01344000
*       /*************************************************************/ 01345000
*       /*                                                           */ 01346000
*       /* SET VOLUME ATTRIBUTE TO MATCH GROUP ATTRIBUTE     @Y30LB32*/ 01347000
*       /*                                                           */ 01348000
*       /*************************************************************/ 01349000
*                                                                  0524 01350000
*         ELSE                      /*                       @Y30LB32*/ 01351000
*           IF GRODAERA=ON THEN     /*                       @Y30LB32*/ 01352000
         B     @RC00522                                            0524 01353000
@RF00522 TM    GRODAERA(GROUPPTR),B'00100000'                      0524 01354000
         BNO   @RF00524                                            0524 01355000
*             DEFVSEC=ON;           /*                       @Y30LB32*/ 01356000
*                                                                  0525 01357000
         L     @01,DEFLSTP                                         0525 01358000
         OI    DEFVSEC(@01),B'00100000'                            0525 01359000
*       /*************************************************************/ 01360000
*       /*                                                           */ 01361000
*       /* CHECK IF DASDERASE OR NODASDERASE PARAMETER WAS   @Y30LB32*/ 01362000
*       /* SPECIFIED, IF EITHER WAS SPECIFIED, COMPARE       @Y30LB32*/ 01363000
*       /* ATTRIBUTES WITH GROUP ATTRIBUTE. IF MISMATCH, SET @Y30LB32*/ 01364000
*       /* CONDITION CODE                                    @Y30LB32*/ 01365000
*       /*                                                           */ 01366000
*       /*************************************************************/ 01367000
*                                                                  0526 01368000
*       IF DERASNDE=ON THEN         /*                       @Y30LB32*/ 01369000
@RF00524 DS    0H                                                  0526 01370000
@RC00522 DS    0H                                                  0526 01371000
@RC00517 TM    DERASNDE,B'00001000'                                0526 01372000
         BNO   @RF00526                                            0526 01373000
*         IF DEFVSEC=ON&GRODAERA=OFF THEN/*                  @Y30LB32*/ 01374000
         L     @01,DEFLSTP                                         0527 01375000
         TM    DEFVSEC(@01),B'00100000'                            0527 01376000
         BNO   @RF00527                                            0527 01377000
         TM    GRODAERA(GROUPPTR),B'00100000'                      0527 01378000
         BNZ   @RF00527                                            0527 01379000
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/ 01380000
         LA    GENCOND,4                                           0528 01381000
*         ELSE                      /*                       @Y30LB32*/ 01382000
*           IF DEFVSEC=OFF&GRODAERA=ON THEN/*                @Y30LB32*/ 01383000
         B     @RC00527                                            0529 01384000
@RF00527 L     @01,DEFLSTP                                         0529 01385000
         TM    DEFVSEC(@01),B'00100000'                            0529 01386000
         BNZ   @RF00529                                            0529 01387000
         TM    GRODAERA(GROUPPTR),B'00100000'                      0529 01388000
         BNO   @RF00529                                            0529 01389000
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/ 01390000
*                                                                  0530 01391000
         LA    GENCOND,4                                           0530 01392000
*       /*************************************************************/ 01393000
*       /*                                                           */ 01394000
*       /* CHECK IF READONLY PARAMETER WAS SPECIFIED, IF     @Y30LB32*/ 01395000
*       /* SPECIFIED SET FLAGS INDICATING RONLY SPECIFIED    @Y30LB32*/ 01396000
*       /*                                                           */ 01397000
*       /*************************************************************/ 01398000
*                                                                  0531 01399000
*       IF(ADDR(RONLY))^=NULLPTR THEN/*                      @Y30LB32*/ 01400000
@RF00529 DS    0H                                                  0531 01401000
@RC00527 DS    0H                                                  0531 01402000
@RF00526 L     @15,@PC00001+4                                      0531 01403000
         L     @15,FDTPTR+64(,@15)                                 0531 01404000
         LTR   @15,@15                                             0531 01405000
         BZ    @RF00531                                            0531 01406000
*         DO;                       /*                       @Y30LB32*/ 01407000
*           RONLYRW=ON;             /*                       @Y30LB32*/ 01408000
*           RONLYFLG=ON;            /*                       @Y30LB32*/ 01409000
         OI    RONLYRW,B'01000100'                                 0534 01410000
*         END;                      /*                       @Y30LB32*/ 01411000
*                                                                  0535 01412000
*       /*************************************************************/ 01413000
*       /*                                                           */ 01414000
*       /* CHECK IF READWRITE PARAMETER WAS SPECIFIED, IF    @Y30LB32*/ 01415000
*       /* SPECIFIED SET FLAG INDICATING RW SPECIFIED        @Y30LB32*/ 01416000
*       /*                                                           */ 01417000
*       /*************************************************************/ 01418000
*                                                                  0536 01419000
*       ELSE                        /*                       @Y30LB32*/ 01420000
*         IF(ADDR(RW))^=NULLPTR THEN/*                       @Y30LB32*/ 01421000
         B     @RC00531                                            0536 01422000
@RF00531 L     @15,@PC00001+4                                      0536 01423000
         L     @15,FDTPTR+68(,@15)                                 0536 01424000
         LTR   @15,@15                                             0536 01425000
         BZ    @RF00536                                            0536 01426000
*           RONLYRW=ON;             /*                       @Y30LB32*/ 01427000
*                                                                  0537 01428000
         OI    RONLYRW,B'00000100'                                 0537 01429000
*       /*************************************************************/ 01430000
*       /*                                                           */ 01431000
*       /* SET RONLYFLG TO MATCH GROUP ATTRIBUTE             @Y30LB32*/ 01432000
*       /*                                                           */ 01433000
*       /*************************************************************/ 01434000
*                                                                  0538 01435000
*         ELSE                      /*                       @Y30LB32*/ 01436000
*           IF GRORONLY=ON THEN     /*                       @Y30LB32*/ 01437000
         B     @RC00536                                            0538 01438000
@RF00536 TM    GRORONLY(GROUPPTR),B'00010000'                      0538 01439000
         BNO   @RF00538                                            0538 01440000
*             RONLYFLG=ON;          /*                       @Y30LB32*/ 01441000
*                                                                  0539 01442000
         OI    RONLYFLG,B'01000000'                                0539 01443000
*       /*************************************************************/ 01444000
*       /*                                                           */ 01445000
*       /* CHECK IF READONLY OR READWRITE PARAMETER WAS      @Y30LB32*/ 01446000
*       /* SPECIFIED, IF EITHER WAS SPECIFIED, COMPARE       @Y30LB32*/ 01447000
*       /* ATTRIBUTES WITH GROUP ATTRIBUTE. IF ATTRIBUTES    @Y30LB32*/ 01448000
*       /* DO NOT MATCH SET CONDITION CODE                   @Y30LB32*/ 01449000
*       /*                                                           */ 01450000
*       /*************************************************************/ 01451000
*                                                                  0540 01452000
*       IF RONLYRW=ON THEN          /*                       @Y30LB32*/ 01453000
@RF00538 DS    0H                                                  0540 01454000
@RC00536 DS    0H                                                  0540 01455000
@RC00531 TM    RONLYRW,B'00000100'                                 0540 01456000
         BNO   @RF00540                                            0540 01457000
*         IF RONLYFLG=ON&GRORONLY=OFF THEN/*                 @Y30LB32*/ 01458000
         TM    RONLYFLG,B'01000000'                                0541 01459000
         BNO   @RF00541                                            0541 01460000
         TM    GRORONLY(GROUPPTR),B'00010000'                      0541 01461000
         BNZ   @RF00541                                            0541 01462000
*           GENCOND=LASTCC04;       /*                       @Y30LB32*/ 01463000
         LA    GENCOND,4                                           0542 01464000
*         ELSE                      /*                       @Y30LB32*/ 01465000
*           IF RONLYFLG=OFF&GRORONLY=ON THEN/*               @Y30LB32*/ 01466000
         B     @RC00541                                            0543 01467000
@RF00541 TM    RONLYFLG,B'01000000'                                0543 01468000
         BNZ   @RF00543                                            0543 01469000
         TM    GRORONLY(GROUPPTR),B'00010000'                      0543 01470000
         BNO   @RF00543                                            0543 01471000
*             GENCOND=LASTCC04;     /*                       @Y30LB32*/ 01472000
*                                                                  0544 01473000
         LA    GENCOND,4                                           0544 01474000
*       /*************************************************************/ 01475000
*       /*                                                           */ 01476000
*       /* CHECK CONDITION CODE IF IT IS FOUR MESSAGE        @Y30LB32*/ 01477000
*       /* IDC3072I IS ISSUED                                @Y30LB32*/ 01478000
*       /*                                                           */ 01479000
*       /*************************************************************/ 01480000
*                                                                  0545 01481000
*       IF GENCOND=4 THEN           /*                       @Y30LB32*/ 01482000
@RF00543 DS    0H                                                  0545 01483000
@RC00541 DS    0H                                                  0545 01484000
@RF00540 C     GENCOND,@CF00042                                    0545 01485000
         BNE   @RF00545                                            0545 01486000
*         DO;                       /*                       @Y30LB32*/ 01487000
*           PRINTTAB=''B;           /*                       @Y30LB32*/ 01488000
         XC    PRINTTAB(36),PRINTTAB                               0547 01489000
*           DARGSMOD=COMMSG;        /*                       @Y30LB32*/ 01490000
         L     @04,DDSTRU                                          0548 01491000
         MVC   DARGSMOD(3,@04),@CC01460                            0548 01492000
*           DARGSENT=MSG3072I;      /*                       @Y30LB32*/ 01493000
         MVI   DARGSENT(@04),X'22'                                 0549 01494000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB32*/ 01495000
         L     @04,@PC00001                                        0550 01496000
         ST    @04,@AL00001                                        0550 01497000
         LA    @15,@CF00116                                        0550 01498000
         ST    @15,@AL00001+4                                      0550 01499000
         LA    @15,DDSTRU                                          0550 01500000
         ST    @15,@AL00001+8                                      0550 01501000
         MVI   @AL00001+8,X'80'                                    0550 01502000
         L     @15,GDTPRT(,@04)                                    0550 01503000
         LA    @01,@AL00001                                        0550 01504000
         BALR  @14,@15                                             0550 01505000
*         END;                      /*                       @Y30LB32*/ 01506000
*     END;                          /*                       @Y30LB32*/ 01507000
*                                                                  0553 01508000
*   /*****************************************************************/ 01509000
*   /*                                                               */ 01510000
*   /* READ FAILED - CALL SSCMSG ROUTINE TO WRITE MESSAGE    @Y30LB32*/ 01511000
*   /* EXPLAINING REASON FOR FAILURE                         @Y30LB32*/ 01512000
*   /*                                                               */ 01513000
*   /*****************************************************************/ 01514000
*                                                                  0553 01515000
*   ELSE                            /*                       @Y30LB32*/ 01516000
*     DO;                           /*                       @Y30LB32*/ 01517000
         B     @RC00487                                            0553 01518000
@RF00487 DS    0H                                                  0554 01519000
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB32*/ 01520000
*                                                                  0554 01521000
         LA    @15,REASONCD                                        0554 01522000
         ST    @15,@AL00001                                        0554 01523000
         LA    @01,@AL00001                                        0554 01524000
         BAL   @14,SSCMSG                                          0554 01525000
*       /*************************************************************/ 01526000
*       /*                                                           */ 01527000
*       /* WRITE SECONDARY MESSAGE IDC2079I AND SET          @Y30LB32*/ 01528000
*       /* CONDITION CODE                                    @Y30LB32*/ 01529000
*       /*                                                           */ 01530000
*       /*************************************************************/ 01531000
*                                                                  0555 01532000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 01533000
         XC    PRINTTAB(36),PRINTTAB                               0555 01534000
*       DARGSMOD=COMMSG;            /*                       @Y30LB32*/ 01535000
         L     @04,DDSTRU                                          0556 01536000
         MVC   DARGSMOD(3,@04),@CC01460                            0556 01537000
*       DARGSENT=MSG2079I;          /*                       @Y30LB32*/ 01538000
         MVI   DARGSENT(@04),X'1B'                                 0557 01539000
*       DARGDBP=ADDR(GRPVAL);       /*                       @Y30LB32*/ 01540000
         L     @15,@PC00001+4                                      0558 01541000
         L     @01,FDTPTR+36(,@15)                                 0558 01542000
         LA    @15,GRPVAL(,@01)                                    0558 01543000
         ST    @15,DARGDBP(,@04)                                   0558 01544000
*       DARGILP=LENGTH(GRPVAL);     /*                       @Y30LB32*/ 01545000
         MVC   DARGILP(2,@04),@CH00181                             0559 01546000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 01547000
         L     @04,@PC00001                                        0560 01548000
         ST    @04,@AL00001                                        0560 01549000
         LA    @15,@CF00116                                        0560 01550000
         ST    @15,@AL00001+4                                      0560 01551000
         LA    @15,DDSTRU                                          0560 01552000
         ST    @15,@AL00001+8                                      0560 01553000
         MVI   @AL00001+8,X'80'                                    0560 01554000
         L     @15,GDTPRT(,@04)                                    0560 01555000
         LA    @01,@AL00001                                        0560 01556000
         BALR  @14,@15                                             0560 01557000
*       GENCOND=LASTCC04;           /*                       @Y30LB32*/ 01558000
         LA    GENCOND,4                                           0561 01559000
*     END;                          /*                       @Y30LB32*/ 01560000
*                                                                  0562 01561000
*   /*****************************************************************/ 01562000
*   /*                                                               */ 01563000
*   /* RESET RETURN ADDRESS AND RETURN TO CALLER             @Y30LB32*/ 01564000
*   /*                                                               */ 01565000
*   /*****************************************************************/ 01566000
*                                                                  0563 01567000
*   REG14=RETADDR1;                 /*                       @Y30LB32*/ 01568000
@RC00487 L     REG14,RETADDR1                                      0563 01569000
*   RETURN CODE(GENCOND);           /*                       @Y30LB32*/ 01570000
         LR    @15,GENCOND                                         0564 01571000
@EL00004 DS    0H                                                  0564 01572000
@EF00004 DS    0H                                                  0564 01573000
@ER00004 BR    @14                                                 0564 01574000
*   END GENPROC;                    /*                       @Y30LB32*/ 01575000
*                                                                  0566 01576000
*/********************************************************************/ 01577000
*/*                                                          @Y30LB32*/ 01578000
*/*  PROCEDURE NAME - CKVOLSER                               @Y30LB32*/ 01579000
*/*                                                          @Y30LB32*/ 01580000
*/*  FUNCTION - CHECK IF VOLUME SERIAL NUMBER IS VALID FOR   @Y30LB32*/ 01581000
*/*             INCREMENTING TO CREATE MORE THAN ONE VOLUME  @Y30LB32*/ 01582000
*/*             MESSAGES IDC3682I AND IDC3683I ARE ISSUED    @Y30LB32*/ 01583000
*/*             IF VOLUME SERIAL NUMBER IS NOT VALID. CALLS  @Y30LB32*/ 01584000
*/*             NUMCHK ROUTINE TO CHECK FOR NUMERIC          @Y30LB32*/ 01585000
*/*             CHARACTERS                                   @Y30LB32*/ 01586000
*/*                                                          @Y30LB32*/ 01587000
*/*  INPUT - VOLUME SERIAL NUMBER,COUNT OF VOLUMES TO CREATE @Y30LB32*/ 01588000
*/*                                                          @Y30LB32*/ 01589000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 01590000
*/*             RETURN CODE = 0 VOLUME SERIAL NUMBER VALID   @Y30LB32*/ 01591000
*/*             RETURN CODE = 4 VOLUME SERIAL NUMBER INVALID @Y30LB32*/ 01592000
*/*                                                          @Y30LB32*/ 01593000
*/********************************************************************/ 01594000
*                                                                  0566 01595000
*CKVOLSER:                                                         0566 01596000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 01597000
*                                                                  0566 01598000
CKVOLSER DS    0H                                                  0567 01599000
*   /*****************************************************************/ 01600000
*   /*                                                               */ 01601000
*   /* SAVE RETURN ADDRESS AND SET CONDITON CODE TO ZERO     @Y30LB32*/ 01602000
*   /*                                                               */ 01603000
*   /*****************************************************************/ 01604000
*                                                                  0567 01605000
*   RETADDR=REG14;                  /*                       @Y30LB32*/ 01606000
         LR    RETADDR,REG14                                       0567 01607000
*   OLDERID2=NEWERID2;                                             0568 01608000
         L     @04,@PC00001                                        0568 01609000
         L     @04,GDTTR2(,@04)                                    0568 01610000
         MVC   @TS00001(95),NEWERID2(@04)                          0568 01611000
         MVC   OLDERID2(95,@04),@TS00001                           0568 01612000
*   NEWID2='CVCK';                  /*                       @Y30LB32*/ 01613000
         MVC   NEWID2(4,@04),@CC01564                              0569 01614000
*   CKVCOND=0;                      /*                       @Y30LB32*/ 01615000
*                                                                  0570 01616000
         SLR   CKVCOND,CKVCOND                                     0570 01617000
*   /*****************************************************************/ 01618000
*   /*                                                               */ 01619000
*   /* CALL NUMCHK ROUTINE TO CHECK FOR NUMBER OF NUMERIC    @Y30LB32*/ 01620000
*   /* CHARACTERS IN VOLUME SERIAL NUMBER                    @Y30LB32*/ 01621000
*   /*                                                               */ 01622000
*   /*****************************************************************/ 01623000
*                                                                  0571 01624000
*   CALL NUMCHK;                    /*                       @Y30LB32*/ 01625000
*                                                                  0571 01626000
         BAL   @14,NUMCHK                                          0571 01627000
*   /*****************************************************************/ 01628000
*   /*                                                               */ 01629000
*   /* CHECK NUMBER OF NUMERIC CHARACTERS FOUND BY NUMCHK    @Y30LB32*/ 01630000
*   /* ROUTINE                                               @Y30LB32*/ 01631000
*   /*                                                               */ 01632000
*   /*****************************************************************/ 01633000
*                                                                  0572 01634000
*   IF NUMCNT=>1 THEN               /*                       @Y30LB32*/ 01635000
         LA    @04,1                                               0572 01636000
         CR    NUMCNT,@04                                          0572 01637000
         BL    @RF00572                                            0572 01638000
*     DO;                           /*                       @Y30LB32*/ 01639000
*                                                                  0573 01640000
*       /*************************************************************/ 01641000
*       /*                                                           */ 01642000
*       /* ZERO FIELDS USED TO CONVERT NUMERIC CHARACTERS    @Y30LB32*/ 01643000
*       /* SET VALUE FOR SUBSTRINGING TO ACCESS PROPER       @Y30LB32*/ 01644000
*       /* CHARACTERS FROM VOLUME SERIAL NUMBER THEN ACCESS  @Y30LB32*/ 01645000
*       /* CHARACTERS AND CONVERT THEM TO BINARY             @Y30LB32*/ 01646000
*       /*                                                           */ 01647000
*       /*************************************************************/ 01648000
*                                                                  0574 01649000
*       PACKEDNO=''B;               /*                       @Y30LB32*/ 01650000
         XC    PACKEDNO(6),PACKEDNO                                0574 01651000
*       NUMERICS=''B;               /*                       @Y30LB32*/ 01652000
         XC    NUMERICS(6),NUMERICS                                0575 01653000
*       CHARNUM=(6-NUMCNT)+1;       /*                       @Y30LB32*/ 01654000
         LA    @15,6                                               0576 01655000
         LR    @14,@15                                             0576 01656000
         SLR   @14,NUMCNT                                          0576 01657000
         ALR   @14,@04                                             0576 01658000
         STC   @14,CHARNUM                                         0576 01659000
*       NUMERICS(CHARNUM:6)=VOLVAL(CHARNUM:6);/*             @Y30LB32*/ 01660000
         LA    @04,NUMERICS-1(@14)                                 0577 01661000
         LR    @01,@15                                             0577 01662000
         SLR   @01,@14                                             0577 01663000
         L     @00,@PC00001+4                                      0577 01664000
         LR    @15,@00                                             0577 01665000
         L     @15,FDTPTR(,@15)                                    0577 01666000
         ALR   @14,@15                                             0577 01667000
         EX    @01,@SM01692                                        0577 01668000
*       PACK(PACKEDNO,NUMERICS);    /*                       @Y30LB32*/ 01669000
         PACK  PACKEDNO(6),NUMERICS(6)                             0578 01670000
*       CVB(BINARYNO,PACKEDNO);     /*                       @Y30LB32*/ 01671000
*                                                                  0579 01672000
         XC    @TS00001(8),@TS00001                                0579 01673000
         MVC   @TS00001+2(6),PACKEDNO                              0579 01674000
         CVB   BINARYNO,@TS00001                                   0579 01675000
*       /*************************************************************/ 01676000
*       /*                                                           */ 01677000
*       /* SAVE CONVERTED NUMBER TO CREATE VOLUME SERIAL     @Y30LB32*/ 01678000
*       /* NUMBERS WITH AND THEN                             @Y30LB32*/ 01679000
*       /* ADD CONVERTED NUMBER TO COUNT OF VOLUMES MINUS 1  @ZA28874*/ 01680000
*       /* TO BE CREATED AND CHECK IF SUM EXCEEDS MAXIMUM    @ZA28874*/ 01681000
*       /* ALLOWED FOR THE NUMBER OF NUMERIC                 @Y30LB32*/ 01682000
*       /* CHARACTERS SPECIFIED                              @Y30LB32*/ 01683000
*       /*                                                           */ 01684000
*       /*************************************************************/ 01685000
*                                                                  0580 01686000
*       SAVBINNO=BINARYNO;          /*                       @Y30LB32*/ 01687000
         ST    BINARYNO,SAVBINNO                                   0580 01688000
*       BINARYNO=BINARYNO+COUNTVAL-1;/*                      @ZA28874*/ 01689000
         LR    @04,@00                                             0581 01690000
         L     @04,FDTPTR+8(,@04)                                  0581 01691000
         LR    @14,BINARYNO                                        0581 01692000
         AL    @14,COUNTVAL(,@04)                                  0581 01693000
         BCTR  @14,0                                               0581 01694000
         LR    BINARYNO,@14                                        0581 01695000
*       IF BINARYNO>MAXNUM(NUMCNT) THEN/*                    @Y30LB32*/ 01696000
         LR    @04,NUMCNT                                          0582 01697000
         SLA   @04,2                                               0582 01698000
         C     BINARYNO,MAXNUM-4(@04)                              0582 01699000
         BNH   @RF00582                                            0582 01700000
*         DO;                       /*                       @Y30LB32*/ 01701000
*                                                                  0583 01702000
*           /*********************************************************/ 01703000
*           /*                                                       */ 01704000
*           /* CHECK IF ALL SIX CHARACTERS ARE NUMERIC       @Y30LB32*/ 01705000
*           /* IF ALL NUMERIC WRITE MESSAGE IDC3683I STATING @Y30LB32*/ 01706000
*           /* SUM OF COUNTVAL PLUS VOLSER                   @Y30LB32*/ 01707000
*           /* EXCEED MAXIMUM VALUE ALLOWED                  @Y30LB32*/ 01708000
*           /*                                                       */ 01709000
*           /*********************************************************/ 01710000
*                                                                  0584 01711000
*           IF NUMCNT=6 THEN        /*                       @Y30LB32*/ 01712000
         LA    @02,6                                               0584 01713000
         CR    NUMCNT,@02                                          0584 01714000
         BNE   @RF00584                                            0584 01715000
*             DO;                   /*                       @Y30LB32*/ 01716000
*               PRINTTAB=''B;       /*                       @Y30LB32*/ 01717000
         XC    PRINTTAB(36),PRINTTAB                               0586 01718000
*               DARGSMOD=CRVMSG;    /*                       @Y30LB32*/ 01719000
         L     @14,DDSTRU                                          0587 01720000
         MVC   DARGSMOD(3,@14),@CC01462                            0587 01721000
*               DARGSENT=MSG3683I;  /*                       @Y30LB32*/ 01722000
         MVI   DARGSENT(@14),X'04'                                 0588 01723000
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB32*/ 01724000
         LA    @15,VOLVAL(,@15)                                    0589 01725000
         ST    @15,DARGDBP(,@14)                                   0589 01726000
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB32*/ 01727000
         STH   @02,DARGILP(,@14)                                   0590 01728000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/ 01729000
         L     @15,@PC00001                                        0591 01730000
         ST    @15,@AL00001                                        0591 01731000
         LA    @14,@CF00116                                        0591 01732000
         ST    @14,@AL00001+4                                      0591 01733000
         LA    @14,DDSTRU                                          0591 01734000
         ST    @14,@AL00001+8                                      0591 01735000
         MVI   @AL00001+8,X'80'                                    0591 01736000
         L     @15,GDTPRT(,@15)                                    0591 01737000
         LA    @01,@AL00001                                        0591 01738000
         BALR  @14,@15                                             0591 01739000
*             END;                  /*                       @Y30LB32*/ 01740000
*                                                                  0592 01741000
*           /*********************************************************/ 01742000
*           /*                                                       */ 01743000
*           /* IF ALL SIX CHARACTERS ARE NOT NUMERIC THEN    @Y30LB32*/ 01744000
*           /* WRITE MESSAGE IDC3682I STATING CHARACTER      @Y30LB32*/ 01745000
*           /* NOT NUMERIC                                   @Y30LB32*/ 01746000
*           /*                                                       */ 01747000
*           /*********************************************************/ 01748000
*                                                                  0593 01749000
*           ELSE                    /*                       @Y30LB32*/ 01750000
*             DO;                   /*                       @Y30LB32*/ 01751000
         B     @RC00584                                            0593 01752000
@RF00584 DS    0H                                                  0594 01753000
*               PRINTTAB=''B;       /*                       @Y30LB32*/ 01754000
         XC    PRINTTAB(36),PRINTTAB                               0594 01755000
*               DARGSMOD=CRVMSG;    /*                       @Y30LB32*/ 01756000
         L     @15,DDSTRU                                          0595 01757000
         MVC   DARGSMOD(3,@15),@CC01462                            0595 01758000
*               DARGSENT=MSG3682I;  /*                       @Y30LB32*/ 01759000
         MVI   DARGSENT(@15),X'03'                                 0596 01760000
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB32*/ 01761000
         L     @14,@PC00001+4                                      0597 01762000
         L     @01,FDTPTR(,@14)                                    0597 01763000
         LA    @14,VOLVAL(,@01)                                    0597 01764000
         ST    @14,DARGDBP(,@15)                                   0597 01765000
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB32*/ 01766000
         MVC   DARGILP(2,@15),@CH00158                             0598 01767000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/ 01768000
         L     @15,@PC00001                                        0599 01769000
         ST    @15,@AL00001                                        0599 01770000
         LA    @14,@CF00116                                        0599 01771000
         ST    @14,@AL00001+4                                      0599 01772000
         LA    @14,DDSTRU                                          0599 01773000
         ST    @14,@AL00001+8                                      0599 01774000
         MVI   @AL00001+8,X'80'                                    0599 01775000
         L     @15,GDTPRT(,@15)                                    0599 01776000
         LA    @01,@AL00001                                        0599 01777000
         BALR  @14,@15                                             0599 01778000
*             END;                  /*                       @Y30LB32*/ 01779000
*                                                                  0600 01780000
*           /*********************************************************/ 01781000
*           /*                                                       */ 01782000
*           /* SET CONDITION CODE WITH ERROR CODE            @Y30LB32*/ 01783000
*           /*                                                       */ 01784000
*           /*********************************************************/ 01785000
*                                                                  0601 01786000
*           CKVCOND=LASTCC04;       /*                       @Y30LB32*/ 01787000
@RC00584 LA    CKVCOND,4                                           0601 01788000
*         END;                      /*                       @Y30LB32*/ 01789000
*     END;                          /*                       @Y30LB32*/ 01790000
*                                                                  0603 01791000
*   /*****************************************************************/ 01792000
*   /*                                                               */ 01793000
*   /* IF NO NUMERIC CHARACTERS WERE FOUND                   @Y30LB32*/ 01794000
*   /* WRITE MESSAGE IDC3682I STATING CHARACTER              @Y30LB32*/ 01795000
*   /* NOT NUMERIC AND SET CONDITION CODE WITH               @Y30LB32*/ 01796000
*   /* ERROR CODE                                            @Y30LB32*/ 01797000
*   /*                                                               */ 01798000
*   /*****************************************************************/ 01799000
*                                                                  0604 01800000
*   ELSE                            /*                       @Y30LB32*/ 01801000
*     DO;                           /*                       @Y30LB32*/ 01802000
         B     @RC00572                                            0604 01803000
@RF00572 DS    0H                                                  0605 01804000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 01805000
         XC    PRINTTAB(36),PRINTTAB                               0605 01806000
*       DARGSENT=MSG3682I;          /*                       @Y30LB32*/ 01807000
         L     @04,DDSTRU                                          0606 01808000
         MVI   DARGSENT(@04),X'03'                                 0606 01809000
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/ 01810000
         MVC   DARGSMOD(3,@04),@CC01462                            0607 01811000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB32*/ 01812000
         L     @15,@PC00001+4                                      0608 01813000
         L     @01,FDTPTR(,@15)                                    0608 01814000
         LA    @15,VOLVAL(,@01)                                    0608 01815000
         ST    @15,DARGDBP(,@04)                                   0608 01816000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB32*/ 01817000
         MVC   DARGILP(2,@04),@CH00158                             0609 01818000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 01819000
         L     @04,@PC00001                                        0610 01820000
         ST    @04,@AL00001                                        0610 01821000
         LA    @15,@CF00116                                        0610 01822000
         ST    @15,@AL00001+4                                      0610 01823000
         LA    @15,DDSTRU                                          0610 01824000
         ST    @15,@AL00001+8                                      0610 01825000
         MVI   @AL00001+8,X'80'                                    0610 01826000
         L     @15,GDTPRT(,@04)                                    0610 01827000
         LA    @01,@AL00001                                        0610 01828000
         BALR  @14,@15                                             0610 01829000
*       CKVCOND=LASTCC04;           /*                       @Y30LB32*/ 01830000
         LA    CKVCOND,4                                           0611 01831000
*     END;                          /*                       @Y30LB32*/ 01832000
*                                                                  0612 01833000
*   /*****************************************************************/ 01834000
*   /*                                                               */ 01835000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 01836000
*   /*                                                               */ 01837000
*   /*****************************************************************/ 01838000
*                                                                  0613 01839000
*   REG14=RETADDR;                  /*                       @Y30LB32*/ 01840000
@RC00572 LR    REG14,RETADDR                                       0613 01841000
*   RETURN CODE(CKVCOND);           /*                       @Y30LB32*/ 01842000
         LR    @15,CKVCOND                                         0614 01843000
@EL00005 DS    0H                                                  0614 01844000
@EF00005 DS    0H                                                  0614 01845000
@ER00005 BR    @14                                                 0614 01846000
*   END CKVOLSER;                   /*                       @Y30LB32*/ 01847000
*                                                                  0616 01848000
*/********************************************************************/ 01849000
*/*                                                          @Y30LB32*/ 01850000
*/*  PROCEDURE NAME - NUMCHK                                 @Y30LB32*/ 01851000
*/*                                                          @Y30LB32*/ 01852000
*/*  FUNCTION - CHECKS FOR NUMERIC CHARACTERS IN VOLUME      @Y30LB32*/ 01853000
*/*             SERIAL NUMBER WHICH ARE VALID FOR            @Y30LB32*/ 01854000
*/*             INCREMENTING TO CREATE NEW VOLUME SERIAL     @Y30LB32*/ 01855000
*/*             NUMBERS                                      @Y30LB32*/ 01856000
*/*                                                          @Y30LB32*/ 01857000
*/*  INPUT - VOLUME SERIAL NUMBER                            @Y30LB32*/ 01858000
*/*                                                          @Y30LB32*/ 01859000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 01860000
*/*             RETURN CODE = 0 - ALL SIX CHARACTERS NUMERIC @Y30LB32*/ 01861000
*/*             RETURN CODE = 4 - NONE OR SOME CHARACTERS    @Y30LB32*/ 01862000
*/*                 NUMERIC                                  @Y30LB32*/ 01863000
*/*         - NUMBER OF NUMERIC CHARACTERS                   @Y30LB32*/ 01864000
*/*                                                          @Y30LB32*/ 01865000
*/********************************************************************/ 01866000
*                                                                  0616 01867000
*NUMCHK:                                                           0616 01868000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 01869000
*                                                                  0616 01870000
NUMCHK   DS    0H                                                  0617 01871000
*   /*****************************************************************/ 01872000
*   /*                                                               */ 01873000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/ 01874000
*   /* CODE TO ZERO                                          @Y30LB32*/ 01875000
*   /*                                                               */ 01876000
*   /*****************************************************************/ 01877000
*                                                                  0617 01878000
*   RETADDR1=REG14;                 /*                       @Y30LB32*/ 01879000
         ST    REG14,RETADDR1                                      0617 01880000
*   OLDERID2=NEWERID2;                                             0618 01881000
         L     @02,@PC00001                                        0618 01882000
         L     @02,GDTTR2(,@02)                                    0618 01883000
         MVC   @TS00001(95),NEWERID2(@02)                          0618 01884000
         MVC   OLDERID2(95,@02),@TS00001                           0618 01885000
*   NEWID2='CVNC';                  /*                       @Y30LB32*/ 01886000
         MVC   NEWID2(4,@02),@CC01571                              0619 01887000
*   NUMCOND=0;                      /*                       @Y30LB32*/ 01888000
*                                                                  0620 01889000
         SLR   NUMCOND,NUMCOND                                     0620 01890000
*   /*****************************************************************/ 01891000
*   /*                                                               */ 01892000
*   /* SET COUNT OF NUMERIC CHARACTERS TO ZERO AND           @Y30LB32*/ 01893000
*   /* SET SUBSTRING VALUE TO ACCESS LAST CHARACTER OF       @Y30LB32*/ 01894000
*   /* VOLUME SERIAL NUMBER                                  @Y30LB32*/ 01895000
*   /*                                                               */ 01896000
*   /*****************************************************************/ 01897000
*                                                                  0621 01898000
*   NUMCNT=0;                       /*                       @Y30LB32*/ 01899000
         SLR   NUMCNT,NUMCNT                                       0621 01900000
*   CHARNUM=6;                      /*                       @Y30LB32*/ 01901000
*                                                                  0622 01902000
         MVI   CHARNUM,X'06'                                       0622 01903000
*   /*****************************************************************/ 01904000
*   /*                                                               */ 01905000
*   /* CHECK EACH CHARACTER IN VOLUME SERIAL NUMBER          @Y30LB32*/ 01906000
*   /* STARTING WITH HIGH ORDER BYTE FOR NUMERIC CHARACTER   @Y30LB32*/ 01907000
*   /*                                                               */ 01908000
*   /*****************************************************************/ 01909000
*                                                                  0623 01910000
*   DO VOLSERCK=1 TO 6 WHILE NUMCOND=0;/*                    @Y30LB32*/ 01911000
*                                                                  0623 01912000
         LA    VOLSERCK,1                                          0623 01913000
@DL00623 LTR   NUMCOND,NUMCOND                                     0623 01914000
         BNZ   @DC00623                                            0623 01915000
*     /***************************************************************/ 01916000
*     /*                                                             */ 01917000
*     /* ACCESS CHARACTER TO CHECK IT FOR NUMERIC            @Y30LB32*/ 01918000
*     /* CHARACTER                                           @Y30LB32*/ 01919000
*     /*                                                             */ 01920000
*     /***************************************************************/ 01921000
*                                                                  0624 01922000
*     VOLCHAR=VOLVAL(CHARNUM:CHARNUM);/*                     @Y30LB32*/ 01923000
*                                                                  0624 01924000
         SLR   @01,@01                                             0624 01925000
         IC    @01,CHARNUM                                         0624 01926000
         L     @15,@PC00001+4                                      0624 01927000
         L     @15,FDTPTR(,@15)                                    0624 01928000
         ALR   @15,@01                                             0624 01929000
         MVC   VOLCHAR(1),VOLVAL-1(@15)                            0624 01930000
*     /***************************************************************/ 01931000
*     /*                                                             */ 01932000
*     /* SET FIELD FOR NUMBER TO ZERO                        @Y30LB32*/ 01933000
*     /*                                                             */ 01934000
*     /***************************************************************/ 01935000
*                                                                  0625 01936000
*     NUMBER=0;                     /*                       @Y30LB32*/ 01937000
*                                                                  0625 01938000
         MVI   NUMBER,X'00'                                        0625 01939000
*     /***************************************************************/ 01940000
*     /*                                                             */ 01941000
*     /* CHECK CHARACTER FOR NUMERIC VALUE                   @Y30LB32*/ 01942000
*     /*                                                             */ 01943000
*     /***************************************************************/ 01944000
*                                                                  0626 01945000
*     DO LOOPCNT=1 TO 10 WHILE VOLCHAR^=NUMBER;/*            @Y30LB32*/ 01946000
         LA    @15,1                                               0626 01947000
         ST    @15,LOOPCNT                                         0626 01948000
@DL00626 CLC   VOLCHAR(1),NUMBER                                   0626 01949000
         BE    @DC00626                                            0626 01950000
*       NUMBER=NUMTBL(LOOPCNT);     /*                       @Y30LB32*/ 01951000
*                                                                  0627 01952000
         LA    @14,NUMTBL-1(@15)                                   0627 01953000
         MVC   NUMBER(1),0(@14)                                    0627 01954000
*       /*************************************************************/ 01955000
*       /*                                                           */ 01956000
*       /* CHECK IF CHARACTER NOT NUMERIC AND IF NOT         @Y30LB32*/ 01957000
*       /* NUMERIC SET CONDITION CODE WITH ERROR CODE        @Y30LB32*/ 01958000
*       /*                                                           */ 01959000
*       /*************************************************************/ 01960000
*                                                                  0628 01961000
*       IF VOLCHAR^=NUMBER&LOOPCNT=10 THEN/*                 @Y30LB32*/ 01962000
         CLC   VOLCHAR(1),NUMBER                                   0628 01963000
         BE    @RF00628                                            0628 01964000
         C     @15,@CF00478                                        0628 01965000
         BNE   @RF00628                                            0628 01966000
*         NUMCOND=LASTCC04;         /*                       @Y30LB32*/ 01967000
*                                                                  0629 01968000
         LA    NUMCOND,4                                           0629 01969000
*       /*************************************************************/ 01970000
*       /*                                                           */ 01971000
*       /* CHECK IF CHARACTER NUMERIC AND IF NUMERIC         @Y30LB32*/ 01972000
*       /* INCREMENT COUNT OF NUMERIC CHARACTERS FOUND       @Y30LB32*/ 01973000
*       /*                                                           */ 01974000
*       /*************************************************************/ 01975000
*                                                                  0630 01976000
*       ELSE                        /*                       @Y30LB32*/ 01977000
*         IF VOLCHAR=NUMBER THEN    /*                       @Y30LB32*/ 01978000
         B     @RC00628                                            0630 01979000
@RF00628 CLC   VOLCHAR(1),NUMBER                                   0630 01980000
         BNE   @RF00630                                            0630 01981000
*           NUMCNT=NUMCNT+1;        /*                       @Y30LB32*/ 01982000
         LA    NUMCNT,1(,NUMCNT)                                   0631 01983000
*     END;                          /*                       @Y30LB32*/ 01984000
*                                                                  0632 01985000
@RF00630 DS    0H                                                  0632 01986000
@RC00628 LA    @15,1                                               0632 01987000
         AL    @15,LOOPCNT                                         0632 01988000
         ST    @15,LOOPCNT                                         0632 01989000
         C     @15,@CF00478                                        0632 01990000
         BNH   @DL00626                                            0632 01991000
@DC00626 DS    0H                                                  0633 01992000
*     /***************************************************************/ 01993000
*     /*                                                             */ 01994000
*     /* RESET SUBSTRINGING VARIABLE TO ACCESS NEXT          @Y30LB32*/ 01995000
*     /* CHARACTER IN VOLUME SERIAL NUMBER                   @Y30LB32*/ 01996000
*     /*                                                             */ 01997000
*     /***************************************************************/ 01998000
*                                                                  0633 01999000
*     CHARNUM=CHARNUM-1;            /*                       @Y30LB32*/ 02000000
         SLR   @15,@15                                             0633 02001000
         IC    @15,CHARNUM                                         0633 02002000
         BCTR  @15,0                                               0633 02003000
         STC   @15,CHARNUM                                         0633 02004000
*   END;                            /*                       @Y30LB32*/ 02005000
*                                                                  0634 02006000
         AL    VOLSERCK,@CF00221                                   0634 02007000
         C     VOLSERCK,@CF00158                                   0634 02008000
         BNH   @DL00623                                            0634 02009000
@DC00623 DS    0H                                                  0635 02010000
*   /*****************************************************************/ 02011000
*   /*                                                               */ 02012000
*   /* RESTORE RETURN ADDRESS AND RETURN                     @Y30LB32*/ 02013000
*   /* TO CALLER                                             @Y30LB32*/ 02014000
*   /*                                                               */ 02015000
*   /*****************************************************************/ 02016000
*                                                                  0635 02017000
*   REG14=RETADDR1;                 /*                       @Y30LB32*/ 02018000
         L     REG14,RETADDR1                                      0635 02019000
*   RETURN CODE(NUMCOND);           /*                       @Y30LB32*/ 02020000
         LR    @15,NUMCOND                                         0636 02021000
@EL00006 DS    0H                                                  0636 02022000
@EF00006 DS    0H                                                  0636 02023000
@ER00006 BR    @14                                                 0636 02024000
*   END NUMCHK;                     /*                       @Y30LB32*/ 02025000
*                                                                  0638 02026000
*/********************************************************************/ 02027000
*/*                                                          @Y30LB32*/ 02028000
*/*  PROCEDURE NAME - ACCESS                                 @Y30LB32*/ 02029000
*/*                                                          @Y30LB32*/ 02030000
*/*  FUNCTION - ACCESSES INFORMATION FROM FDT AND            @Y30LB32*/ 02031000
*/*             INITIALIZES PARM LIST DEFLIST AND ARGUMENT   @Y30LB32*/ 02032000
*/*             LIST VS2AGL WITH THE INFORMATION             @Y30LB32*/ 02033000
*/*                                                          @Y30LB32*/ 02034000
*/*  INPUT - DEFLIST, MSF ID, VOLUME SERIAL NUMBER, VOLUME   @Y30LB32*/ 02035000
*/*          DESCRIPTION, BACKUP NUMBER, VTOC SIZE, OWNER    @Y30LB32*/ 02036000
*/*          NAME                                            @Y30LB32*/ 02037000
*/*                                                          @Y30LB32*/ 02038000
*/*  OUTPUT - DEFLIST                                        @Y30LB32*/ 02039000
*/*           CONDITION CODE - NONE                          @Y30LB32*/ 02040000
*/*                                                          @Y30LB32*/ 02041000
*/********************************************************************/ 02042000
*                                                                  0638 02043000
*ACCESS:                                                           0638 02044000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 02045000
*                                                                  0638 02046000
ACCESS   DS    0H                                                  0639 02047000
*   /*****************************************************************/ 02048000
*   /*                                                               */ 02049000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 02050000
*   /* TO ZERO                                               @Y30LB32*/ 02051000
*   /*                                                               */ 02052000
*   /*****************************************************************/ 02053000
*                                                                  0639 02054000
*   RETADDR=REG14;                  /*                       @Y30LB32*/ 02055000
         LR    RETADDR,REG14                                       0639 02056000
*   OLDERID2=NEWERID2;                                             0640 02057000
         L     @06,@PC00001                                        0640 02058000
         L     @06,GDTTR2(,@06)                                    0640 02059000
         MVC   @TS00001(95),NEWERID2(@06)                          0640 02060000
         MVC   OLDERID2(95,@06),@TS00001                           0640 02061000
*   NEWID2='CVAC';                  /*                       @Y30LB32*/ 02062000
         MVC   NEWID2(4,@06),@CC01575                              0641 02063000
*   ACCCOND=0;                      /*                       @Y30LB32*/ 02064000
*                                                                  0642 02065000
         SLR   ACCCOND,ACCCOND                                     0642 02066000
*   /*****************************************************************/ 02067000
*   /*                                                               */ 02068000
*   /* ACCESS MSF ID FROM FDT AND PLACE IN PARM LIST         @Y30LB32*/ 02069000
*   /* DEFLIST AREAS                                         @Y30LB32*/ 02070000
*   /*                                                               */ 02071000
*   /*****************************************************************/ 02072000
*                                                                  0643 02073000
*   DEFVLIB=MSFVAL;                 /*                       @Y30LB32*/ 02074000
*                                                                  0643 02075000
         L     @06,DEFLSTP                                         0643 02076000
         L     @02,@PC00001+4                                      0643 02077000
         L     @01,FDTPTR+12(,@02)                                 0643 02078000
         L     @15,MSFVAL(,@01)                                    0643 02079000
         STC   @15,DEFVLIB(,@06)                                   0643 02080000
*   /*****************************************************************/ 02081000
*   /*                                                               */ 02082000
*   /* ACCESS VOLUME DESCRIPTION AND BACKUP NUMBER FROM THE  @Y30LB32*/ 02083000
*   /* FDT AND PLACE IN DEFINE MACRO PARAMETER EXTENSION     @Y30LB32*/ 02084000
*   /* LIST DEFVE. SET FLAGS SPECIFYING FIELDS SET           @Y30LB32*/ 02085000
*   /*                                                               */ 02086000
*   /*****************************************************************/ 02087000
*                                                                  0644 02088000
*   DEFDESCR=DESCRVAL;              /*                       @Y30LB32*/ 02089000
         L     @01,FDTPTR+28(,@02)                                 0644 02090000
         MVC   DEFDESCR(30,DEFVEPTR),DESCRVAL(@01)                 0644 02091000
*   DEFPDESC=ON;                    /*                       @Y30LB32*/ 02092000
         OI    DEFPDESC(DEFVEPTR),B'00010000'                      0645 02093000
*   DEFBKUPN=BKUP#VAL;              /*                       @Y30LB32*/ 02094000
         L     @01,FDTPTR+32(,@02)                                 0646 02095000
         L     @15,BKUP#VAL(,@01)                                  0646 02096000
         STC   @15,DEFBKUPN(,DEFVEPTR)                             0646 02097000
*   DEFPBKUP=ON;                    /*                       @Y30LB32*/ 02098000
*                                                                  0647 02099000
         OI    DEFPBKUP(DEFVEPTR),B'00000100'                      0647 02100000
*   /*****************************************************************/ 02101000
*   /*                                                               */ 02102000
*   /* SET DEFVDATA TO BLANK AND SET DEFOWNID WITH OWNER     @Y30LB32*/ 02103000
*   /* NAME ACCESSED FROM FDT AND SET DEFTLAB TO T           @Y30LB32*/ 02104000
*   /*                                                               */ 02105000
*   /*****************************************************************/ 02106000
*                                                                  0648 02107000
*   DEFVDATA=BLANK;                 /*                       @Y30LB32*/ 02108000
         MVI   DEFVDATA+1(@06),C' '                                0648 02109000
         MVC   DEFVDATA+2(70,@06),DEFVDATA+1(@06)                  0648 02110000
         MVI   DEFVDATA(@06),C' '                                  0648 02111000
*   DEFOWNID=OWNERVAL;              /*                       @Y30LB32*/ 02112000
         MVI   DEFOWNID+10(@06),C' '                               0649 02113000
         MVC   DEFOWNID+11(3,@06),DEFOWNID+10(@06)                 0649 02114000
         L     @02,FDTPTR+24(,@02)                                 0649 02115000
         MVC   DEFOWNID(10,@06),OWNERVAL(@02)                      0649 02116000
*   DEFTLAB=TCHAR;                  /*                       @Y30LB32*/ 02117000
*                                                                  0650 02118000
         MVI   DEFTLAB(@06),C'T'                                   0650 02119000
*   /*****************************************************************/ 02120000
*   /*                                                               */ 02121000
*   /* CHECK IF RONLYFLG IS ON, IF ON SET WAIT FLAG IN MDAGL @Y30LB32*/ 02122000
*   /* FOR DEMOUNT TO RETURN CONTROL TO CALLER AFTER         @Y30LB32*/ 02123000
*   /* DEMOUNT IS COMPLETE                                   @Y30LB32*/ 02124000
*   /*                                                               */ 02125000
*   /*****************************************************************/ 02126000
*                                                                  0651 02127000
*   IF RONLYFLG=ON THEN             /*                       @Y30LB32*/ 02128000
         TM    RONLYFLG,B'01000000'                                0651 02129000
         BNO   @RF00651                                            0651 02130000
*     MDWAIT=ON;                    /*                       @Y30LB32*/ 02131000
*                                                                  0652 02132000
         L     @06,MDAGLPTR                                        0652 02133000
         OI    MDWAIT(@06),B'00010000'                             0652 02134000
*   /*****************************************************************/ 02135000
*   /*                                                               */ 02136000
*   /* ACCESS DDNAME TO ALLOCATE NEW VOLUME ON               @Y30LB32*/ 02137000
*   /*                                                               */ 02138000
*   /*****************************************************************/ 02139000
*                                                                  0653 02140000
*   MDDDNAME=FILEVAL;               /*                       @Y30LB32*/ 02141000
@RF00651 L     @06,MDAGLPTR                                        0653 02142000
         L     @02,@PC00001+4                                      0653 02143000
         L     @15,FDTPTR+4(,@02)                                  0653 02144000
         MVC   MDDDNAME(8,@06),FILEVAL(@15)                        0653 02145000
*   VSDDNAME=FILEVAL;               /*                       @Y30LB32*/ 02146000
*                                                                  0654 02147000
         L     @06,VSAGLPTR                                        0654 02148000
         MVC   VSDDNAME(8,@06),FILEVAL(@15)                        0654 02149000
*   /*****************************************************************/ 02150000
*   /*                                                               */ 02151000
*   /* ACCESS ADDRESS OF VOLUME SERIAL NUMBER, ADDRESS OF    @Y30LB32*/ 02152000
*   /* VOLUME OWNER NAME, AND ADDRESS TO ADDRESS OF IO       @Y30LB32*/ 02153000
*   /* CONTROL BLOCK                                         @Y30LB32*/ 02154000
*   /*                                                               */ 02155000
*   /*****************************************************************/ 02156000
*                                                                  0655 02157000
*   VSVOLPTR=ADDR(VOLSER);          /*                       @Y30LB32*/ 02158000
         LA    @15,VOLSER                                          0655 02159000
         ST    @15,VSVOLPTR(,@06)                                  0655 02160000
*   VSOWNPTR=ADDR(OWNERVAL);        /*                       @Y30LB32*/ 02161000
         L     @01,FDTPTR+24(,@02)                                 0656 02162000
         LA    @15,OWNERVAL(,@01)                                  0656 02163000
         ST    @15,VSOWNPTR(,@06)                                  0656 02164000
*   VSIOBKPT=ADDR(IOCTLBKP);        /*                       @Y30LB32*/ 02165000
*                                                                  0657 02166000
         LA    @15,IOCTLBKP                                        0657 02167000
         ST    @15,VSIOBKPT(,@06)                                  0657 02168000
*   /*****************************************************************/ 02169000
*   /*                                                               */ 02170000
*   /* ACCESS THE NUMBER OF TRACKS THE VTOC IS TO OCCUPY     @Y30LB32*/ 02171000
*   /* FROM THE FDT AND PALCE IN ARGUMENT LIST VS2AGL        @Y30LB32*/ 02172000
*   /* SET BIT REQUESTING RESERVE TO BE PERFORMED            @Y30LB32*/ 02173000
*   /*                                                               */ 02174000
*   /*****************************************************************/ 02175000
*                                                                  0658 02176000
*   VSVTOCSZ=VTSZVAL;               /*                       @Y30LB32*/ 02177000
*                                                                  0658 02178000
         L     @02,FDTPTR+16(,@02)                                 0658 02179000
         L     @02,VTSZVAL(,@02)                                   0658 02180000
         ST    @02,VSVTOCSZ(,@06)                                  0658 02181000
*   /*****************************************************************/ 02182000
*   /*                                                               */ 02183000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 02184000
*   /*                                                               */ 02185000
*   /*****************************************************************/ 02186000
*                                                                  0659 02187000
*   REG14=RETADDR;                  /*                       @Y30LB32*/ 02188000
         LR    REG14,RETADDR                                       0659 02189000
*   RETURN CODE(ACCCOND);           /*                       @Y30LB32*/ 02190000
         LR    @15,ACCCOND                                         0660 02191000
@EL00007 DS    0H                                                  0660 02192000
@EF00007 DS    0H                                                  0660 02193000
@ER00007 BR    @14                                                 0660 02194000
*   END ACCESS;                     /*                       @Y30LB32*/ 02195000
*                                                                  0662 02196000
*/********************************************************************/ 02197000
*/*                                                          @Y30LB32*/ 02198000
*/*  PROCEDURE NAME - CREATVOL                               @Y30LB32*/ 02199000
*/*                                                          @Y30LB32*/ 02200000
*/*  FUNCTION - ROUTES CONTROL TO ROUTINES WHICH CREATE,     @Y30LB32*/ 02201000
*/*             MOUNT, INITIALIZE, DEMOUNT, AND RESET        @Y30LB32*/ 02202000
*/*             READONLY MOUNTING ATTRIBUTE FLAG. WRITES     @Y30LB32*/ 02203000
*/*             MESSAGE IDC0680I IF VOLUME IS CREATED.       @Y30LB32*/ 02204000
*/*             INCREMENTS VOLUME SERIAL NUMBER IF MORE THEN @Y30LB32*/ 02205000
*/*             ONE VOLUME IS TO BE CREATED.                 @Y30LB32*/ 02206000
*/*                                                          @Y30LB32*/ 02207000
*/*  INPUT - CSN, CSN LENGTH, NUMBER OF VOLUMES              @Y30LB32*/ 02208000
*/*          TO BE CREATED                                   @Y30LB32*/ 02209000
*/*                                                          @Y30LB32*/ 02210000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 02211000
*/*            RETURN CODE = 0 - VOLUME CREATED & UPDATED    @Y30LB32*/ 02212000
*/*            RETURN CODE = 4 - ALL VOLUMES WERE NOT        @Y30LB32*/ 02213000
*/*                              CREATED                     @Y30LB32*/ 02214000
*/*            RETURN CODE = 8 - FUNCTION TERMINATED         @Y30LB32*/ 02215000
*/*                              ERROR DURING UPDATE, CART-  @ZA00067*/ 02216000
*/*                              PROC OR CREATACT            @ZA00067*/ 02217000
*/*         - ROFAIL FLAG                                    @Y30LB32*/ 02218000
*/*                                                          @Y30LB32*/ 02219000
*/********************************************************************/ 02220000
*                                                                  0662 02221000
*CREATVOL:                                                         0662 02222000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 02223000
*                                                                  0662 02224000
CREATVOL DS    0H                                                  0663 02225000
*   /*****************************************************************/ 02226000
*   /*                                                               */ 02227000
*   /* SAVE RETURN ADDRESS AND SET CONDITION CODE TO         @Y30LB32*/ 02228000
*   /* ZERO                                                  @Y30LB32*/ 02229000
*   /*                                                               */ 02230000
*   /*****************************************************************/ 02231000
*                                                                  0663 02232000
*   RETADDR1=REG14;                 /*                       @Y30LB32*/ 02233000
         ST    REG14,RETADDR1                                      0663 02234000
*   OLDERID2=NEWERID2;                                             0664 02235000
         L     @06,@PC00001                                        0664 02236000
         L     @06,GDTTR2(,@06)                                    0664 02237000
         MVC   @TS00001(95),NEWERID2(@06)                          0664 02238000
         MVC   OLDERID2(95,@06),@TS00001                           0664 02239000
*   NEWID2='CVCL';                  /*                       @Y30LB32*/ 02240000
         MVC   NEWID2(4,@06),@CC01579                              0665 02241000
*   CRVCOND=0;                      /*                       @Y30LB32*/ 02242000
*                                                                  0666 02243000
         SLR   CRVCOND,CRVCOND                                     0666 02244000
*   /*****************************************************************/ 02245000
*   /*                                                               */ 02246000
*   /* INITIALIZE FIELD USED TO COUNT NUMBER OF VOLUMES      @Y30LB32*/ 02247000
*   /* CREATED TO ZERO                                       @Y30LB32*/ 02248000
*   /*                                                               */ 02249000
*   /*****************************************************************/ 02250000
*                                                                  0667 02251000
*   VOLCRCNT=''B;                   /*                       @Y30LB32*/ 02252000
*                                                                  0667 02253000
         SLR   @06,@06                                             0667 02254000
         ST    @06,VOLCRCNT                                        0667 02255000
*   /*****************************************************************/ 02256000
*   /*                                                               */ 02257000
*   /* ACCESS VOLUME SERIAL NUMBER FROM THE FDT              @Y30LB32*/ 02258000
*   /*                                                               */ 02259000
*   /*****************************************************************/ 02260000
*                                                                  0668 02261000
*   VOLSER=VOLVAL;                  /*                       @Y30LB32*/ 02262000
*                                                                  0668 02263000
         L     @06,@PC00001+4                                      0668 02264000
         L     @06,FDTPTR(,@06)                                    0668 02265000
         MVC   VOLSER(6),VOLVAL(@06)                               0668 02266000
*   /*****************************************************************/ 02267000
*   /*                                                               */ 02268000
*   /* CREATE NEW VOLUMES UNTIL REQUESTED NUMBER ARE         @Y30LB32*/ 02269000
*   /* CREATED OR A TERMINATING ERROR OCCURS                 @Y30LB32*/ 02270000
*   /*                                                               */ 02271000
*   /*****************************************************************/ 02272000
*                                                                  0669 02273000
*   DO LOOPCNT=ONE TO COUNTVAL      /*                       @Y30LB32*/ 02274000
*         WHILE(CRVCOND<LASTCC08);  /*                       @ZA00067*/ 02275000
*                                                                  0669 02276000
         LA    @06,1                                               0669 02277000
         B     @DE00669                                            0669 02278000
@DL00669 C     CRVCOND,@CF00181                                    0669 02279000
         BNL   @DC00669                                            0669 02280000
*     /***************************************************************/ 02281000
*     /*                                                             */ 02282000
*     /* CHECK IF CART PARAMETER IS SPECIFIED. IF            @Y30LB32*/ 02283000
*     /* SPECIFIED, CHECK NUMBER OF CSN'S LISTED ADEQUATE    @Y30LB32*/ 02284000
*     /*                                                             */ 02285000
*     /***************************************************************/ 02286000
*                                                                  0670 02287000
*     IF(ADDR(CART))^=NULLPTR THEN  /*                       @Y30LB32*/ 02288000
         L     @06,@PC00001+4                                      0670 02289000
         L     @06,FDTPTR+20(,@06)                                 0670 02290000
         LTR   @06,@06                                             0670 02291000
         BZ    @RF00670                                            0670 02292000
*       IF VOLCRCNT<CARTCNT/2 THEN  /*                       @Y30LB32*/ 02293000
         LH    @00,CARTCNT(,@06)                                   0671 02294000
         SRDA  @00,32                                              0671 02295000
         D     @00,@CF00155                                        0671 02296000
         C     @01,VOLCRCNT                                        0671 02297000
         BNH   @RF00671                                            0671 02298000
*         DO;                       /*                       @Y30LB32*/ 02299000
*                                                                  0672 02300000
*           /*********************************************************/ 02301000
*           /*                                                       */ 02302000
*           /* CALL CARTPROC TO ACCESS CARTRIDGES AND        @Y30LB32*/ 02303000
*           /* CHECK CSN'S USED TO CREATE NEW VOLUME         @Y30LB32*/ 02304000
*           /*                                                       */ 02305000
*           /*********************************************************/ 02306000
*                                                                  0673 02307000
*           CALL CARTPROC;          /*                       @Y30LB32*/ 02308000
         BAL   @14,CARTPROC                                        0673 02309000
*           RESPECIFY                                              0674 02310000
*             RTNREG RSTD;                                         0674 02311000
*           TESTRC=RTNREG;                                         0675 02312000
         LR    TESTRC,RTNREG                                       0675 02313000
*           RESPECIFY                                              0676 02314000
*             RTNREG UNRSTD;        /*                       @Y30LB32*/ 02315000
*                                                                  0676 02316000
*           /*********************************************************/ 02317000
*           /*                                                       */ 02318000
*           /* CHECK IF CARTPROC ROUTINE WAS SUCCESSFUL      @Y30LB32*/ 02319000
*           /* IF NOT SUCCESSFUL SET CONDITION CODE WITH     @Y30LB32*/ 02320000
*           /* ERROR CODE                                    @Y30LB32*/ 02321000
*           /*                                                       */ 02322000
*           /*********************************************************/ 02323000
*                                                                  0677 02324000
*           IF TESTRC^=0 THEN       /*                       @Y30LB32*/ 02325000
         LTR   TESTRC,TESTRC                                       0677 02326000
         BZ    @RF00677                                            0677 02327000
*             CRVCOND=LASTCC08;     /*                       @Y30LB32*/ 02328000
         LA    CRVCOND,8                                           0678 02329000
*         END;                      /*                       @Y30LB32*/ 02330000
*                                                                  0679 02331000
*     /***************************************************************/ 02332000
*     /*                                                             */ 02333000
*     /* WRITE MESSAGE IDC2689I STATING INSUFFICIENT NUMBER  @Y30LB32*/ 02334000
*     /* OF CARTRIDGES AND SET CONDITION CODE                @Y30LB32*/ 02335000
*     /*                                                             */ 02336000
*     /***************************************************************/ 02337000
*                                                                  0680 02338000
*       ELSE                        /*                       @Y30LB32*/ 02339000
*         DO;                       /*                       @Y30LB32*/ 02340000
         B     @RC00671                                            0680 02341000
@RF00671 DS    0H                                                  0681 02342000
*           PRINTTAB=''B;           /*                       @Y30LB32*/ 02343000
         XC    PRINTTAB(36),PRINTTAB                               0681 02344000
*           DARGSMOD=CRVMSG;        /*                       @Y30LB32*/ 02345000
         L     @06,DDSTRU                                          0682 02346000
         MVC   DARGSMOD(3,@06),@CC01462                            0682 02347000
*           DARGSENT=MSG2689I;      /*                       @Y30LB32*/ 02348000
         MVI   DARGSENT(@06),X'0A'                                 0683 02349000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB32*/ 02350000
         L     @06,@PC00001                                        0684 02351000
         ST    @06,@AL00001                                        0684 02352000
         LA    @15,@CF00116                                        0684 02353000
         ST    @15,@AL00001+4                                      0684 02354000
         LA    @15,DDSTRU                                          0684 02355000
         ST    @15,@AL00001+8                                      0684 02356000
         MVI   @AL00001+8,X'80'                                    0684 02357000
         L     @15,GDTPRT(,@06)                                    0684 02358000
         LA    @01,@AL00001                                        0684 02359000
         BALR  @14,@15                                             0684 02360000
*           CRVCOND=LASTCC08;       /*                       @Y30LB32*/ 02361000
         LA    CRVCOND,8                                           0685 02362000
*         END;                      /*                       @Y30LB32*/ 02363000
*                                                                  0686 02364000
*     /***************************************************************/ 02365000
*     /*                                                             */ 02366000
*     /* CHECK CONDITION CODE TO DETERMINE IF                @Y30LB32*/ 02367000
*     /* PROCESSING SHOULD CONTINUE                          @Y30LB32*/ 02368000
*     /*                                                             */ 02369000
*     /***************************************************************/ 02370000
*                                                                  0687 02371000
*     IF CRVCOND^=LASTCC08 THEN     /*                       @Y30LB32*/ 02372000
@RC00671 DS    0H                                                  0687 02373000
@RF00670 C     CRVCOND,@CF00181                                    0687 02374000
         BE    @RF00687                                            0687 02375000
*       DO;                         /*                       @Y30LB32*/ 02376000
*                                                                  0688 02377000
*         /***********************************************************/ 02378000
*         /*                                                         */ 02379000
*         /* ISSUE UENQ MACRO TO GAIN EXCLUSIVE              @Y30LB32*/ 02380000
*         /* CONTROL OF VOLUME SERIAL NUMBER                 @Y30LB32*/ 02381000
*         /*                                                         */ 02382000
*         /***********************************************************/ 02383000
*                                                                  0689 02384000
*         TYPENAME=ENQUEUE;         /*                       @Y30LB32*/ 02385000
         MVC   TYPENAME(8),@CC01489                                0689 02386000
*         CALL IDCSANQ0(GDTTBL,EXCL,WAIT,SYSZAMS,RNAME);/*   @Y30LB32*/ 02387000
*                                                                  0690 02388000
         MVC   @AL00001+4(12),@AL00690                             0690 02389000
         L     @06,@PC00001                                        0690 02390000
         ST    @06,@AL00001                                        0690 02391000
         LA    @15,RNAME                                           0690 02392000
         ST    @15,@AL00001+16                                     0690 02393000
         MVI   @AL00001+16,X'80'                                   0690 02394000
         L     @15,GDTENQ(,@06)                                    0690 02395000
         LA    @01,@AL00001                                        0690 02396000
         BALR  @14,@15                                             0690 02397000
*         /***********************************************************/ 02398000
*         /*                                                         */ 02399000
*         /* SET DEFLIST WITH VOLUME SERIAL NUMBER           @Y30LB32*/ 02400000
*         /*                                                         */ 02401000
*         /***********************************************************/ 02402000
*                                                                  0691 02403000
*         DEFLSTP=ADDR(PARMLST2);   /*                       @Y30LB32*/ 02404000
         LA    @06,PARMLST2                                        0691 02405000
         ST    @06,DEFLSTP                                         0691 02406000
*         DEFVOLD=VOLSER;           /*                       @Y30LB32*/ 02407000
         MVC   DEFVOLD(6,@06),VOLSER                               0692 02408000
*         DEFLSTP=ADDR(PARMLST);    /*                       @Y30LB32*/ 02409000
         LA    @06,PARMLST                                         0693 02410000
         ST    @06,DEFLSTP                                         0693 02411000
*         DEFVOLD=VOLSER;           /*                       @Y30LB32*/ 02412000
*                                                                  0694 02413000
         MVC   DEFVOLD(6,@06),VOLSER                               0694 02414000
*         /***********************************************************/ 02415000
*         /*                                                         */ 02416000
*         /* CALL CREATACT ROUTINE WHICH CREATES AND         @Y30LB32*/ 02417000
*         /* ACTIVATES A NEW VOLUME                          @Y30LB32*/ 02418000
*         /*                                                         */ 02419000
*         /***********************************************************/ 02420000
*                                                                  0695 02421000
*         CALL CREATACT;            /*                       @Y30LB32*/ 02422000
         BAL   @14,CREATACT                                        0695 02423000
*         RESPECIFY                                                0696 02424000
*           RTNREG RSTD;                                           0696 02425000
*         TESTRC=RTNREG;                                           0697 02426000
         LR    TESTRC,RTNREG                                       0697 02427000
*         RESPECIFY                                                0698 02428000
*           RTNREG UNRSTD;          /*                       @Y30LB32*/ 02429000
*                                                                  0698 02430000
*         /***********************************************************/ 02431000
*         /*                                                         */ 02432000
*         /* CHECK IF CREATACT ROUTINE WAS SUCCESSFUL        @Y30LB32*/ 02433000
*         /*                                                         */ 02434000
*         /***********************************************************/ 02435000
*                                                                  0699 02436000
*         IF TESTRC=0 THEN          /*                       @Y30LB32*/ 02437000
         LTR   TESTRC,TESTRC                                       0699 02438000
         BNZ   @RF00699                                            0699 02439000
*           DO;                     /*                       @Y30LB32*/ 02440000
*                                                                  0700 02441000
*             /*******************************************************/ 02442000
*             /*                                                     */ 02443000
*             /* CALL UPDATE ROUTINE TO INITIALIZE VOLUME    @Y30LB32*/ 02444000
*             /* WITH VOLUME LABEL AND VTOC                  @Y30LB32*/ 02445000
*             /*                                                     */ 02446000
*             /*******************************************************/ 02447000
*                                                                  0701 02448000
*             CALL UPDATE;          /*                       @Y30LB32*/ 02449000
         BAL   @14,UPDATE                                          0701 02450000
*             RESPECIFY                                            0702 02451000
*               RTNREG RSTD;                                       0702 02452000
*             TESTRC=RTNREG;                                       0703 02453000
         LR    TESTRC,RTNREG                                       0703 02454000
*             RESPECIFY                                            0704 02455000
*               RTNREG UNRSTD;      /*                       @Y30LB32*/ 02456000
*                                                                  0704 02457000
*             /*******************************************************/ 02458000
*             /*                                                     */ 02459000
*             /* CHECK IF UPDATE ROUTINE WAS SUCCESSFUL      @Y30LB32*/ 02460000
*             /*                                                     */ 02461000
*             /*******************************************************/ 02462000
*                                                                  0705 02463000
*             IF TESTRC=0 THEN      /*                       @Y30LB32*/ 02464000
         LTR   TESTRC,TESTRC                                       0705 02465000
         BNZ   @RF00705                                            0705 02466000
*               IF RONLYFLG=ON THEN /*                       @Y30LB32*/ 02467000
         TM    RONLYFLG,B'01000000'                                0706 02468000
         BNO   @RF00706                                            0706 02469000
*                 DO;               /*                       @Y30LB32*/ 02470000
*                                                                  0707 02471000
*                   /*************************************************/ 02472000
*                   /*                                               */ 02473000
*                   /* CALL ROPROC ROUTINE TO SET READWRITE  @Y30LB32*/ 02474000
*                   /* VOLUME ATTRIBUTE FLAG TO READ ONLY    @Y30LB32*/ 02475000
*                   /*                                               */ 02476000
*                   /*************************************************/ 02477000
*                                                                  0708 02478000
*                   CALL ROPROC;    /*                       @Y30LB32*/ 02479000
         BAL   @14,ROPROC                                          0708 02480000
*                   RESPECIFY                                      0709 02481000
*                     RTNREG RSTD;                                 0709 02482000
*                   TESTRC=RTNREG;                                 0710 02483000
         LR    TESTRC,RTNREG                                       0710 02484000
*                   RESPECIFY                                      0711 02485000
*                     RTNREG UNRSTD;/*                       @Y30LB32*/ 02486000
*                                                                  0711 02487000
*                   /*************************************************/ 02488000
*                   /*                                               */ 02489000
*                   /* CHECK IF ROPROC ROUTINE WAS SUCCESSFUL        */ 02490000
*                   /*                                       @Y30LB32*/ 02491000
*                   /* IF NOT SUCCESSFUL SET ROFAIL FLAG     @Y30LB32*/ 02492000
*                   /*                                               */ 02493000
*                   /*************************************************/ 02494000
*                                                                  0712 02495000
*                   IF TESTRC^=0 THEN/*                      @Y30LB32*/ 02496000
         LTR   TESTRC,TESTRC                                       0712 02497000
         BZ    @RF00712                                            0712 02498000
*                     ROFAIL=ON;    /*                       @Y30LB32*/ 02499000
         OI    ROFAIL,B'00000010'                                  0713 02500000
*                 END;              /*                       @Y30LB32*/ 02501000
*               ELSE                                               0715 02502000
*                 ;                 /*                       @Y30LB32*/ 02503000
*                                                                  0715 02504000
@RF00706 DS    0H                                                  0716 02505000
*             /*******************************************************/ 02506000
*             /*                                                     */ 02507000
*             /* UPDATE ROUTINE WAS UNSUCCESSFUL             @Y30LB32*/ 02508000
*             /* PROCESS ERROR CODE                          @Y30LB32*/ 02509000
*             /*                                                     */ 02510000
*             /*******************************************************/ 02511000
*                                                                  0716 02512000
*             ELSE                  /*                       @Y30LB32*/ 02513000
*                                                                  0716 02514000
*               /*****************************************************/ 02515000
*               /*                                                   */ 02516000
*               /* IF UPDATE FAILS FOR ANY REASON, WE WANT TO        */ 02517000
*               /* TERMINATE OUR LOOP BY SETTING OUR RETURN CODE TO  */ 02518000
*               /* 8.                                        @ZA00067*/ 02519000
*               /*                                                   */ 02520000
*               /*****************************************************/ 02521000
*                                                                  0716 02522000
*               CRVCOND=LASTCC08;   /*                       @Y30LB32*/ 02523000
         B     @RC00705                                            0716 02524000
@RF00705 LA    CRVCOND,8                                           0716 02525000
*           END;                    /*                       @Y30LB32*/ 02526000
*                                                                  0717 02527000
*         /***********************************************************/ 02528000
*         /*                                                         */ 02529000
*         /* CREATACT WAS NOT SUCCESSFUL PROCESS             @Y30LB32*/ 02530000
*         /* ERROR CODE                                      @Y30LB32*/ 02531000
*         /*                                                         */ 02532000
*         /***********************************************************/ 02533000
*                                                                  0718 02534000
*         ELSE                      /*                       @Y30LB32*/ 02535000
*                                                                  0718 02536000
*           /*********************************************************/ 02537000
*           /*                                                       */ 02538000
*           /* IF CREATACT FAILS FOR ANY REASON, WE WANT TO TERMINATE*/ 02539000
*           /* OUR LOOP BY SETTING OUR RETURN CODE TO 8.     @ZA00067*/ 02540000
*           /*                                                       */ 02541000
*           /*********************************************************/ 02542000
*                                                                  0718 02543000
*           CRVCOND=LASTCC08;       /*                       @Y30LB32*/ 02544000
*                                                                  0718 02545000
         B     @RC00699                                            0718 02546000
@RF00699 LA    CRVCOND,8                                           0718 02547000
*         /***********************************************************/ 02548000
*         /*                                                         */ 02549000
*         /* ISSUE UDEQ UMACRO TO RELEASE EXCLUSIVE          @Y30LB32*/ 02550000
*         /* CONTROL OF VOLUME SERIAL NUMBER                 @Y30LB32*/ 02551000
*         /*                                                         */ 02552000
*         /***********************************************************/ 02553000
*                                                                  0719 02554000
*         TYPENAME=ENQUEUE;         /*                       @ZA05119*/ 02555000
@RC00699 MVC   TYPENAME(8),@CC01489                                0719 02556000
*         CALL IDCSADQ0(GDTTBL,SYSZAMS,RNAME);/*             @Y30LB32*/ 02557000
*                                                                  0720 02558000
         L     @06,@PC00001                                        0720 02559000
         ST    @06,@AL00001                                        0720 02560000
         LA    @15,@CC01493                                        0720 02561000
         ST    @15,@AL00001+4                                      0720 02562000
         LA    @15,RNAME                                           0720 02563000
         ST    @15,@AL00001+8                                      0720 02564000
         MVI   @AL00001+8,X'80'                                    0720 02565000
         L     @15,GDTDEQ(,@06)                                    0720 02566000
         LA    @01,@AL00001                                        0720 02567000
         BALR  @14,@15                                             0720 02568000
*         /***********************************************************/ 02569000
*         /*                                                         */ 02570000
*         /* IF VCREATED FLAG IS                             @Y30LB32*/ 02571000
*         /* SET WRITE MESSAGE IDC0680I STATING              @Y30LB32*/ 02572000
*         /* VOLUME CREATED                                  @Y30LB32*/ 02573000
*         /*                                                         */ 02574000
*         /***********************************************************/ 02575000
*                                                                  0721 02576000
*         IF VCREATED=ON THEN       /*                       @Y30LB32*/ 02577000
         TM    VCREATED,B'10000000'                                0721 02578000
         BNO   @RF00721                                            0721 02579000
*           DO;                     /*                       @Y30LB32*/ 02580000
*             PRINTTAB=''B;         /*                       @Y30LB32*/ 02581000
         XC    PRINTTAB(36),PRINTTAB                               0723 02582000
*             DARGSMOD=CRVMSG;      /*                       @Y30LB32*/ 02583000
         L     @06,DDSTRU                                          0724 02584000
         MVC   DARGSMOD(3,@06),@CC01462                            0724 02585000
*             DARGSENT=MSG0680I;    /*                       @Y30LB32*/ 02586000
         MVI   DARGSENT(@06),X'01'                                 0725 02587000
*             DARGDBP=ADDR(VOLSER); /*                       @Y30LB32*/ 02588000
         LA    @15,VOLSER                                          0726 02589000
         ST    @15,DARGDBP(,@06)                                   0726 02590000
*             DARGILP=LENGTH(VOLSER);/*                      @Y30LB32*/ 02591000
         MVC   DARGILP(2,@06),@CH00158                             0727 02592000
*             DARGCNT=2;            /*                       @Y30LB32*/ 02593000
         LA    @15,2                                               0728 02594000
         STH   @15,DARGCNT(,@06)                                   0728 02595000
*             DARGINS(1)=1;         /*                       @Y30LB32*/ 02596000
         MVC   DARGINS(2,@06),@CH00221                             0729 02597000
*             DARGINL(1)=LENGTH(SAVECSN1);/*                 @Y30LB32*/ 02598000
         LA    @14,12                                              0730 02599000
         STH   @14,DARGINL(,@06)                                   0730 02600000
*             DARGDTM(1)=ADDR(SAVECSN1);/*                   @Y30LB32*/ 02601000
         LA    @05,SAVECSN1                                        0731 02602000
         ST    @05,DARGDTM(,@06)                                   0731 02603000
*             DARGINS(2)=2;         /*                       @Y30LB32*/ 02604000
         STH   @15,DARGINS+8(,@06)                                 0732 02605000
*             DARGINL(2)=LENGTH(SAVECSN2);/*                 @Y30LB32*/ 02606000
         STH   @14,DARGINL+8(,@06)                                 0733 02607000
*             DARGDTM(2)=ADDR(SAVECSN2);/*                   @Y30LB32*/ 02608000
         LA    @15,SAVECSN2                                        0734 02609000
         ST    @15,DARGDTM+8(,@06)                                 0734 02610000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB32*/ 02611000
*                                                                  0735 02612000
         L     @06,@PC00001                                        0735 02613000
         ST    @06,@AL00001                                        0735 02614000
         LA    @15,@CF00116                                        0735 02615000
         ST    @15,@AL00001+4                                      0735 02616000
         LA    @15,DDSTRU                                          0735 02617000
         ST    @15,@AL00001+8                                      0735 02618000
         MVI   @AL00001+8,X'80'                                    0735 02619000
         L     @15,GDTPRT(,@06)                                    0735 02620000
         LA    @01,@AL00001                                        0735 02621000
         BALR  @14,@15                                             0735 02622000
*             /*******************************************************/ 02623000
*             /*                                                     */ 02624000
*             /* INCREMENT COUNT OF VOLUMES CREATED AND SET  @Y30LB32*/ 02625000
*             /* VOLUME CREATED INDICATOR FLAG               @Y30LB32*/ 02626000
*             /*                                                     */ 02627000
*             /*******************************************************/ 02628000
*                                                                  0736 02629000
*             VOLCRCNT=VOLCRCNT+1;  /*                       @Y30LB32*/ 02630000
         LA    @06,1                                               0736 02631000
         AL    @06,VOLCRCNT                                        0736 02632000
         ST    @06,VOLCRCNT                                        0736 02633000
*             CREATFLG=ON;          /*                       @Y30LB32*/ 02634000
         OI    CREATFLG,B'10000000'                                0737 02635000
*           END;                    /*                       @Y30LB32*/ 02636000
*                                                                  0738 02637000
*         /***********************************************************/ 02638000
*         /*                                                         */ 02639000
*         /* CHECK IF MORE THAN ONE VOLUME IS TO BE CREATED. @Y30LB32*/ 02640000
*         /*                                                         */ 02641000
*         /***********************************************************/ 02642000
*                                                                  0739 02643000
*         IF COUNTVAL>1&CRVCOND<8 THEN/*                     @Y30LB32*/ 02644000
@RF00721 LA    @06,1                                               0739 02645000
         L     @15,@PC00001+4                                      0739 02646000
         L     @01,FDTPTR+8(,@15)                                  0739 02647000
         C     @06,COUNTVAL(,@01)                                  0739 02648000
         BNL   @RF00739                                            0739 02649000
         C     CRVCOND,@CF00181                                    0739 02650000
         BNL   @RF00739                                            0739 02651000
*           DO;                     /*                       @Y30LB32*/ 02652000
*                                                                  0740 02653000
*             /*******************************************************/ 02654000
*             /*                                                     */ 02655000
*             /* INCREMENT VOLSER FOR NEXT VOLUME            @Y30LB32*/ 02656000
*             /*                                                     */ 02657000
*             /*******************************************************/ 02658000
*                                                                  0741 02659000
*             SAVBINNO=SAVBINNO+ONE;/*                       @Y30LB32*/ 02660000
         AL    @06,SAVBINNO                                        0741 02661000
         ST    @06,SAVBINNO                                        0741 02662000
*             CVD(SAVBINNO,PACKEDNO);/*                      @Y30LB32*/ 02663000
         CVD   @06,@TS00001                                        0742 02664000
         MVC   PACKEDNO(6),@TS00001+2                              0742 02665000
*             UNPK(NUMERICS,PACKEDNO);/*                     @Y30LB32*/ 02666000
         UNPK  NUMERICS(6),PACKEDNO(6)                             0743 02667000
*             MVZ(NUMERICS(6:6),NUMERICS);/*                 @Y30LB32*/ 02668000
         MVZ   NUMERICS+5(1),NUMERICS                              0744 02669000
*             VOLSER(CHARNUM:6)=NUMERICS(CHARNUM:6);/*       @Y30LB32*/ 02670000
*                                                                  0745 02671000
         SLR   @06,@06                                             0745 02672000
         IC    @06,CHARNUM                                         0745 02673000
         LA    @01,VOLSER-1(@06)                                   0745 02674000
         LA    @15,6                                               0745 02675000
         SLR   @15,@06                                             0745 02676000
         LA    @14,NUMERICS-1(@06)                                 0745 02677000
         EX    @15,@SM01695                                        0745 02678000
*             /*******************************************************/ 02679000
*             /*                                                     */ 02680000
*             /* RESET VCREATED FLAG TO ZERO AND BLANK FIELDS FOR    */ 02681000
*             /*                                             @Y30LB32*/ 02682000
*             /* SAVING CSNS                                 @Y30LB32*/ 02683000
*             /*                                                     */ 02684000
*             /*******************************************************/ 02685000
*                                                                  0746 02686000
*             VCREATED=OFF;         /*                       @Y30LB32*/ 02687000
         NI    VCREATED,B'01111111'                                0746 02688000
*             SAVECSN1=BLANK;       /*                       @Y30LB32*/ 02689000
         MVI   SAVECSN1+1,C' '                                     0747 02690000
         MVC   SAVECSN1+2(10),SAVECSN1+1                           0747 02691000
         MVI   SAVECSN1,C' '                                       0747 02692000
*             SAVECSN2=BLANK;       /*                       @Y30LB32*/ 02693000
         MVI   SAVECSN2+1,C' '                                     0748 02694000
         MVC   SAVECSN2+2(10),SAVECSN2+1                           0748 02695000
         MVI   SAVECSN2,C' '                                       0748 02696000
*           END;                    /*                       @Y30LB32*/ 02697000
*       END;                        /*                       @Y30LB32*/ 02698000
@RF00739 DS    0H                                                  0751 02699000
*   END;                            /*                       @Y30LB32*/ 02700000
@RF00687 LA    @06,1                                               0751 02701000
         AL    @06,LOOPCNT                                         0751 02702000
@DE00669 ST    @06,LOOPCNT                                         0751 02703000
         L     @15,@PC00001+4                                      0751 02704000
         L     @01,FDTPTR+8(,@15)                                  0751 02705000
         C     @06,COUNTVAL(,@01)                                  0751 02706000
         BNH   @DL00669                                            0751 02707000
@DC00669 DS    0H                                                  0752 02708000
*                                                                  0752 02709000
*   /*****************************************************************/ 02710000
*   /*                                                               */ 02711000
*   /* CHECK IF ALL REQUESTED VOLUMES WERE CREATED           @Y30LB32*/ 02712000
*   /* SUCCESSFULLY OR ATTEMPT MADE TO CREATE THEM           @Y30LB32*/ 02713000
*   /*                                                               */ 02714000
*   /*****************************************************************/ 02715000
*                                                                  0752 02716000
*   IF(VOLCRCNT+1)<COUNTVAL THEN    /*                       @Y30LB32*/ 02717000
         LA    @08,1                                               0752 02718000
         AL    @08,VOLCRCNT                                        0752 02719000
         L     @06,@PC00001+4                                      0752 02720000
         L     @06,FDTPTR+8(,@06)                                  0752 02721000
         C     @08,COUNTVAL(,@06)                                  0752 02722000
         BNL   @RF00752                                            0752 02723000
*     DO;                           /*                       @Y30LB32*/ 02724000
*                                                                  0753 02725000
*       /*************************************************************/ 02726000
*       /*                                                           */ 02727000
*       /* ISSUE MESSAGE IDC2685I STATING ATTEMPT            @Y30LB32*/ 02728000
*       /* NOT MADE TO CREATE ADDITIONAL VOLUMES             @Y30LB32*/ 02729000
*       /*                                                           */ 02730000
*       /*************************************************************/ 02731000
*                                                                  0754 02732000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 02733000
         XC    PRINTTAB(36),PRINTTAB                               0754 02734000
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/ 02735000
         L     @08,DDSTRU                                          0755 02736000
         MVC   DARGSMOD(3,@08),@CC01462                            0755 02737000
*       DARGSENT=MSG2685I;          /*                       @Y30LB32*/ 02738000
         MVI   DARGSENT(@08),X'06'                                 0756 02739000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 02740000
         L     @08,@PC00001                                        0757 02741000
         ST    @08,@AL00001                                        0757 02742000
         LA    @06,@CF00116                                        0757 02743000
         ST    @06,@AL00001+4                                      0757 02744000
         LA    @06,DDSTRU                                          0757 02745000
         ST    @06,@AL00001+8                                      0757 02746000
         MVI   @AL00001+8,X'80'                                    0757 02747000
         L     @15,GDTPRT(,@08)                                    0757 02748000
         LA    @01,@AL00001                                        0757 02749000
         BALR  @14,@15                                             0757 02750000
*     END;                          /*                       @Y30LB32*/ 02751000
*                                                                  0758 02752000
*   /*****************************************************************/ 02753000
*   /*                                                               */ 02754000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 02755000
*   /*                                                               */ 02756000
*   /*****************************************************************/ 02757000
*                                                                  0759 02758000
*   REG14=RETADDR1;                 /*                       @Y30LB32*/ 02759000
@RF00752 L     REG14,RETADDR1                                      0759 02760000
*   RETURN CODE(CRVCOND);           /*                       @Y30LB32*/ 02761000
         LR    @15,CRVCOND                                         0760 02762000
@EL00008 DS    0H                                                  0760 02763000
@EF00008 DS    0H                                                  0760 02764000
@ER00008 BR    @14                                                 0760 02765000
*   END CREATVOL;                   /*                       @Y30LB32*/ 02766000
*                                                                  0762 02767000
*/********************************************************************/ 02768000
*/*                                                          @Y30LB32*/ 02769000
*/*  PROCEDURE NAME - CARTPROC                               @Y30LB32*/ 02770000
*/*                                                          @Y30LB32*/ 02771000
*/*  FUNCTION - ACCESSES CSN'S AND CHECKS LENGTH OF          @Y30LB32*/ 02772000
*/*             CSN'S. CALLS SUBROUTINE CKCSNLEN WHICH       @Y30LB32*/ 02773000
*/*             ACTUALLY CHECKS LENGTH. IF CSN IS VALID      @Y30LB32*/ 02774000
*/*             PLACES IT IN PARM LIST DEFLIST               @Y30LB32*/ 02775000
*/*                                                          @Y30LB32*/ 02776000
*/*  INPUT - COUNT OF ATTEMPTS TO CREATE A VOLUME            @Y30LB32*/ 02777000
*/*         CSN'S AND LENGTH OF CSN'S                        @Y30LB32*/ 02778000
*/*                                                          @Y30LB32*/ 02779000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 02780000
*/*             RETURN CODE = 0 - CSN'S VALID                @Y30LB32*/ 02781000
*/*             RETURN CODE = 4 - CSN INVALID LENGTH         @Y30LB32*/ 02782000
*/*                                                          @Y30LB32*/ 02783000
*/********************************************************************/ 02784000
*                                                                  0762 02785000
*CARTPROC:                                                         0762 02786000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 02787000
*                                                                  0762 02788000
CARTPROC DS    0H                                                  0763 02789000
*   /*****************************************************************/ 02790000
*   /*                                                               */ 02791000
*   /* SAVE RETURN ADDRESS TO CALLER, SET CONDITION CODE     @Y30LB32*/ 02792000
*   /* TO ZERO AND RESET POINTER TO DEFLIST PARM AREA        @Y30LB32*/ 02793000
*   /*                                                               */ 02794000
*   /*****************************************************************/ 02795000
*                                                                  0763 02796000
*   RETADDR2=REG14;                 /*                       @Y30LB32*/ 02797000
         ST    REG14,RETADDR2                                      0763 02798000
*   OLDERID2=NEWERID2;                                             0764 02799000
         L     @06,@PC00001                                        0764 02800000
         L     @06,GDTTR2(,@06)                                    0764 02801000
         MVC   @TS00001(95),NEWERID2(@06)                          0764 02802000
         MVC   OLDERID2(95,@06),@TS00001                           0764 02803000
*   NEWID2='CVCP';                  /*                       @Y30LB32*/ 02804000
         MVC   NEWID2(4,@06),@CC01590                              0765 02805000
*   CARTCOND=0;                     /*                       @Y30LB32*/ 02806000
         SLR   CARTCOND,CARTCOND                                   0766 02807000
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/ 02808000
*                                                                  0767 02809000
         LA    @06,PARMLST                                         0767 02810000
         ST    @06,DEFLSTP                                         0767 02811000
*   /*****************************************************************/ 02812000
*   /*                                                               */ 02813000
*   /* SET ARRAY COUNT TO LIST OF CSN'S BASED ON             @Y30LB32*/ 02814000
*   /* NUMBER OF VOLUMES CREATED                             @Y30LB32*/ 02815000
*   /*                                                               */ 02816000
*   /*****************************************************************/ 02817000
*                                                                  0768 02818000
*   IF VOLCRCNT=0 THEN              /*                       @Y30LB32*/ 02819000
         L     @06,VOLCRCNT                                        0768 02820000
         LTR   @06,@06                                             0768 02821000
         BNZ   @RF00768                                            0768 02822000
*     CSNNUM=ONE;                   /*                       @Y30LB32*/ 02823000
*                                                                  0769 02824000
         LA    CSNNUM,1                                            0769 02825000
*   /*****************************************************************/ 02826000
*   /*                                                               */ 02827000
*   /* SET INDEX NUMBER TO ACCESS CSNS FOR THE NEXT VOLUME   @Y30LB32*/ 02828000
*   /*                                                               */ 02829000
*   /*****************************************************************/ 02830000
*                                                                  0770 02831000
*   ELSE                            /*                       @Y30LB32*/ 02832000
*     CSNNUM=(VOLCRCNT*2)+1;        /*                       @Y30LB32*/ 02833000
*                                                                  0770 02834000
         B     @RC00768                                            0770 02835000
@RF00768 L     CSNNUM,VOLCRCNT                                     0770 02836000
         ALR   CSNNUM,CSNNUM                                       0770 02837000
         LA    CSNNUM,1(,CSNNUM)                                   0770 02838000
*   /*****************************************************************/ 02839000
*   /*                                                               */ 02840000
*   /* ACCESS, CHECK LENGTH, AND PLACE TWO CSN'S IN          @Y30LB32*/ 02841000
*   /* DEFLIST                                               @Y30LB32*/ 02842000
*   /*                                                               */ 02843000
*   /*****************************************************************/ 02844000
*                                                                  0771 02845000
*   DO CSNCNT=1 TO 2 WHILE(CARTCOND=0);/*                    @Y30LB32*/ 02846000
*                                                                  0771 02847000
@RC00768 LA    CSNCNT,1                                            0771 02848000
@DL00771 LTR   CARTCOND,CARTCOND                                   0771 02849000
         BNZ   @DC00771                                            0771 02850000
*     /***************************************************************/ 02851000
*     /*                                                             */ 02852000
*     /* ACCESS CSN AND CSN LENGTH THEN CALL CKCSNLEN        @Y30LB32*/ 02853000
*     /* ROUTINE TO CHECK LENGTH OF CSN                      @Y30LB32*/ 02854000
*     /*                                                             */ 02855000
*     /***************************************************************/ 02856000
*                                                                  0772 02857000
*     CSNVAL=CARTVAL(CSNNUM);       /*                       @Y30LB32*/ 02858000
         LR    @15,CSNNUM                                          0772 02859000
         MH    @15,@CH00649                                        0772 02860000
         L     @14,@PC00001+4                                      0772 02861000
         L     @14,FDTPTR+20(,@14)                                 0772 02862000
         ST    @15,@TF00001                                        0772 02863000
         ALR   @15,@14                                             0772 02864000
         AL    @15,@CF01698                                        0772 02865000
         MVC   CSNVAL(12),CARTVAL-3(@15)                           0772 02866000
*     CALL CKCSNLEN(CSNVAL,CARTLEN(CSNNUM));/*               @Y30LB32*/ 02867000
         LA    @15,CSNVAL                                          0773 02868000
         ST    @15,@AL00001                                        0773 02869000
         L     @15,@TF00001                                        0773 02870000
         AL    @14,@CF01699                                        0773 02871000
         LA    @15,CARTLEN-2(@15,@14)                              0773 02872000
         ST    @15,@AL00001+4                                      0773 02873000
         LA    @01,@AL00001                                        0773 02874000
         BAL   @14,CKCSNLEN                                        0773 02875000
*     RESPECIFY                                                    0774 02876000
*       RTNREG RSTD;                                               0774 02877000
*     TESTRC=RTNREG;                                               0775 02878000
         LR    TESTRC,RTNREG                                       0775 02879000
*     RESPECIFY                                                    0776 02880000
*       RTNREG UNRSTD;              /*                       @Y30LB32*/ 02881000
*                                                                  0776 02882000
*     /***************************************************************/ 02883000
*     /*                                                             */ 02884000
*     /* CHECK IF CSN IS VALID LENGTH. IF CSN VALID          @Y30LB32*/ 02885000
*     /* CHECK IF FIRST CSN FOR NEW VOLUME                   @Y30LB32*/ 02886000
*     /*                                                             */ 02887000
*     /***************************************************************/ 02888000
*                                                                  0777 02889000
*     IF TESTRC=0 THEN              /*                       @Y30LB32*/ 02890000
         LTR   TESTRC,TESTRC                                       0777 02891000
         BNZ   @RF00777                                            0777 02892000
*       IF CSNCNT=FIRSTCSN THEN     /*                       @Y30LB32*/ 02893000
         LA    @15,1                                               0778 02894000
         CR    CSNCNT,@15                                          0778 02895000
         BNE   @RF00778                                            0778 02896000
*         DO;                       /*                       @Y30LB32*/ 02897000
*                                                                  0779 02898000
*           /*********************************************************/ 02899000
*           /*                                                       */ 02900000
*           /* PLACE CSN IN DEFLIST AS FIRST CSN             @Y30LB32*/ 02901000
*           /*                                                       */ 02902000
*           /*********************************************************/ 02903000
*                                                                  0780 02904000
*           DEFVCSN1=CSNVAL;        /*                       @Y30LB32*/ 02905000
*                                                                  0780 02906000
         L     @01,DEFLSTP                                         0780 02907000
         MVC   DEFVCSN1(12,@01),CSNVAL                             0780 02908000
*           /*********************************************************/ 02909000
*           /*                                                       */ 02910000
*           /* RESET ARRAY SUBSCRIPT NUMBER TO ACCESS        @Y30LB32*/ 02911000
*           /* NEXT CSN                                      @Y30LB32*/ 02912000
*           /*                                                       */ 02913000
*           /*********************************************************/ 02914000
*                                                                  0781 02915000
*           CSNNUM=CSNNUM+1;        /*                       @Y30LB32*/ 02916000
         ALR   CSNNUM,@15                                          0781 02917000
*         END;                      /*                       @Y30LB32*/ 02918000
*                                                                  0782 02919000
*     /***************************************************************/ 02920000
*     /*                                                             */ 02921000
*     /* IF CSN IS NOT FIRST CSN THEN PLACE CSN              @Y30LB32*/ 02922000
*     /* IN DEFLIST AS SECOND CSN                            @Y30LB32*/ 02923000
*     /*                                                             */ 02924000
*     /***************************************************************/ 02925000
*                                                                  0783 02926000
*       ELSE                        /*                       @Y30LB32*/ 02927000
*         DEFVCSN2=CSNVAL;          /*                       @Y30LB32*/ 02928000
*                                                                  0783 02929000
         B     @RC00778                                            0783 02930000
@RF00778 L     @01,DEFLSTP                                         0783 02931000
         MVC   DEFVCSN2(12,@01),CSNVAL                             0783 02932000
*     /***************************************************************/ 02933000
*     /*                                                             */ 02934000
*     /* IF CSN IS NOT VALID WRITE MESSAGE IDC2681I          @Y30LB32*/ 02935000
*     /* STATING VOLUME NOT CREATED                          @Y30LB32*/ 02936000
*     /*                                                             */ 02937000
*     /***************************************************************/ 02938000
*                                                                  0784 02939000
*     ELSE                          /*                       @Y30LB32*/ 02940000
*       DO;                         /*                       @Y30LB32*/ 02941000
         B     @RC00777                                            0784 02942000
@RF00777 DS    0H                                                  0785 02943000
*         PRINTTAB=''B;             /*                       @Y30LB32*/ 02944000
         XC    PRINTTAB(36),PRINTTAB                               0785 02945000
*         DARGSMOD=CRVMSG;          /*                       @Y30LB32*/ 02946000
         L     @15,DDSTRU                                          0786 02947000
         MVC   DARGSMOD(3,@15),@CC01462                            0786 02948000
*         DARGSENT=MSG2681I;        /*                       @Y30LB32*/ 02949000
         MVI   DARGSENT(@15),X'02'                                 0787 02950000
*         DARGDBP=ADDR(VOLSER);     /*                       @Y30LB32*/ 02951000
         LA    @14,VOLSER                                          0788 02952000
         ST    @14,DARGDBP(,@15)                                   0788 02953000
*         DARGILP=LENGTH(VOLSER);   /*                       @Y30LB32*/ 02954000
         MVC   DARGILP(2,@15),@CH00158                             0789 02955000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Y30LB32*/ 02956000
*                                                                  0790 02957000
         L     @15,@PC00001                                        0790 02958000
         ST    @15,@AL00001                                        0790 02959000
         LA    @14,@CF00116                                        0790 02960000
         ST    @14,@AL00001+4                                      0790 02961000
         LA    @14,DDSTRU                                          0790 02962000
         ST    @14,@AL00001+8                                      0790 02963000
         MVI   @AL00001+8,X'80'                                    0790 02964000
         L     @15,GDTPRT(,@15)                                    0790 02965000
         LA    @01,@AL00001                                        0790 02966000
         BALR  @14,@15                                             0790 02967000
*         /***********************************************************/ 02968000
*         /*                                                         */ 02969000
*         /* SET CONDITION CODE WITH ERROR CODE              @Y30LB32*/ 02970000
*         /*                                                         */ 02971000
*         /***********************************************************/ 02972000
*                                                                  0791 02973000
*         CARTCOND=LASTCC04;        /*                       @Y30LB32*/ 02974000
         LA    CARTCOND,4                                          0791 02975000
*       END;                        /*                       @Y30LB32*/ 02976000
*   END;                            /*                       @Y30LB32*/ 02977000
*                                                                  0793 02978000
@RC00777 AL    CSNCNT,@CF00221                                     0793 02979000
         C     CSNCNT,@CF00155                                     0793 02980000
         BNH   @DL00771                                            0793 02981000
@DC00771 DS    0H                                                  0794 02982000
*   /*****************************************************************/ 02983000
*   /*                                                               */ 02984000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB32*/ 02985000
*   /* TO CALLER                                             @Y30LB32*/ 02986000
*   /*                                                               */ 02987000
*   /*****************************************************************/ 02988000
*                                                                  0794 02989000
*   REG14=RETADDR2;                 /*                       @Y30LB32*/ 02990000
         L     REG14,RETADDR2                                      0794 02991000
*   RETURN CODE(CARTCOND);          /*                       @Y30LB32*/ 02992000
         LR    @15,CARTCOND                                        0795 02993000
@EL00009 DS    0H                                                  0795 02994000
@EF00009 DS    0H                                                  0795 02995000
@ER00009 BR    @14                                                 0795 02996000
*   END CARTPROC;                   /*                       @Y30LB32*/ 02997000
*                                                                  0797 02998000
*/********************************************************************/ 02999000
*/*                                                          @Y30LB32*/ 03000000
*/*  PROCEDURE NAME - CREATACT                               @Y30LB32*/ 03001000
*/*                                                          @Y30LB32*/ 03002000
*/*  FUNCTION - CREATES NEW VOLUME THEN ACTIVATES NEW        @Y30LB32*/ 03003000
*/*             VOLUME. ISSUES MESSAGE IDC2681I IF VOLUME    @Y30LB32*/ 03004000
*/*             NOT CREATED. ISSUES MESSAGE IDC2075I IF      @Y30LB32*/ 03005000
*/*             VOLUME NOT ACTIVATED. CALLS SCRATCH ROUTINE  @Y30LB32*/ 03006000
*/*             TO SCRATCH VOLUME IF VOLUME IS NOT ACTIVATED @Y30LB32*/ 03007000
*/*                                                          @Y30LB32*/ 03008000
*/*  INPUT - DEFLIST, DEFVE                                  @Y30LB32*/ 03009000
*/*                                                          @Y30LB32*/ 03010000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 03011000
*/*            RETURN CODE = 0 VOLUME CREATED AND ACTIVATED  @Y30LB32*/ 03012000
*/*            RETURN CODE = 4 VOLUME NOT CREATED OR NOT     @Y30LB32*/ 03013000
*/*                            ACTIVATED.                    @Y30LB32*/ 03014000
*/*                                                          @Y30LB32*/ 03015000
*/********************************************************************/ 03016000
*                                                                  0797 03017000
*CREATACT:                                                         0797 03018000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 03019000
*                                                                  0797 03020000
CREATACT DS    0H                                                  0798 03021000
*   /*****************************************************************/ 03022000
*   /*                                                               */ 03023000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/ 03024000
*   /* CODE TO ZERO AND RESET PTR TO DEFLIST PARM AREA       @Y30LB32*/ 03025000
*   /*                                                               */ 03026000
*   /*****************************************************************/ 03027000
*                                                                  0798 03028000
*   RETADDR2=REG14;                 /*                       @Y30LB32*/ 03029000
         ST    REG14,RETADDR2                                      0798 03030000
*   OLDERID2=NEWERID2;                                             0799 03031000
         L     @06,@PC00001                                        0799 03032000
         L     @05,GDTTR2(,@06)                                    0799 03033000
         MVC   @TS00001(95),NEWERID2(@05)                          0799 03034000
         MVC   OLDERID2(95,@05),@TS00001                           0799 03035000
*   NEWID2='CVCA';                  /*                       @Y30LB32*/ 03036000
         MVC   NEWID2(4,@05),@CC01595                              0800 03037000
*   CRACOND=0;                      /*                       @Y30LB32*/ 03038000
*                                                                  0801 03039000
         SLR   CRACOND,CRACOND                                     0801 03040000
*   /*****************************************************************/ 03041000
*   /*                                                               */ 03042000
*   /* SAVE FLAG BIT SETTINGS INDICATING VOLUME MOUNTING     @Y30LB32*/ 03043000
*   /* ATTRIBUTES REQUESTED                                  @Y30LB32*/ 03044000
*   /*                                                               */ 03045000
*   /*****************************************************************/ 03046000
*                                                                  0802 03047000
*   SAVFLAG=DEFVVFLG;                                              0802 03048000
*                                                                  0802 03049000
         L     @05,DEFLSTP                                         0802 03050000
         IC    @15,DEFVVFLG(,@05)                                  0802 03051000
         STC   @15,SAVFLAG                                         0802 03052000
*   /*****************************************************************/ 03053000
*   /*                                                               */ 03054000
*   /* ISSUE USSC UMACRO TO INVOKE EXECUTE FORM OF           @Y30LB32*/ 03055000
*   /* ICBDEFV TO CREATE NEW VOLUME                          @Y30LB32*/ 03056000
*   /*                                                               */ 03057000
*   /*****************************************************************/ 03058000
*                                                                  0803 03059000
*   IF GDTDBG=NULLPTR THEN                                         0803 03060000
         L     @06,GDTDBG(,@06)                                    0803 03061000
         LTR   @06,@06                                             0803 03062000
         BZ    @RT00803                                            0803 03063000
*     ;                                                            0804 03064000
*   ELSE                                                           0805 03065000
*     DO;                                                          0805 03066000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/ 03067000
         LA    DMPINDEX,DUMPAREA                                   0806 03068000
*       DMPITMNM='DEFLIST';                                        0807 03069000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0807 03070000
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       0807 03071000
*       DMPITMPT=ADDR(DEFLIST);                                    0808 03072000
         L     @06,DEFLSTP                                         0808 03073000
         ST    @06,DMPITMPT(,DMPINDEX)                             0808 03074000
*       DMPITMLN=LENGTH(DEFLIST);                                  0809 03075000
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       0809 03076000
*       DMPITMTP='H';                                              0810 03077000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0810 03078000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0811 03079000
*                                                                  0811 03080000
         LA    @06,16                                              0811 03081000
         ALR   DMPINDEX,@06                                        0811 03082000
*       /*************************************************************/ 03083000
*       /*                                                           */ 03084000
*       /*                                                   @Y30LB32*/ 03085000
*       /*                                                           */ 03086000
*       /*************************************************************/ 03087000
*                                                                  0812 03088000
*       DMPITMNM='DEFVE';                                          0812 03089000
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0812 03090000
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0812 03091000
         MVC   DMPITMNM(5,DMPINDEX),@CC01597                       0812 03092000
*       DMPITMPT=ADDR(DEFVE);                                      0813 03093000
         ST    DEFVEPTR,DMPITMPT(,DMPINDEX)                        0813 03094000
*       DMPITMLN=LENGTH(DEFVE);                                    0814 03095000
         MVC   DMPITMLN(2,DMPINDEX),@CH01674                       0814 03096000
*       DMPITMTP='H';                                              0815 03097000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0815 03098000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0816 03099000
*                                                                  0816 03100000
         ALR   DMPINDEX,@06                                        0816 03101000
*       /*************************************************************/ 03102000
*       /*                                                           */ 03103000
*       /*                                                   @Y30LB32*/ 03104000
*       /*                                                           */ 03105000
*       /*************************************************************/ 03106000
*                                                                  0817 03107000
*       DMPTRM=DMPTRMVL;                                           0817 03108000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0817 03109000
*     END;                          /*                       @Y30LB32*/ 03110000
*   IF GDTDBG=NULLPTR THEN                                         0819 03111000
@RT00803 L     @06,@PC00001                                        0819 03112000
         L     @06,GDTDBG(,@06)                                    0819 03113000
         LTR   @06,@06                                             0819 03114000
         BZ    @RT00819                                            0819 03115000
*     ;                                                            0820 03116000
*   ELSE                                                           0821 03117000
*     CALL IDCDB010(GDTTBL,'CVBC',ADDR(DUMPAREA));/*         @Y30LB32*/ 03118000
         L     @06,@PC00001                                        0821 03119000
         ST    @06,@AL00001                                        0821 03120000
         LA    @05,@CC01598                                        0821 03121000
         ST    @05,@AL00001+4                                      0821 03122000
         LA    @05,DUMPAREA                                        0821 03123000
         ST    @05,@AFTEMPS+4                                      0821 03124000
         LA    @05,@AFTEMPS+4                                      0821 03125000
         ST    @05,@AL00001+8                                      0821 03126000
         MVI   @AL00001+8,X'80'                                    0821 03127000
         L     @15,GDTDBG(,@06)                                    0821 03128000
         LA    @01,@AL00001                                        0821 03129000
         BALR  @14,@15                                             0821 03130000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);/*   03131000
*                                                            @Y30LB32*/ 03132000
@RT00819 L     @06,@PC00001                                        0822 03133000
         ST    @06,@AL00001                                        0822 03134000
         LA    @05,DEFINE                                          0822 03135000
         ST    @05,@AL00001+4                                      0822 03136000
         LA    @05,DEFLSTP                                         0822 03137000
         ST    @05,@AL00001+8                                      0822 03138000
         LA    @05,REASONCD                                        0822 03139000
         ST    @05,@AL00001+12                                     0822 03140000
         LA    @05,ECBCODE                                         0822 03141000
         ST    @05,@AL00001+16                                     0822 03142000
         LA    @05,CMMSGPTR                                        0822 03143000
         ST    @05,@AL00001+20                                     0822 03144000
         MVI   @AL00001+20,X'80'                                   0822 03145000
         L     @15,GDTSSC(,@06)                                    0822 03146000
         LA    @01,@AL00001                                        0822 03147000
         BALR  @14,@15                                             0822 03148000
*   RESPECIFY                                                      0823 03149000
*     RTNREG RSTD;                                                 0823 03150000
*   TESTRC=RTNREG;                                                 0824 03151000
         LR    TESTRC,RTNREG                                       0824 03152000
*   RESPECIFY                                                      0825 03153000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 03154000
*                                                                  0825 03155000
*   /*****************************************************************/ 03156000
*   /*                                                               */ 03157000
*   /* CHECK IF CREATE FORM OF DEFINE MACRO WAS SUCCESSFUL   @Y30LB32*/ 03158000
*   /*                                                               */ 03159000
*   /*****************************************************************/ 03160000
*                                                                  0826 03161000
*   IF TESTRC=0|TESTRC=12 THEN      /*                       @Y30LB32*/ 03162000
         LTR   TESTRC,TESTRC                                       0826 03163000
         BZ    @RT00826                                            0826 03164000
         C     TESTRC,@CF00606                                     0826 03165000
         BNE   @RF00826                                            0826 03166000
@RT00826 DS    0H                                                  0827 03167000
*     DO;                           /*                       @Y30LB32*/ 03168000
*                                                                  0827 03169000
*       /*************************************************************/ 03170000
*       /*                                                           */ 03171000
*       /* CHECK IF VOLUME INVENTORY WAS UPDATED             @Y30LB32*/ 03172000
*       /* SUCCESSFULLY, IF NOT UPDATED SET ERROR FLAG       @Y30LB32*/ 03173000
*       /*                                                           */ 03174000
*       /*************************************************************/ 03175000
*                                                                  0828 03176000
*       IF TESTRC=12 THEN           /*                       @Y30LB32*/ 03177000
         C     TESTRC,@CF00606                                     0828 03178000
         BNE   @RF00828                                            0828 03179000
*         VIERRFLG=ON;              /*                       @Y30LB32*/ 03180000
*                                                                  0829 03181000
         OI    VIERRFLG,B'01000000'                                0829 03182000
*       /*************************************************************/ 03183000
*       /*                                                           */ 03184000
*       /* ACCESS CSN'S FROM MESSAGE AREA AND FREE UP        @Y30LB32*/ 03185000
*       /* MESSAGE AREA OBTAINED BY USSC UMACRO              @Y30LB32*/ 03186000
*       /*                                                           */ 03187000
*       /*************************************************************/ 03188000
*                                                                  0830 03189000
*       SAVECSN1=CMCSN1;            /*                       @Y30LB32*/ 03190000
@RF00828 LA    @06,4                                               0830 03191000
         AL    @06,CMMSGPTR                                        0830 03192000
         MVC   SAVECSN1(12),CMCSN1(@06)                            0830 03193000
*       SAVECSN2=CMCSN2;            /*                       @Y30LB32*/ 03194000
         MVC   SAVECSN2(12),CMCSN2(@06)                            0831 03195000
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB32*/ 03196000
*                                                                  0832 03197000
         L     @06,@PC00001                                        0832 03198000
         ST    @06,@AL00001                                        0832 03199000
         LA    @05,CMMSGPTR                                        0832 03200000
         ST    @05,@AL00001+4                                      0832 03201000
         L     @15,GDTFSP(,@06)                                    0832 03202000
         LA    @01,@AL00001                                        0832 03203000
         BALR  @14,@15                                             0832 03204000
*       /*************************************************************/ 03205000
*       /*                                                           */ 03206000
*       /* RESET POINTER TO DEFLIST PARM AREA                @Y30LB32*/ 03207000
*       /* THE DEFLIST IS REINITIALIZED AND USSC UMACRO      @Y30LB32*/ 03208000
*       /* ISSUED TO INVOKE THE EXECUTE FORM OF ICBDEFV      @Y30LB32*/ 03209000
*       /* MACRO TO ACTIVATE THE NEWLY CREATED VOLUME        @Y30LB32*/ 03210000
*       /*                                                           */ 03211000
*       /*************************************************************/ 03212000
*                                                                  0833 03213000
*       DEFLSTP=ADDR(PARMLST2);     /*                       @Y30LB32*/ 03214000
         LA    @06,PARMLST2                                        0833 03215000
         ST    @06,DEFLSTP                                         0833 03216000
*       DEFVVFLG=''B;               /*                       @Y30LB32*/ 03217000
         MVI   DEFVVFLG(@06),X'00'                                 0834 03218000
*       DEFVFLG=''B;                /*                       @Y30LB32*/ 03219000
         MVI   DEFVFLG(@06),X'00'                                  0835 03220000
*       DEFVACT=ON;                 /*                       @Y30LB32*/ 03221000
         OI    DEFVACT(@06),B'00000010'                            0836 03222000
*       DEFVCSN1=SAVECSN1;          /*                       @Y30LB32*/ 03223000
         MVC   DEFVCSN1(12,@06),SAVECSN1                           0837 03224000
*       IF GDTDBG=NULLPTR THEN                                     0838 03225000
         L     @06,@PC00001                                        0838 03226000
         L     @06,GDTDBG(,@06)                                    0838 03227000
         LTR   @06,@06                                             0838 03228000
         BZ    @RT00838                                            0838 03229000
*         ;                                                        0839 03230000
*       ELSE                                                       0840 03231000
*         DO;                                                      0840 03232000
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB32*/ 03233000
         LA    DMPINDEX,DUMPAREA                                   0841 03234000
*           DMPITMNM='DEFLIST';                                    0842 03235000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0842 03236000
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       0842 03237000
*           DMPITMPT=ADDR(DEFLIST);                                0843 03238000
         L     @06,DEFLSTP                                         0843 03239000
         ST    @06,DMPITMPT(,DMPINDEX)                             0843 03240000
*           DMPITMLN=LENGTH(DEFLIST);                              0844 03241000
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       0844 03242000
*           DMPITMTP='H';                                          0845 03243000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0845 03244000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0846 03245000
*                                                                  0846 03246000
         AL    DMPINDEX,@CF00508                                   0846 03247000
*           /*********************************************************/ 03248000
*           /*                                                       */ 03249000
*           /*                                               @Y30LB32*/ 03250000
*           /*                                                       */ 03251000
*           /*********************************************************/ 03252000
*                                                                  0847 03253000
*           DMPTRM=DMPTRMVL;                                       0847 03254000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0847 03255000
*         END;                      /*                       @Y30LB32*/ 03256000
*       IF GDTDBG=NULLPTR THEN                                     0849 03257000
@RT00838 L     @06,@PC00001                                        0849 03258000
         L     @06,GDTDBG(,@06)                                    0849 03259000
         LTR   @06,@06                                             0849 03260000
         BZ    @RT00849                                            0849 03261000
*         ;                                                        0850 03262000
*       ELSE                                                       0851 03263000
*         CALL IDCDB010(GDTTBL,'CVBA',ADDR(DUMPAREA));/*     @Y30LB32*/ 03264000
         L     @06,@PC00001                                        0851 03265000
         ST    @06,@AL00001                                        0851 03266000
         LA    @05,@CC01599                                        0851 03267000
         ST    @05,@AL00001+4                                      0851 03268000
         LA    @05,DUMPAREA                                        0851 03269000
         ST    @05,@AFTEMPS+4                                      0851 03270000
         LA    @05,@AFTEMPS+4                                      0851 03271000
         ST    @05,@AL00001+8                                      0851 03272000
         MVI   @AL00001+8,X'80'                                    0851 03273000
         L     @15,GDTDBG(,@06)                                    0851 03274000
         LA    @01,@AL00001                                        0851 03275000
         BALR  @14,@15                                             0851 03276000
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR); 03277000
@RT00849 L     @06,@PC00001                                        0852 03278000
         ST    @06,@AL00001                                        0852 03279000
         LA    @05,DEFINE                                          0852 03280000
         ST    @05,@AL00001+4                                      0852 03281000
         LA    @05,DEFLSTP                                         0852 03282000
         ST    @05,@AL00001+8                                      0852 03283000
         LA    @05,REASONCD                                        0852 03284000
         ST    @05,@AL00001+12                                     0852 03285000
         LA    @05,ECBCODE                                         0852 03286000
         ST    @05,@AL00001+16                                     0852 03287000
         LA    @05,CMMSGPTR                                        0852 03288000
         ST    @05,@AL00001+20                                     0852 03289000
         MVI   @AL00001+20,X'80'                                   0852 03290000
         L     @15,GDTSSC(,@06)                                    0852 03291000
         LA    @01,@AL00001                                        0852 03292000
         BALR  @14,@15                                             0852 03293000
*                                   /*                       @Y30LB32*/ 03294000
*       RESPECIFY                                                  0853 03295000
*         RTNREG RSTD;                                             0853 03296000
*       TESTRC=RTNREG;                                             0854 03297000
         LR    TESTRC,RTNREG                                       0854 03298000
*       RESPECIFY                                                  0855 03299000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 03300000
*                                                                  0855 03301000
*       /*************************************************************/ 03302000
*       /*                                                           */ 03303000
*       /* CHECK IF ACTIVATE FORM OF DEFINE MACRO WAS        @Y30LB32*/ 03304000
*       /* SUCCESSFUL, IF SUCCESSFUL FREE UP MESSAGE STORAGE @Y30LB32*/ 03305000
*       /* AREA                                              @Y30LB32*/ 03306000
*       /*                                                           */ 03307000
*       /*************************************************************/ 03308000
*                                                                  0856 03309000
*       IF TESTRC=0|TESTRC=12 THEN  /*                       @Y30LB32*/ 03310000
         LTR   TESTRC,TESTRC                                       0856 03311000
         BZ    @RT00856                                            0856 03312000
         C     TESTRC,@CF00606                                     0856 03313000
         BNE   @RF00856                                            0856 03314000
@RT00856 DS    0H                                                  0857 03315000
*         DO;                       /*                       @Y30LB32*/ 03316000
*           IF TESTRC=12 THEN       /*                       @Y30LB32*/ 03317000
         C     TESTRC,@CF00606                                     0858 03318000
         BNE   @RF00858                                            0858 03319000
*             VIERRFLG=ON;          /*                       @Y30LB32*/ 03320000
         OI    VIERRFLG,B'01000000'                                0859 03321000
*           CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                @Y30LB32*/ 03322000
@RF00858 L     @06,@PC00001                                        0860 03323000
         ST    @06,@AL00001                                        0860 03324000
         LA    @05,CMMSGPTR                                        0860 03325000
         ST    @05,@AL00001+4                                      0860 03326000
         L     @15,GDTFSP(,@06)                                    0860 03327000
         LA    @01,@AL00001                                        0860 03328000
         BALR  @14,@15                                             0860 03329000
*         END;                      /*                       @Y30LB32*/ 03330000
*                                                                  0861 03331000
*       /*************************************************************/ 03332000
*       /*                                                           */ 03333000
*       /* IF DEFINE MACRO DID NOT ACTIVATE VOLUME           @Y30LB32*/ 03334000
*       /* SUCCESSFULLY PROCESS ERROR CODE                   @Y30LB32*/ 03335000
*       /*                                                           */ 03336000
*       /*************************************************************/ 03337000
*                                                                  0862 03338000
*       ELSE                        /*                       @Y30LB32*/ 03339000
*         DO;                       /*                       @Y30LB32*/ 03340000
*                                                                  0862 03341000
         B     @RC00856                                            0862 03342000
@RF00856 DS    0H                                                  0863 03343000
*           /*********************************************************/ 03344000
*           /*                                                       */ 03345000
*           /* CHECK IF USSC UMACRO COULD NOT OBTAIN         @Y30LB32*/ 03346000
*           /* STORAGE FOR ECB/MESSAGE AREA                  @Y30LB32*/ 03347000
*           /*                                                       */ 03348000
*           /*********************************************************/ 03349000
*                                                                  0863 03350000
*           IF TESTRC^=8 THEN       /*                       @Y30LB32*/ 03351000
         C     TESTRC,@CF00181                                     0863 03352000
         BE    @RF00863                                            0863 03353000
*             DO;                   /*                       @Y30LB32*/ 03354000
*               CALL SSCMSG(REASONCD);/*                     @Y30LB32*/ 03355000
         LA    @06,REASONCD                                        0865 03356000
         ST    @06,@AL00001                                        0865 03357000
         LA    @01,@AL00001                                        0865 03358000
         BAL   @14,SSCMSG                                          0865 03359000
*               CRACOND=LASTCC04;   /*                       @Y30LB32*/ 03360000
*                                                                  0866 03361000
         LA    CRACOND,4                                           0866 03362000
*               /*****************************************************/ 03363000
*               /*                                                   */ 03364000
*               /* WRITE MESSAGE IDC2075I STATING VOLUME     @Y30LB32*/ 03365000
*               /* COULD NOT BE ACTIVATED                    @Y30LB32*/ 03366000
*               /*                                                   */ 03367000
*               /*****************************************************/ 03368000
*                                                                  0867 03369000
*               PRINTTAB=''B;       /*                       @Y30LB32*/ 03370000
         XC    PRINTTAB(36),PRINTTAB                               0867 03371000
*               DARGSMOD=COMMSG;    /*                       @Y30LB32*/ 03372000
         L     @06,DDSTRU                                          0868 03373000
         MVC   DARGSMOD(3,@06),@CC01460                            0868 03374000
*               DARGSENT=MSG2075I;  /*                       @Y30LB32*/ 03375000
         MVI   DARGSENT(@06),X'1F'                                 0869 03376000
*               DARGDBP=ADDR(VOLSER);/*                      @Y30LB32*/ 03377000
         LA    @05,VOLSER                                          0870 03378000
         ST    @05,DARGDBP(,@06)                                   0870 03379000
*               DARGILP=LENGTH(VOLSER);/*                    @Y30LB32*/ 03380000
         MVC   DARGILP(2,@06),@CH00158                             0871 03381000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/ 03382000
*                                                                  0872 03383000
         L     @06,@PC00001                                        0872 03384000
         ST    @06,@AL00001                                        0872 03385000
         LA    @05,@CF00116                                        0872 03386000
         ST    @05,@AL00001+4                                      0872 03387000
         LA    @05,DDSTRU                                          0872 03388000
         ST    @05,@AL00001+8                                      0872 03389000
         MVI   @AL00001+8,X'80'                                    0872 03390000
         L     @15,GDTPRT(,@06)                                    0872 03391000
         LA    @01,@AL00001                                        0872 03392000
         BALR  @14,@15                                             0872 03393000
*               /*****************************************************/ 03394000
*               /*                                                   */ 03395000
*               /* RESET POINTER TO DEFLIST PARM AREA        @Y30LB32*/ 03396000
*               /* INITIALIZE PARM LIST DEFLIST AND CALL SCRATCH     */ 03397000
*               /*                                           @Y30LB32*/ 03398000
*               /* ROUTINE TO SCRATCH PARTIALLY CREATED INACTIVE     */ 03399000
*               /*                                           @Y30LB32*/ 03400000
*               /* VOLUME                                    @Y30LB32*/ 03401000
*               /*                                                   */ 03402000
*               /*****************************************************/ 03403000
*                                                                  0873 03404000
*               DEFLSTP=ADDR(PARMLST2);/*                    @Y30LB32*/ 03405000
         LA    @06,PARMLST2                                        0873 03406000
         ST    @06,DEFLSTP                                         0873 03407000
*               DEFVFLG=''B;        /*                       @Y30LB32*/ 03408000
         MVI   DEFVFLG(@06),X'00'                                  0874 03409000
*               DEFVELTR=ON;        /*                       @Y30LB32*/ 03410000
         OI    DEFVELTR(@06),B'00001000'                           0875 03411000
*               CALL SCRATCH;       /*                       @Y30LB32*/ 03412000
         BAL   @14,SCRATCH                                         0876 03413000
*               RESPECIFY                                          0877 03414000
*                 RTNREG RSTD;                                     0877 03415000
*               TESTRC=RTNREG;                                     0878 03416000
         LR    TESTRC,RTNREG                                       0878 03417000
*               RESPECIFY                                          0879 03418000
*                 RTNREG UNRSTD;    /*                       @Y30LB32*/ 03419000
*               CRACOND=MAX(CRACOND,TESTRC);/*               @Y30LB32*/ 03420000
         CR    CRACOND,TESTRC                                      0880 03421000
         BNL   *+6                                                      03422000
         LR    CRACOND,TESTRC                                      0880 03423000
*             END;                  /*                       @Y30LB32*/ 03424000
*                                                                  0881 03425000
*           /*********************************************************/ 03426000
*           /*                                                       */ 03427000
*           /* SET CONDITION CODE WITH ERROR CODE            @Y30LB32*/ 03428000
*           /*                                                       */ 03429000
*           /*********************************************************/ 03430000
*                                                                  0882 03431000
*           ELSE                    /*                       @Y30LB32*/ 03432000
*             DO;                   /*                       @Y30LB32*/ 03433000
         B     @RC00863                                            0882 03434000
@RF00863 DS    0H                                                  0883 03435000
*               CRACOND=LASTCC08;   /*                       @Y30LB32*/ 03436000
*                                                                  0883 03437000
         LA    CRACOND,8                                           0883 03438000
*               /*****************************************************/ 03439000
*               /*                                                   */ 03440000
*               /* WRITE MESSAGE IDC2075I STATING VOLUME     @Y30LB32*/ 03441000
*               /* COULD NOT BE ACTIVATED                    @Y30LB32*/ 03442000
*               /*                                                   */ 03443000
*               /*****************************************************/ 03444000
*                                                                  0884 03445000
*               PRINTTAB=''B;       /*                       @Y30LB32*/ 03446000
         XC    PRINTTAB(36),PRINTTAB                               0884 03447000
*               DARGSMOD=COMMSG;    /*                       @Y30LB32*/ 03448000
         L     @06,DDSTRU                                          0885 03449000
         MVC   DARGSMOD(3,@06),@CC01460                            0885 03450000
*               DARGSENT=MSG2075I;  /*                       @Y30LB32*/ 03451000
         MVI   DARGSENT(@06),X'1F'                                 0886 03452000
*               DARGDBP=ADDR(VOLSER);/*                      @Y30LB32*/ 03453000
         LA    @05,VOLSER                                          0887 03454000
         ST    @05,DARGDBP(,@06)                                   0887 03455000
*               DARGILP=LENGTH(VOLSER);/*                    @Y30LB32*/ 03456000
         MVC   DARGILP(2,@06),@CH00158                             0888 03457000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB32*/ 03458000
         L     @06,@PC00001                                        0889 03459000
         ST    @06,@AL00001                                        0889 03460000
         LA    @05,@CF00116                                        0889 03461000
         ST    @05,@AL00001+4                                      0889 03462000
         LA    @05,DDSTRU                                          0889 03463000
         ST    @05,@AL00001+8                                      0889 03464000
         MVI   @AL00001+8,X'80'                                    0889 03465000
         L     @15,GDTPRT(,@06)                                    0889 03466000
         LA    @01,@AL00001                                        0889 03467000
         BALR  @14,@15                                             0889 03468000
*             END;                  /*                       @Y30LB32*/ 03469000
*         END;                      /*                       @Y30LB32*/ 03470000
*     END;                          /*                       @Y30LB32*/ 03471000
*                                                                  0892 03472000
*   /*****************************************************************/ 03473000
*   /*                                                               */ 03474000
*   /* IF DEFINE MACRO DID NOT CREATE A VOLUME               @Y30LB32*/ 03475000
*   /* SUCCESSFULLY PROCESS ERROR CODE                       @Y30LB32*/ 03476000
*   /*                                                               */ 03477000
*   /*****************************************************************/ 03478000
*                                                                  0893 03479000
*   ELSE                            /*                       @Y30LB32*/ 03480000
*     DO;                           /*                       @Y30LB32*/ 03481000
*                                                                  0893 03482000
         B     @RC00826                                            0893 03483000
@RF00826 DS    0H                                                  0894 03484000
*       /*************************************************************/ 03485000
*       /*                                                           */ 03486000
*       /* CHECK IF USSC UMACRO COULD NOT OBTAIN STORAGE     @Y30LB32*/ 03487000
*       /* FOR ECB/MESSAGE AREA. IF FAILURE DUE TO           @Y30LB32*/ 03488000
*       /* OTHER ERROR CALL SSCMSG TO WRITE ERROR MESSAGE    @Y30LB32*/ 03489000
*       /* AND SET ERROR CODE                                @Y30LB32*/ 03490000
*       /*                                                           */ 03491000
*       /*************************************************************/ 03492000
*                                                                  0894 03493000
*       IF TESTRC^=8 THEN           /*                       @Y30LB32*/ 03494000
         C     TESTRC,@CF00181                                     0894 03495000
         BE    @RF00894                                            0894 03496000
*         DO;                       /*                       @Y30LB32*/ 03497000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/ 03498000
         LA    @06,REASONCD                                        0896 03499000
         ST    @06,@AL00001                                        0896 03500000
         LA    @01,@AL00001                                        0896 03501000
         BAL   @14,SSCMSG                                          0896 03502000
*           CRACOND=LASTCC04;       /*                       @Y30LB32*/ 03503000
         LA    CRACOND,4                                           0897 03504000
*         END;                      /*                       @Y30LB32*/ 03505000
*                                                                  0898 03506000
*       /*************************************************************/ 03507000
*       /*                                                           */ 03508000
*       /* SET CONDITION CODE WITH ERROR CODE                @Y30LB32*/ 03509000
*       /*                                                           */ 03510000
*       /*************************************************************/ 03511000
*                                                                  0899 03512000
*       ELSE                        /*                       @Y30LB32*/ 03513000
*         CRACOND=LASTCC08;         /*                       @Y30LB32*/ 03514000
*                                                                  0899 03515000
         B     @RC00894                                            0899 03516000
@RF00894 LA    CRACOND,8                                           0899 03517000
*       /*************************************************************/ 03518000
*       /*                                                           */ 03519000
*       /* WRITE MESSAGE IDC2681I STATING VOLUME NOT         @Y30LB32*/ 03520000
*       /* CREATED                                           @Y30LB32*/ 03521000
*       /*                                                           */ 03522000
*       /*************************************************************/ 03523000
*                                                                  0900 03524000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 03525000
@RC00894 XC    PRINTTAB(36),PRINTTAB                               0900 03526000
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/ 03527000
         L     @06,DDSTRU                                          0901 03528000
         MVC   DARGSMOD(3,@06),@CC01462                            0901 03529000
*       DARGSENT=MSG2681I;          /*                       @Y30LB32*/ 03530000
         MVI   DARGSENT(@06),X'02'                                 0902 03531000
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/ 03532000
         LA    @05,VOLSER                                          0903 03533000
         ST    @05,DARGDBP(,@06)                                   0903 03534000
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/ 03535000
         MVC   DARGILP(2,@06),@CH00158                             0904 03536000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 03537000
         L     @06,@PC00001                                        0905 03538000
         ST    @06,@AL00001                                        0905 03539000
         LA    @05,@CF00116                                        0905 03540000
         ST    @05,@AL00001+4                                      0905 03541000
         LA    @05,DDSTRU                                          0905 03542000
         ST    @05,@AL00001+8                                      0905 03543000
         MVI   @AL00001+8,X'80'                                    0905 03544000
         L     @15,GDTPRT(,@06)                                    0905 03545000
         LA    @01,@AL00001                                        0905 03546000
         BALR  @14,@15                                             0905 03547000
*     END;                          /*                       @Y30LB32*/ 03548000
*                                                                  0906 03549000
*   /*****************************************************************/ 03550000
*   /*                                                               */ 03551000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 03552000
*   /*                                                               */ 03553000
*   /*****************************************************************/ 03554000
*                                                                  0907 03555000
*   REG14=RETADDR2;                 /*                       @Y30LB32*/ 03556000
@RC00826 L     REG14,RETADDR2                                      0907 03557000
*   RETURN CODE(CRACOND);           /*                       @Y30LB32*/ 03558000
         LR    @15,CRACOND                                         0908 03559000
@EL00010 DS    0H                                                  0908 03560000
@EF00010 DS    0H                                                  0908 03561000
@ER00010 BR    @14                                                 0908 03562000
*   END CREATACT;                   /*                       @Y30LB32*/ 03563000
*                                                                  0910 03564000
*/********************************************************************/ 03565000
*/*                                                          @Y30LB32*/ 03566000
*/*  PROCEDURE NAME - UPDATE                                 @Y30LB32*/ 03567000
*/*                                                          @Y30LB32*/ 03568000
*/*  FUNCTION - ROUTES CONTROL TO PROCEDURES WHICH           @Y30LB32*/ 03569000
*/*             MOUNT, INITIALIZE, AND DEMOUNT NEW           @Y30LB32*/ 03570000
*/*             VOLUME. ALSO INVOKES ROUTINE TO SCRATCH      @Y30LB32*/ 03571000
*/*             PARTIALLY CREATED VOLUME FOR BACK OUT        @Y30LB32*/ 03572000
*/*                                                          @Y30LB32*/ 03573000
*/*  INPUT - NONE                                            @Y30LB32*/ 03574000
*/*                                                          @Y30LB32*/ 03575000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 03576000
*/*             RETURN CODE = 0 - VOLUME CREATED             @Y30LB32*/ 03577000
*/*             RETURN CODE = 4 - MOUNT, INITIALIZATION, OR  @Y30LB32*/ 03578000
*/*                               SCRATCHING OF VOL FAILED   @Y30LB32*/ 03579000
*/*             RETURN CODE = 8 - DEMOUNT NOT SUCCESSFUL     @Y30LB32*/ 03580000
*/*                                                          @Y30LB32*/ 03581000
*/********************************************************************/ 03582000
*                                                                  0910 03583000
*UPDATE:                                                           0910 03584000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 03585000
*                                                                  0910 03586000
UPDATE   DS    0H                                                  0911 03587000
*   /*****************************************************************/ 03588000
*   /*                                                               */ 03589000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION       @Y30LB32*/ 03590000
*   /* CODE TO ZERO                                          @Y30LB32*/ 03591000
*   /*                                                               */ 03592000
*   /*****************************************************************/ 03593000
*                                                                  0911 03594000
*   RETADDR2=REG14;                 /*                       @Y30LB32*/ 03595000
         ST    REG14,RETADDR2                                      0911 03596000
*   OLDERID2=NEWERID2;                                             0912 03597000
         L     @15,@PC00001                                        0912 03598000
         L     @15,GDTTR2(,@15)                                    0912 03599000
         MVC   @TS00001(95),NEWERID2(@15)                          0912 03600000
         MVC   OLDERID2(95,@15),@TS00001                           0912 03601000
*   NEWID2='CVUD';                  /*                       @Y30LB32*/ 03602000
         MVC   NEWID2(4,@15),@CC01604                              0913 03603000
*   UPDCOND=0;                      /*                       @Y30LB32*/ 03604000
*                                                                  0914 03605000
         SLR   UPDCOND,UPDCOND                                     0914 03606000
*   /*****************************************************************/ 03607000
*   /*                                                               */ 03608000
*   /* THE MNTPROC ROUTINE IS INVOKED TO MOUNT VOLUME        @Y30LB32*/ 03609000
*   /* FOR INITIALIZING LABEL AND VTOC                       @Y30LB32*/ 03610000
*   /*                                                               */ 03611000
*   /*****************************************************************/ 03612000
*                                                                  0915 03613000
*   CALL MNTPROC;                   /*                       @Y30LB32*/ 03614000
         BAL   @14,MNTPROC                                         0915 03615000
*   RESPECIFY                                                      0916 03616000
*     RTNREG RSTD;                                                 0916 03617000
*   TESTRC=RTNREG;                                                 0917 03618000
         LR    TESTRC,RTNREG                                       0917 03619000
*   RESPECIFY                                                      0918 03620000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 03621000
*                                                                  0918 03622000
*   /*****************************************************************/ 03623000
*   /*                                                               */ 03624000
*   /* CHECK IF MNTPROC ROUTINE WAS SUCCESSFUL               @Y30LB32*/ 03625000
*   /*                                                               */ 03626000
*   /*****************************************************************/ 03627000
*                                                                  0919 03628000
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/ 03629000
         LTR   TESTRC,TESTRC                                       0919 03630000
         BNZ   @RF00919                                            0919 03631000
*     DO;                           /*                       @Y30LB32*/ 03632000
*                                                                  0920 03633000
*       /*************************************************************/ 03634000
*       /*                                                           */ 03635000
*       /* THE INITPROC ROUTINE IS INVOKED TO INITIALIZE     @Y30LB32*/ 03636000
*       /* VOLUME LABEL AND VTOC                             @Y30LB32*/ 03637000
*       /*                                                           */ 03638000
*       /*************************************************************/ 03639000
*                                                                  0921 03640000
*       CALL INITPROC;              /*                       @Y30LB32*/ 03641000
         BAL   @14,INITPROC                                        0921 03642000
*       RESPECIFY                                                  0922 03643000
*         RTNREG RSTD;                                             0922 03644000
*       TESTRC=RTNREG;                                             0923 03645000
         LR    TESTRC,RTNREG                                       0923 03646000
*       RESPECIFY                                                  0924 03647000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 03648000
*                                                                  0924 03649000
*       /*************************************************************/ 03650000
*       /*                                                           */ 03651000
*       /* CHECK IF INITPROC ROUTINE WAS SUCCESSFUL, IF      @Y30LB32*/ 03652000
*       /* UNSUCCESSFUL SET CONDITION CODE WITH ERROR CODE   @Y30LB32*/ 03653000
*       /*                                                           */ 03654000
*       /*************************************************************/ 03655000
*                                                                  0925 03656000
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/ 03657000
         LTR   TESTRC,TESTRC                                       0925 03658000
         BZ    @RF00925                                            0925 03659000
*         UPDCOND=LASTCC04;         /*                       @Y30LB32*/ 03660000
*                                                                  0926 03661000
         LA    UPDCOND,4                                           0926 03662000
*       /*************************************************************/ 03663000
*       /*                                                           */ 03664000
*       /* SET VOLUME CREATED INDICATOR FLAG BIT             @Y30LB32*/ 03665000
*       /*                                                           */ 03666000
*       /*************************************************************/ 03667000
*                                                                  0927 03668000
*       ELSE                        /*                       @Y30LB32*/ 03669000
*         VCREATED=ON;              /*                       @Y30LB32*/ 03670000
*                                                                  0927 03671000
         B     @RC00925                                            0927 03672000
@RF00925 OI    VCREATED,B'10000000'                                0927 03673000
*       /*************************************************************/ 03674000
*       /*                                                           */ 03675000
*       /* THE DMNTPROC ROUTINE IS INVOKED TO DEMOUNT        @Y30LB32*/ 03676000
*       /* VOLUME                                            @Y30LB32*/ 03677000
*       /*                                                           */ 03678000
*       /*************************************************************/ 03679000
*                                                                  0928 03680000
*       CALL DMNTPROC;              /*                       @Y30LB32*/ 03681000
@RC00925 BAL   @14,DMNTPROC                                        0928 03682000
*       RESPECIFY                                                  0929 03683000
*         RTNREG RSTD;                                             0929 03684000
*       TESTRC=RTNREG;                                             0930 03685000
         LR    TESTRC,RTNREG                                       0930 03686000
*       RESPECIFY                                                  0931 03687000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 03688000
*                                                                  0931 03689000
*       /*************************************************************/ 03690000
*       /*                                                           */ 03691000
*       /* CHECK IF DMNTPROC ROUTINE WAS SUCCESSFUL          @Y30LB32*/ 03692000
*       /* IF UNSUCCESSFUL SET CONDITION CODE WITH ERROR     @Y30LB32*/ 03693000
*       /* IF NOT ALREADY SET WITH ERROR CODE OF FOUR        @Y30LB32*/ 03694000
*       /*                                                           */ 03695000
*       /*************************************************************/ 03696000
*                                                                  0932 03697000
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/ 03698000
         LTR   TESTRC,TESTRC                                       0932 03699000
         BZ    @RF00932                                            0932 03700000
*         UPDCOND=LASTCC08;         /*                       @Y30LB32*/ 03701000
         LA    UPDCOND,8                                           0933 03702000
*     END;                          /*                       @Y30LB32*/ 03703000
*                                                                  0934 03704000
*   /*****************************************************************/ 03705000
*   /*                                                               */ 03706000
*   /* IF MNTPROC WAS UNSUCCESSFUL SET CONDITION CODE WITH   @Y30LB32*/ 03707000
*   /* ERROR CODE OF FOUR                                    @Y30LB32*/ 03708000
*   /*                                                               */ 03709000
*   /*****************************************************************/ 03710000
*                                                                  0935 03711000
*   ELSE                            /*                       @Y30LB32*/ 03712000
*     UPDCOND=LASTCC04;             /*                       @Y30LB32*/ 03713000
*                                                                  0935 03714000
         B     @RC00919                                            0935 03715000
@RF00919 LA    UPDCOND,4                                           0935 03716000
*   /*****************************************************************/ 03717000
*   /*                                                               */ 03718000
*   /* CHECK CONDITION CODE TO DETERMINE IF VOLUME           @Y30LB32*/ 03719000
*   /* WAS ONLY PARTIALLY CREATED                            @Y30LB32*/ 03720000
*   /*                                                               */ 03721000
*   /*****************************************************************/ 03722000
*                                                                  0936 03723000
*   IF UPDCOND=4 THEN               /*                       @Y30LB32*/ 03724000
@RC00919 C     UPDCOND,@CF00042                                    0936 03725000
         BNE   @RF00936                                            0936 03726000
*     DO;                           /*                       @Y30LB32*/ 03727000
*                                                                  0937 03728000
*       /*************************************************************/ 03729000
*       /*                                                           */ 03730000
*       /* RESET POINTER TO DEFLIST PARM AREA                @Y30LB32*/ 03731000
*       /* INITIALIZE PARM LIST DEFLIST TO SCRATCH A         @Y30LB32*/ 03732000
*       /* PARTIALLY CREATED ACTIVE VOLUME AND THEN          @Y30LB32*/ 03733000
*       /* CALL SCRATCH ROUTINE                              @Y30LB32*/ 03734000
*       /*                                                           */ 03735000
*       /*************************************************************/ 03736000
*                                                                  0938 03737000
*       DEFLSTP=ADDR(PARMLST2);     /*                       @Y30LB32*/ 03738000
         LA    @15,PARMLST2                                        0938 03739000
         ST    @15,DEFLSTP                                         0938 03740000
*       DEFVFLG=OFF;                /*                       @Y30LB32*/ 03741000
         MVI   DEFVFLG(@15),B'00000000'                            0939 03742000
*       DEFVELM=ON;                 /*                       @Y30LB32*/ 03743000
         OI    DEFVELM(@15),B'01000000'                            0940 03744000
*       CALL SCRATCH;               /*                       @Y30LB32*/ 03745000
         BAL   @14,SCRATCH                                         0941 03746000
*       RESPECIFY                                                  0942 03747000
*         RTNREG RSTD;                                             0942 03748000
*       TESTRC=RTNREG;                                             0943 03749000
         LR    TESTRC,RTNREG                                       0943 03750000
*       RESPECIFY                                                  0944 03751000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 03752000
*       UPDCOND=MAX(UPDCOND,TESTRC);/*                       @Y30LB32*/ 03753000
         CR    UPDCOND,TESTRC                                      0945 03754000
         BNL   *+6                                                      03755000
         LR    UPDCOND,TESTRC                                      0945 03756000
*     END;                          /*                       @Y30LB32*/ 03757000
*                                                                  0946 03758000
*   /*****************************************************************/ 03759000
*   /*                                                               */ 03760000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 03761000
*   /*                                                               */ 03762000
*   /*****************************************************************/ 03763000
*                                                                  0947 03764000
*   REG14=RETADDR2;                 /*                       @Y30LB32*/ 03765000
@RF00936 L     REG14,RETADDR2                                      0947 03766000
*   RETURN CODE(UPDCOND);           /*                       @Y30LB32*/ 03767000
         LR    @15,UPDCOND                                         0948 03768000
@EL00011 DS    0H                                                  0948 03769000
@EF00011 DS    0H                                                  0948 03770000
@ER00011 BR    @14                                                 0948 03771000
*   END UPDATE;                     /*                       @Y30LB32*/ 03772000
*                                                                  0950 03773000
*/********************************************************************/ 03774000
*/*                                                          @Y30LB32*/ 03775000
*/*  PROCEDURE NAME - MNTPROC                                @Y30LB32*/ 03776000
*/*                                                          @Y30LB32*/ 03777000
*/*  FUNCTION - MOUNTS AND RESERVES VOLUME TO INITIALIZE     @Y30LB32*/ 03778000
*/*             VOLUME WITH LABEL AND EMPTY VTOC             @Y30LB32*/ 03779000
*/*                                                          @Y30LB32*/ 03780000
*/*  INPUT - DEFLIST, MDAGL                                  @Y30LB32*/ 03781000
*/*                                                          @Y30LB32*/ 03782000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 03783000
*/*             RETURN CODE = 0 - VOLUME MOUNTED             @Y30LB32*/ 03784000
*/*             RETURN CODE = 4 - VOLUME NOT MOUNTED         @Y30LB32*/ 03785000
*/*                                                          @Y30LB32*/ 03786000
*/********************************************************************/ 03787000
*                                                                  0950 03788000
*MNTPROC:                                                          0950 03789000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 03790000
*                                                                  0950 03791000
MNTPROC  DS    0H                                                  0951 03792000
*   /*****************************************************************/ 03793000
*   /*                                                               */ 03794000
*   /* SAVE CALLERS RETURN ADDRESS AND SET CONDITION CODE    @Y30LB32*/ 03795000
*   /* TO ZERO AND RESET PTR TO DEFLIST PARM AREA            @Y30LB32*/ 03796000
*   /*                                                               */ 03797000
*   /*****************************************************************/ 03798000
*                                                                  0951 03799000
*   RETADDR3=REG14;                 /*                       @Y30LB32*/ 03800000
         LR    RETADDR3,REG14                                      0951 03801000
*   OLDERID2=NEWERID2;                                             0952 03802000
         L     @02,@PC00001                                        0952 03803000
         L     @15,GDTTR2(,@02)                                    0952 03804000
         MVC   @TS00001(95),NEWERID2(@15)                          0952 03805000
         MVC   OLDERID2(95,@15),@TS00001                           0952 03806000
*   NEWID2='CVMP';                  /*                       @Y30LB32*/ 03807000
         MVC   NEWID2(4,@15),@CC01611                              0953 03808000
*   MNTCOND=0;                      /*                       @Y30LB32*/ 03809000
         SLR   MNTCOND,MNTCOND                                     0954 03810000
*   DEFLSTP=ADDR(PARMLST);          /*                       @Y30LB32*/ 03811000
*                                                                  0955 03812000
         LA    @15,PARMLST                                         0955 03813000
         ST    @15,DEFLSTP                                         0955 03814000
*   /*****************************************************************/ 03815000
*   /*                                                               */ 03816000
*   /* ACCESS VOLUME SERIAL NUMBER FROM DEFLIST AND PLACE    @Y30LB32*/ 03817000
*   /* IN MDAGL, SET FLAG FOR NEW VOLUME AND ZERO ENQ FLAG   @Y30LB32*/ 03818000
*   /*                                                               */ 03819000
*   /*****************************************************************/ 03820000
*                                                                  0956 03821000
*   MDLABEL=DEFVOLD;                /*                       @Y30LB32*/ 03822000
         L     @14,MDAGLPTR                                        0956 03823000
         MVC   MDLABEL(6,@14),DEFVOLD(@15)                         0956 03824000
*   MDNEWVOL=ON;                    /*                       @Y30LB32*/ 03825000
*   MDENQ=OFF;                      /*                       @Y30LB32*/ 03826000
*                                                                  0958 03827000
         OI    MDNEWVOL(@14),B'10000000'                           0958 03828000
         NI    MDENQ(@14),B'11110111'                              0958 03829000
*   /*****************************************************************/ 03830000
*   /*                                                               */ 03831000
*   /* ISSUE UMSSUNIT (MOUNT) TO MOUNT VOLUME                @Y30LB32*/ 03832000
*   /*                                                               */ 03833000
*   /*****************************************************************/ 03834000
*                                                                  0959 03835000
*   CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                     @Y30LB32*/ 03836000
         ST    @02,@AL00001                                        0959 03837000
         LA    @15,MOUNT                                           0959 03838000
         ST    @15,@AL00001+4                                      0959 03839000
         ST    @14,@AL00001+8                                      0959 03840000
         MVI   @AL00001+8,X'80'                                    0959 03841000
         L     @15,GDTUNT(,@02)                                    0959 03842000
         LA    @01,@AL00001                                        0959 03843000
         BALR  @14,@15                                             0959 03844000
*   RESPECIFY                                                      0960 03845000
*     RTNREG RSTD;                                                 0960 03846000
*   TESTRC=RTNREG;                                                 0961 03847000
         LR    TESTRC,RTNREG                                       0961 03848000
*   RESPECIFY                                                      0962 03849000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 03850000
*                                                                  0962 03851000
*   /*****************************************************************/ 03852000
*   /*                                                               */ 03853000
*   /* CHECK IF MOUNT WAS SUCCESSFUL. IF SUCCESSFUL ISSUE    @Y30LB32*/ 03854000
*   /* URESERVE UMACRO TO GAIN EXCLUSIVE CONTROL OF VOLUME   @Y30LB32*/ 03855000
*   /*                                                               */ 03856000
*   /*****************************************************************/ 03857000
*                                                                  0963 03858000
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/ 03859000
         LTR   TESTRC,TESTRC                                       0963 03860000
         BNZ   @RF00963                                            0963 03861000
*     DO;                           /*                       @Y30LB32*/ 03862000
*       TYPENAME=RESERVE;           /*                       @Y30LB32*/ 03863000
         MVC   TYPENAME(8),@CC01491                                0965 03864000
*       CALL IDCSARV0(GDTTBL,EXCL,WAIT,UCBPTR,SYSZAMS,RNAME);/*    0966 03865000
*                                                            @Y30LB32*/ 03866000
         L     @15,@PC00001                                        0966 03867000
         ST    @15,@AL00001                                        0966 03868000
         LA    @14,EXCL                                            0966 03869000
         ST    @14,@AL00001+4                                      0966 03870000
         LA    @14,WAIT                                            0966 03871000
         ST    @14,@AL00001+8                                      0966 03872000
         LA    @14,UCBPTR                                          0966 03873000
         ST    @14,@AL00001+12                                     0966 03874000
         LA    @14,@CC01493                                        0966 03875000
         ST    @14,@AL00001+16                                     0966 03876000
         LA    @14,RNAME                                           0966 03877000
         ST    @14,@AL00001+20                                     0966 03878000
         MVI   @AL00001+20,X'80'                                   0966 03879000
         L     @15,GDTRSV(,@15)                                    0966 03880000
         LA    @01,@AL00001                                        0966 03881000
         BALR  @14,@15                                             0966 03882000
*     END;                          /*                       @Y30LB32*/ 03883000
*                                                                  0967 03884000
*   /*****************************************************************/ 03885000
*   /*                                                               */ 03886000
*   /* SET CONDITION CODE WITH ERROR CODE                    @Y30LB32*/ 03887000
*   /*                                                               */ 03888000
*   /*****************************************************************/ 03889000
*                                                                  0968 03890000
*   ELSE                            /*                       @Y30LB32*/ 03891000
*     MNTCOND=LASTCC04;             /*                       @Y30LB32*/ 03892000
*                                                                  0968 03893000
         B     @RC00963                                            0968 03894000
@RF00963 LA    MNTCOND,4                                           0968 03895000
*   /*****************************************************************/ 03896000
*   /*                                                               */ 03897000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN TO          @Y30LB32*/ 03898000
*   /* CALLER                                                @Y30LB32*/ 03899000
*   /*                                                               */ 03900000
*   /*****************************************************************/ 03901000
*                                                                  0969 03902000
*   REG14=RETADDR3;                 /*                       @Y30LB32*/ 03903000
@RC00963 LR    REG14,RETADDR3                                      0969 03904000
*   RETURN CODE(MNTCOND);           /*                       @Y30LB32*/ 03905000
         LR    @15,MNTCOND                                         0970 03906000
@EL00012 DS    0H                                                  0970 03907000
@EF00012 DS    0H                                                  0970 03908000
@ER00012 BR    @14                                                 0970 03909000
*   END MNTPROC;                    /*                       @Y30LB32*/ 03910000
*                                                                  0972 03911000
*/********************************************************************/ 03912000
*/*                                                          @Y30LB32*/ 03913000
*/*  PROCEDURE NAME - INITPROC                               @Y30LB32*/ 03914000
*/*                                                          @Y30LB32*/ 03915000
*/*  FUNCTION - UPDATES NEW VOLUME WITH LABEL AND            @Y30LB32*/ 03916000
*/*             VTOC. MODIFIES VOLUME RECORD TO TURN THE     @Y30LB32*/ 03917000
*/*             INCOMPLETE CREATE FLAG OFF. WRITES MESSAGE   @Y30LB32*/ 03918000
*/*             IDC2684I IF VOLUME IS NOT INITIALIZED AND    @Y30LB32*/ 03919000
*/*             MESSAGE IDC2688I IF INCOMPLETE CREATE FLAG   @Y30LB32*/ 03920000
*/*             IS NOT TURNED OFF. ISSUES UEXCP TO CLOSE DCB.@Y30LB32*/ 03921000
*/*                                                          @Y30LB32*/ 03922000
*/*  INPUT - VS2AGL, MVR, DEFLIST                            @Y30LB32*/ 03923000
*/*                                                          @Y30LB32*/ 03924000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 03925000
*/*             RETURN CODE = 0 - NEW VOLUME INITIALIZED     @Y30LB32*/ 03926000
*/*             RETURN CODE = 4 - NEW VOLUME NOT INITIALIZED @Y30LB32*/ 03927000
*/*                                                          @Y30LB32*/ 03928000
*/********************************************************************/ 03929000
*                                                                  0972 03930000
*INITPROC:                                                         0972 03931000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 03932000
*                                                                  0972 03933000
INITPROC DS    0H                                                  0973 03934000
*   /*****************************************************************/ 03935000
*   /*                                                               */ 03936000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 03937000
*   /* TO ZERO                                               @Y30LB32*/ 03938000
*   /*                                                               */ 03939000
*   /*****************************************************************/ 03940000
*                                                                  0973 03941000
*   RETADDR3=REG14;                 /*                       @Y30LB32*/ 03942000
         LR    RETADDR3,REG14                                      0973 03943000
*   OLDERID2=NEWERID2;                                             0974 03944000
         L     @02,@PC00001                                        0974 03945000
         L     @15,GDTTR2(,@02)                                    0974 03946000
         MVC   @TS00001(95),NEWERID2(@15)                          0974 03947000
         MVC   OLDERID2(95,@15),@TS00001                           0974 03948000
*   NEWID2='CVIP';                  /*                       @Y30LB32*/ 03949000
         MVC   NEWID2(4,@15),@CC01615                              0975 03950000
*   INITCOND=0;                     /*                       @Y30LB32*/ 03951000
         SLR   INITCOND,INITCOND                                   0976 03952000
*   IOCTLBKP=NULLPTR;               /*                       @Y30LB32*/ 03953000
*                                                                  0977 03954000
         SLR   @15,@15                                             0977 03955000
         ST    @15,IOCTLBKP                                        0977 03956000
*   /*****************************************************************/ 03957000
*   /*                                                               */ 03958000
*   /* THE INITVOL SERVICE ROUTINE IS INVOKED TO INITIALIZE  @Y30LB32*/ 03959000
*   /* NEW VOLUME WITH VOLUME LABEL AND VTOC                 @Y30LB32*/ 03960000
*   /*                                                               */ 03961000
*   /*****************************************************************/ 03962000
*                                                                  0978 03963000
*   CALL IDCSACL0(GDTTBL,'IDCVS02 ',INITVOL,VS2AGL);/*       @Y30LB32*/ 03964000
         ST    @02,@AL00001                                        0978 03965000
         LA    @15,@CC01616                                        0978 03966000
         ST    @15,@AL00001+4                                      0978 03967000
         LA    @15,INITVOL                                         0978 03968000
         ST    @15,@AL00001+8                                      0978 03969000
         L     @01,VSAGLPTR                                        0978 03970000
         ST    @01,@AL00001+12                                     0978 03971000
         MVI   @AL00001+12,X'80'                                   0978 03972000
         L     @15,GDTCAL(,@02)                                    0978 03973000
         LA    @01,@AL00001                                        0978 03974000
         BALR  @14,@15                                             0978 03975000
*   RESPECIFY                                                      0979 03976000
*     RTNREG RSTD;                                                 0979 03977000
*   TESTRC=RTNREG;                                                 0980 03978000
         LR    TESTRC,RTNREG                                       0980 03979000
*   RESPECIFY                                                      0981 03980000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 03981000
*                                                                  0981 03982000
*   /*****************************************************************/ 03983000
*   /*                                                               */ 03984000
*   /* CHECK IF INITVOL WAS SUCCESSFUL                       @Y30LB32*/ 03985000
*   /*                                                               */ 03986000
*   /*****************************************************************/ 03987000
*                                                                  0982 03988000
*   IF TESTRC=0 THEN                /*                       @Y30LB32*/ 03989000
         SLR   @02,@02                                             0982 03990000
         CR    TESTRC,@02                                          0982 03991000
         BNE   @RF00982                                            0982 03992000
*     DO;                           /*                       @Y30LB32*/ 03993000
*                                                                  0983 03994000
*       /*************************************************************/ 03995000
*       /*                                                           */ 03996000
*       /* INITIALIZE PARM LIST MVR AND ISSUE MSVC MACRO     @Y30LB32*/ 03997000
*       /* TO RESET INCOMPLETE VOLUME CREATION FLAG          @Y30LB32*/ 03998000
*       /*                                                           */ 03999000
*       /*************************************************************/ 04000000
*                                                                  0984 04001000
*       MVRBVOL=VOLSER;             /*                       @Y30LB32*/ 04002000
         L     @03,MVRPTR                                          0984 04003000
         MVC   MVRBVOL(6,@03),VOLSER                               0984 04004000
*       MVRFLBAS=ON;                /*                       @Y30LB32*/ 04005000
*                                                                  0985 04006000
         OI    MVRFLBAS(@03),B'00100000'                           0985 04007000
*       /*************************************************************/ 04008000
*       /*                                                           */ 04009000
*       /* ISSUE USSC UMACRO TO INVOKE EXECUTE FORM OF       @Y30LB32*/ 04010000
*       /* MSVC MODIFY VOLUME RECORD MACRO                   @Y30LB32*/ 04011000
*       /*                                                           */ 04012000
*       /*************************************************************/ 04013000
*                                                                  0986 04014000
*       IF GDTDBG=NULLPTR THEN                                     0986 04015000
         L     @03,@PC00001                                        0986 04016000
         C     @02,GDTDBG(,@03)                                    0986 04017000
         BE    @RT00986                                            0986 04018000
*         ;                                                        0987 04019000
*       ELSE                                                       0988 04020000
*         DO;                                                      0988 04021000
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB32*/ 04022000
         LA    DMPINDEX,DUMPAREA                                   0989 04023000
*           DMPITMNM='MVR';                                        0990 04024000
         MVI   DMPITMNM+3(DMPINDEX),C' '                           0990 04025000
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         0990 04026000
         MVC   DMPITMNM(3,DMPINDEX),@CC01617                       0990 04027000
*           DMPITMPT=ADDR(MVR);                                    0991 04028000
         L     @03,MVRPTR                                          0991 04029000
         ST    @03,DMPITMPT(,DMPINDEX)                             0991 04030000
*           DMPITMLN=LENGTH(MVR);                                  0992 04031000
         MVC   DMPITMLN(2,DMPINDEX),@CH01680                       0992 04032000
*           DMPITMTP='H';                                          0993 04033000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0993 04034000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0994 04035000
*                                                                  0994 04036000
         AL    DMPINDEX,@CF00508                                   0994 04037000
*           /*********************************************************/ 04038000
*           /*                                                       */ 04039000
*           /*                                               @Y30LB32*/ 04040000
*           /*                                                       */ 04041000
*           /*********************************************************/ 04042000
*                                                                  0995 04043000
*           DMPTRM=DMPTRMVL;                                       0995 04044000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0995 04045000
*         END;                      /*                       @Y30LB32*/ 04046000
*       IF GDTDBG=NULLPTR THEN                                     0997 04047000
@RT00986 L     @15,@PC00001                                        0997 04048000
         L     @15,GDTDBG(,@15)                                    0997 04049000
         LTR   @15,@15                                             0997 04050000
         BZ    @RT00997                                            0997 04051000
*         ;                                                        0998 04052000
*       ELSE                                                       0999 04053000
*         CALL IDCDB010(GDTTBL,'CVMR',ADDR(DUMPAREA));/*     @Y30LB32*/ 04054000
         L     @15,@PC00001                                        0999 04055000
         ST    @15,@AL00001                                        0999 04056000
         LA    @14,@CC01618                                        0999 04057000
         ST    @14,@AL00001+4                                      0999 04058000
         LA    @14,DUMPAREA                                        0999 04059000
         ST    @14,@AFTEMPS+8                                      0999 04060000
         LA    @14,@AFTEMPS+8                                      0999 04061000
         ST    @14,@AL00001+8                                      0999 04062000
         MVI   @AL00001+8,X'80'                                    0999 04063000
         L     @15,GDTDBG(,@15)                                    0999 04064000
         LA    @01,@AL00001                                        0999 04065000
         BALR  @14,@15                                             0999 04066000
*       CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASONCD);/*        @Y30LB32*/ 04067000
@RT00997 L     @02,@PC00001                                        1000 04068000
         ST    @02,@AL00001                                        1000 04069000
         LA    @15,VVIC                                            1000 04070000
         ST    @15,@AL00001+4                                      1000 04071000
         LA    @15,MVRPTR                                          1000 04072000
         ST    @15,@AL00001+8                                      1000 04073000
         LA    @15,REASONCD                                        1000 04074000
         ST    @15,@AL00001+12                                     1000 04075000
         MVI   @AL00001+12,X'80'                                   1000 04076000
         L     @15,GDTSSC(,@02)                                    1000 04077000
         LA    @01,@AL00001                                        1000 04078000
         BALR  @14,@15                                             1000 04079000
*       RESPECIFY                                                  1001 04080000
*         RTNREG RSTD;                                             1001 04081000
*       TESTRC=RTNREG;                                             1002 04082000
         LR    TESTRC,RTNREG                                       1002 04083000
*       RESPECIFY                                                  1003 04084000
*         RTNREG UNRSTD;            /*                       @Y30LB32*/ 04085000
*                                                                  1003 04086000
*       /*************************************************************/ 04087000
*       /*                                                           */ 04088000
*       /* CHECK IF MODIFY WAS SUCCESSFUL. IF NOT            @Y30LB32*/ 04089000
*       /* SUCCESSFUL INVOKE SSCMSG SUBROUTINE TO            @Y30LB32*/ 04090000
*       /* WRITE MESSAGE EXPLAINING REASON FOR FAILURE       @Y30LB32*/ 04091000
*       /*                                                           */ 04092000
*       /*************************************************************/ 04093000
*                                                                  1004 04094000
*       IF TESTRC^=0 THEN           /*                       @Y30LB32*/ 04095000
         LTR   TESTRC,TESTRC                                       1004 04096000
         BZ    @RF01004                                            1004 04097000
*         DO;                       /*                       @Y30LB32*/ 04098000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/ 04099000
*                                                                  1006 04100000
         LA    @04,REASONCD                                        1006 04101000
         ST    @04,@AL00001                                        1006 04102000
         LA    @01,@AL00001                                        1006 04103000
         BAL   @14,SSCMSG                                          1006 04104000
*           /*********************************************************/ 04105000
*           /*                                                       */ 04106000
*           /* WRITE SECONDARY MESSAGE IDC2688I STATING      @Y30LB32*/ 04107000
*           /* INCOMPLETE VOLUME CREATION FLAG NOT RESET     @Y30LB32*/ 04108000
*           /*                                                       */ 04109000
*           /*********************************************************/ 04110000
*                                                                  1007 04111000
*           PRINTTAB=''B;           /*                       @Y30LB32*/ 04112000
         XC    PRINTTAB(36),PRINTTAB                               1007 04113000
*           DARGSMOD=CRVMSG;        /*                       @Y30LB32*/ 04114000
         L     @15,DDSTRU                                          1008 04115000
         MVC   DARGSMOD(3,@15),@CC01462                            1008 04116000
*           DARGSENT=MSG2688I;      /*                       @Y30LB32*/ 04117000
         MVI   DARGSENT(@15),X'09'                                 1009 04118000
*           DARGDBP=ADDR(VOLSER);   /*                       @Y30LB32*/ 04119000
         LA    @14,VOLSER                                          1010 04120000
         ST    @14,DARGDBP(,@15)                                   1010 04121000
*           DARGILP=LENGTH(VOLSER); /*                       @Y30LB32*/ 04122000
         MVC   DARGILP(2,@15),@CH00158                             1011 04123000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB32*/ 04124000
*                                                                  1012 04125000
         L     @15,@PC00001                                        1012 04126000
         ST    @15,@AL00001                                        1012 04127000
         LA    @14,@CF00116                                        1012 04128000
         ST    @14,@AL00001+4                                      1012 04129000
         LA    @14,DDSTRU                                          1012 04130000
         ST    @14,@AL00001+8                                      1012 04131000
         MVI   @AL00001+8,X'80'                                    1012 04132000
         L     @15,GDTPRT(,@15)                                    1012 04133000
         LA    @01,@AL00001                                        1012 04134000
         BALR  @14,@15                                             1012 04135000
*           /*********************************************************/ 04136000
*           /*                                                       */ 04137000
*           /* SET CONDITION CODE WITH ERROR CODE            @Y30LB32*/ 04138000
*           /*                                                       */ 04139000
*           /*********************************************************/ 04140000
*                                                                  1013 04141000
*           INITCOND=LASTCC04;      /*                       @Y30LB32*/ 04142000
         LA    INITCOND,4                                          1013 04143000
*         END;                      /*                       @Y30LB32*/ 04144000
*     END;                          /*                       @Y30LB32*/ 04145000
*                                                                  1015 04146000
*   /*****************************************************************/ 04147000
*   /*                                                               */ 04148000
*   /* IF INITVOL ROUTINE WAS NOT SUCCESSFUL, WRITE          @Y30LB32*/ 04149000
*   /* MESSAGE IDC2684I STATING VOLUME NOT INITIALIZED       @Y30LB32*/ 04150000
*   /*                                                               */ 04151000
*   /*****************************************************************/ 04152000
*                                                                  1016 04153000
*   ELSE                            /*                       @Y30LB32*/ 04154000
*     DO;                           /*                       @Y30LB32*/ 04155000
         B     @RC00982                                            1016 04156000
@RF00982 DS    0H                                                  1017 04157000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 04158000
         XC    PRINTTAB(36),PRINTTAB                               1017 04159000
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/ 04160000
         L     @15,DDSTRU                                          1018 04161000
         MVC   DARGSMOD(3,@15),@CC01462                            1018 04162000
*       DARGSENT=MSG2684I;          /*                       @Y30LB32*/ 04163000
         MVI   DARGSENT(@15),X'05'                                 1019 04164000
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/ 04165000
         LA    @14,VOLSER                                          1020 04166000
         ST    @14,DARGDBP(,@15)                                   1020 04167000
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/ 04168000
         MVC   DARGILP(2,@15),@CH00158                             1021 04169000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 04170000
*                                                                  1022 04171000
         L     @15,@PC00001                                        1022 04172000
         ST    @15,@AL00001                                        1022 04173000
         LA    @14,@CF00116                                        1022 04174000
         ST    @14,@AL00001+4                                      1022 04175000
         LA    @14,DDSTRU                                          1022 04176000
         ST    @14,@AL00001+8                                      1022 04177000
         MVI   @AL00001+8,X'80'                                    1022 04178000
         L     @15,GDTPRT(,@15)                                    1022 04179000
         LA    @01,@AL00001                                        1022 04180000
         BALR  @14,@15                                             1022 04181000
*       /*************************************************************/ 04182000
*       /*                                                           */ 04183000
*       /* SET CONDITION CODE WITH ERROR CODE                @Y30LB32*/ 04184000
*       /*                                                           */ 04185000
*       /*************************************************************/ 04186000
*                                                                  1023 04187000
*       INITCOND=LASTCC04;          /*                       @Y30LB32*/ 04188000
         LA    INITCOND,4                                          1023 04189000
*     END;                          /*                       @Y30LB32*/ 04190000
*                                                                  1024 04191000
*   /*****************************************************************/ 04192000
*   /*                                                               */ 04193000
*   /* CHECK POINTER TO IO CONTROL BLOCK. IF NON             @Y30LB32*/ 04194000
*   /* ZERO ISSUE UEXCP (CLOSE) TO CLOSE DCB                 @Y30LB32*/ 04195000
*   /*                                                               */ 04196000
*   /*****************************************************************/ 04197000
*                                                                  1025 04198000
*   IF IOCTLBKP^=NULLPTR THEN       /*                       @Y30LB32*/ 04199000
@RC00982 L     @15,IOCTLBKP                                        1025 04200000
         LTR   @15,@15                                             1025 04201000
         BZ    @RF01025                                            1025 04202000
*     DO;                           /*                       @Y30LB32*/ 04203000
*       CALL IDCIO050(GDTTBL,CLOSE,IOCTLBKP);/*              @Y30LB32*/ 04204000
         L     @15,@PC00001                                        1027 04205000
         ST    @15,@AL00001                                        1027 04206000
         LA    @14,CLOSE                                           1027 04207000
         ST    @14,@AL00001+4                                      1027 04208000
         LA    @14,IOCTLBKP                                        1027 04209000
         ST    @14,@AL00001+8                                      1027 04210000
         MVI   @AL00001+8,X'80'                                    1027 04211000
         L     @15,GDTEXP(,@15)                                    1027 04212000
         LA    @01,@AL00001                                        1027 04213000
         BALR  @14,@15                                             1027 04214000
*     END;                          /*                       @Y30LB32*/ 04215000
*                                                                  1028 04216000
*   /*****************************************************************/ 04217000
*   /*                                                               */ 04218000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB32*/ 04219000
*   /* TO THE CALLER                                         @Y30LB32*/ 04220000
*   /*                                                               */ 04221000
*   /*****************************************************************/ 04222000
*                                                                  1029 04223000
*   REG14=RETADDR3;                 /*                       @Y30LB32*/ 04224000
@RF01025 LR    REG14,RETADDR3                                      1029 04225000
*   RETURN CODE(INITCOND);          /*                       @Y30LB32*/ 04226000
         LR    @15,INITCOND                                        1030 04227000
@EL00013 DS    0H                                                  1030 04228000
@EF00013 DS    0H                                                  1030 04229000
@ER00013 BR    @14                                                 1030 04230000
*   END INITPROC;                   /*                       @Y30LB32*/ 04231000
*                                                                  1032 04232000
*/********************************************************************/ 04233000
*/*                                                          @Y30LB32*/ 04234000
*/*  PROCEDURE NAME - DMNTPROC                               @Y30LB32*/ 04235000
*/*                                                          @Y30LB32*/ 04236000
*/*  FUNCTION - DEMOUNTS NEWLY CREATED VOLUME AND ISSUES     @Y30LB32*/ 04237000
*/*             UDEQ TO RELEASE CONTROL GAINED WITH URESERVE @Y30LB32*/ 04238000
*/*                                                          @Y30LB32*/ 04239000
*/*  INPUT - CKAGL                                           @Y30LB32*/ 04240000
*/*                                                          @Y30LB32*/ 04241000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 04242000
*/*             RETURN CODE = 0 - NEW VOLUME DEMOUNTED       @Y30LB32*/ 04243000
*/*             RETURN CODE = 4 - NEW VOLUME NOT DEMOUNTED   @Y30LB32*/ 04244000
*/*                                                          @Y30LB32*/ 04245000
*/********************************************************************/ 04246000
*                                                                  1032 04247000
*DMNTPROC:                                                         1032 04248000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 04249000
*                                                                  1032 04250000
DMNTPROC DS    0H                                                  1033 04251000
*   /*****************************************************************/ 04252000
*   /*                                                               */ 04253000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 04254000
*   /* TO ZERO                                               @Y30LB32*/ 04255000
*   /*                                                               */ 04256000
*   /*****************************************************************/ 04257000
*                                                                  1033 04258000
*   RETADDR3=REG14;                 /*                       @Y30LB32*/ 04259000
         LR    RETADDR3,REG14                                      1033 04260000
*   OLDERID2=NEWERID2;                                             1034 04261000
         L     @02,@PC00001                                        1034 04262000
         L     @15,GDTTR2(,@02)                                    1034 04263000
         MVC   @TS00001(95),NEWERID2(@15)                          1034 04264000
         MVC   OLDERID2(95,@15),@TS00001                           1034 04265000
*   NEWID2='CVDM';                  /*                       @Y30LB32*/ 04266000
         MVC   NEWID2(4,@15),@CC01622                              1035 04267000
*   DMNTCOND=0;                     /*                       @Y30LB32*/ 04268000
*                                                                  1036 04269000
         SLR   DMNTCOND,DMNTCOND                                   1036 04270000
*   /*****************************************************************/ 04271000
*   /*                                                               */ 04272000
*   /* ISSUE UDEQ UMACRO TO RELEASE CONTROL OF VOLUME        @ZA05122*/ 04273000
*   /* GAINED WITH RESERVE                                   @ZA05122*/ 04274000
*   /*                                                               */ 04275000
*   /*****************************************************************/ 04276000
*                                                                  1037 04277000
*   TYPENAME=RESERVE;               /*                       @ZA05119*/ 04278000
         MVC   TYPENAME(8),@CC01491                                1037 04279000
*   CALL IDCSADQ0(GDTTBL,SYSZAMS,RNAME);/*                   @ZA05122*/ 04280000
*                                                                  1038 04281000
         ST    @02,@AL00001                                        1038 04282000
         LA    @15,@CC01493                                        1038 04283000
         ST    @15,@AL00001+4                                      1038 04284000
         LA    @15,RNAME                                           1038 04285000
         ST    @15,@AL00001+8                                      1038 04286000
         MVI   @AL00001+8,X'80'                                    1038 04287000
         L     @15,GDTDEQ(,@02)                                    1038 04288000
         LA    @01,@AL00001                                        1038 04289000
         BALR  @14,@15                                             1038 04290000
*   /*****************************************************************/ 04291000
*   /*                                                               */ 04292000
*   /* RESET MDNEWVOL FLAG TO ZERO DURING DEMOUNT.           @YD00175*/ 04293000
*   /* SET MDDEQ FLAG TO CAUSE DEQUEUE OF VOLSER             @YD00175*/ 04294000
*   /* SINCE THIS IS THE FINAL DEMOUNT.                      @YD00175*/ 04295000
*   /*                                                               */ 04296000
*   /*****************************************************************/ 04297000
*                                                                  1039 04298000
*   MDWAIT=ON;                      /*                       @ZM04313*/ 04299000
*   MDDEQ=ON;                       /*                       @YD00175*/ 04300000
*   MDNEWVOL=OFF;                   /*                       #Y30LB32*/ 04301000
*                                                                  1041 04302000
         L     @02,MDAGLPTR                                        1041 04303000
         OI    MDWAIT(@02),B'00010100'                             1041 04304000
         NI    MDNEWVOL(@02),B'01111111'                           1041 04305000
*   /*****************************************************************/ 04306000
*   /*                                                               */ 04307000
*   /* ISSUE DEMOUNT VERSION OF UMSSUNIT UMACRO TO DEMOUNT   #Y30LB32*/ 04308000
*   /* VOLUME                                                #Y30LB32*/ 04309000
*   /*                                                               */ 04310000
*   /*****************************************************************/ 04311000
*                                                                  1042 04312000
*   CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*                   #Y30LB32*/ 04313000
         L     @15,@PC00001                                        1042 04314000
         ST    @15,@AL00001                                        1042 04315000
         LA    @14,DEMOUNT                                         1042 04316000
         ST    @14,@AL00001+4                                      1042 04317000
         ST    @02,@AL00001+8                                      1042 04318000
         MVI   @AL00001+8,X'80'                                    1042 04319000
         L     @15,GDTUNT(,@15)                                    1042 04320000
         LA    @01,@AL00001                                        1042 04321000
         BALR  @14,@15                                             1042 04322000
*   RESPECIFY                                                      1043 04323000
*     RTNREG RSTD;                                                 1043 04324000
*   TESTRC=RTNREG;                                                 1044 04325000
         LR    TESTRC,RTNREG                                       1044 04326000
*   RESPECIFY                                                      1045 04327000
*     RTNREG UNRSTD;                /*                       #Y30LB32*/ 04328000
*                                                                  1045 04329000
*   /*****************************************************************/ 04330000
*   /*                                                               */ 04331000
*   /* CHECK IF DEMOUNT WAS SUCCESSFUL. IF NOT SUCCESSFUL    #Y30LB32*/ 04332000
*   /* SET CONDITION CODE WITH ERROR CODE                    #Y30LB32*/ 04333000
*   /*                                                               */ 04334000
*   /*****************************************************************/ 04335000
*                                                                  1046 04336000
*   IF TESTRC^=0 THEN               /*                       #Y30LB32*/ 04337000
         LTR   TESTRC,TESTRC                                       1046 04338000
         BZ    @RF01046                                            1046 04339000
*     DMNTCOND=LASTCC04;            /*                       #Y30LB32*/ 04340000
*                                                                  1047 04341000
         LA    DMNTCOND,4                                          1047 04342000
*   /*****************************************************************/ 04343000
*   /*                                                               */ 04344000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN TO THE      #Y30LB32*/ 04345000
*   /* CALLER                                                #Y30LB32*/ 04346000
*   /*                                                               */ 04347000
*   /*****************************************************************/ 04348000
*                                                                  1048 04349000
*   REG14=RETADDR3;                 /*                       #Y30LB32*/ 04350000
@RF01046 LR    REG14,RETADDR3                                      1048 04351000
*   RETURN CODE(DMNTCOND);          /*                       #Y30LB32*/ 04352000
         LR    @15,DMNTCOND                                        1049 04353000
@EL00014 DS    0H                                                  1049 04354000
@EF00014 DS    0H                                                  1049 04355000
@ER00014 BR    @14                                                 1049 04356000
*   END DMNTPROC;                   /*                       #Y30LB32*/ 04357000
*                                                                  1051 04358000
*/********************************************************************/ 04359000
*/*                                                          #Y30LB32*/ 04360000
*/*  PROCEDURE NAME - ROPROC                                 #Y30LB32*/ 04361000
*/*                                                          #Y30LB32*/ 04362000
*/*  FUNCTION - SETS READWRITE ATTRIBUTE TO READONLY. ISSUES #Y30LB32*/ 04363000
*/*             MESSAGE IDC2091I IF READONLY FLAG IS NOT SET #Y30LB32*/ 04364000
*/*                                                          #Y30LB32*/ 04365000
*/*  INPUT - DEFLIST                                         #Y30LB32*/ 04366000
*/*                                                          #Y30LB32*/ 04367000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     #Y30LB32*/ 04368000
*/*             RETURN CODE = 0 - READWRITE FLAG RESET       #Y30LB32*/ 04369000
*/*             RETURN CODE = 4 - READWRITE FLAG NOT RESET   #Y30LB32*/ 04370000
*/*                                                          #Y30LB32*/ 04371000
*/********************************************************************/ 04372000
*                                                                  1051 04373000
*ROPROC:                                                           1051 04374000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB32*/ 04375000
*                                                                  1051 04376000
ROPROC   DS    0H                                                  1052 04377000
*   /*****************************************************************/ 04378000
*   /*                                                               */ 04379000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  #Y30LB32*/ 04380000
*   /* TO ZERO                                               #Y30LB32*/ 04381000
*   /*                                                               */ 04382000
*   /*****************************************************************/ 04383000
*                                                                  1052 04384000
*   RETADDR2=REG14;                 /*                       #Y30LB32*/ 04385000
         ST    REG14,RETADDR2                                      1052 04386000
*   OLDERID2=NEWERID2;                                             1053 04387000
         L     @06,@PC00001                                        1053 04388000
         L     @05,GDTTR2(,@06)                                    1053 04389000
         MVC   @TS00001(95),NEWERID2(@05)                          1053 04390000
         MVC   OLDERID2(95,@05),@TS00001                           1053 04391000
*   NEWID2='CVRO';                  /*                       #Y30LB32*/ 04392000
         MVC   NEWID2(4,@05),@CC01626                              1054 04393000
*   ROCOND=0;                       /*                       #Y30LB32*/ 04394000
*                                                                  1055 04395000
         SLR   ROCOND,ROCOND                                       1055 04396000
*   /*****************************************************************/ 04397000
*   /*                                                               */ 04398000
*   /* ZERO FLAG BYTE AND SET FLAG BITS IN DEFLIST TO CHANGE #Y30LB32*/ 04399000
*   /* VOLUME STATUS FROM READWRITE TO READONLY              #Y30LB32*/ 04400000
*   /*                                                               */ 04401000
*   /*****************************************************************/ 04402000
*                                                                  1056 04403000
*   DEFLSTP=ADDR(PARMLST2);         /*                       #Y30LB32*/ 04404000
         LA    @05,PARMLST2                                        1056 04405000
         ST    @05,DEFLSTP                                         1056 04406000
*   DEFVFLG=''B;                    /*                       #Y30LB32*/ 04407000
         MVI   DEFVFLG(@05),X'00'                                  1057 04408000
*   DEFVREP=ON;                     /*                       #Y30LB32*/ 04409000
         OI    DEFVREP(@05),B'00010000'                            1058 04410000
*   DEFVVFLG=SAVFLAG;               /*                       #Y30LB32*/ 04411000
         IC    @15,SAVFLAG                                         1059 04412000
         STC   @15,DEFVVFLG(,@05)                                  1059 04413000
*   DEFVWINH=ON;                    /*                       #Y30LB32*/ 04414000
*                                                                  1060 04415000
         OI    DEFVWINH(@05),B'00000010'                           1060 04416000
*   /*****************************************************************/ 04417000
*   /*                                                               */ 04418000
*   /* ISSUE USSC UMACRO TO INVOKE EXECUTE FORM OF ICBDEFV   @Y30LB32*/ 04419000
*   /* MACRO TO REPLACE ATTRIBUTE FLAG                       @Y30LB32*/ 04420000
*   /*                                                               */ 04421000
*   /*****************************************************************/ 04422000
*                                                                  1061 04423000
*   IF GDTDBG=NULLPTR THEN                                         1061 04424000
         L     @06,GDTDBG(,@06)                                    1061 04425000
         LTR   @06,@06                                             1061 04426000
         BZ    @RT01061                                            1061 04427000
*     ;                                                            1062 04428000
*   ELSE                                                           1063 04429000
*     DO;                                                          1063 04430000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/ 04431000
         LA    DMPINDEX,DUMPAREA                                   1064 04432000
*       DMPITMNM='DEFLIST';                                        1065 04433000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1065 04434000
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       1065 04435000
*       DMPITMPT=ADDR(DEFLIST);                                    1066 04436000
         L     @06,DEFLSTP                                         1066 04437000
         ST    @06,DMPITMPT(,DMPINDEX)                             1066 04438000
*       DMPITMLN=LENGTH(DEFLIST);                                  1067 04439000
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       1067 04440000
*       DMPITMTP='H';                                              1068 04441000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1068 04442000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1069 04443000
*                                                                  1069 04444000
         AL    DMPINDEX,@CF00508                                   1069 04445000
*       /*************************************************************/ 04446000
*       /*                                                           */ 04447000
*       /*                                                   @Y30LB32*/ 04448000
*       /*                                                           */ 04449000
*       /*************************************************************/ 04450000
*                                                                  1070 04451000
*       DMPTRM=DMPTRMVL;                                           1070 04452000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1070 04453000
*     END;                          /*                       @Y30LB32*/ 04454000
*   IF GDTDBG=NULLPTR THEN                                         1072 04455000
@RT01061 L     @06,@PC00001                                        1072 04456000
         L     @06,GDTDBG(,@06)                                    1072 04457000
         LTR   @06,@06                                             1072 04458000
         BZ    @RT01072                                            1072 04459000
*     ;                                                            1073 04460000
*   ELSE                                                           1074 04461000
*     CALL IDCDB010(GDTTBL,'CVMW',ADDR(DUMPAREA));/*         @Y30LB32*/ 04462000
         L     @06,@PC00001                                        1074 04463000
         ST    @06,@AL00001                                        1074 04464000
         LA    @05,@CC01627                                        1074 04465000
         ST    @05,@AL00001+4                                      1074 04466000
         LA    @05,DUMPAREA                                        1074 04467000
         ST    @05,@AFTEMPS+12                                     1074 04468000
         LA    @05,@AFTEMPS+12                                     1074 04469000
         ST    @05,@AL00001+8                                      1074 04470000
         MVI   @AL00001+8,X'80'                                    1074 04471000
         L     @15,GDTDBG(,@06)                                    1074 04472000
         LA    @01,@AL00001                                        1074 04473000
         BALR  @14,@15                                             1074 04474000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);/*   04475000
*                                                            @Y30LB32*/ 04476000
@RT01072 L     @06,@PC00001                                        1075 04477000
         ST    @06,@AL00001                                        1075 04478000
         LA    @05,DEFINE                                          1075 04479000
         ST    @05,@AL00001+4                                      1075 04480000
         LA    @05,DEFLSTP                                         1075 04481000
         ST    @05,@AL00001+8                                      1075 04482000
         LA    @05,REASONCD                                        1075 04483000
         ST    @05,@AL00001+12                                     1075 04484000
         LA    @05,ECBCODE                                         1075 04485000
         ST    @05,@AL00001+16                                     1075 04486000
         LA    @05,CMMSGPTR                                        1075 04487000
         ST    @05,@AL00001+20                                     1075 04488000
         MVI   @AL00001+20,X'80'                                   1075 04489000
         L     @15,GDTSSC(,@06)                                    1075 04490000
         LA    @01,@AL00001                                        1075 04491000
         BALR  @14,@15                                             1075 04492000
*   RESPECIFY                                                      1076 04493000
*     RTNREG RSTD;                                                 1076 04494000
*   TESTRC=RTNREG;                                                 1077 04495000
         LR    TESTRC,RTNREG                                       1077 04496000
*   RESPECIFY                                                      1078 04497000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 04498000
*                                                                  1078 04499000
*   /*****************************************************************/ 04500000
*   /*                                                               */ 04501000
*   /* CHECK IF DEFINE MACRO WAS SUCCESSFUL. IF SUCCESSFUL   @Y30LB32*/ 04502000
*   /* CHECK IF VOLUME INVENTORY WAS UPDATED SUCCESSFULLY    @Y30LB32*/ 04503000
*   /*                                                               */ 04504000
*   /*****************************************************************/ 04505000
*                                                                  1079 04506000
*   IF TESTRC=0|TESTRC=12 THEN      /*                       @Y30LB32*/ 04507000
         LTR   TESTRC,TESTRC                                       1079 04508000
         BZ    @RT01079                                            1079 04509000
         C     TESTRC,@CF00606                                     1079 04510000
         BNE   @RF01079                                            1079 04511000
@RT01079 DS    0H                                                  1080 04512000
*     DO;                           /*                       @Y30LB32*/ 04513000
*       IF TESTRC=12 THEN           /*                       @Y30LB32*/ 04514000
         C     TESTRC,@CF00606                                     1081 04515000
         BNE   @RF01081                                            1081 04516000
*         VIERRFLG=ON;              /*                       @Y30LB32*/ 04517000
*                                                                  1082 04518000
         OI    VIERRFLG,B'01000000'                                1082 04519000
*       /*************************************************************/ 04520000
*       /*                                                           */ 04521000
*       /* FREE STORAGE OBTAINED BY USSC UMACFO FOR ECB AND  @Y30LB32*/ 04522000
*       /* MESSAGE AREA                                      @Y30LB32*/ 04523000
*       /*                                                           */ 04524000
*       /*************************************************************/ 04525000
*                                                                  1083 04526000
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB32*/ 04527000
@RF01081 L     @06,@PC00001                                        1083 04528000
         ST    @06,@AL00001                                        1083 04529000
         LA    @05,CMMSGPTR                                        1083 04530000
         ST    @05,@AL00001+4                                      1083 04531000
         L     @15,GDTFSP(,@06)                                    1083 04532000
         LA    @01,@AL00001                                        1083 04533000
         BALR  @14,@15                                             1083 04534000
*     END;                          /*                       @Y30LB32*/ 04535000
*                                                                  1085 04536000
*   /*****************************************************************/ 04537000
*   /*                                                               */ 04538000
*   /* DEFINE MACRO WAS UNSUCCESSFUL, PROCESS ERROR CODE     @Y30LB32*/ 04539000
*   /*                                                               */ 04540000
*   /*****************************************************************/ 04541000
*                                                                  1085 04542000
*   ELSE                            /*                       @Y30LB32*/ 04543000
*     DO;                           /*                       @Y30LB32*/ 04544000
*                                                                  1085 04545000
         B     @RC01079                                            1085 04546000
@RF01079 DS    0H                                                  1086 04547000
*       /*************************************************************/ 04548000
*       /*                                                           */ 04549000
*       /* CHECK IF USSC COULD NOT OBTAIN STORAGE FOR        @Y30LB32*/ 04550000
*       /* MESSAGE AREA. IF ERROR DUE TO SOME OTHER PROBLEM  @Y30LB32*/ 04551000
*       /* INVOKE SSCMSG SUBROUTINE TO WRITE ERROR MESSAGE   @Y30LB32*/ 04552000
*       /* AND SET ERROR CODE                                @Y30LB32*/ 04553000
*       /*                                                           */ 04554000
*       /*************************************************************/ 04555000
*                                                                  1086 04556000
*       IF TESTRC^=8 THEN           /*                       @Y30LB32*/ 04557000
         C     TESTRC,@CF00181                                     1086 04558000
         BE    @RF01086                                            1086 04559000
*         DO;                       /*                       @Y30LB32*/ 04560000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/ 04561000
         LA    @06,REASONCD                                        1088 04562000
         ST    @06,@AL00001                                        1088 04563000
         LA    @01,@AL00001                                        1088 04564000
         BAL   @14,SSCMSG                                          1088 04565000
*           ROCOND=LASTCC04;        /*                       @Y30LB32*/ 04566000
         LA    ROCOND,4                                            1089 04567000
*         END;                      /*                       @Y30LB32*/ 04568000
*                                                                  1090 04569000
*       /*************************************************************/ 04570000
*       /*                                                           */ 04571000
*       /* SET ERROR CODE INDICATING NO STORAGE OBTAINED     @Y30LB32*/ 04572000
*       /*                                                           */ 04573000
*       /*************************************************************/ 04574000
*                                                                  1091 04575000
*       ELSE                        /*                       @Y30LB32*/ 04576000
*         ROCOND=LASTCC08;          /*                       @Y30LB32*/ 04577000
*                                                                  1091 04578000
         B     @RC01086                                            1091 04579000
@RF01086 LA    ROCOND,8                                            1091 04580000
*       /*************************************************************/ 04581000
*       /*                                                           */ 04582000
*       /* WRITE MESSAGE IDC3091I STATING READONLY FLAG NOT  @Y30LB32*/ 04583000
*       /* SET AS REQUIRED                                   @Y30LB32*/ 04584000
*       /*                                                           */ 04585000
*       /*************************************************************/ 04586000
*                                                                  1092 04587000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 04588000
@RC01086 XC    PRINTTAB(36),PRINTTAB                               1092 04589000
*       DARGSMOD=COMMSG;            /*                       @Y30LB32*/ 04590000
         L     @06,DDSTRU                                          1093 04591000
         MVC   DARGSMOD(3,@06),@CC01460                            1093 04592000
*       DARGSENT=MSG2091I;          /*                       @Y30LB32*/ 04593000
         MVI   DARGSENT(@06),X'0F'                                 1094 04594000
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/ 04595000
         LA    @05,VOLSER                                          1095 04596000
         ST    @05,DARGDBP(,@06)                                   1095 04597000
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/ 04598000
         MVC   DARGILP(2,@06),@CH00158                             1096 04599000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 04600000
         L     @06,@PC00001                                        1097 04601000
         ST    @06,@AL00001                                        1097 04602000
         LA    @05,@CF00116                                        1097 04603000
         ST    @05,@AL00001+4                                      1097 04604000
         LA    @05,DDSTRU                                          1097 04605000
         ST    @05,@AL00001+8                                      1097 04606000
         MVI   @AL00001+8,X'80'                                    1097 04607000
         L     @15,GDTPRT(,@06)                                    1097 04608000
         LA    @01,@AL00001                                        1097 04609000
         BALR  @14,@15                                             1097 04610000
*     END;                          /*                       @Y30LB32*/ 04611000
*                                                                  1098 04612000
*   /*****************************************************************/ 04613000
*   /*                                                               */ 04614000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN TO CALLER   @Y30LB32*/ 04615000
*   /*                                                               */ 04616000
*   /*****************************************************************/ 04617000
*                                                                  1099 04618000
*   REG14=RETADDR2;                 /*                       @Y30LB32*/ 04619000
@RC01079 L     REG14,RETADDR2                                      1099 04620000
*   RETURN CODE(ROCOND);            /*                       @Y30LB32*/ 04621000
         LR    @15,ROCOND                                          1100 04622000
@EL00015 DS    0H                                                  1100 04623000
@EF00015 DS    0H                                                  1100 04624000
@ER00015 BR    @14                                                 1100 04625000
*   END ROPROC;                     /*                       @Y30LB32*/ 04626000
*                                                                  1102 04627000
*/********************************************************************/ 04628000
*/*                                                          @Y30LB32*/ 04629000
*/*  PROCEDURE NAME - SCRATCH                                @Y30LB32*/ 04630000
*/*                                                          @Y30LB32*/ 04631000
*/*  FUNCTION - SCRATCHES PARTIALLY CREATED VOLUMES FOR BACK @Y30LB32*/ 04632000
*/*             OUT. ISSUES MESSAGE IDC0686I IF VOLUME WAS   @Y30LB32*/ 04633000
*/*             SCRATCHED ISSUES MESSAGE IDC2687I IF VOLUME  @Y30LB32*/ 04634000
*/*             WAS NOT SCRATCHED                            @Y30LB32*/ 04635000
*/*                                                          @Y30LB32*/ 04636000
*/*  INPUT - DEFLIST                                         @Y30LB32*/ 04637000
*/*                                                          @Y30LB32*/ 04638000
*/*  OUTPUT - RETURN CODE IN REGISTER 15                     @Y30LB32*/ 04639000
*/*             RETURN CODE = 0 - PARTIALLY CREATED VOLUME   @Y30LB32*/ 04640000
*/*                               SCRATCHED                  @Y30LB32*/ 04641000
*/*             RETURN CODE = 4 - PARTIALLY CREATED VOLUME   @Y30LB32*/ 04642000
*/*                               NOT SCRATCHED              @Y30LB32*/ 04643000
*/*                                                          @Y30LB32*/ 04644000
*/********************************************************************/ 04645000
*                                                                  1102 04646000
*SCRATCH:                                                          1102 04647000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB32*/ 04648000
*                                                                  1102 04649000
SCRATCH  DS    0H                                                  1103 04650000
*   /*****************************************************************/ 04651000
*   /*                                                               */ 04652000
*   /* SAVE RETURN ADDRESS TO CALLER AND SET CONDITION CODE  @Y30LB32*/ 04653000
*   /* TO ZERO                                               @Y30LB32*/ 04654000
*   /*                                                               */ 04655000
*   /*****************************************************************/ 04656000
*                                                                  1103 04657000
*   RETADDR3=REG14;                 /*                       @Y30LB32*/ 04658000
         LR    RETADDR3,REG14                                      1103 04659000
*   OLDERID2=NEWERID2;                                             1104 04660000
         L     @15,@PC00001                                        1104 04661000
         L     @14,GDTTR2(,@15)                                    1104 04662000
         MVC   @TS00001(95),NEWERID2(@14)                          1104 04663000
         MVC   OLDERID2(95,@14),@TS00001                           1104 04664000
*   NEWID2='CVSC';                  /*                       @Y30LB32*/ 04665000
         MVC   NEWID2(4,@14),@CC01631                              1105 04666000
*   SCRCOND=0;                      /*                       @Y30LB32*/ 04667000
*                                                                  1106 04668000
         SLR   @14,@14                                             1106 04669000
         STH   @14,SCRCOND                                         1106 04670000
*   /*****************************************************************/ 04671000
*   /*                                                               */ 04672000
*   /* ISSUE USSC UMACRO TO INVOKE THE EXECUTE FORM OF THE   @Y30LB32*/ 04673000
*   /* ICBDEFV MACRO TO SCRATCH PARTIALLY CREATED VOLUME     @Y30LB32*/ 04674000
*   /*                                                               */ 04675000
*   /*****************************************************************/ 04676000
*                                                                  1107 04677000
*   IF GDTDBG=NULLPTR THEN                                         1107 04678000
         C     @14,GDTDBG(,@15)                                    1107 04679000
         BE    @RT01107                                            1107 04680000
*     ;                                                            1108 04681000
*   ELSE                                                           1109 04682000
*     DO;                                                          1109 04683000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB32*/ 04684000
         LA    DMPINDEX,DUMPAREA                                   1110 04685000
*       DMPITMNM='DEFLIST';                                        1111 04686000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1111 04687000
         MVC   DMPITMNM(7,DMPINDEX),@CC01596                       1111 04688000
*       DMPITMPT=ADDR(DEFLIST);                                    1112 04689000
         L     @03,DEFLSTP                                         1112 04690000
         ST    @03,DMPITMPT(,DMPINDEX)                             1112 04691000
*       DMPITMLN=LENGTH(DEFLIST);                                  1113 04692000
         MVC   DMPITMLN(2,DMPINDEX),@CH01679                       1113 04693000
*       DMPITMTP='H';                                              1114 04694000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1114 04695000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1115 04696000
*                                                                  1115 04697000
         AL    DMPINDEX,@CF00508                                   1115 04698000
*       /*************************************************************/ 04699000
*       /*                                                           */ 04700000
*       /*                                                   @Y30LB32*/ 04701000
*       /*                                                           */ 04702000
*       /*************************************************************/ 04703000
*                                                                  1116 04704000
*       DMPTRM=DMPTRMVL;                                           1116 04705000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1116 04706000
*     END;                          /*                       @Y30LB32*/ 04707000
*   IF GDTDBG=NULLPTR THEN                                         1118 04708000
@RT01107 L     @15,@PC00001                                        1118 04709000
         L     @15,GDTDBG(,@15)                                    1118 04710000
         LTR   @15,@15                                             1118 04711000
         BZ    @RT01118                                            1118 04712000
*     ;                                                            1119 04713000
*   ELSE                                                           1120 04714000
*     CALL IDCDB010(GDTTBL,'CVSR',ADDR(DUMPAREA));/*         @Y30LB32*/ 04715000
         L     @15,@PC00001                                        1120 04716000
         ST    @15,@AL00001                                        1120 04717000
         LA    @14,@CC01632                                        1120 04718000
         ST    @14,@AL00001+4                                      1120 04719000
         LA    @14,DUMPAREA                                        1120 04720000
         ST    @14,@AFTEMPS+16                                     1120 04721000
         LA    @14,@AFTEMPS+16                                     1120 04722000
         ST    @14,@AL00001+8                                      1120 04723000
         MVI   @AL00001+8,X'80'                                    1120 04724000
         L     @15,GDTDBG(,@15)                                    1120 04725000
         LA    @01,@AL00001                                        1120 04726000
         BALR  @14,@15                                             1120 04727000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLSTP,REASONCD,ECBCODE,CMMSGPTR);/*   04728000
*                                                            @Y30LB32*/ 04729000
@RT01118 L     @02,@PC00001                                        1121 04730000
         ST    @02,@AL00001                                        1121 04731000
         LA    @15,DEFINE                                          1121 04732000
         ST    @15,@AL00001+4                                      1121 04733000
         LA    @15,DEFLSTP                                         1121 04734000
         ST    @15,@AL00001+8                                      1121 04735000
         LA    @15,REASONCD                                        1121 04736000
         ST    @15,@AL00001+12                                     1121 04737000
         LA    @15,ECBCODE                                         1121 04738000
         ST    @15,@AL00001+16                                     1121 04739000
         LA    @15,CMMSGPTR                                        1121 04740000
         ST    @15,@AL00001+20                                     1121 04741000
         MVI   @AL00001+20,X'80'                                   1121 04742000
         L     @15,GDTSSC(,@02)                                    1121 04743000
         LA    @01,@AL00001                                        1121 04744000
         BALR  @14,@15                                             1121 04745000
*   RESPECIFY                                                      1122 04746000
*     RTNREG RSTD;                                                 1122 04747000
*   TESTRC=RTNREG;                                                 1123 04748000
         LR    TESTRC,RTNREG                                       1123 04749000
*   RESPECIFY                                                      1124 04750000
*     RTNREG UNRSTD;                /*                       @Y30LB32*/ 04751000
*                                                                  1125 04752000
*   /*****************************************************************/ 04753000
*   /*                                                               */ 04754000
*   /* CHECK IF DEFINE MACRO WAS SUCCESSFUL                  @Y30LB32*/ 04755000
*   /*                                                               */ 04756000
*   /*****************************************************************/ 04757000
*                                                                  1125 04758000
*   IF TESTRC=0|TESTRC=12 THEN      /*                       @Y30LB32*/ 04759000
         LTR   TESTRC,TESTRC                                       1125 04760000
         BZ    @RT01125                                            1125 04761000
         C     TESTRC,@CF00606                                     1125 04762000
         BNE   @RF01125                                            1125 04763000
@RT01125 DS    0H                                                  1126 04764000
*     DO;                           /*                       @Y30LB32*/ 04765000
*                                                                  1126 04766000
*       /*************************************************************/ 04767000
*       /*                                                           */ 04768000
*       /* WRITE MESSAGE IDC0686I STATING PARTIALLY CREATED  @Y30LB32*/ 04769000
*       /* VOLUME WAS SCRATCHED                              @Y30LB32*/ 04770000
*       /*                                                           */ 04771000
*       /*************************************************************/ 04772000
*                                                                  1127 04773000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 04774000
         XC    PRINTTAB(36),PRINTTAB                               1127 04775000
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/ 04776000
         L     @15,DDSTRU                                          1128 04777000
         MVC   DARGSMOD(3,@15),@CC01462                            1128 04778000
*       DARGSENT=MSG0686I;          /*                       @Y30LB32*/ 04779000
         MVI   DARGSENT(@15),X'07'                                 1129 04780000
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/ 04781000
         LA    @14,VOLSER                                          1130 04782000
         ST    @14,DARGDBP(,@15)                                   1130 04783000
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/ 04784000
         MVC   DARGILP(2,@15),@CH00158                             1131 04785000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 04786000
*                                                                  1132 04787000
         L     @15,@PC00001                                        1132 04788000
         ST    @15,@AL00001                                        1132 04789000
         LA    @14,@CF00116                                        1132 04790000
         ST    @14,@AL00001+4                                      1132 04791000
         LA    @14,DDSTRU                                          1132 04792000
         ST    @14,@AL00001+8                                      1132 04793000
         MVI   @AL00001+8,X'80'                                    1132 04794000
         L     @15,GDTPRT(,@15)                                    1132 04795000
         LA    @01,@AL00001                                        1132 04796000
         BALR  @14,@15                                             1132 04797000
*       /*************************************************************/ 04798000
*       /*                                                           */ 04799000
*       /* FREE STORAGE OBTAINED BY USSC UMACRO FOR ECB AND  @Y30LB32*/ 04800000
*       /* MESSAGE AREA                                      @Y30LB32*/ 04801000
*       /*                                                           */ 04802000
*       /*************************************************************/ 04803000
*                                                                  1133 04804000
*       CALL IDCSAFS0(GDTTBL,CMMSGPTR);/*                    @Y30LB32*/ 04805000
         L     @15,@PC00001                                        1133 04806000
         ST    @15,@AL00001                                        1133 04807000
         LA    @14,CMMSGPTR                                        1133 04808000
         ST    @14,@AL00001+4                                      1133 04809000
         L     @15,GDTFSP(,@15)                                    1133 04810000
         LA    @01,@AL00001                                        1133 04811000
         BALR  @14,@15                                             1133 04812000
*     END;                          /*                       @Y30LB32*/ 04813000
*                                                                  1134 04814000
*   /*****************************************************************/ 04815000
*   /*                                                               */ 04816000
*   /* IF DEFINE MACRO WAS UNSUCCESSFUL, PROCESS ERROR CODE  @Y30LB32*/ 04817000
*   /*                                                               */ 04818000
*   /*****************************************************************/ 04819000
*                                                                  1135 04820000
*   ELSE                            /*                       @Y30LB32*/ 04821000
*     DO;                           /*                       @Y30LB32*/ 04822000
*                                                                  1135 04823000
         B     @RC01125                                            1135 04824000
@RF01125 DS    0H                                                  1136 04825000
*       /*************************************************************/ 04826000
*       /*                                                           */ 04827000
*       /* CHECK IF USSC UMACRO COULD NOT OBTAIN STORAGE     @Y30LB32*/ 04828000
*       /* FOR MESSAGE AREA                                  @Y30LB32*/ 04829000
*       /*                                                           */ 04830000
*       /*************************************************************/ 04831000
*                                                                  1136 04832000
*       IF TESTRC^=8 THEN           /*                       @Y30LB32*/ 04833000
         C     TESTRC,@CF00181                                     1136 04834000
         BE    @RF01136                                            1136 04835000
*         DO;                       /*                       @Y30LB32*/ 04836000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB32*/ 04837000
         LA    @15,REASONCD                                        1138 04838000
         ST    @15,@AL00001                                        1138 04839000
         LA    @01,@AL00001                                        1138 04840000
         BAL   @14,SSCMSG                                          1138 04841000
*           SCRCOND=LASTCC04;       /*                       @Y30LB32*/ 04842000
         MVC   SCRCOND(2),@CH00042                                 1139 04843000
*         END;                      /*                       @Y30LB32*/ 04844000
*                                                                  1140 04845000
*       /*************************************************************/ 04846000
*       /*                                                           */ 04847000
*       /* SET ERROR CODE INDICATING STORAGE NOT OBTAINED    @Y30LB32*/ 04848000
*       /*                                                           */ 04849000
*       /*************************************************************/ 04850000
*                                                                  1141 04851000
*       ELSE                        /*                       @Y30LB32*/ 04852000
*         SCRCOND=LASTCC08;         /*                       @Y30LB32*/ 04853000
*                                                                  1141 04854000
         B     @RC01136                                            1141 04855000
@RF01136 MVC   SCRCOND(2),@CH00181                                 1141 04856000
*       /*************************************************************/ 04857000
*       /*                                                           */ 04858000
*       /* WRITE MESSAGE IDC2687I STATING PARTIALLY CREATED  @Y30LB32*/ 04859000
*       /* VOLUME NOT SCRATCHED                              @Y30LB32*/ 04860000
*       /*                                                           */ 04861000
*       /*************************************************************/ 04862000
*                                                                  1142 04863000
*       PRINTTAB=''B;               /*                       @Y30LB32*/ 04864000
@RC01136 XC    PRINTTAB(36),PRINTTAB                               1142 04865000
*       DARGSMOD=CRVMSG;            /*                       @Y30LB32*/ 04866000
         L     @15,DDSTRU                                          1143 04867000
         MVC   DARGSMOD(3,@15),@CC01462                            1143 04868000
*       DARGSENT=MSG2687I;          /*                       @Y30LB32*/ 04869000
         MVI   DARGSENT(@15),X'08'                                 1144 04870000
*       DARGDBP=ADDR(VOLSER);       /*                       @Y30LB32*/ 04871000
         LA    @14,VOLSER                                          1145 04872000
         ST    @14,DARGDBP(,@15)                                   1145 04873000
*       DARGILP=LENGTH(VOLSER);     /*                       @Y30LB32*/ 04874000
         MVC   DARGILP(2,@15),@CH00158                             1146 04875000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 04876000
         L     @15,@PC00001                                        1147 04877000
         ST    @15,@AL00001                                        1147 04878000
         LA    @14,@CF00116                                        1147 04879000
         ST    @14,@AL00001+4                                      1147 04880000
         LA    @14,DDSTRU                                          1147 04881000
         ST    @14,@AL00001+8                                      1147 04882000
         MVI   @AL00001+8,X'80'                                    1147 04883000
         L     @15,GDTPRT(,@15)                                    1147 04884000
         LA    @01,@AL00001                                        1147 04885000
         BALR  @14,@15                                             1147 04886000
*     END;                          /*                       @Y30LB32*/ 04887000
*                                                                  1148 04888000
*   /*****************************************************************/ 04889000
*   /*                                                               */ 04890000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB32*/ 04891000
*   /*                                                               */ 04892000
*   /*****************************************************************/ 04893000
*                                                                  1149 04894000
*   REG14=RETADDR3;                 /*                       @Y30LB32*/ 04895000
@RC01125 LR    REG14,RETADDR3                                      1149 04896000
*   RETURN CODE(SCRCOND);           /*                       @Y30LB32*/ 04897000
         LH    @15,SCRCOND                                         1150 04898000
@EL00016 DS    0H                                                  1150 04899000
@EF00016 DS    0H                                                  1150 04900000
@ER00016 BR    @14                                                 1150 04901000
*   END SCRATCH;                    /*                       @Y30LB32*/ 04902000
*                                                                  1152 04903000
*/****************************************************************** */ 04904000
*/*                                                          @Y30LB32*/ 04905000
*/*  PROCEDURE NAME - CKCSNLEN (FSR SUBROUTINE)              @Y30LB32*/ 04906000
*/*                                                          @Y30LB32*/ 04907000
*/*  FUNCTION - CHECKS LENGTH OF CARTRIDGE SERIAL NUMBER     @Y30LB32*/ 04908000
*/*             IF THE LENGTH OF THE CSN IS LESS THEN ELEVEN,@Y30LB32*/ 04909000
*/*             ISSUES MESSAGE IDC2099I, IF CSN IS ELEVEN    @Y30LB32*/ 04910000
*/*             A BLANK CHARACTER IS INSERTED AS THE FOURTH  @Y30LB32*/ 04911000
*/*             CHARACTER                                    @Y30LB32*/ 04912000
*/*                                                          @Y30LB32*/ 04913000
*/*  INPUT - CSN, LENGTH OF CSN                              @Y30LB32*/ 04914000
*/*                                                          @Y30LB32*/ 04915000
*/*  OUTPUT - CSN, RETURN CODE IN REGISTER 15(RETURN CODE    @Y30LB32*/ 04916000
*/*           ZERO IF CSN VALID AND FOUR IF CSN INVALID)     @Y30LB32*/ 04917000
*/*                                                          @Y30LB32*/ 04918000
*/********************************************************************/ 04919000
*                                                                  1152 04920000
*CKCSNLEN:                          /*                       @Y30LB32*/ 04921000
*   PROCEDURE(CKCSNVAL,             /* CSN VALUE             @Y30LB32*/ 04922000
*       CKLENGTH)                   /* LENGTH OF CSN         @Y30LB32*/ 04923000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB32*/ 04924000
*                                                                  1152 04925000
CKCSNLEN MVC   @PC00017(8),0(@01)                                  1152 04926000
*   /*****************************************************************/ 04927000
*   /*                                                               */ 04928000
*   /* DECLARATIONS FOR CKCSNLEN SUBROUTINE                  @Y30LB32*/ 04929000
*   /*                                                               */ 04930000
*   /*****************************************************************/ 04931000
*                                                                  1153 04932000
*   DCL                                                            1153 04933000
*     CKCSNVAL CHAR(12);            /* CSN VALUE             @Y30LB32*/ 04934000
*   DCL                                                            1154 04935000
*     CKCSNADJ CHAR(12);            /* FOR ADJUSTED CSN      @Y30LB32*/ 04936000
*   DCL                                                            1155 04937000
*     CKLENGTH FIXED(8);            /* LENGTH OF CSN         @Y30LB32*/ 04938000
*   DCL                                                            1156 04939000
*     CKRETPTR PTR(31);             /* SAVE RETURN ADDR      @Y30LB32*/ 04940000
*   DCL                                                            1157 04941000
*     CKSAVPTR PTR(31);             /* TO SAVE POINTER       @Y30LB32*/ 04942000
*   DCL                                                            1158 04943000
*     CKPRTTAB CHAR(20) BDY(WORD);  /* PRINT TABLE AREA      @Y30LB32*/ 04944000
*   DCL                                                            1159 04945000
*     CKCOND FIXED(15);                                            1159 04946000
*                                                                  1159 04947000
*   /*****************************************************************/ 04948000
*   /*                                                               */ 04949000
*   /* DECLARATIONS OF CONSTANTS                             @Y30LB32*/ 04950000
*   /*                                                               */ 04951000
*   /*****************************************************************/ 04952000
*                                                                  1160 04953000
*   DCL                                                            1160 04954000
*     CKBLANK CHAR(1) CONSTANT(' ');/* BLANK TO INSERT IN    @Y30LB32   04955000
*                                      CSN                   @Y30LB32*/ 04956000
*   DCL                                                            1161 04957000
*     CKELEVEN BIT(8) CONSTANT('0B'X);/* TO CHECK LENGTH     @Y30LB32   04958000
*                                      OF CSN AGAINST        @Y30LB32*/ 04959000
*   DCL                                                            1162 04960000
*     CKMSGID CHAR(3) CONSTANT('CM0');/* MODULE MESSAGE ID   @Y30LB32*/ 04961000
*   DCL                                                            1163 04962000
*     MSG2099I PTR(8) CONSTANT(1);  /* INVALID CSN MSG       @Y30LB32*/ 04963000
*                                                                  1164 04964000
*   /*****************************************************************/ 04965000
*   /*                                                               */ 04966000
*   /* THIS IS THE START OF THE CHECK CSN SUBROUTINE         @Y30LB32*/ 04967000
*   /* THE CALLERS RETURN ADDRESS IS SAVED                   @Y30LB32*/ 04968000
*   /*                                                               */ 04969000
*   /*****************************************************************/ 04970000
*                                                                  1164 04971000
*   CKRETPTR=REG14;                 /*                       @Y30LB32*/ 04972000
         ST    REG14,CKRETPTR                                      1164 04973000
*   OLDERID2=NEWERID2;                                             1165 04974000
         L     @02,@PC00001                                        1165 04975000
         L     @02,GDTTR2(,@02)                                    1165 04976000
         MVC   @TS00001(95),NEWERID2(@02)                          1165 04977000
         MVC   OLDERID2(95,@02),@TS00001                           1165 04978000
*   NEWID2='CKLN';                  /*                       @Y30LB32*/ 04979000
*                                                                  1166 04980000
         MVC   NEWID2(4,@02),@CC01650                              1166 04981000
*   /*****************************************************************/ 04982000
*   /*                                                               */ 04983000
*   /* SAVE POINTER TO CALLERS PRINT TABLE,                  @Y30LB32*/ 04984000
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB32*/ 04985000
*   /* AND CONDITION CODE TO ZEROES                          @Y30LB32*/ 04986000
*   /*                                                               */ 04987000
*   /*****************************************************************/ 04988000
*                                                                  1167 04989000
*   CKSAVPTR=DDSTRU;                /*                       @Y30LB32*/ 04990000
         L     @02,DDSTRU                                          1167 04991000
         ST    @02,CKSAVPTR                                        1167 04992000
*   DDSTRU=ADDR(CKPRTTAB);          /*                       @Y30LB32*/ 04993000
         LA    @02,CKPRTTAB                                        1168 04994000
         ST    @02,DDSTRU                                          1168 04995000
*   CKPRTTAB=''B;                   /*                       @Y30LB32*/ 04996000
         XC    CKPRTTAB(20),CKPRTTAB                               1169 04997000
*   CKCOND=''B;                     /*                       @Y30LB32*/ 04998000
*                                                                  1170 04999000
         SLR   CKCOND,CKCOND                                       1170 05000000
*   /*****************************************************************/ 05001000
*   /*                                                               */ 05002000
*   /* CSN IS CHECKED FOR LENGTH OF ELEVEN CHARACTERS        @Y30LB32*/ 05003000
*   /* OR MORE                                               @Y30LB32*/ 05004000
*   /*                                                               */ 05005000
*   /*****************************************************************/ 05006000
*                                                                  1171 05007000
*   IF CKLENGTH>=CKELEVEN THEN      /*                       @Y30LB32*/ 05008000
*                                                                  1171 05009000
         L     @02,@PC00017+4                                      1171 05010000
         CLI   CKLENGTH(@02),11                                    1171 05011000
         BL    @RF01171                                            1171 05012000
*     /***************************************************************/ 05013000
*     /*                                                             */ 05014000
*     /* CSN IS CHECKED FOR LENGTH OF ELEVEN AND IF IT IS    @Y30LB32*/ 05015000
*     /* ELEVEN A BLANK CHARACTER IS INSERTED AS FOURTH      @Y30LB32*/ 05016000
*     /* CHARACTER                                           @Y30LB32*/ 05017000
*     /*                                                             */ 05018000
*     /***************************************************************/ 05019000
*                                                                  1172 05020000
*     IF CKLENGTH=CKELEVEN THEN     /*                       @Y30LB32*/ 05021000
         CLI   CKLENGTH(@02),11                                    1172 05022000
         BNE   @RF01172                                            1172 05023000
*       DO;                         /*                       @Y30LB32*/ 05024000
*         CKCSNADJ(4:4)=CKBLANK;    /*                       @Y30LB32*/ 05025000
         MVI   CKCSNADJ+3,C' '                                     1174 05026000
*         CKCSNADJ(5:12)=CKCSNVAL(4:11);/*                   @Y30LB32*/ 05027000
         L     @02,@PC00017                                        1175 05028000
         MVC   CKCSNADJ+4(8),CKCSNVAL+3(@02)                       1175 05029000
*         CKCSNVAL(4:12)=CKCSNADJ(4:12);/*                   @Y30LB32*/ 05030000
         MVC   CKCSNVAL+3(9,@02),CKCSNADJ+3                        1176 05031000
*       END;                        /*                       @Y30LB32*/ 05032000
*     ELSE                                                         1178 05033000
*       ;                           /*                       @Y30LB32*/ 05034000
*                                                                  1178 05035000
@RF01172 DS    0H                                                  1179 05036000
*   /*****************************************************************/ 05037000
*   /*                                                               */ 05038000
*   /* IF CSN IS LESS THEN ELEVEN CHARACTERS ERROR           @Y30LB32*/ 05039000
*   /* MESSAGE IDC2099I IS WRITTEN AND CONDITION CODE SET    @Y30LB32*/ 05040000
*   /*                                                               */ 05041000
*   /*****************************************************************/ 05042000
*                                                                  1179 05043000
*   ELSE                            /*                       @Y30LB32*/ 05044000
*     DO;                           /*                       @Y30LB32*/ 05045000
         B     @RC01171                                            1179 05046000
@RF01171 DS    0H                                                  1180 05047000
*       DARGSMOD=CKMSGID;           /*                       @Y30LB32*/ 05048000
         L     @02,DDSTRU                                          1180 05049000
         MVC   DARGSMOD(3,@02),@CC01460                            1180 05050000
*       DARGSENT=MSG2099I;          /*                       @Y30LB32*/ 05051000
         MVI   DARGSENT(@02),X'01'                                 1181 05052000
*       DARGDBP=ADDR(CKCSNVAL);     /*                       @Y30LB32*/ 05053000
         L     @15,@PC00017                                        1182 05054000
         ST    @15,DARGDBP(,@02)                                   1182 05055000
*       DARGILP=LENGTH(CKCSNVAL);   /*                       @Y30LB32*/ 05056000
         MVC   DARGILP(2,@02),@CH00606                             1183 05057000
*       DARGRETP=''B;               /*                       @Y30LB32*/ 05058000
         SLR   @15,@15                                             1184 05059000
         ST    @15,DARGRETP(,@02)                                  1184 05060000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB32*/ 05061000
         L     @02,@PC00001                                        1185 05062000
         ST    @02,@AL00001                                        1185 05063000
         LA    @15,@CF00116                                        1185 05064000
         ST    @15,@AL00001+4                                      1185 05065000
         LA    @15,DDSTRU                                          1185 05066000
         ST    @15,@AL00001+8                                      1185 05067000
         MVI   @AL00001+8,X'80'                                    1185 05068000
         L     @15,GDTPRT(,@02)                                    1185 05069000
         LA    @01,@AL00001                                        1185 05070000
         BALR  @14,@15                                             1185 05071000
*       CKCOND=4;                   /*                       @Y30LB32*/ 05072000
         LA    CKCOND,4                                            1186 05073000
*     END;                          /*                       @Y30LB32*/ 05074000
*                                                                  1187 05075000
*   /*****************************************************************/ 05076000
*   /*                                                               */ 05077000
*   /* RESTORE PRINT AREA POINTER AND RETURN ADDRESS AND     @Y30LB32*/ 05078000
*   /* RETURN CONTROL TO CALLING FSR                         @Y30LB32*/ 05079000
*   /*                                                               */ 05080000
*   /*****************************************************************/ 05081000
*                                                                  1188 05082000
*   DDSTRU=CKSAVPTR;                /*                       @Y30LB32*/ 05083000
@RC01171 L     @02,CKSAVPTR                                        1188 05084000
         ST    @02,DDSTRU                                          1188 05085000
*   REG14=CKRETPTR;                 /*                       @Y30LB32*/ 05086000
         L     REG14,CKRETPTR                                      1189 05087000
*   RETURN CODE(CKCOND);            /*                       @Y30LB32*/ 05088000
         LR    @15,CKCOND                                          1190 05089000
@EL00017 DS    0H                                                  1190 05090000
@EF00017 DS    0H                                                  1190 05091000
@ER00017 BR    @14                                                 1190 05092000
*   END CKCSNLEN;                   /*                       @Y30LB32*/ 05093000
*                                                                  1192 05094000
*/***********************************************************@Y30LB39*/ 05095000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 05096000
*/*                                                          @Y30LB39*/ 05097000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 05098000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 05099000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 05100000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 05101000
*/*                                                          @Y30LB39*/ 05102000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 05103000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 05104000
*/*   IN SSECBCD.                                            @Y30LB39*/ 05105000
*/*                                                          @Y30LB39*/ 05106000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 05107000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 05108000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 05109000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 05110000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 05111000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 05112000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 05113000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 05114000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 05115000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 05116000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 05117000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 05118000
*/*                                                          @Y30LB39*/ 05119000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 05120000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 05121000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 05122000
*/*                                                          @Y30LB39*/ 05123000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 05124000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 05125000
*/*                                                          @Y30LB39*/ 05126000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 05127000
*/*                                                          @Y30LB39*/ 05128000
*/***********************************************************@Y30LB39*/ 05129000
*                                                                  1192 05130000
*                                   /*                       @Y30LB39*/ 05131000
*SSCMSG:                                                           1192 05132000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 05133000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   05134000
*                                                            @Y30LB39*/ 05135000
SSCMSG   STM   @14,@12,@SA00018                                    1192 05136000
         MVC   @PC00018(8),0(@01)                                  1192 05137000
*                                   /*                       @Y30LB39*/ 05138000
*                                                                  1193 05139000
*   /*****************************************************************/ 05140000
*   /*                                                               */ 05141000
*   /*                                                       @Y30LB39*/ 05142000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 05143000
*   /*                                                       @Y30LB39*/ 05144000
*   /*                                                               */ 05145000
*   /*****************************************************************/ 05146000
*                                                                  1193 05147000
*                                   /*                       @Y30LB39   05148000
*                                                            @Y30LB39*/ 05149000
*                                                                  1193 05150000
*   /*****************************************************************/ 05151000
*   /*                                                               */ 05152000
*   /*                                                       @Y30LB39*/ 05153000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 05154000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 05155000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 05156000
*   /*                                                       @Y30LB39*/ 05157000
*   /*                                                               */ 05158000
*   /*****************************************************************/ 05159000
*                                                                  1193 05160000
*                                   /*                       @Y30LB39*/ 05161000
*   DCL                                                            1193 05162000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 05163000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 05164000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 05165000
*   DCL                                                            1194 05166000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   05167000
*                                                            @Y30LB39   05168000
*                                                            @Y30LB39*/ 05169000
*                                                                  1194 05170000
*   /*****************************************************************/ 05171000
*   /*                                                               */ 05172000
*   /*                                                       @Y30LB39*/ 05173000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 05174000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 05175000
*   /*                                                       @Y30LB39*/ 05176000
*   /*                                                               */ 05177000
*   /*****************************************************************/ 05178000
*                                                                  1195 05179000
*                                   /*                       @Y30LB39*/ 05180000
*   DCL                                                            1195 05181000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 05182000
*   DCL                                                            1196 05183000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   05184000
*                                                            @Y30LB39*/ 05185000
*                                                                  1196 05186000
*   /*****************************************************************/ 05187000
*   /*                                                               */ 05188000
*   /*                                                       @Y30LB39*/ 05189000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 05190000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 05191000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 05192000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 05193000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 05194000
*   /*                                                       @Y30LB39*/ 05195000
*   /*                                                               */ 05196000
*   /*****************************************************************/ 05197000
*                                                                  1197 05198000
*                                   /*                       @Y30LB39*/ 05199000
*   DECLARE                                                        1197 05200000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   05201000
*                                                            @Y30LB39*/ 05202000
*                                                                  1197 05203000
*   /*****************************************************************/ 05204000
*   /*                                                               */ 05205000
*   /*                                                       @Y30LB39*/ 05206000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 05207000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 05208000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 05209000
*   /* IDCTSCM0.                                             @Y30LB39*/ 05210000
*   /*                                                       @Y30LB39*/ 05211000
*   /*                                                               */ 05212000
*   /*****************************************************************/ 05213000
*                                                                  1198 05214000
*                                   /*                       @Y30LB39*/ 05215000
*   DECLARE                                                        1198 05216000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   05217000
*                                                            @Y30LB39*/ 05218000
*                                                                  1198 05219000
*   /*****************************************************************/ 05220000
*   /*                                                               */ 05221000
*   /*                                                       @Y30LB39*/ 05222000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 05223000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 05224000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 05225000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 05226000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 05227000
*   /*                                                       @Y30LB39*/ 05228000
*   /*                                                               */ 05229000
*   /*****************************************************************/ 05230000
*                                                                  1199 05231000
*                                   /*                       @Y30LB39*/ 05232000
*   DECLARE                                                        1199 05233000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 05234000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   05235000
*                                                            @Y30LB39*/ 05236000
*                                                                  1199 05237000
*   /*****************************************************************/ 05238000
*   /*                                                               */ 05239000
*   /*                                                       @Y30LB39*/ 05240000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 05241000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 05242000
*   /*                                                       @Y30LB39*/ 05243000
*   /*                                                               */ 05244000
*   /*****************************************************************/ 05245000
*                                                                  1200 05246000
*                                   /*                       @Y30LB39*/ 05247000
*   DECLARE                                                        1200 05248000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   05249000
*                                                            @Y30LB39*/ 05250000
*                                                                  1200 05251000
*   /*****************************************************************/ 05252000
*   /*                                                               */ 05253000
*   /*                                                       @Y30LB39*/ 05254000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 05255000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 05256000
*   /*                                                       @Y30LB39*/ 05257000
*   /*                                                               */ 05258000
*   /*****************************************************************/ 05259000
*                                                                  1201 05260000
*                                   /*                       @Y30LB39*/ 05261000
*   DECLARE                                                        1201 05262000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   05263000
*                                                            @Y30LB39*/ 05264000
*                                   /*                       @Y30LB39*/ 05265000
*                                                                  1202 05266000
*   /*****************************************************************/ 05267000
*   /*                                                               */ 05268000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 05269000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 05270000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 05271000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 05272000
*   /*                                                       @Y30LB39*/ 05273000
*   /*                                                               */ 05274000
*   /*****************************************************************/ 05275000
*                                                                  1202 05276000
*                                   /*                       @Y30LB39*/ 05277000
*   OLDERID2=NEWERID2;                                             1202 05278000
         L     @08,@PC00001                                        1202 05279000
         L     @15,GDTTR2(,@08)                                    1202 05280000
         MVC   @TS00001(95),NEWERID2(@15)                          1202 05281000
         MVC   OLDERID2(95,@15),@TS00001                           1202 05282000
*   NEWID2='SSAA';                  /*                       @Y30LB39   05283000
*                                                            @Y30LB39*/ 05284000
*                                                                  1203 05285000
         MVC   NEWID2(4,@15),@CC01671                              1203 05286000
*   /*****************************************************************/ 05287000
*   /*                                                               */ 05288000
*   /*                                                       @Y30LB39*/ 05289000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 05290000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 05291000
*   /*                                                       @Y30LB39*/ 05292000
*   /*                                                               */ 05293000
*   /*****************************************************************/ 05294000
*                                                                  1204 05295000
*                                   /*                       @Y30LB39*/ 05296000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   05297000
*                                                            @Y30LB39*/ 05298000
*                                                                  1204 05299000
         LA    @15,SSDRGLT                                         1204 05300000
         ST    @15,SSDLPTR                                         1204 05301000
*   /*****************************************************************/ 05302000
*   /*                                                               */ 05303000
*   /*                                                       @Y30LB39*/ 05304000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 05305000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 05306000
*   /*                                                       @Y30LB39*/ 05307000
*   /*                                                               */ 05308000
*   /*****************************************************************/ 05309000
*                                                                  1205 05310000
*                                   /*                       @Y30LB39*/ 05311000
*   IF SSRCODE>0 THEN                                              1205 05312000
         L     @14,@PC00018                                        1205 05313000
         L     @14,SSRCODE(,@14)                                   1205 05314000
         LTR   @14,@14                                             1205 05315000
         BNP   @RF01205                                            1205 05316000
*     DO;                           /*                       @Y30LB39   05317000
*                                                            @Y30LB39*/ 05318000
*                                                                  1206 05319000
*       /*************************************************************/ 05320000
*       /*                                                           */ 05321000
*       /*                                                   @Y30LB39*/ 05322000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 05323000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 05324000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 05325000
*       /* CODES.                                            @Y30LB39*/ 05326000
*       /*                                                   @Y30LB39*/ 05327000
*       /*                                                           */ 05328000
*       /*************************************************************/ 05329000
*                                                                  1207 05330000
*                                   /*                       @Y30LB39*/ 05331000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05332000
         XC    SSDRGLT(20),SSDRGLT                                 1207 05333000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 05334000
         LA    @03,SSINXLST                                        1208 05335000
         ST    @03,DARGRETP(,@15)                                  1208 05336000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 05337000
         MVC   DARGSMOD(3,@15),SSMODSS0                            1209 05338000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 05339000
         MVI   DARGSENT(@15),X'01'                                 1210 05340000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   05341000
*                                                            @Y30LB39*/ 05342000
*                                                                  1211 05343000
         MVC   DARGRETL(2,@15),@CH01681                            1211 05344000
*       /*************************************************************/ 05345000
*       /*                                                           */ 05346000
*       /*                                                   @Y30LB39*/ 05347000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 05348000
*       /* ARRAY.                                            @Y30LB39*/ 05349000
*       /*                                                   @Y30LB39*/ 05350000
*       /*                                                           */ 05351000
*       /*************************************************************/ 05352000
*                                                                  1212 05353000
*                                   /*                       @Y30LB39*/ 05354000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   05355000
*                                                            @Y30LB39*/ 05356000
*                                                                  1212 05357000
         ST    @08,@AL00001                                        1212 05358000
         LA    @03,@CF00116                                        1212 05359000
         ST    @03,@AL00001+4                                      1212 05360000
         LA    @03,SSDLPTR                                         1212 05361000
         ST    @03,@AL00001+8                                      1212 05362000
         MVI   @AL00001+8,X'80'                                    1212 05363000
         L     @15,GDTPRT(,@08)                                    1212 05364000
         LA    @01,@AL00001                                        1212 05365000
         BALR  @14,@15                                             1212 05366000
*       /*************************************************************/ 05367000
*       /*                                                           */ 05368000
*       /*                                                   @Y30LB39*/ 05369000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 05370000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 05371000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 05372000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 05373000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 05374000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 05375000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 05376000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 05377000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 05378000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 05379000
*       /* REASON CODE.                                      @Y30LB39*/ 05380000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 05381000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 05382000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 05383000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 05384000
*       /*                                                   @Y30LB39*/ 05385000
*       /*                                                           */ 05386000
*       /*************************************************************/ 05387000
*                                                                  1213 05388000
*                                   /*                       @Y30LB39*/ 05389000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 05390000
         LA    ENTRYNUM,1                                          1213 05391000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1214 05392000
@DL01214 DS    0H                                                  1215 05393000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 05394000
         LA    ENTRYNUM,1(,ENTRYNUM)                               1215 05395000
*       END;                        /*                       @Y30LB39   05396000
*                                                            @Y30LB39*/ 05397000
*                                                                  1216 05398000
@DE01214 L     @08,@PC00018                                        1216 05399000
         LR    @03,ENTRYNUM                                        1216 05400000
         ALR   @03,@03                                             1216 05401000
         LH    @03,SSARRAY-2(@03)                                  1216 05402000
         CH    @03,SSRHALF(,@08)                                   1216 05403000
         BE    @DC01214                                            1216 05404000
         LTR   @03,@03                                             1216 05405000
         BNZ   @DL01214                                            1216 05406000
@DC01214 DS    0H                                                  1217 05407000
*       /*************************************************************/ 05408000
*       /*                                                           */ 05409000
*       /*                                                   @Y30LB39*/ 05410000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 05411000
*       /*                                                   @Y30LB39*/ 05412000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 05413000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 05414000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 05415000
*       /* CODE OR                                           @Y30LB39*/ 05416000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 05417000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 05418000
*       /*                                                   @Y30LB39*/ 05419000
*       /*                                                           */ 05420000
*       /*************************************************************/ 05421000
*                                                                  1217 05422000
*                                   /*                       @Y30LB39*/ 05423000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05424000
         XC    SSDRGLT(20),SSDRGLT                                 1217 05425000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 05426000
         L     @08,SSDLPTR                                         1218 05427000
         MVC   DARGSMOD(3,@08),SSMODSS0                            1218 05428000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 05429000
         STC   ENTRYNUM,DARGSENT(,@08)                             1219 05430000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 05431000
         LR    @03,ENTRYNUM                                        1220 05432000
         ALR   @03,@03                                             1220 05433000
         LH    @03,SSARRAY-2(@03)                                  1220 05434000
         LTR   @03,@03                                             1220 05435000
         BNZ   @RF01220                                            1220 05436000
*         DO;                       /*                       @Y30LB39*/ 05437000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 05438000
         L     @15,@PC00018                                        1222 05439000
         ST    @15,DARGDBP(,@08)                                   1222 05440000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 05441000
         MVC   DARGILP(2,@08),@CH00042                             1223 05442000
*         END;                      /*                       @Y30LB39*/ 05443000
*     END;                          /*                       @Y30LB39*/ 05444000
*                                   /*                       @Y30LB39*/ 05445000
*                                                                  1226 05446000
*   /*****************************************************************/ 05447000
*   /*                                                               */ 05448000
*   /*                                                       @Y30LB39*/ 05449000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 05450000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 05451000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 05452000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 05453000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 05454000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 05455000
*   /* POST CODE.                                            @Y30LB39*/ 05456000
*   /*                                                       @Y30LB39*/ 05457000
*   /*                                                               */ 05458000
*   /*****************************************************************/ 05459000
*                                                                  1226 05460000
*                                   /*                       @Y30LB39*/ 05461000
*   ELSE                            /*                       @Y30LB39*/ 05462000
*     DO;                           /*                       @Y30LB39*/ 05463000
         B     @RC01205                                            1226 05464000
@RF01205 DS    0H                                                  1227 05465000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05466000
         XC    SSDRGLT(20),SSDRGLT                                 1227 05467000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 05468000
         L     @08,SSDLPTR                                         1228 05469000
         MVC   DARGSMOD(3,@08),SSMODCM0                            1228 05470000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 05471000
         IC    @15,SSMSGNUM                                        1229 05472000
         STC   @15,DARGSENT(,@08)                                  1229 05473000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 05474000
         L     @15,@PC00018+4                                      1230 05475000
         ST    @15,DARGDBP(,@08)                                   1230 05476000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 05477000
         MVC   DARGILP(2,@08),@CH00221                             1231 05478000
*     END;                          /*                       @Y30LB39   05479000
*                                                            @Y30LB39*/ 05480000
*                                                                  1232 05481000
*   /*****************************************************************/ 05482000
*   /*                                                               */ 05483000
*   /*                                                       @Y30LB39*/ 05484000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 05485000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 05486000
*   /*                                                       @Y30LB39*/ 05487000
*   /*                                                               */ 05488000
*   /*****************************************************************/ 05489000
*                                                                  1233 05490000
*                                   /*                       @Y30LB39*/ 05491000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   05492000
*                                                            @Y30LB39*/ 05493000
*                                                                  1233 05494000
@RC01205 L     @08,@PC00001                                        1233 05495000
         ST    @08,@AL00001                                        1233 05496000
         LA    @15,@CF00116                                        1233 05497000
         ST    @15,@AL00001+4                                      1233 05498000
         LA    @15,SSDLPTR                                         1233 05499000
         ST    @15,@AL00001+8                                      1233 05500000
         MVI   @AL00001+8,X'80'                                    1233 05501000
         L     @15,GDTPRT(,@08)                                    1233 05502000
         LA    @01,@AL00001                                        1233 05503000
         BALR  @14,@15                                             1233 05504000
*   /*****************************************************************/ 05505000
*   /*                                                               */ 05506000
*   /*                                                       @Y30LB39*/ 05507000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 05508000
*   /*                                                       @Y30LB39*/ 05509000
*   /*                                                               */ 05510000
*   /*****************************************************************/ 05511000
*                                                                  1234 05512000
*                                   /*                       @Y30LB39   05513000
*                                                            @Y30LB39*/ 05514000
*   RETURN CODE(0);                 /*                       @Y30LB39   05515000
*                                                            @Y30LB39*/ 05516000
         SLR   @15,@15                                             1234 05517000
         L     @14,@SA00018                                        1234 05518000
         LM    @00,@12,@SA00018+8                                  1234 05519000
         BR    @14                                                 1234 05520000
*   END SSCMSG;                     /*                       @Y30LB39*/ 05521000
*   END IDCCV01                     /*                       @Y30LB32*/ 05522000
*                                                                  1236 05523000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05524000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 05525000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 05526000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 05527000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 05528000
*/*%INCLUDE SYSLIB  (IDCCSCV )                                       */ 05529000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 05530000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 05531000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 05532000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 05533000
*/*%INCLUDE SYSLIB  (IDCDF50 )                                       */ 05534000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 05535000
*                                                                  1236 05536000
*       ;                                                          1236 05537000
@DATA    DS    0H                                                       05538000
@CH00649 DC    H'14'                                                    05539000
@CH01674 DC    H'64'                                                    05540000
@CH01676 DC    H'68'                                                    05541000
@CH01680 DC    H'88'                                                    05542000
@CH01681 DC    H'120'                                                   05543000
@CH01679 DC    H'132'                                                   05544000
@CH01675 DC    H'164'                                                   05545000
@SM01692 MVC   0(0,@04),VOLVAL-1(@14)                                   05546000
@SM01695 MVC   0(0,@01),0(@14)                                          05547000
         DS    0F                                                       05548000
@AL00690 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        05549000
         DC    A(WAIT)                                                  05550000
         DC    A(@CC01493)                                              05551000
@DATD    DSECT                                                          05552000
         DS    0F                                                       05553000
@SA00001 DS    18F                                                      05554000
@PC00001 DS    3F                                                       05555000
@SA00018 DS    15F                                                      05556000
@PC00018 DS    2F                                                       05557000
@PC00017 DS    2F                                                       05558000
@AL00001 DS    6A                                                       05559000
@TF00001 DS    F                                                        05560000
@AFTEMPS DS    5F                                                       05561000
IDCCV01  CSECT                                                          05562000
         DS    0F                                                       05563000
@CF00116 DC    F'0'                                                     05564000
@CF00221 DC    F'1'                                                     05565000
@CH00221 EQU   @CF00221+2                                               05566000
@CF00155 DC    F'2'                                                     05567000
@CH00155 EQU   @CF00155+2                                               05568000
@CF00042 DC    F'4'                                                     05569000
@CH00042 EQU   @CF00042+2                                               05570000
@CF00158 DC    F'6'                                                     05571000
@CH00158 EQU   @CF00158+2                                               05572000
@CF00181 DC    F'8'                                                     05573000
@CH00181 EQU   @CF00181+2                                               05574000
@CF00478 DC    F'10'                                                    05575000
@CF00606 DC    F'12'                                                    05576000
@CH00606 EQU   @CF00606+2                                               05577000
@CF00508 DC    F'16'                                                    05578000
@CF01699 DC    F'-12'                                                   05579000
@CF01698 DC    F'-11'                                                   05580000
@DATD    DSECT                                                          05581000
         DS    0D                                                       05582000
LISTSCAN DS    A                                                        05583000
IOCSPTR  DS    A                                                        05584000
OPNPTR   DS    A                                                        05585000
DDSTRU   DS    A                                                        05586000
FSADDR   DS    A                                                        05587000
ERCNVADR DS    A                                                        05588000
CCMSGPTR DS    A                                                        05589000
CMMSGPTR DS    A                                                        05590000
CTMSGPTR DS    A                                                        05591000
ELEMENT  DS    F                                                        05592000
RVVIPTR  DS    A                                                        05593000
MVRPTR   DS    A                                                        05594000
DEFLSTP  DS    A                                                        05595000
VOLCRCNT DS    F                                                        05596000
REASONCD DS    F                                                        05597000
RETADDR1 DS    A                                                        05598000
RETADDR2 DS    A                                                        05599000
MDAGLPTR DS    A                                                        05600000
VSAGLPTR DS    A                                                        05601000
UCBPTR   DS    A                                                        05602000
IOCTLBKP DS    A                                                        05603000
LOOPCNT  DS    F                                                        05604000
SAVBINNO DS    F                                                        05605000
CKRETPTR DS    A                                                        05606000
CKSAVPTR DS    A                                                        05607000
SSDLPTR  DS    A                                                        05608000
LISTPTR  DS    A                                                        05609000
GRPCOND  DS    H                                                        05610000
SCRCOND  DS    H                                                        05611000
SETRC    DS    H                                                        05612000
SAVFLAG  DS    FL1                                                      05613000
ECBCODE  DS    FL1                                                      05614000
CHARNUM  DS    FL1                                                      05615000
LISTLN   DS    FL1                                                      05616000
         DS    0D                                                       05617000
@TS00001 DS    CL95                                                     05618000
CRVFLGS  DS    BL2                                                      05619000
         ORG   CRVFLGS                                                  05620000
CREATFLG DS    BL1                                                      05621000
RONLYFLG EQU   CRVFLGS+0                                                05622000
BNDNBND  EQU   CRVFLGS+0                                                05623000
EXCLSHRD EQU   CRVFLGS+0                                                05624000
DERASNDE EQU   CRVFLGS+0                                                05625000
RONLYRW  EQU   CRVFLGS+0                                                05626000
ROFAIL   EQU   CRVFLGS+0                                                05627000
@NM00119 EQU   CRVFLGS+0                                                05628000
VCREATED DS    BL1                                                      05629000
VIERRFLG EQU   CRVFLGS+1                                                05630000
         ORG   CRVFLGS+2                                                05631000
DUMPAREA DS    CL33                                                     05632000
SAVECSN1 DS    CL12                                                     05633000
SAVECSN2 DS    CL12                                                     05634000
PARMLST  DS    CL132                                                    05635000
DEFLSTEX DS    CL64                                                     05636000
PARMLST2 DS    CL132                                                    05637000
         DS    CL2                                                      05638000
PRINTTAB DS    CL36                                                     05639000
BUFFER   DS    CL164                                                    05640000
MVRLST   DS    CL88                                                     05641000
RVVILST  DS    CL68                                                     05642000
VS2AGLST DS    CL52                                                     05643000
MDAGLLST DS    CL37                                                     05644000
CKAGLLST DS    CL29                                                     05645000
         DS    CL2                                                      05646000
EXCLLST  DS    CL23                                                     05647000
RNAME    DS    CL23                                                     05648000
         ORG   RNAME                                                    05649000
RNAMELN  DS    FL1                                                      05650000
VOLSER   DS    CL6                                                      05651000
VIRTNAME DS    CL8                                                      05652000
TYPENAME DS    CL8                                                      05653000
         ORG   RNAME+23                                                 05654000
CSNVAL   DS    CL12                                                     05655000
NUMBER   DS    CL1                                                      05656000
VOLCHAR  DS    CL1                                                      05657000
         DS    CL4                                                      05658000
NUMERICS DS    CL6                                                      05659000
         DS    CL2                                                      05660000
PACKEDNO DS    CL6                                                      05661000
CKCSNADJ DS    CL12                                                     05662000
         DS    CL2                                                      05663000
CKPRTTAB DS    CL20                                                     05664000
SSDRGLT  DS    CL20                                                     05665000
SSINXLST DS    CL120                                                    05666000
         ORG   SSINXLST                                                 05667000
SSARRAY  DS    60H                                                      05668000
         ORG   SSINXLST+120                                             05669000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05670000
@ENDDATD EQU   *                                                        05671000
IDCCV01  CSECT                                                          05672000
         DS    0F                                                       05673000
@SIZDATD DC    AL1(0)                                                   05674000
         DC    AL3(@ENDDATD-@DATD)                                      05675000
         DS    0D                                                       05676000
RVVLEN   DC    AL2(68)                                                  05677000
MVRLEN   DC    AL2(88)                                                  05678000
DEFLEN   DC    AL2(64)                                                  05679000
SSMSGNUM DC    AL1(56)                                                  05680000
@CC01487 DC    C'.VIRTUAL'                                              05681000
@CC01489 DC    C'.ENQUEUE'                                              05682000
@CC01491 DC    C'.RESERVE'                                              05683000
@CC01493 DC    C'SYSZAMS '                                              05684000
@CC01616 DC    C'IDCVS02 '                                              05685000
@CC01596 DC    C'DEFLIST'                                               05686000
@CC01597 DC    C'DEFVE'                                                 05687000
@CC01528 DC    C'CVCR'                                                  05688000
@CC01529 DC    C'CVCV'                                                  05689000
@CC01543 DC    C'CVRP'                                                  05690000
@CC01547 DC    C'CVGP'                                                  05691000
@CC01552 DC    C'CVAT'                                                  05692000
@CC01556 DC    C'DVGN'                                                  05693000
@CC01557 DC    C'RVVI'                                                  05694000
@CC01559 DC    C'CVBV'                                                  05695000
@CC01564 DC    C'CVCK'                                                  05696000
@CC01571 DC    C'CVNC'                                                  05697000
@CC01575 DC    C'CVAC'                                                  05698000
@CC01579 DC    C'CVCL'                                                  05699000
@CC01590 DC    C'CVCP'                                                  05700000
@CC01595 DC    C'CVCA'                                                  05701000
@CC01598 DC    C'CVBC'                                                  05702000
@CC01599 DC    C'CVBA'                                                  05703000
@CC01604 DC    C'CVUD'                                                  05704000
@CC01611 DC    C'CVMP'                                                  05705000
@CC01615 DC    C'CVIP'                                                  05706000
@CC01618 DC    C'CVMR'                                                  05707000
@CC01622 DC    C'CVDM'                                                  05708000
@CC01626 DC    C'CVRO'                                                  05709000
@CC01627 DC    C'CVMW'                                                  05710000
@CC01631 DC    C'CVSC'                                                  05711000
@CC01632 DC    C'CVSR'                                                  05712000
@CC01650 DC    C'CKLN'                                                  05713000
@CC01671 DC    C'SSAA'                                                  05714000
@CC01458 DC    C'UV0'                                                   05715000
@CC01460 DC    C'CM0'                                                   05716000
@CC01462 DC    C'CV0'                                                   05717000
@CC01617 DC    C'MVR'                                                   05718000
ALL      DC    CL3'ALL'                                                 05719000
FORMAT   DC    CL4'FORM'                                                05720000
HSECOND  DC    CL4'HSEC'                                                05721000
CLOCK    DC    CL4'KLOK'                                                05722000
SETZERO  DC    CL4'ZERO'                                                05723000
SETBLANK DC    CL4'BLNK'                                                05724000
NOSET    DC    CL4'NSET'                                                05725000
OVERRIDE DC    CL4'OVRD'                                                05726000
ACQUIRE  DC    CL8'ACQUIRE '                                            05727000
RELINQ   DC    CL8'RELINQ  '                                            05728000
MOUNT    DC    CL8'MOUNT   '                                            05729000
DEMOUNT  DC    CL8'DEMOUNT '                                            05730000
DEFINE   DC    CL8'DEFINE  '                                            05731000
MOVE     DC    CL8'MOVE    '                                            05732000
TRACEQ   DC    CL8'TRACEQ  '                                            05733000
COPYTABL DC    CL8'COPYTABL'                                            05734000
COPYCRTG DC    CL8'COPYCRTG'                                            05735000
COPYVOL  DC    CL8'COPYVOL '                                            05736000
VVIC     DC    CL8'VVIC    '                                            05737000
TUNE     DC    CL8'TUNE    '                                            05738000
NAMES    DC    CL4'NAME'                                                05739000
UNIT     DC    CL4'UNIT'                                                05740000
SHR      DC    CL4'SHR '                                                05741000
EXCL     DC    CL4'EXCL'                                                05742000
NOWAIT   DC    CL4'NWAI'                                                05743000
WAIT     DC    CL4'WAIT'                                                05744000
SECCHECK DC    CL8'SECCHECK'                                            05745000
SCRVTOC  DC    CL8'SCRVTOC '                                            05746000
GETVTOC  DC    CL8'GETVTOC '                                            05747000
PUTVTOC  DC    CL8'PUTVTOC '                                            05748000
RECATLG  DC    CL8'RECATLG '                                            05749000
INITVOL  DC    CL8'INITVOL '                                            05750000
CHECK    DC    CL8'CHECK   '                                            05751000
POSTUCB  DC    CL8'POSTUCB '                                            05752000
GET      DC    CL8'GET     '                                            05753000
PUT      DC    CL8'PUT     '                                            05754000
CLOSE    DC    CL8'CLOSE   '                                            05755000
OPEN     DC    CL8'OPEN    '                                            05756000
RVOPENR  DC    CL8'OPENR   '                                            05757000
RVRDCNT  DC    CL8'READCNT '                                            05758000
RVREADKD DC    CL8'READKD  '                                            05759000
RVSPACCR DC    CL8'SPACCR  '                                            05760000
RVFWRITE DC    CL8'FWRITE  '                                            05761000
RVWRITER DC    CL8'WRITEREC'                                            05762000
PUTLABEL DC    CL8'PUTLABEL'                                            05763000
GETLABEL DC    CL8'GETLABEL'                                            05764000
CANCEL   DC    CL8'CANCEL  '                                            05765000
SET      DC    CL8'SET     '                                            05766000
SELECTX  DC    CL8'SELECTX '                                            05767000
CHANGEX  DC    CL8'CHANGEX '                                            05768000
SELECTDD DC    CL8'SELECTDD'                                            05769000
SELECTDS DC    CL8'SELECTDS'                                            05770000
TBLREST  DC    CL8'TBLREST '                                            05771000
NULLIFYC DC    CL8'NULLIFYC'                                            05772000
RDMSC    DC    CL8'RDMSC   '                                            05773000
RDMSCTBL DC    CL8'RDMSCTBL'                                            05774000
RDCARTLB DC    CL8'RDCARTLB'                                            05775000
AUDITCEL DC    CL8'AUDITCEL'                                            05776000
RDSTGAD  DC    CL8'RDSTGAD '                                            05777000
MODIFYC  DC    CL8'MODIFYC '                                            05778000
MODID    DC    CL4'CV01'                                                05779000
FIXAREA  DS    CL400                                                    05780000
         ORG   FIXAREA                                                  05781000
@NM00120 DC    400X'00'                                                 05782000
         ORG   FIXAREA+400                                              05783000
SSMODSS0 DC    CL3'SS0'                                                 05784000
SSMODCM0 DC    CL3'CM0'                                                 05785000
MAXNUM   DC    XL4'9'                                                   05786000
         DC    XL4'63'                                                  05787000
         DC    XL4'3E7'                                                 05788000
         DC    XL4'2705'                                                05789000
         DC    XL4'1869F'                                               05790000
         DC    XL4'F423F'                                               05791000
NUMTBL   DC    CL1'0'                                                   05792000
         DC    CL1'1'                                                   05793000
         DC    CL1'2'                                                   05794000
         DC    CL1'3'                                                   05795000
         DC    CL1'4'                                                   05796000
         DC    CL1'5'                                                   05797000
         DC    CL1'6'                                                   05798000
         DC    CL1'7'                                                   05799000
         DC    CL1'8'                                                   05800000
         DC    CL1'9'                                                   05801000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05802000
@01      EQU   01                                                       05803000
@02      EQU   02                                                       05804000
@03      EQU   03                                                       05805000
@04      EQU   04                                                       05806000
@05      EQU   05                                                       05807000
@06      EQU   06                                                       05808000
@07      EQU   07                                                       05809000
@08      EQU   08                                                       05810000
@09      EQU   09                                                       05811000
@10      EQU   10                                                       05812000
@11      EQU   11                                                       05813000
@12      EQU   12                                                       05814000
@13      EQU   13                                                       05815000
@14      EQU   14                                                       05816000
@15      EQU   15                                                       05817000
ENTRYNUM EQU   @02                                                      05818000
CKCOND   EQU   @03                                                      05819000
BINARYNO EQU   @02                                                      05820000
VOLSERCK EQU   @02                                                      05821000
NUMCNT   EQU   @03                                                      05822000
CSNNUM   EQU   @04                                                      05823000
CKAGLPTR EQU   @06                                                      05824000
RETADDR3 EQU   @05                                                      05825000
RETADDR  EQU   @07                                                      05826000
CKVCOND  EQU   @05                                                      05827000
ROCOND   EQU   @04                                                      05828000
DMNTCOND EQU   @04                                                      05829000
INITCOND EQU   @04                                                      05830000
MNTCOND  EQU   @04                                                      05831000
UPDCOND  EQU   @06                                                      05832000
CRACOND  EQU   @04                                                      05833000
CARTCOND EQU   @05                                                      05834000
CRVCOND  EQU   @07                                                      05835000
ACCCOND  EQU   @03                                                      05836000
NUMCOND  EQU   @04                                                      05837000
GENCOND  EQU   @05                                                      05838000
ATTRCOND EQU   @03                                                      05839000
CSNCNT   EQU   @06                                                      05840000
DEFVEPTR EQU   @08                                                      05841000
GROUPPTR EQU   @04                                                      05842000
DMPINDEX EQU   @02                                                      05843000
TESTRC   EQU   @03                                                      05844000
REG11    EQU   @11                                                      05845000
REG12    EQU   @12                                                      05846000
REG9     EQU   @09                                                      05847000
RTNREG   EQU   @15                                                      05848000
REG14    EQU   @14                                                      05849000
DEFVR1   EQU   @01                                                      05850000
REG0     EQU   @00                                                      05851000
REG1     EQU   @01                                                      05852000
REG10    EQU   @10                                                      05853000
REG13    EQU   @13                                                      05854000
REG15    EQU   @15                                                      05855000
REG2     EQU   @02                                                      05856000
REG3     EQU   @03                                                      05857000
REG4     EQU   @04                                                      05858000
REG5     EQU   @05                                                      05859000
REG6     EQU   @06                                                      05860000
REG7     EQU   @07                                                      05861000
REG8     EQU   @08                                                      05862000
IDCSACL0 EQU   0                                                        05863000
IDCSAEP0 EQU   0                                                        05864000
IDCSAFS0 EQU   0                                                        05865000
IDCSASS0 EQU   0                                                        05866000
IDCSANQ0 EQU   0                                                        05867000
IDCSARV0 EQU   0                                                        05868000
IDCSADQ0 EQU   0                                                        05869000
IDCSA060 EQU   0                                                        05870000
TRACE1   EQU   0                                                        05871000
OLDERID1 EQU   TRACE1                                                   05872000
TRACE2   EQU   0                                                        05873000
OLDERID2 EQU   TRACE2                                                   05874000
NEWID2   EQU   TRACE2+95                                                05875000
NEWERID2 EQU   5                                                        05876000
CIRAGL   EQU   0                                                        05877000
CIRTYPE  EQU   CIRAGL                                                   05878000
ALLAGL   EQU   0                                                        05879000
ALLSTS   EQU   ALLAGL+24                                                05880000
ALLDSP   EQU   ALLAGL+25                                                05881000
ALLORG   EQU   ALLAGL+26                                                05882000
ALLOPT   EQU   ALLAGL+28                                                05883000
RACFAGL  EQU   0                                                        05884000
RACFFLG1 EQU   RACFAGL                                                  05885000
RACFFLG2 EQU   RACFAGL+1                                                05886000
RACFFLG3 EQU   RACFAGL+2                                                05887000
RACFFLG4 EQU   RACFAGL+3                                                05888000
UNITABL  EQU   0                                                        05889000
UNITADR  EQU   UNITABL+4                                                05890000
@NM00017 EQU   UNITADR                                                  05891000
UNITSTAT EQU   UNITABL+6                                                05892000
IDCIO050 EQU   0                                                        05893000
IOCSTR   EQU   0                                                        05894000
IOCDSO   EQU   IOCSTR+16                                                05895000
IOCRFM   EQU   IOCSTR+17                                                05896000
IOCMAC   EQU   IOCSTR+18                                                05897000
IOCMAC2  EQU   IOCSTR+19                                                05898000
IOCCHP   EQU   IOCSTR+20                                                05899000
IOCMSG   EQU   IOCSTR+21                                                05900000
IOCRBA   EQU   IOCSTR+40                                                05901000
IOCTTR   EQU   IOCRBA                                                   05902000
IOCMEM   EQU   IOCSTR+44                                                05903000
IOCNWM   EQU   IOCSTR+48                                                05904000
IOCREL   EQU   IOCSTR+60                                                05905000
OPNAGL   EQU   0                                                        05906000
OPNOPT   EQU   OPNAGL                                                   05907000
OPNRFM   EQU   OPNAGL+1                                                 05908000
OPNTYP   EQU   OPNAGL+2                                                 05909000
OPNMOD   EQU   OPNAGL+3                                                 05910000
OPNDEV   EQU   OPNAGL+24                                                05911000
OPNDSO   EQU   OPNAGL+41                                                05912000
OPNOPT2  EQU   OPNAGL+42                                                05913000
IOINFOPT EQU   0                                                        05914000
UVOLLIST EQU   0                                                        05915000
UVOLENT  EQU   UVOLLIST+2                                               05916000
AMSTP011 EQU   0                                                        05917000
DARGLIST EQU   0                                                        05918000
DARGDBP  EQU   DARGLIST                                                 05919000
DARGRETP EQU   DARGLIST+4                                               05920000
DARGSTID EQU   DARGLIST+8                                               05921000
DARGSMOD EQU   DARGSTID                                                 05922000
DARGSENT EQU   DARGSTID+3                                               05923000
DARGILP  EQU   DARGLIST+12                                              05924000
DARGCNT  EQU   DARGLIST+14                                              05925000
DARGRETL EQU   DARGLIST+16                                              05926000
DARGARY  EQU   DARGLIST+20                                              05927000
DARGINS  EQU   DARGARY                                                  05928000
DARGINL  EQU   DARGARY+2                                                05929000
DARGDTM  EQU   DARGARY+4                                                05930000
FMTLIST  EQU   0                                                        05931000
FMTFLGS  EQU   FMTLIST                                                  05932000
FMTSPF   EQU   FMTLIST+2                                                05933000
FMTRFNO  EQU   FMTSPF                                                   05934000
FMTILEN  EQU   FMTRFNO                                                  05935000
FMTIOFF  EQU   FMTLIST+4                                                05936000
FMTTRBC  EQU   FMTIOFF                                                  05937000
FMTSTO   EQU   FMTTRBC                                                  05938000
FMTOCOL  EQU   FMTLIST+6                                                05939000
FMTCNVF  EQU   FMTLIST+10                                               05940000
ERCNVTAB EQU   0                                                        05941000
ERTYPE   EQU   ERCNVTAB                                                 05942000
EROPER   EQU   ERCNVTAB+1                                               05943000
EROSOPER EQU   ERCNVTAB+2                                               05944000
ERCATRC  EQU   ERCNVTAB+16                                              05945000
ERCPLPT  EQU   ERCNVTAB+20                                              05946000
IDCDB010 EQU   0                                                        05947000
DMPITM   EQU   0                                                        05948000
DMPITMNM EQU   DMPITM                                                   05949000
DMPITMPT EQU   DMPITM+8                                                 05950000
DMPITMLN EQU   DMPITM+12                                                05951000
DMPITMTP EQU   DMPITM+14                                                05952000
DMPARY   EQU   0                                                        05953000
DMPTRM   EQU   0                                                        05954000
CCMSG    EQU   0                                                        05955000
CMMSG    EQU   0                                                        05956000
CMVOLFLG EQU   CMMSG+6                                                  05957000
CMCSN1   EQU   CMMSG+16                                                 05958000
CMCSN2   EQU   CMMSG+28                                                 05959000
CTMSG    EQU   0                                                        05960000
CTARRAY  EQU   CTMSG+4                                                  05961000
MDAGL    EQU   0                                                        05962000
MDUCBPTR EQU   MDAGL+8                                                  05963000
MDDDNAME EQU   MDAGL+12                                                 05964000
MDLABEL  EQU   MDAGL+24                                                 05965000
MDFLAGS  EQU   MDAGL+30                                                 05966000
MDNEWVOL EQU   MDFLAGS                                                  05967000
MDWAIT   EQU   MDFLAGS                                                  05968000
MDENQ    EQU   MDFLAGS                                                  05969000
MDDEQ    EQU   MDFLAGS                                                  05970000
MDVTOC   EQU   MDAGL+32                                                 05971000
PUAGL    EQU   0                                                        05972000
CKAGL    EQU   0                                                        05973000
CKUCBPTR EQU   CKAGL+8                                                  05974000
CKDDNAME EQU   CKAGL+12                                                 05975000
CKFLAGS  EQU   CKAGL+28                                                 05976000
CKTESTVT EQU   CKFLAGS                                                  05977000
EXCLAGL  EQU   0                                                        05978000
EXCLUCBP EQU   EXCLAGL+8                                                05979000
EXCLDDP  EQU   EXCLAGL+12                                               05980000
EXCLFLAG EQU   EXCLAGL+22                                               05981000
EXOARG   EQU   0                                                        05982000
EXOPT    EQU   EXOARG+32                                                05983000
EXFLG    EQU   EXOARG+33                                                05984000
EXGARG   EQU   0                                                        05985000
EXWRARG  EQU   0                                                        05986000
EXRWCHR  EQU   EXWRARG+26                                               05987000
EXSPACE  EQU   EXWRARG+36                                               05988000
EXPARG   EQU   0                                                        05989000
EXPDATA  EQU   EXPARG+12                                                05990000
EXPDATAB EQU   0                                                        05991000
EXPARRAY EQU   EXPDATAB+4                                               05992000
VS2AGL   EQU   0                                                        05993000
VSUCBPTR EQU   VS2AGL+8                                                 05994000
VSVTOCSZ EQU   VS2AGL+12                                                05995000
VSOWNPTR EQU   VS2AGL+16                                                05996000
VSVOLPTR EQU   VS2AGL+20                                                05997000
VSIOBKPT EQU   VS2AGL+24                                                05998000
VSLABOPT EQU   VS2AGL+28                                                05999000
VS2MSG   EQU   VS2AGL+35                                                06000000
VS2RESOP EQU   VS2AGL+36                                                06001000
VSDDNAME EQU   VS2AGL+37                                                06002000
VS1AGL   EQU   0                                                        06003000
VSSECOPT EQU   VS1AGL+68                                                06004000
VSVTOPT  EQU   VS1AGL+69                                                06005000
VSCATOPT EQU   VS1AGL+70                                                06006000
VSRETURN EQU   VS1AGL+71                                                06007000
VSMSG    EQU   VS1AGL+72                                                06008000
VSRESOPT EQU   VS1AGL+73                                                06009000
RCTAGL   EQU   0                                                        06010000
RCTOPT   EQU   RCTAGL+8                                                 06011000
STAEPARM EQU   0                                                        06012000
STARCVY  EQU   STAEPARM+52                                              06013000
STARETRY EQU   STAEPARM+53                                              06014000
VOLLABEL EQU   0                                                        06015000
SV82LIST EQU   0                                                        06016000
@NM00073 EQU   SV82LIST+4                                               06017000
SV82DCBP EQU   @NM00073                                                 06018000
@NM00074 EQU   SV82LIST+12                                              06019000
SV82WRKP EQU   @NM00074                                                 06020000
SRTAGL   EQU   0                                                        06021000
LCTINFO  EQU   0                                                        06022000
LCTFLAGS EQU   LCTINFO+32                                               06023000
UCTAGL   EQU   0                                                        06024000
UCTFLAGS EQU   UCTAGL+68                                                06025000
SELAGL   EQU   0                                                        06026000
SELFLAGS EQU   SELAGL+22                                                06027000
DATESAGL EQU   0                                                        06028000
DATESOPT EQU   DATESAGL+20                                              06029000
VS3AGL   EQU   0                                                        06030000
VS3FLAGS EQU   VS3AGL+58                                                06031000
VSDVTOC  EQU   0                                                        06032000
VSDSTAT  EQU   0                                                        06033000
VSDSFLG1 EQU   VSDSTAT+16                                               06034000
VSDFLG2  EQU   VSDSTAT+17                                               06035000
VSDSCR   EQU   0                                                        06036000
VSDSCRFL EQU   VSDSCR+4                                                 06037000
VSDUSAGE EQU   0                                                        06038000
VSDDORG  EQU   VSDUSAGE+9                                               06039000
VSDALLOC EQU   VSDUSAGE+10                                              06040000
VSDUSEF  EQU   VSDUSAGE+11                                              06041000
VSDDSORG EQU   VSDUSAGE+16                                              06042000
VSDBLOCK EQU   0                                                        06043000
VSDSPACE EQU   VSDBLOCK+12                                              06044000
VSDARRAY EQU   VSDBLOCK+16                                              06045000
VSDVARY  EQU   VSDARRAY+48                                              06046000
VOL      EQU   0                                                        06047000
VOLVAL   EQU   VOL+1                                                    06048000
FILE     EQU   0                                                        06049000
FILEVAL  EQU   FILE+1                                                   06050000
COUNT    EQU   0                                                        06051000
COUNTVAL EQU   COUNT                                                    06052000
MSF      EQU   0                                                        06053000
MSFVAL   EQU   MSF                                                      06054000
VTSZ     EQU   0                                                        06055000
VTSZVAL  EQU   VTSZ                                                     06056000
CART     EQU   0                                                        06057000
CARTCNT  EQU   CART                                                     06058000
@NM00093 EQU   CART+2                                                   06059000
CARTLEN  EQU   @NM00093                                                 06060000
CARTVAL  EQU   @NM00093+1                                               06061000
OWNER    EQU   0                                                        06062000
OWNERVAL EQU   OWNER+1                                                  06063000
DESCR    EQU   0                                                        06064000
DESCRVAL EQU   DESCR+1                                                  06065000
BKUP#    EQU   0                                                        06066000
BKUP#VAL EQU   BKUP#                                                    06067000
GRP      EQU   0                                                        06068000
GRPVAL   EQU   GRP+1                                                    06069000
RSTR     EQU   0                                                        06070000
BIND     EQU   0                                                        06071000
NBIND    EQU   0                                                        06072000
EXCLU    EQU   0                                                        06073000
SHRD     EQU   0                                                        06074000
RONLY    EQU   0                                                        06075000
RW       EQU   0                                                        06076000
DERAS    EQU   0                                                        06077000
NDERS    EQU   0                                                        06078000
RVVI     EQU   0                                                        06079000
RVVLNGTH EQU   RVVI                                                     06080000
RVVOPCOD EQU   RVVI+4                                                   06081000
RVVCODE  EQU   RVVOPCOD                                                 06082000
RVVGROUP EQU   RVVI+14                                                  06083000
RVVBUFLN EQU   RVVI+30                                                  06084000
RVVRTBUF EQU   RVVI+32                                                  06085000
RVVFLAGA EQU   RVVI+58                                                  06086000
RVVRMODE EQU   RVVFLAGA                                                 06087000
RVVRDR   EQU   RVVRMODE                                                 06088000
RVVCHAIN EQU   RVVFLAGA+1                                               06089000
RVVRDRCD EQU   RVVFLAGA+2                                               06090000
RVVGRPRC EQU   RVVRDRCD                                                 06091000
RVVRTEST EQU   RVVFLAGA+3                                               06092000
RVVCPYTP EQU   RVVFLAGA+4                                               06093000
RVVSPEC  EQU   RVVFLAGA+5                                               06094000
RVVSGRP  EQU   RVVSPEC                                                  06095000
MVR      EQU   0                                                        06096000
MVRLNGTH EQU   MVR                                                      06097000
MVRCODE  EQU   MVR+4                                                    06098000
MVROPCD  EQU   MVRCODE                                                  06099000
MVRFLAGA EQU   MVR+8                                                    06100000
MVRFLBAS EQU   MVRFLAGA                                                 06101000
MVRCIVCF EQU   MVRFLAGA+2                                               06102000
MVRBVOL  EQU   MVR+12                                                   06103000
GROUP    EQU   0                                                        06104000
GRONAME  EQU   GROUP                                                    06105000
GROID    EQU   GRONAME+11                                               06106000
GROFLAGA EQU   GROUP+13                                                 06107000
GROTYPE  EQU   GROFLAGA                                                 06108000
GROBIND  EQU   GROFLAGA+2                                               06109000
GROEXCL  EQU   GROFLAGA+2                                               06110000
GRODAERA EQU   GROFLAGA+2                                               06111000
GRORONLY EQU   GROFLAGA+2                                               06112000
GROERRTS EQU   GROUP+56                                                 06113000
DEFLIST  EQU   0                                                        06114000
DEFVFLG  EQU   DEFLIST+6                                                06115000
DEFVCR   EQU   DEFVFLG                                                  06116000
DEFVELM  EQU   DEFVFLG                                                  06117000
DEFVREP  EQU   DEFVFLG                                                  06118000
DEFVELTR EQU   DEFVFLG                                                  06119000
DEFVACT  EQU   DEFVFLG                                                  06120000
DEFVLIB  EQU   DEFLIST+7                                                06121000
DEFVOLD  EQU   DEFLIST+8                                                06122000
DEFVVFLG EQU   DEFLIST+14                                               06123000
DEFVSEC  EQU   DEFVVFLG                                                 06124000
DEFVEXCL EQU   DEFVVFLG                                                 06125000
DEFVBIND EQU   DEFVVFLG                                                 06126000
DEFVWINH EQU   DEFVVFLG                                                 06127000
DEFVCSN1 EQU   DEFLIST+24                                               06128000
DEFVCSN2 EQU   DEFLIST+36                                               06129000
DEFVDATA EQU   DEFLIST+56                                               06130000
DEFOWNID EQU   DEFVDATA+29                                              06131000
DEFTLAB  EQU   DEFVDATA+71                                              06132000
DEFVVEXT EQU   DEFLIST+128                                              06133000
DEFVE    EQU   0                                                        06134000
DEFLNGTH EQU   DEFVE                                                    06135000
DEFGROUP EQU   DEFVE+4                                                  06136000
DEFDESCR EQU   DEFVE+12                                                 06137000
DEFBKUPN EQU   DEFVE+48                                                 06138000
DEFFLAGA EQU   DEFVE+55                                                 06139000
DEFPGRO  EQU   DEFFLAGA                                                 06140000
DEFPDESC EQU   DEFFLAGA                                                 06141000
DEFPBKUP EQU   DEFFLAGA                                                 06142000
DEFFLAGB EQU   DEFVE+56                                                 06143000
DEFSETFL EQU   DEFFLAGB                                                 06144000
DEFSRCVY EQU   DEFSETFL                                                 06145000
DEFRECFL EQU   DEFFLAGB+1                                               06146000
DEFCREAT EQU   DEFRECFL                                                 06147000
DEFTYPFL EQU   DEFFLAGB+2                                               06148000
DEFGENUS EQU   DEFTYPFL                                                 06149000
DEFRSTD  EQU   DEFTYPFL                                                 06150000
DEFNULFL EQU   DEFFLAGB+3                                               06151000
AMSTP041 EQU   0                                                        06152000
AMSTP042 EQU   0                                                        06153000
AMSTP043 EQU   0                                                        06154000
AMSTP044 EQU   0                                                        06155000
GENRL    EQU   0                                                        06156000
IDCIOCL0 EQU   0                                                        06157000
IDCIOCO0 EQU   0                                                        06158000
IDCIOGT0 EQU   0                                                        06159000
IDCIOIT0 EQU   0                                                        06160000
IDCIOOP0 EQU   0                                                        06161000
IDCIOPO0 EQU   0                                                        06162000
IDCIOPT0 EQU   0                                                        06163000
IDCIOSI0 EQU   0                                                        06164000
IDCIOST0 EQU   0                                                        06165000
IDCIOTM0 EQU   0                                                        06166000
IDCIOVY0 EQU   0                                                        06167000
IDCSAAL0 EQU   0                                                        06168000
IDCSACA0 EQU   0                                                        06169000
IDCSACR0 EQU   0                                                        06170000
IDCSADE0 EQU   0                                                        06171000
IDCSADL0 EQU   0                                                        06172000
IDCSAFP0 EQU   0                                                        06173000
IDCSAGP0 EQU   0                                                        06174000
IDCSAGS0 EQU   0                                                        06175000
IDCSAID0 EQU   0                                                        06176000
IDCSALC0 EQU   0                                                        06177000
IDCSALD0 EQU   0                                                        06178000
IDCSALK0 EQU   0                                                        06179000
IDCSAPR0 EQU   0                                                        06180000
IDCSAPT0 EQU   0                                                        06181000
IDCSAQL0 EQU   0                                                        06182000
IDCSARC0 EQU   0                                                        06183000
IDCSARK0 EQU   0                                                        06184000
IDCSASC0 EQU   0                                                        06185000
IDCSASI0 EQU   0                                                        06186000
IDCSASN0 EQU   0                                                        06187000
IDCSAST0 EQU   0                                                        06188000
IDCSATI0 EQU   0                                                        06189000
IDCSAUC0 EQU   0                                                        06190000
IDCSAWO0 EQU   0                                                        06191000
IDCST010 EQU   0                                                        06192000
IDCTPER0 EQU   0                                                        06193000
LISTTEST EQU   0                                                        06194000
NEWERID1 EQU   5                                                        06195000
GDTTBL   EQU   0                                                        06196000
GDTTR1   EQU   GDTTBL+8                                                 06197000
GDTTR2   EQU   GDTTBL+12                                                06198000
GDTDBG   EQU   GDTTBL+40                                                06199000
GDTSTC   EQU   GDTTBL+44                                                06200000
GDTPRT   EQU   GDTTBL+48                                                06201000
GDTESS   EQU   GDTTBL+52                                                06202000
GDTESA   EQU   GDTTBL+56                                                06203000
GDTRST   EQU   GDTTBL+60                                                06204000
GDTRES   EQU   GDTTBL+64                                                06205000
GDTCAL   EQU   GDTTBL+68                                                06206000
GDTGSP   EQU   GDTTBL+72                                                06207000
GDTFSP   EQU   GDTTBL+76                                                06208000
GDTGPL   EQU   GDTTBL+80                                                06209000
GDTFPL   EQU   GDTTBL+84                                                06210000
GDTLOD   EQU   GDTTBL+88                                                06211000
GDTDEL   EQU   GDTTBL+92                                                06212000
GDTPRL   EQU   GDTTBL+96                                                06213000
GDTEPL   EQU   GDTTBL+100                                               06214000
GDTTIM   EQU   GDTTBL+104                                               06215000
GDTIIO   EQU   GDTTBL+108                                               06216000
GDTTIO   EQU   GDTTBL+112                                               06217000
GDTOPN   EQU   GDTTBL+124                                               06218000
GDTCLS   EQU   GDTTBL+128                                               06219000
GDTGET   EQU   GDTTBL+132                                               06220000
GDTPUT   EQU   GDTTBL+136                                               06221000
GDTPOS   EQU   GDTTBL+140                                               06222000
GDTCPY   EQU   GDTTBL+144                                               06223000
GDTCAT   EQU   GDTTBL+148                                               06224000
GDTSNP   EQU   GDTTBL+164                                               06225000
GDTVFY   EQU   GDTTBL+172                                               06226000
GDTUID   EQU   GDTTBL+192                                               06227000
GDTPMT   EQU   GDTTBL+196                                               06228000
GDTCIR   EQU   GDTTBL+200                                               06229000
GDTLNK   EQU   GDTTBL+204                                               06230000
GDTALC   EQU   GDTTBL+208                                               06231000
GDTDLC   EQU   GDTTBL+212                                               06232000
GDTQAL   EQU   GDTTBL+216                                               06233000
GDTSTW   EQU   GDTTBL+220                                               06234000
GDTSSC   EQU   GDTTBL+224                                               06235000
GDTENQ   EQU   GDTTBL+228                                               06236000
GDTRSV   EQU   GDTTBL+232                                               06237000
GDTDEQ   EQU   GDTTBL+236                                               06238000
GDTSFO   EQU   GDTTBL+240                                               06239000
GDTWTO   EQU   GDTTBL+244                                               06240000
GDTSCR   EQU   GDTTBL+248                                               06241000
GDTUNT   EQU   GDTTBL+252                                               06242000
GDTRCT   EQU   GDTTBL+256                                               06243000
GDTIFO   EQU   GDTTBL+260                                               06244000
GDTEXP   EQU   GDTTBL+264                                               06245000
GDTSTA   EQU   GDTTBL+268                                               06246000
GDTERR   EQU   GDTTBL+272                                               06247000
GDTUNC   EQU   GDTTBL+276                                               06248000
GDTLOC   EQU   GDTTBL+280                                               06249000
GDTRCK   EQU   GDTTBL+284                                               06250000
FDTTBL   EQU   0                                                        06251000
FDTPTR   EQU   FDTTBL+8                                                 06252000
LASTCOND EQU   0                                                        06253000
CKCSNVAL EQU   0                                                        06254000
CKLENGTH EQU   0                                                        06255000
SSRCODE  EQU   0                                                        06256000
SSRHALF  EQU   SSRCODE+2                                                06257000
SSECBCD  EQU   0                                                        06258000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06259000
@NM00121 EQU   SSRCODE                                                  06260000
FDTVERB  EQU   FDTTBL                                                   06261000
GDTECT   EQU   GDTTBL+188                                               06262000
GDTPSB   EQU   GDTTBL+184                                               06263000
GDTUPT   EQU   GDTTBL+180                                               06264000
GDTCMB   EQU   GDTTBL+176                                               06265000
GDTSPR   EQU   GDTTBL+168                                               06266000
@NM00001 EQU   GDTTBL+160                                               06267000
GDTABH   EQU   GDTTBL+156                                               06268000
GDTABT   EQU   GDTTBL+152                                               06269000
GDTTOH   EQU   GDTTBL+120                                               06270000
GDTRIP   EQU   GDTTBL+116                                               06271000
GDTIOH   EQU   GDTTBL+36                                                06272000
GDTSAH   EQU   GDTTBL+32                                                06273000
GDTTPH   EQU   GDTTBL+28                                                06274000
GDTRIH   EQU   GDTTBL+24                                                06275000
GDTSTH   EQU   GDTTBL+20                                                06276000
GDTDBH   EQU   GDTTBL+16                                                06277000
GDTPRM   EQU   GDTTBL+4                                                 06278000
GDTHDR   EQU   GDTTBL                                                   06279000
@NM00118 EQU   DEFVE+60                                                 06280000
@NM00117 EQU   DEFNULFL                                                 06281000
DEFNEXPD EQU   DEFNULFL                                                 06282000
DEFNDESC EQU   DEFNULFL                                                 06283000
DEFNGRP  EQU   DEFNULFL                                                 06284000
@NM00116 EQU   DEFTYPFL                                                 06285000
DEFCOPY  EQU   DEFTYPFL                                                 06286000
DEFDUP   EQU   DEFTYPFL                                                 06287000
@NM00115 EQU   DEFRECFL                                                 06288000
DEFLAMIS EQU   DEFRECFL                                                 06289000
DEFICOPY EQU   DEFRECFL                                                 06290000
@NM00114 EQU   DEFSETFL                                                 06291000
DEFCRCVY EQU   DEFSETFL                                                 06292000
@NM00113 EQU   DEFFLAGA                                                 06293000
DEFPTO   EQU   DEFFLAGA                                                 06294000
DEFPVLAB EQU   DEFFLAGA                                                 06295000
DEFPFOR  EQU   DEFFLAGA                                                 06296000
DEFLABEL EQU   DEFVE+49                                                 06297000
DEFFOR   EQU   DEFVE+46                                                 06298000
DEFTO    EQU   DEFVE+42                                                 06299000
DEFR60   EQU   DEFVDATA+43                                              06300000
DEFR55   EQU   DEFVDATA+3                                               06301000
DEFACSEC EQU   DEFVDATA+2                                               06302000
DEFR50   EQU   DEFVDATA                                                 06303000
DEFVECB  EQU   DEFLIST+52                                               06304000
DEFVASID EQU   DEFLIST+50                                               06305000
@NM00112 EQU   DEFLIST+48                                               06306000
@NM00111 EQU   DEFLIST+22                                               06307000
DEFVNVOL EQU   DEFLIST+16                                               06308000
@NM00110 EQU   DEFLIST+15                                               06309000
@NM00109 EQU   DEFVVFLG                                                 06310000
@NM00108 EQU   DEFVVFLG                                                 06311000
@NM00107 EQU   DEFVVFLG                                                 06312000
DEFVCECT EQU   DEFVVFLG                                                 06313000
DEFVLID  EQU   DEFVLIB                                                  06314000
@NM00106 EQU   DEFVLIB                                                  06315000
DEFVDACT EQU   DEFVFLG                                                  06316000
DEFVRNTR EQU   DEFVFLG                                                  06317000
DEFVRNM  EQU   DEFVFLG                                                  06318000
@NM00105 EQU   DEFLIST+5                                                06319000
DEFVOPCD EQU   DEFLIST+4                                                06320000
DEFVLEN  EQU   DEFLIST                                                  06321000
@NM00104 EQU   GROUP+136                                                06322000
GROADDR  EQU   GROUP+106                                                06323000
GROOWNER EQU   GROUP+96                                                 06324000
GRORESSP EQU   GROUP+95                                                 06325000
GROCONUS EQU   GROUP+94                                                 06326000
GRODESCR EQU   GROUP+64                                                 06327000
GROERRTM EQU   GROERRTS+4                                               06328000
GROERRDT EQU   GROERRTS                                                 06329000
GRORETPD EQU   GROUP+52                                                 06330000
GROFREXT EQU   GROUP+48                                                 06331000
GROFRESP EQU   GROUP+44                                                 06332000
GROSTRSH EQU   GROUP+40                                                 06333000
GROSSPD  EQU   GROUP+38                                                 06334000
GROPSPD  EQU   GROUP+36                                                 06335000
GRONINAC EQU   GROUP+34                                                 06336000
GRONRSTD EQU   GROUP+32                                                 06337000
GRONGEN  EQU   GROUP+30                                                 06338000
GROPCENT EQU   GROUP+29                                                 06339000
GROLSN   EQU   GROUP+23                                                 06340000
GROFSN   EQU   GROUP+17                                                 06341000
@NM00103 EQU   GROFLAGA+2                                               06342000
GROMSG1  EQU   GROFLAGA+2                                               06343000
GRORETN  EQU   GROFLAGA+2                                               06344000
GRORLSE  EQU   GROFLAGA+2                                               06345000
GRORES1  EQU   GROTYPE                                                  06346000
GROGVR   EQU   GROTYPE                                                  06347000
GROZERO  EQU   GROID+1                                                  06348000
GROBLANK EQU   GROID                                                    06349000
GROVVGRP EQU   GRONAME+3                                                06350000
GROG     EQU   GRONAME                                                  06351000
@NM00102 EQU   MVR+82                                                   06352000
MVRLABEL EQU   MVR+76                                                   06353000
MVRBLNK1 EQU   MVR+75                                                   06354000
MVRBKUPN EQU   MVR+74                                                   06355000
MVRCSN   EQU   MVR+62                                                   06356000
MVRTO    EQU   MVR+58                                                   06357000
MVRDES   EQU   MVR+28                                                   06358000
MVRGROUP EQU   MVR+20                                                   06359000
MVRFOR   EQU   MVR+18                                                   06360000
@NM00101 EQU   MVRFLAGA+2                                               06361000
MVRCICPY EQU   MVRFLAGA+2                                               06362000
MVRCLMIS EQU   MVRFLAGA+1                                               06363000
MVRSLMIS EQU   MVRFLAGA+1                                               06364000
MVRNEXPD EQU   MVRFLAGA+1                                               06365000
MVRNDESC EQU   MVRFLAGA+1                                               06366000
MVRBKUP  EQU   MVRFLAGA+1                                               06367000
MVRNGRP  EQU   MVRFLAGA+1                                               06368000
MVRRSTD  EQU   MVRFLAGA+1                                               06369000
MVRGEN   EQU   MVRFLAGA+1                                               06370000
MVRFLLAB EQU   MVRFLAGA                                                 06371000
MVRFLBK  EQU   MVRFLAGA                                                 06372000
MVRFLCSN EQU   MVRFLAGA                                                 06373000
MVRFLTO  EQU   MVRFLAGA                                                 06374000
MVRFLDES EQU   MVRFLAGA                                                 06375000
MVRFLGRO EQU   MVRFLAGA                                                 06376000
MVRFLFOR EQU   MVRFLAGA                                                 06377000
@NM00100 EQU   MVRCODE+1                                                06378000
@NM00099 EQU   RVVI+64                                                  06379000
RVVSVOL  EQU   RVVSPEC                                                  06380000
RVVSDUP  EQU   RVVSPEC                                                  06381000
RVVSCPY  EQU   RVVSPEC                                                  06382000
RVVSCSN  EQU   RVVSPEC                                                  06383000
RVVSSEQ  EQU   RVVSPEC                                                  06384000
RVVSDTE  EQU   RVVSPEC                                                  06385000
RVVSEXP  EQU   RVVSPEC                                                  06386000
@NM00098 EQU   RVVCPYTP                                                 06387000
RVVCPLHD EQU   RVVCPYTP                                                 06388000
RVVLCOPY EQU   RVVCPYTP                                                 06389000
RVVOBKUP EQU   RVVCPYTP                                                 06390000
RVVLBKUP EQU   RVVCPYTP                                                 06391000
RVVBPLHD EQU   RVVRTEST                                                 06392000
RVVDVOL  EQU   RVVRTEST                                                 06393000
RVVACTV  EQU   RVVRTEST                                                 06394000
RVVINACT EQU   RVVRTEST                                                 06395000
RVVRSTD  EQU   RVVRTEST                                                 06396000
RVVGSVOL EQU   RVVRTEST                                                 06397000
RVVTHOLD EQU   RVVRTEST                                                 06398000
RVVEXPDT EQU   RVVRTEST                                                 06399000
RVVALL   EQU   RVVRDRCD                                                 06400000
RVVCPURC EQU   RVVRDRCD                                                 06401000
RVVCIRCD EQU   RVVRDRCD                                                 06402000
RVVRUNKN EQU   RVVRDRCD                                                 06403000
RVVDUPRC EQU   RVVRDRCD                                                 06404000
RVVCPYRC EQU   RVVRDRCD                                                 06405000
RVVBVRCD EQU   RVVRDRCD                                                 06406000
@NM00097 EQU   RVVCHAIN                                                 06407000
RVVNGVOL EQU   RVVCHAIN                                                 06408000
RVVGPVOL EQU   RVVCHAIN                                                 06409000
@NM00096 EQU   RVVRMODE                                                 06410000
RVVRDCH  EQU   RVVRMODE                                                 06411000
RVVRDNR  EQU   RVVRMODE                                                 06412000
RVVDUPID EQU   RVVI+57                                                  06413000
RVVCPYID EQU   RVVI+56                                                  06414000
RVVRDCSN EQU   RVVI+44                                                  06415000
RVVRDSEQ EQU   RVVI+43                                                  06416000
RVVBLNK1 EQU   RVVI+42                                                  06417000
RVVCDATE EQU   RVVI+38                                                  06418000
RVVEXPIR EQU   RVVI+36                                                  06419000
@NM00095 EQU   RVVI+28                                                  06420000
RVVAREA  EQU   RVVI+24                                                  06421000
RVVARLN  EQU   RVVI+22                                                  06422000
RVVOLUME EQU   RVVI+8                                                   06423000
@NM00094 EQU   RVVOPCOD+1                                               06424000
GRPLEN   EQU   GRP                                                      06425000
DESCRLEN EQU   DESCR                                                    06426000
OWNERLEN EQU   OWNER                                                    06427000
FILELEN  EQU   FILE                                                     06428000
VOLLEN   EQU   VOL                                                      06429000
VSDDSN   EQU   VSDARRAY+4                                               06430000
VSDVOLCT EQU   VSDARRAY                                                 06431000
VSDFMT0  EQU   VSDBLOCK+8                                               06432000
VSDVTOCS EQU   VSDBLOCK+4                                               06433000
VSDELEM  EQU   VSDBLOCK                                                 06434000
VSDFREE  EQU   VSDUSAGE+24                                              06435000
VSDALLC  EQU   VSDUSAGE+19                                              06436000
VSDDSOR3 EQU   VSDDSORG+2                                               06437000
@NM00092 EQU   VSDDSORG                                                 06438000
VSDSCAL  EQU   VSDUSAGE+12                                              06439000
@NM00091 EQU   VSDUSEF                                                  06440000
VSDCALFR EQU   VSDUSEF                                                  06441000
@NM00090 EQU   VSDALLOC                                                 06442000
VSDABSTR EQU   VSDALLOC                                                 06443000
VSDABLK  EQU   VSDALLOC                                                 06444000
VSDATRK  EQU   VSDALLOC                                                 06445000
VSDACYL  EQU   VSDALLOC                                                 06446000
@NM00089 EQU   VSDDORG                                                  06447000
VSDOU    EQU   VSDDORG                                                  06448000
VSDOIS   EQU   VSDDORG                                                  06449000
VSDODA   EQU   VSDDORG                                                  06450000
VSDOUN   EQU   VSDDORG                                                  06451000
VSDOPS   EQU   VSDDORG                                                  06452000
VSDOPO   EQU   VSDDORG                                                  06453000
VSDEXTS  EQU   VSDUSAGE+8                                               06454000
VSDSECAL EQU   VSDUSAGE+4                                               06455000
VSDFTRK  EQU   VSDUSAGE+2                                               06456000
VSDTRKS  EQU   VSDUSAGE                                                 06457000
@NM00088 EQU   VSDSCR+5                                                 06458000
@NM00087 EQU   VSDSCRFL                                                 06459000
VSDVSAM  EQU   VSDSCRFL                                                 06460000
VSDCATLC EQU   VSDSCRFL                                                 06461000
VSDACBPT EQU   VSDSCR                                                   06462000
@NM00086 EQU   VSDSTAT+29                                               06463000
VSDPRTC  EQU   VSDSTAT+25                                               06464000
VSDCAT   EQU   VSDSTAT+22                                               06465000
VSDEXP   EQU   VSDSTAT+20                                               06466000
VSDCRE   EQU   VSDSTAT+18                                               06467000
@NM00085 EQU   VSDFLG2                                                  06468000
VSDRACF  EQU   VSDFLG2                                                  06469000
VSDERROR EQU   VSDFLG2                                                  06470000
VSDPROT  EQU   VSDFLG2                                                  06471000
VSDPWW   EQU   VSDFLG2                                                  06472000
VSDPWR   EQU   VSDFLG2                                                  06473000
@NM00084 EQU   VSDSFLG1                                                 06474000
VSDCVSAM EQU   VSDSFLG1                                                 06475000
VSDCATLG EQU   VSDSFLG1                                                 06476000
VSDVSAME EQU   VSDSFLG1                                                 06477000
VSDVSAMC EQU   VSDSFLG1                                                 06478000
VSDVTOCE EQU   VSDSFLG1                                                 06479000
VSDVTOCC EQU   VSDSFLG1                                                 06480000
VSDOWNER EQU   VSDSTAT+8                                                06481000
VSDEXPIR EQU   VSDSTAT+4                                                06482000
VSDCREAT EQU   VSDSTAT                                                  06483000
VSDFRCCL EQU   VSDVTOC+21                                               06484000
@NM00083 EQU   VSDVTOC+20                                               06485000
VSDFREXT EQU   VSDVTOC+16                                               06486000
@NM00082 EQU   VSDVTOC+15                                               06487000
VSDFRTRK EQU   VSDVTOC+11                                               06488000
@NM00081 EQU   VSDVTOC+10                                               06489000
VSDFRCYL EQU   VSDVTOC+6                                                06490000
@NM00080 EQU   VSDVTOC                                                  06491000
@NM00079 EQU   VS3FLAGS                                                 06492000
VS3SYSNM EQU   VS3FLAGS                                                 06493000
VS3UNCAT EQU   VS3FLAGS                                                 06494000
VS3SCR   EQU   VS3FLAGS                                                 06495000
VS3USAGE EQU   VS3FLAGS                                                 06496000
VS3STAT  EQU   VS3FLAGS                                                 06497000
VS3DD    EQU   VS3AGL+50                                                06498000
VS3VOL   EQU   VS3AGL+44                                                06499000
VS3POOL  EQU   VS3AGL+40                                                06500000
VS3DEV   EQU   VS3AGL+36                                                06501000
VS3UCBP  EQU   VS3AGL+32                                                06502000
VS3CREAT EQU   VS3AGL+28                                                06503000
VS3EXPIR EQU   VS3AGL+24                                                06504000
VS3AST   EQU   VS3AGL+22                                                06505000
VS3LEVLN EQU   VS3AGL+20                                                06506000
VS3LEVP  EQU   VS3AGL+16                                                06507000
VS3EXDSP EQU   VS3AGL+12                                                06508000
VS3LISTP EQU   VS3AGL+8                                                 06509000
VS3HEAD  EQU   VS3AGL                                                   06510000
@NM00078 EQU   DATESOPT                                                 06511000
DATDAYOP EQU   DATESOPT                                                 06512000
DATDTEOP EQU   DATESOPT                                                 06513000
DATSUB   EQU   DATESOPT                                                 06514000
DATADD   EQU   DATESOPT                                                 06515000
DATRETRN EQU   DATESAGL+16                                              06516000
DATDAYS  EQU   DATESAGL+12                                              06517000
DATDATE  EQU   DATESAGL+8                                               06518000
DATHEAD  EQU   DATESAGL                                                 06519000
@NM00077 EQU   SELFLAGS                                                 06520000
SELVOL   EQU   SELAGL+16                                                06521000
SELDDNP  EQU   SELAGL+12                                                06522000
SELUCBP  EQU   SELAGL+8                                                 06523000
SELHEAD  EQU   SELAGL                                                   06524000
@NM00076 EQU   UCTFLAGS                                                 06525000
UCTVSCAT EQU   UCTFLAGS                                                 06526000
UCTDD    EQU   UCTAGL+60                                                06527000
UCTVOLP  EQU   UCTAGL+56                                                06528000
UCTACBP  EQU   UCTAGL+52                                                06529000
UCTDSN   EQU   UCTAGL+8                                                 06530000
UCTHEAD  EQU   UCTAGL                                                   06531000
@NM00075 EQU   LCTFLAGS                                                 06532000
LCTVSCAT EQU   LCTFLAGS                                                 06533000
LCTOWNER EQU   LCTINFO+24                                               06534000
LCTEXPIR EQU   LCTINFO+20                                               06535000
LCTCREAT EQU   LCTINFO+16                                               06536000
LCTACBP  EQU   LCTINFO+12                                               06537000
LCTMULVC EQU   LCTINFO+8                                                06538000
LCTHEAD  EQU   LCTINFO                                                  06539000
SRTWORKP EQU   SRTAGL+28                                                06540000
SRTFLDLN EQU   SRTAGL+24                                                06541000
SRTPOSIT EQU   SRTAGL+20                                                06542000
SRTLEN   EQU   SRTAGL+16                                                06543000
SRTNUM   EQU   SRTAGL+12                                                06544000
SRTADDR  EQU   SRTAGL+8                                                 06545000
SRTHEAD  EQU   SRTAGL                                                   06546000
SV82DEBP EQU   SV82WRKP                                                 06547000
SV82TTRP EQU   SV82LIST+8                                               06548000
SV82VOLP EQU   SV82DCBP                                                 06549000
SV82UCBP EQU   SV82LIST+1                                               06550000
SV82CODE EQU   SV82LIST                                                 06551000
VOLRESV3 EQU   VOLLABEL+55                                              06552000
VOLOWNER EQU   VOLLABEL+45                                              06553000
VOLRESV1 EQU   VOLLABEL+20                                              06554000
VOLVTOC  EQU   VOLLABEL+15                                              06555000
VOLSECTY EQU   VOLLABEL+14                                              06556000
VOLSERNO EQU   VOLLABEL+8                                               06557000
VOLNO    EQU   VOLLABEL+7                                               06558000
VOLLABI  EQU   VOLLABEL+4                                               06559000
VOLKEY   EQU   VOLLABEL                                                 06560000
STAVTTR  EQU   STAEPARM+54                                              06561000
@NM00072 EQU   STARETRY                                                 06562000
STAVTOC  EQU   STARETRY                                                 06563000
STAOFF   EQU   STARETRY                                                 06564000
STAIO05  EQU   STARETRY                                                 06565000
@NM00071 EQU   STARCVY                                                  06566000
STACLEAR EQU   STARCVY                                                  06567000
STAVPOST EQU   STARCVY                                                  06568000
STAVENQ  EQU   STARCVY                                                  06569000
STAVDMNT EQU   STARCVY                                                  06570000
STAVMNT  EQU   STARCVY                                                  06571000
STATCB   EQU   STAEPARM+48                                              06572000
STARTADD EQU   STAEPARM+44                                              06573000
STAEXSAV EQU   STAEPARM+40                                              06574000
STARTSAV EQU   STAEPARM+36                                              06575000
STARTTR  EQU   STAEPARM+32                                              06576000
@NM00070 EQU   STAEPARM+30                                              06577000
STARVOL  EQU   STAEPARM+24                                              06578000
STARUCB  EQU   STAEPARM+20                                              06579000
@NM00069 EQU   STAEPARM+18                                              06580000
STAVVOL  EQU   STAEPARM+12                                              06581000
STAVUCB  EQU   STAEPARM+8                                               06582000
STAHEAD  EQU   STAEPARM                                                 06583000
RCTDSET  EQU   RCTAGL+32                                                06584000
RCTNVOL  EQU   RCTAGL+26                                                06585000
RCTOVOL  EQU   RCTAGL+20                                                06586000
RCTNDEV  EQU   RCTAGL+16                                                06587000
RCTODEV  EQU   RCTAGL+12                                                06588000
@NM00068 EQU   RCTAGL+10                                                06589000
@NM00067 EQU   RCTOPT                                                   06590000
RCTVOL   EQU   RCTOPT                                                   06591000
RCTDEV   EQU   RCTOPT                                                   06592000
RCTHEAD  EQU   RCTAGL                                                   06593000
@NM00066 EQU   VSRESOPT                                                 06594000
VSREAL   EQU   VSRESOPT                                                 06595000
VSRES    EQU   VSRESOPT                                                 06596000
@NM00065 EQU   VSMSG                                                    06597000
VSTOV    EQU   VSMSG                                                    06598000
VSFROMV  EQU   VSMSG                                                    06599000
@NM00064 EQU   VSRETURN                                                 06600000
VSUCAT   EQU   VSRETURN                                                 06601000
VSVSAM   EQU   VSRETURN                                                 06602000
@NM00063 EQU   VSCATOPT                                                 06603000
VSLIST   EQU   VSCATOPT                                                 06604000
VSSERIAL EQU   VSCATOPT                                                 06605000
VSDEVICE EQU   VSCATOPT                                                 06606000
@NM00062 EQU   VSVTOPT                                                  06607000
VSVSFLAG EQU   VSVTOPT                                                  06608000
VSALTTRK EQU   VSVTOPT                                                  06609000
VSTIME   EQU   VSVTOPT                                                  06610000
VSUCMAST EQU   VSSECOPT                                                 06611000
VSOPCAT  EQU   VSSECOPT                                                 06612000
VSUCTEST EQU   VSSECOPT                                                 06613000
VSWRITE  EQU   VSSECOPT                                                 06614000
VSREAD   EQU   VSSECOPT                                                 06615000
VSNONONV EQU   VSSECOPT                                                 06616000
VSMASTER EQU   VSSECOPT                                                 06617000
VSNOVSAM EQU   VSSECOPT                                                 06618000
VSODEVP  EQU   VS1AGL+64                                                06619000
VSOSERP  EQU   VS1AGL+60                                                06620000
VSDEVP   EQU   VS1AGL+56                                                06621000
VSSERP   EQU   VS1AGL+52                                                06622000
VSPFILEP EQU   VS1AGL+48                                                06623000
VSPSWDP  EQU   VS1AGL+44                                                06624000
VSCATDDP EQU   VS1AGL+40                                                06625000
VSACBP   EQU   VS1AGL+36                                                06626000
VSCATP   EQU   VS1AGL+32                                                06627000
VSNXTATP EQU   VS1AGL+28                                                06628000
VSNUMATP EQU   VS1AGL+24                                                06629000
VSIOP    EQU   VS1AGL+20                                                06630000
VSFILEP  EQU   VS1AGL+16                                                06631000
VSVOLP   EQU   VS1AGL+12                                                06632000
VSUCBP   EQU   VS1AGL+8                                                 06633000
VSHEAD   EQU   VS1AGL                                                   06634000
VSVTOCPT EQU   VS2AGL+48                                                06635000
@NM00061 EQU   VS2AGL+45                                                06636000
@NM00060 EQU   VS2RESOP                                                 06637000
VS2REAL  EQU   VS2RESOP                                                 06638000
VS2RES   EQU   VS2RESOP                                                 06639000
@NM00059 EQU   VS2MSG                                                   06640000
VS2TOV   EQU   VS2MSG                                                   06641000
VSVOLUME EQU   VS2AGL+29                                                06642000
@NM00058 EQU   VSLABOPT                                                 06643000
VSNOVTOC EQU   VSLABOPT                                                 06644000
VSVOLSER EQU   VSLABOPT                                                 06645000
VSOWNER  EQU   VSLABOPT                                                 06646000
VS2HEAD  EQU   VS2AGL                                                   06647000
EXPDATAL EQU   EXPARRAY+6                                               06648000
@NM00057 EQU   EXPARRAY+5                                               06649000
EXPKEYLN EQU   EXPARRAY+4                                               06650000
EXPDATAP EQU   EXPARRAY                                                 06651000
EXPRECNO EQU   EXPDATAB                                                 06652000
EXPCCHHR EQU   EXPARG+16                                                06653000
EXPCTLBK EQU   EXPARG+8                                                 06654000
EXPHEAD  EQU   EXPARG                                                   06655000
EXRWFUN  EQU   EXWRARG+46                                               06656000
@NM00056 EQU   EXSPACE+8                                                06657000
@NM00055 EQU   EXSPACE+6                                                06658000
@NM00054 EQU   EXSPACE+4                                                06659000
@NM00053 EQU   EXSPACE+1                                                06660000
@NM00052 EQU   EXSPACE                                                  06661000
EXRWKDLN EQU   EXWRARG+32                                               06662000
@NM00051 EQU   EXWRARG+31                                               06663000
EXRECNUM EQU   EXRWCHR+4                                                06664000
EXHH     EQU   EXRWCHR+2                                                06665000
EXCC     EQU   EXRWCHR                                                  06666000
EXCCWCNT EQU   EXWRARG+24                                               06667000
EXLOCPTR EQU   EXWRARG+20                                               06668000
EXRWDARE EQU   EXWRARG+16                                               06669000
EXRWIOAR EQU   EXWRARG+12                                               06670000
EXRWCTBL EQU   EXWRARG+8                                                06671000
EXRWRES  EQU   EXWRARG                                                  06672000
EXGDATAL EQU   EXGARG+30                                                06673000
@NM00050 EQU   EXGARG+29                                                06674000
EXGKEYLN EQU   EXGARG+28                                                06675000
EXGDATAP EQU   EXGARG+24                                                06676000
EXGRECNO EQU   EXGARG+20                                                06677000
EXGCCHH2 EQU   EXGARG+16                                                06678000
EXGCCHH1 EQU   EXGARG+12                                                06679000
EXGCTLBK EQU   EXGARG+8                                                 06680000
EXGHEAD  EQU   EXGARG                                                   06681000
EXOVTH   EQU   EXFLG                                                    06682000
EXORVT   EQU   EXFLG                                                    06683000
EXORDS   EQU   EXFLG                                                    06684000
EXOSPK   EQU   EXFLG                                                    06685000
EXORVS   EQU   EXFLG                                                    06686000
@NM00049 EQU   EXFLG                                                    06687000
EXOREAD  EQU   EXFLG                                                    06688000
@NM00048 EQU   EXOPT                                                    06689000
EXOREP   EQU   EXOPT                                                    06690000
EXOVTOC  EQU   EXOPT                                                    06691000
EXONEW   EQU   EXOPT                                                    06692000
EXOPASS  EQU   EXOPT                                                    06693000
EXOLAB   EQU   EXOPT                                                    06694000
EXOTAB   EQU   EXOPT                                                    06695000
EXOCTLBK EQU   EXOARG+28                                                06696000
EXOEXT   EQU   EXOARG+24                                                06697000
EXOUCB   EQU   EXOARG+20                                                06698000
EXOVSN   EQU   EXOARG+16                                                06699000
EXODSN   EQU   EXOARG+12                                                06700000
EXODDN   EQU   EXOARG+8                                                 06701000
EXOHEAD  EQU   EXOARG                                                   06702000
@NM00047 EQU   EXCLFLAG                                                 06703000
EXCLMNT  EQU   EXCLFLAG                                                 06704000
EXCLVOL  EQU   EXCLAGL+16                                               06705000
EXCLHEAD EQU   EXCLAGL                                                  06706000
@NM00046 EQU   CKFLAGS                                                  06707000
CKDMTABL EQU   CKFLAGS                                                  06708000
CKRETTYP EQU   CKFLAGS                                                  06709000
CKLABELP EQU   CKAGL+24                                                 06710000
CKDATYPE EQU   CKAGL+20                                                 06711000
CKHEAD   EQU   CKAGL                                                    06712000
PULABELP EQU   PUAGL+16                                                 06713000
PUTTRPTR EQU   PUAGL+12                                                 06714000
PUUCBPTR EQU   PUAGL+8                                                  06715000
PUHEAD   EQU   PUAGL                                                    06716000
MDR      EQU   MDVTOC+4                                                 06717000
MDHH     EQU   MDVTOC+2                                                 06718000
MDCC     EQU   MDVTOC                                                   06719000
@NM00045 EQU   MDAGL+31                                                 06720000
MDVTOCTR EQU   MDFLAGS                                                  06721000
MDFORCE  EQU   MDFLAGS                                                  06722000
MDPOST   EQU   MDFLAGS                                                  06723000
MDCLEAR  EQU   MDFLAGS                                                  06724000
MDPUAGL  EQU   MDAGL+20                                                 06725000
MDHEAD   EQU   MDAGL                                                    06726000
CTTBLRR  EQU   CTARRAY+3                                                06727000
CTTBLHH  EQU   CTARRAY+2                                                06728000
CTTBLCC  EQU   CTARRAY+1                                                06729000
CTTBLID  EQU   CTARRAY                                                  06730000
CTREALH  EQU   CTMSG+3                                                  06731000
CTREALCC EQU   CTMSG+1                                                  06732000
@NM00044 EQU   CTMSG                                                    06733000
CMNUMCRT EQU   CMMSG+15                                                 06734000
@NM00043 EQU   CMMSG+14                                                 06735000
CMNEWVOL EQU   CMMSG+8                                                  06736000
@NM00042 EQU   CMMSG+7                                                  06737000
@NM00041 EQU   CMVOLFLG                                                 06738000
CMRONLY  EQU   CMVOLFLG                                                 06739000
CMBIND   EQU   CMVOLFLG                                                 06740000
CMSCRCRT EQU   CMVOLFLG                                                 06741000
CMEXCL   EQU   CMVOLFLG                                                 06742000
CMDERAS  EQU   CMVOLFLG                                                 06743000
CMSCRVOL EQU   CMVOLFLG                                                 06744000
CMCECART EQU   CMVOLFLG                                                 06745000
CMOLDVOL EQU   CMMSG                                                    06746000
CCOLDCSN EQU   CCMSG+24                                                 06747000
CCNEWCSN EQU   CCMSG+12                                                 06748000
@NM00040 EQU   CCMSG+10                                                 06749000
CCVOL    EQU   CCMSG+4                                                  06750000
@NM00039 EQU   CCMSG+2                                                  06751000
CCEJCODE EQU   CCMSG+1                                                  06752000
CCPSTCDE EQU   CCMSG                                                    06753000
@NM00038 EQU   DMPARY+15                                                06754000
DMPARYTP EQU   DMPARY+14                                                06755000
DMPARYEX EQU   DMPARY+12                                                06756000
DMPARYIC EQU   DMPARY+10                                                06757000
DMPARYSZ EQU   DMPARY+8                                                 06758000
DMPARYNM EQU   DMPARY                                                   06759000
@NM00037 EQU   DMPITM+15                                                06760000
@NM00036 EQU   ERCNVTAB+24                                              06761000
ERDARBPT EQU   ERCPLPT                                                  06762000
ERDYNRC  EQU   ERCATRC                                                  06763000
ERDSNM   EQU   ERCNVTAB+12                                              06764000
@NM00035 EQU   ERCNVTAB+4                                               06765000
@NM00034 EQU   ERCNVTAB+3                                               06766000
@NM00033 EQU   EROSOPER                                                 06767000
EROSUCDX EQU   EROSOPER                                                 06768000
EROSCATL EQU   EROSOPER                                                 06769000
@NM00032 EQU   EROPER                                                   06770000
ERCATAL  EQU   EROPER                                                   06771000
ERCATDL  EQU   EROPER                                                   06772000
ERCATDE  EQU   EROPER                                                   06773000
ERCATLC  EQU   EROPER                                                   06774000
@NM00031 EQU   ERTYPE                                                   06775000
ERDYNAL  EQU   ERTYPE                                                   06776000
EROSCAT  EQU   ERTYPE                                                   06777000
ERCATLG  EQU   ERTYPE                                                   06778000
@NM00030 EQU   FMTCNVF+1                                                06779000
FMTAR    EQU   FMTCNVF+1                                                06780000
FMTBS    EQU   FMTCNVF+1                                                06781000
FMTSS    EQU   FMTCNVF+1                                                06782000
FMTAL    EQU   FMTCNVF+1                                                06783000
FMTZS    EQU   FMTCNVF+1                                                06784000
@NM00029 EQU   FMTCNVF                                                  06785000
FMTPU    EQU   FMTCNVF                                                  06786000
FMTBD    EQU   FMTCNVF                                                  06787000
FMTBHD   EQU   FMTCNVF                                                  06788000
FMTBHA   EQU   FMTCNVF                                                  06789000
FMTBH    EQU   FMTCNVF                                                  06790000
FMTOLEN  EQU   FMTLIST+8                                                06791000
FMTRIO   EQU   FMTOCOL                                                  06792000
FMTSPT   EQU   FMTSTO                                                   06793000
FMTSTL   EQU   FMTILEN                                                  06794000
@NM00028 EQU   FMTFLGS+1                                                06795000
FMTSMSG  EQU   FMTFLGS+1                                                06796000
FMTHDF   EQU   FMTFLGS                                                  06797000
FMTDFF   EQU   FMTFLGS                                                  06798000
FMTSTF   EQU   FMTFLGS                                                  06799000
FMTREPF  EQU   FMTFLGS                                                  06800000
FMTBDF   EQU   FMTFLGS                                                  06801000
FMTIDF   EQU   FMTFLGS                                                  06802000
FMTSCF   EQU   FMTFLGS                                                  06803000
FMTEOLF  EQU   FMTFLGS                                                  06804000
DARGPCT  EQU   DARGINL                                                  06805000
DARGREP  EQU   DARGINS                                                  06806000
@NM00027 EQU   DARGLIST+19                                              06807000
DARGIND  EQU   DARGLIST+18                                              06808000
UVOLVOL  EQU   UVOLENT+4                                                06809000
UVOLDEV  EQU   UVOLENT                                                  06810000
UVOLCNT  EQU   UVOLLIST                                                 06811000
@NM00026 EQU   IOINFOPT                                                 06812000
IOINFLUB EQU   IOINFOPT                                                 06813000
IOINFTMS EQU   IOINFOPT                                                 06814000
IOINFSUP EQU   IOINFOPT                                                 06815000
IOINFDSN EQU   IOINFOPT                                                 06816000
IOINFVOL EQU   IOINFOPT                                                 06817000
IOINFDVT EQU   IOINFOPT                                                 06818000
OPNVOL   EQU   OPNAGL+44                                                06819000
OPNSTRNO EQU   OPNAGL+43                                                06820000
@NM00025 EQU   OPNOPT2                                                  06821000
OPNOPTJM EQU   OPNOPT2                                                  06822000
OPNOPTNM EQU   OPNOPT2                                                  06823000
OPNOPTAS EQU   OPNOPT2                                                  06824000
@NM00024 EQU   OPNDSO                                                   06825000
OPNDSOPO EQU   OPNDSO                                                   06826000
OPNDSOIS EQU   OPNDSO                                                   06827000
OPNDSOPS EQU   OPNDSO                                                   06828000
OPNDSOAM EQU   OPNDSO                                                   06829000
OPNKYL   EQU   OPNAGL+40                                                06830000
OPNBLK   EQU   OPNAGL+36                                                06831000
OPNREC   EQU   OPNAGL+32                                                06832000
OPNDEVIX EQU   OPNDEV+4                                                 06833000
OPNDEVDT EQU   OPNDEV                                                   06834000
OPNCBP   EQU   OPNAGL+20                                                06835000
OPNDSN   EQU   OPNAGL+16                                                06836000
OPNPWA   EQU   OPNAGL+12                                                06837000
OPNDDN   EQU   OPNAGL+8                                                 06838000
OPNIOC   EQU   OPNAGL+4                                                 06839000
OPNMODRP EQU   OPNMOD                                                   06840000
OPNMODUB EQU   OPNMOD                                                   06841000
OPNMODRS EQU   OPNMOD                                                   06842000
OPNMODAX EQU   OPNMOD                                                   06843000
OPNMODRR EQU   OPNMOD                                                   06844000
OPNMODRC EQU   OPNMOD                                                   06845000
OPNMODAC EQU   OPNMOD                                                   06846000
OPNMODPD EQU   OPNMOD                                                   06847000
OPNTYPSY EQU   OPNTYP                                                   06848000
OPNTYPRV EQU   OPNTYP                                                   06849000
OPNTYPEX EQU   OPNTYP                                                   06850000
OPNTYPRA EQU   OPNTYP                                                   06851000
OPNTYPXM EQU   OPNTYP                                                   06852000
OPNTYPCI EQU   OPNTYP                                                   06853000
OPNTYPSO EQU   OPNTYP                                                   06854000
OPNTYPSI EQU   OPNTYP                                                   06855000
@NM00023 EQU   OPNRFM                                                   06856000
OPNRFMBK EQU   OPNRFM                                                   06857000
OPNRFMSF EQU   OPNRFM                                                   06858000
OPNRFMUN EQU   OPNRFM                                                   06859000
OPNRFMVR EQU   OPNRFM                                                   06860000
OPNRFMFX EQU   OPNRFM                                                   06861000
OPNOPTSK EQU   OPNOPT                                                   06862000
OPNOPTDR EQU   OPNOPT                                                   06863000
OPNOPTCR EQU   OPNOPT                                                   06864000
OPNOPTKS EQU   OPNOPT                                                   06865000
OPNOPTBK EQU   OPNOPT                                                   06866000
OPNOPTUP EQU   OPNOPT                                                   06867000
OPNOPTOT EQU   OPNOPT                                                   06868000
OPNOPTIN EQU   OPNOPT                                                   06869000
IOCEXT   EQU   IOCSTR+64                                                06870000
IOCTSML  EQU   IOCREL+2                                                 06871000
IOCTPML  EQU   IOCREL                                                   06872000
IOCWORK  EQU   IOCSTR+56                                                06873000
IOCRRN   EQU   IOCSTR+52                                                06874000
IOCPNM   EQU   IOCNWM+2                                                 06875000
IOCPTL   EQU   IOCNWM                                                   06876000
IOCKYA   EQU   IOCMEM                                                   06877000
IOCVRC   EQU   IOCTTR                                                   06878000
IOCCBP   EQU   IOCSTR+36                                                06879000
IOCDSN   EQU   IOCSTR+32                                                06880000
IOCHURBA EQU   IOCSTR+28                                                06881000
IOCVOLSR EQU   IOCSTR+22                                                06882000
@NM00022 EQU   IOCMSG                                                   06883000
IOCMSGSM EQU   IOCMSG                                                   06884000
IOCMSGAE EQU   IOCMSG                                                   06885000
IOCMSGCE EQU   IOCMSG                                                   06886000
IOCMSGOE EQU   IOCMSG                                                   06887000
IOCMSGOP EQU   IOCMSG                                                   06888000
IOCCHPKG EQU   IOCMSG                                                   06889000
IOCCHPKE EQU   IOCMSG                                                   06890000
IOCCHPNU EQU   IOCCHP                                                   06891000
IOCCHPUP EQU   IOCCHP                                                   06892000
IOCCHPBK EQU   IOCCHP                                                   06893000
IOCCHPCR EQU   IOCCHP                                                   06894000
IOCCHPKS EQU   IOCCHP                                                   06895000
IOCCHPSK EQU   IOCCHP                                                   06896000
IOCCHPDR EQU   IOCCHP                                                   06897000
IOCCHPSQ EQU   IOCCHP                                                   06898000
IOCMACNT EQU   IOCMAC2                                                  06899000
IOCMACER EQU   IOCMAC2                                                  06900000
IOCMACPA EQU   IOCMAC2                                                  06901000
IOCMACEN EQU   IOCMAC2                                                  06902000
IOCMACCP EQU   IOCMAC2                                                  06903000
IOCMACRR EQU   IOCMAC2                                                  06904000
IOCMACAS EQU   IOCMAC2                                                  06905000
IOCMACSK EQU   IOCMAC2                                                  06906000
@NM00021 EQU   IOCMAC                                                   06907000
IOCMACCC EQU   IOCMAC                                                   06908000
IOCMACDR EQU   IOCMAC                                                   06909000
IOCMACBK EQU   IOCMAC                                                   06910000
IOCMACCR EQU   IOCMAC                                                   06911000
IOCMACUP EQU   IOCMAC                                                   06912000
IOCMACOT EQU   IOCMAC                                                   06913000
IOCMACIN EQU   IOCMAC                                                   06914000
@NM00020 EQU   IOCRFM                                                   06915000
IOCRFMBK EQU   IOCRFM                                                   06916000
IOCRFMSF EQU   IOCRFM                                                   06917000
IOCRFMUN EQU   IOCRFM                                                   06918000
IOCRFMVR EQU   IOCRFM                                                   06919000
IOCRFMFX EQU   IOCRFM                                                   06920000
@NM00019 EQU   IOCDSO                                                   06921000
IOCDSOPO EQU   IOCDSO                                                   06922000
IOCDSOIS EQU   IOCDSO                                                   06923000
IOCDSOPS EQU   IOCDSO                                                   06924000
IOCDSOAM EQU   IOCDSO                                                   06925000
IOCRKP   EQU   IOCSTR+13                                                06926000
IOCKYL   EQU   IOCSTR+12                                                06927000
IOCTRN   EQU   IOCSTR+8                                                 06928000
IOCDLN   EQU   IOCSTR+4                                                 06929000
IOCDAD   EQU   IOCSTR                                                   06930000
UNITVTOC EQU   UNITABL+7                                                06931000
@NM00018 EQU   UNITSTAT                                                 06932000
UNITUSHR EQU   UNITSTAT                                                 06933000
UNITXSHR EQU   UNITSTAT                                                 06934000
UNITISHR EQU   UNITSTAT                                                 06935000
UNITUA   EQU   @NM00017+1                                               06936000
UNITCHA  EQU   @NM00017                                                 06937000
UNITUCB  EQU   UNITABL                                                  06938000
RACFVOLS EQU   RACFAGL+16                                               06939000
RACFCLN  EQU   RACFAGL+12                                               06940000
RACFPROF EQU   RACFAGL+8                                                06941000
RACFENT  EQU   RACFAGL+4                                                06942000
@NM00016 EQU   RACFFLG4                                                 06943000
@NM00015 EQU   RACFFLG3                                                 06944000
RACFPRF  EQU   RACFFLG3                                                 06945000
@NM00014 EQU   RACFFLG3                                                 06946000
@NM00013 EQU   RACFFLG2                                                 06947000
RACFTRD  EQU   RACFFLG2                                                 06948000
RACFTUPD EQU   RACFFLG2                                                 06949000
RACFTCTL EQU   RACFFLG2                                                 06950000
@NM00012 EQU   RACFFLG2                                                 06951000
RACFTALT EQU   RACFFLG2                                                 06952000
RACFCSA  EQU   RACFFLG1                                                 06953000
RACFLOGN EQU   RACFFLG1                                                 06954000
RACFLOGF EQU   RACFFLG1                                                 06955000
@NM00011 EQU   RACFFLG1                                                 06956000
RACFDSTV EQU   RACFFLG1                                                 06957000
@NM00010 EQU   RACFFLG1                                                 06958000
ALLUNCNT EQU   ALLAGL+30                                                06959000
ALLVLCNT EQU   ALLAGL+29                                                06960000
@NM00009 EQU   ALLOPT                                                   06961000
ALLOPTUN EQU   ALLOPT                                                   06962000
ALLOPTPV EQU   ALLOPT                                                   06963000
ALLOPTDS EQU   ALLOPT                                                   06964000
ALLOPTVL EQU   ALLOPT                                                   06965000
@NM00008 EQU   ALLORG+1                                                 06966000
ALLORGVS EQU   ALLORG+1                                                 06967000
@NM00007 EQU   ALLORG+1                                                 06968000
ALLORGGS EQU   ALLORG+1                                                 06969000
ALLORGUN EQU   ALLORG                                                   06970000
ALLORGPO EQU   ALLORG                                                   06971000
ALLORGMQ EQU   ALLORG                                                   06972000
ALLORGCQ EQU   ALLORG                                                   06973000
ALLORGCX EQU   ALLORG                                                   06974000
ALLORGDA EQU   ALLORG                                                   06975000
ALLORGPS EQU   ALLORG                                                   06976000
ALLORGIS EQU   ALLORG                                                   06977000
ALLDSPUN EQU   ALLDSP                                                   06978000
ALLDSPCG EQU   ALLDSP                                                   06979000
ALLDSPDE EQU   ALLDSP                                                   06980000
ALLDSPKP EQU   ALLDSP                                                   06981000
@NM00006 EQU   ALLDSP                                                   06982000
ALLSTSOD EQU   ALLSTS                                                   06983000
ALLSTSMD EQU   ALLSTS                                                   06984000
ALLSTSNW EQU   ALLSTS                                                   06985000
ALLSTSSR EQU   ALLSTS                                                   06986000
@NM00005 EQU   ALLSTS                                                   06987000
ALLPWD   EQU   ALLAGL+20                                                06988000
ALLVLP   EQU   ALLAGL+16                                                06989000
ALLULP   EQU   ALLAGL+12                                                06990000
ALLDDN   EQU   ALLAGL+4                                                 06991000
ALLDSN   EQU   ALLAGL                                                   06992000
CIRPID   EQU   CIRAGL+28                                                06993000
CIRPWD   EQU   CIRAGL+24                                                06994000
CIRCAT   EQU   CIRAGL+20                                                06995000
CIRWKP   EQU   CIRAGL+16                                                06996000
CIRTLR   EQU   CIRAGL+12                                                06997000
CIRHDR   EQU   CIRAGL+8                                                 06998000
CIRTLN   EQU   CIRAGL+6                                                 06999000
CIRHLN   EQU   CIRAGL+4                                                 07000000
@NM00004 EQU   CIRAGL+1                                                 07001000
@NM00003 EQU   CIRTYPE                                                  07002000
CIRTYPAQ EQU   CIRTYPE                                                  07003000
CIRTYP1Q EQU   CIRTYPE                                                  07004000
NEWID1   EQU   TRACE1+95                                                07005000
CALLID   EQU   OLDERID1+90                                              07006000
@NM00002 EQU   OLDERID1                                                 07007000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07008000
@RC00389 EQU   @RC00380                                                 07009000
@RF00398 EQU   @RC00380                                                 07010000
@RF00545 EQU   @RC00487                                                 07011000
@RF00582 EQU   @RC00572                                                 07012000
@RF00677 EQU   @RC00671                                                 07013000
@RC00705 EQU   @RC00699                                                 07014000
@RC00778 EQU   @RC00777                                                 07015000
@RC00856 EQU   @RC00826                                                 07016000
@RC00863 EQU   @RC00826                                                 07017000
@RF00932 EQU   @RC00919                                                 07018000
@RF01004 EQU   @RC00982                                                 07019000
@RF01220 EQU   @RC01205                                                 07020000
@PB00018 EQU   @EL00001                                                 07021000
@RC00391 EQU   @RC00389                                                 07022000
@RC00706 EQU   @RC00705                                                 07023000
@PB00017 EQU   @PB00018                                                 07024000
@RF00712 EQU   @RC00706                                                 07025000
@PB00016 EQU   @PB00017                                                 07026000
@PB00015 EQU   @PB00016                                                 07027000
@PB00014 EQU   @PB00015                                                 07028000
@PB00013 EQU   @PB00014                                                 07029000
@PB00012 EQU   @PB00013                                                 07030000
@PB00011 EQU   @PB00012                                                 07031000
@PB00010 EQU   @PB00011                                                 07032000
@PB00009 EQU   @PB00010                                                 07033000
@PB00008 EQU   @PB00009                                                 07034000
@PB00007 EQU   @PB00008                                                 07035000
@PB00006 EQU   @PB00007                                                 07036000
@PB00005 EQU   @PB00006                                                 07037000
@PB00004 EQU   @PB00005                                                 07038000
@PB00003 EQU   @PB00004                                                 07039000
@PB00002 EQU   @PB00003                                                 07040000
@ENDDATA EQU   *                                                        07041000
         END   IDCCV01,(C'PLS1930',0701,78164)                          07042000
