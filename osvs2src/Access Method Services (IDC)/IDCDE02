         TITLE '*********** IDCDE02: IDCAMS DEFINE ROUTINE - LEVEL 3 ***00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
        MACRO                                                           00013000
        FREEMAIN &MODE,&LV=,&LA=,&A=,&SP=,&MF=I                         00014000
        MEND                                                            00015000
IDCDE02  CSECT ,                                                   0003 00016000
@MAINENT DS    0H                                                  0003 00017000
         USING *,@15                                               0003 00018000
         B     @PROLOG                                             0003 00019000
         DC    AL1(16)                                             0003 00020000
         DC    C'IDCDE02   77.228'                                 0003 00021000
         DROP  @15                                                      00022000
@PROLOG  STM   @14,@06,12(@13)                                     0003 00023000
         STM   @08,@12,52(@13)                                     0003 00024000
         BALR  @12,0                                               0003 00025000
@PSTART  LA    @11,4095(,@12)                                      0003 00026000
         LA    @10,4095(,@11)                                      0003 00027000
         USING @PSTART,@12                                         0003 00028000
         USING @PSTART+4095,@11                                    0003 00029000
         USING @PSTART+8190,@10                                    0003 00030000
         L     @00,@SIZDATD                                        0003 00031000
         GETMAIN  R,LV=(0)                                              00032000
         LR    @07,@01                                             0003 00033000
         USING @DATD,@07                                           0003 00034000
         ST    @13,@SA00001+4                                      0003 00035000
         LM    @00,@01,20(@13)                                     0003 00036000
         ST    @07,8(,@13)                                         0003 00037000
         LR    @13,@07                                             0003 00038000
         MVC   @PC00001(12),0(@01)                                 0003 00039000
*                                                                  0623 00040000
*        OLDERID2 = NEWERID2;                                      0624 00041000
         L     @06,@PC00001                                        0624 00042000
         L     @06,GDTTR2(,@06)                                    0624 00043000
         MVC   @TS00001(95),NEWERID2(@06)                          0624 00044000
         MVC   OLDERID2(95,@06),@TS00001                           0624 00045000
*        NEWID2 = 'DE30';                                  /*@Y30SSJH*/ 00046000
*                                                                  0625 00047000
         MVC   NEWID2(4,@06),@CC02513                              0625 00048000
*        STM(REG10,REG12,BASESAVE);    /* INTERNAL CODEREG   @Y30SSJH*/ 00049000
*                                                                  0626 00050000
         STM   REG10,REG12,BASESAVE                                0626 00051000
*        RETURN;                       /*  RETURN TO IDCDE01 @Y30SSJH*/ 00052000
*                                                                  0627 00053000
@EL00001 L     @13,4(,@13)                                         0627 00054000
@EF00001 L     @00,@SIZDATD                                        0627 00055000
         LR    @01,@07                                             0627 00056000
         FREEMAIN R,LV=(0),A=(1)                                        00057000
@ER00001 LM    @14,@06,12(@13)                                     0627 00058000
         LM    @08,@12,52(@13)                                     0627 00059000
         BR    @14                                                 0627 00060000
*        /************************************************************/ 00061000
*        /* PROCEDURE NAME - NAMEPROC (LEVEL 3 PARAMETER PROCESSOR)  */ 00062000
*        /*                                                          */ 00063000
*        /* FUNCTION - NAMEPROC INITIALIZES THE FOLLOWING ITEMS:     */ 00064000
*        /*            DSETCRDT FPL - DATA SET CREATION DATE FPL     */ 00065000
*        /*            DSETEXDT FPL - DATA SET EXPIRATION DATE FPL   */ 00066000
*        /*            GDG ATTRIBUTES - SCRATCH|NOSCRATCH,   @Y30SSJH*/ 00067000
*        /*              EMPTY|NOEMPTY AND LIMIT ARE INITIALIZED     */ 00068000
*        /*              IN THE PSEUDO FIELDS WHICH ARE CONTAINED    */ 00069000
*        /*              IN THE FPLAREA.                     @Y30SSJH*/ 00070000
*        /*            ALIAS - THE TRUE NAME IS REFERENCED   @Y30SSJH*/ 00071000
*        /*              DIRECTLY FROM THE ALIAS FVT.        @Y30SSJH*/ 00072000
*        /*            EXCPEXIT FPL - EXCEPTION EXIT FPL     @Y30SSJH*/ 00073000
*        /*            OBJECT NAME IN FVT                            */ 00074000
*        /*            RELATED NAME/PASSWORD IN AIX FVT      @Y30SSJH*/ 00075000
*        /*            PATHENTRY NAME/PASSWORD IN PATH FVT   @Y30SSJH*/ 00076000
*        /*                                                          */ 00077000
*        /*            THE FVT BEING CONSTRUCTED IS ESTABLISHED PRIOR*/ 00078000
*        /*            TO ENTERING NAMEPROC, THUS THIS PROCEDURE IS  */ 00079000
*        /*            BLIND TO THE TYPE OF OBJECT BEING INITIALIZED */ 00080000
*        /*                                                          */ 00081000
*        /* INPUT -                                                  */ 00082000
*        /*            DEFSTID - GLOBAL INTERNAL STATUS COMMUNICATOR */ 00083000
*        /*            CTGFV - THE CURRENT FVT ADDRESSING IS ESTAB-  */ 00084000
*        /*              LISHED GLOBALLY IN THE LEVEL TWO PROCESSOR  */ 00085000
*        /*            SEE DEFINITION OF ARGUMENTS OF INVOCATION FOR */ 00086000
*        /*            EXPLICIT ARGUMENTS                            */ 00087000
*        /*                                                          */ 00088000
*        /* OUTPUT -                                                 */ 00089000
*        /*            DEFSTID - GLOBAL PROCESSING STATUS, SET ON    */ 00090000
*        /*              ERROR DETECTION:                            */ 00091000
*        /*                DEFSTID = NOSTORAG                        */ 00092000
*        /*            DSETCRDT FPL CREATED AND REFERENCED IN FVT    */ 00093000
*        /*            DSETEXDT FPL CREATED AND REFERENCED IN FVT    */ 00094000
*        /*            CTGFVENT - INITIALIZED TO ADDRESS OF OBJECT   */ 00095000
*        /*              NAME.                                       */ 00096000
*        /*            CTGFVGAT - REFERENCES THE GDG ATTRIBUTES      */ 00097000
*        /*            CTGFVLMT - REFERENCES THE GDG LIMIT   @Y30SSJH*/ 00098000
*        /*            CTGFVNAM - REFERENCES THE ALIAS TRUE NAME     */ 00099000
*        /*                                                          */ 00100000
*        /************************************************************/ 00101000
*                                                                  0628 00102000
*NAMEPROC:                                                         0628 00103000
*    PROCEDURE(ETRY,ETO,EFOR,EGENSC,EGENEM,EGENLM,EALREL,          0628 00104000
*        EEEXT,EREL,EMODLTAB)                                      0628 00105000
*          OPTIONS(SAVEAREA);                              /*@Y30SSJH*/ 00106000
NAMEPROC STM   @14,@12,12(@13)                                     0628 00107000
         ST    @13,@SA00002+4                                      0628 00108000
         LA    @14,@SA00002                                        0628 00109000
         ST    @14,8(,@13)                                         0628 00110000
         LR    @13,@14                                             0628 00111000
         MVC   @PC00002(40),0(@01)                                 0628 00112000
*        GEN (ENTRY NAMEPROC );      /* EXTERNAL ENTRY POINT @Y30SSJH*/ 00113000
         ENTRY NAMEPROC                                                 00114000
*        LM(REG10,REG12,BASESAVE);      /* LOAD PROC CODEREG @Y30SSJH*/ 00115000
         LM    REG10,REG12,BASESAVE                                0630 00116000
*                                                                  0631 00117000
*        /************************************************************/ 00118000
*        /*                                                          */ 00119000
*        /* ARGUMENTS OF INVOCATION                                  */ 00120000
*        /*                                                          */ 00121000
*        /************************************************************/ 00122000
*                                                                  0631 00123000
*        DCL                                                       0631 00124000
*          ETRY,                       /* OBJECT NAME                */ 00125000
*          ETO,                        /* SPECIFIC EXPIRATION DATE   */ 00126000
*          EFOR,                       /* EXPIRATION IN DAY INCREMENT*/ 00127000
*          EGENSC,                     /* GDG SCRATCH OPTION @Y30SSJH*/ 00128000
*          EGENEM,                     /* GDG EMPTY OPTION   @Y30SSJH*/ 00129000
*          EGENLM,                     /* GDG LIMIT ATTRIBUTE        */ 00130000
*          EALREL,                     /* ALIAS TRUE NAME    @Y30SSJH*/ 00131000
*          EEEXT,                      /* EXCEPTION EXIT NAME@Y30SSJH*/ 00132000
*          EREL,                       /* RELATED OR PATHENTRY     0631 00133000
*                                         NAME               @Y30SSJH*/ 00134000
*          EMODLTAB;                   /* MODEL TABLE                */ 00135000
*                                                                  0631 00136000
*        /************************************************************/ 00137000
*        /*                                                          */ 00138000
*        /* STRUCTURE FOR REFERENCING THE POSSIBLE FPLS BUILT        */ 00139000
*        /* BY NAMEPROC: DSETCRDT FPL ,DSETEXDT FPL AND      @Y30SSJH*/ 00140000
*        /*              EXCPEXIT FPL                        @Y30SSJH*/ 00141000
*        /*                                                          */ 00142000
*        /************************************************************/ 00143000
*                                                                  0632 00144000
*        DCL                                                       0632 00145000
*          NFPLPTR  PTR(31);                                       0632 00146000
*        DCL                                                       0633 00147000
*          1 FPLAREA BASED(NFPLPTR) BDY(WORD),                     0633 00148000
*            2 FPLEEXT   CHAR(LENGTH(CTGFL)),              /*@Y30SSJH*/ 00149000
*            2 *         CHAR(8),                          /*@Y30SSJH*/ 00150000
*            2 FPLCRDT   CHAR(LENGTH(CTGFL)),                      0633 00151000
*            2 *         CHAR(8),                                  0633 00152000
*            2 FPLEXPDT  CHAR(LENGTH(CTGFL)),                      0633 00153000
*            2 *         CHAR(8),                                  0633 00154000
*            2 EXPIREDT  CHAR(8),                                  0633 00155000
*              3 *     CHAR(5),                                    0633 00156000
*              3 EXPIRE CHAR(3),       /* EXPDAT REFERENCED BY FPL   */ 00157000
*                4 EXPIRYR FIXED(8) BDY(BYTE),                     0633 00158000
*                4 EXPIRDAY FIXED(15) BDY(BYTE),                   0633 00159000
*            2 GENDATTR  CHAR(1),      /* GDG ATTRIBUTES     @Y30SSJH*/ 00160000
*              3 GENDEPTY BIT(1),      /* GDG EMPTY/NOEMPTY  @Y30SSJH*/ 00161000
*              3 GENDSCR  BIT(1),      /* GDG SCRATCH/NOSCR  @Y30SSJH*/ 00162000
*              3 *       BIT(6),       /* RESERVED           @Y30SSJH*/ 00163000
*            2 GENDLIMT  FIXED(8),     /* GDG LIMIT          @Y30SSJH*/ 00164000
*            2 ALRELLN   FIXED(15),    /* ALIAS NAME LENGTH  @Y30SSJH*/ 00165000
*            2 ALRELPTR  PTR(31),      /* PTR TO TRUE NAME   @Y30SSJH*/ 00166000
*            2 ALRELNM   CHAR(44);     /* HOLDER FOR TRUE NAME       */ 00167000
*                                                                  0633 00168000
*        /************************************************************/ 00169000
*        /*                                                          */ 00170000
*        /* FIELD NAMES REFERENCED IN THE FPLS                       */ 00171000
*        /*                                                          */ 00172000
*        /************************************************************/ 00173000
*                                                                  0634 00174000
*        DCL                                                       0634 00175000
*          DSETCRDT CHAR(8) INIT('DSETCRDT') STATIC,               0634 00176000
*          DSETEXDT CHAR(8) INIT('DSETEXDT') STATIC,               0634 00177000
*          EXCPEXIT CHAR(8) INIT('EXCPEXIT') STATIC;       /*@Y30SSJH*/ 00178000
*                                                                  0634 00179000
*        /************************************************************/ 00180000
*        /*                                                          */ 00181000
*        /* AREA FOR RETURN OF TIME AND DATE                         */ 00182000
*        /*                                                          */ 00183000
*        /************************************************************/ 00184000
*        DCL                                                       0635 00185000
*          1 CREATEDT CHAR(8) BDY(WORD),                           0635 00186000
*            2 *       CHAR(1),                                    0635 00187000
*            2 XUTYEAR FIXED(8),                                   0635 00188000
*            2 XUTDAY  FIXED(15);                                  0635 00189000
*        DCL                                                       0636 00190000
*          TIMEODAY CHAR(8);                                       0636 00191000
*                                                                  0636 00192000
*        DCL                                                       0637 00193000
*          1 CNVTYEAR BIT(16) BDY(BYTE),                           0637 00194000
*            2 CVTYEAR BIT(8),                                     0637 00195000
*            2 CVTPACK BIT(8);                                     0637 00196000
*                                                                  0637 00197000
*        DCL                                                       0638 00198000
*          SHIFTVAL FIXED(8) CONSTANT(4);                          0638 00199000
*                                                                  0638 00200000
*        /************************************************************/ 00201000
*        /*                                                          */ 00202000
*        /* TEMPORARY WORKAREAS USED IN COMPUTING AND CONVERTING THE */ 00203000
*        /* EXPIRATION DATE INTO THE 3 BYTE PACKED DECIMAL FORMAT    */ 00204000
*        /*                                                          */ 00205000
*        /************************************************************/ 00206000
*        DCL                                                       0639 00207000
*          1 DAYTOTAL    CHAR(8) BDY(DWORD),                       0639 00208000
*            2 *     CHAR(6),                                      0639 00209000
*            2 DAYTOTL FIXED(15);                                  0639 00210000
*        DCL                                                       0640 00211000
*          NOWYEAR     FIXED(31);      /* CURRENT LOOP YEAR          */ 00212000
*                                                                  0640 00213000
*        DCL                                                       0641 00214000
*          DAYPERYR    FIXED(15);      /* DAYS IN CURRENT YEAR       */ 00215000
*                                                                  0641 00216000
*        DCL                                                       0642 00217000
*          DATELOOP    CHAR(1);        /* YRDYLOOP CONTROL FLAG      */ 00218000
*        /************************************************************/ 00219000
*        /*                                                          */ 00220000
*        /* ENTRY POINT OF NAMEPROC                                  */ 00221000
*        /*                                                          */ 00222000
*        /************************************************************/ 00223000
*                                                                  0643 00224000
*        OLDERID2 = NEWERID2;                                      0643 00225000
         L     @06,@PC00001                                        0643 00226000
         L     @15,GDTTR2(,@06)                                    0643 00227000
         MVC   @TS00001(95),NEWERID2(@15)                          0643 00228000
         MVC   OLDERID2(95,@15),@TS00001                           0643 00229000
*        NEWID2 = 'DE31';                                          0644 00230000
*                                                                  0644 00231000
         MVC   NEWID2(4,@15),@CC02582                              0644 00232000
*        /************************************************************/ 00233000
*        /*                                                          */ 00234000
*        /* GET DYNAMIC STORAGE FOR ALL FPLS - THIS IS DONE ON FIRST */ 00235000
*        /* PASS ONLY IN DATA AND INDEX COMPONENTS                   */ 00236000
*        /*                                                          */ 00237000
*        /************************************************************/ 00238000
*        IF NAMEFLG = GO                                           0645 00239000
*          THEN                                                    0645 00240000
         L     @15,@PC00001+8                                      0645 00241000
         CLI   NAMEFLG(@15),X'00'                                  0645 00242000
         BNE   @RF00645                                            0645 00243000
*            DO;                                                   0646 00244000
*                                                                  0646 00245000
*            CALL IDCSAGP0 (GDTTBL,                                0647 00246000
*                    (LENGTH(FPLAREA)),  /* LENGTH OF AREA           */ 00247000
*                    NFPLPTR,            /* ADDRESS OF AREA          */ 00248000
*                    DEGPID,             /* POOL ID                  */ 00249000
*                    SETZERO);           /* SET AREA TO ZERO         */ 00250000
*                                                                  0647 00251000
         ST    @06,@AL00001                                        0647 00252000
         LA    @09,132                                             0647 00253000
         ST    @09,@AFTEMPS                                        0647 00254000
         LA    @09,@AFTEMPS                                        0647 00255000
         ST    @09,@AL00001+4                                      0647 00256000
         LA    @09,NFPLPTR                                         0647 00257000
         ST    @09,@AL00001+8                                      0647 00258000
         LA    @09,DEGPID                                          0647 00259000
         ST    @09,@AL00001+12                                     0647 00260000
         LA    @09,SETZERO                                         0647 00261000
         ST    @09,@AL00001+16                                     0647 00262000
         MVI   @AL00001+16,X'80'                                   0647 00263000
         L     @15,GDTGPL(,@06)                                    0647 00264000
         LA    @01,@AL00001                                        0647 00265000
         BALR  @14,@15                                             0647 00266000
*            RESPECIFY RTNREG RSTD;                                0648 00267000
*            TESTRC = RTNREG;                                      0649 00268000
         LR    TESTRC,RTNREG                                       0649 00269000
*            RESPECIFY RTNREG UNRSTD;                              0650 00270000
*                                                                  0650 00271000
*            IF TESTRC ^= 0                                        0651 00272000
*              THEN                                                0651 00273000
         LTR   TESTRC,TESTRC                                       0651 00274000
         BZ    @RF00651                                            0651 00275000
*                DO;                                               0652 00276000
*                                                                  0652 00277000
*                DEFSTID = NOSTORAG;                               0653 00278000
         L     @06,@PC00001+8                                      0653 00279000
         MVC   DEFSTID(5,@06),@CB02317                             0653 00280000
*                RETURN;                                           0654 00281000
*                                                                  0654 00282000
@EL00002 L     @13,4(,@13)                                         0654 00283000
@EF00002 DS    0H                                                  0654 00284000
@ER00002 LM    @14,@12,12(@13)                                     0654 00285000
         BR    @14                                                 0654 00286000
*                END;                                              0655 00287000
*                                                                  0655 00288000
*            NAMEFLG = STOP;                                       0656 00289000
*                                                                  0656 00290000
@RF00651 L     @06,@PC00001+8                                      0656 00291000
         MVI   NAMEFLG(@06),X'0F'                                  0656 00292000
*            /********************************************************/ 00293000
*            /*                                                      */ 00294000
*            /* BUILD DSETCRDT FPL - CREATION DATE                   */ 00295000
*            /*                                                      */ 00296000
*            /********************************************************/ 00297000
*            CTGFLPTR = ADDR(FPLCRDT);                             0657 00298000
         L     CTGFLPTR,NFPLPTR                                    0657 00299000
         LA    CTGFLPTR,FPLCRDT(,CTGFLPTR)                         0657 00300000
*            CTGFVCRE = CTGFLPTR;                                  0658 00301000
         L     @06,CTGFVPTR(,@06)                                  0658 00302000
         ST    CTGFLPTR,CTGFVCRE(,@06)                             0658 00303000
*            CTGFLDNO = 1;                                         0659 00304000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0659 00305000
*            CTGFLDNM = ADDR(DSETCRDT);                            0660 00306000
         LA    @06,DSETCRDT                                        0660 00307000
         ST    @06,CTGFLDNM(,CTGFLPTR)                             0660 00308000
*            CTGFLNG(1) = 3;                                       0661 00309000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00163                        0661 00310000
*            CTGFLPT(1) = ADDR(XUTYEAR);                           0662 00311000
*                                                                  0662 00312000
         LA    @06,XUTYEAR                                         0662 00313000
         ST    @06,CTGFLPT(,CTGFLPTR)                              0662 00314000
*            CALL IDCSATI0 (GDTTBL,TIMEODAY,CREATEDT);             0663 00315000
*                                                                  0663 00316000
         L     @06,@PC00001                                        0663 00317000
         ST    @06,@AL00001                                        0663 00318000
         LA    @15,TIMEODAY                                        0663 00319000
         ST    @15,@AL00001+4                                      0663 00320000
         LA    @15,CREATEDT                                        0663 00321000
         ST    @15,@AL00001+8                                      0663 00322000
         MVI   @AL00001+8,X'80'                                    0663 00323000
         L     @15,GDTTIM(,@06)                                    0663 00324000
         LA    @01,@AL00001                                        0663 00325000
         BALR  @14,@15                                             0663 00326000
*            END;                                                  0664 00327000
*        /************************************************************/ 00328000
*        /*                                                          */ 00329000
*        /* INITIALIZE POINTER TO ENTRY NAME                         */ 00330000
*        /*                                                          */ 00331000
*        /************************************************************/ 00332000
*                                                                  0665 00333000
*        IF (ADDR(ETRY)) ^= NULLPTR                                0665 00334000
*          THEN DO;                                                0665 00335000
@RF00645 L     @06,@PC00002                                        0665 00336000
         LTR   @06,@06                                             0665 00337000
         BZ    @RF00665                                            0665 00338000
*            FDTTBLPT = ADDR(ETRY);                                0667 00339000
         LR    FDTTBLPT,@06                                        0667 00340000
*            CTGFVENT = ADDR(NAMVAL);                              0668 00341000
*                                                                  0668 00342000
         L     @06,@PC00001+8                                      0668 00343000
         L     @05,CTGFVPTR(,@06)                                  0668 00344000
         LA    @15,NAMVAL(,FDTTBLPT)                               0668 00345000
         ST    @15,CTGFVENT(,@05)                                  0668 00346000
*            /********************************************************/ 00347000
*            /*                                              @Y30SSJH*/ 00348000
*            /* GDG NAMES CANNOT EXCEED 35 CHARACTERS.       @Y30SSJH*/ 00349000
*            /*                                              @Y30SSJH*/ 00350000
*            /********************************************************/ 00351000
*                                                                  0669 00352000
*            IF CTGFVTYP = CTGFVGBS    &                           0669 00353000
*               NAMLEN > MAXGDGNM                                  0669 00354000
*              THEN                                                0669 00355000
         CLI   CTGFVTYP(@05),C'B'                                  0669 00356000
         BNE   @RF00669                                            0669 00357000
         CLI   NAMLEN(FDTTBLPT),35                                 0669 00358000
         BNH   @RF00669                                            0669 00359000
*                DO;                                       /*@Y30SSJH*/ 00360000
*                                                                  0670 00361000
*                DEFSTID = GDGNAMER;                       /*@Y30SSJH*/ 00362000
         MVC   DEFSTID(5,@06),@CB02350                             0671 00363000
*                RETURN;                                   /*@Y30SSJH*/ 00364000
*                                                                  0672 00365000
         B     @EL00002                                            0672 00366000
*                END;                                      /*@Y30SSJH*/ 00367000
*                                                                  0673 00368000
*            END;                                                  0674 00369000
*                                                                  0674 00370000
@RF00669 DS    0H                                                  0675 00371000
*        /************************************************************/ 00372000
*        /*                                                          */ 00373000
*        /* INITIALIZE THE DATA SET EXPIRATION DATE FPL - THE DATE   */ 00374000
*        /* MAY BE SPECIFIED IN THREE WAYS:                          */ 00375000
*        /*  . USER SPECIFICATION OF A SPECIFIC DATE                 */ 00376000
*        /*  . USER SPECIFICATION OF AN INCREMENT TO CURRENT DATE    */ 00377000
*        /*  . FROM THE MODEL OBJECT                                 */ 00378000
*        /*                                                          */ 00379000
*        /************************************************************/ 00380000
*                                                                  0675 00381000
*        /************************************************************/ 00382000
*        /*                                                          */ 00383000
*        /* COMPUTE THE EXPIRATION DATE FROM THAT DATE SPECIFIED BY  */ 00384000
*        /* THE USER - THE USER DATE RESIDES IN THE FDTTBL IN BINARY */ 00385000
*        /* THE INITIALIZATION ROUTINE CONVERTS THE VALUE TO PACKED  */ 00386000
*        /* DECIMAL FOR INSERTION INTO THE VSAM CATALOG      @Y30SSJH*/ 00387000
*        /*                                                          */ 00388000
*        /************************************************************/ 00389000
*                                                                  0675 00390000
*        IF (ADDR(ETO)) ^= NULLPTR                                 0675 00391000
*          THEN                                                    0675 00392000
@RF00665 L     @06,@PC00002+4                                      0675 00393000
         LTR   @06,@06                                             0675 00394000
         BZ    @RF00675                                            0675 00395000
*TOLOOP:     DO;                                                   0676 00396000
*                                                                  0676 00397000
TOLOOP   DS    0H                                                  0677 00398000
*            RFY (REG5,REG6) RESTRICTED;                           0677 00399000
*            FDTTBLPT = ADDR(ETO);                                 0678 00400000
         L     FDTTBLPT,@PC00002+4                                 0678 00401000
*            REG6 = NUMBVAL;                                       0679 00402000
         L     REG6,NUMBVAL(,FDTTBLPT)                             0679 00403000
*            REG5 = ADDR(EXPIREDT);                                0680 00404000
*                                                                  0680 00405000
         L     REG5,NFPLPTR                                        0680 00406000
         LA    REG5,EXPIREDT(,REG5)                                0680 00407000
*            GENERATE(CVD REG6,0(0,REG5));                         0681 00408000
*                                                                  0681 00409000
         CVD REG6,0(0,REG5)                                             00410000
*            RFY (REG5,REG6) UNRESTRICTED;                         0682 00411000
*            CTGFVEXP = ADDR(FPLEXPDT);                            0683 00412000
*                                                                  0683 00413000
         L     @06,@PC00001+8                                      0683 00414000
         L     @06,CTGFVPTR(,@06)                                  0683 00415000
         L     @01,NFPLPTR                                         0683 00416000
         LA    @15,FPLEXPDT(,@01)                                  0683 00417000
         ST    @15,CTGFVEXP(,@06)                                  0683 00418000
*            END TOLOOP;                                           0684 00419000
*                                                                  0684 00420000
*          /**********************************************************/ 00421000
*          /*                                                        */ 00422000
*          /* COMPUTE THE EXPIRATION DATE VIA THE USER SPECIFIED     */ 00423000
*          /* INCREMENT - THIS BINARY VALUE IN THE FDTTBL IS ADDED   */ 00424000
*          /* TO THE CURRENT DAY VALUE FROM UTIME. THE LOOP WILL     */ 00425000
*          /* ADJUST THE YEAR AND DAY COMPONENTS ALLOWING FOR BOTH   */ 00426000
*          /* LEAP YEAR AND NON LEAP YEARS                   @Y30SSJH*/ 00427000
*          /*                                                        */ 00428000
*          /**********************************************************/ 00429000
*          ELSE                                                    0685 00430000
*                                                                  0685 00431000
*            IF (ADDR(EFOR)) ^= NULLPTR                            0685 00432000
*              THEN                                                0685 00433000
         B     @RC00675                                            0685 00434000
@RF00675 L     @06,@PC00002+8                                      0685 00435000
         LTR   @06,@06                                             0685 00436000
         BZ    @RF00685                                            0685 00437000
*FORLOOP:        DO;                                               0686 00438000
*                                                                  0686 00439000
FORLOOP  DS    0H                                                  0687 00440000
*                FDTTBLPT = ADDR(EFOR);                            0687 00441000
         L     FDTTBLPT,@PC00002+8                                 0687 00442000
*                CTGFVEXP = ADDR(FPLEXPDT);                        0688 00443000
*                                                                  0688 00444000
         L     @06,@PC00001+8                                      0688 00445000
         L     @06,CTGFVPTR(,@06)                                  0688 00446000
         L     @05,NFPLPTR                                         0688 00447000
         LA    @15,FPLEXPDT(,@05)                                  0688 00448000
         ST    @15,CTGFVEXP(,@06)                                  0688 00449000
*                /****************************************************/ 00450000
*                /*                                                  */ 00451000
*                /* WHEN THE INCREMENT IS GREATER THAN FIVE YEARS    */ 00452000
*                /* FROM THE CURRENT DATE THE MAXIMUM EXPIRATION DATE*/ 00453000
*                /* IS USED                                          */ 00454000
*                /*                                                  */ 00455000
*                /****************************************************/ 00456000
*                IF NUMBVAL >= MAXEXPDT                            0689 00457000
*                  THEN                                            0689 00458000
         L     @06,NUMBVAL(,FDTTBLPT)                              0689 00459000
         C     @06,@CF02367                                        0689 00460000
         BL    @RF00689                                            0689 00461000
*                    EXPIRE   = '99999F'X;                         0690 00462000
*                                                                  0690 00463000
         MVC   EXPIRE(3,@05),@CB02587                              0690 00464000
*                  /**************************************************/ 00465000
*                  /*                                                */ 00466000
*                  /* THE INCREMENT IS NOT WITHIN THE MAXIMUM        */ 00467000
*                  /* DATE RANGE - COMPUTE THE DATE                  */ 00468000
*                  /*                                                */ 00469000
*                  /**************************************************/ 00470000
*                  ELSE                                            0691 00471000
*DAYFORLP:           DO;                                           0691 00472000
*                                                                  0691 00473000
         B     @RC00689                                            0691 00474000
@RF00689 DS    0H                                                  0691 00475000
DAYFORLP DS    0H                                                  0692 00476000
*                    DATELOOP = GO;                                0692 00477000
         MVI   DATELOOP,X'00'                                      0692 00478000
*                    RFY (REG5) RESTRICTED;                        0693 00479000
*                    DAYTOTAL = ''B;                               0694 00480000
         XC    DAYTOTAL(8),DAYTOTAL                                0694 00481000
*                    DAYTOTL = XUTDAY;                             0695 00482000
*                                                                  0695 00483000
         LH    @06,XUTDAY                                          0695 00484000
         STH   @06,DAYTOTL                                         0695 00485000
*                    GEN(CVB 5,DAYTOTAL);                          0696 00486000
*                                                                  0696 00487000
         CVB 5,DAYTOTAL                                                 00488000
*                    REG5 = REG5 + NUMBVAL;                        0697 00489000
         AL    REG5,NUMBVAL(,FDTTBLPT)                             0697 00490000
*                    NOWYEAR = XUTYEAR;                    /*@OZ05948*/ 00491000
         SLR   @06,@06                                             0698 00492000
         IC    @06,XUTYEAR                                         0698 00493000
         LR    NOWYEAR,@06                                         0698 00494000
*                    CVTYEAR = XUTYEAR;                    /*@OZ05948*/ 00495000
         STC   @06,CVTYEAR                                         0699 00496000
*                    CVTPACK = 'F0'X;                      /*@OZ05948*/ 00497000
         MVI   CVTPACK,X'F0'                                       0700 00498000
*                    SRL(CNVTYEAR,SHIFTVAL);               /*@OZ05948*/ 00499000
         SLR   @06,@06                                             0701 00500000
         ICM   @06,3,CNVTYEAR                                      0701 00501000
         SRL   @06,4                                               0701 00502000
         STCM  @06,3,CNVTYEAR                                      0701 00503000
*                    CVB(NOWYEAR,CNVTYEAR);                /*@OZ05948*/ 00504000
*                                                                  0702 00505000
         XC    @TS00001(8),@TS00001                                0702 00506000
         MVC   @TS00001+6(2),CNVTYEAR                              0702 00507000
         CVB   NOWYEAR,@TS00001                                    0702 00508000
*                      /**********************************************/ 00509000
*                      /*                                            */ 00510000
*                      /* LOOP THRU THE DAY TOTAL ALLOWING FOR LEAP  */ 00511000
*                      /* YEARS AS THEY OCCUR                        */ 00512000
*                      /*                                            */ 00513000
*                      /**********************************************/ 00514000
*                                                                  0703 00515000
*YRDYLOOP:             DO N = 1 TO 6                               0703 00516000
*                         WHILE DATELOOP = GO;                     0703 00517000
*                                                                  0703 00518000
YRDYLOOP LA    N,1                                                 0703 00519000
@DL00703 CLI   DATELOOP,X'00'                                      0703 00520000
         BNE   @DC00703                                            0703 00521000
*                      IF (NOWYEAR // 4) = 0                       0704 00522000
*                        THEN                                      0704 00523000
         LR    @00,NOWYEAR                                         0704 00524000
         SRDA  @00,32                                              0704 00525000
         D     @00,@CF00043                                        0704 00526000
         LTR   @00,@00                                             0704 00527000
         BNZ   @RF00704                                            0704 00528000
*                          DAYPERYR = LEAPYEAR;            /*@OZ05948*/ 00529000
*                                                                  0705 00530000
         LA    DAYPERYR,366                                        0705 00531000
*                        ELSE                                      0706 00532000
*                          DAYPERYR = NOLEAPYR;                    0706 00533000
*                                                                  0706 00534000
         B     @RC00704                                            0706 00535000
@RF00704 LA    DAYPERYR,365                                        0706 00536000
*                      IF (REG5 - DAYPERYR) > 0                    0707 00537000
*                        THEN                                      0707 00538000
@RC00704 LR    @06,REG5                                            0707 00539000
         SLR   @06,DAYPERYR                                        0707 00540000
         LTR   @06,@06                                             0707 00541000
         BNP   @RF00707                                            0707 00542000
*                          DO;                                     0708 00543000
*                                                                  0708 00544000
*                          REG5 = REG5 - DAYPERYR;                 0709 00545000
         SLR   REG5,DAYPERYR                                       0709 00546000
*                          NOWYEAR = NOWYEAR +1;                   0710 00547000
*                                                                  0710 00548000
         AL    NOWYEAR,@CF00220                                    0710 00549000
*                          END;                                    0711 00550000
*                                                                  0711 00551000
*                        ELSE                                      0712 00552000
*                          DATELOOP = STOP;                        0712 00553000
         B     @RC00707                                            0712 00554000
@RF00707 MVI   DATELOOP,X'0F'                                      0712 00555000
*                      END YRDYLOOP;                               0713 00556000
*                                                                  0713 00557000
@RC00707 AL    N,@CF00220                                          0713 00558000
         C     N,@CF00157                                          0713 00559000
         BNH   @DL00703                                            0713 00560000
@DC00703 DS    0H                                                  0714 00561000
*                    CVD(NOWYEAR,CNVTYEAR);                /*@OZ05948*/ 00562000
         CVD   NOWYEAR,@TS00001                                    0714 00563000
         MVC   CNVTYEAR(2),@TS00001+6                              0714 00564000
*                    SLL(CNVTYEAR,SHIFTVAL);               /*@OZ05948*/ 00565000
         SLR   @06,@06                                             0715 00566000
         ICM   @06,3,CNVTYEAR                                      0715 00567000
         SLL   @06,4                                               0715 00568000
         STCM  @06,3,CNVTYEAR                                      0715 00569000
*                    EXPIRYR = CVTYEAR;                    /*@OZ05948*/ 00570000
         IC    @06,CVTYEAR                                         0716 00571000
         L     @04,NFPLPTR                                         0716 00572000
         STC   @06,EXPIRYR(,@04)                                   0716 00573000
*                    GEN(CVD 5,DAYTOTAL);                          0717 00574000
         CVD 5,DAYTOTAL                                                 00575000
*                    EXPIRDAY = DAYTOTL;                           0718 00576000
*                                                                  0718 00577000
         LH    @06,DAYTOTL                                         0718 00578000
         L     @04,NFPLPTR                                         0718 00579000
         STH   @06,EXPIRDAY(,@04)                                  0718 00580000
*                    END DAYFORLP;                                 0719 00581000
*                                                                  0719 00582000
*                END FORLOOP;                                      0720 00583000
*              /******************************************************/ 00584000
*              /*                                                    */ 00585000
*              /* TAKE THE EXPIRATION DATE DIRECTLY FROM THE MODEL   */ 00586000
*              /* OBJECT                                             */ 00587000
*              /*                                                    */ 00588000
*              /******************************************************/ 00589000
*              ELSE                                                0721 00590000
*                IF MDLEXDT ^= NULLPTR   &                         0721 00591000
*                   (CTGFVTYP = 'C' |                      /*@Y30SSJH*/ 00592000
*                    CTGFVTYP = 'G' |                      /*@Y30SSJH*/ 00593000
*                    CTGFVTYP = 'R')                       /*@Y30SSJH*/ 00594000
*                  THEN                                            0721 00595000
         B     @RC00685                                            0721 00596000
@RF00685 L     @06,@PC00001+8                                      0721 00597000
         L     @04,MDLTBLPT(,@06)                                  0721 00598000
         L     @04,MDLEXDT(,@04)                                   0721 00599000
         LTR   @04,@04                                             0721 00600000
         BZ    @RF00721                                            0721 00601000
         L     @06,CTGFVPTR(,@06)                                  0721 00602000
         CLI   CTGFVTYP(@06),C'C'                                  0721 00603000
         BE    @RT00721                                            0721 00604000
         CLI   CTGFVTYP(@06),C'G'                                  0721 00605000
         BE    @RT00721                                            0721 00606000
         CLI   CTGFVTYP(@06),C'R'                                  0721 00607000
         BNE   @RF00721                                            0721 00608000
@RT00721 DS    0H                                                  0722 00609000
*                    DO;                                           0722 00610000
*                                                                  0722 00611000
*                    EXPIRE = MDLEXPDT;                            0723 00612000
         L     @06,NFPLPTR                                         0723 00613000
         L     @04,@PC00001+8                                      0723 00614000
         L     @01,MDLTBLPT(,@04)                                  0723 00615000
         L     @01,MDLEXDT(,@01)                                   0723 00616000
         MVC   EXPIRE(3,@06),MDLEXPDT(@01)                         0723 00617000
*                    CTGFVEXP = ADDR(FPLEXPDT);                    0724 00618000
*                                                                  0724 00619000
         L     @04,CTGFVPTR(,@04)                                  0724 00620000
         LA    @06,FPLEXPDT(,@06)                                  0724 00621000
         ST    @06,CTGFVEXP(,@04)                                  0724 00622000
*                    END;                                          0725 00623000
*                                                                  0725 00624000
*        /************************************************************/ 00625000
*        /*                                                          */ 00626000
*        /* BUILD THE DSETEXDT FPL IF THE EXPIRATION DATE HAS BEEN   */ 00627000
*        /* SET IN ONE OF THE ABOVE THREE SECTIONS                   */ 00628000
*        /*                                                          */ 00629000
*        /************************************************************/ 00630000
*        IF CTGFVEXP ^= NULLPTR                                    0726 00631000
*          THEN                                                    0726 00632000
@RF00721 DS    0H                                                  0726 00633000
@RC00685 DS    0H                                                  0726 00634000
@RC00675 L     @06,@PC00001+8                                      0726 00635000
         L     @06,CTGFVPTR(,@06)                                  0726 00636000
         L     @06,CTGFVEXP(,@06)                                  0726 00637000
         LTR   @06,@06                                             0726 00638000
         BZ    @RF00726                                            0726 00639000
*            DO;                                                   0727 00640000
*                                                                  0727 00641000
*            CTGFLPTR = CTGFVEXP;                                  0728 00642000
         LR    CTGFLPTR,@06                                        0728 00643000
*            CTGFLDNO = 1;                                         0729 00644000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0729 00645000
*            CTGFLDNM = ADDR(DSETEXDT);                            0730 00646000
         LA    @06,DSETEXDT                                        0730 00647000
         ST    @06,CTGFLDNM(,CTGFLPTR)                             0730 00648000
*            CTGFLNG(1) = 3;                                       0731 00649000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00163                        0731 00650000
*            CTGFLPT(1) = ADDR(EXPIRE);                            0732 00651000
*                                                                  0732 00652000
         L     @06,NFPLPTR                                         0732 00653000
         LA    @06,EXPIRE(,@06)                                    0732 00654000
         ST    @06,CTGFLPT(,CTGFLPTR)                              0732 00655000
*            END;                                                  0733 00656000
*        /************************************************************/ 00657000
*        /*                                                  @Y30SSJH*/ 00658000
*        /* ATTRIBUTES INDIGENOUS TO A GDG BASE ARE SET HERE @Y30SSJH*/ 00659000
*        /*                                                  @Y30SSJH*/ 00660000
*        /************************************************************/ 00661000
*        IF CTGFVTYP = CTGFVGBS                                    0734 00662000
*          THEN                                                    0734 00663000
@RF00726 L     @06,@PC00001+8                                      0734 00664000
         L     @06,CTGFVPTR(,@06)                                  0734 00665000
         CLI   CTGFVTYP(@06),C'B'                                  0734 00666000
         BNE   @RF00734                                            0734 00667000
*            DO;                                           /*@Y30SSJH*/ 00668000
*                                                                  0735 00669000
*            /********************************************************/ 00670000
*            /*                                              @Y30SSJH*/ 00671000
*            /* REFERENCE GDG ATTRIBUTES FIELD FROM FVT      @Y30SSJH*/ 00672000
*            /*                                              @Y30SSJH*/ 00673000
*            /********************************************************/ 00674000
*                                                                  0736 00675000
*            CTGFVGAT = ADDR(GENDATTR);                    /*@Y30SSJH*/ 00676000
*                                                                  0736 00677000
         L     @04,NFPLPTR                                         0736 00678000
         LA    @15,GENDATTR(,@04)                                  0736 00679000
         ST    @15,CTGFVGAT(,@06)                                  0736 00680000
*            /********************************************************/ 00681000
*            /*                                              @Y30SSJH*/ 00682000
*            /* TURN FLAG ON INDICATING GDG SCRATCH OPTION   @Y30SSJH*/ 00683000
*            /*                                              @Y30SSJH*/ 00684000
*            /********************************************************/ 00685000
*                                                                  0737 00686000
*            IF (ADDR(EGENSC)) ^= NULLPTR                          0737 00687000
*              THEN                                                0737 00688000
         L     @06,@PC00002+12                                     0737 00689000
         LTR   @06,@06                                             0737 00690000
         BZ    @RF00737                                            0737 00691000
*                GENDSCR = ON;                             /*@Y30SSJH*/ 00692000
*                                                                  0738 00693000
         OI    GENDSCR(@04),B'01000000'                            0738 00694000
*            /********************************************************/ 00695000
*            /*                                              @Y30SSJH*/ 00696000
*            /* SET EMPTY FLAG IN GDG ATTRIBUTES FIELD       @Y30SSJH*/ 00697000
*            /*                                              @Y30SSJH*/ 00698000
*            /********************************************************/ 00699000
*                                                                  0739 00700000
*            IF (ADDR(EGENEM)) ^= NULLPTR                          0739 00701000
*              THEN                                                0739 00702000
@RF00737 L     @06,@PC00002+16                                     0739 00703000
         LTR   @06,@06                                             0739 00704000
         BZ    @RF00739                                            0739 00705000
*                GENDEPTY = ON;                            /*@Y30SSJH*/ 00706000
*                                                                  0740 00707000
         L     @06,NFPLPTR                                         0740 00708000
         OI    GENDEPTY(@06),B'10000000'                           0740 00709000
*            /********************************************************/ 00710000
*            /*                                              @Y30SSJH*/ 00711000
*            /* MOVE THE GDG LIMIT VALUE TO THE ONE BYTE     @Y30SSJH*/ 00712000
*            /* REQUIRED BY VSAM CATALOG MANAGEMENT AND      @Y30SSJH*/ 00713000
*            /* REFERENCE THAT AREA FROM THE FVT.            @Y30SSJH*/ 00714000
*            /*                                              @Y30SSJH*/ 00715000
*            /********************************************************/ 00716000
*                                                                  0741 00717000
*            FDTTBLPT = ADDR(EGENLM);                      /*@Y30SSJH*/ 00718000
@RF00739 L     FDTTBLPT,@PC00002+20                                0741 00719000
*            GENDLIMT = NUMBVAL;                           /*@Y30SSJH*/ 00720000
         L     @06,NFPLPTR                                         0742 00721000
         L     @15,NUMBVAL(,FDTTBLPT)                              0742 00722000
         STC   @15,GENDLIMT(,@06)                                  0742 00723000
*            CTGFVLMT = ADDR(GENDLIMT);                    /*@Y30SSJH*/ 00724000
*                                                                  0743 00725000
         L     @04,@PC00001+8                                      0743 00726000
         L     @04,CTGFVPTR(,@04)                                  0743 00727000
         LA    @06,GENDLIMT(,@06)                                  0743 00728000
         ST    @06,CTGFVLMT(,@04)                                  0743 00729000
*            END;                                          /*@Y30SSJH*/ 00730000
*        /************************************************************/ 00731000
*        /*                                                  @Y30SSJH*/ 00732000
*        /* PROCESS THE ALIAS RELATE PARAMETER               @Y30SSJH*/ 00733000
*        /*                                                  @Y30SSJH*/ 00734000
*        /************************************************************/ 00735000
*        IF (ADDR(EALREL)) ^= NULLPTR                              0745 00736000
*          THEN                                                    0745 00737000
@RF00734 L     @06,@PC00002+24                                     0745 00738000
         LTR   @06,@06                                             0745 00739000
         BZ    @RF00745                                            0745 00740000
*            DO;                                           /*@Y30SSJH*/ 00741000
*                                                                  0746 00742000
*            FDTTBLPT = ADDR(EALREL);  /* SET OVERLAY BASE   @Y30SSJH*/ 00743000
         LR    FDTTBLPT,@06                                        0747 00744000
*            ALRELNM  = NAMVAL;        /* MOVE TRUE NAME     @Y30SSJH*/ 00745000
*                                                                  0748 00746000
         L     @06,NFPLPTR                                         0748 00747000
         MVC   ALRELNM(44,@06),NAMVAL(FDTTBLPT)                    0748 00748000
*            IF NAMFUQ = ON                                        0749 00749000
*              THEN                                                0749 00750000
         TM    NAMFUQ(FDTTBLPT),B'10000000'                        0749 00751000
         BNO   @RF00749                                            0749 00752000
*                /****************************************************/ 00753000
*                /*                                          @Y30SSJH*/ 00754000
*                /* THE NAME IS NOT FULLY QUALIFIED, ISSUE   @Y30SSJH*/ 00755000
*                /* THE UQUAL MACRO TO FULLY QUALIFY THE     @Y30SSJH*/ 00756000
*                /* TRUE NAME OF THE ALIAS ENTRY.            @Y30SSJH*/ 00757000
*                /*                                          @Y30SSJH*/ 00758000
*                /****************************************************/ 00759000
*QQUAL01:        DO;                                       /*@Y30SSJH*/ 00760000
*                                                                  0750 00761000
QQUAL01  DS    0H                                                  0751 00762000
*                QDSNPTR = ADDR(NAMVAL);                   /*@Y30SSJH*/ 00763000
         LA    @06,NAMVAL(,FDTTBLPT)                               0751 00764000
         ST    @06,QDSNPTR                                         0751 00765000
*                QDSNLEN = NAMLEN;                         /*@Y30SSJH*/ 00766000
*                                                                  0752 00767000
         SLR   @06,@06                                             0752 00768000
         IC    @06,NAMLEN(,FDTTBLPT)                               0752 00769000
         STH   @06,QDSNLEN                                         0752 00770000
*                IF (ADDR(CAT)) ^= NULLPTR                         0753 00771000
*                  THEN                                            0753 00772000
         L     @06,@PC00001+4                                      0753 00773000
         L     @04,FDTPTR(,@06)                                    0753 00774000
         LTR   @04,@04                                             0753 00775000
         BZ    @RF00753                                            0753 00776000
*                    DO;                                   /*@Y30SSJH*/ 00777000
*                                                                  0754 00778000
*                    QCATPTR = ADDR(CATLGVAL);             /*@Y30SSJH*/ 00779000
*                                                                  0755 00780000
         L     @06,FDTPTR+4(,@06)                                  0755 00781000
         LA    @04,CATLGVAL(,@06)                                  0755 00782000
         ST    @04,QCATPTR                                         0755 00783000
*                    IF CATLGPLN ^= 0                              0756 00784000
*                      THEN                                        0756 00785000
         CLI   CATLGPLN(@06),0                                     0756 00786000
         BE    @RF00756                                            0756 00787000
*                        QCATPSWD = ADDR(CATLGPAS);        /*@Y30SSJH*/ 00788000
*                                                                  0757 00789000
         LA    @06,CATLGPAS(,@06)                                  0757 00790000
         ST    @06,QCATPSWD                                        0757 00791000
*                    END;                                  /*@Y30SSJH*/ 00792000
*                  ELSE                                            0759 00793000
*                    DO;                                   /*@Y30SSJH*/ 00794000
*                                                                  0759 00795000
         B     @RC00753                                            0759 00796000
@RF00753 DS    0H                                                  0760 00797000
*                    QCATPTR = NULLPTR;                    /*@Y30SSJH*/ 00798000
         SLR   @06,@06                                             0760 00799000
         ST    @06,QCATPTR                                         0760 00800000
*                    QCATPSWD = NULLPTR;                   /*@Y30SSJH*/ 00801000
*                                                                  0761 00802000
         ST    @06,QCATPSWD                                        0761 00803000
*                    END;                                  /*@Y30SSJH*/ 00804000
*                                                                  0762 00805000
*                CALL IDCSAQL0 (GDTTBL,                            0763 00806000
*                  QDSNPTR,            /* PTR TO DSNAME      @Y30SSJH*/ 00807000
*                  QDSNLEN,            /* LENGTH OF DSNAME   @Y30SSJH*/ 00808000
*                  QCATPTR,            /* PTR TO CAT NAME    @Y30SSJH*/ 00809000
*                  QCATPSWD);          /* PTR TO CAT PSWD    @Y30SSJH*/ 00810000
*                                                                  0763 00811000
@RC00753 L     @09,@PC00001                                        0763 00812000
         ST    @09,@AL00001                                        0763 00813000
         LA    @06,QDSNPTR                                         0763 00814000
         ST    @06,@AL00001+4                                      0763 00815000
         LA    @06,QDSNLEN                                         0763 00816000
         ST    @06,@AL00001+8                                      0763 00817000
         LA    @06,QCATPTR                                         0763 00818000
         ST    @06,@AL00001+12                                     0763 00819000
         LA    @06,QCATPSWD                                        0763 00820000
         ST    @06,@AL00001+16                                     0763 00821000
         MVI   @AL00001+16,X'80'                                   0763 00822000
         L     @15,GDTQAL(,@09)                                    0763 00823000
         LA    @01,@AL00001                                        0763 00824000
         BALR  @14,@15                                             0763 00825000
*                RESPECIFY RTNREG RSTD;                            0764 00826000
*                TESTRC = RTNREG;                                  0765 00827000
         LR    TESTRC,RTNREG                                       0765 00828000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSJH*/ 00829000
*                                                                  0766 00830000
*                IF TESTRC ^= 0                                    0767 00831000
*                  THEN                                            0767 00832000
         LTR   TESTRC,TESTRC                                       0767 00833000
         BZ    @RF00767                                            0767 00834000
*                    DO;                                   /*@Y30SSJH*/ 00835000
*                                                                  0768 00836000
*                    DEFSTID = TERMERR;                    /*@Y30SSJH*/ 00837000
         L     @06,@PC00001+8                                      0769 00838000
         MVC   DEFSTID(5,@06),@CB02326                             0769 00839000
*                    RETURN;                               /*@Y30SSJH*/ 00840000
*                                                                  0770 00841000
         B     @EL00002                                            0770 00842000
*                    END;                                  /*@Y30SSJH*/ 00843000
*                END QQUAL01;                              /*@Y30SSJH*/ 00844000
*                                                                  0772 00845000
@RF00767 DS    0H                                                  0773 00846000
*            CTGFVNAM = ADDR(ALRELNM);                     /*@Y30SSJH*/ 00847000
*                                                                  0773 00848000
@RF00749 L     @06,@PC00001+8                                      0773 00849000
         L     @06,CTGFVPTR(,@06)                                  0773 00850000
         L     @04,NFPLPTR                                         0773 00851000
         LA    @04,ALRELNM(,@04)                                   0773 00852000
         ST    @04,CTGFVNAM(,@06)                                  0773 00853000
*            END;                                          /*@Y30SSJH*/ 00854000
*                                                                  0774 00855000
*        /************************************************************/ 00856000
*        /*                                                  @Y30SSJH*/ 00857000
*        /* BUILD EXCPEXIT FPL - EXCEPTION EXIT NAME         @Y30SSJH*/ 00858000
*        /*                                                  @Y30SSJH*/ 00859000
*        /************************************************************/ 00860000
*                                                                  0775 00861000
*        CTGFLPTR = ADDR(FPLEEXT);                         /*@Y30SSJH*/ 00862000
@RF00745 L     CTGFLPTR,NFPLPTR                                    0775 00863000
*        CTGFLDNO = 1;                                     /*@Y30SSJH*/ 00864000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0776 00865000
*        CTGFLNG(1) = 8;                                   /*@Y30SSJH*/ 00866000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00180                        0777 00867000
*        CTGFLDNM = ADDR(EXCPEXIT);                        /*@Y30SSJH*/ 00868000
*                                                                  0778 00869000
         LA    @06,EXCPEXIT                                        0778 00870000
         ST    @06,CTGFLDNM(,CTGFLPTR)                             0778 00871000
*        IF ADDR(EEEXT) ^= NULLPTR                                 0779 00872000
*          THEN                                                    0779 00873000
         L     @06,@PC00002+28                                     0779 00874000
         LTR   @06,@06                                             0779 00875000
         BZ    @RF00779                                            0779 00876000
*            DO;                                           /*@Y30SSJH*/ 00877000
*                                                                  0780 00878000
*            CTGFVEXT = CTGFLPTR;                          /*@Y30SSJH*/ 00879000
         L     @02,@PC00001+8                                      0781 00880000
         L     @02,CTGFVPTR(,@02)                                  0781 00881000
         ST    CTGFLPTR,CTGFVEXT(,@02)                             0781 00882000
*            FDTTBLPT = ADDR(EEEXT);                       /*@Y30SSJH*/ 00883000
         LR    FDTTBLPT,@06                                        0782 00884000
*            CTGFLPT(1) = ADDR(CHARVAL);                   /*@Y30SSJH*/ 00885000
*                                                                  0783 00886000
         LA    @06,CHARVAL(,FDTTBLPT)                              0783 00887000
         ST    @06,CTGFLPT(,CTGFLPTR)                              0783 00888000
*            END;                                          /*@Y30SSJH*/ 00889000
*                                                                  0784 00890000
*          ELSE                                                    0785 00891000
*            IF (ADDR(MCAT)) = NULLPTR &                           0785 00892000
*               (ADDR(UCAT)) = NULLPTR &                           0785 00893000
*               (ADDR(PGSP)) = NULLPTR &                   /*@Y30SSJH*/ 00894000
*               (ADDR(PATH)) = NULLPTR &                   /*@Y30SSJH*/ 00895000
*               MDLEEXIT ^=NULLPTR                                 0785 00896000
*              THEN                                                0785 00897000
         B     @RC00779                                            0785 00898000
@RF00779 SLR   @06,@06                                             0785 00899000
         L     @04,@PC00001+4                                      0785 00900000
         C     @06,FDTPTR+12(,@04)                                 0785 00901000
         BNE   @RF00785                                            0785 00902000
         C     @06,FDTPTR+16(,@04)                                 0785 00903000
         BNE   @RF00785                                            0785 00904000
         C     @06,FDTPTR+24(,@04)                                 0785 00905000
         BNE   @RF00785                                            0785 00906000
         C     @06,FDTPTR+56(,@04)                                 0785 00907000
         BNE   @RF00785                                            0785 00908000
         L     @04,@PC00001+8                                      0785 00909000
         L     @02,MDLTBLPT(,@04)                                  0785 00910000
         L     @02,MDLEEXIT(,@02)                                  0785 00911000
         CR    @02,@06                                             0785 00912000
         BE    @RF00785                                            0785 00913000
*                DO;                                       /*@Y30SSJH*/ 00914000
*                                                                  0786 00915000
*                CTGFVEXT = CTGFLPTR;                      /*@Y30SSJH*/ 00916000
         L     @06,CTGFVPTR(,@04)                                  0787 00917000
         ST    CTGFLPTR,CTGFVEXT(,@06)                             0787 00918000
*                CTGFLPT(1) = MDLEEXIT;                    /*@Y30SSJH*/ 00919000
*                                                                  0788 00920000
         ST    @02,CTGFLPT(,CTGFLPTR)                              0788 00921000
*                END;                                      /*@Y30SSJH*/ 00922000
*                                                                  0789 00923000
*        /************************************************************/ 00924000
*        /*                                                  @Y30SSJH*/ 00925000
*        /* INITIALIZE POINTER TO RELATED NAME (AIX) OR      @Y30SSJH*/ 00926000
*        /* PATHENTRY NAME (PATH) AND ASSOCIATED PASSWORD    @Y30SSJH*/ 00927000
*        /*                                                  @Y30SSJH*/ 00928000
*        /************************************************************/ 00929000
*                                                                  0790 00930000
*        IF (ADDR(EREL)) ^= NULLPTR                                0790 00931000
*          THEN                                                    0790 00932000
@RF00785 DS    0H                                                  0790 00933000
@RC00779 L     @06,@PC00002+32                                     0790 00934000
         LTR   @06,@06                                             0790 00935000
         BZ    @RF00790                                            0790 00936000
*            DO;                                           /*@Y30SSJH*/ 00937000
*                                                                  0791 00938000
*            FDTTBLPT = ADDR(EREL);                        /*@Y30SSJH*/ 00939000
         LR    FDTTBLPT,@06                                        0792 00940000
*            CTGFVNAM = ADDR(NAMVAL);                      /*@Y30SSJH*/ 00941000
*                                                                  0793 00942000
         L     @06,@PC00001+8                                      0793 00943000
         L     @06,CTGFVPTR(,@06)                                  0793 00944000
         LA    @15,NAMVAL(,FDTTBLPT)                               0793 00945000
         ST    @15,CTGFVNAM(,@06)                                  0793 00946000
*            IF NAMPLN ^= 0                                        0794 00947000
*              THEN                                                0794 00948000
         CLI   NAMPLN(FDTTBLPT),0                                  0794 00949000
         BE    @RF00794                                            0794 00950000
*                CTGFVPWD = ADDR(NAMPAS);                  /*@Y30SSJH*/ 00951000
*                                                                  0795 00952000
         LA    @15,NAMPAS(,FDTTBLPT)                               0795 00953000
         ST    @15,CTGFVPWD(,@06)                                  0795 00954000
*            END;                                          /*@Y30SSJH*/ 00955000
*                                                                  0796 00956000
*        /************************************************************/ 00957000
*        /*                                                          */ 00958000
*        /* THIS COMPLETES NAMEPROC PROCESSING RETURN TO CALLER      */ 00959000
*        /*                                                          */ 00960000
*        /************************************************************/ 00961000
*                                                                  0797 00962000
*        RETURN;                                                   0797 00963000
*                                                                  0797 00964000
         B     @EL00002                                            0797 00965000
*END NAMEPROC;                                                     0798 00966000
*                                                                  0798 00967000
         B     @EL00002                                            0798 00968000
*ALLCPROC:                                                         0799 00969000
*/********************************************************************/ 00970000
*/*                                                                  */ 00971000
*/* PROCEDURE NAME - ALLCPROC (LEVEL 3 PARAMETER PROCESSOR)          */ 00972000
*/*                                                                  */ 00973000
*/* FUNCTION - ALLCPROC INITIALIZES THE FOLLOWING ITEMS:             */ 00974000
*/*      . DSATTR FPL - DATA SET ATTRIBUTES FPL                      */ 00975000
*/*          UNIQUE/SUBALLOCATE                              @Y30SSJH*/ 00976000
*/*          SPEED/RECOVERY                                  @Y30SSJH*/ 00977000
*/*          RECOVERABLE/NOTRECOVERABLE                      @Y30SSJH*/ 00978000
*/*      . LRECL FPL  - LOGICAL RECORD SIZE FPL                      */ 00979000
*/*      . BUFSIZE FPL - BUFFERSIZE FPL                              */ 00980000
*/*      . SPACPARM FPL - SPACE PARAMETER COMBINATION FPL            */ 00981000
*/*      . DEVTYP FPL - DEVICETYPE FPL                               */ 00982000
*/*      . AMDSBCAT FIELD IS INITIALIZED BUT NOT CREATED IN ALLCPROC */ 00983000
*/*        THE FIELDS INITIALIZED ARE:                               */ 00984000
*/*            AMDPCTCA   - CONTROL AREA FREESPACE                   */ 00985000
*/*            AMDPCTCI   - CONTROL INTERVAL FREESPACE               */ 00986000
*/*            AMDLRECL   - MAXIMUM RECORD SIZE                      */ 00987000
*/*            AMDWCK     - WRITECHECK/NOWRITECHECK OPTION           */ 00988000
*/*            AMDORDR    - ORDERED/UNORDERED OPTION                 */ 00989000
*/*            AMDCINV    - CONTROL INTERVAL SIZE                    */ 00990000
*/*      . CTGFVIND - THE JCL NAME FOR VOLUMES OF THIS OBJECT(IN FVT)*/ 00991000
*/*      . VOLSER LIST - LIST OF VOLUME SERIAL NUMBERS               */ 00992000
*/*                                                                  */ 00993000
*/*      ALLCPROC RECEIVES ATTRIBUTES FROM TWO SOURCES: EXPLICIT     */ 00994000
*/*      ARGUMENTS DERIVED FROM THE FDTTBL AND FROM AMDTBL ( THE     */ 00995000
*/*      MODEL TABLE). EXPLICIT ATTRIBUTES OVERRIDE THE MODEL        */ 00996000
*/*      ATTRIBUTES.                                                 */ 00997000
*/*                                                                  */ 00998000
*/*      . DEFSTID - GLOBAL INTERNAL STATUS COMMUNICATOR             */ 00999000
*/*      . CTGFV   - THE CURRENT FVT IS ESTABLISHED EXTERNALLY BY    */ 01000000
*/*        LEVEL TWO PROCESSOR                                       */ 01001000
*/*      . SEE DEFINITION OF ARGUMENTS OF INVOCATION                 */ 01002000
*/*                                                                  */ 01003000
*/* OUTPUT -                                                         */ 01004000
*/*      . DEFSTID - GLOBAL PROCESSING STATUS, SET ON ERROR DETECTION*/ 01005000
*/*                  DEFSTID = NOSTORAG                              */ 01006000
*/*      . CREATION AND/OR INITIALIZATION OF ITEMS MENTIONED ABOVE   */ 01007000
*/*                                                                  */ 01008000
*/********************************************************************/ 01009000
*        PROCEDURE(AINDDN,AVLSR,AORDR,AUORD,ASUBA,AUNIQ,   /*@Y30SSJH*/ 01010000
*          ATRKS,ACYLD,ARCDS,APTRK,APCYL,APRCD,ASTRK,ASCYL,        0799 01011000
*          ASRCD,ACAND,ARSIZ,AARSZ,AMRSZ,AWCHK,ANWCK,ASPED,ARECV,AFSPC, 01012000
*          ACIFS,ACAFS,ABFSZ,ACINV,ADEVICE,AAFSNO,         /*@Y30SSJH*/ 01013000
*          ARVBL,ANRVL,ASTAGE,ABINDD,ACYLFF,ANSTGW,        /*@Y30SSJH*/ 01014000
*          ASTGWW,AMDTBL)                                          0799 01015000
*          OPTIONS(SAVEAREA);                              /*@Y30SSJH*/ 01016000
ALLCPROC STM   @14,@12,12(@13)                                     0799 01017000
         ST    @13,@SA00003+4                                      0799 01018000
         LA    @14,@SA00003                                        0799 01019000
         ST    @14,8(,@13)                                         0799 01020000
         LR    @13,@14                                             0799 01021000
         MVC   @PC00003(152),0(@01)                                0799 01022000
*        GEN (ENTRY ALLCPROC);     /* EXTERNAL ENTRY POINT   @Y30SSJH*/ 01023000
         ENTRY ALLCPROC                                                 01024000
*        LM(REG10,REG12,BASESAVE);      /* LOAD PROC CODEREG @Y30SSJH*/ 01025000
         LM    REG10,REG12,BASESAVE                                0801 01026000
*        /************************************************************/ 01027000
*        /*                                                          */ 01028000
*        /* ARGUMENTS OF INVOCATION                                  */ 01029000
*        /*                                                          */ 01030000
*        /************************************************************/ 01031000
*        DCL                                                       0802 01032000
*          (AINDDN,                    /* JCL STATEMENT NAME @Y30SSJH*/ 01033000
*           AVLSR,                     /* ALLOCATION VOLUMES         */ 01034000
*           AORDR,                     /* ALLOCATE VOLS IN ORDER     */ 01035000
*           AUORD,                     /* VOLUMES NOT ALLOC IN ORDER */ 01036000
*           ASUBA,                     /* SUBALLOCATE SPACE          */ 01037000
*           AUNIQ,                     /* UNIQUE SPACE               */ 01038000
*           ATRKS,                     /* ALLOCATION IN TRACKS       */ 01039000
*           ACYLD,                     /* ALLOCATION IN CYLINDERS    */ 01040000
*           ARCDS,                     /* ALLOCATION IN RECORDS      */ 01041000
*           APTRK,                     /* PRIMARY TRACK ALLOCATION   */ 01042000
*           APCYL,                     /* PRIMARY CYLINDER ALLOCATION*/ 01043000
*           APRCD,                     /* PRIMARY RECORD ALLOCATION  */ 01044000
*           ASTRK,                     /* SECONDARY TRACK ALLOCATION */ 01045000
*           ASCYL,                     /* SECONDARY CYL ALLOCATION   */ 01046000
*           ASRCD,                     /* SECONDARY RECD ALLOCATION  */ 01047000
*           ACAND,                     /* VOLUME IS CANDIDATE        */ 01048000
*           ARSIZ,                     /* RECORD SIZE INDICATOR      */ 01049000
*           AARSZ,                     /* AVERAGE RECORD SIZE        */ 01050000
*           AMRSZ,                     /* MAXIMUM RECORD SIZE        */ 01051000
*           AWCHK,                     /* WRITECHECK OPTION          */ 01052000
*           ANWCK,                     /* NOWRITECHECK OPTION        */ 01053000
*           ADEVICE,                   /* DEVICETYPES                */ 01054000
*           AAFSNO,                    /* FILE SEQUENCE NUMBER       */ 01055000
*           ASPED,                     /* SPEED OPTION               */ 01056000
*           ARECV,                     /* RECOVERY OPTION            */ 01057000
*           AFSPC,                     /* FREESPACE INDICATOR        */ 01058000
*           ACIFS,                     /* CONTROL INTERVAL FREESPACE */ 01059000
*           ACAFS,                     /* CONTROL AREA FREESPACE     */ 01060000
*           ABFSZ,                     /* BUFFERSIZE                 */ 01061000
*           ACINV,                     /* CONTROLINTERVAL SIZE       */ 01062000
*           ARVBL,                     /* RECOVERABLE        @Y30SSJH*/ 01063000
*           ANRVL,                     /* NOTRECOVERABLE     @Y30SSJH*/ 01064000
*           ASTAGE,                    /* SS/1 STAGE         @Y30SSJH*/ 01065000
*           ABINDD,                    /* SS/1 BIND          @Y30SSJH*/ 01066000
*           ACYLFF,                    /* SS/1 CYLINDERFAULT @Y30SSJH*/ 01067000
*           ANSTGW,                    /* SS/1 NODESTAGEWAIT @Y30SSJH*/ 01068000
*           ASTGWW,                    /* SS/1 DESTAGEWAIT   @Y30SSJH*/ 01069000
*           AMDLTABL);                 /* MODELTABLE                 */ 01070000
*                                                                  0803 01071000
*        /************************************************************/ 01072000
*        /*                                                          */ 01073000
*        /* OVERLAY OF FPLS BUILT BY ALLOCPROC PLUS SPACPARM AND     */ 01074000
*        /* DATA SET ATTRIBUTES AREA                         @Y30SSJH*/ 01075000
*        /*                                                          */ 01076000
*        /************************************************************/ 01077000
*                                                                  0803 01078000
*        DCL                                                       0803 01079000
*          1 AFPLAREA  BASED(FPLSTPTR) BDY(WORD),                  0803 01080000
*            2 ADSATRFL  CHAR(LENGTH(CTGFL)),                      0803 01081000
*            2 *     CHAR(8),                                      0803 01082000
*            2 ALRECLFL  CHAR(LENGTH(CTGFL)),                      0803 01083000
*            2 *         CHAR(8),                                  0803 01084000
*            2 ABFSZFL   CHAR(LENGTH(CTGFL)),                      0803 01085000
*            2 *         CHAR(8),                                  0803 01086000
*            2 ASPACFL   CHAR(LENGTH(CTGFL)),                      0803 01087000
*            2 *         CHAR(8),                                  0803 01088000
*            2 ADEVTFL CHAR(LENGTH(CTGFL)),                        0803 01089000
*            2 *       CHAR(8),                                    0803 01090000
*            2 AFSEQFL  CHAR(LENGTH(CTGFL)),                       0803 01091000
*            2 *        CHAR(8),                                   0803 01092000
*                                                                  0803 01093000
*            2 DSETATTR  CHAR(2),      /* DATA SET ATTRIBUTES        */ 01094000
*              3 *      CHAR(1),                                   0803 01095000
*                4 AASPEED   BIT(1),                               0803 01096000
*                4 AAUNIQ    BIT(1),                               0803 01097000
*                4 AARUS     BIT(1),                       /*@Y30SSJH*/ 01098000
*                4 AAERASE   BIT(1),                               0803 01099000
*                4 AARVBL    BIT(1),                       /*@Y30SSJH*/ 01100000
*                4 AAINHIB   BIT(1),                               0803 01101000
*                4 *         BIT(1),                               0803 01102000
*                4 AATKOVFL  BIT(1),                               0803 01103000
*              3 *      CHAR(1),                                   0803 01104000
*                4 *         BIT(2),                               0803 01105000
*                4 SHRDEFLT  BIT(1),                               0803 01106000
*                                                                  0803 01107000
*            2 SPACPFLD CHAR(7)BDY(BYTE),   /* SPACEPARM COMBINATION */ 01108000
*              3 PRIMESPC  PTR(24) BDY(BYTE),                      0803 01109000
*              3 SCONDSPC  PTR(24) BDY(BYTE),                      0803 01110000
*              3 ASPACOPT  CHAR(1);                                0803 01111000
*                                                                  0803 01112000
*        /************************************************************/ 01113000
*        /*                                                          */ 01114000
*        /* FIELD NAMES OF FPLS BUILT BY ALLCPROC                    */ 01115000
*        /*                                                          */ 01116000
*        /************************************************************/ 01117000
*                                                                  0804 01118000
*        DCL                                                       0804 01119000
*           ALCFLDNM(6) CHAR(8) INIT('DSATTR','LRECL','BUFSIZE',   0804 01120000
*            'SPACPARM','DEVTYP','FILESEQ');                       0804 01121000
*                                                                  0804 01122000
*        /************************************************************/ 01123000
*        /*                                                          */ 01124000
*        /* CONTROL FLAG USED IN CONSTRUCTING VOLUMELIST             */ 01125000
*        /*                                                          */ 01126000
*        /************************************************************/ 01127000
*                                                                  0805 01128000
*        DCL                                                       0805 01129000
*          VOLEXFLG CHAR(1);                                       0805 01130000
*                                                                  0805 01131000
*        /************************************************************/ 01132000
*        /*                                                          */ 01133000
*        /* LENGTH OF GETPOOL AREA                                   */ 01134000
*        /*                                                          */ 01135000
*        /************************************************************/ 01136000
*                                                                  0806 01137000
*        DCL                                                       0806 01138000
*          GPOOLPT PTR(31),                                        0806 01139000
*          GPOOLEN FIXED(31);                                      0806 01140000
*                                                                  0806 01141000
*        DCL                                                       0807 01142000
*          VOLSTCNT FIXED(31);                                     0807 01143000
*                                                                  0807 01144000
*        /************************************************************/ 01145000
*        /*                                                          */ 01146000
*        /* OVERLAY OF FILESEQUENCE NUMBER LIAT                      */ 01147000
*        /*                                                          */ 01148000
*        /************************************************************/ 01149000
*                                                                  0808 01150000
*        DCL                                                       0808 01151000
*          1 FSNFIELD BASED BDY(WORD),                             0808 01152000
*            2 FSNARRAY(255) BDY(HWORD),                           0808 01153000
*              3 FSNUMBER FIXED(15);                               0808 01154000
*                                                                  0808 01155000
*        /************************************************************/ 01156000
*        /*                                                          */ 01157000
*        /* OVERLAY OF DEVICE TYPES LIST REFERENCED BY DEVT FPL      */ 01158000
*        /*                                                          */ 01159000
*        /************************************************************/ 01160000
*                                                                  0809 01161000
*        DCL                                                       0809 01162000
*          DEVICLST(*) CHAR(12) BASED(GPOOLPT);                    0809 01163000
*                                                                  0809 01164000
*        /************************************************************/ 01165000
*        /*                                                          */ 01166000
*        /* POINTER USED IN PROCESSING UNIQUE ATTRIBUTE              */ 01167000
*        /*                                                          */ 01168000
*        /************************************************************/ 01169000
*                                                                  0810 01170000
*        DCL TEMPPTR PTR(31);                                      0810 01171000
*        /************************************************************/ 01172000
*        /*                                                          */ 01173000
*        /* ENTRY TO ALLCPROC                                        */ 01174000
*        /*                                                          */ 01175000
*        /************************************************************/ 01176000
*                                                                  0811 01177000
*        OLDERID2 = NEWERID2;                                      0811 01178000
         L     @08,@PC00001                                        0811 01179000
         L     @06,GDTTR2(,@08)                                    0811 01180000
         MVC   @TS00001(95),NEWERID2(@06)                          0811 01181000
         MVC   OLDERID2(95,@06),@TS00001                           0811 01182000
*        NEWID2 = 'DE32';                                          0812 01183000
*                                                                  0812 01184000
         MVC   NEWID2(4,@06),@CC02727                              0812 01185000
*        /************************************************************/ 01186000
*        /*                                                          */ 01187000
*        /* GET DYNAMIC STORAGE FOR FPLS BUILT BY ALLCPROC AND INIT- */ 01188000
*        /* IALIZE.  THIS IS DONE ON FIRST ALLCPROC PASS OF EACH     */ 01189000
*        /* APPLICABLE OBJECT.                                       */ 01190000
*        /*                                                          */ 01191000
*        /***********************************************************/  01192000
*                                                                  0813 01193000
*        IF ALLCFLAG = GO                                          0813 01194000
*          THEN                                                    0813 01195000
         L     @06,@PC00001+8                                      0813 01196000
         CLI   ALLCFLAG(@06),X'00'                                 0813 01197000
         BNE   @RF00813                                            0813 01198000
*            DO;                                                   0814 01199000
*                                                                  0814 01200000
*            CALL IDCSAGP0 (GDTTBL,                                0815 01201000
*                    (LENGTH(AFPLAREA) ),                          0815 01202000
*                    FPLSTPTR,DEGPID,SETZERO);                     0815 01203000
*                                                                  0815 01204000
         L     @06,@PC00001                                        0815 01205000
         ST    @06,@AL00001                                        0815 01206000
         LA    @15,153                                             0815 01207000
         ST    @15,@AFTEMPS+4                                      0815 01208000
         LA    @15,@AFTEMPS+4                                      0815 01209000
         ST    @15,@AL00001+4                                      0815 01210000
         LA    @15,FPLSTPTR                                        0815 01211000
         ST    @15,@AL00001+8                                      0815 01212000
         LA    @15,DEGPID                                          0815 01213000
         ST    @15,@AL00001+12                                     0815 01214000
         LA    @15,SETZERO                                         0815 01215000
         ST    @15,@AL00001+16                                     0815 01216000
         MVI   @AL00001+16,X'80'                                   0815 01217000
         L     @15,GDTGPL(,@06)                                    0815 01218000
         LA    @01,@AL00001                                        0815 01219000
         BALR  @14,@15                                             0815 01220000
*            ALLCFLAG = STOP;                                      0816 01221000
         L     @06,@PC00001+8                                      0816 01222000
         MVI   ALLCFLAG(@06),X'0F'                                 0816 01223000
*            RESPECIFY RTNREG RSTD;                                0817 01224000
*            TESTRC = RTNREG;                                      0818 01225000
         LR    TESTRC,RTNREG                                       0818 01226000
*            RESPECIFY RTNREG UNRSTD;                              0819 01227000
*            IF TESTRC ^= 0                                        0820 01228000
*              THEN                                                0820 01229000
         LTR   TESTRC,TESTRC                                       0820 01230000
         BZ    @RF00820                                            0820 01231000
*                DO;                                               0821 01232000
*                                                                  0821 01233000
*                DEFSTID = NOSTORAG;                               0822 01234000
         MVC   DEFSTID(5,@06),@CB02317                             0822 01235000
*                RETURN;                                           0823 01236000
*                                                                  0823 01237000
@EL00003 L     @13,4(,@13)                                         0823 01238000
@EF00003 DS    0H                                                  0823 01239000
@ER00003 LM    @14,@12,12(@13)                                     0823 01240000
         BR    @14                                                 0823 01241000
*                END;                                              0824 01242000
*                                                                  0824 01243000
*            /********************************************************/ 01244000
*            /*                                                      */ 01245000
*            /* INITIALIZE FPLS - FIELD NAME AND DATA/ADDR PAIR #    */ 01246000
*            /*                                                      */ 01247000
*            /********************************************************/ 01248000
*                                                                  0825 01249000
*            CTGFLPTR = FPLSTPTR;                                  0825 01250000
@RF00820 L     CTGFLPTR,FPLSTPTR                                   0825 01251000
*            DO N = 1 TO 6;                                        0826 01252000
*                                                                  0826 01253000
         LA    N,1                                                 0826 01254000
@DL00826 DS    0H                                                  0827 01255000
*            CTGFLDNO = 1;                                         0827 01256000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0827 01257000
*            CTGFLDNM = ADDR(ALCFLDNM(N));                         0828 01258000
         LR    @06,N                                               0828 01259000
         SLA   @06,3                                               0828 01260000
         LA    @06,ALCFLDNM-8(@06)                                 0828 01261000
         ST    @06,CTGFLDNM(,CTGFLPTR)                             0828 01262000
*            ARITHX = (LENGTH(CTGFL) + 8);                         0829 01263000
         LA    ARITHX,24                                           0829 01264000
*            CTGFLPTR = CTGFLPTR + ARITHX;                         0830 01265000
*                                                                  0830 01266000
         ALR   CTGFLPTR,ARITHX                                     0830 01267000
*            END;                                                  0831 01268000
*                                                                  0831 01269000
         AL    N,@CF00220                                          0831 01270000
         C     N,@CF00157                                          0831 01271000
         BNH   @DL00826                                            0831 01272000
*            /********************************************************/ 01273000
*            /*                                              @Z40WSJH*/ 01274000
*            /* SET UNIQUE DEFAULT FOR PAGESPACE DATA SETS   @Z40WSJH*/ 01275000
*            /*                                              @Z40WSJH*/ 01276000
*            /********************************************************/ 01277000
*            IF (ADDR(PGSP)) ^= NULLPTR                            0832 01278000
*              THEN                                                0832 01279000
         L     @08,@PC00001+4                                      0832 01280000
         L     @08,FDTPTR+24(,@08)                                 0832 01281000
         LTR   @08,@08                                             0832 01282000
         BZ    @RF00832                                            0832 01283000
*                AAUNIQ = ON;                              /*@Z40WSJH*/ 01284000
*                                                                  0833 01285000
         L     @08,FPLSTPTR                                        0833 01286000
         OI    AAUNIQ(@08),B'01000000'                             0833 01287000
*            /********************************************************/ 01288000
*            /*                                                      */ 01289000
*            /* SET SHARE OPTIONS DEFAULT                            */ 01290000
*            /*                                                      */ 01291000
*            /********************************************************/ 01292000
*                                                                  0834 01293000
*            SHRDEFLT = ON;                                        0834 01294000
*                                                                  0834 01295000
@RF00832 L     @08,FPLSTPTR                                        0834 01296000
         OI    SHRDEFLT(@08),B'00100000'                           0834 01297000
*            /********************************************************/ 01298000
*            /*                                              @Y30SSJH*/ 01299000
*            /* INITIALIZE FVT POINTER TO LRECL FPL -        @Y30SSJH*/ 01300000
*            /* IF THE RECORDSIZE PARAMETER IS NOT           @Y30SSJH*/ 01301000
*            /* EXPLICITLY SPECIFIED OR MODELED, A DEFAULT   @Y30SSJH*/ 01302000
*            /* VALUE WILL BE SET UP IN THE INTGDSET         @Y30SSJH*/ 01303000
*            /* PROCESSING                                   @Y30SSJH*/ 01304000
*            /*                                              @Y30SSJH*/ 01305000
*            /********************************************************/ 01306000
*                                                                  0835 01307000
*            IF (ADDR(MCAT)) = NULLPTR &                           0835 01308000
*               (ADDR(UCAT)) = NULLPTR &                           0835 01309000
*               (ADDR(PGSP)) = NULLPTR &                           0835 01310000
*               CTGFVTYP = 'D'                                     0835 01311000
*              THEN                                                0835 01312000
         SLR   @06,@06                                             0835 01313000
         L     @15,@PC00001+4                                      0835 01314000
         C     @06,FDTPTR+12(,@15)                                 0835 01315000
         BNE   @RF00835                                            0835 01316000
         C     @06,FDTPTR+16(,@15)                                 0835 01317000
         BNE   @RF00835                                            0835 01318000
         C     @06,FDTPTR+24(,@15)                                 0835 01319000
         BNE   @RF00835                                            0835 01320000
         L     @06,@PC00001+8                                      0835 01321000
         L     @06,CTGFVPTR(,@06)                                  0835 01322000
         CLI   CTGFVTYP(@06),C'D'                                  0835 01323000
         BNE   @RF00835                                            0835 01324000
*                DO;                                       /*@Y30SSJH*/ 01325000
*                                                                  0836 01326000
*                CTGFLPTR = ADDR(ALRECLFL);                /*@Y30SSJH*/ 01327000
         LA    CTGFLPTR,ALRECLFL(,@08)                             0837 01328000
*                CTGFVLRS = CTGFLPTR;                      /*@Y30SSJH*/ 01329000
*                                                                  0838 01330000
         ST    CTGFLPTR,CTGFVLRS(,@06)                             0838 01331000
*                END;                                      /*@Y30SSJH*/ 01332000
*                                                                  0839 01333000
*            END;                                                  0840 01334000
@RF00835 DS    0H                                                  0841 01335000
*        /************************************************************/ 01336000
*        /*                                                          */ 01337000
*        /* SET CONTROLINTERVAL AND CONTROLAREA FREESPACE VALUES IN  */ 01338000
*        /* AMDSB, UNLESS NONINDEXED OR NUMBERED WAS         @OZ24797*/ 01339000
*        /* SPECIFIED.                                       @OZ24797*/ 01340000
*        /*                                                          */ 01341000
*        /************************************************************/ 01342000
*                                                                  0841 01343000
*        IF ADDR(CNIDX) ^= NULLPTR |                       /*@OZ24797*/ 01344000
*           ADDR(CNUMD) ^= NULLPTR                         /*@OZ24797*/ 01345000
*          THEN;                                           /*@OZ24797*/ 01346000
@RF00813 SLR   @08,@08                                             0841 01347000
         L     @06,@PC00001+4                                      0841 01348000
         C     @08,FDTPTR+96(,@06)                                 0841 01349000
         BNE   @RT00841                                            0841 01350000
         C     @08,FDTPTR+1056(,@06)                               0841 01351000
         BNE   @RT00841                                            0841 01352000
*          ELSE                                            /*@OZ24797*/ 01353000
*                                                                  0843 01354000
*        IF (ADDR(AFSPC)) ^= NULLPTR   /* FROM FDTTBL                */ 01355000
*          THEN                                                    0843 01356000
         SLR   @08,@08                                             0843 01357000
         L     @06,@PC00003+92                                     0843 01358000
         CR    @06,@08                                             0843 01359000
         BE    @RF00843                                            0843 01360000
*            DO;                                                   0844 01361000
*                                                                  0844 01362000
*            FDTTBLPT = ADDR(ACIFS);                               0845 01363000
         L     FDTTBLPT,@PC00003+96                                0845 01364000
*            AMDPCTCI = NUMBVAL;                                   0846 01365000
*                                                                  0846 01366000
         L     @06,@PC00001+8                                      0846 01367000
         L     @06,DSBCATPT(,@06)                                  0846 01368000
         L     @15,NUMBVAL(,FDTTBLPT)                              0846 01369000
         STC   @15,AMDPCTCI(,@06)                                  0846 01370000
*            IF (ADDR(ACAFS)) ^= NULLPTR                           0847 01371000
*              THEN                                                0847 01372000
         L     @15,@PC00003+100                                    0847 01373000
         CR    @15,@08                                             0847 01374000
         BE    @RF00847                                            0847 01375000
*                DO;                                               0848 01376000
*                                                                  0848 01377000
*                FDTTBLPT = ADDR(ACAFS);                           0849 01378000
         LR    FDTTBLPT,@15                                        0849 01379000
*                AMDPCTCA = NUMBVAL;                               0850 01380000
*                                                                  0850 01381000
         L     @08,NUMBVAL(,FDTTBLPT)                              0850 01382000
         STC   @08,AMDPCTCA(,@06)                                  0850 01383000
*                END;                                              0851 01384000
*                                                                  0851 01385000
*            END;                                                  0852 01386000
*                                                                  0852 01387000
*          ELSE                                                    0853 01388000
*            IF MDLAMDSB ^= NULLPTR &  /* SET VALUES FROM MODEL      */ 01389000
*              CTGTYPE ^= CTGTUCAT                                 0853 01390000
*              THEN                                                0853 01391000
         B     @RC00843                                            0853 01392000
@RF00843 L     @08,@PC00001+8                                      0853 01393000
         L     @06,MDLTBLPT(,@08)                                  0853 01394000
         L     @06,MDLAMDSB(,@06)                                  0853 01395000
         LTR   @06,@06                                             0853 01396000
         BZ    @RF00853                                            0853 01397000
         L     @01,CTGPLPTR(,@08)                                  0853 01398000
         CLI   CTGTYPE(@01),C'U'                                   0853 01399000
         BE    @RF00853                                            0853 01400000
*                DO;                                               0854 01401000
*                                                                  0854 01402000
*                AMDPCTCA = MDLAMDSB -> AMDPCTCA;                  0855 01403000
         L     @08,DSBCATPT(,@08)                                  0855 01404000
         IC    @15,AMDPCTCA(,@06)                                  0855 01405000
         STC   @15,AMDPCTCA(,@08)                                  0855 01406000
*                AMDPCTCI = MDLAMDSB -> AMDPCTCI;                  0856 01407000
*                                                                  0856 01408000
         IC    @15,AMDPCTCI(,@06)                                  0856 01409000
         STC   @15,AMDPCTCI(,@08)                                  0856 01410000
*                END;                                              0857 01411000
*        /************************************************************/ 01412000
*        /*                                                          */ 01413000
*        /* SET LRECL VALUE IN FPL AND MAXRECL IN AMDSB              */ 01414000
*        /*                                                          */ 01415000
*        /************************************************************/ 01416000
*                                                                  0858 01417000
*        IF (ADDR(ARSIZ)) ^= NULLPTR   /* TAKE VALUES FROM FDTTBL    */ 01418000
*          THEN                                                    0858 01419000
@RF00853 DS    0H                                                  0858 01420000
@RC00843 DS    0H                                                  0858 01421000
@RT00841 L     @08,@PC00003+64                                     0858 01422000
         LTR   @08,@08                                             0858 01423000
         BZ    @RF00858                                            0858 01424000
*            DO;                                                   0859 01425000
*                                                                  0859 01426000
*            /********************************************************/ 01427000
*            /*                                                      */ 01428000
*            /* INSURE THAT THE MAXIMUM RECORD SIZE IS NOT LESS THAN */ 01429000
*            /* THE AVERAGE RECORDSIZE - WHEN THE AVERAGE EXCEEDS MAX*/ 01430000
*            /* A TERMINAL ERROR CONDITION IS SET AND PROCESSING IS  */ 01431000
*            /* TERMINATED                                           */ 01432000
*            /*                                                      */ 01433000
*            /********************************************************/ 01434000
*                                                                  0860 01435000
*            IF AMRSZ < AARSZ                                      0860 01436000
*              THEN                                                0860 01437000
         L     @08,@PC00003+72                                     0860 01438000
         L     @06,@PC00003+68                                     0860 01439000
         L     @08,AMRSZ(,@08)                                     0860 01440000
         C     @08,AARSZ(,@06)                                     0860 01441000
         BNL   @RF00860                                            0860 01442000
*                DO;                                               0861 01443000
*                                                                  0861 01444000
*                DEFSTID = AVMXERR;                                0862 01445000
         L     @06,@PC00001+8                                      0862 01446000
         MVC   DEFSTID(5,@06),@CB02335                             0862 01447000
*                RETURN;                                           0863 01448000
*                                                                  0863 01449000
         B     @EL00003                                            0863 01450000
*                END;                                              0864 01451000
*                                                                  0864 01452000
*            /********************************************************/ 01453000
*            /*                                              @Y30SSJH*/ 01454000
*            /* INSURE THAT AVERAGE AND MAXIMUM RECORDSIZE   @Y30SSJH*/ 01455000
*            /* ARE EQUAL FOR A RELATIVE RECORD DATA SET     @Y30SSJH*/ 01456000
*            /*                                              @Y30SSJH*/ 01457000
*            /********************************************************/ 01458000
*                                                                  0865 01459000
*            IF CTGFVTYP = 'D'                                     0865 01460000
*              THEN                                                0865 01461000
@RF00860 L     @08,@PC00001+8                                      0865 01462000
         L     @06,CTGFVPTR(,@08)                                  0865 01463000
         CLI   CTGFVTYP(@06),C'D'                                  0865 01464000
         BNE   @RF00865                                            0865 01465000
*                IF AMDRRDS = ON                                   0866 01466000
*                  THEN                                            0866 01467000
         L     @06,DSBCATPT(,@08)                                  0866 01468000
         TM    AMDRRDS(@06),B'00000010'                            0866 01469000
         BNO   @RF00866                                            0866 01470000
*                    IF AMRSZ ^= AARSZ                             0867 01471000
*                      THEN                                        0867 01472000
         L     @06,@PC00003+72                                     0867 01473000
         L     @04,@PC00003+68                                     0867 01474000
         CLC   AMRSZ(4,@06),AARSZ(@04)                             0867 01475000
         BE    @RF00867                                            0867 01476000
*                        DO;                               /*@Y30SSJH*/ 01477000
*                                                                  0868 01478000
*                        DEFSTID = AVMAXUNQ;               /*@Y30SSJH*/ 01479000
         MVC   DEFSTID(5,@08),@CB02338                             0869 01480000
*                        RETURN;                           /*@Y30SSJH*/ 01481000
*                                                                  0870 01482000
         B     @EL00003                                            0870 01483000
*                        END;                              /*@Y30SSJH*/ 01484000
*                                                                  0871 01485000
*            /********************************************************/ 01486000
*            /*                                              @Y30SSJH*/ 01487000
*            /* SET VALUES IN LRECL FPL AND AMDSB            @Y30SSJH*/ 01488000
*            /*                                              @Y30SSJH*/ 01489000
*            /********************************************************/ 01490000
*                                                                  0872 01491000
*            CTGFLPTR = ADDR(ALRECLFL); /*INIT OF LRECL FPL          */ 01492000
@RF00867 DS    0H                                                  0872 01493000
@RF00866 DS    0H                                                  0872 01494000
@RF00865 L     CTGFLPTR,FPLSTPTR                                   0872 01495000
         LA    CTGFLPTR,ALRECLFL(,CTGFLPTR)                        0872 01496000
*            CTGFVLRS = CTGFLPTR;                                  0873 01497000
         L     @08,@PC00001+8                                      0873 01498000
         L     @06,CTGFVPTR(,@08)                                  0873 01499000
         ST    CTGFLPTR,CTGFVLRS(,@06)                             0873 01500000
*            CTGFLNG(1) = 4;                                       0874 01501000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00043                        0874 01502000
*            FDTTBLPT = ADDR(AARSZ);                               0875 01503000
         L     FDTTBLPT,@PC00003+68                                0875 01504000
*            CTGFLPT(1) = ADDR(NUMBVAL);                           0876 01505000
*                                                                  0876 01506000
         ST    FDTTBLPT,CTGFLPT(,CTGFLPTR)                         0876 01507000
*            /* INIT MAXRECL VALUE IN AMDSB                          */ 01508000
*            IF CTGFVTYP = CTGFVDTA                                0877 01509000
*              THEN                                                0877 01510000
         CLI   CTGFVTYP(@06),C'D'                                  0877 01511000
         BNE   @RF00877                                            0877 01512000
*                DO;                                               0878 01513000
*                                                                  0878 01514000
*                FDTTBLPT = ADDR(AMRSZ);                           0879 01515000
         L     FDTTBLPT,@PC00003+72                                0879 01516000
*                AMDLRECL = NUMBVAL;                               0880 01517000
*                                                                  0880 01518000
         L     @08,DSBCATPT(,@08)                                  0880 01519000
         L     @06,NUMBVAL(,FDTTBLPT)                              0880 01520000
         ST    @06,AMDLRECL(,@08)                                  0880 01521000
*                END;                                              0881 01522000
*                                                                  0881 01523000
*            END;                                                  0882 01524000
*                                                                  0882 01525000
*          /**********************************************************/ 01526000
*          /*                                                        */ 01527000
*          /* MODEL LRECL AND MAXRECL VALUES                         */ 01528000
*          /*                                                        */ 01529000
*          /**********************************************************/ 01530000
*                                                                  0883 01531000
*          ELSE                                                    0883 01532000
*            DO;                                                   0883 01533000
*                                                                  0883 01534000
         B     @RC00858                                            0883 01535000
@RF00858 DS    0H                                                  0884 01536000
*            IF MDLLRECL ^= NULLPTR &  /* INIT LRECL FPL FROM MODEL  */ 01537000
*               (CTGTYPE ^= CTGTUCAT  &                            0884 01538000
*                CTGTYPE ^= CTGTPGSP  )                            0884 01539000
*              THEN                                                0884 01540000
         SLR   @08,@08                                             0884 01541000
         L     @06,@PC00001+8                                      0884 01542000
         L     @15,MDLTBLPT(,@06)                                  0884 01543000
         L     @14,MDLLRECL(,@15)                                  0884 01544000
         CR    @14,@08                                             0884 01545000
         BE    @RF00884                                            0884 01546000
         L     @03,CTGPLPTR(,@06)                                  0884 01547000
         CLI   CTGTYPE(@03),C'U'                                   0884 01548000
         BE    @RF00884                                            0884 01549000
         CLI   CTGTYPE(@03),C'P'                                   0884 01550000
         BE    @RF00884                                            0884 01551000
*                DO;                                               0885 01552000
*                                                                  0885 01553000
*                CTGFLPTR = ADDR(ALRECLFL);                        0886 01554000
         L     CTGFLPTR,FPLSTPTR                                   0886 01555000
         LA    CTGFLPTR,ALRECLFL(,CTGFLPTR)                        0886 01556000
*                CTGFVLRS = CTGFLPTR;                              0887 01557000
         L     @02,CTGFVPTR(,@06)                                  0887 01558000
         ST    CTGFLPTR,CTGFVLRS(,@02)                             0887 01559000
*                CTGFLNG(1) = 4;                                   0888 01560000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00043                        0888 01561000
*                CTGFLPT(1) = MDLLRECL;                            0889 01562000
*                                                                  0889 01563000
         ST    @14,CTGFLPT(,CTGFLPTR)                              0889 01564000
*                IF MDLAMDSB ^= NULLPTR  /* MAXRECL FROM MODEL AMDSB*/  01565000
*                  THEN                                            0890 01566000
         L     @15,MDLAMDSB(,@15)                                  0890 01567000
         CR    @15,@08                                             0890 01568000
         BE    @RF00890                                            0890 01569000
*                    AMDLRECL = MDLAMDSB -> AMDLRECL;              0891 01570000
*                                                                  0891 01571000
         L     @08,DSBCATPT(,@06)                                  0891 01572000
         L     @06,AMDLRECL(,@15)                                  0891 01573000
         ST    @06,AMDLRECL(,@08)                                  0891 01574000
*                END;                                              0892 01575000
*                                                                  0892 01576000
@RF00890 DS    0H                                                  0893 01577000
*            END;                                                  0893 01578000
@RF00884 DS    0H                                                  0894 01579000
*        /************************************************************/ 01580000
*        /*                                                          */ 01581000
*        /* SET WRITECHECK FLAG IN AMDSB                             */ 01582000
*        /*                                                          */ 01583000
*        /************************************************************/ 01584000
*                                                                  0894 01585000
*        IF (ADDR(AWCHK)) ^= NULLPTR   /*VALUE FROM FDTTBL           */ 01586000
*          THEN                                                    0894 01587000
@RC00858 L     @08,@PC00003+76                                     0894 01588000
         LTR   @08,@08                                             0894 01589000
         BZ    @RF00894                                            0894 01590000
*            AMDWCK = ON;                                          0895 01591000
*                                                                  0895 01592000
         L     @08,@PC00001+8                                      0895 01593000
         L     @08,DSBCATPT(,@08)                                  0895 01594000
         OI    AMDWCK(@08),B'01000000'                             0895 01595000
*          ELSE                                                    0896 01596000
*            IF (ADDR(ANWCK)) ^= NULLPTR                           0896 01597000
*              THEN                                                0896 01598000
         B     @RC00894                                            0896 01599000
@RF00894 L     @08,@PC00003+80                                     0896 01600000
         LTR   @08,@08                                             0896 01601000
         BZ    @RF00896                                            0896 01602000
*                AMDWCK = OFF;                                     0897 01603000
*                                                                  0897 01604000
         L     @08,@PC00001+8                                      0897 01605000
         L     @08,DSBCATPT(,@08)                                  0897 01606000
         NI    AMDWCK(@08),B'10111111'                             0897 01607000
*              ELSE                                                0898 01608000
*                IF MDLAMDSB ^= NULLPTR /*TAKE VALUE FROM MODEL      */ 01609000
*                  THEN                                            0898 01610000
         B     @RC00896                                            0898 01611000
@RF00896 L     @08,@PC00001+8                                      0898 01612000
         L     @06,MDLTBLPT(,@08)                                  0898 01613000
         L     @06,MDLAMDSB(,@06)                                  0898 01614000
         LTR   @06,@06                                             0898 01615000
         BZ    @RF00898                                            0898 01616000
*                    IF MDLAMDSB -> AMDWCK = ON                    0899 01617000
*                      THEN                                        0899 01618000
         TM    AMDWCK(@06),B'01000000'                             0899 01619000
         BNO   @RF00899                                            0899 01620000
*                        AMDWCK = ON;                              0900 01621000
         L     @08,DSBCATPT(,@08)                                  0900 01622000
         OI    AMDWCK(@08),B'01000000'                             0900 01623000
*                      ELSE                                        0901 01624000
*                        AMDWCK = OFF;                             0901 01625000
*                                                                  0901 01626000
         B     @RC00899                                            0901 01627000
@RF00899 L     @08,@PC00001+8                                      0901 01628000
         L     @08,DSBCATPT(,@08)                                  0901 01629000
         NI    AMDWCK(@08),B'10111111'                             0901 01630000
*        /************************************************************/ 01631000
*        /*                                                  @Y30SSJH*/ 01632000
*        /* INITIALIZE SS/1 ATTRIBUTES IN THE AMDSB.         @Y30SSJH*/ 01633000
*        /* TEST EXPLICIT ATTRIBUTES FIRST. IF NO            @Y30SSJH*/ 01634000
*        /* EXPLICIT ATTRIBUTES, CHECK FOR MODEL             @Y30SSJH*/ 01635000
*        /* ATTRIBUTES.                                      @Y30SSJH*/ 01636000
*        /*                                                  @Y30SSJH*/ 01637000
*        /************************************************************/ 01638000
*                                                                  0902 01639000
*        IF (ADDR(ACYLFF)) ^= NULLPTR                              0902 01640000
*          THEN                                                    0902 01641000
@RC00899 DS    0H                                                  0902 01642000
@RF00898 DS    0H                                                  0902 01643000
@RC00896 DS    0H                                                  0902 01644000
@RC00894 L     @08,@PC00003+136                                    0902 01645000
         LTR   @08,@08                                             0902 01646000
         BZ    @RF00902                                            0902 01647000
*            DO;                                           /*@Y30SSJH*/ 01648000
*                                                                  0903 01649000
*            AMDFAULT = ON;                                /*@Y30SSJH*/ 01650000
*            AMDBIND = OFF;                                /*@Y30SSJH*/ 01651000
*                                                                  0905 01652000
         L     @08,@PC00001+8                                      0905 01653000
         L     @08,DSBCATPT(,@08)                                  0905 01654000
         OI    AMDFAULT(@08),B'01000000'                           0905 01655000
         NI    AMDBIND(@08),B'11011111'                            0905 01656000
*            END;                                          /*@Y30SSJH*/ 01657000
*          ELSE                                                    0907 01658000
*            IF (ADDR(ABINDD)) ^= NULLPTR                          0907 01659000
*              THEN                                                0907 01660000
         B     @RC00902                                            0907 01661000
@RF00902 L     @08,@PC00003+132                                    0907 01662000
         LTR   @08,@08                                             0907 01663000
         BZ    @RF00907                                            0907 01664000
*                DO;                                       /*@Y30SSJH*/ 01665000
*                                                                  0908 01666000
*                AMDFAULT = OFF;                           /*@Y30SSJH*/ 01667000
*                AMDBIND = ON;                             /*@Y30SSJH*/ 01668000
*                                                                  0910 01669000
         L     @08,@PC00001+8                                      0910 01670000
         L     @08,DSBCATPT(,@08)                                  0910 01671000
         OI    AMDBIND(@08),B'00100000'                            0910 01672000
         NI    AMDFAULT(@08),B'10111111'                           0910 01673000
*                END;                                      /*@Y30SSJH*/ 01674000
*              ELSE                                                0912 01675000
*                IF (ADDR(ASTAGE)) ^= NULLPTR                      0912 01676000
*                  THEN                                            0912 01677000
         B     @RC00907                                            0912 01678000
@RF00907 L     @08,@PC00003+128                                    0912 01679000
         LTR   @08,@08                                             0912 01680000
         BZ    @RF00912                                            0912 01681000
*                    DO;                                   /*@Y30SSJH*/ 01682000
*                                                                  0913 01683000
*                    AMDFAULT = OFF;                       /*@Y30SSJH*/ 01684000
*                    AMDBIND = OFF;                        /*@Y30SSJH*/ 01685000
*                                                                  0915 01686000
         L     @08,@PC00001+8                                      0915 01687000
         L     @08,DSBCATPT(,@08)                                  0915 01688000
         NI    AMDFAULT(@08),B'10011111'                           0915 01689000
*                    END;                                  /*@Y30SSJH*/ 01690000
*                  ELSE                                            0917 01691000
*                    IF MDLAMDSB ^= NULLPTR     &                  0917 01692000
*                       (ADDR(CLST) ^= NULLPTR  |                  0917 01693000
*                        ADDR(AIX)  ^= NULLPTR  )                  0917 01694000
*                      THEN                                        0917 01695000
         B     @RC00912                                            0917 01696000
@RF00912 SLR   @08,@08                                             0917 01697000
         L     @06,@PC00001+8                                      0917 01698000
         L     @06,MDLTBLPT(,@06)                                  0917 01699000
         C     @08,MDLAMDSB(,@06)                                  0917 01700000
         BE    @RF00917                                            0917 01701000
         L     @06,@PC00001+4                                      0917 01702000
         C     @08,FDTPTR+20(,@06)                                 0917 01703000
         BNE   @RT00917                                            0917 01704000
         C     @08,FDTPTR+52(,@06)                                 0917 01705000
         BE    @RF00917                                            0917 01706000
@RT00917 DS    0H                                                  0918 01707000
*                        DO;                               /*@Y30SSJH*/ 01708000
*                                                                  0918 01709000
*                        IF MDLAMDSB -> AMDFAULT = ON              0919 01710000
*                          THEN                                    0919 01711000
         L     @08,@PC00001+8                                      0919 01712000
         L     @06,MDLTBLPT(,@08)                                  0919 01713000
         L     @06,MDLAMDSB(,@06)                                  0919 01714000
         TM    AMDFAULT(@06),B'01000000'                           0919 01715000
         BNO   @RF00919                                            0919 01716000
*                            AMDFAULT = ON;                /*@Y30SSJH*/ 01717000
         L     @08,DSBCATPT(,@08)                                  0920 01718000
         OI    AMDFAULT(@08),B'01000000'                           0920 01719000
*                          ELSE                                    0921 01720000
*                            AMDFAULT = OFF;               /*@Y30SSJH*/ 01721000
*                                                                  0921 01722000
         B     @RC00919                                            0921 01723000
@RF00919 L     @08,@PC00001+8                                      0921 01724000
         L     @08,DSBCATPT(,@08)                                  0921 01725000
         NI    AMDFAULT(@08),B'10111111'                           0921 01726000
*                        IF MDLAMDSB -> AMDBIND = ON               0922 01727000
*                          THEN                                    0922 01728000
@RC00919 L     @08,@PC00001+8                                      0922 01729000
         L     @06,MDLTBLPT(,@08)                                  0922 01730000
         L     @06,MDLAMDSB(,@06)                                  0922 01731000
         TM    AMDBIND(@06),B'00100000'                            0922 01732000
         BNO   @RF00922                                            0922 01733000
*                            AMDBIND = ON;                 /*@Y30SSJH*/ 01734000
         L     @08,DSBCATPT(,@08)                                  0923 01735000
         OI    AMDBIND(@08),B'00100000'                            0923 01736000
*                          ELSE                                    0924 01737000
*                            AMDBIND = OFF;                /*@Y30SSJH*/ 01738000
*                                                                  0924 01739000
         B     @RC00922                                            0924 01740000
@RF00922 L     @08,@PC00001+8                                      0924 01741000
         L     @08,DSBCATPT(,@08)                                  0924 01742000
         NI    AMDBIND(@08),B'11011111'                            0924 01743000
*                        END;                              /*@Y30SSJH*/ 01744000
*                                                                  0925 01745000
@RC00922 DS    0H                                                  0926 01746000
*        IF (ADDR(ANSTGW)) ^= NULLPTR                              0926 01747000
*          THEN                                                    0926 01748000
@RF00917 DS    0H                                                  0926 01749000
@RC00912 DS    0H                                                  0926 01750000
@RC00907 DS    0H                                                  0926 01751000
@RC00902 L     @08,@PC00003+140                                    0926 01752000
         LTR   @08,@08                                             0926 01753000
         BZ    @RF00926                                            0926 01754000
*            AMDWAIT = OFF;                                /*@Y30SSJH*/ 01755000
         L     @08,@PC00001+8                                      0927 01756000
         L     @08,DSBCATPT(,@08)                                  0927 01757000
         NI    AMDWAIT(@08),B'11101111'                            0927 01758000
*          ELSE                                                    0928 01759000
*            IF (ADDR(ASTGWW)) ^= NULLPTR                          0928 01760000
*              THEN                                                0928 01761000
         B     @RC00926                                            0928 01762000
@RF00926 L     @08,@PC00003+144                                    0928 01763000
         LTR   @08,@08                                             0928 01764000
         BZ    @RF00928                                            0928 01765000
*                AMDWAIT = ON;                             /*@Y30SSJH*/ 01766000
         L     @08,@PC00001+8                                      0929 01767000
         L     @08,DSBCATPT(,@08)                                  0929 01768000
         OI    AMDWAIT(@08),B'00010000'                            0929 01769000
*              ELSE                                                0930 01770000
*                IF MDLAMDSB ^= NULLPTR                            0930 01771000
*                  THEN                                            0930 01772000
         B     @RC00928                                            0930 01773000
@RF00928 L     @08,@PC00001+8                                      0930 01774000
         L     @06,MDLTBLPT(,@08)                                  0930 01775000
         L     @06,MDLAMDSB(,@06)                                  0930 01776000
         LTR   @06,@06                                             0930 01777000
         BZ    @RF00930                                            0930 01778000
*                    IF MDLAMDSB -> AMDWAIT = ON                   0931 01779000
*                      THEN                                        0931 01780000
         TM    AMDWAIT(@06),B'00010000'                            0931 01781000
         BNO   @RF00931                                            0931 01782000
*                        AMDWAIT = ON;                     /*@Y30SSJH*/ 01783000
         L     @08,DSBCATPT(,@08)                                  0932 01784000
         OI    AMDWAIT(@08),B'00010000'                            0932 01785000
*                      ELSE                                        0933 01786000
*                        AMDWAIT = OFF;                    /*@Y30SSJH*/ 01787000
*                                                                  0933 01788000
         B     @RC00931                                            0933 01789000
@RF00931 L     @08,@PC00001+8                                      0933 01790000
         L     @08,DSBCATPT(,@08)                                  0933 01791000
         NI    AMDWAIT(@08),B'11101111'                            0933 01792000
*        /************************************************************/ 01793000
*        /*                                                  @Y30SSJH*/ 01794000
*        /* IF THE OBJECT BEING ALTERED IS A CATALOG,        @Y30SSJH*/ 01795000
*        /* INDICATE IT IN THE AMDSB.                        @Y30SSJH*/ 01796000
*        /*                                                  @Y30SSJH*/ 01797000
*        /************************************************************/ 01798000
*                                                                  0934 01799000
*        IF (ADDR(MCAT)) ^= NULLPTR   |                            0934 01800000
*           (ADDR(UCAT)) ^= NULLPTR                                0934 01801000
*          THEN                                                    0934 01802000
@RC00931 DS    0H                                                  0934 01803000
@RF00930 DS    0H                                                  0934 01804000
@RC00928 DS    0H                                                  0934 01805000
@RC00926 SLR   @08,@08                                             0934 01806000
         L     @06,@PC00001+4                                      0934 01807000
         C     @08,FDTPTR+12(,@06)                                 0934 01808000
         BNE   @RT00934                                            0934 01809000
         C     @08,FDTPTR+16(,@06)                                 0934 01810000
         BE    @RF00934                                            0934 01811000
@RT00934 DS    0H                                                  0935 01812000
*            IF CTGFVTYP = 'D'   |                                 0935 01813000
*               CTGFVTYP = 'I'                                     0935 01814000
*              THEN                                                0935 01815000
         L     @08,@PC00001+8                                      0935 01816000
         L     @08,CTGFVPTR(,@08)                                  0935 01817000
         CLI   CTGFVTYP(@08),C'D'                                  0935 01818000
         BE    @RT00935                                            0935 01819000
         CLI   CTGFVTYP(@08),C'I'                                  0935 01820000
         BNE   @RF00935                                            0935 01821000
@RT00935 DS    0H                                                  0936 01822000
*                AMDBIND = ON;                             /*@Y30SSJH*/ 01823000
*                                                                  0936 01824000
         L     @08,@PC00001+8                                      0936 01825000
         L     @08,DSBCATPT(,@08)                                  0936 01826000
         OI    AMDBIND(@08),B'00100000'                            0936 01827000
*        /************************************************************/ 01828000
*        /*                                                          */ 01829000
*        /* INITIALIZE DATA SET ATTRIBUTES - TAKE COPY FROM MODEL IF */ 01830000
*        /* ONE EXISTS THEN OVERRIDE WITH EXPLICIT ATTRIBUTES        */ 01831000
*        /*                                                          */ 01832000
*        /************************************************************/ 01833000
*                                                                  0937 01834000
*                                                                  0937 01835000
*        IF CTGFVTYP = 'D'  |                                      0937 01836000
*           CTGFVTYP = 'I'                                         0937 01837000
*          THEN                                                    0937 01838000
@RF00935 DS    0H                                                  0937 01839000
@RF00934 L     @08,@PC00001+8                                      0937 01840000
         L     @08,CTGFVPTR(,@08)                                  0937 01841000
         CLI   CTGFVTYP(@08),C'D'                                  0937 01842000
         BE    @RT00937                                            0937 01843000
         CLI   CTGFVTYP(@08),C'I'                                  0937 01844000
         BNE   @RF00937                                            0937 01845000
@RT00937 DS    0H                                                  0938 01846000
*            DO;                                                   0938 01847000
*                                                                  0938 01848000
*            CTGFLPTR = ADDR(ADSATRFL);                            0939 01849000
         L     @08,FPLSTPTR                                        0939 01850000
         LR    CTGFLPTR,@08                                        0939 01851000
*            CTGFVATR = CTGFLPTR;                                  0940 01852000
         L     @06,@PC00001+8                                      0940 01853000
         L     @02,CTGFVPTR(,@06)                                  0940 01854000
         ST    CTGFLPTR,CTGFVATR(,@02)                             0940 01855000
*            CTGFLNG(1) = 2;                                       0941 01856000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00154                        0941 01857000
*            CTGFLPT(1) = ADDR(DSETATTR);                          0942 01858000
*                                                                  0942 01859000
         LA    @02,DSETATTR(,@08)                                  0942 01860000
         ST    @02,CTGFLPT(,CTGFLPTR)                              0942 01861000
*            IF MDLDSATR ^= NULLPTR    /* COPY DSATTR FROM MODEL     */ 01862000
*              THEN                                                0943 01863000
         L     @06,MDLTBLPT(,@06)                                  0943 01864000
         L     @06,MDLDSATR(,@06)                                  0943 01865000
         LTR   @06,@06                                             0943 01866000
         BZ    @RF00943                                            0943 01867000
*                DSETATTR = MDLDATTR;                              0944 01868000
*                                                                  0944 01869000
         MVC   DSETATTR(2,@08),MDLDATTR(@06)                       0944 01870000
*            /********************************************************/ 01871000
*            /*                                                      */ 01872000
*            /* SET EXPLICIT DATA SET ATTRIBUTES FROM FDTTBL         */ 01873000
*            /*                                                      */ 01874000
*            /********************************************************/ 01875000
*                                                                  0945 01876000
*            IF (ADDR(AUNIQ)) ^= NULLPTR                           0945 01877000
*              THEN                                                0945 01878000
@RF00943 L     @08,@PC00003+20                                     0945 01879000
         LTR   @08,@08                                             0945 01880000
         BZ    @RF00945                                            0945 01881000
*                DO;                                               0946 01882000
*                                                                  0946 01883000
*                AAUNIQ = ON;                                      0947 01884000
*                                                                  0947 01885000
         L     @08,FPLSTPTR                                        0947 01886000
         OI    AAUNIQ(@08),B'01000000'                             0947 01887000
*                END;                                              0948 01888000
*                                                                  0948 01889000
*              ELSE                                                0949 01890000
*                IF (ADDR(ASUBA)) ^= NULLPTR                       0949 01891000
*                  THEN                                            0949 01892000
         B     @RC00945                                            0949 01893000
@RF00945 L     @08,@PC00003+16                                     0949 01894000
         LTR   @08,@08                                             0949 01895000
         BZ    @RF00949                                            0949 01896000
*                    AAUNIQ = OFF;                                 0950 01897000
*                                                                  0950 01898000
         L     @08,FPLSTPTR                                        0950 01899000
         NI    AAUNIQ(@08),B'10111111'                             0950 01900000
*            IF (ADDR(ASPED)) ^= NULLPTR                           0951 01901000
*              THEN                                                0951 01902000
@RF00949 DS    0H                                                  0951 01903000
@RC00945 L     @08,@PC00003+84                                     0951 01904000
         LTR   @08,@08                                             0951 01905000
         BZ    @RF00951                                            0951 01906000
*                AASPEED = ON;                                     0952 01907000
*                                                                  0952 01908000
         L     @08,FPLSTPTR                                        0952 01909000
         OI    AASPEED(@08),B'10000000'                            0952 01910000
*              ELSE                                                0953 01911000
*                IF (ADDR(ARECV)) ^= NULLPTR                       0953 01912000
*                  THEN                                            0953 01913000
         B     @RC00951                                            0953 01914000
@RF00951 L     @08,@PC00003+88                                     0953 01915000
         LTR   @08,@08                                             0953 01916000
         BZ    @RF00953                                            0953 01917000
*                    AASPEED = OFF;                                0954 01918000
*                                                                  0954 01919000
         L     @08,FPLSTPTR                                        0954 01920000
         NI    AASPEED(@08),B'01111111'                            0954 01921000
*            /********************************************************/ 01922000
*            /*                                              @Y30SSJH*/ 01923000
*            /* SET RECOVERABLE CATALOG ATTRIBUTE            @Y30SSJH*/ 01924000
*            /*                                              @Y30SSJH*/ 01925000
*            /********************************************************/ 01926000
*                                                                  0955 01927000
*            IF (ADDR(ARVBL)) ^= NULLPTR                           0955 01928000
*              THEN                                                0955 01929000
@RF00953 DS    0H                                                  0955 01930000
@RC00951 L     @08,@PC00003+120                                    0955 01931000
         LTR   @08,@08                                             0955 01932000
         BZ    @RF00955                                            0955 01933000
*                AARVBL = ON;                              /*@Y30SSJH*/ 01934000
*                                                                  0956 01935000
         L     @08,FPLSTPTR                                        0956 01936000
         OI    AARVBL(@08),B'00001000'                             0956 01937000
*              ELSE                                                0957 01938000
*                IF (ADDR(ANRVL)) ^= NULLPTR                       0957 01939000
*                  THEN                                            0957 01940000
         B     @RC00955                                            0957 01941000
@RF00955 L     @08,@PC00003+124                                    0957 01942000
         LTR   @08,@08                                             0957 01943000
         BZ    @RF00957                                            0957 01944000
*                    AARVBL = OFF;                         /*@Y30SSJH*/ 01945000
*                                                                  0958 01946000
         L     @08,FPLSTPTR                                        0958 01947000
         NI    AARVBL(@08),B'11110111'                             0958 01948000
*            /********************************************************/ 01949000
*            /*                                              @Y30SSJH*/ 01950000
*            /* SET TRACK OVERFLOW BIT IN DSATTR FOR PAGESPACE       */ 01951000
*            /*                                              @Y30SSJH*/ 01952000
*            /********************************************************/ 01953000
*            IF (ADDR(PGSP)) ^= NULLPTR                            0959 01954000
*              THEN                                                0959 01955000
@RF00957 DS    0H                                                  0959 01956000
@RC00955 SLR   @08,@08                                             0959 01957000
         L     @06,@PC00001+4                                      0959 01958000
         C     @08,FDTPTR+24(,@06)                                 0959 01959000
         BE    @RF00959                                            0959 01960000
*                  IF (ADDR(PSWAP)) ^= NULLPTR  |                  0960 01961000
*                     SWAPFLAG = GO                                0960 01962000
*                    THEN                                          0960 01963000
         C     @08,FDTPTR+992(,@06)                                0960 01964000
         BNE   @RT00960                                            0960 01965000
         L     @08,@PC00001+8                                      0960 01966000
         CLI   SWAPFLAG(@08),X'00'                                 0960 01967000
         BNE   @RF00960                                            0960 01968000
@RT00960 DS    0H                                                  0961 01969000
*                      AATKOVFL = OFF;                     /*@Z40WSJH*/ 01970000
         L     @08,FPLSTPTR                                        0961 01971000
         NI    AATKOVFL(@08),B'11111110'                           0961 01972000
*                    ELSE                                          0962 01973000
*                      AATKOVFL = ON;                      /*@Z40WSJH*/ 01974000
*                                                                  0962 01975000
         B     @RC00960                                            0962 01976000
@RF00960 L     @08,FPLSTPTR                                        0962 01977000
         OI    AATKOVFL(@08),B'00000001'                           0962 01978000
*            END;                                          /*@Z40WSJH*/ 01979000
@RC00960 DS    0H                                                  0963 01980000
@RF00959 DS    0H                                                  0964 01981000
*        /************************************************************/ 01982000
*        /*                                                          */ 01983000
*        /* INITIALIZE VOLUME SERIAL LIST PSEUDO FIELD               */ 01984000
*        /*                                                          */ 01985000
*        /************************************************************/ 01986000
*                                                                  0964 01987000
*        VOLEXFLG = GO;                                            0964 01988000
@RF00937 MVI   VOLEXFLG,X'00'                                      0964 01989000
*        GPOOLEN = 0;                                              0965 01990000
         SLR   @08,@08                                             0965 01991000
         ST    @08,GPOOLEN                                         0965 01992000
*        IF (ADDR(AVLSR)) ^= NULLPTR   /*VOLSERIAL LIST FROM FDTTBL  */ 01993000
*          THEN                                                    0966 01994000
         L     @06,@PC00003+4                                      0966 01995000
         CR    @06,@08                                             0966 01996000
         BE    @RF00966                                            0966 01997000
*            DO;                                                   0967 01998000
*                                                                  0967 01999000
*            FDTTBLPT = ADDR(AVLSR);                               0968 02000000
         LR    FDTTBLPT,@06                                        0968 02001000
*            GPOOLEN = (8 * LISTCNT) +2;                           0969 02002000
         LH    @08,LISTCNT(,FDTTBLPT)                              0969 02003000
         LR    @06,@08                                             0969 02004000
         SLA   @06,3                                               0969 02005000
         AL    @06,@CF00154                                        0969 02006000
         ST    @06,GPOOLEN                                         0969 02007000
*            VOLSTCNT = LISTCNT;                                   0970 02008000
         LR    VOLSTCNT,@08                                        0970 02009000
*            VOLEXFLG = 'F';                                       0971 02010000
*                                                                  0971 02011000
         MVI   VOLEXFLG,C'F'                                       0971 02012000
*            END;                                                  0972 02013000
*                                                                  0972 02014000
*          ELSE                                                    0973 02015000
*            IF MDLVLIST ^= NULLPTR    /* VOLSER LIST FROM MODEL     */ 02016000
*              THEN                                                0973 02017000
         B     @RC00966                                            0973 02018000
@RF00966 L     @08,@PC00001+8                                      0973 02019000
         L     @08,MDLTBLPT(,@08)                                  0973 02020000
         L     @06,MDLVLIST(,@08)                                  0973 02021000
         LTR   @06,@06                                             0973 02022000
         BZ    @RF00973                                            0973 02023000
*                DO;                                               0974 02024000
*                                                                  0974 02025000
*                VOLSTCNT = MDLVLLEN/6;                            0975 02026000
         L     @00,MDLVLLEN(,@08)                                  0975 02027000
         SRDA  @00,32                                              0975 02028000
         D     @00,@CF00157                                        0975 02029000
         LR    VOLSTCNT,@01                                        0975 02030000
*                GPOOLEN = (VOLSTCNT * 8) +2;                      0976 02031000
         LR    @08,VOLSTCNT                                        0976 02032000
         SLA   @08,3                                               0976 02033000
         AL    @08,@CF00154                                        0976 02034000
         ST    @08,GPOOLEN                                         0976 02035000
*                VOLEXFLG = 'M';       /* SET FLG INDICATING LIST IS    02036000
*                                         IS FROM THE MODEL          */ 02037000
*                                                                  0977 02038000
         MVI   VOLEXFLG,C'M'                                       0977 02039000
*                END;                                              0978 02040000
*                                                                  0978 02041000
*        IF VOLEXFLG ^= GO                                         0979 02042000
*          THEN                                                    0979 02043000
@RF00973 DS    0H                                                  0979 02044000
@RC00966 CLI   VOLEXFLG,X'00'                                      0979 02045000
         BE    @RF00979                                            0979 02046000
*            DO;                                                   0980 02047000
*                                                                  0980 02048000
*            /********************************************************/ 02049000
*            /*                                                      */ 02050000
*            /* THE VOLUME LIST MUST BE AT LEAST 130 BYTES LONG, DUE */ 02051000
*            /* TO DOS CONSIDERATIONS                                */ 02052000
*            /*                                                      */ 02053000
*            /********************************************************/ 02054000
*                                                                  0981 02055000
*            IF GPOOLEN < POOLEN1                                  0981 02056000
*              THEN                                                0981 02057000
         LA    @08,130                                             0981 02058000
         C     @08,GPOOLEN                                         0981 02059000
         BNH   @RF00981                                            0981 02060000
*                GPOOLEN = POOLEN1;                        /*@Y30SSJH*/ 02061000
*                                                                  0982 02062000
         ST    @08,GPOOLEN                                         0982 02063000
*            /********************************************************/ 02064000
*            /*                                                      */ 02065000
*            /* GET STORAGE FOR VOLUME LIST IF NECESSARY             */ 02066000
*            /*                                                      */ 02067000
*            /********************************************************/ 02068000
*                                                                  0983 02069000
*            IF CTGFVVLT = NULLPTR  |                              0983 02070000
*               GPOOLEN  > VLISTLEN                                0983 02071000
*              THEN                                                0983 02072000
@RF00981 L     @08,@PC00001+8                                      0983 02073000
         L     @08,CTGFVPTR(,@08)                                  0983 02074000
         L     @08,CTGFVVLT(,@08)                                  0983 02075000
         LTR   @08,@08                                             0983 02076000
         BZ    @RT00983                                            0983 02077000
         L     @06,GPOOLEN                                         0983 02078000
         CH    @06,VLISTLEN(,@08)                                  0983 02079000
         BNH   @RF00983                                            0983 02080000
@RT00983 DS    0H                                                  0984 02081000
*                DO;                                               0984 02082000
*                                                                  0984 02083000
*                CALL IDCSAGP0(GDTTBL,GPOOLEN,CTGFVVLT,DEGPID,SETZERO); 02084000
         L     @06,@PC00001                                        0985 02085000
         ST    @06,@AL00001                                        0985 02086000
         LA    @15,GPOOLEN                                         0985 02087000
         ST    @15,@AL00001+4                                      0985 02088000
         L     @15,@PC00001+8                                      0985 02089000
         L     @01,CTGFVPTR(,@15)                                  0985 02090000
         LA    @15,CTGFVVLT(,@01)                                  0985 02091000
         ST    @15,@AL00001+8                                      0985 02092000
         LA    @15,DEGPID                                          0985 02093000
         ST    @15,@AL00001+12                                     0985 02094000
         LA    @15,SETZERO                                         0985 02095000
         ST    @15,@AL00001+16                                     0985 02096000
         MVI   @AL00001+16,X'80'                                   0985 02097000
         L     @15,GDTGPL(,@06)                                    0985 02098000
         LA    @01,@AL00001                                        0985 02099000
         BALR  @14,@15                                             0985 02100000
*                RESPECIFY RTNREG RSTD;                            0986 02101000
*                TESTRC = RTNREG;                                  0987 02102000
         LR    TESTRC,RTNREG                                       0987 02103000
*                RESPECIFY RTNREG UNRSTD;                          0988 02104000
*                IF TESTRC ^= 0                                    0989 02105000
*                  THEN                                            0989 02106000
         LTR   TESTRC,TESTRC                                       0989 02107000
         BZ    @RF00989                                            0989 02108000
*                    DO;                                           0990 02109000
*                                                                  0990 02110000
*                    DEFSTID = NOSTORAG;                           0991 02111000
         L     @06,@PC00001+8                                      0991 02112000
         MVC   DEFSTID(5,@06),@CB02317                             0991 02113000
*                    RETURN;                                       0992 02114000
*                                                                  0992 02115000
         B     @EL00003                                            0992 02116000
*                    END;                                          0993 02117000
*                                                                  0993 02118000
*                END;                                              0994 02119000
*                                                                  0994 02120000
@RF00989 DS    0H                                                  0995 02121000
*                VLISTLEN = 0;                                     0995 02122000
@RF00983 L     @08,@PC00001+8                                      0995 02123000
         L     @08,CTGFVPTR(,@08)                                  0995 02124000
         L     @08,CTGFVVLT(,@08)                                  0995 02125000
         SLR   @06,@06                                             0995 02126000
         STH   @06,VLISTLEN(,@08)                                  0995 02127000
*                DO N = 1 TO VOLSTCNT;                             0996 02128000
*                                                                  0996 02129000
         LA    N,1                                                 0996 02130000
         B     @DE00996                                            0996 02131000
@DL00996 DS    0H                                                  0997 02132000
*                /****************************************************/ 02133000
*                /*                                                  */ 02134000
*                /* VOLUME LIST IS INITIALIZED FROM THE FDTTBL       */ 02135000
*                /*                                                  */ 02136000
*                /****************************************************/ 02137000
*                                                                  0997 02138000
*                IF VOLEXFLG = 'F'                                 0997 02139000
*                  THEN                                            0997 02140000
         CLI   VOLEXFLG,C'F'                                       0997 02141000
         BNE   @RF00997                                            0997 02142000
*                    VLISTSER(N) = LISTVAL(N);                     0998 02143000
*                                                                  0998 02144000
         LR    @08,N                                               0998 02145000
         SLA   @08,3                                               0998 02146000
         L     @06,@PC00001+8                                      0998 02147000
         L     @06,CTGFVPTR(,@06)                                  0998 02148000
         L     @06,CTGFVVLT(,@06)                                  0998 02149000
         ALR   @06,@08                                             0998 02150000
         AL    @06,@CF03031                                        0998 02151000
         ALR   @08,FDTTBLPT                                        0998 02152000
         AL    @08,@CF03032                                        0998 02153000
         MVC   VLISTSER-4(6,@06),LISTVAL-3(@08)                    0998 02154000
*                  /**************************************************/ 02155000
*                  /*                                                */ 02156000
*                  /* THE VOLUME LIST IS INITIALIZED FROM THE MODEL  */ 02157000
*                  /*                                                */ 02158000
*                  /**************************************************/ 02159000
*                                                                  0999 02160000
*                  ELSE                                            0999 02161000
*                    VLISTSER(N) = MDLVOLUM(N);                    0999 02162000
*                                                                  0999 02163000
         B     @RC00997                                            0999 02164000
@RF00997 LR    @08,N                                               0999 02165000
         SLA   @08,3                                               0999 02166000
         L     @06,@PC00001+8                                      0999 02167000
         L     @03,CTGFVPTR(,@06)                                  0999 02168000
         L     @03,CTGFVVLT(,@03)                                  0999 02169000
         ALR   @03,@08                                             0999 02170000
         AL    @03,@CF03031                                        0999 02171000
         LR    @08,N                                               0999 02172000
         MH    @08,@CH00157                                        0999 02173000
         L     @06,MDLTBLPT(,@06)                                  0999 02174000
         L     @06,MDLVLIST(,@06)                                  0999 02175000
         ALR   @06,@08                                             0999 02176000
         AL    @06,@CF03033                                        0999 02177000
         MVC   VLISTSER-4(6,@03),MDLVOLUM(@06)                     0999 02178000
*                VLISTLEN = VLISTLEN + 8;                          1000 02179000
*                                                                  1000 02180000
@RC00997 L     @08,@PC00001+8                                      1000 02181000
         L     @08,CTGFVPTR(,@08)                                  1000 02182000
         L     @08,CTGFVVLT(,@08)                                  1000 02183000
         LA    @06,8                                               1000 02184000
         AH    @06,VLISTLEN(,@08)                                  1000 02185000
         STH   @06,VLISTLEN(,@08)                                  1000 02186000
*                END;                                              1001 02187000
*                                                                  1001 02188000
         AL    N,@CF00220                                          1001 02189000
@DE00996 CR    N,VOLSTCNT                                          1001 02190000
         BNH   @DL00996                                            1001 02191000
*            END;                                                  1002 02192000
*                                                                  1002 02193000
*        /************************************************************/ 02194000
*        /*                                                          */ 02195000
*        /* INITIALIZE FILE SEQUENCE NUMBER FIELD                    */ 02196000
*        /*                                                          */ 02197000
*        /************************************************************/ 02198000
*        IF (ADDR(AAFSNO)) ^= NULLPTR                              1003 02199000
*          THEN                                                    1003 02200000
@RF00979 L     @08,@PC00003+116                                    1003 02201000
         LTR   @08,@08                                             1003 02202000
         BZ    @RF01003                                            1003 02203000
*            DO;                                                   1004 02204000
*                                                                  1004 02205000
*            /********************************************************/ 02206000
*            /*                                                      */ 02207000
*            /* THE ELEMENTS IN THE LIST OF FILE SEQUENCE NUMBERS    */ 02208000
*            /* MUST EQUAL THE ELEMENTS IN THE VOLUME SERIAL LIST -  */ 02209000
*            /* IF NOT TERMINATE PROCESSING                          */ 02210000
*            /*                                                      */ 02211000
*            /********************************************************/ 02212000
*                                                                  1005 02213000
*            IF AFSNOCNT ^= VOLSTCNT                               1005 02214000
*              THEN                                                1005 02215000
         L     @08,@PC00001+4                                      1005 02216000
         L     @08,FDTPTR+500(,@08)                                1005 02217000
         C     VOLSTCNT,AFSNOCNT(,@08)                             1005 02218000
         BE    @RF01005                                            1005 02219000
*                DO;                                               1006 02220000
*                                                                  1006 02221000
*                DEFSTID = FILSQERR;                               1007 02222000
         L     @06,@PC00001+8                                      1007 02223000
         MVC   DEFSTID(5,@06),@CB02320                             1007 02224000
*                RETURN;                                           1008 02225000
*                                                                  1008 02226000
         B     @EL00003                                            1008 02227000
*                END;                                              1009 02228000
*                                                                  1009 02229000
*            /********************************************************/ 02230000
*            /*                                                      */ 02231000
*            /* GETSTORAGE FOR THE FILE SEQUENCE LIST                */ 02232000
*            /*                                                      */ 02233000
*            /********************************************************/ 02234000
*                                                                  1010 02235000
*            CTGFLPTR = ADDR(AFSEQFL);                             1010 02236000
@RF01005 L     CTGFLPTR,FPLSTPTR                                   1010 02237000
         LA    CTGFLPTR,AFSEQFL(,CTGFLPTR)                         1010 02238000
*            CTGFLNG(1) = (AFSNOCNT * 2);                          1011 02239000
         L     @09,@PC00001+4                                      1011 02240000
         L     @09,FDTPTR+500(,@09)                                1011 02241000
         L     @09,AFSNOCNT(,@09)                                  1011 02242000
         ALR   @09,@09                                             1011 02243000
         ST    @09,CTGFLNG(,CTGFLPTR)                              1011 02244000
*            CALL IDCSAGP0 (GDTTBL,                                1012 02245000
*                    (CTGFLNG(1)),       /*LENGTH OF STORAGE REQUST  */ 02246000
*                    CTGFLPT(1),         /* ADDR OF STORAGE IN FVT   */ 02247000
*                    DEGPID,             /* POOL ID                  */ 02248000
*                    SETZERO);           /* SET AREA TO ZEROS        */ 02249000
*                                                                  1012 02250000
         L     @09,@PC00001                                        1012 02251000
         ST    @09,@AL00001                                        1012 02252000
         L     @06,CTGFLNG(,CTGFLPTR)                              1012 02253000
         ST    @06,@AFTEMPS+4                                      1012 02254000
         LA    @06,@AFTEMPS+4                                      1012 02255000
         ST    @06,@AL00001+4                                      1012 02256000
         LA    @06,CTGFLPT(,CTGFLPTR)                              1012 02257000
         ST    @06,@AL00001+8                                      1012 02258000
         LA    @06,DEGPID                                          1012 02259000
         ST    @06,@AL00001+12                                     1012 02260000
         LA    @06,SETZERO                                         1012 02261000
         ST    @06,@AL00001+16                                     1012 02262000
         MVI   @AL00001+16,X'80'                                   1012 02263000
         L     @15,GDTGPL(,@09)                                    1012 02264000
         LA    @01,@AL00001                                        1012 02265000
         BALR  @14,@15                                             1012 02266000
*            RESPECIFY RTNREG RSTD;                                1013 02267000
*            TESTRC = RTNREG;                                      1014 02268000
         LR    TESTRC,RTNREG                                       1014 02269000
*            RESPECIFY RTNREG UNRSTD;                              1015 02270000
*                                                                  1015 02271000
*            IF TESTRC ^= 0                                        1016 02272000
*              THEN                                                1016 02273000
         LTR   TESTRC,TESTRC                                       1016 02274000
         BZ    @RF01016                                            1016 02275000
*                DO;                                               1017 02276000
*                                                                  1017 02277000
*                DEFSTID = NOSTORAG;                               1018 02278000
         L     @06,@PC00001+8                                      1018 02279000
         MVC   DEFSTID(5,@06),@CB02317                             1018 02280000
*                RETURN;                                           1019 02281000
*                                                                  1019 02282000
         B     @EL00003                                            1019 02283000
*                END;                                              1020 02284000
*                                                                  1020 02285000
*            /********************************************************/ 02286000
*            /*                                                      */ 02287000
*            /* INITIALIZE THE FILE SEQUENCE LIST                    */ 02288000
*            /*  . SET LENGTH OF ELEMENTS IN FIRST 2 BYTES OF LIST,  */ 02289000
*            /*    THE LENGTH DOES NOT INCLUDE ITSELF                */ 02290000
*            /*  . LOOP INITIALIZES THE ACTUAL SEQUENCE NUMBERS      */ 02291000
*            /*                                                      */ 02292000
*            /********************************************************/ 02293000
*                                                                  1021 02294000
*                                                                  1021 02295000
*            DO N = 1 TO AFSNOCNT;                                 1021 02296000
*                                                                  1021 02297000
@RF01016 LA    N,1                                                 1021 02298000
         B     @DE01021                                            1021 02299000
@DL01021 DS    0H                                                  1022 02300000
*               CTGFLPT(1) -> FSNUMBER(N) = AFSNOVAL(N);           1022 02301000
*                                                                  1022 02302000
         LR    @06,N                                               1022 02303000
         ALR   @06,@06                                             1022 02304000
         L     @04,CTGFLPT(,CTGFLPTR)                              1022 02305000
         LR    @15,N                                               1022 02306000
         SLA   @15,2                                               1022 02307000
         L     @14,@PC00001+4                                      1022 02308000
         L     @01,FDTPTR+500(,@14)                                1022 02309000
         L     @15,AFSNOVAL-4(@15,@01)                             1022 02310000
         BCTR  @04,0                                               1022 02311000
         BCTR  @04,0                                               1022 02312000
         STH   @15,FSNUMBER(@06,@04)                               1022 02313000
*            END;                                                  1023 02314000
*                                                                  1023 02315000
         AL    N,@CF00220                                          1023 02316000
@DE01021 L     @06,@PC00001+4                                      1023 02317000
         L     @06,FDTPTR+500(,@06)                                1023 02318000
         C     N,AFSNOCNT(,@06)                                    1023 02319000
         BNH   @DL01021                                            1023 02320000
*            CTGFVFSN = ADDR(AFSEQFL);                             1024 02321000
*                                                                  1024 02322000
         L     @06,@PC00001+8                                      1024 02323000
         L     @06,CTGFVPTR(,@06)                                  1024 02324000
         L     @04,FPLSTPTR                                        1024 02325000
         LA    @04,AFSEQFL(,@04)                                   1024 02326000
         ST    @04,CTGFVFSN(,@06)                                  1024 02327000
*            END;                                                  1025 02328000
*                                                                  1026 02329000
*        /************************************************************/ 02330000
*        /*                                                          */ 02331000
*        /* INITIALIZE DEVTYPE FPL                                   */ 02332000
*        /*                                                          */ 02333000
*        /************************************************************/ 02334000
*                                                                  1026 02335000
*        IF (ADDR(ADEVICE)) ^= NULLPTR                             1026 02336000
*          THEN                                                    1026 02337000
@RF01003 L     @06,@PC00003+112                                    1026 02338000
         LTR   @06,@06                                             1026 02339000
         BZ    @RF01026                                            1026 02340000
*            DO;                                                   1027 02341000
*                                                                  1027 02342000
*            FDTTBLPT = ADDR(ADEVICE);                             1028 02343000
         LR    FDTTBLPT,@06                                        1028 02344000
*            CTGFLPTR = ADDR(ADEVTFL);                             1029 02345000
         L     CTGFLPTR,FPLSTPTR                                   1029 02346000
         LA    CTGFLPTR,ADEVTFL(,CTGFLPTR)                         1029 02347000
*            CTGFVDVT = CTGFLPTR;                                  1030 02348000
         L     @09,@PC00001+8                                      1030 02349000
         L     @09,CTGFVPTR(,@09)                                  1030 02350000
         ST    CTGFLPTR,CTGFVDVT(,@09)                             1030 02351000
*            GPOOLEN = LISTCNT1 * 12;                              1031 02352000
*                                                                  1031 02353000
         LH    @09,LISTCNT1(,FDTTBLPT)                             1031 02354000
         MH    @09,@CH00036                                        1031 02355000
         ST    @09,GPOOLEN                                         1031 02356000
*            CALL IDCSAGP0(GDTTBL,GPOOLEN,GPOOLPT,DEGPID,SETZERO); 1032 02357000
         L     @09,@PC00001                                        1032 02358000
         ST    @09,@AL00001                                        1032 02359000
         LA    @06,GPOOLEN                                         1032 02360000
         ST    @06,@AL00001+4                                      1032 02361000
         LA    @06,GPOOLPT                                         1032 02362000
         ST    @06,@AL00001+8                                      1032 02363000
         LA    @06,DEGPID                                          1032 02364000
         ST    @06,@AL00001+12                                     1032 02365000
         LA    @06,SETZERO                                         1032 02366000
         ST    @06,@AL00001+16                                     1032 02367000
         MVI   @AL00001+16,X'80'                                   1032 02368000
         L     @15,GDTGPL(,@09)                                    1032 02369000
         LA    @01,@AL00001                                        1032 02370000
         BALR  @14,@15                                             1032 02371000
*            RESPECIFY RTNREG RSTD;                                1033 02372000
*            TESTRC = RTNREG;                                      1034 02373000
         LR    TESTRC,RTNREG                                       1034 02374000
*            RESPECIFY RTNREG UNRSTD;                              1035 02375000
*            IF TESTRC ^= 0                                        1036 02376000
*              THEN                                                1036 02377000
         LTR   TESTRC,TESTRC                                       1036 02378000
         BZ    @RF01036                                            1036 02379000
*                DO;                                               1037 02380000
*                                                                  1037 02381000
*                DEFSTID = NOSTORAG;                               1038 02382000
         L     @06,@PC00001+8                                      1038 02383000
         MVC   DEFSTID(5,@06),@CB02317                             1038 02384000
*                RETURN;                                           1039 02385000
*                                                                  1039 02386000
         B     @EL00003                                            1039 02387000
*                END;                                              1040 02388000
*                                                                  1040 02389000
*            CTGFLNG(1) = GPOOLEN;                                 1041 02390000
@RF01036 L     @06,GPOOLEN                                         1041 02391000
         ST    @06,CTGFLNG(,CTGFLPTR)                              1041 02392000
*            CTGFLPT(1) = GPOOLPT;                                 1042 02393000
*                                                                  1042 02394000
         L     @06,GPOOLPT                                         1042 02395000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1042 02396000
*            DO N = 1 TO LISTCNT1;                                 1043 02397000
*                                                                  1043 02398000
         LA    N,1                                                 1043 02399000
         B     @DE01043                                            1043 02400000
@DL01043 DS    0H                                                  1044 02401000
*              DEVICLST(N) = LISTVAL1(N);                          1044 02402000
*                                                                  1044 02403000
         LR    @06,N                                               1044 02404000
         MH    @06,@CH00036                                        1044 02405000
         L     @03,GPOOLPT                                         1044 02406000
         ALR   @03,@06                                             1044 02407000
         AL    @03,@CF03034                                        1044 02408000
         MVI   DEVICLST+8(@03),C' '                                1044 02409000
         MVC   DEVICLST+9(3,@03),DEVICLST+8(@03)                   1044 02410000
         LR    @06,N                                               1044 02411000
         MH    @06,@CH00038                                        1044 02412000
         ALR   @06,FDTTBLPT                                        1044 02413000
         AL    @06,@CF03035                                        1044 02414000
         MVC   DEVICLST(8,@03),LISTVAL1-3(@06)                     1044 02415000
*            END;                                                  1045 02416000
*                                                                  1045 02417000
         AL    N,@CF00220                                          1045 02418000
@DE01043 CH    N,LISTCNT1(,FDTTBLPT)                               1045 02419000
         BNH   @DL01043                                            1045 02420000
*            END;                                                  1046 02421000
*        /************************************************************/ 02422000
*        /*                                                          */ 02423000
*        /* INITIALIZE BUFFSIZE FPL                                  */ 02424000
*        /*                                                          */ 02425000
*        /************************************************************/ 02426000
*                                                                  1047 02427000
*        IF (ADDR(ABFSZ)) ^= NULLPTR                               1047 02428000
*          THEN                                                    1047 02429000
@RF01026 L     @06,@PC00003+104                                    1047 02430000
         LTR   @06,@06                                             1047 02431000
         BZ    @RF01047                                            1047 02432000
*            DO;                                                   1048 02433000
*                                                                  1048 02434000
*            FDTTBLPT = ADDR(ABFSZ);                               1049 02435000
         LR    FDTTBLPT,@06                                        1049 02436000
*            CTGFLPTR = ADDR(ABFSZFL);                             1050 02437000
         L     CTGFLPTR,FPLSTPTR                                   1050 02438000
         LA    CTGFLPTR,ABFSZFL(,CTGFLPTR)                         1050 02439000
*            CTGFVBUF = CTGFLPTR;                                  1051 02440000
         L     @06,@PC00001+8                                      1051 02441000
         L     @06,CTGFVPTR(,@06)                                  1051 02442000
         ST    CTGFLPTR,CTGFVBUF(,@06)                             1051 02443000
*            CTGFLNG(1) = 4;                                       1052 02444000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00043                        1052 02445000
*            CTGFLPT(1) = ADDR(NUMBVAL);                           1053 02446000
*                                                                  1053 02447000
         ST    FDTTBLPT,CTGFLPT(,CTGFLPTR)                         1053 02448000
*            END;                                                  1054 02449000
*                                                                  1054 02450000
*          ELSE                                                    1055 02451000
*            IF MDLBFSZ ^= NULLPTR                                 1055 02452000
*              THEN                                                1055 02453000
         B     @RC01047                                            1055 02454000
@RF01047 L     @06,@PC00001+8                                      1055 02455000
         L     @04,MDLTBLPT(,@06)                                  1055 02456000
         L     @04,MDLBFSZ(,@04)                                   1055 02457000
         LTR   @04,@04                                             1055 02458000
         BZ    @RF01055                                            1055 02459000
*                DO;                                               1056 02460000
*                                                                  1056 02461000
*                CTGFLPTR = ADDR(ABFSZFL);                         1057 02462000
         L     CTGFLPTR,FPLSTPTR                                   1057 02463000
         LA    CTGFLPTR,ABFSZFL(,CTGFLPTR)                         1057 02464000
*                CTGFVBUF = CTGFLPTR;                              1058 02465000
         L     @06,CTGFVPTR(,@06)                                  1058 02466000
         ST    CTGFLPTR,CTGFVBUF(,@06)                             1058 02467000
*                CTGFLNG(1)= 4;                                    1059 02468000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00043                        1059 02469000
*                CTGFLPT(1) = MDLBFSZ;                             1060 02470000
*                                                                  1060 02471000
         ST    @04,CTGFLPT(,CTGFLPTR)                              1060 02472000
*                END;                                              1061 02473000
*        /************************************************************/ 02474000
*        /*                                                          */ 02475000
*        /* INITIALIZE SPACEPARM FPL                                 */ 02476000
*        /*                                                          */ 02477000
*        /************************************************************/ 02478000
*                                                                  1062 02479000
*        IF ( (ADDR(ATRKS)) ^= NULLPTR  |                          1062 02480000
*             (ADDR(ACYLD)) ^= NULLPTR  |                          1062 02481000
*             (ADDR(ARCDS)) ^= NULLPTR  |                          1062 02482000
*             (ADDR(ACAND)) ^= NULLPTR  |                          1062 02483000
*             MDLSPARM      ^= NULLPTR )                           1062 02484000
*          THEN                                                    1062 02485000
@RF01055 DS    0H                                                  1062 02486000
@RC01047 SLR   @06,@06                                             1062 02487000
         L     @04,@PC00003+24                                     1062 02488000
         CR    @04,@06                                             1062 02489000
         BNE   @RT01062                                            1062 02490000
         L     @04,@PC00003+28                                     1062 02491000
         CR    @04,@06                                             1062 02492000
         BNE   @RT01062                                            1062 02493000
         L     @04,@PC00003+32                                     1062 02494000
         CR    @04,@06                                             1062 02495000
         BNE   @RT01062                                            1062 02496000
         L     @04,@PC00003+60                                     1062 02497000
         CR    @04,@06                                             1062 02498000
         BNE   @RT01062                                            1062 02499000
         L     @04,@PC00001+8                                      1062 02500000
         L     @04,MDLTBLPT(,@04)                                  1062 02501000
         C     @06,MDLSPARM(,@04)                                  1062 02502000
         BE    @RF01062                                            1062 02503000
@RT01062 DS    0H                                                  1063 02504000
*            DO;                                                   1063 02505000
*                                                                  1063 02506000
*            CTGFLPTR = ADDR(ASPACFL);                             1064 02507000
         L     @06,FPLSTPTR                                        1064 02508000
         LA    CTGFLPTR,ASPACFL(,@06)                              1064 02509000
*            CTGFVSPC = CTGFLPTR;                                  1065 02510000
         L     @04,@PC00001+8                                      1065 02511000
         L     @04,CTGFVPTR(,@04)                                  1065 02512000
         ST    CTGFLPTR,CTGFVSPC(,@04)                             1065 02513000
*            CTGFLNG(1) = 7;                                       1066 02514000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00035                        1066 02515000
*            CTGFLPT(1) = ADDR(SPACPFLD);                          1067 02516000
         LA    @04,SPACPFLD(,@06)                                  1067 02517000
         ST    @04,CTGFLPT(,CTGFLPTR)                              1067 02518000
*            SPACPFLD = ''B;                                       1068 02519000
*                                                                  1068 02520000
         XC    SPACPFLD(7,@06),SPACPFLD(@06)                       1068 02521000
*            /********************************************************/ 02522000
*            /*                                                      */ 02523000
*            /*  CANDIDATE IS SPECIFIED BY A NULL SPACPFLD           */ 02524000
*            /*                                                      */ 02525000
*            /********************************************************/ 02526000
*                                                                  1069 02527000
*            /********************************************************/ 02528000
*            /*                                                      */ 02529000
*            /* EXPLICIT SPACEPARM FROM FDTTBL OVERRIDES MODEL       */ 02530000
*            /*                                                      */ 02531000
*            /********************************************************/ 02532000
*                                                                  1069 02533000
*            IF (ADDR(ATRKS)) ^= NULLPTR                           1069 02534000
*              THEN                                                1069 02535000
*                                                                  1069 02536000
         SLR   @04,@04                                             1069 02537000
         L     @15,@PC00003+24                                     1069 02538000
         CR    @15,@04                                             1069 02539000
         BE    @RF01069                                            1069 02540000
*                /****************************************************/ 02541000
*                /*                                                  */ 02542000
*                /* PRIMARY SPACE SPECIFIED IN TRACKS                */ 02543000
*                /*                                                  */ 02544000
*                /****************************************************/ 02545000
*                                                                  1070 02546000
*                DO;                                               1070 02547000
*                                                                  1070 02548000
*                ASPACOPT = SPTRACKS;  /* PRIMARY SPACE - TRACKS     */ 02549000
         MVI   ASPACOPT(@06),X'80'                                 1071 02550000
*                FDTTBLPT = ADDR(APTRK);                           1072 02551000
         L     FDTTBLPT,@PC00003+36                                1072 02552000
*                PRIMESPC = NUMBVAL;                               1073 02553000
*                                                                  1073 02554000
         MVC   PRIMESPC(3,@06),NUMBVAL+1(FDTTBLPT)                 1073 02555000
*                /****************************************************/ 02556000
*                /*                                                  */ 02557000
*                /* SECONDARY SPACE IN TRACKS                        */ 02558000
*                /*                                                  */ 02559000
*                /****************************************************/ 02560000
*                                                                  1074 02561000
*                IF (ADDR(ASTRK)) ^= NULLPTR                       1074 02562000
*                  THEN                                            1074 02563000
         SLR   @04,@04                                             1074 02564000
         L     @15,@PC00003+48                                     1074 02565000
         CR    @15,@04                                             1074 02566000
         BE    @RF01074                                            1074 02567000
*                    DO;                                           1075 02568000
*                                                                  1075 02569000
*                    FDTTBLPT = ADDR(ASTRK);                       1076 02570000
         LR    FDTTBLPT,@15                                        1076 02571000
*                    SCONDSPC = NUMBVAL;                           1077 02572000
*                                                                  1077 02573000
         MVC   SCONDSPC(3,@06),NUMBVAL+1(FDTTBLPT)                 1077 02574000
*                    END;                                          1078 02575000
*                END;                                              1079 02576000
*                                                                  1079 02577000
*              ELSE                                                1080 02578000
*                                                                  1080 02579000
*                /****************************************************/ 02580000
*                /*                                                  */ 02581000
*                /* PRIMARY SPACE SPECIFIED IN CYLINDERS             */ 02582000
*                /*                                                  */ 02583000
*                /****************************************************/ 02584000
*                                                                  1080 02585000
*                IF (ADDR(ACYLD)) ^= NULLPTR                       1080 02586000
*                  THEN                                            1080 02587000
         B     @RC01069                                            1080 02588000
@RF01069 SLR   @06,@06                                             1080 02589000
         L     @04,@PC00003+28                                     1080 02590000
         CR    @04,@06                                             1080 02591000
         BE    @RF01080                                            1080 02592000
*                    DO;                                           1081 02593000
*                                                                  1081 02594000
*                    ASPACOPT = SPCYLNDS;                          1082 02595000
         L     @15,FPLSTPTR                                        1082 02596000
         MVI   ASPACOPT(@15),X'C0'                                 1082 02597000
*                    FDTTBLPT = ADDR(APCYL);                       1083 02598000
         L     FDTTBLPT,@PC00003+40                                1083 02599000
*                    PRIMESPC = NUMBVAL;                           1084 02600000
*                                                                  1084 02601000
         MVC   PRIMESPC(3,@15),NUMBVAL+1(FDTTBLPT)                 1084 02602000
*                    /************************************************/ 02603000
*                    /*                                              */ 02604000
*                    /* SECONDARY SPACE IN CYLINDERS                 */ 02605000
*                    /*                                              */ 02606000
*                    /************************************************/ 02607000
*                                                                  1085 02608000
*                    IF (ADDR(ASCYL)) ^= NULLPTR                   1085 02609000
*                      THEN                                        1085 02610000
         L     @04,@PC00003+52                                     1085 02611000
         CR    @04,@06                                             1085 02612000
         BE    @RF01085                                            1085 02613000
*                        DO;                                       1086 02614000
*                                                                  1086 02615000
         ST    @04,@TF00001                                        1086 02616000
*                        FDTTBLPT = ADDR(ASCYL);                   1087 02617000
         L     FDTTBLPT,@TF00001                                   1087 02618000
*                        SCONDSPC = NUMBVAL;                       1088 02619000
*                                                                  1088 02620000
         MVC   SCONDSPC(3,@15),NUMBVAL+1(FDTTBLPT)                 1088 02621000
*                        END;                                      1089 02622000
*                                                                  1089 02623000
*                    END;                                          1090 02624000
*                                                                  1090 02625000
*                  ELSE                                            1091 02626000
*                                                                  1091 02627000
*                    /************************************************/ 02628000
*                    /*                                              */ 02629000
*                    /* PRIMARY SPACE IN RECORDS                     */ 02630000
*                    /*                                              */ 02631000
*                    /************************************************/ 02632000
*                                                                  1091 02633000
*                    IF (ADDR(ARCDS)) ^= NULLPTR                   1091 02634000
*                      THEN                                        1091 02635000
         B     @RC01080                                            1091 02636000
@RF01080 SLR   @06,@06                                             1091 02637000
         L     @04,@PC00003+32                                     1091 02638000
         CR    @04,@06                                             1091 02639000
         BE    @RF01091                                            1091 02640000
*                        DO;                                       1092 02641000
*                                                                  1092 02642000
*                        ASPACOPT = SPRECDS;                       1093 02643000
         L     @15,FPLSTPTR                                        1093 02644000
         MVI   ASPACOPT(@15),X'40'                                 1093 02645000
*                        FDTTBLPT = ADDR(APRCD);                   1094 02646000
         L     FDTTBLPT,@PC00003+44                                1094 02647000
*                        PRIMESPC = NUMBVAL;                       1095 02648000
*                                                                  1095 02649000
         MVC   PRIMESPC(3,@15),NUMBVAL+1(FDTTBLPT)                 1095 02650000
*                        /********************************************/ 02651000
*                        /*                                          */ 02652000
*                        /* SECONDARY SPACE IN RECORDS               */ 02653000
*                        /*                                          */ 02654000
*                        /********************************************/ 02655000
*                        IF (ADDR(ASRCD)) ^= NULLPTR               1096 02656000
*                          THEN                                    1096 02657000
         L     @04,@PC00003+56                                     1096 02658000
         CR    @04,@06                                             1096 02659000
         BE    @RF01096                                            1096 02660000
*                            DO;                                   1097 02661000
*                                                                  1097 02662000
         ST    @04,@TF00001                                        1097 02663000
*                            FDTTBLPT = ADDR(ASRCD);               1098 02664000
         L     FDTTBLPT,@TF00001                                   1098 02665000
*                            SCONDSPC = NUMBVAL;                   1099 02666000
*                                                                  1099 02667000
         MVC   SCONDSPC(3,@15),NUMBVAL+1(FDTTBLPT)                 1099 02668000
*                            END;                                  1100 02669000
*                                                                  1100 02670000
*                        END;                                      1101 02671000
*                                                                  1101 02672000
*                                                                  1101 02673000
*                                                                  1101 02674000
*                /****************************************************/ 02675000
*                /*                                                  */ 02676000
*                /* NO EXPLICIT PICK UP FROM MODEL                   */ 02677000
*                /*                                                  */ 02678000
*                /****************************************************/ 02679000
*                                                                  1102 02680000
*                ELSE                                              1102 02681000
*                  IF MDLSPARM ^= NULLPTR                          1102 02682000
*                    THEN                                          1102 02683000
         B     @RC01091                                            1102 02684000
@RF01091 SLR   @06,@06                                             1102 02685000
         L     @04,@PC00001+8                                      1102 02686000
         L     @01,MDLTBLPT(,@04)                                  1102 02687000
         C     @06,MDLSPARM(,@01)                                  1102 02688000
         BE    @RF01102                                            1102 02689000
*                      IF CTGTYPE = CTGTUCAT  |                    1103 02690000
*                        CTGFVT -> CTGFVSPC = NULLPTR              1103 02691000
*                          THEN                                    1103 02692000
         L     @04,CTGPLPTR(,@04)                                  1103 02693000
         CLI   CTGTYPE(@04),C'U'                                   1103 02694000
         BE    @RT01103                                            1103 02695000
         L     @04,CTGFVT(,@04)                                    1103 02696000
         C     @06,CTGFVSPC(,@04)                                  1103 02697000
         BNE   @RF01103                                            1103 02698000
@RT01103 DS    0H                                                  1104 02699000
*                            SPACPFLD = MDLSPACE;                  1104 02700000
*                                                                  1104 02701000
         L     @06,FPLSTPTR                                        1104 02702000
         L     @04,@PC00001+8                                      1104 02703000
         L     @04,MDLTBLPT(,@04)                                  1104 02704000
         L     @04,MDLSPARM(,@04)                                  1104 02705000
         MVC   SPACPFLD(7,@06),MDLSPACE(@04)                       1104 02706000
*                          ELSE                                    1105 02707000
*                            CTGFVSPC = NULLPTR;                   1105 02708000
*                                                                  1105 02709000
         B     @RC01103                                            1105 02710000
@RF01103 L     @06,@PC00001+8                                      1105 02711000
         L     @06,CTGFVPTR(,@06)                                  1105 02712000
         SLR   @04,@04                                             1105 02713000
         ST    @04,CTGFVSPC(,@06)                                  1105 02714000
*            END;                                                  1106 02715000
*                                                                  1106 02716000
@RC01103 DS    0H                                                  1106 02717000
@RF01102 DS    0H                                                  1106 02718000
@RC01091 DS    0H                                                  1106 02719000
@RC01080 DS    0H                                                  1106 02720000
@RC01069 DS    0H                                                  1107 02721000
*        /************************************************************/ 02722000
*        /*                                                          */ 02723000
*        /* INITIALIZE ORDERED/UNORDERED ATTRIBUTES IN AMDSB         */ 02724000
*        /*                                                          */ 02725000
*        /************************************************************/ 02726000
*                                                                  1107 02727000
*        IF (ADDR(AORDR)) ^= NULLPTR                               1107 02728000
*          THEN                                                    1107 02729000
@RF01062 L     @06,@PC00003+8                                      1107 02730000
         LTR   @06,@06                                             1107 02731000
         BZ    @RF01107                                            1107 02732000
*            AMDORDER = ON;                                        1108 02733000
         L     @06,@PC00001+8                                      1108 02734000
         L     @06,DSBCATPT(,@06)                                  1108 02735000
         OI    AMDORDER(@06),B'00001000'                           1108 02736000
*          ELSE                                                    1109 02737000
*            IF (ADDR(AUORD)) ^= NULLPTR                           1109 02738000
*              THEN                                                1109 02739000
         B     @RC01107                                            1109 02740000
@RF01107 L     @06,@PC00003+12                                     1109 02741000
         LTR   @06,@06                                             1109 02742000
         BZ    @RF01109                                            1109 02743000
*                AMDORDER = OFF;                                   1110 02744000
*                                                                  1110 02745000
         L     @06,@PC00001+8                                      1110 02746000
         L     @06,DSBCATPT(,@06)                                  1110 02747000
         NI    AMDORDER(@06),B'11110111'                           1110 02748000
*              ELSE                                                1111 02749000
*                IF MDLAMDSB ^= NULLPTR  &                         1111 02750000
*                    CTGTYPE ^= CTGTUCAT                           1111 02751000
*                  THEN                                            1111 02752000
         B     @RC01109                                            1111 02753000
@RF01109 L     @06,@PC00001+8                                      1111 02754000
         L     @04,MDLTBLPT(,@06)                                  1111 02755000
         L     @04,MDLAMDSB(,@04)                                  1111 02756000
         LTR   @04,@04                                             1111 02757000
         BZ    @RF01111                                            1111 02758000
         L     @01,CTGPLPTR(,@06)                                  1111 02759000
         CLI   CTGTYPE(@01),C'U'                                   1111 02760000
         BE    @RF01111                                            1111 02761000
*                    IF MDLAMDSB -> AMDORDER = ON                  1112 02762000
*                      THEN                                        1112 02763000
         TM    AMDORDER(@04),B'00001000'                           1112 02764000
         BNO   @RF01112                                            1112 02765000
*                        AMDORDER = ON;                            1113 02766000
         L     @06,DSBCATPT(,@06)                                  1113 02767000
         OI    AMDORDER(@06),B'00001000'                           1113 02768000
*                      ELSE                                        1114 02769000
*                        AMDORDER = OFF;                           1114 02770000
*                                                                  1114 02771000
         B     @RC01112                                            1114 02772000
@RF01112 L     @06,@PC00001+8                                      1114 02773000
         L     @06,DSBCATPT(,@06)                                  1114 02774000
         NI    AMDORDER(@06),B'11110111'                           1114 02775000
*        /************************************************************/ 02776000
*        /*                                                          */ 02777000
*        /* INITIALIZE CONTROL INTERVAL SIZE                         */ 02778000
*        /*                                                          */ 02779000
*        /************************************************************/ 02780000
*                                                                  1115 02781000
*        IF (ADDR(ACINV)) ^= NULLPTR                               1115 02782000
*          THEN                                                    1115 02783000
@RC01112 DS    0H                                                  1115 02784000
@RF01111 DS    0H                                                  1115 02785000
@RC01109 DS    0H                                                  1115 02786000
@RC01107 L     @06,@PC00003+108                                    1115 02787000
         LTR   @06,@06                                             1115 02788000
         BZ    @RF01115                                            1115 02789000
*            DO;                                                   1116 02790000
*                                                                  1116 02791000
*            FDTTBLPT = ADDR(ACINV);                               1117 02792000
         LR    FDTTBLPT,@06                                        1117 02793000
*            AMDCINV = NUMBVAL;                                    1118 02794000
*                                                                  1118 02795000
         L     @06,@PC00001+8                                      1118 02796000
         L     @06,DSBCATPT(,@06)                                  1118 02797000
         L     @15,NUMBVAL(,FDTTBLPT)                              1118 02798000
         ST    @15,AMDCINV(,@06)                                   1118 02799000
*            END;                                                  1119 02800000
*                                                                  1119 02801000
*          ELSE                                                    1120 02802000
*            IF MDLAMDSB ^= NULLPTR  &                             1120 02803000
*                CTGTYPE ^= CTGTUCAT                               1120 02804000
*              THEN                                                1120 02805000
         B     @RC01115                                            1120 02806000
@RF01115 L     @06,@PC00001+8                                      1120 02807000
         L     @04,MDLTBLPT(,@06)                                  1120 02808000
         L     @04,MDLAMDSB(,@04)                                  1120 02809000
         LTR   @04,@04                                             1120 02810000
         BZ    @RF01120                                            1120 02811000
         L     @01,CTGPLPTR(,@06)                                  1120 02812000
         CLI   CTGTYPE(@01),C'U'                                   1120 02813000
         BE    @RF01120                                            1120 02814000
*                AMDCINV = MDLAMDSB -> AMDCINV;                    1121 02815000
*                                                                  1121 02816000
         L     @06,DSBCATPT(,@06)                                  1121 02817000
         L     @04,AMDCINV(,@04)                                   1121 02818000
         ST    @04,AMDCINV(,@06)                                   1121 02819000
*        /************************************************************/ 02820000
*        /*                                                          */ 02821000
*        /* INITIALIZE JCL STATEMENT ADDRESS IN FVT                  */ 02822000
*        /*                                                          */ 02823000
*        /************************************************************/ 02824000
*                                                                  1122 02825000
*        IF (ADDR(AINDDN)) ^= NULLPTR                      /*@Y30SSJH*/ 02826000
*          THEN                                                    1122 02827000
@RF01120 DS    0H                                                  1122 02828000
@RC01115 L     @06,@PC00003                                        1122 02829000
         LTR   @06,@06                                             1122 02830000
         BZ    @RF01122                                            1122 02831000
*            DO;                                                   1123 02832000
*                                                                  1123 02833000
*            FDTTBLPT = ADDR(AINDDN);                      /*@Y30SSJH*/ 02834000
         LR    FDTTBLPT,@06                                        1124 02835000
*            CTGFVIND = ADDR(CHARVAL);                             1125 02836000
*                                                                  1125 02837000
         L     @06,@PC00001+8                                      1125 02838000
         L     @06,CTGFVPTR(,@06)                                  1125 02839000
         LA    @15,CHARVAL(,FDTTBLPT)                              1125 02840000
         ST    @15,CTGFVIND(,@06)                                  1125 02841000
*            END;                                                  1126 02842000
*                                                                  1126 02843000
*        /************************************************************/ 02844000
*        /*                                                  @Y30SSJH*/ 02845000
*        /* INITIALIZE POINTER TO RECOVERY VOLUME SERIAL     @Y30SSJH*/ 02846000
*        /* WORKAREA                                         @Y30SSJH*/ 02847000
*        /*                                                  @Y30SSJH*/ 02848000
*        /************************************************************/ 02849000
*                                                                  1127 02850000
*        IF CTGFVTYP ^= 'D' &                                      1127 02851000
*           CTGFVTYP ^= 'I'                                        1127 02852000
*          THEN                                                    1127 02853000
@RF01122 L     @06,@PC00001+8                                      1127 02854000
         L     @04,CTGFVPTR(,@06)                                  1127 02855000
         CLI   CTGFVTYP(@04),C'D'                                  1127 02856000
         BE    @RF01127                                            1127 02857000
         CLI   CTGFVTYP(@04),C'I'                                  1127 02858000
         BE    @RF01127                                            1127 02859000
*            DO;                                           /*@Y30SSJH*/ 02860000
*                                                                  1128 02861000
*            CTGFVWKA = ADDR(RECVSWKA);                    /*@Y30SSJH*/ 02862000
         L     @06,DEPLPTR(,@06)                                   1129 02863000
         LA    @15,RECVSWKA(,@06)                                  1129 02864000
         ST    @15,CTGFVWKA(,@04)                                  1129 02865000
*            RECVSLEN = LENGTH(RECVSWKA);                  /*@Y30SSJH*/ 02866000
*                                                                  1130 02867000
         MVC   RECVSLEN(2,@06),@CH00036                            1130 02868000
*            END;                                          /*@Y30SSJH*/ 02869000
*                                                                  1131 02870000
*        /************************************************************/ 02871000
*        /*                                                          */ 02872000
*        /* THIS COMPLETES THE ALLOCATION PASS RETURN TO SECOND LEVEL*/ 02873000
*        /* PROCESSOR WHICH INVOKED ALLCPROC                         */ 02874000
*        /*                                                          */ 02875000
*        /************************************************************/ 02876000
*                                                                  1132 02877000
*        RETURN;                                                   1132 02878000
*                                                                  1132 02879000
         B     @EL00003                                            1132 02880000
*END ALLCPROC;                                                     1133 02881000
         B     @EL00003                                            1133 02882000
*/********************************************************************/ 02883000
*/*                                                                  */ 02884000
*/* PROCEDURE NAME - KEYPROC (LEVEL THREE INTERNAL PROCEDURE)        */ 02885000
*/*                                                                  */ 02886000
*/* FUNCTION - KEYPROC INITIALIZES THE FOLLOWING ITEMS:              */ 02887000
*/*            . AMDSBCAT FPL - RECORD MANAGEMENT CONTROL BLOCK      */ 02888000
*/*            . KEY RANGE 'PSEUDO FIELD'                            */ 02889000
*/*                                                                  */ 02890000
*/*            KEYPROC RECEIVES ARGUMENTS FROM TWO SOURCES - EXPLICIT*/ 02891000
*/*            ARGUMENTS DERIVED FROM THE FDTTBL AND FROM THE        */ 02892000
*/*            MODEL TABLE (KYMDLTAB). EXPLICIT ATTRIBUTES OVERRIDE  */ 02893000
*/*            THEIR MODEL TABLE COUNTERPARTS.                       */ 02894000
*/*                                                                  */ 02895000
*/* INPUT -                                                          */ 02896000
*/*            DEFSTID - GLOBAL INTERNAL STATUS COMMNUNICATOR        */ 02897000
*/*            CTGFV   - THE CURRENT FVT IS ESTABLISHED EXTERNALLY   */ 02898000
*/*              BY THE LEVEL TWO PROCESSOR                          */ 02899000
*/*            SEE DEFINITION OF ARGUMENTS OF INVOCATION(BELOW)      */ 02900000
*/*                                                                  */ 02901000
*/* OUTPUT -                                                         */ 02902000
*/*            DEFSTID - GLOBAL PROCESSING STATUS, SET ON ERROR      */ 02903000
*/*              DETECTION.                                          */ 02904000
*/*                . DEFSTID = NOSTORAG                              */ 02905000
*/*                . DEFSTID = RANGERR                               */ 02906000
*/*            CREATION OF FIELDS MENTIONED ABOVE                    */ 02907000
*/*                                                                  */ 02908000
*/********************************************************************/ 02909000
*KEYPROC:                                                          1134 02910000
*        PROCEDURE(KEY,KYPS,KYLN,RANGE,RANGECNT,                   1134 02911000
*              RNGLOPTR,RNGHIPTR,KSPND,KNSPD,KUNQK,KNUQK,  /*@Y30SSJH*/ 02912000
*              KYMDLTAB)                                   /*@Y30SSJH*/ 02913000
*          OPTIONS(SAVEAREA);                              /*@Y30SSJH*/ 02914000
KEYPROC  STM   @14,@12,12(@13)                                     1134 02915000
         ST    @13,@SA00004+4                                      1134 02916000
         LA    @14,@SA00004                                        1134 02917000
         ST    @14,8(,@13)                                         1134 02918000
         LR    @13,@14                                             1134 02919000
         MVC   @PC00004(48),0(@01)                                 1134 02920000
*        GEN (ENTRY KEYPROC);        /* EXTERNAL ENTRY POINT @Y30SSJH*/ 02921000
         ENTRY KEYPROC                                                  02922000
*        LM(REG10,REG12,BASESAVE);      /* LOAD PROC CODEREG @Y30SSJH*/ 02923000
*                                                                  1136 02924000
         LM    REG10,REG12,BASESAVE                                1136 02925000
*        /************************************************************/ 02926000
*        /*                                                          */ 02927000
*        /* ARGUMENTS OF INVOCATION                                  */ 02928000
*        /*                                                          */ 02929000
*        /************************************************************/ 02930000
*        DCL                                                       1137 02931000
*          KEY,                        /* INDICATOR OF KEYS PARAM   */  02932000
*          KYPS,                       /* KEY POSITION              */  02933000
*          KYLN,                       /* KEY LENGTH                */  02934000
*          RANGE,                      /* INDICATOR OF RANGE PARM    */ 02935000
*          RANGECNT FIXED(31),         /* PAIRS OF RANGES            */ 02936000
*          RNGLOPTR(*) PTR(31),        /* LOW RANGE POINTER          */ 02937000
*          RNGHIPTR(*) PTR(31),        /* HIGH RANGE POINTER         */ 02938000
*          KSPND,                      /* SPANNED ATTRIBUTE  @Y30SSJH*/ 02939000
*          KNSPD,                      /* NONSPANNED         @Y30SSJH*/ 02940000
*          KUNQK,                      /* UNIQUEKEY          @Y30SSJH*/ 02941000
*          KNUQK,                      /* NONUNIQUEKEY       @Y30SSJH*/ 02942000
*          KYMDLTAB;                   /* MODEL TABLE                */ 02943000
*                                                                  1137 02944000
*        DCL KEYFPLPT PTR(31);                                     1138 02945000
*                                                                  1138 02946000
*        /************************************************************/ 02947000
*        /*                                                          */ 02948000
*        /* BASIC OVERLAY FOR FPL AND AMDSBCAT FIELD                 */ 02949000
*        /*                                                          */ 02950000
*        /************************************************************/ 02951000
*        DCL                                                       1139 02952000
*          1 FPLAMDSB  BDY(WORD)BASED(KEYFPLPT),                   1139 02953000
*            2 KFPLAREA CHAR(LENGTH(CTGFL)),                       1139 02954000
*            2 *       CHAR(8),                                    1139 02955000
*            2 AMDAREA CHAR(LENGTH(IDAAMDSB));             /*@Y30SSJH*/ 02956000
*                                                                  1139 02957000
*        /************************************************************/ 02958000
*        /*                                                          */ 02959000
*        /* AMDSBCAT FIELD NAME                                      */ 02960000
*        /*                                                          */ 02961000
*        /************************************************************/ 02962000
*        DCL                                                       1140 02963000
*          AMDSBNAM CHAR(8) INIT('AMDSBCAT') STATIC;               1140 02964000
*                                                                  1140 02965000
*        /************************************************************/ 02966000
*        /*                                                  @Y30SSJH*/ 02967000
*        /* CONSTANTS USED FOR DEFAULT KEYLENGTH AND RKP     @Y30SSJH*/ 02968000
*        /*                                                  @Y30SSJH*/ 02969000
*        /************************************************************/ 02970000
*                                                                  1141 02971000
*        DCL                                                       1141 02972000
*          KEYLNDEF FIXED(15) CONSTANT(64),                /*@Y30SSJH*/ 02973000
*          AIXRKP   FIXED(15) CONSTANT(5);                 /*@Y30SSJH*/ 02974000
*                                                                  1141 02975000
*        /************************************************************/ 02976000
*        /*                                                          */ 02977000
*        /* OVERLAY FOR LOW - HIGH KEY FDT SPECIFICATION             */ 02978000
*        /*                                                          */ 02979000
*        /************************************************************/ 02980000
*        DCL                                                       1142 02981000
*          RGFDTPTR PTR(31);                                       1142 02982000
*        DCL                                                       1143 02983000
*          1 RANGEFDT BASED(RGFDTPTR),                             1143 02984000
*            2 RGKEYLN FIXED(8),                           /*@Y30SSJH*/ 02985000
*            2 RGKEY   CHAR(*);                                    1143 02986000
*                                                                  1143 02987000
*        DCL                                                       1144 02988000
*          RANGLOOP  FIXED(31);        /* RANGE LOOP CONTROL         */ 02989000
*                                                                  1144 02990000
*        DCL                                                       1145 02991000
*          RGLSTPT PTR(31);                                        1145 02992000
*                                                                  1145 02993000
*        DCL                                                       1146 02994000
*          1 RANGLIST  BASED(RGLSTPT),                             1146 02995000
*            2 RGLISTLN FIXED(15) BDY(BYTE),                       1146 02996000
*            2 RANGARRY CHAR(*);                                   1146 02997000
*                                                                  1146 02998000
*        DCL                                                       1147 02999000
*          1 LOHIPAIR BASED(RGLSTPT),                              1147 03000000
*            2 LOHIKYLN FIXED(15),                                 1147 03001000
*            2 LOHIKEY  CHAR(*);                                   1147 03002000
*                                                                  1147 03003000
*        /************************************************************/ 03004000
*        /*                                                          */ 03005000
*        /* ADDRESSABILITY STRUCTURE TO KEY RANGES AS REQUIRED BY    */ 03006000
*        /* THE MODELING OF RANGES                                   */ 03007000
*        /*                                                          */ 03008000
*        /************************************************************/ 03009000
*        DCL                                                       1148 03010000
*          RNGFPLLO PTR(31),                                       1148 03011000
*          RNGFPLHI PTR(31);                                       1148 03012000
*                                                                  1148 03013000
*        DCL                                                       1149 03014000
*          1 RGKYFPL  BASED(RNGFPLLO),                             1149 03015000
*            2 FPLLKYLN FIXED(15),                                 1149 03016000
*            2 FPLLOKEY CHAR(*);                                   1149 03017000
*                                                                  1149 03018000
*        DCL                                                       1150 03019000
*          1 RGHKYFPL  BASED(RNGFPLHI),                            1150 03020000
*            2 FPLHKYLN FIXED(15),                                 1150 03021000
*            2 FPLHIKEY CHAR(*);                                   1150 03022000
*                                                                  1150 03023000
*        /************************************************************/ 03024000
*        /*                                                          */ 03025000
*        /* RANGE COMPUTATION VARIABLES                              */ 03026000
*        /*                                                          */ 03027000
*        /************************************************************/ 03028000
*        DCL                                                       1151 03029000
*          MAXRGADR  PTR(31),          /* END ADDR OF RANGE LIST     */ 03030000
*          RANGELEN  FIXED(31),        /* LENGTH OF RANGE LIST       */ 03031000
*          RANGFLAG  CHAR(1);          /* LOOP CONTROL FLAG          */ 03032000
*                                                                  1151 03033000
*        /************************************************************/ 03034000
*        /*                                                          */ 03035000
*        /* VARIABLES AND WORKAREAS USED IN CHECKING THE VALIDITY OF */ 03036000
*        /* KEY RANGE PAIRS WHICH COMPRISE THE KEYRANGE LIST         */ 03037000
*        /*                                                          */ 03038000
*        /************************************************************/ 03039000
*        DCL                                                       1152 03040000
*          CKRANGE   CHAR(1),          /* FLAG WHICH INDICATES A KEY    03041000
*                                         RANGE IS TO BE CHECKED     */ 03042000
*          LKYCHECK  CHAR(64),         /* LOW KEY CHECK AREA         */ 03043000
*          HKYCHECK  CHAR(64),         /* HIGH KEY CHECK AREA        */ 03044000
*          LKYCMPR   CHAR(64),         /* LOW KEY COMPARE AREA       */ 03045000
*          HKYCMPR   CHAR(64),         /* HIGH KEY COMPARE AREA      */ 03046000
*          LKYCKPTR  PTR(31),          /* PTR TO LOW KEY IN CHECKLIST*/ 03047000
*          HKYCKPTR  PTR(31),          /* PTR TO HIGHKEY IN CHECKLIST*/ 03048000
*          LKYCMPTR  PTR(31),          /* PTR TO LOWKEY COMPARELIST  */ 03049000
*          HKYCMPTR  PTR(31),          /* PTR TO HIGHKEY COMPARELIST */ 03050000
*          KYMSKPTR  PTR(31);          /* PTR TO MASK USED IN SETTING   03051000
*                                         KEY AREAS TO BINARY ONES   */ 03052000
*                                                                  1152 03053000
*        DCL                                                       1153 03054000
*          KEYMASK   CHAR(64) BASED(KYMSKPTR); /* MASK FOR ONES INIT */ 03055000
*                                                                  1153 03056000
*        DCL                                                       1154 03057000
*          1 *       BASED(LKYCKPTR),  /* LOWKEY CHECK LIST          */ 03058000
*            2 LKYLEN  FIXED(15),                                  1154 03059000
*            2 LOKEY   CHAR(*);                                    1154 03060000
*                                                                  1154 03061000
*        DCL                                                       1155 03062000
*          1 *       BASED(HKYCKPTR),  /* HIGHKEY CHECK LIST         */ 03063000
*            2 HIKYLEN FIXED(15),                                  1155 03064000
*            2 HIKEY   CHAR(*);                                    1155 03065000
*                                                                  1155 03066000
*        DCL                                                       1156 03067000
*          1 *       BASED(LKYCMPTR),  /* LOWKEY COMPARE LIST        */ 03068000
*            2 LKYCMPLN FIXED(15),                                 1156 03069000
*            2 LKYCOMP  CHAR(*);                                   1156 03070000
*                                                                  1156 03071000
*        DCL                                                       1157 03072000
*          1 *       BASED(HKYCMPTR),  /* HIGHKEY COMPARE LIST       */ 03073000
*            2 HKYCMPLN FIXED(15),                                 1157 03074000
*            2 HKYCOMP  CHAR(*);                                   1157 03075000
*        /************************************************************/ 03076000
*        /*                                                          */ 03077000
*        /* ENTRY POINT TO KEYPROC                                   */ 03078000
*        /*                                                          */ 03079000
*        /************************************************************/ 03080000
*                                                                  1158 03081000
*        OLDERID2 = NEWERID2;                                      1158 03082000
         L     @06,@PC00001                                        1158 03083000
         L     @04,GDTTR2(,@06)                                    1158 03084000
         MVC   @TS00001(95),NEWERID2(@04)                          1158 03085000
         MVC   OLDERID2(95,@04),@TS00001                           1158 03086000
*        NEWID2 = 'DE33';                                          1159 03087000
         MVC   NEWID2(4,@04),@CC02811                              1159 03088000
*        CKRANGE = STOP;                                           1160 03089000
*                                                                  1160 03090000
         MVI   CKRANGE,X'0F'                                       1160 03091000
*        /************************************************************/ 03092000
*        /*                                                          */ 03093000
*        /* GET DYNAMIC STORAGE FOR AMDSBCAT FPL AND AMDSBCAT FIELD  */ 03094000
*        /*                                                          */ 03095000
*        /************************************************************/ 03096000
*                                                                  1161 03097000
*        IF KEYFLAG = GO                                           1161 03098000
*          THEN                                                    1161 03099000
         L     @04,@PC00001+8                                      1161 03100000
         CLI   KEYFLAG(@04),X'00'                                  1161 03101000
         BNE   @RF01161                                            1161 03102000
*            DO;                                                   1162 03103000
*                                                                  1162 03104000
*            KEYFLAG = STOP;                                       1163 03105000
         MVI   KEYFLAG(@04),X'0F'                                  1163 03106000
*            CALL IDCSAGP0 (GDTTBL,(LENGTH(FPLAMDSB)),             1164 03107000
*              KEYFPLPT,DEGPID,SETZERO);                           1164 03108000
*                                                                  1164 03109000
         ST    @06,@AL00001                                        1164 03110000
         LA    @09,120                                             1164 03111000
         ST    @09,@AFTEMPS+8                                      1164 03112000
         LA    @09,@AFTEMPS+8                                      1164 03113000
         ST    @09,@AL00001+4                                      1164 03114000
         LA    @09,KEYFPLPT                                        1164 03115000
         ST    @09,@AL00001+8                                      1164 03116000
         LA    @09,DEGPID                                          1164 03117000
         ST    @09,@AL00001+12                                     1164 03118000
         LA    @09,SETZERO                                         1164 03119000
         ST    @09,@AL00001+16                                     1164 03120000
         MVI   @AL00001+16,X'80'                                   1164 03121000
         L     @15,GDTGPL(,@06)                                    1164 03122000
         LA    @01,@AL00001                                        1164 03123000
         BALR  @14,@15                                             1164 03124000
*            RESPECIFY RTNREG RSTD;                                1165 03125000
*            TESTRC = RTNREG;                                      1166 03126000
         LR    TESTRC,RTNREG                                       1166 03127000
*            RESPECIFY RTNREG UNRSTD;                              1167 03128000
*            IF TESTRC ^= 0                                        1168 03129000
*              THEN                                                1168 03130000
         LTR   TESTRC,TESTRC                                       1168 03131000
         BZ    @RF01168                                            1168 03132000
*                DO;                                               1169 03133000
*                                                                  1169 03134000
*                DEFSTID = NOSTORAG;                               1170 03135000
         L     @06,@PC00001+8                                      1170 03136000
         MVC   DEFSTID(5,@06),@CB02317                             1170 03137000
*                RETURN;                                           1171 03138000
*                                                                  1171 03139000
@EL00004 L     @13,4(,@13)                                         1171 03140000
@EF00004 DS    0H                                                  1171 03141000
@ER00004 LM    @14,@12,12(@13)                                     1171 03142000
         BR    @14                                                 1171 03143000
*                END;                                              1172 03144000
*                                                                  1172 03145000
*            /********************************************************/ 03146000
*            /*                                                      */ 03147000
*            /* INITIALIZE FPL AND REFERENCE IDAAMDSB        @Y30SSJH*/ 03148000
*            /*                                                      */ 03149000
*            /********************************************************/ 03150000
*                                                                  1173 03151000
*            CTGFLPTR = ADDR(KFPLAREA);                            1173 03152000
@RF01168 L     @06,KEYFPLPT                                        1173 03153000
         LR    CTGFLPTR,@06                                        1173 03154000
*            CTGFVAMD = CTGFLPTR;                                  1174 03155000
         L     @04,@PC00001+8                                      1174 03156000
         L     @02,CTGFVPTR(,@04)                                  1174 03157000
         ST    CTGFLPTR,CTGFVAMD(,@02)                             1174 03158000
*            CTGFLNG(1) = LENGTH(IDAAMDSB);                /*@Y30SSJH*/ 03159000
         MVC   CTGFLNG(4,CTGFLPTR),@CF01344                        1175 03160000
*            CTGFLPT(1) = ADDR(AMDAREA);                           1176 03161000
         LA    @06,AMDAREA(,@06)                                   1176 03162000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1176 03163000
*            DSBCATPT = CTGFLPT(1);                                1177 03164000
         ST    @06,DSBCATPT(,@04)                                  1177 03165000
*            CTGFLDNO = 1;                                         1178 03166000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1178 03167000
*            CTGFLDNM = ADDR(AMDSBNAM);                            1179 03168000
         LA    @04,AMDSBNAM                                        1179 03169000
         ST    @04,CTGFLDNM(,CTGFLPTR)                             1179 03170000
*            AMDLEN = CTGFLNG(1);                                  1180 03171000
*                                                                  1180 03172000
         L     @04,CTGFLNG(,CTGFLPTR)                              1180 03173000
         STH   @04,AMDLEN(,@06)                                    1180 03174000
*            /********************************************************/ 03175000
*            /*                                                      */ 03176000
*            /* SET TYPE - INDEXED OR NONINDEXED                     */ 03177000
*            /*            OR NUMBERED                       @Y30SSJH*/ 03178000
*            /*                                                      */ 03179000
*            /********************************************************/ 03180000
*                                                                  1181 03181000
*            IF ((ADDR(INDEX))  ^= NULLPTR  |                      1181 03182000
*                (ADDR(CINDX))  ^= NULLPTR  |                      1181 03183000
*                (ADDR(MCAT))   ^= NULLPTR  |                      1181 03184000
*                (ADDR(UCAT))   ^= NULLPTR  |                      1181 03185000
*                (ADDR(AIX))    ^= NULLPTR  |              /*@Y30SSJH*/ 03186000
*                (ADDR(CNIDX)    = NULLPTR &                       1181 03187000
*                 ADDR(PGSP)     = NULLPTR  &                      1181 03188000
*                 ADDR(CNUMD)    = NULLPTR &               /*@Y30SSJH*/ 03189000
*                 ADDR(CMODL)    = NULLPTR) |                      1181 03190000
*                (ADDR(CMODL)   ^= NULLPTR &                       1181 03191000
*                 IASCNMID       = 'I'      ) )                    1181 03192000
*              THEN                                                1181 03193000
*                                                                  1181 03194000
         SLR   @06,@06                                             1181 03195000
         L     @04,@PC00001+4                                      1181 03196000
         C     @06,FDTPTR+32(,@04)                                 1181 03197000
         BNE   @RT01181                                            1181 03198000
         C     @06,FDTPTR+92(,@04)                                 1181 03199000
         BNE   @RT01181                                            1181 03200000
         C     @06,FDTPTR+12(,@04)                                 1181 03201000
         BNE   @RT01181                                            1181 03202000
         C     @06,FDTPTR+16(,@04)                                 1181 03203000
         BNE   @RT01181                                            1181 03204000
         C     @06,FDTPTR+52(,@04)                                 1181 03205000
         BNE   @RT01181                                            1181 03206000
         C     @06,FDTPTR+96(,@04)                                 1181 03207000
         BNE   @GL00031                                            1181 03208000
         C     @06,FDTPTR+24(,@04)                                 1181 03209000
         BNE   @GL00031                                            1181 03210000
         C     @06,FDTPTR+1056(,@04)                               1181 03211000
         BNE   @GL00031                                            1181 03212000
         C     @06,FDTPTR+104(,@04)                                1181 03213000
         BE    @RT01181                                            1181 03214000
@GL00031 L     @06,@PC00001+4                                      1181 03215000
         L     @06,FDTPTR+104(,@06)                                1181 03216000
         LTR   @06,@06                                             1181 03217000
         BZ    @RF01181                                            1181 03218000
         L     @06,@PC00001+8                                      1181 03219000
         CLI   IASCNMID(@06),C'I'                                  1181 03220000
         BNE   @RF01181                                            1181 03221000
@RT01181 DS    0H                                                  1182 03222000
*                /****************************************************/ 03223000
*                /*                                          @Y30SSJH*/ 03224000
*                /* THE TYPE IS INDEXED - SET KSDS INDICATOR @Y30SSJH*/ 03225000
*                /* AND DEFAULT KEYLENGTH AND RKP            @Y30SSJH*/ 03226000
*                /*                                          @Y30SSJH*/ 03227000
*                /****************************************************/ 03228000
*                                                                  1182 03229000
*                DO;                                       /*@Y30SSJH*/ 03230000
*                AMDDST = ON;                              /*@Y30SSJH*/ 03231000
*                                                                  1183 03232000
         L     @06,@PC00001+8                                      1183 03233000
         L     @04,DSBCATPT(,@06)                                  1183 03234000
         OI    AMDDST(@04),B'10000000'                             1183 03235000
*                IF (ADDR(MCAT)) = NULLPTR &                       1184 03236000
*                   (ADDR(UCAT)) = NULLPTR &                       1184 03237000
*                    CTGFVTYP = 'D'                                1184 03238000
*                  THEN                                            1184 03239000
         SLR   @15,@15                                             1184 03240000
         L     @14,@PC00001+4                                      1184 03241000
         C     @15,FDTPTR+12(,@14)                                 1184 03242000
         BNE   @RF01184                                            1184 03243000
         C     @15,FDTPTR+16(,@14)                                 1184 03244000
         BNE   @RF01184                                            1184 03245000
         L     @06,CTGFVPTR(,@06)                                  1184 03246000
         CLI   CTGFVTYP(@06),C'D'                                  1184 03247000
         BNE   @RF01184                                            1184 03248000
*                    DO;                                   /*@Y30SSJH*/ 03249000
*                                                                  1185 03250000
*                    AMDKEYLN = KEYLNDEF;                  /*@Y30SSJH*/ 03251000
*                                                                  1186 03252000
         MVC   AMDKEYLN(2,@04),@CH01127                            1186 03253000
*                    IF (ADDR(AIX)) ^= NULLPTR                     1187 03254000
*                      THEN                                        1187 03255000
         C     @15,FDTPTR+52(,@14)                                 1187 03256000
         BE    @RF01187                                            1187 03257000
*                        DO;               /* AIX DEFAULT    @Y30SSJH*/ 03258000
*                                                                  1188 03259000
*                        AMDAXRKP = NULLPTR;               /*@Y30SSJH*/ 03260000
         STH   @15,AMDAXRKP(,@04)                                  1189 03261000
*                        AMDRKP = AIXRKP;                  /*@Y30SSJH*/ 03262000
*                                                                  1190 03263000
         MVC   AMDRKP(2,@04),@CH00287                              1190 03264000
*                        END;                              /*@Y30SSJH*/ 03265000
*                                                                  1191 03266000
*                      ELSE                /* CLUSTER DEFAULT@Y30SSJH*/ 03267000
*                        AMDRKP = NULLPTR;                 /*@Y30SSJH*/ 03268000
*                                                                  1192 03269000
         B     @RC01187                                            1192 03270000
@RF01187 L     @06,@PC00001+8                                      1192 03271000
         L     @06,DSBCATPT(,@06)                                  1192 03272000
         SLR   @04,@04                                             1192 03273000
         STH   @04,AMDRKP(,@06)                                    1192 03274000
*                    END;                                  /*@Y30SSJH*/ 03275000
*                                                                  1193 03276000
*                END;                                      /*@Y30SSJH*/ 03277000
*                                                                  1194 03278000
*              /******************************************************/ 03279000
*              /*                                            @Y30SSJH*/ 03280000
*              /* THE TYPE IS NOT INDEXED - DETERMINE IF IT  @Y30SSJH*/ 03281000
*              /* IS NUMBERED                                @Y30SSJH*/ 03282000
*              /*                                            @Y30SSJH*/ 03283000
*              /******************************************************/ 03284000
*                                                                  1195 03285000
*              ELSE                                                1195 03286000
*                IF (ADDR(CNUMD)) ^= NULLPTR                       1195 03287000
*                  THEN                                            1195 03288000
         B     @RC01181                                            1195 03289000
@RF01181 L     @06,@PC00001+4                                      1195 03290000
         L     @06,FDTPTR+1056(,@06)                               1195 03291000
         LTR   @06,@06                                             1195 03292000
         BZ    @RF01195                                            1195 03293000
*                    AMDRRDS = ON;     /* NUMBERED SPECIFIED @Y30SSJH*/ 03294000
*                                                                  1196 03295000
         L     @06,@PC00001+8                                      1196 03296000
         L     @06,DSBCATPT(,@06)                                  1196 03297000
         OI    AMDRRDS(@06),B'00000010'                            1196 03298000
*                  ELSE                                            1197 03299000
*                    IF (ADDR(CNIDX)) = NULLPTR &                  1197 03300000
*                       MDLAMDSB ^= NULLPTR                        1197 03301000
*                      THEN                                        1197 03302000
         B     @RC01195                                            1197 03303000
@RF01195 SLR   @06,@06                                             1197 03304000
         L     @04,@PC00001+4                                      1197 03305000
         C     @06,FDTPTR+96(,@04)                                 1197 03306000
         BNE   @RF01197                                            1197 03307000
         L     @04,@PC00001+8                                      1197 03308000
         L     @01,MDLTBLPT(,@04)                                  1197 03309000
         L     @15,MDLAMDSB(,@01)                                  1197 03310000
         CR    @15,@06                                             1197 03311000
         BE    @RF01197                                            1197 03312000
*                        IF MDLAMDSB -> AMDRRDS = ON               1198 03313000
*                          THEN                                    1198 03314000
         TM    AMDRRDS(@15),B'00000010'                            1198 03315000
         BNO   @RF01198                                            1198 03316000
*                            AMDRRDS = ON; /* NUMBERED MODEL @Y30SSJH*/ 03317000
*                                                                  1199 03318000
         L     @06,DSBCATPT(,@04)                                  1199 03319000
         OI    AMDRRDS(@06),B'00000010'                            1199 03320000
*                          ELSE;                           /*@Y30SSJH*/ 03321000
*                                                                  1200 03322000
@RF01198 DS    0H                                                  1201 03323000
*                      ELSE;                               /*@Y30SSJH*/ 03324000
*                                                                  1201 03325000
*                                                                  1201 03326000
@RF01197 DS    0H                                                  1202 03327000
*            /********************************************************/ 03328000
*            /*                                              @Y30SSJH*/ 03329000
*            /* SET NONUNIQUEKEY DEFAULT.  IF EXPLICITLY SPECIFIED OR*/ 03330000
*            /* MODELLED, DEFAULT WILL BE OVERRIDDEN         @Y30SSJH*/ 03331000
*            /*                                              @Y30SSJH*/ 03332000
*            /********************************************************/ 03333000
*                                                                  1202 03334000
*            IF (ADDR(AIX)) ^= NULLPTR &                           1202 03335000
*              CTGFVTYP = 'D'                                      1202 03336000
*              THEN                                                1202 03337000
@RC01195 DS    0H                                                  1202 03338000
@RC01181 L     @06,@PC00001+4                                      1202 03339000
         L     @06,FDTPTR+52(,@06)                                 1202 03340000
         LTR   @06,@06                                             1202 03341000
         BZ    @RF01202                                            1202 03342000
         L     @06,@PC00001+8                                      1202 03343000
         L     @04,CTGFVPTR(,@06)                                  1202 03344000
         CLI   CTGFVTYP(@04),C'D'                                  1202 03345000
         BNE   @RF01202                                            1202 03346000
*                AMDUNQ = ON;                              /*@Y30SSJH*/ 03347000
*                                                                  1203 03348000
         L     @06,DSBCATPT(,@06)                                  1203 03349000
         OI    AMDUNQ(@06),B'10000000'                             1203 03350000
*            END;                                                  1204 03351000
*                                                                  1204 03352000
*          /**********************************************************/ 03353000
*          /*                                                        */ 03354000
*          /* SECOND PASS - RESET PTRS TO AMDSBFPL AND IDAAMDSB      */ 03355000
*          /*                                                        */ 03356000
*          /**********************************************************/ 03357000
*                                                                  1205 03358000
*          ELSE                                                    1205 03359000
*            DO;                                                   1205 03360000
*                                                                  1205 03361000
         B     @RC01161                                            1205 03362000
@RF01161 DS    0H                                                  1206 03363000
*            CTGFLPTR = ADDR(KFPLAREA);                            1206 03364000
         L     CTGFLPTR,KEYFPLPT                                   1206 03365000
*            DSBCATPT = CTGFLPT(1);                                1207 03366000
*                                                                  1207 03367000
         L     @06,@PC00001+8                                      1207 03368000
         L     @04,CTGFLPT(,CTGFLPTR)                              1207 03369000
         ST    @04,DSBCATPT(,@06)                                  1207 03370000
*            END;                                                  1208 03371000
*                                                                  1208 03372000
*        /************************************************************/ 03373000
*        /*                                                  @Y30SSJH*/ 03374000
*        /* SET THE SPANNED ATTRIBUTE IN THE AMDSB -         @Y30SSJH*/ 03375000
*        /* AN ALTERNATE INDEX IS ALWAYS SPANNED             @Y30SSJH*/ 03376000
*        /*                                                  @Y30SSJH*/ 03377000
*        /************************************************************/ 03378000
*                                                                  1209 03379000
*        IF (ADDR(AIX)) ^= NULLPTR &                               1209 03380000
*           CTGFVTYP = 'D'                                         1209 03381000
*          THEN                                                    1209 03382000
@RC01161 L     @06,@PC00001+4                                      1209 03383000
         L     @06,FDTPTR+52(,@06)                                 1209 03384000
         LTR   @06,@06                                             1209 03385000
         BZ    @RF01209                                            1209 03386000
         L     @06,@PC00001+8                                      1209 03387000
         L     @04,CTGFVPTR(,@06)                                  1209 03388000
         CLI   CTGFVTYP(@04),C'D'                                  1209 03389000
         BNE   @RF01209                                            1209 03390000
*            AMDSPAN = ON;                                 /*@Y30SSJH*/ 03391000
*                                                                  1210 03392000
         L     @06,DSBCATPT(,@06)                                  1210 03393000
         OI    AMDSPAN(@06),B'00000001'                            1210 03394000
*          ELSE                                                    1211 03395000
*                                                                  1211 03396000
*            IF (ADDR(KSPND)) ^= NULLPTR /* VALUE FROM FDTTBL@Y30SSJH*/ 03397000
*              THEN                                                1211 03398000
         B     @RC01209                                            1211 03399000
@RF01209 L     @06,@PC00004+28                                     1211 03400000
         LTR   @06,@06                                             1211 03401000
         BZ    @RF01211                                            1211 03402000
*                AMDSPAN = ON;                             /*@Y30SSJH*/ 03403000
*                                                                  1212 03404000
         L     @06,@PC00001+8                                      1212 03405000
         L     @06,DSBCATPT(,@06)                                  1212 03406000
         OI    AMDSPAN(@06),B'00000001'                            1212 03407000
*              ELSE                                                1213 03408000
*                IF (ADDR(KNSPD)) ^= NULLPTR                       1213 03409000
*                  THEN                                            1213 03410000
         B     @RC01211                                            1213 03411000
@RF01211 L     @06,@PC00004+32                                     1213 03412000
         LTR   @06,@06                                             1213 03413000
         BZ    @RF01213                                            1213 03414000
*                    AMDSPAN = OFF;                        /*@Y30SSJH*/ 03415000
*                                                                  1214 03416000
         L     @06,@PC00001+8                                      1214 03417000
         L     @06,DSBCATPT(,@06)                                  1214 03418000
         NI    AMDSPAN(@06),B'11111110'                            1214 03419000
*                  ELSE                  /* VALUE FROM MODEL @Y30SSJH*/ 03420000
*                    IF MDLAMDSB ^= NULLPTR &                      1215 03421000
*                       (ADDR(MCAT)) = NULLPTR &                   1215 03422000
*                       (ADDR(UCAT)) = NULLPTR &                   1215 03423000
*                       (ADDR(PGSP)) = NULLPTR &                   1215 03424000
*                       CTGFVTYP = 'D'                             1215 03425000
*                      THEN                                        1215 03426000
         B     @RC01213                                            1215 03427000
@RF01213 SLR   @06,@06                                             1215 03428000
         L     @04,@PC00001+8                                      1215 03429000
         L     @01,MDLTBLPT(,@04)                                  1215 03430000
         L     @15,MDLAMDSB(,@01)                                  1215 03431000
         CR    @15,@06                                             1215 03432000
         BE    @RF01215                                            1215 03433000
         L     @14,@PC00001+4                                      1215 03434000
         C     @06,FDTPTR+12(,@14)                                 1215 03435000
         BNE   @RF01215                                            1215 03436000
         C     @06,FDTPTR+16(,@14)                                 1215 03437000
         BNE   @RF01215                                            1215 03438000
         C     @06,FDTPTR+24(,@14)                                 1215 03439000
         BNE   @RF01215                                            1215 03440000
         L     @06,CTGFVPTR(,@04)                                  1215 03441000
         CLI   CTGFVTYP(@06),C'D'                                  1215 03442000
         BNE   @RF01215                                            1215 03443000
*                        IF MDLAMDSB -> AMDSPAN = ON               1216 03444000
*                          THEN                                    1216 03445000
         TM    AMDSPAN(@15),B'00000001'                            1216 03446000
         BNO   @RF01216                                            1216 03447000
*                            AMDSPAN = ON;                 /*@Y30SSJH*/ 03448000
*                                                                  1217 03449000
         L     @06,DSBCATPT(,@04)                                  1217 03450000
         OI    AMDSPAN(@06),B'00000001'                            1217 03451000
*                          ELSE                                    1218 03452000
*                            AMDSPAN = OFF;                /*@Y30SSJH*/ 03453000
*                                                                  1218 03454000
         B     @RC01216                                            1218 03455000
@RF01216 L     @06,@PC00001+8                                      1218 03456000
         L     @06,DSBCATPT(,@06)                                  1218 03457000
         NI    AMDSPAN(@06),B'11111110'                            1218 03458000
*        /************************************************************/ 03459000
*        /*                                                  @Y30SSJH*/ 03460000
*        /* SET THE ALTERNATE INDEX UNIQUE KEY ATTRIBUTE IN  @Y30SSJH*/ 03461000
*        /* THE AMDSB                                        @Y30SSJH*/ 03462000
*        /*                                                  @Y30SSJH*/ 03463000
*        /************************************************************/ 03464000
*                                                                  1219 03465000
*        IF (ADDR(KUNQK)) ^= NULLPTR   /* VALUE FROM FDTTBL  @Y30SSJH*/ 03466000
*          THEN                                                    1219 03467000
@RC01216 DS    0H                                                  1219 03468000
@RF01215 DS    0H                                                  1219 03469000
@RC01213 DS    0H                                                  1219 03470000
@RC01211 DS    0H                                                  1219 03471000
@RC01209 L     @06,@PC00004+36                                     1219 03472000
         LTR   @06,@06                                             1219 03473000
         BZ    @RF01219                                            1219 03474000
*            AMDUNQ = OFF;                                 /*@Y30SSJH*/ 03475000
*                                                                  1220 03476000
         L     @06,@PC00001+8                                      1220 03477000
         L     @06,DSBCATPT(,@06)                                  1220 03478000
         NI    AMDUNQ(@06),B'01111111'                             1220 03479000
*          ELSE                                                    1221 03480000
*            IF (ADDR(KNUQK)) ^= NULLPTR                           1221 03481000
*              THEN                                                1221 03482000
         B     @RC01219                                            1221 03483000
@RF01219 L     @06,@PC00004+40                                     1221 03484000
         LTR   @06,@06                                             1221 03485000
         BZ    @RF01221                                            1221 03486000
*                AMDUNQ = ON;                              /*@Y30SSJH*/ 03487000
*                                                                  1222 03488000
         L     @06,@PC00001+8                                      1222 03489000
         L     @06,DSBCATPT(,@06)                                  1222 03490000
         OI    AMDUNQ(@06),B'10000000'                             1222 03491000
*              ELSE                                                1223 03492000
*                IF MDLAMDSB ^= NULLPTR &                          1223 03493000
*                   (ADDR(AIX)) ^= NULLPTR &                       1223 03494000
*                   CTGFVTYP = 'D'                                 1223 03495000
*                  THEN                                            1223 03496000
         B     @RC01221                                            1223 03497000
@RF01221 SLR   @06,@06                                             1223 03498000
         L     @04,@PC00001+8                                      1223 03499000
         L     @01,MDLTBLPT(,@04)                                  1223 03500000
         L     @15,MDLAMDSB(,@01)                                  1223 03501000
         CR    @15,@06                                             1223 03502000
         BE    @RF01223                                            1223 03503000
         L     @14,@PC00001+4                                      1223 03504000
         C     @06,FDTPTR+52(,@14)                                 1223 03505000
         BE    @RF01223                                            1223 03506000
         L     @06,CTGFVPTR(,@04)                                  1223 03507000
         CLI   CTGFVTYP(@06),C'D'                                  1223 03508000
         BNE   @RF01223                                            1223 03509000
*                    IF MDLAMDSB -> AMDUNQ = ON                    1224 03510000
*                      THEN                                        1224 03511000
         TM    AMDUNQ(@15),B'10000000'                             1224 03512000
         BNO   @RF01224                                            1224 03513000
*                        AMDUNQ = ON;                      /*@Y30SSJH*/ 03514000
*                                                                  1225 03515000
         L     @06,DSBCATPT(,@04)                                  1225 03516000
         OI    AMDUNQ(@06),B'10000000'                             1225 03517000
*                      ELSE                                        1226 03518000
*                        AMDUNQ = OFF;                     /*@Y30SSJH*/ 03519000
*                                                                  1226 03520000
         B     @RC01224                                            1226 03521000
@RF01224 L     @06,@PC00001+8                                      1226 03522000
         L     @06,DSBCATPT(,@06)                                  1226 03523000
         NI    AMDUNQ(@06),B'01111111'                             1226 03524000
*        /************************************************************/ 03525000
*        /*                                                          */ 03526000
*        /* INITIALIZE KEYS AND OPTIONS IN IDAAMDSB -        @Y30SSJH*/ 03527000
*        /* KEY POSITION AND LENGTH IS SET ONLY FOR DATA     @Y30SSJH*/ 03528000
*        /* OBJECT OF THE DATA SET                           @Y30SSJH*/ 03529000
*        /*                                                          */ 03530000
*        /************************************************************/ 03531000
*                                                                  1227 03532000
*        IF (ADDR(KEY)) ^= NULLPTR                                 1227 03533000
*          THEN                                                    1227 03534000
@RC01224 DS    0H                                                  1227 03535000
@RF01223 DS    0H                                                  1227 03536000
@RC01221 DS    0H                                                  1227 03537000
@RC01219 SLR   @06,@06                                             1227 03538000
         L     @04,@PC00004                                        1227 03539000
         CR    @04,@06                                             1227 03540000
         BE    @RF01227                                            1227 03541000
*            DO;                                                   1228 03542000
*                                                                  1228 03543000
*            FDTTBLPT = ADDR(KYLN);                                1229 03544000
         L     FDTTBLPT,@PC00004+8                                 1229 03545000
*            AMDKEYLN = NUMBVAL;                                   1230 03546000
*                                                                  1230 03547000
         L     @15,@PC00001+8                                      1230 03548000
         L     @15,DSBCATPT(,@15)                                  1230 03549000
         L     @14,NUMBVAL(,FDTTBLPT)                              1230 03550000
         STH   @14,AMDKEYLN(,@15)                                  1230 03551000
*            FDTTBLPT = ADDR(KYPS);                        /*@Y30SSJH*/ 03552000
         L     FDTTBLPT,@PC00004+4                                 1231 03553000
*            IF (ADDR(AIX)) ^= NULLPTR                             1232 03554000
*              THEN                                                1232 03555000
         L     @14,@PC00001+4                                      1232 03556000
         C     @06,FDTPTR+52(,@14)                                 1232 03557000
         BE    @RF01232                                            1232 03558000
*                AMDAXRKP = NUMBVAL;                       /*@Y30SSJH*/ 03559000
*                                                                  1233 03560000
         L     @06,NUMBVAL(,FDTTBLPT)                              1233 03561000
         STH   @06,AMDAXRKP(,@15)                                  1233 03562000
*              ELSE                                                1234 03563000
*                AMDRKP = NUMBVAL;                         /*@Y30SSJH*/ 03564000
*                                                                  1234 03565000
         B     @RC01232                                            1234 03566000
@RF01232 L     @06,@PC00001+8                                      1234 03567000
         L     @06,DSBCATPT(,@06)                                  1234 03568000
         L     @15,NUMBVAL(,FDTTBLPT)                              1234 03569000
         STH   @15,AMDRKP(,@06)                                    1234 03570000
*            END;                                                  1235 03571000
*                                                                  1235 03572000
*          ELSE                                                    1236 03573000
*            IF MDLAMDSB ^= NULLPTR   &                            1236 03574000
*              (ADDR(MCAT)) = NULLPTR  &                           1236 03575000
*              (ADDR(UCAT)) = NULLPTR  &                           1236 03576000
*              (ADDR(PGSP)) = NULLPTR  &                           1236 03577000
*               CTGFVTYP    = 'D'                                  1236 03578000
*              THEN                                                1236 03579000
         B     @RC01227                                            1236 03580000
@RF01227 SLR   @06,@06                                             1236 03581000
         L     @04,@PC00001+8                                      1236 03582000
         L     @01,MDLTBLPT(,@04)                                  1236 03583000
         L     @15,MDLAMDSB(,@01)                                  1236 03584000
         CR    @15,@06                                             1236 03585000
         BE    @RF01236                                            1236 03586000
         L     @14,@PC00001+4                                      1236 03587000
         C     @06,FDTPTR+12(,@14)                                 1236 03588000
         BNE   @RF01236                                            1236 03589000
         C     @06,FDTPTR+16(,@14)                                 1236 03590000
         BNE   @RF01236                                            1236 03591000
         C     @06,FDTPTR+24(,@14)                                 1236 03592000
         BNE   @RF01236                                            1236 03593000
         L     @01,CTGFVPTR(,@04)                                  1236 03594000
         CLI   CTGFVTYP(@01),C'D'                                  1236 03595000
         BNE   @RF01236                                            1236 03596000
*                DO;                                               1237 03597000
*                                                                  1237 03598000
*                AMDKEYLN = MDLAMDSB -> AMDKEYLN;                  1238 03599000
*                                                                  1238 03600000
         L     @04,DSBCATPT(,@04)                                  1238 03601000
         LH    @09,AMDKEYLN(,@15)                                  1238 03602000
         STH   @09,AMDKEYLN(,@04)                                  1238 03603000
*                IF (ADDR(AIX)) ^= NULLPTR                         1239 03604000
*                  THEN                                            1239 03605000
         C     @06,FDTPTR+52(,@14)                                 1239 03606000
         BE    @RF01239                                            1239 03607000
*                    AMDAXRKP = MDLAMDSB -> AMDAXRKP;      /*@Y30SSJH*/ 03608000
*                                                                  1240 03609000
         LH    @06,AMDAXRKP(,@15)                                  1240 03610000
         STH   @06,AMDAXRKP(,@04)                                  1240 03611000
*                  ELSE                                            1241 03612000
*                    AMDRKP = MDLAMDSB -> AMDRKP;          /*@Y30SSJH*/ 03613000
*                                                                  1241 03614000
         B     @RC01239                                            1241 03615000
@RF01239 L     @06,@PC00001+8                                      1241 03616000
         L     @04,DSBCATPT(,@06)                                  1241 03617000
         L     @06,MDLTBLPT(,@06)                                  1241 03618000
         L     @06,MDLAMDSB(,@06)                                  1241 03619000
         LH    @06,AMDRKP(,@06)                                    1241 03620000
         STH   @06,AMDRKP(,@04)                                    1241 03621000
*                END;                                              1242 03622000
*                                                                  1242 03623000
@RC01239 DS    0H                                                  1243 03624000
*        /************************************************************/ 03625000
*        /*                                                          */ 03626000
*        /* INITIALIZE THE LOW KEY - HIGH KEY 'PSEUDO' LIST - THE    */ 03627000
*        /* SOURCE OF KEYS FOR THIS LIST COME FROM EITHER THE FDTTBL */ 03628000
*        /* OR THE MODEL OBJECT.                                     */ 03629000
*        /*                                                          */ 03630000
*        /************************************************************/ 03631000
*        IF (ADDR(RANGE)) ^= NULLPTR                               1243 03632000
*          THEN                                                    1243 03633000
@RF01236 DS    0H                                                  1243 03634000
@RC01227 L     @06,@PC00004+12                                     1243 03635000
         LTR   @06,@06                                             1243 03636000
         BZ    @RF01243                                            1243 03637000
*            /********************************************************/ 03638000
*            /*                                                      */ 03639000
*            /* THE RANGE VALUES ARE TAKEN FROM THE FDTTBL AND       */ 03640000
*            /* CONVERTED INTO THE 'PSEUDO' FIELD FORMAT REFERENCED  */ 03641000
*            /* BY THE FVT                                           */ 03642000
*            /*                                                      */ 03643000
*            /********************************************************/ 03644000
*            DO;                                                   1244 03645000
*                                                                  1244 03646000
*            AMDRANGE = ON;                                        1245 03647000
*                                                                  1245 03648000
         L     @06,@PC00001+8                                      1245 03649000
         L     @06,DSBCATPT(,@06)                                  1245 03650000
         OI    AMDRANGE(@06),B'00000100'                           1245 03651000
*            /********************************************************/ 03652000
*            /*                                                      */ 03653000
*            /* COMPUTE THE LENGTH REQUIRED FOR THE KEY RANGE        */ 03654000
*            /* 'PSEUDO' LIST                                        */ 03655000
*            /*                                                      */ 03656000
*            /********************************************************/ 03657000
*                                                                  1246 03658000
*            RANGELEN = 0;                                         1246 03659000
*                                                                  1246 03660000
         SLR   RANGELEN,RANGELEN                                   1246 03661000
*            DO RANGLOOP = 1 TO RANGECNT;                          1247 03662000
*                                                                  1247 03663000
         LA    RANGLOOP,1                                          1247 03664000
         B     @DE01247                                            1247 03665000
@DL01247 DS    0H                                                  1248 03666000
*              RANGELEN = (RANGELEN + 4) +                         1248 03667000
*                         (RNGLOPTR(RANGLOOP) -> RGKEYLN) +        1248 03668000
*                         (RNGHIPTR(RANGLOOP) -> RGKEYLN) ;        1248 03669000
*                                                                  1248 03670000
         LA    @06,4                                               1248 03671000
         ALR   @06,RANGELEN                                        1248 03672000
         LR    @02,RANGLOOP                                        1248 03673000
         SLA   @02,2                                               1248 03674000
         L     @15,@PC00004+20                                     1248 03675000
         AL    @15,@CF03031                                        1248 03676000
         L     @01,RNGLOPTR(@02,@15)                               1248 03677000
         SLR   @00,@00                                             1248 03678000
         IC    @00,RGKEYLN(,@01)                                   1248 03679000
         ALR   @06,@00                                             1248 03680000
         L     @15,@PC00004+24                                     1248 03681000
         AL    @15,@CF03031                                        1248 03682000
         L     @02,RNGHIPTR(@02,@15)                               1248 03683000
         SLR   @15,@15                                             1248 03684000
         IC    @15,RGKEYLN(,@02)                                   1248 03685000
         ALR   @06,@15                                             1248 03686000
         LR    RANGELEN,@06                                        1248 03687000
*            END;                                                  1249 03688000
*                                                                  1249 03689000
         AL    RANGLOOP,@CF00220                                   1249 03690000
@DE01247 L     @06,@PC00004+16                                     1249 03691000
         C     RANGLOOP,RANGECNT(,@06)                             1249 03692000
         BNH   @DL01247                                            1249 03693000
*            CALL IDCSAGP0 (GDTTBL,                                1250 03694000
*                    (RANGELEN + 50), /* LENGTH OF AREA FOR RANGE   */  03695000
*                    RGLSTPT,         /* PTR TO CORE FOR RANGE LIST */  03696000
*                    DEGPID,          /* POOL ID                    */  03697000
*                    SETZERO);        /* SET AREA TO ZERO           */  03698000
*                                                                  1250 03699000
         L     @09,@PC00001                                        1250 03700000
         ST    @09,@AL00001                                        1250 03701000
         LA    @06,50                                              1250 03702000
         ALR   @06,RANGELEN                                        1250 03703000
         ST    @06,@AFTEMPS+8                                      1250 03704000
         LA    @06,@AFTEMPS+8                                      1250 03705000
         ST    @06,@AL00001+4                                      1250 03706000
         LA    @06,RGLSTPT                                         1250 03707000
         ST    @06,@AL00001+8                                      1250 03708000
         LA    @06,DEGPID                                          1250 03709000
         ST    @06,@AL00001+12                                     1250 03710000
         LA    @06,SETZERO                                         1250 03711000
         ST    @06,@AL00001+16                                     1250 03712000
         MVI   @AL00001+16,X'80'                                   1250 03713000
         L     @15,GDTGPL(,@09)                                    1250 03714000
         LA    @01,@AL00001                                        1250 03715000
         BALR  @14,@15                                             1250 03716000
*            RESPECIFY RTNREG RSTD;                                1251 03717000
*            TESTRC = RTNREG;                                      1252 03718000
         LR    TESTRC,RTNREG                                       1252 03719000
*            RESPECIFY RTNREG UNRSTD;                              1253 03720000
*                                                                  1253 03721000
*            IF TESTRC ^= 0                                        1254 03722000
*              THEN                                                1254 03723000
         LTR   TESTRC,TESTRC                                       1254 03724000
         BZ    @RF01254                                            1254 03725000
*                DO;                                               1255 03726000
*                                                                  1255 03727000
*                DEFSTID = NOSTORAG;                               1256 03728000
         L     @06,@PC00001+8                                      1256 03729000
         MVC   DEFSTID(5,@06),@CB02317                             1256 03730000
*                RETURN;                                           1257 03731000
*                                                                  1257 03732000
         B     @EL00004                                            1257 03733000
*                END;                                              1258 03734000
*                                                                  1258 03735000
*            /********************************************************/ 03736000
*            /*                                                      */ 03737000
*            /* BUILD THE PSEUDO LIST -                              */ 03738000
*            /*  THE LIST IS COMPOSED OF HIGH/LOW KEY RANGE PAIRS.   */ 03739000
*            /*  EACH KEY IS PREFIXED BY A TWO BYTE LENGTH FIELD.    */ 03740000
*            /*  THE LENGTH OF THE ENTIRE LIST RESIDES IN THE FIRST  */ 03741000
*            /*  TWO BYTES OF THE LIST                               */ 03742000
*            /*                                                      */ 03743000
*            /********************************************************/ 03744000
*                                                                  1259 03745000
*            RGLISTLN = RANGELEN + 2;                              1259 03746000
@RF01254 L     @06,RGLSTPT                                         1259 03747000
         LA    @04,2                                               1259 03748000
         ALR   @04,RANGELEN                                        1259 03749000
         STCM  @04,3,RGLISTLN(@06)                                 1259 03750000
*            CTGFVRNG = ADDR(RANGLIST);                            1260 03751000
         L     @04,@PC00001+8                                      1260 03752000
         L     @04,CTGFVPTR(,@04)                                  1260 03753000
         ST    @06,CTGFVRNG(,@04)                                  1260 03754000
*            RGLSTPT  = ADDR(RANGARRY);                            1261 03755000
         LA    @06,RANGARRY(,@06)                                  1261 03756000
         ST    @06,RGLSTPT                                         1261 03757000
*            CKRANGE = GO;                                         1262 03758000
*                                                                  1262 03759000
         MVI   CKRANGE,X'00'                                       1262 03760000
*            DO RANGLOOP = 1 TO RANGECNT;                          1263 03761000
*                                                                  1263 03762000
         LA    RANGLOOP,1                                          1263 03763000
         B     @DE01263                                            1263 03764000
@DL01263 DS    0H                                                  1264 03765000
*              RGFDTPTR = RNGLOPTR(RANGLOOP);                      1264 03766000
*                                                                  1264 03767000
         LR    @06,RANGLOOP                                        1264 03768000
         SLA   @06,2                                               1264 03769000
         L     @15,@PC00004+20                                     1264 03770000
         AL    @15,@CF03031                                        1264 03771000
         L     RGFDTPTR,RNGLOPTR(@06,@15)                          1264 03772000
*              /******************************************************/ 03773000
*              /*                                                    */ 03774000
*              /* INTERNAL LOOP -                                    */ 03775000
*              /*  FIRST ITERATION FOR LOW KEY LENGTH AND VALUE      */ 03776000
*              /*  SECOND ITERATION FOR HIGH KEY LENGTH AND VALUE    */ 03777000
*              /*                                                    */ 03778000
*              /******************************************************/ 03779000
*                                                                  1265 03780000
*              DO N = 1 TO 2;                                      1265 03781000
*                                                                  1265 03782000
         LA    N,1                                                 1265 03783000
@DL01265 DS    0H                                                  1266 03784000
*                LOHIKYLN = RGKEYLN;                               1266 03785000
         L     @06,RGLSTPT                                         1266 03786000
         SLR   @15,@15                                             1266 03787000
         IC    @15,RGKEYLN(,RGFDTPTR)                              1266 03788000
         STH   @15,LOHIKYLN(,@06)                                  1266 03789000
*                LOHIKEY(1 : RGKEYLN)  = RGKEY(1 : RGKEYLN);       1267 03790000
         LR    @14,@15                                             1267 03791000
         BCTR  @14,0                                               1267 03792000
         EX    @14,@SM03038                                        1267 03793000
*                RGLSTPT  = RGLSTPT  + RGKEYLN + 2;                1268 03794000
         ALR   @06,@15                                             1268 03795000
         AL    @06,@CF00154                                        1268 03796000
         ST    @06,RGLSTPT                                         1268 03797000
*                RGFDTPTR = RNGHIPTR(RANGLOOP);                    1269 03798000
*                                                                  1269 03799000
         LR    @06,RANGLOOP                                        1269 03800000
         SLA   @06,2                                               1269 03801000
         L     @15,@PC00004+24                                     1269 03802000
         AL    @15,@CF03031                                        1269 03803000
         L     RGFDTPTR,RNGHIPTR(@06,@15)                          1269 03804000
*              END;                                                1270 03805000
*                                                                  1270 03806000
         AL    N,@CF00220                                          1270 03807000
         C     N,@CF00154                                          1270 03808000
         BNH   @DL01265                                            1270 03809000
*            END;                                                  1271 03810000
*                                                                  1271 03811000
         AL    RANGLOOP,@CF00220                                   1271 03812000
@DE01263 L     @06,@PC00004+16                                     1271 03813000
         C     RANGLOOP,RANGECNT(,@06)                             1271 03814000
         BNH   @DL01263                                            1271 03815000
*          END;                                                    1272 03816000
*                                                                  1272 03817000
*            /********************************************************/ 03818000
*            /*                                                      */ 03819000
*            /* BUILD THE RANGE LIST FROM THE MODEL OBJECTS LOWKEY-  */ 03820000
*            /* HIGH KEY FIELDS WHICH HAVE BEEN RETRIEVED BY LOCATE  */ 03821000
*            /*                                                      */ 03822000
*            /********************************************************/ 03823000
*                                                                  1273 03824000
*            ELSE                                                  1273 03825000
*              IF ( MDLLOKEY ^= NULLPTR  &                         1273 03826000
*                   MDLHIKEY ^= NULLPTR  &                         1273 03827000
*                   CTGTYPE ^= CTGTUCAT &                          1273 03828000
*                   CTGFVTYP  = 'D'      )                         1273 03829000
*                THEN                                              1273 03830000
         B     @RC01243                                            1273 03831000
@RF01243 SLR   @06,@06                                             1273 03832000
         L     @04,@PC00001+8                                      1273 03833000
         L     @15,MDLTBLPT(,@04)                                  1273 03834000
         C     @06,MDLLOKEY(,@15)                                  1273 03835000
         BE    @RF01273                                            1273 03836000
         C     @06,MDLHIKEY(,@15)                                  1273 03837000
         BE    @RF01273                                            1273 03838000
         L     @06,CTGPLPTR(,@04)                                  1273 03839000
         CLI   CTGTYPE(@06),C'U'                                   1273 03840000
         BE    @RF01273                                            1273 03841000
         L     @06,CTGFVPTR(,@04)                                  1273 03842000
         CLI   CTGFVTYP(@06),C'D'                                  1273 03843000
         BNE   @RF01273                                            1273 03844000
*RGFPLLP:          DO;                                             1274 03845000
*                                                                  1274 03846000
RGFPLLP  DS    0H                                                  1275 03847000
*                  /**************************************************/ 03848000
*                  /*                                                */ 03849000
*                  /* GET STORAGE FOR RANGE LIST BASED ON MODEL      */ 03850000
*                  /* LENGTH REQUIREMENT                             */ 03851000
*                  /*                                                */ 03852000
*                  /**************************************************/ 03853000
*                                                                  1275 03854000
*                  CALL IDCSAGP0 (GDTTBL,                          1275 03855000
*                          (MDLLKLEN + MDLHKLEN + 50), /* POOL LENGTH*/ 03856000
*                          RGLSTPT,                    /* POOL ADDR  */ 03857000
*                          DEGPID,                     /* POOL ID    */ 03858000
*                          SETZERO);                   /* SET TO ZERO*/ 03859000
*                                                                  1275 03860000
         L     @09,@PC00001                                        1275 03861000
         ST    @09,@AL00001                                        1275 03862000
         L     @06,@PC00001+8                                      1275 03863000
         L     @06,MDLTBLPT(,@06)                                  1275 03864000
         L     @04,MDLLKLEN(,@06)                                  1275 03865000
         AL    @04,MDLHKLEN(,@06)                                  1275 03866000
         AL    @04,@CF01033                                        1275 03867000
         ST    @04,@AFTEMPS+8                                      1275 03868000
         LA    @06,@AFTEMPS+8                                      1275 03869000
         ST    @06,@AL00001+4                                      1275 03870000
         LA    @06,RGLSTPT                                         1275 03871000
         ST    @06,@AL00001+8                                      1275 03872000
         LA    @06,DEGPID                                          1275 03873000
         ST    @06,@AL00001+12                                     1275 03874000
         LA    @06,SETZERO                                         1275 03875000
         ST    @06,@AL00001+16                                     1275 03876000
         MVI   @AL00001+16,X'80'                                   1275 03877000
         L     @15,GDTGPL(,@09)                                    1275 03878000
         LA    @01,@AL00001                                        1275 03879000
         BALR  @14,@15                                             1275 03880000
*                  RESPECIFY RTNREG RSTD;                          1276 03881000
*                  TESTRC = RTNREG;                                1277 03882000
         LR    TESTRC,RTNREG                                       1277 03883000
*                  RESPECIFY RTNREG UNRSTD;                        1278 03884000
*                                                                  1278 03885000
*                  IF TESTRC ^= 0                                  1279 03886000
*                    THEN                                          1279 03887000
         LTR   TESTRC,TESTRC                                       1279 03888000
         BZ    @RF01279                                            1279 03889000
*                      DO;                                         1280 03890000
*                                                                  1280 03891000
*                      DEFSTID = NOSTORAG;                         1281 03892000
         L     @06,@PC00001+8                                      1281 03893000
         MVC   DEFSTID(5,@06),@CB02317                             1281 03894000
*                      RETURN;                                     1282 03895000
*                                                                  1282 03896000
         B     @EL00004                                            1282 03897000
*                      END;                                        1283 03898000
*                                                                  1283 03899000
*                  /**************************************************/ 03900000
*                  /*                                                */ 03901000
*                  /* INITIALIZE POINTERS, CONTROL FLAGS AND INITIAL */ 03902000
*                  /* VALUES FOR RNGFDTLP                            */ 03903000
*                  /*                                                */ 03904000
*                  /**************************************************/ 03905000
*                                                                  1284 03906000
*                  RANGFLAG = GO;                                  1284 03907000
@RF01279 MVI   RANGFLAG,X'00'                                      1284 03908000
*                  CKRANGE = GO;                                   1285 03909000
         MVI   CKRANGE,X'00'                                       1285 03910000
*                  CTGFVRNG = ADDR(RANGLIST);                      1286 03911000
         L     @09,RGLSTPT                                         1286 03912000
         L     @06,@PC00001+8                                      1286 03913000
         L     @04,CTGFVPTR(,@06)                                  1286 03914000
         ST    @09,CTGFVRNG(,@04)                                  1286 03915000
*                  AMDRANGE = ON;                                  1287 03916000
         L     @04,DSBCATPT(,@06)                                  1287 03917000
         OI    AMDRANGE(@04),B'00000100'                           1287 03918000
*                  RGLISTLN = MDLLKLEN + MDLHKLEN +2;              1288 03919000
         L     @06,MDLTBLPT(,@06)                                  1288 03920000
         L     @04,MDLLKLEN(,@06)                                  1288 03921000
         AL    @04,MDLHKLEN(,@06)                                  1288 03922000
         AL    @04,@CF00154                                        1288 03923000
         STCM  @04,3,RGLISTLN(@09)                                 1288 03924000
*                  MAXRGADR = RGLISTLN + (ADDR(RANGLIST));         1289 03925000
         ALR   @04,@09                                             1289 03926000
         LR    MAXRGADR,@04                                        1289 03927000
*                  RGLSTPT  = ADDR(RANGARRY);                      1290 03928000
         LA    @09,RANGARRY(,@09)                                  1290 03929000
         ST    @09,RGLSTPT                                         1290 03930000
*                  RNGFPLLO = MDLLOKEY;                            1291 03931000
         L     RNGFPLLO,MDLLOKEY(,@06)                             1291 03932000
*                  RNGFPLHI = MDLHIKEY;                            1292 03933000
         L     RNGFPLHI,MDLHIKEY(,@06)                             1292 03934000
*                  /**************************************************/ 03935000
*                  /*                                                */ 03936000
*                  /* BUILD THE LOW/HIGH KEY PSEUDO FIELD BY MERGING */ 03937000
*                  /* THE LOW AND HIGH KEYS FROM THE MODEL OBJECT'S  */ 03938000
*                  /* 'LOKEYV' - 'HIKEYV' FIELDS INTO THE PSEUDO     */ 03939000
*                  /* RANGE FIELD REFERENCED BY THE FVT - EACH       */ 03940000
*                  /* ITERATION OF THE LOOP RESULTS IN ON LOW/HIGH   */ 03941000
*                  /* PAIR BEING INITIALIZED                         */ 03942000
*                  /*                                                */ 03943000
*                  /**************************************************/ 03944000
*                                                                  1293 03945000
*MERGEFPL:         DO RANGLOOP = 1 TO 255                          1293 03946000
*                     WHILE RANGFLAG = GO;                         1293 03947000
*                                                                  1293 03948000
MERGEFPL LA    RANGLOOP,1                                          1293 03949000
@DL01293 CLI   RANGFLAG,X'00'                                      1293 03950000
         BNE   @DC01293                                            1293 03951000
*                    /************************************************/ 03952000
*                    /*                                              */ 03953000
*                    /* INSURE ADDITION TO PSEUDO FIELD DOES NOT     */ 03954000
*                    /* OVERRUN THE AREA ALLOTTED                    */ 03955000
*                    /*                                              */ 03956000
*                    /************************************************/ 03957000
*                                                                  1294 03958000
*                    IF (RGLSTPT + FPLLKYLN + 2) < MAXRGADR        1294 03959000
*                      THEN                                        1294 03960000
*                                                                  1294 03961000
         L     @09,RGLSTPT                                         1294 03962000
         LH    @06,FPLLKYLN(,RNGFPLLO)                             1294 03963000
         LR    @15,@09                                             1294 03964000
         ALR   @15,@06                                             1294 03965000
         AL    @15,@CF00154                                        1294 03966000
         CR    @15,MAXRGADR                                        1294 03967000
         BNL   @RF01294                                            1294 03968000
*                        /********************************************/ 03969000
*                        /*                                          */ 03970000
*                        /* THE LENGTH IS WITHIN AREA - INITIALIZE   */ 03971000
*                        /* THE LOWKEY LENGTH AND VALUE              */ 03972000
*                        /*                                          */ 03973000
*                        /********************************************/ 03974000
*                        DO;                                       1295 03975000
*                                                                  1295 03976000
*                        LOHIKYLN = FPLLKYLN;                      1296 03977000
         STH   @06,LOHIKYLN(,@09)                                  1296 03978000
*                        LOHIKEY(1:FPLLKYLN) = FPLLOKEY(1: FPLLKYLN);   03979000
*                                                                  1297 03980000
         BCTR  @06,0                                               1297 03981000
         EX    @06,@SM03040                                        1297 03982000
*                        END;                                      1298 03983000
*                                                                  1298 03984000
*                      /**********************************************/ 03985000
*                      /*                                            */ 03986000
*                      /* WE HAVE OVERRUN THE ALLOTTED AREA - SINCE  */ 03987000
*                      /* THE AREA WAS COMPUTED THIS IS A TERMINAL   */ 03988000
*                      /* ERROR - RETURN WITH STATUS                 */ 03989000
*                      /*                                            */ 03990000
*                      /**********************************************/ 03991000
*                      ELSE                                        1299 03992000
*                        DO;                                       1299 03993000
*                                                                  1299 03994000
         B     @RC01294                                            1299 03995000
@RF01294 DS    0H                                                  1300 03996000
*                        DEFSTID = RANGERR;                        1300 03997000
         L     @06,@PC00001+8                                      1300 03998000
         MVC   DEFSTID(5,@06),@CB02323                             1300 03999000
*                        RETURN;                                   1301 04000000
*                                                                  1301 04001000
         B     @EL00004                                            1301 04002000
*                        END;                                      1302 04003000
*                                                                  1302 04004000
*                    /************************************************/ 04005000
*                    /*                                              */ 04006000
*                    /* BUMP POINTER WHICH CONTROLS INSERTS INTO THE */ 04007000
*                    /* RANGELIST (RGLSTPT) - AND BUMP THE POINTER   */ 04008000
*                    /* TO THE NEXT LOW KEY VALUE                    */ 04009000
*                    /*                                              */ 04010000
*                    /************************************************/ 04011000
*                                                                  1303 04012000
*                    RGLSTPT = RGLSTPT + FPLLKYLN + 2;             1303 04013000
@RC01294 LA    @09,2                                               1303 04014000
         LH    @06,FPLLKYLN(,RNGFPLLO)                             1303 04015000
         L     @15,RGLSTPT                                         1303 04016000
         ALR   @15,@06                                             1303 04017000
         ALR   @15,@09                                             1303 04018000
         ST    @15,RGLSTPT                                         1303 04019000
*                    RNGFPLLO = RNGFPLLO + FPLLKYLN + 2;           1304 04020000
*                                                                  1304 04021000
         ALR   @06,RNGFPLLO                                        1304 04022000
         ALR   @06,@09                                             1304 04023000
         LR    RNGFPLLO,@06                                        1304 04024000
*                    /************************************************/ 04025000
*                    /*                                              */ 04026000
*                    /* INSURE THAT ADDITION OF HIGH KEY TO THE LIST */ 04027000
*                    /* DOES NOT OVERRUN THE AREA ALLOTTED           */ 04028000
*                    /*                                              */ 04029000
*                    /************************************************/ 04030000
*                                                                  1305 04031000
*                    IF (RGLSTPT + FPLHKYLN + 2) =< MAXRGADR       1305 04032000
*                      THEN                                        1305 04033000
*                                                                  1305 04034000
         LH    @06,FPLHKYLN(,RNGFPLHI)                             1305 04035000
         LR    @14,@15                                             1305 04036000
         ALR   @14,@06                                             1305 04037000
         ALR   @14,@09                                             1305 04038000
         CR    @14,MAXRGADR                                        1305 04039000
         BH    @RF01305                                            1305 04040000
*                        /********************************************/ 04041000
*                        /*                                          */ 04042000
*                        /* THE LENGTH IS PROPER INITIALIZE HIGH KEY */ 04043000
*                        /*                                          */ 04044000
*                        /********************************************/ 04045000
*                        DO;                                       1306 04046000
*                                                                  1306 04047000
*                        LOHIKYLN = FPLHKYLN;                      1307 04048000
         STH   @06,LOHIKYLN(,@15)                                  1307 04049000
*                        LOHIKEY(1:FPLHKYLN) = FPLHIKEY(1: FPLHKYLN);   04050000
*                                                                  1308 04051000
         BCTR  @06,0                                               1308 04052000
         EX    @06,@SM03042                                        1308 04053000
*                        END;                                      1309 04054000
*                                                                  1309 04055000
*                      /**********************************************/ 04056000
*                      /*                                            */ 04057000
*                      /* WE HAVE OVERRUN THE ALLOTTED AREA - SINCE  */ 04058000
*                      /* THE AREA WAS COMPUTED THIS IS A TERMINAL   */ 04059000
*                      /* ERROR - RETURN WITH STATUS INDICATED       */ 04060000
*                      /*                                            */ 04061000
*                      /**********************************************/ 04062000
*                      ELSE                                        1310 04063000
*                        DO;                                       1310 04064000
*                                                                  1310 04065000
         B     @RC01305                                            1310 04066000
@RF01305 DS    0H                                                  1311 04067000
*                        DEFSTID = RANGERR;                        1311 04068000
         L     @06,@PC00001+8                                      1311 04069000
         MVC   DEFSTID(5,@06),@CB02323                             1311 04070000
*                        RETURN;                                   1312 04071000
*                                                                  1312 04072000
         B     @EL00004                                            1312 04073000
*                        END;                                      1313 04074000
*                                                                  1313 04075000
*                    RGLSTPT = RGLSTPT + FPLHKYLN + 2;             1314 04076000
@RC01305 LA    @09,2                                               1314 04077000
         LH    @06,FPLHKYLN(,RNGFPLHI)                             1314 04078000
         L     @15,RGLSTPT                                         1314 04079000
         ALR   @15,@06                                             1314 04080000
         ALR   @15,@09                                             1314 04081000
         ST    @15,RGLSTPT                                         1314 04082000
*                    RNGFPLHI = RNGFPLHI + FPLHKYLN + 2;           1315 04083000
*                                                                  1315 04084000
         ALR   @06,RNGFPLHI                                        1315 04085000
         ALR   @06,@09                                             1315 04086000
         LR    RNGFPLHI,@06                                        1315 04087000
*                    /************************************************/ 04088000
*                    /*                                              */ 04089000
*                    /* HAVE WE EXHAUSTED THE KEYS FROM THE MODEL -  */ 04090000
*                    /* SET RNAGFLAG TO TERMINATE LOOP               */ 04091000
*                    /*                                              */ 04092000
*                    /************************************************/ 04093000
*                    IF RNGFPLHI => (MDLHIKEY + MDLHKLEN)  |       1316 04094000
*                       RNGFPLLO => (MDLLOKEY + MDLLKLEN)          1316 04095000
*                      THEN                                        1316 04096000
         L     @09,@PC00001+8                                      1316 04097000
         L     @09,MDLTBLPT(,@09)                                  1316 04098000
         L     @06,MDLHIKEY(,@09)                                  1316 04099000
         AL    @06,MDLHKLEN(,@09)                                  1316 04100000
         CR    RNGFPLHI,@06                                        1316 04101000
         BNL   @RT01316                                            1316 04102000
         L     @06,MDLLOKEY(,@09)                                  1316 04103000
         AL    @06,MDLLKLEN(,@09)                                  1316 04104000
         CR    RNGFPLLO,@06                                        1316 04105000
         BL    @RF01316                                            1316 04106000
@RT01316 DS    0H                                                  1317 04107000
*                        RANGFLAG = STOP;                          1317 04108000
*                                                                  1317 04109000
         MVI   RANGFLAG,X'0F'                                      1317 04110000
*                  END MERGEFPL;                                   1318 04111000
*                                                                  1318 04112000
@RF01316 AL    RANGLOOP,@CF00220                                   1318 04113000
         C     RANGLOOP,@CF00872                                   1318 04114000
         BNH   @DL01293                                            1318 04115000
@DC01293 DS    0H                                                  1319 04116000
*                END RGFPLLP;                                      1319 04117000
*        /************************************************************/ 04118000
*        /*                                                          */ 04119000
*        /* VERIFY THAT THERE IS NO OVERLAPPING OF KEY RANGE PAIRS - */ 04120000
*        /* . BEGINNING WITH THE FIRST PAIR IN THE LIST, EACH PAIR   */ 04121000
*        /*   IS CHECKED AGAINST THOSE PAIRS LOWER ON THE LIST.      */ 04122000
*        /* . THE PAIR WHICH IS COMPARED TO THE REMAINING PAIRS IS   */ 04123000
*        /*   REFERENCED AS THE CHECK PAIR                           */ 04124000
*        /* . THE CURRENT PAIR OF THE REMAINING PAIR IS REFERENCED   */ 04125000
*        /*   AS THE COMPARE PAIR                                    */ 04126000
*        /*                                                          */ 04127000
*        /************************************************************/ 04128000
*                                                                  1320 04129000
*        IF CTGFVRNG ^= NULLPTR  &                                 1320 04130000
*           CKRANGE   = GO                                         1320 04131000
*          THEN                                                    1320 04132000
@RF01273 DS    0H                                                  1320 04133000
@RC01243 L     @06,@PC00001+8                                      1320 04134000
         L     @06,CTGFVPTR(,@06)                                  1320 04135000
         L     @06,CTGFVRNG(,@06)                                  1320 04136000
         LTR   @06,@06                                             1320 04137000
         BZ    @RF01320                                            1320 04138000
         CLI   CKRANGE,X'00'                                       1320 04139000
         BNE   @RF01320                                            1320 04140000
*CKRANGE0:   DO;                                                   1321 04141000
*                                                                  1321 04142000
CKRANGE0 DS    0H                                                  1322 04143000
*            RGLSTPT = CTGFVRNG;                                   1322 04144000
         L     @09,@PC00001+8                                      1322 04145000
         L     @09,CTGFVPTR(,@09)                                  1322 04146000
         L     @09,CTGFVRNG(,@09)                                  1322 04147000
         ST    @09,RGLSTPT                                         1322 04148000
*            LKYCKPTR = ADDR(RANGARRY);                            1323 04149000
         LA    @06,RANGARRY(,@09)                                  1323 04150000
         LR    LKYCKPTR,@06                                        1323 04151000
*            HKYCKPTR = LKYCKPTR + LKYLEN +2;                      1324 04152000
*                                                                  1324 04153000
         LR    HKYCKPTR,LKYCKPTR                                   1324 04154000
         AH    HKYCKPTR,LKYLEN(,LKYCKPTR)                          1324 04155000
         AL    HKYCKPTR,@CF00154                                   1324 04156000
*            /********************************************************/ 04157000
*            /*                                                      */ 04158000
*            /* SET POINTER TO INDICATE THE END OF THE RANGE LIST    */ 04159000
*            /*                                                      */ 04160000
*            /********************************************************/ 04161000
*                                                                  1325 04162000
*            MAXRGADR = ADDR(RANGARRY) + RGLISTLN;                 1325 04163000
*                                                                  1325 04164000
         ICM   MAXRGADR,12,RGLISTLN(@09)                           1325 04165000
         SRA   MAXRGADR,16                                         1325 04166000
         ALR   @06,MAXRGADR                                        1325 04167000
         LR    MAXRGADR,@06                                        1325 04168000
*              /******************************************************/ 04169000
*              /*                                                    */ 04170000
*              /* VERIFY THAT THE LOW KEY OF THE CHECK PAIR IS NOT   */ 04171000
*              /* GREATER THAN THE HIGH KEY - THE LOW AND HIGH KEY   */ 04172000
*              /* ARE MOVED INTO FIXED AREAS (LKYCHECK AND HKYCHECK) */ 04173000
*              /* THE LOW KEY IS PADDED WITH BINARY ZEROES THE HIGH  */ 04174000
*              /* KEY WITH BINARY ONES                               */ 04175000
*              /*                                                    */ 04176000
*              /******************************************************/ 04177000
*                                                                  1326 04178000
*CKRANGE1:     DO WHILE HKYCKPTR < MAXRGADR;                       1326 04179000
*                                                                  1326 04180000
CKRANGE1 B     @DE01326                                            1326 04181000
@DL01326 DS    0H                                                  1327 04182000
*                LKYCHECK = ''B;                                   1327 04183000
         XC    LKYCHECK(64),LKYCHECK                               1327 04184000
*                LKYCHECK(1 : LKYLEN) = LOKEY(1 : LKYLEN);         1328 04185000
         LH    @09,LKYLEN(,LKYCKPTR)                               1328 04186000
         BCTR  @09,0                                               1328 04187000
         EX    @09,@SM03044                                        1328 04188000
*                KYMSKPTR = ADDR(HKYCHECK);                        1329 04189000
         LA    KYMSKPTR,HKYCHECK                                   1329 04190000
*                HKYCHECK(1) = 'FF'X;                              1330 04191000
         MVI   HKYCHECK,X'FF'                                      1330 04192000
*                HKYCHECK(2:LENGTH(HKYCHECK)) =                    1331 04193000
*                  KEYMASK(1:(LENGTH(HKYCHECK)-1));                1331 04194000
         MVC   HKYCHECK+1(63),KEYMASK(KYMSKPTR)                    1331 04195000
*                HKYCHECK(1 : HIKYLEN) = HIKEY(1 : HIKYLEN);       1332 04196000
*                                                                  1332 04197000
         LH    @09,HIKYLEN(,HKYCKPTR)                              1332 04198000
         BCTR  @09,0                                               1332 04199000
         EX    @09,@SM03046                                        1332 04200000
*                /****************************************************/ 04201000
*                /*                                                  */ 04202000
*                /* INITIALIZE HKYCMPTR SO THAT BUMPING IN CKRANGE2  */ 04203000
*                /* WILL REFERENCE THE KEY COMPARE PAIR              */ 04204000
*                /*                                                  */ 04205000
*                /****************************************************/ 04206000
*                                                                  1333 04207000
*                HKYCMPTR = HKYCKPTR;                              1333 04208000
*                                                                  1333 04209000
         LR    HKYCMPTR,HKYCKPTR                                   1333 04210000
*                /****************************************************/ 04211000
*                /*                                                  */ 04212000
*                /* VERIFY THAT THE LOW KEY OF THE CHECK RANGE PAIR  */ 04213000
*                /* IS NOT GREATER THAN THE HIGH KEY                 */ 04214000
*                /*                                                  */ 04215000
*                /****************************************************/ 04216000
*                                                                  1334 04217000
*                IF LKYCHECK > HKYCHECK                            1334 04218000
*                  THEN                                            1334 04219000
         CLC   LKYCHECK(64),HKYCHECK                               1334 04220000
         BNH   @RF01334                                            1334 04221000
*                    DO;                                           1335 04222000
*                                                                  1335 04223000
*                    DEFSTID = RNGOLPER;                           1336 04224000
         L     @06,@PC00001+8                                      1336 04225000
         MVC   DEFSTID(5,@06),@CB02329                             1336 04226000
*                    RETURN;                                       1337 04227000
*                                                                  1337 04228000
         B     @EL00004                                            1337 04229000
*                    END;                                          1338 04230000
*                                                                  1338 04231000
*                  /**************************************************/ 04232000
*                  /*                                                */ 04233000
*                  /* THE CHECK PAIR IS VALID - NOW COMPARE THIS PAIR*/ 04234000
*                  /* WITH THOSE PAIRS LOWER ON THE LIST FOR OVERLAP */ 04235000
*                  /*                                                */ 04236000
*                  /**************************************************/ 04237000
*                                                                  1339 04238000
*CKRANGE2:         DO WHILE HKYCMPTR < MAXRGADR;                   1339 04239000
*                                                                  1339 04240000
@RF01334 DS    0H                                                  1339 04241000
CKRANGE2 B     @DE01339                                            1339 04242000
@DL01339 DS    0H                                                  1340 04243000
*                    /************************************************/ 04244000
*                    /*                                              */ 04245000
*                    /* LKYCMPTR AND HKYCMPTR REFERENCE THE COMPARE  */ 04246000
*                    /* KEYS AGAINST WHICH THE CHECKKEYS ARE VERIFIED*/ 04247000
*                    /*                                              */ 04248000
*                    /************************************************/ 04249000
*                                                                  1340 04250000
*                    LKYCMPTR = HKYCMPTR + HKYCMPLN + 2;           1340 04251000
         LA    @09,2                                               1340 04252000
         LR    LKYCMPTR,HKYCMPTR                                   1340 04253000
         AH    LKYCMPTR,HKYCMPLN(,HKYCMPTR)                        1340 04254000
         ALR   LKYCMPTR,@09                                        1340 04255000
*                    HKYCMPTR = LKYCMPTR + LKYCMPLN + 2;           1341 04256000
*                                                                  1341 04257000
         LH    @06,LKYCMPLN(,LKYCMPTR)                             1341 04258000
         LR    HKYCMPTR,LKYCMPTR                                   1341 04259000
         ALR   HKYCMPTR,@06                                        1341 04260000
         ALR   HKYCMPTR,@09                                        1341 04261000
*                    /************************************************/ 04262000
*                    /*                                              */ 04263000
*                    /* INSURE THAT THE COMPARE KEY POINTERS ARE     */ 04264000
*                    /* STILL WITHIN THE RANGE LIST - THEN MOVE THE  */ 04265000
*                    /* COMPARE KEYS INTO THE FIXED AREA AND PERFORM */ 04266000
*                    /* THE OVERLAPPING CHECK                        */ 04267000
*                    /*                                              */ 04268000
*                    /************************************************/ 04269000
*                                                                  1342 04270000
*                    IF HKYCMPTR < MAXRGADR                        1342 04271000
*                      THEN                                        1342 04272000
         CR    HKYCMPTR,MAXRGADR                                   1342 04273000
         BNL   @RF01342                                            1342 04274000
*                        DO;                                       1343 04275000
*                                                                  1343 04276000
*                        LKYCMPR = ''B;                            1344 04277000
         XC    LKYCMPR(64),LKYCMPR                                 1344 04278000
*                        LKYCMPR(1 : LKYCMPLN) = LKYCOMP(1: LKYCMPLN);  04279000
         BCTR  @06,0                                               1345 04280000
         EX    @06,@SM03048                                        1345 04281000
*                        KYMSKPTR = ADDR(HKYCMPR);                 1346 04282000
         LA    KYMSKPTR,HKYCMPR                                    1346 04283000
*                        HKYCMPR(1) = 'FF'X;                       1347 04284000
         MVI   HKYCMPR,X'FF'                                       1347 04285000
*                        HKYCMPR(2:LENGTH(HKYCMPR)) =              1348 04286000
*                          KEYMASK(1:(LENGTH(HKYCMPR) -1));        1348 04287000
         MVC   HKYCMPR+1(63),KEYMASK(KYMSKPTR)                     1348 04288000
*                        HKYCMPR(1 : HKYCMPLN) = HKYCOMP(1:HKYCMPLN);   04289000
*                                                                  1349 04290000
         LH    @09,HKYCMPLN(,HKYCMPTR)                             1349 04291000
         BCTR  @09,0                                               1349 04292000
         EX    @09,@SM03050                                        1349 04293000
*                        /********************************************/ 04294000
*                        /*                                          */ 04295000
*                        /* PERFORM OVERLAP CHECKING                 */ 04296000
*                        /* . THE LOW COMPARE KEY CANNOT BE WITHIN   */ 04297000
*                        /*   THE BOUNDS OF THE CHECK PAIR           */ 04298000
*                        /* . THE HIGH COMPARE KEY CANNON BE WITHIN  */ 04299000
*                        /*   THE BOUNDS OF THE CHECK PAIR           */ 04300000
*                        /* . THE COMPARE KEY BOUNDS CANNOT SPAN THE */ 04301000
*                        /*   CHECK KEY BOUNDS                       */ 04302000
*                        /*                                          */ 04303000
*                        /********************************************/ 04304000
*                                                                  1350 04305000
*                        IF (LKYCMPR >= LKYCHECK  &                1350 04306000
*                            LKYCMPR <= HKYCHECK  )  |             1350 04307000
*                           (HKYCMPR <= HKYCHECK  &                1350 04308000
*                            HKYCMPR >= LKYCHECK  )  |             1350 04309000
*                           (LKYCMPR <= LKYCHECK  &                1350 04310000
*                            HKYCMPR >= HKYCHECK  )                1350 04311000
*                          THEN                                    1350 04312000
         CLC   LKYCMPR(64),LKYCHECK                                1350 04313000
         BL    @GL00062                                            1350 04314000
         CLC   LKYCMPR(64),HKYCHECK                                1350 04315000
         BNH   @RT01350                                            1350 04316000
@GL00062 CLC   HKYCMPR(64),HKYCHECK                                1350 04317000
         BH    @GL00061                                            1350 04318000
         CLC   HKYCMPR(64),LKYCHECK                                1350 04319000
         BNL   @RT01350                                            1350 04320000
@GL00061 CLC   LKYCMPR(64),LKYCHECK                                1350 04321000
         BH    @RF01350                                            1350 04322000
         CLC   HKYCMPR(64),HKYCHECK                                1350 04323000
         BL    @RF01350                                            1350 04324000
@RT01350 DS    0H                                                  1351 04325000
*                            DO;                                   1351 04326000
*                                                                  1351 04327000
*                            DEFSTID = RNGOLPER;                   1352 04328000
         L     @06,@PC00001+8                                      1352 04329000
         MVC   DEFSTID(5,@06),@CB02329                             1352 04330000
*                            RETURN;                               1353 04331000
*                                                                  1353 04332000
         B     @EL00004                                            1353 04333000
*                            END;                                  1354 04334000
*                        END;                                      1355 04335000
*                                                                  1355 04336000
@RF01350 DS    0H                                                  1356 04337000
*                  END CKRANGE2;                                   1356 04338000
@RF01342 DS    0H                                                  1356 04339000
@DE01339 CR    HKYCMPTR,MAXRGADR                                   1356 04340000
         BL    @DL01339                                            1356 04341000
*                /****************************************************/ 04342000
*                /*                                                  */ 04343000
*                /* BUMP THE LOW KEY POINTER TO THE LOW KEY  @OZ06147*/ 04344000
*                /* OF THE NEXT CHECK RANGE PAIR.            @OZ06147*/ 04345000
*                /*                                                  */ 04346000
*                /****************************************************/ 04347000
*                                                                  1357 04348000
*                LKYCKPTR = HKYCKPTR + HIKYLEN + 2;                1357 04349000
*                                                                  1357 04350000
         LA    @09,2                                               1357 04351000
         LR    LKYCKPTR,HKYCKPTR                                   1357 04352000
         AH    LKYCKPTR,HIKYLEN(,HKYCKPTR)                         1357 04353000
         ALR   LKYCKPTR,@09                                        1357 04354000
*                /****************************************************/ 04355000
*                /*                                          @OZ06147*/ 04356000
*                /* TO ENSURE THAT THE KEYRANGE PAIRS ARE IN @OZ06147*/ 04357000
*                /* ASCENDING ORDER, THE HIGH KEY OF THE PREVIOUS    */ 04358000
*                /* PAIR MUST NOT BE GREATER THAN THE LOW KEY        */ 04359000
*                /* OF THE NEW PAIR.                         @OZ06147*/ 04360000
*                /*                                          @OZ06147*/ 04361000
*                /****************************************************/ 04362000
*                                                                  1358 04363000
*                IF LKYCKPTR < (MAXRGADR  - 2)  &                  1358 04364000
*                   HKYCHECK(1 : LKYLEN) > LOKEY(1 : LKYLEN)       1358 04365000
*                  THEN                                    /*@OZ06147*/ 04366000
         LCR   @09,@09                                             1358 04367000
         ALR   @09,MAXRGADR                                        1358 04368000
         CR    LKYCKPTR,@09                                        1358 04369000
         BNL   @RF01358                                            1358 04370000
         LH    @09,LKYLEN(,LKYCKPTR)                               1358 04371000
         BCTR  @09,0                                               1358 04372000
         EX    @09,@SC03052                                        1358 04373000
         BNH   @RF01358                                            1358 04374000
*                    DO;                                   /*@OZ06147*/ 04375000
*                                                                  1359 04376000
*                    DEFSTID = KEYRNGER;                   /*@OZ06147*/ 04377000
         L     @06,@PC00001+8                                      1360 04378000
         MVC   DEFSTID(5,@06),@CB02332                             1360 04379000
*                    RETURN;                               /*@OZ06147*/ 04380000
*                                                                  1361 04381000
         B     @EL00004                                            1361 04382000
*                    END;                                  /*@OZ06147*/ 04383000
*                                                                  1362 04384000
*                /****************************************************/ 04385000
*                /*                                          @OZ06147*/ 04386000
*                /* BUMP THE HIGH KEY POINTER TO THE HIGH KEY        */ 04387000
*                /* OF THE NEXT CHECK RANGE PAIR.            @OZ06147*/ 04388000
*                /*                                          @OZ06147*/ 04389000
*                /****************************************************/ 04390000
*                                                                  1363 04391000
*                HKYCKPTR = LKYCKPTR + LKYLEN + 2;         /*@OZ06147*/ 04392000
*                                                                  1363 04393000
@RF01358 LR    HKYCKPTR,LKYCKPTR                                   1363 04394000
         AH    HKYCKPTR,LKYLEN(,LKYCKPTR)                          1363 04395000
         AL    HKYCKPTR,@CF00154                                   1363 04396000
*              END CKRANGE1;                                       1364 04397000
*                                                                  1364 04398000
@DE01326 CR    HKYCKPTR,MAXRGADR                                   1364 04399000
         BL    @DL01326                                            1364 04400000
*            END CKRANGE0;                                         1365 04401000
*                                                                  1365 04402000
*        /************************************************************/ 04403000
*        /*                                                          */ 04404000
*        /* RETURN TO LEVEL TWO PROCESSOR                            */ 04405000
*        /*                                                          */ 04406000
*        /************************************************************/ 04407000
*                                                                  1366 04408000
*        RETURN;                                                   1366 04409000
*                                                                  1366 04410000
         B     @EL00004                                            1366 04411000
*END KEYPROC;                                                      1367 04412000
         B     @EL00004                                            1367 04413000
*/********************************************************************/ 04414000
*/*                                                                  */ 04415000
*/* PROCEDURE NAME - IXOPPROC (LEVEL THREE PARAMETER PROCESSOR)      */ 04416000
*/*                                                                  */ 04417000
*/* FUNCTION - IXOPPROC INITIALIZES INDEX OPTIONS IN THE AMDSBCAT    */ 04418000
*/*            FIELD. THE AMDSBCAT IS BUILT BY KEYPROC AND           */ 04419000
*/*            REFERENCED BY THE CURRENT FVT.                        */ 04420000
*/*                                                                  */ 04421000
*/*            IXOPPROC RECEIVES ARGUMENTS FROM TWO SOURCES -        */ 04422000
*/*            EXPLICIT ATTRIBUTES FROM THE FDTTBL AND MODEL         */ 04423000
*/*            ATTRIBUTES FROM THE MODEL TABLE(IXMDLTAB)             */ 04424000
*/*                                                                  */ 04425000
*/* INPUT -                                                          */ 04426000
*/*            CTGFV   - THE CURRENT FVT IS ESTABLISHED EXTERNALLY   */ 04427000
*/*              BY THE LEVEL TWO PROCESSOR                          */ 04428000
*/*            SEE DEFINITION OF ARGUMENTS OF INVOCATION(BELOW)      */ 04429000
*/*                                                                  */ 04430000
*/* OUTPUT -                                                         */ 04431000
*/*            INITIALIZATION OF INDEX OPTIONS IN AMDSBCAT           */ 04432000
*/*                                                                  */ 04433000
*/********************************************************************/ 04434000
*                                                                  1368 04435000
*IXOPPROC:                                                         1368 04436000
*        PROCEDURE (REPL,NREP,IMBD,NIBD,IXMDLTAB)                  1368 04437000
*          OPTIONS(SAVEAREA);                              /*@Y30SSJH*/ 04438000
IXOPPROC STM   @14,@12,12(@13)                                     1368 04439000
         ST    @13,@SA00005+4                                      1368 04440000
         LA    @14,@SA00005                                        1368 04441000
         ST    @14,8(,@13)                                         1368 04442000
         LR    @13,@14                                             1368 04443000
         MVC   @PC00005(20),0(@01)                                 1368 04444000
*        GEN (ENTRY IXOPPROC);        /*EXTERNAL ENTRY POINT @Y30SSJH*/ 04445000
         ENTRY IXOPPROC                                                 04446000
*        LM(REG10,REG12,BASESAVE);      /* LOAD PROC CODEREG @Y30SSJH*/ 04447000
         LM    REG10,REG12,BASESAVE                                1370 04448000
*                                                                  1371 04449000
*        /************************************************************/ 04450000
*        /*                                                          */ 04451000
*        /* ARGUMENTS OF INVOCATION                                  */ 04452000
*        /*                                                          */ 04453000
*        /************************************************************/ 04454000
*                                                                  1371 04455000
*        DCL                                                       1371 04456000
*          REPL,                       /* REPLICATE THE INDEX        */ 04457000
*          NREP,                       /* DONT REPLICATE THE INDEX   */ 04458000
*          IMBD,                       /* IMBED INDEX IN SEQ. SET    */ 04459000
*          NIBD,                       /* DONT IMBED THE INDEX       */ 04460000
*          IXMDLTAB;                   /* MODEL TABLE                */ 04461000
*        /************************************************************/ 04462000
*        /*                                                          */ 04463000
*        /* ENTRY POINT TO IXOPPROC - LEVEL 3 INTERNAL PROCEDURE     */ 04464000
*        /*                                                          */ 04465000
*        /************************************************************/ 04466000
*                                                                  1372 04467000
*        OLDERID2 = NEWERID2;                                      1372 04468000
         L     @06,@PC00001                                        1372 04469000
         L     @06,GDTTR2(,@06)                                    1372 04470000
         MVC   @TS00001(95),NEWERID2(@06)                          1372 04471000
         MVC   OLDERID2(95,@06),@TS00001                           1372 04472000
*        NEWID2 = 'DE35';                                          1373 04473000
*                                                                  1373 04474000
         MVC   NEWID2(4,@06),@CC02836                              1373 04475000
*        /************************************************************/ 04476000
*        /*                                                          */ 04477000
*        /* INITIALIZE INDEXOPTIONS FROM MODEL OF AMDSB              */ 04478000
*        /*                                                          */ 04479000
*        /************************************************************/ 04480000
*                                                                  1374 04481000
*        IF MDLAMDSB ^= NULLPTR                                    1374 04482000
*          THEN                                                    1374 04483000
         L     @06,@PC00001+8                                      1374 04484000
         L     @04,MDLTBLPT(,@06)                                  1374 04485000
         L     @04,MDLAMDSB(,@04)                                  1374 04486000
         LTR   @04,@04                                             1374 04487000
         BZ    @RF01374                                            1374 04488000
*            DO;                                                   1375 04489000
*                                                                  1375 04490000
*            IF MDLAMDSB -> AMDREPL = ON                           1376 04491000
*              THEN                                                1376 04492000
         TM    AMDREPL(@04),B'00010000'                            1376 04493000
         BNO   @RF01376                                            1376 04494000
*                AMDREPL = ON;                                     1377 04495000
*                                                                  1377 04496000
         L     @06,DSBCATPT(,@06)                                  1377 04497000
         OI    AMDREPL(@06),B'00010000'                            1377 04498000
*              ELSE                                                1378 04499000
*                AMDREPL = OFF;                                    1378 04500000
*                                                                  1378 04501000
         B     @RC01376                                            1378 04502000
@RF01376 L     @06,@PC00001+8                                      1378 04503000
         L     @06,DSBCATPT(,@06)                                  1378 04504000
         NI    AMDREPL(@06),B'11101111'                            1378 04505000
*            IF MDLAMDSB -> AMDSDT = ON                            1379 04506000
*              THEN                                                1379 04507000
@RC01376 L     @06,@PC00001+8                                      1379 04508000
         L     @04,MDLTBLPT(,@06)                                  1379 04509000
         L     @04,MDLAMDSB(,@04)                                  1379 04510000
         TM    AMDSDT(@04),B'00100000'                             1379 04511000
         BNO   @RF01379                                            1379 04512000
*                AMDSDT = ON;                                      1380 04513000
         L     @06,DSBCATPT(,@06)                                  1380 04514000
         OI    AMDSDT(@06),B'00100000'                             1380 04515000
*              ELSE                                                1381 04516000
*                AMDSDT = OFF;                                     1381 04517000
*                                                                  1381 04518000
         B     @RC01379                                            1381 04519000
@RF01379 L     @06,@PC00001+8                                      1381 04520000
         L     @06,DSBCATPT(,@06)                                  1381 04521000
         NI    AMDSDT(@06),B'11011111'                             1381 04522000
*            END;                                                  1382 04523000
*                                                                  1382 04524000
@RC01379 DS    0H                                                  1383 04525000
*        /************************************************************/ 04526000
*        /*                                                          */ 04527000
*        /* EXPLICIT FDTTBL ATTRIBUTES OVERRIDE MODELED ATTRIBUTES   */ 04528000
*        /*                                                          */ 04529000
*        /************************************************************/ 04530000
*                                                                  1383 04531000
*        IF (ADDR(REPL)) ^= NULLPTR                                1383 04532000
*          THEN                                                    1383 04533000
@RF01374 L     @06,@PC00005                                        1383 04534000
         LTR   @06,@06                                             1383 04535000
         BZ    @RF01383                                            1383 04536000
*            AMDREPL = ON;                                         1384 04537000
*                                                                  1384 04538000
         L     @06,@PC00001+8                                      1384 04539000
         L     @06,DSBCATPT(,@06)                                  1384 04540000
         OI    AMDREPL(@06),B'00010000'                            1384 04541000
*          ELSE                                                    1385 04542000
*            IF (ADDR(NREP)) ^= NULLPTR                            1385 04543000
*              THEN                                                1385 04544000
         B     @RC01383                                            1385 04545000
@RF01383 L     @06,@PC00005+4                                      1385 04546000
         LTR   @06,@06                                             1385 04547000
         BZ    @RF01385                                            1385 04548000
*                AMDREPL = OFF;                                    1386 04549000
*                                                                  1386 04550000
         L     @06,@PC00001+8                                      1386 04551000
         L     @06,DSBCATPT(,@06)                                  1386 04552000
         NI    AMDREPL(@06),B'11101111'                            1386 04553000
*        IF (ADDR(IMBD)) ^= NULLPTR                                1387 04554000
*          THEN                                                    1387 04555000
@RF01385 DS    0H                                                  1387 04556000
@RC01383 L     @06,@PC00005+8                                      1387 04557000
         LTR   @06,@06                                             1387 04558000
         BZ    @RF01387                                            1387 04559000
*            AMDSDT = ON;                                          1388 04560000
*                                                                  1388 04561000
         L     @06,@PC00001+8                                      1388 04562000
         L     @06,DSBCATPT(,@06)                                  1388 04563000
         OI    AMDSDT(@06),B'00100000'                             1388 04564000
*          ELSE                                                    1389 04565000
*            IF (ADDR(NIBD)) ^= NULLPTR                            1389 04566000
*              THEN                                                1389 04567000
         B     @RC01387                                            1389 04568000
@RF01387 L     @06,@PC00005+12                                     1389 04569000
         LTR   @06,@06                                             1389 04570000
         BZ    @RF01389                                            1389 04571000
*                AMDSDT = OFF;                                     1390 04572000
*                                                                  1390 04573000
*                                                                  1390 04574000
*                                                                  1390 04575000
         L     @06,@PC00001+8                                      1390 04576000
         L     @06,DSBCATPT(,@06)                                  1390 04577000
         NI    AMDSDT(@06),B'11011111'                             1390 04578000
*        /************************************************************/ 04579000
*        /*                                                          */ 04580000
*        /* RETURN TO INVOKER                                        */ 04581000
*        /*                                                          */ 04582000
*        /************************************************************/ 04583000
*                                                                  1391 04584000
*        RETURN;                                                   1391 04585000
*                                                                  1391 04586000
@EL00005 L     @13,4(,@13)                                         1391 04587000
@EF00005 DS    0H                                                  1391 04588000
@ER00005 LM    @14,@12,12(@13)                                     1391 04589000
         BR    @14                                                 1391 04590000
*END IXOPPROC;                                                     1392 04591000
         B     @EL00005                                            1392 04592000
*/********************************************************************/ 04593000
*/*                                                                  */ 04594000
*/* PROCEDURE NAME - PROTPROC(LEVEL THREE PARAMETER PROCESSOR)       */ 04595000
*/*                                                                  */ 04596000
*/* FUNCTION - PROTPROC INITIALIZES THE FOLLOWING ITEMS:             */ 04597000
*/*            . PASSWALL FPL - SECURITY COMBINATION FIELD           */ 04598000
*/*            . OWNERID FPL  -                                      */ 04599000
*/*            . DSATTR FLAGS ARE INITIALIZED - THE DSATTR FPL IS    */ 04600000
*/*              BUILT IN ALLCPROC                                   */ 04601000
*/*                SHARE/NOSHARE                                     */ 04602000
*/*                ERASE/NOERASE                                     */ 04603000
*/*                REUSE/NOREUSE                             @Y30SSJH*/ 04604000
*/*            . RGATTR FPL - RG ATTRIBUTES FOR AIX AND PATHS@Y30SSJH*/ 04605000
*/*                                                                  */ 04606000
*/* INPUT -                                                          */ 04607000
*/*            DEFSTID - GLOBAL INTERNAL STATUS COMMUNICATOR         */ 04608000
*/*            CTGFV   - THE CURRENT FVT IS ESTABLISHED EXTERNALLY   */ 04609000
*/*              BY THE LEVEL TWO PROCESSOR                          */ 04610000
*/*                                                                  */ 04611000
*/* OUTPUT -                                                         */ 04612000
*/*            DEFSTID - GLOBAL PROCESSING STATUS, SET ON ERROR      */ 04613000
*/*              DETECTION                                           */ 04614000
*/*                DEFSTID = NOSTORAG                                */ 04615000
*/*            CREATION AND/OR INITIALIZATION OF ABOVE MENTIONED     */ 04616000
*/*              FIELDS                                              */ 04617000
*/*                                                                  */ 04618000
*/********************************************************************/ 04619000
*        PROTPROC:                                                 1393 04620000
*        PROCEDURE(AMASTER,ACINT,AUPDATE,AREAD,AMXATTMP,APWPRMT,   1393 04621000
*          AUSVRNM,AUSERARC,AOWNRID,AERASE,                        1393 04622000
*          ANERS,ASHAR1,ASHAR2,ARUS,ANRUS,AUPG,ANUPG,              1393 04623000
*          PMDLTABL)                                       /*@Y30SSJH*/ 04624000
*              OPTIONS(SAVEAREA);                          /*@Y30SSJH*/ 04625000
*                                                                  1393 04626000
PROTPROC STM   @14,@12,12(@13)                                     1393 04627000
         ST    @13,@SA00006+4                                      1393 04628000
         LA    @14,@SA00006                                        1393 04629000
         ST    @14,8(,@13)                                         1393 04630000
         LR    @13,@14                                             1393 04631000
         MVC   @PC00006(72),0(@01)                                 1393 04632000
*        GEN (ENTRY PROTPROC);    /* EXTERNAL ENTRY POINT    @Y30SSJH*/ 04633000
         ENTRY PROTPROC                                                 04634000
*        LM(REG10,REG12,BASESAVE);      /* LOAD PROC CODEREG @Y30SSJH*/ 04635000
         LM    REG10,REG12,BASESAVE                                1395 04636000
*        /************************************************************/ 04637000
*        /*                                                          */ 04638000
*        /* ARGUMENTS OF INVOCATION                                  */ 04639000
*        /*                                                          */ 04640000
*        /************************************************************/ 04641000
*        DCL                                                       1396 04642000
*          AMASTER,                    /* MASTER PASSWORD            */ 04643000
*          ACINT,                      /* CONTROL INTERVAL PASSWORD  */ 04644000
*          AUPDATE,                    /* UPDATE PASSWORD            */ 04645000
*          AREAD,                      /* READ PASSWORD              */ 04646000
*          AMXATTMP,                   /* PASSWORD ATTEMPTS          */ 04647000
*          APWPRMT,                    /* PASSWORD PROMPTING CODENAME*/ 04648000
*          AUSVRNM,                    /* VERIFICATION MODULE NAME   */ 04649000
*          AUSERARC,                   /* AUTHORIZATION RECORD       */ 04650000
*          AOWNRID,                    /* OWNER IDENTIFICATION       */ 04651000
*          AERASE,                     /* ERASE OPTION               */ 04652000
*          ANERS,                      /* NOERASE OPTION             */ 04653000
*          ASHAR1,                     /* REGION SHARE OPTION        */ 04654000
*          ASHAR2,                     /* SYSTEM SHARE OPTION        */ 04655000
*          ARUS,                       /* REUSE OPTION       @Y30SSJH*/ 04656000
*          ANRUS,                      /* NOREUSE OPTION     @Y30SSJH*/ 04657000
*          AUPG,                       /* UPGRADE,UPDATE     @Y30SSJH*/ 04658000
*          ANUPG,                      /* NOUPGRADE,NOUPDATE @Y30SSJH*/ 04659000
*          PMDLTABL;                   /* MODELTABLE                 */ 04660000
*                                                                  1396 04661000
*        /************************************************************/ 04662000
*        /*                                                          */ 04663000
*        /* CONSTANT VALUES USED IN SETTING SHARE OPTIONS            */ 04664000
*        /*                                                          */ 04665000
*        /************************************************************/ 04666000
*                                                                  1397 04667000
*        DCL SHROPT1 BIT(2) CONSTANT('00'B);                       1397 04668000
*        DCL SHROPT2 BIT(2) CONSTANT('01'B);                       1398 04669000
*        DCL SHROPT3 BIT(2) CONSTANT('10'B);                       1399 04670000
*        DCL SHROPT4 BIT(2) CONSTANT('11'B);                       1400 04671000
*                                                                  1400 04672000
*        /************************************************************/ 04673000
*        /*                                                          */ 04674000
*        /* ARRAY OF PROTECTION FIELD NAMES                          */ 04675000
*        /*                                                          */ 04676000
*        /************************************************************/ 04677000
*        DCL                                                       1401 04678000
*          PROTPTR   PTR(31),                                      1401 04679000
*          PROTFLNM (3) CHAR(8) INIT('PASSWALL','RGATTR',          1401 04680000
*                                    'OWNERID');           /*@Y30SSJH*/ 04681000
*        /************************************************************/ 04682000
*        /*                                                          */ 04683000
*        /* OVERLAY OF DYNAMIC AREA CONTAINING FPLS AND DATA AREA    */ 04684000
*        /* PASSED TO VSAM CATALOG MANAGEMENT                @Z40WSJH*/ 04685000
*        /*                                                          */ 04686000
*        /************************************************************/ 04687000
*                                                                  1402 04688000
*        DCL                                                       1402 04689000
*          1 PROTAREA BASED(PROTPTR),                              1402 04690000
*            2 PASSWFPL CHAR(LENGTH(CTGFL)),                       1402 04691000
*            2 *       CHAR(8),                                    1402 04692000
*            2 RGATRFPL CHAR(LENGTH(CTGFL)),               /*@Y30SSJH*/ 04693000
*            2 *       CHAR(8),                                    1402 04694000
*            2 OWNIDFPL CHAR(LENGTH(CTGFL)),                       1402 04695000
*            2 *       CHAR(8),                                    1402 04696000
*            2 SPRMAREA,                                           1402 04697000
*              3 PWDOVLAY(4) CHAR(8),                              1402 04698000
*              3 PASSPRMT  CHAR(8),                                1402 04699000
*              3 PASSATMP  FIXED(15),                              1402 04700000
*              3 SVRMDUL   CHAR(8),                                1402 04701000
*              3 ARECLEN   FIXED(15),                              1402 04702000
*            2 AUTHREC CHAR(255),                          /*@Y30SSJH*/ 04703000
*            2 RGATTR   BIT(8),                            /*@Y30SSJH*/ 04704000
*              3 UPGUPD BIT(1),                            /*@Y30SSJH*/ 04705000
*              3 *      BIT(7),                            /*@Y30SSJH*/ 04706000
*            2 OWNERUID CHAR(8),                                   1402 04707000
*            2 OWNUIDLN FIXED(15);     /* USERID LENGTH      @Y30SSJH*/ 04708000
*                                                                  1402 04709000
*        /************************************************************/ 04710000
*        /*                                                          */ 04711000
*        /* ARRAY OF FDTTBL PASSWORD INDICATORS                      */ 04712000
*        /*                                                          */ 04713000
*        /************************************************************/ 04714000
*                                                                  1403 04715000
*        DCL                                                       1403 04716000
*          PWDPTRS(4) PTR(31);                                     1403 04717000
*                                                                  1403 04718000
*        /************************************************************/ 04719000
*        /*                                                          */ 04720000
*        /* INDEX INDICATOR WHICH INDICATES THE HIGHEST LEVEL OF     */ 04721000
*        /* OF PASSWORD SPECIFIED. THIS INDICATOR IS SET IN PWINIT   */ 04722000
*        /* AND USED IN PASSWORD MIGRATION                           */ 04723000
*        /*                                                          */ 04724000
*        /************************************************************/ 04725000
*                                                                  1404 04726000
*        DCL                                                       1404 04727000
*          PSWDFLAG FIXED(15);                                     1404 04728000
*                                                                  1404 04729000
*        /************************************************************/ 04730000
*        /*                                                          */ 04731000
*        /* OVERLAY OF DATA SET ATTRIBUTES FLAG                      */ 04732000
*        /*                                                          */ 04733000
*        /************************************************************/ 04734000
*                                                                  1405 04735000
*        DCL                                                       1405 04736000
*          1 PROTATTR CHAR(2) BASED,                               1405 04737000
*            2 *       CHAR(1),                                    1405 04738000
*              3 *      BIT(2),                            /*@Y30SSJH*/ 04739000
*              3 PRUS   BIT(1),                            /*@Y30SSJH*/ 04740000
*              3 PERASE BIT(1),                                    1405 04741000
*            2 *       CHAR(1),                                    1405 04742000
*              3 PSHARE1 BIT(2),                                   1405 04743000
*              3 PSHARE2 BIT(2);                                   1405 04744000
*                                                                  1405 04745000
*        /************************************************************/ 04746000
*        /*                                                          */ 04747000
*        /* INDEX VARIABLES USED IN PASSWORD MIGRATION               */ 04748000
*        /*                                                          */ 04749000
*        /************************************************************/ 04750000
*                                                                  1406 04751000
*        DCL                                                       1406 04752000
*          I FIXED(15),                                            1406 04753000
*          K FIXED(15),                                            1406 04754000
*          J FIXED(15);                                            1406 04755000
*        /************************************************************/ 04756000
*        /*                                                          */ 04757000
*        /* ENTRY POINT TO PROTPROC                                  */ 04758000
*        /*                                                          */ 04759000
*        /************************************************************/ 04760000
*                                                                  1407 04761000
*        OLDERID2 = NEWERID2;                                      1407 04762000
         L     @06,@PC00001                                        1407 04763000
         L     @06,GDTTR2(,@06)                                    1407 04764000
         MVC   @TS00001(95),NEWERID2(@06)                          1407 04765000
         MVC   OLDERID2(95,@06),@TS00001                           1407 04766000
*        NEWID2 = 'DE34';                                          1408 04767000
*                                                                  1408 04768000
         MVC   NEWID2(4,@06),@CC02922                              1408 04769000
*        /************************************************************/ 04770000
*        /*                                                          */ 04771000
*        /* GET DYNAMIC STORAGE FOR FPLS AND DATA PASSED TO CATALOG  */ 04772000
*        /* MANAGEMENT                                               */ 04773000
*        /*                                                          */ 04774000
*        /************************************************************/ 04775000
*        IF PROTFLAG = GO                                          1409 04776000
*         THEN                                                     1409 04777000
         L     @06,@PC00001+8                                      1409 04778000
         CLI   PROTFLAG(@06),X'00'                                 1409 04779000
         BNE   @RF01409                                            1409 04780000
*NEWLOOP:  DO;                                                     1410 04781000
*                                                                  1410 04782000
NEWLOOP  DS    0H                                                  1411 04783000
*          PROTFLAG = STOP;                                        1411 04784000
*                                                                  1411 04785000
         L     @09,@PC00001+8                                      1411 04786000
         MVI   PROTFLAG(@09),X'0F'                                 1411 04787000
*          CALL IDCSAGP0 (GDTTBL,                                  1412 04788000
*                (LENGTH(PROTAREA)),                               1412 04789000
*                PROTPTR,DEGPID,SETZERO);                          1412 04790000
         L     @09,@PC00001                                        1412 04791000
         ST    @09,@AL00001                                        1412 04792000
         LA    @06,390                                             1412 04793000
         ST    @06,@AFTEMPS+12                                     1412 04794000
         LA    @06,@AFTEMPS+12                                     1412 04795000
         ST    @06,@AL00001+4                                      1412 04796000
         LA    @06,PROTPTR                                         1412 04797000
         ST    @06,@AL00001+8                                      1412 04798000
         LA    @06,DEGPID                                          1412 04799000
         ST    @06,@AL00001+12                                     1412 04800000
         LA    @06,SETZERO                                         1412 04801000
         ST    @06,@AL00001+16                                     1412 04802000
         MVI   @AL00001+16,X'80'                                   1412 04803000
         L     @15,GDTGPL(,@09)                                    1412 04804000
         LA    @01,@AL00001                                        1412 04805000
         BALR  @14,@15                                             1412 04806000
*          RESPECIFY RTNREG RSTD;                                  1413 04807000
*          TESTRC = RTNREG;                                        1414 04808000
         LR    TESTRC,RTNREG                                       1414 04809000
*          RESPECIFY RTNREG UNRSTD;                                1415 04810000
*                                                                  1415 04811000
*          IF TESTRC ^= 0                                          1416 04812000
*            THEN                                                  1416 04813000
         LTR   TESTRC,TESTRC                                       1416 04814000
         BZ    @RF01416                                            1416 04815000
*              DO;                                                 1417 04816000
*                                                                  1417 04817000
*              DEFSTID = NOSTORAG;                                 1418 04818000
         L     @06,@PC00001+8                                      1418 04819000
         MVC   DEFSTID(5,@06),@CB02317                             1418 04820000
*              RETURN;                                             1419 04821000
*                                                                  1419 04822000
@EL00006 L     @13,4(,@13)                                         1419 04823000
@EF00006 DS    0H                                                  1419 04824000
@ER00006 LM    @14,@12,12(@13)                                     1419 04825000
         BR    @14                                                 1419 04826000
*              END;                                                1420 04827000
*                                                                  1420 04828000
*          /**********************************************************/ 04829000
*          /*                                                        */ 04830000
*          /* INITIALIZE BASIC PORTIONS OF FPLS                      */ 04831000
*          /*                                                        */ 04832000
*          /**********************************************************/ 04833000
*                                                                  1421 04834000
*          CTGFLPTR = PROTPTR;                                     1421 04835000
*                                                                  1421 04836000
@RF01416 L     CTGFLPTR,PROTPTR                                    1421 04837000
*          DO N = 1 TO 3;                                          1422 04838000
*                                                                  1422 04839000
         LA    N,1                                                 1422 04840000
@DL01422 DS    0H                                                  1423 04841000
*          CTGFLDNO = 1;                                           1423 04842000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1423 04843000
*          CTGFLDNM = ADDR(PROTFLNM(N));                           1424 04844000
         LR    @09,N                                               1424 04845000
         SLA   @09,3                                               1424 04846000
         LA    @09,PROTFLNM-8(@09)                                 1424 04847000
         ST    @09,CTGFLDNM(,CTGFLPTR)                             1424 04848000
*          ARITHX = (LENGTH(CTGFL) + 8);                           1425 04849000
         LA    ARITHX,24                                           1425 04850000
*          CTGFLPTR = CTGFLPTR + ARITHX;                           1426 04851000
*                                                                  1426 04852000
         ALR   CTGFLPTR,ARITHX                                     1426 04853000
*          END;                                                    1427 04854000
         AL    N,@CF00220                                          1427 04855000
         C     N,@CF00163                                          1427 04856000
         BNH   @DL01422                                            1427 04857000
*        /************************************************************/ 04858000
*        /*                                                  @Y30SSJH*/ 04859000
*        /* ISSUE THE UID MACRO TO INITIALIZE THE OWNERID - THE UID  */ 04860000
*        /* MACRO WILL ONLY BE EFFECTIVE IN THE TSO ENVIRONMENT      */ 04861000
*        /*                                                  @Y30SSJH*/ 04862000
*        /************************************************************/ 04863000
*                                                                  1428 04864000
*        OWNERUID = ' ';                                   /*@Z40WSJH*/ 04865000
*                                                                  1428 04866000
         L     @09,PROTPTR                                         1428 04867000
         MVI   OWNERUID+1(@09),C' '                                1428 04868000
         MVC   OWNERUID+2(6,@09),OWNERUID+1(@09)                   1428 04869000
         MVI   OWNERUID(@09),C' '                                  1428 04870000
*        CALL IDCSAID0 (GDTTBL,OWNERUID,OWNUIDLN);         /*@Z40WSJH*/ 04871000
*                                                                  1429 04872000
         L     @06,@PC00001                                        1429 04873000
         ST    @06,@AL00001                                        1429 04874000
         LA    @04,OWNERUID(,@09)                                  1429 04875000
         ST    @04,@AL00001+4                                      1429 04876000
         LA    @09,OWNUIDLN(,@09)                                  1429 04877000
         ST    @09,@AL00001+8                                      1429 04878000
         MVI   @AL00001+8,X'80'                                    1429 04879000
         L     @15,GDTUID(,@06)                                    1429 04880000
         LA    @01,@AL00001                                        1429 04881000
         BALR  @14,@15                                             1429 04882000
*        RESPECIFY RTNREG RSTD;                                    1430 04883000
*        TESTRC = RTNREG;                                          1431 04884000
         LR    TESTRC,RTNREG                                       1431 04885000
*        RESPECIFY RTNREG UNRSTD;                          /*@Z40WSJH*/ 04886000
*        IF TESTRC = 0                                             1433 04887000
*          THEN                                                    1433 04888000
         LTR   TESTRC,TESTRC                                       1433 04889000
         BNZ   @RF01433                                            1433 04890000
*            DO;                                           /*@Z40WSJH*/ 04891000
*                                                                  1434 04892000
*            CTGFLPTR = ADDR(OWNIDFPL);                    /*@Z40WSJH*/ 04893000
         L     @06,PROTPTR                                         1435 04894000
         LA    CTGFLPTR,OWNIDFPL(,@06)                             1435 04895000
*            CTGFVOWN = CTGFLPTR;                          /*@Z40WSJH*/ 04896000
         L     @04,@PC00001+8                                      1436 04897000
         L     @04,CTGFVPTR(,@04)                                  1436 04898000
         ST    CTGFLPTR,CTGFVOWN(,@04)                             1436 04899000
*            CTGFLNG(1) = 8;                               /*@Z40WSJH*/ 04900000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00180                        1437 04901000
*            CTGFLPT(1) = ADDR(OWNERUID);                  /*@Z40WSJH*/ 04902000
*                                                                  1438 04903000
         LA    @06,OWNERUID(,@06)                                  1438 04904000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1438 04905000
*            END;                                          /*@Z40WSJH*/ 04906000
*        /************************************************************/ 04907000
*        /*                                                  @Z40WSJH*/ 04908000
*        /* INIT PASSWORD PORTION OF PASSWALL  COMBINATION FIELD     */ 04909000
*        /*                                                  @Z40WSJH*/ 04910000
*        /************************************************************/ 04911000
*                                                                  1440 04912000
*        DO N = 1 TO LENGTH(SPRMAREA);                     /*@Z40WSJH*/ 04913000
*                                                                  1440 04914000
@RF01433 LA    N,1                                                 1440 04915000
@DL01440 DS    0H                                                  1441 04916000
*        SPRMAREA(N) = 'FF'X;                              /*@Z40WSJH*/ 04917000
*                                                                  1441 04918000
         L     @06,PROTPTR                                         1441 04919000
         ALR   @06,N                                               1441 04920000
         MVI   SPRMAREA-1(@06),X'FF'                               1441 04921000
*        END;                                              /*@Z40WSJH*/ 04922000
*                                                                  1442 04923000
         AL    N,@CF00220                                          1442 04924000
         C     N,@CF01041                                          1442 04925000
         BNH   @DL01440                                            1442 04926000
*        ARECLEN = 0;                                      /*@Z40WSJH*/ 04927000
         L     @06,PROTPTR                                         1443 04928000
         SLR   @04,@04                                             1443 04929000
         STH   @04,ARECLEN(,@06)                                   1443 04930000
*        PASSATMP = 2;                                     /*@Z40WSJH*/ 04931000
*                                                                  1444 04932000
         MVC   PASSATMP(2,@06),@CH00154                            1444 04933000
*        END NEWLOOP;                                      /*@Z40WSJH*/ 04934000
*                                                                  1445 04935000
*                                                                  1445 04936000
*        /************************************************************/ 04937000
*        /*                                                          */ 04938000
*        /* INITIALIZE ARRAY POINTERS TO PASSWORD VALUES IN THE      */ 04939000
*        /* FDTTBL, THIS ALLOWS LOOP INITIALIZATION AND MIGRATION    */ 04940000
*        /*                                                          */ 04941000
*        /************************************************************/ 04942000
*                                                                  1446 04943000
*        PWDPTRS(1) = ADDR(AMASTER);                               1446 04944000
@RF01409 L     @06,@PC00006                                        1446 04945000
         ST    @06,PWDPTRS                                         1446 04946000
*        PWDPTRS(2) = ADDR(ACINT);                                 1447 04947000
         L     @06,@PC00006+4                                      1447 04948000
         ST    @06,PWDPTRS+4                                       1447 04949000
*        PWDPTRS(3) = ADDR(AUPDATE);                               1448 04950000
         L     @06,@PC00006+8                                      1448 04951000
         ST    @06,PWDPTRS+8                                       1448 04952000
*        PWDPTRS(4) = ADDR(AREAD);                                 1449 04953000
*                                                                  1449 04954000
         L     @06,@PC00006+12                                     1449 04955000
         ST    @06,PWDPTRS+12                                      1449 04956000
*        /************************************************************/ 04957000
*        /*                                                          */ 04958000
*        /* LOOP INITIALIZES AND MIGRATES UPWARD EACH VALID PASSWD   */ 04959000
*        /*                                                          */ 04960000
*        /************************************************************/ 04961000
*                                                                  1450 04962000
*        CTGFLPTR = ADDR(PASSWFPL);                                1450 04963000
         L     CTGFLPTR,PROTPTR                                    1450 04964000
*        PSWDFLAG = 0;                                             1451 04965000
*                                                                  1451 04966000
         SLR   PSWDFLAG,PSWDFLAG                                   1451 04967000
*PWINIT: DO N = 4 TO 1 BY -1;                                      1452 04968000
*                                                                  1452 04969000
PWINIT   LA    N,4                                                 1452 04970000
@DL01452 DS    0H                                                  1453 04971000
*        /************************************************************/ 04972000
*        /*                                                          */ 04973000
*        /* INITIALIZE PASSWALL FIELD FROM FDTTBL                    */ 04974000
*        /*                                                          */ 04975000
*        /************************************************************/ 04976000
*                                                                  1453 04977000
*        IF PWDPTRS(N) ^= NULLPTR                                  1453 04978000
*          THEN                                                    1453 04979000
         LR    @06,N                                               1453 04980000
         SLA   @06,2                                               1453 04981000
         L     @06,PWDPTRS-4(@06)                                  1453 04982000
         LTR   @06,@06                                             1453 04983000
         BZ    @RF01453                                            1453 04984000
*            DO;                                                   1454 04985000
*                                                                  1454 04986000
*            FDTTBLPT = PWDPTRS(N);                                1455 04987000
         LR    FDTTBLPT,@06                                        1455 04988000
*            PWDOVLAY(N) = CHARVAL(1:CHARLEN);                     1456 04989000
         LR    @06,N                                               1456 04990000
         SLA   @06,3                                               1456 04991000
         L     @01,PROTPTR                                         1456 04992000
         ALR   @01,@06                                             1456 04993000
         MVI   PWDOVLAY-7(@01),C' '                                1456 04994000
         MVC   PWDOVLAY-6(6,@01),PWDOVLAY-7(@01)                   1456 04995000
         SLR   @06,@06                                             1456 04996000
         IC    @06,CHARLEN(,FDTTBLPT)                              1456 04997000
         BCTR  @06,0                                               1456 04998000
         EX    @06,@SM03054                                        1456 04999000
*            PSWDFLAG = N;                                         1457 05000000
*                                                                  1457 05001000
         LR    PSWDFLAG,N                                          1457 05002000
*            END;                                                  1458 05003000
*                                                                  1458 05004000
*          /**********************************************************/ 05005000
*          /*                                                        */ 05006000
*          /* INIT PASSWALL FIELD  FROM THE MODEL TABLE              */ 05007000
*          /*                                                        */ 05008000
*          /**********************************************************/ 05009000
*                                                                  1459 05010000
*          ELSE                                                    1459 05011000
*            IF MDLPWALL ^= NULLPTR   &                            1459 05012000
*               MDLPSWD(N) ^= NULLPSWD                             1459 05013000
*              THEN                                                1459 05014000
         B     @RC01453                                            1459 05015000
@RF01453 L     @06,@PC00001+8                                      1459 05016000
         L     @06,MDLTBLPT(,@06)                                  1459 05017000
         L     @06,MDLPWALL(,@06)                                  1459 05018000
         LTR   @06,@06                                             1459 05019000
         BZ    @RF01459                                            1459 05020000
         LR    @15,N                                               1459 05021000
         SLA   @15,3                                               1459 05022000
         ST    @15,@TF00001                                        1459 05023000
         ALR   @15,@06                                             1459 05024000
         AL    @15,@CF03056                                        1459 05025000
         CLC   MDLPSWD(8,@15),@CB02355                             1459 05026000
         BE    @RF01459                                            1459 05027000
*                DO;                                               1460 05028000
*                                                                  1460 05029000
*                PWDOVLAY(N) = MDLPSWD(N);                         1461 05030000
         L     @01,PROTPTR                                         1461 05031000
         AL    @01,@TF00001                                        1461 05032000
         AL    @06,@TF00001                                        1461 05033000
         AL    @06,@CF03056                                        1461 05034000
         MVC   PWDOVLAY-8(8,@01),MDLPSWD(@06)                      1461 05035000
*                PSWDFLAG = N;                                     1462 05036000
*                                                                  1462 05037000
         LR    PSWDFLAG,N                                          1462 05038000
*                END;                                              1463 05039000
*                                                                  1463 05040000
*        END PWINIT;                                               1464 05041000
*                                                                  1464 05042000
@RF01459 DS    0H                                                  1464 05043000
@RC01453 BCTR  N,0                                                 1464 05044000
         LTR   N,N                                                 1464 05045000
         BP    @DL01452                                            1464 05046000
*        /************************************************************/ 05047000
*        /*                                                          */ 05048000
*        /* THE INITIALIZATION OF PSWDFLAG IN PWINIT INDICATES A     */ 05049000
*        /* PASSWORD HAS BEEN INITIALIZED AND THE HIGHEST LEVEL THAT */ 05050000
*        /* HAS BEEN SET. THE POINTER TO THE PASSWALL FPL IS SET IN  */ 05051000
*        /* THE FVT.                                                 */ 05052000
*        /*                                                          */ 05053000
*        /************************************************************/ 05054000
*                                                                  1465 05055000
*        IF PSWDFLAG ^= 0                                          1465 05056000
*          THEN                                                    1465 05057000
         LTR   PSWDFLAG,PSWDFLAG                                   1465 05058000
         BZ    @RF01465                                            1465 05059000
*            DO;                                                   1466 05060000
*                                                                  1466 05061000
*            CTGFVSTY = ADDR(PASSWFPL);                            1467 05062000
*                                                                  1467 05063000
         L     @06,PROTPTR                                         1467 05064000
         L     @02,@PC00001+8                                      1467 05065000
         L     @02,CTGFVPTR(,@02)                                  1467 05066000
         ST    @06,CTGFVSTY(,@02)                                  1467 05067000
*            /********************************************************/ 05068000
*            /*                                                      */ 05069000
*            /* PASSWORDS HAVE BEEN INITIALIZED, THERE MUST BE A     */ 05070000
*            /* MASTER PASSWORD IF IT HAS NOT BEEN EXPLICITELY SET   */ 05071000
*            /* MIGRATE THE HIGHEST SPECIFIED LEVEL UP THRU THE      */ 05072000
*            /* MASTER LEVEL. PSWDFLAG INDICATES THE HIGHEST LEVEL   */ 05073000
*            /* WHICH HAS BEEN SET.                                  */ 05074000
*            /*                                                      */ 05075000
*            /********************************************************/ 05076000
*                                                                  1468 05077000
*            IF PSWDFLAG ^= 1          &                           1468 05078000
*               PWDOVLAY(1) = NULLPSWD                             1468 05079000
*              THEN                                                1468 05080000
         C     PSWDFLAG,@CF00220                                   1468 05081000
         BE    @RF01468                                            1468 05082000
         CLC   PWDOVLAY(8,@06),@CB02355                            1468 05083000
         BNE   @RF01468                                            1468 05084000
*                DO N = (PSWDFLAG-1) TO 1 BY -1;                   1469 05085000
*                                                                  1469 05086000
         LR    N,PSWDFLAG                                          1469 05087000
         BCTR  N,0                                                 1469 05088000
         B     @DE01469                                            1469 05089000
@DL01469 DS    0H                                                  1470 05090000
*                PWDOVLAY(N) = PWDOVLAY(PSWDFLAG);                 1470 05091000
*                                                                  1470 05092000
         L     @06,PROTPTR                                         1470 05093000
         LR    @15,N                                               1470 05094000
         SLA   @15,3                                               1470 05095000
         ALR   @15,@06                                             1470 05096000
         LR    @14,PSWDFLAG                                        1470 05097000
         SLA   @14,3                                               1470 05098000
         ALR   @06,@14                                             1470 05099000
         MVC   @TS00001(8),PWDOVLAY-8(@06)                         1470 05100000
         MVC   PWDOVLAY-8(8,@15),@TS00001                          1470 05101000
*                END;                                              1471 05102000
*                                                                  1471 05103000
         BCTR  N,0                                                 1471 05104000
@DE01469 LTR   N,N                                                 1471 05105000
         BP    @DL01469                                            1471 05106000
*            END;                                                  1472 05107000
@RF01468 DS    0H                                                  1473 05108000
*        /************************************************************/ 05109000
*        /*                                                          */ 05110000
*        /* INITIALIZE PASSWORD PROMPTING CODE NAME IN SPACEPARM     */ 05111000
*        /* COMBINATION FIELD                                        */ 05112000
*        /*                                                          */ 05113000
*        /************************************************************/ 05114000
*                                                                  1473 05115000
*        IF (ADDR(APWPRMT)) ^= NULLPTR                             1473 05116000
*          THEN                                                    1473 05117000
@RF01465 L     @06,@PC00006+20                                     1473 05118000
         LTR   @06,@06                                             1473 05119000
         BZ    @RF01473                                            1473 05120000
*            DO;                                                   1474 05121000
*                                                                  1474 05122000
*            CTGFVSTY = ADDR(PASSWFPL);                            1475 05123000
         L     @02,PROTPTR                                         1475 05124000
         L     @15,@PC00001+8                                      1475 05125000
         L     @01,CTGFVPTR(,@15)                                  1475 05126000
         ST    @02,CTGFVSTY(,@01)                                  1475 05127000
*            FDTTBLPT = ADDR(APWPRMT);                             1476 05128000
         LR    FDTTBLPT,@06                                        1476 05129000
*            PASSPRMT = CHARVAL(1:CHARLEN);                        1477 05130000
*                                                                  1477 05131000
         MVI   PASSPRMT+1(@02),C' '                                1477 05132000
         MVC   PASSPRMT+2(6,@02),PASSPRMT+1(@02)                   1477 05133000
         SLR   @06,@06                                             1477 05134000
         IC    @06,CHARLEN(,FDTTBLPT)                              1477 05135000
         BCTR  @06,0                                               1477 05136000
         EX    @06,@SM03057                                        1477 05137000
*            END;                                                  1478 05138000
*                                                                  1478 05139000
*          ELSE                                                    1479 05140000
*            IF MDLPWALL ^= NULLPTR                                1479 05141000
*              THEN                                                1479 05142000
         B     @RC01473                                            1479 05143000
@RF01473 L     @06,@PC00001+8                                      1479 05144000
         L     @04,MDLTBLPT(,@06)                                  1479 05145000
         L     @04,MDLPWALL(,@04)                                  1479 05146000
         LTR   @04,@04                                             1479 05147000
         BZ    @RF01479                                            1479 05148000
*                DO;                                               1480 05149000
*                                                                  1480 05150000
*                PASSPRMT = MDLPWPMT;                              1481 05151000
         L     @02,PROTPTR                                         1481 05152000
         MVC   PASSPRMT(8,@02),MDLPWPMT(@04)                       1481 05153000
*                CTGFVSTY = ADDR(PASSWFPL);                        1482 05154000
*                                                                  1482 05155000
         L     @06,CTGFVPTR(,@06)                                  1482 05156000
         ST    @02,CTGFVSTY(,@06)                                  1482 05157000
*                END;                                              1483 05158000
*                                                                  1483 05159000
*        /************************************************************/ 05160000
*        /*                                                          */ 05161000
*        /* INITIALIZE MAXIMUM PASSWORD ATTEMPTS                     */ 05162000
*        /*                                                          */ 05163000
*        /************************************************************/ 05164000
*                                                                  1484 05165000
*        IF (ADDR(AMXATTMP)) ^= NULLPTR   &                        1484 05166000
*           PWDOVLAY(1) ^= NULLPSWD                                1484 05167000
*          THEN                                                    1484 05168000
@RF01479 DS    0H                                                  1484 05169000
@RC01473 L     @06,@PC00006+16                                     1484 05170000
         LTR   @06,@06                                             1484 05171000
         BZ    @RF01484                                            1484 05172000
         L     @04,PROTPTR                                         1484 05173000
         CLC   PWDOVLAY(8,@04),@CB02355                            1484 05174000
         BE    @RF01484                                            1484 05175000
*            DO;                                                   1485 05176000
*                                                                  1485 05177000
*            FDTTBLPT = ADDR(AMXATTMP);                            1486 05178000
         LR    FDTTBLPT,@06                                        1486 05179000
*            PASSATMP = NUMBVAL;                                   1487 05180000
         L     @06,PROTPTR                                         1487 05181000
         L     @02,NUMBVAL(,FDTTBLPT)                              1487 05182000
         STH   @02,PASSATMP(,@06)                                  1487 05183000
*            CTGFVSTY = ADDR(PASSWFPL);                            1488 05184000
*                                                                  1488 05185000
         L     @04,@PC00001+8                                      1488 05186000
         L     @04,CTGFVPTR(,@04)                                  1488 05187000
         ST    @06,CTGFVSTY(,@04)                                  1488 05188000
*            END;                                                  1489 05189000
*                                                                  1489 05190000
*          ELSE                                                    1490 05191000
*            IF MDLPWALL ^= NULLPTR                                1490 05192000
*              THEN                                                1490 05193000
         B     @RC01484                                            1490 05194000
@RF01484 L     @06,@PC00001+8                                      1490 05195000
         L     @04,MDLTBLPT(,@06)                                  1490 05196000
         L     @04,MDLPWALL(,@04)                                  1490 05197000
         LTR   @04,@04                                             1490 05198000
         BZ    @RF01490                                            1490 05199000
*                DO;                                               1491 05200000
*                                                                  1491 05201000
*                PASSATMP = MDLPWATP;                              1492 05202000
         L     @02,PROTPTR                                         1492 05203000
         LH    @04,MDLPWATP(,@04)                                  1492 05204000
         STH   @04,PASSATMP(,@02)                                  1492 05205000
*                CTGFVSTY = ADDR(PASSWFPL);                        1493 05206000
*                                                                  1493 05207000
         L     @06,CTGFVPTR(,@06)                                  1493 05208000
         ST    @02,CTGFVSTY(,@06)                                  1493 05209000
*                END;                                              1494 05210000
*                                                                  1494 05211000
*        /************************************************************/ 05212000
*        /*                                                          */ 05213000
*        /* INIT USER SECURITY VERIFICATION MODULE NAME              */ 05214000
*        /*                                                          */ 05215000
*        /************************************************************/ 05216000
*                                                                  1495 05217000
*        IF (ADDR(AUSVRNM)) ^= NULLPTR                             1495 05218000
*          THEN                                                    1495 05219000
@RF01490 DS    0H                                                  1495 05220000
@RC01484 L     @06,@PC00006+24                                     1495 05221000
         LTR   @06,@06                                             1495 05222000
         BZ    @RF01495                                            1495 05223000
*            DO;                                                   1496 05224000
*                                                                  1496 05225000
*            CTGFVSTY = ADDR(PASSWFPL);                            1497 05226000
         L     @02,PROTPTR                                         1497 05227000
         L     @15,@PC00001+8                                      1497 05228000
         L     @01,CTGFVPTR(,@15)                                  1497 05229000
         ST    @02,CTGFVSTY(,@01)                                  1497 05230000
*            FDTTBLPT = ADDR(AUSVRNM);                             1498 05231000
         LR    FDTTBLPT,@06                                        1498 05232000
*            SVRMDUL = CHARVAL(1:CHARLEN);                         1499 05233000
*                                                                  1499 05234000
         MVI   SVRMDUL+1(@02),C' '                                 1499 05235000
         MVC   SVRMDUL+2(6,@02),SVRMDUL+1(@02)                     1499 05236000
         SLR   @06,@06                                             1499 05237000
         IC    @06,CHARLEN(,FDTTBLPT)                              1499 05238000
         BCTR  @06,0                                               1499 05239000
         EX    @06,@SM03059                                        1499 05240000
*            END;                                                  1500 05241000
*                                                                  1500 05242000
*          ELSE                                                    1501 05243000
*            IF MDLPWALL ^= NULLPTR                                1501 05244000
*              THEN                                                1501 05245000
         B     @RC01495                                            1501 05246000
@RF01495 L     @06,@PC00001+8                                      1501 05247000
         L     @04,MDLTBLPT(,@06)                                  1501 05248000
         L     @04,MDLPWALL(,@04)                                  1501 05249000
         LTR   @04,@04                                             1501 05250000
         BZ    @RF01501                                            1501 05251000
*                DO;                                               1502 05252000
*                                                                  1502 05253000
*                SVRMDUL = MDLUSVRN;                               1503 05254000
         L     @02,PROTPTR                                         1503 05255000
         MVC   SVRMDUL(8,@02),MDLUSVRN(@04)                        1503 05256000
*                CTGFVSTY = ADDR(PASSWFPL);                        1504 05257000
*                                                                  1504 05258000
         L     @06,CTGFVPTR(,@06)                                  1504 05259000
         ST    @02,CTGFVSTY(,@06)                                  1504 05260000
*                END;                                              1505 05261000
*                                                                  1505 05262000
*        /************************************************************/ 05263000
*        /*                                                          */ 05264000
*        /* INIT VARIABLE LENGTH USER AUTHORIZATION RECORD           */ 05265000
*        /*                                                          */ 05266000
*        /************************************************************/ 05267000
*                                                                  1506 05268000
*        IF (ADDR(AUSERARC)) ^= NULLPTR                            1506 05269000
*          THEN                                                    1506 05270000
@RF01501 DS    0H                                                  1506 05271000
@RC01495 L     @06,@PC00006+28                                     1506 05272000
         LTR   @06,@06                                             1506 05273000
         BZ    @RF01506                                            1506 05274000
*            DO;                                                   1507 05275000
*                                                                  1507 05276000
*            FDTTBLPT = ADDR(AUSERARC);                            1508 05277000
         LR    FDTTBLPT,@06                                        1508 05278000
*            ARECLEN = CHARLEN;                                    1509 05279000
         L     @06,PROTPTR                                         1509 05280000
         SLR   @02,@02                                             1509 05281000
         IC    @02,CHARLEN(,FDTTBLPT)                              1509 05282000
         STH   @02,ARECLEN(,@06)                                   1509 05283000
*            AUTHREC(1:CHARLEN) = CHARVAL(1 : CHARLEN);            1510 05284000
         BCTR  @02,0                                               1510 05285000
         EX    @02,@SM03061                                        1510 05286000
*            CTGFVSTY = ADDR(PASSWFPL);                            1511 05287000
*                                                                  1511 05288000
         L     @04,@PC00001+8                                      1511 05289000
         L     @04,CTGFVPTR(,@04)                                  1511 05290000
         ST    @06,CTGFVSTY(,@04)                                  1511 05291000
*            END;                                                  1512 05292000
*                                                                  1512 05293000
*          ELSE                                                    1513 05294000
*            IF MDLPWALL ^= NULLPTR                                1513 05295000
*              THEN                                                1513 05296000
         B     @RC01506                                            1513 05297000
@RF01506 SLR   @06,@06                                             1513 05298000
         L     @04,@PC00001+8                                      1513 05299000
         L     @02,MDLTBLPT(,@04)                                  1513 05300000
         L     @02,MDLPWALL(,@02)                                  1513 05301000
         CR    @02,@06                                             1513 05302000
         BE    @RF01513                                            1513 05303000
*                IF MDLUARLN ^= 0                                  1514 05304000
*                  THEN                                            1514 05305000
         LH    @15,MDLUARLN(,@02)                                  1514 05306000
         CR    @15,@06                                             1514 05307000
         BE    @RF01514                                            1514 05308000
*                    DO;                                           1515 05309000
*                                                                  1515 05310000
*                    ARECLEN = MDLUARLN;                           1516 05311000
         L     @06,PROTPTR                                         1516 05312000
         STH   @15,ARECLEN(,@06)                                   1516 05313000
*                    AUTHREC(1:MDLUARLN) = MDLARECD(1 : MDLUARLN); 1517 05314000
         BCTR  @15,0                                               1517 05315000
         EX    @15,@SM03063                                        1517 05316000
*                    CTGFVSTY = ADDR(PASSWFPL);                    1518 05317000
*                                                                  1518 05318000
         L     @04,CTGFVPTR(,@04)                                  1518 05319000
         ST    @06,CTGFVSTY(,@04)                                  1518 05320000
*                    END;                                          1519 05321000
*                                                                  1519 05322000
*        /************************************************************/ 05323000
*        /*                                                          */ 05324000
*        /* INIT PASSWALL LENGTH AND POINTER IN FPL                  */ 05325000
*        /*                                                          */ 05326000
*        /************************************************************/ 05327000
*                                                                  1520 05328000
*        IF CTGFVSTY ^= NULLPTR                                    1520 05329000
*          THEN                                                    1520 05330000
*                                                                  1520 05331000
@RF01514 DS    0H                                                  1520 05332000
@RF01513 DS    0H                                                  1520 05333000
@RC01506 SLR   @06,@06                                             1520 05334000
         L     @04,@PC00001+8                                      1520 05335000
         L     @04,CTGFVPTR(,@04)                                  1520 05336000
         C     @06,CTGFVSTY(,@04)                                  1520 05337000
         BE    @RF01520                                            1520 05338000
*            /********************************************************/ 05339000
*            /* ACTION HAS OCCURRED AGAINST THE PASSWALL FIELD, THIS */ 05340000
*            /* FIELD IS PASSED ONLY IF SUCH ACTION HAS RESULTED IN  */ 05341000
*            /* A VALID MASTER PASSWORD BEING IN EXISTANCE AT THIS   */ 05342000
*            /* TIME                                                 */ 05343000
*            /********************************************************/ 05344000
*                                                                  1521 05345000
*            IF PWDOVLAY(1) = NULLPSWD                             1521 05346000
*              THEN                                                1521 05347000
         L     @02,PROTPTR                                         1521 05348000
         CLC   PWDOVLAY(8,@02),@CB02355                            1521 05349000
         BNE   @RF01521                                            1521 05350000
*                CTGFVSTY = NULLPTR;                               1522 05351000
*                                                                  1522 05352000
         ST    @06,CTGFVSTY(,@04)                                  1522 05353000
*              /******************************************************/ 05354000
*              /*                                                    */ 05355000
*              /* ACTION HAS OCCURRED AND WE HAVE A VALID MASTER PSWD*/ 05356000
*              /* THUS SET UP THE PASSWALL FPL SO THAT THIS          */ 05357000
*              /* INFORMATION IS PASSED TO VSAM CATLG MANAGEMENT     */ 05358000
*              /*                                                    */ 05359000
*              /******************************************************/ 05360000
*                                                                  1523 05361000
*              ELSE                                                1523 05362000
*                DO;                                               1523 05363000
*                                                                  1523 05364000
         B     @RC01521                                            1523 05365000
@RF01521 DS    0H                                                  1524 05366000
*                CTGFLNG(1) = (LENGTH(SPRMAREA) + ARECLEN);        1524 05367000
         L     @06,PROTPTR                                         1524 05368000
         LA    @04,52                                              1524 05369000
         AH    @04,ARECLEN(,@06)                                   1524 05370000
         ST    @04,CTGFLNG(,CTGFLPTR)                              1524 05371000
*                CTGFLPT(1) = ADDR(SPRMAREA);                      1525 05372000
*                                                                  1525 05373000
         LA    @06,SPRMAREA(,@06)                                  1525 05374000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1525 05375000
*                END;                                              1526 05376000
*                                                                  1526 05377000
*        /************************************************************/ 05378000
*        /*                                                          */ 05379000
*        /* INITIALIZE OWNER ID - NAME OF OWNER OF OBJECT            */ 05380000
*        /*                                                          */ 05381000
*        /************************************************************/ 05382000
*                                                                  1527 05383000
*        IF (ADDR(AOWNRID)) ^= NULLPTR                             1527 05384000
*          THEN                                                    1527 05385000
@RC01521 DS    0H                                                  1527 05386000
@RF01520 L     @06,@PC00006+32                                     1527 05387000
         LTR   @06,@06                                             1527 05388000
         BZ    @RF01527                                            1527 05389000
*            DO;                                                   1528 05390000
*                                                                  1528 05391000
*            CTGFLPTR = ADDR(OWNIDFPL);                            1529 05392000
         L     CTGFLPTR,PROTPTR                                    1529 05393000
         LA    CTGFLPTR,OWNIDFPL(,CTGFLPTR)                        1529 05394000
*            CTGFVOWN = CTGFLPTR;                                  1530 05395000
         L     @02,@PC00001+8                                      1530 05396000
         L     @02,CTGFVPTR(,@02)                                  1530 05397000
         ST    CTGFLPTR,CTGFVOWN(,@02)                             1530 05398000
*            CTGFLNG(1) = 8;                                       1531 05399000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00180                        1531 05400000
*            FDTTBLPT = ADDR(AOWNRID);                             1532 05401000
         LR    FDTTBLPT,@06                                        1532 05402000
*            CTGFLPT(1) = ADDR(CHARVAL);                           1533 05403000
*                                                                  1533 05404000
         LA    @06,CHARVAL(,FDTTBLPT)                              1533 05405000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1533 05406000
*            END;                                                  1534 05407000
*                                                                  1534 05408000
*          ELSE                                                    1535 05409000
*            IF MDLOWNID ^= NULLPTR                                1535 05410000
*              THEN                                                1535 05411000
         B     @RC01527                                            1535 05412000
@RF01527 L     @06,@PC00001+8                                      1535 05413000
         L     @04,MDLTBLPT(,@06)                                  1535 05414000
         L     @04,MDLOWNID(,@04)                                  1535 05415000
         LTR   @04,@04                                             1535 05416000
         BZ    @RF01535                                            1535 05417000
*                DO;                                               1536 05418000
*                                                                  1536 05419000
*                CTGFLPTR = ADDR(OWNIDFPL);                        1537 05420000
         L     CTGFLPTR,PROTPTR                                    1537 05421000
         LA    CTGFLPTR,OWNIDFPL(,CTGFLPTR)                        1537 05422000
*                CTGFVOWN = CTGFLPTR;                              1538 05423000
         L     @06,CTGFVPTR(,@06)                                  1538 05424000
         ST    CTGFLPTR,CTGFVOWN(,@06)                             1538 05425000
*                CTGFLNG(1) = 8;                                   1539 05426000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00180                        1539 05427000
*                CTGFLPT(1) = MDLOWNID;                            1540 05428000
*                                                                  1540 05429000
         ST    @04,CTGFLPT(,CTGFLPTR)                              1540 05430000
*                END;                                              1541 05431000
*                                                                  1541 05432000
*        /************************************************************/ 05433000
*        /*                                                          */ 05434000
*        /* INITIALIZE DATA SET ATTRIBUTES                           */ 05435000
*        /*                                                          */ 05436000
*        /************************************************************/ 05437000
*                                                                  1542 05438000
*        CTGFLPTR = CTGFVATR;                                      1542 05439000
*                                                                  1542 05440000
*                                                                  1542 05441000
@RF01535 DS    0H                                                  1542 05442000
@RC01527 L     @06,@PC00001+8                                      1542 05443000
         L     @06,CTGFVPTR(,@06)                                  1542 05444000
         L     CTGFLPTR,CTGFVATR(,@06)                             1542 05445000
*        /************************************************************/ 05446000
*        /*                                                          */ 05447000
*        /* INITIALIZE SHARE OPTIONS PORTION OF DATA SET ATTRIBUTES  */ 05448000
*        /*                                                          */ 05449000
*        /************************************************************/ 05450000
*        IF (ADDR(ASHAR1)) ^= NULLPTR                              1543 05451000
*          THEN                                                    1543 05452000
         L     @06,@PC00006+44                                     1543 05453000
         LTR   @06,@06                                             1543 05454000
         BZ    @RF01543                                            1543 05455000
*SHARSET:    DO;                                                   1544 05456000
*                                                                  1544 05457000
SHARSET  DS    0H                                                  1545 05458000
*            /********************************************************/ 05459000
*            /*                                                      */ 05460000
*            /* SET CROSS REGION SHARE OPTIONS                       */ 05461000
*            /*                                                      */ 05462000
*            /********************************************************/ 05463000
*            FDTTBLPT = ADDR(ASHAR1);                              1545 05464000
         L     FDTTBLPT,@PC00006+44                                1545 05465000
*            CTGFLPT(1) -> PSHARE2 = SHROPT3;                      1546 05466000
*                                                                  1546 05467000
         L     @06,CTGFLPT(,CTGFLPTR)                              1546 05468000
         NI    PSHARE2(@06),B'11101111'                            1546 05469000
         OI    PSHARE2(@06),B'00100000'                            1546 05470000
*            /********************************************************/ 05471000
*            /*                                                      */ 05472000
*            /* REGION SHARE - ALL READ USERS OR ONE UPDATE/OUTPUT   */ 05473000
*            /*                                                      */ 05474000
*            /********************************************************/ 05475000
*            IF NUMBVAL = 1                                        1547 05476000
*              THEN                                                1547 05477000
         CLC   NUMBVAL(4,FDTTBLPT),@CF00220                        1547 05478000
         BNE   @RF01547                                            1547 05479000
*                CTGFLPT(1) -> PSHARE1 = SHROPT1;                  1548 05480000
*                                                                  1548 05481000
         NI    PSHARE1(@06),B'00111111'                            1548 05482000
*              /******************************************************/ 05483000
*              /*                                                    */ 05484000
*              /* REGION SHARE - ALL READ & ONE UPDATE/OUTPUT USER   */ 05485000
*              /*                                                    */ 05486000
*              /******************************************************/ 05487000
*              ELSE                                                1549 05488000
*                IF NUMBVAL = 2                                    1549 05489000
*                  THEN                                            1549 05490000
         B     @RC01547                                            1549 05491000
@RF01547 CLC   NUMBVAL(4,FDTTBLPT),@CF00154                        1549 05492000
         BNE   @RF01549                                            1549 05493000
*                    CTGFLPT(1) -> PSHARE1 = SHROPT2;              1550 05494000
*                                                                  1550 05495000
         L     @06,CTGFLPT(,CTGFLPTR)                              1550 05496000
         NI    PSHARE1(@06),B'01111111'                            1550 05497000
         OI    PSHARE1(@06),B'01000000'                            1550 05498000
*                  /**************************************************/ 05499000
*                  /*                                                */ 05500000
*                  /*REGION SHARE - FULL SHARE                       */ 05501000
*                  /*                                                */ 05502000
*                  /**************************************************/ 05503000
*                  ELSE                                            1551 05504000
*                    IF NUMBVAL = 3                                1551 05505000
*                      THEN                                        1551 05506000
         B     @RC01549                                            1551 05507000
@RF01549 CLC   NUMBVAL(4,FDTTBLPT),@CF00163                        1551 05508000
         BNE   @RF01551                                            1551 05509000
*                        CTGFLPT(1) -> PSHARE1 = SHROPT3;          1552 05510000
*                                                                  1552 05511000
         L     @06,CTGFLPT(,CTGFLPTR)                              1552 05512000
         NI    PSHARE1(@06),B'10111111'                            1552 05513000
         OI    PSHARE1(@06),B'10000000'                            1552 05514000
*                      /**********************************************/ 05515000
*                      /*                                            */ 05516000
*                      /* REGION SHARE - FULL SHARE, ACCESS METHOD   */ 05517000
*                      /* ASSISTANCE                                 */ 05518000
*                      /*                                            */ 05519000
*                      /**********************************************/ 05520000
*                      ELSE                                        1553 05521000
*                        IF NUMBVAL = 4                            1553 05522000
*                          THEN                                    1553 05523000
         B     @RC01551                                            1553 05524000
@RF01551 CLC   NUMBVAL(4,FDTTBLPT),@CF00043                        1553 05525000
         BNE   @RF01553                                            1553 05526000
*                            CTGFLPT(1) -> PSHARE1 = SHROPT4;      1554 05527000
*                                                                  1554 05528000
         L     @06,CTGFLPT(,CTGFLPTR)                              1554 05529000
         OI    PSHARE1(@06),B'11000000'                            1554 05530000
*                          ELSE;                                   1555 05531000
*                                                                  1555 05532000
@RF01553 DS    0H                                                  1556 05533000
*            /********************************************************/ 05534000
*            /*                                                      */ 05535000
*            /* SET CROSS SYSTEM ATTRIBUTES                          */ 05536000
*            /*                                                      */ 05537000
*            /********************************************************/ 05538000
*            IF (ADDR(ASHAR2)) ^= NULLPTR                          1556 05539000
*              THEN                                                1556 05540000
@RC01551 DS    0H                                                  1556 05541000
@RC01549 DS    0H                                                  1556 05542000
@RC01547 L     @06,@PC00006+48                                     1556 05543000
         LTR   @06,@06                                             1556 05544000
         BZ    @RF01556                                            1556 05545000
*                DO;                                               1557 05546000
*                                                                  1557 05547000
*                FDTTBLPT = ADDR(ASHAR2);                          1558 05548000
*                                                                  1558 05549000
         LR    FDTTBLPT,@06                                        1558 05550000
*                /****************************************************/ 05551000
*                /*                                                  */ 05552000
*                /* SYSTEM SHARE - FULL SHARE                        */ 05553000
*                /*                                                  */ 05554000
*                /****************************************************/ 05555000
*                                                                  1559 05556000
*                IF NUMBVAL = 3                                    1559 05557000
*                  THEN                                            1559 05558000
         CLC   NUMBVAL(4,FDTTBLPT),@CF00163                        1559 05559000
         BNE   @RF01559                                            1559 05560000
*                    CTGFLPT(1) -> PSHARE2 = SHROPT3;              1560 05561000
*                                                                  1560 05562000
         L     @06,CTGFLPT(,CTGFLPTR)                              1560 05563000
         NI    PSHARE2(@06),B'11101111'                            1560 05564000
         OI    PSHARE2(@06),B'00100000'                            1560 05565000
*                  /**************************************************/ 05566000
*                  /*                                                */ 05567000
*                  /* SYSTEM SHARE - FULL SHARE WITH ACCESS METHOD   */ 05568000
*                  /* ASSISTANCE                                     */ 05569000
*                  /*                                                */ 05570000
*                  /**************************************************/ 05571000
*                  ELSE                                            1561 05572000
*                    IF NUMBVAL = 4                                1561 05573000
*                      THEN                                        1561 05574000
         B     @RC01559                                            1561 05575000
@RF01559 CLC   NUMBVAL(4,FDTTBLPT),@CF00043                        1561 05576000
         BNE   @RF01561                                            1561 05577000
*                        CTGFLPT(1) -> PSHARE2 = SHROPT4;          1562 05578000
*                                                                  1562 05579000
         L     @06,CTGFLPT(,CTGFLPTR)                              1562 05580000
         OI    PSHARE2(@06),B'00110000'                            1562 05581000
*                      ELSE;                                       1563 05582000
*                                                                  1563 05583000
@RF01561 DS    0H                                                  1564 05584000
*                END;                                              1564 05585000
*                                                                  1564 05586000
@RC01559 DS    0H                                                  1565 05587000
*            END SHARSET;                                          1565 05588000
*                                                                  1565 05589000
@RF01556 DS    0H                                                  1566 05590000
*        /************************************************************/ 05591000
*        /*                                                  @Y30SSJH*/ 05592000
*        /* INITIALIZE ERASE/NOERASE AND REUSE/NOREUSE       @Y30SSJH*/ 05593000
*        /* OPTIONS                                          @Y30SSJH*/ 05594000
*        /*                                                  @Y30SSJH*/ 05595000
*        /************************************************************/ 05596000
*                                                                  1566 05597000
*        IF (ADDR(AERASE)) ^= NULLPTR                              1566 05598000
*          THEN                                                    1566 05599000
@RF01543 L     @06,@PC00006+36                                     1566 05600000
         LTR   @06,@06                                             1566 05601000
         BZ    @RF01566                                            1566 05602000
*            CTGFLPT(1) -> PERASE = ON;                            1567 05603000
         L     @06,CTGFLPT(,CTGFLPTR)                              1567 05604000
         OI    PERASE(@06),B'00010000'                             1567 05605000
*          ELSE                                                    1568 05606000
*            IF (ADDR(ANERS)) ^= NULLPTR                           1568 05607000
*              THEN                                                1568 05608000
         B     @RC01566                                            1568 05609000
@RF01566 L     @06,@PC00006+40                                     1568 05610000
         LTR   @06,@06                                             1568 05611000
         BZ    @RF01568                                            1568 05612000
*                CTGFLPT(1) -> PERASE = OFF;                       1569 05613000
*                                                                  1569 05614000
         L     @06,CTGFLPT(,CTGFLPTR)                              1569 05615000
         NI    PERASE(@06),B'11101111'                             1569 05616000
*        IF (ADDR(ARUS)) ^= NULLPTR                                1570 05617000
*          THEN                                                    1570 05618000
@RF01568 DS    0H                                                  1570 05619000
@RC01566 L     @06,@PC00006+52                                     1570 05620000
         LTR   @06,@06                                             1570 05621000
         BZ    @RF01570                                            1570 05622000
*            CTGFLPT(1) -> PRUS = ON;                      /*@Y30SSJH*/ 05623000
         L     @06,CTGFLPT(,CTGFLPTR)                              1571 05624000
         OI    PRUS(@06),B'00100000'                               1571 05625000
*          ELSE                                                    1572 05626000
*            IF (ADDR(ANRUS)) ^= NULLPTR                           1572 05627000
*              THEN                                                1572 05628000
         B     @RC01570                                            1572 05629000
@RF01570 L     @06,@PC00006+56                                     1572 05630000
         LTR   @06,@06                                             1572 05631000
         BZ    @RF01572                                            1572 05632000
*                CTGFLPT(1) -> PRUS = OFF;                 /*@Y30SSJH*/ 05633000
*                                                                  1573 05634000
         L     @06,CTGFLPT(,CTGFLPTR)                              1573 05635000
         NI    PRUS(@06),B'11011111'                               1573 05636000
*        /************************************************************/ 05637000
*        /*                                                  @Y30SSJH*/ 05638000
*        /* INITIALIZE RGATTR FPL FOR ALTERNATE INDEXES AND  @Y30SSJH*/ 05639000
*        /* PATHS - TAKE COPY FROM MODEL IF ONE EXISTS, THEN @Y30SSJH*/ 05640000
*        /* OVERRIDE WITH EXPLICIT ATTRIBUTES                @Y30SSJH*/ 05641000
*        /*                                                  @Y30SSJH*/ 05642000
*        /************************************************************/ 05643000
*                                                                  1574 05644000
*        IF CTGFVTYP = 'G' |                                       1574 05645000
*           CTGFVTYP = 'R'                                         1574 05646000
*          THEN                                                    1574 05647000
@RF01572 DS    0H                                                  1574 05648000
@RC01570 L     @06,@PC00001+8                                      1574 05649000
         L     @06,CTGFVPTR(,@06)                                  1574 05650000
         CLI   CTGFVTYP(@06),C'G'                                  1574 05651000
         BE    @RT01574                                            1574 05652000
         CLI   CTGFVTYP(@06),C'R'                                  1574 05653000
         BNE   @RF01574                                            1574 05654000
@RT01574 DS    0H                                                  1575 05655000
*            DO;                                           /*@Y30SSJH*/ 05656000
*                                                                  1575 05657000
*            CTGFLPTR = ADDR(RGATRFPL);                    /*@Y30SSJH*/ 05658000
         L     @06,PROTPTR                                         1576 05659000
         LA    CTGFLPTR,RGATRFPL(,@06)                             1576 05660000
*            CTGFVUPG = CTGFLPTR;                          /*@Y30SSJH*/ 05661000
         L     @04,@PC00001+8                                      1577 05662000
         L     @02,CTGFVPTR(,@04)                                  1577 05663000
         ST    CTGFLPTR,CTGFVUPG(,@02)                             1577 05664000
*            CTGFLNG(1) = 1;                               /*@Y30SSJH*/ 05665000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00220                        1578 05666000
*            CTGFLPT(1) = ADDR(RGATTR);                    /*@Y30SSJH*/ 05667000
*                                                                  1579 05668000
         LA    @02,RGATTR(,@06)                                    1579 05669000
         ST    @02,CTGFLPT(,CTGFLPTR)                              1579 05670000
*            IF MDLRGATR ^= NULLPTR                                1580 05671000
*              THEN                                                1580 05672000
         L     @04,MDLTBLPT(,@04)                                  1580 05673000
         L     @04,MDLRGATR(,@04)                                  1580 05674000
         LTR   @04,@04                                             1580 05675000
         BZ    @RF01580                                            1580 05676000
*                RGATTR = MDLRATTR;    /* COPY FROM MODEL    @Y30SSJH*/ 05677000
*                                                                  1581 05678000
         MVC   RGATTR(1,@06),MDLRATTR(@04)                         1581 05679000
*              ELSE                                                1582 05680000
*                UPGUPD = ON;          /* UPGRADE, UPDATE IS DEFAULT    05681000
*                                                            @Y30SSJH*/ 05682000
*                                                                  1582 05683000
         B     @RC01580                                            1582 05684000
@RF01580 L     @06,PROTPTR                                         1582 05685000
         OI    UPGUPD(@06),B'10000000'                             1582 05686000
*            /********************************************************/ 05687000
*            /*                                              @Y30SSJH*/ 05688000
*            /* SET EXPLICIT ATTRIBUTES FROM FDTTBL          @Y30SSJH*/ 05689000
*            /*                                              @Y30SSJH*/ 05690000
*            /********************************************************/ 05691000
*                                                                  1583 05692000
*            IF (ADDR(AUPG)) ^= NULLPTR                            1583 05693000
*              THEN                                                1583 05694000
@RC01580 L     @06,@PC00006+60                                     1583 05695000
         LTR   @06,@06                                             1583 05696000
         BZ    @RF01583                                            1583 05697000
*                UPGUPD = ON;                              /*@Y30SSJH*/ 05698000
*                                                                  1584 05699000
         L     @06,PROTPTR                                         1584 05700000
         OI    UPGUPD(@06),B'10000000'                             1584 05701000
*              ELSE                                                1585 05702000
*                IF (ADDR(ANUPG)) ^= NULLPTR                       1585 05703000
*                  THEN                                            1585 05704000
         B     @RC01583                                            1585 05705000
@RF01583 L     @06,@PC00006+64                                     1585 05706000
         LTR   @06,@06                                             1585 05707000
         BZ    @RF01585                                            1585 05708000
*                    UPGUPD = OFF;                         /*@Y30SSJH*/ 05709000
*                                                                  1586 05710000
         L     @06,PROTPTR                                         1586 05711000
         NI    UPGUPD(@06),B'01111111'                             1586 05712000
*            END;                                          /*@Y30SSJH*/ 05713000
*                                                                  1587 05714000
*        /************************************************************/ 05715000
*        /*                                                  @Y30SSJH*/ 05716000
*        /* PROTECTION ATTRIBUTES HAVE BEEN INITIALIZED - RETURN     */ 05717000
*        /* CONTROL TO CALLER OF PROTPROC                    @Y30SSJH*/ 05718000
*        /*                                                  @Y30SSJH*/ 05719000
*        /************************************************************/ 05720000
*                                                                  1588 05721000
*        RETURN;                                           /*@Y30SSJH*/ 05722000
*                                                                  1588 05723000
         B     @EL00006                                            1588 05724000
*END PROTPROC;                                             /*@Y30SSJH*/ 05725000
         B     @EL00006                                            1589 05726000
*/********************************************************************/ 05727000
*/*                                                                  */ 05728000
*/* PROCEDURE NAME - MODELPRC (LEVEL TWO SERVICE ROUTINE)            */ 05729000
*/*                                                                  */ 05730000
*/* FUNCTION - MODELPRC HANDLES THE RETRIEVAL OF MODEL OBJECTS TO    */ 05731000
*/*            BE USED IN DEFINING COMPONENTS OF VSAM USER CATALOGS  */ 05732000
*/*            AND VSAM DATA SETS.                                   */ 05733000
*/*                                                                  */ 05734000
*/*            MODELPRC OPENS THE USERCATALOGS CONTAINING THE MODEL  */ 05735000
*/*            WHEN MDNM IS SPECIFIED                                */ 05736000
*/*                                                                  */ 05737000
*/*            A CPL-FPL COMPLEX IS BUILT TO TRANSMIT THE THE LOCATE */ 05738000
*/*            REQUEST TO VSAM CATALOG MANAGEMENT                    */ 05739000
*/*            MODELPRC ISSUES THE IDCAMS UCATLG MACRO TO INVOKE     */ 05740000
*/*            VSAM CATALOG MANAGEMENT                               */ 05741000
*/*                                                                  */ 05742000
*/*            MODELPRC INITIALIZES THE MODEL TABLE(MDTAB) ON COMP-  */ 05743000
*/*            LETION OF THE LOCATE REQUEST,  THIS TABLE CONTAINS    */ 05744000
*/*            THE LENGTH AND ADDRESS OF FIELDS LOCATED.             */ 05745000
*/*                                                                  */ 05746000
*/*            MODELPRC RECEIVES CONTROL FROM AND RETURNS TO A       */ 05747000
*/*            LEVEL TWO PROCESSOR                                   */ 05748000
*/*                                                                  */ 05749000
*/* INPUT -                                                          */ 05750000
*/*            DEFSTID - GLOBAL INTERNAL STATUS COMMUNICATOR         */ 05751000
*/*            SEE DEFINITION OF ARGUMENTS OF INVOCATION             */ 05752000
*/*                                                                  */ 05753000
*/* OUTPUT -                                                         */ 05754000
*/*            DEFSTID GLOBAL PROCESSING STATUS, SET ON ERROR        */ 05755000
*/*            DETECTION                                             */ 05756000
*/*              . DEFSTID = NOSTORAG                                */ 05757000
*/*              . DEFSTID = CATERROR                                */ 05758000
*/*              . DEFSTID = MDLTYPER                                */ 05759000
*/*              . DEFSTID = PSWDSUPR                                */ 05760000
*/*            MDTAB - THE MODEL TABLE                               */ 05761000
*/*                                                                  */ 05762000
*/********************************************************************/ 05763000
*                                                                  1590 05764000
*MODELPRC:                                                         1590 05765000
*        PROCEDURE (ENAM,ENAMPLN,ENAMPAS,MDCT,MDCTPLN,MDCTPAS,MDNM,     05766000
*          ASCNAME,MDLACBPT,MODELTAB)                      /*@Z40WSJH*/ 05767000
*          OPTIONS(SAVEAREA);                              /*@Z40WSJH*/ 05768000
MODELPRC STM   @14,@12,12(@13)                                     1590 05769000
         ST    @13,@SA00007+4                                      1590 05770000
         LA    @14,@SA00007                                        1590 05771000
         ST    @14,8(,@13)                                         1590 05772000
         LR    @13,@14                                             1590 05773000
         MVC   @PC00007(40),0(@01)                                 1590 05774000
*        GEN (ENTRY MODELPRC);       /* EXTERNAL ENTRY POINT @Z40WSJH*/ 05775000
         ENTRY MODELPRC                                                 05776000
*        LM (REG10,REG12,BASESAVE);   /* LOAD PROC CODE REGS @Z40WSJH*/ 05777000
*                                                                  1592 05778000
         LM    REG10,REG12,BASESAVE                                1592 05779000
*        /************************************************************/ 05780000
*        /*                                                          */ 05781000
*        /* ARGUMENTS OF INVOCATION                                  */ 05782000
*        /*                                                          */ 05783000
*        /************************************************************/ 05784000
*        DCL                                                       1593 05785000
*          ENAM,                       /*NAME OF OBJECT TO BE MODELED*/ 05786000
*          ENAMPLN,                    /* LEN OF ENTRY PASSWORD      */ 05787000
*          ENAMPAS,                    /*PASSWORD OF NAME            */ 05788000
*          MDCT,                       /*CATLG NAME OF ENTRY         */ 05789000
*          MDCTPLN,                    /* LENGTH OF CATALOG PASSWORD */ 05790000
*          MDCTPAS,                    /*PASSWORD OF CATALOG NAME    */ 05791000
*          MDNM,                       /*JCL STATEMENT DESCRIBING CTG*/ 05792000
*          ASCNAME,                    /*ID # OF ENTRY TO BE MODELED */ 05793000
*          MODELTAB,                   /* MODEL TABLE                */ 05794000
*          MDLACBPT;                   /* RETN ADDR OF OPENACB       */ 05795000
*                                                                  1593 05796000
*                                                                  1593 05797000
*        /************************************************************/ 05798000
*        /*                                                          */ 05799000
*        /* LENTABLE GIVES THE LENGTH OF FIXED LENGTH FIELDS WHICH   */ 05800000
*        /* ARE USED TO DETERMINE RETURN OF NULL DATA                */ 05801000
*        /*                                                          */ 05802000
*        /************************************************************/ 05803000
*                                                                  1594 05804000
*        DCL                                                       1594 05805000
*          LENTABLE(15) FIXED(8) INIT(                             1594 05806000
*            1,                        /* ENTYPE LENGTH              */ 05807000
*            4,                        /* CATACB LENGTH              */ 05808000
*            3,                        /* DSETCRDT LENGTH            */ 05809000
*            8,                        /* OWNERID LENGTH             */ 05810000
*            2,                        /* DSATTR LENGTH              */ 05811000
*            (LENGTH(IDAAMDSB)),       /* AMDSBCAT LENGTH            */ 05812000
*            6,                        /* VOLSER LENGTH              */ 05813000
*            0,                        /* LOW KEY, VARIABLE LENGTH   */ 05814000
*            0,                        /* HIGH KEY, VARIABLE LENGTH  */ 05815000
*            7,                        /* SPACPARM LENGTH            */ 05816000
*            4,                        /* LRECL LENGTH               */ 05817000
*            4,                        /* BUFSIZE LENGTH             */ 05818000
*            4,                        /* ASCNAME LENGTH     @Y30SSJH*/ 05819000
*            8,                        /* EXCPEXIT LENGTH    @Y30SSJH*/ 05820000
*            1);                       /* RGATTR LENGTH      @Y30SSJH*/ 05821000
*                                                                  1594 05822000
*        /************************************************************/ 05823000
*        /*                                                          */ 05824000
*        /* WORKAREA IN WHICH VSAM LOCATE RETURNS CATLG DATA @Y30SSJH*/ 05825000
*        /*                                                          */ 05826000
*        /************************************************************/ 05827000
*                                                                  1595 05828000
*        DCL MDLWKAPT PTR(31);                                     1595 05829000
*        DCL                                                       1596 05830000
*          1 MODELWKA BASED(MDLWKAPT) BDY(WORD),                   1596 05831000
*            2 MDLWKALN FIXED(15),                                 1596 05832000
*            2 MDLRQDLN FIXED(15),                                 1596 05833000
*            2 MDLDATA  CHAR(*);                                   1596 05834000
*                                                                  1596 05835000
*        /************************************************************/ 05836000
*        /*                                                          */ 05837000
*        /* UGPOOL ID FOR MODEL WORKAREA SPACE                       */ 05838000
*        /*                                                          */ 05839000
*        /************************************************************/ 05840000
*                                                                  1597 05841000
*        DCL                                                       1597 05842000
*          MDLID   CHAR(4) INIT('DE02');                           1597 05843000
*                                                                  1597 05844000
*        /************************************************************/ 05845000
*        /*                                                          */ 05846000
*        /* IOCS ADDRESS OF OPENCATALOG - USED TO REFERENCE THE ACB  */ 05847000
*        /* ADDRESS OF THE OPEN CATALOG                              */ 05848000
*        /*                                                          */ 05849000
*        /************************************************************/ 05850000
*                                                                  1598 05851000
*        DCL                                                       1598 05852000
*          MDIOCSPT PTR(31) BASED(OPNIOC);                         1598 05853000
*                                                                  1598 05854000
*        /************************************************************/ 05855000
*        /*                                                          */ 05856000
*        /* LENGTH OF LOCATE WORKAREA OBTAINED BY UGPOOL             */ 05857000
*        /*                                                          */ 05858000
*        /************************************************************/ 05859000
*        DCL                                                       1599 05860000
*          MWKALEN  FIXED(31);                                     1599 05861000
*                                                                  1599 05862000
*        /************************************************************/ 05863000
*        /*                                                          */ 05864000
*        /* MODEL PROCESSING CONTROL VARIABLES                       */ 05865000
*        /*                                                          */ 05866000
*        /************************************************************/ 05867000
*                                                                  1600 05868000
*        DCL                                                       1600 05869000
*          CKLEN   FIXED(15),          /* LOOP CONTROL FOR VERIFYING    05870000
*                                         NON-NULL LOCATED DATA      */ 05871000
*          LOOP    FIXED(15),          /* LOOP CONTROL FOR ISOLATING    05872000
*                                         ASSOCIATED NAMES   @Y30SSJH*/ 05873000
*          MDLOOPCT FIXED(15),         /* COUNTER TO PREVENT INFINITE   05874000
*                                         LOCATE LOOP                */ 05875000
*          CKSWITCH CHAR(1),         /* SWITCH USED IN VERIFYING THE    05876000
*                                         NON-NULL LOCATED DATA      */ 05877000
*          MDLFLG   CHAR(1);           /* LOOP CONTROL FOR LOCATE    */ 05878000
*                                                                  1600 05879000
*        /************************************************************/ 05880000
*        /*                                                          */ 05881000
*        /* FIELD NAMES OF DATA LOCATED FOR MODEL                    */ 05882000
*        /*                                                          */ 05883000
*        /************************************************************/ 05884000
*        DCL                                                       1601 05885000
*           MDLNMTAB(19) CHAR(8) INIT('ENTYPE','CATACB',           1601 05886000
*            'DSETEXDT','OWNERID','DSATTR','AMDSBCAT','VOLSER',    1601 05887000
*            'LOKEYV','HIKEYV',                                    1601 05888000
*            'SPACPARM','LRECL','BUFSIZE','NAMEDS','EXCPEXIT',     1601 05889000
*            'RGATTR','PASSWALL','CATTR','ITYPEXT',                1601 05890000
*            'CNTREPNO');                                  /*@Y30SSJH*/ 05891000
*                                                                  1601 05892000
*        /************************************************************/ 05893000
*        /*                                                          */ 05894000
*        /* MODEL TABLE - CONTAINS POINTERS TO DATA FIELDS AND LENGTH*/ 05895000
*        /*                                                          */ 05896000
*        /************************************************************/ 05897000
*        DCL LOCATPTR PTR(31);         /* PTR TO LOCATE PARM LIST    */ 05898000
*        DCL MDTBPT PTR(31);                                       1603 05899000
*        DCL                                                       1604 05900000
*          1 MDTAB BASED(MDTBPT) BDY(WORD),                        1604 05901000
*            2 MDLETYPE  CHAR(1),                                  1604 05902000
*            2 *     CHAR(3),                                      1604 05903000
*            2 *     (16)  CHAR(8)BDY(WORD),                       1604 05904000
*              3 MDLFLDLN  FIXED(31),                              1604 05905000
*              3 MDLFLDPT  PTR(31);                                1604 05906000
*                                                                  1604 05907000
*        /************************************************************/ 05908000
*        /*                                                          */ 05909000
*        /* POINTER AND MASK USED IN SETTING TEST FOR VOLSER RETRIEVE*/ 05910000
*        /*                                                          */ 05911000
*        /************************************************************/ 05912000
*                                                                  1605 05913000
*        DCL                                                       1605 05914000
*          TSTFPLVS PTR(31);                               /*@Y30SSJH*/ 05915000
*                                                                  1605 05916000
*        DCL                                                       1606 05917000
*          VOLSMASK CHAR(1) INIT('80'X);                           1606 05918000
*                                                                  1606 05919000
*        /***********************************************************/  05920000
*        /*                                                  @Y30SSJH*/ 05921000
*        /* POINTER AND MASK USED IN SETTING TEST FOR NAMEDS @Y30SSJH*/ 05922000
*        /*                                                  @Y30SSJH*/ 05923000
*        /***********************************************************/  05924000
*                                                                  1607 05925000
*        DCL                                                       1607 05926000
*          TSTFPLDS PTR(31);                               /*@Y30SSJH*/ 05927000
*                                                                  1607 05928000
*        DCL                                                       1608 05929000
*          NAMEMASK FIXED(15) INIT(2);                     /*@Y30SSJH*/ 05930000
*                                                                  1608 05931000
*        /************************************************************/ 05932000
*        /*                                                          */ 05933000
*        /* MASKS USED TO VERIFY A NON-NULL FIELD IN SETTING UP THE  */ 05934000
*        /* MODEL TABLE                                              */ 05935000
*        /************************************************************/ 05936000
*                                                                  1609 05937000
*        DCL                                                       1609 05938000
*          DATAVAL CHAR(1) BASED;                                  1609 05939000
*                                                                  1609 05940000
*        DCL                                                       1610 05941000
*          KEYFLDLN FIXED(15)BASED;                                1610 05942000
*                                                                  1610 05943000
*        /************************************************************/ 05944000
*        /*                                                  @YL026UG*/ 05945000
*        /* OVERLAY STRUCTURE FOR PAGE ATTR IN THE CATTR FIELD       */ 05946000
*        /*                                                  @YL026UG*/ 05947000
*        /************************************************************/ 05948000
*        DCL                                                       1611 05949000
*          1 CLATTR BASED,                                         1611 05950000
*            2 *         BIT(6),                           /*@Z40WSJH*/ 05951000
*            2 SWAPATTR  BIT(1),                           /*@Z40WSJH*/ 05952000
*            2 PAGEATTR  BIT(1);                           /*@YL026UG*/ 05953000
*        /************************************************************/ 05954000
*        /*                                                          */ 05955000
*        /* ENTRY POINT TO MODELPRC                                  */ 05956000
*        /*                                                          */ 05957000
*        /************************************************************/ 05958000
*                                                                  1612 05959000
*        OLDERID2 = NEWERID2;                                      1612 05960000
         L     @06,@PC00001                                        1612 05961000
         L     @04,GDTTR2(,@06)                                    1612 05962000
         MVC   @TS00001(95),NEWERID2(@04)                          1612 05963000
         MVC   OLDERID2(95,@04),@TS00001                           1612 05964000
*        NEWID2 = 'DE36';                                          1613 05965000
         MVC   NEWID2(4,@04),@CC02997                              1613 05966000
*        MDLTABL = ''B;                                            1614 05967000
         L     @04,@PC00001+8                                      1614 05968000
         L     @04,MDLTBLPT(,@04)                                  1614 05969000
         XC    MDLTABL(132,@04),MDLTABL(@04)                       1614 05970000
*        MDTBPT = ADDR(MODELTAB);                                  1615 05971000
*                                                                  1615 05972000
         L     MDTBPT,@PC00007+36                                  1615 05973000
*        /************************************************************/ 05974000
*        /*                                                          */ 05975000
*        /* GET DYNAMIC STORAGE FOR BUILDING THE CATALOG MANAGEMENT  */ 05976000
*        /* LOCATE INTERFACE                                         */ 05977000
*        /*                                                          */ 05978000
*        /************************************************************/ 05979000
*                                                                  1616 05980000
*        CALL IDCSAGP0 (GDTTBL,                                    1616 05981000
*                ((LENGTH(CTGPL) +76) + ((LENGTH(CTGFL)+8) * 19)), 1616 05982000
*                LOCATPTR,DEGPID,SETZERO);                 /*@Y30SSJH*/ 05983000
*                                                                  1616 05984000
         ST    @06,@AL00001                                        1616 05985000
         LA    @04,560                                             1616 05986000
         ST    @04,@AFTEMPS+16                                     1616 05987000
         LA    @04,@AFTEMPS+16                                     1616 05988000
         ST    @04,@AL00001+4                                      1616 05989000
         LA    @04,LOCATPTR                                        1616 05990000
         ST    @04,@AL00001+8                                      1616 05991000
         LA    @04,DEGPID                                          1616 05992000
         ST    @04,@AL00001+12                                     1616 05993000
         LA    @04,SETZERO                                         1616 05994000
         ST    @04,@AL00001+16                                     1616 05995000
         MVI   @AL00001+16,X'80'                                   1616 05996000
         L     @15,GDTGPL(,@06)                                    1616 05997000
         LA    @01,@AL00001                                        1616 05998000
         BALR  @14,@15                                             1616 05999000
*        RESPECIFY RTNREG RSTD;                                    1617 06000000
*        TESTRC = RTNREG;                                          1618 06001000
         LR    TESTRC,RTNREG                                       1618 06002000
*        RESPECIFY RTNREG UNRSTD;                                  1619 06003000
*        IF TESTRC ^= 0                                            1620 06004000
*          THEN                                                    1620 06005000
         LTR   TESTRC,TESTRC                                       1620 06006000
         BZ    @RF01620                                            1620 06007000
*            DO;                                                   1621 06008000
*                                                                  1621 06009000
*            DEFSTID = NOSTORAG;                                   1622 06010000
         L     @06,@PC00001+8                                      1622 06011000
         MVC   DEFSTID(5,@06),@CB02317                             1622 06012000
*            RETURN;                                               1623 06013000
*                                                                  1623 06014000
@EL00007 L     @13,4(,@13)                                         1623 06015000
@EF00007 DS    0H                                                  1623 06016000
@ER00007 LM    @14,@12,12(@13)                                     1623 06017000
         BR    @14                                                 1623 06018000
*            END;                                                  1624 06019000
*        /************************************************************/ 06020000
*        /*                                                          */ 06021000
*        /* BUILD CATALOG PARAMETER LIST (CPL) - INTERFACE TO VSAM   */ 06022000
*        /* CATALOG MANAGEMENT FOR LOCATE                            */ 06023000
*        /*                                                          */ 06024000
*        /************************************************************/ 06025000
*                                                                  1625 06026000
*        RFY CTGPL BASED(LOCATPTR);    /* RESPECIFY BASE OF CTGPL    */ 06027000
@RF01620 DS    0H                                                  1626 06028000
*        CTGFUNC = CTGLOC;                                         1626 06029000
         L     @08,LOCATPTR                                        1626 06030000
         NI    CTGFUNC(@08),B'00111111'                            1626 06031000
         OI    CTGFUNC(@08),B'00100000'                            1626 06032000
*        CTGAM0 = ON;                                              1627 06033000
*        CTGSRH = OFF;                                             1628 06034000
*        CTGNUM = ON;                                              1629 06035000
*                                                                  1629 06036000
         OI    CTGAM0(@08),B'00000011'                             1629 06037000
         NI    CTGSRH(@08),B'11111011'                             1629 06038000
*        /************************************************************/ 06039000
*        /*                                                          */ 06040000
*        /* SETCTCNAME & CTGENT TO INDICATE IF THIS IS A LOCAT OF    */ 06041000
*        /* AN ENTRYNAME OR AN ENTRYID                               */ 06042000
*        /*                                                          */ 06043000
*        /************************************************************/ 06044000
*                                                                  1630 06045000
*        IF (ADDR(ENAM)) ^= NULLPTR                                1630 06046000
*          THEN                                                    1630 06047000
         L     @06,@PC00007                                        1630 06048000
         LTR   @06,@06                                             1630 06049000
         BZ    @RF01630                                            1630 06050000
*            DO;                                                   1631 06051000
*                                                                  1631 06052000
*            FDTTBLPT = ADDR(ENAM);                                1632 06053000
         LR    FDTTBLPT,@06                                        1632 06054000
*            CTGNAME = ON;                                         1633 06055000
*                                                                  1633 06056000
         OI    CTGNAME(@08),B'00000100'                            1633 06057000
*            IF NAMFUQ = ON                                        1634 06058000
*              THEN                                                1634 06059000
         TM    NAMFUQ(FDTTBLPT),B'10000000'                        1634 06060000
         BNO   @RF01634                                            1634 06061000
*                /****************************************************/ 06062000
*                /*                                          @YL026UG*/ 06063000
*                /* THE NAME OF THE MODEL IS UNQUOTED, ISSUE @YL026UG*/ 06064000
*                /* UQUAL MACRO FOR POSSIBLE QUALIFICATION   @YL026UG*/ 06065000
*                /* OF THE NAME, THIS IS DONE IN TSO ONLY    @YL026UG*/ 06066000
*                /*                                          @YL026UG*/ 06067000
*                /****************************************************/ 06068000
*QQUAL02:        DO;                                       /*@YL026UG*/ 06069000
*                                                                  1635 06070000
QQUAL02  DS    0H                                                  1636 06071000
*                QDSNPTR = ADDR(NAMVAL);                   /*@YL026UG*/ 06072000
         LA    @08,NAMVAL(,FDTTBLPT)                               1636 06073000
         ST    @08,QDSNPTR                                         1636 06074000
*                QDSNLEN = NAMLEN;                         /*@YL026UG*/ 06075000
*                                                                  1637 06076000
         SLR   @08,@08                                             1637 06077000
         IC    @08,NAMLEN(,FDTTBLPT)                               1637 06078000
         STH   @08,QDSNLEN                                         1637 06079000
*                IF (ADDR(CAT)) ^= NULLPTR                         1638 06080000
*                  THEN                                            1638 06081000
         L     @08,@PC00001+4                                      1638 06082000
         L     @06,FDTPTR(,@08)                                    1638 06083000
         LTR   @06,@06                                             1638 06084000
         BZ    @RF01638                                            1638 06085000
*                    DO;                                   /*@YL026UG*/ 06086000
*                                                                  1639 06087000
*                    QCATPTR = ADDR(CATLGVAL);             /*@YL026UG*/ 06088000
*                                                                  1640 06089000
         L     @08,FDTPTR+4(,@08)                                  1640 06090000
         LA    @06,CATLGVAL(,@08)                                  1640 06091000
         ST    @06,QCATPTR                                         1640 06092000
*                    IF CATLGPLN ^= 0                              1641 06093000
*                      THEN                                        1641 06094000
         CLI   CATLGPLN(@08),0                                     1641 06095000
         BE    @RF01641                                            1641 06096000
*                        QCATPSWD = ADDR(CATLGPAS);        /*@YL026UG*/ 06097000
*                                                                  1642 06098000
         LA    @08,CATLGPAS(,@08)                                  1642 06099000
         ST    @08,QCATPSWD                                        1642 06100000
*                    END;                                  /*@YL026UG*/ 06101000
*                                                                  1643 06102000
*                  ELSE                                            1644 06103000
*                    DO;                                   /*@YL026UG*/ 06104000
*                                                                  1644 06105000
         B     @RC01638                                            1644 06106000
@RF01638 DS    0H                                                  1645 06107000
*                    QCATPTR = NULLPTR;                    /*@YL026UG*/ 06108000
         SLR   @08,@08                                             1645 06109000
         ST    @08,QCATPTR                                         1645 06110000
*                    QCATPSWD = NULLPTR;                   /*@YL026UG*/ 06111000
*                                                                  1646 06112000
         ST    @08,QCATPSWD                                        1646 06113000
*                    END;                                  /*@YL026UG*/ 06114000
*                                                                  1647 06115000
*                CALL IDCSAQL0 (GDTTBL,                            1648 06116000
*                  QDSNPTR,            /* PTR TO DSNAME      @YL026UG*/ 06117000
*                  QDSNLEN,            /* LENGTH OF DSNAME   @YL026UG*/ 06118000
*                  QCATPTR,            /* PTR TO CAT NAME    @YL026UG*/ 06119000
*                  QCATPSWD);          /* PTR TO CAT PASWD   @YL026UG*/ 06120000
*                                                                  1648 06121000
@RC01638 L     @06,@PC00001                                        1648 06122000
         ST    @06,@AL00001                                        1648 06123000
         LA    @15,QDSNPTR                                         1648 06124000
         ST    @15,@AL00001+4                                      1648 06125000
         LA    @15,QDSNLEN                                         1648 06126000
         ST    @15,@AL00001+8                                      1648 06127000
         LA    @15,QCATPTR                                         1648 06128000
         ST    @15,@AL00001+12                                     1648 06129000
         LA    @15,QCATPSWD                                        1648 06130000
         ST    @15,@AL00001+16                                     1648 06131000
         MVI   @AL00001+16,X'80'                                   1648 06132000
         L     @15,GDTQAL(,@06)                                    1648 06133000
         LA    @01,@AL00001                                        1648 06134000
         BALR  @14,@15                                             1648 06135000
*                RESPECIFY RTNREG RSTD;                            1649 06136000
*                TESTRC = RTNREG;                                  1650 06137000
         LR    TESTRC,RTNREG                                       1650 06138000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UG*/ 06139000
*                                                                  1651 06140000
*                IF TESTRC ^= 0                                    1652 06141000
*                  THEN                                            1652 06142000
         LTR   TESTRC,TESTRC                                       1652 06143000
         BZ    @RF01652                                            1652 06144000
*                    DO;                                   /*@YL026UG*/ 06145000
*                                                                  1653 06146000
*                    DEFSTID = TERMERR;                    /*@YL026UG*/ 06147000
         L     @06,@PC00001+8                                      1654 06148000
         MVC   DEFSTID(5,@06),@CB02326                             1654 06149000
*                    RETURN;                               /*@YL026UG*/ 06150000
*                                                                  1655 06151000
         B     @EL00007                                            1655 06152000
*                    END;                                  /*@YL026UG*/ 06153000
*                END QQUAL02;                              /*@YL026UG*/ 06154000
*                                                                  1657 06155000
@RF01652 DS    0H                                                  1658 06156000
*            CTGENT = ADDR(NAMVAL);                                1658 06157000
*                                                                  1658 06158000
@RF01634 LA    @08,NAMVAL(,FDTTBLPT)                               1658 06159000
         L     @06,LOCATPTR                                        1658 06160000
         ST    @08,CTGENT(,@06)                                    1658 06161000
*            END;                                                  1659 06162000
*                                                                  1659 06163000
*          ELSE                                                    1660 06164000
*            DO;                                                   1660 06165000
*                                                                  1660 06166000
         B     @RC01630                                            1660 06167000
@RF01630 DS    0H                                                  1661 06168000
*            CTGNAME = OFF;                                        1661 06169000
         L     @08,LOCATPTR                                        1661 06170000
         NI    CTGNAME(@08),B'11111011'                            1661 06171000
*            CTGENT = ADDR(ASCNAME);                               1662 06172000
*                                                                  1662 06173000
         L     @06,@PC00007+28                                     1662 06174000
         ST    @06,CTGENT(,@08)                                    1662 06175000
*            END;                                                  1663 06176000
*                                                                  1663 06177000
*        /************************************************************/ 06178000
*        /*                                                          */ 06179000
*        /* IDENTIFY THE CATALOG IN WHICH THE MODEL ENTRY RESIDES -  */ 06180000
*        /* THREE METHODS OF EXPRESSING EXIST:                       */ 06181000
*        /*  CATLG NAME(MDLCATNM),ACB OF CATALOG(MDLACBPT) OR DEFAULT*/ 06182000
*        /*  (STEPCAT,JOBCAT,MASTER)                                 */ 06183000
*        /*                                                          */ 06184000
*        /************************************************************/ 06185000
*                                                                  1664 06186000
*        IF MDLACBPT = NULLPTR                                     1664 06187000
*          THEN                                                    1664 06188000
@RC01630 SLR   @08,@08                                             1664 06189000
         L     @06,@PC00007+32                                     1664 06190000
         C     @08,MDLACBPT(,@06)                                  1664 06191000
         BNE   @RF01664                                            1664 06192000
*            DO;                                                   1665 06193000
*                                                                  1665 06194000
*            /********************************************************/ 06195000
*            /*                                                      */ 06196000
*            /* SET CTGCAT POINTER TO CATALOG NAME                   */ 06197000
*            /*                                                      */ 06198000
*            /********************************************************/ 06199000
*                                                                  1666 06200000
*            IF (ADDR(MDCT)) ^= NULLPTR                            1666 06201000
*              THEN                                                1666 06202000
         L     @06,@PC00007+12                                     1666 06203000
         CR    @06,@08                                             1666 06204000
         BE    @RF01666                                            1666 06205000
*                DO;                                               1667 06206000
*                                                                  1667 06207000
*                FDTTBLPT = ADDR(MDCT);                            1668 06208000
         LR    FDTTBLPT,@06                                        1668 06209000
*                CTGCAT = ADDR(NAMVAL);                            1669 06210000
         L     @08,LOCATPTR                                        1669 06211000
         LA    @06,NAMVAL(,FDTTBLPT)                               1669 06212000
         ST    @06,CTGCAT(,@08)                                    1669 06213000
*                CTGCNAME = ON;                                    1670 06214000
*                                                                  1670 06215000
         OI    CTGCNAME(@08),B'00000010'                           1670 06216000
*                END;                                              1671 06217000
*                                                                  1671 06218000
*              /******************************************************/ 06219000
*              /*                                                    */ 06220000
*              /* SET CTGCAT POINTER TO NULLPTR                      */ 06221000
*              /*                                                    */ 06222000
*              /******************************************************/ 06223000
*                                                                  1672 06224000
*              ELSE                                                1672 06225000
*                DO;                                               1672 06226000
*                                                                  1672 06227000
         B     @RC01666                                            1672 06228000
@RF01666 DS    0H                                                  1673 06229000
*                CTGCAT = NULLPTR;                                 1673 06230000
         L     @08,LOCATPTR                                        1673 06231000
         SLR   @06,@06                                             1673 06232000
         ST    @06,CTGCAT(,@08)                                    1673 06233000
*                CTGCNAME = ON;                                    1674 06234000
*                                                                  1674 06235000
         OI    CTGCNAME(@08),B'00000010'                           1674 06236000
*                END;                                              1675 06237000
*                                                                  1675 06238000
*            END;                                                  1676 06239000
*                                                                  1676 06240000
*          /**********************************************************/ 06241000
*          /*                                                        */ 06242000
*          /* SET CTGCAT TO CATALOG ACB ADDRESS                      */ 06243000
*          /*                                                        */ 06244000
*          /**********************************************************/ 06245000
*                                                                  1677 06246000
*          ELSE                                                    1677 06247000
*            DO;                                                   1677 06248000
*                                                                  1677 06249000
         B     @RC01664                                            1677 06250000
@RF01664 DS    0H                                                  1678 06251000
*            CTGCNAME = OFF;                                       1678 06252000
         L     @08,LOCATPTR                                        1678 06253000
         NI    CTGCNAME(@08),B'11111101'                           1678 06254000
*            CTGCAT = MDLACBPT;                            /*@Y30SSJH*/ 06255000
*                                                                  1679 06256000
         L     @06,@PC00007+32                                     1679 06257000
         L     @06,MDLACBPT(,@06)                                  1679 06258000
         ST    @06,CTGCAT(,@08)                                    1679 06259000
*            END;                                                  1680 06260000
*                                                                  1680 06261000
*        /************************************************************/ 06262000
*        /*                                                          */ 06263000
*        /* DENOTE PASSWORD IN CPL                                   */ 06264000
*        /* THE CATALOG PASSWORD OF THE MODEL PARAMETER OVERRIDES    */ 06265000
*        /* THE ENTRY PASSWORD WHEN BOTH ARE SPECIFIED               */ 06266000
*        /*                                                          */ 06267000
*        /************************************************************/ 06268000
*                                                                  1681 06269000
*        IF (ADDR(MDCT)) ^= NULLPTR                                1681 06270000
*                                                                  1681 06271000
*          /**********************************************************/ 06272000
*          /*                                                        */ 06273000
*          /* INITIALIZE PASSWORD WITH THE CATALOG PASSWORD          */ 06274000
*          /*                                                        */ 06275000
*          /**********************************************************/ 06276000
*          THEN                                                    1681 06277000
@RC01664 SLR   @08,@08                                             1681 06278000
         L     @06,@PC00007+12                                     1681 06279000
         CR    @06,@08                                             1681 06280000
         BE    @RF01681                                            1681 06281000
*            IF MDCTPLN ^= 0                                       1682 06282000
*              THEN                                                1682 06283000
         L     @06,@PC00007+16                                     1682 06284000
         C     @08,MDCTPLN(,@06)                                   1682 06285000
         BE    @RF01682                                            1682 06286000
*                CTGPSWD = ADDR(MDCTPAS);                          1683 06287000
*                                                                  1683 06288000
         L     @08,@PC00007+20                                     1683 06289000
         L     @06,LOCATPTR                                        1683 06290000
         ST    @08,CTGPSWD(,@06)                                   1683 06291000
*              ELSE;                                               1684 06292000
*                                                                  1684 06293000
@RF01682 DS    0H                                                  1685 06294000
*        /************************************************************/ 06295000
*        /*                                                          */ 06296000
*        /* CHECK TO SEE IF CTGPSWD IS SET IF NOT AND THERE IS AN    */ 06297000
*        /* ENTRY PASSWORD-INITIALIZE THE PASSWORD POINTER IN THE CPL*/ 06298000
*        /*                                                          */ 06299000
*        /************************************************************/ 06300000
*                                                                  1685 06301000
*        IF CTGPSWD = NULLPTR  &                                   1685 06302000
*           ENAMPLN ^= 0                                           1685 06303000
*            THEN                                                  1685 06304000
@RF01681 SLR   @08,@08                                             1685 06305000
         L     @06,LOCATPTR                                        1685 06306000
         C     @08,CTGPSWD(,@06)                                   1685 06307000
         BNE   @RF01685                                            1685 06308000
         L     @04,@PC00007+4                                      1685 06309000
         C     @08,ENAMPLN(,@04)                                   1685 06310000
         BE    @RF01685                                            1685 06311000
*              CTGPSWD = ADDR(ENAMPAS);                            1686 06312000
*                                                                  1686 06313000
         L     @08,@PC00007+8                                      1686 06314000
         ST    @08,CTGPSWD(,@06)                                   1686 06315000
*        /************************************************************/ 06316000
*        /*                                                          */ 06317000
*        /* CONSTRUCT AND CHAIN THE FPLS TO THE CPL - THE FPLS       */ 06318000
*        /* INDICATE TO CATALOG MANAGEMENT WHICH FIELDS ARE TO BE    */ 06319000
*        /* LOCATED                                                  */ 06320000
*        /*                                                          */ 06321000
*        /************************************************************/ 06322000
*                                                                  1687 06323000
*        CTGFLPTR = LOCATPTR + LENGTH(CTGPL) + 76;         /*@Y30SSJH*/ 06324000
*                                                                  1687 06325000
@RF01685 LA    CTGFLPTR,104                                        1687 06326000
         AL    CTGFLPTR,LOCATPTR                                   1687 06327000
*        DO N = 1 TO 17;                                   /*@Y30SSJH*/ 06328000
*                                                                  1688 06329000
         LA    N,1                                                 1688 06330000
@DL01688 DS    0H                                                  1689 06331000
*        CTGFLDNO = 1;                                             1689 06332000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1689 06333000
*        CTGFLDNM = ADDR(MDLNMTAB(N));                             1690 06334000
         LR    @08,N                                               1690 06335000
         SLA   @08,3                                               1690 06336000
         LA    @08,MDLNMTAB-8(@08)                                 1690 06337000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             1690 06338000
*        CTGFIELD(N) = CTGFLPTR;                                   1691 06339000
         LR    @08,N                                               1691 06340000
         SLA   @08,2                                               1691 06341000
         L     @06,LOCATPTR                                        1691 06342000
         ST    CTGFLPTR,CTGFIELD-4(@08,@06)                        1691 06343000
*        CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL)+8);                  1692 06344000
*                                                                  1692 06345000
         AL    CTGFLPTR,@CF00311                                   1692 06346000
*        END;                                                      1693 06347000
*                                                                  1693 06348000
         AL    N,@CF00220                                          1693 06349000
         C     N,@CF00646                                          1693 06350000
         BNH   @DL01688                                            1693 06351000
*        CTGNOFLD = 17;                                    /*@Y30SSJH*/ 06352000
*                                                                  1694 06353000
         L     @08,LOCATPTR                                        1694 06354000
         MVI   CTGNOFLD(@08),X'11'                                 1694 06355000
*        /************************************************************/ 06356000
*        /*                                                          */ 06357000
*        /* BUILD TEST FPL FOR VOLSER FPL, THIS GUARANTEES THAT      */ 06358000
*        /* VOLUMES RETURNED AT THE INDEX LEVEL ARE NOT DATA VOLUMES */ 06359000
*        /* WITH IMBEDDED SEQUENCE SETS                              */ 06360000
*        /* CTGFLPTR IS REFERENCING THE AREA OF THE TEST FPL AS A    */ 06361000
*        /* RESULT OF THE FINAL BUMPING IN THE ABOVE LOOP            */ 06362000
*        /*                                                          */ 06363000
*        /************************************************************/ 06364000
*                                                                  1695 06365000
*        CTGFLDNO = 1;                                             1695 06366000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1695 06367000
*        CTGFLDCD = CTGFLDZ;                                       1696 06368000
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            1696 06369000
*        CTGFLDNM = ADDR(MDLNMTAB(18));                    /*@Y30SSJH*/ 06370000
         LA    @06,MDLNMTAB+136                                    1697 06371000
         ST    @06,CTGFLDNM(,CTGFLPTR)                             1697 06372000
*        CTGFLNG(1) = 1;                                           1698 06373000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00220                        1698 06374000
*        CTGFLPT(1) = ADDR(VOLSMASK);                              1699 06375000
         LA    @06,VOLSMASK                                        1699 06376000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1699 06377000
*        TSTFPLVS = CTGFLPTR;                              /*@Y30SSJH*/ 06378000
*                                                                  1700 06379000
         LR    TSTFPLVS,CTGFLPTR                                   1700 06380000
*        /************************************************************/ 06381000
*        /*                                                  @Y30SSJH*/ 06382000
*        /* BUILD TEST FPL FOR NAMEDS FPL WHICH GUARANTEES   @Y30SSJH*/ 06383000
*        /* THAT NO MORE THAN TWO ASSOCIATIONS ARE RETURNED. @Y30SSJH*/ 06384000
*        /* CTGFLPTR IS STILL REFERENCING THE VOLSER TEST    @Y30SSJH*/ 06385000
*        /* FPL                                              @Y30SSJH*/ 06386000
*        /************************************************************/ 06387000
*                                                                  1701 06388000
*        CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL)+8);          /*@Y30SSJH*/ 06389000
*                                                                  1701 06390000
         AL    CTGFLPTR,@CF00311                                   1701 06391000
*        CTGFLDNO = 1;                                     /*@Y30SSJH*/ 06392000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1702 06393000
*        CTGFLDCD = CTGFLDLE;                              /*@Y30SSJH*/ 06394000
         MVI   CTGFLDCD(CTGFLPTR),X'C0'                            1703 06395000
*        CTGFLDNM = ADDR(MDLNMTAB(19));                    /*@Y30SSJH*/ 06396000
         LA    @06,MDLNMTAB+144                                    1704 06397000
         ST    @06,CTGFLDNM(,CTGFLPTR)                             1704 06398000
*        CTGFLNG(1) = 2;                                   /*@Y30SSJH*/ 06399000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00154                        1705 06400000
*        CTGFLPT(1) = ADDR(NAMEMASK);                      /*@Y30SSJH*/ 06401000
         LA    @06,NAMEMASK                                        1706 06402000
         ST    @06,CTGFLPT(,CTGFLPTR)                              1706 06403000
*        TSTFPLDS = CTGFLPTR;                              /*@Y30SSJH*/ 06404000
*                                                                  1707 06405000
         LR    TSTFPLDS,CTGFLPTR                                   1707 06406000
*        /************************************************************/ 06407000
*        /*                                                  @Y30SSJH*/ 06408000
*        /* CHAIN VOLSER FPL TO ITS TEST FPL                 @Y30SSJH*/ 06409000
*        /*                                                  @Y30SSJH*/ 06410000
*        /************************************************************/ 06411000
*                                                                  1708 06412000
*        CTGFLPTR = LOCATPTR + (LENGTH(CTGPL) + 76) +              1708 06413000
*                   ((LENGTH(CTGFL) + 8) * 6);             /*@Y30SSJH*/ 06414000
         AL    @08,@CF01598                                        1708 06415000
         LR    CTGFLPTR,@08                                        1708 06416000
*        CTGFLCHN = TSTFPLVS;                              /*@Y30SSJH*/ 06417000
*                                                                  1709 06418000
         ST    TSTFPLVS,CTGFLCHN(,CTGFLPTR)                        1709 06419000
*        /************************************************************/ 06420000
*        /*                                                  @Y30SSJH*/ 06421000
*        /* CHAIN THE NAMEDS FPL TO ITS TEST FPL -           @Y30SSJH*/ 06422000
*        /* THE CTGFLPTR IS REFERENCING THE VOLSER FPL       @Y30SSJH*/ 06423000
*        /*                                                  @Y30SSJH*/ 06424000
*        /************************************************************/ 06425000
*                                                                  1710 06426000
*        CTGFLPTR = CTGFLPTR + ((LENGTH(CTGFL) + 8) * 6);  /*@Y30SSJH*/ 06427000
*                                                                  1710 06428000
         AL    CTGFLPTR,@CF01586                                   1710 06429000
*        CTGFLCHN = TSTFPLDS;                              /*@Y30SSJH*/ 06430000
         ST    TSTFPLDS,CTGFLCHN(,CTGFLPTR)                        1711 06431000
*                                                                  1712 06432000
*        /************************************************************/ 06433000
*        /*                                                          */ 06434000
*        /* ISSUE CATALOG LOCATE - LOOP PERMITS REISSUANCE OF LOCATE */ 06435000
*        /* WHEN INITIAL INVOCATION SPECIFIES INSUFFICIENT WORKAREA  */ 06436000
*        /*                                                          */ 06437000
*        /************************************************************/ 06438000
*                                                                  1712 06439000
*        MWKALEN = WKALEN1;                                /*@Y30SSJH*/ 06440000
         MVC   MWKALEN(4),@CF02370                                 1712 06441000
*        MDLOOPCT = 0;                                             1713 06442000
         SLR   MDLOOPCT,MDLOOPCT                                   1713 06443000
*        MDLFLG = GO;                                              1714 06444000
         MVI   MDLFLG,X'00'                                        1714 06445000
*        DO WHILE MDLFLG = GO;                                     1715 06446000
*                                                                  1715 06447000
         B     @DE01715                                            1715 06448000
@DL01715 DS    0H                                                  1716 06449000
*        CALL IDCSAGP0 (GDTTBL,MWKALEN,MDLWKAPT,MDLID,SETZERO);    1716 06450000
         L     @06,@PC00001                                        1716 06451000
         ST    @06,@AL00001                                        1716 06452000
         LA    @04,MWKALEN                                         1716 06453000
         ST    @04,@AL00001+4                                      1716 06454000
         LA    @04,MDLWKAPT                                        1716 06455000
         ST    @04,@AL00001+8                                      1716 06456000
         LA    @04,MDLID                                           1716 06457000
         ST    @04,@AL00001+12                                     1716 06458000
         LA    @04,SETZERO                                         1716 06459000
         ST    @04,@AL00001+16                                     1716 06460000
         MVI   @AL00001+16,X'80'                                   1716 06461000
         L     @15,GDTGPL(,@06)                                    1716 06462000
         LA    @01,@AL00001                                        1716 06463000
         BALR  @14,@15                                             1716 06464000
*        RESPECIFY RTNREG RSTD;                                    1717 06465000
*        TESTRC = RTNREG;                                          1718 06466000
         LR    TESTRC,RTNREG                                       1718 06467000
*        RESPECIFY RTNREG UNRSTD;                                  1719 06468000
*        IF TESTRC ^= 0                                            1720 06469000
*          THEN                                                    1720 06470000
         LTR   TESTRC,TESTRC                                       1720 06471000
         BZ    @RF01720                                            1720 06472000
*            DO;                                                   1721 06473000
*                                                                  1721 06474000
*            MDLFLG = STOP;                                        1722 06475000
         MVI   MDLFLG,X'0F'                                        1722 06476000
*            DEFSTID = NOSTORAG;                                   1723 06477000
         L     @06,@PC00001+8                                      1723 06478000
         MVC   DEFSTID(5,@06),@CB02317                             1723 06479000
*            RETURN;                                               1724 06480000
*                                                                  1724 06481000
         B     @EL00007                                            1724 06482000
*            END;                                                  1725 06483000
*                                                                  1725 06484000
*          ELSE                                                    1726 06485000
*            DO;                                                   1726 06486000
*                                                                  1726 06487000
@RF01720 DS    0H                                                  1727 06488000
*            MDLOOPCT = MDLOOPCT +1;                               1727 06489000
         AL    MDLOOPCT,@CF00220                                   1727 06490000
*            CTGWKA = MDLWKAPT;                                    1728 06491000
         L     @08,MDLWKAPT                                        1728 06492000
         L     @06,LOCATPTR                                        1728 06493000
         ST    @08,CTGWKA(,@06)                                    1728 06494000
*            MDLWKALN = MWKALEN;                                   1729 06495000
*                                                                  1729 06496000
         L     @06,MWKALEN                                         1729 06497000
         STH   @06,MDLWKALN(,@08)                                  1729 06498000
*            CALL IDCSACA0 (GDTTBL,LOCATPTR);                      1730 06499000
*                                                                  1730 06500000
         L     @08,@PC00001                                        1730 06501000
         ST    @08,@AL00001                                        1730 06502000
         LA    @06,LOCATPTR                                        1730 06503000
         ST    @06,@AL00001+4                                      1730 06504000
         L     @15,GDTCAT(,@08)                                    1730 06505000
         LA    @01,@AL00001                                        1730 06506000
         BALR  @14,@15                                             1730 06507000
*            /********************************************************/ 06508000
*            /*                                                      */ 06509000
*            /* CHECK CATALOG RETURN CODES                           */ 06510000
*            /*                                                      */ 06511000
*            /********************************************************/ 06512000
*                                                                  1731 06513000
*            CTGRTNCC = RTNREG;                                    1731 06514000
*                                                                  1731 06515000
         L     @14,@PC00001+8                                      1731 06516000
         ST    RTNREG,CTGRTNCC(,@14)                               1731 06517000
*            IF GDTDBG = NULLPTR                                   1732 06518000
*              THEN;                                               1732 06519000
         L     @08,@PC00001                                        1732 06520000
         L     @08,GDTDBG(,@08)                                    1732 06521000
         LTR   @08,@08                                             1732 06522000
         BZ    @RT01732                                            1732 06523000
*              ELSE                                                1734 06524000
*                CALL IDCDB010 (GDTTBL,'DE03');                    1734 06525000
*                                                                  1734 06526000
         L     @08,@PC00001                                        1734 06527000
         ST    @08,@AL00001                                        1734 06528000
         LA    @06,@CC03001                                        1734 06529000
         ST    @06,@AL00001+4                                      1734 06530000
         MVI   @AL00001+4,X'80'                                    1734 06531000
         L     @15,GDTDBG(,@08)                                    1734 06532000
         LA    @01,@AL00001                                        1734 06533000
         BALR  @14,@15                                             1734 06534000
*            /********************************************************/ 06535000
*            /*                                                      */ 06536000
*            /* SUCCESSFULL COMPLETION GET OUT OF LOOP               */ 06537000
*            /*                                                      */ 06538000
*            /********************************************************/ 06539000
*                                                                  1735 06540000
*            IF CTGRTNCC = 0                                       1735 06541000
*              THEN                                                1735 06542000
@RT01732 L     @08,@PC00001+8                                      1735 06543000
         L     @08,CTGRTNCC(,@08)                                  1735 06544000
         LTR   @08,@08                                             1735 06545000
         BNZ   @RF01735                                            1735 06546000
*                MDLFLG = STOP;                                    1736 06547000
*                                                                  1736 06548000
         MVI   MDLFLG,X'0F'                                        1736 06549000
*              ELSE                                                1737 06550000
*                                                                  1737 06551000
*                /****************************************************/ 06552000
*                /*                                                  */ 06553000
*                /* INSUFFICIENT WORKAREA SIZE - ON FIRST LOCATE     */ 06554000
*                /* INCREASE THE WORKAREA SIZE - IF NOT FIRST LOCATE */ 06555000
*                /* TERMINATE PROCESSING                             */ 06556000
*                /*                                                  */ 06557000
*                /****************************************************/ 06558000
*                                                                  1737 06559000
*                IF CTGRTNCC = 40  &                               1737 06560000
*                   MDLOOPCT < 2                                   1737 06561000
*                  THEN                                            1737 06562000
         B     @RC01735                                            1737 06563000
@RF01735 L     @08,@PC00001+8                                      1737 06564000
         CLC   CTGRTNCC(4,@08),@CF00950                            1737 06565000
         BNE   @RF01737                                            1737 06566000
         C     MDLOOPCT,@CF00154                                   1737 06567000
         BNL   @RF01737                                            1737 06568000
*                    MWKALEN = MDLRQDLN + 8;                       1738 06569000
*                                                                  1738 06570000
         LA    @08,8                                               1738 06571000
         L     @06,MDLWKAPT                                        1738 06572000
         AH    @08,MDLRQDLN(,@06)                                  1738 06573000
         ST    @08,MWKALEN                                         1738 06574000
*                  /**************************************************/ 06575000
*                  /*                                                */ 06576000
*                  /* LOCATE ERROR TERMINATE PROCESSING              */ 06577000
*                  /*                                                */ 06578000
*                  /**************************************************/ 06579000
*                                                                  1739 06580000
*                  ELSE                                            1739 06581000
*                    DO;                                           1739 06582000
*                                                                  1739 06583000
         B     @RC01737                                            1739 06584000
@RF01737 DS    0H                                                  1740 06585000
*                    MDLFLG = STOP;                                1740 06586000
         MVI   MDLFLG,X'0F'                                        1740 06587000
*                    CTGPLPTR = LOCATPTR;                  /*@Y30SSJH*/ 06588000
         L     @06,@PC00001+8                                      1741 06589000
         L     @04,LOCATPTR                                        1741 06590000
         ST    @04,CTGPLPTR(,@06)                                  1741 06591000
*                    DEFSTID = CATERROR;                           1742 06592000
         MVC   DEFSTID(5,@06),@CB02344                             1742 06593000
*                    RETURN;                                       1743 06594000
*                                                                  1743 06595000
         B     @EL00007                                            1743 06596000
*                    END;                                          1744 06597000
*                                                                  1744 06598000
*            END;                                                  1745 06599000
*                                                                  1745 06600000
@RC01737 DS    0H                                                  1745 06601000
@RC01735 DS    0H                                                  1746 06602000
*            END;                                                  1746 06603000
@DE01715 CLI   MDLFLG,X'00'                                        1746 06604000
         BE    @DL01715                                            1746 06605000
*                                                                  1747 06606000
*        /************************************************************/ 06607000
*        /*                                                          */ 06608000
*        /* INITIALIZE MODELTBL VALUES WHICH IS USED TO COMMUNICATE  */ 06609000
*        /* THE LOCATED ATTRIBUTES.                                  */ 06610000
*        /*                                                          */ 06611000
*        /************************************************************/ 06612000
*                                                                  1747 06613000
*        IF DEFSTID = NORMAL                                       1747 06614000
*          THEN                                                    1747 06615000
         L     @08,@PC00001+8                                      1747 06616000
         CLC   DEFSTID(5,@08),@CB02347                             1747 06617000
         BNE   @RF01747                                            1747 06618000
*            DO;                                                   1748 06619000
*                                                                  1748 06620000
*            CTGFLPTR = LOCATPTR + (LENGTH(CTGPL) + 76);   /*@Y30SSJH*/ 06621000
*                                                                  1749 06622000
         LA    CTGFLPTR,104                                        1749 06623000
         AL    CTGFLPTR,LOCATPTR                                   1749 06624000
*            /********************************************************/ 06625000
*            /*                                                      */ 06626000
*            /* VERIFY THAT MODEL ENTYPE IS SAME AS CURRENT          */ 06627000
*            /*                                                      */ 06628000
*            /********************************************************/ 06629000
*                                                                  1750 06630000
*            MDLOTYPE = CTGFLPT(1) -> MDLETYPE;                    1750 06631000
         L     @06,MDLTBLPT(,@08)                                  1750 06632000
         L     @04,CTGFLPT(,CTGFLPTR)                              1750 06633000
         MVC   MDLOTYPE(1,@06),MDLETYPE(@04)                       1750 06634000
*            IF CTGFVTYP ^= MDLOTYPE                               1751 06635000
*              THEN                                                1751 06636000
         L     @04,CTGFVPTR(,@08)                                  1751 06637000
         CLC   CTGFVTYP(1,@04),MDLOTYPE(@06)                       1751 06638000
         BE    @RF01751                                            1751 06639000
*                DO;                                               1752 06640000
*                                                                  1752 06641000
*                DEFSTID = MDLTYPER;                               1753 06642000
         MVC   DEFSTID(5,@08),@CB02341                             1753 06643000
*                RETURN;                                           1754 06644000
*                                                                  1754 06645000
         B     @EL00007                                            1754 06646000
*                END;                                              1755 06647000
*                                                                  1755 06648000
*            /********************************************************/ 06649000
*            /*                                              @YL026UG*/ 06650000
*            /* FOR PAGESPACE - LOOK AT CATTR AND CHECK TO   @YL026UG*/ 06651000
*            /* SEE IF WE HAVE A PAGESPACE                   @YL026UG*/ 06652000
*            /*                                              @YL026UG*/ 06653000
*            /********************************************************/ 06654000
*            IF CTGFIELD(17) -> CTGFLPT(1) ^= NULLPTR              1756 06655000
*              THEN                                                1756 06656000
@RF01751 SLR   @08,@08                                             1756 06657000
         L     @06,LOCATPTR                                        1756 06658000
         L     @06,CTGFIELD+64(,@06)                               1756 06659000
         L     @06,CTGFLPT(,@06)                                   1756 06660000
         CR    @06,@08                                             1756 06661000
         BE    @RF01756                                            1756 06662000
*                IF CTGFIELD(17) -> CTGFLPT(1) -> CLATTR ^= 'FF'X  &    06663000
*                   CTGFIELD(17) -> CTGFLPT(1) -> PAGEATTR = ON    1757 06664000
*                  THEN                                            1757 06665000
         CLI   CLATTR(@06),X'FF'                                   1757 06666000
         BE    @RF01757                                            1757 06667000
         TM    PAGEATTR(@06),B'00000001'                           1757 06668000
         BNO   @RF01757                                            1757 06669000
*                    DO;                                   /*@YL026UG*/ 06670000
*                                                                  1758 06671000
*                    PGSPFLAG = GO;                        /*@YL026UG*/ 06672000
*                                                                  1759 06673000
         L     @04,@PC00001+8                                      1759 06674000
         MVI   PGSPFLAG(@04),X'00'                                 1759 06675000
*                    /************************************************/ 06676000
*                    /*                                      @Z40WSJH*/ 06677000
*                    /* SET SWAPFLAG IF THE PAGESPACE HAS THE        */ 06678000
*                    /* THE SWAP ATTRIBUTE.                  @Z40WSJH*/ 06679000
*                    /*                                      @Z40WSJH*/ 06680000
*                    /************************************************/ 06681000
*                    IF (CTGFIELD(17) -> CTGFLPT(1) -> SWAPATTR = ON  & 06682000
*                        ADDR(PNSWP)  = NULLPTR )                  1760 06683000
*                      THEN                                        1760 06684000
         TM    SWAPATTR(@06),B'00000010'                           1760 06685000
         BNO   @RF01760                                            1760 06686000
         L     @06,@PC00001+4                                      1760 06687000
         C     @08,FDTPTR+996(,@06)                                1760 06688000
         BNE   @RF01760                                            1760 06689000
*                        SWAPFLAG = GO;                    /*@Z40WSJH*/ 06690000
*                                                                  1761 06691000
         MVI   SWAPFLAG(@04),X'00'                                 1761 06692000
*                    /************************************************/ 06693000
*                    /*                                      @YL026UG*/ 06694000
*                    /* THE MODEL IS A PAGESPACE - MAKE SURE @YL026UG*/ 06695000
*                    /* WE ARE DEFINING A PAGESPACE.         @YL026UG*/ 06696000
*                    /*                                      @YL026UG*/ 06697000
*                    /************************************************/ 06698000
*                    IF (ADDR(PGSP)) = NULLPTR                     1762 06699000
*                      THEN                                        1762 06700000
@RF01760 L     @08,@PC00001+4                                      1762 06701000
         L     @08,FDTPTR+24(,@08)                                 1762 06702000
         LTR   @08,@08                                             1762 06703000
         BNZ   @RF01762                                            1762 06704000
*                        DO;                               /*@YL026UG*/ 06705000
*                                                                  1763 06706000
*                        DEFSTID = MDLTYPER;               /*@YL026UG*/ 06707000
         L     @06,@PC00001+8                                      1764 06708000
         MVC   DEFSTID(5,@06),@CB02341                             1764 06709000
*                        RETURN;                           /*@YL026UG*/ 06710000
*                                                                  1765 06711000
         B     @EL00007                                            1765 06712000
*                        END;                              /*@YL026UG*/ 06713000
*                                                                  1766 06714000
*                    END;                                  /*@YL026UG*/ 06715000
*                                                                  1767 06716000
@RF01762 DS    0H                                                  1768 06717000
*            /********************************************************/ 06718000
*            /*                                                      */ 06719000
*            /* LOOP THRU THE FPLS CHECKING FOR VALID RETURN OF DATA */ 06720000
*            /*                                                      */ 06721000
*            /********************************************************/ 06722000
*                                                                  1768 06723000
*            DO N = 1 TO 15;                               /*@Y30SSJH*/ 06724000
*                                                                  1768 06725000
@RF01757 DS    0H                                                  1768 06726000
@RF01756 LA    N,1                                                 1768 06727000
@DL01768 DS    0H                                                  1769 06728000
*            IF CTGFLNG(1) ^= 0                                    1769 06729000
*              THEN                                                1769 06730000
         L     @08,CTGFLNG(,CTGFLPTR)                              1769 06731000
         LTR   @08,@08                                             1769 06732000
         BZ    @RF01769                                            1769 06733000
*                DO;                                               1770 06734000
*                                                                  1770 06735000
*                CKSWITCH = GO;                                    1771 06736000
*                                                                  1771 06737000
         MVI   CKSWITCH,X'00'                                      1771 06738000
*                /****************************************************/ 06739000
*                /*                                                  */ 06740000
*                /* THE FIELD WAS RETURNED - FOR IT TO BE REFERENCED */ 06741000
*                /* IN THE MODEL TABLE IT MUST NOT CONTAIN ALL 'FF'X */ 06742000
*                /*                                                  */ 06743000
*                /****************************************************/ 06744000
*                                                                  1772 06745000
*                DO CKLEN = 1 TO (LENTABLE(N))                     1772 06746000
*                  WHILE CKSWITCH = GO;                            1772 06747000
*                                                                  1772 06748000
         LA    CKLEN,1                                             1772 06749000
         B     @DE01772                                            1772 06750000
@DL01772 CLI   CKSWITCH,X'00'                                      1772 06751000
         BNE   @DC01772                                            1772 06752000
*                IF CTGFLPT(1) -> DATAVAL(CKLEN) ^= 'FF'X          1773 06753000
*                  THEN                                            1773 06754000
         L     @08,CTGFLPT(,CTGFLPTR)                              1773 06755000
         ALR   @08,CKLEN                                           1773 06756000
         BCTR  @08,0                                               1773 06757000
         CLI   DATAVAL(@08),X'FF'                                  1773 06758000
         BE    @RF01773                                            1773 06759000
*                    CKSWITCH = STOP;                              1774 06760000
*                                                                  1774 06761000
         MVI   CKSWITCH,X'0F'                                      1774 06762000
*                END;                                              1775 06763000
*                                                                  1775 06764000
@RF01773 AL    CKLEN,@CF00220                                      1775 06765000
@DE01772 SLR   @08,@08                                             1775 06766000
         IC    @08,LENTABLE-1(N)                                   1775 06767000
         CR    CKLEN,@08                                           1775 06768000
         BNH   @DL01772                                            1775 06769000
@DC01772 DS    0H                                                  1776 06770000
*                /****************************************************/ 06771000
*                /*                                                  */ 06772000
*                /* WE HAVE A VALID FIELD INITIALIZE THE MODEL TABLE */ 06773000
*                /*                                                  */ 06774000
*                /****************************************************/ 06775000
*                                                                  1776 06776000
*                IF CKSWITCH = STOP                                1776 06777000
*                  THEN                                            1776 06778000
         CLI   CKSWITCH,X'0F'                                      1776 06779000
         BNE   @RF01776                                            1776 06780000
*                    DO;                                           1777 06781000
*                                                                  1777 06782000
*                    MDLFLDLN(N) = CTGFLNG(1);                     1778 06783000
         LR    @08,N                                               1778 06784000
         SLA   @08,3                                               1778 06785000
         L     @06,CTGFLNG(,CTGFLPTR)                              1778 06786000
         LR    @04,MDTBPT                                          1778 06787000
         AL    @04,@CF03031                                        1778 06788000
         ST    @06,MDLFLDLN-4(@08,@04)                             1778 06789000
*                    MDLFLDPT(N) = CTGFLPT(1);                     1779 06790000
*                                                                  1779 06791000
         L     @06,CTGFLPT(,CTGFLPTR)                              1779 06792000
         ST    @06,MDLFLDPT-8(@08,MDTBPT)                          1779 06793000
*                    END;                                          1780 06794000
*                                                                  1780 06795000
*                END;                                              1781 06796000
@RF01776 DS    0H                                                  1782 06797000
*            CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL)+8);              1782 06798000
*                                                                  1782 06799000
@RF01769 AL    CTGFLPTR,@CF00311                                   1782 06800000
*            END;                                                  1783 06801000
*                                                                  1783 06802000
         AL    N,@CF00220                                          1783 06803000
         C     N,@CF00229                                          1783 06804000
         BNH   @DL01768                                            1783 06805000
*            END;                                                  1784 06806000
*                                                                  1784 06807000
*        /************************************************************/ 06808000
*        /*                                                  @Y30SSJH*/ 06809000
*        /* MOVE ASSOCIATED NAMES OF CLUSTER, AIX AND        @Y30SSJH*/ 06810000
*        /* USERCATLG TO SAVE AREA FOR FURTHER REFERENCE     @Y30SSJH*/ 06811000
*        /*                                                  @Y30SSJH*/ 06812000
*        /************************************************************/ 06813000
*                                                                  1785 06814000
*        IF CTGFVTYP = 'C'    |                                    1785 06815000
*           CTGFVTYP = 'U'    |                            /*@Y30SSJH*/ 06816000
*           CTGFVTYP = 'G'                                 /*@Y30SSJH*/ 06817000
*          THEN                                                    1785 06818000
*                                                                  1785 06819000
@RF01747 L     @08,@PC00001+8                                      1785 06820000
         L     @08,CTGFVPTR(,@08)                                  1785 06821000
         CLI   CTGFVTYP(@08),C'C'                                  1785 06822000
         BE    @RT01785                                            1785 06823000
         CLI   CTGFVTYP(@08),C'U'                                  1785 06824000
         BE    @RT01785                                            1785 06825000
         CLI   CTGFVTYP(@08),C'G'                                  1785 06826000
         BNE   @RF01785                                            1785 06827000
@RT01785 DS    0H                                                  1786 06828000
*            IF MDLFLDPT(13) ^= NULLPTR                            1786 06829000
*              THEN                                                1786 06830000
         L     @08,MDLFLDPT+96(,MDTBPT)                            1786 06831000
         LTR   @08,@08                                             1786 06832000
         BZ    @RF01786                                            1786 06833000
*                DO;                                       /*@Y30SSJH*/ 06834000
*                                                                  1787 06835000
*                N = MDLFLDLN(13) / 4;                     /*@Y30SSJH*/ 06836000
         L     @00,MDLFLDLN+96(,MDTBPT)                            1788 06837000
         SRDA  @00,32                                              1788 06838000
         D     @00,@CF00043                                        1788 06839000
         LR    N,@01                                               1788 06840000
*                DO LOOP = 1 TO N;                         /*@Y30SSJH*/ 06841000
*                                                                  1789 06842000
         LA    LOOP,1                                              1789 06843000
         B     @DE01789                                            1789 06844000
@DL01789 DS    0H                                                  1790 06845000
*                IF MDLASID(LOOP) = 'D'                            1790 06846000
*                  THEN                                            1790 06847000
         LR    @08,LOOP                                            1790 06848000
         SLA   @08,2                                               1790 06849000
         L     @06,@PC00001+8                                      1790 06850000
         L     @04,MDLTBLPT(,@06)                                  1790 06851000
         L     @04,MDLASNAM(,@04)                                  1790 06852000
         ST    @08,@TF00001                                        1790 06853000
         ALR   @08,@04                                             1790 06854000
         AL    @08,@CF03031                                        1790 06855000
         CLI   MDLASID(@08),C'D'                                   1790 06856000
         BNE   @RF01790                                            1790 06857000
*                    DO;                                   /*@Y30SSJH*/ 06858000
*                                                                  1791 06859000
*                    DASCNMID = 'D';                       /*@Y30SSJH*/ 06860000
         MVI   DASCNMID(@06),C'D'                                  1792 06861000
*                    DASCNAME = MDLASCI(LOOP);             /*@Y30SSJH*/ 06862000
*                                                                  1793 06863000
         AL    @04,@TF00001                                        1793 06864000
         AL    @04,@CF03070                                        1793 06865000
         MVC   DASCNAME(3,@06),MDLASCI-1(@04)                      1793 06866000
*                    END;                                  /*@Y30SSJH*/ 06867000
*                                                                  1794 06868000
*                  ELSE                                            1795 06869000
*                    IF MDLASID(LOOP) = 'I'                        1795 06870000
*                      THEN                                        1795 06871000
         B     @RC01790                                            1795 06872000
@RF01790 LR    @08,LOOP                                            1795 06873000
         SLA   @08,2                                               1795 06874000
         L     @06,@PC00001+8                                      1795 06875000
         L     @06,MDLTBLPT(,@06)                                  1795 06876000
         L     @06,MDLASNAM(,@06)                                  1795 06877000
         ALR   @06,@08                                             1795 06878000
         AL    @06,@CF03031                                        1795 06879000
         CLI   MDLASID(@06),C'I'                                   1795 06880000
         BNE   @RF01795                                            1795 06881000
*                        DO;                               /*@Y30SSJH*/ 06882000
*                                                                  1796 06883000
*                        /********************************************/ 06884000
*                        /*                                  @Y30SSJH*/ 06885000
*                        /* THE DATA SET MODELED IS KSDS - BUT THE   */ 06886000
*                        /* USER SPECIFIED ESDS OR RRDS VIA  @Y30SSJH*/ 06887000
*                        /* THE MODE PARAMETER - TERMINATE   @Y30SSJH*/ 06888000
*                        /* PROCESSING                       @Y30SSJH*/ 06889000
*                        /*                                  @Y30SSJH*/ 06890000
*                        /********************************************/ 06891000
*                                                                  1797 06892000
*                        IF (ADDR(CNIDX)) ^= NULLPTR |     /*@Y30SSJH*/ 06893000
*                           (ADDR(CNUMD)) ^= NULLPTR       /*@Y30SSJH*/ 06894000
*                          THEN                                    1797 06895000
         SLR   @08,@08                                             1797 06896000
         L     @06,@PC00001+4                                      1797 06897000
         C     @08,FDTPTR+96(,@06)                                 1797 06898000
         BNE   @RT01797                                            1797 06899000
         C     @08,FDTPTR+1056(,@06)                               1797 06900000
         BE    @RF01797                                            1797 06901000
@RT01797 DS    0H                                                  1798 06902000
*                            DO;                           /*@Y30SSJH*/ 06903000
*                                                                  1798 06904000
*                            DEFSTID = MDLTYPER;           /*@Y30SSJH*/ 06905000
         L     @06,@PC00001+8                                      1799 06906000
         MVC   DEFSTID(5,@06),@CB02341                             1799 06907000
*                            RETURN;                       /*@Y30SSJH*/ 06908000
*                                                                  1800 06909000
         B     @EL00007                                            1800 06910000
*                            END;                          /*@Y30SSJH*/ 06911000
*                                                                  1801 06912000
*                        /********************************************/ 06913000
*                        /*                                  @Y30SSJH*/ 06914000
*                        /* THE MODEL MATCHES THE MODE SPECIFICATION */ 06915000
*                        /* USE THE MODEL                    @Y30SSJH*/ 06916000
*                        /*                                  @Y30SSJH*/ 06917000
*                        /********************************************/ 06918000
*                                                                  1802 06919000
*                        IASCNMID = 'I';                   /*@Y30SSJH*/ 06920000
@RF01797 L     @08,@PC00001+8                                      1802 06921000
         MVI   IASCNMID(@08),C'I'                                  1802 06922000
*                        IASCNAME = MDLASCI(LOOP);         /*@Y30SSJH*/ 06923000
*                                                                  1803 06924000
         LR    @06,LOOP                                            1803 06925000
         SLA   @06,2                                               1803 06926000
         L     @04,MDLTBLPT(,@08)                                  1803 06927000
         L     @04,MDLASNAM(,@04)                                  1803 06928000
         ALR   @04,@06                                             1803 06929000
         AL    @04,@CF03070                                        1803 06930000
         MVC   IASCNAME(3,@08),MDLASCI-1(@04)                      1803 06931000
*                        END;                              /*@Y30SSJH*/ 06932000
*                                                                  1804 06933000
*                END;                                      /*@Y30SSJH*/ 06934000
@RF01795 DS    0H                                                  1805 06935000
@RC01790 AL    LOOP,@CF00220                                       1805 06936000
@DE01789 CR    LOOP,N                                              1805 06937000
         BNH   @DL01789                                            1805 06938000
*                END;                                      /*@Y30SSJH*/ 06939000
*                                                                  1806 06940000
*              ELSE;                                       /*@Y30SSJH*/ 06941000
*                                                                  1807 06942000
@RF01786 DS    0H                                                  1808 06943000
*                /****************************************************/ 06944000
*                /*                                          @Y30SSJH*/ 06945000
*                /* DONT CONSIDER ASSOCIATED NAMES FOR OBJECTS OTHER */ 06946000
*                /* THAN CLUSTER, AIX OR USER CATALOG        @Y30SSJH*/ 06947000
*                /*                                          @Y30SSJH*/ 06948000
*                /****************************************************/ 06949000
*                                                                  1808 06950000
*                ELSE                                              1808 06951000
*                  DO;                                     /*@Y30SSJH*/ 06952000
*                                                                  1808 06953000
         B     @RC01785                                            1808 06954000
@RF01785 DS    0H                                                  1809 06955000
*                  MDLFLDLN(13) = 0;                       /*@Y30SSJH*/ 06956000
         SLR   @08,@08                                             1809 06957000
         ST    @08,MDLFLDLN+96(,MDTBPT)                            1809 06958000
*                  MDLFLDPT(13) = 0;                       /*@Y30SSJH*/ 06959000
*                                                                  1810 06960000
         ST    @08,MDLFLDPT+96(,MDTBPT)                            1810 06961000
*                  END;                                    /*@Y30SSJH*/ 06962000
*                                                                  1811 06963000
*        /************************************************************/ 06964000
*        /*                                                  @Y30SSJH*/ 06965000
*        /* SAVE THE CATALOG ACB FOR FUTURE REFERENCE.       @Y30SSJH*/ 06966000
*        /*                                                  @Y30SSJH*/ 06967000
*        /************************************************************/ 06968000
*        IF MDLACBPT = NULLPTR   &                                 1812 06969000
*           MDLFLDLN(2) ^= NULLPTR                                 1812 06970000
*          THEN                                                    1812 06971000
@RC01785 SLR   @08,@08                                             1812 06972000
         L     @06,@PC00007+32                                     1812 06973000
         C     @08,MDLACBPT(,@06)                                  1812 06974000
         BNE   @RF01812                                            1812 06975000
         C     @08,MDLFLDLN+8(,MDTBPT)                             1812 06976000
         BE    @RF01812                                            1812 06977000
*            MDLACBPT = ADDR(MDLFLDPT(2) -> MDLCACB);      /*@ZA15657*/ 06978000
         L     @08,MDLFLDPT+8(,MDTBPT)                             1813 06979000
         ST    @08,MDLACBPT(,@06)                                  1813 06980000
*        /************************************************************/ 06981000
*        /*                                                          */ 06982000
*        /* PASSWALL IS INTERROGATED SEPARATELY TO DETERMINE 1 OF 3  */ 06983000
*        /* CONDITIONS:                                              */ 06984000
*        /*    1- NO PASSWALL INITIALIZATION                         */ 06985000
*        /*    2- PASSWORD SUPPRESSION - TERMINAL ERROR              */ 06986000
*        /*    3- PASSWALL OCCURRENCE                                */ 06987000
*        /*                                                          */ 06988000
*        /************************************************************/ 06989000
*                                                                  1814 06990000
*        ARITHX = ((LENGTH(CTGFL) + 8) * 15);              /*@Y30SSJH*/ 06991000
@RF01812 LA    ARITHX,360                                          1814 06992000
*        CTGFLPTR = LOCATPTR + (LENGTH(CTGPL) + 76) + ARITHX;      1815 06993000
*                                                                  1815 06994000
         LA    CTGFLPTR,104                                        1815 06995000
         AL    CTGFLPTR,LOCATPTR                                   1815 06996000
         ALR   CTGFLPTR,ARITHX                                     1815 06997000
*        /************************************************************/ 06998000
*        /*                                                          */ 06999000
*        /* DOES OCCURRENCE EXIST                                    */ 07000000
*        /*                                                          */ 07001000
*        /************************************************************/ 07002000
*                                                                  1816 07003000
*        IF CTGFLNG(1) ^= 0                                        1816 07004000
*          THEN                                                    1816 07005000
         SLR   @08,@08                                             1816 07006000
         L     @06,CTGFLNG(,CTGFLPTR)                              1816 07007000
         CR    @06,@08                                             1816 07008000
         BE    @RF01816                                            1816 07009000
*            DO;                                                   1817 07010000
*                                                                  1817 07011000
*            /********************************************************/ 07012000
*            /*                                                      */ 07013000
*            /*        HAVE PASSWORDS BEEN SUPPRESSED                */ 07014000
*            /* SET PSWDWARN TO STOP TO CAUSE WARNING MESSAGE TO BE  */ 07015000
*            /* ISSUED WHICH DESCRIBES THIS CONDITION                */ 07016000
*            /*                                                      */ 07017000
*            /********************************************************/ 07018000
*                                                                  1818 07019000
*            IF CTGFLNG(1) = 1   &                                 1818 07020000
*               CTGFLPT(1) = 0                                     1818 07021000
*              THEN                                                1818 07022000
         C     @06,@CF00220                                        1818 07023000
         BNE   @RF01818                                            1818 07024000
         C     @08,CTGFLPT(,CTGFLPTR)                              1818 07025000
         BNE   @RF01818                                            1818 07026000
*                DO;                                               1819 07027000
*                                                                  1819 07028000
*                MDLFLDLN(16) = 0;                         /*@Y30SSJH*/ 07029000
         ST    @08,MDLFLDLN+120(,MDTBPT)                           1820 07030000
*                MDLFLDPT(16) = NULLPTR;                   /*@Y30SSJH*/ 07031000
         ST    @08,MDLFLDPT+120(,MDTBPT)                           1821 07032000
*                PSWDWARN = STOP;                                  1822 07033000
*                                                                  1822 07034000
         L     @08,@PC00001+8                                      1822 07035000
         MVI   PSWDWARN(@08),X'0F'                                 1822 07036000
*                END;                                              1823 07037000
*                                                                  1823 07038000
*              ELSE                                                1824 07039000
*                DO;                                               1824 07040000
*                                                                  1824 07041000
         B     @RC01818                                            1824 07042000
@RF01818 DS    0H                                                  1825 07043000
*                MDLFLDLN(16) = CTGFLNG(1);                /*@Y30SSJH*/ 07044000
         L     @08,CTGFLNG(,CTGFLPTR)                              1825 07045000
         ST    @08,MDLFLDLN+120(,MDTBPT)                           1825 07046000
*                MDLFLDPT(16) = CTGFLPT(1);                /*@Y30SSJH*/ 07047000
*                                                                  1826 07048000
         L     @08,CTGFLPT(,CTGFLPTR)                              1826 07049000
         ST    @08,MDLFLDPT+120(,MDTBPT)                           1826 07050000
*                END;                                              1827 07051000
*                                                                  1827 07052000
*            END;                                                  1828 07053000
*                                                                  1828 07054000
@RC01818 DS    0H                                                  1829 07055000
*        /************************************************************/ 07056000
*        /*                                                          */ 07057000
*        /* LOW AND HIGH KEY RANGE VALUES FOR A KEY RANGE DATA SET   */ 07058000
*        /* ARE INTERROGATED SEPARATELY - DUE TO THE WAY VARIABLE    */ 07059000
*        /* LENGTH FIELDS ARE RETURNED BY LOCATE. FIRST VERIFY THAT  */ 07060000
*        /* THE LENGTH FIELD IN THE RESPECTIVE LOW AND HIGH KEY FPL  */ 07061000
*        /* ARE NON ZERO.                                            */ 07062000
*        /*                                                          */ 07063000
*        /************************************************************/ 07064000
*                                                                  1829 07065000
*        IF CTGFIELD(8) -> CTGFLNG(1) ^= 0 &                       1829 07066000
*           CTGFIELD(9) -> CTGFLNG(1) ^= 0                         1829 07067000
*          THEN                                                    1829 07068000
*                                                                  1829 07069000
@RF01816 SLR   @08,@08                                             1829 07070000
         L     @06,LOCATPTR                                        1829 07071000
         L     @04,CTGFIELD+28(,@06)                               1829 07072000
         L     @15,CTGFLNG(,@04)                                   1829 07073000
         CR    @15,@08                                             1829 07074000
         BE    @RF01829                                            1829 07075000
         L     @06,CTGFIELD+32(,@06)                               1829 07076000
         L     @14,CTGFLNG(,@06)                                   1829 07077000
         CR    @14,@08                                             1829 07078000
         BE    @RF01829                                            1829 07079000
*            /********************************************************/ 07080000
*            /*                                                      */ 07081000
*            /* NOW MAKE SURE THAT THE DATA REFERENCED BY THE FPL IS */ 07082000
*            /* NON-ZERO. THIS IS DONE BY CHECKING THE FIRST TWO     */ 07083000
*            /* BYTES REFERENCED BY CTGFLPT.                         */ 07084000
*            /*                                                      */ 07085000
*            /********************************************************/ 07086000
*                                                                  1830 07087000
*            IF CTGFIELD(8) -> CTGFLPT(1) -> KEYFLDLN ^= 0 &       1830 07088000
*               CTGFIELD(9) -> CTGFLPT(1) -> KEYFLDLN ^= 0         1830 07089000
*              THEN                                                1830 07090000
*                                                                  1830 07091000
         L     @04,CTGFLPT(,@04)                                   1830 07092000
         CH    @08,KEYFLDLN(,@04)                                  1830 07093000
         BE    @RF01830                                            1830 07094000
         L     @06,CTGFLPT(,@06)                                   1830 07095000
         CH    @08,KEYFLDLN(,@06)                                  1830 07096000
         BE    @RF01830                                            1830 07097000
*                /****************************************************/ 07098000
*                /*                                                  */ 07099000
*                /* WE HAVE A KEY RANGE DATA SET BUILD THE MODEL     */ 07100000
*                /* TABLE ENTRIES                                    */ 07101000
*                /*                                                  */ 07102000
*                /****************************************************/ 07103000
*                DO;                                               1831 07104000
*                                                                  1831 07105000
*                MDLFLDLN(8) = CTGFIELD(8) -> CTGFLNG(1);          1832 07106000
         ST    @15,MDLFLDLN+56(,MDTBPT)                            1832 07107000
*                MDLFLDPT(8) = CTGFIELD(8) -> CTGFLPT(1);          1833 07108000
*                                                                  1833 07109000
         ST    @04,MDLFLDPT+56(,MDTBPT)                            1833 07110000
*                MDLFLDLN(9) = CTGFIELD(9) -> CTGFLNG(1);          1834 07111000
         ST    @14,MDLFLDLN+64(,MDTBPT)                            1834 07112000
*                MDLFLDPT(9) = CTGFIELD(9) -> CTGFLPT(1);          1835 07113000
*                                                                  1835 07114000
         ST    @06,MDLFLDPT+64(,MDTBPT)                            1835 07115000
*                END;                                              1836 07116000
*                                                                  1836 07117000
*        /************************************************************/ 07118000
*        /*                                                  @YL026UG*/ 07119000
*        /* ADJUST THE MODEL TABLE IS A PAGESPACE IS BEING   @YL026UG*/ 07120000
*        /* MODELED TO PREVENT ATTRIBUTES CARRIED IN CATALOG @YL026UG*/ 07121000
*        /* BUT NONDEFINEABLE FROM BEING SET IN DEFINE REQUEST       */ 07122000
*        /*                                                  @YL026UG*/ 07123000
*        /************************************************************/ 07124000
*        IF PGSPFLAG = GO                                          1837 07125000
*          THEN                                                    1837 07126000
@RF01830 DS    0H                                                  1837 07127000
@RF01829 L     @08,@PC00001+8                                      1837 07128000
         CLI   PGSPFLAG(@08),X'00'                                 1837 07129000
         BNE   @RF01837                                            1837 07130000
*            DO;                                           /*@YL026UG*/ 07131000
*                                                                  1838 07132000
*            MDLFLDPT(11) = NULLPTR;                       /*@YL026UG*/ 07133000
         SLR   @08,@08                                             1839 07134000
         ST    @08,MDLFLDPT+80(,MDTBPT)                            1839 07135000
*            MDLFLDPT(12) = NULLPTR;                       /*@YL026UG*/ 07136000
*                                                                  1840 07137000
         ST    @08,MDLFLDPT+88(,MDTBPT)                            1840 07138000
*            END;                                          /*@YL026UG*/ 07139000
*                                                                  1841 07140000
*        /************************************************************/ 07141000
*        /*                                                          */ 07142000
*        /* MODELING IS COMPLETE - RETURN TO INVOKER                 */ 07143000
*        /*                                                          */ 07144000
*        /************************************************************/ 07145000
*                                                                  1842 07146000
*        RFY CTGPL BASED(CTGPLPTR);    /* RESET CTGPL BASE FOR DEFINE*/ 07147000
@RF01837 DS    0H                                                  1843 07148000
*        IF GDTDBG = NULLPTR                                       1843 07149000
*          THEN;                                                   1843 07150000
         L     @06,@PC00001                                        1843 07151000
         L     @06,GDTDBG(,@06)                                    1843 07152000
         LTR   @06,@06                                             1843 07153000
         BZ    @RT01843                                            1843 07154000
*          ELSE                                                    1845 07155000
*            CALL IDCDB010(GDTTBL,'DE04');                         1845 07156000
         L     @06,@PC00001                                        1845 07157000
         ST    @06,@AL00001                                        1845 07158000
         LA    @04,@CC03003                                        1845 07159000
         ST    @04,@AL00001+4                                      1845 07160000
         MVI   @AL00001+4,X'80'                                    1845 07161000
         L     @15,GDTDBG(,@06)                                    1845 07162000
         LA    @01,@AL00001                                        1845 07163000
         BALR  @14,@15                                             1845 07164000
*        RETURN;                                                   1846 07165000
*                                                                  1846 07166000
         B     @EL00007                                            1846 07167000
*END MODELPRC;                                                     1847 07168000
         B     @EL00007                                            1847 07169000
*/********************************************************************/ 07170000
*/*                                                          @Y30SSJH*/ 07171000
*/* PROCEDURE NAME - FREESTG                                 @Y30SSJH*/ 07172000
*/*                                                          @Y30SSJH*/ 07173000
*/* FUNCTION - FREESTG HAS A SINGLE PURPOSE,TO FREE AUTOMATIC        */ 07174000
*/*            STORAGE GOTTEN BY IDCDE02. IT DOES THIS BY    @Y30SSJH*/ 07175000
*/*            INVOKING THE SYSTEM ADAPTER VIA THE UEPILOG   @Y30SSJH*/ 07176000
*/*            MACRO. UPON COMPLETION, THE SYSTEM ADAPTER    @Y30SSJH*/ 07177000
*/*            RETURNS CONTROL TO IDCDE02'S CALLER,IDCDE01.  @Y30SSJH*/ 07178000
*/*                                                          @Y30SSJH*/ 07179000
*/* INPUT - NONE                                             @Y30SSJH*/ 07180000
*/*                                                          @Y30SSJH*/ 07181000
*/* OUTPUT -                                                 @Y30SSJH*/ 07182000
*/*          RESULTS IN IDCDE02'S AUTOMATIC STORAGE BEING    @Y30SSJH*/ 07183000
*/*          RELEASED.                                       @Y30SSJH*/ 07184000
*/*                                                          @Y30SSJH*/ 07185000
*/********************************************************************/ 07186000
*FREESTG:                                                          1848 07187000
*        PROCEDURE        OPTIONS(SAVEAREA);               /*@Y30SSJH*/ 07188000
*                                                                  1848 07189000
FREESTG  STM   @14,@12,12(@13)                                     1848 07190000
         ST    @13,@SA00008+4                                      1848 07191000
         LA    @14,@SA00008                                        1848 07192000
         ST    @14,8(,@13)                                         1848 07193000
         LR    @13,@14                                             1848 07194000
*        GEN (ENTRY FREESTG);                              /*@Y30SSJH*/ 07195000
         ENTRY FREESTG                                                  07196000
*        LM(REG10,REG12,BASESAVE);                         /*@Y30SSJH*/ 07197000
*                                                                  1850 07198000
         LM    REG10,REG12,BASESAVE                                1850 07199000
*        IF GDTDBG = NULLPTR                                       1851 07200000
*          THEN;                                                   1851 07201000
         L     @06,@PC00001                                        1851 07202000
         L     @06,GDTDBG(,@06)                                    1851 07203000
         LTR   @06,@06                                             1851 07204000
         BZ    @RT01851                                            1851 07205000
*          ELSE                                                    1853 07206000
*            CALL IDCDB010(GDTTBL,'DE37');                         1853 07207000
         L     @06,@PC00001                                        1853 07208000
         ST    @06,@AL00001                                        1853 07209000
         LA    @04,@CC03008                                        1853 07210000
         ST    @04,@AL00001+4                                      1853 07211000
         MVI   @AL00001+4,X'80'                                    1853 07212000
         L     @15,GDTDBG(,@06)                                    1853 07213000
         LA    @01,@AL00001                                        1853 07214000
         BALR  @14,@15                                             1853 07215000
*                                                          /*@Y30SSJH*/ 07216000
*                                                                  1854 07217000
*        RFY (REG7,REG13) RESTRICTED;                      /*@Y30SSJH*/ 07218000
@RT01851 DS    0H                                                  1855 07219000
*        REG13 = REG7;                                             1855 07220000
         LR    REG13,REG7                                          1855 07221000
*        RFY (REG7,REG13) UNRESTRICTED;                    /*@Y30SSJH*/ 07222000
*                                                                  1856 07223000
*        CALL IDCSAEP0(GDTTBL,MODID);                              1857 07224000
         L     @06,@PC00001                                        1857 07225000
         ST    @06,@AL00001                                        1857 07226000
         LA    @04,MODID                                           1857 07227000
         ST    @04,@AL00001+4                                      1857 07228000
         MVI   @AL00001+4,X'80'                                    1857 07229000
         L     @15,GDTEPL(,@06)                                    1857 07230000
         LA    @01,@AL00001                                        1857 07231000
         BALR  @14,@15                                             1857 07232000
*         /*@Y30SSJH*/                                             1858 07233000
*                                                                  1858 07234000
*END FREESTG;                                              /*@Y30SSJH*/ 07235000
*                                                                  1858 07236000
@EL00008 L     @13,4(,@13)                                         1858 07237000
@EF00008 DS    0H                                                  1858 07238000
@ER00008 LM    @14,@12,12(@13)                                     1858 07239000
         BR    @14                                                 1858 07240000
*END IDCDE02                                               /*@Y30SSJH*/ 07241000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07242000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 07243000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 07244000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 07245000
*/*%INCLUDE SYSLIB  (IDCCSDE )                                        * 07246000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 07247000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 07248000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 07249000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 07250000
*;                                                                 1859 07251000
@DATA    DS    0H                                                       07252000
@CH00287 DC    H'5'                                                     07253000
@CH00038 DC    H'10'                                                    07254000
@CH00036 DC    H'12'                                                    07255000
@CH01127 DC    H'64'                                                    07256000
@SM03038 MVC   LOHIKEY(0,@06),RGKEY(RGFDTPTR)                           07257000
@SM03040 MVC   LOHIKEY(0,@09),FPLLOKEY(RNGFPLLO)                        07258000
@SM03042 MVC   LOHIKEY(0,@15),FPLHIKEY(RNGFPLHI)                        07259000
@SM03044 MVC   LKYCHECK(0),LOKEY(LKYCKPTR)                              07260000
@SM03046 MVC   HKYCHECK(0),HIKEY(HKYCKPTR)                              07261000
@SM03048 MVC   LKYCMPR(0),LKYCOMP(LKYCMPTR)                             07262000
@SM03050 MVC   HKYCMPR(0),HKYCOMP(HKYCMPTR)                             07263000
@SC03052 CLC   HKYCHECK(0),LOKEY(LKYCKPTR)                              07264000
@SM03054 MVC   PWDOVLAY-8(0,@01),CHARVAL(FDTTBLPT)                      07265000
@SM03057 MVC   PASSPRMT(0,@02),CHARVAL(FDTTBLPT)                        07266000
@SM03059 MVC   SVRMDUL(0,@02),CHARVAL(FDTTBLPT)                         07267000
@SM03061 MVC   AUTHREC(0,@06),CHARVAL(FDTTBLPT)                         07268000
@SM03063 MVC   AUTHREC(0,@06),MDLARECD(@02)                             07269000
@DATD    DSECT                                                          07270000
         DS    0F                                                       07271000
@SA00001 DS    18F                                                      07272000
@PC00001 DS    3F                                                       07273000
@SA00002 DS    18F                                                      07274000
@PC00002 DS    10F                                                      07275000
@SA00003 DS    18F                                                      07276000
@PC00003 DS    38F                                                      07277000
@SA00004 DS    18F                                                      07278000
@PC00004 DS    12F                                                      07279000
@SA00005 DS    18F                                                      07280000
@PC00005 DS    5F                                                       07281000
@SA00006 DS    18F                                                      07282000
@PC00006 DS    18F                                                      07283000
@SA00007 DS    18F                                                      07284000
@PC00007 DS    10F                                                      07285000
@SA00008 DS    18F                                                      07286000
@AL00001 DS    5A                                                       07287000
@TF00001 DS    F                                                        07288000
@AFTEMPS DS    5F                                                       07289000
IDCDE02  CSECT                                                          07290000
         DS    0F                                                       07291000
@CF00220 DC    F'1'                                                     07292000
@CF00154 DC    F'2'                                                     07293000
@CH00154 EQU   @CF00154+2                                               07294000
@CF00163 DC    F'3'                                                     07295000
@CF00043 DC    F'4'                                                     07296000
@CF00157 DC    F'6'                                                     07297000
@CH00157 EQU   @CF00157+2                                               07298000
@CF00035 DC    F'7'                                                     07299000
@CF00180 DC    F'8'                                                     07300000
@CF00229 DC    F'15'                                                    07301000
@CF00646 DC    F'17'                                                    07302000
@CF00311 DC    F'24'                                                    07303000
@CF00950 DC    F'40'                                                    07304000
@CF01033 DC    F'50'                                                    07305000
@CF01041 DC    F'52'                                                    07306000
@CF01344 DC    F'96'                                                    07307000
@CF01586 DC    F'144'                                                   07308000
@CF01598 DC    F'248'                                                   07309000
@CF00872 DC    F'255'                                                   07310000
@CF02370 DC    F'512'                                                   07311000
@CF02367 DC    F'1830'                                                  07312000
@CF03034 DC    F'-12'                                                   07313000
@CF03056 DC    F'-8'                                                    07314000
@CF03035 DC    F'-7'                                                    07315000
@CF03033 DC    F'-6'                                                    07316000
@CF03032 DC    F'-5'                                                    07317000
@CF03031 DC    F'-4'                                                    07318000
@CF03070 DC    F'-3'                                                    07319000
@DATD    DSECT                                                          07320000
         DS    0D                                                       07321000
LISTSCAN DS    A                                                        07322000
IOCSPTR  DS    A                                                        07323000
OPNPTR   DS    A                                                        07324000
DDSTRU   DS    A                                                        07325000
FSADDR   DS    A                                                        07326000
ERCNVADR DS    A                                                        07327000
DMPINDEX DS    A                                                        07328000
FPLSTPTR DS    A                                                        07329000
NFPLPTR  DS    A                                                        07330000
GPOOLPT  DS    A                                                        07331000
GPOOLEN  DS    F                                                        07332000
KEYFPLPT DS    A                                                        07333000
RGLSTPT  DS    A                                                        07334000
PROTPTR  DS    A                                                        07335000
MDLWKAPT DS    A                                                        07336000
MWKALEN  DS    F                                                        07337000
LOCATPTR DS    A                                                        07338000
AMDLTABL DS    F                                                        07339000
LISTPTR  DS    A                                                        07340000
TEMPPTR  DS    A                                                        07341000
I        DS    H                                                        07342000
J        DS    H                                                        07343000
K        DS    H                                                        07344000
SETRC    DS    H                                                        07345000
LISTLN   DS    FL1                                                      07346000
         DS    0D                                                       07347000
@TS00001 DS    CL95                                                     07348000
         DS    CL1                                                      07349000
BASESAVE DS    CL12                                                     07350000
QUALVARS DS    CL16                                                     07351000
         ORG   QUALVARS                                                 07352000
QDSNLEN  DS    FL2                                                      07353000
         DS    CL2                                                      07354000
QDSNPTR  DS    AL4                                                      07355000
QCATPTR  DS    AL4                                                      07356000
QCATPSWD DS    AL4                                                      07357000
         ORG   QUALVARS+16                                              07358000
CREATEDT DS    CL8                                                      07359000
         ORG   CREATEDT                                                 07360000
@NM00079 DS    CL1                                                      07361000
XUTYEAR  DS    FL1                                                      07362000
XUTDAY   DS    FL2                                                      07363000
         ORG   CREATEDT+8                                               07364000
TIMEODAY DS    CL8                                                      07365000
CNVTYEAR DS    BL2                                                      07366000
         ORG   CNVTYEAR                                                 07367000
CVTYEAR  DS    BL1                                                      07368000
CVTPACK  DS    BL1                                                      07369000
         ORG   CNVTYEAR+2                                               07370000
         DS    CL2                                                      07371000
DAYTOTAL DS    CL8                                                      07372000
         ORG   DAYTOTAL                                                 07373000
@NM00080 DS    CL6                                                      07374000
DAYTOTL  DS    FL2                                                      07375000
         ORG   DAYTOTAL+8                                               07376000
DATELOOP DS    CL1                                                      07377000
VOLEXFLG DS    CL1                                                      07378000
RANGFLAG DS    CL1                                                      07379000
CKRANGE  DS    CL1                                                      07380000
LKYCHECK DS    CL64                                                     07381000
HKYCHECK DS    CL64                                                     07382000
LKYCMPR  DS    CL64                                                     07383000
HKYCMPR  DS    CL64                                                     07384000
CKSWITCH DS    CL1                                                      07385000
MDLFLG   DS    CL1                                                      07386000
         DS    CL2                                                      07387000
PWDPTRS  DS    4A                                                       07388000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07389000
@ENDDATD EQU   *                                                        07390000
IDCDE02  CSECT                                                          07391000
         DS    0F                                                       07392000
@SIZDATD DC    AL1(0)                                                   07393000
         DC    AL3(@ENDDATD-@DATD)                                      07394000
         DS    0D                                                       07395000
NAMEMASK DC    H'2'                                                     07396000
@CC02513 DC    C'DE30'                                                  07397000
@CC02582 DC    C'DE31'                                                  07398000
@CC02727 DC    C'DE32'                                                  07399000
@CC02811 DC    C'DE33'                                                  07400000
@CC02836 DC    C'DE35'                                                  07401000
@CC02922 DC    C'DE34'                                                  07402000
@CC02997 DC    C'DE36'                                                  07403000
@CC03001 DC    C'DE03'                                                  07404000
@CC03003 DC    C'DE04'                                                  07405000
@CC03008 DC    C'DE37'                                                  07406000
@CB02355 DC    X'FFFFFFFFFFFFFFFF'                                      07407000
@CB02317 DC    X'E4E5F00C04'                                            07408000
@CB02320 DC    X'C4C5F00C01'                                            07409000
@CB02323 DC    X'C4C5F00C02'                                            07410000
@CB02326 DC    X'E4E5F00C03'                                            07411000
@CB02329 DC    X'C4C5F00C0F'                                            07412000
@CB02332 DC    X'C4C5F00C19'                                            07413000
@CB02335 DC    X'C4C5F00C10'                                            07414000
@CB02338 DC    X'C4C5F00C12'                                            07415000
@CB02341 DC    X'C4C5F00C04'                                            07416000
@CB02344 DC    X'E4E5F00C07'                                            07417000
@CB02347 DC    X'E4E5F00001'                                            07418000
@CB02350 DC    X'C4C5F00C18'                                            07419000
@CB02587 DC    X'99999F'                                                07420000
ALL      DC    CL3'ALL'                                                 07421000
FORMAT   DC    CL4'FORM'                                                07422000
HSECOND  DC    CL4'HSEC'                                                07423000
CLOCK    DC    CL4'KLOK'                                                07424000
SETZERO  DC    CL4'ZERO'                                                07425000
SETBLANK DC    CL4'BLNK'                                                07426000
NOSET    DC    CL4'NSET'                                                07427000
OVERRIDE DC    CL4'OVRD'                                                07428000
ACQUIRE  DC    CL8'ACQUIRE '                                            07429000
RELINQ   DC    CL8'RELINQ  '                                            07430000
MOUNT    DC    CL8'MOUNT   '                                            07431000
DEMOUNT  DC    CL8'DEMOUNT '                                            07432000
DEFINE   DC    CL8'DEFINE  '                                            07433000
MOVE     DC    CL8'MOVE    '                                            07434000
TRACEQ   DC    CL8'TRACEQ  '                                            07435000
COPYTABL DC    CL8'COPYTABL'                                            07436000
COPYCRTG DC    CL8'COPYCRTG'                                            07437000
COPYVOL  DC    CL8'COPYVOL '                                            07438000
VVIC     DC    CL8'VVIC    '                                            07439000
TUNE     DC    CL8'TUNE    '                                            07440000
NAMES    DC    CL4'NAME'                                                07441000
UNIT     DC    CL4'UNIT'                                                07442000
SHR      DC    CL4'SHR '                                                07443000
EXCL     DC    CL4'EXCL'                                                07444000
NOWAIT   DC    CL4'NWAI'                                                07445000
WAIT     DC    CL4'WAIT'                                                07446000
FIXAREA  DS    CL256                                                    07447000
         ORG   FIXAREA                                                  07448000
@NM00054 DS    CL256                                                    07449000
         ORG   @NM00054                                                 07450000
@NM00055 DC    256X'00'                                                 07451000
         ORG   FIXAREA+256                                              07452000
DEGPID   DC    CL4'DE00'                                                07453000
MODID    DC    CL4'DE02'                                                07454000
DSETCRDT DC    CL8'DSETCRDT'                                            07455000
DSETEXDT DC    CL8'DSETEXDT'                                            07456000
EXCPEXIT DC    CL8'EXCPEXIT'                                            07457000
AMDSBNAM DC    CL8'AMDSBCAT'                                            07458000
MDLID    DC    CL4'DE02'                                                07459000
VOLSMASK DC    X'80'                                                    07460000
ALCFLDNM DC    CL8'DSATTR'                                              07461000
         DC    CL8'LRECL'                                               07462000
         DC    CL8'BUFSIZE'                                             07463000
         DC    CL8'SPACPARM'                                            07464000
         DC    CL8'DEVTYP'                                              07465000
         DC    CL8'FILESEQ'                                             07466000
PROTFLNM DC    CL8'PASSWALL'                                            07467000
         DC    CL8'RGATTR'                                              07468000
         DC    CL8'OWNERID'                                             07469000
LENTABLE DC    AL1(1)                                                   07470000
         DC    AL1(4)                                                   07471000
         DC    AL1(3)                                                   07472000
         DC    AL1(8)                                                   07473000
         DC    AL1(2)                                                   07474000
         DC    AL1(96)                                                  07475000
         DC    AL1(6)                                                   07476000
         DC    AL1(0)                                                   07477000
         DC    AL1(0)                                                   07478000
         DC    AL1(7)                                                   07479000
         DC    AL1(4)                                                   07480000
         DC    AL1(4)                                                   07481000
         DC    AL1(4)                                                   07482000
         DC    AL1(8)                                                   07483000
         DC    AL1(1)                                                   07484000
MDLNMTAB DC    CL8'ENTYPE'                                              07485000
         DC    CL8'CATACB'                                              07486000
         DC    CL8'DSETEXDT'                                            07487000
         DC    CL8'OWNERID'                                             07488000
         DC    CL8'DSATTR'                                              07489000
         DC    CL8'AMDSBCAT'                                            07490000
         DC    CL8'VOLSER'                                              07491000
         DC    CL8'LOKEYV'                                              07492000
         DC    CL8'HIKEYV'                                              07493000
         DC    CL8'SPACPARM'                                            07494000
         DC    CL8'LRECL'                                               07495000
         DC    CL8'BUFSIZE'                                             07496000
         DC    CL8'NAMEDS'                                              07497000
         DC    CL8'EXCPEXIT'                                            07498000
         DC    CL8'RGATTR'                                              07499000
         DC    CL8'PASSWALL'                                            07500000
         DC    CL8'CATTR'                                               07501000
         DC    CL8'ITYPEXT'                                             07502000
         DC    CL8'CNTREPNO'                                            07503000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07504000
@01      EQU   01                                                       07505000
@02      EQU   02                                                       07506000
@03      EQU   03                                                       07507000
@04      EQU   04                                                       07508000
@05      EQU   05                                                       07509000
@06      EQU   06                                                       07510000
@07      EQU   07                                                       07511000
@08      EQU   08                                                       07512000
@09      EQU   09                                                       07513000
@10      EQU   10                                                       07514000
@11      EQU   11                                                       07515000
@12      EQU   12                                                       07516000
@13      EQU   13                                                       07517000
@14      EQU   14                                                       07518000
@15      EQU   15                                                       07519000
TSTFPLDS EQU   @04                                                      07520000
TSTFPLVS EQU   @02                                                      07521000
MDTBPT   EQU   @09                                                      07522000
MDLOOPCT EQU   @03                                                      07523000
LOOP     EQU   @03                                                      07524000
CKLEN    EQU   @04                                                      07525000
PSWDFLAG EQU   @04                                                      07526000
KYMSKPTR EQU   @04                                                      07527000
HKYCMPTR EQU   @02                                                      07528000
LKYCMPTR EQU   @04                                                      07529000
HKYCKPTR EQU   @03                                                      07530000
LKYCKPTR EQU   @02                                                      07531000
RANGELEN EQU   @03                                                      07532000
MAXRGADR EQU   @08                                                      07533000
RNGFPLHI EQU   @02                                                      07534000
RNGFPLLO EQU   @03                                                      07535000
RANGLOOP EQU   @04                                                      07536000
RGFDTPTR EQU   @03                                                      07537000
VOLSTCNT EQU   @09                                                      07538000
DAYPERYR EQU   @04                                                      07539000
NOWYEAR  EQU   @03                                                      07540000
ARITHX   EQU   @08                                                      07541000
N        EQU   @02                                                      07542000
FDTTBLPT EQU   @04                                                      07543000
CTGFLPTR EQU   @03                                                      07544000
TESTRC   EQU   @08                                                      07545000
RTNREG   EQU   @15                                                      07546000
REG5     EQU   @05                                                      07547000
REG6     EQU   @06                                                      07548000
REG7     EQU   @07                                                      07549000
REG10    EQU   @10                                                      07550000
REG12    EQU   @12                                                      07551000
REG13    EQU   @13                                                      07552000
REG0     EQU   @00                                                      07553000
REG1     EQU   @01                                                      07554000
REG11    EQU   @11                                                      07555000
REG14    EQU   @14                                                      07556000
REG15    EQU   @15                                                      07557000
REG2     EQU   @02                                                      07558000
REG3     EQU   @03                                                      07559000
REG4     EQU   @04                                                      07560000
REG8     EQU   @08                                                      07561000
REG9     EQU   @09                                                      07562000
IDCSAEP0 EQU   0                                                        07563000
IDCSAGP0 EQU   0                                                        07564000
IDCSATI0 EQU   0                                                        07565000
IDCSACA0 EQU   0                                                        07566000
IDCSAID0 EQU   0                                                        07567000
IDCSAQL0 EQU   0                                                        07568000
TRACE1   EQU   0                                                        07569000
OLDERID1 EQU   TRACE1                                                   07570000
TRACE2   EQU   0                                                        07571000
OLDERID2 EQU   TRACE2                                                   07572000
NEWID2   EQU   TRACE2+95                                                07573000
NEWERID2 EQU   5                                                        07574000
CIRAGL   EQU   0                                                        07575000
CIRTYPE  EQU   CIRAGL                                                   07576000
ALLAGL   EQU   0                                                        07577000
ALLSTS   EQU   ALLAGL+24                                                07578000
ALLDSP   EQU   ALLAGL+25                                                07579000
ALLORG   EQU   ALLAGL+26                                                07580000
ALLOPT   EQU   ALLAGL+28                                                07581000
UNITABL  EQU   0                                                        07582000
UNITADR  EQU   UNITABL+4                                                07583000
@NM00010 EQU   UNITADR                                                  07584000
UNITSTAT EQU   UNITABL+6                                                07585000
IOCSTR   EQU   0                                                        07586000
IOCDSO   EQU   IOCSTR+16                                                07587000
IOCRFM   EQU   IOCSTR+17                                                07588000
IOCMAC   EQU   IOCSTR+18                                                07589000
IOCMAC2  EQU   IOCSTR+19                                                07590000
IOCCHP   EQU   IOCSTR+20                                                07591000
IOCMSG   EQU   IOCSTR+21                                                07592000
IOCRBA   EQU   IOCSTR+40                                                07593000
IOCTTR   EQU   IOCRBA                                                   07594000
IOCMEM   EQU   IOCSTR+44                                                07595000
IOCNWM   EQU   IOCSTR+48                                                07596000
IOCREL   EQU   IOCSTR+60                                                07597000
OPNAGL   EQU   0                                                        07598000
OPNOPT   EQU   OPNAGL                                                   07599000
OPNRFM   EQU   OPNAGL+1                                                 07600000
OPNTYP   EQU   OPNAGL+2                                                 07601000
OPNMOD   EQU   OPNAGL+3                                                 07602000
OPNIOC   EQU   OPNAGL+4                                                 07603000
OPNDEV   EQU   OPNAGL+24                                                07604000
OPNDSO   EQU   OPNAGL+41                                                07605000
OPNOPT2  EQU   OPNAGL+42                                                07606000
IOINFOPT EQU   0                                                        07607000
UVOLLIST EQU   0                                                        07608000
UVOLENT  EQU   UVOLLIST+2                                               07609000
DARGLIST EQU   0                                                        07610000
DARGSTID EQU   DARGLIST+8                                               07611000
DARGFLGS EQU   DARGLIST+19                                              07612000
DARGARY  EQU   DARGLIST+20                                              07613000
DARGINS  EQU   DARGARY                                                  07614000
DARGINL  EQU   DARGARY+2                                                07615000
FMTLIST  EQU   0                                                        07616000
FMTFLGS  EQU   FMTLIST                                                  07617000
FMTSPF   EQU   FMTLIST+2                                                07618000
FMTRFNO  EQU   FMTSPF                                                   07619000
FMTILEN  EQU   FMTRFNO                                                  07620000
FMTIOFF  EQU   FMTLIST+4                                                07621000
FMTTRBC  EQU   FMTIOFF                                                  07622000
FMTSTO   EQU   FMTTRBC                                                  07623000
FMTOCOL  EQU   FMTLIST+6                                                07624000
FMTCNVF  EQU   FMTLIST+10                                               07625000
ERCNVTAB EQU   0                                                        07626000
ERTYPE   EQU   ERCNVTAB                                                 07627000
EROPER   EQU   ERCNVTAB+1                                               07628000
EROSOPER EQU   ERCNVTAB+2                                               07629000
ERCATRC  EQU   ERCNVTAB+16                                              07630000
ERCPLPT  EQU   ERCNVTAB+20                                              07631000
IDCDB010 EQU   0                                                        07632000
DMPITM   EQU   0                                                        07633000
DMPARY   EQU   0                                                        07634000
FDTTBL   EQU   0                                                        07635000
FDTPTR   EQU   FDTTBL+8                                                 07636000
CAT      EQU   0                                                        07637000
CATLG    EQU   0                                                        07638000
CATLGPLN EQU   CATLG                                                    07639000
CATLGPAS EQU   CATLG+1                                                  07640000
CATLGFLG EQU   CATLG+10                                                 07641000
CATLGVAL EQU   CATLG+21                                                 07642000
CATDN    EQU   0                                                        07643000
MCAT     EQU   0                                                        07644000
UCAT     EQU   0                                                        07645000
CLST     EQU   0                                                        07646000
PGSP     EQU   0                                                        07647000
INDEX    EQU   0                                                        07648000
AIX      EQU   0                                                        07649000
PATH     EQU   0                                                        07650000
METRY    EQU   0                                                        07651000
METRYFLG EQU   METRY+10                                                 07652000
UETRY    EQU   0                                                        07653000
UETRYFLG EQU   UETRY+10                                                 07654000
CETRY    EQU   0                                                        07655000
CETRYFLG EQU   CETRY+10                                                 07656000
PETRY    EQU   0                                                        07657000
PETRYFLG EQU   PETRY+10                                                 07658000
AETRY    EQU   0                                                        07659000
AETRYFLG EQU   AETRY+10                                                 07660000
GETRY    EQU   0                                                        07661000
GETRYFLG EQU   GETRY+10                                                 07662000
RETRY    EQU   0                                                        07663000
RETRYFLG EQU   RETRY+10                                                 07664000
XETRY    EQU   0                                                        07665000
XETRYFLG EQU   XETRY+10                                                 07666000
BETRY    EQU   0                                                        07667000
BETRYFLG EQU   BETRY+10                                                 07668000
DETRY    EQU   0                                                        07669000
DETRYFLG EQU   DETRY+10                                                 07670000
IETRY    EQU   0                                                        07671000
IETRYFLG EQU   IETRY+10                                                 07672000
CINDX    EQU   0                                                        07673000
CNIDX    EQU   0                                                        07674000
CMODL    EQU   0                                                        07675000
CENAM    EQU   0                                                        07676000
CENAMFLG EQU   CENAM+10                                                 07677000
UENAM    EQU   0                                                        07678000
UENAMFLG EQU   UENAM+10                                                 07679000
GENAM    EQU   0                                                        07680000
GENAMFLG EQU   GENAM+10                                                 07681000
RENAM    EQU   0                                                        07682000
RENAMFLG EQU   RENAM+10                                                 07683000
PENAM    EQU   0                                                        07684000
PENAMFLG EQU   PENAM+10                                                 07685000
CMDCT    EQU   0                                                        07686000
CMDCTFLG EQU   CMDCT+10                                                 07687000
UMDCT    EQU   0                                                        07688000
UMDCTFLG EQU   UMDCT+10                                                 07689000
GMDCT    EQU   0                                                        07690000
GMDCTFLG EQU   GMDCT+10                                                 07691000
RMDCT    EQU   0                                                        07692000
RMDCTFLG EQU   RMDCT+10                                                 07693000
PMDCT    EQU   0                                                        07694000
PMDCTFLG EQU   PMDCT+10                                                 07695000
CMDNM    EQU   0                                                        07696000
UMDNM    EQU   0                                                        07697000
GMDNM    EQU   0                                                        07698000
RMDNM    EQU   0                                                        07699000
PMDNM    EQU   0                                                        07700000
DENAM    EQU   0                                                        07701000
DENAMFLG EQU   DENAM+10                                                 07702000
DMDCT    EQU   0                                                        07703000
DMDCTFLG EQU   DMDCT+10                                                 07704000
DMDNM    EQU   0                                                        07705000
IENAM    EQU   0                                                        07706000
IENAMFLG EQU   IENAM+10                                                 07707000
IMDCT    EQU   0                                                        07708000
IMDCTFLG EQU   IMDCT+10                                                 07709000
IMDNM    EQU   0                                                        07710000
MMSTR    EQU   0                                                        07711000
UMSTR    EQU   0                                                        07712000
CMSTR    EQU   0                                                        07713000
PMSTR    EQU   0                                                        07714000
GMSTR    EQU   0                                                        07715000
RMSTR    EQU   0                                                        07716000
DMSTR    EQU   0                                                        07717000
IMSTR    EQU   0                                                        07718000
MCINT    EQU   0                                                        07719000
CCINT    EQU   0                                                        07720000
UCINT    EQU   0                                                        07721000
PCINT    EQU   0                                                        07722000
GCINT    EQU   0                                                        07723000
RCINT    EQU   0                                                        07724000
DCINT    EQU   0                                                        07725000
ICINT    EQU   0                                                        07726000
MUPDT    EQU   0                                                        07727000
CUPDT    EQU   0                                                        07728000
UUPDT    EQU   0                                                        07729000
PUPDT    EQU   0                                                        07730000
GUPDT    EQU   0                                                        07731000
RUPDT    EQU   0                                                        07732000
DUPDT    EQU   0                                                        07733000
IUPDT    EQU   0                                                        07734000
MREAD    EQU   0                                                        07735000
CREAD    EQU   0                                                        07736000
UREAD    EQU   0                                                        07737000
PREAD    EQU   0                                                        07738000
GREAD    EQU   0                                                        07739000
RREAD    EQU   0                                                        07740000
DREAD    EQU   0                                                        07741000
IREAD    EQU   0                                                        07742000
MCODE    EQU   0                                                        07743000
CCODE    EQU   0                                                        07744000
UCODE    EQU   0                                                        07745000
PCODE    EQU   0                                                        07746000
GCODE    EQU   0                                                        07747000
RCODE    EQU   0                                                        07748000
DCODE    EQU   0                                                        07749000
ICODE    EQU   0                                                        07750000
MATTP    EQU   0                                                        07751000
CATTP    EQU   0                                                        07752000
UATTP    EQU   0                                                        07753000
PATTP    EQU   0                                                        07754000
GATTP    EQU   0                                                        07755000
RATTP    EQU   0                                                        07756000
DATTP    EQU   0                                                        07757000
IATTP    EQU   0                                                        07758000
MEPNM    EQU   0                                                        07759000
UEPNM    EQU   0                                                        07760000
CEPNM    EQU   0                                                        07761000
PEPNM    EQU   0                                                        07762000
GEPNM    EQU   0                                                        07763000
REPNM    EQU   0                                                        07764000
MSTRG    EQU   0                                                        07765000
USTRG    EQU   0                                                        07766000
CSTRG    EQU   0                                                        07767000
PSTRG    EQU   0                                                        07768000
GSTRG    EQU   0                                                        07769000
RSTRG    EQU   0                                                        07770000
DEPNM    EQU   0                                                        07771000
DSTRG    EQU   0                                                        07772000
IEPNM    EQU   0                                                        07773000
ISTRG    EQU   0                                                        07774000
MTO      EQU   0                                                        07775000
CTO      EQU   0                                                        07776000
UTO      EQU   0                                                        07777000
ATO      EQU   0                                                        07778000
BTO      EQU   0                                                        07779000
PTO      EQU   0                                                        07780000
GTO      EQU   0                                                        07781000
RTO      EQU   0                                                        07782000
MFOR     EQU   0                                                        07783000
CFOR     EQU   0                                                        07784000
UFOR     EQU   0                                                        07785000
AFOR     EQU   0                                                        07786000
BFOR     EQU   0                                                        07787000
PFOR     EQU   0                                                        07788000
GFOR     EQU   0                                                        07789000
RFOR     EQU   0                                                        07790000
MOWNR    EQU   0                                                        07791000
COWNR    EQU   0                                                        07792000
UOWNR    EQU   0                                                        07793000
AOWNR    EQU   0                                                        07794000
BOWNR    EQU   0                                                        07795000
POWNR    EQU   0                                                        07796000
GOWNR    EQU   0                                                        07797000
ROWNR    EQU   0                                                        07798000
DOWNR    EQU   0                                                        07799000
IOWNR    EQU   0                                                        07800000
CSHR1    EQU   0                                                        07801000
GSHR1    EQU   0                                                        07802000
CSHR2    EQU   0                                                        07803000
GSHR2    EQU   0                                                        07804000
DSHR1    EQU   0                                                        07805000
DSHR2    EQU   0                                                        07806000
ISHR1    EQU   0                                                        07807000
ISHR2    EQU   0                                                        07808000
CKYLN    EQU   0                                                        07809000
CKYPS    EQU   0                                                        07810000
GKYLN    EQU   0                                                        07811000
GKYPS    EQU   0                                                        07812000
DKYLN    EQU   0                                                        07813000
DKYPS    EQU   0                                                        07814000
MINDD    EQU   0                                                        07815000
CINDD    EQU   0                                                        07816000
UINDD    EQU   0                                                        07817000
PINDD    EQU   0                                                        07818000
SINDD    EQU   0                                                        07819000
AINDD    EQU   0                                                        07820000
GINDD    EQU   0                                                        07821000
RINDD    EQU   0                                                        07822000
DINDD    EQU   0                                                        07823000
IINDD    EQU   0                                                        07824000
MVSER    EQU   0                                                        07825000
@NM00032 EQU   MVSER+2                                                  07826000
UVSER    EQU   0                                                        07827000
@NM00033 EQU   UVSER+2                                                  07828000
PVSER    EQU   0                                                        07829000
@NM00034 EQU   PVSER+2                                                  07830000
CVSER    EQU   0                                                        07831000
@NM00035 EQU   CVSER+2                                                  07832000
SVSER    EQU   0                                                        07833000
@NM00036 EQU   SVSER+2                                                  07834000
AVSER    EQU   0                                                        07835000
@NM00037 EQU   AVSER+2                                                  07836000
GVSER    EQU   0                                                        07837000
@NM00038 EQU   GVSER+2                                                  07838000
DVSER    EQU   0                                                        07839000
@NM00039 EQU   DVSER+2                                                  07840000
IVSER    EQU   0                                                        07841000
@NM00040 EQU   IVSER+2                                                  07842000
CRGLO    EQU   0                                                        07843000
CRGHI    EQU   0                                                        07844000
GRGLO    EQU   0                                                        07845000
GRGHI    EQU   0                                                        07846000
DRGLO    EQU   0                                                        07847000
DRGHI    EQU   0                                                        07848000
ADEVT    EQU   0                                                        07849000
@NM00041 EQU   ADEVT+2                                                  07850000
AFSNO    EQU   0                                                        07851000
AFSNOCNT EQU   AFSNO                                                    07852000
AFSNOVAL EQU   AFSNO+4                                                  07853000
MTKPR    EQU   0                                                        07854000
CTKPR    EQU   0                                                        07855000
STKPR    EQU   0                                                        07856000
UTKPR    EQU   0                                                        07857000
PTKPR    EQU   0                                                        07858000
MCLPR    EQU   0                                                        07859000
CCLPR    EQU   0                                                        07860000
UCLPR    EQU   0                                                        07861000
PCLPR    EQU   0                                                        07862000
SCLPR    EQU   0                                                        07863000
MRCPR    EQU   0                                                        07864000
CRCPR    EQU   0                                                        07865000
SRCPR    EQU   0                                                        07866000
URCPR    EQU   0                                                        07867000
PRCPR    EQU   0                                                        07868000
GTKPR    EQU   0                                                        07869000
GCLPR    EQU   0                                                        07870000
GRCPR    EQU   0                                                        07871000
DTKPR    EQU   0                                                        07872000
DCLPR    EQU   0                                                        07873000
DRCPR    EQU   0                                                        07874000
ITKPR    EQU   0                                                        07875000
ICLPR    EQU   0                                                        07876000
IRCPR    EQU   0                                                        07877000
MTKSC    EQU   0                                                        07878000
CTKSC    EQU   0                                                        07879000
STKSC    EQU   0                                                        07880000
UTKSC    EQU   0                                                        07881000
PTKSC    EQU   0                                                        07882000
MCLSC    EQU   0                                                        07883000
CCLSC    EQU   0                                                        07884000
UCLSC    EQU   0                                                        07885000
PCLSC    EQU   0                                                        07886000
SCLSC    EQU   0                                                        07887000
MRCSC    EQU   0                                                        07888000
CRCSC    EQU   0                                                        07889000
SRCSC    EQU   0                                                        07890000
URCSC    EQU   0                                                        07891000
PRCSC    EQU   0                                                        07892000
GTKSC    EQU   0                                                        07893000
GCLSC    EQU   0                                                        07894000
GRCSC    EQU   0                                                        07895000
DTKSC    EQU   0                                                        07896000
DCLSC    EQU   0                                                        07897000
DRCSC    EQU   0                                                        07898000
ITKSC    EQU   0                                                        07899000
ICLSC    EQU   0                                                        07900000
IRCSC    EQU   0                                                        07901000
CARSZ    EQU   0                                                        07902000
SARSZ    EQU   0                                                        07903000
GARSZ    EQU   0                                                        07904000
CMRSZ    EQU   0                                                        07905000
SMRSZ    EQU   0                                                        07906000
GMRSZ    EQU   0                                                        07907000
DARSZ    EQU   0                                                        07908000
DMRSZ    EQU   0                                                        07909000
CCIFS    EQU   0                                                        07910000
GCIFS    EQU   0                                                        07911000
CCAFS    EQU   0                                                        07912000
GCAFS    EQU   0                                                        07913000
DCIFS    EQU   0                                                        07914000
DCAFS    EQU   0                                                        07915000
MBFSZ    EQU   0                                                        07916000
CBFSZ    EQU   0                                                        07917000
UBFSZ    EQU   0                                                        07918000
GBFSZ    EQU   0                                                        07919000
DBFSZ    EQU   0                                                        07920000
CCINV    EQU   0                                                        07921000
GCINV    EQU   0                                                        07922000
DCINV    EQU   0                                                        07923000
ICINV    EQU   0                                                        07924000
ALREL    EQU   0                                                        07925000
ALRELFLG EQU   ALREL+10                                                 07926000
GENLM    EQU   0                                                        07927000
PSWAP    EQU   0                                                        07928000
PNSWP    EQU   0                                                        07929000
GREL     EQU   0                                                        07930000
GRELFLG  EQU   GREL+10                                                  07931000
CEEXT    EQU   0                                                        07932000
GEEXT    EQU   0                                                        07933000
DEEXT    EQU   0                                                        07934000
IEEXT    EQU   0                                                        07935000
CNUMD    EQU   0                                                        07936000
RPENT    EQU   0                                                        07937000
RPENTFLG EQU   RPENT+10                                                 07938000
CTGPL    EQU   0                                                        07939000
CTGOPTN1 EQU   CTGPL                                                    07940000
CTGNAME  EQU   CTGOPTN1                                                 07941000
CTGCNAME EQU   CTGOPTN1                                                 07942000
CTGOPTN2 EQU   CTGPL+1                                                  07943000
CTGEXT   EQU   CTGOPTN2                                                 07944000
CTGERASE EQU   CTGOPTN2                                                 07945000
CTGSMF   EQU   CTGERASE                                                 07946000
CTGREL   EQU   CTGSMF                                                   07947000
CTGPURG  EQU   CTGOPTN2                                                 07948000
CTGVMNT  EQU   CTGPURG                                                  07949000
CTGOPTN3 EQU   CTGPL+2                                                  07950000
CTGFUNC  EQU   CTGOPTN3                                                 07951000
CTGSRH   EQU   CTGOPTN3                                                 07952000
CTGNUM   EQU   CTGOPTN3                                                 07953000
CTGAM0   EQU   CTGOPTN3                                                 07954000
CTGOPTN4 EQU   CTGPL+3                                                  07955000
CTGENT   EQU   CTGPL+4                                                  07956000
CTGFVT   EQU   CTGENT                                                   07957000
CTGCAT   EQU   CTGPL+8                                                  07958000
CTGWKA   EQU   CTGPL+12                                                 07959000
CTGDSORG EQU   CTGPL+16                                                 07960000
CTGTYPE  EQU   CTGPL+18                                                 07961000
CTGNOFLD EQU   CTGPL+19                                                 07962000
CTGDDNM  EQU   CTGPL+20                                                 07963000
CTGNEWNM EQU   CTGDDNM                                                  07964000
CTGFBFLG EQU   CTGNEWNM+2                                               07965000
CTGJSCB  EQU   CTGPL+24                                                 07966000
CTGPSWD  EQU   CTGJSCB                                                  07967000
CTGFIELD EQU   CTGPL+28                                                 07968000
CTGFL    EQU   0                                                        07969000
CTGFLDNO EQU   CTGFL                                                    07970000
CTGFLDCD EQU   CTGFL+1                                                  07971000
CTGFLDRE EQU   CTGFL+3                                                  07972000
CTGFLDNM EQU   CTGFL+8                                                  07973000
CTGFLCHN EQU   CTGFL+12                                                 07974000
CTGFLDAT EQU   CTGFL+16                                                 07975000
CTGFLNG  EQU   CTGFLDAT                                                 07976000
CTGFLPT  EQU   CTGFLDAT+4                                               07977000
IDAAMDSB EQU   0                                                        07978000
AMDATTR  EQU   IDAAMDSB+1                                               07979000
AMDDST   EQU   AMDATTR                                                  07980000
AMDWCK   EQU   AMDATTR                                                  07981000
AMDSDT   EQU   AMDATTR                                                  07982000
AMDREPL  EQU   AMDATTR                                                  07983000
AMDORDER EQU   AMDATTR                                                  07984000
AMDRANGE EQU   AMDATTR                                                  07985000
AMDRRDS  EQU   AMDATTR                                                  07986000
AMDSPAN  EQU   AMDATTR                                                  07987000
AMDLEN   EQU   IDAAMDSB+2                                               07988000
AMDNEST  EQU   IDAAMDSB+4                                               07989000
AMDAXRKP EQU   AMDNEST                                                  07990000
AMDRKP   EQU   IDAAMDSB+6                                               07991000
AMDKEYLN EQU   IDAAMDSB+8                                               07992000
AMDPCTCA EQU   IDAAMDSB+10                                              07993000
AMDPCTCI EQU   IDAAMDSB+11                                              07994000
AMDCINV  EQU   IDAAMDSB+20                                              07995000
AMDLRECL EQU   IDAAMDSB+24                                              07996000
AMDHLRBA EQU   IDAAMDSB+28                                              07997000
AMDSSRBA EQU   IDAAMDSB+32                                              07998000
AMDATTR3 EQU   IDAAMDSB+40                                              07999000
AMDUNQ   EQU   AMDATTR3                                                 08000000
AMDFAULT EQU   AMDATTR3                                                 08001000
AMDBIND  EQU   AMDATTR3                                                 08002000
AMDWAIT  EQU   AMDATTR3                                                 08003000
AMDSTAT  EQU   IDAAMDSB+48                                              08004000
CTGFV    EQU   0                                                        08005000
CTGFVTYP EQU   CTGFV                                                    08006000
CTGFVPRO EQU   CTGFV+1                                                  08007000
CTGFVIND EQU   CTGFV+16                                                 08008000
CTGFVENT EQU   CTGFV+20                                                 08009000
CTGFVSTY EQU   CTGFV+24                                                 08010000
CTGFVOWN EQU   CTGFV+28                                                 08011000
CTGFVEXP EQU   CTGFV+32                                                 08012000
CTGFVCRE EQU   CTGFV+36                                                 08013000
CTGFVVLT EQU   CTGFV+40                                                 08014000
CTGFVRNG EQU   CTGFV+44                                                 08015000
CTGFVDVT EQU   CTGFV+48                                                 08016000
CTGFVSPC EQU   CTGFV+52                                                 08017000
CTGFVAMD EQU   CTGFV+56                                                 08018000
CTGFVFSN EQU   CTGFVAMD                                                 08019000
CTGFVATR EQU   CTGFV+60                                                 08020000
CTGFVBUF EQU   CTGFV+64                                                 08021000
CTGFVLRS EQU   CTGFV+68                                                 08022000
CTGFVLMT EQU   CTGFV+72                                                 08023000
CTGFVEXT EQU   CTGFVLMT                                                 08024000
CTGFVGAT EQU   CTGFV+76                                                 08025000
CTGFVUPG EQU   CTGFVGAT                                                 08026000
CTGFVNAM EQU   CTGFV+80                                                 08027000
CTGFVPWD EQU   CTGFV+84                                                 08028000
CTGFVWKA EQU   CTGFV+88                                                 08029000
@NM00056 EQU   0                                                        08030000
CHARLEN  EQU   @NM00056                                                 08031000
CHARVAL  EQU   @NM00056+1                                               08032000
NUMBVAL  EQU   0                                                        08033000
@NM00057 EQU   0                                                        08034000
LISTCNT  EQU   @NM00057                                                 08035000
@NM00058 EQU   @NM00057+2                                               08036000
LISTVAL  EQU   @NM00058+1                                               08037000
@NM00059 EQU   0                                                        08038000
LISTCNT1 EQU   @NM00059                                                 08039000
@NM00060 EQU   @NM00059+2                                               08040000
LISTVAL1 EQU   @NM00060+1                                               08041000
@NM00061 EQU   0                                                        08042000
NAMPLN   EQU   @NM00061                                                 08043000
NAMPAS   EQU   @NM00061+1                                               08044000
NAMFLG   EQU   @NM00061+10                                              08045000
NAMFUQ   EQU   NAMFLG                                                   08046000
NAMLEN   EQU   @NM00061+20                                              08047000
NAMVAL   EQU   @NM00061+21                                              08048000
VOLIST   EQU   0                                                        08049000
VLISTLEN EQU   VOLIST                                                   08050000
@NM00062 EQU   VOLIST+2                                                 08051000
VLISTCDE EQU   @NM00062                                                 08052000
VLISTSER EQU   @NM00062+2                                               08053000
MDLTABL  EQU   0                                                        08054000
MDLOTYPE EQU   MDLTABL                                                  08055000
MDLACBXP EQU   MDLTABL+16                                               08056000
MDLEXDT  EQU   MDLTABL+24                                               08057000
MDLOWNID EQU   MDLTABL+32                                               08058000
MDLDSATR EQU   MDLTABL+40                                               08059000
MDLAMDSB EQU   MDLTABL+48                                               08060000
MDLVLLEN EQU   MDLTABL+52                                               08061000
MDLVLIST EQU   MDLTABL+56                                               08062000
MDLLKLEN EQU   MDLTABL+60                                               08063000
MDLLOKEY EQU   MDLTABL+64                                               08064000
MDLHKLEN EQU   MDLTABL+68                                               08065000
MDLHIKEY EQU   MDLTABL+72                                               08066000
MDLSPARM EQU   MDLTABL+80                                               08067000
MDLLRECL EQU   MDLTABL+88                                               08068000
MDLBFSZ  EQU   MDLTABL+96                                               08069000
MDLASNAM EQU   MDLTABL+104                                              08070000
MDLEEXIT EQU   MDLTABL+112                                              08071000
MDLRGATR EQU   MDLTABL+120                                              08072000
MDLPWALL EQU   MDLTABL+128                                              08073000
DECPLFPL EQU   0                                                        08074000
DEWKAREA EQU   DECPLFPL+484                                             08075000
DEWKA    EQU   DEWKAREA+4                                               08076000
@NM00070 EQU   DEWKA                                                    08077000
RECVSWKA EQU   DECPLFPL+744                                             08078000
RECVSLEN EQU   RECVSWKA                                                 08079000
MDLPSWLL EQU   0                                                        08080000
MDLPSWD  EQU   MDLPSWLL                                                 08081000
MDLPWPMT EQU   MDLPSWLL+32                                              08082000
MDLPWATP EQU   MDLPSWLL+40                                              08083000
MDLUSVRN EQU   MDLPSWLL+42                                              08084000
MDLUARLN EQU   MDLPSWLL+50                                              08085000
MDLARECD EQU   MDLPSWLL+52                                              08086000
MDLEXPDT EQU   0                                                        08087000
MDLDATTR EQU   0                                                        08088000
MDLRATTR EQU   0                                                        08089000
MDLCACB  EQU   0                                                        08090000
MDLVOLUM EQU   0                                                        08091000
@NM00072 EQU   0                                                        08092000
@NM00073 EQU   0                                                        08093000
MDLSPACE EQU   0                                                        08094000
MDLASSOC EQU   0                                                        08095000
MDLASID  EQU   MDLASSOC                                                 08096000
MDLASCI  EQU   MDLASSOC+1                                               08097000
FPLAREA  EQU   0                                                        08098000
FPLEEXT  EQU   FPLAREA                                                  08099000
FPLCRDT  EQU   FPLAREA+24                                               08100000
FPLEXPDT EQU   FPLAREA+48                                               08101000
EXPIREDT EQU   FPLAREA+72                                               08102000
EXPIRE   EQU   EXPIREDT+5                                               08103000
EXPIRYR  EQU   EXPIRE                                                   08104000
EXPIRDAY EQU   EXPIRE+1                                                 08105000
GENDATTR EQU   FPLAREA+80                                               08106000
GENDEPTY EQU   GENDATTR                                                 08107000
GENDSCR  EQU   GENDATTR                                                 08108000
GENDLIMT EQU   FPLAREA+81                                               08109000
ALRELNM  EQU   FPLAREA+88                                               08110000
AFPLAREA EQU   0                                                        08111000
ADSATRFL EQU   AFPLAREA                                                 08112000
ALRECLFL EQU   AFPLAREA+24                                              08113000
ABFSZFL  EQU   AFPLAREA+48                                              08114000
ASPACFL  EQU   AFPLAREA+72                                              08115000
ADEVTFL  EQU   AFPLAREA+96                                              08116000
AFSEQFL  EQU   AFPLAREA+120                                             08117000
DSETATTR EQU   AFPLAREA+144                                             08118000
@NM00087 EQU   DSETATTR                                                 08119000
AASPEED  EQU   @NM00087                                                 08120000
AAUNIQ   EQU   @NM00087                                                 08121000
AARVBL   EQU   @NM00087                                                 08122000
AATKOVFL EQU   @NM00087                                                 08123000
@NM00089 EQU   DSETATTR+1                                               08124000
SHRDEFLT EQU   @NM00089                                                 08125000
SPACPFLD EQU   AFPLAREA+146                                             08126000
PRIMESPC EQU   SPACPFLD                                                 08127000
SCONDSPC EQU   SPACPFLD+3                                               08128000
ASPACOPT EQU   SPACPFLD+6                                               08129000
FSNFIELD EQU   0                                                        08130000
FSNARRAY EQU   FSNFIELD                                                 08131000
FSNUMBER EQU   FSNARRAY                                                 08132000
DEVICLST EQU   0                                                        08133000
FPLAMDSB EQU   0                                                        08134000
KFPLAREA EQU   FPLAMDSB                                                 08135000
AMDAREA  EQU   FPLAMDSB+24                                              08136000
RANGEFDT EQU   0                                                        08137000
RGKEYLN  EQU   RANGEFDT                                                 08138000
RGKEY    EQU   RANGEFDT+1                                               08139000
RANGLIST EQU   0                                                        08140000
RGLISTLN EQU   RANGLIST                                                 08141000
RANGARRY EQU   RANGLIST+2                                               08142000
LOHIPAIR EQU   0                                                        08143000
LOHIKYLN EQU   LOHIPAIR                                                 08144000
LOHIKEY  EQU   LOHIPAIR+2                                               08145000
RGKYFPL  EQU   0                                                        08146000
FPLLKYLN EQU   RGKYFPL                                                  08147000
FPLLOKEY EQU   RGKYFPL+2                                                08148000
RGHKYFPL EQU   0                                                        08149000
FPLHKYLN EQU   RGHKYFPL                                                 08150000
FPLHIKEY EQU   RGHKYFPL+2                                               08151000
KEYMASK  EQU   0                                                        08152000
@NM00092 EQU   0                                                        08153000
LKYLEN   EQU   @NM00092                                                 08154000
LOKEY    EQU   @NM00092+2                                               08155000
@NM00093 EQU   0                                                        08156000
HIKYLEN  EQU   @NM00093                                                 08157000
HIKEY    EQU   @NM00093+2                                               08158000
@NM00094 EQU   0                                                        08159000
LKYCMPLN EQU   @NM00094                                                 08160000
LKYCOMP  EQU   @NM00094+2                                               08161000
@NM00095 EQU   0                                                        08162000
HKYCMPLN EQU   @NM00095                                                 08163000
HKYCOMP  EQU   @NM00095+2                                               08164000
PROTAREA EQU   0                                                        08165000
PASSWFPL EQU   PROTAREA                                                 08166000
RGATRFPL EQU   PROTAREA+24                                              08167000
OWNIDFPL EQU   PROTAREA+48                                              08168000
SPRMAREA EQU   PROTAREA+72                                              08169000
PWDOVLAY EQU   SPRMAREA                                                 08170000
PASSPRMT EQU   SPRMAREA+32                                              08171000
PASSATMP EQU   SPRMAREA+40                                              08172000
SVRMDUL  EQU   SPRMAREA+42                                              08173000
ARECLEN  EQU   SPRMAREA+50                                              08174000
AUTHREC  EQU   PROTAREA+124                                             08175000
RGATTR   EQU   PROTAREA+379                                             08176000
UPGUPD   EQU   RGATTR                                                   08177000
OWNERUID EQU   PROTAREA+380                                             08178000
OWNUIDLN EQU   PROTAREA+388                                             08179000
PROTATTR EQU   0                                                        08180000
@NM00100 EQU   PROTATTR                                                 08181000
PRUS     EQU   @NM00100                                                 08182000
PERASE   EQU   @NM00100                                                 08183000
@NM00102 EQU   PROTATTR+1                                               08184000
PSHARE1  EQU   @NM00102                                                 08185000
PSHARE2  EQU   @NM00102                                                 08186000
MODELWKA EQU   0                                                        08187000
MDLWKALN EQU   MODELWKA                                                 08188000
MDLRQDLN EQU   MODELWKA+2                                               08189000
MDTAB    EQU   0                                                        08190000
MDLETYPE EQU   MDTAB                                                    08191000
@NM00104 EQU   MDTAB+4                                                  08192000
MDLFLDLN EQU   @NM00104                                                 08193000
MDLFLDPT EQU   @NM00104+4                                               08194000
DATAVAL  EQU   0                                                        08195000
KEYFLDLN EQU   0                                                        08196000
CLATTR   EQU   0                                                        08197000
SWAPATTR EQU   CLATTR                                                   08198000
PAGEATTR EQU   CLATTR                                                   08199000
ALIAS    EQU   0                                                        08200000
ALIEN    EQU   0                                                        08201000
AMSTP011 EQU   0                                                        08202000
AMSTP041 EQU   0                                                        08203000
AMSTP042 EQU   0                                                        08204000
AMSTP043 EQU   0                                                        08205000
AMSTP044 EQU   0                                                        08206000
CAUTH    EQU   0                                                        08207000
CBIND    EQU   0                                                        08208000
CCYLD    EQU   0                                                        08209000
CCYLF    EQU   0                                                        08210000
CERAS    EQU   0                                                        08211000
CFSPC    EQU   0                                                        08212000
CIMBD    EQU   0                                                        08213000
CKEY     EQU   0                                                        08214000
CNERS    EQU   0                                                        08215000
CNIBD    EQU   0                                                        08216000
CNREP    EQU   0                                                        08217000
CNRUS    EQU   0                                                        08218000
CNSPD    EQU   0                                                        08219000
CNSTW    EQU   0                                                        08220000
CNWCK    EQU   0                                                        08221000
CORDR    EQU   0                                                        08222000
CRANG    EQU   0                                                        08223000
CRANGCNT EQU   0                                                        08224000
CRCDS    EQU   0                                                        08225000
CRECV    EQU   0                                                        08226000
CREPL    EQU   0                                                        08227000
CRGHIPTR EQU   0                                                        08228000
CRGLOPTR EQU   0                                                        08229000
CRSIZ    EQU   0                                                        08230000
CRUS     EQU   0                                                        08231000
CSHAR    EQU   0                                                        08232000
CSPED    EQU   0                                                        08233000
CSPND    EQU   0                                                        08234000
CSTAG    EQU   0                                                        08235000
CSTGW    EQU   0                                                        08236000
CSUBA    EQU   0                                                        08237000
CTRKS    EQU   0                                                        08238000
CUNIQ    EQU   0                                                        08239000
CUORD    EQU   0                                                        08240000
CWCK     EQU   0                                                        08241000
DATAA    EQU   0                                                        08242000
DAUTH    EQU   0                                                        08243000
DBIND    EQU   0                                                        08244000
DCYLD    EQU   0                                                        08245000
DCYLF    EQU   0                                                        08246000
DERAS    EQU   0                                                        08247000
DFSPC    EQU   0                                                        08248000
DKEY     EQU   0                                                        08249000
DMODL    EQU   0                                                        08250000
DMPTRM   EQU   0                                                        08251000
DNERS    EQU   0                                                        08252000
DNRUS    EQU   0                                                        08253000
DNRVL    EQU   0                                                        08254000
DNSPD    EQU   0                                                        08255000
DNSTW    EQU   0                                                        08256000
DNUQK    EQU   0                                                        08257000
DNWCK    EQU   0                                                        08258000
DORDR    EQU   0                                                        08259000
DRANG    EQU   0                                                        08260000
DRANGCNT EQU   0                                                        08261000
DRCDS    EQU   0                                                        08262000
DRECV    EQU   0                                                        08263000
DRGHIPTR EQU   0                                                        08264000
DRGLOPTR EQU   0                                                        08265000
DRSIZ    EQU   0                                                        08266000
DRUS     EQU   0                                                        08267000
DRVBL    EQU   0                                                        08268000
DSHAR    EQU   0                                                        08269000
DSPED    EQU   0                                                        08270000
DSPND    EQU   0                                                        08271000
DSTAG    EQU   0                                                        08272000
DSTGW    EQU   0                                                        08273000
DSUBA    EQU   0                                                        08274000
DTRKS    EQU   0                                                        08275000
DUNIQ    EQU   0                                                        08276000
DUNQK    EQU   0                                                        08277000
DUORD    EQU   0                                                        08278000
DWCK     EQU   0                                                        08279000
GAUTH    EQU   0                                                        08280000
GBIND    EQU   0                                                        08281000
GCYLD    EQU   0                                                        08282000
GCYLF    EQU   0                                                        08283000
GENDG    EQU   0                                                        08284000
GENEM    EQU   0                                                        08285000
GENNE    EQU   0                                                        08286000
GENNS    EQU   0                                                        08287000
GENSC    EQU   0                                                        08288000
GERAS    EQU   0                                                        08289000
GFSPC    EQU   0                                                        08290000
GIMBD    EQU   0                                                        08291000
GKEY     EQU   0                                                        08292000
GMODL    EQU   0                                                        08293000
GNERS    EQU   0                                                        08294000
GNIBD    EQU   0                                                        08295000
GNREP    EQU   0                                                        08296000
GNRUS    EQU   0                                                        08297000
GNSTW    EQU   0                                                        08298000
GNUPG    EQU   0                                                        08299000
GNUQK    EQU   0                                                        08300000
GNWCK    EQU   0                                                        08301000
GORDR    EQU   0                                                        08302000
GRANG    EQU   0                                                        08303000
GRANGCNT EQU   0                                                        08304000
GRCDS    EQU   0                                                        08305000
GRECV    EQU   0                                                        08306000
GREPL    EQU   0                                                        08307000
GRGHIPTR EQU   0                                                        08308000
GRGLOPTR EQU   0                                                        08309000
GRSIZ    EQU   0                                                        08310000
GRUS     EQU   0                                                        08311000
GSHAR    EQU   0                                                        08312000
GSPED    EQU   0                                                        08313000
GSTAG    EQU   0                                                        08314000
GSTGW    EQU   0                                                        08315000
GSUBA    EQU   0                                                        08316000
GTRKS    EQU   0                                                        08317000
GUNIQ    EQU   0                                                        08318000
GUNQK    EQU   0                                                        08319000
GUORD    EQU   0                                                        08320000
GUPG     EQU   0                                                        08321000
GWCK     EQU   0                                                        08322000
IAUTH    EQU   0                                                        08323000
IBIND    EQU   0                                                        08324000
ICYLD    EQU   0                                                        08325000
ICYLF    EQU   0                                                        08326000
IDCIOCL0 EQU   0                                                        08327000
IDCIOCO0 EQU   0                                                        08328000
IDCIOGT0 EQU   0                                                        08329000
IDCIOIT0 EQU   0                                                        08330000
IDCIOOP0 EQU   0                                                        08331000
IDCIOPO0 EQU   0                                                        08332000
IDCIOPT0 EQU   0                                                        08333000
IDCIOSI0 EQU   0                                                        08334000
IDCIOST0 EQU   0                                                        08335000
IDCIOTM0 EQU   0                                                        08336000
IDCIOVY0 EQU   0                                                        08337000
IDCIO050 EQU   0                                                        08338000
IDCSAAL0 EQU   0                                                        08339000
IDCSACL0 EQU   0                                                        08340000
IDCSACR0 EQU   0                                                        08341000
IDCSADE0 EQU   0                                                        08342000
IDCSADL0 EQU   0                                                        08343000
IDCSADQ0 EQU   0                                                        08344000
IDCSAFP0 EQU   0                                                        08345000
IDCSAFS0 EQU   0                                                        08346000
IDCSAGS0 EQU   0                                                        08347000
IDCSALC0 EQU   0                                                        08348000
IDCSALD0 EQU   0                                                        08349000
IDCSALK0 EQU   0                                                        08350000
IDCSANQ0 EQU   0                                                        08351000
IDCSAPR0 EQU   0                                                        08352000
IDCSAPT0 EQU   0                                                        08353000
IDCSARC0 EQU   0                                                        08354000
IDCSARV0 EQU   0                                                        08355000
IDCSASC0 EQU   0                                                        08356000
IDCSASI0 EQU   0                                                        08357000
IDCSASN0 EQU   0                                                        08358000
IDCSASS0 EQU   0                                                        08359000
IDCSAST0 EQU   0                                                        08360000
IDCSAUC0 EQU   0                                                        08361000
IDCSAWO0 EQU   0                                                        08362000
IDCSA060 EQU   0                                                        08363000
IDCST010 EQU   0                                                        08364000
IDCTPER0 EQU   0                                                        08365000
IIMBD    EQU   0                                                        08366000
IMODL    EQU   0                                                        08367000
INIBD    EQU   0                                                        08368000
INREP    EQU   0                                                        08369000
INRUS    EQU   0                                                        08370000
INSTW    EQU   0                                                        08371000
INWCK    EQU   0                                                        08372000
IORDR    EQU   0                                                        08373000
IRCDS    EQU   0                                                        08374000
IREPL    EQU   0                                                        08375000
IRUS     EQU   0                                                        08376000
ISHAR    EQU   0                                                        08377000
ISTAG    EQU   0                                                        08378000
ISTGW    EQU   0                                                        08379000
ISUBA    EQU   0                                                        08380000
ITRKS    EQU   0                                                        08381000
IUNIQ    EQU   0                                                        08382000
IUORD    EQU   0                                                        08383000
IWCK     EQU   0                                                        08384000
LISTTEST EQU   0                                                        08385000
MAUTH    EQU   0                                                        08386000
MCYLD    EQU   0                                                        08387000
MDIOCSPT EQU   0                                                        08388000
MDLOWNER EQU   0                                                        08389000
MNRVL    EQU   0                                                        08390000
MNSTW    EQU   0                                                        08391000
MNWCK    EQU   0                                                        08392000
MRCDS    EQU   0                                                        08393000
MRVBL    EQU   0                                                        08394000
MSTGW    EQU   0                                                        08395000
MTRKS    EQU   0                                                        08396000
MWCK     EQU   0                                                        08397000
NEWERID1 EQU   5                                                        08398000
PAUTH    EQU   0                                                        08399000
PCYLD    EQU   0                                                        08400000
PERAS    EQU   0                                                        08401000
PMODL    EQU   0                                                        08402000
PNERS    EQU   0                                                        08403000
PRCDS    EQU   0                                                        08404000
PSUBA    EQU   0                                                        08405000
PTRKS    EQU   0                                                        08406000
PUNIQ    EQU   0                                                        08407000
RAUTH    EQU   0                                                        08408000
RMODL    EQU   0                                                        08409000
RNUPD    EQU   0                                                        08410000
RUPD     EQU   0                                                        08411000
SCAND    EQU   0                                                        08412000
SCYLD    EQU   0                                                        08413000
SPACE    EQU   0                                                        08414000
SRCDS    EQU   0                                                        08415000
SRSIZ    EQU   0                                                        08416000
STRKS    EQU   0                                                        08417000
UAUTH    EQU   0                                                        08418000
UCYLD    EQU   0                                                        08419000
UMODL    EQU   0                                                        08420000
UNRVL    EQU   0                                                        08421000
UNSTW    EQU   0                                                        08422000
UNWCK    EQU   0                                                        08423000
URCDS    EQU   0                                                        08424000
URVBL    EQU   0                                                        08425000
USTGW    EQU   0                                                        08426000
UTRKS    EQU   0                                                        08427000
UWCK     EQU   0                                                        08428000
GDTTBL   EQU   0                                                        08429000
GDTTR1   EQU   GDTTBL+8                                                 08430000
GDTTR2   EQU   GDTTBL+12                                                08431000
GDTDBG   EQU   GDTTBL+40                                                08432000
GDTSTC   EQU   GDTTBL+44                                                08433000
GDTPRT   EQU   GDTTBL+48                                                08434000
GDTESS   EQU   GDTTBL+52                                                08435000
GDTESA   EQU   GDTTBL+56                                                08436000
GDTRST   EQU   GDTTBL+60                                                08437000
GDTRES   EQU   GDTTBL+64                                                08438000
GDTCAL   EQU   GDTTBL+68                                                08439000
GDTGSP   EQU   GDTTBL+72                                                08440000
GDTFSP   EQU   GDTTBL+76                                                08441000
GDTGPL   EQU   GDTTBL+80                                                08442000
GDTFPL   EQU   GDTTBL+84                                                08443000
GDTLOD   EQU   GDTTBL+88                                                08444000
GDTDEL   EQU   GDTTBL+92                                                08445000
GDTPRL   EQU   GDTTBL+96                                                08446000
GDTEPL   EQU   GDTTBL+100                                               08447000
GDTTIM   EQU   GDTTBL+104                                               08448000
GDTIIO   EQU   GDTTBL+108                                               08449000
GDTTIO   EQU   GDTTBL+112                                               08450000
GDTOPN   EQU   GDTTBL+124                                               08451000
GDTCLS   EQU   GDTTBL+128                                               08452000
GDTGET   EQU   GDTTBL+132                                               08453000
GDTPUT   EQU   GDTTBL+136                                               08454000
GDTPOS   EQU   GDTTBL+140                                               08455000
GDTCPY   EQU   GDTTBL+144                                               08456000
GDTCAT   EQU   GDTTBL+148                                               08457000
GDTSNP   EQU   GDTTBL+164                                               08458000
GDTVFY   EQU   GDTTBL+172                                               08459000
GDTUID   EQU   GDTTBL+192                                               08460000
GDTPMT   EQU   GDTTBL+196                                               08461000
GDTCIR   EQU   GDTTBL+200                                               08462000
GDTLNK   EQU   GDTTBL+204                                               08463000
GDTALC   EQU   GDTTBL+208                                               08464000
GDTDLC   EQU   GDTTBL+212                                               08465000
GDTQAL   EQU   GDTTBL+216                                               08466000
GDTSTW   EQU   GDTTBL+220                                               08467000
GDTSSC   EQU   GDTTBL+224                                               08468000
GDTENQ   EQU   GDTTBL+228                                               08469000
GDTRSV   EQU   GDTTBL+232                                               08470000
GDTDEQ   EQU   GDTTBL+236                                               08471000
GDTSFO   EQU   GDTTBL+240                                               08472000
GDTWTO   EQU   GDTTBL+244                                               08473000
GDTSCR   EQU   GDTTBL+248                                               08474000
GDTUNT   EQU   GDTTBL+252                                               08475000
GDTRCT   EQU   GDTTBL+256                                               08476000
GDTIFO   EQU   GDTTBL+260                                               08477000
GDTEXP   EQU   GDTTBL+264                                               08478000
GDTSTA   EQU   GDTTBL+268                                               08479000
GDTERR   EQU   GDTTBL+272                                               08480000
GDTUNC   EQU   GDTTBL+276                                               08481000
GDTLOC   EQU   GDTTBL+280                                               08482000
FDTTBLX  EQU   0                                                        08483000
COMAREA  EQU   0                                                        08484000
DEPLPTR  EQU   COMAREA                                                  08485000
CTGPLPTR EQU   COMAREA+4                                                08486000
CTGFVPTR EQU   COMAREA+8                                                08487000
DSBCATPT EQU   COMAREA+12                                               08488000
MDLTBLPT EQU   COMAREA+16                                               08489000
ASCNAMES EQU   COMAREA+20                                               08490000
IASCNMID EQU   ASCNAMES                                                 08491000
IASCNAME EQU   ASCNAMES+1                                               08492000
DASCNMID EQU   ASCNAMES+4                                               08493000
DASCNAME EQU   ASCNAMES+5                                               08494000
CTGRTNCC EQU   COMAREA+36                                               08495000
ALLCFLAG EQU   COMAREA+40                                               08496000
PROTFLAG EQU   COMAREA+41                                               08497000
NAMEFLG  EQU   COMAREA+42                                               08498000
KEYFLAG  EQU   COMAREA+44                                               08499000
PGSPFLAG EQU   COMAREA+45                                               08500000
SWAPFLAG EQU   COMAREA+46                                               08501000
PSWDWARN EQU   COMAREA+47                                               08502000
DEFSTID  EQU   COMAREA+57                                               08503000
CATOPEN  EQU   COMAREA+68                                               08504000
@NM00053 EQU   CATOPEN+4                                                08505000
ETRY     EQU   0                                                        08506000
ETO      EQU   0                                                        08507000
EFOR     EQU   0                                                        08508000
EGENSC   EQU   0                                                        08509000
EGENEM   EQU   0                                                        08510000
EGENLM   EQU   0                                                        08511000
EALREL   EQU   0                                                        08512000
EEEXT    EQU   0                                                        08513000
EREL     EQU   0                                                        08514000
EMODLTAB EQU   0                                                        08515000
AINDDN   EQU   0                                                        08516000
AVLSR    EQU   0                                                        08517000
AORDR    EQU   0                                                        08518000
AUORD    EQU   0                                                        08519000
ASUBA    EQU   0                                                        08520000
AUNIQ    EQU   0                                                        08521000
ATRKS    EQU   0                                                        08522000
ACYLD    EQU   0                                                        08523000
ARCDS    EQU   0                                                        08524000
APTRK    EQU   0                                                        08525000
APCYL    EQU   0                                                        08526000
APRCD    EQU   0                                                        08527000
ASTRK    EQU   0                                                        08528000
ASCYL    EQU   0                                                        08529000
ASRCD    EQU   0                                                        08530000
ACAND    EQU   0                                                        08531000
ARSIZ    EQU   0                                                        08532000
AARSZ    EQU   0                                                        08533000
AMRSZ    EQU   0                                                        08534000
AWCHK    EQU   0                                                        08535000
ANWCK    EQU   0                                                        08536000
ASPED    EQU   0                                                        08537000
ARECV    EQU   0                                                        08538000
AFSPC    EQU   0                                                        08539000
ACIFS    EQU   0                                                        08540000
ACAFS    EQU   0                                                        08541000
ABFSZ    EQU   0                                                        08542000
ACINV    EQU   0                                                        08543000
ADEVICE  EQU   0                                                        08544000
AAFSNO   EQU   0                                                        08545000
ARVBL    EQU   0                                                        08546000
ANRVL    EQU   0                                                        08547000
ASTAGE   EQU   0                                                        08548000
ABINDD   EQU   0                                                        08549000
ACYLFF   EQU   0                                                        08550000
ANSTGW   EQU   0                                                        08551000
ASTGWW   EQU   0                                                        08552000
AMDTBL   EQU   0                                                        08553000
KEY      EQU   0                                                        08554000
KYPS     EQU   0                                                        08555000
KYLN     EQU   0                                                        08556000
RANGE    EQU   0                                                        08557000
RANGECNT EQU   0                                                        08558000
RNGLOPTR EQU   0                                                        08559000
RNGHIPTR EQU   0                                                        08560000
KSPND    EQU   0                                                        08561000
KNSPD    EQU   0                                                        08562000
KUNQK    EQU   0                                                        08563000
KNUQK    EQU   0                                                        08564000
KYMDLTAB EQU   0                                                        08565000
REPL     EQU   0                                                        08566000
NREP     EQU   0                                                        08567000
IMBD     EQU   0                                                        08568000
NIBD     EQU   0                                                        08569000
IXMDLTAB EQU   0                                                        08570000
AMASTER  EQU   0                                                        08571000
ACINT    EQU   0                                                        08572000
AUPDATE  EQU   0                                                        08573000
AREAD    EQU   0                                                        08574000
AMXATTMP EQU   0                                                        08575000
APWPRMT  EQU   0                                                        08576000
AUSVRNM  EQU   0                                                        08577000
AUSERARC EQU   0                                                        08578000
AOWNRID  EQU   0                                                        08579000
AERASE   EQU   0                                                        08580000
ANERS    EQU   0                                                        08581000
ASHAR1   EQU   0                                                        08582000
ASHAR2   EQU   0                                                        08583000
ARUS     EQU   0                                                        08584000
ANRUS    EQU   0                                                        08585000
AUPG     EQU   0                                                        08586000
ANUPG    EQU   0                                                        08587000
PMDLTABL EQU   0                                                        08588000
ENAM     EQU   0                                                        08589000
ENAMPLN  EQU   0                                                        08590000
ENAMPAS  EQU   0                                                        08591000
MDCT     EQU   0                                                        08592000
MDCTPLN  EQU   0                                                        08593000
MDCTPAS  EQU   0                                                        08594000
MDNM     EQU   0                                                        08595000
ASCNAME  EQU   0                                                        08596000
MDLACBPT EQU   0                                                        08597000
MODELTAB EQU   0                                                        08598000
@NM00047 EQU   CTGDDNM                                                  08599000
CTGPROB  EQU   @NM00047                                                 08600000
CTGREASN EQU   CTGPROB+2                                                08601000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08602000
CTGREAS2 EQU   CTGREASN+1                                               08603000
CTGREAS1 EQU   CTGREASN                                                 08604000
CTGMODID EQU   CTGPROB                                                  08605000
DEACBAD  EQU   @NM00053+4                                               08606000
DEIOCS   EQU   @NM00053                                                 08607000
CATINDEX EQU   CATOPEN                                                  08608000
DDSTRU2  EQU   COMAREA+64                                               08609000
DEFSTD   EQU   DEFSTID+4                                                08610000
DEFCOND  EQU   DEFSTID+3                                                08611000
DEFMODID EQU   DEFSTID                                                  08612000
DEFSTIDL EQU   COMAREA+48                                               08613000
STRCTYPE EQU   COMAREA+43                                               08614000
CTGRTNID EQU   COMAREA+28                                               08615000
GDTECT   EQU   GDTTBL+188                                               08616000
GDTPSB   EQU   GDTTBL+184                                               08617000
GDTUPT   EQU   GDTTBL+180                                               08618000
GDTCMB   EQU   GDTTBL+176                                               08619000
GDTSPR   EQU   GDTTBL+168                                               08620000
@NM00001 EQU   GDTTBL+160                                               08621000
GDTABH   EQU   GDTTBL+156                                               08622000
GDTABT   EQU   GDTTBL+152                                               08623000
GDTTOH   EQU   GDTTBL+120                                               08624000
GDTRIP   EQU   GDTTBL+116                                               08625000
GDTIOH   EQU   GDTTBL+36                                                08626000
GDTSAH   EQU   GDTTBL+32                                                08627000
GDTTPH   EQU   GDTTBL+28                                                08628000
GDTRIH   EQU   GDTTBL+24                                                08629000
GDTSTH   EQU   GDTTBL+20                                                08630000
GDTDBH   EQU   GDTTBL+16                                                08631000
GDTPRM   EQU   GDTTBL+4                                                 08632000
GDTHDR   EQU   GDTTBL                                                   08633000
@NM00105 EQU   CLATTR                                                   08634000
@NM00103 EQU   MDTAB+1                                                  08635000
MDLDATA  EQU   MODELWKA+4                                               08636000
@NM00101 EQU   @NM00100                                                 08637000
@NM00099 EQU   RGATTR                                                   08638000
@NM00098 EQU   PROTAREA+64                                              08639000
@NM00097 EQU   PROTAREA+40                                              08640000
@NM00096 EQU   PROTAREA+16                                              08641000
@NM00091 EQU   FPLAMDSB+16                                              08642000
@NM00090 EQU   @NM00089                                                 08643000
@NM00088 EQU   @NM00087                                                 08644000
AAINHIB  EQU   @NM00087                                                 08645000
AAERASE  EQU   @NM00087                                                 08646000
AARUS    EQU   @NM00087                                                 08647000
@NM00086 EQU   AFPLAREA+136                                             08648000
@NM00085 EQU   AFPLAREA+112                                             08649000
@NM00084 EQU   AFPLAREA+88                                              08650000
@NM00083 EQU   AFPLAREA+64                                              08651000
@NM00082 EQU   AFPLAREA+40                                              08652000
@NM00081 EQU   AFPLAREA+16                                              08653000
ALRELPTR EQU   FPLAREA+84                                               08654000
ALRELLN  EQU   FPLAREA+82                                               08655000
@NM00078 EQU   GENDATTR                                                 08656000
@NM00077 EQU   EXPIREDT                                                 08657000
@NM00076 EQU   FPLAREA+64                                               08658000
@NM00075 EQU   FPLAREA+40                                               08659000
@NM00074 EQU   FPLAREA+16                                               08660000
MDLHKEY  EQU   @NM00073+2                                               08661000
MDLHKYLN EQU   @NM00073                                                 08662000
MDLLKEY  EQU   @NM00072+2                                               08663000
MDLLKYLN EQU   @NM00072                                                 08664000
DEMDLTAB EQU   DECPLFPL+756                                             08665000
@NM00071 EQU   RECVSWKA+10                                              08666000
RECVSVOL EQU   RECVSWKA+4                                               08667000
RECVSRET EQU   RECVSWKA+2                                               08668000
GENAME   EQU   @NM00070+1                                               08669000
GENMTYPE EQU   @NM00070                                                 08670000
DEAM0LEN EQU   DEWKAREA+2                                               08671000
DEUSERLN EQU   DEWKAREA                                                 08672000
DEWKAID  EQU   DECPLFPL+476                                             08673000
@NM00069 EQU   DECPLFPL+468                                             08674000
DATAFVT  EQU   DECPLFPL+376                                             08675000
DATAID   EQU   DECPLFPL+368                                             08676000
@NM00068 EQU   DECPLFPL+360                                             08677000
INDEXFVT EQU   DECPLFPL+268                                             08678000
INDEXID  EQU   DECPLFPL+260                                             08679000
@NM00067 EQU   DECPLFPL+252                                             08680000
VOLFVT   EQU   DECPLFPL+160                                             08681000
VOLID    EQU   DECPLFPL+152                                             08682000
@NM00066 EQU   DECPLFPL+144                                             08683000
CLSTRFVT EQU   DECPLFPL+52                                              08684000
CLSTRID  EQU   DECPLFPL+44                                              08685000
@NM00065 EQU   DECPLFPL+36                                              08686000
DECPL    EQU   DECPLFPL+8                                               08687000
CPLID    EQU   DECPLFPL                                                 08688000
MDLPWLEN EQU   MDLTABL+124                                              08689000
MDLRGLEN EQU   MDLTABL+116                                              08690000
MDLEELEN EQU   MDLTABL+108                                              08691000
MDLASLEN EQU   MDLTABL+100                                              08692000
MDLBFLEN EQU   MDLTABL+92                                               08693000
MDLLRLEN EQU   MDLTABL+84                                               08694000
MDLSPLEN EQU   MDLTABL+76                                               08695000
MDLDBLEN EQU   MDLTABL+44                                               08696000
MDLATLEN EQU   MDLTABL+36                                               08697000
MDLOWLEN EQU   MDLTABL+28                                               08698000
MDLEXLEN EQU   MDLTABL+20                                               08699000
MDLACBXL EQU   MDLTABL+12                                               08700000
MDLENTYP EQU   MDLTABL+8                                                08701000
MDLENTLN EQU   MDLTABL+4                                                08702000
@NM00064 EQU   MDLTABL+1                                                08703000
@NM00063 EQU   VLISTCDE+1                                               08704000
VLISTCC  EQU   VLISTCDE                                                 08705000
NAMMELM  EQU   @NM00061+12                                              08706000
NAMMLEN  EQU   @NM00061+11                                              08707000
NAMPOS   EQU   @NM00061+9                                               08708000
LISTLEN1 EQU   @NM00060                                                 08709000
LISTLEN  EQU   @NM00058                                                 08710000
CTGFVCPP EQU   CTGFVPWD                                                 08711000
CTGFVTTR EQU   CTGFVSPC                                                 08712000
CTGFVVCH EQU   CTGFV+12                                                 08713000
CTGFVICH EQU   CTGFV+8                                                  08714000
CTGFVDCH EQU   CTGFV+4                                                  08715000
@NM00052 EQU   CTGFV+3                                                  08716000
CTGFVELM EQU   CTGFV+2                                                  08717000
@NM00051 EQU   CTGFVPRO                                                 08718000
CTGFVROF EQU   CTGFVPRO                                                 08719000
CTGFVRON EQU   CTGFVPRO                                                 08720000
CTGFVDRC EQU   CTGFVPRO                                                 08721000
CTGFVNDC EQU   CTGFVPRO                                                 08722000
CTGFVRVL EQU   CTGFVPRO                                                 08723000
CTGFVAVL EQU   CTGFVPRO                                                 08724000
AMDEXCP  EQU   AMDSTAT+44                                               08725000
AMDNCAS  EQU   AMDSTAT+40                                               08726000
AMDNCIS  EQU   AMDSTAT+36                                               08727000
AMDASPA  EQU   AMDSTAT+32                                               08728000
AMDRETR  EQU   AMDSTAT+28                                               08729000
AMDUPR   EQU   AMDSTAT+24                                               08730000
AMDIREC  EQU   AMDSTAT+20                                               08731000
AMDDELR  EQU   AMDSTAT+16                                               08732000
AMDNLR   EQU   AMDSTAT+12                                               08733000
AMDNEXT  EQU   AMDSTAT+10                                               08734000
AMDNIL   EQU   AMDSTAT+8                                                08735000
AMDSTSP  EQU   AMDSTAT                                                  08736000
@NM00050 EQU   IDAAMDSB+41                                              08737000
@NM00049 EQU   AMDATTR3                                                 08738000
AMDLM    EQU   AMDATTR3                                                 08739000
AMDPARDB EQU   IDAAMDSB+36                                              08740000
AMDMAXRR EQU   AMDSSRBA                                                 08741000
AMDNSLOT EQU   AMDHLRBA                                                 08742000
AMDFSCI  EQU   IDAAMDSB+16                                              08743000
AMDFSCA  EQU   IDAAMDSB+14                                              08744000
AMDCIPCA EQU   IDAAMDSB+12                                              08745000
AMDSBID  EQU   IDAAMDSB                                                 08746000
CTGFLDWA EQU   CTGFL+4                                                  08747000
CTGFLDTS EQU   CTGFLDRE                                                 08748000
@NM00048 EQU   CTGFLDRE                                                 08749000
CTGFLDGC EQU   CTGFL+2                                                  08750000
@NM00046 EQU   CTGFBFLG                                                 08751000
CTGNGDSN EQU   CTGFBFLG                                                 08752000
CTGGDGB  EQU   CTGFBFLG                                                 08753000
CTGKEEP  EQU   CTGFBFLG                                                 08754000
CTGPAR   EQU   CTGFBFLG                                                 08755000
CTGFDBK  EQU   CTGNEWNM                                                 08756000
@NM00045 EQU   CTGDSORG                                                 08757000
CTGOPTNS EQU   CTGDSORG                                                 08758000
CTGCVOL  EQU   CTGCAT                                                   08759000
@NM00044 EQU   CTGOPTN4                                                 08760000
CTGTIOT  EQU   CTGOPTN4                                                 08761000
CTGBYPMT EQU   CTGOPTN4                                                 08762000
CTGCOIN  EQU   CTGOPTN4                                                 08763000
@NM00043 EQU   CTGOPTN4                                                 08764000
CTGDOCAT EQU   CTGOPTN4                                                 08765000
CTGLBASE EQU   CTGOPTN4                                                 08766000
CTGGDGL  EQU   CTGOPTN3                                                 08767000
CTGSUPLT EQU   CTGOPTN3                                                 08768000
@NM00042 EQU   CTGOPTN2                                                 08769000
CTGSCR   EQU   CTGOPTN2                                                 08770000
CTGOVRID EQU   CTGOPTN2                                                 08771000
CTGDISC  EQU   CTGOPTN2                                                 08772000
CTGGTNXT EQU   CTGOPTN2                                                 08773000
CTGRCATN EQU   CTGVMNT                                                  08774000
CTGGTALL EQU   CTGREL                                                   08775000
CTGNSVS  EQU   CTGEXT                                                   08776000
CTGGENLD EQU   CTGOPTN1                                                 08777000
CTGREAD  EQU   CTGOPTN1                                                 08778000
CTGUPD   EQU   CTGOPTN1                                                 08779000
CTGCI    EQU   CTGOPTN1                                                 08780000
CTGMAST  EQU   CTGOPTN1                                                 08781000
CTGBYPSS EQU   CTGOPTN1                                                 08782000
RPENTVAL EQU   RPENT+21                                                 08783000
RPENTLEN EQU   RPENT+20                                                 08784000
RPENTMEM EQU   RPENT+12                                                 08785000
RPENTMLN EQU   RPENT+11                                                 08786000
RPENTFUQ EQU   RPENTFLG                                                 08787000
RPENTPOS EQU   RPENT+9                                                  08788000
RPENTPAS EQU   RPENT+1                                                  08789000
RPENTPLN EQU   RPENT                                                    08790000
IEEXTVAL EQU   IEEXT+1                                                  08791000
IEEXTLEN EQU   IEEXT                                                    08792000
DEEXTVAL EQU   DEEXT+1                                                  08793000
DEEXTLEN EQU   DEEXT                                                    08794000
GEEXTVAL EQU   GEEXT+1                                                  08795000
GEEXTLEN EQU   GEEXT                                                    08796000
CEEXTVAL EQU   CEEXT+1                                                  08797000
CEEXTLEN EQU   CEEXT                                                    08798000
GRELVAL  EQU   GREL+21                                                  08799000
GRELLEN  EQU   GREL+20                                                  08800000
GRELMEM  EQU   GREL+12                                                  08801000
GRELMLN  EQU   GREL+11                                                  08802000
GRELFUQ  EQU   GRELFLG                                                  08803000
GRELPOS  EQU   GREL+9                                                   08804000
GRELPAS  EQU   GREL+1                                                   08805000
GRELPLN  EQU   GREL                                                     08806000
GENLMVAL EQU   GENLM                                                    08807000
ALRELVAL EQU   ALREL+21                                                 08808000
ALRELLEN EQU   ALREL+20                                                 08809000
ALRELMEM EQU   ALREL+12                                                 08810000
ALRELMLN EQU   ALREL+11                                                 08811000
ALRELFUQ EQU   ALRELFLG                                                 08812000
ALRELPOS EQU   ALREL+9                                                  08813000
ALRELPAS EQU   ALREL+1                                                  08814000
ALRELPLN EQU   ALREL                                                    08815000
ICINVVAL EQU   ICINV                                                    08816000
DCINVVAL EQU   DCINV                                                    08817000
GCINVVAL EQU   GCINV                                                    08818000
CCINVVAL EQU   CCINV                                                    08819000
DBFSZVAL EQU   DBFSZ                                                    08820000
GBFSZVAL EQU   GBFSZ                                                    08821000
UBFSZVAL EQU   UBFSZ                                                    08822000
CBFSZVAL EQU   CBFSZ                                                    08823000
MBFSZVAL EQU   MBFSZ                                                    08824000
DCAFSVAL EQU   DCAFS                                                    08825000
DCIFSVAL EQU   DCIFS                                                    08826000
GCAFSVAL EQU   GCAFS                                                    08827000
CCAFSVAL EQU   CCAFS                                                    08828000
GCIFSVAL EQU   GCIFS                                                    08829000
CCIFSVAL EQU   CCIFS                                                    08830000
DMRSZVAL EQU   DMRSZ                                                    08831000
DARSZVAL EQU   DARSZ                                                    08832000
GMRSZVAL EQU   GMRSZ                                                    08833000
SMRSZVAL EQU   SMRSZ                                                    08834000
CMRSZVAL EQU   CMRSZ                                                    08835000
GARSZVAL EQU   GARSZ                                                    08836000
SARSZVAL EQU   SARSZ                                                    08837000
CARSZVAL EQU   CARSZ                                                    08838000
IRCSCVAL EQU   IRCSC                                                    08839000
ICLSCVAL EQU   ICLSC                                                    08840000
ITKSCVAL EQU   ITKSC                                                    08841000
DRCSCVAL EQU   DRCSC                                                    08842000
DCLSCVAL EQU   DCLSC                                                    08843000
DTKSCVAL EQU   DTKSC                                                    08844000
GRCSCVAL EQU   GRCSC                                                    08845000
GCLSCVAL EQU   GCLSC                                                    08846000
GTKSCVAL EQU   GTKSC                                                    08847000
PRCSCVAL EQU   PRCSC                                                    08848000
URCSCVAL EQU   URCSC                                                    08849000
SRCSCVAL EQU   SRCSC                                                    08850000
CRCSCVAL EQU   CRCSC                                                    08851000
MRCSCVAL EQU   MRCSC                                                    08852000
SCLSCVAL EQU   SCLSC                                                    08853000
PCLSCVAL EQU   PCLSC                                                    08854000
UCLSCVAL EQU   UCLSC                                                    08855000
CCLSCVAL EQU   CCLSC                                                    08856000
MCLSCVAL EQU   MCLSC                                                    08857000
PTKSCVAL EQU   PTKSC                                                    08858000
UTKSCVAL EQU   UTKSC                                                    08859000
STKSCVAL EQU   STKSC                                                    08860000
CTKSCVAL EQU   CTKSC                                                    08861000
MTKSCVAL EQU   MTKSC                                                    08862000
IRCPRVAL EQU   IRCPR                                                    08863000
ICLPRVAL EQU   ICLPR                                                    08864000
ITKPRVAL EQU   ITKPR                                                    08865000
DRCPRVAL EQU   DRCPR                                                    08866000
DCLPRVAL EQU   DCLPR                                                    08867000
DTKPRVAL EQU   DTKPR                                                    08868000
GRCPRVAL EQU   GRCPR                                                    08869000
GCLPRVAL EQU   GCLPR                                                    08870000
GTKPRVAL EQU   GTKPR                                                    08871000
PRCPRVAL EQU   PRCPR                                                    08872000
URCPRVAL EQU   URCPR                                                    08873000
SRCPRVAL EQU   SRCPR                                                    08874000
CRCPRVAL EQU   CRCPR                                                    08875000
MRCPRVAL EQU   MRCPR                                                    08876000
SCLPRVAL EQU   SCLPR                                                    08877000
PCLPRVAL EQU   PCLPR                                                    08878000
UCLPRVAL EQU   UCLPR                                                    08879000
CCLPRVAL EQU   CCLPR                                                    08880000
MCLPRVAL EQU   MCLPR                                                    08881000
PTKPRVAL EQU   PTKPR                                                    08882000
UTKPRVAL EQU   UTKPR                                                    08883000
STKPRVAL EQU   STKPR                                                    08884000
CTKPRVAL EQU   CTKPR                                                    08885000
MTKPRVAL EQU   MTKPR                                                    08886000
ADEVTVAL EQU   @NM00041+1                                               08887000
ADEVTLEN EQU   @NM00041                                                 08888000
ADEVTCNT EQU   ADEVT                                                    08889000
DRGHIVAL EQU   DRGHI+1                                                  08890000
DRGHILEN EQU   DRGHI                                                    08891000
DRGLOVAL EQU   DRGLO+1                                                  08892000
DRGLOLEN EQU   DRGLO                                                    08893000
GRGHIVAL EQU   GRGHI+1                                                  08894000
GRGHILEN EQU   GRGHI                                                    08895000
GRGLOVAL EQU   GRGLO+1                                                  08896000
GRGLOLEN EQU   GRGLO                                                    08897000
CRGHIVAL EQU   CRGHI+1                                                  08898000
CRGHILEN EQU   CRGHI                                                    08899000
CRGLOVAL EQU   CRGLO+1                                                  08900000
CRGLOLEN EQU   CRGLO                                                    08901000
IVSERVAL EQU   @NM00040+1                                               08902000
IVSERLEN EQU   @NM00040                                                 08903000
IVSERCNT EQU   IVSER                                                    08904000
DVSERVAL EQU   @NM00039+1                                               08905000
DVSERLEN EQU   @NM00039                                                 08906000
DVSERCNT EQU   DVSER                                                    08907000
GVSERVAL EQU   @NM00038+1                                               08908000
GVSERLEN EQU   @NM00038                                                 08909000
GVSERCNT EQU   GVSER                                                    08910000
AVSERVAL EQU   @NM00037+1                                               08911000
AVSERLEN EQU   @NM00037                                                 08912000
AVSERCNT EQU   AVSER                                                    08913000
SVSERVAL EQU   @NM00036+1                                               08914000
SVSERLEN EQU   @NM00036                                                 08915000
SVSERCNT EQU   SVSER                                                    08916000
CVSERVAL EQU   @NM00035+1                                               08917000
CVSERLEN EQU   @NM00035                                                 08918000
CVSERCNT EQU   CVSER                                                    08919000
PVSERVAL EQU   @NM00034+1                                               08920000
PVSERLEN EQU   @NM00034                                                 08921000
PVSERCNT EQU   PVSER                                                    08922000
UVSERVAL EQU   @NM00033+1                                               08923000
UVSERLEN EQU   @NM00033                                                 08924000
UVSERCNT EQU   UVSER                                                    08925000
MVSERVAL EQU   @NM00032+1                                               08926000
MVSERLEN EQU   @NM00032                                                 08927000
MVSERCNT EQU   MVSER                                                    08928000
IINDDVAL EQU   IINDD+1                                                  08929000
IINDDLEN EQU   IINDD                                                    08930000
DINDDVAL EQU   DINDD+1                                                  08931000
DINDDLEN EQU   DINDD                                                    08932000
RINDDVAL EQU   RINDD+1                                                  08933000
RINDDLEN EQU   RINDD                                                    08934000
GINDDVAL EQU   GINDD+1                                                  08935000
GINDDLEN EQU   GINDD                                                    08936000
AINDDVAL EQU   AINDD+1                                                  08937000
AINDDLEN EQU   AINDD                                                    08938000
SINDDVAL EQU   SINDD+1                                                  08939000
SINDDLEN EQU   SINDD                                                    08940000
PINDDVAL EQU   PINDD+1                                                  08941000
PINDDLEN EQU   PINDD                                                    08942000
UINDDVAL EQU   UINDD+1                                                  08943000
UINDDLEN EQU   UINDD                                                    08944000
CINDDVAL EQU   CINDD+1                                                  08945000
CINDDLEN EQU   CINDD                                                    08946000
MINDDVAL EQU   MINDD+1                                                  08947000
MINDDLEN EQU   MINDD                                                    08948000
DKYPSVAL EQU   DKYPS                                                    08949000
DKYLNVAL EQU   DKYLN                                                    08950000
GKYPSVAL EQU   GKYPS                                                    08951000
GKYLNVAL EQU   GKYLN                                                    08952000
CKYPSVAL EQU   CKYPS                                                    08953000
CKYLNVAL EQU   CKYLN                                                    08954000
ISHR2VAL EQU   ISHR2                                                    08955000
ISHR1VAL EQU   ISHR1                                                    08956000
DSHR2VAL EQU   DSHR2                                                    08957000
DSHR1VAL EQU   DSHR1                                                    08958000
GSHR2VAL EQU   GSHR2                                                    08959000
CSHR2VAL EQU   CSHR2                                                    08960000
GSHR1VAL EQU   GSHR1                                                    08961000
CSHR1VAL EQU   CSHR1                                                    08962000
IOWNRVAL EQU   IOWNR+1                                                  08963000
IOWNRLEN EQU   IOWNR                                                    08964000
DOWNRVAL EQU   DOWNR+1                                                  08965000
DOWNRLEN EQU   DOWNR                                                    08966000
ROWNRVAL EQU   ROWNR+1                                                  08967000
ROWNRLEN EQU   ROWNR                                                    08968000
GOWNRVAL EQU   GOWNR+1                                                  08969000
GOWNRLEN EQU   GOWNR                                                    08970000
POWNRVAL EQU   POWNR+1                                                  08971000
POWNRLEN EQU   POWNR                                                    08972000
BOWNRVAL EQU   BOWNR+1                                                  08973000
BOWNRLEN EQU   BOWNR                                                    08974000
AOWNRVAL EQU   AOWNR+1                                                  08975000
AOWNRLEN EQU   AOWNR                                                    08976000
UOWNRVAL EQU   UOWNR+1                                                  08977000
UOWNRLEN EQU   UOWNR                                                    08978000
COWNRVAL EQU   COWNR+1                                                  08979000
COWNRLEN EQU   COWNR                                                    08980000
MOWNRVAL EQU   MOWNR+1                                                  08981000
MOWNRLEN EQU   MOWNR                                                    08982000
RFORVAL  EQU   RFOR                                                     08983000
GFORVAL  EQU   GFOR                                                     08984000
PFORVAL  EQU   PFOR                                                     08985000
BFORVAL  EQU   BFOR                                                     08986000
AFORVAL  EQU   AFOR                                                     08987000
UFORVAL  EQU   UFOR                                                     08988000
CFORVAL  EQU   CFOR                                                     08989000
MFORVAL  EQU   MFOR                                                     08990000
RTOVAL   EQU   RTO                                                      08991000
GTOVAL   EQU   GTO                                                      08992000
PTOVAL   EQU   PTO                                                      08993000
BTOVAL   EQU   BTO                                                      08994000
ATOVAL   EQU   ATO                                                      08995000
UTOVAL   EQU   UTO                                                      08996000
CTOVAL   EQU   CTO                                                      08997000
MTOVAL   EQU   MTO                                                      08998000
ISTRGVAL EQU   ISTRG+1                                                  08999000
ISTRGLEN EQU   ISTRG                                                    09000000
IEPNMVAL EQU   IEPNM+1                                                  09001000
IEPNMLEN EQU   IEPNM                                                    09002000
DSTRGVAL EQU   DSTRG+1                                                  09003000
DSTRGLEN EQU   DSTRG                                                    09004000
DEPNMVAL EQU   DEPNM+1                                                  09005000
DEPNMLEN EQU   DEPNM                                                    09006000
RSTRGVAL EQU   RSTRG+1                                                  09007000
RSTRGLEN EQU   RSTRG                                                    09008000
GSTRGVAL EQU   GSTRG+1                                                  09009000
GSTRGLEN EQU   GSTRG                                                    09010000
PSTRGVAL EQU   PSTRG+1                                                  09011000
PSTRGLEN EQU   PSTRG                                                    09012000
CSTRGVAL EQU   CSTRG+1                                                  09013000
CSTRGLEN EQU   CSTRG                                                    09014000
USTRGVAL EQU   USTRG+1                                                  09015000
USTRGLEN EQU   USTRG                                                    09016000
MSTRGVAL EQU   MSTRG+1                                                  09017000
MSTRGLEN EQU   MSTRG                                                    09018000
REPNMVAL EQU   REPNM+1                                                  09019000
REPNMLEN EQU   REPNM                                                    09020000
GEPNMVAL EQU   GEPNM+1                                                  09021000
GEPNMLEN EQU   GEPNM                                                    09022000
PEPNMVAL EQU   PEPNM+1                                                  09023000
PEPNMLEN EQU   PEPNM                                                    09024000
CEPNMVAL EQU   CEPNM+1                                                  09025000
CEPNMLEN EQU   CEPNM                                                    09026000
UEPNMVAL EQU   UEPNM+1                                                  09027000
UEPNMLEN EQU   UEPNM                                                    09028000
MEPNMVAL EQU   MEPNM+1                                                  09029000
MEPNMLEN EQU   MEPNM                                                    09030000
IATTPVAL EQU   IATTP                                                    09031000
DATTPVAL EQU   DATTP                                                    09032000
RATTPVAL EQU   RATTP                                                    09033000
GATTPVAL EQU   GATTP                                                    09034000
PATTPVAL EQU   PATTP                                                    09035000
UATTPVAL EQU   UATTP                                                    09036000
CATTPVAL EQU   CATTP                                                    09037000
MATTPVAL EQU   MATTP                                                    09038000
ICODEVAL EQU   ICODE+1                                                  09039000
ICODELEN EQU   ICODE                                                    09040000
DCODEVAL EQU   DCODE+1                                                  09041000
DCODELEN EQU   DCODE                                                    09042000
RCODEVAL EQU   RCODE+1                                                  09043000
RCODELEN EQU   RCODE                                                    09044000
GCODEVAL EQU   GCODE+1                                                  09045000
GCODELEN EQU   GCODE                                                    09046000
PCODEVAL EQU   PCODE+1                                                  09047000
PCODELEN EQU   PCODE                                                    09048000
UCODEVAL EQU   UCODE+1                                                  09049000
UCODELEN EQU   UCODE                                                    09050000
CCODEVAL EQU   CCODE+1                                                  09051000
CCODELEN EQU   CCODE                                                    09052000
MCODEVAL EQU   MCODE+1                                                  09053000
MCODELEN EQU   MCODE                                                    09054000
IREADVAL EQU   IREAD+1                                                  09055000
IREADLEN EQU   IREAD                                                    09056000
DREADVAL EQU   DREAD+1                                                  09057000
DREADLEN EQU   DREAD                                                    09058000
RREADVAL EQU   RREAD+1                                                  09059000
RREADLEN EQU   RREAD                                                    09060000
GREADVAL EQU   GREAD+1                                                  09061000
GREADLEN EQU   GREAD                                                    09062000
PREADVAL EQU   PREAD+1                                                  09063000
PREADLEN EQU   PREAD                                                    09064000
UREADVAL EQU   UREAD+1                                                  09065000
UREADLEN EQU   UREAD                                                    09066000
CREADVAL EQU   CREAD+1                                                  09067000
CREADLEN EQU   CREAD                                                    09068000
MREADVAL EQU   MREAD+1                                                  09069000
MREADLEN EQU   MREAD                                                    09070000
IUPDTVAL EQU   IUPDT+1                                                  09071000
IUPDTLEN EQU   IUPDT                                                    09072000
DUPDTVAL EQU   DUPDT+1                                                  09073000
DUPDTLEN EQU   DUPDT                                                    09074000
RUPDTVAL EQU   RUPDT+1                                                  09075000
RUPDTLEN EQU   RUPDT                                                    09076000
GUPDTVAL EQU   GUPDT+1                                                  09077000
GUPDTLEN EQU   GUPDT                                                    09078000
PUPDTVAL EQU   PUPDT+1                                                  09079000
PUPDTLEN EQU   PUPDT                                                    09080000
UUPDTVAL EQU   UUPDT+1                                                  09081000
UUPDTLEN EQU   UUPDT                                                    09082000
CUPDTVAL EQU   CUPDT+1                                                  09083000
CUPDTLEN EQU   CUPDT                                                    09084000
MUPDTVAL EQU   MUPDT+1                                                  09085000
MUPDTLEN EQU   MUPDT                                                    09086000
ICINTVAL EQU   ICINT+1                                                  09087000
ICINTLEN EQU   ICINT                                                    09088000
DCINTVAL EQU   DCINT+1                                                  09089000
DCINTLEN EQU   DCINT                                                    09090000
RCINTVAL EQU   RCINT+1                                                  09091000
RCINTLEN EQU   RCINT                                                    09092000
GCINTVAL EQU   GCINT+1                                                  09093000
GCINTLEN EQU   GCINT                                                    09094000
PCINTVAL EQU   PCINT+1                                                  09095000
PCINTLEN EQU   PCINT                                                    09096000
UCINTVAL EQU   UCINT+1                                                  09097000
UCINTLEN EQU   UCINT                                                    09098000
CCINTVAL EQU   CCINT+1                                                  09099000
CCINTLEN EQU   CCINT                                                    09100000
MCINTVAL EQU   MCINT+1                                                  09101000
MCINTLEN EQU   MCINT                                                    09102000
IMSTRVAL EQU   IMSTR+1                                                  09103000
IMSTRLEN EQU   IMSTR                                                    09104000
DMSTRVAL EQU   DMSTR+1                                                  09105000
DMSTRLEN EQU   DMSTR                                                    09106000
RMSTRVAL EQU   RMSTR+1                                                  09107000
RMSTRLEN EQU   RMSTR                                                    09108000
GMSTRVAL EQU   GMSTR+1                                                  09109000
GMSTRLEN EQU   GMSTR                                                    09110000
PMSTRVAL EQU   PMSTR+1                                                  09111000
PMSTRLEN EQU   PMSTR                                                    09112000
CMSTRVAL EQU   CMSTR+1                                                  09113000
CMSTRLEN EQU   CMSTR                                                    09114000
UMSTRVAL EQU   UMSTR+1                                                  09115000
UMSTRLEN EQU   UMSTR                                                    09116000
MMSTRVAL EQU   MMSTR+1                                                  09117000
MMSTRLEN EQU   MMSTR                                                    09118000
IMDNMVAL EQU   IMDNM+1                                                  09119000
IMDNMLEN EQU   IMDNM                                                    09120000
IMDCTVAL EQU   IMDCT+21                                                 09121000
IMDCTLEN EQU   IMDCT+20                                                 09122000
IMDCTMEM EQU   IMDCT+12                                                 09123000
IMDCTMLN EQU   IMDCT+11                                                 09124000
IMDCTFUQ EQU   IMDCTFLG                                                 09125000
IMDCTPOS EQU   IMDCT+9                                                  09126000
IMDCTPAS EQU   IMDCT+1                                                  09127000
IMDCTPLN EQU   IMDCT                                                    09128000
IENAMVAL EQU   IENAM+21                                                 09129000
IENAMLEN EQU   IENAM+20                                                 09130000
IENAMMEM EQU   IENAM+12                                                 09131000
IENAMMLN EQU   IENAM+11                                                 09132000
IENAMFUQ EQU   IENAMFLG                                                 09133000
IENAMPOS EQU   IENAM+9                                                  09134000
IENAMPAS EQU   IENAM+1                                                  09135000
IENAMPLN EQU   IENAM                                                    09136000
DMDNMVAL EQU   DMDNM+1                                                  09137000
DMDNMLEN EQU   DMDNM                                                    09138000
DMDCTVAL EQU   DMDCT+21                                                 09139000
DMDCTLEN EQU   DMDCT+20                                                 09140000
DMDCTMEM EQU   DMDCT+12                                                 09141000
DMDCTMLN EQU   DMDCT+11                                                 09142000
DMDCTFUQ EQU   DMDCTFLG                                                 09143000
DMDCTPOS EQU   DMDCT+9                                                  09144000
DMDCTPAS EQU   DMDCT+1                                                  09145000
DMDCTPLN EQU   DMDCT                                                    09146000
DENAMVAL EQU   DENAM+21                                                 09147000
DENAMLEN EQU   DENAM+20                                                 09148000
DENAMMEM EQU   DENAM+12                                                 09149000
DENAMMLN EQU   DENAM+11                                                 09150000
DENAMFUQ EQU   DENAMFLG                                                 09151000
DENAMPOS EQU   DENAM+9                                                  09152000
DENAMPAS EQU   DENAM+1                                                  09153000
DENAMPLN EQU   DENAM                                                    09154000
PMDNMVAL EQU   PMDNM+1                                                  09155000
PMDNMLEN EQU   PMDNM                                                    09156000
RMDNMVAL EQU   RMDNM+1                                                  09157000
RMDNMLEN EQU   RMDNM                                                    09158000
GMDNMVAL EQU   GMDNM+1                                                  09159000
GMDNMLEN EQU   GMDNM                                                    09160000
UMDNMVAL EQU   UMDNM+1                                                  09161000
UMDNMLEN EQU   UMDNM                                                    09162000
CMDNMVAL EQU   CMDNM+1                                                  09163000
CMDNMLEN EQU   CMDNM                                                    09164000
PMDCTVAL EQU   PMDCT+21                                                 09165000
PMDCTLEN EQU   PMDCT+20                                                 09166000
PMDCTMEM EQU   PMDCT+12                                                 09167000
PMDCTMLN EQU   PMDCT+11                                                 09168000
PMDCTFUQ EQU   PMDCTFLG                                                 09169000
PMDCTPOS EQU   PMDCT+9                                                  09170000
PMDCTPAS EQU   PMDCT+1                                                  09171000
PMDCTPLN EQU   PMDCT                                                    09172000
RMDCTVAL EQU   RMDCT+21                                                 09173000
RMDCTLEN EQU   RMDCT+20                                                 09174000
RMDCTMEM EQU   RMDCT+12                                                 09175000
RMDCTMLN EQU   RMDCT+11                                                 09176000
RMDCTFUQ EQU   RMDCTFLG                                                 09177000
RMDCTPOS EQU   RMDCT+9                                                  09178000
RMDCTPAS EQU   RMDCT+1                                                  09179000
RMDCTPLN EQU   RMDCT                                                    09180000
GMDCTVAL EQU   GMDCT+21                                                 09181000
GMDCTLEN EQU   GMDCT+20                                                 09182000
GMDCTMEM EQU   GMDCT+12                                                 09183000
GMDCTMLN EQU   GMDCT+11                                                 09184000
GMDCTFUQ EQU   GMDCTFLG                                                 09185000
GMDCTPOS EQU   GMDCT+9                                                  09186000
GMDCTPAS EQU   GMDCT+1                                                  09187000
GMDCTPLN EQU   GMDCT                                                    09188000
UMDCTVAL EQU   UMDCT+21                                                 09189000
UMDCTLEN EQU   UMDCT+20                                                 09190000
UMDCTMEM EQU   UMDCT+12                                                 09191000
UMDCTMLN EQU   UMDCT+11                                                 09192000
UMDCTFUQ EQU   UMDCTFLG                                                 09193000
UMDCTPOS EQU   UMDCT+9                                                  09194000
UMDCTPAS EQU   UMDCT+1                                                  09195000
UMDCTPLN EQU   UMDCT                                                    09196000
CMDCTVAL EQU   CMDCT+21                                                 09197000
CMDCTLEN EQU   CMDCT+20                                                 09198000
CMDCTMEM EQU   CMDCT+12                                                 09199000
CMDCTMLN EQU   CMDCT+11                                                 09200000
CMDCTFUQ EQU   CMDCTFLG                                                 09201000
CMDCTPOS EQU   CMDCT+9                                                  09202000
CMDCTPAS EQU   CMDCT+1                                                  09203000
CMDCTPLN EQU   CMDCT                                                    09204000
PENAMVAL EQU   PENAM+21                                                 09205000
PENAMLEN EQU   PENAM+20                                                 09206000
PENAMMEM EQU   PENAM+12                                                 09207000
PENAMMLN EQU   PENAM+11                                                 09208000
PENAMFUQ EQU   PENAMFLG                                                 09209000
PENAMPOS EQU   PENAM+9                                                  09210000
PENAMPAS EQU   PENAM+1                                                  09211000
PENAMPLN EQU   PENAM                                                    09212000
RENAMVAL EQU   RENAM+21                                                 09213000
RENAMLEN EQU   RENAM+20                                                 09214000
RENAMMEM EQU   RENAM+12                                                 09215000
RENAMMLN EQU   RENAM+11                                                 09216000
RENAMFUQ EQU   RENAMFLG                                                 09217000
RENAMPOS EQU   RENAM+9                                                  09218000
RENAMPAS EQU   RENAM+1                                                  09219000
RENAMPLN EQU   RENAM                                                    09220000
GENAMVAL EQU   GENAM+21                                                 09221000
GENAMLEN EQU   GENAM+20                                                 09222000
GENAMMEM EQU   GENAM+12                                                 09223000
GENAMMLN EQU   GENAM+11                                                 09224000
GENAMFUQ EQU   GENAMFLG                                                 09225000
GENAMPOS EQU   GENAM+9                                                  09226000
GENAMPAS EQU   GENAM+1                                                  09227000
GENAMPLN EQU   GENAM                                                    09228000
UENAMVAL EQU   UENAM+21                                                 09229000
UENAMLEN EQU   UENAM+20                                                 09230000
UENAMMEM EQU   UENAM+12                                                 09231000
UENAMMLN EQU   UENAM+11                                                 09232000
UENAMFUQ EQU   UENAMFLG                                                 09233000
UENAMPOS EQU   UENAM+9                                                  09234000
UENAMPAS EQU   UENAM+1                                                  09235000
UENAMPLN EQU   UENAM                                                    09236000
CENAMVAL EQU   CENAM+21                                                 09237000
CENAMLEN EQU   CENAM+20                                                 09238000
CENAMMEM EQU   CENAM+12                                                 09239000
CENAMMLN EQU   CENAM+11                                                 09240000
CENAMFUQ EQU   CENAMFLG                                                 09241000
CENAMPOS EQU   CENAM+9                                                  09242000
CENAMPAS EQU   CENAM+1                                                  09243000
CENAMPLN EQU   CENAM                                                    09244000
IETRYVAL EQU   IETRY+21                                                 09245000
IETRYLEN EQU   IETRY+20                                                 09246000
IETRYMEM EQU   IETRY+12                                                 09247000
IETRYMLN EQU   IETRY+11                                                 09248000
IETRYFUQ EQU   IETRYFLG                                                 09249000
IETRYPOS EQU   IETRY+9                                                  09250000
IETRYPAS EQU   IETRY+1                                                  09251000
IETRYPLN EQU   IETRY                                                    09252000
DETRYVAL EQU   DETRY+21                                                 09253000
DETRYLEN EQU   DETRY+20                                                 09254000
DETRYMEM EQU   DETRY+12                                                 09255000
DETRYMLN EQU   DETRY+11                                                 09256000
DETRYFUQ EQU   DETRYFLG                                                 09257000
DETRYPOS EQU   DETRY+9                                                  09258000
DETRYPAS EQU   DETRY+1                                                  09259000
DETRYPLN EQU   DETRY                                                    09260000
BETRYVAL EQU   BETRY+21                                                 09261000
BETRYLEN EQU   BETRY+20                                                 09262000
BETRYMEM EQU   BETRY+12                                                 09263000
BETRYMLN EQU   BETRY+11                                                 09264000
BETRYFUQ EQU   BETRYFLG                                                 09265000
BETRYPOS EQU   BETRY+9                                                  09266000
BETRYPAS EQU   BETRY+1                                                  09267000
BETRYPLN EQU   BETRY                                                    09268000
XETRYVAL EQU   XETRY+21                                                 09269000
XETRYLEN EQU   XETRY+20                                                 09270000
XETRYMEM EQU   XETRY+12                                                 09271000
XETRYMLN EQU   XETRY+11                                                 09272000
XETRYFUQ EQU   XETRYFLG                                                 09273000
XETRYPOS EQU   XETRY+9                                                  09274000
XETRYPAS EQU   XETRY+1                                                  09275000
XETRYPLN EQU   XETRY                                                    09276000
RETRYVAL EQU   RETRY+21                                                 09277000
RETRYLEN EQU   RETRY+20                                                 09278000
RETRYMEM EQU   RETRY+12                                                 09279000
RETRYMLN EQU   RETRY+11                                                 09280000
RETRYFUQ EQU   RETRYFLG                                                 09281000
RETRYPOS EQU   RETRY+9                                                  09282000
RETRYPAS EQU   RETRY+1                                                  09283000
RETRYPLN EQU   RETRY                                                    09284000
GETRYVAL EQU   GETRY+21                                                 09285000
GETRYLEN EQU   GETRY+20                                                 09286000
GETRYMEM EQU   GETRY+12                                                 09287000
GETRYMLN EQU   GETRY+11                                                 09288000
GETRYFUQ EQU   GETRYFLG                                                 09289000
GETRYPOS EQU   GETRY+9                                                  09290000
GETRYPAS EQU   GETRY+1                                                  09291000
GETRYPLN EQU   GETRY                                                    09292000
AETRYVAL EQU   AETRY+21                                                 09293000
AETRYLEN EQU   AETRY+20                                                 09294000
AETRYMEM EQU   AETRY+12                                                 09295000
AETRYMLN EQU   AETRY+11                                                 09296000
AETRYFUQ EQU   AETRYFLG                                                 09297000
AETRYPOS EQU   AETRY+9                                                  09298000
AETRYPAS EQU   AETRY+1                                                  09299000
AETRYPLN EQU   AETRY                                                    09300000
PETRYVAL EQU   PETRY+21                                                 09301000
PETRYLEN EQU   PETRY+20                                                 09302000
PETRYMEM EQU   PETRY+12                                                 09303000
PETRYMLN EQU   PETRY+11                                                 09304000
PETRYFUQ EQU   PETRYFLG                                                 09305000
PETRYPOS EQU   PETRY+9                                                  09306000
PETRYPAS EQU   PETRY+1                                                  09307000
PETRYPLN EQU   PETRY                                                    09308000
CETRYVAL EQU   CETRY+21                                                 09309000
CETRYLEN EQU   CETRY+20                                                 09310000
CETRYMEM EQU   CETRY+12                                                 09311000
CETRYMLN EQU   CETRY+11                                                 09312000
CETRYFUQ EQU   CETRYFLG                                                 09313000
CETRYPOS EQU   CETRY+9                                                  09314000
CETRYPAS EQU   CETRY+1                                                  09315000
CETRYPLN EQU   CETRY                                                    09316000
UETRYVAL EQU   UETRY+21                                                 09317000
UETRYLEN EQU   UETRY+20                                                 09318000
UETRYMEM EQU   UETRY+12                                                 09319000
UETRYMLN EQU   UETRY+11                                                 09320000
UETRYFUQ EQU   UETRYFLG                                                 09321000
UETRYPOS EQU   UETRY+9                                                  09322000
UETRYPAS EQU   UETRY+1                                                  09323000
UETRYPLN EQU   UETRY                                                    09324000
METRYVAL EQU   METRY+21                                                 09325000
METRYLEN EQU   METRY+20                                                 09326000
METRYMEM EQU   METRY+12                                                 09327000
METRYMLN EQU   METRY+11                                                 09328000
METRYFUQ EQU   METRYFLG                                                 09329000
METRYPOS EQU   METRY+9                                                  09330000
METRYPAS EQU   METRY+1                                                  09331000
METRYPLN EQU   METRY                                                    09332000
CATDNVAL EQU   CATDN+1                                                  09333000
CATDNLEN EQU   CATDN                                                    09334000
CATLGLEN EQU   CATLG+20                                                 09335000
CATLGMEM EQU   CATLG+12                                                 09336000
CATLGMLN EQU   CATLG+11                                                 09337000
CATLGFUQ EQU   CATLGFLG                                                 09338000
CATLGPOS EQU   CATLG+9                                                  09339000
FDTVERB  EQU   FDTTBL                                                   09340000
@NM00031 EQU   DMPARY+15                                                09341000
DMPARYTP EQU   DMPARY+14                                                09342000
DMPARYEX EQU   DMPARY+12                                                09343000
DMPARYIC EQU   DMPARY+10                                                09344000
DMPARYSZ EQU   DMPARY+8                                                 09345000
DMPARYNM EQU   DMPARY                                                   09346000
@NM00030 EQU   DMPITM+15                                                09347000
DMPITMTP EQU   DMPITM+14                                                09348000
DMPITMLN EQU   DMPITM+12                                                09349000
DMPITMPT EQU   DMPITM+8                                                 09350000
DMPITMNM EQU   DMPITM                                                   09351000
@NM00029 EQU   ERCNVTAB+24                                              09352000
ERDARBPT EQU   ERCPLPT                                                  09353000
ERDYNRC  EQU   ERCATRC                                                  09354000
ERDSNM   EQU   ERCNVTAB+12                                              09355000
@NM00028 EQU   ERCNVTAB+4                                               09356000
@NM00027 EQU   ERCNVTAB+3                                               09357000
@NM00026 EQU   EROSOPER                                                 09358000
EROSUCDX EQU   EROSOPER                                                 09359000
EROSCATL EQU   EROSOPER                                                 09360000
@NM00025 EQU   EROPER                                                   09361000
ERCATAL  EQU   EROPER                                                   09362000
ERCATDL  EQU   EROPER                                                   09363000
ERCATDE  EQU   EROPER                                                   09364000
ERCATLC  EQU   EROPER                                                   09365000
@NM00024 EQU   ERTYPE                                                   09366000
ERDYNAL  EQU   ERTYPE                                                   09367000
EROSCAT  EQU   ERTYPE                                                   09368000
ERCATLG  EQU   ERTYPE                                                   09369000
@NM00023 EQU   FMTCNVF+1                                                09370000
FMTAR    EQU   FMTCNVF+1                                                09371000
FMTBS    EQU   FMTCNVF+1                                                09372000
FMTSS    EQU   FMTCNVF+1                                                09373000
FMTAL    EQU   FMTCNVF+1                                                09374000
FMTZS    EQU   FMTCNVF+1                                                09375000
@NM00022 EQU   FMTCNVF                                                  09376000
FMTPU    EQU   FMTCNVF                                                  09377000
FMTBD    EQU   FMTCNVF                                                  09378000
FMTBHD   EQU   FMTCNVF                                                  09379000
FMTBHA   EQU   FMTCNVF                                                  09380000
FMTBH    EQU   FMTCNVF                                                  09381000
FMTOLEN  EQU   FMTLIST+8                                                09382000
FMTRIO   EQU   FMTOCOL                                                  09383000
FMTSPT   EQU   FMTSTO                                                   09384000
FMTSTL   EQU   FMTILEN                                                  09385000
@NM00021 EQU   FMTFLGS+1                                                09386000
FMTSMSG  EQU   FMTFLGS+1                                                09387000
FMTHDF   EQU   FMTFLGS                                                  09388000
FMTDFF   EQU   FMTFLGS                                                  09389000
FMTSTF   EQU   FMTFLGS                                                  09390000
FMTREPF  EQU   FMTFLGS                                                  09391000
FMTBDF   EQU   FMTFLGS                                                  09392000
FMTIDF   EQU   FMTFLGS                                                  09393000
FMTSCF   EQU   FMTFLGS                                                  09394000
FMTEOLF  EQU   FMTFLGS                                                  09395000
DARGDTM  EQU   DARGARY+4                                                09396000
DARGPCT  EQU   DARGINL                                                  09397000
DARGREP  EQU   DARGINS                                                  09398000
@NM00020 EQU   DARGFLGS                                                 09399000
DARGFULL EQU   DARGFLGS                                                 09400000
DARGIND  EQU   DARGLIST+18                                              09401000
DARGRETL EQU   DARGLIST+16                                              09402000
DARGCNT  EQU   DARGLIST+14                                              09403000
DARGILP  EQU   DARGLIST+12                                              09404000
DARGSENT EQU   DARGSTID+3                                               09405000
DARGSMOD EQU   DARGSTID                                                 09406000
DARGRETP EQU   DARGLIST+4                                               09407000
DARGDBP  EQU   DARGLIST                                                 09408000
UVOLVOL  EQU   UVOLENT+4                                                09409000
UVOLDEV  EQU   UVOLENT                                                  09410000
UVOLCNT  EQU   UVOLLIST                                                 09411000
@NM00019 EQU   IOINFOPT                                                 09412000
IOINFLUB EQU   IOINFOPT                                                 09413000
IOINFTMS EQU   IOINFOPT                                                 09414000
IOINFSUP EQU   IOINFOPT                                                 09415000
IOINFDSN EQU   IOINFOPT                                                 09416000
IOINFVOL EQU   IOINFOPT                                                 09417000
IOINFDVT EQU   IOINFOPT                                                 09418000
OPNVOL   EQU   OPNAGL+44                                                09419000
OPNSTRNO EQU   OPNAGL+43                                                09420000
@NM00018 EQU   OPNOPT2                                                  09421000
OPNOPTJM EQU   OPNOPT2                                                  09422000
OPNOPTNM EQU   OPNOPT2                                                  09423000
OPNOPTAS EQU   OPNOPT2                                                  09424000
@NM00017 EQU   OPNDSO                                                   09425000
OPNDSOPO EQU   OPNDSO                                                   09426000
OPNDSOIS EQU   OPNDSO                                                   09427000
OPNDSOPS EQU   OPNDSO                                                   09428000
OPNDSOAM EQU   OPNDSO                                                   09429000
OPNKYL   EQU   OPNAGL+40                                                09430000
OPNBLK   EQU   OPNAGL+36                                                09431000
OPNREC   EQU   OPNAGL+32                                                09432000
OPNDEVIX EQU   OPNDEV+4                                                 09433000
OPNDEVDT EQU   OPNDEV                                                   09434000
OPNCBP   EQU   OPNAGL+20                                                09435000
OPNDSN   EQU   OPNAGL+16                                                09436000
OPNPWA   EQU   OPNAGL+12                                                09437000
OPNDDN   EQU   OPNAGL+8                                                 09438000
OPNMODRP EQU   OPNMOD                                                   09439000
OPNMODUB EQU   OPNMOD                                                   09440000
OPNMODRS EQU   OPNMOD                                                   09441000
OPNMODAX EQU   OPNMOD                                                   09442000
OPNMODRR EQU   OPNMOD                                                   09443000
OPNMODRC EQU   OPNMOD                                                   09444000
OPNMODAC EQU   OPNMOD                                                   09445000
OPNMODPD EQU   OPNMOD                                                   09446000
OPNTYPSY EQU   OPNTYP                                                   09447000
OPNTYPRV EQU   OPNTYP                                                   09448000
OPNTYPEX EQU   OPNTYP                                                   09449000
OPNTYPRA EQU   OPNTYP                                                   09450000
OPNTYPXM EQU   OPNTYP                                                   09451000
OPNTYPCI EQU   OPNTYP                                                   09452000
OPNTYPSO EQU   OPNTYP                                                   09453000
OPNTYPSI EQU   OPNTYP                                                   09454000
@NM00016 EQU   OPNRFM                                                   09455000
OPNRFMBK EQU   OPNRFM                                                   09456000
OPNRFMSF EQU   OPNRFM                                                   09457000
OPNRFMUN EQU   OPNRFM                                                   09458000
OPNRFMVR EQU   OPNRFM                                                   09459000
OPNRFMFX EQU   OPNRFM                                                   09460000
OPNOPTSK EQU   OPNOPT                                                   09461000
OPNOPTDR EQU   OPNOPT                                                   09462000
OPNOPTCR EQU   OPNOPT                                                   09463000
OPNOPTKS EQU   OPNOPT                                                   09464000
OPNOPTBK EQU   OPNOPT                                                   09465000
OPNOPTUP EQU   OPNOPT                                                   09466000
OPNOPTOT EQU   OPNOPT                                                   09467000
OPNOPTIN EQU   OPNOPT                                                   09468000
IOCEXT   EQU   IOCSTR+64                                                09469000
IOCTSML  EQU   IOCREL+2                                                 09470000
IOCTPML  EQU   IOCREL                                                   09471000
IOCWORK  EQU   IOCSTR+56                                                09472000
IOCRRN   EQU   IOCSTR+52                                                09473000
IOCPNM   EQU   IOCNWM+2                                                 09474000
IOCPTL   EQU   IOCNWM                                                   09475000
IOCKYA   EQU   IOCMEM                                                   09476000
IOCVRC   EQU   IOCTTR                                                   09477000
IOCCBP   EQU   IOCSTR+36                                                09478000
IOCDSN   EQU   IOCSTR+32                                                09479000
IOCHURBA EQU   IOCSTR+28                                                09480000
IOCVOLSR EQU   IOCSTR+22                                                09481000
@NM00015 EQU   IOCMSG                                                   09482000
IOCMSGSM EQU   IOCMSG                                                   09483000
IOCMSGAE EQU   IOCMSG                                                   09484000
IOCMSGCE EQU   IOCMSG                                                   09485000
IOCMSGOE EQU   IOCMSG                                                   09486000
IOCMSGOP EQU   IOCMSG                                                   09487000
IOCCHPKG EQU   IOCMSG                                                   09488000
IOCCHPKE EQU   IOCMSG                                                   09489000
IOCCHPNU EQU   IOCCHP                                                   09490000
IOCCHPUP EQU   IOCCHP                                                   09491000
IOCCHPBK EQU   IOCCHP                                                   09492000
IOCCHPCR EQU   IOCCHP                                                   09493000
IOCCHPKS EQU   IOCCHP                                                   09494000
IOCCHPSK EQU   IOCCHP                                                   09495000
IOCCHPDR EQU   IOCCHP                                                   09496000
IOCCHPSQ EQU   IOCCHP                                                   09497000
IOCMACNT EQU   IOCMAC2                                                  09498000
IOCMACER EQU   IOCMAC2                                                  09499000
IOCMACPA EQU   IOCMAC2                                                  09500000
IOCMACEN EQU   IOCMAC2                                                  09501000
IOCMACCP EQU   IOCMAC2                                                  09502000
IOCMACRR EQU   IOCMAC2                                                  09503000
IOCMACAS EQU   IOCMAC2                                                  09504000
IOCMACSK EQU   IOCMAC2                                                  09505000
@NM00014 EQU   IOCMAC                                                   09506000
IOCMACCC EQU   IOCMAC                                                   09507000
IOCMACDR EQU   IOCMAC                                                   09508000
IOCMACBK EQU   IOCMAC                                                   09509000
IOCMACCR EQU   IOCMAC                                                   09510000
IOCMACUP EQU   IOCMAC                                                   09511000
IOCMACOT EQU   IOCMAC                                                   09512000
IOCMACIN EQU   IOCMAC                                                   09513000
@NM00013 EQU   IOCRFM                                                   09514000
IOCRFMBK EQU   IOCRFM                                                   09515000
IOCRFMSF EQU   IOCRFM                                                   09516000
IOCRFMUN EQU   IOCRFM                                                   09517000
IOCRFMVR EQU   IOCRFM                                                   09518000
IOCRFMFX EQU   IOCRFM                                                   09519000
@NM00012 EQU   IOCDSO                                                   09520000
IOCDSOPO EQU   IOCDSO                                                   09521000
IOCDSOIS EQU   IOCDSO                                                   09522000
IOCDSOPS EQU   IOCDSO                                                   09523000
IOCDSOAM EQU   IOCDSO                                                   09524000
IOCRKP   EQU   IOCSTR+13                                                09525000
IOCKYL   EQU   IOCSTR+12                                                09526000
IOCTRN   EQU   IOCSTR+8                                                 09527000
IOCDLN   EQU   IOCSTR+4                                                 09528000
IOCDAD   EQU   IOCSTR                                                   09529000
UNITVTOC EQU   UNITABL+7                                                09530000
@NM00011 EQU   UNITSTAT                                                 09531000
UNITUSHR EQU   UNITSTAT                                                 09532000
UNITXSHR EQU   UNITSTAT                                                 09533000
UNITISHR EQU   UNITSTAT                                                 09534000
UNITUA   EQU   @NM00010+1                                               09535000
UNITCHA  EQU   @NM00010                                                 09536000
UNITUCB  EQU   UNITABL                                                  09537000
ALLUNCNT EQU   ALLAGL+30                                                09538000
ALLVLCNT EQU   ALLAGL+29                                                09539000
@NM00009 EQU   ALLOPT                                                   09540000
ALLOPTUN EQU   ALLOPT                                                   09541000
ALLOPTPV EQU   ALLOPT                                                   09542000
ALLOPTDS EQU   ALLOPT                                                   09543000
ALLOPTVL EQU   ALLOPT                                                   09544000
@NM00008 EQU   ALLORG+1                                                 09545000
ALLORGVS EQU   ALLORG+1                                                 09546000
@NM00007 EQU   ALLORG+1                                                 09547000
ALLORGGS EQU   ALLORG+1                                                 09548000
ALLORGUN EQU   ALLORG                                                   09549000
ALLORGPO EQU   ALLORG                                                   09550000
ALLORGMQ EQU   ALLORG                                                   09551000
ALLORGCQ EQU   ALLORG                                                   09552000
ALLORGCX EQU   ALLORG                                                   09553000
ALLORGDA EQU   ALLORG                                                   09554000
ALLORGPS EQU   ALLORG                                                   09555000
ALLORGIS EQU   ALLORG                                                   09556000
ALLDSPUN EQU   ALLDSP                                                   09557000
ALLDSPCG EQU   ALLDSP                                                   09558000
ALLDSPDE EQU   ALLDSP                                                   09559000
ALLDSPKP EQU   ALLDSP                                                   09560000
@NM00006 EQU   ALLDSP                                                   09561000
ALLSTSOD EQU   ALLSTS                                                   09562000
ALLSTSMD EQU   ALLSTS                                                   09563000
ALLSTSNW EQU   ALLSTS                                                   09564000
ALLSTSSR EQU   ALLSTS                                                   09565000
@NM00005 EQU   ALLSTS                                                   09566000
ALLPWD   EQU   ALLAGL+20                                                09567000
ALLVLP   EQU   ALLAGL+16                                                09568000
ALLULP   EQU   ALLAGL+12                                                09569000
ALLDDN   EQU   ALLAGL+4                                                 09570000
ALLDSN   EQU   ALLAGL                                                   09571000
CIRPID   EQU   CIRAGL+28                                                09572000
CIRPWD   EQU   CIRAGL+24                                                09573000
CIRCAT   EQU   CIRAGL+20                                                09574000
CIRWKP   EQU   CIRAGL+16                                                09575000
CIRTLR   EQU   CIRAGL+12                                                09576000
CIRHDR   EQU   CIRAGL+8                                                 09577000
CIRTLN   EQU   CIRAGL+6                                                 09578000
CIRHLN   EQU   CIRAGL+4                                                 09579000
@NM00004 EQU   CIRAGL+1                                                 09580000
@NM00003 EQU   CIRTYPE                                                  09581000
CIRTYPAQ EQU   CIRTYPE                                                  09582000
CIRTYP1Q EQU   CIRTYPE                                                  09583000
NEWID1   EQU   TRACE1+95                                                09584000
CALLID   EQU   OLDERID1+90                                              09585000
@NM00002 EQU   OLDERID1                                                 09586000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09587000
@RC00689 EQU   @RC00685                                                 09588000
@RF00756 EQU   @RC00753                                                 09589000
@RF00790 EQU   @EL00002                                                 09590000
@RF00794 EQU   @EL00002                                                 09591000
@RF00847 EQU   @RC00843                                                 09592000
@RF00877 EQU   @RC00858                                                 09593000
@RF01074 EQU   @RC01069                                                 09594000
@RF01085 EQU   @RC01080                                                 09595000
@RF01096 EQU   @RC01091                                                 09596000
@RF01127 EQU   @EL00003                                                 09597000
@RF01184 EQU   @RC01181                                                 09598000
@RC01187 EQU   @RC01181                                                 09599000
@RF01202 EQU   @RC01161                                                 09600000
@RC01232 EQU   @RC01227                                                 09601000
@RF01320 EQU   @EL00004                                                 09602000
@RF01389 EQU   @EL00005                                                 09603000
@RC01387 EQU   @EL00005                                                 09604000
@RF01574 EQU   @EL00006                                                 09605000
@RF01585 EQU   @EL00006                                                 09606000
@RC01583 EQU   @EL00006                                                 09607000
@RF01641 EQU   @RC01638                                                 09608000
@RC01666 EQU   @RC01664                                                 09609000
@RT01843 EQU   @EL00007                                                 09610000
@ENDDATA EQU   *                                                        09611000
         END   IDCDE02,(C'PLS2303',0701,77228)                          09612000
